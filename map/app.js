(()=>{var Bct=Object.create;var dP=Object.defineProperty;var Oct=Object.getOwnPropertyDescriptor;var Nct=Object.getOwnPropertyNames;var Fct=Object.getPrototypeOf,Lct=Object.prototype.hasOwnProperty;var AP=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),sl=(e,t)=>{for(var r in t)dP(e,r,{get:t[r],enumerable:!0})},zct=(e,t,r,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of Nct(t))!Lct.call(e,s)&&s!==r&&dP(e,s,{get:()=>t[s],enumerable:!(i=Oct(t,s))||i.enumerable});return e};var mP=(e,t,r)=>(r=e!=null?Bct(Fct(e)):{},zct(t||!e||!e.__esModule?dP(r,"default",{value:e,enumerable:!0}):r,e));var k$=AP((dzt,CS)=>{(function(e,t,r,i){"use strict";var s=["","webkit","Moz","MS","ms","o"],n=t.createElement("div"),o="function",c=Math.round,f=Math.abs,p=Date.now;function x(ut,gt,$t){return setTimeout(G(ut,$t),gt)}function E(ut,gt,$t){return Array.isArray(ut)?(T(ut,$t[gt],$t),!0):!1}function T(ut,gt,$t){var pe;if(ut)if(ut.forEach)ut.forEach(gt,$t);else if(ut.length!==i)for(pe=0;pe<ut.length;)gt.call($t,ut[pe],pe,ut),pe++;else for(pe in ut)ut.hasOwnProperty(pe)&&gt.call($t,ut[pe],pe,ut)}function D(ut,gt,$t){var pe="DEPRECATED METHOD: "+gt+`
`+$t+` AT 
`;return function(){var Oe=new Error("get-stack-trace"),ar=Oe&&Oe.stack?Oe.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",Ri=e.console&&(e.console.warn||e.console.log);return Ri&&Ri.call(e.console,pe,ar),ut.apply(this,arguments)}}var N;typeof Object.assign!="function"?N=function(gt){if(gt===i||gt===null)throw new TypeError("Cannot convert undefined or null to object");for(var $t=Object(gt),pe=1;pe<arguments.length;pe++){var Oe=arguments[pe];if(Oe!==i&&Oe!==null)for(var ar in Oe)Oe.hasOwnProperty(ar)&&($t[ar]=Oe[ar])}return $t}:N=Object.assign;var z=D(function(gt,$t,pe){for(var Oe=Object.keys($t),ar=0;ar<Oe.length;)(!pe||pe&&gt[Oe[ar]]===i)&&(gt[Oe[ar]]=$t[Oe[ar]]),ar++;return gt},"extend","Use `assign`."),U=D(function(gt,$t){return z(gt,$t,!0)},"merge","Use `assign`.");function H(ut,gt,$t){var pe=gt.prototype,Oe;Oe=ut.prototype=Object.create(pe),Oe.constructor=ut,Oe._super=pe,$t&&N(Oe,$t)}function G(ut,gt){return function(){return ut.apply(gt,arguments)}}function Z(ut,gt){return typeof ut==o?ut.apply(gt&&gt[0]||i,gt):ut}function Y(ut,gt){return ut===i?gt:ut}function st(ut,gt,$t){T(kt(gt),function(pe){ut.addEventListener(pe,$t,!1)})}function at(ut,gt,$t){T(kt(gt),function(pe){ut.removeEventListener(pe,$t,!1)})}function Dt(ut,gt){for(;ut;){if(ut==gt)return!0;ut=ut.parentNode}return!1}function Tt(ut,gt){return ut.indexOf(gt)>-1}function kt(ut){return ut.trim().split(/\s+/g)}function Et(ut,gt,$t){if(ut.indexOf&&!$t)return ut.indexOf(gt);for(var pe=0;pe<ut.length;){if($t&&ut[pe][$t]==gt||!$t&&ut[pe]===gt)return pe;pe++}return-1}function Mt(ut){return Array.prototype.slice.call(ut,0)}function oe(ut,gt,$t){for(var pe=[],Oe=[],ar=0;ar<ut.length;){var Ri=gt?ut[ar][gt]:ut[ar];Et(Oe,Ri)<0&&pe.push(ut[ar]),Oe[ar]=Ri,ar++}return $t&&(gt?pe=pe.sort(function(eo,mo){return eo[gt]>mo[gt]}):pe=pe.sort()),pe}function Xt(ut,gt){for(var $t,pe,Oe=gt[0].toUpperCase()+gt.slice(1),ar=0;ar<s.length;){if($t=s[ar],pe=$t?$t+Oe:gt,pe in ut)return pe;ar++}return i}var xt=1;function jt(){return xt++}function Wt(ut){var gt=ut.ownerDocument||ut;return gt.defaultView||gt.parentWindow||e}var de=/mobile|tablet|ip(ad|hone|od)|android/i,Ee="ontouchstart"in e,Se=Xt(e,"PointerEvent")!==i,ze=Ee&&de.test(navigator.userAgent),ke="touch",ir="pen",Ti="mouse",_i="kinect",ci=25,Gr=1,Fr=2,Dr=4,Le=8,Tr=1,jr=2,Ie=4,Ji=8,yi=16,tn=jr|Ie,hn=Ji|yi,Sr=tn|hn,ae=["x","y"],Xn=["clientX","clientY"];function on(ut,gt){var $t=this;this.manager=ut,this.callback=gt,this.element=ut.element,this.target=ut.options.inputTarget,this.domHandler=function(pe){Z(ut.options.enable,[ut])&&$t.handler(pe)},this.init()}on.prototype={handler:function(){},init:function(){this.evEl&&st(this.element,this.evEl,this.domHandler),this.evTarget&&st(this.target,this.evTarget,this.domHandler),this.evWin&&st(Wt(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&at(this.element,this.evEl,this.domHandler),this.evTarget&&at(this.target,this.evTarget,this.domHandler),this.evWin&&at(Wt(this.element),this.evWin,this.domHandler)}};function Qi(ut){var gt,$t=ut.options.inputClass;return $t?gt=$t:Se?gt=It:ze?gt=Lt:Ee?gt=be:gt=Br,new gt(ut,$i)}function $i(ut,gt,$t){var pe=$t.pointers.length,Oe=$t.changedPointers.length,ar=gt&Gr&&pe-Oe===0,Ri=gt&(Dr|Le)&&pe-Oe===0;$t.isFirst=!!ar,$t.isFinal=!!Ri,ar&&(ut.session={}),$t.eventType=gt,Ro(ut,$t),ut.emit("hammer.input",$t),ut.recognize($t),ut.session.prevInput=$t}function Ro(ut,gt){var $t=ut.session,pe=gt.pointers,Oe=pe.length;$t.firstInput||($t.firstInput=Uo(gt)),Oe>1&&!$t.firstMultiple?$t.firstMultiple=Uo(gt):Oe===1&&($t.firstMultiple=!1);var ar=$t.firstInput,Ri=$t.firstMultiple,Ns=Ri?Ri.center:ar.center,eo=gt.center=vl(pe);gt.timeStamp=p(),gt.deltaTime=gt.timeStamp-ar.timeStamp,gt.angle=ta(Ns,eo),gt.distance=Ne(Ns,eo),pu($t,gt),gt.offsetDirection=Vo(gt.deltaX,gt.deltaY);var mo=Xa(gt.deltaTime,gt.deltaX,gt.deltaY);gt.overallVelocityX=mo.x,gt.overallVelocityY=mo.y,gt.overallVelocity=f(mo.x)>f(mo.y)?mo.x:mo.y,gt.scale=Ri?Xl(Ri.pointers,pe):1,gt.rotation=Ri?Zn(Ri.pointers,pe):0,gt.maxPointers=$t.prevInput?gt.pointers.length>$t.prevInput.maxPointers?gt.pointers.length:$t.prevInput.maxPointers:gt.pointers.length,bl($t,gt);var Ka=ut.element;Dt(gt.srcEvent.target,Ka)&&(Ka=gt.srcEvent.target),gt.target=Ka}function pu(ut,gt){var $t=gt.center,pe=ut.offsetDelta||{},Oe=ut.prevDelta||{},ar=ut.prevInput||{};(gt.eventType===Gr||ar.eventType===Dr)&&(Oe=ut.prevDelta={x:ar.deltaX||0,y:ar.deltaY||0},pe=ut.offsetDelta={x:$t.x,y:$t.y}),gt.deltaX=Oe.x+($t.x-pe.x),gt.deltaY=Oe.y+($t.y-pe.y)}function bl(ut,gt){var $t=ut.lastInterval||gt,pe=gt.timeStamp-$t.timeStamp,Oe,ar,Ri,Ns;if(gt.eventType!=Le&&(pe>ci||$t.velocity===i)){var eo=gt.deltaX-$t.deltaX,mo=gt.deltaY-$t.deltaY,Ka=Xa(pe,eo,mo);ar=Ka.x,Ri=Ka.y,Oe=f(Ka.x)>f(Ka.y)?Ka.x:Ka.y,Ns=Vo(eo,mo),ut.lastInterval=gt}else Oe=$t.velocity,ar=$t.velocityX,Ri=$t.velocityY,Ns=$t.direction;gt.velocity=Oe,gt.velocityX=ar,gt.velocityY=Ri,gt.direction=Ns}function Uo(ut){for(var gt=[],$t=0;$t<ut.pointers.length;)gt[$t]={clientX:c(ut.pointers[$t].clientX),clientY:c(ut.pointers[$t].clientY)},$t++;return{timeStamp:p(),pointers:gt,center:vl(gt),deltaX:ut.deltaX,deltaY:ut.deltaY}}function vl(ut){var gt=ut.length;if(gt===1)return{x:c(ut[0].clientX),y:c(ut[0].clientY)};for(var $t=0,pe=0,Oe=0;Oe<gt;)$t+=ut[Oe].clientX,pe+=ut[Oe].clientY,Oe++;return{x:c($t/gt),y:c(pe/gt)}}function Xa(ut,gt,$t){return{x:gt/ut||0,y:$t/ut||0}}function Vo(ut,gt){return ut===gt?Tr:f(ut)>=f(gt)?ut<0?jr:Ie:gt<0?Ji:yi}function Ne(ut,gt,$t){$t||($t=ae);var pe=gt[$t[0]]-ut[$t[0]],Oe=gt[$t[1]]-ut[$t[1]];return Math.sqrt(pe*pe+Oe*Oe)}function ta(ut,gt,$t){$t||($t=ae);var pe=gt[$t[0]]-ut[$t[0]],Oe=gt[$t[1]]-ut[$t[1]];return Math.atan2(Oe,pe)*180/Math.PI}function Zn(ut,gt){return ta(gt[1],gt[0],Xn)+ta(ut[1],ut[0],Xn)}function Xl(ut,gt){return Ne(gt[0],gt[1],Xn)/Ne(ut[0],ut[1],Xn)}var Za={mousedown:Gr,mousemove:Fr,mouseup:Dr},Ue="mousedown",ri="mousemove mouseup";function Br(){this.evEl=Ue,this.evWin=ri,this.pressed=!1,on.apply(this,arguments)}H(Br,on,{handler:function(gt){var $t=Za[gt.type];$t&Gr&&gt.button===0&&(this.pressed=!0),$t&Fr&&gt.which!==1&&($t=Dr),this.pressed&&($t&Dr&&(this.pressed=!1),this.callback(this.manager,$t,{pointers:[gt],changedPointers:[gt],pointerType:Ti,srcEvent:gt}))}});var Ao={pointerdown:Gr,pointermove:Fr,pointerup:Dr,pointercancel:Le,pointerout:Le},Ga={2:ke,3:ir,4:Ti,5:_i},Hr="pointerdown",ba="pointermove pointerup pointercancel";e.MSPointerEvent&&!e.PointerEvent&&(Hr="MSPointerDown",ba="MSPointerMove MSPointerUp MSPointerCancel");function It(){this.evEl=Hr,this.evWin=ba,on.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}H(It,on,{handler:function(gt){var $t=this.store,pe=!1,Oe=gt.type.toLowerCase().replace("ms",""),ar=Ao[Oe],Ri=Ga[gt.pointerType]||gt.pointerType,Ns=Ri==ke,eo=Et($t,gt.pointerId,"pointerId");ar&Gr&&(gt.button===0||Ns)?eo<0&&($t.push(gt),eo=$t.length-1):ar&(Dr|Le)&&(pe=!0),!(eo<0)&&($t[eo]=gt,this.callback(this.manager,ar,{pointers:$t,changedPointers:[gt],pointerType:Ri,srcEvent:gt}),pe&&$t.splice(eo,1))}});var rt={touchstart:Gr,touchmove:Fr,touchend:Dr,touchcancel:Le},ot="touchstart",At="touchstart touchmove touchend touchcancel";function Rt(){this.evTarget=ot,this.evWin=At,this.started=!1,on.apply(this,arguments)}H(Rt,on,{handler:function(gt){var $t=rt[gt.type];if($t===Gr&&(this.started=!0),!!this.started){var pe=Bt.call(this,gt,$t);$t&(Dr|Le)&&pe[0].length-pe[1].length===0&&(this.started=!1),this.callback(this.manager,$t,{pointers:pe[0],changedPointers:pe[1],pointerType:ke,srcEvent:gt})}}});function Bt(ut,gt){var $t=Mt(ut.touches),pe=Mt(ut.changedTouches);return gt&(Dr|Le)&&($t=oe($t.concat(pe),"identifier",!0)),[$t,pe]}var St={touchstart:Gr,touchmove:Fr,touchend:Dr,touchcancel:Le},qt="touchstart touchmove touchend touchcancel";function Lt(){this.evTarget=qt,this.targetIds={},on.apply(this,arguments)}H(Lt,on,{handler:function(gt){var $t=St[gt.type],pe=Qt.call(this,gt,$t);pe&&this.callback(this.manager,$t,{pointers:pe[0],changedPointers:pe[1],pointerType:ke,srcEvent:gt})}});function Qt(ut,gt){var $t=Mt(ut.touches),pe=this.targetIds;if(gt&(Gr|Fr)&&$t.length===1)return pe[$t[0].identifier]=!0,[$t,$t];var Oe,ar,Ri=Mt(ut.changedTouches),Ns=[],eo=this.target;if(ar=$t.filter(function(mo){return Dt(mo.target,eo)}),gt===Gr)for(Oe=0;Oe<ar.length;)pe[ar[Oe].identifier]=!0,Oe++;for(Oe=0;Oe<Ri.length;)pe[Ri[Oe].identifier]&&Ns.push(Ri[Oe]),gt&(Dr|Le)&&delete pe[Ri[Oe].identifier],Oe++;if(Ns.length)return[oe(ar.concat(Ns),"identifier",!0),Ns]}var _e=2500,ye=25;function be(){on.apply(this,arguments);var ut=G(this.handler,this);this.touch=new Lt(this.manager,ut),this.mouse=new Br(this.manager,ut),this.primaryTouch=null,this.lastTouches=[]}H(be,on,{handler:function(gt,$t,pe){var Oe=pe.pointerType==ke,ar=pe.pointerType==Ti;if(!(ar&&pe.sourceCapabilities&&pe.sourceCapabilities.firesTouchEvents)){if(Oe)xr.call(this,$t,pe);else if(ar&&lr.call(this,pe))return;this.callback(gt,$t,pe)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function xr(ut,gt){ut&Gr?(this.primaryTouch=gt.changedPointers[0].identifier,Or.call(this,gt)):ut&(Dr|Le)&&Or.call(this,gt)}function Or(ut){var gt=ut.changedPointers[0];if(gt.identifier===this.primaryTouch){var $t={x:gt.clientX,y:gt.clientY};this.lastTouches.push($t);var pe=this.lastTouches,Oe=function(){var ar=pe.indexOf($t);ar>-1&&pe.splice(ar,1)};setTimeout(Oe,_e)}}function lr(ut){for(var gt=ut.srcEvent.clientX,$t=ut.srcEvent.clientY,pe=0;pe<this.lastTouches.length;pe++){var Oe=this.lastTouches[pe],ar=Math.abs(gt-Oe.x),Ri=Math.abs($t-Oe.y);if(ar<=ye&&Ri<=ye)return!0}return!1}var br=Xt(n.style,"touchAction"),Ur=br!==i,an="compute",gn="auto",Ui="manipulation",di="none",Is="pan-x",fn="pan-y",rs=Pm();function Os(ut,gt){this.manager=ut,this.set(gt)}Os.prototype={set:function(ut){ut==an&&(ut=this.compute()),Ur&&this.manager.element.style&&rs[ut]&&(this.manager.element.style[br]=ut),this.actions=ut.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var ut=[];return T(this.manager.recognizers,function(gt){Z(gt.options.enable,[gt])&&(ut=ut.concat(gt.getTouchAction()))}),va(ut.join(" "))},preventDefaults:function(ut){var gt=ut.srcEvent,$t=ut.offsetDirection;if(this.manager.session.prevented){gt.preventDefault();return}var pe=this.actions,Oe=Tt(pe,di)&&!rs[di],ar=Tt(pe,fn)&&!rs[fn],Ri=Tt(pe,Is)&&!rs[Is];if(Oe){var Ns=ut.pointers.length===1,eo=ut.distance<2,mo=ut.deltaTime<250;if(Ns&&eo&&mo)return}if(!(Ri&&ar)&&(Oe||ar&&$t&tn||Ri&&$t&hn))return this.preventSrc(gt)},preventSrc:function(ut){this.manager.session.prevented=!0,ut.preventDefault()}};function va(ut){if(Tt(ut,di))return di;var gt=Tt(ut,Is),$t=Tt(ut,fn);return gt&&$t?di:gt||$t?gt?Is:fn:Tt(ut,Ui)?Ui:gn}function Pm(){if(!Ur)return!1;var ut={},gt=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function($t){ut[$t]=gt?e.CSS.supports("touch-action",$t):!0}),ut}var Zl=1,to=2,_h=4,Hi=8,Qa=Hi,Dc=16,$n=32;function _s(ut){this.options=N({},this.defaults,ut||{}),this.id=jt(),this.manager=null,this.options.enable=Y(this.options.enable,!0),this.state=Zl,this.simultaneous={},this.requireFail=[]}_s.prototype={defaults:{},set:function(ut){return N(this.options,ut),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(ut){if(E(ut,"recognizeWith",this))return this;var gt=this.simultaneous;return ut=Ms(ut,this),gt[ut.id]||(gt[ut.id]=ut,ut.recognizeWith(this)),this},dropRecognizeWith:function(ut){return E(ut,"dropRecognizeWith",this)?this:(ut=Ms(ut,this),delete this.simultaneous[ut.id],this)},requireFailure:function(ut){if(E(ut,"requireFailure",this))return this;var gt=this.requireFail;return ut=Ms(ut,this),Et(gt,ut)===-1&&(gt.push(ut),ut.requireFailure(this)),this},dropRequireFailure:function(ut){if(E(ut,"dropRequireFailure",this))return this;ut=Ms(ut,this);var gt=Et(this.requireFail,ut);return gt>-1&&this.requireFail.splice(gt,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(ut){return!!this.simultaneous[ut.id]},emit:function(ut){var gt=this,$t=this.state;function pe(Oe){gt.manager.emit(Oe,ut)}$t<Hi&&pe(gt.options.event+Rm($t)),pe(gt.options.event),ut.additionalEvent&&pe(ut.additionalEvent),$t>=Hi&&pe(gt.options.event+Rm($t))},tryEmit:function(ut){if(this.canEmit())return this.emit(ut);this.state=$n},canEmit:function(){for(var ut=0;ut<this.requireFail.length;){if(!(this.requireFail[ut].state&($n|Zl)))return!1;ut++}return!0},recognize:function(ut){var gt=N({},ut);if(!Z(this.options.enable,[this,gt])){this.reset(),this.state=$n;return}this.state&(Qa|Dc|$n)&&(this.state=Zl),this.state=this.process(gt),this.state&(to|_h|Hi|Dc)&&this.tryEmit(gt)},process:function(ut){},getTouchAction:function(){},reset:function(){}};function Rm(ut){return ut&Dc?"cancel":ut&Hi?"end":ut&_h?"move":ut&to?"start":""}function ea(ut){return ut==yi?"down":ut==Ji?"up":ut==jr?"left":ut==Ie?"right":""}function Ms(ut,gt){var $t=gt.manager;return $t?$t.get(ut):ut}function ko(){_s.apply(this,arguments)}H(ko,_s,{defaults:{pointers:1},attrTest:function(ut){var gt=this.options.pointers;return gt===0||ut.pointers.length===gt},process:function(ut){var gt=this.state,$t=ut.eventType,pe=gt&(to|_h),Oe=this.attrTest(ut);return pe&&($t&Le||!Oe)?gt|Dc:pe||Oe?$t&Dr?gt|Hi:gt&to?gt|_h:to:$n}});function Gl(){ko.apply(this,arguments),this.pX=null,this.pY=null}H(Gl,ko,{defaults:{event:"pan",threshold:10,pointers:1,direction:Sr},getTouchAction:function(){var ut=this.options.direction,gt=[];return ut&tn&&gt.push(fn),ut&hn&&gt.push(Is),gt},directionTest:function(ut){var gt=this.options,$t=!0,pe=ut.distance,Oe=ut.direction,ar=ut.deltaX,Ri=ut.deltaY;return Oe&gt.direction||(gt.direction&tn?(Oe=ar===0?Tr:ar<0?jr:Ie,$t=ar!=this.pX,pe=Math.abs(ut.deltaX)):(Oe=Ri===0?Tr:Ri<0?Ji:yi,$t=Ri!=this.pY,pe=Math.abs(ut.deltaY))),ut.direction=Oe,$t&&pe>gt.threshold&&Oe&gt.direction},attrTest:function(ut){return ko.prototype.attrTest.call(this,ut)&&(this.state&to||!(this.state&to)&&this.directionTest(ut))},emit:function(ut){this.pX=ut.deltaX,this.pY=ut.deltaY;var gt=ea(ut.direction);gt&&(ut.additionalEvent=this.options.event+gt),this._super.emit.call(this,ut)}});function Fn(){ko.apply(this,arguments)}H(Fn,ko,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[di]},attrTest:function(ut){return this._super.attrTest.call(this,ut)&&(Math.abs(ut.scale-1)>this.options.threshold||this.state&to)},emit:function(ut){if(ut.scale!==1){var gt=ut.scale<1?"in":"out";ut.additionalEvent=this.options.event+gt}this._super.emit.call(this,ut)}});function Ki(){_s.apply(this,arguments),this._timer=null,this._input=null}H(Ki,_s,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[gn]},process:function(ut){var gt=this.options,$t=ut.pointers.length===gt.pointers,pe=ut.distance<gt.threshold,Oe=ut.deltaTime>gt.time;if(this._input=ut,!pe||!$t||ut.eventType&(Dr|Le)&&!Oe)this.reset();else if(ut.eventType&Gr)this.reset(),this._timer=x(function(){this.state=Qa,this.tryEmit()},gt.time,this);else if(ut.eventType&Dr)return Qa;return $n},reset:function(){clearTimeout(this._timer)},emit:function(ut){this.state===Qa&&(ut&&ut.eventType&Dr?this.manager.emit(this.options.event+"up",ut):(this._input.timeStamp=p(),this.manager.emit(this.options.event,this._input)))}});function Ql(){ko.apply(this,arguments)}H(Ql,ko,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[di]},attrTest:function(ut){return this._super.attrTest.call(this,ut)&&(Math.abs(ut.rotation)>this.options.threshold||this.state&to)}});function Hn(){ko.apply(this,arguments)}H(Hn,ko,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:tn|hn,pointers:1},getTouchAction:function(){return Gl.prototype.getTouchAction.call(this)},attrTest:function(ut){var gt=this.options.direction,$t;return gt&(tn|hn)?$t=ut.overallVelocity:gt&tn?$t=ut.overallVelocityX:gt&hn&&($t=ut.overallVelocityY),this._super.attrTest.call(this,ut)&&gt&ut.offsetDirection&&ut.distance>this.options.threshold&&ut.maxPointers==this.options.pointers&&f($t)>this.options.velocity&&ut.eventType&Dr},emit:function(ut){var gt=ea(ut.offsetDirection);gt&&this.manager.emit(this.options.event+gt,ut),this.manager.emit(this.options.event,ut)}});function du(){_s.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}H(du,_s,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Ui]},process:function(ut){var gt=this.options,$t=ut.pointers.length===gt.pointers,pe=ut.distance<gt.threshold,Oe=ut.deltaTime<gt.time;if(this.reset(),ut.eventType&Gr&&this.count===0)return this.failTimeout();if(pe&&Oe&&$t){if(ut.eventType!=Dr)return this.failTimeout();var ar=this.pTime?ut.timeStamp-this.pTime<gt.interval:!0,Ri=!this.pCenter||Ne(this.pCenter,ut.center)<gt.posThreshold;this.pTime=ut.timeStamp,this.pCenter=ut.center,!Ri||!ar?this.count=1:this.count+=1,this._input=ut;var Ns=this.count%gt.taps;if(Ns===0)return this.hasRequireFailures()?(this._timer=x(function(){this.state=Qa,this.tryEmit()},gt.interval,this),to):Qa}return $n},failTimeout:function(){return this._timer=x(function(){this.state=$n},this.options.interval,this),$n},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Qa&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function Cs(ut,gt){return gt=gt||{},gt.recognizers=Y(gt.recognizers,Cs.defaults.preset),new Xp(ut,gt)}Cs.VERSION="2.0.7",Cs.defaults={domEvents:!1,touchAction:an,enable:!0,inputTarget:null,inputClass:null,preset:[[Ql,{enable:!1}],[Fn,{enable:!1},["rotate"]],[Hn,{direction:tn}],[Gl,{direction:tn},["swipe"]],[du],[du,{event:"doubletap",taps:2},["tap"]],[Ki]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var B0=1,Kl=2;function Xp(ut,gt){this.options=N({},Cs.defaults,gt||{}),this.options.inputTarget=this.options.inputTarget||ut,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=ut,this.input=Qi(this),this.touchAction=new Os(this,this.options.touchAction),Zp(this,!0),T(this.options.recognizers,function($t){var pe=this.add(new $t[0]($t[1]));$t[2]&&pe.recognizeWith($t[2]),$t[3]&&pe.requireFailure($t[3])},this)}Xp.prototype={set:function(ut){return N(this.options,ut),ut.touchAction&&this.touchAction.update(),ut.inputTarget&&(this.input.destroy(),this.input.target=ut.inputTarget,this.input.init()),this},stop:function(ut){this.session.stopped=ut?Kl:B0},recognize:function(ut){var gt=this.session;if(!gt.stopped){this.touchAction.preventDefaults(ut);var $t,pe=this.recognizers,Oe=gt.curRecognizer;(!Oe||Oe&&Oe.state&Qa)&&(Oe=gt.curRecognizer=null);for(var ar=0;ar<pe.length;)$t=pe[ar],gt.stopped!==Kl&&(!Oe||$t==Oe||$t.canRecognizeWith(Oe))?$t.recognize(ut):$t.reset(),!Oe&&$t.state&(to|_h|Hi)&&(Oe=gt.curRecognizer=$t),ar++}},get:function(ut){if(ut instanceof _s)return ut;for(var gt=this.recognizers,$t=0;$t<gt.length;$t++)if(gt[$t].options.event==ut)return gt[$t];return null},add:function(ut){if(E(ut,"add",this))return this;var gt=this.get(ut.options.event);return gt&&this.remove(gt),this.recognizers.push(ut),ut.manager=this,this.touchAction.update(),ut},remove:function(ut){if(E(ut,"remove",this))return this;if(ut=this.get(ut),ut){var gt=this.recognizers,$t=Et(gt,ut);$t!==-1&&(gt.splice($t,1),this.touchAction.update())}return this},on:function(ut,gt){if(ut!==i&&gt!==i){var $t=this.handlers;return T(kt(ut),function(pe){$t[pe]=$t[pe]||[],$t[pe].push(gt)}),this}},off:function(ut,gt){if(ut!==i){var $t=this.handlers;return T(kt(ut),function(pe){gt?$t[pe]&&$t[pe].splice(Et($t[pe],gt),1):delete $t[pe]}),this}},emit:function(ut,gt){this.options.domEvents&&Gp(ut,gt);var $t=this.handlers[ut]&&this.handlers[ut].slice();if(!(!$t||!$t.length)){gt.type=ut,gt.preventDefault=function(){gt.srcEvent.preventDefault()};for(var pe=0;pe<$t.length;)$t[pe](gt),pe++}},destroy:function(){this.element&&Zp(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function Zp(ut,gt){var $t=ut.element;if($t.style){var pe;T(ut.options.cssProps,function(Oe,ar){pe=Xt($t.style,ar),gt?(ut.oldCssProps[pe]=$t.style[pe],$t.style[pe]=Oe):$t.style[pe]=ut.oldCssProps[pe]||""}),gt||(ut.oldCssProps={})}}function Gp(ut,gt){var $t=t.createEvent("Event");$t.initEvent(ut,!0,!0),$t.gesture=gt,gt.target.dispatchEvent($t)}N(Cs,{INPUT_START:Gr,INPUT_MOVE:Fr,INPUT_END:Dr,INPUT_CANCEL:Le,STATE_POSSIBLE:Zl,STATE_BEGAN:to,STATE_CHANGED:_h,STATE_ENDED:Hi,STATE_RECOGNIZED:Qa,STATE_CANCELLED:Dc,STATE_FAILED:$n,DIRECTION_NONE:Tr,DIRECTION_LEFT:jr,DIRECTION_RIGHT:Ie,DIRECTION_UP:Ji,DIRECTION_DOWN:yi,DIRECTION_HORIZONTAL:tn,DIRECTION_VERTICAL:hn,DIRECTION_ALL:Sr,Manager:Xp,Input:on,TouchAction:Os,TouchInput:Lt,MouseInput:Br,PointerEventInput:It,TouchMouseInput:be,SingleTouchInput:Rt,Recognizer:_s,AttrRecognizer:ko,Tap:du,Pan:Gl,Swipe:Hn,Pinch:Fn,Rotate:Ql,Press:Ki,on:st,off:at,each:T,merge:U,extend:z,assign:N,inherit:H,bindFn:G,prefixed:Xt});var Qp=typeof e<"u"?e:typeof self<"u"?self:{};Qp.Hammer=Cs,typeof define=="function"&&define.amd?define(function(){return Cs}):typeof CS<"u"&&CS.exports?CS.exports=Cs:e[r]=Cs})(window,document,"Hammer")});var ZH=AP((j$t,U7)=>{"use strict";U7.exports=YS;U7.exports.default=YS;function YS(e,t,r){r=r||2;var i=t&&t.length,s=i?t[0]*r:e.length,n=qH(e,0,s,r,!0),o=[];if(!n||n.next===n.prev)return o;var c,f,p,x,E,T,D;if(i&&(n=u1t(e,t,n,r)),e.length>80*r){c=p=e[0],f=x=e[1];for(var N=r;N<s;N+=r)E=e[N],T=e[N+1],E<c&&(c=E),T<f&&(f=T),E>p&&(p=E),T>x&&(x=T);D=Math.max(p-c,x-f),D=D!==0?32767/D:0}return Aw(n,o,r,c,f,D,0),o}function qH(e,t,r,i,s){var n,o;if(s===z7(e,t,r,i)>0)for(n=t;n<r;n+=i)o=WH(n,e[n],e[n+1],o);else for(n=r-i;n>=t;n-=i)o=WH(n,e[n],e[n+1],o);return o&&XS(o,o.next)&&(gw(o),o=o.next),o}function Hg(e,t){if(!e)return e;t||(t=e);var r=e,i;do if(i=!1,!r.steiner&&(XS(r,r.next)||Zs(r.prev,r,r.next)===0)){if(gw(r),r=t=r.prev,r===r.next)break;i=!0}else r=r.next;while(i||r!==t);return t}function Aw(e,t,r,i,s,n,o){if(e){!o&&n&&A1t(e,i,s,n);for(var c=e,f,p;e.prev!==e.next;){if(f=e.prev,p=e.next,n?a1t(e,i,s,n):o1t(e)){t.push(f.i/r|0),t.push(e.i/r|0),t.push(p.i/r|0),gw(e),e=p.next,c=p.next;continue}if(e=p,e===c){o?o===1?(e=l1t(Hg(e),t,r),Aw(e,t,r,i,s,n,2)):o===2&&c1t(e,t,r,i,s,n):Aw(Hg(e),t,r,i,s,n,1);break}}}}function o1t(e){var t=e.prev,r=e,i=e.next;if(Zs(t,r,i)>=0)return!1;for(var s=t.x,n=r.x,o=i.x,c=t.y,f=r.y,p=i.y,x=s<n?s<o?s:o:n<o?n:o,E=c<f?c<p?c:p:f<p?f:p,T=s>n?s>o?s:o:n>o?n:o,D=c>f?c>p?c:p:f>p?f:p,N=i.next;N!==t;){if(N.x>=x&&N.x<=T&&N.y>=E&&N.y<=D&&jy(s,c,n,f,o,p,N.x,N.y)&&Zs(N.prev,N,N.next)>=0)return!1;N=N.next}return!0}function a1t(e,t,r,i){var s=e.prev,n=e,o=e.next;if(Zs(s,n,o)>=0)return!1;for(var c=s.x,f=n.x,p=o.x,x=s.y,E=n.y,T=o.y,D=c<f?c<p?c:p:f<p?f:p,N=x<E?x<T?x:T:E<T?E:T,z=c>f?c>p?c:p:f>p?f:p,U=x>E?x>T?x:T:E>T?E:T,H=F7(D,N,t,r,i),G=F7(z,U,t,r,i),Z=e.prevZ,Y=e.nextZ;Z&&Z.z>=H&&Y&&Y.z<=G;){if(Z.x>=D&&Z.x<=z&&Z.y>=N&&Z.y<=U&&Z!==s&&Z!==o&&jy(c,x,f,E,p,T,Z.x,Z.y)&&Zs(Z.prev,Z,Z.next)>=0||(Z=Z.prevZ,Y.x>=D&&Y.x<=z&&Y.y>=N&&Y.y<=U&&Y!==s&&Y!==o&&jy(c,x,f,E,p,T,Y.x,Y.y)&&Zs(Y.prev,Y,Y.next)>=0))return!1;Y=Y.nextZ}for(;Z&&Z.z>=H;){if(Z.x>=D&&Z.x<=z&&Z.y>=N&&Z.y<=U&&Z!==s&&Z!==o&&jy(c,x,f,E,p,T,Z.x,Z.y)&&Zs(Z.prev,Z,Z.next)>=0)return!1;Z=Z.prevZ}for(;Y&&Y.z<=G;){if(Y.x>=D&&Y.x<=z&&Y.y>=N&&Y.y<=U&&Y!==s&&Y!==o&&jy(c,x,f,E,p,T,Y.x,Y.y)&&Zs(Y.prev,Y,Y.next)>=0)return!1;Y=Y.nextZ}return!0}function l1t(e,t,r){var i=e;do{var s=i.prev,n=i.next.next;!XS(s,n)&&YH(s,i,i.next,n)&&mw(s,n)&&mw(n,s)&&(t.push(s.i/r|0),t.push(i.i/r|0),t.push(n.i/r|0),gw(i),gw(i.next),i=e=n),i=i.next}while(i!==e);return Hg(i)}function c1t(e,t,r,i,s,n){var o=e;do{for(var c=o.next.next;c!==o.prev;){if(o.i!==c.i&&_1t(o,c)){var f=XH(o,c);o=Hg(o,o.next),f=Hg(f,f.next),Aw(o,t,r,i,s,n,0),Aw(f,t,r,i,s,n,0);return}c=c.next}o=o.next}while(o!==e)}function u1t(e,t,r,i){var s=[],n,o,c,f,p;for(n=0,o=t.length;n<o;n++)c=t[n]*i,f=n<o-1?t[n+1]*i:e.length,p=qH(e,c,f,i,!1),p===p.next&&(p.steiner=!0),s.push(g1t(p));for(s.sort(h1t),n=0;n<s.length;n++)r=f1t(s[n],r);return r}function h1t(e,t){return e.x-t.x}function f1t(e,t){var r=p1t(e,t);if(!r)return t;var i=XH(r,e);return Hg(i,i.next),Hg(r,r.next)}function p1t(e,t){var r=t,i=e.x,s=e.y,n=-1/0,o;do{if(s<=r.y&&s>=r.next.y&&r.next.y!==r.y){var c=r.x+(s-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(c<=i&&c>n&&(n=c,o=r.x<r.next.x?r:r.next,c===i))return o}r=r.next}while(r!==t);if(!o)return null;var f=o,p=o.x,x=o.y,E=1/0,T;r=o;do i>=r.x&&r.x>=p&&i!==r.x&&jy(s<x?i:n,s,p,x,s<x?n:i,s,r.x,r.y)&&(T=Math.abs(s-r.y)/(i-r.x),mw(r,e)&&(T<E||T===E&&(r.x>o.x||r.x===o.x&&d1t(o,r)))&&(o=r,E=T)),r=r.next;while(r!==f);return o}function d1t(e,t){return Zs(e.prev,e,t.prev)<0&&Zs(t.next,e,e.next)<0}function A1t(e,t,r,i){var s=e;do s.z===0&&(s.z=F7(s.x,s.y,t,r,i)),s.prevZ=s.prev,s.nextZ=s.next,s=s.next;while(s!==e);s.prevZ.nextZ=null,s.prevZ=null,m1t(s)}function m1t(e){var t,r,i,s,n,o,c,f,p=1;do{for(r=e,e=null,n=null,o=0;r;){for(o++,i=r,c=0,t=0;t<p&&(c++,i=i.nextZ,!!i);t++);for(f=p;c>0||f>0&&i;)c!==0&&(f===0||!i||r.z<=i.z)?(s=r,r=r.nextZ,c--):(s=i,i=i.nextZ,f--),n?n.nextZ=s:e=s,s.prevZ=n,n=s;r=i}n.nextZ=null,p*=2}while(o>1);return e}function F7(e,t,r,i,s){return e=(e-r)*s|0,t=(t-i)*s|0,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e|t<<1}function g1t(e){var t=e,r=e;do(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next;while(t!==e);return r}function jy(e,t,r,i,s,n,o,c){return(s-o)*(t-c)>=(e-o)*(n-c)&&(e-o)*(i-c)>=(r-o)*(t-c)&&(r-o)*(n-c)>=(s-o)*(i-c)}function _1t(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!y1t(e,t)&&(mw(e,t)&&mw(t,e)&&x1t(e,t)&&(Zs(e.prev,e,t.prev)||Zs(e,t.prev,t))||XS(e,t)&&Zs(e.prev,e,e.next)>0&&Zs(t.prev,t,t.next)>0)}function Zs(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function XS(e,t){return e.x===t.x&&e.y===t.y}function YH(e,t,r,i){var s=qS(Zs(e,t,r)),n=qS(Zs(e,t,i)),o=qS(Zs(r,i,e)),c=qS(Zs(r,i,t));return!!(s!==n&&o!==c||s===0&&WS(e,r,t)||n===0&&WS(e,i,t)||o===0&&WS(r,e,i)||c===0&&WS(r,t,i))}function WS(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function qS(e){return e>0?1:e<0?-1:0}function y1t(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&YH(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}function mw(e,t){return Zs(e.prev,e,e.next)<0?Zs(e,t,e.next)>=0&&Zs(e,e.prev,t)>=0:Zs(e,t,e.prev)<0||Zs(e,e.next,t)<0}function x1t(e,t){var r=e,i=!1,s=(e.x+t.x)/2,n=(e.y+t.y)/2;do r.y>n!=r.next.y>n&&r.next.y!==r.y&&s<(r.next.x-r.x)*(n-r.y)/(r.next.y-r.y)+r.x&&(i=!i),r=r.next;while(r!==e);return i}function XH(e,t){var r=new L7(e.i,e.x,e.y),i=new L7(t.i,t.x,t.y),s=e.next,n=t.prev;return e.next=t,t.prev=e,r.next=s,s.prev=r,i.next=r,r.prev=i,n.next=i,i.prev=n,i}function WH(e,t,r,i){var s=new L7(e,t,r);return i?(s.next=i.next,s.prev=i,i.next.prev=s,i.next=s):(s.prev=s,s.next=s),s}function gw(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function L7(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}YS.deviation=function(e,t,r,i){var s=t&&t.length,n=s?t[0]*r:e.length,o=Math.abs(z7(e,0,n,r));if(s)for(var c=0,f=t.length;c<f;c++){var p=t[c]*r,x=c<f-1?t[c+1]*r:e.length;o-=Math.abs(z7(e,p,x,r))}var E=0;for(c=0;c<i.length;c+=3){var T=i[c]*r,D=i[c+1]*r,N=i[c+2]*r;E+=Math.abs((e[T]-e[N])*(e[D+1]-e[T+1])-(e[T]-e[D])*(e[N+1]-e[T+1]))}return o===0&&E===0?0:Math.abs((E-o)/o)};function z7(e,t,r,i){for(var s=0,n=t,o=r-i;n<r;n+=i)s+=(e[o]-e[n])*(e[n+1]+e[o+1]),o=n;return s}YS.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},i=0,s=0;s<e.length;s++){for(var n=0;n<e[s].length;n++)for(var o=0;o<t;o++)r.vertices.push(e[s][n][o]);s>0&&(i+=e[s-1].length,r.holes.push(i))}return r}});var qW=AP((eD,rD)=>{(function(e,t){typeof eD=="object"&&typeof rD<"u"?rD.exports=t():typeof define=="function"&&define.amd?define(t):(e=typeof globalThis<"u"?globalThis:e||self,e.maplibregl=t())})(eD,function(){"use strict";var e,t,r;function i(n,o){if(!e)e=o;else if(!t)t=o;else{var c="var sharedChunk = {}; ("+e+")(sharedChunk); ("+t+")(sharedChunk);",f={};e(f),r=o(f),typeof window<"u"&&(r.workerUrl=window.URL.createObjectURL(new Blob([c],{type:"text/javascript"})))}}i(["exports"],function(n){"use strict";function o(u,a,h,y){return new(h||(h=Promise))(function(w,R){function k(q){try{j(y.next(q))}catch(K){R(K)}}function F(q){try{j(y.throw(q))}catch(K){R(K)}}function j(q){var K;q.done?w(q.value):(K=q.value,K instanceof h?K:new h(function(et){et(K)})).then(k,F)}j((y=y.apply(u,a||[])).next())})}function c(u){return u&&u.__esModule&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u}typeof SuppressedError=="function"&&SuppressedError;var f=p;function p(u,a){this.x=u,this.y=a}p.prototype={clone:function(){return new p(this.x,this.y)},add:function(u){return this.clone()._add(u)},sub:function(u){return this.clone()._sub(u)},multByPoint:function(u){return this.clone()._multByPoint(u)},divByPoint:function(u){return this.clone()._divByPoint(u)},mult:function(u){return this.clone()._mult(u)},div:function(u){return this.clone()._div(u)},rotate:function(u){return this.clone()._rotate(u)},rotateAround:function(u,a){return this.clone()._rotateAround(u,a)},matMult:function(u){return this.clone()._matMult(u)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(u){return this.x===u.x&&this.y===u.y},dist:function(u){return Math.sqrt(this.distSqr(u))},distSqr:function(u){var a=u.x-this.x,h=u.y-this.y;return a*a+h*h},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(u){return Math.atan2(this.y-u.y,this.x-u.x)},angleWith:function(u){return this.angleWithSep(u.x,u.y)},angleWithSep:function(u,a){return Math.atan2(this.x*a-this.y*u,this.x*u+this.y*a)},_matMult:function(u){var a=u[2]*this.x+u[3]*this.y;return this.x=u[0]*this.x+u[1]*this.y,this.y=a,this},_add:function(u){return this.x+=u.x,this.y+=u.y,this},_sub:function(u){return this.x-=u.x,this.y-=u.y,this},_mult:function(u){return this.x*=u,this.y*=u,this},_div:function(u){return this.x/=u,this.y/=u,this},_multByPoint:function(u){return this.x*=u.x,this.y*=u.y,this},_divByPoint:function(u){return this.x/=u.x,this.y/=u.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var u=this.y;return this.y=this.x,this.x=-u,this},_rotate:function(u){var a=Math.cos(u),h=Math.sin(u),y=h*this.x+a*this.y;return this.x=a*this.x-h*this.y,this.y=y,this},_rotateAround:function(u,a){var h=Math.cos(u),y=Math.sin(u),w=a.y+y*(this.x-a.x)+h*(this.y-a.y);return this.x=a.x+h*(this.x-a.x)-y*(this.y-a.y),this.y=w,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},p.convert=function(u){return u instanceof p?u:Array.isArray(u)?new p(u[0],u[1]):u};var x=c(f),E=T;function T(u,a,h,y){this.cx=3*u,this.bx=3*(h-u)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*a,this.by=3*(y-a)-this.cy,this.ay=1-this.cy-this.by,this.p1x=u,this.p1y=a,this.p2x=h,this.p2y=y}T.prototype={sampleCurveX:function(u){return((this.ax*u+this.bx)*u+this.cx)*u},sampleCurveY:function(u){return((this.ay*u+this.by)*u+this.cy)*u},sampleCurveDerivativeX:function(u){return(3*this.ax*u+2*this.bx)*u+this.cx},solveCurveX:function(u,a){if(a===void 0&&(a=1e-6),u<0)return 0;if(u>1)return 1;for(var h=u,y=0;y<8;y++){var w=this.sampleCurveX(h)-u;if(Math.abs(w)<a)return h;var R=this.sampleCurveDerivativeX(h);if(Math.abs(R)<1e-6)break;h-=w/R}var k=0,F=1;for(h=u,y=0;y<20&&(w=this.sampleCurveX(h),!(Math.abs(w-u)<a));y++)u>w?k=h:F=h,h=.5*(F-k)+k;return h},solve:function(u,a){return this.sampleCurveY(this.solveCurveX(u,a))}};var D=c(E);let N,z;function U(){return N==null&&(N=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),N}function H(){if(z==null&&(z=!1,U())){let a=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(a){for(let y=0;y<5*5;y++){let w=4*y;a.fillStyle=`rgb(${w},${w+1},${w+2})`,a.fillRect(y%5,Math.floor(y/5),1,1)}let h=a.getImageData(0,0,5,5).data;for(let y=0;y<5*5*4;y++)if(y%4!=3&&h[y]!==y){z=!0;break}}}return z||!1}function G(u,a,h,y){let w=new D(u,a,h,y);return function(R){return w.solve(R)}}let Z=G(.25,.1,.25,1);function Y(u,a,h){return Math.min(h,Math.max(a,u))}function st(u,a,h){let y=h-a,w=((u-a)%y+y)%y+a;return w===a?h:w}function at(u,...a){for(let h of a)for(let y in h)u[y]=h[y];return u}let Dt=1;function Tt(u,a,h){let y={};for(let w in u)y[w]=a.call(h||this,u[w],w,u);return y}function kt(u,a,h){let y={};for(let w in u)a.call(h||this,u[w],w,u)&&(y[w]=u[w]);return y}function Et(u){return Array.isArray(u)?u.map(Et):typeof u=="object"&&u?Tt(u,Et):u}let Mt={};function oe(u){Mt[u]||(typeof console<"u"&&console.warn(u),Mt[u]=!0)}function Xt(u,a,h){return(h.y-u.y)*(a.x-u.x)>(a.y-u.y)*(h.x-u.x)}function xt(u){let a=0;for(let h,y,w=0,R=u.length,k=R-1;w<R;k=w++)h=u[w],y=u[k],a+=(y.x-h.x)*(h.y+y.y);return a}function jt(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}let Wt=null;function de(u){return typeof ImageBitmap<"u"&&u instanceof ImageBitmap}let Ee="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Se(u,a,h,y,w){return o(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");let R=new VideoFrame(u,{timestamp:0});try{let k=R?.format;if(!k||!k.startsWith("BGR")&&!k.startsWith("RGB"))throw new Error(`Unrecognized format ${k}`);let F=k.startsWith("BGR"),j=new Uint8ClampedArray(y*w*4);if(yield R.copyTo(j,function(q,K,et,it,ct){let ht=4*Math.max(-K,0),vt=(Math.max(0,et)-et)*it*4+ht,Nt=4*it,Ut=Math.max(0,K),Kt=Math.max(0,et);return{rect:{x:Ut,y:Kt,width:Math.min(q.width,K+it)-Ut,height:Math.min(q.height,et+ct)-Kt},layout:[{offset:vt,stride:Nt}]}}(u,a,h,y,w)),F)for(let q=0;q<j.length;q+=4){let K=j[q];j[q]=j[q+2],j[q+2]=K}return j}finally{R.close()}})}let ze,ke,ir,Ti,_i={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(u){let a=requestAnimationFrame(u);return{cancel:()=>cancelAnimationFrame(a)}},getImageData(u,a=0){return this.getImageCanvasContext(u).getImageData(-a,-a,u.width+2*a,u.height+2*a)},getImageCanvasContext(u){let a=window.document.createElement("canvas"),h=a.getContext("2d",{willReadFrequently:!0});if(!h)throw new Error("failed to create canvas 2d context");return a.width=u.width,a.height=u.height,h.drawImage(u,0,0,u.width,u.height),h},resolveURL:u=>(ir||(ir=document.createElement("a")),ir.href=u,ir.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(Ti==null&&(Ti=matchMedia("(prefers-reduced-motion: reduce)")),Ti.matches)}},ci={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};class Gr extends Error{constructor(a,h,y,w){super(`AJAXError: ${h} (${a}): ${y}`),this.status=a,this.statusText=h,this.url=y,this.body=w}}let Fr=jt()?()=>self.worker&&self.worker.referrer:()=>(window.location.protocol==="blob:"?window.parent:window).location.href,Dr=u=>ci.REGISTERED_PROTOCOLS[u.substring(0,u.indexOf("://"))];function Le(u,a){let h=new AbortController,y=new Request(u.url,{method:u.method||"GET",body:u.body,credentials:u.credentials,headers:u.headers,cache:u.cache,referrer:Fr(),signal:h.signal}),w=!1,R=!1;return u.type==="json"&&y.headers.set("Accept","application/json"),R||fetch(y).then(k=>k.ok?(F=>{(u.type==="arrayBuffer"||u.type==="image"?F.arrayBuffer():u.type==="json"?F.json():F.text()).then(j=>{R||(w=!0,a(null,j,F.headers.get("Cache-Control"),F.headers.get("Expires")))}).catch(j=>{R||a(new Error(j.message))})})(k):k.blob().then(F=>a(new Gr(k.status,k.statusText,u.url,F)))).catch(k=>{k.code!==20&&a(new Error(k.message))}),{cancel:()=>{R=!0,w||h.abort()}}}let Tr=function(u,a){if(/:\/\//.test(u.url)&&!/^https?:|^file:/.test(u.url)){if(jt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",u,a);if(!jt())return(Dr(u.url)||Le)(u,a)}if(!(/^file:/.test(h=u.url)||/^file:/.test(Fr())&&!/^\w+:/.test(h))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return Le(u,a);if(jt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",u,a,void 0,!0)}var h;return function(y,w){let R=new XMLHttpRequest;R.open(y.method||"GET",y.url,!0),y.type!=="arrayBuffer"&&y.type!=="image"||(R.responseType="arraybuffer");for(let k in y.headers)R.setRequestHeader(k,y.headers[k]);return y.type==="json"&&(R.responseType="text",R.setRequestHeader("Accept","application/json")),R.withCredentials=y.credentials==="include",R.onerror=()=>{w(new Error(R.statusText))},R.onload=()=>{if((R.status>=200&&R.status<300||R.status===0)&&R.response!==null){let k=R.response;if(y.type==="json")try{k=JSON.parse(R.response)}catch(F){return w(F)}w(null,k,R.getResponseHeader("Cache-Control"),R.getResponseHeader("Expires"))}else{let k=new Blob([R.response],{type:R.getResponseHeader("Content-Type")});w(new Gr(R.status,R.statusText,y.url,k))}},R.send(y.body),{cancel:()=>R.abort()}}(u,a)},jr=function(u,a){return Tr(at(u,{type:"arrayBuffer"}),a)};function Ie(u){if(!u||u.indexOf("://")<=0||u.indexOf("data:image/")===0||u.indexOf("blob:")===0)return!0;let a=new URL(u),h=window.location;return a.protocol===h.protocol&&a.host===h.host}function Ji(u,a,h){h[u]&&h[u].indexOf(a)!==-1||(h[u]=h[u]||[],h[u].push(a))}function yi(u,a,h){if(h&&h[u]){let y=h[u].indexOf(a);y!==-1&&h[u].splice(y,1)}}class tn{constructor(a,h={}){at(this,h),this.type=a}}class hn extends tn{constructor(a,h={}){super("error",at({error:a},h))}}class Sr{on(a,h){return this._listeners=this._listeners||{},Ji(a,h,this._listeners),this}off(a,h){return yi(a,h,this._listeners),yi(a,h,this._oneTimeListeners),this}once(a,h){return h?(this._oneTimeListeners=this._oneTimeListeners||{},Ji(a,h,this._oneTimeListeners),this):new Promise(y=>this.once(a,y))}fire(a,h){typeof a=="string"&&(a=new tn(a,h||{}));let y=a.type;if(this.listens(y)){a.target=this;let w=this._listeners&&this._listeners[y]?this._listeners[y].slice():[];for(let F of w)F.call(this,a);let R=this._oneTimeListeners&&this._oneTimeListeners[y]?this._oneTimeListeners[y].slice():[];for(let F of R)yi(y,F,this._oneTimeListeners),F.call(this,a);let k=this._eventedParent;k&&(at(a,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),k.fire(a))}else a instanceof hn&&console.error(a.error);return this}listens(a){return this._listeners&&this._listeners[a]&&this._listeners[a].length>0||this._oneTimeListeners&&this._oneTimeListeners[a]&&this._oneTimeListeners[a].length>0||this._eventedParent&&this._eventedParent.listens(a)}setEventedParent(a,h){return this._eventedParent=a,this._eventedParentData=h,this}}var ae={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};let Xn=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function on(u,a){let h={};for(let y in u)y!=="ref"&&(h[y]=u[y]);return Xn.forEach(y=>{y in a&&(h[y]=a[y])}),h}function Qi(u,a){if(Array.isArray(u)){if(!Array.isArray(a)||u.length!==a.length)return!1;for(let h=0;h<u.length;h++)if(!Qi(u[h],a[h]))return!1;return!0}if(typeof u=="object"&&u!==null&&a!==null){if(typeof a!="object"||Object.keys(u).length!==Object.keys(a).length)return!1;for(let h in u)if(!Qi(u[h],a[h]))return!1;return!0}return u===a}let $i={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function Ro(u,a,h){h.push({command:$i.addSource,args:[u,a[u]]})}function pu(u,a,h){a.push({command:$i.removeSource,args:[u]}),h[u]=!0}function bl(u,a,h,y){pu(u,h,y),Ro(u,a,h)}function Uo(u,a,h){let y;for(y in u[h])if(Object.prototype.hasOwnProperty.call(u[h],y)&&y!=="data"&&!Qi(u[h][y],a[h][y]))return!1;for(y in a[h])if(Object.prototype.hasOwnProperty.call(a[h],y)&&y!=="data"&&!Qi(u[h][y],a[h][y]))return!1;return!0}function vl(u,a,h,y,w,R){let k;for(k in a=a||{},u=u||{})Object.prototype.hasOwnProperty.call(u,k)&&(Qi(u[k],a[k])||h.push({command:R,args:[y,k,a[k],w]}));for(k in a)Object.prototype.hasOwnProperty.call(a,k)&&!Object.prototype.hasOwnProperty.call(u,k)&&(Qi(u[k],a[k])||h.push({command:R,args:[y,k,a[k],w]}))}function Xa(u){return u.id}function Vo(u,a){return u[a.id]=a,u}class Ne{constructor(a,h,y,w){this.message=(a?`${a}: `:"")+y,w&&(this.identifier=w),h!=null&&h.__line__&&(this.line=h.__line__)}}function ta(u,...a){for(let h of a)for(let y in h)u[y]=h[y];return u}class Zn extends Error{constructor(a,h){super(h),this.message=h,this.key=a}}class Xl{constructor(a,h=[]){this.parent=a,this.bindings={};for(let[y,w]of h)this.bindings[y]=w}concat(a){return new Xl(this,a)}get(a){if(this.bindings[a])return this.bindings[a];if(this.parent)return this.parent.get(a);throw new Error(`${a} not found in scope.`)}has(a){return!!this.bindings[a]||!!this.parent&&this.parent.has(a)}}let Za={kind:"null"},Ue={kind:"number"},ri={kind:"string"},Br={kind:"boolean"},Ao={kind:"color"},Ga={kind:"object"},Hr={kind:"value"},ba={kind:"collator"},It={kind:"formatted"},rt={kind:"padding"},ot={kind:"resolvedImage"},At={kind:"variableAnchorOffsetCollection"};function Rt(u,a){return{kind:"array",itemType:u,N:a}}function Bt(u){if(u.kind==="array"){let a=Bt(u.itemType);return typeof u.N=="number"?`array<${a}, ${u.N}>`:u.itemType.kind==="value"?"array":`array<${a}>`}return u.kind}let St=[Za,Ue,ri,Br,Ao,It,Ga,Rt(Hr),rt,ot,At];function qt(u,a){if(a.kind==="error")return null;if(u.kind==="array"){if(a.kind==="array"&&(a.N===0&&a.itemType.kind==="value"||!qt(u.itemType,a.itemType))&&(typeof u.N!="number"||u.N===a.N))return null}else{if(u.kind===a.kind)return null;if(u.kind==="value"){for(let h of St)if(!qt(h,a))return null}}return`Expected ${Bt(u)} but found ${Bt(a)} instead.`}function Lt(u,a){return a.some(h=>h.kind===u.kind)}function Qt(u,a){return a.some(h=>h==="null"?u===null:h==="array"?Array.isArray(u):h==="object"?u&&!Array.isArray(u)&&typeof u=="object":h===typeof u)}function _e(u,a){return u.kind==="array"&&a.kind==="array"?u.itemType.kind===a.itemType.kind&&typeof u.N=="number":u.kind===a.kind}let ye=.96422,be=.82521,xr=4/29,Or=6/29,lr=3*Or*Or,br=Or*Or*Or,Ur=Math.PI/180,an=180/Math.PI;function gn(u){return(u%=360)<0&&(u+=360),u}function Ui([u,a,h,y]){let w,R,k=Is((.2225045*(u=di(u))+.7168786*(a=di(a))+.0606169*(h=di(h)))/1);u===a&&a===h?w=R=k:(w=Is((.4360747*u+.3850649*a+.1430804*h)/ye),R=Is((.0139322*u+.0971045*a+.7141733*h)/be));let F=116*k-16;return[F<0?0:F,500*(w-k),200*(k-R),y]}function di(u){return u<=.04045?u/12.92:Math.pow((u+.055)/1.055,2.4)}function Is(u){return u>br?Math.pow(u,1/3):u/lr+xr}function fn([u,a,h,y]){let w=(u+16)/116,R=isNaN(a)?w:w+a/500,k=isNaN(h)?w:w-h/200;return w=1*Os(w),R=ye*Os(R),k=be*Os(k),[rs(3.1338561*R-1.6168667*w-.4906146*k),rs(-.9787684*R+1.9161415*w+.033454*k),rs(.0719453*R-.2289914*w+1.4052427*k),y]}function rs(u){return(u=u<=.00304?12.92*u:1.055*Math.pow(u,1/2.4)-.055)<0?0:u>1?1:u}function Os(u){return u>Or?u*u*u:lr*(u-xr)}function va(u){return parseInt(u.padEnd(2,u),16)/255}function Pm(u,a){return Zl(a?u/100:u,0,1)}function Zl(u,a,h){return Math.min(Math.max(a,u),h)}function to(u){return!u.some(Number.isNaN)}let _h={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class Hi{constructor(a,h,y,w=1,R=!0){this.r=a,this.g=h,this.b=y,this.a=w,R||(this.r*=w,this.g*=w,this.b*=w,w||this.overwriteGetter("rgb",[a,h,y,w]))}static parse(a){if(a instanceof Hi)return a;if(typeof a!="string")return;let h=function(y){if((y=y.toLowerCase().trim())==="transparent")return[0,0,0,0];let w=_h[y];if(w){let[k,F,j]=w;return[k/255,F/255,j/255,1]}if(y.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(y)){let k=y.length<6?1:2,F=1;return[va(y.slice(F,F+=k)),va(y.slice(F,F+=k)),va(y.slice(F,F+=k)),va(y.slice(F,F+k)||"ff")]}if(y.startsWith("rgb")){let k=y.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(k){let[F,j,q,K,et,it,ct,ht,vt,Nt,Ut,Kt]=k,Ht=[K||" ",ct||" ",Nt].join("");if(Ht==="  "||Ht==="  /"||Ht===",,"||Ht===",,,"){let Jt=[q,it,vt].join(""),le=Jt==="%%%"?100:Jt===""?255:0;if(le){let ve=[Zl(+j/le,0,1),Zl(+et/le,0,1),Zl(+ht/le,0,1),Ut?Pm(+Ut,Kt):1];if(to(ve))return ve}}return}}let R=y.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(R){let[k,F,j,q,K,et,it,ct,ht]=R,vt=[j||" ",K||" ",it].join("");if(vt==="  "||vt==="  /"||vt===",,"||vt===",,,"){let Nt=[+F,Zl(+q,0,100),Zl(+et,0,100),ct?Pm(+ct,ht):1];if(to(Nt))return function([Ut,Kt,Ht,Jt]){function le(ve){let Ke=(ve+Ut/30)%12,dr=Kt*Math.min(Ht,1-Ht);return Ht-dr*Math.max(-1,Math.min(Ke-3,9-Ke,1))}return Ut=gn(Ut),Kt/=100,Ht/=100,[le(0),le(8),le(4),Jt]}(Nt)}}}(a);return h?new Hi(...h,!1):void 0}get rgb(){let{r:a,g:h,b:y,a:w}=this,R=w||1/0;return this.overwriteGetter("rgb",[a/R,h/R,y/R,w])}get hcl(){return this.overwriteGetter("hcl",function(a){let[h,y,w,R]=Ui(a),k=Math.sqrt(y*y+w*w);return[Math.round(1e4*k)?gn(Math.atan2(w,y)*an):NaN,k,h,R]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Ui(this.rgb))}overwriteGetter(a,h){return Object.defineProperty(this,a,{value:h}),h}toString(){let[a,h,y,w]=this.rgb;return`rgba(${[a,h,y].map(R=>Math.round(255*R)).join(",")},${w})`}}Hi.black=new Hi(0,0,0,1),Hi.white=new Hi(1,1,1,1),Hi.transparent=new Hi(0,0,0,0),Hi.red=new Hi(1,0,0,1);class Qa{constructor(a,h,y){this.sensitivity=a?h?"variant":"case":h?"accent":"base",this.locale=y,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(a,h){return this.collator.compare(a,h)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Dc{constructor(a,h,y,w,R){this.text=a,this.image=h,this.scale=y,this.fontStack=w,this.textColor=R}}class $n{constructor(a){this.sections=a}static fromString(a){return new $n([new Dc(a,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(a=>a.text.length!==0||a.image&&a.image.name.length!==0)}static factory(a){return a instanceof $n?a:$n.fromString(a)}toString(){return this.sections.length===0?"":this.sections.map(a=>a.text).join("")}}class _s{constructor(a){this.values=a.slice()}static parse(a){if(a instanceof _s)return a;if(typeof a=="number")return new _s([a,a,a,a]);if(Array.isArray(a)&&!(a.length<1||a.length>4)){for(let h of a)if(typeof h!="number")return;switch(a.length){case 1:a=[a[0],a[0],a[0],a[0]];break;case 2:a=[a[0],a[1],a[0],a[1]];break;case 3:a=[a[0],a[1],a[2],a[1]]}return new _s(a)}}toString(){return JSON.stringify(this.values)}}let Rm=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class ea{constructor(a){this.values=a.slice()}static parse(a){if(a instanceof ea)return a;if(Array.isArray(a)&&!(a.length<1)&&a.length%2==0){for(let h=0;h<a.length;h+=2){let y=a[h],w=a[h+1];if(typeof y!="string"||!Rm.has(y)||!Array.isArray(w)||w.length!==2||typeof w[0]!="number"||typeof w[1]!="number")return}return new ea(a)}}toString(){return JSON.stringify(this.values)}}class Ms{constructor(a){this.name=a.name,this.available=a.available}toString(){return this.name}static fromString(a){return a?new Ms({name:a,available:!1}):null}}function ko(u,a,h,y){return typeof u=="number"&&u>=0&&u<=255&&typeof a=="number"&&a>=0&&a<=255&&typeof h=="number"&&h>=0&&h<=255?y===void 0||typeof y=="number"&&y>=0&&y<=1?null:`Invalid rgba value [${[u,a,h,y].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof y=="number"?[u,a,h,y]:[u,a,h]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Gl(u){if(u===null||typeof u=="string"||typeof u=="boolean"||typeof u=="number"||u instanceof Hi||u instanceof Qa||u instanceof $n||u instanceof _s||u instanceof ea||u instanceof Ms)return!0;if(Array.isArray(u)){for(let a of u)if(!Gl(a))return!1;return!0}if(typeof u=="object"){for(let a in u)if(!Gl(u[a]))return!1;return!0}return!1}function Fn(u){if(u===null)return Za;if(typeof u=="string")return ri;if(typeof u=="boolean")return Br;if(typeof u=="number")return Ue;if(u instanceof Hi)return Ao;if(u instanceof Qa)return ba;if(u instanceof $n)return It;if(u instanceof _s)return rt;if(u instanceof ea)return At;if(u instanceof Ms)return ot;if(Array.isArray(u)){let a=u.length,h;for(let y of u){let w=Fn(y);if(h){if(h===w)continue;h=Hr;break}h=w}return Rt(h||Hr,a)}return Ga}function Ki(u){let a=typeof u;return u===null?"":a==="string"||a==="number"||a==="boolean"?String(u):u instanceof Hi||u instanceof $n||u instanceof _s||u instanceof ea||u instanceof Ms?u.toString():JSON.stringify(u)}class Ql{constructor(a,h){this.type=a,this.value=h}static parse(a,h){if(a.length!==2)return h.error(`'literal' expression requires exactly one argument, but found ${a.length-1} instead.`);if(!Gl(a[1]))return h.error("invalid value");let y=a[1],w=Fn(y),R=h.expectedType;return w.kind!=="array"||w.N!==0||!R||R.kind!=="array"||typeof R.N=="number"&&R.N!==0||(w=R),new Ql(w,y)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class Hn{constructor(a){this.name="ExpressionEvaluationError",this.message=a}toJSON(){return this.message}}let du={string:ri,number:Ue,boolean:Br,object:Ga};class Cs{constructor(a,h){this.type=a,this.args=h}static parse(a,h){if(a.length<2)return h.error("Expected at least one argument.");let y,w=1,R=a[0];if(R==="array"){let F,j;if(a.length>2){let q=a[1];if(typeof q!="string"||!(q in du)||q==="object")return h.error('The item type argument of "array" must be one of string, number, boolean',1);F=du[q],w++}else F=Hr;if(a.length>3){if(a[2]!==null&&(typeof a[2]!="number"||a[2]<0||a[2]!==Math.floor(a[2])))return h.error('The length argument to "array" must be a positive integer literal',2);j=a[2],w++}y=Rt(F,j)}else{if(!du[R])throw new Error(`Types doesn't contain name = ${R}`);y=du[R]}let k=[];for(;w<a.length;w++){let F=h.parse(a[w],w,Hr);if(!F)return null;k.push(F)}return new Cs(y,k)}evaluate(a){for(let h=0;h<this.args.length;h++){let y=this.args[h].evaluate(a);if(!qt(this.type,Fn(y)))return y;if(h===this.args.length-1)throw new Hn(`Expected value to be of type ${Bt(this.type)}, but found ${Bt(Fn(y))} instead.`)}throw new Error}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}}let B0={"to-boolean":Br,"to-color":Ao,"to-number":Ue,"to-string":ri};class Kl{constructor(a,h){this.type=a,this.args=h}static parse(a,h){if(a.length<2)return h.error("Expected at least one argument.");let y=a[0];if(!B0[y])throw new Error(`Can't parse ${y} as it is not part of the known types`);if((y==="to-boolean"||y==="to-string")&&a.length!==2)return h.error("Expected one argument.");let w=B0[y],R=[];for(let k=1;k<a.length;k++){let F=h.parse(a[k],k,Hr);if(!F)return null;R.push(F)}return new Kl(w,R)}evaluate(a){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(a);case"color":{let h,y;for(let w of this.args){if(h=w.evaluate(a),y=null,h instanceof Hi)return h;if(typeof h=="string"){let R=a.parseColor(h);if(R)return R}else if(Array.isArray(h)&&(y=h.length<3||h.length>4?`Invalid rbga value ${JSON.stringify(h)}: expected an array containing either three or four numeric values.`:ko(h[0],h[1],h[2],h[3]),!y))return new Hi(h[0]/255,h[1]/255,h[2]/255,h[3])}throw new Hn(y||`Could not parse color from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"padding":{let h;for(let y of this.args){h=y.evaluate(a);let w=_s.parse(h);if(w)return w}throw new Hn(`Could not parse padding from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"variableAnchorOffsetCollection":{let h;for(let y of this.args){h=y.evaluate(a);let w=ea.parse(h);if(w)return w}throw new Hn(`Could not parse variableAnchorOffsetCollection from value '${typeof h=="string"?h:JSON.stringify(h)}'`)}case"number":{let h=null;for(let y of this.args){if(h=y.evaluate(a),h===null)return 0;let w=Number(h);if(!isNaN(w))return w}throw new Hn(`Could not convert ${JSON.stringify(h)} to number.`)}case"formatted":return $n.fromString(Ki(this.args[0].evaluate(a)));case"resolvedImage":return Ms.fromString(Ki(this.args[0].evaluate(a)));default:return Ki(this.args[0].evaluate(a))}}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}}let Xp=["Unknown","Point","LineString","Polygon"];class Zp{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Xp[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(a){let h=this._parseColorCache[a];return h||(h=this._parseColorCache[a]=Hi.parse(a)),h}}class Gp{constructor(a,h,y=[],w,R=new Xl,k=[]){this.registry=a,this.path=y,this.key=y.map(F=>`[${F}]`).join(""),this.scope=R,this.errors=k,this.expectedType=w,this._isConstant=h}parse(a,h,y,w,R={}){return h?this.concat(h,y,w)._parse(a,R):this._parse(a,R)}_parse(a,h){function y(w,R,k){return k==="assert"?new Cs(R,[w]):k==="coerce"?new Kl(R,[w]):w}if(a!==null&&typeof a!="string"&&typeof a!="boolean"&&typeof a!="number"||(a=["literal",a]),Array.isArray(a)){if(a.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');let w=a[0];if(typeof w!="string")return this.error(`Expression name must be a string, but found ${typeof w} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;let R=this.registry[w];if(R){let k=R.parse(a,this);if(!k)return null;if(this.expectedType){let F=this.expectedType,j=k.type;if(F.kind!=="string"&&F.kind!=="number"&&F.kind!=="boolean"&&F.kind!=="object"&&F.kind!=="array"||j.kind!=="value")if(F.kind!=="color"&&F.kind!=="formatted"&&F.kind!=="resolvedImage"||j.kind!=="value"&&j.kind!=="string")if(F.kind!=="padding"||j.kind!=="value"&&j.kind!=="number"&&j.kind!=="array")if(F.kind!=="variableAnchorOffsetCollection"||j.kind!=="value"&&j.kind!=="array"){if(this.checkSubtype(F,j))return null}else k=y(k,F,h.typeAnnotation||"coerce");else k=y(k,F,h.typeAnnotation||"coerce");else k=y(k,F,h.typeAnnotation||"coerce");else k=y(k,F,h.typeAnnotation||"assert")}if(!(k instanceof Ql)&&k.type.kind!=="resolvedImage"&&this._isConstant(k)){let F=new Zp;try{k=new Ql(k.type,k.evaluate(F))}catch(j){return this.error(j.message),null}}return k}return this.error(`Unknown expression "${w}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(a===void 0?"'undefined' value invalid. Use null instead.":typeof a=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof a} instead.`)}concat(a,h,y){let w=typeof a=="number"?this.path.concat(a):this.path,R=y?this.scope.concat(y):this.scope;return new Gp(this.registry,this._isConstant,w,h||null,R,this.errors)}error(a,...h){let y=`${this.key}${h.map(w=>`[${w}]`).join("")}`;this.errors.push(new Zn(y,a))}checkSubtype(a,h){let y=qt(a,h);return y&&this.error(y),y}}class Qp{constructor(a,h,y){this.type=ba,this.locale=y,this.caseSensitive=a,this.diacriticSensitive=h}static parse(a,h){if(a.length!==2)return h.error("Expected one argument.");let y=a[1];if(typeof y!="object"||Array.isArray(y))return h.error("Collator options argument must be an object.");let w=h.parse(y["case-sensitive"]!==void 0&&y["case-sensitive"],1,Br);if(!w)return null;let R=h.parse(y["diacritic-sensitive"]!==void 0&&y["diacritic-sensitive"],1,Br);if(!R)return null;let k=null;return y.locale&&(k=h.parse(y.locale,1,ri),!k)?null:new Qp(w,R,k)}evaluate(a){return new Qa(this.caseSensitive.evaluate(a),this.diacriticSensitive.evaluate(a),this.locale?this.locale.evaluate(a):null)}eachChild(a){a(this.caseSensitive),a(this.diacriticSensitive),this.locale&&a(this.locale)}outputDefined(){return!1}}let ut=8192;function gt(u,a){u[0]=Math.min(u[0],a[0]),u[1]=Math.min(u[1],a[1]),u[2]=Math.max(u[2],a[0]),u[3]=Math.max(u[3],a[1])}function $t(u,a){return!(u[0]<=a[0]||u[2]>=a[2]||u[1]<=a[1]||u[3]>=a[3])}function pe(u,a){let h=(180+u[0])/360,y=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+u[1]*Math.PI/360)))/360,w=Math.pow(2,a.z);return[Math.round(h*w*ut),Math.round(y*w*ut)]}function Oe(u,a,h){let y=u[0]-a[0],w=u[1]-a[1],R=u[0]-h[0],k=u[1]-h[1];return y*k-R*w==0&&y*R<=0&&w*k<=0}function ar(u,a){let h=!1;for(let k=0,F=a.length;k<F;k++){let j=a[k];for(let q=0,K=j.length;q<K-1;q++){if(Oe(u,j[q],j[q+1]))return!1;(w=j[q])[1]>(y=u)[1]!=(R=j[q+1])[1]>y[1]&&y[0]<(R[0]-w[0])*(y[1]-w[1])/(R[1]-w[1])+w[0]&&(h=!h)}}var y,w,R;return h}function Ri(u,a){for(let h=0;h<a.length;h++)if(ar(u,a[h]))return!0;return!1}function Ns(u,a,h,y){let w=y[0]-h[0],R=y[1]-h[1],k=(u[0]-h[0])*R-w*(u[1]-h[1]),F=(a[0]-h[0])*R-w*(a[1]-h[1]);return k>0&&F<0||k<0&&F>0}function eo(u,a,h){for(let q of h)for(let K=0;K<q.length-1;++K)if((F=[(k=q[K+1])[0]-(R=q[K])[0],k[1]-R[1]])[0]*(j=[(w=a)[0]-(y=u)[0],w[1]-y[1]])[1]-F[1]*j[0]!=0&&Ns(y,w,R,k)&&Ns(R,k,y,w))return!0;var y,w,R,k,F,j;return!1}function mo(u,a){for(let h=0;h<u.length;++h)if(!ar(u[h],a))return!1;for(let h=0;h<u.length-1;++h)if(eo(u[h],u[h+1],a))return!1;return!0}function Ka(u,a){for(let h=0;h<a.length;h++)if(mo(u,a[h]))return!0;return!1}function km(u,a,h){let y=[];for(let w=0;w<u.length;w++){let R=[];for(let k=0;k<u[w].length;k++){let F=pe(u[w][k],h);gt(a,F),R.push(F)}y.push(R)}return y}function nb(u,a,h){let y=[];for(let w=0;w<u.length;w++){let R=km(u[w],a,h);y.push(R)}return y}function sb(u,a,h,y){if(u[0]<h[0]||u[0]>h[2]){let w=.5*y,R=u[0]-h[0]>w?-y:h[0]-u[0]>w?y:0;R===0&&(R=u[0]-h[2]>w?-y:h[2]-u[0]>w?y:0),u[0]+=R}gt(a,u)}function M_(u,a,h,y){let w=Math.pow(2,y.z)*ut,R=[y.x*ut,y.y*ut],k=[];for(let F of u)for(let j of F){let q=[j.x+R[0],j.y+R[1]];sb(q,a,h,w),k.push(q)}return k}function C_(u,a,h,y){let w=Math.pow(2,y.z)*ut,R=[y.x*ut,y.y*ut],k=[];for(let j of u){let q=[];for(let K of j){let et=[K.x+R[0],K.y+R[1]];gt(a,et),q.push(et)}k.push(q)}if(a[2]-a[0]<=w/2){(F=a)[0]=F[1]=1/0,F[2]=F[3]=-1/0;for(let j of k)for(let q of j)sb(q,a,h,w)}var F;return k}class yf{constructor(a,h){this.type=Br,this.geojson=a,this.geometries=h}static parse(a,h){if(a.length!==2)return h.error(`'within' expression requires exactly one argument, but found ${a.length-1} instead.`);if(Gl(a[1])){let y=a[1];if(y.type==="FeatureCollection")for(let w=0;w<y.features.length;++w){let R=y.features[w].geometry.type;if(R==="Polygon"||R==="MultiPolygon")return new yf(y,y.features[w].geometry)}else if(y.type==="Feature"){let w=y.geometry.type;if(w==="Polygon"||w==="MultiPolygon")return new yf(y,y.geometry)}else if(y.type==="Polygon"||y.type==="MultiPolygon")return new yf(y,y)}return h.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(a){if(a.geometry()!=null&&a.canonicalID()!=null){if(a.geometryType()==="Point")return function(h,y){let w=[1/0,1/0,-1/0,-1/0],R=[1/0,1/0,-1/0,-1/0],k=h.canonicalID();if(y.type==="Polygon"){let F=km(y.coordinates,R,k),j=M_(h.geometry(),w,R,k);if(!$t(w,R))return!1;for(let q of j)if(!ar(q,F))return!1}if(y.type==="MultiPolygon"){let F=nb(y.coordinates,R,k),j=M_(h.geometry(),w,R,k);if(!$t(w,R))return!1;for(let q of j)if(!Ri(q,F))return!1}return!0}(a,this.geometries);if(a.geometryType()==="LineString")return function(h,y){let w=[1/0,1/0,-1/0,-1/0],R=[1/0,1/0,-1/0,-1/0],k=h.canonicalID();if(y.type==="Polygon"){let F=km(y.coordinates,R,k),j=C_(h.geometry(),w,R,k);if(!$t(w,R))return!1;for(let q of j)if(!mo(q,F))return!1}if(y.type==="MultiPolygon"){let F=nb(y.coordinates,R,k),j=C_(h.geometry(),w,R,k);if(!$t(w,R))return!1;for(let q of j)if(!Ka(q,F))return!1}return!0}(a,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class Dm{constructor(a,h){this.type=h.type,this.name=a,this.boundExpression=h}static parse(a,h){if(a.length!==2||typeof a[1]!="string")return h.error("'var' expression requires exactly one string literal argument.");let y=a[1];return h.scope.has(y)?new Dm(y,h.scope.get(y)):h.error(`Unknown variable "${y}". Make sure "${y}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(a){return this.boundExpression.evaluate(a)}eachChild(){}outputDefined(){return!1}}class wl{constructor(a,h,y,w){this.name=a,this.type=h,this._evaluate=y,this.args=w}evaluate(a){return this._evaluate(a,this.args)}eachChild(a){this.args.forEach(a)}outputDefined(){return!1}static parse(a,h){let y=a[0],w=wl.definitions[y];if(!w)return h.error(`Unknown expression "${y}". If you wanted a literal array, use ["literal", [...]].`,0);let R=Array.isArray(w)?w[0]:w.type,k=Array.isArray(w)?[[w[1],w[2]]]:w.overloads,F=k.filter(([q])=>!Array.isArray(q)||q.length===a.length-1),j=null;for(let[q,K]of F){j=new Gp(h.registry,Bm,h.path,null,h.scope);let et=[],it=!1;for(let ct=1;ct<a.length;ct++){let ht=a[ct],vt=Array.isArray(q)?q[ct-1]:q.type,Nt=j.parse(ht,1+et.length,vt);if(!Nt){it=!0;break}et.push(Nt)}if(!it)if(Array.isArray(q)&&q.length!==et.length)j.error(`Expected ${q.length} arguments, but found ${et.length} instead.`);else{for(let ct=0;ct<et.length;ct++){let ht=Array.isArray(q)?q[ct]:q.type,vt=et[ct];j.concat(ct+1).checkSubtype(ht,vt.type)}if(j.errors.length===0)return new wl(y,R,K,et)}}if(F.length===1)h.errors.push(...j.errors);else{let q=(F.length?F:k).map(([et])=>{return it=et,Array.isArray(it)?`(${it.map(Bt).join(", ")})`:`(${Bt(it.type)}...)`;var it}).join(" | "),K=[];for(let et=1;et<a.length;et++){let it=h.parse(a[et],1+K.length);if(!it)return null;K.push(Bt(it.type))}h.error(`Expected arguments of type ${q}, but found (${K.join(", ")}) instead.`)}return null}static register(a,h){wl.definitions=h;for(let y in h)a[y]=wl}}function Bm(u){if(u instanceof Dm)return Bm(u.boundExpression);if(u instanceof wl&&u.name==="error"||u instanceof Qp||u instanceof yf)return!1;let a=u instanceof Kl||u instanceof Cs,h=!0;return u.eachChild(y=>{h=a?h&&Bm(y):h&&y instanceof Ql}),!!h&&Om(u)&&Nm(u,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function Om(u){if(u instanceof wl&&(u.name==="get"&&u.args.length===1||u.name==="feature-state"||u.name==="has"&&u.args.length===1||u.name==="properties"||u.name==="geometry-type"||u.name==="id"||/^filter-/.test(u.name))||u instanceof yf)return!1;let a=!0;return u.eachChild(h=>{a&&!Om(h)&&(a=!1)}),a}function O0(u){if(u instanceof wl&&u.name==="feature-state")return!1;let a=!0;return u.eachChild(h=>{a&&!O0(h)&&(a=!1)}),a}function Nm(u,a){if(u instanceof wl&&a.indexOf(u.name)>=0)return!1;let h=!0;return u.eachChild(y=>{h&&!Nm(y,a)&&(h=!1)}),h}function Kp(u,a){let h=u.length-1,y,w,R=0,k=h,F=0;for(;R<=k;)if(F=Math.floor((R+k)/2),y=u[F],w=u[F+1],y<=a){if(F===h||a<w)return F;R=F+1}else{if(!(y>a))throw new Hn("Input is not a number.");k=F-1}return 0}class yh{constructor(a,h,y){this.type=a,this.input=h,this.labels=[],this.outputs=[];for(let[w,R]of y)this.labels.push(w),this.outputs.push(R)}static parse(a,h){if(a.length-1<4)return h.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if((a.length-1)%2!=0)return h.error("Expected an even number of arguments.");let y=h.parse(a[1],1,Ue);if(!y)return null;let w=[],R=null;h.expectedType&&h.expectedType.kind!=="value"&&(R=h.expectedType);for(let k=1;k<a.length;k+=2){let F=k===1?-1/0:a[k],j=a[k+1],q=k,K=k+1;if(typeof F!="number")return h.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',q);if(w.length&&w[w.length-1][0]>=F)return h.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',q);let et=h.parse(j,K,R);if(!et)return null;R=R||et.type,w.push([F,et])}return new yh(R,y,w)}evaluate(a){let h=this.labels,y=this.outputs;if(h.length===1)return y[0].evaluate(a);let w=this.input.evaluate(a);if(w<=h[0])return y[0].evaluate(a);let R=h.length;return w>=h[R-1]?y[R-1].evaluate(a):y[Kp(h,w)].evaluate(a)}eachChild(a){a(this.input);for(let h of this.outputs)a(h)}outputDefined(){return this.outputs.every(a=>a.outputDefined())}}function qi(u,a,h){return u+h*(a-u)}function Fm(u,a,h){return u.map((y,w)=>qi(y,a[w],h))}let Ja={number:qi,color:function(u,a,h,y="rgb"){switch(y){case"rgb":{let[w,R,k,F]=Fm(u.rgb,a.rgb,h);return new Hi(w,R,k,F,!1)}case"hcl":{let[w,R,k,F]=u.hcl,[j,q,K,et]=a.hcl,it,ct;if(isNaN(w)||isNaN(j))isNaN(w)?isNaN(j)?it=NaN:(it=j,k!==1&&k!==0||(ct=q)):(it=w,K!==1&&K!==0||(ct=R));else{let Kt=j-w;j>w&&Kt>180?Kt-=360:j<w&&w-j>180&&(Kt+=360),it=w+h*Kt}let[ht,vt,Nt,Ut]=function([Kt,Ht,Jt,le]){return Kt=isNaN(Kt)?0:Kt*Ur,fn([Jt,Math.cos(Kt)*Ht,Math.sin(Kt)*Ht,le])}([it,ct??qi(R,q,h),qi(k,K,h),qi(F,et,h)]);return new Hi(ht,vt,Nt,Ut,!1)}case"lab":{let[w,R,k,F]=fn(Fm(u.lab,a.lab,h));return new Hi(w,R,k,F,!1)}}},array:Fm,padding:function(u,a,h){return new _s(Fm(u.values,a.values,h))},variableAnchorOffsetCollection:function(u,a,h){let y=u.values,w=a.values;if(y.length!==w.length)throw new Hn(`Cannot interpolate values of different length. from: ${u.toString()}, to: ${a.toString()}`);let R=[];for(let k=0;k<y.length;k+=2){if(y[k]!==w[k])throw new Hn(`Cannot interpolate values containing mismatched anchors. from[${k}]: ${y[k]}, to[${k}]: ${w[k]}`);R.push(y[k]);let[F,j]=y[k+1],[q,K]=w[k+1];R.push([qi(F,q,h),qi(j,K,h)])}return new ea(R)}};class tl{constructor(a,h,y,w,R){this.type=a,this.operator=h,this.interpolation=y,this.input=w,this.labels=[],this.outputs=[];for(let[k,F]of R)this.labels.push(k),this.outputs.push(F)}static interpolationFactor(a,h,y,w){let R=0;if(a.name==="exponential")R=P_(h,a.base,y,w);else if(a.name==="linear")R=P_(h,1,y,w);else if(a.name==="cubic-bezier"){let k=a.controlPoints;R=new D(k[0],k[1],k[2],k[3]).solve(P_(h,1,y,w))}return R}static parse(a,h){let[y,w,R,...k]=a;if(!Array.isArray(w)||w.length===0)return h.error("Expected an interpolation type expression.",1);if(w[0]==="linear")w={name:"linear"};else if(w[0]==="exponential"){let q=w[1];if(typeof q!="number")return h.error("Exponential interpolation requires a numeric base.",1,1);w={name:"exponential",base:q}}else{if(w[0]!=="cubic-bezier")return h.error(`Unknown interpolation type ${String(w[0])}`,1,0);{let q=w.slice(1);if(q.length!==4||q.some(K=>typeof K!="number"||K<0||K>1))return h.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);w={name:"cubic-bezier",controlPoints:q}}}if(a.length-1<4)return h.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if((a.length-1)%2!=0)return h.error("Expected an even number of arguments.");if(R=h.parse(R,2,Ue),!R)return null;let F=[],j=null;y==="interpolate-hcl"||y==="interpolate-lab"?j=Ao:h.expectedType&&h.expectedType.kind!=="value"&&(j=h.expectedType);for(let q=0;q<k.length;q+=2){let K=k[q],et=k[q+1],it=q+3,ct=q+4;if(typeof K!="number")return h.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',it);if(F.length&&F[F.length-1][0]>=K)return h.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',it);let ht=h.parse(et,ct,j);if(!ht)return null;j=j||ht.type,F.push([K,ht])}return _e(j,Ue)||_e(j,Ao)||_e(j,rt)||_e(j,At)||_e(j,Rt(Ue))?new tl(j,y,w,R,F):h.error(`Type ${Bt(j)} is not interpolatable.`)}evaluate(a){let h=this.labels,y=this.outputs;if(h.length===1)return y[0].evaluate(a);let w=this.input.evaluate(a);if(w<=h[0])return y[0].evaluate(a);let R=h.length;if(w>=h[R-1])return y[R-1].evaluate(a);let k=Kp(h,w),F=tl.interpolationFactor(this.interpolation,w,h[k],h[k+1]),j=y[k].evaluate(a),q=y[k+1].evaluate(a);switch(this.operator){case"interpolate":return Ja[this.type.kind](j,q,F);case"interpolate-hcl":return Ja.color(j,q,F,"hcl");case"interpolate-lab":return Ja.color(j,q,F,"lab")}}eachChild(a){a(this.input);for(let h of this.outputs)a(h)}outputDefined(){return this.outputs.every(a=>a.outputDefined())}}function P_(u,a,h,y){let w=y-h,R=u-h;return w===0?0:a===1?R/w:(Math.pow(a,R)-1)/(Math.pow(a,w)-1)}class Lm{constructor(a,h){this.type=a,this.args=h}static parse(a,h){if(a.length<2)return h.error("Expectected at least one argument.");let y=null,w=h.expectedType;w&&w.kind!=="value"&&(y=w);let R=[];for(let F of a.slice(1)){let j=h.parse(F,1+R.length,y,void 0,{typeAnnotation:"omit"});if(!j)return null;y=y||j.type,R.push(j)}if(!y)throw new Error("No output type");let k=w&&R.some(F=>qt(w,F.type));return new Lm(k?Hr:y,R)}evaluate(a){let h,y=null,w=0;for(let R of this.args)if(w++,y=R.evaluate(a),y&&y instanceof Ms&&!y.available&&(h||(h=y.name),y=null,w===this.args.length&&(y=h)),y!==null)break;return y}eachChild(a){this.args.forEach(a)}outputDefined(){return this.args.every(a=>a.outputDefined())}}class zm{constructor(a,h){this.type=h.type,this.bindings=[].concat(a),this.result=h}evaluate(a){return this.result.evaluate(a)}eachChild(a){for(let h of this.bindings)a(h[1]);a(this.result)}static parse(a,h){if(a.length<4)return h.error(`Expected at least 3 arguments, but found ${a.length-1} instead.`);let y=[];for(let R=1;R<a.length-1;R+=2){let k=a[R];if(typeof k!="string")return h.error(`Expected string, but found ${typeof k} instead.`,R);if(/[^a-zA-Z0-9_]/.test(k))return h.error("Variable names must contain only alphanumeric characters or '_'.",R);let F=h.parse(a[R+1],R+1);if(!F)return null;y.push([k,F])}let w=h.parse(a[a.length-1],a.length-1,h.expectedType,y);return w?new zm(y,w):null}outputDefined(){return this.result.outputDefined()}}class R_{constructor(a,h,y){this.type=a,this.index=h,this.input=y}static parse(a,h){if(a.length!==3)return h.error(`Expected 2 arguments, but found ${a.length-1} instead.`);let y=h.parse(a[1],1,Ue),w=h.parse(a[2],2,Rt(h.expectedType||Hr));return y&&w?new R_(w.type.itemType,y,w):null}evaluate(a){let h=this.index.evaluate(a),y=this.input.evaluate(a);if(h<0)throw new Hn(`Array index out of bounds: ${h} < 0.`);if(h>=y.length)throw new Hn(`Array index out of bounds: ${h} > ${y.length-1}.`);if(h!==Math.floor(h))throw new Hn(`Array index must be an integer, but found ${h} instead.`);return y[h]}eachChild(a){a(this.index),a(this.input)}outputDefined(){return!1}}class k_{constructor(a,h){this.type=Br,this.needle=a,this.haystack=h}static parse(a,h){if(a.length!==3)return h.error(`Expected 2 arguments, but found ${a.length-1} instead.`);let y=h.parse(a[1],1,Hr),w=h.parse(a[2],2,Hr);return y&&w?Lt(y.type,[Br,ri,Ue,Za,Hr])?new k_(y,w):h.error(`Expected first argument to be of type boolean, string, number or null, but found ${Bt(y.type)} instead`):null}evaluate(a){let h=this.needle.evaluate(a),y=this.haystack.evaluate(a);if(!y)return!1;if(!Qt(h,["boolean","string","number","null"]))throw new Hn(`Expected first argument to be of type boolean, string, number or null, but found ${Bt(Fn(h))} instead.`);if(!Qt(y,["string","array"]))throw new Hn(`Expected second argument to be of type array or string, but found ${Bt(Fn(y))} instead.`);return y.indexOf(h)>=0}eachChild(a){a(this.needle),a(this.haystack)}outputDefined(){return!0}}class Um{constructor(a,h,y){this.type=Ue,this.needle=a,this.haystack=h,this.fromIndex=y}static parse(a,h){if(a.length<=2||a.length>=5)return h.error(`Expected 3 or 4 arguments, but found ${a.length-1} instead.`);let y=h.parse(a[1],1,Hr),w=h.parse(a[2],2,Hr);if(!y||!w)return null;if(!Lt(y.type,[Br,ri,Ue,Za,Hr]))return h.error(`Expected first argument to be of type boolean, string, number or null, but found ${Bt(y.type)} instead`);if(a.length===4){let R=h.parse(a[3],3,Ue);return R?new Um(y,w,R):null}return new Um(y,w)}evaluate(a){let h=this.needle.evaluate(a),y=this.haystack.evaluate(a);if(!Qt(h,["boolean","string","number","null"]))throw new Hn(`Expected first argument to be of type boolean, string, number or null, but found ${Bt(Fn(h))} instead.`);if(!Qt(y,["string","array"]))throw new Hn(`Expected second argument to be of type array or string, but found ${Bt(Fn(y))} instead.`);if(this.fromIndex){let w=this.fromIndex.evaluate(a);return y.indexOf(h,w)}return y.indexOf(h)}eachChild(a){a(this.needle),a(this.haystack),this.fromIndex&&a(this.fromIndex)}outputDefined(){return!1}}class D_{constructor(a,h,y,w,R,k){this.inputType=a,this.type=h,this.input=y,this.cases=w,this.outputs=R,this.otherwise=k}static parse(a,h){if(a.length<5)return h.error(`Expected at least 4 arguments, but found only ${a.length-1}.`);if(a.length%2!=1)return h.error("Expected an even number of arguments.");let y,w;h.expectedType&&h.expectedType.kind!=="value"&&(w=h.expectedType);let R={},k=[];for(let q=2;q<a.length-1;q+=2){let K=a[q],et=a[q+1];Array.isArray(K)||(K=[K]);let it=h.concat(q);if(K.length===0)return it.error("Expected at least one branch label.");for(let ht of K){if(typeof ht!="number"&&typeof ht!="string")return it.error("Branch labels must be numbers or strings.");if(typeof ht=="number"&&Math.abs(ht)>Number.MAX_SAFE_INTEGER)return it.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof ht=="number"&&Math.floor(ht)!==ht)return it.error("Numeric branch labels must be integer values.");if(y){if(it.checkSubtype(y,Fn(ht)))return null}else y=Fn(ht);if(R[String(ht)]!==void 0)return it.error("Branch labels must be unique.");R[String(ht)]=k.length}let ct=h.parse(et,q,w);if(!ct)return null;w=w||ct.type,k.push(ct)}let F=h.parse(a[1],1,Hr);if(!F)return null;let j=h.parse(a[a.length-1],a.length-1,w);return j?F.type.kind!=="value"&&h.concat(1).checkSubtype(y,F.type)?null:new D_(y,w,F,R,k,j):null}evaluate(a){let h=this.input.evaluate(a);return(Fn(h)===this.inputType&&this.outputs[this.cases[h]]||this.otherwise).evaluate(a)}eachChild(a){a(this.input),this.outputs.forEach(a),a(this.otherwise)}outputDefined(){return this.outputs.every(a=>a.outputDefined())&&this.otherwise.outputDefined()}}class B_{constructor(a,h,y){this.type=a,this.branches=h,this.otherwise=y}static parse(a,h){if(a.length<4)return h.error(`Expected at least 3 arguments, but found only ${a.length-1}.`);if(a.length%2!=0)return h.error("Expected an odd number of arguments.");let y;h.expectedType&&h.expectedType.kind!=="value"&&(y=h.expectedType);let w=[];for(let k=1;k<a.length-1;k+=2){let F=h.parse(a[k],k,Br);if(!F)return null;let j=h.parse(a[k+1],k+1,y);if(!j)return null;w.push([F,j]),y=y||j.type}let R=h.parse(a[a.length-1],a.length-1,y);if(!R)return null;if(!y)throw new Error("Can't infer output type");return new B_(y,w,R)}evaluate(a){for(let[h,y]of this.branches)if(h.evaluate(a))return y.evaluate(a);return this.otherwise.evaluate(a)}eachChild(a){for(let[h,y]of this.branches)a(h),a(y);a(this.otherwise)}outputDefined(){return this.branches.every(([a,h])=>h.outputDefined())&&this.otherwise.outputDefined()}}class Vm{constructor(a,h,y,w){this.type=a,this.input=h,this.beginIndex=y,this.endIndex=w}static parse(a,h){if(a.length<=2||a.length>=5)return h.error(`Expected 3 or 4 arguments, but found ${a.length-1} instead.`);let y=h.parse(a[1],1,Hr),w=h.parse(a[2],2,Ue);if(!y||!w)return null;if(!Lt(y.type,[Rt(Hr),ri,Hr]))return h.error(`Expected first argument to be of type array or string, but found ${Bt(y.type)} instead`);if(a.length===4){let R=h.parse(a[3],3,Ue);return R?new Vm(y.type,y,w,R):null}return new Vm(y.type,y,w)}evaluate(a){let h=this.input.evaluate(a),y=this.beginIndex.evaluate(a);if(!Qt(h,["string","array"]))throw new Hn(`Expected first argument to be of type array or string, but found ${Bt(Fn(h))} instead.`);if(this.endIndex){let w=this.endIndex.evaluate(a);return h.slice(y,w)}return h.slice(y)}eachChild(a){a(this.input),a(this.beginIndex),this.endIndex&&a(this.endIndex)}outputDefined(){return!1}}function ob(u,a){return u==="=="||u==="!="?a.kind==="boolean"||a.kind==="string"||a.kind==="number"||a.kind==="null"||a.kind==="value":a.kind==="string"||a.kind==="number"||a.kind==="value"}function ab(u,a,h,y){return y.compare(a,h)===0}function Jp(u,a,h){let y=u!=="=="&&u!=="!=";return class WW{constructor(R,k,F){this.type=Br,this.lhs=R,this.rhs=k,this.collator=F,this.hasUntypedArgument=R.type.kind==="value"||k.type.kind==="value"}static parse(R,k){if(R.length!==3&&R.length!==4)return k.error("Expected two or three arguments.");let F=R[0],j=k.parse(R[1],1,Hr);if(!j)return null;if(!ob(F,j.type))return k.concat(1).error(`"${F}" comparisons are not supported for type '${Bt(j.type)}'.`);let q=k.parse(R[2],2,Hr);if(!q)return null;if(!ob(F,q.type))return k.concat(2).error(`"${F}" comparisons are not supported for type '${Bt(q.type)}'.`);if(j.type.kind!==q.type.kind&&j.type.kind!=="value"&&q.type.kind!=="value")return k.error(`Cannot compare types '${Bt(j.type)}' and '${Bt(q.type)}'.`);y&&(j.type.kind==="value"&&q.type.kind!=="value"?j=new Cs(q.type,[j]):j.type.kind!=="value"&&q.type.kind==="value"&&(q=new Cs(j.type,[q])));let K=null;if(R.length===4){if(j.type.kind!=="string"&&q.type.kind!=="string"&&j.type.kind!=="value"&&q.type.kind!=="value")return k.error("Cannot use collator to compare non-string types.");if(K=k.parse(R[3],3,ba),!K)return null}return new WW(j,q,K)}evaluate(R){let k=this.lhs.evaluate(R),F=this.rhs.evaluate(R);if(y&&this.hasUntypedArgument){let j=Fn(k),q=Fn(F);if(j.kind!==q.kind||j.kind!=="string"&&j.kind!=="number")throw new Hn(`Expected arguments for "${u}" to be (string, string) or (number, number), but found (${j.kind}, ${q.kind}) instead.`)}if(this.collator&&!y&&this.hasUntypedArgument){let j=Fn(k),q=Fn(F);if(j.kind!=="string"||q.kind!=="string")return a(R,k,F)}return this.collator?h(R,k,F,this.collator.evaluate(R)):a(R,k,F)}eachChild(R){R(this.lhs),R(this.rhs),this.collator&&R(this.collator)}outputDefined(){return!0}}}let CT=Jp("==",function(u,a,h){return a===h},ab),PT=Jp("!=",function(u,a,h){return a!==h},function(u,a,h,y){return!ab(0,a,h,y)}),RT=Jp("<",function(u,a,h){return a<h},function(u,a,h,y){return y.compare(a,h)<0}),kT=Jp(">",function(u,a,h){return a>h},function(u,a,h,y){return y.compare(a,h)>0}),O_=Jp("<=",function(u,a,h){return a<=h},function(u,a,h,y){return y.compare(a,h)<=0}),lb=Jp(">=",function(u,a,h){return a>=h},function(u,a,h,y){return y.compare(a,h)>=0});class jm{constructor(a,h,y,w,R){this.type=ri,this.number=a,this.locale=h,this.currency=y,this.minFractionDigits=w,this.maxFractionDigits=R}static parse(a,h){if(a.length!==3)return h.error("Expected two arguments.");let y=h.parse(a[1],1,Ue);if(!y)return null;let w=a[2];if(typeof w!="object"||Array.isArray(w))return h.error("NumberFormat options argument must be an object.");let R=null;if(w.locale&&(R=h.parse(w.locale,1,ri),!R))return null;let k=null;if(w.currency&&(k=h.parse(w.currency,1,ri),!k))return null;let F=null;if(w["min-fraction-digits"]&&(F=h.parse(w["min-fraction-digits"],1,Ue),!F))return null;let j=null;return w["max-fraction-digits"]&&(j=h.parse(w["max-fraction-digits"],1,Ue),!j)?null:new jm(y,R,k,F,j)}evaluate(a){return new Intl.NumberFormat(this.locale?this.locale.evaluate(a):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(a):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(a):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(a):void 0}).format(this.number.evaluate(a))}eachChild(a){a(this.number),this.locale&&a(this.locale),this.currency&&a(this.currency),this.minFractionDigits&&a(this.minFractionDigits),this.maxFractionDigits&&a(this.maxFractionDigits)}outputDefined(){return!1}}class xf{constructor(a){this.type=It,this.sections=a}static parse(a,h){if(a.length<2)return h.error("Expected at least one argument.");let y=a[1];if(!Array.isArray(y)&&typeof y=="object")return h.error("First argument must be an image or text section.");let w=[],R=!1;for(let k=1;k<=a.length-1;++k){let F=a[k];if(R&&typeof F=="object"&&!Array.isArray(F)){R=!1;let j=null;if(F["font-scale"]&&(j=h.parse(F["font-scale"],1,Ue),!j))return null;let q=null;if(F["text-font"]&&(q=h.parse(F["text-font"],1,Rt(ri)),!q))return null;let K=null;if(F["text-color"]&&(K=h.parse(F["text-color"],1,Ao),!K))return null;let et=w[w.length-1];et.scale=j,et.font=q,et.textColor=K}else{let j=h.parse(a[k],1,Hr);if(!j)return null;let q=j.type.kind;if(q!=="string"&&q!=="value"&&q!=="null"&&q!=="resolvedImage")return h.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");R=!0,w.push({content:j,scale:null,font:null,textColor:null})}}return new xf(w)}evaluate(a){return new $n(this.sections.map(h=>{let y=h.content.evaluate(a);return Fn(y)===ot?new Dc("",y,null,null,null):new Dc(Ki(y),null,h.scale?h.scale.evaluate(a):null,h.font?h.font.evaluate(a).join(","):null,h.textColor?h.textColor.evaluate(a):null)}))}eachChild(a){for(let h of this.sections)a(h.content),h.scale&&a(h.scale),h.font&&a(h.font),h.textColor&&a(h.textColor)}outputDefined(){return!1}}class N0{constructor(a){this.type=ot,this.input=a}static parse(a,h){if(a.length!==2)return h.error("Expected two arguments.");let y=h.parse(a[1],1,ri);return y?new N0(y):h.error("No image name provided.")}evaluate(a){let h=this.input.evaluate(a),y=Ms.fromString(h);return y&&a.availableImages&&(y.available=a.availableImages.indexOf(h)>-1),y}eachChild(a){a(this.input)}outputDefined(){return!1}}class F0{constructor(a){this.type=Ue,this.input=a}static parse(a,h){if(a.length!==2)return h.error(`Expected 1 argument, but found ${a.length-1} instead.`);let y=h.parse(a[1],1);return y?y.type.kind!=="array"&&y.type.kind!=="string"&&y.type.kind!=="value"?h.error(`Expected argument of type string or array, but found ${Bt(y.type)} instead.`):new F0(y):null}evaluate(a){let h=this.input.evaluate(a);if(typeof h=="string"||Array.isArray(h))return h.length;throw new Hn(`Expected value to be of type string or array, but found ${Bt(Fn(h))} instead.`)}eachChild(a){a(this.input)}outputDefined(){return!1}}let xh={"==":CT,"!=":PT,">":kT,"<":RT,">=":lb,"<=":O_,array:Cs,at:R_,boolean:Cs,case:B_,coalesce:Lm,collator:Qp,format:xf,image:N0,in:k_,"index-of":Um,interpolate:tl,"interpolate-hcl":tl,"interpolate-lab":tl,length:F0,let:zm,literal:Ql,match:D_,number:Cs,"number-format":jm,object:Cs,slice:Vm,step:yh,string:Cs,"to-boolean":Kl,"to-color":Kl,"to-number":Kl,"to-string":Kl,var:Dm,within:yf};function td(u,[a,h,y,w]){a=a.evaluate(u),h=h.evaluate(u),y=y.evaluate(u);let R=w?w.evaluate(u):1,k=ko(a,h,y,R);if(k)throw new Hn(k);return new Hi(a/255,h/255,y/255,R,!1)}function L0(u,a){return u in a}function Bc(u,a){let h=a[u];return h===void 0?null:h}function se(u){return{type:u}}function we(u){return{result:"success",value:u}}function $e(u){return{result:"error",value:u}}function Pr(u){return u["property-type"]==="data-driven"||u["property-type"]==="cross-faded-data-driven"}function g(u){return!!u.expression&&u.expression.parameters.indexOf("zoom")>-1}function bn(u){return!!u.expression&&u.expression.interpolated}function _r(u){return u instanceof Number?"number":u instanceof String?"string":u instanceof Boolean?"boolean":Array.isArray(u)?"array":u===null?"null":typeof u}function ft(u){return typeof u=="object"&&u!==null&&!Array.isArray(u)}function ro(u){return u}function Vr(u,a){let h=a.type==="color",y=u.stops&&typeof u.stops[0][0]=="object",w=y||!(y||u.property!==void 0),R=u.type||(bn(a)?"exponential":"interval");if(h||a.type==="padding"){let K=h?Hi.parse:_s.parse;(u=ta({},u)).stops&&(u.stops=u.stops.map(et=>[et[0],K(et[1])])),u.default=K(u.default?u.default:a.default)}if(u.colorSpace&&(k=u.colorSpace)!=="rgb"&&k!=="hcl"&&k!=="lab")throw new Error(`Unknown color space: "${u.colorSpace}"`);var k;let F,j,q;if(R==="exponential")F=ys;else if(R==="interval")F=Qr;else if(R==="categorical"){F=Nr,j=Object.create(null);for(let K of u.stops)j[K[0]]=K[1];q=typeof u.stops[0][0]}else{if(R!=="identity")throw new Error(`Unknown function type "${R}"`);F=ln}if(y){let K={},et=[];for(let ht=0;ht<u.stops.length;ht++){let vt=u.stops[ht],Nt=vt[0].zoom;K[Nt]===void 0&&(K[Nt]={zoom:Nt,type:u.type,property:u.property,default:u.default,stops:[]},et.push(Nt)),K[Nt].stops.push([vt[0].value,vt[1]])}let it=[];for(let ht of et)it.push([K[ht].zoom,Vr(K[ht],a)]);let ct={name:"linear"};return{kind:"composite",interpolationType:ct,interpolationFactor:tl.interpolationFactor.bind(void 0,ct),zoomStops:it.map(ht=>ht[0]),evaluate:({zoom:ht},vt)=>ys({stops:it,base:u.base},a,ht).evaluate(ht,vt)}}if(w){let K=R==="exponential"?{name:"exponential",base:u.base!==void 0?u.base:1}:null;return{kind:"camera",interpolationType:K,interpolationFactor:tl.interpolationFactor.bind(void 0,K),zoomStops:u.stops.map(et=>et[0]),evaluate:({zoom:et})=>F(u,a,et,j,q)}}return{kind:"source",evaluate(K,et){let it=et&&et.properties?et.properties[u.property]:void 0;return it===void 0?is(u.default,a.default):F(u,a,it,j,q)}}}function is(u,a,h){return u!==void 0?u:a!==void 0?a:h!==void 0?h:void 0}function Nr(u,a,h,y,w){return is(typeof h===w?y[h]:void 0,u.default,a.default)}function Qr(u,a,h){if(_r(h)!=="number")return is(u.default,a.default);let y=u.stops.length;if(y===1||h<=u.stops[0][0])return u.stops[0][1];if(h>=u.stops[y-1][0])return u.stops[y-1][1];let w=Kp(u.stops.map(R=>R[0]),h);return u.stops[w][1]}function ys(u,a,h){let y=u.base!==void 0?u.base:1;if(_r(h)!=="number")return is(u.default,a.default);let w=u.stops.length;if(w===1||h<=u.stops[0][0])return u.stops[0][1];if(h>=u.stops[w-1][0])return u.stops[w-1][1];let R=Kp(u.stops.map(K=>K[0]),h),k=function(K,et,it,ct){let ht=ct-it,vt=K-it;return ht===0?0:et===1?vt/ht:(Math.pow(et,vt)-1)/(Math.pow(et,ht)-1)}(h,y,u.stops[R][0],u.stops[R+1][0]),F=u.stops[R][1],j=u.stops[R+1][1],q=Ja[a.type]||ro;return typeof F.evaluate=="function"?{evaluate(...K){let et=F.evaluate.apply(void 0,K),it=j.evaluate.apply(void 0,K);if(et!==void 0&&it!==void 0)return q(et,it,k,u.colorSpace)}}:q(F,j,k,u.colorSpace)}function ln(u,a,h){switch(a.type){case"color":h=Hi.parse(h);break;case"formatted":h=$n.fromString(h.toString());break;case"resolvedImage":h=Ms.fromString(h.toString());break;case"padding":h=_s.parse(h);break;default:_r(h)===a.type||a.type==="enum"&&a.values[h]||(h=void 0)}return is(h,u.default,a.default)}wl.register(xh,{error:[{kind:"error"},[ri],(u,[a])=>{throw new Hn(a.evaluate(u))}],typeof:[ri,[Hr],(u,[a])=>Bt(Fn(a.evaluate(u)))],"to-rgba":[Rt(Ue,4),[Ao],(u,[a])=>{let[h,y,w,R]=a.evaluate(u).rgb;return[255*h,255*y,255*w,R]}],rgb:[Ao,[Ue,Ue,Ue],td],rgba:[Ao,[Ue,Ue,Ue,Ue],td],has:{type:Br,overloads:[[[ri],(u,[a])=>L0(a.evaluate(u),u.properties())],[[ri,Ga],(u,[a,h])=>L0(a.evaluate(u),h.evaluate(u))]]},get:{type:Hr,overloads:[[[ri],(u,[a])=>Bc(a.evaluate(u),u.properties())],[[ri,Ga],(u,[a,h])=>Bc(a.evaluate(u),h.evaluate(u))]]},"feature-state":[Hr,[ri],(u,[a])=>Bc(a.evaluate(u),u.featureState||{})],properties:[Ga,[],u=>u.properties()],"geometry-type":[ri,[],u=>u.geometryType()],id:[Hr,[],u=>u.id()],zoom:[Ue,[],u=>u.globals.zoom],"heatmap-density":[Ue,[],u=>u.globals.heatmapDensity||0],"line-progress":[Ue,[],u=>u.globals.lineProgress||0],accumulated:[Hr,[],u=>u.globals.accumulated===void 0?null:u.globals.accumulated],"+":[Ue,se(Ue),(u,a)=>{let h=0;for(let y of a)h+=y.evaluate(u);return h}],"*":[Ue,se(Ue),(u,a)=>{let h=1;for(let y of a)h*=y.evaluate(u);return h}],"-":{type:Ue,overloads:[[[Ue,Ue],(u,[a,h])=>a.evaluate(u)-h.evaluate(u)],[[Ue],(u,[a])=>-a.evaluate(u)]]},"/":[Ue,[Ue,Ue],(u,[a,h])=>a.evaluate(u)/h.evaluate(u)],"%":[Ue,[Ue,Ue],(u,[a,h])=>a.evaluate(u)%h.evaluate(u)],ln2:[Ue,[],()=>Math.LN2],pi:[Ue,[],()=>Math.PI],e:[Ue,[],()=>Math.E],"^":[Ue,[Ue,Ue],(u,[a,h])=>Math.pow(a.evaluate(u),h.evaluate(u))],sqrt:[Ue,[Ue],(u,[a])=>Math.sqrt(a.evaluate(u))],log10:[Ue,[Ue],(u,[a])=>Math.log(a.evaluate(u))/Math.LN10],ln:[Ue,[Ue],(u,[a])=>Math.log(a.evaluate(u))],log2:[Ue,[Ue],(u,[a])=>Math.log(a.evaluate(u))/Math.LN2],sin:[Ue,[Ue],(u,[a])=>Math.sin(a.evaluate(u))],cos:[Ue,[Ue],(u,[a])=>Math.cos(a.evaluate(u))],tan:[Ue,[Ue],(u,[a])=>Math.tan(a.evaluate(u))],asin:[Ue,[Ue],(u,[a])=>Math.asin(a.evaluate(u))],acos:[Ue,[Ue],(u,[a])=>Math.acos(a.evaluate(u))],atan:[Ue,[Ue],(u,[a])=>Math.atan(a.evaluate(u))],min:[Ue,se(Ue),(u,a)=>Math.min(...a.map(h=>h.evaluate(u)))],max:[Ue,se(Ue),(u,a)=>Math.max(...a.map(h=>h.evaluate(u)))],abs:[Ue,[Ue],(u,[a])=>Math.abs(a.evaluate(u))],round:[Ue,[Ue],(u,[a])=>{let h=a.evaluate(u);return h<0?-Math.round(-h):Math.round(h)}],floor:[Ue,[Ue],(u,[a])=>Math.floor(a.evaluate(u))],ceil:[Ue,[Ue],(u,[a])=>Math.ceil(a.evaluate(u))],"filter-==":[Br,[ri,Hr],(u,[a,h])=>u.properties()[a.value]===h.value],"filter-id-==":[Br,[Hr],(u,[a])=>u.id()===a.value],"filter-type-==":[Br,[ri],(u,[a])=>u.geometryType()===a.value],"filter-<":[Br,[ri,Hr],(u,[a,h])=>{let y=u.properties()[a.value],w=h.value;return typeof y==typeof w&&y<w}],"filter-id-<":[Br,[Hr],(u,[a])=>{let h=u.id(),y=a.value;return typeof h==typeof y&&h<y}],"filter->":[Br,[ri,Hr],(u,[a,h])=>{let y=u.properties()[a.value],w=h.value;return typeof y==typeof w&&y>w}],"filter-id->":[Br,[Hr],(u,[a])=>{let h=u.id(),y=a.value;return typeof h==typeof y&&h>y}],"filter-<=":[Br,[ri,Hr],(u,[a,h])=>{let y=u.properties()[a.value],w=h.value;return typeof y==typeof w&&y<=w}],"filter-id-<=":[Br,[Hr],(u,[a])=>{let h=u.id(),y=a.value;return typeof h==typeof y&&h<=y}],"filter->=":[Br,[ri,Hr],(u,[a,h])=>{let y=u.properties()[a.value],w=h.value;return typeof y==typeof w&&y>=w}],"filter-id->=":[Br,[Hr],(u,[a])=>{let h=u.id(),y=a.value;return typeof h==typeof y&&h>=y}],"filter-has":[Br,[Hr],(u,[a])=>a.value in u.properties()],"filter-has-id":[Br,[],u=>u.id()!==null&&u.id()!==void 0],"filter-type-in":[Br,[Rt(ri)],(u,[a])=>a.value.indexOf(u.geometryType())>=0],"filter-id-in":[Br,[Rt(Hr)],(u,[a])=>a.value.indexOf(u.id())>=0],"filter-in-small":[Br,[ri,Rt(Hr)],(u,[a,h])=>h.value.indexOf(u.properties()[a.value])>=0],"filter-in-large":[Br,[ri,Rt(Hr)],(u,[a,h])=>function(y,w,R,k){for(;R<=k;){let F=R+k>>1;if(w[F]===y)return!0;w[F]>y?k=F-1:R=F+1}return!1}(u.properties()[a.value],h.value,0,h.value.length-1)],all:{type:Br,overloads:[[[Br,Br],(u,[a,h])=>a.evaluate(u)&&h.evaluate(u)],[se(Br),(u,a)=>{for(let h of a)if(!h.evaluate(u))return!1;return!0}]]},any:{type:Br,overloads:[[[Br,Br],(u,[a,h])=>a.evaluate(u)||h.evaluate(u)],[se(Br),(u,a)=>{for(let h of a)if(h.evaluate(u))return!0;return!1}]]},"!":[Br,[Br],(u,[a])=>!a.evaluate(u)],"is-supported-script":[Br,[ri],(u,[a])=>{let h=u.globals&&u.globals.isSupportedScript;return!h||h(a.evaluate(u))}],upcase:[ri,[ri],(u,[a])=>a.evaluate(u).toUpperCase()],downcase:[ri,[ri],(u,[a])=>a.evaluate(u).toLowerCase()],concat:[ri,se(Hr),(u,a)=>a.map(h=>Ki(h.evaluate(u))).join("")],"resolved-locale":[ri,[ba],(u,[a])=>a.evaluate(u).resolvedLocale()]});class cn{constructor(a,h){var y;this.expression=a,this._warningHistory={},this._evaluator=new Zp,this._defaultValue=h?(y=h).type==="color"&&ft(y.default)?new Hi(0,0,0,0):y.type==="color"?Hi.parse(y.default)||null:y.type==="padding"?_s.parse(y.default)||null:y.type==="variableAnchorOffsetCollection"?ea.parse(y.default)||null:y.default===void 0?null:y.default:null,this._enumValues=h&&h.type==="enum"?h.values:null}evaluateWithoutErrorHandling(a,h,y,w,R,k){return this._evaluator.globals=a,this._evaluator.feature=h,this._evaluator.featureState=y,this._evaluator.canonical=w,this._evaluator.availableImages=R||null,this._evaluator.formattedSection=k,this.expression.evaluate(this._evaluator)}evaluate(a,h,y,w,R,k){this._evaluator.globals=a,this._evaluator.feature=h||null,this._evaluator.featureState=y||null,this._evaluator.canonical=w,this._evaluator.availableImages=R||null,this._evaluator.formattedSection=k||null;try{let F=this.expression.evaluate(this._evaluator);if(F==null||typeof F=="number"&&F!=F)return this._defaultValue;if(this._enumValues&&!(F in this._enumValues))throw new Hn(`Expected value to be one of ${Object.keys(this._enumValues).map(j=>JSON.stringify(j)).join(", ")}, but found ${JSON.stringify(F)} instead.`);return F}catch(F){return this._warningHistory[F.message]||(this._warningHistory[F.message]=!0,typeof console<"u"&&console.warn(F.message)),this._defaultValue}}}function Au(u){return Array.isArray(u)&&u.length>0&&typeof u[0]=="string"&&u[0]in xh}function z0(u,a){let h=new Gp(xh,Bm,[],a?function(w){let R={color:Ao,string:ri,number:Ue,enum:ri,boolean:Br,formatted:It,padding:rt,resolvedImage:ot,variableAnchorOffsetCollection:At};return w.type==="array"?Rt(R[w.value]||Hr,w.length):R[w.type]}(a):void 0),y=h.parse(u,void 0,void 0,void 0,a&&a.type==="string"?{typeAnnotation:"coerce"}:void 0);return y?we(new cn(y,a)):$e(h.errors)}class $m{constructor(a,h){this.kind=a,this._styleExpression=h,this.isStateDependent=a!=="constant"&&!O0(h.expression)}evaluateWithoutErrorHandling(a,h,y,w,R,k){return this._styleExpression.evaluateWithoutErrorHandling(a,h,y,w,R,k)}evaluate(a,h,y,w,R,k){return this._styleExpression.evaluate(a,h,y,w,R,k)}}class bf{constructor(a,h,y,w){this.kind=a,this.zoomStops=y,this._styleExpression=h,this.isStateDependent=a!=="camera"&&!O0(h.expression),this.interpolationType=w}evaluateWithoutErrorHandling(a,h,y,w,R,k){return this._styleExpression.evaluateWithoutErrorHandling(a,h,y,w,R,k)}evaluate(a,h,y,w,R,k){return this._styleExpression.evaluate(a,h,y,w,R,k)}interpolationFactor(a,h,y){return this.interpolationType?tl.interpolationFactor(this.interpolationType,a,h,y):0}}function ra(u,a){let h=z0(u,a);if(h.result==="error")return h;let y=h.value.expression,w=Om(y);if(!w&&!Pr(a))return $e([new Zn("","data expressions not supported")]);let R=Nm(y,["zoom"]);if(!R&&!g(a))return $e([new Zn("","zoom expressions not supported")]);let k=ia(y);return k||R?k instanceof Zn?$e([k]):k instanceof tl&&!bn(a)?$e([new Zn("",'"interpolate" expressions cannot be used with this property')]):we(k?new bf(w?"camera":"composite",h.value,k.labels,k instanceof tl?k.interpolation:void 0):new $m(w?"constant":"source",h.value)):$e([new Zn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Jl{constructor(a,h){this._parameters=a,this._specification=h,ta(this,Vr(this._parameters,this._specification))}static deserialize(a){return new Jl(a._parameters,a._specification)}static serialize(a){return{_parameters:a._parameters,_specification:a._specification}}}function ia(u){let a=null;if(u instanceof zm)a=ia(u.result);else if(u instanceof Lm){for(let h of u.args)if(a=ia(h),a)break}else(u instanceof yh||u instanceof tl)&&u.input instanceof wl&&u.input.name==="zoom"&&(a=u);return a instanceof Zn||u.eachChild(h=>{let y=ia(h);y instanceof Zn?a=y:!a&&y?a=new Zn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):a&&y&&a!==y&&(a=new Zn("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),a}function bh(u){if(u===!0||u===!1)return!0;if(!Array.isArray(u)||u.length===0)return!1;switch(u[0]){case"has":return u.length>=2&&u[1]!=="$id"&&u[1]!=="$type";case"in":return u.length>=3&&(typeof u[1]!="string"||Array.isArray(u[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return u.length!==3||Array.isArray(u[1])||Array.isArray(u[2]);case"any":case"all":for(let a of u.slice(1))if(!bh(a)&&typeof a!="boolean")return!1;return!0;default:return!0}}let cb={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Oc(u){if(u==null)return{filter:()=>!0,needGeometry:!1};bh(u)||(u=Lr(u));let a=z0(u,cb);if(a.result==="error")throw new Error(a.value.map(h=>`${h.key}: ${h.message}`).join(", "));return{filter:(h,y,w)=>a.value.evaluate(h,y,{},w),needGeometry:wt(u)}}function Si(u,a){return u<a?-1:u>a?1:0}function wt(u){if(!Array.isArray(u))return!1;if(u[0]==="within")return!0;for(let a=1;a<u.length;a++)if(wt(u[a]))return!0;return!1}function Lr(u){if(!u)return!0;let a=u[0];return u.length<=1?a!=="any":a==="=="?U0(u[1],u[2],"=="):a==="!="?ed(U0(u[1],u[2],"==")):a==="<"||a===">"||a==="<="||a===">="?U0(u[1],u[2],a):a==="any"?(h=u.slice(1),["any"].concat(h.map(Lr))):a==="all"?["all"].concat(u.slice(1).map(Lr)):a==="none"?["all"].concat(u.slice(1).map(Lr).map(ed)):a==="in"?N_(u[1],u.slice(2)):a==="!in"?ed(N_(u[1],u.slice(2))):a==="has"?F_(u[1]):a==="!has"?ed(F_(u[1])):a!=="within"||u;var h}function U0(u,a,h){switch(u){case"$type":return[`filter-type-${h}`,a];case"$id":return[`filter-id-${h}`,a];default:return[`filter-${h}`,u,a]}}function N_(u,a){if(a.length===0)return!1;switch(u){case"$type":return["filter-type-in",["literal",a]];case"$id":return["filter-id-in",["literal",a]];default:return a.length>200&&!a.some(h=>typeof h!=typeof a[0])?["filter-in-large",u,["literal",a.sort(Si)]]:["filter-in-small",u,["literal",a]]}}function F_(u){switch(u){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",u]}}function ed(u){return["!",u]}function V0(u){let a=typeof u;if(a==="number"||a==="boolean"||a==="string"||u==null)return JSON.stringify(u);if(Array.isArray(u)){let w="[";for(let R of u)w+=`${V0(R)},`;return`${w}]`}let h=Object.keys(u).sort(),y="{";for(let w=0;w<h.length;w++)y+=`${JSON.stringify(h[w])}:${V0(u[h[w]])},`;return`${y}}`}function pt(u){let a="";for(let h of Xn)a+=`/${V0(u[h])}`;return a}function L_(u){let a=u.value;return a?[new Ne(u.key,a,"constants have been deprecated as of v8")]:[]}function cs(u){return u instanceof Number||u instanceof String||u instanceof Boolean?u.valueOf():u}function vh(u){if(Array.isArray(u))return u.map(vh);if(u instanceof Object&&!(u instanceof Number||u instanceof String||u instanceof Boolean)){let a={};for(let h in u)a[h]=vh(u[h]);return a}return cs(u)}function na(u){let a=u.key,h=u.value,y=u.valueSpec||{},w=u.objectElementValidators||{},R=u.style,k=u.styleSpec,F=u.validateSpec,j=[],q=_r(h);if(q!=="object")return[new Ne(a,h,`object expected, ${q} found`)];for(let K in h){let et=K.split(".")[0],it=y[et]||y["*"],ct;if(w[et])ct=w[et];else if(y[et])ct=F;else if(w["*"])ct=w["*"];else{if(!y["*"]){j.push(new Ne(a,h[K],`unknown property "${K}"`));continue}ct=F}j=j.concat(ct({key:(a&&`${a}.`)+K,value:h[K],valueSpec:it,style:R,styleSpec:k,object:h,objectKey:K,validateSpec:F},h))}for(let K in y)w[K]||y[K].required&&y[K].default===void 0&&h[K]===void 0&&j.push(new Ne(a,h,`missing required property "${K}"`));return j}function vf(u){let a=u.value,h=u.valueSpec,y=u.style,w=u.styleSpec,R=u.key,k=u.arrayElementValidator||u.validateSpec;if(_r(a)!=="array")return[new Ne(R,a,`array expected, ${_r(a)} found`)];if(h.length&&a.length!==h.length)return[new Ne(R,a,`array length ${h.length} expected, length ${a.length} found`)];if(h["min-length"]&&a.length<h["min-length"])return[new Ne(R,a,`array length at least ${h["min-length"]} expected, length ${a.length} found`)];let F={type:h.value,values:h.values};w.$version<7&&(F.function=h.function),_r(h.value)==="object"&&(F=h.value);let j=[];for(let q=0;q<a.length;q++)j=j.concat(k({array:a,arrayIndex:q,value:a[q],valueSpec:F,validateSpec:u.validateSpec,style:y,styleSpec:w,key:`${R}[${q}]`}));return j}function rd(u){let a=u.key,h=u.value,y=u.valueSpec,w=_r(h);return w==="number"&&h!=h&&(w="NaN"),w!=="number"?[new Ne(a,h,`number expected, ${w} found`)]:"minimum"in y&&h<y.minimum?[new Ne(a,h,`${h} is less than the minimum value ${y.minimum}`)]:"maximum"in y&&h>y.maximum?[new Ne(a,h,`${h} is greater than the maximum value ${y.maximum}`)]:[]}function id(u){let a=u.valueSpec,h=cs(u.value.type),y,w,R,k={},F=h!=="categorical"&&u.value.property===void 0,j=!F,q=_r(u.value.stops)==="array"&&_r(u.value.stops[0])==="array"&&_r(u.value.stops[0][0])==="object",K=na({key:u.key,value:u.value,valueSpec:u.styleSpec.function,validateSpec:u.validateSpec,style:u.style,styleSpec:u.styleSpec,objectElementValidators:{stops:function(ct){if(h==="identity")return[new Ne(ct.key,ct.value,'identity function may not have a "stops" property')];let ht=[],vt=ct.value;return ht=ht.concat(vf({key:ct.key,value:vt,valueSpec:ct.valueSpec,validateSpec:ct.validateSpec,style:ct.style,styleSpec:ct.styleSpec,arrayElementValidator:et})),_r(vt)==="array"&&vt.length===0&&ht.push(new Ne(ct.key,vt,"array must have at least one stop")),ht},default:function(ct){return ct.validateSpec({key:ct.key,value:ct.value,valueSpec:a,validateSpec:ct.validateSpec,style:ct.style,styleSpec:ct.styleSpec})}}});return h==="identity"&&F&&K.push(new Ne(u.key,u.value,'missing required property "property"')),h==="identity"||u.value.stops||K.push(new Ne(u.key,u.value,'missing required property "stops"')),h==="exponential"&&u.valueSpec.expression&&!bn(u.valueSpec)&&K.push(new Ne(u.key,u.value,"exponential functions not supported")),u.styleSpec.$version>=8&&(j&&!Pr(u.valueSpec)?K.push(new Ne(u.key,u.value,"property functions not supported")):F&&!g(u.valueSpec)&&K.push(new Ne(u.key,u.value,"zoom functions not supported"))),h!=="categorical"&&!q||u.value.property!==void 0||K.push(new Ne(u.key,u.value,'"property" property is required')),K;function et(ct){let ht=[],vt=ct.value,Nt=ct.key;if(_r(vt)!=="array")return[new Ne(Nt,vt,`array expected, ${_r(vt)} found`)];if(vt.length!==2)return[new Ne(Nt,vt,`array length 2 expected, length ${vt.length} found`)];if(q){if(_r(vt[0])!=="object")return[new Ne(Nt,vt,`object expected, ${_r(vt[0])} found`)];if(vt[0].zoom===void 0)return[new Ne(Nt,vt,"object stop key must have zoom")];if(vt[0].value===void 0)return[new Ne(Nt,vt,"object stop key must have value")];if(R&&R>cs(vt[0].zoom))return[new Ne(Nt,vt[0].zoom,"stop zoom values must appear in ascending order")];cs(vt[0].zoom)!==R&&(R=cs(vt[0].zoom),w=void 0,k={}),ht=ht.concat(na({key:`${Nt}[0]`,value:vt[0],valueSpec:{zoom:{}},validateSpec:ct.validateSpec,style:ct.style,styleSpec:ct.styleSpec,objectElementValidators:{zoom:rd,value:it}}))}else ht=ht.concat(it({key:`${Nt}[0]`,value:vt[0],valueSpec:{},validateSpec:ct.validateSpec,style:ct.style,styleSpec:ct.styleSpec},vt));return Au(vh(vt[1]))?ht.concat([new Ne(`${Nt}[1]`,vt[1],"expressions are not allowed in function stops.")]):ht.concat(ct.validateSpec({key:`${Nt}[1]`,value:vt[1],valueSpec:a,validateSpec:ct.validateSpec,style:ct.style,styleSpec:ct.styleSpec}))}function it(ct,ht){let vt=_r(ct.value),Nt=cs(ct.value),Ut=ct.value!==null?ct.value:ht;if(y){if(vt!==y)return[new Ne(ct.key,Ut,`${vt} stop domain type must match previous stop domain type ${y}`)]}else y=vt;if(vt!=="number"&&vt!=="string"&&vt!=="boolean")return[new Ne(ct.key,Ut,"stop domain value must be a number, string, or boolean")];if(vt!=="number"&&h!=="categorical"){let Kt=`number expected, ${vt} found`;return Pr(a)&&h===void 0&&(Kt+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ne(ct.key,Ut,Kt)]}return h!=="categorical"||vt!=="number"||isFinite(Nt)&&Math.floor(Nt)===Nt?h!=="categorical"&&vt==="number"&&w!==void 0&&Nt<w?[new Ne(ct.key,Ut,"stop domain values must appear in ascending order")]:(w=Nt,h==="categorical"&&Nt in k?[new Ne(ct.key,Ut,"stop domain values must be unique")]:(k[Nt]=!0,[])):[new Ne(ct.key,Ut,`integer expected, found ${Nt}`)]}}function mu(u){let a=(u.expressionContext==="property"?ra:z0)(vh(u.value),u.valueSpec);if(a.result==="error")return a.value.map(y=>new Ne(`${u.key}${y.key}`,u.value,y.message));let h=a.value.expression||a.value._styleExpression.expression;if(u.expressionContext==="property"&&u.propertyKey==="text-font"&&!h.outputDefined())return[new Ne(u.key,u.value,`Invalid data expression for "${u.propertyKey}". Output values must be contained as literals within the expression.`)];if(u.expressionContext==="property"&&u.propertyType==="layout"&&!O0(h))return[new Ne(u.key,u.value,'"feature-state" data expressions are not supported with layout properties.')];if(u.expressionContext==="filter"&&!O0(h))return[new Ne(u.key,u.value,'"feature-state" data expressions are not supported with filters.')];if(u.expressionContext&&u.expressionContext.indexOf("cluster")===0){if(!Nm(h,["zoom","feature-state"]))return[new Ne(u.key,u.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(u.expressionContext==="cluster-initial"&&!Om(h))return[new Ne(u.key,u.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function wf(u){let a=u.key,h=u.value,y=u.valueSpec,w=[];return Array.isArray(y.values)?y.values.indexOf(cs(h))===-1&&w.push(new Ne(a,h,`expected one of [${y.values.join(", ")}], ${JSON.stringify(h)} found`)):Object.keys(y.values).indexOf(cs(h))===-1&&w.push(new Ne(a,h,`expected one of [${Object.keys(y.values).join(", ")}], ${JSON.stringify(h)} found`)),w}function sa(u){return bh(vh(u.value))?mu(ta({},u,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Ws(u)}function Ws(u){let a=u.value,h=u.key;if(_r(a)!=="array")return[new Ne(h,a,`array expected, ${_r(a)} found`)];let y=u.styleSpec,w,R=[];if(a.length<1)return[new Ne(h,a,"filter array must have at least 1 element")];switch(R=R.concat(wf({key:`${h}[0]`,value:a[0],valueSpec:y.filter_operator,style:u.style,styleSpec:u.styleSpec})),cs(a[0])){case"<":case"<=":case">":case">=":a.length>=2&&cs(a[1])==="$type"&&R.push(new Ne(h,a,`"$type" cannot be use with operator "${a[0]}"`));case"==":case"!=":a.length!==3&&R.push(new Ne(h,a,`filter array for operator "${a[0]}" must have 3 elements`));case"in":case"!in":a.length>=2&&(w=_r(a[1]),w!=="string"&&R.push(new Ne(`${h}[1]`,a[1],`string expected, ${w} found`)));for(let k=2;k<a.length;k++)w=_r(a[k]),cs(a[1])==="$type"?R=R.concat(wf({key:`${h}[${k}]`,value:a[k],valueSpec:y.geometry_type,style:u.style,styleSpec:u.styleSpec})):w!=="string"&&w!=="number"&&w!=="boolean"&&R.push(new Ne(`${h}[${k}]`,a[k],`string, number, or boolean expected, ${w} found`));break;case"any":case"all":case"none":for(let k=1;k<a.length;k++)R=R.concat(Ws({key:`${h}[${k}]`,value:a[k],style:u.style,styleSpec:u.styleSpec}));break;case"has":case"!has":w=_r(a[1]),a.length!==2?R.push(new Ne(h,a,`filter array for "${a[0]}" operator must have 2 elements`)):w!=="string"&&R.push(new Ne(`${h}[1]`,a[1],`string expected, ${w} found`));break;case"within":w=_r(a[1]),a.length!==2?R.push(new Ne(h,a,`filter array for "${a[0]}" operator must have 2 elements`)):w!=="object"&&R.push(new Ne(`${h}[1]`,a[1],`object expected, ${w} found`))}return R}function j0(u,a){let h=u.key,y=u.validateSpec,w=u.style,R=u.styleSpec,k=u.value,F=u.objectKey,j=R[`${a}_${u.layerType}`];if(!j)return[];let q=F.match(/^(.*)-transition$/);if(a==="paint"&&q&&j[q[1]]&&j[q[1]].transition)return y({key:h,value:k,valueSpec:R.transition,style:w,styleSpec:R});let K=u.valueSpec||j[F];if(!K)return[new Ne(h,k,`unknown property "${F}"`)];let et;if(_r(k)==="string"&&Pr(K)&&!K.tokens&&(et=/^{([^}]+)}$/.exec(k)))return[new Ne(h,k,`"${F}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(et[1])} }\`.`)];let it=[];return u.layerType==="symbol"&&(F==="text-field"&&w&&!w.glyphs&&it.push(new Ne(h,k,'use of "text-field" requires a style "glyphs" property')),F==="text-font"&&ft(vh(k))&&cs(k.type)==="identity"&&it.push(new Ne(h,k,'"text-font" does not support identity functions'))),it.concat(y({key:u.key,value:k,valueSpec:K,style:w,styleSpec:R,expressionContext:"property",propertyType:a,propertyKey:F}))}function z_(u){return j0(u,"paint")}function U_(u){return j0(u,"layout")}function Hm(u){let a=[],h=u.value,y=u.key,w=u.style,R=u.styleSpec;h.type||h.ref||a.push(new Ne(y,h,'either "type" or "ref" is required'));let k=cs(h.type),F=cs(h.ref);if(h.id){let j=cs(h.id);for(let q=0;q<u.arrayIndex;q++){let K=w.layers[q];cs(K.id)===j&&a.push(new Ne(y,h.id,`duplicate layer id "${h.id}", previously used at line ${K.id.__line__}`))}}if("ref"in h){let j;["type","source","source-layer","filter","layout"].forEach(q=>{q in h&&a.push(new Ne(y,h[q],`"${q}" is prohibited for ref layers`))}),w.layers.forEach(q=>{cs(q.id)===F&&(j=q)}),j?j.ref?a.push(new Ne(y,h.ref,"ref cannot reference another ref layer")):k=cs(j.type):a.push(new Ne(y,h.ref,`ref layer "${F}" not found`))}else if(k!=="background")if(h.source){let j=w.sources&&w.sources[h.source],q=j&&cs(j.type);j?q==="vector"&&k==="raster"?a.push(new Ne(y,h.source,`layer "${h.id}" requires a raster source`)):q!=="raster-dem"&&k==="hillshade"?a.push(new Ne(y,h.source,`layer "${h.id}" requires a raster-dem source`)):q==="raster"&&k!=="raster"?a.push(new Ne(y,h.source,`layer "${h.id}" requires a vector source`)):q!=="vector"||h["source-layer"]?q==="raster-dem"&&k!=="hillshade"?a.push(new Ne(y,h.source,"raster-dem source can only be used with layer type 'hillshade'.")):k!=="line"||!h.paint||!h.paint["line-gradient"]||q==="geojson"&&j.lineMetrics||a.push(new Ne(y,h,`layer "${h.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):a.push(new Ne(y,h,`layer "${h.id}" must specify a "source-layer"`)):a.push(new Ne(y,h.source,`source "${h.source}" not found`))}else a.push(new Ne(y,h,'missing required property "source"'));return a=a.concat(na({key:y,value:h,valueSpec:R.layer,style:u.style,styleSpec:u.styleSpec,validateSpec:u.validateSpec,objectElementValidators:{"*":()=>[],type:()=>u.validateSpec({key:`${y}.type`,value:h.type,valueSpec:R.layer.type,style:u.style,styleSpec:u.styleSpec,validateSpec:u.validateSpec,object:h,objectKey:"type"}),filter:sa,layout:j=>na({layer:h,key:j.key,value:j.value,style:j.style,styleSpec:j.styleSpec,validateSpec:j.validateSpec,objectElementValidators:{"*":q=>U_(ta({layerType:k},q))}}),paint:j=>na({layer:h,key:j.key,value:j.value,style:j.style,styleSpec:j.styleSpec,validateSpec:j.validateSpec,objectElementValidators:{"*":q=>z_(ta({layerType:k},q))}})}})),a}function tc(u){let a=u.value,h=u.key,y=_r(a);return y!=="string"?[new Ne(h,a,`string expected, ${y} found`)]:[]}let nd={promoteId:function({key:u,value:a}){if(_r(a)==="string")return tc({key:u,value:a});{let h=[];for(let y in a)h.push(...tc({key:`${u}.${y}`,value:a[y]}));return h}}};function wa(u){let a=u.value,h=u.key,y=u.styleSpec,w=u.style,R=u.validateSpec;if(!a.type)return[new Ne(h,a,'"type" is required')];let k=cs(a.type),F;switch(k){case"vector":case"raster":return F=na({key:h,value:a,valueSpec:y[`source_${k.replace("-","_")}`],style:u.style,styleSpec:y,objectElementValidators:nd,validateSpec:R}),F;case"raster-dem":return F=function(j){var q;let K=(q=j.sourceName)!==null&&q!==void 0?q:"",et=j.value,it=j.styleSpec,ct=it.source_raster_dem,ht=j.style,vt=[],Nt=_r(et);if(et===void 0)return vt;if(Nt!=="object")return vt.push(new Ne("source_raster_dem",et,`object expected, ${Nt} found`)),vt;let Ut=cs(et.encoding)==="custom",Kt=["redFactor","greenFactor","blueFactor","baseShift"],Ht=j.value.encoding?`"${j.value.encoding}"`:"Default";for(let Jt in et)!Ut&&Kt.includes(Jt)?vt.push(new Ne(Jt,et[Jt],`In "${K}": "${Jt}" is only valid when "encoding" is set to "custom". ${Ht} encoding found`)):ct[Jt]?vt=vt.concat(j.validateSpec({key:Jt,value:et[Jt],valueSpec:ct[Jt],validateSpec:j.validateSpec,style:ht,styleSpec:it})):vt.push(new Ne(Jt,et[Jt],`unknown property "${Jt}"`));return vt}({sourceName:h,value:a,style:u.style,styleSpec:y,validateSpec:R}),F;case"geojson":if(F=na({key:h,value:a,valueSpec:y.source_geojson,style:w,styleSpec:y,validateSpec:R,objectElementValidators:nd}),a.cluster)for(let j in a.clusterProperties){let[q,K]=a.clusterProperties[j],et=typeof q=="string"?[q,["accumulated"],["get",j]]:q;F.push(...mu({key:`${h}.${j}.map`,value:K,validateSpec:R,expressionContext:"cluster-map"})),F.push(...mu({key:`${h}.${j}.reduce`,value:et,validateSpec:R,expressionContext:"cluster-reduce"}))}return F;case"video":return na({key:h,value:a,valueSpec:y.source_video,style:w,validateSpec:R,styleSpec:y});case"image":return na({key:h,value:a,valueSpec:y.source_image,style:w,validateSpec:R,styleSpec:y});case"canvas":return[new Ne(h,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return wf({key:`${h}.type`,value:a.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:w,validateSpec:R,styleSpec:y})}}function vn(u){let a=u.value,h=u.styleSpec,y=h.light,w=u.style,R=[],k=_r(a);if(a===void 0)return R;if(k!=="object")return R=R.concat([new Ne("light",a,`object expected, ${k} found`)]),R;for(let F in a){let j=F.match(/^(.*)-transition$/);R=R.concat(j&&y[j[1]]&&y[j[1]].transition?u.validateSpec({key:F,value:a[F],valueSpec:h.transition,validateSpec:u.validateSpec,style:w,styleSpec:h}):y[F]?u.validateSpec({key:F,value:a[F],valueSpec:y[F],validateSpec:u.validateSpec,style:w,styleSpec:h}):[new Ne(F,a[F],`unknown property "${F}"`)])}return R}function $0(u){let a=u.value,h=u.styleSpec,y=h.terrain,w=u.style,R=[],k=_r(a);if(a===void 0)return R;if(k!=="object")return R=R.concat([new Ne("terrain",a,`object expected, ${k} found`)]),R;for(let F in a)R=R.concat(y[F]?u.validateSpec({key:F,value:a[F],valueSpec:y[F],validateSpec:u.validateSpec,style:w,styleSpec:h}):[new Ne(F,a[F],`unknown property "${F}"`)]);return R}function Wm(u){let a=[],h=u.value,y=u.key;if(Array.isArray(h)){let w=[],R=[];for(let k in h)h[k].id&&w.includes(h[k].id)&&a.push(new Ne(y,h,`all the sprites' ids must be unique, but ${h[k].id} is duplicated`)),w.push(h[k].id),h[k].url&&R.includes(h[k].url)&&a.push(new Ne(y,h,`all the sprites' URLs must be unique, but ${h[k].url} is duplicated`)),R.push(h[k].url),a=a.concat(na({key:`${y}[${k}]`,value:h[k],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:u.validateSpec}));return a}return tc({key:y,value:h})}let V_={"*":()=>[],array:vf,boolean:function(u){let a=u.value,h=u.key,y=_r(a);return y!=="boolean"?[new Ne(h,a,`boolean expected, ${y} found`)]:[]},number:rd,color:function(u){let a=u.key,h=u.value,y=_r(h);return y!=="string"?[new Ne(a,h,`color expected, ${y} found`)]:Hi.parse(String(h))?[]:[new Ne(a,h,`color expected, "${h}" found`)]},constants:L_,enum:wf,filter:sa,function:id,layer:Hm,object:na,source:wa,light:vn,terrain:$0,string:tc,formatted:function(u){return tc(u).length===0?[]:mu(u)},resolvedImage:function(u){return tc(u).length===0?[]:mu(u)},padding:function(u){let a=u.key,h=u.value;if(_r(h)==="array"){if(h.length<1||h.length>4)return[new Ne(a,h,`padding requires 1 to 4 values; ${h.length} values found`)];let y={type:"number"},w=[];for(let R=0;R<h.length;R++)w=w.concat(u.validateSpec({key:`${a}[${R}]`,value:h[R],validateSpec:u.validateSpec,valueSpec:y}));return w}return rd({key:a,value:h,valueSpec:{}})},variableAnchorOffsetCollection:function(u){let a=u.key,h=u.value,y=_r(h),w=u.styleSpec;if(y!=="array"||h.length<1||h.length%2!=0)return[new Ne(a,h,"variableAnchorOffsetCollection requires a non-empty array of even length")];let R=[];for(let k=0;k<h.length;k+=2)R=R.concat(wf({key:`${a}[${k}]`,value:h[k],valueSpec:w.layout_symbol["text-anchor"]})),R=R.concat(vf({key:`${a}[${k+1}]`,value:h[k+1],valueSpec:{length:2,value:"number"},validateSpec:u.validateSpec,style:u.style,styleSpec:w}));return R},sprite:Wm};function Nc(u){let a=u.value,h=u.valueSpec,y=u.styleSpec;return u.validateSpec=Nc,h.expression&&ft(cs(a))?id(u):h.expression&&Au(vh(a))?mu(u):h.type&&V_[h.type]?V_[h.type](u):na(ta({},u,{valueSpec:h.type?y[h.type]:h}))}function j_(u){let a=u.value,h=u.key,y=tc(u);return y.length||(a.indexOf("{fontstack}")===-1&&y.push(new Ne(h,a,'"glyphs" url must include a "{fontstack}" token')),a.indexOf("{range}")===-1&&y.push(new Ne(h,a,'"glyphs" url must include a "{range}" token'))),y}function Ta(u,a=ae){let h=[];return h=h.concat(Nc({key:"",value:u,valueSpec:a.$root,styleSpec:a,style:u,validateSpec:Nc,objectElementValidators:{glyphs:j_,"*":()=>[]}})),u.constants&&(h=h.concat(L_({key:"constants",value:u.constants,style:u,styleSpec:a,validateSpec:Nc}))),Tf(h)}function Tl(u){return function(a){return u({...a,validateSpec:Nc})}}function Tf(u){return[].concat(u).sort((a,h)=>a.line-h.line)}function Fc(u){return function(...a){return Tf(u.apply(this,a))}}Ta.source=Fc(Tl(wa)),Ta.sprite=Fc(Tl(Wm)),Ta.glyphs=Fc(Tl(j_)),Ta.light=Fc(Tl(vn)),Ta.terrain=Fc(Tl($0)),Ta.layer=Fc(Tl(Hm)),Ta.filter=Fc(Tl(sa)),Ta.paintProperty=Fc(Tl(z_)),Ta.layoutProperty=Fc(Tl(U_));let Lc=Ta,$_=Lc.light,H0=Lc.paintProperty,qm=Lc.layoutProperty;function W0(u,a){let h=!1;if(a&&a.length)for(let y of a)u.fire(new hn(new Error(y.message))),h=!0;return h}class Sf{constructor(a,h,y){let w=this.cells=[];if(a instanceof ArrayBuffer){this.arrayBuffer=a;let k=new Int32Array(this.arrayBuffer);a=k[0],this.d=(h=k[1])+2*(y=k[2]);for(let j=0;j<this.d*this.d;j++){let q=k[3+j],K=k[3+j+1];w.push(q===K?null:k.subarray(q,K))}let F=k[3+w.length+1];this.keys=k.subarray(k[3+w.length],F),this.bboxes=k.subarray(F),this.insert=this._insertReadonly}else{this.d=h+2*y;for(let k=0;k<this.d*this.d;k++)w.push([]);this.keys=[],this.bboxes=[]}this.n=h,this.extent=a,this.padding=y,this.scale=h/a,this.uid=0;let R=y/h*a;this.min=-R,this.max=a+R}insert(a,h,y,w,R){this._forEachCell(h,y,w,R,this._insertCell,this.uid++,void 0,void 0),this.keys.push(a),this.bboxes.push(h),this.bboxes.push(y),this.bboxes.push(w),this.bboxes.push(R)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(a,h,y,w,R,k){this.cells[R].push(k)}query(a,h,y,w,R){let k=this.min,F=this.max;if(a<=k&&h<=k&&F<=y&&F<=w&&!R)return Array.prototype.slice.call(this.keys);{let j=[];return this._forEachCell(a,h,y,w,this._queryCell,j,{},R),j}}_queryCell(a,h,y,w,R,k,F,j){let q=this.cells[R];if(q!==null){let K=this.keys,et=this.bboxes;for(let it=0;it<q.length;it++){let ct=q[it];if(F[ct]===void 0){let ht=4*ct;(j?j(et[ht+0],et[ht+1],et[ht+2],et[ht+3]):a<=et[ht+2]&&h<=et[ht+3]&&y>=et[ht+0]&&w>=et[ht+1])?(F[ct]=!0,k.push(K[ct])):F[ct]=!1}}}}_forEachCell(a,h,y,w,R,k,F,j){let q=this._convertToCellCoord(a),K=this._convertToCellCoord(h),et=this._convertToCellCoord(y),it=this._convertToCellCoord(w);for(let ct=q;ct<=et;ct++)for(let ht=K;ht<=it;ht++){let vt=this.d*ht+ct;if((!j||j(this._convertFromCellCoord(ct),this._convertFromCellCoord(ht),this._convertFromCellCoord(ct+1),this._convertFromCellCoord(ht+1)))&&R.call(this,a,h,y,w,vt,k,F,j))return}}_convertFromCellCoord(a){return(a-this.padding)/this.scale}_convertToCellCoord(a){return Math.max(0,Math.min(this.d-1,Math.floor(a*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;let a=this.cells,h=3+this.cells.length+1+1,y=0;for(let k=0;k<this.cells.length;k++)y+=this.cells[k].length;let w=new Int32Array(h+y+this.keys.length+this.bboxes.length);w[0]=this.extent,w[1]=this.n,w[2]=this.padding;let R=h;for(let k=0;k<a.length;k++){let F=a[k];w[3+k]=R,w.set(F,R),R+=F.length}return w[3+a.length]=R,w.set(this.keys,R),R+=this.keys.length,w[3+a.length+1]=R,w.set(this.bboxes,R),R+=this.bboxes.length,w.buffer}static serialize(a,h){let y=a.toArrayBuffer();return h&&h.push(y),{buffer:y}}static deserialize(a){return new Sf(a.buffer)}}let zc={};function Ve(u,a,h={}){if(zc[u])throw new Error(`${u} is already registered.`);Object.defineProperty(a,"_classRegistryKey",{value:u,writeable:!1}),zc[u]={klass:a,omit:h.omit||[],shallow:h.shallow||[]}}Ve("Object",Object),Ve("TransferableGridIndex",Sf),Ve("Color",Hi),Ve("Error",Error),Ve("AJAXError",Gr),Ve("ResolvedImage",Ms),Ve("StylePropertyFunction",Jl),Ve("StyleExpression",cn,{omit:["_evaluator"]}),Ve("ZoomDependentExpression",bf),Ve("ZoomConstantExpression",$m),Ve("CompoundExpression",wl,{omit:["_evaluate"]});for(let u in xh)xh[u]._classRegistryKey||Ve(`Expression_${u}`,xh[u]);function ec(u){return u&&typeof ArrayBuffer<"u"&&(u instanceof ArrayBuffer||u.constructor&&u.constructor.name==="ArrayBuffer")}function xs(u,a){if(u==null||typeof u=="boolean"||typeof u=="number"||typeof u=="string"||u instanceof Boolean||u instanceof Number||u instanceof String||u instanceof Date||u instanceof RegExp||u instanceof Blob)return u;if(ec(u)||de(u))return a&&a.push(u),u;if(ArrayBuffer.isView(u)){let h=u;return a&&a.push(h.buffer),h}if(u instanceof ImageData)return a&&a.push(u.data.buffer),u;if(Array.isArray(u)){let h=[];for(let y of u)h.push(xs(y,a));return h}if(typeof u=="object"){let h=u.constructor,y=h._classRegistryKey;if(!y)throw new Error("can't serialize object of unregistered class");if(!zc[y])throw new Error(`${y} is not registered.`);let w=h.serialize?h.serialize(u,a):{};if(h.serialize){if(a&&w===a[a.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(let R in u){if(!u.hasOwnProperty(R)||zc[y].omit.indexOf(R)>=0)continue;let k=u[R];w[R]=zc[y].shallow.indexOf(R)>=0?k:xs(k,a)}u instanceof Error&&(w.message=u.message)}if(w.$name)throw new Error("$name property is reserved for worker serialization logic.");return y!=="Object"&&(w.$name=y),w}throw new Error("can't serialize object of type "+typeof u)}function gu(u){if(u==null||typeof u=="boolean"||typeof u=="number"||typeof u=="string"||u instanceof Boolean||u instanceof Number||u instanceof String||u instanceof Date||u instanceof RegExp||u instanceof Blob||ec(u)||de(u)||ArrayBuffer.isView(u)||u instanceof ImageData)return u;if(Array.isArray(u))return u.map(gu);if(typeof u=="object"){let a=u.$name||"Object";if(!zc[a])throw new Error(`can't deserialize unregistered class ${a}`);let{klass:h}=zc[a];if(!h)throw new Error(`can't deserialize unregistered class ${a}`);if(h.deserialize)return h.deserialize(u);let y=Object.create(h.prototype);for(let w of Object.keys(u)){if(w==="$name")continue;let R=u[w];y[w]=zc[a].shallow.indexOf(w)>=0?R:gu(R)}return y}throw new Error("can't deserialize object of type "+typeof u)}class Ym{constructor(){this.first=!0}update(a,h){let y=Math.floor(a);return this.first?(this.first=!1,this.lastIntegerZoom=y,this.lastIntegerZoomTime=0,this.lastZoom=a,this.lastFloorZoom=y,!0):(this.lastFloorZoom>y?(this.lastIntegerZoom=y+1,this.lastIntegerZoomTime=h):this.lastFloorZoom<y&&(this.lastIntegerZoom=y,this.lastIntegerZoomTime=h),a!==this.lastZoom&&(this.lastZoom=a,this.lastFloorZoom=y,!0))}}let qe={"Latin-1 Supplement":u=>u>=128&&u<=255,Arabic:u=>u>=1536&&u<=1791,"Arabic Supplement":u=>u>=1872&&u<=1919,"Arabic Extended-A":u=>u>=2208&&u<=2303,"Hangul Jamo":u=>u>=4352&&u<=4607,"Unified Canadian Aboriginal Syllabics":u=>u>=5120&&u<=5759,Khmer:u=>u>=6016&&u<=6143,"Unified Canadian Aboriginal Syllabics Extended":u=>u>=6320&&u<=6399,"General Punctuation":u=>u>=8192&&u<=8303,"Letterlike Symbols":u=>u>=8448&&u<=8527,"Number Forms":u=>u>=8528&&u<=8591,"Miscellaneous Technical":u=>u>=8960&&u<=9215,"Control Pictures":u=>u>=9216&&u<=9279,"Optical Character Recognition":u=>u>=9280&&u<=9311,"Enclosed Alphanumerics":u=>u>=9312&&u<=9471,"Geometric Shapes":u=>u>=9632&&u<=9727,"Miscellaneous Symbols":u=>u>=9728&&u<=9983,"Miscellaneous Symbols and Arrows":u=>u>=11008&&u<=11263,"CJK Radicals Supplement":u=>u>=11904&&u<=12031,"Kangxi Radicals":u=>u>=12032&&u<=12255,"Ideographic Description Characters":u=>u>=12272&&u<=12287,"CJK Symbols and Punctuation":u=>u>=12288&&u<=12351,Hiragana:u=>u>=12352&&u<=12447,Katakana:u=>u>=12448&&u<=12543,Bopomofo:u=>u>=12544&&u<=12591,"Hangul Compatibility Jamo":u=>u>=12592&&u<=12687,Kanbun:u=>u>=12688&&u<=12703,"Bopomofo Extended":u=>u>=12704&&u<=12735,"CJK Strokes":u=>u>=12736&&u<=12783,"Katakana Phonetic Extensions":u=>u>=12784&&u<=12799,"Enclosed CJK Letters and Months":u=>u>=12800&&u<=13055,"CJK Compatibility":u=>u>=13056&&u<=13311,"CJK Unified Ideographs Extension A":u=>u>=13312&&u<=19903,"Yijing Hexagram Symbols":u=>u>=19904&&u<=19967,"CJK Unified Ideographs":u=>u>=19968&&u<=40959,"Yi Syllables":u=>u>=40960&&u<=42127,"Yi Radicals":u=>u>=42128&&u<=42191,"Hangul Jamo Extended-A":u=>u>=43360&&u<=43391,"Hangul Syllables":u=>u>=44032&&u<=55215,"Hangul Jamo Extended-B":u=>u>=55216&&u<=55295,"Private Use Area":u=>u>=57344&&u<=63743,"CJK Compatibility Ideographs":u=>u>=63744&&u<=64255,"Arabic Presentation Forms-A":u=>u>=64336&&u<=65023,"Vertical Forms":u=>u>=65040&&u<=65055,"CJK Compatibility Forms":u=>u>=65072&&u<=65103,"Small Form Variants":u=>u>=65104&&u<=65135,"Arabic Presentation Forms-B":u=>u>=65136&&u<=65279,"Halfwidth and Fullwidth Forms":u=>u>=65280&&u<=65519};function Xm(u){for(let a of u)if(q0(a.charCodeAt(0)))return!0;return!1}function Zm(u){for(let a of u)if(!ub(a.charCodeAt(0)))return!1;return!0}function ub(u){return!(qe.Arabic(u)||qe["Arabic Supplement"](u)||qe["Arabic Extended-A"](u)||qe["Arabic Presentation Forms-A"](u)||qe["Arabic Presentation Forms-B"](u))}function q0(u){return!(u!==746&&u!==747&&(u<4352||!(qe["Bopomofo Extended"](u)||qe.Bopomofo(u)||qe["CJK Compatibility Forms"](u)&&!(u>=65097&&u<=65103)||qe["CJK Compatibility Ideographs"](u)||qe["CJK Compatibility"](u)||qe["CJK Radicals Supplement"](u)||qe["CJK Strokes"](u)||!(!qe["CJK Symbols and Punctuation"](u)||u>=12296&&u<=12305||u>=12308&&u<=12319||u===12336)||qe["CJK Unified Ideographs Extension A"](u)||qe["CJK Unified Ideographs"](u)||qe["Enclosed CJK Letters and Months"](u)||qe["Hangul Compatibility Jamo"](u)||qe["Hangul Jamo Extended-A"](u)||qe["Hangul Jamo Extended-B"](u)||qe["Hangul Jamo"](u)||qe["Hangul Syllables"](u)||qe.Hiragana(u)||qe["Ideographic Description Characters"](u)||qe.Kanbun(u)||qe["Kangxi Radicals"](u)||qe["Katakana Phonetic Extensions"](u)||qe.Katakana(u)&&u!==12540||!(!qe["Halfwidth and Fullwidth Forms"](u)||u===65288||u===65289||u===65293||u>=65306&&u<=65310||u===65339||u===65341||u===65343||u>=65371&&u<=65503||u===65507||u>=65512&&u<=65519)||!(!qe["Small Form Variants"](u)||u>=65112&&u<=65118||u>=65123&&u<=65126)||qe["Unified Canadian Aboriginal Syllabics"](u)||qe["Unified Canadian Aboriginal Syllabics Extended"](u)||qe["Vertical Forms"](u)||qe["Yijing Hexagram Symbols"](u)||qe["Yi Syllables"](u)||qe["Yi Radicals"](u))))}function sd(u){return!(q0(u)||function(a){return!!(qe["Latin-1 Supplement"](a)&&(a===167||a===169||a===174||a===177||a===188||a===189||a===190||a===215||a===247)||qe["General Punctuation"](a)&&(a===8214||a===8224||a===8225||a===8240||a===8241||a===8251||a===8252||a===8258||a===8263||a===8264||a===8265||a===8273)||qe["Letterlike Symbols"](a)||qe["Number Forms"](a)||qe["Miscellaneous Technical"](a)&&(a>=8960&&a<=8967||a>=8972&&a<=8991||a>=8996&&a<=9e3||a===9003||a>=9085&&a<=9114||a>=9150&&a<=9165||a===9167||a>=9169&&a<=9179||a>=9186&&a<=9215)||qe["Control Pictures"](a)&&a!==9251||qe["Optical Character Recognition"](a)||qe["Enclosed Alphanumerics"](a)||qe["Geometric Shapes"](a)||qe["Miscellaneous Symbols"](a)&&!(a>=9754&&a<=9759)||qe["Miscellaneous Symbols and Arrows"](a)&&(a>=11026&&a<=11055||a>=11088&&a<=11097||a>=11192&&a<=11243)||qe["CJK Symbols and Punctuation"](a)||qe.Katakana(a)||qe["Private Use Area"](a)||qe["CJK Compatibility Forms"](a)||qe["Small Form Variants"](a)||qe["Halfwidth and Fullwidth Forms"](a)||a===8734||a===8756||a===8757||a>=9984&&a<=10087||a>=10102&&a<=10131||a===65532||a===65533)}(u))}function _u(u){return u>=1424&&u<=2303||qe["Arabic Presentation Forms-A"](u)||qe["Arabic Presentation Forms-B"](u)}function Gm(u,a){return!(!a&&_u(u)||u>=2304&&u<=3583||u>=3840&&u<=4255||qe.Khmer(u))}function H_(u){for(let a of u)if(_u(a.charCodeAt(0)))return!0;return!1}let Ef="deferred",Uc="loading",rc="loaded",Y0=null,jo="unavailable",ic=null,od=function(u){u&&typeof u=="string"&&u.indexOf("NetworkError")>-1&&(jo="error"),Y0&&Y0(u)};function Qm(){If.fire(new tn("pluginStateChange",{pluginStatus:jo,pluginURL:ic}))}let If=new Sr,Km=function(){return jo},W_=function(){if(jo!==Ef||!ic)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");jo=Uc,Qm(),ic&&jr({url:ic},u=>{u?od(u):(jo=rc,Qm())})},Sa={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>jo===rc||Sa.applyArabicShaping!=null,isLoading:()=>jo===Uc,setState(u){if(!jt())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");jo=u.pluginStatus,ic=u.pluginURL},isParsed(){if(!jt())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return Sa.applyArabicShaping!=null&&Sa.processBidirectionalText!=null&&Sa.processStyledBidirectionalText!=null},getPluginURL(){if(!jt())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return ic}};class Wn{constructor(a,h){this.zoom=a,h?(this.now=h.now,this.fadeDuration=h.fadeDuration,this.zoomHistory=h.zoomHistory,this.transition=h.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Ym,this.transition={})}isSupportedScript(a){return function(h,y){for(let w of h)if(!Gm(w.charCodeAt(0),y))return!1;return!0}(a,Sa.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){let a=this.zoom,h=a-Math.floor(a),y=this.crossFadingFactor();return a>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:h+(1-h)*y}:{fromScale:.5,toScale:1,t:1-(1-y)*h}}}class X0{constructor(a,h){this.property=a,this.value=h,this.expression=function(y,w){if(ft(y))return new Jl(y,w);if(Au(y)){let R=ra(y,w);if(R.result==="error")throw new Error(R.value.map(k=>`${k.key}: ${k.message}`).join(", "));return R.value}{let R=y;return w.type==="color"&&typeof y=="string"?R=Hi.parse(y):w.type!=="padding"||typeof y!="number"&&!Array.isArray(y)?w.type==="variableAnchorOffsetCollection"&&Array.isArray(y)&&(R=ea.parse(y)):R=_s.parse(y),{kind:"constant",evaluate:()=>R}}}(h===void 0?a.specification.default:h,a.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(a,h,y){return this.property.possiblyEvaluate(this,a,h,y)}}class Jm{constructor(a){this.property=a,this.value=new X0(a,void 0)}transitioned(a,h){return new Y_(this.property,this.value,h,at({},a.transition,this.transition),a.now)}untransitioned(){return new Y_(this.property,this.value,null,{},0)}}class q_{constructor(a){this._properties=a,this._values=Object.create(a.defaultTransitionablePropertyValues)}getValue(a){return Et(this._values[a].value.value)}setValue(a,h){Object.prototype.hasOwnProperty.call(this._values,a)||(this._values[a]=new Jm(this._values[a].property)),this._values[a].value=new X0(this._values[a].property,h===null?void 0:Et(h))}getTransition(a){return Et(this._values[a].transition)}setTransition(a,h){Object.prototype.hasOwnProperty.call(this._values,a)||(this._values[a]=new Jm(this._values[a].property)),this._values[a].transition=Et(h)||void 0}serialize(){let a={};for(let h of Object.keys(this._values)){let y=this.getValue(h);y!==void 0&&(a[h]=y);let w=this.getTransition(h);w!==void 0&&(a[`${h}-transition`]=w)}return a}transitioned(a,h){let y=new ad(this._properties);for(let w of Object.keys(this._values))y._values[w]=this._values[w].transitioned(a,h._values[w]);return y}untransitioned(){let a=new ad(this._properties);for(let h of Object.keys(this._values))a._values[h]=this._values[h].untransitioned();return a}}class Y_{constructor(a,h,y,w,R){this.property=a,this.value=h,this.begin=R+w.delay||0,this.end=this.begin+w.duration||0,a.specification.transition&&(w.delay||w.duration)&&(this.prior=y)}possiblyEvaluate(a,h,y){let w=a.now||0,R=this.value.possiblyEvaluate(a,h,y),k=this.prior;if(k){if(w>this.end)return this.prior=null,R;if(this.value.isDataDriven())return this.prior=null,R;if(w<this.begin)return k.possiblyEvaluate(a,h,y);{let F=(w-this.begin)/(this.end-this.begin);return this.property.interpolate(k.possiblyEvaluate(a,h,y),R,function(j){if(j<=0)return 0;if(j>=1)return 1;let q=j*j,K=q*j;return 4*(j<.5?K:3*(j-q)+K-.75)}(F))}}return R}}class ad{constructor(a){this._properties=a,this._values=Object.create(a.defaultTransitioningPropertyValues)}possiblyEvaluate(a,h,y){let w=new Z0(this._properties);for(let R of Object.keys(this._values))w._values[R]=this._values[R].possiblyEvaluate(a,h,y);return w}hasTransition(){for(let a of Object.keys(this._values))if(this._values[a].prior)return!0;return!1}}class hb{constructor(a){this._properties=a,this._values=Object.create(a.defaultPropertyValues)}hasValue(a){return this._values[a].value!==void 0}getValue(a){return Et(this._values[a].value)}setValue(a,h){this._values[a]=new X0(this._values[a].property,h===null?void 0:Et(h))}serialize(){let a={};for(let h of Object.keys(this._values)){let y=this.getValue(h);y!==void 0&&(a[h]=y)}return a}possiblyEvaluate(a,h,y){let w=new Z0(this._properties);for(let R of Object.keys(this._values))w._values[R]=this._values[R].possiblyEvaluate(a,h,y);return w}}class $o{constructor(a,h,y){this.property=a,this.value=h,this.parameters=y}isConstant(){return this.value.kind==="constant"}constantOr(a){return this.value.kind==="constant"?this.value.value:a}evaluate(a,h,y,w){return this.property.evaluate(this.value,this.parameters,a,h,y,w)}}class Z0{constructor(a){this._properties=a,this._values=Object.create(a.defaultPossiblyEvaluatedValues)}get(a){return this._values[a]}}class cr{constructor(a){this.specification=a}possiblyEvaluate(a,h){if(a.isDataDriven())throw new Error("Value should not be data driven");return a.expression.evaluate(h)}interpolate(a,h,y){let w=Ja[this.specification.type];return w?w(a,h,y):a}}class Rr{constructor(a,h){this.specification=a,this.overrides=h}possiblyEvaluate(a,h,y,w){return new $o(this,a.expression.kind==="constant"||a.expression.kind==="camera"?{kind:"constant",value:a.expression.evaluate(h,null,{},y,w)}:a.expression,h)}interpolate(a,h,y){if(a.value.kind!=="constant"||h.value.kind!=="constant")return a;if(a.value.value===void 0||h.value.value===void 0)return new $o(this,{kind:"constant",value:void 0},a.parameters);let w=Ja[this.specification.type];if(w){let R=w(a.value.value,h.value.value,y);return new $o(this,{kind:"constant",value:R},a.parameters)}return a}evaluate(a,h,y,w,R,k){return a.kind==="constant"?a.value:a.evaluate(h,y,w,R,k)}}class wh extends Rr{possiblyEvaluate(a,h,y,w){if(a.value===void 0)return new $o(this,{kind:"constant",value:void 0},h);if(a.expression.kind==="constant"){let R=a.expression.evaluate(h,null,{},y,w),k=a.property.specification.type==="resolvedImage"&&typeof R!="string"?R.name:R,F=this._calculate(k,k,k,h);return new $o(this,{kind:"constant",value:F},h)}if(a.expression.kind==="camera"){let R=this._calculate(a.expression.evaluate({zoom:h.zoom-1}),a.expression.evaluate({zoom:h.zoom}),a.expression.evaluate({zoom:h.zoom+1}),h);return new $o(this,{kind:"constant",value:R},h)}return new $o(this,a.expression,h)}evaluate(a,h,y,w,R,k){if(a.kind==="source"){let F=a.evaluate(h,y,w,R,k);return this._calculate(F,F,F,h)}return a.kind==="composite"?this._calculate(a.evaluate({zoom:Math.floor(h.zoom)-1},y,w),a.evaluate({zoom:Math.floor(h.zoom)},y,w),a.evaluate({zoom:Math.floor(h.zoom)+1},y,w),h):a.value}_calculate(a,h,y,w){return w.zoom>w.zoomHistory.lastIntegerZoom?{from:a,to:h}:{from:y,to:h}}interpolate(a){return a}}class G0{constructor(a){this.specification=a}possiblyEvaluate(a,h,y,w){if(a.value!==void 0){if(a.expression.kind==="constant"){let R=a.expression.evaluate(h,null,{},y,w);return this._calculate(R,R,R,h)}return this._calculate(a.expression.evaluate(new Wn(Math.floor(h.zoom-1),h)),a.expression.evaluate(new Wn(Math.floor(h.zoom),h)),a.expression.evaluate(new Wn(Math.floor(h.zoom+1),h)),h)}}_calculate(a,h,y,w){return w.zoom>w.zoomHistory.lastIntegerZoom?{from:a,to:h}:{from:y,to:h}}interpolate(a){return a}}class yu{constructor(a){this.specification=a}possiblyEvaluate(a,h,y,w){return!!a.expression.evaluate(h,null,{},y,w)}interpolate(){return!1}}class Ps{constructor(a){this.properties=a,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(let h in a){let y=a[h];y.specification.overridable&&this.overridableProperties.push(h);let w=this.defaultPropertyValues[h]=new X0(y,void 0),R=this.defaultTransitionablePropertyValues[h]=new Jm(y);this.defaultTransitioningPropertyValues[h]=R.untransitioned(),this.defaultPossiblyEvaluatedValues[h]=w.possiblyEvaluate({})}}}Ve("DataDrivenProperty",Rr),Ve("DataConstantProperty",cr),Ve("CrossFadedDataDrivenProperty",wh),Ve("CrossFadedProperty",G0),Ve("ColorRampProperty",yu);let ld="-transition";class Ea extends Sr{constructor(a,h){if(super(),this.id=a.id,this.type=a.type,this._featureFilter={filter:()=>!0,needGeometry:!1},a.type!=="custom"&&(this.metadata=a.metadata,this.minzoom=a.minzoom,this.maxzoom=a.maxzoom,a.type!=="background"&&(this.source=a.source,this.sourceLayer=a["source-layer"],this.filter=a.filter),h.layout&&(this._unevaluatedLayout=new hb(h.layout)),h.paint)){this._transitionablePaint=new q_(h.paint);for(let y in a.paint)this.setPaintProperty(y,a.paint[y],{validate:!1});for(let y in a.layout)this.setLayoutProperty(y,a.layout[y],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Z0(h.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(a){return a==="visibility"?this.visibility:this._unevaluatedLayout.getValue(a)}setLayoutProperty(a,h,y={}){h!=null&&this._validate(qm,`layers.${this.id}.layout.${a}`,a,h,y)||(a!=="visibility"?this._unevaluatedLayout.setValue(a,h):this.visibility=h)}getPaintProperty(a){return a.endsWith(ld)?this._transitionablePaint.getTransition(a.slice(0,-11)):this._transitionablePaint.getValue(a)}setPaintProperty(a,h,y={}){if(h!=null&&this._validate(H0,`layers.${this.id}.paint.${a}`,a,h,y))return!1;if(a.endsWith(ld))return this._transitionablePaint.setTransition(a.slice(0,-11),h||void 0),!1;{let w=this._transitionablePaint._values[a],R=w.property.specification["property-type"]==="cross-faded-data-driven",k=w.value.isDataDriven(),F=w.value;this._transitionablePaint.setValue(a,h),this._handleSpecialPaintPropertyUpdate(a);let j=this._transitionablePaint._values[a].value;return j.isDataDriven()||k||R||this._handleOverridablePaintPropertyUpdate(a,F,j)}}_handleSpecialPaintPropertyUpdate(a){}_handleOverridablePaintPropertyUpdate(a,h,y){return!1}isHidden(a){return!!(this.minzoom&&a<this.minzoom)||!!(this.maxzoom&&a>=this.maxzoom)||this.visibility==="none"}updateTransitions(a){this._transitioningPaint=this._transitionablePaint.transitioned(a,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(a,h){a.getCrossfadeParameters&&(this._crossfadeParameters=a.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(a,void 0,h)),this.paint=this._transitioningPaint.possiblyEvaluate(a,void 0,h)}serialize(){let a={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(a.layout=a.layout||{},a.layout.visibility=this.visibility),kt(a,(h,y)=>!(h===void 0||y==="layout"&&!Object.keys(h).length||y==="paint"&&!Object.keys(h).length))}_validate(a,h,y,w,R={}){return(!R||R.validate!==!1)&&W0(this,a.call(Lc,{key:h,layerType:this.type,objectKey:y,value:w,styleSpec:ae,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(let a in this.paint._values){let h=this.paint.get(a);if(h instanceof $o&&Pr(h.property.specification)&&(h.value.kind==="source"||h.value.kind==="composite")&&h.value.isStateDependent)return!0}return!1}}let X_={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class xu{constructor(a,h){this._structArray=a,this._pos1=h*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Gn{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(a,h){return a._trim(),h&&(a.isTransferred=!0,h.push(a.arrayBuffer)),{length:a.length,arrayBuffer:a.arrayBuffer}}static deserialize(a){let h=Object.create(this.prototype);return h.arrayBuffer=a.arrayBuffer,h.length=a.length,h.capacity=a.arrayBuffer.byteLength/h.bytesPerElement,h._refreshViews(),h}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(a){this.reserve(a),this.length=a}reserve(a){if(a>this.capacity){this.capacity=Math.max(a,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);let h=this.uint8;this._refreshViews(),h&&this.uint8.set(h)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function qn(u,a=1){let h=0,y=0;return{members:u.map(w=>{let R=X_[w.type].BYTES_PER_ELEMENT,k=h=Vc(h,Math.max(a,R)),F=w.components||1;return y=Math.max(y,R),h+=R*F,{name:w.name,type:w.type,components:F,offset:k}}),size:Vc(h,Math.max(y,a)),alignment:a}}function Vc(u,a){return Math.ceil(u/a)*a}class wn extends Gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,h){let y=this.length;return this.resize(y+1),this.emplace(y,a,h)}emplace(a,h,y){let w=2*a;return this.int16[w+0]=h,this.int16[w+1]=y,a}}wn.prototype.bytesPerElement=4,Ve("StructArrayLayout2i4",wn);class cd extends Gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,h,y){let w=this.length;return this.resize(w+1),this.emplace(w,a,h,y)}emplace(a,h,y,w){let R=3*a;return this.int16[R+0]=h,this.int16[R+1]=y,this.int16[R+2]=w,a}}cd.prototype.bytesPerElement=6,Ve("StructArrayLayout3i6",cd);class Th extends Gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,h,y,w){let R=this.length;return this.resize(R+1),this.emplace(R,a,h,y,w)}emplace(a,h,y,w,R){let k=4*a;return this.int16[k+0]=h,this.int16[k+1]=y,this.int16[k+2]=w,this.int16[k+3]=R,a}}Th.prototype.bytesPerElement=8,Ve("StructArrayLayout4i8",Th);class tg extends Gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,h,y,w,R,k){let F=this.length;return this.resize(F+1),this.emplace(F,a,h,y,w,R,k)}emplace(a,h,y,w,R,k,F){let j=6*a;return this.int16[j+0]=h,this.int16[j+1]=y,this.int16[j+2]=w,this.int16[j+3]=R,this.int16[j+4]=k,this.int16[j+5]=F,a}}tg.prototype.bytesPerElement=12,Ve("StructArrayLayout2i4i12",tg);class eg extends Gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,h,y,w,R,k){let F=this.length;return this.resize(F+1),this.emplace(F,a,h,y,w,R,k)}emplace(a,h,y,w,R,k,F){let j=4*a,q=8*a;return this.int16[j+0]=h,this.int16[j+1]=y,this.uint8[q+4]=w,this.uint8[q+5]=R,this.uint8[q+6]=k,this.uint8[q+7]=F,a}}eg.prototype.bytesPerElement=8,Ve("StructArrayLayout2i4ub8",eg);class Mf extends Gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,h){let y=this.length;return this.resize(y+1),this.emplace(y,a,h)}emplace(a,h,y){let w=2*a;return this.float32[w+0]=h,this.float32[w+1]=y,a}}Mf.prototype.bytesPerElement=8,Ve("StructArrayLayout2f8",Mf);class rg extends Gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,h,y,w,R,k,F,j,q,K){let et=this.length;return this.resize(et+1),this.emplace(et,a,h,y,w,R,k,F,j,q,K)}emplace(a,h,y,w,R,k,F,j,q,K,et){let it=10*a;return this.uint16[it+0]=h,this.uint16[it+1]=y,this.uint16[it+2]=w,this.uint16[it+3]=R,this.uint16[it+4]=k,this.uint16[it+5]=F,this.uint16[it+6]=j,this.uint16[it+7]=q,this.uint16[it+8]=K,this.uint16[it+9]=et,a}}rg.prototype.bytesPerElement=20,Ve("StructArrayLayout10ui20",rg);class ig extends Gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,h,y,w,R,k,F,j,q,K,et,it){let ct=this.length;return this.resize(ct+1),this.emplace(ct,a,h,y,w,R,k,F,j,q,K,et,it)}emplace(a,h,y,w,R,k,F,j,q,K,et,it,ct){let ht=12*a;return this.int16[ht+0]=h,this.int16[ht+1]=y,this.int16[ht+2]=w,this.int16[ht+3]=R,this.uint16[ht+4]=k,this.uint16[ht+5]=F,this.uint16[ht+6]=j,this.uint16[ht+7]=q,this.int16[ht+8]=K,this.int16[ht+9]=et,this.int16[ht+10]=it,this.int16[ht+11]=ct,a}}ig.prototype.bytesPerElement=24,Ve("StructArrayLayout4i4ui4i24",ig);class ii extends Gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,h,y){let w=this.length;return this.resize(w+1),this.emplace(w,a,h,y)}emplace(a,h,y,w){let R=3*a;return this.float32[R+0]=h,this.float32[R+1]=y,this.float32[R+2]=w,a}}ii.prototype.bytesPerElement=12,Ve("StructArrayLayout3f12",ii);class M extends Gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(a){let h=this.length;return this.resize(h+1),this.emplace(h,a)}emplace(a,h){return this.uint32[1*a+0]=h,a}}M.prototype.bytesPerElement=4,Ve("StructArrayLayout1ul4",M);class l extends Gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,h,y,w,R,k,F,j,q){let K=this.length;return this.resize(K+1),this.emplace(K,a,h,y,w,R,k,F,j,q)}emplace(a,h,y,w,R,k,F,j,q,K){let et=10*a,it=5*a;return this.int16[et+0]=h,this.int16[et+1]=y,this.int16[et+2]=w,this.int16[et+3]=R,this.int16[et+4]=k,this.int16[et+5]=F,this.uint32[it+3]=j,this.uint16[et+8]=q,this.uint16[et+9]=K,a}}l.prototype.bytesPerElement=20,Ve("StructArrayLayout6i1ul2ui20",l);class m extends Gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,h,y,w,R,k){let F=this.length;return this.resize(F+1),this.emplace(F,a,h,y,w,R,k)}emplace(a,h,y,w,R,k,F){let j=6*a;return this.int16[j+0]=h,this.int16[j+1]=y,this.int16[j+2]=w,this.int16[j+3]=R,this.int16[j+4]=k,this.int16[j+5]=F,a}}m.prototype.bytesPerElement=12,Ve("StructArrayLayout2i2i2i12",m);class v extends Gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(a,h,y,w,R){let k=this.length;return this.resize(k+1),this.emplace(k,a,h,y,w,R)}emplace(a,h,y,w,R,k){let F=4*a,j=8*a;return this.float32[F+0]=h,this.float32[F+1]=y,this.float32[F+2]=w,this.int16[j+6]=R,this.int16[j+7]=k,a}}v.prototype.bytesPerElement=16,Ve("StructArrayLayout2f1f2i16",v);class S extends Gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,h,y,w){let R=this.length;return this.resize(R+1),this.emplace(R,a,h,y,w)}emplace(a,h,y,w,R){let k=12*a,F=3*a;return this.uint8[k+0]=h,this.uint8[k+1]=y,this.float32[F+1]=w,this.float32[F+2]=R,a}}S.prototype.bytesPerElement=12,Ve("StructArrayLayout2ub2f12",S);class C extends Gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,h,y){let w=this.length;return this.resize(w+1),this.emplace(w,a,h,y)}emplace(a,h,y,w){let R=3*a;return this.uint16[R+0]=h,this.uint16[R+1]=y,this.uint16[R+2]=w,a}}C.prototype.bytesPerElement=6,Ve("StructArrayLayout3ui6",C);class L extends Gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,h,y,w,R,k,F,j,q,K,et,it,ct,ht,vt,Nt,Ut){let Kt=this.length;return this.resize(Kt+1),this.emplace(Kt,a,h,y,w,R,k,F,j,q,K,et,it,ct,ht,vt,Nt,Ut)}emplace(a,h,y,w,R,k,F,j,q,K,et,it,ct,ht,vt,Nt,Ut,Kt){let Ht=24*a,Jt=12*a,le=48*a;return this.int16[Ht+0]=h,this.int16[Ht+1]=y,this.uint16[Ht+2]=w,this.uint16[Ht+3]=R,this.uint32[Jt+2]=k,this.uint32[Jt+3]=F,this.uint32[Jt+4]=j,this.uint16[Ht+10]=q,this.uint16[Ht+11]=K,this.uint16[Ht+12]=et,this.float32[Jt+7]=it,this.float32[Jt+8]=ct,this.uint8[le+36]=ht,this.uint8[le+37]=vt,this.uint8[le+38]=Nt,this.uint32[Jt+10]=Ut,this.int16[Ht+22]=Kt,a}}L.prototype.bytesPerElement=48,Ve("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",L);class V extends Gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,h,y,w,R,k,F,j,q,K,et,it,ct,ht,vt,Nt,Ut,Kt,Ht,Jt,le,ve,Ke,dr,Qe,Ye,je,sr){let He=this.length;return this.resize(He+1),this.emplace(He,a,h,y,w,R,k,F,j,q,K,et,it,ct,ht,vt,Nt,Ut,Kt,Ht,Jt,le,ve,Ke,dr,Qe,Ye,je,sr)}emplace(a,h,y,w,R,k,F,j,q,K,et,it,ct,ht,vt,Nt,Ut,Kt,Ht,Jt,le,ve,Ke,dr,Qe,Ye,je,sr,He){let Re=32*a,Mr=16*a;return this.int16[Re+0]=h,this.int16[Re+1]=y,this.int16[Re+2]=w,this.int16[Re+3]=R,this.int16[Re+4]=k,this.int16[Re+5]=F,this.int16[Re+6]=j,this.int16[Re+7]=q,this.uint16[Re+8]=K,this.uint16[Re+9]=et,this.uint16[Re+10]=it,this.uint16[Re+11]=ct,this.uint16[Re+12]=ht,this.uint16[Re+13]=vt,this.uint16[Re+14]=Nt,this.uint16[Re+15]=Ut,this.uint16[Re+16]=Kt,this.uint16[Re+17]=Ht,this.uint16[Re+18]=Jt,this.uint16[Re+19]=le,this.uint16[Re+20]=ve,this.uint16[Re+21]=Ke,this.uint16[Re+22]=dr,this.uint32[Mr+12]=Qe,this.float32[Mr+13]=Ye,this.float32[Mr+14]=je,this.uint16[Re+30]=sr,this.uint16[Re+31]=He,a}}V.prototype.bytesPerElement=64,Ve("StructArrayLayout8i15ui1ul2f2ui64",V);class $ extends Gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a){let h=this.length;return this.resize(h+1),this.emplace(h,a)}emplace(a,h){return this.float32[1*a+0]=h,a}}$.prototype.bytesPerElement=4,Ve("StructArrayLayout1f4",$);class X extends Gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,h,y){let w=this.length;return this.resize(w+1),this.emplace(w,a,h,y)}emplace(a,h,y,w){let R=3*a;return this.uint16[6*a+0]=h,this.float32[R+1]=y,this.float32[R+2]=w,a}}X.prototype.bytesPerElement=12,Ve("StructArrayLayout1ui2f12",X);class J extends Gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,h,y){let w=this.length;return this.resize(w+1),this.emplace(w,a,h,y)}emplace(a,h,y,w){let R=4*a;return this.uint32[2*a+0]=h,this.uint16[R+2]=y,this.uint16[R+3]=w,a}}J.prototype.bytesPerElement=8,Ve("StructArrayLayout1ul2ui8",J);class tt extends Gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a,h){let y=this.length;return this.resize(y+1),this.emplace(y,a,h)}emplace(a,h,y){let w=2*a;return this.uint16[w+0]=h,this.uint16[w+1]=y,a}}tt.prototype.bytesPerElement=4,Ve("StructArrayLayout2ui4",tt);class lt extends Gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(a){let h=this.length;return this.resize(h+1),this.emplace(h,a)}emplace(a,h){return this.uint16[1*a+0]=h,a}}lt.prototype.bytesPerElement=2,Ve("StructArrayLayout1ui2",lt);class bt extends Gn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(a,h,y,w){let R=this.length;return this.resize(R+1),this.emplace(R,a,h,y,w)}emplace(a,h,y,w,R){let k=4*a;return this.float32[k+0]=h,this.float32[k+1]=y,this.float32[k+2]=w,this.float32[k+3]=R,a}}bt.prototype.bytesPerElement=16,Ve("StructArrayLayout4f16",bt);class yt extends xu{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new x(this.anchorPointX,this.anchorPointY)}}yt.prototype.size=20;class Ct extends l{get(a){return new yt(this,a)}}Ve("CollisionBoxArray",Ct);class _t extends xu{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(a){this._structArray.uint8[this._pos1+37]=a}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(a){this._structArray.uint8[this._pos1+38]=a}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(a){this._structArray.uint32[this._pos4+10]=a}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}_t.prototype.size=48;class Zt extends L{get(a){return new _t(this,a)}}Ve("PlacedSymbolArray",Zt);class ne extends xu{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(a){this._structArray.uint32[this._pos4+12]=a}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}ne.prototype.size=64;class Ot extends V{get(a){return new ne(this,a)}}Ve("SymbolInstanceArray",Ot);class Gt extends ${getoffsetX(a){return this.float32[1*a+0]}}Ve("GlyphOffsetArray",Gt);class he extends cd{getx(a){return this.int16[3*a+0]}gety(a){return this.int16[3*a+1]}gettileUnitDistanceFromAnchor(a){return this.int16[3*a+2]}}Ve("SymbolLineVertexArray",he);class ce extends xu{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}ce.prototype.size=12;class xe extends X{get(a){return new ce(this,a)}}Ve("TextAnchorOffsetArray",xe);class Pe extends xu{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Pe.prototype.size=8;class Te extends J{get(a){return new Pe(this,a)}}Ve("FeatureIndexArray",Te);class Fe extends wn{}class ur extends wn{}class ki extends wn{}class We extends tg{}class Ir extends eg{}class hr extends Mf{}class pn extends rg{}class Mi extends ig{}class ui extends ii{}class Di extends M{}class bs extends m{}class Ln extends S{}class go extends C{}class qs extends tt{}let vs=qn([{name:"a_pos",components:2,type:"Int16"}],4),{members:Ia}=vs;class zn{constructor(a=[]){this.segments=a}prepareSegment(a,h,y,w){let R=this.segments[this.segments.length-1];return a>zn.MAX_VERTEX_ARRAY_LENGTH&&oe(`Max vertices per segment is ${zn.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${a}`),(!R||R.vertexLength+a>zn.MAX_VERTEX_ARRAY_LENGTH||R.sortKey!==w)&&(R={vertexOffset:h.length,primitiveOffset:y.length,vertexLength:0,primitiveLength:0},w!==void 0&&(R.sortKey=w),this.segments.push(R)),R}get(){return this.segments}destroy(){for(let a of this.segments)for(let h in a.vaos)a.vaos[h].destroy()}static simpleSegment(a,h,y,w){return new zn([{vertexOffset:a,primitiveOffset:h,vertexLength:y,primitiveLength:w,vaos:{},sortKey:0}])}}function io(u,a){return 256*(u=Y(Math.floor(u),0,255))+Y(Math.floor(a),0,255)}zn.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Ve("SegmentVector",zn);let Sl=qn([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var bu={exports:{}},Sh={exports:{}};Sh.exports=function(u,a){var h,y,w,R,k,F,j,q;for(y=u.length-(h=3&u.length),w=a,k=3432918353,F=461845907,q=0;q<y;)j=255&u.charCodeAt(q)|(255&u.charCodeAt(++q))<<8|(255&u.charCodeAt(++q))<<16|(255&u.charCodeAt(++q))<<24,++q,w=27492+(65535&(R=5*(65535&(w=(w^=j=(65535&(j=(j=(65535&j)*k+(((j>>>16)*k&65535)<<16)&4294967295)<<15|j>>>17))*F+(((j>>>16)*F&65535)<<16)&4294967295)<<13|w>>>19))+((5*(w>>>16)&65535)<<16)&4294967295))+((58964+(R>>>16)&65535)<<16);switch(j=0,h){case 3:j^=(255&u.charCodeAt(q+2))<<16;case 2:j^=(255&u.charCodeAt(q+1))<<8;case 1:w^=j=(65535&(j=(j=(65535&(j^=255&u.charCodeAt(q)))*k+(((j>>>16)*k&65535)<<16)&4294967295)<<15|j>>>17))*F+(((j>>>16)*F&65535)<<16)&4294967295}return w^=u.length,w=2246822507*(65535&(w^=w>>>16))+((2246822507*(w>>>16)&65535)<<16)&4294967295,w=3266489909*(65535&(w^=w>>>13))+((3266489909*(w>>>16)&65535)<<16)&4294967295,(w^=w>>>16)>>>0};var Cf=Sh.exports,Do={exports:{}};Do.exports=function(u,a){for(var h,y=u.length,w=a^y,R=0;y>=4;)h=1540483477*(65535&(h=255&u.charCodeAt(R)|(255&u.charCodeAt(++R))<<8|(255&u.charCodeAt(++R))<<16|(255&u.charCodeAt(++R))<<24))+((1540483477*(h>>>16)&65535)<<16),w=1540483477*(65535&w)+((1540483477*(w>>>16)&65535)<<16)^(h=1540483477*(65535&(h^=h>>>24))+((1540483477*(h>>>16)&65535)<<16)),y-=4,++R;switch(y){case 3:w^=(255&u.charCodeAt(R+2))<<16;case 2:w^=(255&u.charCodeAt(R+1))<<8;case 1:w=1540483477*(65535&(w^=255&u.charCodeAt(R)))+((1540483477*(w>>>16)&65535)<<16)}return w=1540483477*(65535&(w^=w>>>13))+((1540483477*(w>>>16)&65535)<<16),(w^=w>>>15)>>>0};var _o=Cf,ws=Do.exports;bu.exports=_o,bu.exports.murmur3=_o,bu.exports.murmur2=ws;var vu=c(bu.exports);class us{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(a,h,y,w){this.ids.push(Ys(a)),this.positions.push(h,y,w)}getPositions(a){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");let h=Ys(a),y=0,w=this.ids.length-1;for(;y<w;){let k=y+w>>1;this.ids[k]>=h?w=k:y=k+1}let R=[];for(;this.ids[y]===h;)R.push({index:this.positions[3*y],start:this.positions[3*y+1],end:this.positions[3*y+2]}),y++;return R}static serialize(a,h){let y=new Float64Array(a.ids),w=new Uint32Array(a.positions);return oa(y,w,0,y.length-1),h&&h.push(y.buffer,w.buffer),{ids:y,positions:w}}static deserialize(a){let h=new us;return h.ids=a.ids,h.positions=a.positions,h.indexed=!0,h}}function Ys(u){let a=+u;return!isNaN(a)&&a<=Number.MAX_SAFE_INTEGER?a:vu(String(u))}function oa(u,a,h,y){for(;h<y;){let w=u[h+y>>1],R=h-1,k=y+1;for(;;){do R++;while(u[R]<w);do k--;while(u[k]>w);if(R>=k)break;Ts(u,R,k),Ts(a,3*R,3*k),Ts(a,3*R+1,3*k+1),Ts(a,3*R+2,3*k+2)}k-h<y-k?(oa(u,a,h,k),h=k+1):(oa(u,a,k+1,y),y=k)}}function Ts(u,a,h){let y=u[a];u[a]=u[h],u[h]=y}Ve("FeaturePositionMap",us);class Eh{constructor(a,h){this.gl=a.gl,this.location=h}}class Q0 extends Eh{constructor(a,h){super(a,h),this.current=0}set(a){this.current!==a&&(this.current=a,this.gl.uniform1f(this.location,a))}}class Z_ extends Eh{constructor(a,h){super(a,h),this.current=[0,0,0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]&&a[2]===this.current[2]&&a[3]===this.current[3]||(this.current=a,this.gl.uniform4f(this.location,a[0],a[1],a[2],a[3]))}}class G_ extends Eh{constructor(a,h){super(a,h),this.current=Hi.transparent}set(a){a.r===this.current.r&&a.g===this.current.g&&a.b===this.current.b&&a.a===this.current.a||(this.current=a,this.gl.uniform4f(this.location,a.r,a.g,a.b,a.a))}}let fb=new Float32Array(16);function ng(u){return[io(255*u.r,255*u.g),io(255*u.b,255*u.a)]}class nc{constructor(a,h,y){this.value=a,this.uniformNames=h.map(w=>`u_${w}`),this.type=y}setUniform(a,h,y){a.set(y.constantOr(this.value))}getBinding(a,h,y){return this.type==="color"?new G_(a,h):new Q0(a,h)}}class Ih{constructor(a,h){this.uniformNames=h.map(y=>`u_${y}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(a,h){this.pixelRatioFrom=h.pixelRatio,this.pixelRatioTo=a.pixelRatio,this.patternFrom=h.tlbr,this.patternTo=a.tlbr}setUniform(a,h,y,w){let R=w==="u_pattern_to"?this.patternTo:w==="u_pattern_from"?this.patternFrom:w==="u_pixel_ratio_to"?this.pixelRatioTo:w==="u_pixel_ratio_from"?this.pixelRatioFrom:null;R&&a.set(R)}getBinding(a,h,y){return y.substr(0,9)==="u_pattern"?new Z_(a,h):new Q0(a,h)}}class El{constructor(a,h,y,w){this.expression=a,this.type=y,this.maxValue=0,this.paintVertexAttributes=h.map(R=>({name:`a_${R}`,type:"Float32",components:y==="color"?2:1,offset:0})),this.paintVertexArray=new w}populatePaintArray(a,h,y,w,R){let k=this.paintVertexArray.length,F=this.expression.evaluate(new Wn(0),h,{},w,[],R);this.paintVertexArray.resize(a),this._setPaintValue(k,a,F)}updatePaintArray(a,h,y,w){let R=this.expression.evaluate({zoom:0},y,w);this._setPaintValue(a,h,R)}_setPaintValue(a,h,y){if(this.type==="color"){let w=ng(y);for(let R=a;R<h;R++)this.paintVertexArray.emplace(R,w[0],w[1])}else{for(let w=a;w<h;w++)this.paintVertexArray.emplace(w,y);this.maxValue=Math.max(this.maxValue,Math.abs(y))}}upload(a){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Ma{constructor(a,h,y,w,R,k){this.expression=a,this.uniformNames=h.map(F=>`u_${F}_t`),this.type=y,this.useIntegerZoom=w,this.zoom=R,this.maxValue=0,this.paintVertexAttributes=h.map(F=>({name:`a_${F}`,type:"Float32",components:y==="color"?4:2,offset:0})),this.paintVertexArray=new k}populatePaintArray(a,h,y,w,R){let k=this.expression.evaluate(new Wn(this.zoom),h,{},w,[],R),F=this.expression.evaluate(new Wn(this.zoom+1),h,{},w,[],R),j=this.paintVertexArray.length;this.paintVertexArray.resize(a),this._setPaintValue(j,a,k,F)}updatePaintArray(a,h,y,w){let R=this.expression.evaluate({zoom:this.zoom},y,w),k=this.expression.evaluate({zoom:this.zoom+1},y,w);this._setPaintValue(a,h,R,k)}_setPaintValue(a,h,y,w){if(this.type==="color"){let R=ng(y),k=ng(w);for(let F=a;F<h;F++)this.paintVertexArray.emplace(F,R[0],R[1],k[0],k[1])}else{for(let R=a;R<h;R++)this.paintVertexArray.emplace(R,y,w);this.maxValue=Math.max(this.maxValue,Math.abs(y),Math.abs(w))}}upload(a){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=a.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(a,h){let y=this.useIntegerZoom?Math.floor(h.zoom):h.zoom,w=Y(this.expression.interpolationFactor(y,this.zoom,this.zoom+1),0,1);a.set(w)}getBinding(a,h,y){return new Q0(a,h)}}class In{constructor(a,h,y,w,R,k){this.expression=a,this.type=h,this.useIntegerZoom=y,this.zoom=w,this.layerId=k,this.zoomInPaintVertexArray=new R,this.zoomOutPaintVertexArray=new R}populatePaintArray(a,h,y){let w=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(a),this.zoomOutPaintVertexArray.resize(a),this._setPaintValues(w,a,h.patterns&&h.patterns[this.layerId],y)}updatePaintArray(a,h,y,w,R){this._setPaintValues(a,h,y.patterns&&y.patterns[this.layerId],R)}_setPaintValues(a,h,y,w){if(!w||!y)return;let{min:R,mid:k,max:F}=y,j=w[R],q=w[k],K=w[F];if(j&&q&&K)for(let et=a;et<h;et++)this.zoomInPaintVertexArray.emplace(et,q.tl[0],q.tl[1],q.br[0],q.br[1],j.tl[0],j.tl[1],j.br[0],j.br[1],q.pixelRatio,j.pixelRatio),this.zoomOutPaintVertexArray.emplace(et,q.tl[0],q.tl[1],q.br[0],q.br[1],K.tl[0],K.tl[1],K.br[0],K.br[1],q.pixelRatio,K.pixelRatio)}upload(a){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=a.createVertexBuffer(this.zoomInPaintVertexArray,Sl.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=a.createVertexBuffer(this.zoomOutPaintVertexArray,Sl.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class sg{constructor(a,h,y){this.binders={},this._buffers=[];let w=[];for(let R in a.paint._values){if(!y(R))continue;let k=a.paint.get(R);if(!(k instanceof $o&&Pr(k.property.specification)))continue;let F=og(R,a.type),j=k.value,q=k.property.specification.type,K=k.property.useIntegerZoom,et=k.property.specification["property-type"],it=et==="cross-faded"||et==="cross-faded-data-driven";if(j.kind==="constant")this.binders[R]=it?new Ih(j.value,F):new nc(j.value,F,q),w.push(`/u_${R}`);else if(j.kind==="source"||it){let ct=Il(R,q,"source");this.binders[R]=it?new In(j,q,K,h,ct,a.id):new El(j,F,q,ct),w.push(`/a_${R}`)}else{let ct=Il(R,q,"composite");this.binders[R]=new Ma(j,F,q,K,h,ct),w.push(`/z_${R}`)}}this.cacheKey=w.sort().join("")}getMaxValue(a){let h=this.binders[a];return h instanceof El||h instanceof Ma?h.maxValue:0}populatePaintArrays(a,h,y,w,R){for(let k in this.binders){let F=this.binders[k];(F instanceof El||F instanceof Ma||F instanceof In)&&F.populatePaintArray(a,h,y,w,R)}}setConstantPatternPositions(a,h){for(let y in this.binders){let w=this.binders[y];w instanceof Ih&&w.setConstantPatternPositions(a,h)}}updatePaintArrays(a,h,y,w,R){let k=!1;for(let F in a){let j=h.getPositions(F);for(let q of j){let K=y.feature(q.index);for(let et in this.binders){let it=this.binders[et];if((it instanceof El||it instanceof Ma||it instanceof In)&&it.expression.isStateDependent===!0){let ct=w.paint.get(et);it.expression=ct.value,it.updatePaintArray(q.start,q.end,K,a[F],R),k=!0}}}}return k}defines(){let a=[];for(let h in this.binders){let y=this.binders[h];(y instanceof nc||y instanceof Ih)&&a.push(...y.uniformNames.map(w=>`#define HAS_UNIFORM_${w}`))}return a}getBinderAttributes(){let a=[];for(let h in this.binders){let y=this.binders[h];if(y instanceof El||y instanceof Ma)for(let w=0;w<y.paintVertexAttributes.length;w++)a.push(y.paintVertexAttributes[w].name);else if(y instanceof In)for(let w=0;w<Sl.members.length;w++)a.push(Sl.members[w].name)}return a}getBinderUniforms(){let a=[];for(let h in this.binders){let y=this.binders[h];if(y instanceof nc||y instanceof Ih||y instanceof Ma)for(let w of y.uniformNames)a.push(w)}return a}getPaintVertexBuffers(){return this._buffers}getUniforms(a,h){let y=[];for(let w in this.binders){let R=this.binders[w];if(R instanceof nc||R instanceof Ih||R instanceof Ma){for(let k of R.uniformNames)if(h[k]){let F=R.getBinding(a,h[k],k);y.push({name:k,property:w,binding:F})}}}return y}setUniforms(a,h,y,w){for(let{name:R,property:k,binding:F}of h)this.binders[k].setUniform(F,w,y.get(k),R)}updatePaintBuffers(a){this._buffers=[];for(let h in this.binders){let y=this.binders[h];if(a&&y instanceof In){let w=a.fromScale===2?y.zoomInPaintVertexBuffer:y.zoomOutPaintVertexBuffer;w&&this._buffers.push(w)}else(y instanceof El||y instanceof Ma)&&y.paintVertexBuffer&&this._buffers.push(y.paintVertexBuffer)}}upload(a){for(let h in this.binders){let y=this.binders[h];(y instanceof El||y instanceof Ma||y instanceof In)&&y.upload(a)}this.updatePaintBuffers()}destroy(){for(let a in this.binders){let h=this.binders[a];(h instanceof El||h instanceof Ma||h instanceof In)&&h.destroy()}}}class jc{constructor(a,h,y=()=>!0){this.programConfigurations={};for(let w of a)this.programConfigurations[w.id]=new sg(w,h,y);this.needsUpload=!1,this._featureMap=new us,this._bufferOffset=0}populatePaintArrays(a,h,y,w,R,k){for(let F in this.programConfigurations)this.programConfigurations[F].populatePaintArrays(a,h,w,R,k);h.id!==void 0&&this._featureMap.add(h.id,y,this._bufferOffset,a),this._bufferOffset=a,this.needsUpload=!0}updatePaintArrays(a,h,y,w){for(let R of y)this.needsUpload=this.programConfigurations[R.id].updatePaintArrays(a,this._featureMap,h,R,w)||this.needsUpload}get(a){return this.programConfigurations[a]}upload(a){if(this.needsUpload){for(let h in this.programConfigurations)this.programConfigurations[h].upload(a);this.needsUpload=!1}}destroy(){for(let a in this.programConfigurations)this.programConfigurations[a].destroy()}}function og(u,a){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[u]||[u.replace(`${a}-`,"").replace(/-/g,"_")]}function Il(u,a,h){let y={color:{source:Mf,composite:bt},number:{source:$,composite:Mf}},w=function(R){return{"line-pattern":{source:pn,composite:pn},"fill-pattern":{source:pn,composite:pn},"fill-extrusion-pattern":{source:pn,composite:pn}}[R]}(u);return w&&w[h]||y[a][h]}Ve("ConstantBinder",nc),Ve("CrossFadedConstantBinder",Ih),Ve("SourceExpressionBinder",El),Ve("CrossFadedCompositeBinder",In),Ve("CompositeExpressionBinder",Ma),Ve("ProgramConfiguration",sg,{omit:["_buffers"]}),Ve("ProgramConfigurationSet",jc);let Fs=8192,pb=Math.pow(2,14)-1,DT=-pb-1;function Pf(u){let a=Fs/u.extent,h=u.loadGeometry();for(let y=0;y<h.length;y++){let w=h[y];for(let R=0;R<w.length;R++){let k=w[R],F=Math.round(k.x*a),j=Math.round(k.y*a);k.x=Y(F,DT,pb),k.y=Y(j,DT,pb),(F<k.x||F>k.x+1||j<k.y||j>k.y+1)&&oe("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return h}function Rf(u,a){return{type:u.type,id:u.id,properties:u.properties,geometry:a?Pf(u):[]}}function ag(u,a,h,y,w){u.emplaceBack(2*a+(y+1)/2,2*h+(w+1)/2)}class Q_{constructor(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(h=>h.id),this.index=a.index,this.hasPattern=!1,this.layoutVertexArray=new ur,this.indexArray=new go,this.segments=new zn,this.programConfigurations=new jc(a.layers,a.zoom),this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(a,h,y){let w=this.layers[0],R=[],k=null,F=!1;w.type==="circle"&&(k=w.layout.get("circle-sort-key"),F=!k.isConstant());for(let{feature:j,id:q,index:K,sourceLayerIndex:et}of a){let it=this.layers[0]._featureFilter.needGeometry,ct=Rf(j,it);if(!this.layers[0]._featureFilter.filter(new Wn(this.zoom),ct,y))continue;let ht=F?k.evaluate(ct,{},y):void 0,vt={id:q,properties:j.properties,type:j.type,sourceLayerIndex:et,index:K,geometry:it?ct.geometry:Pf(j),patterns:{},sortKey:ht};R.push(vt)}F&&R.sort((j,q)=>j.sortKey-q.sortKey);for(let j of R){let{geometry:q,index:K,sourceLayerIndex:et}=j,it=a[K].feature;this.addFeature(j,q,K,y),h.featureIndex.insert(it,q,K,et,this.index)}}update(a,h,y){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,h,this.stateDependentLayers,y)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,Ia),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(a,h,y,w){for(let R of h)for(let k of R){let F=k.x,j=k.y;if(F<0||F>=Fs||j<0||j>=Fs)continue;let q=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,a.sortKey),K=q.vertexLength;ag(this.layoutVertexArray,F,j,-1,-1),ag(this.layoutVertexArray,F,j,1,-1),ag(this.layoutVertexArray,F,j,1,1),ag(this.layoutVertexArray,F,j,-1,1),this.indexArray.emplaceBack(K,K+1,K+2),this.indexArray.emplaceBack(K,K+3,K+2),q.vertexLength+=4,q.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,y,{},w)}}function BT(u,a){for(let h=0;h<u.length;h++)if(Ei(a,u[h]))return!0;for(let h=0;h<a.length;h++)if(Ei(u,a[h]))return!0;return!!db(u,a)}function kC(u,a,h){return!!Ei(u,a)||!!sc(a,u,h)}function OT(u,a){if(u.length===1)return $c(a,u[0]);for(let h=0;h<a.length;h++){let y=a[h];for(let w=0;w<y.length;w++)if(Ei(u,y[w]))return!0}for(let h=0;h<u.length;h++)if($c(a,u[h]))return!0;for(let h=0;h<a.length;h++)if(db(u,a[h]))return!0;return!1}function DC(u,a,h){if(u.length>1){if(db(u,a))return!0;for(let y=0;y<a.length;y++)if(sc(a[y],u,h))return!0}for(let y=0;y<u.length;y++)if(sc(u[y],a,h))return!0;return!1}function db(u,a){if(u.length===0||a.length===0)return!1;for(let h=0;h<u.length-1;h++){let y=u[h],w=u[h+1];for(let R=0;R<a.length-1;R++)if(kf(y,w,a[R],a[R+1]))return!0}return!1}function kf(u,a,h,y){return Xt(u,h,y)!==Xt(a,h,y)&&Xt(u,a,h)!==Xt(u,a,y)}function sc(u,a,h){let y=h*h;if(a.length===1)return u.distSqr(a[0])<y;for(let w=1;w<a.length;w++)if(ni(u,a[w-1],a[w])<y)return!0;return!1}function ni(u,a,h){let y=a.distSqr(h);if(y===0)return u.distSqr(a);let w=((u.x-a.x)*(h.x-a.x)+(u.y-a.y)*(h.y-a.y))/y;return u.distSqr(w<0?a:w>1?h:h.sub(a)._mult(w)._add(a))}function $c(u,a){let h,y,w,R=!1;for(let k=0;k<u.length;k++){h=u[k];for(let F=0,j=h.length-1;F<h.length;j=F++)y=h[F],w=h[j],y.y>a.y!=w.y>a.y&&a.x<(w.x-y.x)*(a.y-y.y)/(w.y-y.y)+y.x&&(R=!R)}return R}function Ei(u,a){let h=!1;for(let y=0,w=u.length-1;y<u.length;w=y++){let R=u[y],k=u[w];R.y>a.y!=k.y>a.y&&a.x<(k.x-R.x)*(a.y-R.y)/(k.y-R.y)+R.x&&(h=!h)}return h}function aa(u,a,h){let y=h[0],w=h[2];if(u.x<y.x&&a.x<y.x||u.x>w.x&&a.x>w.x||u.y<y.y&&a.y<y.y||u.y>w.y&&a.y>w.y)return!1;let R=Xt(u,a,h[0]);return R!==Xt(u,a,h[1])||R!==Xt(u,a,h[2])||R!==Xt(u,a,h[3])}function K0(u,a,h){let y=a.paint.get(u).value;return y.kind==="constant"?y.value:h.programConfigurations.get(a.id).getMaxValue(u)}function J0(u){return Math.sqrt(u[0]*u[0]+u[1]*u[1])}function wu(u,a,h,y,w){if(!a[0]&&!a[1])return u;let R=x.convert(a)._mult(w);h==="viewport"&&R._rotate(-y);let k=[];for(let F=0;F<u.length;F++)k.push(u[F].sub(R));return k}let NT,Ho;Ve("CircleBucket",Q_,{omit:["layers"]});var K_={get paint(){return Ho=Ho||new Ps({"circle-radius":new Rr(ae.paint_circle["circle-radius"]),"circle-color":new Rr(ae.paint_circle["circle-color"]),"circle-blur":new Rr(ae.paint_circle["circle-blur"]),"circle-opacity":new Rr(ae.paint_circle["circle-opacity"]),"circle-translate":new cr(ae.paint_circle["circle-translate"]),"circle-translate-anchor":new cr(ae.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new cr(ae.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new cr(ae.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Rr(ae.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Rr(ae.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Rr(ae.paint_circle["circle-stroke-opacity"])})},get layout(){return NT=NT||new Ps({"circle-sort-key":new Rr(ae.layout_circle["circle-sort-key"])})}},Xs=1e-6,ud=typeof Float32Array<"u"?Float32Array:Array;function De(u){return u[0]=1,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=1,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=1,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u}function Ge(u,a,h){var y=a[0],w=a[1],R=a[2],k=a[3],F=a[4],j=a[5],q=a[6],K=a[7],et=a[8],it=a[9],ct=a[10],ht=a[11],vt=a[12],Nt=a[13],Ut=a[14],Kt=a[15],Ht=h[0],Jt=h[1],le=h[2],ve=h[3];return u[0]=Ht*y+Jt*F+le*et+ve*vt,u[1]=Ht*w+Jt*j+le*it+ve*Nt,u[2]=Ht*R+Jt*q+le*ct+ve*Ut,u[3]=Ht*k+Jt*K+le*ht+ve*Kt,u[4]=(Ht=h[4])*y+(Jt=h[5])*F+(le=h[6])*et+(ve=h[7])*vt,u[5]=Ht*w+Jt*j+le*it+ve*Nt,u[6]=Ht*R+Jt*q+le*ct+ve*Ut,u[7]=Ht*k+Jt*K+le*ht+ve*Kt,u[8]=(Ht=h[8])*y+(Jt=h[9])*F+(le=h[10])*et+(ve=h[11])*vt,u[9]=Ht*w+Jt*j+le*it+ve*Nt,u[10]=Ht*R+Jt*q+le*ct+ve*Ut,u[11]=Ht*k+Jt*K+le*ht+ve*Kt,u[12]=(Ht=h[12])*y+(Jt=h[13])*F+(le=h[14])*et+(ve=h[15])*vt,u[13]=Ht*w+Jt*j+le*it+ve*Nt,u[14]=Ht*R+Jt*q+le*ct+ve*Ut,u[15]=Ht*k+Jt*K+le*ht+ve*Kt,u}Math.hypot||(Math.hypot=function(){for(var u=0,a=arguments.length;a--;)u+=arguments[a]*arguments[a];return Math.sqrt(u)});var tA,Ab=Ge;function hd(u,a,h){var y=a[0],w=a[1],R=a[2],k=a[3];return u[0]=h[0]*y+h[4]*w+h[8]*R+h[12]*k,u[1]=h[1]*y+h[5]*w+h[9]*R+h[13]*k,u[2]=h[2]*y+h[6]*w+h[10]*R+h[14]*k,u[3]=h[3]*y+h[7]*w+h[11]*R+h[15]*k,u}tA=new ud(4),ud!=Float32Array&&(tA[0]=0,tA[1]=0,tA[2]=0,tA[3]=0);class J_ extends Ea{constructor(a){super(a,K_)}createBucket(a){return new Q_(a)}queryRadius(a){let h=a;return K0("circle-radius",this,h)+K0("circle-stroke-width",this,h)+J0(this.paint.get("circle-translate"))}queryIntersectsFeature(a,h,y,w,R,k,F,j){let q=wu(a,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),k.angle,F),K=this.paint.get("circle-radius").evaluate(h,y)+this.paint.get("circle-stroke-width").evaluate(h,y),et=this.paint.get("circle-pitch-alignment")==="map",it=et?q:function(ht,vt){return ht.map(Nt=>Df(Nt,vt))}(q,j),ct=et?K*F:K;for(let ht of w)for(let vt of ht){let Nt=et?vt:Df(vt,j),Ut=ct,Kt=hd([],[vt.x,vt.y,0,1],j);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Ut*=Kt[3]/k.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Ut*=k.cameraToCenterDistance/Kt[3]),kC(it,Nt,Ut))return!0}return!1}}function Df(u,a){let h=hd([],[u.x,u.y,0,1],a);return new x(h[0]/h[3],h[1]/h[3])}class mb extends Q_{}let Mh;Ve("HeatmapBucket",mb,{omit:["layers"]});var A={get paint(){return Mh=Mh||new Ps({"heatmap-radius":new Rr(ae.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Rr(ae.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new cr(ae.paint_heatmap["heatmap-intensity"]),"heatmap-color":new yu(ae.paint_heatmap["heatmap-color"]),"heatmap-opacity":new cr(ae.paint_heatmap["heatmap-opacity"])})}};function d(u,{width:a,height:h},y,w){if(w){if(w instanceof Uint8ClampedArray)w=new Uint8Array(w.buffer);else if(w.length!==a*h*y)throw new RangeError(`mismatched image size. expected: ${w.length} but got: ${a*h*y}`)}else w=new Uint8Array(a*h*y);return u.width=a,u.height=h,u.data=w,u}function _(u,{width:a,height:h},y){if(a===u.width&&h===u.height)return;let w=d({},{width:a,height:h},y);b(u,w,{x:0,y:0},{x:0,y:0},{width:Math.min(u.width,a),height:Math.min(u.height,h)},y),u.width=a,u.height=h,u.data=w.data}function b(u,a,h,y,w,R){if(w.width===0||w.height===0)return a;if(w.width>u.width||w.height>u.height||h.x>u.width-w.width||h.y>u.height-w.height)throw new RangeError("out of range source coordinates for image copy");if(w.width>a.width||w.height>a.height||y.x>a.width-w.width||y.y>a.height-w.height)throw new RangeError("out of range destination coordinates for image copy");let k=u.data,F=a.data;if(k===F)throw new Error("srcData equals dstData, so image is already copied");for(let j=0;j<w.height;j++){let q=((h.y+j)*u.width+h.x)*R,K=((y.y+j)*a.width+y.x)*R;for(let et=0;et<w.width*R;et++)F[K+et]=k[q+et]}return a}class I{constructor(a,h){d(this,a,1,h)}resize(a){_(this,a,1)}clone(){return new I({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(a,h,y,w,R){b(a,h,y,w,R,1)}}class P{constructor(a,h){d(this,a,4,h)}resize(a){_(this,a,4)}replace(a,h){h?this.data.set(a):this.data=a instanceof Uint8ClampedArray?new Uint8Array(a.buffer):a}clone(){return new P({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(a,h,y,w,R){b(a,h,y,w,R,4)}}function B(u){let a={},h=u.resolution||256,y=u.clips?u.clips.length:1,w=u.image||new P({width:h,height:y});if(Math.log(h)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${h}`);let R=(k,F,j)=>{a[u.evaluationKey]=j;let q=u.expression.evaluate(a);w.data[k+F+0]=Math.floor(255*q.r/q.a),w.data[k+F+1]=Math.floor(255*q.g/q.a),w.data[k+F+2]=Math.floor(255*q.b/q.a),w.data[k+F+3]=Math.floor(255*q.a)};if(u.clips)for(let k=0,F=0;k<y;++k,F+=4*h)for(let j=0,q=0;j<h;j++,q+=4){let K=j/(h-1),{start:et,end:it}=u.clips[k];R(F,q,et*(1-K)+it*K)}else for(let k=0,F=0;k<h;k++,F+=4)R(0,F,k/(h-1));return w}Ve("AlphaImage",I),Ve("RGBAImage",P);class O extends Ea{createBucket(a){return new mb(a)}constructor(a){super(a,A),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(a){a==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=B({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let W;var Q={get paint(){return W=W||new Ps({"hillshade-illumination-direction":new cr(ae.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new cr(ae.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new cr(ae.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new cr(ae.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new cr(ae.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new cr(ae.paint_hillshade["hillshade-accent-color"])})}};class nt extends Ea{constructor(a){super(a,Q)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}let mt=qn([{name:"a_pos",components:2,type:"Int16"}],4),{members:Vt}=mt;var Yt={exports:{}};function zt(u,a,h){h=h||2;var y,w,R,k,F,j,q,K=a&&a.length,et=K?a[0]*h:u.length,it=re(u,0,et,h,!0),ct=[];if(!it||it.next===it.prev)return ct;if(K&&(it=function(vt,Nt,Ut,Kt){var Ht,Jt,le,ve=[];for(Ht=0,Jt=Nt.length;Ht<Jt;Ht++)(le=re(vt,Nt[Ht]*Kt,Ht<Jt-1?Nt[Ht+1]*Kt:vt.length,Kt,!1))===le.next&&(le.steiner=!0),ve.push(un(le));for(ve.sort(fr),Ht=0;Ht<ve.length;Ht++)Ut=Xe(ve[Ht],Ut);return Ut}(u,a,it,h)),u.length>80*h){y=R=u[0],w=k=u[1];for(var ht=h;ht<et;ht+=h)(F=u[ht])<y&&(y=F),(j=u[ht+1])<w&&(w=j),F>R&&(R=F),j>k&&(k=j);q=(q=Math.max(R-y,k-w))!==0?32767/q:0}return Ae(it,ct,h,y,w,q,0),ct}function re(u,a,h,y,w){var R,k;if(w===OC(u,a,h,y)>0)for(R=a;R<h;R+=y)k=lL(R,u[R],u[R+1],k);else for(R=h-y;R>=a;R-=y)k=lL(R,u[R],u[R+1],k);return k&&Ai(k,k.next)&&(_b(k),k=k.next),k}function ge(u,a){if(!u)return u;a||(a=u);var h,y=u;do if(h=!1,y.steiner||!Ai(y,y.next)&&Ar(y.prev,y,y.next)!==0)y=y.next;else{if(_b(y),(y=a=y.prev)===y.next)break;h=!0}while(h||y!==a);return a}function Ae(u,a,h,y,w,R,k){if(u){!k&&R&&function(K,et,it,ct){var ht=K;do ht.z===0&&(ht.z=_n(ht.x,ht.y,et,it,ct)),ht.prevZ=ht.prev,ht.nextZ=ht.next,ht=ht.next;while(ht!==K);ht.prevZ.nextZ=null,ht.prevZ=null,function(vt){var Nt,Ut,Kt,Ht,Jt,le,ve,Ke,dr=1;do{for(Ut=vt,vt=null,Jt=null,le=0;Ut;){for(le++,Kt=Ut,ve=0,Nt=0;Nt<dr&&(ve++,Kt=Kt.nextZ);Nt++);for(Ke=dr;ve>0||Ke>0&&Kt;)ve!==0&&(Ke===0||!Kt||Ut.z<=Kt.z)?(Ht=Ut,Ut=Ut.nextZ,ve--):(Ht=Kt,Kt=Kt.nextZ,Ke--),Jt?Jt.nextZ=Ht:vt=Ht,Ht.prevZ=Jt,Jt=Ht;Ut=Kt}Jt.nextZ=null,dr*=2}while(le>1)}(ht)}(u,y,w,R);for(var F,j,q=u;u.prev!==u.next;)if(F=u.prev,j=u.next,R?fe(u,y,w,R):ue(u))a.push(F.i/h|0),a.push(u.i/h|0),a.push(j.i/h|0),_b(u),u=j.next,q=j.next;else if((u=j)===q){k?k===1?Ae(u=ie(ge(u),a,h),a,h,y,w,R,2):k===2&&tr(u,a,h,y,w,R):Ae(ge(u),a,h,y,w,R,1);break}}}function ue(u){var a=u.prev,h=u,y=u.next;if(Ar(a,h,y)>=0)return!1;for(var w=a.x,R=h.x,k=y.x,F=a.y,j=h.y,q=y.y,K=w<R?w<k?w:k:R<k?R:k,et=F<j?F<q?F:q:j<q?j:q,it=w>R?w>k?w:k:R>k?R:k,ct=F>j?F>q?F:q:j>q?j:q,ht=y.next;ht!==a;){if(ht.x>=K&&ht.x<=it&&ht.y>=et&&ht.y<=ct&&Yi(w,F,R,j,k,q,ht.x,ht.y)&&Ar(ht.prev,ht,ht.next)>=0)return!1;ht=ht.next}return!0}function fe(u,a,h,y){var w=u.prev,R=u,k=u.next;if(Ar(w,R,k)>=0)return!1;for(var F=w.x,j=R.x,q=k.x,K=w.y,et=R.y,it=k.y,ct=F<j?F<q?F:q:j<q?j:q,ht=K<et?K<it?K:it:et<it?et:it,vt=F>j?F>q?F:q:j>q?j:q,Nt=K>et?K>it?K:it:et>it?et:it,Ut=_n(ct,ht,a,h,y),Kt=_n(vt,Nt,a,h,y),Ht=u.prevZ,Jt=u.nextZ;Ht&&Ht.z>=Ut&&Jt&&Jt.z<=Kt;){if(Ht.x>=ct&&Ht.x<=vt&&Ht.y>=ht&&Ht.y<=Nt&&Ht!==w&&Ht!==k&&Yi(F,K,j,et,q,it,Ht.x,Ht.y)&&Ar(Ht.prev,Ht,Ht.next)>=0||(Ht=Ht.prevZ,Jt.x>=ct&&Jt.x<=vt&&Jt.y>=ht&&Jt.y<=Nt&&Jt!==w&&Jt!==k&&Yi(F,K,j,et,q,it,Jt.x,Jt.y)&&Ar(Jt.prev,Jt,Jt.next)>=0))return!1;Jt=Jt.nextZ}for(;Ht&&Ht.z>=Ut;){if(Ht.x>=ct&&Ht.x<=vt&&Ht.y>=ht&&Ht.y<=Nt&&Ht!==w&&Ht!==k&&Yi(F,K,j,et,q,it,Ht.x,Ht.y)&&Ar(Ht.prev,Ht,Ht.next)>=0)return!1;Ht=Ht.prevZ}for(;Jt&&Jt.z<=Kt;){if(Jt.x>=ct&&Jt.x<=vt&&Jt.y>=ht&&Jt.y<=Nt&&Jt!==w&&Jt!==k&&Yi(F,K,j,et,q,it,Jt.x,Jt.y)&&Ar(Jt.prev,Jt,Jt.next)>=0)return!1;Jt=Jt.nextZ}return!0}function ie(u,a,h){var y=u;do{var w=y.prev,R=y.next.next;!Ai(w,R)&&Rn(w,y,y.next,R)&&yo(w,R)&&yo(R,w)&&(a.push(w.i/h|0),a.push(y.i/h|0),a.push(R.i/h|0),_b(y),_b(y.next),y=u=R),y=y.next}while(y!==u);return ge(y)}function tr(u,a,h,y,w,R){var k=u;do{for(var F=k.next.next;F!==k.prev;){if(k.i!==F.i&&Ci(k,F)){var j=gb(k,F);return k=ge(k,k.next),j=ge(j,j.next),Ae(k,a,h,y,w,R,0),void Ae(j,a,h,y,w,R,0)}F=F.next}k=k.next}while(k!==u)}function fr(u,a){return u.x-a.x}function Xe(u,a){var h=function(w,R){var k,F=R,j=w.x,q=w.y,K=-1/0;do{if(q<=F.y&&q>=F.next.y&&F.next.y!==F.y){var et=F.x+(q-F.y)*(F.next.x-F.x)/(F.next.y-F.y);if(et<=j&&et>K&&(K=et,k=F.x<F.next.x?F:F.next,et===j))return k}F=F.next}while(F!==R);if(!k)return null;var it,ct=k,ht=k.x,vt=k.y,Nt=1/0;F=k;do j>=F.x&&F.x>=ht&&j!==F.x&&Yi(q<vt?j:K,q,ht,vt,q<vt?K:j,q,F.x,F.y)&&(it=Math.abs(q-F.y)/(j-F.x),yo(F,w)&&(it<Nt||it===Nt&&(F.x>k.x||F.x===k.x&&er(k,F)))&&(k=F,Nt=it)),F=F.next;while(F!==ct);return k}(u,a);if(!h)return a;var y=gb(h,u);return ge(y,y.next),ge(h,h.next)}function er(u,a){return Ar(u.prev,u,a.prev)<0&&Ar(a.next,u,u.next)<0}function _n(u,a,h,y,w){return(u=1431655765&((u=858993459&((u=252645135&((u=16711935&((u=(u-h)*w|0)|u<<8))|u<<4))|u<<2))|u<<1))|(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=(a-y)*w|0)|a<<8))|a<<4))|a<<2))|a<<1))<<1}function un(u){var a=u,h=u;do(a.x<h.x||a.x===h.x&&a.y<h.y)&&(h=a),a=a.next;while(a!==u);return h}function Yi(u,a,h,y,w,R,k,F){return(w-k)*(a-F)>=(u-k)*(R-F)&&(u-k)*(y-F)>=(h-k)*(a-F)&&(h-k)*(R-F)>=(w-k)*(y-F)}function Ci(u,a){return u.next.i!==a.i&&u.prev.i!==a.i&&!function(h,y){var w=h;do{if(w.i!==h.i&&w.next.i!==h.i&&w.i!==y.i&&w.next.i!==y.i&&Rn(w,w.next,h,y))return!0;w=w.next}while(w!==h);return!1}(u,a)&&(yo(u,a)&&yo(a,u)&&function(h,y){var w=h,R=!1,k=(h.x+y.x)/2,F=(h.y+y.y)/2;do w.y>F!=w.next.y>F&&w.next.y!==w.y&&k<(w.next.x-w.x)*(F-w.y)/(w.next.y-w.y)+w.x&&(R=!R),w=w.next;while(w!==h);return R}(u,a)&&(Ar(u.prev,u,a.prev)||Ar(u,a.prev,a))||Ai(u,a)&&Ar(u.prev,u,u.next)>0&&Ar(a.prev,a,a.next)>0)}function Ar(u,a,h){return(a.y-u.y)*(h.x-a.x)-(a.x-u.x)*(h.y-a.y)}function Ai(u,a){return u.x===a.x&&u.y===a.y}function Rn(u,a,h,y){var w=kn(Ar(u,a,h)),R=kn(Ar(u,a,y)),k=kn(Ar(h,y,u)),F=kn(Ar(h,y,a));return w!==R&&k!==F||!(w!==0||!Kr(u,h,a))||!(R!==0||!Kr(u,y,a))||!(k!==0||!Kr(h,u,y))||!(F!==0||!Kr(h,a,y))}function Kr(u,a,h){return a.x<=Math.max(u.x,h.x)&&a.x>=Math.min(u.x,h.x)&&a.y<=Math.max(u.y,h.y)&&a.y>=Math.min(u.y,h.y)}function kn(u){return u>0?1:u<0?-1:0}function yo(u,a){return Ar(u.prev,u,u.next)<0?Ar(u,a,u.next)>=0&&Ar(u,u.prev,a)>=0:Ar(u,a,u.prev)<0||Ar(u,u.next,a)<0}function gb(u,a){var h=new BC(u.i,u.x,u.y),y=new BC(a.i,a.x,a.y),w=u.next,R=a.prev;return u.next=a,a.prev=u,h.next=w,w.prev=h,y.next=h,h.prev=y,R.next=y,y.prev=R,y}function lL(u,a,h,y){var w=new BC(u,a,h);return y?(w.next=y.next,w.prev=y,y.next.prev=w,y.next=w):(w.prev=w,w.next=w),w}function _b(u){u.next.prev=u.prev,u.prev.next=u.next,u.prevZ&&(u.prevZ.nextZ=u.nextZ),u.nextZ&&(u.nextZ.prevZ=u.prevZ)}function BC(u,a,h){this.i=u,this.x=a,this.y=h,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function OC(u,a,h,y){for(var w=0,R=a,k=h-y;R<h;R+=y)w+=(u[k]-u[R])*(u[R+1]+u[k+1]),k=R;return w}Yt.exports=zt,Yt.exports.default=zt,zt.deviation=function(u,a,h,y){var w=a&&a.length,R=Math.abs(OC(u,0,w?a[0]*h:u.length,h));if(w)for(var k=0,F=a.length;k<F;k++)R-=Math.abs(OC(u,a[k]*h,k<F-1?a[k+1]*h:u.length,h));var j=0;for(k=0;k<y.length;k+=3){var q=y[k]*h,K=y[k+1]*h,et=y[k+2]*h;j+=Math.abs((u[q]-u[et])*(u[K+1]-u[q+1])-(u[q]-u[K])*(u[et+1]-u[q+1]))}return R===0&&j===0?0:Math.abs((j-R)/R)},zt.flatten=function(u){for(var a=u[0][0].length,h={vertices:[],holes:[],dimensions:a},y=0,w=0;w<u.length;w++){for(var R=0;R<u[w].length;R++)for(var k=0;k<a;k++)h.vertices.push(u[w][R][k]);w>0&&h.holes.push(y+=u[w-1].length)}return h};var cL=c(Yt.exports);function clt(u,a,h,y,w){uL(u,a,h||0,y||u.length-1,w||ult)}function uL(u,a,h,y,w){for(;y>h;){if(y-h>600){var R=y-h+1,k=a-h+1,F=Math.log(R),j=.5*Math.exp(2*F/3),q=.5*Math.sqrt(F*j*(R-j)/R)*(k-R/2<0?-1:1);uL(u,a,Math.max(h,Math.floor(a-k*j/R+q)),Math.min(y,Math.floor(a+(R-k)*j/R+q)),w)}var K=u[a],et=h,it=y;for(yb(u,h,a),w(u[y],K)>0&&yb(u,h,y);et<it;){for(yb(u,et,it),et++,it--;w(u[et],K)<0;)et++;for(;w(u[it],K)>0;)it--}w(u[h],K)===0?yb(u,h,it):yb(u,++it,y),it<=a&&(h=it+1),a<=it&&(y=it-1)}}function yb(u,a,h){var y=u[a];u[a]=u[h],u[h]=y}function ult(u,a){return u<a?-1:u>a?1:0}function NC(u,a){let h=u.length;if(h<=1)return[u];let y=[],w,R;for(let k=0;k<h;k++){let F=xt(u[k]);F!==0&&(u[k].area=Math.abs(F),R===void 0&&(R=F<0),R===F<0?(w&&y.push(w),w=[u[k]]):w.push(u[k]))}if(w&&y.push(w),a>1)for(let k=0;k<y.length;k++)y[k].length<=a||(clt(y[k],a,1,y[k].length-1,hlt),y[k]=y[k].slice(0,a));return y}function hlt(u,a){return a.area-u.area}function FC(u,a,h){let y=h.patternDependencies,w=!1;for(let R of a){let k=R.paint.get(`${u}-pattern`);k.isConstant()||(w=!0);let F=k.constantOr(null);F&&(w=!0,y[F.to]=!0,y[F.from]=!0)}return w}function LC(u,a,h,y,w){let R=w.patternDependencies;for(let k of a){let F=k.paint.get(`${u}-pattern`).value;if(F.kind!=="constant"){let j=F.evaluate({zoom:y-1},h,{},w.availableImages),q=F.evaluate({zoom:y},h,{},w.availableImages),K=F.evaluate({zoom:y+1},h,{},w.availableImages);j=j&&j.name?j.name:j,q=q&&q.name?q.name:q,K=K&&K.name?K.name:K,R[j]=!0,R[q]=!0,R[K]=!0,h.patterns[k.id]={min:j,mid:q,max:K}}}return h}class zC{constructor(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(h=>h.id),this.index=a.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new ki,this.indexArray=new go,this.indexArray2=new qs,this.programConfigurations=new jc(a.layers,a.zoom),this.segments=new zn,this.segments2=new zn,this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(a,h,y){this.hasPattern=FC("fill",this.layers,h);let w=this.layers[0].layout.get("fill-sort-key"),R=!w.isConstant(),k=[];for(let{feature:F,id:j,index:q,sourceLayerIndex:K}of a){let et=this.layers[0]._featureFilter.needGeometry,it=Rf(F,et);if(!this.layers[0]._featureFilter.filter(new Wn(this.zoom),it,y))continue;let ct=R?w.evaluate(it,{},y,h.availableImages):void 0,ht={id:j,properties:F.properties,type:F.type,sourceLayerIndex:K,index:q,geometry:et?it.geometry:Pf(F),patterns:{},sortKey:ct};k.push(ht)}R&&k.sort((F,j)=>F.sortKey-j.sortKey);for(let F of k){let{geometry:j,index:q,sourceLayerIndex:K}=F;if(this.hasPattern){let et=LC("fill",this.layers,F,this.zoom,h);this.patternFeatures.push(et)}else this.addFeature(F,j,q,y,{});h.featureIndex.insert(a[q].feature,j,q,K,this.index)}}update(a,h,y){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,h,this.stateDependentLayers,y)}addFeatures(a,h,y){for(let w of this.patternFeatures)this.addFeature(w,w.geometry,w.index,h,y)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,Vt),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.indexBuffer2=a.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(a,h,y,w,R){for(let k of NC(h,500)){let F=0;for(let ct of k)F+=ct.length;let j=this.segments.prepareSegment(F,this.layoutVertexArray,this.indexArray),q=j.vertexLength,K=[],et=[];for(let ct of k){if(ct.length===0)continue;ct!==k[0]&&et.push(K.length/2);let ht=this.segments2.prepareSegment(ct.length,this.layoutVertexArray,this.indexArray2),vt=ht.vertexLength;this.layoutVertexArray.emplaceBack(ct[0].x,ct[0].y),this.indexArray2.emplaceBack(vt+ct.length-1,vt),K.push(ct[0].x),K.push(ct[0].y);for(let Nt=1;Nt<ct.length;Nt++)this.layoutVertexArray.emplaceBack(ct[Nt].x,ct[Nt].y),this.indexArray2.emplaceBack(vt+Nt-1,vt+Nt),K.push(ct[Nt].x),K.push(ct[Nt].y);ht.vertexLength+=ct.length,ht.primitiveLength+=ct.length}let it=cL(K,et);for(let ct=0;ct<it.length;ct+=3)this.indexArray.emplaceBack(q+it[ct],q+it[ct+1],q+it[ct+2]);j.vertexLength+=F,j.primitiveLength+=it.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,y,R,w)}}let hL,fL;Ve("FillBucket",zC,{omit:["layers","patternFeatures"]});var flt={get paint(){return fL=fL||new Ps({"fill-antialias":new cr(ae.paint_fill["fill-antialias"]),"fill-opacity":new Rr(ae.paint_fill["fill-opacity"]),"fill-color":new Rr(ae.paint_fill["fill-color"]),"fill-outline-color":new Rr(ae.paint_fill["fill-outline-color"]),"fill-translate":new cr(ae.paint_fill["fill-translate"]),"fill-translate-anchor":new cr(ae.paint_fill["fill-translate-anchor"]),"fill-pattern":new wh(ae.paint_fill["fill-pattern"])})},get layout(){return hL=hL||new Ps({"fill-sort-key":new Rr(ae.layout_fill["fill-sort-key"])})}};class plt extends Ea{constructor(a){super(a,flt)}recalculate(a,h){super.recalculate(a,h);let y=this.paint._values["fill-outline-color"];y.value.kind==="constant"&&y.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(a){return new zC(a)}queryRadius(){return J0(this.paint.get("fill-translate"))}queryIntersectsFeature(a,h,y,w,R,k,F){return OT(wu(a,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),k.angle,F),w)}isTileClipped(){return!0}}let dlt=qn([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Alt=qn([{name:"a_centroid",components:2,type:"Int16"}],4),{members:mlt}=dlt;var eA={},glt=f,pL=ty;function ty(u,a,h,y,w){this.properties={},this.extent=h,this.type=0,this._pbf=u,this._geometry=-1,this._keys=y,this._values=w,u.readFields(_lt,this,a)}function _lt(u,a,h){u==1?a.id=h.readVarint():u==2?function(y,w){for(var R=y.readVarint()+y.pos;y.pos<R;){var k=w._keys[y.readVarint()],F=w._values[y.readVarint()];w.properties[k]=F}}(h,a):u==3?a.type=h.readVarint():u==4&&(a._geometry=h.pos)}function ylt(u){for(var a,h,y=0,w=0,R=u.length,k=R-1;w<R;k=w++)y+=((h=u[k]).x-(a=u[w]).x)*(a.y+h.y);return y}ty.types=["Unknown","Point","LineString","Polygon"],ty.prototype.loadGeometry=function(){var u=this._pbf;u.pos=this._geometry;for(var a,h=u.readVarint()+u.pos,y=1,w=0,R=0,k=0,F=[];u.pos<h;){if(w<=0){var j=u.readVarint();y=7&j,w=j>>3}if(w--,y===1||y===2)R+=u.readSVarint(),k+=u.readSVarint(),y===1&&(a&&F.push(a),a=[]),a.push(new glt(R,k));else{if(y!==7)throw new Error("unknown command "+y);a&&a.push(a[0].clone())}}return a&&F.push(a),F},ty.prototype.bbox=function(){var u=this._pbf;u.pos=this._geometry;for(var a=u.readVarint()+u.pos,h=1,y=0,w=0,R=0,k=1/0,F=-1/0,j=1/0,q=-1/0;u.pos<a;){if(y<=0){var K=u.readVarint();h=7&K,y=K>>3}if(y--,h===1||h===2)(w+=u.readSVarint())<k&&(k=w),w>F&&(F=w),(R+=u.readSVarint())<j&&(j=R),R>q&&(q=R);else if(h!==7)throw new Error("unknown command "+h)}return[k,j,F,q]},ty.prototype.toGeoJSON=function(u,a,h){var y,w,R=this.extent*Math.pow(2,h),k=this.extent*u,F=this.extent*a,j=this.loadGeometry(),q=ty.types[this.type];function K(ct){for(var ht=0;ht<ct.length;ht++){var vt=ct[ht];ct[ht]=[360*(vt.x+k)/R-180,360/Math.PI*Math.atan(Math.exp((180-360*(vt.y+F)/R)*Math.PI/180))-90]}}switch(this.type){case 1:var et=[];for(y=0;y<j.length;y++)et[y]=j[y][0];K(j=et);break;case 2:for(y=0;y<j.length;y++)K(j[y]);break;case 3:for(j=function(ct){var ht=ct.length;if(ht<=1)return[ct];for(var vt,Nt,Ut=[],Kt=0;Kt<ht;Kt++){var Ht=ylt(ct[Kt]);Ht!==0&&(Nt===void 0&&(Nt=Ht<0),Nt===Ht<0?(vt&&Ut.push(vt),vt=[ct[Kt]]):vt.push(ct[Kt]))}return vt&&Ut.push(vt),Ut}(j),y=0;y<j.length;y++)for(w=0;w<j[y].length;w++)K(j[y][w])}j.length===1?j=j[0]:q="Multi"+q;var it={type:"Feature",geometry:{type:q,coordinates:j},properties:this.properties};return"id"in this&&(it.id=this.id),it};var xlt=pL,dL=AL;function AL(u,a){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=u,this._keys=[],this._values=[],this._features=[],u.readFields(blt,this,a),this.length=this._features.length}function blt(u,a,h){u===15?a.version=h.readVarint():u===1?a.name=h.readString():u===5?a.extent=h.readVarint():u===2?a._features.push(h.pos):u===3?a._keys.push(h.readString()):u===4&&a._values.push(function(y){for(var w=null,R=y.readVarint()+y.pos;y.pos<R;){var k=y.readVarint()>>3;w=k===1?y.readString():k===2?y.readFloat():k===3?y.readDouble():k===4?y.readVarint64():k===5?y.readVarint():k===6?y.readSVarint():k===7?y.readBoolean():null}return w}(h))}AL.prototype.feature=function(u){if(u<0||u>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[u];var a=this._pbf.readVarint()+this._pbf.pos;return new xlt(this._pbf,a,this.extent,this._keys,this._values)};var vlt=dL;function wlt(u,a,h){if(u===3){var y=new vlt(h,h.readVarint()+h.pos);y.length&&(a[y.name]=y)}}eA.VectorTile=function(u,a){this.layers=u.readFields(wlt,{},a)},eA.VectorTileFeature=pL,eA.VectorTileLayer=dL;let Tlt=eA.VectorTileFeature.types,UC=Math.pow(2,13);function xb(u,a,h,y,w,R,k,F){u.emplaceBack(a,h,2*Math.floor(y*UC)+k,w*UC*2,R*UC*2,Math.round(F))}class VC{constructor(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(h=>h.id),this.index=a.index,this.hasPattern=!1,this.layoutVertexArray=new We,this.centroidVertexArray=new Fe,this.indexArray=new go,this.programConfigurations=new jc(a.layers,a.zoom),this.segments=new zn,this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(a,h,y){this.features=[],this.hasPattern=FC("fill-extrusion",this.layers,h);for(let{feature:w,id:R,index:k,sourceLayerIndex:F}of a){let j=this.layers[0]._featureFilter.needGeometry,q=Rf(w,j);if(!this.layers[0]._featureFilter.filter(new Wn(this.zoom),q,y))continue;let K={id:R,sourceLayerIndex:F,index:k,geometry:j?q.geometry:Pf(w),properties:w.properties,type:w.type,patterns:{}};this.hasPattern?this.features.push(LC("fill-extrusion",this.layers,K,this.zoom,h)):this.addFeature(K,K.geometry,k,y,{}),h.featureIndex.insert(w,K.geometry,k,F,this.index,!0)}}addFeatures(a,h,y){for(let w of this.features){let{geometry:R}=w;this.addFeature(w,R,w.index,h,y)}}update(a,h,y){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,h,this.stateDependentLayers,y)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,mlt),this.centroidVertexBuffer=a.createVertexBuffer(this.centroidVertexArray,Alt.members,!0),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(a,h,y,w,R){let k={x:0,y:0,vertexCount:0};for(let F of NC(h,500)){let j=0;for(let ht of F)j+=ht.length;let q=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(let ht of F){if(ht.length===0||Elt(ht))continue;let vt=0;for(let Nt=0;Nt<ht.length;Nt++){let Ut=ht[Nt];if(Nt>=1){let Kt=ht[Nt-1];if(!Slt(Ut,Kt)){q.vertexLength+4>zn.MAX_VERTEX_ARRAY_LENGTH&&(q=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));let Ht=Ut.sub(Kt)._perp()._unit(),Jt=Kt.dist(Ut);vt+Jt>32768&&(vt=0),xb(this.layoutVertexArray,Ut.x,Ut.y,Ht.x,Ht.y,0,0,vt),xb(this.layoutVertexArray,Ut.x,Ut.y,Ht.x,Ht.y,0,1,vt),k.x+=2*Ut.x,k.y+=2*Ut.y,k.vertexCount+=2,vt+=Jt,xb(this.layoutVertexArray,Kt.x,Kt.y,Ht.x,Ht.y,0,0,vt),xb(this.layoutVertexArray,Kt.x,Kt.y,Ht.x,Ht.y,0,1,vt),k.x+=2*Kt.x,k.y+=2*Kt.y,k.vertexCount+=2;let le=q.vertexLength;this.indexArray.emplaceBack(le,le+2,le+1),this.indexArray.emplaceBack(le+1,le+2,le+3),q.vertexLength+=4,q.primitiveLength+=2}}}}if(q.vertexLength+j>zn.MAX_VERTEX_ARRAY_LENGTH&&(q=this.segments.prepareSegment(j,this.layoutVertexArray,this.indexArray)),Tlt[a.type]!=="Polygon")continue;let K=[],et=[],it=q.vertexLength;for(let ht of F)if(ht.length!==0){ht!==F[0]&&et.push(K.length/2);for(let vt=0;vt<ht.length;vt++){let Nt=ht[vt];xb(this.layoutVertexArray,Nt.x,Nt.y,0,0,1,1,0),k.x+=Nt.x,k.y+=Nt.y,k.vertexCount+=1,K.push(Nt.x),K.push(Nt.y)}}let ct=cL(K,et);for(let ht=0;ht<ct.length;ht+=3)this.indexArray.emplaceBack(it+ct[ht],it+ct[ht+2],it+ct[ht+1]);q.primitiveLength+=ct.length/3,q.vertexLength+=j}for(let F=0;F<k.vertexCount;F++)this.centroidVertexArray.emplaceBack(Math.floor(k.x/k.vertexCount),Math.floor(k.y/k.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,y,R,w)}}function Slt(u,a){return u.x===a.x&&(u.x<0||u.x>Fs)||u.y===a.y&&(u.y<0||u.y>Fs)}function Elt(u){return u.every(a=>a.x<0)||u.every(a=>a.x>Fs)||u.every(a=>a.y<0)||u.every(a=>a.y>Fs)}let mL;Ve("FillExtrusionBucket",VC,{omit:["layers","features"]});var Ilt={get paint(){return mL=mL||new Ps({"fill-extrusion-opacity":new cr(ae["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Rr(ae["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new cr(ae["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new cr(ae["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new wh(ae["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Rr(ae["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Rr(ae["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new cr(ae["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class Mlt extends Ea{constructor(a){super(a,Ilt)}createBucket(a){return new VC(a)}queryRadius(){return J0(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(a,h,y,w,R,k,F,j){let q=wu(a,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),k.angle,F),K=this.paint.get("fill-extrusion-height").evaluate(h,y),et=this.paint.get("fill-extrusion-base").evaluate(h,y),it=function(ht,vt,Nt,Ut){let Kt=[];for(let Ht of ht){let Jt=[Ht.x,Ht.y,0,1];hd(Jt,Jt,vt),Kt.push(new x(Jt[0]/Jt[3],Jt[1]/Jt[3]))}return Kt}(q,j),ct=function(ht,vt,Nt,Ut){let Kt=[],Ht=[],Jt=Ut[8]*vt,le=Ut[9]*vt,ve=Ut[10]*vt,Ke=Ut[11]*vt,dr=Ut[8]*Nt,Qe=Ut[9]*Nt,Ye=Ut[10]*Nt,je=Ut[11]*Nt;for(let sr of ht){let He=[],Re=[];for(let Mr of sr){let mr=Mr.x,Bi=Mr.y,ns=Ut[0]*mr+Ut[4]*Bi+Ut[12],hs=Ut[1]*mr+Ut[5]*Bi+Ut[13],bo=Ut[2]*mr+Ut[6]*Bi+Ut[14],oc=Ut[3]*mr+Ut[7]*Bi+Ut[15],el=bo+ve,no=oc+Ke,Wo=ns+dr,ca=hs+Qe,rl=bo+Ye,il=oc+je,vo=new x((ns+Jt)/no,(hs+le)/no);vo.z=el/no,He.push(vo);let wo=new x(Wo/il,ca/il);wo.z=rl/il,Re.push(wo)}Kt.push(He),Ht.push(Re)}return[Kt,Ht]}(w,et,K,j);return function(ht,vt,Nt){let Ut=1/0;OT(Nt,vt)&&(Ut=gL(Nt,vt[0]));for(let Kt=0;Kt<vt.length;Kt++){let Ht=vt[Kt],Jt=ht[Kt];for(let le=0;le<Ht.length-1;le++){let ve=Ht[le],Ke=[ve,Ht[le+1],Jt[le+1],Jt[le],ve];BT(Nt,Ke)&&(Ut=Math.min(Ut,gL(Nt,Ke)))}}return Ut!==1/0&&Ut}(ct[0],ct[1],it)}}function bb(u,a){return u.x*a.x+u.y*a.y}function gL(u,a){if(u.length===1){let h=0,y=a[h++],w;for(;!w||y.equals(w);)if(w=a[h++],!w)return 1/0;for(;h<a.length;h++){let R=a[h],k=u[0],F=w.sub(y),j=R.sub(y),q=k.sub(y),K=bb(F,F),et=bb(F,j),it=bb(j,j),ct=bb(q,F),ht=bb(q,j),vt=K*it-et*et,Nt=(it*ct-et*ht)/vt,Ut=(K*ht-et*ct)/vt,Kt=y.z*(1-Nt-Ut)+w.z*Nt+R.z*Ut;if(isFinite(Kt))return Kt}return 1/0}{let h=1/0;for(let y of a)h=Math.min(h,y.z);return h}}let Clt=qn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Plt}=Clt,Rlt=qn([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:klt}=Rlt,Dlt=eA.VectorTileFeature.types,Blt=Math.cos(Math.PI/180*37.5),_L=Math.pow(2,14)/.5;class jC{constructor(a){this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(h=>h.id),this.index=a.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(h=>{this.gradients[h.id]={}}),this.layoutVertexArray=new Ir,this.layoutVertexArray2=new hr,this.indexArray=new go,this.programConfigurations=new jc(a.layers,a.zoom),this.segments=new zn,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(h=>h.isStateDependent()).map(h=>h.id)}populate(a,h,y){this.hasPattern=FC("line",this.layers,h);let w=this.layers[0].layout.get("line-sort-key"),R=!w.isConstant(),k=[];for(let{feature:F,id:j,index:q,sourceLayerIndex:K}of a){let et=this.layers[0]._featureFilter.needGeometry,it=Rf(F,et);if(!this.layers[0]._featureFilter.filter(new Wn(this.zoom),it,y))continue;let ct=R?w.evaluate(it,{},y):void 0,ht={id:j,properties:F.properties,type:F.type,sourceLayerIndex:K,index:q,geometry:et?it.geometry:Pf(F),patterns:{},sortKey:ct};k.push(ht)}R&&k.sort((F,j)=>F.sortKey-j.sortKey);for(let F of k){let{geometry:j,index:q,sourceLayerIndex:K}=F;if(this.hasPattern){let et=LC("line",this.layers,F,this.zoom,h);this.patternFeatures.push(et)}else this.addFeature(F,j,q,y,{});h.featureIndex.insert(a[q].feature,j,q,K,this.index)}}update(a,h,y){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(a,h,this.stateDependentLayers,y)}addFeatures(a,h,y){for(let w of this.patternFeatures)this.addFeature(w,w.geometry,w.index,h,y)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(a){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=a.createVertexBuffer(this.layoutVertexArray2,klt)),this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,Plt),this.indexBuffer=a.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(a),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(a){if(a.properties&&Object.prototype.hasOwnProperty.call(a.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(a.properties,"mapbox_clip_end"))return{start:+a.properties.mapbox_clip_start,end:+a.properties.mapbox_clip_end}}addFeature(a,h,y,w,R){let k=this.layers[0].layout,F=k.get("line-join").evaluate(a,{}),j=k.get("line-cap"),q=k.get("line-miter-limit"),K=k.get("line-round-limit");this.lineClips=this.lineFeatureClips(a);for(let et of h)this.addLine(et,a,F,j,q,K);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,a,y,R,w)}addLine(a,h,y,w,R,k){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Ut=0;Ut<a.length-1;Ut++)this.totalDistance+=a[Ut].dist(a[Ut+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}let F=Dlt[h.type]==="Polygon",j=a.length;for(;j>=2&&a[j-1].equals(a[j-2]);)j--;let q=0;for(;q<j-1&&a[q].equals(a[q+1]);)q++;if(j<(F?3:2))return;y==="bevel"&&(R=1.05);let K=this.overscaling<=16?15*Fs/(512*this.overscaling):0,et=this.segments.prepareSegment(10*j,this.layoutVertexArray,this.indexArray),it,ct,ht,vt,Nt;this.e1=this.e2=-1,F&&(it=a[j-2],Nt=a[q].sub(it)._unit()._perp());for(let Ut=q;Ut<j;Ut++){if(ht=Ut===j-1?F?a[q+1]:void 0:a[Ut+1],ht&&a[Ut].equals(ht))continue;Nt&&(vt=Nt),it&&(ct=it),it=a[Ut],Nt=ht?ht.sub(it)._unit()._perp():vt,vt=vt||Nt;let Kt=vt.add(Nt);Kt.x===0&&Kt.y===0||Kt._unit();let Ht=vt.x*Nt.x+vt.y*Nt.y,Jt=Kt.x*Nt.x+Kt.y*Nt.y,le=Jt!==0?1/Jt:1/0,ve=2*Math.sqrt(2-2*Jt),Ke=Jt<Blt&&ct&&ht,dr=vt.x*Nt.y-vt.y*Nt.x>0;if(Ke&&Ut>q){let je=it.dist(ct);if(je>2*K){let sr=it.sub(it.sub(ct)._mult(K/je)._round());this.updateDistance(ct,sr),this.addCurrentVertex(sr,vt,0,0,et),ct=sr}}let Qe=ct&&ht,Ye=Qe?y:F?"butt":w;if(Qe&&Ye==="round"&&(le<k?Ye="miter":le<=2&&(Ye="fakeround")),Ye==="miter"&&le>R&&(Ye="bevel"),Ye==="bevel"&&(le>2&&(Ye="flipbevel"),le<R&&(Ye="miter")),ct&&this.updateDistance(ct,it),Ye==="miter")Kt._mult(le),this.addCurrentVertex(it,Kt,0,0,et);else if(Ye==="flipbevel"){if(le>100)Kt=Nt.mult(-1);else{let je=le*vt.add(Nt).mag()/vt.sub(Nt).mag();Kt._perp()._mult(je*(dr?-1:1))}this.addCurrentVertex(it,Kt,0,0,et),this.addCurrentVertex(it,Kt.mult(-1),0,0,et)}else if(Ye==="bevel"||Ye==="fakeround"){let je=-Math.sqrt(le*le-1),sr=dr?je:0,He=dr?0:je;if(ct&&this.addCurrentVertex(it,vt,sr,He,et),Ye==="fakeround"){let Re=Math.round(180*ve/Math.PI/20);for(let Mr=1;Mr<Re;Mr++){let mr=Mr/Re;if(mr!==.5){let ns=mr-.5;mr+=mr*ns*(mr-1)*((1.0904+Ht*(Ht*(3.55645-1.43519*Ht)-3.2452))*ns*ns+(.848013+Ht*(.215638*Ht-1.06021)))}let Bi=Nt.sub(vt)._mult(mr)._add(vt)._unit()._mult(dr?-1:1);this.addHalfVertex(it,Bi.x,Bi.y,!1,dr,0,et)}}ht&&this.addCurrentVertex(it,Nt,-sr,-He,et)}else if(Ye==="butt")this.addCurrentVertex(it,Kt,0,0,et);else if(Ye==="square"){let je=ct?1:-1;this.addCurrentVertex(it,Kt,je,je,et)}else Ye==="round"&&(ct&&(this.addCurrentVertex(it,vt,0,0,et),this.addCurrentVertex(it,vt,1,1,et,!0)),ht&&(this.addCurrentVertex(it,Nt,-1,-1,et,!0),this.addCurrentVertex(it,Nt,0,0,et)));if(Ke&&Ut<j-1){let je=it.dist(ht);if(je>2*K){let sr=it.add(ht.sub(it)._mult(K/je)._round());this.updateDistance(it,sr),this.addCurrentVertex(sr,Nt,0,0,et),it=sr}}}}addCurrentVertex(a,h,y,w,R,k=!1){let F=h.y*w-h.x,j=-h.y-h.x*w;this.addHalfVertex(a,h.x+h.y*y,h.y-h.x*y,k,!1,y,R),this.addHalfVertex(a,F,j,k,!0,-w,R),this.distance>_L/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(a,h,y,w,R,k))}addHalfVertex({x:a,y:h},y,w,R,k,F,j){let q=.5*(this.lineClips?this.scaledDistance*(_L-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((a<<1)+(R?1:0),(h<<1)+(k?1:0),Math.round(63*y)+128,Math.round(63*w)+128,1+(F===0?0:F<0?-1:1)|(63&q)<<2,q>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);let K=j.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,K),j.primitiveLength++),k?this.e2=K:this.e1=K}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(a,h){this.distance+=a.dist(h),this.updateScaledDistance()}}let yL,xL;Ve("LineBucket",jC,{omit:["layers","patternFeatures"]});var bL={get paint(){return xL=xL||new Ps({"line-opacity":new Rr(ae.paint_line["line-opacity"]),"line-color":new Rr(ae.paint_line["line-color"]),"line-translate":new cr(ae.paint_line["line-translate"]),"line-translate-anchor":new cr(ae.paint_line["line-translate-anchor"]),"line-width":new Rr(ae.paint_line["line-width"]),"line-gap-width":new Rr(ae.paint_line["line-gap-width"]),"line-offset":new Rr(ae.paint_line["line-offset"]),"line-blur":new Rr(ae.paint_line["line-blur"]),"line-dasharray":new G0(ae.paint_line["line-dasharray"]),"line-pattern":new wh(ae.paint_line["line-pattern"]),"line-gradient":new yu(ae.paint_line["line-gradient"])})},get layout(){return yL=yL||new Ps({"line-cap":new cr(ae.layout_line["line-cap"]),"line-join":new Rr(ae.layout_line["line-join"]),"line-miter-limit":new cr(ae.layout_line["line-miter-limit"]),"line-round-limit":new cr(ae.layout_line["line-round-limit"]),"line-sort-key":new Rr(ae.layout_line["line-sort-key"])})}};class Olt extends Rr{possiblyEvaluate(a,h){return h=new Wn(Math.floor(h.zoom),{now:h.now,fadeDuration:h.fadeDuration,zoomHistory:h.zoomHistory,transition:h.transition}),super.possiblyEvaluate(a,h)}evaluate(a,h,y,w){return h=at({},h,{zoom:Math.floor(h.zoom)}),super.evaluate(a,h,y,w)}}let FT;class Nlt extends Ea{constructor(a){super(a,bL),this.gradientVersion=0,FT||(FT=new Olt(bL.paint.properties["line-width"].specification),FT.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(a){if(a==="line-gradient"){let h=this.gradientExpression();this.stepInterpolant=!!function(y){return y._styleExpression!==void 0}(h)&&h._styleExpression.expression instanceof yh,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(a,h){super.recalculate(a,h),this.paint._values["line-floorwidth"]=FT.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,a)}createBucket(a){return new jC(a)}queryRadius(a){let h=a,y=vL(K0("line-width",this,h),K0("line-gap-width",this,h)),w=K0("line-offset",this,h);return y/2+Math.abs(w)+J0(this.paint.get("line-translate"))}queryIntersectsFeature(a,h,y,w,R,k,F){let j=wu(a,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),k.angle,F),q=F/2*vL(this.paint.get("line-width").evaluate(h,y),this.paint.get("line-gap-width").evaluate(h,y)),K=this.paint.get("line-offset").evaluate(h,y);return K&&(w=function(et,it){let ct=[];for(let ht=0;ht<et.length;ht++){let vt=et[ht],Nt=[];for(let Ut=0;Ut<vt.length;Ut++){let Kt=vt[Ut-1],Ht=vt[Ut],Jt=vt[Ut+1],le=Ut===0?new x(0,0):Ht.sub(Kt)._unit()._perp(),ve=Ut===vt.length-1?new x(0,0):Jt.sub(Ht)._unit()._perp(),Ke=le._add(ve)._unit(),dr=Ke.x*ve.x+Ke.y*ve.y;dr!==0&&Ke._mult(1/dr),Nt.push(Ke._mult(it)._add(Ht))}ct.push(Nt)}return ct}(w,K*F)),function(et,it,ct){for(let ht=0;ht<it.length;ht++){let vt=it[ht];if(et.length>=3){for(let Nt=0;Nt<vt.length;Nt++)if(Ei(et,vt[Nt]))return!0}if(DC(et,vt,ct))return!0}return!1}(j,w,q)}isTileClipped(){return!0}}function vL(u,a){return a>0?a+2*u:u}let Flt=qn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Llt=qn([{name:"a_projected_pos",components:3,type:"Float32"}],4);qn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);let zlt=qn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);qn([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);let wL=qn([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Ult=qn([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Vlt(u,a,h){return u.sections.forEach(y=>{y.text=function(w,R,k){let F=R.layout.get("text-transform").evaluate(k,{});return F==="uppercase"?w=w.toLocaleUpperCase():F==="lowercase"&&(w=w.toLocaleLowerCase()),Sa.applyArabicShaping&&(w=Sa.applyArabicShaping(w)),w}(y.text,a,h)}),u}qn([{name:"triangle",components:3,type:"Uint16"}]),qn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),qn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),qn([{type:"Float32",name:"offsetX"}]),qn([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),qn([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);let vb={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"};var xo=24,TL=Un,SL=function(u,a,h,y,w){var R,k,F=8*w-y-1,j=(1<<F)-1,q=j>>1,K=-7,et=h?w-1:0,it=h?-1:1,ct=u[a+et];for(et+=it,R=ct&(1<<-K)-1,ct>>=-K,K+=F;K>0;R=256*R+u[a+et],et+=it,K-=8);for(k=R&(1<<-K)-1,R>>=-K,K+=y;K>0;k=256*k+u[a+et],et+=it,K-=8);if(R===0)R=1-q;else{if(R===j)return k?NaN:1/0*(ct?-1:1);k+=Math.pow(2,y),R-=q}return(ct?-1:1)*k*Math.pow(2,R-y)},EL=function(u,a,h,y,w,R){var k,F,j,q=8*R-w-1,K=(1<<q)-1,et=K>>1,it=w===23?Math.pow(2,-24)-Math.pow(2,-77):0,ct=y?0:R-1,ht=y?1:-1,vt=a<0||a===0&&1/a<0?1:0;for(a=Math.abs(a),isNaN(a)||a===1/0?(F=isNaN(a)?1:0,k=K):(k=Math.floor(Math.log(a)/Math.LN2),a*(j=Math.pow(2,-k))<1&&(k--,j*=2),(a+=k+et>=1?it/j:it*Math.pow(2,1-et))*j>=2&&(k++,j/=2),k+et>=K?(F=0,k=K):k+et>=1?(F=(a*j-1)*Math.pow(2,w),k+=et):(F=a*Math.pow(2,et-1)*Math.pow(2,w),k=0));w>=8;u[h+ct]=255&F,ct+=ht,F/=256,w-=8);for(k=k<<w|F,q+=w;q>0;u[h+ct]=255&k,ct+=ht,k/=256,q-=8);u[h+ct-ht]|=128*vt};function Un(u){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(u)?u:new Uint8Array(u||0),this.pos=0,this.type=0,this.length=this.buf.length}Un.Varint=0,Un.Fixed64=1,Un.Bytes=2,Un.Fixed32=5;var $C=4294967296,IL=1/$C,ML=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function fd(u){return u.type===Un.Bytes?u.readVarint()+u.pos:u.pos+1}function ey(u,a,h){return h?4294967296*a+(u>>>0):4294967296*(a>>>0)+(u>>>0)}function CL(u,a,h){var y=a<=16383?1:a<=2097151?2:a<=268435455?3:Math.floor(Math.log(a)/(7*Math.LN2));h.realloc(y);for(var w=h.pos-1;w>=u;w--)h.buf[w+y]=h.buf[w]}function jlt(u,a){for(var h=0;h<u.length;h++)a.writeVarint(u[h])}function $lt(u,a){for(var h=0;h<u.length;h++)a.writeSVarint(u[h])}function Hlt(u,a){for(var h=0;h<u.length;h++)a.writeFloat(u[h])}function Wlt(u,a){for(var h=0;h<u.length;h++)a.writeDouble(u[h])}function qlt(u,a){for(var h=0;h<u.length;h++)a.writeBoolean(u[h])}function Ylt(u,a){for(var h=0;h<u.length;h++)a.writeFixed32(u[h])}function Xlt(u,a){for(var h=0;h<u.length;h++)a.writeSFixed32(u[h])}function Zlt(u,a){for(var h=0;h<u.length;h++)a.writeFixed64(u[h])}function Glt(u,a){for(var h=0;h<u.length;h++)a.writeSFixed64(u[h])}function LT(u,a){return(u[a]|u[a+1]<<8|u[a+2]<<16)+16777216*u[a+3]}function ry(u,a,h){u[h]=a,u[h+1]=a>>>8,u[h+2]=a>>>16,u[h+3]=a>>>24}function PL(u,a){return(u[a]|u[a+1]<<8|u[a+2]<<16)+(u[a+3]<<24)}Un.prototype={destroy:function(){this.buf=null},readFields:function(u,a,h){for(h=h||this.length;this.pos<h;){var y=this.readVarint(),w=y>>3,R=this.pos;this.type=7&y,u(w,a,this),this.pos===R&&this.skip(y)}return a},readMessage:function(u,a){return this.readFields(u,a,this.readVarint()+this.pos)},readFixed32:function(){var u=LT(this.buf,this.pos);return this.pos+=4,u},readSFixed32:function(){var u=PL(this.buf,this.pos);return this.pos+=4,u},readFixed64:function(){var u=LT(this.buf,this.pos)+LT(this.buf,this.pos+4)*$C;return this.pos+=8,u},readSFixed64:function(){var u=LT(this.buf,this.pos)+PL(this.buf,this.pos+4)*$C;return this.pos+=8,u},readFloat:function(){var u=SL(this.buf,this.pos,!0,23,4);return this.pos+=4,u},readDouble:function(){var u=SL(this.buf,this.pos,!0,52,8);return this.pos+=8,u},readVarint:function(u){var a,h,y=this.buf;return a=127&(h=y[this.pos++]),h<128?a:(a|=(127&(h=y[this.pos++]))<<7,h<128?a:(a|=(127&(h=y[this.pos++]))<<14,h<128?a:(a|=(127&(h=y[this.pos++]))<<21,h<128?a:function(w,R,k){var F,j,q=k.buf;if(F=(112&(j=q[k.pos++]))>>4,j<128||(F|=(127&(j=q[k.pos++]))<<3,j<128)||(F|=(127&(j=q[k.pos++]))<<10,j<128)||(F|=(127&(j=q[k.pos++]))<<17,j<128)||(F|=(127&(j=q[k.pos++]))<<24,j<128)||(F|=(1&(j=q[k.pos++]))<<31,j<128))return ey(w,F,R);throw new Error("Expected varint not more than 10 bytes")}(a|=(15&(h=y[this.pos]))<<28,u,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var u=this.readVarint();return u%2==1?(u+1)/-2:u/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var u=this.readVarint()+this.pos,a=this.pos;return this.pos=u,u-a>=12&&ML?function(h,y,w){return ML.decode(h.subarray(y,w))}(this.buf,a,u):function(h,y,w){for(var R="",k=y;k<w;){var F,j,q,K=h[k],et=null,it=K>239?4:K>223?3:K>191?2:1;if(k+it>w)break;it===1?K<128&&(et=K):it===2?(192&(F=h[k+1]))==128&&(et=(31&K)<<6|63&F)<=127&&(et=null):it===3?(j=h[k+2],(192&(F=h[k+1]))==128&&(192&j)==128&&((et=(15&K)<<12|(63&F)<<6|63&j)<=2047||et>=55296&&et<=57343)&&(et=null)):it===4&&(j=h[k+2],q=h[k+3],(192&(F=h[k+1]))==128&&(192&j)==128&&(192&q)==128&&((et=(15&K)<<18|(63&F)<<12|(63&j)<<6|63&q)<=65535||et>=1114112)&&(et=null)),et===null?(et=65533,it=1):et>65535&&(et-=65536,R+=String.fromCharCode(et>>>10&1023|55296),et=56320|1023&et),R+=String.fromCharCode(et),k+=it}return R}(this.buf,a,u)},readBytes:function(){var u=this.readVarint()+this.pos,a=this.buf.subarray(this.pos,u);return this.pos=u,a},readPackedVarint:function(u,a){if(this.type!==Un.Bytes)return u.push(this.readVarint(a));var h=fd(this);for(u=u||[];this.pos<h;)u.push(this.readVarint(a));return u},readPackedSVarint:function(u){if(this.type!==Un.Bytes)return u.push(this.readSVarint());var a=fd(this);for(u=u||[];this.pos<a;)u.push(this.readSVarint());return u},readPackedBoolean:function(u){if(this.type!==Un.Bytes)return u.push(this.readBoolean());var a=fd(this);for(u=u||[];this.pos<a;)u.push(this.readBoolean());return u},readPackedFloat:function(u){if(this.type!==Un.Bytes)return u.push(this.readFloat());var a=fd(this);for(u=u||[];this.pos<a;)u.push(this.readFloat());return u},readPackedDouble:function(u){if(this.type!==Un.Bytes)return u.push(this.readDouble());var a=fd(this);for(u=u||[];this.pos<a;)u.push(this.readDouble());return u},readPackedFixed32:function(u){if(this.type!==Un.Bytes)return u.push(this.readFixed32());var a=fd(this);for(u=u||[];this.pos<a;)u.push(this.readFixed32());return u},readPackedSFixed32:function(u){if(this.type!==Un.Bytes)return u.push(this.readSFixed32());var a=fd(this);for(u=u||[];this.pos<a;)u.push(this.readSFixed32());return u},readPackedFixed64:function(u){if(this.type!==Un.Bytes)return u.push(this.readFixed64());var a=fd(this);for(u=u||[];this.pos<a;)u.push(this.readFixed64());return u},readPackedSFixed64:function(u){if(this.type!==Un.Bytes)return u.push(this.readSFixed64());var a=fd(this);for(u=u||[];this.pos<a;)u.push(this.readSFixed64());return u},skip:function(u){var a=7&u;if(a===Un.Varint)for(;this.buf[this.pos++]>127;);else if(a===Un.Bytes)this.pos=this.readVarint()+this.pos;else if(a===Un.Fixed32)this.pos+=4;else{if(a!==Un.Fixed64)throw new Error("Unimplemented type: "+a);this.pos+=8}},writeTag:function(u,a){this.writeVarint(u<<3|a)},realloc:function(u){for(var a=this.length||16;a<this.pos+u;)a*=2;if(a!==this.length){var h=new Uint8Array(a);h.set(this.buf),this.buf=h,this.length=a}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(u){this.realloc(4),ry(this.buf,u,this.pos),this.pos+=4},writeSFixed32:function(u){this.realloc(4),ry(this.buf,u,this.pos),this.pos+=4},writeFixed64:function(u){this.realloc(8),ry(this.buf,-1&u,this.pos),ry(this.buf,Math.floor(u*IL),this.pos+4),this.pos+=8},writeSFixed64:function(u){this.realloc(8),ry(this.buf,-1&u,this.pos),ry(this.buf,Math.floor(u*IL),this.pos+4),this.pos+=8},writeVarint:function(u){(u=+u||0)>268435455||u<0?function(a,h){var y,w;if(a>=0?(y=a%4294967296|0,w=a/4294967296|0):(w=~(-a/4294967296),4294967295^(y=~(-a%4294967296))?y=y+1|0:(y=0,w=w+1|0)),a>=18446744073709552e3||a<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");h.realloc(10),function(R,k,F){F.buf[F.pos++]=127&R|128,R>>>=7,F.buf[F.pos++]=127&R|128,R>>>=7,F.buf[F.pos++]=127&R|128,R>>>=7,F.buf[F.pos++]=127&R|128,F.buf[F.pos]=127&(R>>>=7)}(y,0,h),function(R,k){var F=(7&R)<<4;k.buf[k.pos++]|=F|((R>>>=3)?128:0),R&&(k.buf[k.pos++]=127&R|((R>>>=7)?128:0),R&&(k.buf[k.pos++]=127&R|((R>>>=7)?128:0),R&&(k.buf[k.pos++]=127&R|((R>>>=7)?128:0),R&&(k.buf[k.pos++]=127&R|((R>>>=7)?128:0),R&&(k.buf[k.pos++]=127&R)))))}(w,h)}(u,this):(this.realloc(4),this.buf[this.pos++]=127&u|(u>127?128:0),u<=127||(this.buf[this.pos++]=127&(u>>>=7)|(u>127?128:0),u<=127||(this.buf[this.pos++]=127&(u>>>=7)|(u>127?128:0),u<=127||(this.buf[this.pos++]=u>>>7&127))))},writeSVarint:function(u){this.writeVarint(u<0?2*-u-1:2*u)},writeBoolean:function(u){this.writeVarint(!!u)},writeString:function(u){u=String(u),this.realloc(4*u.length),this.pos++;var a=this.pos;this.pos=function(y,w,R){for(var k,F,j=0;j<w.length;j++){if((k=w.charCodeAt(j))>55295&&k<57344){if(!F){k>56319||j+1===w.length?(y[R++]=239,y[R++]=191,y[R++]=189):F=k;continue}if(k<56320){y[R++]=239,y[R++]=191,y[R++]=189,F=k;continue}k=F-55296<<10|k-56320|65536,F=null}else F&&(y[R++]=239,y[R++]=191,y[R++]=189,F=null);k<128?y[R++]=k:(k<2048?y[R++]=k>>6|192:(k<65536?y[R++]=k>>12|224:(y[R++]=k>>18|240,y[R++]=k>>12&63|128),y[R++]=k>>6&63|128),y[R++]=63&k|128)}return R}(this.buf,u,this.pos);var h=this.pos-a;h>=128&&CL(a,h,this),this.pos=a-1,this.writeVarint(h),this.pos+=h},writeFloat:function(u){this.realloc(4),EL(this.buf,u,this.pos,!0,23,4),this.pos+=4},writeDouble:function(u){this.realloc(8),EL(this.buf,u,this.pos,!0,52,8),this.pos+=8},writeBytes:function(u){var a=u.length;this.writeVarint(a),this.realloc(a);for(var h=0;h<a;h++)this.buf[this.pos++]=u[h]},writeRawMessage:function(u,a){this.pos++;var h=this.pos;u(a,this);var y=this.pos-h;y>=128&&CL(h,y,this),this.pos=h-1,this.writeVarint(y),this.pos+=y},writeMessage:function(u,a,h){this.writeTag(u,Un.Bytes),this.writeRawMessage(a,h)},writePackedVarint:function(u,a){a.length&&this.writeMessage(u,jlt,a)},writePackedSVarint:function(u,a){a.length&&this.writeMessage(u,$lt,a)},writePackedBoolean:function(u,a){a.length&&this.writeMessage(u,qlt,a)},writePackedFloat:function(u,a){a.length&&this.writeMessage(u,Hlt,a)},writePackedDouble:function(u,a){a.length&&this.writeMessage(u,Wlt,a)},writePackedFixed32:function(u,a){a.length&&this.writeMessage(u,Ylt,a)},writePackedSFixed32:function(u,a){a.length&&this.writeMessage(u,Xlt,a)},writePackedFixed64:function(u,a){a.length&&this.writeMessage(u,Zlt,a)},writePackedSFixed64:function(u,a){a.length&&this.writeMessage(u,Glt,a)},writeBytesField:function(u,a){this.writeTag(u,Un.Bytes),this.writeBytes(a)},writeFixed32Field:function(u,a){this.writeTag(u,Un.Fixed32),this.writeFixed32(a)},writeSFixed32Field:function(u,a){this.writeTag(u,Un.Fixed32),this.writeSFixed32(a)},writeFixed64Field:function(u,a){this.writeTag(u,Un.Fixed64),this.writeFixed64(a)},writeSFixed64Field:function(u,a){this.writeTag(u,Un.Fixed64),this.writeSFixed64(a)},writeVarintField:function(u,a){this.writeTag(u,Un.Varint),this.writeVarint(a)},writeSVarintField:function(u,a){this.writeTag(u,Un.Varint),this.writeSVarint(a)},writeStringField:function(u,a){this.writeTag(u,Un.Bytes),this.writeString(a)},writeFloatField:function(u,a){this.writeTag(u,Un.Fixed32),this.writeFloat(a)},writeDoubleField:function(u,a){this.writeTag(u,Un.Fixed64),this.writeDouble(a)},writeBooleanField:function(u,a){this.writeVarintField(u,!!a)}};var HC=c(TL);let WC=3;function Qlt(u,a,h){u===1&&h.readMessage(Klt,a)}function Klt(u,a,h){if(u===3){let{id:y,bitmap:w,width:R,height:k,left:F,top:j,advance:q}=h.readMessage(Jlt,{});a.push({id:y,bitmap:new I({width:R+2*WC,height:k+2*WC},w),metrics:{width:R,height:k,left:F,top:j,advance:q}})}}function Jlt(u,a,h){u===1?a.id=h.readVarint():u===2?a.bitmap=h.readBytes():u===3?a.width=h.readVarint():u===4?a.height=h.readVarint():u===5?a.left=h.readSVarint():u===6?a.top=h.readSVarint():u===7&&(a.advance=h.readVarint())}let RL=WC;function kL(u){let a=0,h=0;for(let k of u)a+=k.w*k.h,h=Math.max(h,k.w);u.sort((k,F)=>F.h-k.h);let y=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(a/.95)),h),h:1/0}],w=0,R=0;for(let k of u)for(let F=y.length-1;F>=0;F--){let j=y[F];if(!(k.w>j.w||k.h>j.h)){if(k.x=j.x,k.y=j.y,R=Math.max(R,k.y+k.h),w=Math.max(w,k.x+k.w),k.w===j.w&&k.h===j.h){let q=y.pop();F<y.length&&(y[F]=q)}else k.h===j.h?(j.x+=k.w,j.w-=k.w):k.w===j.w?(j.y+=k.h,j.h-=k.h):(y.push({x:j.x+k.w,y:j.y,w:j.w-k.w,h:k.h}),j.y+=k.h,j.h-=k.h);break}}return{w,h:R,fill:a/(w*R)||0}}let Ml=1;class qC{constructor(a,{pixelRatio:h,version:y,stretchX:w,stretchY:R,content:k}){this.paddedRect=a,this.pixelRatio=h,this.stretchX=w,this.stretchY=R,this.content=k,this.version=y}get tl(){return[this.paddedRect.x+Ml,this.paddedRect.y+Ml]}get br(){return[this.paddedRect.x+this.paddedRect.w-Ml,this.paddedRect.y+this.paddedRect.h-Ml]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*Ml)/this.pixelRatio,(this.paddedRect.h-2*Ml)/this.pixelRatio]}}class DL{constructor(a,h){let y={},w={};this.haveRenderCallbacks=[];let R=[];this.addImages(a,y,R),this.addImages(h,w,R);let{w:k,h:F}=kL(R),j=new P({width:k||1,height:F||1});for(let q in a){let K=a[q],et=y[q].paddedRect;P.copy(K.data,j,{x:0,y:0},{x:et.x+Ml,y:et.y+Ml},K.data)}for(let q in h){let K=h[q],et=w[q].paddedRect,it=et.x+Ml,ct=et.y+Ml,ht=K.data.width,vt=K.data.height;P.copy(K.data,j,{x:0,y:0},{x:it,y:ct},K.data),P.copy(K.data,j,{x:0,y:vt-1},{x:it,y:ct-1},{width:ht,height:1}),P.copy(K.data,j,{x:0,y:0},{x:it,y:ct+vt},{width:ht,height:1}),P.copy(K.data,j,{x:ht-1,y:0},{x:it-1,y:ct},{width:1,height:vt}),P.copy(K.data,j,{x:0,y:0},{x:it+ht,y:ct},{width:1,height:vt})}this.image=j,this.iconPositions=y,this.patternPositions=w}addImages(a,h,y){for(let w in a){let R=a[w],k={x:0,y:0,w:R.data.width+2*Ml,h:R.data.height+2*Ml};y.push(k),h[w]=new qC(k,R),R.hasRenderCallback&&this.haveRenderCallbacks.push(w)}}patchUpdatedImages(a,h){a.dispatchRenderCallbacks(this.haveRenderCallbacks);for(let y in a.updatedImages)this.patchUpdatedImage(this.iconPositions[y],a.getImage(y),h),this.patchUpdatedImage(this.patternPositions[y],a.getImage(y),h)}patchUpdatedImage(a,h,y){if(!a||!h||a.version===h.version)return;a.version=h.version;let[w,R]=a.tl;y.update(h.data,void 0,{x:w,y:R})}}var rA;Ve("ImagePosition",qC),Ve("ImageAtlas",DL),n.ai=void 0,(rA=n.ai||(n.ai={}))[rA.none=0]="none",rA[rA.horizontal=1]="horizontal",rA[rA.vertical=2]="vertical",rA[rA.horizontalOnly=3]="horizontalOnly";let wb=-17;class Tb{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(a,h){let y=new Tb;return y.scale=a||1,y.fontStack=h,y}static forImage(a){let h=new Tb;return h.imageName=a,h}}class iy{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(a,h){let y=new iy;for(let w=0;w<a.sections.length;w++){let R=a.sections[w];R.image?y.addImageSection(R):y.addTextSection(R,h)}return y}length(){return this.text.length}getSection(a){return this.sections[this.sectionIndex[a]]}getSectionIndex(a){return this.sectionIndex[a]}getCharCode(a){return this.text.charCodeAt(a)}verticalizePunctuation(){this.text=function(a){let h="";for(let y=0;y<a.length;y++){let w=a.charCodeAt(y+1)||null,R=a.charCodeAt(y-1)||null;h+=w&&sd(w)&&!vb[a[y+1]]||R&&sd(R)&&!vb[a[y-1]]||!vb[a[y]]?a[y]:vb[a[y]]}return h}(this.text)}trim(){let a=0;for(let y=0;y<this.text.length&&UT[this.text.charCodeAt(y)];y++)a++;let h=this.text.length;for(let y=this.text.length-1;y>=0&&y>=a&&UT[this.text.charCodeAt(y)];y--)h--;this.text=this.text.substring(a,h),this.sectionIndex=this.sectionIndex.slice(a,h)}substring(a,h){let y=new iy;return y.text=this.text.substring(a,h),y.sectionIndex=this.sectionIndex.slice(a,h),y.sections=this.sections,y}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((a,h)=>Math.max(a,this.sections[h].scale),0)}addTextSection(a,h){this.text+=a.text,this.sections.push(Tb.forText(a.scale,a.fontStack||h));let y=this.sections.length-1;for(let w=0;w<a.text.length;++w)this.sectionIndex.push(y)}addImageSection(a){let h=a.image?a.image.name:"";if(h.length===0)return void oe("Can't add FormattedSection with an empty image.");let y=this.getNextImageSectionCharCode();y?(this.text+=String.fromCharCode(y),this.sections.push(Tb.forImage(h)),this.sectionIndex.push(this.sections.length-1)):oe("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function zT(u,a,h,y,w,R,k,F,j,q,K,et,it,ct,ht,vt){let Nt=iy.fromFeature(u,w),Ut;et===n.ai.vertical&&Nt.verticalizePunctuation();let{processBidirectionalText:Kt,processStyledBidirectionalText:Ht}=Sa;if(Kt&&Nt.sections.length===1){Ut=[];let ve=Kt(Nt.toString(),YC(Nt,q,R,a,y,ct,ht));for(let Ke of ve){let dr=new iy;dr.text=Ke,dr.sections=Nt.sections;for(let Qe=0;Qe<Ke.length;Qe++)dr.sectionIndex.push(0);Ut.push(dr)}}else if(Ht){Ut=[];let ve=Ht(Nt.text,Nt.sectionIndex,YC(Nt,q,R,a,y,ct,ht));for(let Ke of ve){let dr=new iy;dr.text=Ke[0],dr.sectionIndex=Ke[1],dr.sections=Nt.sections,Ut.push(dr)}}else Ut=function(ve,Ke){let dr=[],Qe=ve.text,Ye=0;for(let je of Ke)dr.push(ve.substring(Ye,je)),Ye=je;return Ye<Qe.length&&dr.push(ve.substring(Ye,Qe.length)),dr}(Nt,YC(Nt,q,R,a,y,ct,ht));let Jt=[],le={positionedLines:Jt,text:Nt.toString(),top:K[1],bottom:K[1],left:K[0],right:K[0],writingMode:et,iconsInText:!1,verticalizable:!1};return function(ve,Ke,dr,Qe,Ye,je,sr,He,Re,Mr,mr,Bi){let ns=0,hs=wb,bo=0,oc=0,el=He==="right"?1:He==="left"?0:.5,no=0;for(let vo of Ye){vo.trim();let wo=vo.getMaxScale(),Ca=(wo-1)*xo,nl={positionedGlyphs:[],lineOffset:0};ve.positionedLines[no]=nl;let Pa=nl.positionedGlyphs,Cl=0;if(!vo.length()){hs+=je,++no;continue}for(let To=0;To<vo.length();To++){let Xi=vo.getSection(To),Ra=vo.getSectionIndex(To),ua=vo.getCharCode(To),So=0,Tu=null,Ch=null,Ph=null,pd=xo,Su=!(Re===n.ai.horizontal||!mr&&!q0(ua)||mr&&(UT[ua]||(Wo=ua,qe.Arabic(Wo)||qe["Arabic Supplement"](Wo)||qe["Arabic Extended-A"](Wo)||qe["Arabic Presentation Forms-A"](Wo)||qe["Arabic Presentation Forms-B"](Wo))));if(Xi.imageName){let Wc=Qe[Xi.imageName];if(!Wc)continue;Ph=Xi.imageName,ve.iconsInText=ve.iconsInText||!0,Ch=Wc.paddedRect;let Rl=Wc.displaySize;Xi.scale=Xi.scale*xo/Bi,Tu={width:Rl[0],height:Rl[1],left:Ml,top:-RL,advance:Su?Rl[1]:Rl[0]},So=Ca+(xo-Rl[1]*Xi.scale),pd=Tu.advance;let dd=Su?Rl[0]*Xi.scale-xo*wo:Rl[1]*Xi.scale-xo*wo;dd>0&&dd>Cl&&(Cl=dd)}else{let Wc=dr[Xi.fontStack],Rl=Wc&&Wc[ua];if(Rl&&Rl.rect)Ch=Rl.rect,Tu=Rl.metrics;else{let dd=Ke[Xi.fontStack],Cb=dd&&dd[ua];if(!Cb)continue;Tu=Cb.metrics}So=(wo-Xi.scale)*xo}Su?(ve.verticalizable=!0,Pa.push({glyph:ua,imageName:Ph,x:ns,y:hs+So,vertical:Su,scale:Xi.scale,fontStack:Xi.fontStack,sectionIndex:Ra,metrics:Tu,rect:Ch}),ns+=pd*Xi.scale+Mr):(Pa.push({glyph:ua,imageName:Ph,x:ns,y:hs+So,vertical:Su,scale:Xi.scale,fontStack:Xi.fontStack,sectionIndex:Ra,metrics:Tu,rect:Ch}),ns+=Tu.advance*Xi.scale+Mr)}Pa.length!==0&&(bo=Math.max(ns-Mr,bo),rct(Pa,0,Pa.length-1,el,Cl)),ns=0;let Pl=je*wo+Cl;nl.lineOffset=Math.max(Cl,Ca),hs+=Pl,oc=Math.max(Pl,oc),++no}var Wo;let ca=hs-wb,{horizontalAlign:rl,verticalAlign:il}=XC(sr);(function(vo,wo,Ca,nl,Pa,Cl,Pl,To,Xi){let Ra=(wo-Ca)*Pa,ua=0;ua=Cl!==Pl?-To*nl-wb:(-nl*Xi+.5)*Pl;for(let So of vo)for(let Tu of So.positionedGlyphs)Tu.x+=Ra,Tu.y+=ua})(ve.positionedLines,el,rl,il,bo,oc,je,ca,Ye.length),ve.top+=-il*ca,ve.bottom=ve.top+ca,ve.left+=-rl*bo,ve.right=ve.left+bo}(le,a,h,y,Ut,k,F,j,et,q,it,vt),!function(ve){for(let Ke of ve)if(Ke.positionedGlyphs.length!==0)return!1;return!0}(Jt)&&le}let UT={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},tct={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function BL(u,a,h,y,w,R){if(a.imageName){let k=y[a.imageName];return k?k.displaySize[0]*a.scale*xo/R+w:0}{let k=h[a.fontStack],F=k&&k[u];return F?F.metrics.advance*a.scale+w:0}}function OL(u,a,h,y){let w=Math.pow(u-a,2);return y?u<a?w/2:2*w:w+Math.abs(h)*h}function ect(u,a,h){let y=0;return u===10&&(y-=1e4),h&&(y+=150),u!==40&&u!==65288||(y+=50),a!==41&&a!==65289||(y+=50),y}function NL(u,a,h,y,w,R){let k=null,F=OL(a,h,w,R);for(let j of y){let q=OL(a-j.x,h,w,R)+j.badness;q<=F&&(k=j,F=q)}return{index:u,x:a,priorBreak:k,badness:F}}function FL(u){return u?FL(u.priorBreak).concat(u.index):[]}function YC(u,a,h,y,w,R,k){if(R!=="point")return[];if(!u)return[];let F=[],j=function(it,ct,ht,vt,Nt,Ut){let Kt=0;for(let Ht=0;Ht<it.length();Ht++){let Jt=it.getSection(Ht);Kt+=BL(it.getCharCode(Ht),Jt,vt,Nt,ct,Ut)}return Kt/Math.max(1,Math.ceil(Kt/ht))}(u,a,h,y,w,k),q=u.text.indexOf("\u200B")>=0,K=0;for(let it=0;it<u.length();it++){let ct=u.getSection(it),ht=u.getCharCode(it);if(UT[ht]||(K+=BL(ht,ct,y,w,a,k)),it<u.length()-1){let vt=!((et=ht)<11904||!(qe["Bopomofo Extended"](et)||qe.Bopomofo(et)||qe["CJK Compatibility Forms"](et)||qe["CJK Compatibility Ideographs"](et)||qe["CJK Compatibility"](et)||qe["CJK Radicals Supplement"](et)||qe["CJK Strokes"](et)||qe["CJK Symbols and Punctuation"](et)||qe["CJK Unified Ideographs Extension A"](et)||qe["CJK Unified Ideographs"](et)||qe["Enclosed CJK Letters and Months"](et)||qe["Halfwidth and Fullwidth Forms"](et)||qe.Hiragana(et)||qe["Ideographic Description Characters"](et)||qe["Kangxi Radicals"](et)||qe["Katakana Phonetic Extensions"](et)||qe.Katakana(et)||qe["Vertical Forms"](et)||qe["Yi Radicals"](et)||qe["Yi Syllables"](et)));(tct[ht]||vt||ct.imageName)&&F.push(NL(it+1,K,j,F,ect(ht,u.getCharCode(it+1),vt&&q),!1))}}var et;return FL(NL(u.length(),K,j,F,0,!0))}function XC(u){let a=.5,h=.5;switch(u){case"right":case"top-right":case"bottom-right":a=1;break;case"left":case"top-left":case"bottom-left":a=0}switch(u){case"bottom":case"bottom-right":case"bottom-left":h=1;break;case"top":case"top-right":case"top-left":h=0}return{horizontalAlign:a,verticalAlign:h}}function rct(u,a,h,y,w){if(!y&&!w)return;let R=u[h],k=(u[h].x+R.metrics.advance*R.scale)*y;for(let F=a;F<=h;F++)u[F].x-=k,u[F].y+=w}function ict(u,a,h){let{horizontalAlign:y,verticalAlign:w}=XC(h),R=a[0]-u.displaySize[0]*y,k=a[1]-u.displaySize[1]*w;return{image:u,top:k,bottom:k+u.displaySize[1],left:R,right:R+u.displaySize[0]}}function LL(u,a,h,y,w,R){let k=u.image,F;if(k.content){let Nt=k.content,Ut=k.pixelRatio||1;F=[Nt[0]/Ut,Nt[1]/Ut,k.displaySize[0]-Nt[2]/Ut,k.displaySize[1]-Nt[3]/Ut]}let j=a.left*R,q=a.right*R,K,et,it,ct;h==="width"||h==="both"?(ct=w[0]+j-y[3],et=w[0]+q+y[1]):(ct=w[0]+(j+q-k.displaySize[0])/2,et=ct+k.displaySize[0]);let ht=a.top*R,vt=a.bottom*R;return h==="height"||h==="both"?(K=w[1]+ht-y[0],it=w[1]+vt+y[2]):(K=w[1]+(ht+vt-k.displaySize[1])/2,it=K+k.displaySize[1]),{image:k,top:K,right:et,bottom:it,left:ct,collisionPadding:F}}let Sb=255,Bf=128,iA=Sb*Bf;function zL(u,a){let{expression:h}=a;if(h.kind==="constant")return{kind:"constant",layoutSize:h.evaluate(new Wn(u+1))};if(h.kind==="source")return{kind:"source"};{let{zoomStops:y,interpolationType:w}=h,R=0;for(;R<y.length&&y[R]<=u;)R++;R=Math.max(0,R-1);let k=R;for(;k<y.length&&y[k]<u+1;)k++;k=Math.min(y.length-1,k);let F=y[R],j=y[k];return h.kind==="composite"?{kind:"composite",minZoom:F,maxZoom:j,interpolationType:w}:{kind:"camera",minZoom:F,maxZoom:j,minSize:h.evaluate(new Wn(F)),maxSize:h.evaluate(new Wn(j)),interpolationType:w}}}function ZC(u,a,h){let y="never",w=u.get(a);return w?y=w:u.get(h)&&(y="always"),y}let nct=eA.VectorTileFeature.types,sct=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function VT(u,a,h,y,w,R,k,F,j,q,K,et,it){let ct=F?Math.min(iA,Math.round(F[0])):0,ht=F?Math.min(iA,Math.round(F[1])):0;u.emplaceBack(a,h,Math.round(32*y),Math.round(32*w),R,k,(ct<<1)+(j?1:0),ht,16*q,16*K,256*et,256*it)}function GC(u,a,h){u.emplaceBack(a.x,a.y,h),u.emplaceBack(a.x,a.y,h),u.emplaceBack(a.x,a.y,h),u.emplaceBack(a.x,a.y,h)}function oct(u){for(let a of u.sections)if(H_(a.text))return!0;return!1}class QC{constructor(a){this.layoutVertexArray=new Mi,this.indexArray=new go,this.programConfigurations=a,this.segments=new zn,this.dynamicLayoutVertexArray=new ui,this.opacityVertexArray=new Di,this.hasVisibleVertices=!1,this.placedSymbolArray=new Zt}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(a,h,y,w){this.isEmpty()||(y&&(this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,Flt.members),this.indexBuffer=a.createIndexBuffer(this.indexArray,h),this.dynamicLayoutVertexBuffer=a.createVertexBuffer(this.dynamicLayoutVertexArray,Llt.members,!0),this.opacityVertexBuffer=a.createVertexBuffer(this.opacityVertexArray,sct,!0),this.opacityVertexBuffer.itemSize=1),(y||w)&&this.programConfigurations.upload(a))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Ve("SymbolBuffers",QC);class KC{constructor(a,h,y){this.layoutVertexArray=new a,this.layoutAttributes=h,this.indexArray=new y,this.segments=new zn,this.collisionVertexArray=new Ln}upload(a){this.layoutVertexBuffer=a.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=a.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=a.createVertexBuffer(this.collisionVertexArray,zlt.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Ve("CollisionBuffers",KC);class ny{constructor(a){this.collisionBoxArray=a.collisionBoxArray,this.zoom=a.zoom,this.overscaling=a.overscaling,this.layers=a.layers,this.layerIds=this.layers.map(k=>k.id),this.index=a.index,this.pixelRatio=a.pixelRatio,this.sourceLayerIndex=a.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=De([]),this.placementViewportMatrix=De([]);let h=this.layers[0]._unevaluatedLayout._values;this.textSizeData=zL(this.zoom,h["text-size"]),this.iconSizeData=zL(this.zoom,h["icon-size"]);let y=this.layers[0].layout,w=y.get("symbol-sort-key"),R=y.get("symbol-z-order");this.canOverlap=ZC(y,"text-overlap","text-allow-overlap")!=="never"||ZC(y,"icon-overlap","icon-allow-overlap")!=="never"||y.get("text-ignore-placement")||y.get("icon-ignore-placement"),this.sortFeaturesByKey=R!=="viewport-y"&&!w.isConstant(),this.sortFeaturesByY=(R==="viewport-y"||R==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,y.get("symbol-placement")==="point"&&(this.writingModes=y.get("text-writing-mode").map(k=>n.ai[k])),this.stateDependentLayerIds=this.layers.filter(k=>k.isStateDependent()).map(k=>k.id),this.sourceID=a.sourceID}createArrays(){this.text=new QC(new jc(this.layers,this.zoom,a=>/^text/.test(a))),this.icon=new QC(new jc(this.layers,this.zoom,a=>/^icon/.test(a))),this.glyphOffsetArray=new Gt,this.lineVertexArray=new he,this.symbolInstances=new Ot,this.textAnchorOffsets=new xe}calculateGlyphDependencies(a,h,y,w,R){for(let k=0;k<a.length;k++)if(h[a.charCodeAt(k)]=!0,(y||w)&&R){let F=vb[a.charAt(k)];F&&(h[F.charCodeAt(0)]=!0)}}populate(a,h,y){let w=this.layers[0],R=w.layout,k=R.get("text-font"),F=R.get("text-field"),j=R.get("icon-image"),q=(F.value.kind!=="constant"||F.value.value instanceof $n&&!F.value.value.isEmpty()||F.value.value.toString().length>0)&&(k.value.kind!=="constant"||k.value.value.length>0),K=j.value.kind!=="constant"||!!j.value.value||Object.keys(j.parameters).length>0,et=R.get("symbol-sort-key");if(this.features=[],!q&&!K)return;let it=h.iconDependencies,ct=h.glyphDependencies,ht=h.availableImages,vt=new Wn(this.zoom);for(let{feature:Nt,id:Ut,index:Kt,sourceLayerIndex:Ht}of a){let Jt=w._featureFilter.needGeometry,le=Rf(Nt,Jt);if(!w._featureFilter.filter(vt,le,y))continue;let ve,Ke;if(Jt||(le.geometry=Pf(Nt)),q){let Qe=w.getValueAndResolveTokens("text-field",le,y,ht),Ye=$n.factory(Qe);oct(Ye)&&(this.hasRTLText=!0),(!this.hasRTLText||Km()==="unavailable"||this.hasRTLText&&Sa.isParsed())&&(ve=Vlt(Ye,w,le))}if(K){let Qe=w.getValueAndResolveTokens("icon-image",le,y,ht);Ke=Qe instanceof Ms?Qe:Ms.fromString(Qe)}if(!ve&&!Ke)continue;let dr=this.sortFeaturesByKey?et.evaluate(le,{},y):void 0;if(this.features.push({id:Ut,text:ve,icon:Ke,index:Kt,sourceLayerIndex:Ht,geometry:le.geometry,properties:Nt.properties,type:nct[Nt.type],sortKey:dr}),Ke&&(it[Ke.name]=!0),ve){let Qe=k.evaluate(le,{},y).join(","),Ye=R.get("text-rotation-alignment")!=="viewport"&&R.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(n.ai.vertical)>=0;for(let je of ve.sections)if(je.image)it[je.image.name]=!0;else{let sr=Xm(ve.toString()),He=je.fontStack||Qe,Re=ct[He]=ct[He]||{};this.calculateGlyphDependencies(je.text,Re,Ye,this.allowVerticalPlacement,sr)}}}R.get("symbol-placement")==="line"&&(this.features=function(Nt){let Ut={},Kt={},Ht=[],Jt=0;function le(Qe){Ht.push(Nt[Qe]),Jt++}function ve(Qe,Ye,je){let sr=Kt[Qe];return delete Kt[Qe],Kt[Ye]=sr,Ht[sr].geometry[0].pop(),Ht[sr].geometry[0]=Ht[sr].geometry[0].concat(je[0]),sr}function Ke(Qe,Ye,je){let sr=Ut[Ye];return delete Ut[Ye],Ut[Qe]=sr,Ht[sr].geometry[0].shift(),Ht[sr].geometry[0]=je[0].concat(Ht[sr].geometry[0]),sr}function dr(Qe,Ye,je){let sr=je?Ye[0][Ye[0].length-1]:Ye[0][0];return`${Qe}:${sr.x}:${sr.y}`}for(let Qe=0;Qe<Nt.length;Qe++){let Ye=Nt[Qe],je=Ye.geometry,sr=Ye.text?Ye.text.toString():null;if(!sr){le(Qe);continue}let He=dr(sr,je),Re=dr(sr,je,!0);if(He in Kt&&Re in Ut&&Kt[He]!==Ut[Re]){let Mr=Ke(He,Re,je),mr=ve(He,Re,Ht[Mr].geometry);delete Ut[He],delete Kt[Re],Kt[dr(sr,Ht[mr].geometry,!0)]=mr,Ht[Mr].geometry=null}else He in Kt?ve(He,Re,je):Re in Ut?Ke(He,Re,je):(le(Qe),Ut[He]=Jt-1,Kt[Re]=Jt-1)}return Ht.filter(Qe=>Qe.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Nt,Ut)=>Nt.sortKey-Ut.sortKey)}update(a,h,y){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(a,h,this.layers,y),this.icon.programConfigurations.updatePaintArrays(a,h,this.layers,y))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(a){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(a),this.iconCollisionBox.upload(a)),this.text.upload(a,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(a,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(a,h){let y=this.lineVertexArray.length;if(a.segment!==void 0){let w=a.dist(h[a.segment+1]),R=a.dist(h[a.segment]),k={};for(let F=a.segment+1;F<h.length;F++)k[F]={x:h[F].x,y:h[F].y,tileUnitDistanceFromAnchor:w},F<h.length-1&&(w+=h[F+1].dist(h[F]));for(let F=a.segment||0;F>=0;F--)k[F]={x:h[F].x,y:h[F].y,tileUnitDistanceFromAnchor:R},F>0&&(R+=h[F-1].dist(h[F]));for(let F=0;F<h.length;F++){let j=k[F];this.lineVertexArray.emplaceBack(j.x,j.y,j.tileUnitDistanceFromAnchor)}}return{lineStartIndex:y,lineLength:this.lineVertexArray.length-y}}addSymbols(a,h,y,w,R,k,F,j,q,K,et,it){let ct=a.indexArray,ht=a.layoutVertexArray,vt=a.segments.prepareSegment(4*h.length,ht,ct,this.canOverlap?k.sortKey:void 0),Nt=this.glyphOffsetArray.length,Ut=vt.vertexLength,Kt=this.allowVerticalPlacement&&F===n.ai.vertical?Math.PI/2:0,Ht=k.text&&k.text.sections;for(let Jt=0;Jt<h.length;Jt++){let{tl:le,tr:ve,bl:Ke,br:dr,tex:Qe,pixelOffsetTL:Ye,pixelOffsetBR:je,minFontScaleX:sr,minFontScaleY:He,glyphOffset:Re,isSDF:Mr,sectionIndex:mr}=h[Jt],Bi=vt.vertexLength,ns=Re[1];VT(ht,j.x,j.y,le.x,ns+le.y,Qe.x,Qe.y,y,Mr,Ye.x,Ye.y,sr,He),VT(ht,j.x,j.y,ve.x,ns+ve.y,Qe.x+Qe.w,Qe.y,y,Mr,je.x,Ye.y,sr,He),VT(ht,j.x,j.y,Ke.x,ns+Ke.y,Qe.x,Qe.y+Qe.h,y,Mr,Ye.x,je.y,sr,He),VT(ht,j.x,j.y,dr.x,ns+dr.y,Qe.x+Qe.w,Qe.y+Qe.h,y,Mr,je.x,je.y,sr,He),GC(a.dynamicLayoutVertexArray,j,Kt),ct.emplaceBack(Bi,Bi+1,Bi+2),ct.emplaceBack(Bi+1,Bi+2,Bi+3),vt.vertexLength+=4,vt.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Re[0]),Jt!==h.length-1&&mr===h[Jt+1].sectionIndex||a.programConfigurations.populatePaintArrays(ht.length,k,k.index,{},it,Ht&&Ht[mr])}a.placedSymbolArray.emplaceBack(j.x,j.y,Nt,this.glyphOffsetArray.length-Nt,Ut,q,K,j.segment,y?y[0]:0,y?y[1]:0,w[0],w[1],F,0,!1,0,et)}_addCollisionDebugVertex(a,h,y,w,R,k){return h.emplaceBack(0,0),a.emplaceBack(y.x,y.y,w,R,Math.round(k.x),Math.round(k.y))}addCollisionDebugVertices(a,h,y,w,R,k,F){let j=R.segments.prepareSegment(4,R.layoutVertexArray,R.indexArray),q=j.vertexLength,K=R.layoutVertexArray,et=R.collisionVertexArray,it=F.anchorX,ct=F.anchorY;this._addCollisionDebugVertex(K,et,k,it,ct,new x(a,h)),this._addCollisionDebugVertex(K,et,k,it,ct,new x(y,h)),this._addCollisionDebugVertex(K,et,k,it,ct,new x(y,w)),this._addCollisionDebugVertex(K,et,k,it,ct,new x(a,w)),j.vertexLength+=4;let ht=R.indexArray;ht.emplaceBack(q,q+1),ht.emplaceBack(q+1,q+2),ht.emplaceBack(q+2,q+3),ht.emplaceBack(q+3,q),j.primitiveLength+=4}addDebugCollisionBoxes(a,h,y,w){for(let R=a;R<h;R++){let k=this.collisionBoxArray.get(R);this.addCollisionDebugVertices(k.x1,k.y1,k.x2,k.y2,w?this.textCollisionBox:this.iconCollisionBox,k.anchorPoint,y)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new KC(bs,wL.members,qs),this.iconCollisionBox=new KC(bs,wL.members,qs);for(let a=0;a<this.symbolInstances.length;a++){let h=this.symbolInstances.get(a);this.addDebugCollisionBoxes(h.textBoxStartIndex,h.textBoxEndIndex,h,!0),this.addDebugCollisionBoxes(h.verticalTextBoxStartIndex,h.verticalTextBoxEndIndex,h,!0),this.addDebugCollisionBoxes(h.iconBoxStartIndex,h.iconBoxEndIndex,h,!1),this.addDebugCollisionBoxes(h.verticalIconBoxStartIndex,h.verticalIconBoxEndIndex,h,!1)}}_deserializeCollisionBoxesForSymbol(a,h,y,w,R,k,F,j,q){let K={};for(let et=h;et<y;et++){let it=a.get(et);K.textBox={x1:it.x1,y1:it.y1,x2:it.x2,y2:it.y2,anchorPointX:it.anchorPointX,anchorPointY:it.anchorPointY},K.textFeatureIndex=it.featureIndex;break}for(let et=w;et<R;et++){let it=a.get(et);K.verticalTextBox={x1:it.x1,y1:it.y1,x2:it.x2,y2:it.y2,anchorPointX:it.anchorPointX,anchorPointY:it.anchorPointY},K.verticalTextFeatureIndex=it.featureIndex;break}for(let et=k;et<F;et++){let it=a.get(et);K.iconBox={x1:it.x1,y1:it.y1,x2:it.x2,y2:it.y2,anchorPointX:it.anchorPointX,anchorPointY:it.anchorPointY},K.iconFeatureIndex=it.featureIndex;break}for(let et=j;et<q;et++){let it=a.get(et);K.verticalIconBox={x1:it.x1,y1:it.y1,x2:it.x2,y2:it.y2,anchorPointX:it.anchorPointX,anchorPointY:it.anchorPointY},K.verticalIconFeatureIndex=it.featureIndex;break}return K}deserializeCollisionBoxes(a){this.collisionArrays=[];for(let h=0;h<this.symbolInstances.length;h++){let y=this.symbolInstances.get(h);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(a,y.textBoxStartIndex,y.textBoxEndIndex,y.verticalTextBoxStartIndex,y.verticalTextBoxEndIndex,y.iconBoxStartIndex,y.iconBoxEndIndex,y.verticalIconBoxStartIndex,y.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(a,h){let y=a.placedSymbolArray.get(h),w=y.vertexStartIndex+4*y.numGlyphs;for(let R=y.vertexStartIndex;R<w;R+=4)a.indexArray.emplaceBack(R,R+1,R+2),a.indexArray.emplaceBack(R+1,R+2,R+3)}getSortedSymbolIndexes(a){if(this.sortedAngle===a&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;let h=Math.sin(a),y=Math.cos(a),w=[],R=[],k=[];for(let F=0;F<this.symbolInstances.length;++F){k.push(F);let j=this.symbolInstances.get(F);w.push(0|Math.round(h*j.anchorX+y*j.anchorY)),R.push(j.featureIndex)}return k.sort((F,j)=>w[F]-w[j]||R[j]-R[F]),k}addToSortKeyRanges(a,h){let y=this.sortKeyRanges[this.sortKeyRanges.length-1];y&&y.sortKey===h?y.symbolInstanceEnd=a+1:this.sortKeyRanges.push({sortKey:h,symbolInstanceStart:a,symbolInstanceEnd:a+1})}sortFeatures(a){if(this.sortFeaturesByY&&this.sortedAngle!==a&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(a),this.sortedAngle=a,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(let h of this.symbolInstanceIndexes){let y=this.symbolInstances.get(h);this.featureSortOrder.push(y.featureIndex),[y.rightJustifiedTextSymbolIndex,y.centerJustifiedTextSymbolIndex,y.leftJustifiedTextSymbolIndex].forEach((w,R,k)=>{w>=0&&k.indexOf(w)===R&&this.addIndicesForPlacedSymbol(this.text,w)}),y.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,y.verticalPlacedTextSymbolIndex),y.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,y.placedIconSymbolIndex),y.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,y.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let UL,VL;Ve("SymbolBucket",ny,{omit:["layers","collisionBoxArray","features","compareText"]}),ny.MAX_GLYPHS=65535,ny.addDynamicAttributes=GC;var JC={get paint(){return VL=VL||new Ps({"icon-opacity":new Rr(ae.paint_symbol["icon-opacity"]),"icon-color":new Rr(ae.paint_symbol["icon-color"]),"icon-halo-color":new Rr(ae.paint_symbol["icon-halo-color"]),"icon-halo-width":new Rr(ae.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Rr(ae.paint_symbol["icon-halo-blur"]),"icon-translate":new cr(ae.paint_symbol["icon-translate"]),"icon-translate-anchor":new cr(ae.paint_symbol["icon-translate-anchor"]),"text-opacity":new Rr(ae.paint_symbol["text-opacity"]),"text-color":new Rr(ae.paint_symbol["text-color"],{runtimeType:Ao,getOverride:u=>u.textColor,hasOverride:u=>!!u.textColor}),"text-halo-color":new Rr(ae.paint_symbol["text-halo-color"]),"text-halo-width":new Rr(ae.paint_symbol["text-halo-width"]),"text-halo-blur":new Rr(ae.paint_symbol["text-halo-blur"]),"text-translate":new cr(ae.paint_symbol["text-translate"]),"text-translate-anchor":new cr(ae.paint_symbol["text-translate-anchor"])})},get layout(){return UL=UL||new Ps({"symbol-placement":new cr(ae.layout_symbol["symbol-placement"]),"symbol-spacing":new cr(ae.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new cr(ae.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Rr(ae.layout_symbol["symbol-sort-key"]),"symbol-z-order":new cr(ae.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new cr(ae.layout_symbol["icon-allow-overlap"]),"icon-overlap":new cr(ae.layout_symbol["icon-overlap"]),"icon-ignore-placement":new cr(ae.layout_symbol["icon-ignore-placement"]),"icon-optional":new cr(ae.layout_symbol["icon-optional"]),"icon-rotation-alignment":new cr(ae.layout_symbol["icon-rotation-alignment"]),"icon-size":new Rr(ae.layout_symbol["icon-size"]),"icon-text-fit":new cr(ae.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new cr(ae.layout_symbol["icon-text-fit-padding"]),"icon-image":new Rr(ae.layout_symbol["icon-image"]),"icon-rotate":new Rr(ae.layout_symbol["icon-rotate"]),"icon-padding":new Rr(ae.layout_symbol["icon-padding"]),"icon-keep-upright":new cr(ae.layout_symbol["icon-keep-upright"]),"icon-offset":new Rr(ae.layout_symbol["icon-offset"]),"icon-anchor":new Rr(ae.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new cr(ae.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new cr(ae.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new cr(ae.layout_symbol["text-rotation-alignment"]),"text-field":new Rr(ae.layout_symbol["text-field"]),"text-font":new Rr(ae.layout_symbol["text-font"]),"text-size":new Rr(ae.layout_symbol["text-size"]),"text-max-width":new Rr(ae.layout_symbol["text-max-width"]),"text-line-height":new cr(ae.layout_symbol["text-line-height"]),"text-letter-spacing":new Rr(ae.layout_symbol["text-letter-spacing"]),"text-justify":new Rr(ae.layout_symbol["text-justify"]),"text-radial-offset":new Rr(ae.layout_symbol["text-radial-offset"]),"text-variable-anchor":new cr(ae.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Rr(ae.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Rr(ae.layout_symbol["text-anchor"]),"text-max-angle":new cr(ae.layout_symbol["text-max-angle"]),"text-writing-mode":new cr(ae.layout_symbol["text-writing-mode"]),"text-rotate":new Rr(ae.layout_symbol["text-rotate"]),"text-padding":new cr(ae.layout_symbol["text-padding"]),"text-keep-upright":new cr(ae.layout_symbol["text-keep-upright"]),"text-transform":new Rr(ae.layout_symbol["text-transform"]),"text-offset":new Rr(ae.layout_symbol["text-offset"]),"text-allow-overlap":new cr(ae.layout_symbol["text-allow-overlap"]),"text-overlap":new cr(ae.layout_symbol["text-overlap"]),"text-ignore-placement":new cr(ae.layout_symbol["text-ignore-placement"]),"text-optional":new cr(ae.layout_symbol["text-optional"])})}};class jL{constructor(a){if(a.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=a.property.overrides?a.property.overrides.runtimeType:Za,this.defaultValue=a}evaluate(a){if(a.formattedSection){let h=this.defaultValue.property.overrides;if(h&&h.hasOverride(a.formattedSection))return h.getOverride(a.formattedSection)}return a.feature&&a.featureState?this.defaultValue.evaluate(a.feature,a.featureState):this.defaultValue.property.specification.default}eachChild(a){this.defaultValue.isConstant()||a(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Ve("FormatSectionOverride",jL,{omit:["defaultValue"]});class jT extends Ea{constructor(a){super(a,JC)}recalculate(a,h){if(super.recalculate(a,h),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){let y=this.layout.get("text-writing-mode");if(y){let w=[];for(let R of y)w.indexOf(R)<0&&w.push(R);this.layout._values["text-writing-mode"]=w}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(a,h,y,w){let R=this.layout.get(a).evaluate(h,{},y,w),k=this._unevaluatedLayout._values[a];return k.isDataDriven()||Au(k.value)||!R?R:function(F,j){return j.replace(/{([^{}]+)}/g,(q,K)=>F&&K in F?String(F[K]):"")}(h.properties,R)}createBucket(a){return new ny(a)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(let a of JC.paint.overridableProperties){if(!jT.hasPaintOverride(this.layout,a))continue;let h=this.paint.get(a),y=new jL(h),w=new cn(y,h.property.specification),R=null;R=h.value.kind==="constant"||h.value.kind==="source"?new $m("source",w):new bf("composite",w,h.value.zoomStops),this.paint._values[a]=new $o(h.property,R,h.parameters)}}_handleOverridablePaintPropertyUpdate(a,h,y){return!(!this.layout||h.isDataDriven()||y.isDataDriven())&&jT.hasPaintOverride(this.layout,a)}static hasPaintOverride(a,h){let y=a.get("text-field"),w=JC.paint.properties[h],R=!1,k=F=>{for(let j of F)if(w.overrides&&w.overrides.hasOverride(j))return void(R=!0)};if(y.value.kind==="constant"&&y.value.value instanceof $n)k(y.value.value.sections);else if(y.value.kind==="source"){let F=q=>{R||(q instanceof Ql&&Fn(q.value)===It?k(q.value.sections):q instanceof xf?k(q.sections):q.eachChild(F))},j=y.value;j._styleExpression&&F(j._styleExpression.expression)}return R}}let $L;var act={get paint(){return $L=$L||new Ps({"background-color":new cr(ae.paint_background["background-color"]),"background-pattern":new G0(ae.paint_background["background-pattern"]),"background-opacity":new cr(ae.paint_background["background-opacity"])})}};class lct extends Ea{constructor(a){super(a,act)}}let HL;var cct={get paint(){return HL=HL||new Ps({"raster-opacity":new cr(ae.paint_raster["raster-opacity"]),"raster-hue-rotate":new cr(ae.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new cr(ae.paint_raster["raster-brightness-min"]),"raster-brightness-max":new cr(ae.paint_raster["raster-brightness-max"]),"raster-saturation":new cr(ae.paint_raster["raster-saturation"]),"raster-contrast":new cr(ae.paint_raster["raster-contrast"]),"raster-resampling":new cr(ae.paint_raster["raster-resampling"]),"raster-fade-duration":new cr(ae.paint_raster["raster-fade-duration"])})}};class uct extends Ea{constructor(a){super(a,cct)}}class hct extends Ea{constructor(a){super(a,{}),this.onAdd=h=>{this.implementation.onAdd&&this.implementation.onAdd(h,h.painter.context.gl)},this.onRemove=h=>{this.implementation.onRemove&&this.implementation.onRemove(h,h.painter.context.gl)},this.implementation=a}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class fct{constructor(a){this._callback=a,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}let tP=63710088e-1;class nA{constructor(a,h){if(isNaN(a)||isNaN(h))throw new Error(`Invalid LngLat object: (${a}, ${h})`);if(this.lng=+a,this.lat=+h,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new nA(st(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(a){let h=Math.PI/180,y=this.lat*h,w=a.lat*h,R=Math.sin(y)*Math.sin(w)+Math.cos(y)*Math.cos(w)*Math.cos((a.lng-this.lng)*h);return tP*Math.acos(Math.min(R,1))}static convert(a){if(a instanceof nA)return a;if(Array.isArray(a)&&(a.length===2||a.length===3))return new nA(Number(a[0]),Number(a[1]));if(!Array.isArray(a)&&typeof a=="object"&&a!==null)return new nA(Number("lng"in a?a.lng:a.lon),Number(a.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}let WL=2*Math.PI*tP;function qL(u){return WL*Math.cos(u*Math.PI/180)}function YL(u){return(180+u)/360}function XL(u){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+u*Math.PI/360)))/360}function ZL(u,a){return u/qL(a)}function GL(u){return 360*u-180}function eP(u){return 360/Math.PI*Math.atan(Math.exp((180-360*u)*Math.PI/180))-90}class $T{constructor(a,h,y=0){this.x=+a,this.y=+h,this.z=+y}static fromLngLat(a,h=0){let y=nA.convert(a);return new $T(YL(y.lng),XL(y.lat),ZL(h,y.lat))}toLngLat(){return new nA(GL(this.x),eP(this.y))}toAltitude(){return this.z*qL(eP(this.y))}meterInMercatorCoordinateUnits(){return 1/WL*(a=eP(this.y),1/Math.cos(a*Math.PI/180));var a}}function QL(u,a,h){var y=2*Math.PI*6378137/256/Math.pow(2,h);return[u*y-2*Math.PI*6378137/2,a*y-2*Math.PI*6378137/2]}class rP{constructor(a,h,y){if(a<0||a>25||y<0||y>=Math.pow(2,a)||h<0||h>=Math.pow(2,a))throw new Error(`x=${h}, y=${y}, z=${a} outside of bounds. 0<=x<${Math.pow(2,a)}, 0<=y<${Math.pow(2,a)} 0<=z<=25 `);this.z=a,this.x=h,this.y=y,this.key=Eb(0,a,a,h,y)}equals(a){return this.z===a.z&&this.x===a.x&&this.y===a.y}url(a,h,y){let w=(k=this.y,F=this.z,j=QL(256*(R=this.x),256*(k=Math.pow(2,F)-k-1),F),q=QL(256*(R+1),256*(k+1),F),j[0]+","+j[1]+","+q[0]+","+q[1]);var R,k,F,j,q;let K=function(et,it,ct){let ht,vt="";for(let Nt=et;Nt>0;Nt--)ht=1<<Nt-1,vt+=(it&ht?1:0)+(ct&ht?2:0);return vt}(this.z,this.x,this.y);return a[(this.x+this.y)%a.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(y==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,h>1?"@2x":"").replace(/{quadkey}/g,K).replace(/{bbox-epsg-3857}/g,w)}isChildOf(a){let h=this.z-a.z;return h>0&&a.x===this.x>>h&&a.y===this.y>>h}getTilePoint(a){let h=Math.pow(2,this.z);return new x((a.x*h-this.x)*Fs,(a.y*h-this.y)*Fs)}toString(){return`${this.z}/${this.x}/${this.y}`}}class KL{constructor(a,h){this.wrap=a,this.canonical=h,this.key=Eb(a,h.z,h.z,h.x,h.y)}}class Hc{constructor(a,h,y,w,R){if(a<y)throw new Error(`overscaledZ should be >= z; overscaledZ = ${a}; z = ${y}`);this.overscaledZ=a,this.wrap=h,this.canonical=new rP(y,+w,+R),this.key=Eb(h,a,y,w,R)}clone(){return new Hc(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(a){return this.overscaledZ===a.overscaledZ&&this.wrap===a.wrap&&this.canonical.equals(a.canonical)}scaledTo(a){if(a>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${a}; overscaledZ = ${this.overscaledZ}`);let h=this.canonical.z-a;return a>this.canonical.z?new Hc(a,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Hc(a,this.wrap,a,this.canonical.x>>h,this.canonical.y>>h)}calculateScaledKey(a,h){if(a>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${a}; overscaledZ = ${this.overscaledZ}`);let y=this.canonical.z-a;return a>this.canonical.z?Eb(this.wrap*+h,a,this.canonical.z,this.canonical.x,this.canonical.y):Eb(this.wrap*+h,a,a,this.canonical.x>>y,this.canonical.y>>y)}isChildOf(a){if(a.wrap!==this.wrap)return!1;let h=this.canonical.z-a.canonical.z;return a.overscaledZ===0||a.overscaledZ<this.overscaledZ&&a.canonical.x===this.canonical.x>>h&&a.canonical.y===this.canonical.y>>h}children(a){if(this.overscaledZ>=a)return[new Hc(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];let h=this.canonical.z+1,y=2*this.canonical.x,w=2*this.canonical.y;return[new Hc(h,this.wrap,h,y,w),new Hc(h,this.wrap,h,y+1,w),new Hc(h,this.wrap,h,y,w+1),new Hc(h,this.wrap,h,y+1,w+1)]}isLessThan(a){return this.wrap<a.wrap||!(this.wrap>a.wrap)&&(this.overscaledZ<a.overscaledZ||!(this.overscaledZ>a.overscaledZ)&&(this.canonical.x<a.canonical.x||!(this.canonical.x>a.canonical.x)&&this.canonical.y<a.canonical.y))}wrapped(){return new Hc(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(a){return new Hc(this.overscaledZ,a,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new KL(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(a){return this.canonical.getTilePoint(new $T(a.x-this.wrap,a.y))}}function Eb(u,a,h,y,w){(u*=2)<0&&(u=-1*u-1);let R=1<<h;return(R*R*u+R*w+y).toString(36)+h.toString(36)+a.toString(36)}Ve("CanonicalTileID",rP),Ve("OverscaledTileID",Hc,{omit:["posMatrix"]});class JL{constructor(a,h,y,w=1,R=1,k=1,F=0){if(this.uid=a,h.height!==h.width)throw new RangeError("DEM tiles must be square");if(y&&!["mapbox","terrarium","custom"].includes(y))return void oe(`"${y}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=h.height;let j=this.dim=h.height-2;switch(this.data=new Uint32Array(h.data.buffer),y){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=w,this.greenFactor=R,this.blueFactor=k,this.baseShift=F;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let q=0;q<j;q++)this.data[this._idx(-1,q)]=this.data[this._idx(0,q)],this.data[this._idx(j,q)]=this.data[this._idx(j-1,q)],this.data[this._idx(q,-1)]=this.data[this._idx(q,0)],this.data[this._idx(q,j)]=this.data[this._idx(q,j-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(j,-1)]=this.data[this._idx(j-1,0)],this.data[this._idx(-1,j)]=this.data[this._idx(0,j-1)],this.data[this._idx(j,j)]=this.data[this._idx(j-1,j-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let q=0;q<j;q++)for(let K=0;K<j;K++){let et=this.get(q,K);et>this.max&&(this.max=et),et<this.min&&(this.min=et)}}get(a,h){let y=new Uint8Array(this.data.buffer),w=4*this._idx(a,h);return this.unpack(y[w],y[w+1],y[w+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(a,h){if(a<-1||a>=this.dim+1||h<-1||h>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(h+1)*this.stride+(a+1)}unpack(a,h,y){return a*this.redFactor+h*this.greenFactor+y*this.blueFactor-this.baseShift}getPixels(){return new P({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(a,h,y){if(this.dim!==a.dim)throw new Error("dem dimension mismatch");let w=h*this.dim,R=h*this.dim+this.dim,k=y*this.dim,F=y*this.dim+this.dim;switch(h){case-1:w=R-1;break;case 1:R=w+1}switch(y){case-1:k=F-1;break;case 1:F=k+1}let j=-h*this.dim,q=-y*this.dim;for(let K=k;K<F;K++)for(let et=w;et<R;et++)this.data[this._idx(et,K)]=a.data[this._idx(et+j,K+q)]}}Ve("DEMData",JL);class tz{constructor(a){this._stringToNumber={},this._numberToString=[];for(let h=0;h<a.length;h++){let y=a[h];this._stringToNumber[y]=h,this._numberToString[h]=y}}encode(a){return this._stringToNumber[a]}decode(a){if(a>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${a} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[a]}}class ez{constructor(a,h,y,w,R){this.type="Feature",this._vectorTileFeature=a,a._z=h,a._x=y,a._y=w,this.properties=a.properties,this.id=R}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(a){this._geometry=a}toJSON(){let a={geometry:this.geometry};for(let h in this)h!=="_geometry"&&h!=="_vectorTileFeature"&&(a[h]=this[h]);return a}}class rz{constructor(a,h){this.tileID=a,this.x=a.canonical.x,this.y=a.canonical.y,this.z=a.canonical.z,this.grid=new Sf(Fs,16,0),this.grid3D=new Sf(Fs,16,0),this.featureIndexArray=new Te,this.promoteId=h}insert(a,h,y,w,R,k){let F=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(y,w,R);let j=k?this.grid3D:this.grid;for(let q=0;q<h.length;q++){let K=h[q],et=[1/0,1/0,-1/0,-1/0];for(let it=0;it<K.length;it++){let ct=K[it];et[0]=Math.min(et[0],ct.x),et[1]=Math.min(et[1],ct.y),et[2]=Math.max(et[2],ct.x),et[3]=Math.max(et[3],ct.y)}et[0]<Fs&&et[1]<Fs&&et[2]>=0&&et[3]>=0&&j.insert(F,et[0],et[1],et[2],et[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new eA.VectorTile(new HC(this.rawTileData)).layers,this.sourceLayerCoder=new tz(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(a,h,y,w){this.loadVTLayers();let R=a.params||{},k=Fs/a.tileSize/a.scale,F=Oc(R.filter),j=a.queryGeometry,q=a.queryPadding*k,K=nz(j),et=this.grid.query(K.minX-q,K.minY-q,K.maxX+q,K.maxY+q),it=nz(a.cameraQueryGeometry),ct=this.grid3D.query(it.minX-q,it.minY-q,it.maxX+q,it.maxY+q,(Nt,Ut,Kt,Ht)=>function(Jt,le,ve,Ke,dr){for(let Ye of Jt)if(le<=Ye.x&&ve<=Ye.y&&Ke>=Ye.x&&dr>=Ye.y)return!0;let Qe=[new x(le,ve),new x(le,dr),new x(Ke,dr),new x(Ke,ve)];if(Jt.length>2){for(let Ye of Qe)if(Ei(Jt,Ye))return!0}for(let Ye=0;Ye<Jt.length-1;Ye++)if(aa(Jt[Ye],Jt[Ye+1],Qe))return!0;return!1}(a.cameraQueryGeometry,Nt-q,Ut-q,Kt+q,Ht+q));for(let Nt of ct)et.push(Nt);et.sort(pct);let ht={},vt;for(let Nt=0;Nt<et.length;Nt++){let Ut=et[Nt];if(Ut===vt)continue;vt=Ut;let Kt=this.featureIndexArray.get(Ut),Ht=null;this.loadMatchingFeature(ht,Kt.bucketIndex,Kt.sourceLayerIndex,Kt.featureIndex,F,R.layers,R.availableImages,h,y,w,(Jt,le,ve)=>(Ht||(Ht=Pf(Jt)),le.queryIntersectsFeature(j,Jt,ve,Ht,this.z,a.transform,k,a.pixelPosMatrix)))}return ht}loadMatchingFeature(a,h,y,w,R,k,F,j,q,K,et){let it=this.bucketLayerIDs[h];if(k&&!function(Nt,Ut){for(let Kt=0;Kt<Nt.length;Kt++)if(Ut.indexOf(Nt[Kt])>=0)return!0;return!1}(k,it))return;let ct=this.sourceLayerCoder.decode(y),ht=this.vtLayers[ct].feature(w);if(R.needGeometry){let Nt=Rf(ht,!0);if(!R.filter(new Wn(this.tileID.overscaledZ),Nt,this.tileID.canonical))return}else if(!R.filter(new Wn(this.tileID.overscaledZ),ht))return;let vt=this.getId(ht,ct);for(let Nt=0;Nt<it.length;Nt++){let Ut=it[Nt];if(k&&k.indexOf(Ut)<0)continue;let Kt=j[Ut];if(!Kt)continue;let Ht={};vt&&K&&(Ht=K.getState(Kt.sourceLayer||"_geojsonTileLayer",vt));let Jt=at({},q[Ut]);Jt.paint=iz(Jt.paint,Kt.paint,ht,Ht,F),Jt.layout=iz(Jt.layout,Kt.layout,ht,Ht,F);let le=!et||et(ht,Kt,Ht);if(!le)continue;let ve=new ez(ht,this.z,this.x,this.y,vt);ve.layer=Jt;let Ke=a[Ut];Ke===void 0&&(Ke=a[Ut]=[]),Ke.push({featureIndex:w,feature:ve,intersectionZ:le})}}lookupSymbolFeatures(a,h,y,w,R,k,F,j){let q={};this.loadVTLayers();let K=Oc(R);for(let et of a)this.loadMatchingFeature(q,y,w,et,K,k,F,j,h);return q}hasLayer(a){for(let h of this.bucketLayerIDs)for(let y of h)if(a===y)return!0;return!1}getId(a,h){let y=a.id;return this.promoteId&&(y=a.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[h]],typeof y=="boolean"&&(y=Number(y))),y}}function iz(u,a,h,y,w){return Tt(u,(R,k)=>{let F=a instanceof Z0?a.get(k):null;return F&&F.evaluate?F.evaluate(h,y,w):F})}function nz(u){let a=1/0,h=1/0,y=-1/0,w=-1/0;for(let R of u)a=Math.min(a,R.x),h=Math.min(h,R.y),y=Math.max(y,R.x),w=Math.max(w,R.y);return{minX:a,minY:h,maxX:y,maxY:w}}function pct(u,a){return a-u}function sz(u,a,h,y,w){let R=[];for(let k=0;k<u.length;k++){let F=u[k],j;for(let q=0;q<F.length-1;q++){let K=F[q],et=F[q+1];K.x<a&&et.x<a||(K.x<a?K=new x(a,K.y+(a-K.x)/(et.x-K.x)*(et.y-K.y))._round():et.x<a&&(et=new x(a,K.y+(a-K.x)/(et.x-K.x)*(et.y-K.y))._round()),K.y<h&&et.y<h||(K.y<h?K=new x(K.x+(h-K.y)/(et.y-K.y)*(et.x-K.x),h)._round():et.y<h&&(et=new x(K.x+(h-K.y)/(et.y-K.y)*(et.x-K.x),h)._round()),K.x>=y&&et.x>=y||(K.x>=y?K=new x(y,K.y+(y-K.x)/(et.x-K.x)*(et.y-K.y))._round():et.x>=y&&(et=new x(y,K.y+(y-K.x)/(et.x-K.x)*(et.y-K.y))._round()),K.y>=w&&et.y>=w||(K.y>=w?K=new x(K.x+(w-K.y)/(et.y-K.y)*(et.x-K.x),w)._round():et.y>=w&&(et=new x(K.x+(w-K.y)/(et.y-K.y)*(et.x-K.x),w)._round()),j&&K.equals(j[j.length-1])||(j=[K],R.push(j)),j.push(et)))))}}return R}Ve("FeatureIndex",rz,{omit:["rawTileData","sourceLayerCoder"]});class sA extends x{constructor(a,h,y,w){super(a,h),this.angle=y,w!==void 0&&(this.segment=w)}clone(){return new sA(this.x,this.y,this.angle,this.segment)}}function oz(u,a,h,y,w){if(a.segment===void 0||h===0)return!0;let R=a,k=a.segment+1,F=0;for(;F>-h/2;){if(k--,k<0)return!1;F-=u[k].dist(R),R=u[k]}F+=u[k].dist(u[k+1]),k++;let j=[],q=0;for(;F<h/2;){let K=u[k],et=u[k+1];if(!et)return!1;let it=u[k-1].angleTo(K)-K.angleTo(et);for(it=Math.abs((it+3*Math.PI)%(2*Math.PI)-Math.PI),j.push({distance:F,angleDelta:it}),q+=it;F-j[0].distance>y;)q-=j.shift().angleDelta;if(q>w)return!1;k++,F+=K.dist(et)}return!0}function az(u){let a=0;for(let h=0;h<u.length-1;h++)a+=u[h].dist(u[h+1]);return a}function lz(u,a,h){return u?.6*a*h:0}function cz(u,a){return Math.max(u?u.right-u.left:0,a?a.right-a.left:0)}function dct(u,a,h,y,w,R){let k=lz(h,w,R),F=cz(h,y)*R,j=0,q=az(u)/2;for(let K=0;K<u.length-1;K++){let et=u[K],it=u[K+1],ct=et.dist(it);if(j+ct>q){let ht=(q-j)/ct,vt=Ja.number(et.x,it.x,ht),Nt=Ja.number(et.y,it.y,ht),Ut=new sA(vt,Nt,it.angleTo(et),K);return Ut._round(),!k||oz(u,Ut,F,k,a)?Ut:void 0}j+=ct}}function Act(u,a,h,y,w,R,k,F,j){let q=lz(y,R,k),K=cz(y,w),et=K*k,it=u[0].x===0||u[0].x===j||u[0].y===0||u[0].y===j;return a-et<a/4&&(a=et+a/4),uz(u,it?a/2*F%a:(K/2+2*R)*k*F%a,a,q,h,et,it,!1,j)}function uz(u,a,h,y,w,R,k,F,j){let q=R/2,K=az(u),et=0,it=a-h,ct=[];for(let ht=0;ht<u.length-1;ht++){let vt=u[ht],Nt=u[ht+1],Ut=vt.dist(Nt),Kt=Nt.angleTo(vt);for(;it+h<et+Ut;){it+=h;let Ht=(it-et)/Ut,Jt=Ja.number(vt.x,Nt.x,Ht),le=Ja.number(vt.y,Nt.y,Ht);if(Jt>=0&&Jt<j&&le>=0&&le<j&&it-q>=0&&it+q<=K){let ve=new sA(Jt,le,Kt,ht);ve._round(),y&&!oz(u,ve,R,y,w)||ct.push(ve)}}et+=Ut}return F||ct.length||k||(ct=uz(u,et/2,h,y,w,R,k,!0,j)),ct}Ve("Anchor",sA);let sy=Ml;function hz(u,a,h,y){let w=[],R=u.image,k=R.pixelRatio,F=R.paddedRect.w-2*sy,j=R.paddedRect.h-2*sy,q=u.right-u.left,K=u.bottom-u.top,et=R.stretchX||[[0,F]],it=R.stretchY||[[0,j]],ct=(je,sr)=>je+sr[1]-sr[0],ht=et.reduce(ct,0),vt=it.reduce(ct,0),Nt=F-ht,Ut=j-vt,Kt=0,Ht=ht,Jt=0,le=vt,ve=0,Ke=Nt,dr=0,Qe=Ut;if(R.content&&y){let je=R.content;Kt=HT(et,0,je[0]),Jt=HT(it,0,je[1]),Ht=HT(et,je[0],je[2]),le=HT(it,je[1],je[3]),ve=je[0]-Kt,dr=je[1]-Jt,Ke=je[2]-je[0]-Ht,Qe=je[3]-je[1]-le}let Ye=(je,sr,He,Re)=>{let Mr=WT(je.stretch-Kt,Ht,q,u.left),mr=qT(je.fixed-ve,Ke,je.stretch,ht),Bi=WT(sr.stretch-Jt,le,K,u.top),ns=qT(sr.fixed-dr,Qe,sr.stretch,vt),hs=WT(He.stretch-Kt,Ht,q,u.left),bo=qT(He.fixed-ve,Ke,He.stretch,ht),oc=WT(Re.stretch-Jt,le,K,u.top),el=qT(Re.fixed-dr,Qe,Re.stretch,vt),no=new x(Mr,Bi),Wo=new x(hs,Bi),ca=new x(hs,oc),rl=new x(Mr,oc),il=new x(mr/k,ns/k),vo=new x(bo/k,el/k),wo=a*Math.PI/180;if(wo){let Pa=Math.sin(wo),Cl=Math.cos(wo),Pl=[Cl,-Pa,Pa,Cl];no._matMult(Pl),Wo._matMult(Pl),rl._matMult(Pl),ca._matMult(Pl)}let Ca=je.stretch+je.fixed,nl=sr.stretch+sr.fixed;return{tl:no,tr:Wo,bl:rl,br:ca,tex:{x:R.paddedRect.x+sy+Ca,y:R.paddedRect.y+sy+nl,w:He.stretch+He.fixed-Ca,h:Re.stretch+Re.fixed-nl},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:il,pixelOffsetBR:vo,minFontScaleX:Ke/k/q,minFontScaleY:Qe/k/K,isSDF:h}};if(y&&(R.stretchX||R.stretchY)){let je=fz(et,Nt,ht),sr=fz(it,Ut,vt);for(let He=0;He<je.length-1;He++){let Re=je[He],Mr=je[He+1];for(let mr=0;mr<sr.length-1;mr++)w.push(Ye(Re,sr[mr],Mr,sr[mr+1]))}}else w.push(Ye({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:F+1},{fixed:0,stretch:j+1}));return w}function HT(u,a,h){let y=0;for(let w of u)y+=Math.max(a,Math.min(h,w[1]))-Math.max(a,Math.min(h,w[0]));return y}function fz(u,a,h){let y=[{fixed:-sy,stretch:0}];for(let[w,R]of u){let k=y[y.length-1];y.push({fixed:w-k.stretch,stretch:k.stretch}),y.push({fixed:w-k.stretch,stretch:k.stretch+(R-w)})}return y.push({fixed:a+sy,stretch:h}),y}function WT(u,a,h,y){return u/a*h+y}function qT(u,a,h,y){return u-a*h/y}class YT{constructor(a,h,y,w,R,k,F,j,q,K){if(this.boxStartIndex=a.length,q){let et=k.top,it=k.bottom,ct=k.collisionPadding;ct&&(et-=ct[1],it+=ct[3]);let ht=it-et;ht>0&&(ht=Math.max(10,ht),this.circleDiameter=ht)}else{let et=k.top*F-j[0],it=k.bottom*F+j[2],ct=k.left*F-j[3],ht=k.right*F+j[1],vt=k.collisionPadding;if(vt&&(ct-=vt[0]*F,et-=vt[1]*F,ht+=vt[2]*F,it+=vt[3]*F),K){let Nt=new x(ct,et),Ut=new x(ht,et),Kt=new x(ct,it),Ht=new x(ht,it),Jt=K*Math.PI/180;Nt._rotate(Jt),Ut._rotate(Jt),Kt._rotate(Jt),Ht._rotate(Jt),ct=Math.min(Nt.x,Ut.x,Kt.x,Ht.x),ht=Math.max(Nt.x,Ut.x,Kt.x,Ht.x),et=Math.min(Nt.y,Ut.y,Kt.y,Ht.y),it=Math.max(Nt.y,Ut.y,Kt.y,Ht.y)}a.emplaceBack(h.x,h.y,ct,et,ht,it,y,w,R)}this.boxEndIndex=a.length}}class mct{constructor(a=[],h=gct){if(this.data=a,this.length=this.data.length,this.compare=h,this.length>0)for(let y=(this.length>>1)-1;y>=0;y--)this._down(y)}push(a){this.data.push(a),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;let a=this.data[0],h=this.data.pop();return this.length--,this.length>0&&(this.data[0]=h,this._down(0)),a}peek(){return this.data[0]}_up(a){let{data:h,compare:y}=this,w=h[a];for(;a>0;){let R=a-1>>1,k=h[R];if(y(w,k)>=0)break;h[a]=k,a=R}h[a]=w}_down(a){let{data:h,compare:y}=this,w=this.length>>1,R=h[a];for(;a<w;){let k=1+(a<<1),F=h[k],j=k+1;if(j<this.length&&y(h[j],F)<0&&(k=j,F=h[j]),y(F,R)>=0)break;h[a]=F,a=k}h[a]=R}}function gct(u,a){return u<a?-1:u>a?1:0}function _ct(u,a=1,h=!1){let y=1/0,w=1/0,R=-1/0,k=-1/0,F=u[0];for(let ct=0;ct<F.length;ct++){let ht=F[ct];(!ct||ht.x<y)&&(y=ht.x),(!ct||ht.y<w)&&(w=ht.y),(!ct||ht.x>R)&&(R=ht.x),(!ct||ht.y>k)&&(k=ht.y)}let j=Math.min(R-y,k-w),q=j/2,K=new mct([],yct);if(j===0)return new x(y,w);for(let ct=y;ct<R;ct+=j)for(let ht=w;ht<k;ht+=j)K.push(new oy(ct+q,ht+q,q,u));let et=function(ct){let ht=0,vt=0,Nt=0,Ut=ct[0];for(let Kt=0,Ht=Ut.length,Jt=Ht-1;Kt<Ht;Jt=Kt++){let le=Ut[Kt],ve=Ut[Jt],Ke=le.x*ve.y-ve.x*le.y;vt+=(le.x+ve.x)*Ke,Nt+=(le.y+ve.y)*Ke,ht+=3*Ke}return new oy(vt/ht,Nt/ht,0,ct)}(u),it=K.length;for(;K.length;){let ct=K.pop();(ct.d>et.d||!et.d)&&(et=ct,h&&console.log("found best %d after %d probes",Math.round(1e4*ct.d)/1e4,it)),ct.max-et.d<=a||(q=ct.h/2,K.push(new oy(ct.p.x-q,ct.p.y-q,q,u)),K.push(new oy(ct.p.x+q,ct.p.y-q,q,u)),K.push(new oy(ct.p.x-q,ct.p.y+q,q,u)),K.push(new oy(ct.p.x+q,ct.p.y+q,q,u)),it+=4)}return h&&(console.log(`num probes: ${it}`),console.log(`best distance: ${et.d}`)),et.p}function yct(u,a){return a.max-u.max}function oy(u,a,h,y){this.p=new x(u,a),this.h=h,this.d=function(w,R){let k=!1,F=1/0;for(let j=0;j<R.length;j++){let q=R[j];for(let K=0,et=q.length,it=et-1;K<et;it=K++){let ct=q[K],ht=q[it];ct.y>w.y!=ht.y>w.y&&w.x<(ht.x-ct.x)*(w.y-ct.y)/(ht.y-ct.y)+ct.x&&(k=!k),F=Math.min(F,ni(w,ct,ht))}}return(k?1:-1)*Math.sqrt(F)}(this.p,y),this.max=this.d+this.h*Math.SQRT2}var la;n.aq=void 0,(la=n.aq||(n.aq={}))[la.center=1]="center",la[la.left=2]="left",la[la.right=3]="right",la[la.top=4]="top",la[la.bottom=5]="bottom",la[la["top-left"]=6]="top-left",la[la["top-right"]=7]="top-right",la[la["bottom-left"]=8]="bottom-left",la[la["bottom-right"]=9]="bottom-right";let oA=7,iP=Number.POSITIVE_INFINITY;function pz(u,a){return a[1]!==iP?function(h,y,w){let R=0,k=0;switch(y=Math.abs(y),w=Math.abs(w),h){case"top-right":case"top-left":case"top":k=w-oA;break;case"bottom-right":case"bottom-left":case"bottom":k=-w+oA}switch(h){case"top-right":case"bottom-right":case"right":R=-y;break;case"top-left":case"bottom-left":case"left":R=y}return[R,k]}(u,a[0],a[1]):function(h,y){let w=0,R=0;y<0&&(y=0);let k=y/Math.SQRT2;switch(h){case"top-right":case"top-left":R=k-oA;break;case"bottom-right":case"bottom-left":R=-k+oA;break;case"bottom":R=-y+oA;break;case"top":R=y-oA}switch(h){case"top-right":case"bottom-right":w=-k;break;case"top-left":case"bottom-left":w=k;break;case"left":w=y;break;case"right":w=-y}return[w,R]}(u,a[0])}function dz(u,a,h){var y;let w=u.layout,R=(y=w.get("text-variable-anchor-offset"))===null||y===void 0?void 0:y.evaluate(a,{},h);if(R){let F=R.values,j=[];for(let q=0;q<F.length;q+=2){let K=j[q]=F[q],et=F[q+1].map(it=>it*xo);K.startsWith("top")?et[1]-=oA:K.startsWith("bottom")&&(et[1]+=oA),j[q+1]=et}return new ea(j)}let k=w.get("text-variable-anchor");if(k){let F;F=u._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[w.get("text-radial-offset").evaluate(a,{},h)*xo,iP]:w.get("text-offset").evaluate(a,{},h).map(q=>q*xo);let j=[];for(let q of k)j.push(q,pz(q,F));return new ea(j)}return null}function nP(u){switch(u){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function xct(u,a,h,y,w,R,k,F,j,q,K){let et=R.textMaxSize.evaluate(a,{});et===void 0&&(et=k);let it=u.layers[0].layout,ct=it.get("icon-offset").evaluate(a,{},K),ht=mz(h.horizontal),vt=k/24,Nt=u.tilePixelRatio*vt,Ut=u.tilePixelRatio*et/24,Kt=u.tilePixelRatio*F,Ht=u.tilePixelRatio*it.get("symbol-spacing"),Jt=it.get("text-padding")*u.tilePixelRatio,le=function(Re,Mr,mr,Bi=1){let ns=Re.get("icon-padding").evaluate(Mr,{},mr),hs=ns&&ns.values;return[hs[0]*Bi,hs[1]*Bi,hs[2]*Bi,hs[3]*Bi]}(it,a,K,u.tilePixelRatio),ve=it.get("text-max-angle")/180*Math.PI,Ke=it.get("text-rotation-alignment")!=="viewport"&&it.get("symbol-placement")!=="point",dr=it.get("icon-rotation-alignment")==="map"&&it.get("symbol-placement")!=="point",Qe=it.get("symbol-placement"),Ye=Ht/2,je=it.get("icon-text-fit"),sr;y&&je!=="none"&&(u.allowVerticalPlacement&&h.vertical&&(sr=LL(y,h.vertical,je,it.get("icon-text-fit-padding"),ct,vt)),ht&&(y=LL(y,ht,je,it.get("icon-text-fit-padding"),ct,vt)));let He=(Re,Mr)=>{Mr.x<0||Mr.x>=Fs||Mr.y<0||Mr.y>=Fs||function(mr,Bi,ns,hs,bo,oc,el,no,Wo,ca,rl,il,vo,wo,Ca,nl,Pa,Cl,Pl,To,Xi,Ra,ua,So,Tu){let Ch=mr.addToLineVertexArray(Bi,ns),Ph,pd,Su,Wc,Rl=0,dd=0,Cb=0,xz=0,fP=-1,pP=-1,Ad={},bz=vu("");if(mr.allowVerticalPlacement&&hs.vertical){let ka=no.layout.get("text-rotate").evaluate(Xi,{},So)+90;Su=new YT(Wo,Bi,ca,rl,il,hs.vertical,vo,wo,Ca,ka),el&&(Wc=new YT(Wo,Bi,ca,rl,il,el,Pa,Cl,Ca,ka))}if(bo){let ka=no.layout.get("icon-rotate").evaluate(Xi,{}),qc=no.layout.get("icon-text-fit")!=="none",lg=hz(bo,ka,ua,qc),kh=el?hz(el,ka,ua,qc):void 0;pd=new YT(Wo,Bi,ca,rl,il,bo,Pa,Cl,!1,ka),Rl=4*lg.length;let cg=mr.iconSizeData,Of=null;cg.kind==="source"?(Of=[Bf*no.layout.get("icon-size").evaluate(Xi,{})],Of[0]>iA&&oe(`${mr.layerIds[0]}: Value for "icon-size" is >= ${Sb}. Reduce your "icon-size".`)):cg.kind==="composite"&&(Of=[Bf*Ra.compositeIconSizes[0].evaluate(Xi,{},So),Bf*Ra.compositeIconSizes[1].evaluate(Xi,{},So)],(Of[0]>iA||Of[1]>iA)&&oe(`${mr.layerIds[0]}: Value for "icon-size" is >= ${Sb}. Reduce your "icon-size".`)),mr.addSymbols(mr.icon,lg,Of,To,Pl,Xi,n.ai.none,Bi,Ch.lineStartIndex,Ch.lineLength,-1,So),fP=mr.icon.placedSymbolArray.length-1,kh&&(dd=4*kh.length,mr.addSymbols(mr.icon,kh,Of,To,Pl,Xi,n.ai.vertical,Bi,Ch.lineStartIndex,Ch.lineLength,-1,So),pP=mr.icon.placedSymbolArray.length-1)}let vz=Object.keys(hs.horizontal);for(let ka of vz){let qc=hs.horizontal[ka];if(!Ph){bz=vu(qc.text);let kh=no.layout.get("text-rotate").evaluate(Xi,{},So);Ph=new YT(Wo,Bi,ca,rl,il,qc,vo,wo,Ca,kh)}let lg=qc.positionedLines.length===1;if(Cb+=Az(mr,Bi,qc,oc,no,Ca,Xi,nl,Ch,hs.vertical?n.ai.horizontal:n.ai.horizontalOnly,lg?vz:[ka],Ad,fP,Ra,So),lg)break}hs.vertical&&(xz+=Az(mr,Bi,hs.vertical,oc,no,Ca,Xi,nl,Ch,n.ai.vertical,["vertical"],Ad,pP,Ra,So));let wct=Ph?Ph.boxStartIndex:mr.collisionBoxArray.length,Tct=Ph?Ph.boxEndIndex:mr.collisionBoxArray.length,Sct=Su?Su.boxStartIndex:mr.collisionBoxArray.length,Ect=Su?Su.boxEndIndex:mr.collisionBoxArray.length,Ict=pd?pd.boxStartIndex:mr.collisionBoxArray.length,Mct=pd?pd.boxEndIndex:mr.collisionBoxArray.length,Cct=Wc?Wc.boxStartIndex:mr.collisionBoxArray.length,Pct=Wc?Wc.boxEndIndex:mr.collisionBoxArray.length,Rh=-1,ZT=(ka,qc)=>ka&&ka.circleDiameter?Math.max(ka.circleDiameter,qc):qc;Rh=ZT(Ph,Rh),Rh=ZT(Su,Rh),Rh=ZT(pd,Rh),Rh=ZT(Wc,Rh);let wz=Rh>-1?1:0;wz&&(Rh*=Tu/xo),mr.glyphOffsetArray.length>=ny.MAX_GLYPHS&&oe("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Xi.sortKey!==void 0&&mr.addToSortKeyRanges(mr.symbolInstances.length,Xi.sortKey);let Rct=dz(no,Xi,So),[kct,Dct]=function(ka,qc){let lg=ka.length,kh=qc?.values;if(kh?.length>0)for(let cg=0;cg<kh.length;cg+=2){let Of=kh[cg+1];ka.emplaceBack(n.aq[kh[cg]],Of[0],Of[1])}return[lg,ka.length]}(mr.textAnchorOffsets,Rct);mr.symbolInstances.emplaceBack(Bi.x,Bi.y,Ad.right>=0?Ad.right:-1,Ad.center>=0?Ad.center:-1,Ad.left>=0?Ad.left:-1,Ad.vertical||-1,fP,pP,bz,wct,Tct,Sct,Ect,Ict,Mct,Cct,Pct,ca,Cb,xz,Rl,dd,wz,0,vo,Rh,kct,Dct)}(u,Mr,Re,h,y,w,sr,u.layers[0],u.collisionBoxArray,a.index,a.sourceLayerIndex,u.index,Nt,[Jt,Jt,Jt,Jt],Ke,j,Kt,le,dr,ct,a,R,q,K,k)};if(Qe==="line")for(let Re of sz(a.geometry,0,0,Fs,Fs)){let Mr=Act(Re,Ht,ve,h.vertical||ht,y,24,Ut,u.overscaling,Fs);for(let mr of Mr)ht&&bct(u,ht.text,Ye,mr)||He(Re,mr)}else if(Qe==="line-center"){for(let Re of a.geometry)if(Re.length>1){let Mr=dct(Re,ve,h.vertical||ht,y,24,Ut);Mr&&He(Re,Mr)}}else if(a.type==="Polygon")for(let Re of NC(a.geometry,0)){let Mr=_ct(Re,16);He(Re[0],new sA(Mr.x,Mr.y,0))}else if(a.type==="LineString")for(let Re of a.geometry)He(Re,new sA(Re[0].x,Re[0].y,0));else if(a.type==="Point")for(let Re of a.geometry)for(let Mr of Re)He([Mr],new sA(Mr.x,Mr.y,0))}function Az(u,a,h,y,w,R,k,F,j,q,K,et,it,ct,ht){let vt=function(Kt,Ht,Jt,le,ve,Ke,dr,Qe){let Ye=le.layout.get("text-rotate").evaluate(Ke,{})*Math.PI/180,je=[];for(let sr of Ht.positionedLines)for(let He of sr.positionedGlyphs){if(!He.rect)continue;let Re=He.rect||{},Mr=RL+1,mr=!0,Bi=1,ns=0,hs=(ve||Qe)&&He.vertical,bo=He.metrics.advance*He.scale/2;if(Qe&&Ht.verticalizable&&(ns=sr.lineOffset/2-(He.imageName?-(xo-He.metrics.width*He.scale)/2:(He.scale-1)*xo)),He.imageName){let To=dr[He.imageName];mr=To.sdf,Bi=To.pixelRatio,Mr=Ml/Bi}let oc=ve?[He.x+bo,He.y]:[0,0],el=ve?[0,0]:[He.x+bo+Jt[0],He.y+Jt[1]-ns],no=[0,0];hs&&(no=el,el=[0,0]);let Wo=He.metrics.isDoubleResolution?2:1,ca=(He.metrics.left-Mr)*He.scale-bo+el[0],rl=(-He.metrics.top-Mr)*He.scale+el[1],il=ca+Re.w/Wo*He.scale/Bi,vo=rl+Re.h/Wo*He.scale/Bi,wo=new x(ca,rl),Ca=new x(il,rl),nl=new x(ca,vo),Pa=new x(il,vo);if(hs){let To=new x(-bo,bo-wb),Xi=-Math.PI/2,Ra=xo/2-bo,ua=new x(5-wb-Ra,-(He.imageName?Ra:0)),So=new x(...no);wo._rotateAround(Xi,To)._add(ua)._add(So),Ca._rotateAround(Xi,To)._add(ua)._add(So),nl._rotateAround(Xi,To)._add(ua)._add(So),Pa._rotateAround(Xi,To)._add(ua)._add(So)}if(Ye){let To=Math.sin(Ye),Xi=Math.cos(Ye),Ra=[Xi,-To,To,Xi];wo._matMult(Ra),Ca._matMult(Ra),nl._matMult(Ra),Pa._matMult(Ra)}let Cl=new x(0,0),Pl=new x(0,0);je.push({tl:wo,tr:Ca,bl:nl,br:Pa,tex:Re,writingMode:Ht.writingMode,glyphOffset:oc,sectionIndex:He.sectionIndex,isSDF:mr,pixelOffsetTL:Cl,pixelOffsetBR:Pl,minFontScaleX:0,minFontScaleY:0})}return je}(0,h,F,w,R,k,y,u.allowVerticalPlacement),Nt=u.textSizeData,Ut=null;Nt.kind==="source"?(Ut=[Bf*w.layout.get("text-size").evaluate(k,{})],Ut[0]>iA&&oe(`${u.layerIds[0]}: Value for "text-size" is >= ${Sb}. Reduce your "text-size".`)):Nt.kind==="composite"&&(Ut=[Bf*ct.compositeTextSizes[0].evaluate(k,{},ht),Bf*ct.compositeTextSizes[1].evaluate(k,{},ht)],(Ut[0]>iA||Ut[1]>iA)&&oe(`${u.layerIds[0]}: Value for "text-size" is >= ${Sb}. Reduce your "text-size".`)),u.addSymbols(u.text,vt,Ut,F,R,k,q,a,j.lineStartIndex,j.lineLength,it,ht);for(let Kt of K)et[Kt]=u.text.placedSymbolArray.length-1;return 4*vt.length}function mz(u){for(let a in u)return u[a];return null}function bct(u,a,h,y){let w=u.compareText;if(a in w){let R=w[a];for(let k=R.length-1;k>=0;k--)if(y.dist(R[k])<h)return!0}else w[a]=[];return w[a].push(y),!1}let gz=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class sP{static from(a){if(!(a instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");let[h,y]=new Uint8Array(a,0,2);if(h!==219)throw new Error("Data does not appear to be in a KDBush format.");let w=y>>4;if(w!==1)throw new Error(`Got v${w} data when expected v1.`);let R=gz[15&y];if(!R)throw new Error("Unrecognized array type.");let[k]=new Uint16Array(a,2,1),[F]=new Uint32Array(a,4,1);return new sP(F,k,R,a)}constructor(a,h=64,y=Float64Array,w){if(isNaN(a)||a<0)throw new Error(`Unpexpected numItems value: ${a}.`);this.numItems=+a,this.nodeSize=Math.min(Math.max(+h,2),65535),this.ArrayType=y,this.IndexArrayType=a<65536?Uint16Array:Uint32Array;let R=gz.indexOf(this.ArrayType),k=2*a*this.ArrayType.BYTES_PER_ELEMENT,F=a*this.IndexArrayType.BYTES_PER_ELEMENT,j=(8-F%8)%8;if(R<0)throw new Error(`Unexpected typed array class: ${y}.`);w&&w instanceof ArrayBuffer?(this.data=w,this.ids=new this.IndexArrayType(this.data,8,a),this.coords=new this.ArrayType(this.data,8+F+j,2*a),this._pos=2*a,this._finished=!0):(this.data=new ArrayBuffer(8+k+F+j),this.ids=new this.IndexArrayType(this.data,8,a),this.coords=new this.ArrayType(this.data,8+F+j,2*a),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+R]),new Uint16Array(this.data,2,1)[0]=h,new Uint32Array(this.data,4,1)[0]=a)}add(a,h){let y=this._pos>>1;return this.ids[y]=y,this.coords[this._pos++]=a,this.coords[this._pos++]=h,y}finish(){let a=this._pos>>1;if(a!==this.numItems)throw new Error(`Added ${a} items when expected ${this.numItems}.`);return oP(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(a,h,y,w){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");let{ids:R,coords:k,nodeSize:F}=this,j=[0,R.length-1,0],q=[];for(;j.length;){let K=j.pop()||0,et=j.pop()||0,it=j.pop()||0;if(et-it<=F){for(let Nt=it;Nt<=et;Nt++){let Ut=k[2*Nt],Kt=k[2*Nt+1];Ut>=a&&Ut<=y&&Kt>=h&&Kt<=w&&q.push(R[Nt])}continue}let ct=it+et>>1,ht=k[2*ct],vt=k[2*ct+1];ht>=a&&ht<=y&&vt>=h&&vt<=w&&q.push(R[ct]),(K===0?a<=ht:h<=vt)&&(j.push(it),j.push(ct-1),j.push(1-K)),(K===0?y>=ht:w>=vt)&&(j.push(ct+1),j.push(et),j.push(1-K))}return q}within(a,h,y){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");let{ids:w,coords:R,nodeSize:k}=this,F=[0,w.length-1,0],j=[],q=y*y;for(;F.length;){let K=F.pop()||0,et=F.pop()||0,it=F.pop()||0;if(et-it<=k){for(let Nt=it;Nt<=et;Nt++)yz(R[2*Nt],R[2*Nt+1],a,h)<=q&&j.push(w[Nt]);continue}let ct=it+et>>1,ht=R[2*ct],vt=R[2*ct+1];yz(ht,vt,a,h)<=q&&j.push(w[ct]),(K===0?a-y<=ht:h-y<=vt)&&(F.push(it),F.push(ct-1),F.push(1-K)),(K===0?a+y>=ht:h+y>=vt)&&(F.push(ct+1),F.push(et),F.push(1-K))}return j}}function oP(u,a,h,y,w,R){if(w-y<=h)return;let k=y+w>>1;_z(u,a,k,y,w,R),oP(u,a,h,y,k-1,1-R),oP(u,a,h,k+1,w,1-R)}function _z(u,a,h,y,w,R){for(;w>y;){if(w-y>600){let q=w-y+1,K=h-y+1,et=Math.log(q),it=.5*Math.exp(2*et/3),ct=.5*Math.sqrt(et*it*(q-it)/q)*(K-q/2<0?-1:1);_z(u,a,h,Math.max(y,Math.floor(h-K*it/q+ct)),Math.min(w,Math.floor(h+(q-K)*it/q+ct)),R)}let k=a[2*h+R],F=y,j=w;for(Ib(u,a,y,h),a[2*w+R]>k&&Ib(u,a,y,w);F<j;){for(Ib(u,a,F,j),F++,j--;a[2*F+R]<k;)F++;for(;a[2*j+R]>k;)j--}a[2*y+R]===k?Ib(u,a,y,j):(j++,Ib(u,a,j,w)),j<=h&&(y=j+1),h<=j&&(w=j-1)}}function Ib(u,a,h,y){aP(u,h,y),aP(a,2*h,2*y),aP(a,2*h+1,2*y+1)}function aP(u,a,h){let y=u[a];u[a]=u[h],u[h]=y}function yz(u,a,h,y){let w=u-h,R=a-y;return w*w+R*R}var lP;n.bh=void 0,(lP=n.bh||(n.bh={})).create="create",lP.load="load",lP.fullLoad="fullLoad";let XT=null,Mb=[],cP=1e3/60,uP="loadTime",hP="fullLoadTime",vct={mark(u){performance.mark(u)},frame(u){let a=u;XT!=null&&Mb.push(a-XT),XT=a},clearMetrics(){XT=null,Mb=[],performance.clearMeasures(uP),performance.clearMeasures(hP);for(let u in n.bh)performance.clearMarks(n.bh[u])},getPerformanceMetrics(){performance.measure(uP,n.bh.create,n.bh.load),performance.measure(hP,n.bh.create,n.bh.fullLoad);let u=performance.getEntriesByName(uP)[0].duration,a=performance.getEntriesByName(hP)[0].duration,h=Mb.length,y=1/(Mb.reduce((R,k)=>R+k,0)/h/1e3),w=Mb.filter(R=>R>cP).reduce((R,k)=>R+(k-cP)/cP,0);return{loadTime:u,fullLoadTime:a,fps:y,percentDroppedFrames:w/(h+w)*100,totalFrames:h}}};n.$=function(u,a,h){var y,w,R,k,F,j,q,K,et,it,ct,ht,vt=h[0],Nt=h[1],Ut=h[2];return a===u?(u[12]=a[0]*vt+a[4]*Nt+a[8]*Ut+a[12],u[13]=a[1]*vt+a[5]*Nt+a[9]*Ut+a[13],u[14]=a[2]*vt+a[6]*Nt+a[10]*Ut+a[14],u[15]=a[3]*vt+a[7]*Nt+a[11]*Ut+a[15]):(w=a[1],R=a[2],k=a[3],F=a[4],j=a[5],q=a[6],K=a[7],et=a[8],it=a[9],ct=a[10],ht=a[11],u[0]=y=a[0],u[1]=w,u[2]=R,u[3]=k,u[4]=F,u[5]=j,u[6]=q,u[7]=K,u[8]=et,u[9]=it,u[10]=ct,u[11]=ht,u[12]=y*vt+F*Nt+et*Ut+a[12],u[13]=w*vt+j*Nt+it*Ut+a[13],u[14]=R*vt+q*Nt+ct*Ut+a[14],u[15]=k*vt+K*Nt+ht*Ut+a[15]),u},n.A=ud,n.B=Ja,n.C=class{constructor(u,a,h){this.receive=y=>{let w=y.data,R=w.id;if(R&&(!w.targetMapId||this.mapId===w.targetMapId))if(w.type==="<cancel>"){delete this.tasks[R];let k=this.cancelCallbacks[R];delete this.cancelCallbacks[R],k&&k()}else jt()||w.mustQueue?(this.tasks[R]=w,this.taskQueue.push(R),this.invoker.trigger()):this.processTask(R,w)},this.process=()=>{if(!this.taskQueue.length)return;let y=this.taskQueue.shift(),w=this.tasks[y];delete this.tasks[y],this.taskQueue.length&&this.invoker.trigger(),w&&this.processTask(y,w)},this.target=u,this.parent=a,this.mapId=h,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},this.invoker=new fct(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=jt()?u:window}send(u,a,h,y,w=!1){let R=Math.round(1e18*Math.random()).toString(36).substring(0,10);h&&(this.callbacks[R]=h);let k=[],F={id:R,type:u,hasCallback:!!h,targetMapId:y,mustQueue:w,sourceMapId:this.mapId,data:xs(a,k)};return this.target.postMessage(F,{transfer:k}),{cancel:()=>{h&&delete this.callbacks[R],this.target.postMessage({id:R,type:"<cancel>",targetMapId:y,sourceMapId:this.mapId})}}}processTask(u,a){if(a.type==="<response>"){let h=this.callbacks[u];delete this.callbacks[u],h&&(a.error?h(gu(a.error)):h(null,gu(a.data)))}else{let h=!1,y=[],w=a.hasCallback?(F,j)=>{h=!0,delete this.cancelCallbacks[u];let q={id:u,type:"<response>",sourceMapId:this.mapId,error:F?xs(F):null,data:xs(j,y)};this.target.postMessage(q,{transfer:y})}:F=>{h=!0},R=null,k=gu(a.data);if(this.parent[a.type])R=this.parent[a.type](a.sourceMapId,k,w);else if("getWorkerSource"in this.parent){let F=a.type.split(".");R=this.parent.getWorkerSource(a.sourceMapId,F[0],k.source)[F[1]](k,w)}else w(new Error(`Could not find function ${a.type}`));!h&&R&&R.cancel&&(this.cancelCallbacks[u]=R.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},n.D=cr,n.E=Sr,n.F=function(u,a){let h={};for(let y=0;y<a.length;y++){let w=a[y];w in u&&(h[w]=u[w])}return h},n.G=YL,n.H=XL,n.I=qC,n.J=U,n.K=H,n.L=nA,n.M=Se,n.N=Fs,n.O=Hc,n.P=x,n.Q=qn,n.R=P,n.S=zn,n.T=q_,n.U=$T,n.V=class extends Th{},n.W=rP,n.X=function(u,a){let h=window.document.createElement("video");h.muted=!0,h.onloadstart=function(){a(null,h)};for(let y=0;y<u.length;y++){let w=window.document.createElement("source");Ie(u[y])||(h.crossOrigin="Anonymous"),w.src=u[y],h.appendChild(w)}return{cancel:()=>{}}},n.Y=Ne,n.Z=function(){var u=new ud(16);return ud!=Float32Array&&(u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[11]=0,u[12]=0,u[13]=0,u[14]=0),u[0]=1,u[5]=1,u[10]=1,u[15]=1,u},n._=o,n.a=de,n.a$=class extends lt{},n.a0=function(u,a,h){var y=h[0],w=h[1],R=h[2];return u[0]=a[0]*y,u[1]=a[1]*y,u[2]=a[2]*y,u[3]=a[3]*y,u[4]=a[4]*w,u[5]=a[5]*w,u[6]=a[6]*w,u[7]=a[7]*w,u[8]=a[8]*R,u[9]=a[9]*R,u[10]=a[10]*R,u[11]=a[11]*R,u[12]=a[12],u[13]=a[13],u[14]=a[14],u[15]=a[15],u},n.a1=Ge,n.a2=function(){return Dt++},n.a3=Ct,n.a4=ny,n.a5=function(){Sa.isLoading()||Sa.isLoaded()||Km()!=="deferred"||W_()},n.a6=Oc,n.a7=Rf,n.a8=Wn,n.a9=ez,n.aA=od,n.aB=function(u){u=u.slice();let a=Object.create(null);for(let h=0;h<u.length;h++)a[u[h].id]=u[h];for(let h=0;h<u.length;h++)"ref"in u[h]&&(u[h]=on(u[h],a[u[h].ref]));return u},n.aC=function(u){if(u.type==="custom")return new hct(u);switch(u.type){case"background":return new lct(u);case"circle":return new J_(u);case"fill":return new plt(u);case"fill-extrusion":return new Mlt(u);case"heatmap":return new O(u);case"hillshade":return new nt(u);case"line":return new Nlt(u);case"raster":return new uct(u);case"symbol":return new jT(u)}},n.aD=Et,n.aE=function(u,a){if(!u)return[{command:$i.setStyle,args:[a]}];let h=[];try{if(!Qi(u.version,a.version))return[{command:$i.setStyle,args:[a]}];Qi(u.center,a.center)||h.push({command:$i.setCenter,args:[a.center]}),Qi(u.zoom,a.zoom)||h.push({command:$i.setZoom,args:[a.zoom]}),Qi(u.bearing,a.bearing)||h.push({command:$i.setBearing,args:[a.bearing]}),Qi(u.pitch,a.pitch)||h.push({command:$i.setPitch,args:[a.pitch]}),Qi(u.sprite,a.sprite)||h.push({command:$i.setSprite,args:[a.sprite]}),Qi(u.glyphs,a.glyphs)||h.push({command:$i.setGlyphs,args:[a.glyphs]}),Qi(u.transition,a.transition)||h.push({command:$i.setTransition,args:[a.transition]}),Qi(u.light,a.light)||h.push({command:$i.setLight,args:[a.light]});let y={},w=[];(function(k,F,j,q){let K;for(K in F=F||{},k=k||{})Object.prototype.hasOwnProperty.call(k,K)&&(Object.prototype.hasOwnProperty.call(F,K)||pu(K,j,q));for(K in F)Object.prototype.hasOwnProperty.call(F,K)&&(Object.prototype.hasOwnProperty.call(k,K)?Qi(k[K],F[K])||(k[K].type==="geojson"&&F[K].type==="geojson"&&Uo(k,F,K)?j.push({command:$i.setGeoJSONSourceData,args:[K,F[K].data]}):bl(K,F,j,q)):Ro(K,F,j))})(u.sources,a.sources,w,y);let R=[];u.layers&&u.layers.forEach(k=>{y[k.source]?h.push({command:$i.removeLayer,args:[k.id]}):R.push(k)}),h=h.concat(w),function(k,F,j){F=F||[];let q=(k=k||[]).map(Xa),K=F.map(Xa),et=k.reduce(Vo,{}),it=F.reduce(Vo,{}),ct=q.slice(),ht=Object.create(null),vt,Nt,Ut,Kt,Ht,Jt,le;for(vt=0,Nt=0;vt<q.length;vt++)Ut=q[vt],Object.prototype.hasOwnProperty.call(it,Ut)?Nt++:(j.push({command:$i.removeLayer,args:[Ut]}),ct.splice(ct.indexOf(Ut,Nt),1));for(vt=0,Nt=0;vt<K.length;vt++)Ut=K[K.length-1-vt],ct[ct.length-1-vt]!==Ut&&(Object.prototype.hasOwnProperty.call(et,Ut)?(j.push({command:$i.removeLayer,args:[Ut]}),ct.splice(ct.lastIndexOf(Ut,ct.length-Nt),1)):Nt++,Jt=ct[ct.length-vt],j.push({command:$i.addLayer,args:[it[Ut],Jt]}),ct.splice(ct.length-vt,0,Ut),ht[Ut]=!0);for(vt=0;vt<K.length;vt++)if(Ut=K[vt],Kt=et[Ut],Ht=it[Ut],!ht[Ut]&&!Qi(Kt,Ht))if(Qi(Kt.source,Ht.source)&&Qi(Kt["source-layer"],Ht["source-layer"])&&Qi(Kt.type,Ht.type)){for(le in vl(Kt.layout,Ht.layout,j,Ut,null,$i.setLayoutProperty),vl(Kt.paint,Ht.paint,j,Ut,null,$i.setPaintProperty),Qi(Kt.filter,Ht.filter)||j.push({command:$i.setFilter,args:[Ut,Ht.filter]}),Qi(Kt.minzoom,Ht.minzoom)&&Qi(Kt.maxzoom,Ht.maxzoom)||j.push({command:$i.setLayerZoomRange,args:[Ut,Ht.minzoom,Ht.maxzoom]}),Kt)Object.prototype.hasOwnProperty.call(Kt,le)&&le!=="layout"&&le!=="paint"&&le!=="filter"&&le!=="metadata"&&le!=="minzoom"&&le!=="maxzoom"&&(le.indexOf("paint.")===0?vl(Kt[le],Ht[le],j,Ut,le.slice(6),$i.setPaintProperty):Qi(Kt[le],Ht[le])||j.push({command:$i.setLayerProperty,args:[Ut,le,Ht[le]]}));for(le in Ht)Object.prototype.hasOwnProperty.call(Ht,le)&&!Object.prototype.hasOwnProperty.call(Kt,le)&&le!=="layout"&&le!=="paint"&&le!=="filter"&&le!=="metadata"&&le!=="minzoom"&&le!=="maxzoom"&&(le.indexOf("paint.")===0?vl(Kt[le],Ht[le],j,Ut,le.slice(6),$i.setPaintProperty):Qi(Kt[le],Ht[le])||j.push({command:$i.setLayerProperty,args:[Ut,le,Ht[le]]}))}else j.push({command:$i.removeLayer,args:[Ut]}),Jt=ct[ct.lastIndexOf(Ut)+1],j.push({command:$i.addLayer,args:[Ht,Jt]})}(R,a.layers,h)}catch(y){console.warn("Unable to compute style diff:",y),h=[{command:$i.setStyle,args:[a]}]}return h},n.aF=function(u){let a=[],h=u.id;return h===void 0&&a.push({message:`layers.${h}: missing required property "id"`}),u.render===void 0&&a.push({message:`layers.${h}: missing required method "render"`}),u.renderingMode&&u.renderingMode!=="2d"&&u.renderingMode!=="3d"&&a.push({message:`layers.${h}: property "renderingMode" must be either "2d" or "3d"`}),a},n.aG=function u(a,h){if(Array.isArray(a)){if(!Array.isArray(h)||a.length!==h.length)return!1;for(let y=0;y<a.length;y++)if(!u(a[y],h[y]))return!1;return!0}if(typeof a=="object"&&a!==null&&h!==null){if(typeof h!="object"||Object.keys(a).length!==Object.keys(h).length)return!1;for(let y in a)if(!u(a[y],h[y]))return!1;return!0}return a===h},n.aH=Tt,n.aI=kt,n.aJ=If,n.aK=function(u){return u({pluginStatus:jo,pluginURL:ic}),If.on("pluginStateChange",u),u},n.aL=class extends Eh{constructor(u,a){super(u,a),this.current=0}set(u){this.current!==u&&(this.current=u,this.gl.uniform1i(this.location,u))}},n.aM=Q0,n.aN=class extends Eh{constructor(u,a){super(u,a),this.current=fb}set(u){if(u[12]!==this.current[12]||u[0]!==this.current[0])return this.current=u,void this.gl.uniformMatrix4fv(this.location,!1,u);for(let a=1;a<16;a++)if(u[a]!==this.current[a]){this.current=u,this.gl.uniformMatrix4fv(this.location,!1,u);break}}},n.aO=Z_,n.aP=class extends Eh{constructor(u,a){super(u,a),this.current=[0,0,0]}set(u){u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]||(this.current=u,this.gl.uniform3f(this.location,u[0],u[1],u[2]))}},n.aQ=class extends Eh{constructor(u,a){super(u,a),this.current=[0,0]}set(u){u[0]===this.current[0]&&u[1]===this.current[1]||(this.current=u,this.gl.uniform2f(this.location,u[0],u[1]))}},n.aR=G_,n.aS=function(u,a,h,y,w,R,k){var F=1/(a-h),j=1/(y-w),q=1/(R-k);return u[0]=-2*F,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=-2*j,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=2*q,u[11]=0,u[12]=(a+h)*F,u[13]=(w+y)*j,u[14]=(k+R)*q,u[15]=1,u},n.aT=Hi,n.aU=Ab,n.aV=class extends v{},n.aW=Ult,n.aX=class extends C{},n.aY=function(u){return u<=1?1:Math.pow(2,Math.ceil(Math.log(u)/Math.LN2))},n.aZ=B,n.a_=Fe,n.aa=function(u){let a={};if(u.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(h,y,w,R)=>{let k=w||R;return a[y]=!k||k.toLowerCase(),""}),a["max-age"]){let h=parseInt(a["max-age"],10);isNaN(h)?delete a["max-age"]:a["max-age"]=h}return a},n.ab=function(u,a){let h=[];for(let y in u)y in a||h.push(y);return h},n.ac=function(u){if(Wt==null){let a=u.navigator?u.navigator.userAgent:null;Wt=!!u.safari||!(!a||!(/\b(iPad|iPhone|iPod)\b/.test(a)||a.match("Safari")&&!a.match("Chrome")))}return Wt},n.ad=Y,n.ae=function(u,a,h){var y=Math.sin(h),w=Math.cos(h),R=a[0],k=a[1],F=a[2],j=a[3],q=a[4],K=a[5],et=a[6],it=a[7];return a!==u&&(u[8]=a[8],u[9]=a[9],u[10]=a[10],u[11]=a[11],u[12]=a[12],u[13]=a[13],u[14]=a[14],u[15]=a[15]),u[0]=R*w+q*y,u[1]=k*w+K*y,u[2]=F*w+et*y,u[3]=j*w+it*y,u[4]=q*w-R*y,u[5]=K*w-k*y,u[6]=et*w-F*y,u[7]=it*w-j*y,u},n.af=function(u){var a=new ud(16);return a[0]=u[0],a[1]=u[1],a[2]=u[2],a[3]=u[3],a[4]=u[4],a[5]=u[5],a[6]=u[6],a[7]=u[7],a[8]=u[8],a[9]=u[9],a[10]=u[10],a[11]=u[11],a[12]=u[12],a[13]=u[13],a[14]=u[14],a[15]=u[15],a},n.ag=hd,n.ah=function(u,a){let h=0,y=0;if(u.kind==="constant")y=u.layoutSize;else if(u.kind!=="source"){let{interpolationType:w,minZoom:R,maxZoom:k}=u,F=w?Y(tl.interpolationFactor(w,a,R,k),0,1):0;u.kind==="camera"?y=Ja.number(u.minSize,u.maxSize,F):h=F}return{uSizeT:h,uSize:y}},n.aj=function(u,{uSize:a,uSizeT:h},{lowerSize:y,upperSize:w}){return u.kind==="source"?y/Bf:u.kind==="composite"?Ja.number(y/Bf,w/Bf,h):a},n.ak=GC,n.al=function(u,a,h,y){let w=a.y-u.y,R=a.x-u.x,k=y.y-h.y,F=y.x-h.x,j=k*R-F*w;if(j===0)return null;let q=(F*(u.y-h.y)-k*(u.x-h.x))/j;return new x(u.x+q*R,u.y+q*w)},n.am=sz,n.an=BT,n.ao=De,n.ap=xo,n.ar=ZC,n.as=function(u,a){var h=a[0],y=a[1],w=a[2],R=a[3],k=a[4],F=a[5],j=a[6],q=a[7],K=a[8],et=a[9],it=a[10],ct=a[11],ht=a[12],vt=a[13],Nt=a[14],Ut=a[15],Kt=h*F-y*k,Ht=h*j-w*k,Jt=h*q-R*k,le=y*j-w*F,ve=y*q-R*F,Ke=w*q-R*j,dr=K*vt-et*ht,Qe=K*Nt-it*ht,Ye=K*Ut-ct*ht,je=et*Nt-it*vt,sr=et*Ut-ct*vt,He=it*Ut-ct*Nt,Re=Kt*He-Ht*sr+Jt*je+le*Ye-ve*Qe+Ke*dr;return Re?(u[0]=(F*He-j*sr+q*je)*(Re=1/Re),u[1]=(w*sr-y*He-R*je)*Re,u[2]=(vt*Ke-Nt*ve+Ut*le)*Re,u[3]=(it*ve-et*Ke-ct*le)*Re,u[4]=(j*Ye-k*He-q*Qe)*Re,u[5]=(h*He-w*Ye+R*Qe)*Re,u[6]=(Nt*Jt-ht*Ke-Ut*Ht)*Re,u[7]=(K*Ke-it*Jt+ct*Ht)*Re,u[8]=(k*sr-F*Ye+q*dr)*Re,u[9]=(y*Ye-h*sr-R*dr)*Re,u[10]=(ht*ve-vt*Jt+Ut*Kt)*Re,u[11]=(et*Jt-K*ve-ct*Kt)*Re,u[12]=(F*Qe-k*je-j*dr)*Re,u[13]=(h*je-y*Qe+w*dr)*Re,u[14]=(vt*Ht-ht*le-Nt*Kt)*Re,u[15]=(K*le-et*Ht+it*Kt)*Re,u):null},n.at=nP,n.au=XC,n.av=sP,n.aw=function(){let u={},a=ae.$version;for(let h in ae.$root){let y=ae.$root[h];if(y.required){let w=null;w=h==="version"?a:y.type==="array"?[]:{},w!=null&&(u[h]=w)}}return u},n.ax=$i,n.ay=Ym,n.az=Fr,n.b=function(u,a){let h=new Blob([new Uint8Array(u)],{type:"image/png"});createImageBitmap(h).then(y=>{a(null,y)}).catch(y=>{a(new Error(`Could not load image because of ${y.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})},n.b0=go,n.b1=function(u,a){var h=u[0],y=u[1],w=u[2],R=u[3],k=u[4],F=u[5],j=u[6],q=u[7],K=u[8],et=u[9],it=u[10],ct=u[11],ht=u[12],vt=u[13],Nt=u[14],Ut=u[15],Kt=a[0],Ht=a[1],Jt=a[2],le=a[3],ve=a[4],Ke=a[5],dr=a[6],Qe=a[7],Ye=a[8],je=a[9],sr=a[10],He=a[11],Re=a[12],Mr=a[13],mr=a[14],Bi=a[15];return Math.abs(h-Kt)<=Xs*Math.max(1,Math.abs(h),Math.abs(Kt))&&Math.abs(y-Ht)<=Xs*Math.max(1,Math.abs(y),Math.abs(Ht))&&Math.abs(w-Jt)<=Xs*Math.max(1,Math.abs(w),Math.abs(Jt))&&Math.abs(R-le)<=Xs*Math.max(1,Math.abs(R),Math.abs(le))&&Math.abs(k-ve)<=Xs*Math.max(1,Math.abs(k),Math.abs(ve))&&Math.abs(F-Ke)<=Xs*Math.max(1,Math.abs(F),Math.abs(Ke))&&Math.abs(j-dr)<=Xs*Math.max(1,Math.abs(j),Math.abs(dr))&&Math.abs(q-Qe)<=Xs*Math.max(1,Math.abs(q),Math.abs(Qe))&&Math.abs(K-Ye)<=Xs*Math.max(1,Math.abs(K),Math.abs(Ye))&&Math.abs(et-je)<=Xs*Math.max(1,Math.abs(et),Math.abs(je))&&Math.abs(it-sr)<=Xs*Math.max(1,Math.abs(it),Math.abs(sr))&&Math.abs(ct-He)<=Xs*Math.max(1,Math.abs(ct),Math.abs(He))&&Math.abs(ht-Re)<=Xs*Math.max(1,Math.abs(ht),Math.abs(Re))&&Math.abs(vt-Mr)<=Xs*Math.max(1,Math.abs(vt),Math.abs(Mr))&&Math.abs(Nt-mr)<=Xs*Math.max(1,Math.abs(Nt),Math.abs(mr))&&Math.abs(Ut-Bi)<=Xs*Math.max(1,Math.abs(Ut),Math.abs(Bi))},n.b2=function(u,a){return u[0]=a[0],u[1]=a[1],u[2]=a[2],u[3]=a[3],u[4]=a[4],u[5]=a[5],u[6]=a[6],u[7]=a[7],u[8]=a[8],u[9]=a[9],u[10]=a[10],u[11]=a[11],u[12]=a[12],u[13]=a[13],u[14]=a[14],u[15]=a[15],u},n.b3=function(u,a,h){return u[0]=a[0]*h[0],u[1]=a[1]*h[1],u[2]=a[2]*h[2],u[3]=a[3]*h[3],u},n.b4=function(u,a){return u[0]*a[0]+u[1]*a[1]+u[2]*a[2]+u[3]*a[3]},n.b5=st,n.b6=KL,n.b7=ZL,n.b8=function(u,a,h,y,w){var R,k=1/Math.tan(a/2);return u[0]=k/h,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=k,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[11]=-1,u[12]=0,u[13]=0,u[15]=0,w!=null&&w!==1/0?(u[10]=(w+y)*(R=1/(y-w)),u[14]=2*w*y*R):(u[10]=-1,u[14]=-2*y),u},n.b9=function(u,a,h){var y=Math.sin(h),w=Math.cos(h),R=a[4],k=a[5],F=a[6],j=a[7],q=a[8],K=a[9],et=a[10],it=a[11];return a!==u&&(u[0]=a[0],u[1]=a[1],u[2]=a[2],u[3]=a[3],u[12]=a[12],u[13]=a[13],u[14]=a[14],u[15]=a[15]),u[4]=R*w+q*y,u[5]=k*w+K*y,u[6]=F*w+et*y,u[7]=j*w+it*y,u[8]=q*w-R*y,u[9]=K*w-k*y,u[10]=et*w-F*y,u[11]=it*w-j*y,u},n.bA=f,n.bB=TL,n.bC=z0,n.bD=Sa,n.ba=G,n.bb=Z,n.bc=function(u,a){return u[0]=a[0],u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=a[1],u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=a[2],u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u},n.bd=class extends cd{},n.be=tP,n.bf=GL,n.bg=vct,n.bi=Gr,n.bj=function(u,a,h=!1){if(jo===Ef||jo===Uc||jo===rc)throw new Error("setRTLTextPlugin cannot be called multiple times.");ic=_i.resolveURL(u),jo=Ef,Y0=a,Qm(),h||W_()},n.bk=Km,n.bl=function(u,a){let h={};for(let w=0;w<u.length;w++){let R=a&&a[u[w].id]||pt(u[w]);a&&(a[u[w].id]=R);let k=h[R];k||(k=h[R]=[]),k.push(u[w])}let y=[];for(let w in h)y.push(h[w]);return y},n.bm=Ve,n.bn=tz,n.bo=rz,n.bp=DL,n.bq=function(u){u.bucket.createArrays(),u.bucket.tilePixelRatio=Fs/(512*u.bucket.overscaling),u.bucket.compareText={},u.bucket.iconsNeedLinear=!1;let a=u.bucket.layers[0],h=a.layout,y=a._unevaluatedLayout._values,w={layoutIconSize:y["icon-size"].possiblyEvaluate(new Wn(u.bucket.zoom+1),u.canonical),layoutTextSize:y["text-size"].possiblyEvaluate(new Wn(u.bucket.zoom+1),u.canonical),textMaxSize:y["text-size"].possiblyEvaluate(new Wn(18))};if(u.bucket.textSizeData.kind==="composite"){let{minZoom:q,maxZoom:K}=u.bucket.textSizeData;w.compositeTextSizes=[y["text-size"].possiblyEvaluate(new Wn(q),u.canonical),y["text-size"].possiblyEvaluate(new Wn(K),u.canonical)]}if(u.bucket.iconSizeData.kind==="composite"){let{minZoom:q,maxZoom:K}=u.bucket.iconSizeData;w.compositeIconSizes=[y["icon-size"].possiblyEvaluate(new Wn(q),u.canonical),y["icon-size"].possiblyEvaluate(new Wn(K),u.canonical)]}let R=h.get("text-line-height")*xo,k=h.get("text-rotation-alignment")!=="viewport"&&h.get("symbol-placement")!=="point",F=h.get("text-keep-upright"),j=h.get("text-size");for(let q of u.bucket.features){let K=h.get("text-font").evaluate(q,{},u.canonical).join(","),et=j.evaluate(q,{},u.canonical),it=w.layoutTextSize.evaluate(q,{},u.canonical),ct=w.layoutIconSize.evaluate(q,{},u.canonical),ht={horizontal:{},vertical:void 0},vt=q.text,Nt,Ut=[0,0];if(vt){let Jt=vt.toString(),le=h.get("text-letter-spacing").evaluate(q,{},u.canonical)*xo,ve=Zm(Jt)?le:0,Ke=h.get("text-anchor").evaluate(q,{},u.canonical),dr=dz(a,q,u.canonical);if(!dr){let He=h.get("text-radial-offset").evaluate(q,{},u.canonical);Ut=He?pz(Ke,[He*xo,iP]):h.get("text-offset").evaluate(q,{},u.canonical).map(Re=>Re*xo)}let Qe=k?"center":h.get("text-justify").evaluate(q,{},u.canonical),Ye=h.get("symbol-placement"),je=Ye==="point"?h.get("text-max-width").evaluate(q,{},u.canonical)*xo:0,sr=()=>{u.bucket.allowVerticalPlacement&&Xm(Jt)&&(ht.vertical=zT(vt,u.glyphMap,u.glyphPositions,u.imagePositions,K,je,R,Ke,"left",ve,Ut,n.ai.vertical,!0,Ye,it,et))};if(!k&&dr){let He=new Set;if(Qe==="auto")for(let Mr=0;Mr<dr.values.length;Mr+=2)He.add(nP(dr.values[Mr]));else He.add(Qe);let Re=!1;for(let Mr of He)if(!ht.horizontal[Mr])if(Re)ht.horizontal[Mr]=ht.horizontal[0];else{let mr=zT(vt,u.glyphMap,u.glyphPositions,u.imagePositions,K,je,R,"center",Mr,ve,Ut,n.ai.horizontal,!1,Ye,it,et);mr&&(ht.horizontal[Mr]=mr,Re=mr.positionedLines.length===1)}sr()}else{Qe==="auto"&&(Qe=nP(Ke));let He=zT(vt,u.glyphMap,u.glyphPositions,u.imagePositions,K,je,R,Ke,Qe,ve,Ut,n.ai.horizontal,!1,Ye,it,et);He&&(ht.horizontal[Qe]=He),sr(),Xm(Jt)&&k&&F&&(ht.vertical=zT(vt,u.glyphMap,u.glyphPositions,u.imagePositions,K,je,R,Ke,Qe,ve,Ut,n.ai.vertical,!1,Ye,it,et))}}let Kt=!1;if(q.icon&&q.icon.name){let Jt=u.imageMap[q.icon.name];Jt&&(Nt=ict(u.imagePositions[q.icon.name],h.get("icon-offset").evaluate(q,{},u.canonical),h.get("icon-anchor").evaluate(q,{},u.canonical)),Kt=!!Jt.sdf,u.bucket.sdfIcons===void 0?u.bucket.sdfIcons=Kt:u.bucket.sdfIcons!==Kt&&oe("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Jt.pixelRatio!==u.bucket.pixelRatio||h.get("icon-rotate").constantOr(1)!==0)&&(u.bucket.iconsNeedLinear=!0))}let Ht=mz(ht.horizontal)||ht.vertical;u.bucket.iconsInText=!!Ht&&Ht.iconsInText,(Ht||Nt)&&xct(u.bucket,q,ht,Nt,u.imageMap,w,it,ct,Ut,Kt,u.canonical)}u.showCollisionBoxes&&u.bucket.generateCollisionDebugBuffers()},n.br=jC,n.bs=zC,n.bt=VC,n.bu=class{constructor(u){this._marks={start:[u.url,"start"].join("#"),end:[u.url,"end"].join("#"),measure:u.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let u=performance.getEntriesByName(this._marks.measure);return u.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),u=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),u}},n.bv=HC,n.bw=eA,n.bx=function(u,a,h,y,w){return o(this,void 0,void 0,function*(){if(H())try{return yield Se(u,a,h,y,w)}catch{}return function(R,k,F,j,q){let K=R.width,et=R.height;ze&&ke||(ze=new OffscreenCanvas(K,et),ke=ze.getContext("2d",{willReadFrequently:!0})),ze.width=K,ze.height=et,ke.drawImage(R,0,0,K,et);let it=ke.getImageData(k,F,j,q);return ke.clearRect(0,0,K,et),it.data}(u,a,h,y,w)})},n.by=JL,n.bz=c,n.c=ci,n.d=function(u,a){let h=new Image;h.onload=()=>{a(null,h),URL.revokeObjectURL(h.src),h.onload=null,window.requestAnimationFrame(()=>{h.src=Ee})},h.onerror=()=>a(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));let y=new Blob([new Uint8Array(u)],{type:"image/png"});h.src=u.byteLength?URL.createObjectURL(y):Ee},n.e=at,n.f=function(u,a){return Tr(at(u,{type:"json"}),a)},n.g=Dr,n.h=_i,n.i=jt,n.j=hn,n.k=tn,n.l=jr,n.m=Tr,n.n=function(u){return new HC(u).readFields(Qlt,[])},n.o=function(u,a,h){if(!u.length)return h(null,[]);let y=u.length,w=new Array(u.length),R=null;u.forEach((k,F)=>{a(k,(j,q)=>{j&&(R=j),w[F]=q,--y==0&&h(R,w)})})},n.p=kL,n.q=I,n.r=Ps,n.s=Ie,n.t=$_,n.u=qe,n.v=ae,n.w=oe,n.x=W0,n.y=Lc,n.z=function([u,a,h]){return a+=90,a*=Math.PI/180,h*=Math.PI/180,{x:u*Math.cos(a)*Math.sin(h),y:u*Math.sin(a)*Math.sin(h),z:u*Math.cos(h)}}}),i(["./shared"],function(n){"use strict";class o{constructor(rt){this.keyCache={},rt&&this.replace(rt)}replace(rt){this._layerConfigs={},this._layers={},this.update(rt,[])}update(rt,ot){for(let Rt of rt){this._layerConfigs[Rt.id]=Rt;let Bt=this._layers[Rt.id]=n.aC(Rt);Bt._featureFilter=n.a6(Bt.filter),this.keyCache[Rt.id]&&delete this.keyCache[Rt.id]}for(let Rt of ot)delete this.keyCache[Rt],delete this._layerConfigs[Rt],delete this._layers[Rt];this.familiesBySource={};let At=n.bl(Object.values(this._layerConfigs),this.keyCache);for(let Rt of At){let Bt=Rt.map(ye=>this._layers[ye.id]),St=Bt[0];if(St.visibility==="none")continue;let qt=St.source||"",Lt=this.familiesBySource[qt];Lt||(Lt=this.familiesBySource[qt]={});let Qt=St.sourceLayer||"_geojsonTileLayer",_e=Lt[Qt];_e||(_e=Lt[Qt]=[]),_e.push(Bt)}}}class c{constructor(rt){let ot={},At=[];for(let qt in rt){let Lt=rt[qt],Qt=ot[qt]={};for(let _e in Lt){let ye=Lt[+_e];if(!ye||ye.bitmap.width===0||ye.bitmap.height===0)continue;let be={x:0,y:0,w:ye.bitmap.width+2,h:ye.bitmap.height+2};At.push(be),Qt[_e]={rect:be,metrics:ye.metrics}}}let{w:Rt,h:Bt}=n.p(At),St=new n.q({width:Rt||1,height:Bt||1});for(let qt in rt){let Lt=rt[qt];for(let Qt in Lt){let _e=Lt[+Qt];if(!_e||_e.bitmap.width===0||_e.bitmap.height===0)continue;let ye=ot[qt][Qt].rect;n.q.copy(_e.bitmap,St,{x:0,y:0},{x:ye.x+1,y:ye.y+1},_e.bitmap)}}this.image=St,this.positions=ot}}n.bm("GlyphAtlas",c);class f{constructor(rt){this.tileID=new n.O(rt.tileID.overscaledZ,rt.tileID.wrap,rt.tileID.canonical.z,rt.tileID.canonical.x,rt.tileID.canonical.y),this.uid=rt.uid,this.zoom=rt.zoom,this.pixelRatio=rt.pixelRatio,this.tileSize=rt.tileSize,this.source=rt.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=rt.showCollisionBoxes,this.collectResourceTiming=!!rt.collectResourceTiming,this.returnDependencies=!!rt.returnDependencies,this.promoteId=rt.promoteId,this.inFlightDependencies=[],this.dependencySentinel=-1}parse(rt,ot,At,Rt,Bt){this.status="parsing",this.data=rt,this.collisionBoxArray=new n.a3;let St=new n.bn(Object.keys(rt.layers).sort()),qt=new n.bo(this.tileID,this.promoteId);qt.bucketLayerIDs=[];let Lt={},Qt={featureIndex:qt,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:At},_e=ot.familiesBySource[this.source];for(let Ui in _e){let di=rt.layers[Ui];if(!di)continue;di.version===1&&n.w(`Vector tile source "${this.source}" layer "${Ui}" does not use vector tile spec v2 and therefore may have some rendering errors.`);let Is=St.encode(Ui),fn=[];for(let rs=0;rs<di.length;rs++){let Os=di.feature(rs),va=qt.getId(Os,Ui);fn.push({feature:Os,id:va,index:rs,sourceLayerIndex:Is})}for(let rs of _e[Ui]){let Os=rs[0];Os.source!==this.source&&n.w(`layer.source = ${Os.source} does not equal this.source = ${this.source}`),Os.minzoom&&this.zoom<Math.floor(Os.minzoom)||Os.maxzoom&&this.zoom>=Os.maxzoom||Os.visibility!=="none"&&(p(rs,this.zoom,At),(Lt[Os.id]=Os.createBucket({index:qt.bucketLayerIDs.length,layers:rs,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Is,sourceID:this.source})).populate(fn,Qt,this.tileID.canonical),qt.bucketLayerIDs.push(rs.map(va=>va.id)))}}let ye,be,xr,Or,lr=n.aH(Qt.glyphDependencies,Ui=>Object.keys(Ui).map(Number));this.inFlightDependencies.forEach(Ui=>Ui?.cancel()),this.inFlightDependencies=[];let br=++this.dependencySentinel;Object.keys(lr).length?this.inFlightDependencies.push(Rt.send("getGlyphs",{uid:this.uid,stacks:lr,source:this.source,tileID:this.tileID,type:"glyphs"},(Ui,di)=>{br===this.dependencySentinel&&(ye||(ye=Ui,be=di,gn.call(this)))})):be={};let Ur=Object.keys(Qt.iconDependencies);Ur.length?this.inFlightDependencies.push(Rt.send("getImages",{icons:Ur,source:this.source,tileID:this.tileID,type:"icons"},(Ui,di)=>{br===this.dependencySentinel&&(ye||(ye=Ui,xr=di,gn.call(this)))})):xr={};let an=Object.keys(Qt.patternDependencies);function gn(){if(ye)return Bt(ye);if(be&&xr&&Or){let Ui=new c(be),di=new n.bp(xr,Or);for(let Is in Lt){let fn=Lt[Is];fn instanceof n.a4?(p(fn.layers,this.zoom,At),n.bq({bucket:fn,glyphMap:be,glyphPositions:Ui.positions,imageMap:xr,imagePositions:di.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):fn.hasPattern&&(fn instanceof n.br||fn instanceof n.bs||fn instanceof n.bt)&&(p(fn.layers,this.zoom,At),fn.addFeatures(Qt,this.tileID.canonical,di.patternPositions))}this.status="done",Bt(null,{buckets:Object.values(Lt).filter(Is=>!Is.isEmpty()),featureIndex:qt,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Ui.image,imageAtlas:di,glyphMap:this.returnDependencies?be:null,iconMap:this.returnDependencies?xr:null,glyphPositions:this.returnDependencies?Ui.positions:null})}}an.length?this.inFlightDependencies.push(Rt.send("getImages",{icons:an,source:this.source,tileID:this.tileID,type:"patterns"},(Ui,di)=>{br===this.dependencySentinel&&(ye||(ye=Ui,Or=di,gn.call(this)))})):Or={},gn.call(this)}}function p(It,rt,ot){let At=new n.a8(rt);for(let Rt of It)Rt.recalculate(At,ot)}function x(It,rt){let ot=n.l(It.request,(At,Rt,Bt,St)=>{if(At)rt(At);else if(Rt)try{let qt=new n.bw.VectorTile(new n.bv(Rt));rt(null,{vectorTile:qt,rawData:Rt,cacheControl:Bt,expires:St})}catch(qt){let Lt=new Uint8Array(Rt),Qt=`Unable to parse the tile at ${It.request.url}, `;Qt+=Lt[0]===31&&Lt[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${qt.messge}`,rt(new Error(Qt))}});return()=>{ot.cancel(),rt()}}class E{constructor(rt,ot,At,Rt){this.actor=rt,this.layerIndex=ot,this.availableImages=At,this.loadVectorData=Rt||x,this.fetching={},this.loading={},this.loaded={}}loadTile(rt,ot){let At=rt.uid;this.loading||(this.loading={});let Rt=!!(rt&&rt.request&&rt.request.collectResourceTiming)&&new n.bu(rt.request),Bt=this.loading[At]=new f(rt);Bt.abort=this.loadVectorData(rt,(St,qt)=>{if(delete this.loading[At],St||!qt)return Bt.status="done",this.loaded[At]=Bt,ot(St);let Lt=qt.rawData,Qt={};qt.expires&&(Qt.expires=qt.expires),qt.cacheControl&&(Qt.cacheControl=qt.cacheControl);let _e={};if(Rt){let ye=Rt.finish();ye&&(_e.resourceTiming=JSON.parse(JSON.stringify(ye)))}Bt.vectorTile=qt.vectorTile,Bt.parse(qt.vectorTile,this.layerIndex,this.availableImages,this.actor,(ye,be)=>{if(delete this.fetching[At],ye||!be)return ot(ye);ot(null,n.e({rawTileData:Lt.slice(0)},be,Qt,_e))}),this.loaded=this.loaded||{},this.loaded[At]=Bt,this.fetching[At]={rawTileData:Lt,cacheControl:Qt,resourceTiming:_e}})}reloadTile(rt,ot){let At=this.loaded,Rt=rt.uid;if(At&&At[Rt]){let Bt=At[Rt];Bt.showCollisionBoxes=rt.showCollisionBoxes,Bt.status==="parsing"?Bt.parse(Bt.vectorTile,this.layerIndex,this.availableImages,this.actor,(St,qt)=>{if(St||!qt)return ot(St,qt);let Lt;if(this.fetching[Rt]){let{rawTileData:Qt,cacheControl:_e,resourceTiming:ye}=this.fetching[Rt];delete this.fetching[Rt],Lt=n.e({rawTileData:Qt.slice(0)},qt,_e,ye)}else Lt=qt;ot(null,Lt)}):Bt.status==="done"&&(Bt.vectorTile?Bt.parse(Bt.vectorTile,this.layerIndex,this.availableImages,this.actor,ot):ot())}}abortTile(rt,ot){let At=this.loading,Rt=rt.uid;At&&At[Rt]&&At[Rt].abort&&(At[Rt].abort(),delete At[Rt]),ot()}removeTile(rt,ot){let At=this.loaded,Rt=rt.uid;At&&At[Rt]&&delete At[Rt],ot()}}class T{constructor(){this.loaded={}}loadTile(rt,ot){return n._(this,void 0,void 0,function*(){let{uid:At,encoding:Rt,rawImageData:Bt,redFactor:St,greenFactor:qt,blueFactor:Lt,baseShift:Qt}=rt,_e=Bt.width+2,ye=Bt.height+2,be=n.a(Bt)?new n.R({width:_e,height:ye},yield n.bx(Bt,-1,-1,_e,ye)):Bt,xr=new n.by(At,be,Rt,St,qt,Lt,Qt);this.loaded=this.loaded||{},this.loaded[At]=xr,ot(null,xr)})}removeTile(rt){let ot=this.loaded,At=rt.uid;ot&&ot[At]&&delete ot[At]}}function D(It,rt){if(It.length!==0){N(It[0],rt);for(var ot=1;ot<It.length;ot++)N(It[ot],!rt)}}function N(It,rt){for(var ot=0,At=0,Rt=0,Bt=It.length,St=Bt-1;Rt<Bt;St=Rt++){var qt=(It[Rt][0]-It[St][0])*(It[St][1]+It[Rt][1]),Lt=ot+qt;At+=Math.abs(ot)>=Math.abs(qt)?ot-Lt+qt:qt-Lt+ot,ot=Lt}ot+At>=0!=!!rt&&It.reverse()}var z=n.bz(function It(rt,ot){var At,Rt=rt&&rt.type;if(Rt==="FeatureCollection")for(At=0;At<rt.features.length;At++)It(rt.features[At],ot);else if(Rt==="GeometryCollection")for(At=0;At<rt.geometries.length;At++)It(rt.geometries[At],ot);else if(Rt==="Feature")It(rt.geometry,ot);else if(Rt==="Polygon")D(rt.coordinates,ot);else if(Rt==="MultiPolygon")for(At=0;At<rt.coordinates.length;At++)D(rt.coordinates[At],ot);return rt});let U=n.bw.VectorTileFeature.prototype.toGeoJSON;var H={exports:{}},G=n.bA,Z=n.bw.VectorTileFeature,Y=st;function st(It,rt){this.options=rt||{},this.features=It,this.length=It.length}function at(It,rt){this.id=typeof It.id=="number"?It.id:void 0,this.type=It.type,this.rawGeometry=It.type===1?[It.geometry]:It.geometry,this.properties=It.tags,this.extent=rt||4096}st.prototype.feature=function(It){return new at(this.features[It],this.options.extent)},at.prototype.loadGeometry=function(){var It=this.rawGeometry;this.geometry=[];for(var rt=0;rt<It.length;rt++){for(var ot=It[rt],At=[],Rt=0;Rt<ot.length;Rt++)At.push(new G(ot[Rt][0],ot[Rt][1]));this.geometry.push(At)}return this.geometry},at.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var It=this.geometry,rt=1/0,ot=-1/0,At=1/0,Rt=-1/0,Bt=0;Bt<It.length;Bt++)for(var St=It[Bt],qt=0;qt<St.length;qt++){var Lt=St[qt];rt=Math.min(rt,Lt.x),ot=Math.max(ot,Lt.x),At=Math.min(At,Lt.y),Rt=Math.max(Rt,Lt.y)}return[rt,At,ot,Rt]},at.prototype.toGeoJSON=Z.prototype.toGeoJSON;var Dt=n.bB,Tt=Y;function kt(It){var rt=new Dt;return function(ot,At){for(var Rt in ot.layers)At.writeMessage(3,Et,ot.layers[Rt])}(It,rt),rt.finish()}function Et(It,rt){var ot;rt.writeVarintField(15,It.version||1),rt.writeStringField(1,It.name||""),rt.writeVarintField(5,It.extent||4096);var At={keys:[],values:[],keycache:{},valuecache:{}};for(ot=0;ot<It.length;ot++)At.feature=It.feature(ot),rt.writeMessage(2,Mt,At);var Rt=At.keys;for(ot=0;ot<Rt.length;ot++)rt.writeStringField(3,Rt[ot]);var Bt=At.values;for(ot=0;ot<Bt.length;ot++)rt.writeMessage(4,Wt,Bt[ot])}function Mt(It,rt){var ot=It.feature;ot.id!==void 0&&rt.writeVarintField(1,ot.id),rt.writeMessage(2,oe,It),rt.writeVarintField(3,ot.type),rt.writeMessage(4,jt,ot)}function oe(It,rt){var ot=It.feature,At=It.keys,Rt=It.values,Bt=It.keycache,St=It.valuecache;for(var qt in ot.properties){var Lt=ot.properties[qt],Qt=Bt[qt];if(Lt!==null){Qt===void 0&&(At.push(qt),Bt[qt]=Qt=At.length-1),rt.writeVarint(Qt);var _e=typeof Lt;_e!=="string"&&_e!=="boolean"&&_e!=="number"&&(Lt=JSON.stringify(Lt));var ye=_e+":"+Lt,be=St[ye];be===void 0&&(Rt.push(Lt),St[ye]=be=Rt.length-1),rt.writeVarint(be)}}}function Xt(It,rt){return(rt<<3)+(7&It)}function xt(It){return It<<1^It>>31}function jt(It,rt){for(var ot=It.loadGeometry(),At=It.type,Rt=0,Bt=0,St=ot.length,qt=0;qt<St;qt++){var Lt=ot[qt],Qt=1;At===1&&(Qt=Lt.length),rt.writeVarint(Xt(1,Qt));for(var _e=At===3?Lt.length-1:Lt.length,ye=0;ye<_e;ye++){ye===1&&At!==1&&rt.writeVarint(Xt(2,_e-1));var be=Lt[ye].x-Rt,xr=Lt[ye].y-Bt;rt.writeVarint(xt(be)),rt.writeVarint(xt(xr)),Rt+=be,Bt+=xr}At===3&&rt.writeVarint(Xt(7,1))}}function Wt(It,rt){var ot=typeof It;ot==="string"?rt.writeStringField(1,It):ot==="boolean"?rt.writeBooleanField(7,It):ot==="number"&&(It%1!=0?rt.writeDoubleField(3,It):It<0?rt.writeSVarintField(6,It):rt.writeVarintField(5,It))}H.exports=kt,H.exports.fromVectorTileJs=kt,H.exports.fromGeojsonVt=function(It,rt){rt=rt||{};var ot={};for(var At in It)ot[At]=new Tt(It[At].features,rt),ot[At].name=At,ot[At].version=rt.version,ot[At].extent=rt.extent;return kt({layers:ot})},H.exports.GeoJSONWrapper=Tt;var de=n.bz(H.exports);let Ee={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:It=>It},Se=Math.fround||(ze=new Float32Array(1),It=>(ze[0]=+It,ze[0]));var ze;let ke=3,ir=5,Ti=6;class _i{constructor(rt){this.options=Object.assign(Object.create(Ee),rt),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(rt){let{log:ot,minZoom:At,maxZoom:Rt}=this.options;ot&&console.time("total time");let Bt=`prepare ${rt.length} points`;ot&&console.time(Bt),this.points=rt;let St=[];for(let Lt=0;Lt<rt.length;Lt++){let Qt=rt[Lt];if(!Qt.geometry)continue;let[_e,ye]=Qt.geometry.coordinates,be=Se(Fr(_e)),xr=Se(Dr(ye));St.push(be,xr,1/0,Lt,-1,1),this.options.reduce&&St.push(0)}let qt=this.trees[Rt+1]=this._createTree(St);ot&&console.timeEnd(Bt);for(let Lt=Rt;Lt>=At;Lt--){let Qt=+Date.now();qt=this.trees[Lt]=this._createTree(this._cluster(qt,Lt)),ot&&console.log("z%d: %d clusters in %dms",Lt,qt.numItems,+Date.now()-Qt)}return ot&&console.timeEnd("total time"),this}getClusters(rt,ot){let At=((rt[0]+180)%360+360)%360-180,Rt=Math.max(-90,Math.min(90,rt[1])),Bt=rt[2]===180?180:((rt[2]+180)%360+360)%360-180,St=Math.max(-90,Math.min(90,rt[3]));if(rt[2]-rt[0]>=360)At=-180,Bt=180;else if(At>Bt){let ye=this.getClusters([At,Rt,180,St],ot),be=this.getClusters([-180,Rt,Bt,St],ot);return ye.concat(be)}let qt=this.trees[this._limitZoom(ot)],Lt=qt.range(Fr(At),Dr(St),Fr(Bt),Dr(Rt)),Qt=qt.data,_e=[];for(let ye of Lt){let be=this.stride*ye;_e.push(Qt[be+ir]>1?ci(Qt,be,this.clusterProps):this.points[Qt[be+ke]])}return _e}getChildren(rt){let ot=this._getOriginId(rt),At=this._getOriginZoom(rt),Rt="No cluster with the specified id.",Bt=this.trees[At];if(!Bt)throw new Error(Rt);let St=Bt.data;if(ot*this.stride>=St.length)throw new Error(Rt);let qt=this.options.radius/(this.options.extent*Math.pow(2,At-1)),Lt=Bt.within(St[ot*this.stride],St[ot*this.stride+1],qt),Qt=[];for(let _e of Lt){let ye=_e*this.stride;St[ye+4]===rt&&Qt.push(St[ye+ir]>1?ci(St,ye,this.clusterProps):this.points[St[ye+ke]])}if(Qt.length===0)throw new Error(Rt);return Qt}getLeaves(rt,ot,At){let Rt=[];return this._appendLeaves(Rt,rt,ot=ot||10,At=At||0,0),Rt}getTile(rt,ot,At){let Rt=this.trees[this._limitZoom(rt)],Bt=Math.pow(2,rt),{extent:St,radius:qt}=this.options,Lt=qt/St,Qt=(At-Lt)/Bt,_e=(At+1+Lt)/Bt,ye={features:[]};return this._addTileFeatures(Rt.range((ot-Lt)/Bt,Qt,(ot+1+Lt)/Bt,_e),Rt.data,ot,At,Bt,ye),ot===0&&this._addTileFeatures(Rt.range(1-Lt/Bt,Qt,1,_e),Rt.data,Bt,At,Bt,ye),ot===Bt-1&&this._addTileFeatures(Rt.range(0,Qt,Lt/Bt,_e),Rt.data,-1,At,Bt,ye),ye.features.length?ye:null}getClusterExpansionZoom(rt){let ot=this._getOriginZoom(rt)-1;for(;ot<=this.options.maxZoom;){let At=this.getChildren(rt);if(ot++,At.length!==1)break;rt=At[0].properties.cluster_id}return ot}_appendLeaves(rt,ot,At,Rt,Bt){let St=this.getChildren(ot);for(let qt of St){let Lt=qt.properties;if(Lt&&Lt.cluster?Bt+Lt.point_count<=Rt?Bt+=Lt.point_count:Bt=this._appendLeaves(rt,Lt.cluster_id,At,Rt,Bt):Bt<Rt?Bt++:rt.push(qt),rt.length===At)break}return Bt}_createTree(rt){let ot=new n.av(rt.length/this.stride|0,this.options.nodeSize,Float32Array);for(let At=0;At<rt.length;At+=this.stride)ot.add(rt[At],rt[At+1]);return ot.finish(),ot.data=rt,ot}_addTileFeatures(rt,ot,At,Rt,Bt,St){for(let qt of rt){let Lt=qt*this.stride,Qt=ot[Lt+ir]>1,_e,ye,be;if(Qt)_e=Gr(ot,Lt,this.clusterProps),ye=ot[Lt],be=ot[Lt+1];else{let lr=this.points[ot[Lt+ke]];_e=lr.properties;let[br,Ur]=lr.geometry.coordinates;ye=Fr(br),be=Dr(Ur)}let xr={type:1,geometry:[[Math.round(this.options.extent*(ye*Bt-At)),Math.round(this.options.extent*(be*Bt-Rt))]],tags:_e},Or;Or=Qt||this.options.generateId?ot[Lt+ke]:this.points[ot[Lt+ke]].id,Or!==void 0&&(xr.id=Or),St.features.push(xr)}}_limitZoom(rt){return Math.max(this.options.minZoom,Math.min(Math.floor(+rt),this.options.maxZoom+1))}_cluster(rt,ot){let{radius:At,extent:Rt,reduce:Bt,minPoints:St}=this.options,qt=At/(Rt*Math.pow(2,ot)),Lt=rt.data,Qt=[],_e=this.stride;for(let ye=0;ye<Lt.length;ye+=_e){if(Lt[ye+2]<=ot)continue;Lt[ye+2]=ot;let be=Lt[ye],xr=Lt[ye+1],Or=rt.within(Lt[ye],Lt[ye+1],qt),lr=Lt[ye+ir],br=lr;for(let Ur of Or){let an=Ur*_e;Lt[an+2]>ot&&(br+=Lt[an+ir])}if(br>lr&&br>=St){let Ur,an=be*lr,gn=xr*lr,Ui=-1,di=((ye/_e|0)<<5)+(ot+1)+this.points.length;for(let Is of Or){let fn=Is*_e;if(Lt[fn+2]<=ot)continue;Lt[fn+2]=ot;let rs=Lt[fn+ir];an+=Lt[fn]*rs,gn+=Lt[fn+1]*rs,Lt[fn+4]=di,Bt&&(Ur||(Ur=this._map(Lt,ye,!0),Ui=this.clusterProps.length,this.clusterProps.push(Ur)),Bt(Ur,this._map(Lt,fn)))}Lt[ye+4]=di,Qt.push(an/br,gn/br,1/0,di,-1,br),Bt&&Qt.push(Ui)}else{for(let Ur=0;Ur<_e;Ur++)Qt.push(Lt[ye+Ur]);if(br>1)for(let Ur of Or){let an=Ur*_e;if(!(Lt[an+2]<=ot)){Lt[an+2]=ot;for(let gn=0;gn<_e;gn++)Qt.push(Lt[an+gn])}}}}return Qt}_getOriginId(rt){return rt-this.points.length>>5}_getOriginZoom(rt){return(rt-this.points.length)%32}_map(rt,ot,At){if(rt[ot+ir]>1){let St=this.clusterProps[rt[ot+Ti]];return At?Object.assign({},St):St}let Rt=this.points[rt[ot+ke]].properties,Bt=this.options.map(Rt);return At&&Bt===Rt?Object.assign({},Bt):Bt}}function ci(It,rt,ot){return{type:"Feature",id:It[rt+ke],properties:Gr(It,rt,ot),geometry:{type:"Point",coordinates:[(At=It[rt],360*(At-.5)),Le(It[rt+1])]}};var At}function Gr(It,rt,ot){let At=It[rt+ir],Rt=At>=1e4?`${Math.round(At/1e3)}k`:At>=1e3?Math.round(At/100)/10+"k":At,Bt=It[rt+Ti],St=Bt===-1?{}:Object.assign({},ot[Bt]);return Object.assign(St,{cluster:!0,cluster_id:It[rt+ke],point_count:At,point_count_abbreviated:Rt})}function Fr(It){return It/360+.5}function Dr(It){let rt=Math.sin(It*Math.PI/180),ot=.5-.25*Math.log((1+rt)/(1-rt))/Math.PI;return ot<0?0:ot>1?1:ot}function Le(It){let rt=(180-360*It)*Math.PI/180;return 360*Math.atan(Math.exp(rt))/Math.PI-90}function Tr(It,rt,ot,At){for(var Rt,Bt=At,St=ot-rt>>1,qt=ot-rt,Lt=It[rt],Qt=It[rt+1],_e=It[ot],ye=It[ot+1],be=rt+3;be<ot;be+=3){var xr=jr(It[be],It[be+1],Lt,Qt,_e,ye);if(xr>Bt)Rt=be,Bt=xr;else if(xr===Bt){var Or=Math.abs(be-St);Or<qt&&(Rt=be,qt=Or)}}Bt>At&&(Rt-rt>3&&Tr(It,rt,Rt,At),It[Rt+2]=Bt,ot-Rt>3&&Tr(It,Rt,ot,At))}function jr(It,rt,ot,At,Rt,Bt){var St=Rt-ot,qt=Bt-At;if(St!==0||qt!==0){var Lt=((It-ot)*St+(rt-At)*qt)/(St*St+qt*qt);Lt>1?(ot=Rt,At=Bt):Lt>0&&(ot+=St*Lt,At+=qt*Lt)}return(St=It-ot)*St+(qt=rt-At)*qt}function Ie(It,rt,ot,At){var Rt={id:It===void 0?null:It,type:rt,geometry:ot,tags:At,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Bt){var St=Bt.geometry,qt=Bt.type;if(qt==="Point"||qt==="MultiPoint"||qt==="LineString")Ji(Bt,St);else if(qt==="Polygon"||qt==="MultiLineString")for(var Lt=0;Lt<St.length;Lt++)Ji(Bt,St[Lt]);else if(qt==="MultiPolygon")for(Lt=0;Lt<St.length;Lt++)for(var Qt=0;Qt<St[Lt].length;Qt++)Ji(Bt,St[Lt][Qt])}(Rt),Rt}function Ji(It,rt){for(var ot=0;ot<rt.length;ot+=3)It.minX=Math.min(It.minX,rt[ot]),It.minY=Math.min(It.minY,rt[ot+1]),It.maxX=Math.max(It.maxX,rt[ot]),It.maxY=Math.max(It.maxY,rt[ot+1])}function yi(It,rt,ot,At){if(rt.geometry){var Rt=rt.geometry.coordinates,Bt=rt.geometry.type,St=Math.pow(ot.tolerance/((1<<ot.maxZoom)*ot.extent),2),qt=[],Lt=rt.id;if(ot.promoteId?Lt=rt.properties[ot.promoteId]:ot.generateId&&(Lt=At||0),Bt==="Point")tn(Rt,qt);else if(Bt==="MultiPoint")for(var Qt=0;Qt<Rt.length;Qt++)tn(Rt[Qt],qt);else if(Bt==="LineString")hn(Rt,qt,St,!1);else if(Bt==="MultiLineString"){if(ot.lineMetrics){for(Qt=0;Qt<Rt.length;Qt++)hn(Rt[Qt],qt=[],St,!1),It.push(Ie(Lt,"LineString",qt,rt.properties));return}Sr(Rt,qt,St,!1)}else if(Bt==="Polygon")Sr(Rt,qt,St,!0);else{if(Bt!=="MultiPolygon"){if(Bt==="GeometryCollection"){for(Qt=0;Qt<rt.geometry.geometries.length;Qt++)yi(It,{id:Lt,geometry:rt.geometry.geometries[Qt],properties:rt.properties},ot,At);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Qt=0;Qt<Rt.length;Qt++){var _e=[];Sr(Rt[Qt],_e,St,!0),qt.push(_e)}}It.push(Ie(Lt,Bt,qt,rt.properties))}}function tn(It,rt){rt.push(ae(It[0])),rt.push(Xn(It[1])),rt.push(0)}function hn(It,rt,ot,At){for(var Rt,Bt,St=0,qt=0;qt<It.length;qt++){var Lt=ae(It[qt][0]),Qt=Xn(It[qt][1]);rt.push(Lt),rt.push(Qt),rt.push(0),qt>0&&(St+=At?(Rt*Qt-Lt*Bt)/2:Math.sqrt(Math.pow(Lt-Rt,2)+Math.pow(Qt-Bt,2))),Rt=Lt,Bt=Qt}var _e=rt.length-3;rt[2]=1,Tr(rt,0,_e,ot),rt[_e+2]=1,rt.size=Math.abs(St),rt.start=0,rt.end=rt.size}function Sr(It,rt,ot,At){for(var Rt=0;Rt<It.length;Rt++){var Bt=[];hn(It[Rt],Bt,ot,At),rt.push(Bt)}}function ae(It){return It/360+.5}function Xn(It){var rt=Math.sin(It*Math.PI/180),ot=.5-.25*Math.log((1+rt)/(1-rt))/Math.PI;return ot<0?0:ot>1?1:ot}function on(It,rt,ot,At,Rt,Bt,St,qt){if(At/=rt,Bt>=(ot/=rt)&&St<At)return It;if(St<ot||Bt>=At)return null;for(var Lt=[],Qt=0;Qt<It.length;Qt++){var _e=It[Qt],ye=_e.geometry,be=_e.type,xr=Rt===0?_e.minX:_e.minY,Or=Rt===0?_e.maxX:_e.maxY;if(xr>=ot&&Or<At)Lt.push(_e);else if(!(Or<ot||xr>=At)){var lr=[];if(be==="Point"||be==="MultiPoint")Qi(ye,lr,ot,At,Rt);else if(be==="LineString")$i(ye,lr,ot,At,Rt,!1,qt.lineMetrics);else if(be==="MultiLineString")pu(ye,lr,ot,At,Rt,!1);else if(be==="Polygon")pu(ye,lr,ot,At,Rt,!0);else if(be==="MultiPolygon")for(var br=0;br<ye.length;br++){var Ur=[];pu(ye[br],Ur,ot,At,Rt,!0),Ur.length&&lr.push(Ur)}if(lr.length){if(qt.lineMetrics&&be==="LineString"){for(br=0;br<lr.length;br++)Lt.push(Ie(_e.id,be,lr[br],_e.tags));continue}be!=="LineString"&&be!=="MultiLineString"||(lr.length===1?(be="LineString",lr=lr[0]):be="MultiLineString"),be!=="Point"&&be!=="MultiPoint"||(be=lr.length===3?"Point":"MultiPoint"),Lt.push(Ie(_e.id,be,lr,_e.tags))}}}return Lt.length?Lt:null}function Qi(It,rt,ot,At,Rt){for(var Bt=0;Bt<It.length;Bt+=3){var St=It[Bt+Rt];St>=ot&&St<=At&&(rt.push(It[Bt]),rt.push(It[Bt+1]),rt.push(It[Bt+2]))}}function $i(It,rt,ot,At,Rt,Bt,St){for(var qt,Lt,Qt=Ro(It),_e=Rt===0?Uo:vl,ye=It.start,be=0;be<It.length-3;be+=3){var xr=It[be],Or=It[be+1],lr=It[be+2],br=It[be+3],Ur=It[be+4],an=Rt===0?xr:Or,gn=Rt===0?br:Ur,Ui=!1;St&&(qt=Math.sqrt(Math.pow(xr-br,2)+Math.pow(Or-Ur,2))),an<ot?gn>ot&&(Lt=_e(Qt,xr,Or,br,Ur,ot),St&&(Qt.start=ye+qt*Lt)):an>At?gn<At&&(Lt=_e(Qt,xr,Or,br,Ur,At),St&&(Qt.start=ye+qt*Lt)):bl(Qt,xr,Or,lr),gn<ot&&an>=ot&&(Lt=_e(Qt,xr,Or,br,Ur,ot),Ui=!0),gn>At&&an<=At&&(Lt=_e(Qt,xr,Or,br,Ur,At),Ui=!0),!Bt&&Ui&&(St&&(Qt.end=ye+qt*Lt),rt.push(Qt),Qt=Ro(It)),St&&(ye+=qt)}var di=It.length-3;xr=It[di],Or=It[di+1],lr=It[di+2],(an=Rt===0?xr:Or)>=ot&&an<=At&&bl(Qt,xr,Or,lr),di=Qt.length-3,Bt&&di>=3&&(Qt[di]!==Qt[0]||Qt[di+1]!==Qt[1])&&bl(Qt,Qt[0],Qt[1],Qt[2]),Qt.length&&rt.push(Qt)}function Ro(It){var rt=[];return rt.size=It.size,rt.start=It.start,rt.end=It.end,rt}function pu(It,rt,ot,At,Rt,Bt){for(var St=0;St<It.length;St++)$i(It[St],rt,ot,At,Rt,Bt,!1)}function bl(It,rt,ot,At){It.push(rt),It.push(ot),It.push(At)}function Uo(It,rt,ot,At,Rt,Bt){var St=(Bt-rt)/(At-rt);return It.push(Bt),It.push(ot+(Rt-ot)*St),It.push(1),St}function vl(It,rt,ot,At,Rt,Bt){var St=(Bt-ot)/(Rt-ot);return It.push(rt+(At-rt)*St),It.push(Bt),It.push(1),St}function Xa(It,rt){for(var ot=[],At=0;At<It.length;At++){var Rt,Bt=It[At],St=Bt.type;if(St==="Point"||St==="MultiPoint"||St==="LineString")Rt=Vo(Bt.geometry,rt);else if(St==="MultiLineString"||St==="Polygon"){Rt=[];for(var qt=0;qt<Bt.geometry.length;qt++)Rt.push(Vo(Bt.geometry[qt],rt))}else if(St==="MultiPolygon")for(Rt=[],qt=0;qt<Bt.geometry.length;qt++){for(var Lt=[],Qt=0;Qt<Bt.geometry[qt].length;Qt++)Lt.push(Vo(Bt.geometry[qt][Qt],rt));Rt.push(Lt)}ot.push(Ie(Bt.id,St,Rt,Bt.tags))}return ot}function Vo(It,rt){var ot=[];ot.size=It.size,It.start!==void 0&&(ot.start=It.start,ot.end=It.end);for(var At=0;At<It.length;At+=3)ot.push(It[At]+rt,It[At+1],It[At+2]);return ot}function Ne(It,rt){if(It.transformed)return It;var ot,At,Rt,Bt=1<<It.z,St=It.x,qt=It.y;for(ot=0;ot<It.features.length;ot++){var Lt=It.features[ot],Qt=Lt.geometry,_e=Lt.type;if(Lt.geometry=[],_e===1)for(At=0;At<Qt.length;At+=2)Lt.geometry.push(ta(Qt[At],Qt[At+1],rt,Bt,St,qt));else for(At=0;At<Qt.length;At++){var ye=[];for(Rt=0;Rt<Qt[At].length;Rt+=2)ye.push(ta(Qt[At][Rt],Qt[At][Rt+1],rt,Bt,St,qt));Lt.geometry.push(ye)}}return It.transformed=!0,It}function ta(It,rt,ot,At,Rt,Bt){return[Math.round(ot*(It*At-Rt)),Math.round(ot*(rt*At-Bt))]}function Zn(It,rt,ot,At,Rt){for(var Bt=rt===Rt.maxZoom?0:Rt.tolerance/((1<<rt)*Rt.extent),St={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:ot,y:At,z:rt,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},qt=0;qt<It.length;qt++){St.numFeatures++,Xl(St,It[qt],Bt,Rt);var Lt=It[qt].minX,Qt=It[qt].minY,_e=It[qt].maxX,ye=It[qt].maxY;Lt<St.minX&&(St.minX=Lt),Qt<St.minY&&(St.minY=Qt),_e>St.maxX&&(St.maxX=_e),ye>St.maxY&&(St.maxY=ye)}return St}function Xl(It,rt,ot,At){var Rt=rt.geometry,Bt=rt.type,St=[];if(Bt==="Point"||Bt==="MultiPoint")for(var qt=0;qt<Rt.length;qt+=3)St.push(Rt[qt]),St.push(Rt[qt+1]),It.numPoints++,It.numSimplified++;else if(Bt==="LineString")Za(St,Rt,It,ot,!1,!1);else if(Bt==="MultiLineString"||Bt==="Polygon")for(qt=0;qt<Rt.length;qt++)Za(St,Rt[qt],It,ot,Bt==="Polygon",qt===0);else if(Bt==="MultiPolygon")for(var Lt=0;Lt<Rt.length;Lt++){var Qt=Rt[Lt];for(qt=0;qt<Qt.length;qt++)Za(St,Qt[qt],It,ot,!0,qt===0)}if(St.length){var _e=rt.tags||null;if(Bt==="LineString"&&At.lineMetrics){for(var ye in _e={},rt.tags)_e[ye]=rt.tags[ye];_e.mapbox_clip_start=Rt.start/Rt.size,_e.mapbox_clip_end=Rt.end/Rt.size}var be={geometry:St,type:Bt==="Polygon"||Bt==="MultiPolygon"?3:Bt==="LineString"||Bt==="MultiLineString"?2:1,tags:_e};rt.id!==null&&(be.id=rt.id),It.features.push(be)}}function Za(It,rt,ot,At,Rt,Bt){var St=At*At;if(At>0&&rt.size<(Rt?St:At))ot.numPoints+=rt.length/3;else{for(var qt=[],Lt=0;Lt<rt.length;Lt+=3)(At===0||rt[Lt+2]>St)&&(ot.numSimplified++,qt.push(rt[Lt]),qt.push(rt[Lt+1])),ot.numPoints++;Rt&&function(Qt,_e){for(var ye=0,be=0,xr=Qt.length,Or=xr-2;be<xr;Or=be,be+=2)ye+=(Qt[be]-Qt[Or])*(Qt[be+1]+Qt[Or+1]);if(ye>0===_e)for(be=0,xr=Qt.length;be<xr/2;be+=2){var lr=Qt[be],br=Qt[be+1];Qt[be]=Qt[xr-2-be],Qt[be+1]=Qt[xr-1-be],Qt[xr-2-be]=lr,Qt[xr-1-be]=br}}(qt,Bt),It.push(qt)}}function Ue(It,rt){var ot=(rt=this.options=function(Rt,Bt){for(var St in Bt)Rt[St]=Bt[St];return Rt}(Object.create(this.options),rt)).debug;if(ot&&console.time("preprocess data"),rt.maxZoom<0||rt.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(rt.promoteId&&rt.generateId)throw new Error("promoteId and generateId cannot be used together.");var At=function(Rt,Bt){var St=[];if(Rt.type==="FeatureCollection")for(var qt=0;qt<Rt.features.length;qt++)yi(St,Rt.features[qt],Bt,qt);else yi(St,Rt.type==="Feature"?Rt:{geometry:Rt},Bt);return St}(It,rt);this.tiles={},this.tileCoords=[],ot&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",rt.indexMaxZoom,rt.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),At=function(Rt,Bt){var St=Bt.buffer/Bt.extent,qt=Rt,Lt=on(Rt,1,-1-St,St,0,-1,2,Bt),Qt=on(Rt,1,1-St,2+St,0,-1,2,Bt);return(Lt||Qt)&&(qt=on(Rt,1,-St,1+St,0,-1,2,Bt)||[],Lt&&(qt=Xa(Lt,1).concat(qt)),Qt&&(qt=qt.concat(Xa(Qt,-1)))),qt}(At,rt),At.length&&this.splitTile(At,0,0,0),ot&&(At.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function ri(It,rt,ot){return 32*((1<<It)*ot+rt)+It}function Br(It,rt){return rt?It.properties[rt]:It.id}function Ao(It,rt){if(It==null)return!0;if(It.type==="Feature")return Br(It,rt)!=null;if(It.type==="FeatureCollection"){let ot=new Set;for(let At of It.features){let Rt=Br(At,rt);if(Rt==null||ot.has(Rt))return!1;ot.add(Rt)}return!0}return!1}function Ga(It,rt){let ot=new Map;if(It!=null)if(It.type==="Feature")ot.set(Br(It,rt),It);else for(let At of It.features)ot.set(Br(At,rt),At);return ot}Ue.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Ue.prototype.splitTile=function(It,rt,ot,At,Rt,Bt,St){for(var qt=[It,rt,ot,At],Lt=this.options,Qt=Lt.debug;qt.length;){At=qt.pop(),ot=qt.pop(),rt=qt.pop(),It=qt.pop();var _e=1<<rt,ye=ri(rt,ot,At),be=this.tiles[ye];if(!be&&(Qt>1&&console.time("creation"),be=this.tiles[ye]=Zn(It,rt,ot,At,Lt),this.tileCoords.push({z:rt,x:ot,y:At}),Qt)){Qt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",rt,ot,At,be.numFeatures,be.numPoints,be.numSimplified),console.timeEnd("creation"));var xr="z"+rt;this.stats[xr]=(this.stats[xr]||0)+1,this.total++}if(be.source=It,Rt){if(rt===Lt.maxZoom||rt===Rt)continue;var Or=1<<Rt-rt;if(ot!==Math.floor(Bt/Or)||At!==Math.floor(St/Or))continue}else if(rt===Lt.indexMaxZoom||be.numPoints<=Lt.indexMaxPoints)continue;if(be.source=null,It.length!==0){Qt>1&&console.time("clipping");var lr,br,Ur,an,gn,Ui,di=.5*Lt.buffer/Lt.extent,Is=.5-di,fn=.5+di,rs=1+di;lr=br=Ur=an=null,gn=on(It,_e,ot-di,ot+fn,0,be.minX,be.maxX,Lt),Ui=on(It,_e,ot+Is,ot+rs,0,be.minX,be.maxX,Lt),It=null,gn&&(lr=on(gn,_e,At-di,At+fn,1,be.minY,be.maxY,Lt),br=on(gn,_e,At+Is,At+rs,1,be.minY,be.maxY,Lt),gn=null),Ui&&(Ur=on(Ui,_e,At-di,At+fn,1,be.minY,be.maxY,Lt),an=on(Ui,_e,At+Is,At+rs,1,be.minY,be.maxY,Lt),Ui=null),Qt>1&&console.timeEnd("clipping"),qt.push(lr||[],rt+1,2*ot,2*At),qt.push(br||[],rt+1,2*ot,2*At+1),qt.push(Ur||[],rt+1,2*ot+1,2*At),qt.push(an||[],rt+1,2*ot+1,2*At+1)}}},Ue.prototype.getTile=function(It,rt,ot){var At=this.options,Rt=At.extent,Bt=At.debug;if(It<0||It>24)return null;var St=1<<It,qt=ri(It,rt=(rt%St+St)%St,ot);if(this.tiles[qt])return Ne(this.tiles[qt],Rt);Bt>1&&console.log("drilling down to z%d-%d-%d",It,rt,ot);for(var Lt,Qt=It,_e=rt,ye=ot;!Lt&&Qt>0;)Qt--,_e=Math.floor(_e/2),ye=Math.floor(ye/2),Lt=this.tiles[ri(Qt,_e,ye)];return Lt&&Lt.source?(Bt>1&&console.log("found parent tile z%d-%d-%d",Qt,_e,ye),Bt>1&&console.time("drilling down"),this.splitTile(Lt.source,Qt,_e,ye,It,rt,ot),Bt>1&&console.timeEnd("drilling down"),this.tiles[qt]?Ne(this.tiles[qt],Rt):null):null};class Hr extends E{constructor(rt,ot,At,Rt){super(rt,ot,At),this._dataUpdateable=new Map,this.loadGeoJSON=(Bt,St)=>{let{promoteId:qt}=Bt;if(Bt.request)return n.f(Bt.request,(Lt,Qt,_e,ye)=>{this._dataUpdateable=Ao(Qt,qt)?Ga(Qt,qt):void 0,St(Lt,Qt,_e,ye)});if(typeof Bt.data=="string")try{let Lt=JSON.parse(Bt.data);this._dataUpdateable=Ao(Lt,qt)?Ga(Lt,qt):void 0,St(null,Lt)}catch{St(new Error(`Input data given to '${Bt.source}' is not a valid GeoJSON object.`))}else Bt.dataDiff?this._dataUpdateable?(function(Lt,Qt,_e){var ye,be,xr,Or;if(Qt.removeAll&&Lt.clear(),Qt.remove)for(let lr of Qt.remove)Lt.delete(lr);if(Qt.add)for(let lr of Qt.add){let br=Br(lr,_e);br!=null&&Lt.set(br,lr)}if(Qt.update)for(let lr of Qt.update){let br=Lt.get(lr.id);if(br==null)continue;let Ur=!lr.removeAllProperties&&(((ye=lr.removeProperties)===null||ye===void 0?void 0:ye.length)>0||((be=lr.addOrUpdateProperties)===null||be===void 0?void 0:be.length)>0);if((lr.newGeometry||lr.removeAllProperties||Ur)&&(br=Object.assign({},br),Lt.set(lr.id,br),Ur&&(br.properties=Object.assign({},br.properties))),lr.newGeometry&&(br.geometry=lr.newGeometry),lr.removeAllProperties)br.properties={};else if(((xr=lr.removeProperties)===null||xr===void 0?void 0:xr.length)>0)for(let an of lr.removeProperties)Object.prototype.hasOwnProperty.call(br.properties,an)&&delete br.properties[an];if(((Or=lr.addOrUpdateProperties)===null||Or===void 0?void 0:Or.length)>0)for(let{key:an,value:gn}of lr.addOrUpdateProperties)br.properties[an]=gn}}(this._dataUpdateable,Bt.dataDiff,qt),St(null,{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())})):St(new Error(`Cannot update existing geojson data in ${Bt.source}`)):St(new Error(`Input data given to '${Bt.source}' is not a valid GeoJSON object.`));return{cancel:()=>{}}},this.loadVectorData=this.loadGeoJSONTile,Rt&&(this.loadGeoJSON=Rt)}loadGeoJSONTile(rt,ot){let At=rt.tileID.canonical;if(!this._geoJSONIndex)return ot(null,null);let Rt=this._geoJSONIndex.getTile(At.z,At.x,At.y);if(!Rt)return ot(null,null);let Bt=new class{constructor(qt){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=n.N,this.length=qt.length,this._features=qt}feature(qt){return new class{constructor(Lt){this._feature=Lt,this.extent=n.N,this.type=Lt.type,this.properties=Lt.tags,"id"in Lt&&!isNaN(Lt.id)&&(this.id=parseInt(Lt.id,10))}loadGeometry(){if(this._feature.type===1){let Lt=[];for(let Qt of this._feature.geometry)Lt.push([new n.P(Qt[0],Qt[1])]);return Lt}{let Lt=[];for(let Qt of this._feature.geometry){let _e=[];for(let ye of Qt)_e.push(new n.P(ye[0],ye[1]));Lt.push(_e)}return Lt}}toGeoJSON(Lt,Qt,_e){return U.call(this,Lt,Qt,_e)}}(this._features[qt])}}(Rt.features),St=de(Bt);St.byteOffset===0&&St.byteLength===St.buffer.byteLength||(St=new Uint8Array(St)),ot(null,{vectorTile:Bt,rawData:St.buffer})}loadData(rt,ot){var At;(At=this._pendingRequest)===null||At===void 0||At.cancel(),this._pendingCallback&&this._pendingCallback(null,{abandoned:!0});let Rt=!!(rt&&rt.request&&rt.request.collectResourceTiming)&&new n.bu(rt.request);this._pendingCallback=ot,this._pendingRequest=this.loadGeoJSON(rt,(Bt,St)=>{if(delete this._pendingCallback,delete this._pendingRequest,Bt||!St)return ot(Bt);if(typeof St!="object")return ot(new Error(`Input data given to '${rt.source}' is not a valid GeoJSON object.`));{z(St,!0);try{if(rt.filter){let Lt=n.bC(rt.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Lt.result==="error")throw new Error(Lt.value.map(_e=>`${_e.key}: ${_e.message}`).join(", "));St={type:"FeatureCollection",features:St.features.filter(_e=>Lt.value.evaluate({zoom:0},_e))}}this._geoJSONIndex=rt.cluster?new _i(function({superclusterOptions:Lt,clusterProperties:Qt}){if(!Qt||!Lt)return Lt;let _e={},ye={},be={accumulated:null,zoom:0},xr={properties:null},Or=Object.keys(Qt);for(let lr of Or){let[br,Ur]=Qt[lr],an=n.bC(Ur),gn=n.bC(typeof br=="string"?[br,["accumulated"],["get",lr]]:br);_e[lr]=an.value,ye[lr]=gn.value}return Lt.map=lr=>{xr.properties=lr;let br={};for(let Ur of Or)br[Ur]=_e[Ur].evaluate(be,xr);return br},Lt.reduce=(lr,br)=>{xr.properties=br;for(let Ur of Or)be.accumulated=lr[Ur],lr[Ur]=ye[Ur].evaluate(be,xr)},Lt}(rt)).load(St.features):function(Lt,Qt){return new Ue(Lt,Qt)}(St,rt.geojsonVtOptions)}catch(Lt){return ot(Lt)}this.loaded={};let qt={};if(Rt){let Lt=Rt.finish();Lt&&(qt.resourceTiming={},qt.resourceTiming[rt.source]=JSON.parse(JSON.stringify(Lt)))}ot(null,qt)}})}reloadTile(rt,ot){let At=this.loaded;return At&&At[rt.uid]?super.reloadTile(rt,ot):this.loadTile(rt,ot)}removeSource(rt,ot){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),ot()}getClusterExpansionZoom(rt,ot){try{ot(null,this._geoJSONIndex.getClusterExpansionZoom(rt.clusterId))}catch(At){ot(At)}}getClusterChildren(rt,ot){try{ot(null,this._geoJSONIndex.getChildren(rt.clusterId))}catch(At){ot(At)}}getClusterLeaves(rt,ot){try{ot(null,this._geoJSONIndex.getLeaves(rt.clusterId,rt.limit,rt.offset))}catch(At){ot(At)}}}class ba{constructor(rt){this.self=rt,this.actor=new n.C(rt,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:E,geojson:Hr},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(ot,At)=>{if(this.workerSourceTypes[ot])throw new Error(`Worker source with name "${ot}" already registered.`);this.workerSourceTypes[ot]=At},this.self.registerRTLTextPlugin=ot=>{if(n.bD.isParsed())throw new Error("RTL text plugin already registered.");n.bD.applyArabicShaping=ot.applyArabicShaping,n.bD.processBidirectionalText=ot.processBidirectionalText,n.bD.processStyledBidirectionalText=ot.processStyledBidirectionalText}}setReferrer(rt,ot){this.referrer=ot}setImages(rt,ot,At){this.availableImages[rt]=ot;for(let Rt in this.workerSources[rt]){let Bt=this.workerSources[rt][Rt];for(let St in Bt)Bt[St].availableImages=ot}At()}setLayers(rt,ot,At){this.getLayerIndex(rt).replace(ot),At()}updateLayers(rt,ot,At){this.getLayerIndex(rt).update(ot.layers,ot.removedIds),At()}loadTile(rt,ot,At){this.getWorkerSource(rt,ot.type,ot.source).loadTile(ot,At)}loadDEMTile(rt,ot,At){this.getDEMWorkerSource(rt,ot.source).loadTile(ot,At)}reloadTile(rt,ot,At){this.getWorkerSource(rt,ot.type,ot.source).reloadTile(ot,At)}abortTile(rt,ot,At){this.getWorkerSource(rt,ot.type,ot.source).abortTile(ot,At)}removeTile(rt,ot,At){this.getWorkerSource(rt,ot.type,ot.source).removeTile(ot,At)}removeDEMTile(rt,ot){this.getDEMWorkerSource(rt,ot.source).removeTile(ot)}removeSource(rt,ot,At){if(!this.workerSources[rt]||!this.workerSources[rt][ot.type]||!this.workerSources[rt][ot.type][ot.source])return;let Rt=this.workerSources[rt][ot.type][ot.source];delete this.workerSources[rt][ot.type][ot.source],Rt.removeSource!==void 0?Rt.removeSource(ot,At):At()}loadWorkerSource(rt,ot,At){try{this.self.importScripts(ot.url),At()}catch(Rt){At(Rt.toString())}}syncRTLPluginState(rt,ot,At){try{n.bD.setState(ot);let Rt=n.bD.getPluginURL();if(n.bD.isLoaded()&&!n.bD.isParsed()&&Rt!=null){this.self.importScripts(Rt);let Bt=n.bD.isParsed();At(Bt?void 0:new Error(`RTL Text Plugin failed to import scripts from ${Rt}`),Bt)}}catch(Rt){At(Rt.toString())}}getAvailableImages(rt){let ot=this.availableImages[rt];return ot||(ot=[]),ot}getLayerIndex(rt){let ot=this.layerIndexes[rt];return ot||(ot=this.layerIndexes[rt]=new o),ot}getWorkerSource(rt,ot,At){return this.workerSources[rt]||(this.workerSources[rt]={}),this.workerSources[rt][ot]||(this.workerSources[rt][ot]={}),this.workerSources[rt][ot][At]||(this.workerSources[rt][ot][At]=new this.workerSourceTypes[ot]({send:(Rt,Bt,St)=>{this.actor.send(Rt,Bt,St,rt)}},this.getLayerIndex(rt),this.getAvailableImages(rt))),this.workerSources[rt][ot][At]}getDEMWorkerSource(rt,ot){return this.demWorkerSources[rt]||(this.demWorkerSources[rt]={}),this.demWorkerSources[rt][ot]||(this.demWorkerSources[rt][ot]=new T),this.demWorkerSources[rt][ot]}}return n.i()&&(self.worker=new ba(self)),ba}),i(["./shared"],function(n){"use strict";var o="3.6.2";class c{static testProp(l){if(!c.docStyle)return l[0];for(let m=0;m<l.length;m++)if(l[m]in c.docStyle)return l[m];return l[0]}static create(l,m,v){let S=window.document.createElement(l);return m!==void 0&&(S.className=m),v&&v.appendChild(S),S}static createNS(l,m){return window.document.createElementNS(l,m)}static disableDrag(){c.docStyle&&c.selectProp&&(c.userSelect=c.docStyle[c.selectProp],c.docStyle[c.selectProp]="none")}static enableDrag(){c.docStyle&&c.selectProp&&(c.docStyle[c.selectProp]=c.userSelect)}static setTransform(l,m){l.style[c.transformProp]=m}static addEventListener(l,m,v,S={}){l.addEventListener(m,v,"passive"in S?S:S.capture)}static removeEventListener(l,m,v,S={}){l.removeEventListener(m,v,"passive"in S?S:S.capture)}static suppressClickInternal(l){l.preventDefault(),l.stopPropagation(),window.removeEventListener("click",c.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",c.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",c.suppressClickInternal,!0)},0)}static mousePos(l,m){let v=l.getBoundingClientRect();return new n.P(m.clientX-v.left-l.clientLeft,m.clientY-v.top-l.clientTop)}static touchPos(l,m){let v=l.getBoundingClientRect(),S=[];for(let C=0;C<m.length;C++)S.push(new n.P(m[C].clientX-v.left-l.clientLeft,m[C].clientY-v.top-l.clientTop));return S}static mouseButton(l){return l.button}static remove(l){l.parentNode&&l.parentNode.removeChild(l)}}c.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,c.selectProp=c.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),c.transformProp=c.testProp(["transform","WebkitTransform"]);let f={supported:!1,testSupport:function(M){!E&&x&&(T?D(M):p=M)}},p,x,E=!1,T=!1;function D(M){let l=M.createTexture();M.bindTexture(M.TEXTURE_2D,l);try{if(M.texImage2D(M.TEXTURE_2D,0,M.RGBA,M.RGBA,M.UNSIGNED_BYTE,x),M.isContextLost())return;f.supported=!0}catch{}M.deleteTexture(l),E=!0}var N,z;typeof document<"u"&&(x=document.createElement("img"),x.onload=function(){p&&D(p),p=null,T=!0},x.onerror=function(){E=!0,p=null},x.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(M){let l,m,v,S;M.resetRequestQueue=()=>{l=[],m=0,v=0,S={}},M.addThrottleControl=X=>{let J=v++;return S[J]=X,J},M.removeThrottleControl=X=>{delete S[X],V()},M.getImage=(X,J,tt=!0)=>{f.supported&&(X.headers||(X.headers={}),X.headers.accept="image/webp,*/*");let lt={requestParameters:X,supportImageRefresh:tt,callback:J,cancelled:!1,completed:!1,cancel:()=>{lt.completed||lt.cancelled||(lt.cancelled=!0,lt.innerRequest&&(lt.innerRequest.cancel(),m--),V())}};return l.push(lt),V(),lt};let C=X=>{let{requestParameters:J,supportImageRefresh:tt,callback:lt}=X;return n.e(J,{type:"image"}),(tt!==!1||n.i()||n.g(J.url)||J.headers&&!Object.keys(J.headers).reduce((bt,yt)=>bt&&yt==="accept",!0)?n.m:$)(J,(bt,yt,Ct,_t)=>{L(X,lt,bt,yt,Ct,_t)})},L=(X,J,tt,lt,bt,yt)=>{tt?J(tt):lt instanceof HTMLImageElement||n.a(lt)?J(null,lt):lt&&((Ct,_t)=>{typeof createImageBitmap=="function"?n.b(Ct,_t):n.d(Ct,_t)})(lt,(Ct,_t)=>{Ct!=null?J(Ct):_t!=null&&J(null,_t,{cacheControl:bt,expires:yt})}),X.cancelled||(X.completed=!0,m--,V())},V=()=>{let X=(()=>{let J=Object.keys(S),tt=!1;if(J.length>0){for(let lt of J)if(tt=S[lt](),tt)break}return tt})()?n.c.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:n.c.MAX_PARALLEL_IMAGE_REQUESTS;for(let J=m;J<X&&l.length>0;J++){let tt=l.shift();if(tt.cancelled){J--;continue}let lt=C(tt);m++,tt.innerRequest=lt}},$=(X,J)=>{let tt=new Image,lt=X.url,bt=!1,yt=X.credentials;return yt&&yt==="include"?tt.crossOrigin="use-credentials":(yt&&yt==="same-origin"||!n.s(lt))&&(tt.crossOrigin="anonymous"),tt.fetchPriority="high",tt.onload=()=>{J(null,tt),tt.onerror=tt.onload=null},tt.onerror=()=>{bt||J(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.")),tt.onerror=tt.onload=null},tt.src=lt,{cancel:()=>{bt=!0,tt.src=""}}}}(N||(N={})),N.resetRequestQueue(),function(M){M.Glyphs="Glyphs",M.Image="Image",M.Source="Source",M.SpriteImage="SpriteImage",M.SpriteJSON="SpriteJSON",M.Style="Style",M.Tile="Tile",M.Unknown="Unknown"}(z||(z={}));class U{constructor(l){this._transformRequestFn=l}transformRequest(l,m){return this._transformRequestFn&&this._transformRequestFn(l,m)||{url:l}}normalizeSpriteURL(l,m,v){let S=function(C){let L=C.match(H);if(!L)throw new Error(`Unable to parse URL "${C}"`);return{protocol:L[1],authority:L[2],path:L[3]||"/",params:L[4]?L[4].split("&"):[]}}(l);return S.path+=`${m}${v}`,function(C){let L=C.params.length?`?${C.params.join("&")}`:"";return`${C.protocol}://${C.authority}${C.path}${L}`}(S)}setTransformRequest(l){this._transformRequestFn=l}}let H=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function G(M){var l=new n.A(3);return l[0]=M[0],l[1]=M[1],l[2]=M[2],l}var Z,Y=function(M,l,m){return M[0]=l[0]-m[0],M[1]=l[1]-m[1],M[2]=l[2]-m[2],M};Z=new n.A(3),n.A!=Float32Array&&(Z[0]=0,Z[1]=0,Z[2]=0);var st=function(M){var l=M[0],m=M[1];return l*l+m*m};function at(M){let l=[];if(typeof M=="string")l.push({id:"default",url:M});else if(M&&M.length>0){let m=[];for(let{id:v,url:S}of M){let C=`${v}${S}`;m.indexOf(C)===-1&&(m.push(C),l.push({id:v,url:S}))}}return l}function Dt(M,l,m,v,S){if(v)return void M(v);if(S!==Object.values(l).length||S!==Object.values(m).length)return;let C={};for(let L in l){C[L]={};let V=n.h.getImageCanvasContext(m[L]),$=l[L];for(let X in $){let{width:J,height:tt,x:lt,y:bt,sdf:yt,pixelRatio:Ct,stretchX:_t,stretchY:Zt,content:ne}=$[X];C[L][X]={data:null,pixelRatio:Ct,sdf:yt,stretchX:_t,stretchY:Zt,content:ne,spriteData:{width:J,height:tt,x:lt,y:bt,context:V}}}}M(null,C)}(function(){var M=new n.A(2);n.A!=Float32Array&&(M[0]=0,M[1]=0)})();class Tt{constructor(l,m,v,S){this.context=l,this.format=v,this.texture=l.gl.createTexture(),this.update(m,S)}update(l,m,v){let{width:S,height:C}=l,L=!(this.size&&this.size[0]===S&&this.size[1]===C||v),{context:V}=this,{gl:$}=V;if(this.useMipmap=!!(m&&m.useMipmap),$.bindTexture($.TEXTURE_2D,this.texture),V.pixelStoreUnpackFlipY.set(!1),V.pixelStoreUnpack.set(1),V.pixelStoreUnpackPremultiplyAlpha.set(this.format===$.RGBA&&(!m||m.premultiply!==!1)),L)this.size=[S,C],l instanceof HTMLImageElement||l instanceof HTMLCanvasElement||l instanceof HTMLVideoElement||l instanceof ImageData||n.a(l)?$.texImage2D($.TEXTURE_2D,0,this.format,this.format,$.UNSIGNED_BYTE,l):$.texImage2D($.TEXTURE_2D,0,this.format,S,C,0,this.format,$.UNSIGNED_BYTE,l.data);else{let{x:X,y:J}=v||{x:0,y:0};l instanceof HTMLImageElement||l instanceof HTMLCanvasElement||l instanceof HTMLVideoElement||l instanceof ImageData||n.a(l)?$.texSubImage2D($.TEXTURE_2D,0,X,J,$.RGBA,$.UNSIGNED_BYTE,l):$.texSubImage2D($.TEXTURE_2D,0,X,J,S,C,$.RGBA,$.UNSIGNED_BYTE,l.data)}this.useMipmap&&this.isSizePowerOfTwo()&&$.generateMipmap($.TEXTURE_2D)}bind(l,m,v){let{context:S}=this,{gl:C}=S;C.bindTexture(C.TEXTURE_2D,this.texture),v!==C.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(v=C.LINEAR),l!==this.filter&&(C.texParameteri(C.TEXTURE_2D,C.TEXTURE_MAG_FILTER,l),C.texParameteri(C.TEXTURE_2D,C.TEXTURE_MIN_FILTER,v||l),this.filter=l),m!==this.wrap&&(C.texParameteri(C.TEXTURE_2D,C.TEXTURE_WRAP_S,m),C.texParameteri(C.TEXTURE_2D,C.TEXTURE_WRAP_T,m),this.wrap=m)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){let{gl:l}=this.context;l.deleteTexture(this.texture),this.texture=null}}function kt(M){let{userImage:l}=M;return!!(l&&l.render&&l.render())&&(M.data.replace(new Uint8Array(l.data.buffer)),!0)}class Et extends n.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new n.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(l){if(this.loaded!==l&&(this.loaded=l,l)){for(let{ids:m,callback:v}of this.requestors)this._notify(m,v);this.requestors=[]}}getImage(l){let m=this.images[l];if(m&&!m.data&&m.spriteData){let v=m.spriteData;m.data=new n.R({width:v.width,height:v.height},v.context.getImageData(v.x,v.y,v.width,v.height).data),m.spriteData=null}return m}addImage(l,m){if(this.images[l])throw new Error(`Image id ${l} already exist, use updateImage instead`);this._validate(l,m)&&(this.images[l]=m)}_validate(l,m){let v=!0,S=m.data||m.spriteData;return this._validateStretch(m.stretchX,S&&S.width)||(this.fire(new n.j(new Error(`Image "${l}" has invalid "stretchX" value`))),v=!1),this._validateStretch(m.stretchY,S&&S.height)||(this.fire(new n.j(new Error(`Image "${l}" has invalid "stretchY" value`))),v=!1),this._validateContent(m.content,m)||(this.fire(new n.j(new Error(`Image "${l}" has invalid "content" value`))),v=!1),v}_validateStretch(l,m){if(!l)return!0;let v=0;for(let S of l){if(S[0]<v||S[1]<S[0]||m<S[1])return!1;v=S[1]}return!0}_validateContent(l,m){if(!l)return!0;if(l.length!==4)return!1;let v=m.spriteData,S=v&&v.width||m.data.width,C=v&&v.height||m.data.height;return!(l[0]<0||S<l[0]||l[1]<0||C<l[1]||l[2]<0||S<l[2]||l[3]<0||C<l[3]||l[2]<l[0]||l[3]<l[1])}updateImage(l,m,v=!0){let S=this.getImage(l);if(v&&(S.data.width!==m.data.width||S.data.height!==m.data.height))throw new Error(`size mismatch between old image (${S.data.width}x${S.data.height}) and new image (${m.data.width}x${m.data.height}).`);m.version=S.version+1,this.images[l]=m,this.updatedImages[l]=!0}removeImage(l){let m=this.images[l];delete this.images[l],delete this.patterns[l],m.userImage&&m.userImage.onRemove&&m.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(l,m){let v=!0;if(!this.isLoaded())for(let S of l)this.images[S]||(v=!1);this.isLoaded()||v?this._notify(l,m):this.requestors.push({ids:l,callback:m})}_notify(l,m){let v={};for(let S of l){let C=this.getImage(S);C||(this.fire(new n.k("styleimagemissing",{id:S})),C=this.getImage(S)),C?v[S]={data:C.data.clone(),pixelRatio:C.pixelRatio,sdf:C.sdf,version:C.version,stretchX:C.stretchX,stretchY:C.stretchY,content:C.content,hasRenderCallback:!!(C.userImage&&C.userImage.render)}:n.w(`Image "${S}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}m(null,v)}getPixelSize(){let{width:l,height:m}=this.atlasImage;return{width:l,height:m}}getPattern(l){let m=this.patterns[l],v=this.getImage(l);if(!v)return null;if(m&&m.position.version===v.version)return m.position;if(m)m.position.version=v.version;else{let S={w:v.data.width+2,h:v.data.height+2,x:0,y:0},C=new n.I(S,v);this.patterns[l]={bin:S,position:C}}return this._updatePatternAtlas(),this.patterns[l].position}bind(l){let m=l.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new Tt(l,this.atlasImage,m.RGBA),this.atlasTexture.bind(m.LINEAR,m.CLAMP_TO_EDGE)}_updatePatternAtlas(){let l=[];for(let C in this.patterns)l.push(this.patterns[C].bin);let{w:m,h:v}=n.p(l),S=this.atlasImage;S.resize({width:m||1,height:v||1});for(let C in this.patterns){let{bin:L}=this.patterns[C],V=L.x+1,$=L.y+1,X=this.getImage(C).data,J=X.width,tt=X.height;n.R.copy(X,S,{x:0,y:0},{x:V,y:$},{width:J,height:tt}),n.R.copy(X,S,{x:0,y:tt-1},{x:V,y:$-1},{width:J,height:1}),n.R.copy(X,S,{x:0,y:0},{x:V,y:$+tt},{width:J,height:1}),n.R.copy(X,S,{x:J-1,y:0},{x:V-1,y:$},{width:1,height:tt}),n.R.copy(X,S,{x:0,y:0},{x:V+J,y:$},{width:1,height:tt})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(l){for(let m of l){if(this.callbackDispatchedThisFrame[m])continue;this.callbackDispatchedThisFrame[m]=!0;let v=this.getImage(m);v||n.w(`Image with ID: "${m}" was not found`),kt(v)&&this.updateImage(m,v)}}}let Mt=1e20;function oe(M,l,m,v,S,C,L,V,$){for(let X=l;X<l+v;X++)Xt(M,m*C+X,C,S,L,V,$);for(let X=m;X<m+S;X++)Xt(M,X*C+l,1,v,L,V,$)}function Xt(M,l,m,v,S,C,L){C[0]=0,L[0]=-Mt,L[1]=Mt,S[0]=M[l];for(let V=1,$=0,X=0;V<v;V++){S[V]=M[l+V*m];let J=V*V;do{let tt=C[$];X=(S[V]-S[tt]+J-tt*tt)/(V-tt)/2}while(X<=L[$]&&--$>-1);$++,C[$]=V,L[$]=X,L[$+1]=Mt}for(let V=0,$=0;V<v;V++){for(;L[$+1]<V;)$++;let X=C[$],J=V-X;M[l+V*m]=S[X]+J*J}}class xt{constructor(l,m){this.requestManager=l,this.localIdeographFontFamily=m,this.entries={}}setURL(l){this.url=l}getGlyphs(l,m){let v=[];for(let S in l)for(let C of l[S])v.push({stack:S,id:C});n.o(v,({stack:S,id:C},L)=>{let V=this.entries[S];V||(V=this.entries[S]={glyphs:{},requests:{},ranges:{}});let $=V.glyphs[C];if($!==void 0)return void L(null,{stack:S,id:C,glyph:$});if($=this._tinySDF(V,S,C),$)return V.glyphs[C]=$,void L(null,{stack:S,id:C,glyph:$});let X=Math.floor(C/256);if(256*X>65535)return void L(new Error("glyphs > 65535 not supported"));if(V.ranges[X])return void L(null,{stack:S,id:C,glyph:$});if(!this.url)return void L(new Error("glyphsUrl is not set"));let J=V.requests[X];J||(J=V.requests[X]=[],xt.loadGlyphRange(S,X,this.url,this.requestManager,(tt,lt)=>{if(lt){for(let bt in lt)this._doesCharSupportLocalGlyph(+bt)||(V.glyphs[+bt]=lt[+bt]);V.ranges[X]=!0}for(let bt of J)bt(tt,lt);delete V.requests[X]})),J.push((tt,lt)=>{tt?L(tt):lt&&L(null,{stack:S,id:C,glyph:lt[C]||null})})},(S,C)=>{if(S)m(S);else if(C){let L={};for(let{stack:V,id:$,glyph:X}of C)(L[V]||(L[V]={}))[$]=X&&{id:X.id,bitmap:X.bitmap.clone(),metrics:X.metrics};m(null,L)}})}_doesCharSupportLocalGlyph(l){return!!this.localIdeographFontFamily&&(n.u["CJK Unified Ideographs"](l)||n.u["Hangul Syllables"](l)||n.u.Hiragana(l)||n.u.Katakana(l))}_tinySDF(l,m,v){let S=this.localIdeographFontFamily;if(!S||!this._doesCharSupportLocalGlyph(v))return;let C=l.tinySDF;if(!C){let V="400";/bold/i.test(m)?V="900":/medium/i.test(m)?V="500":/light/i.test(m)&&(V="200"),C=l.tinySDF=new xt.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:S,fontWeight:V})}let L=C.draw(String.fromCharCode(v));return{id:v,bitmap:new n.q({width:L.width||60,height:L.height||60},L.data),metrics:{width:L.glyphWidth/2||24,height:L.glyphHeight/2||24,left:L.glyphLeft/2+.5||0,top:L.glyphTop/2-27.5||-8,advance:L.glyphAdvance/2||24,isDoubleResolution:!0}}}}xt.loadGlyphRange=function(M,l,m,v,S){let C=256*l,L=C+255,V=v.transformRequest(m.replace("{fontstack}",M).replace("{range}",`${C}-${L}`),z.Glyphs);n.l(V,($,X)=>{if($)S($);else if(X){let J={};for(let tt of n.n(X))J[tt.id]=tt;S(null,J)}})},xt.TinySDF=class{constructor({fontSize:M=24,buffer:l=3,radius:m=8,cutoff:v=.25,fontFamily:S="sans-serif",fontWeight:C="normal",fontStyle:L="normal"}={}){this.buffer=l,this.cutoff=v,this.radius=m;let V=this.size=M+4*l,$=this._createCanvas(V),X=this.ctx=$.getContext("2d",{willReadFrequently:!0});X.font=`${L} ${C} ${M}px ${S}`,X.textBaseline="alphabetic",X.textAlign="left",X.fillStyle="black",this.gridOuter=new Float64Array(V*V),this.gridInner=new Float64Array(V*V),this.f=new Float64Array(V),this.z=new Float64Array(V+1),this.v=new Uint16Array(V)}_createCanvas(M){let l=document.createElement("canvas");return l.width=l.height=M,l}draw(M){let{width:l,actualBoundingBoxAscent:m,actualBoundingBoxDescent:v,actualBoundingBoxLeft:S,actualBoundingBoxRight:C}=this.ctx.measureText(M),L=Math.ceil(m),V=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(C-S))),$=Math.min(this.size-this.buffer,L+Math.ceil(v)),X=V+2*this.buffer,J=$+2*this.buffer,tt=Math.max(X*J,0),lt=new Uint8ClampedArray(tt),bt={data:lt,width:X,height:J,glyphWidth:V,glyphHeight:$,glyphTop:L,glyphLeft:0,glyphAdvance:l};if(V===0||$===0)return bt;let{ctx:yt,buffer:Ct,gridInner:_t,gridOuter:Zt}=this;yt.clearRect(Ct,Ct,V,$),yt.fillText(M,Ct,Ct+L);let ne=yt.getImageData(Ct,Ct,V,$);Zt.fill(Mt,0,tt),_t.fill(0,0,tt);for(let Ot=0;Ot<$;Ot++)for(let Gt=0;Gt<V;Gt++){let he=ne.data[4*(Ot*V+Gt)+3]/255;if(he===0)continue;let ce=(Ot+Ct)*X+Gt+Ct;if(he===1)Zt[ce]=0,_t[ce]=Mt;else{let xe=.5-he;Zt[ce]=xe>0?xe*xe:0,_t[ce]=xe<0?xe*xe:0}}oe(Zt,0,0,X,J,X,this.f,this.v,this.z),oe(_t,Ct,Ct,V,$,X,this.f,this.v,this.z);for(let Ot=0;Ot<tt;Ot++){let Gt=Math.sqrt(Zt[Ot])-Math.sqrt(_t[Ot]);lt[Ot]=Math.round(255-255*(Gt/this.radius+this.cutoff))}return bt}};class jt{constructor(){this.specification=n.v.light.position}possiblyEvaluate(l,m){return n.z(l.expression.evaluate(m))}interpolate(l,m,v){return{x:n.B.number(l.x,m.x,v),y:n.B.number(l.y,m.y,v),z:n.B.number(l.z,m.z,v)}}}let Wt;class de extends n.E{constructor(l){super(),Wt=Wt||new n.r({anchor:new n.D(n.v.light.anchor),position:new jt,color:new n.D(n.v.light.color),intensity:new n.D(n.v.light.intensity)}),this._transitionable=new n.T(Wt),this.setLight(l),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(l,m={}){if(!this._validate(n.t,l,m))for(let v in l){let S=l[v];v.endsWith("-transition")?this._transitionable.setTransition(v.slice(0,-11),S):this._transitionable.setValue(v,S)}}updateTransitions(l){this._transitioning=this._transitionable.transitioned(l,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(l){this.properties=this._transitioning.possiblyEvaluate(l)}_validate(l,m,v){return(!v||v.validate!==!1)&&n.x(this,l.call(n.y,n.e({value:m,style:{glyphs:!0,sprite:!0},styleSpec:n.v})))}}class Ee{constructor(l,m){this.width=l,this.height=m,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(l,m){let v=l.join(",")+String(m);return this.dashEntry[v]||(this.dashEntry[v]=this.addDash(l,m)),this.dashEntry[v]}getDashRanges(l,m,v){let S=[],C=l.length%2==1?-l[l.length-1]*v:0,L=l[0]*v,V=!0;S.push({left:C,right:L,isDash:V,zeroLength:l[0]===0});let $=l[0];for(let X=1;X<l.length;X++){V=!V;let J=l[X];C=$*v,$+=J,L=$*v,S.push({left:C,right:L,isDash:V,zeroLength:J===0})}return S}addRoundDash(l,m,v){let S=m/2;for(let C=-v;C<=v;C++){let L=this.width*(this.nextRow+v+C),V=0,$=l[V];for(let X=0;X<this.width;X++){X/$.right>1&&($=l[++V]);let J=Math.abs(X-$.left),tt=Math.abs(X-$.right),lt=Math.min(J,tt),bt,yt=C/v*(S+1);if($.isDash){let Ct=S-Math.abs(yt);bt=Math.sqrt(lt*lt+Ct*Ct)}else bt=S-Math.sqrt(lt*lt+yt*yt);this.data[L+X]=Math.max(0,Math.min(255,bt+128))}}}addRegularDash(l){for(let V=l.length-1;V>=0;--V){let $=l[V],X=l[V+1];$.zeroLength?l.splice(V,1):X&&X.isDash===$.isDash&&(X.left=$.left,l.splice(V,1))}let m=l[0],v=l[l.length-1];m.isDash===v.isDash&&(m.left=v.left-this.width,v.right=m.right+this.width);let S=this.width*this.nextRow,C=0,L=l[C];for(let V=0;V<this.width;V++){V/L.right>1&&(L=l[++C]);let $=Math.abs(V-L.left),X=Math.abs(V-L.right),J=Math.min($,X);this.data[S+V]=Math.max(0,Math.min(255,(L.isDash?J:-J)+128))}}addDash(l,m){let v=m?7:0,S=2*v+1;if(this.nextRow+S>this.height)return n.w("LineAtlas out of space"),null;let C=0;for(let V=0;V<l.length;V++)C+=l[V];if(C!==0){let V=this.width/C,$=this.getDashRanges(l,this.width,V);m?this.addRoundDash($,V,v):this.addRegularDash($)}let L={y:(this.nextRow+v+.5)/this.height,height:2*v/this.height,width:C};return this.nextRow+=S,this.dirty=!0,L}bind(l){let m=l.gl;this.texture?(m.bindTexture(m.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,m.texSubImage2D(m.TEXTURE_2D,0,0,0,this.width,this.height,m.ALPHA,m.UNSIGNED_BYTE,this.data))):(this.texture=m.createTexture(),m.bindTexture(m.TEXTURE_2D,this.texture),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,m.REPEAT),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,m.REPEAT),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,m.LINEAR),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,m.LINEAR),m.texImage2D(m.TEXTURE_2D,0,m.ALPHA,this.width,this.height,0,m.ALPHA,m.UNSIGNED_BYTE,this.data))}}class Se{constructor(l,m,v){this.workerPool=l,this.actors=[],this.currentActor=0,this.id=v;let S=this.workerPool.acquire(v);for(let C=0;C<S.length;C++){let L=new n.C(S[C],m,v);L.name=`Worker ${C}`,this.actors.push(L)}if(!this.actors.length)throw new Error("No actors found")}broadcast(l,m,v){n.o(this.actors,(S,C)=>{S.send(l,m,C)},v=v||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(l=!0){this.actors.forEach(m=>{m.remove()}),this.actors=[],l&&this.workerPool.release(this.id)}}function ze(M,l,m){let v=function(S,C){if(S)return m(S);if(C){let L=n.F(n.e(C,M),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);C.vector_layers&&(L.vectorLayers=C.vector_layers,L.vectorLayerIds=L.vectorLayers.map(V=>V.id)),m(null,L)}};return M.url?n.f(l.transformRequest(M.url,z.Source),v):n.h.frame(()=>v(null,M))}class ke{constructor(l,m){l&&(m?this.setSouthWest(l).setNorthEast(m):Array.isArray(l)&&(l.length===4?this.setSouthWest([l[0],l[1]]).setNorthEast([l[2],l[3]]):this.setSouthWest(l[0]).setNorthEast(l[1])))}setNorthEast(l){return this._ne=l instanceof n.L?new n.L(l.lng,l.lat):n.L.convert(l),this}setSouthWest(l){return this._sw=l instanceof n.L?new n.L(l.lng,l.lat):n.L.convert(l),this}extend(l){let m=this._sw,v=this._ne,S,C;if(l instanceof n.L)S=l,C=l;else{if(!(l instanceof ke))return Array.isArray(l)?l.length===4||l.every(Array.isArray)?this.extend(ke.convert(l)):this.extend(n.L.convert(l)):l&&("lng"in l||"lon"in l)&&"lat"in l?this.extend(n.L.convert(l)):this;if(S=l._sw,C=l._ne,!S||!C)return this}return m||v?(m.lng=Math.min(S.lng,m.lng),m.lat=Math.min(S.lat,m.lat),v.lng=Math.max(C.lng,v.lng),v.lat=Math.max(C.lat,v.lat)):(this._sw=new n.L(S.lng,S.lat),this._ne=new n.L(C.lng,C.lat)),this}getCenter(){return new n.L((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new n.L(this.getWest(),this.getNorth())}getSouthEast(){return new n.L(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(l){let{lng:m,lat:v}=n.L.convert(l),S=this._sw.lng<=m&&m<=this._ne.lng;return this._sw.lng>this._ne.lng&&(S=this._sw.lng>=m&&m>=this._ne.lng),this._sw.lat<=v&&v<=this._ne.lat&&S}static convert(l){return l instanceof ke?l:l&&new ke(l)}static fromLngLat(l,m=0){let v=360*m/40075017,S=v/Math.cos(Math.PI/180*l.lat);return new ke(new n.L(l.lng-S,l.lat-v),new n.L(l.lng+S,l.lat+v))}}class ir{constructor(l,m,v){this.bounds=ke.convert(this.validateBounds(l)),this.minzoom=m||0,this.maxzoom=v||24}validateBounds(l){return Array.isArray(l)&&l.length===4?[Math.max(-180,l[0]),Math.max(-90,l[1]),Math.min(180,l[2]),Math.min(90,l[3])]:[-180,-90,180,90]}contains(l){let m=Math.pow(2,l.z),v=Math.floor(n.G(this.bounds.getWest())*m),S=Math.floor(n.H(this.bounds.getNorth())*m),C=Math.ceil(n.G(this.bounds.getEast())*m),L=Math.ceil(n.H(this.bounds.getSouth())*m);return l.x>=v&&l.x<C&&l.y>=S&&l.y<L}}class Ti extends n.E{constructor(l,m,v,S){if(super(),this.load=()=>{this._loaded=!1,this.fire(new n.k("dataloading",{dataType:"source"})),this._tileJSONRequest=ze(this._options,this.map._requestManager,(C,L)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),C?this.fire(new n.j(C)):L&&(n.e(this,L),L.bounds&&(this.tileBounds=new ir(L.bounds,this.minzoom,this.maxzoom)),this.fire(new n.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new n.k("data",{dataType:"source",sourceDataType:"content"})))})},this.serialize=()=>n.e({},this._options),this.id=l,this.dispatcher=v,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,n.e(this,n.F(m,["url","scheme","tileSize","promoteId"])),this._options=n.e({type:"vector"},m),this._collectResourceTiming=m.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(S)}loaded(){return this._loaded}hasTile(l){return!this.tileBounds||this.tileBounds.contains(l.canonical)}onAdd(l){this.map=l,this.load()}setSourceProperty(l){this._tileJSONRequest&&this._tileJSONRequest.cancel(),l(),this.load()}setTiles(l){return this.setSourceProperty(()=>{this._options.tiles=l}),this}setUrl(l){return this.setSourceProperty(()=>{this.url=l,this._options.url=l}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}loadTile(l,m){let v=l.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),S={request:this.map._requestManager.transformRequest(v,z.Tile),uid:l.uid,tileID:l.tileID,zoom:l.tileID.overscaledZ,tileSize:this.tileSize*l.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function C(L,V){return delete l.request,l.aborted?m(null):L&&L.status!==404?m(L):(V&&V.resourceTiming&&(l.resourceTiming=V.resourceTiming),this.map._refreshExpiredTiles&&V&&l.setExpiryData(V),l.loadVectorData(V,this.map.painter),m(null),void(l.reloadCallback&&(this.loadTile(l,l.reloadCallback),l.reloadCallback=null)))}S.request.collectResourceTiming=this._collectResourceTiming,l.actor&&l.state!=="expired"?l.state==="loading"?l.reloadCallback=m:l.request=l.actor.send("reloadTile",S,C.bind(this)):(l.actor=this.dispatcher.getActor(),l.request=l.actor.send("loadTile",S,C.bind(this)))}abortTile(l){l.request&&(l.request.cancel(),delete l.request),l.actor&&l.actor.send("abortTile",{uid:l.uid,type:this.type,source:this.id},void 0)}unloadTile(l){l.unloadVectorData(),l.actor&&l.actor.send("removeTile",{uid:l.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class _i extends n.E{constructor(l,m,v,S){super(),this.id=l,this.dispatcher=v,this.setEventedParent(S),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=n.e({type:"raster"},m),n.e(this,n.F(m,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new n.k("dataloading",{dataType:"source"})),this._tileJSONRequest=ze(this._options,this.map._requestManager,(l,m)=>{this._tileJSONRequest=null,this._loaded=!0,l?this.fire(new n.j(l)):m&&(n.e(this,m),m.bounds&&(this.tileBounds=new ir(m.bounds,this.minzoom,this.maxzoom)),this.fire(new n.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new n.k("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(l){this.map=l,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}setSourceProperty(l){this._tileJSONRequest&&this._tileJSONRequest.cancel(),l(),this.load()}setTiles(l){return this.setSourceProperty(()=>{this._options.tiles=l}),this}serialize(){return n.e({},this._options)}hasTile(l){return!this.tileBounds||this.tileBounds.contains(l.canonical)}loadTile(l,m){let v=l.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);l.request=N.getImage(this.map._requestManager.transformRequest(v,z.Tile),(S,C,L)=>{if(delete l.request,l.aborted)l.state="unloaded",m(null);else if(S)l.state="errored",m(S);else if(C){this.map._refreshExpiredTiles&&L&&l.setExpiryData(L);let V=this.map.painter.context,$=V.gl;l.texture=this.map.painter.getTileTexture(C.width),l.texture?l.texture.update(C,{useMipmap:!0}):(l.texture=new Tt(V,C,$.RGBA,{useMipmap:!0}),l.texture.bind($.LINEAR,$.CLAMP_TO_EDGE,$.LINEAR_MIPMAP_NEAREST),V.extTextureFilterAnisotropic&&$.texParameterf($.TEXTURE_2D,V.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,V.extTextureFilterAnisotropicMax)),l.state="loaded",m(null)}},this.map._refreshExpiredTiles)}abortTile(l,m){l.request&&(l.request.cancel(),delete l.request),m()}unloadTile(l,m){l.texture&&this.map.painter.saveTileTexture(l.texture),m()}hasTransition(){return!1}}class ci extends _i{constructor(l,m,v,S){super(l,m,v,S),this.type="raster-dem",this.maxzoom=22,this._options=n.e({type:"raster-dem"},m),this.encoding=m.encoding||"mapbox",this.redFactor=m.redFactor,this.greenFactor=m.greenFactor,this.blueFactor=m.blueFactor,this.baseShift=m.baseShift}loadTile(l,m){let v=l.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),S=this.map._requestManager.transformRequest(v,z.Tile);function C(L,V){L&&(l.state="errored",m(L)),V&&(l.dem=V,l.needsHillshadePrepare=!0,l.needsTerrainPrepare=!0,l.state="loaded",m(null))}l.neighboringTiles=this._getNeighboringTiles(l.tileID),l.request=N.getImage(S,(L,V,$)=>n._(this,void 0,void 0,function*(){if(delete l.request,l.aborted)l.state="unloaded",m(null);else if(L)l.state="errored",m(L);else if(V){this.map._refreshExpiredTiles&&l.setExpiryData($);let X=n.a(V)&&n.J()?V:yield function(tt){return n._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&n.K()){let lt=tt.width+2,bt=tt.height+2;try{return new n.R({width:lt,height:bt},yield n.M(tt,-1,-1,lt,bt))}catch{}}return n.h.getImageData(tt,1)})}(V),J={uid:l.uid,coord:l.tileID,source:this.id,rawImageData:X,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};l.actor&&l.state!=="expired"||(l.actor=this.dispatcher.getActor(),l.actor.send("loadDEMTile",J,C))}}),this.map._refreshExpiredTiles)}_getNeighboringTiles(l){let m=l.canonical,v=Math.pow(2,m.z),S=(m.x-1+v)%v,C=m.x===0?l.wrap-1:l.wrap,L=(m.x+1+v)%v,V=m.x+1===v?l.wrap+1:l.wrap,$={};return $[new n.O(l.overscaledZ,C,m.z,S,m.y).key]={backfilled:!1},$[new n.O(l.overscaledZ,V,m.z,L,m.y).key]={backfilled:!1},m.y>0&&($[new n.O(l.overscaledZ,C,m.z,S,m.y-1).key]={backfilled:!1},$[new n.O(l.overscaledZ,l.wrap,m.z,m.x,m.y-1).key]={backfilled:!1},$[new n.O(l.overscaledZ,V,m.z,L,m.y-1).key]={backfilled:!1}),m.y+1<v&&($[new n.O(l.overscaledZ,C,m.z,S,m.y+1).key]={backfilled:!1},$[new n.O(l.overscaledZ,l.wrap,m.z,m.x,m.y+1).key]={backfilled:!1},$[new n.O(l.overscaledZ,V,m.z,L,m.y+1).key]={backfilled:!1}),$}unloadTile(l){l.demTexture&&this.map.painter.saveTileTexture(l.demTexture),l.fbo&&(l.fbo.destroy(),delete l.fbo),l.dem&&delete l.dem,delete l.neighboringTiles,l.state="unloaded",l.actor&&l.actor.send("removeDEMTile",{uid:l.uid,source:this.id})}}class Gr extends n.E{constructor(l,m,v,S){super(),this.load=()=>{this._updateWorkerData()},this.serialize=()=>n.e({},this._options,{type:this.type,data:this._data}),this.id=l,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=v.getActor(),this.setEventedParent(S),this._data=m.data,this._options=n.e({},m),this._collectResourceTiming=m.collectResourceTiming,m.maxzoom!==void 0&&(this.maxzoom=m.maxzoom),m.type&&(this.type=m.type),m.attribution&&(this.attribution=m.attribution),this.promoteId=m.promoteId;let C=n.N/this.tileSize;this.workerOptions=n.e({source:this.id,cluster:m.cluster||!1,geojsonVtOptions:{buffer:(m.buffer!==void 0?m.buffer:128)*C,tolerance:(m.tolerance!==void 0?m.tolerance:.375)*C,extent:n.N,maxZoom:this.maxzoom,lineMetrics:m.lineMetrics||!1,generateId:m.generateId||!1},superclusterOptions:{maxZoom:m.clusterMaxZoom!==void 0?m.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,m.clusterMinPoints||2),extent:n.N,radius:(m.clusterRadius||50)*C,log:!1,generateId:m.generateId||!1},clusterProperties:m.clusterProperties,filter:m.filter},m.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}onAdd(l){this.map=l,this.load()}setData(l){return this._data=l,this._updateWorkerData(),this}updateData(l){return this._updateWorkerData(l),this}setClusterOptions(l){return this.workerOptions.cluster=l.cluster,l&&(l.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=l.clusterRadius),l.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=l.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(l,m){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:l,source:this.id},m),this}getClusterChildren(l,m){return this.actor.send("geojson.getClusterChildren",{clusterId:l,source:this.id},m),this}getClusterLeaves(l,m,v,S){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:l,limit:m,offset:v},S),this}_updateWorkerData(l){let m=n.e({},this.workerOptions);l?m.dataDiff=l:typeof this._data=="string"?(m.request=this.map._requestManager.transformRequest(n.h.resolveURL(this._data),z.Source),m.request.collectResourceTiming=this._collectResourceTiming):m.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new n.k("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,m,(v,S)=>{if(this._pendingLoads--,this._removed||S&&S.abandoned)return void this.fire(new n.k("dataabort",{dataType:"source"}));let C=null;if(S&&S.resourceTiming&&S.resourceTiming[this.id]&&(C=S.resourceTiming[this.id].slice(0)),v)return void this.fire(new n.j(v));let L={dataType:"source"};this._collectResourceTiming&&C&&C.length>0&&n.e(L,{resourceTiming:C}),this.fire(new n.k("data",Object.assign(Object.assign({},L),{sourceDataType:"metadata"}))),this.fire(new n.k("data",Object.assign(Object.assign({},L),{sourceDataType:"content"})))})}loaded(){return this._pendingLoads===0}loadTile(l,m){let v=l.actor?"reloadTile":"loadTile";l.actor=this.actor;let S={type:this.type,uid:l.uid,tileID:l.tileID,zoom:l.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};l.request=this.actor.send(v,S,(C,L)=>(delete l.request,l.unloadVectorData(),l.aborted?m(null):C?m(C):(l.loadVectorData(L,this.map.painter,v==="reloadTile"),m(null))))}abortTile(l){l.request&&(l.request.cancel(),delete l.request),l.aborted=!0}unloadTile(l){l.unloadVectorData(),this.actor.send("removeTile",{uid:l.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}hasTransition(){return!1}}var Fr=n.Q([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Dr extends n.E{constructor(l,m,v,S){super(),this.load=(C,L)=>{this._loaded=!1,this.fire(new n.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=N.getImage(this.map._requestManager.transformRequest(this.url,z.Image),(V,$)=>{this._request=null,this._loaded=!0,V?this.fire(new n.j(V)):$&&(this.image=$,C&&(this.coordinates=C),L&&L(),this._finishLoading())})},this.prepare=()=>{if(Object.keys(this.tiles).length===0||!this.image)return;let C=this.map.painter.context,L=C.gl;this.boundsBuffer||(this.boundsBuffer=C.createVertexBuffer(this._boundsArray,Fr.members)),this.boundsSegments||(this.boundsSegments=n.S.simpleSegment(0,0,4,2)),this.texture||(this.texture=new Tt(C,this.image,L.RGBA),this.texture.bind(L.LINEAR,L.CLAMP_TO_EDGE));let V=!1;for(let $ in this.tiles){let X=this.tiles[$];X.state!=="loaded"&&(X.state="loaded",X.texture=this.texture,V=!0)}V&&this.fire(new n.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"image",url:this.options.url,coordinates:this.coordinates}),this.id=l,this.dispatcher=v,this.coordinates=m.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(S),this.options=m}loaded(){return this._loaded}updateImage(l){return l.url?(this._request&&(this._request.cancel(),this._request=null),this.options.url=l.url,this.load(l.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new n.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(l){this.map=l,this.load()}onRemove(){this._request&&(this._request.cancel(),this._request=null)}setCoordinates(l){this.coordinates=l;let m=l.map(n.U.fromLngLat);this.tileID=function(S){let C=1/0,L=1/0,V=-1/0,$=-1/0;for(let lt of S)C=Math.min(C,lt.x),L=Math.min(L,lt.y),V=Math.max(V,lt.x),$=Math.max($,lt.y);let X=Math.max(V-C,$-L),J=Math.max(0,Math.floor(-Math.log(X)/Math.LN2)),tt=Math.pow(2,J);return new n.W(J,Math.floor((C+V)/2*tt),Math.floor((L+$)/2*tt))}(m),this.minzoom=this.maxzoom=this.tileID.z;let v=m.map(S=>this.tileID.getTilePoint(S)._round());return this._boundsArray=new n.V,this._boundsArray.emplaceBack(v[0].x,v[0].y,0,0),this._boundsArray.emplaceBack(v[1].x,v[1].y,n.N,0),this._boundsArray.emplaceBack(v[3].x,v[3].y,0,n.N),this._boundsArray.emplaceBack(v[2].x,v[2].y,n.N,n.N),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new n.k("data",{dataType:"source",sourceDataType:"content"})),this}loadTile(l,m){this.tileID&&this.tileID.equals(l.tileID.canonical)?(this.tiles[String(l.tileID.wrap)]=l,l.buckets={},m(null)):(l.state="errored",m(null))}hasTransition(){return!1}}class Le extends Dr{constructor(l,m,v,S){super(l,m,v,S),this.load=()=>{this._loaded=!1;let C=this.options;this.urls=[];for(let L of C.urls)this.urls.push(this.map._requestManager.transformRequest(L,z.Source).url);n.X(this.urls,(L,V)=>{this._loaded=!0,L?this.fire(new n.j(L)):V&&(this.video=V,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})},this.prepare=()=>{if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;let C=this.map.painter.context,L=C.gl;this.boundsBuffer||(this.boundsBuffer=C.createVertexBuffer(this._boundsArray,Fr.members)),this.boundsSegments||(this.boundsSegments=n.S.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(L.LINEAR,L.CLAMP_TO_EDGE),L.texSubImage2D(L.TEXTURE_2D,0,0,0,L.RGBA,L.UNSIGNED_BYTE,this.video)):(this.texture=new Tt(C,this.video,L.RGBA),this.texture.bind(L.LINEAR,L.CLAMP_TO_EDGE));let V=!1;for(let $ in this.tiles){let X=this.tiles[$];X.state!=="loaded"&&(X.state="loaded",X.texture=this.texture,V=!0)}V&&this.fire(new n.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"video",urls:this.urls,coordinates:this.coordinates}),this.roundZoom=!0,this.type="video",this.options=m}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(l){if(this.video){let m=this.video.seekable;l<m.start(0)||l>m.end(0)?this.fire(new n.j(new n.Y(`sources.${this.id}`,null,`Playback for this video can be set only between the ${m.start(0)} and ${m.end(0)}-second mark.`))):this.video.currentTime=l}}getVideo(){return this.video}onAdd(l){this.map||(this.map=l,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}hasTransition(){return this.video&&!this.video.paused}}class Tr extends Dr{constructor(l,m,v,S){super(l,m,v,S),this.load=()=>{this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new n.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},this.prepare=()=>{let C=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,C=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,C=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;let L=this.map.painter.context,V=L.gl;this.boundsBuffer||(this.boundsBuffer=L.createVertexBuffer(this._boundsArray,Fr.members)),this.boundsSegments||(this.boundsSegments=n.S.simpleSegment(0,0,4,2)),this.texture?(C||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new Tt(L,this.canvas,V.RGBA,{premultiply:!0});let $=!1;for(let X in this.tiles){let J=this.tiles[X];J.state!=="loaded"&&(J.state="loaded",J.texture=this.texture,$=!0)}$&&this.fire(new n.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"canvas",coordinates:this.coordinates}),m.coordinates?Array.isArray(m.coordinates)&&m.coordinates.length===4&&!m.coordinates.some(C=>!Array.isArray(C)||C.length!==2||C.some(L=>typeof L!="number"))||this.fire(new n.j(new n.Y(`sources.${l}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new n.j(new n.Y(`sources.${l}`,null,'missing required property "coordinates"'))),m.animate&&typeof m.animate!="boolean"&&this.fire(new n.j(new n.Y(`sources.${l}`,null,'optional "animate" property must be a boolean value'))),m.canvas?typeof m.canvas=="string"||m.canvas instanceof HTMLCanvasElement||this.fire(new n.j(new n.Y(`sources.${l}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new n.j(new n.Y(`sources.${l}`,null,'missing required property "canvas"'))),this.options=m,this.animate=m.animate===void 0||m.animate}getCanvas(){return this.canvas}onAdd(l){this.map=l,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}hasTransition(){return this._playing}_hasInvalidDimensions(){for(let l of[this.canvas.width,this.canvas.height])if(isNaN(l)||l<=0)return!0;return!1}}let jr={},Ie=M=>{switch(M){case"geojson":return Gr;case"image":return Dr;case"raster":return _i;case"raster-dem":return ci;case"vector":return Ti;case"video":return Le;case"canvas":return Tr}return jr[M]};function Ji(M,l){let m=n.Z();return n.$(m,m,[1,1,0]),n.a0(m,m,[.5*M.width,.5*M.height,1]),n.a1(m,m,M.calculatePosMatrix(l.toUnwrapped()))}function yi(M,l,m,v,S,C){let L=function(tt,lt,bt){if(tt)for(let yt of tt){let Ct=lt[yt];if(Ct&&Ct.source===bt&&Ct.type==="fill-extrusion")return!0}else for(let yt in lt){let Ct=lt[yt];if(Ct.source===bt&&Ct.type==="fill-extrusion")return!0}return!1}(S&&S.layers,l,M.id),V=C.maxPitchScaleFactor(),$=M.tilesIn(v,V,L);$.sort(tn);let X=[];for(let tt of $)X.push({wrappedTileID:tt.tileID.wrapped().key,queryResults:tt.tile.queryRenderedFeatures(l,m,M._state,tt.queryGeometry,tt.cameraQueryGeometry,tt.scale,S,C,V,Ji(M.transform,tt.tileID))});let J=function(tt){let lt={},bt={};for(let yt of tt){let Ct=yt.queryResults,_t=yt.wrappedTileID,Zt=bt[_t]=bt[_t]||{};for(let ne in Ct){let Ot=Ct[ne],Gt=Zt[ne]=Zt[ne]||{},he=lt[ne]=lt[ne]||[];for(let ce of Ot)Gt[ce.featureIndex]||(Gt[ce.featureIndex]=!0,he.push(ce))}}return lt}(X);for(let tt in J)J[tt].forEach(lt=>{let bt=lt.feature,yt=M.getFeatureState(bt.layer["source-layer"],bt.id);bt.source=bt.layer.source,bt.layer["source-layer"]&&(bt.sourceLayer=bt.layer["source-layer"]),bt.state=yt});return J}function tn(M,l){let m=M.tileID,v=l.tileID;return m.overscaledZ-v.overscaledZ||m.canonical.y-v.canonical.y||m.wrap-v.wrap||m.canonical.x-v.canonical.x}class hn{constructor(l,m){this.timeAdded=0,this.fadeEndTime=0,this.tileID=l,this.uid=n.a2(),this.uses=0,this.tileSize=m,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(l){let m=l+this.timeAdded;m<this.fadeEndTime||(this.fadeEndTime=m)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(l){this.demTexture&&l.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(l,m,v){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",l){l.featureIndex&&(this.latestFeatureIndex=l.featureIndex,l.rawTileData?(this.latestRawTileData=l.rawTileData,this.latestFeatureIndex.rawTileData=l.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=l.collisionBoxArray,this.buckets=function(S,C){let L={};if(!C)return L;for(let V of S){let $=V.layerIds.map(X=>C.getLayer(X)).filter(Boolean);if($.length!==0){V.layers=$,V.stateDependentLayerIds&&(V.stateDependentLayers=V.stateDependentLayerIds.map(X=>$.filter(J=>J.id===X)[0]));for(let X of $)L[X.id]=V}}return L}(l.buckets,m.style),this.hasSymbolBuckets=!1;for(let S in this.buckets){let C=this.buckets[S];if(C instanceof n.a4){if(this.hasSymbolBuckets=!0,!v)break;C.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(let S in this.buckets){let C=this.buckets[S];if(C instanceof n.a4&&C.hasRTLText){this.hasRTLText=!0,n.a5();break}}this.queryPadding=0;for(let S in this.buckets){let C=this.buckets[S];this.queryPadding=Math.max(this.queryPadding,m.style.getLayer(S).queryRadius(C))}l.imageAtlas&&(this.imageAtlas=l.imageAtlas),l.glyphAtlasImage&&(this.glyphAtlasImage=l.glyphAtlasImage)}else this.collisionBoxArray=new n.a3}unloadVectorData(){for(let l in this.buckets)this.buckets[l].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(l){return this.buckets[l.id]}upload(l){for(let v in this.buckets){let S=this.buckets[v];S.uploadPending()&&S.upload(l)}let m=l.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Tt(l,this.imageAtlas.image,m.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Tt(l,this.glyphAtlasImage,m.ALPHA),this.glyphAtlasImage=null)}prepare(l){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(l,this.imageAtlasTexture)}queryRenderedFeatures(l,m,v,S,C,L,V,$,X,J){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:S,cameraQueryGeometry:C,scale:L,tileSize:this.tileSize,pixelPosMatrix:J,transform:$,params:V,queryPadding:this.queryPadding*X},l,m,v):{}}querySourceFeatures(l,m){let v=this.latestFeatureIndex;if(!v||!v.rawTileData)return;let S=v.loadVTLayers(),C=m&&m.sourceLayer?m.sourceLayer:"",L=S._geojsonTileLayer||S[C];if(!L)return;let V=n.a6(m&&m.filter),{z:$,x:X,y:J}=this.tileID.canonical,tt={z:$,x:X,y:J};for(let lt=0;lt<L.length;lt++){let bt=L.feature(lt);if(V.needGeometry){let _t=n.a7(bt,!0);if(!V.filter(new n.a8(this.tileID.overscaledZ),_t,this.tileID.canonical))continue}else if(!V.filter(new n.a8(this.tileID.overscaledZ),bt))continue;let yt=v.getId(bt,C),Ct=new n.a9(bt,$,X,J,yt);Ct.tile=tt,l.push(Ct)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(l){let m=this.expirationTime;if(l.cacheControl){let v=n.aa(l.cacheControl);v["max-age"]&&(this.expirationTime=Date.now()+1e3*v["max-age"])}else l.expires&&(this.expirationTime=new Date(l.expires).getTime());if(this.expirationTime){let v=Date.now(),S=!1;if(this.expirationTime>v)S=!1;else if(m)if(this.expirationTime<m)S=!0;else{let C=this.expirationTime-m;C?this.expirationTime=v+Math.max(C,3e4):S=!0}else S=!0;S?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(l,m){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(l).length===0)return;let v=this.latestFeatureIndex.loadVTLayers();for(let S in this.buckets){if(!m.style.hasLayer(S))continue;let C=this.buckets[S],L=C.layers[0].sourceLayer||"_geojsonTileLayer",V=v[L],$=l[L];if(!V||!$||Object.keys($).length===0)continue;C.update($,V,this.imageAtlas&&this.imageAtlas.patternPositions||{});let X=m&&m.style&&m.style.getLayer(S);X&&(this.queryPadding=Math.max(this.queryPadding,X.queryRadius(C)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<n.h.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(l){this.symbolFadeHoldUntil=n.h.now()+l}setDependencies(l,m){let v={};for(let S of m)v[S]=!0;this.dependencies[l]=v}hasDependency(l,m){for(let v of l){let S=this.dependencies[v];if(S){for(let C of m)if(S[C])return!0}}return!1}}class Sr{constructor(l,m){this.max=l,this.onRemove=m,this.reset()}reset(){for(let l in this.data)for(let m of this.data[l])m.timeout&&clearTimeout(m.timeout),this.onRemove(m.value);return this.data={},this.order=[],this}add(l,m,v){let S=l.wrapped().key;this.data[S]===void 0&&(this.data[S]=[]);let C={value:m,timeout:void 0};if(v!==void 0&&(C.timeout=setTimeout(()=>{this.remove(l,C)},v)),this.data[S].push(C),this.order.push(S),this.order.length>this.max){let L=this._getAndRemoveByKey(this.order[0]);L&&this.onRemove(L)}return this}has(l){return l.wrapped().key in this.data}getAndRemove(l){return this.has(l)?this._getAndRemoveByKey(l.wrapped().key):null}_getAndRemoveByKey(l){let m=this.data[l].shift();return m.timeout&&clearTimeout(m.timeout),this.data[l].length===0&&delete this.data[l],this.order.splice(this.order.indexOf(l),1),m.value}getByKey(l){let m=this.data[l];return m?m[0].value:null}get(l){return this.has(l)?this.data[l.wrapped().key][0].value:null}remove(l,m){if(!this.has(l))return this;let v=l.wrapped().key,S=m===void 0?0:this.data[v].indexOf(m),C=this.data[v][S];return this.data[v].splice(S,1),C.timeout&&clearTimeout(C.timeout),this.data[v].length===0&&delete this.data[v],this.onRemove(C.value),this.order.splice(this.order.indexOf(v),1),this}setMaxSize(l){for(this.max=l;this.order.length>this.max;){let m=this._getAndRemoveByKey(this.order[0]);m&&this.onRemove(m)}return this}filter(l){let m=[];for(let v in this.data)for(let S of this.data[v])l(S.value)||m.push(S);for(let v of m)this.remove(v.value.tileID,v)}}class ae{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(l,m,v){let S=String(m);if(this.stateChanges[l]=this.stateChanges[l]||{},this.stateChanges[l][S]=this.stateChanges[l][S]||{},n.e(this.stateChanges[l][S],v),this.deletedStates[l]===null){this.deletedStates[l]={};for(let C in this.state[l])C!==S&&(this.deletedStates[l][C]=null)}else if(this.deletedStates[l]&&this.deletedStates[l][S]===null){this.deletedStates[l][S]={};for(let C in this.state[l][S])v[C]||(this.deletedStates[l][S][C]=null)}else for(let C in v)this.deletedStates[l]&&this.deletedStates[l][S]&&this.deletedStates[l][S][C]===null&&delete this.deletedStates[l][S][C]}removeFeatureState(l,m,v){if(this.deletedStates[l]===null)return;let S=String(m);if(this.deletedStates[l]=this.deletedStates[l]||{},v&&m!==void 0)this.deletedStates[l][S]!==null&&(this.deletedStates[l][S]=this.deletedStates[l][S]||{},this.deletedStates[l][S][v]=null);else if(m!==void 0)if(this.stateChanges[l]&&this.stateChanges[l][S])for(v in this.deletedStates[l][S]={},this.stateChanges[l][S])this.deletedStates[l][S][v]=null;else this.deletedStates[l][S]=null;else this.deletedStates[l]=null}getState(l,m){let v=String(m),S=n.e({},(this.state[l]||{})[v],(this.stateChanges[l]||{})[v]);if(this.deletedStates[l]===null)return{};if(this.deletedStates[l]){let C=this.deletedStates[l][m];if(C===null)return{};for(let L in C)delete S[L]}return S}initializeTileState(l,m){l.setFeatureState(this.state,m)}coalesceChanges(l,m){let v={};for(let S in this.stateChanges){this.state[S]=this.state[S]||{};let C={};for(let L in this.stateChanges[S])this.state[S][L]||(this.state[S][L]={}),n.e(this.state[S][L],this.stateChanges[S][L]),C[L]=this.state[S][L];v[S]=C}for(let S in this.deletedStates){this.state[S]=this.state[S]||{};let C={};if(this.deletedStates[S]===null)for(let L in this.state[S])C[L]={},this.state[S][L]={};else for(let L in this.deletedStates[S]){if(this.deletedStates[S][L]===null)this.state[S][L]={};else for(let V of Object.keys(this.deletedStates[S][L]))delete this.state[S][L][V];C[L]=this.state[S][L]}v[S]=v[S]||{},n.e(v[S],C)}if(this.stateChanges={},this.deletedStates={},Object.keys(v).length!==0)for(let S in l)l[S].setFeatureState(v,m)}}class Xn extends n.E{constructor(l,m,v){super(),this.id=l,this.dispatcher=v,this.on("data",S=>{S.dataType==="source"&&S.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&S.dataType==="source"&&S.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((S,C,L,V)=>{let $=new(Ie(C.type))(S,C,L,V);if($.id!==S)throw new Error(`Expected Source id to be ${S} instead of ${$.id}`);return $})(l,m,v,this),this._tiles={},this._cache=new Sr(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new ae,this._didEmitContent=!1,this._updated=!1}onAdd(l){this.map=l,this._maxTileCacheSize=l?l._maxTileCacheSize:null,this._maxTileCacheZoomLevels=l?l._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(l)}onRemove(l){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(l)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(let l in this._tiles){let m=this._tiles[l];if(m.state!=="loaded"&&m.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;let l=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,l&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(l,m){return this._source.loadTile(l,m)}_unloadTile(l){if(this._source.unloadTile)return this._source.unloadTile(l,()=>{})}_abortTile(l){this._source.abortTile&&this._source.abortTile(l,()=>{}),this._source.fire(new n.k("dataabort",{tile:l,coord:l.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(l){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(let m in this._tiles){let v=this._tiles[m];v.upload(l),v.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(l=>l.tileID).sort(on).map(l=>l.key)}getRenderableIds(l){let m=[];for(let v in this._tiles)this._isIdRenderable(v,l)&&m.push(this._tiles[v]);return l?m.sort((v,S)=>{let C=v.tileID,L=S.tileID,V=new n.P(C.canonical.x,C.canonical.y)._rotate(this.transform.angle),$=new n.P(L.canonical.x,L.canonical.y)._rotate(this.transform.angle);return C.overscaledZ-L.overscaledZ||$.y-V.y||$.x-V.x}).map(v=>v.tileID.key):m.map(v=>v.tileID).sort(on).map(v=>v.key)}hasRenderableParent(l){let m=this.findLoadedParent(l,0);return!!m&&this._isIdRenderable(m.tileID.key)}_isIdRenderable(l,m){return this._tiles[l]&&this._tiles[l].hasData()&&!this._coveredTiles[l]&&(m||!this._tiles[l].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(let l in this._tiles)this._tiles[l].state!=="errored"&&this._reloadTile(l,"reloading")}}_reloadTile(l,m){let v=this._tiles[l];v&&(v.state!=="loading"&&(v.state=m),this._loadTile(v,this._tileLoaded.bind(this,v,l,m)))}_tileLoaded(l,m,v,S){if(S)return l.state="errored",void(S.status!==404?this._source.fire(new n.j(S,{tile:l})):this.update(this.transform,this.terrain));l.timeAdded=n.h.now(),v==="expired"&&(l.refreshedUponExpiration=!0),this._setTileReloadTimer(m,l),this.getSource().type==="raster-dem"&&l.dem&&this._backfillDEM(l),this._state.initializeTileState(l,this.map?this.map.painter:null),l.aborted||this._source.fire(new n.k("data",{dataType:"source",tile:l,coord:l.tileID}))}_backfillDEM(l){let m=this.getRenderableIds();for(let S=0;S<m.length;S++){let C=m[S];if(l.neighboringTiles&&l.neighboringTiles[C]){let L=this.getTileByID(C);v(l,L),v(L,l)}}function v(S,C){S.needsHillshadePrepare=!0,S.needsTerrainPrepare=!0;let L=C.tileID.canonical.x-S.tileID.canonical.x,V=C.tileID.canonical.y-S.tileID.canonical.y,$=Math.pow(2,S.tileID.canonical.z),X=C.tileID.key;L===0&&V===0||Math.abs(V)>1||(Math.abs(L)>1&&(Math.abs(L+$)===1?L+=$:Math.abs(L-$)===1&&(L-=$)),C.dem&&S.dem&&(S.dem.backfillBorder(C.dem,L,V),S.neighboringTiles&&S.neighboringTiles[X]&&(S.neighboringTiles[X].backfilled=!0)))}}getTile(l){return this.getTileByID(l.key)}getTileByID(l){return this._tiles[l]}_retainLoadedChildren(l,m,v,S){for(let C in this._tiles){let L=this._tiles[C];if(S[C]||!L.hasData()||L.tileID.overscaledZ<=m||L.tileID.overscaledZ>v)continue;let V=L.tileID;for(;L&&L.tileID.overscaledZ>m+1;){let X=L.tileID.scaledTo(L.tileID.overscaledZ-1);L=this._tiles[X.key],L&&L.hasData()&&(V=X)}let $=V;for(;$.overscaledZ>m;)if($=$.scaledTo($.overscaledZ-1),l[$.key]){S[V.key]=V;break}}}findLoadedParent(l,m){if(l.key in this._loadedParentTiles){let v=this._loadedParentTiles[l.key];return v&&v.tileID.overscaledZ>=m?v:null}for(let v=l.overscaledZ-1;v>=m;v--){let S=l.scaledTo(v),C=this._getLoadedTile(S);if(C)return C}}_getLoadedTile(l){let m=this._tiles[l.key];return m&&m.hasData()?m:this._cache.getByKey(l.wrapped().key)}updateCacheSize(l){let m=Math.ceil(l.width/this._source.tileSize)+1,v=Math.ceil(l.height/this._source.tileSize)+1,S=Math.floor(m*v*(this._maxTileCacheZoomLevels===null?n.c.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),C=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,S):S;this._cache.setMaxSize(C)}handleWrapJump(l){let m=Math.round((l-(this._prevLng===void 0?l:this._prevLng))/360);if(this._prevLng=l,m){let v={};for(let S in this._tiles){let C=this._tiles[S];C.tileID=C.tileID.unwrapTo(C.tileID.wrap+m),v[C.tileID.key]=C}this._tiles=v;for(let S in this._timers)clearTimeout(this._timers[S]),delete this._timers[S];for(let S in this._tiles)this._setTileReloadTimer(S,this._tiles[S])}}update(l,m){if(this.transform=l,this.terrain=m,!this._sourceLoaded||this._paused)return;let v;this.updateCacheSize(l),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?v=l.getVisibleUnwrappedCoordinates(this._source.tileID).map(J=>new n.O(J.canonical.z,J.wrap,J.canonical.z,J.canonical.x,J.canonical.y)):(v=l.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:m}),this._source.hasTile&&(v=v.filter(J=>this._source.hasTile(J)))):v=[];let S=l.coveringZoomLevel(this._source),C=Math.max(S-Xn.maxOverzooming,this._source.minzoom),L=Math.max(S+Xn.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){let J={};for(let tt of v)if(tt.canonical.z>this._source.minzoom){let lt=tt.scaledTo(tt.canonical.z-1);J[lt.key]=lt;let bt=tt.scaledTo(Math.max(this._source.minzoom,Math.min(tt.canonical.z,5)));J[bt.key]=bt}v=v.concat(Object.values(J))}let V=v.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,V&&this.fire(new n.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));let $=this._updateRetainedTiles(v,S);if(Qi(this._source.type)){let J={},tt={},lt=Object.keys($),bt=n.h.now();for(let yt of lt){let Ct=$[yt],_t=this._tiles[yt];if(!_t||_t.fadeEndTime!==0&&_t.fadeEndTime<=bt)continue;let Zt=this.findLoadedParent(Ct,C);Zt&&(this._addTile(Zt.tileID),J[Zt.tileID.key]=Zt.tileID),tt[yt]=Ct}this._retainLoadedChildren(tt,S,L,$);for(let yt in J)$[yt]||(this._coveredTiles[yt]=!0,$[yt]=J[yt]);if(m){let yt={},Ct={};for(let _t of v)this._tiles[_t.key].hasData()?yt[_t.key]=_t:Ct[_t.key]=_t;for(let _t in Ct){let Zt=Ct[_t].children(this._source.maxzoom);this._tiles[Zt[0].key]&&this._tiles[Zt[1].key]&&this._tiles[Zt[2].key]&&this._tiles[Zt[3].key]&&(yt[Zt[0].key]=$[Zt[0].key]=Zt[0],yt[Zt[1].key]=$[Zt[1].key]=Zt[1],yt[Zt[2].key]=$[Zt[2].key]=Zt[2],yt[Zt[3].key]=$[Zt[3].key]=Zt[3],delete Ct[_t])}for(let _t in Ct){let Zt=this.findLoadedParent(Ct[_t],this._source.minzoom);if(Zt){yt[Zt.tileID.key]=$[Zt.tileID.key]=Zt.tileID;for(let ne in yt)yt[ne].isChildOf(Zt.tileID)&&delete yt[ne]}}for(let _t in this._tiles)yt[_t]||(this._coveredTiles[_t]=!0)}}for(let J in $)this._tiles[J].clearFadeHold();let X=n.ab(this._tiles,$);for(let J of X){let tt=this._tiles[J];tt.hasSymbolBuckets&&!tt.holdingForFade()?tt.setHoldDuration(this.map._fadeDuration):tt.hasSymbolBuckets&&!tt.symbolFadeFinished()||this._removeTile(J)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(let l in this._tiles)this._tiles[l].holdingForFade()&&this._removeTile(l)}_updateRetainedTiles(l,m){let v={},S={},C=Math.max(m-Xn.maxOverzooming,this._source.minzoom),L=Math.max(m+Xn.maxUnderzooming,this._source.minzoom),V={};for(let $ of l){let X=this._addTile($);v[$.key]=$,X.hasData()||m<this._source.maxzoom&&(V[$.key]=$)}this._retainLoadedChildren(V,m,L,v);for(let $ of l){let X=this._tiles[$.key];if(X.hasData())continue;if(m+1>this._source.maxzoom){let tt=$.children(this._source.maxzoom)[0],lt=this.getTile(tt);if(lt&&lt.hasData()){v[tt.key]=tt;continue}}else{let tt=$.children(this._source.maxzoom);if(v[tt[0].key]&&v[tt[1].key]&&v[tt[2].key]&&v[tt[3].key])continue}let J=X.wasRequested();for(let tt=$.overscaledZ-1;tt>=C;--tt){let lt=$.scaledTo(tt);if(S[lt.key])break;if(S[lt.key]=!0,X=this.getTile(lt),!X&&J&&(X=this._addTile(lt)),X){let bt=X.hasData();if((J||bt)&&(v[lt.key]=lt),J=X.wasRequested(),bt)break}}}return v}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(let l in this._tiles){let m=[],v,S=this._tiles[l].tileID;for(;S.overscaledZ>0;){if(S.key in this._loadedParentTiles){v=this._loadedParentTiles[S.key];break}m.push(S.key);let C=S.scaledTo(S.overscaledZ-1);if(v=this._getLoadedTile(C),v)break;S=C}for(let C of m)this._loadedParentTiles[C]=v}}_addTile(l){let m=this._tiles[l.key];if(m)return m;m=this._cache.getAndRemove(l),m&&(this._setTileReloadTimer(l.key,m),m.tileID=l,this._state.initializeTileState(m,this.map?this.map.painter:null),this._cacheTimers[l.key]&&(clearTimeout(this._cacheTimers[l.key]),delete this._cacheTimers[l.key],this._setTileReloadTimer(l.key,m)));let v=m;return m||(m=new hn(l,this._source.tileSize*l.overscaleFactor()),this._loadTile(m,this._tileLoaded.bind(this,m,l.key,m.state))),m.uses++,this._tiles[l.key]=m,v||this._source.fire(new n.k("dataloading",{tile:m,coord:m.tileID,dataType:"source"})),m}_setTileReloadTimer(l,m){l in this._timers&&(clearTimeout(this._timers[l]),delete this._timers[l]);let v=m.getExpiryTimeout();v&&(this._timers[l]=setTimeout(()=>{this._reloadTile(l,"expired"),delete this._timers[l]},v))}_removeTile(l){let m=this._tiles[l];m&&(m.uses--,delete this._tiles[l],this._timers[l]&&(clearTimeout(this._timers[l]),delete this._timers[l]),m.uses>0||(m.hasData()&&m.state!=="reloading"?this._cache.add(m.tileID,m,m.getExpiryTimeout()):(m.aborted=!0,this._abortTile(m),this._unloadTile(m))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(let l in this._tiles)this._removeTile(l);this._cache.reset()}tilesIn(l,m,v){let S=[],C=this.transform;if(!C)return S;let L=v?C.getCameraQueryGeometry(l):l,V=l.map(yt=>C.pointCoordinate(yt,this.terrain)),$=L.map(yt=>C.pointCoordinate(yt,this.terrain)),X=this.getIds(),J=1/0,tt=1/0,lt=-1/0,bt=-1/0;for(let yt of $)J=Math.min(J,yt.x),tt=Math.min(tt,yt.y),lt=Math.max(lt,yt.x),bt=Math.max(bt,yt.y);for(let yt=0;yt<X.length;yt++){let Ct=this._tiles[X[yt]];if(Ct.holdingForFade())continue;let _t=Ct.tileID,Zt=Math.pow(2,C.zoom-Ct.tileID.overscaledZ),ne=m*Ct.queryPadding*n.N/Ct.tileSize/Zt,Ot=[_t.getTilePoint(new n.U(J,tt)),_t.getTilePoint(new n.U(lt,bt))];if(Ot[0].x-ne<n.N&&Ot[0].y-ne<n.N&&Ot[1].x+ne>=0&&Ot[1].y+ne>=0){let Gt=V.map(ce=>_t.getTilePoint(ce)),he=$.map(ce=>_t.getTilePoint(ce));S.push({tile:Ct,tileID:_t,queryGeometry:Gt,cameraQueryGeometry:he,scale:Zt})}}return S}getVisibleCoordinates(l){let m=this.getRenderableIds(l).map(v=>this._tiles[v].tileID);for(let v of m)v.posMatrix=this.transform.calculatePosMatrix(v.toUnwrapped());return m}hasTransition(){if(this._source.hasTransition())return!0;if(Qi(this._source.type)){let l=n.h.now();for(let m in this._tiles)if(this._tiles[m].fadeEndTime>=l)return!0}return!1}setFeatureState(l,m,v){this._state.updateState(l=l||"_geojsonTileLayer",m,v)}removeFeatureState(l,m,v){this._state.removeFeatureState(l=l||"_geojsonTileLayer",m,v)}getFeatureState(l,m){return this._state.getState(l=l||"_geojsonTileLayer",m)}setDependencies(l,m,v){let S=this._tiles[l];S&&S.setDependencies(m,v)}reloadTilesForDependencies(l,m){for(let v in this._tiles)this._tiles[v].hasDependency(l,m)&&this._reloadTile(v,"reloading");this._cache.filter(v=>!v.hasDependency(l,m))}}function on(M,l){let m=Math.abs(2*M.wrap)-+(M.wrap<0),v=Math.abs(2*l.wrap)-+(l.wrap<0);return M.overscaledZ-l.overscaledZ||v-m||l.canonical.y-M.canonical.y||l.canonical.x-M.canonical.x}function Qi(M){return M==="raster"||M==="image"||M==="video"}Xn.maxOverzooming=10,Xn.maxUnderzooming=3;let $i="mapboxgl_preloaded_worker_pool";class Ro{constructor(){this.active={}}acquire(l){if(!this.workers)for(this.workers=[];this.workers.length<Ro.workerCount;)this.workers.push(new Worker(n.c.WORKER_URL));return this.active[l]=!0,this.workers.slice()}release(l){delete this.active[l],this.numActive()===0&&(this.workers.forEach(m=>{m.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[$i]}numActive(){return Object.keys(this.active).length}}let pu=Math.floor(n.h.hardwareConcurrency/2),bl;function Uo(){return bl||(bl=new Ro),bl}Ro.workerCount=n.ac(globalThis)?Math.max(Math.min(pu,3),1):1;class vl{constructor(l,m){this.reset(l,m)}reset(l,m){this.points=l||[],this._distances=[0];for(let v=1;v<this.points.length;v++)this._distances[v]=this._distances[v-1]+this.points[v].dist(this.points[v-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(m||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(l){if(this.points.length===1)return this.points[0];l=n.ad(l,0,1);let m=1,v=this._distances[m],S=l*this.paddedLength+this.padding;for(;v<S&&m<this._distances.length;)v=this._distances[++m];let C=m-1,L=this._distances[C],V=v-L,$=V>0?(S-L)/V:0;return this.points[C].mult(1-$).add(this.points[m].mult($))}}function Xa(M,l){let m=!0;return M==="always"||M!=="never"&&l!=="never"||(m=!1),m}class Vo{constructor(l,m,v){let S=this.boxCells=[],C=this.circleCells=[];this.xCellCount=Math.ceil(l/v),this.yCellCount=Math.ceil(m/v);for(let L=0;L<this.xCellCount*this.yCellCount;L++)S.push([]),C.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=l,this.height=m,this.xScale=this.xCellCount/l,this.yScale=this.yCellCount/m,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(l,m,v,S,C){this._forEachCell(m,v,S,C,this._insertBoxCell,this.boxUid++),this.boxKeys.push(l),this.bboxes.push(m),this.bboxes.push(v),this.bboxes.push(S),this.bboxes.push(C)}insertCircle(l,m,v,S){this._forEachCell(m-S,v-S,m+S,v+S,this._insertCircleCell,this.circleUid++),this.circleKeys.push(l),this.circles.push(m),this.circles.push(v),this.circles.push(S)}_insertBoxCell(l,m,v,S,C,L){this.boxCells[C].push(L)}_insertCircleCell(l,m,v,S,C,L){this.circleCells[C].push(L)}_query(l,m,v,S,C,L,V){if(v<0||l>this.width||S<0||m>this.height)return[];let $=[];if(l<=0&&m<=0&&this.width<=v&&this.height<=S){if(C)return[{key:null,x1:l,y1:m,x2:v,y2:S}];for(let X=0;X<this.boxKeys.length;X++)$.push({key:this.boxKeys[X],x1:this.bboxes[4*X],y1:this.bboxes[4*X+1],x2:this.bboxes[4*X+2],y2:this.bboxes[4*X+3]});for(let X=0;X<this.circleKeys.length;X++){let J=this.circles[3*X],tt=this.circles[3*X+1],lt=this.circles[3*X+2];$.push({key:this.circleKeys[X],x1:J-lt,y1:tt-lt,x2:J+lt,y2:tt+lt})}}else this._forEachCell(l,m,v,S,this._queryCell,$,{hitTest:C,overlapMode:L,seenUids:{box:{},circle:{}}},V);return $}query(l,m,v,S){return this._query(l,m,v,S,!1,null)}hitTest(l,m,v,S,C,L){return this._query(l,m,v,S,!0,C,L).length>0}hitTestCircle(l,m,v,S,C){let L=l-v,V=l+v,$=m-v,X=m+v;if(V<0||L>this.width||X<0||$>this.height)return!1;let J=[];return this._forEachCell(L,$,V,X,this._queryCellCircle,J,{hitTest:!0,overlapMode:S,circle:{x:l,y:m,radius:v},seenUids:{box:{},circle:{}}},C),J.length>0}_queryCell(l,m,v,S,C,L,V,$){let{seenUids:X,hitTest:J,overlapMode:tt}=V,lt=this.boxCells[C];if(lt!==null){let yt=this.bboxes;for(let Ct of lt)if(!X.box[Ct]){X.box[Ct]=!0;let _t=4*Ct,Zt=this.boxKeys[Ct];if(l<=yt[_t+2]&&m<=yt[_t+3]&&v>=yt[_t+0]&&S>=yt[_t+1]&&(!$||$(Zt))&&(!J||!Xa(tt,Zt.overlapMode))&&(L.push({key:Zt,x1:yt[_t],y1:yt[_t+1],x2:yt[_t+2],y2:yt[_t+3]}),J))return!0}}let bt=this.circleCells[C];if(bt!==null){let yt=this.circles;for(let Ct of bt)if(!X.circle[Ct]){X.circle[Ct]=!0;let _t=3*Ct,Zt=this.circleKeys[Ct];if(this._circleAndRectCollide(yt[_t],yt[_t+1],yt[_t+2],l,m,v,S)&&(!$||$(Zt))&&(!J||!Xa(tt,Zt.overlapMode))){let ne=yt[_t],Ot=yt[_t+1],Gt=yt[_t+2];if(L.push({key:Zt,x1:ne-Gt,y1:Ot-Gt,x2:ne+Gt,y2:Ot+Gt}),J)return!0}}}return!1}_queryCellCircle(l,m,v,S,C,L,V,$){let{circle:X,seenUids:J,overlapMode:tt}=V,lt=this.boxCells[C];if(lt!==null){let yt=this.bboxes;for(let Ct of lt)if(!J.box[Ct]){J.box[Ct]=!0;let _t=4*Ct,Zt=this.boxKeys[Ct];if(this._circleAndRectCollide(X.x,X.y,X.radius,yt[_t+0],yt[_t+1],yt[_t+2],yt[_t+3])&&(!$||$(Zt))&&!Xa(tt,Zt.overlapMode))return L.push(!0),!0}}let bt=this.circleCells[C];if(bt!==null){let yt=this.circles;for(let Ct of bt)if(!J.circle[Ct]){J.circle[Ct]=!0;let _t=3*Ct,Zt=this.circleKeys[Ct];if(this._circlesCollide(yt[_t],yt[_t+1],yt[_t+2],X.x,X.y,X.radius)&&(!$||$(Zt))&&!Xa(tt,Zt.overlapMode))return L.push(!0),!0}}}_forEachCell(l,m,v,S,C,L,V,$){let X=this._convertToXCellCoord(l),J=this._convertToYCellCoord(m),tt=this._convertToXCellCoord(v),lt=this._convertToYCellCoord(S);for(let bt=X;bt<=tt;bt++)for(let yt=J;yt<=lt;yt++)if(C.call(this,l,m,v,S,this.xCellCount*yt+bt,L,V,$))return}_convertToXCellCoord(l){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(l*this.xScale)))}_convertToYCellCoord(l){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(l*this.yScale)))}_circlesCollide(l,m,v,S,C,L){let V=S-l,$=C-m,X=v+L;return X*X>V*V+$*$}_circleAndRectCollide(l,m,v,S,C,L,V){let $=(L-S)/2,X=Math.abs(l-(S+$));if(X>$+v)return!1;let J=(V-C)/2,tt=Math.abs(m-(C+J));if(tt>J+v)return!1;if(X<=$||tt<=J)return!0;let lt=X-$,bt=tt-J;return lt*lt+bt*bt<=v*v}}function Ne(M,l,m,v,S){let C=n.Z();return l?(n.a0(C,C,[1/S,1/S,1]),m||n.ae(C,C,v.angle)):n.a1(C,v.labelPlaneMatrix,M),C}function ta(M,l,m,v,S){if(l){let C=n.af(M);return n.a0(C,C,[S,S,1]),m||n.ae(C,C,-v.angle),C}return v.glCoordMatrix}function Zn(M,l,m){let v;m?(v=[M.x,M.y,m(M.x,M.y),1],n.ag(v,v,l)):(v=[M.x,M.y,0,1],Rt(v,v,l));let S=v[3];return{point:new n.P(v[0]/S,v[1]/S),signedDistanceFromCamera:S}}function Xl(M,l){return .5+M/l*.5}function Za(M,l){let m=M[0]/M[3],v=M[1]/M[3];return m>=-l[0]&&m<=l[0]&&v>=-l[1]&&v<=l[1]}function Ue(M,l,m,v,S,C,L,V,$,X){let J=v?M.textSizeData:M.iconSizeData,tt=n.ah(J,m.transform.zoom),lt=[256/m.width*2+1,256/m.height*2+1],bt=v?M.text.dynamicLayoutVertexArray:M.icon.dynamicLayoutVertexArray;bt.clear();let yt=M.lineVertexArray,Ct=v?M.text.placedSymbolArray:M.icon.placedSymbolArray,_t=m.transform.width/m.transform.height,Zt=!1;for(let ne=0;ne<Ct.length;ne++){let Ot=Ct.get(ne);if(Ot.hidden||Ot.writingMode===n.ai.vertical&&!Zt){At(Ot.numGlyphs,bt);continue}let Gt;if(Zt=!1,X?(Gt=[Ot.anchorX,Ot.anchorY,X(Ot.anchorX,Ot.anchorY),1],n.ag(Gt,Gt,l)):(Gt=[Ot.anchorX,Ot.anchorY,0,1],Rt(Gt,Gt,l)),!Za(Gt,lt)){At(Ot.numGlyphs,bt);continue}let he=Xl(m.transform.cameraToCenterDistance,Gt[3]),ce=n.aj(J,tt,Ot),xe=L?ce/he:ce*he,Pe=new n.P(Ot.anchorX,Ot.anchorY),Te=Zn(Pe,S,X).point,Fe={projections:{},offsets:{}},ur=Ao(Ot,xe,!1,V,l,S,C,M.glyphOffsetArray,yt,bt,Te,Pe,Fe,_t,$,X);Zt=ur.useVertical,(ur.notEnoughRoom||Zt||ur.needsFlipping&&Ao(Ot,xe,!0,V,l,S,C,M.glyphOffsetArray,yt,bt,Te,Pe,Fe,_t,$,X).notEnoughRoom)&&At(Ot.numGlyphs,bt)}v?M.text.dynamicLayoutVertexBuffer.updateData(bt):M.icon.dynamicLayoutVertexBuffer.updateData(bt)}function ri(M,l,m,v,S,C,L,V,$,X,J,tt,lt){let bt=V.glyphStartIndex+V.numGlyphs,yt=V.lineStartIndex,Ct=V.lineStartIndex+V.lineLength,_t=l.getoffsetX(V.glyphStartIndex),Zt=l.getoffsetX(bt-1),ne=rt(M*_t,m,v,S,C,L,V.segment,yt,Ct,$,X,J,tt,lt);if(!ne)return null;let Ot=rt(M*Zt,m,v,S,C,L,V.segment,yt,Ct,$,X,J,tt,lt);return Ot?{first:ne,last:Ot}:null}function Br(M,l,m,v){return M===n.ai.horizontal&&Math.abs(m.y-l.y)>Math.abs(m.x-l.x)*v?{useVertical:!0}:(M===n.ai.vertical?l.y<m.y:l.x>m.x)?{needsFlipping:!0}:null}function Ao(M,l,m,v,S,C,L,V,$,X,J,tt,lt,bt,yt,Ct){let _t=l/24,Zt=M.lineOffsetX*_t,ne=M.lineOffsetY*_t,Ot;if(M.numGlyphs>1){let Gt=M.glyphStartIndex+M.numGlyphs,he=M.lineStartIndex,ce=M.lineStartIndex+M.lineLength,xe=ri(_t,V,Zt,ne,m,J,tt,M,$,C,lt,yt,Ct);if(!xe)return{notEnoughRoom:!0};let Pe=Zn(xe.first.point,L,Ct).point,Te=Zn(xe.last.point,L,Ct).point;if(v&&!m){let Fe=Br(M.writingMode,Pe,Te,bt);if(Fe)return Fe}Ot=[xe.first];for(let Fe=M.glyphStartIndex+1;Fe<Gt-1;Fe++)Ot.push(rt(_t*V.getoffsetX(Fe),Zt,ne,m,J,tt,M.segment,he,ce,$,C,lt,yt,Ct));Ot.push(xe.last)}else{if(v&&!m){let he=Zn(tt,S,Ct).point,ce=M.lineStartIndex+M.segment+1,xe=new n.P($.getx(ce),$.gety(ce)),Pe=Zn(xe,S,Ct),Te=Pe.signedDistanceFromCamera>0?Pe.point:Ga(tt,xe,he,1,S,Ct),Fe=Br(M.writingMode,he,Te,bt);if(Fe)return Fe}let Gt=rt(_t*V.getoffsetX(M.glyphStartIndex),Zt,ne,m,J,tt,M.segment,M.lineStartIndex,M.lineStartIndex+M.lineLength,$,C,lt,yt,Ct);if(!Gt)return{notEnoughRoom:!0};Ot=[Gt]}for(let Gt of Ot)n.ak(X,Gt.point,Gt.angle);return{}}function Ga(M,l,m,v,S,C){let L=Zn(M.add(M.sub(l)._unit()),S,C).point,V=m.sub(L);return m.add(V._mult(v/V.mag()))}function Hr(M,l){let{projectionCache:m,lineVertexArray:v,labelPlaneMatrix:S,tileAnchorPoint:C,distanceFromAnchor:L,getElevation:V,previousVertex:$,direction:X,absOffsetX:J}=l;if(m.projections[M])return m.projections[M];let tt=new n.P(v.getx(M),v.gety(M)),lt=Zn(tt,S,V);if(lt.signedDistanceFromCamera>0)return m.projections[M]=lt.point,lt.point;let bt=M-X;return Ga(L===0?C:new n.P(v.getx(bt),v.gety(bt)),tt,$,J-L+1,S,V)}function ba(M,l,m){return M._unit()._perp()._mult(l*m)}function It(M,l,m,v,S,C,L,V){let{projectionCache:$,direction:X}=V;if($.offsets[M])return $.offsets[M];let J=m.add(l);if(M+X<v||M+X>=S)return $.offsets[M]=J,J;let tt=Hr(M+X,V),lt=ba(tt.sub(m),L,X),bt=m.add(lt),yt=tt.add(lt);return $.offsets[M]=n.al(C,J,bt,yt)||J,$.offsets[M]}function rt(M,l,m,v,S,C,L,V,$,X,J,tt,lt,bt){let yt=v?M-l:M+l,Ct=yt>0?1:-1,_t=0;v&&(Ct*=-1,_t=Math.PI),Ct<0&&(_t+=Math.PI);let Zt,ne,Ot=Ct>0?V+L:V+L+1,Gt=S,he=S,ce=0,xe=0,Pe=Math.abs(yt),Te=[],Fe;for(;ce+xe<=Pe;){if(Ot+=Ct,Ot<V||Ot>=$)return null;ce+=xe,he=Gt,ne=Zt;let We={projectionCache:tt,lineVertexArray:X,labelPlaneMatrix:J,tileAnchorPoint:C,distanceFromAnchor:ce,getElevation:bt,previousVertex:he,direction:Ct,absOffsetX:Pe};if(Gt=Hr(Ot,We),m===0)Te.push(he),Fe=Gt.sub(he);else{let Ir,hr=Gt.sub(he);Ir=hr.mag()===0?ba(Hr(Ot+Ct,We).sub(Gt),m,Ct):ba(hr,m,Ct),ne||(ne=he.add(Ir)),Zt=It(Ot,Ir,Gt,V,$,ne,m,We),Te.push(ne),Fe=Zt.sub(ne)}xe=Fe.mag()}let ur=Fe._mult((Pe-ce)/xe)._add(ne||he),ki=_t+Math.atan2(Gt.y-he.y,Gt.x-he.x);return Te.push(ur),{point:ur,angle:lt?ki:0,path:Te}}let ot=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function At(M,l){for(let m=0;m<M;m++){let v=l.length;l.resize(v+4),l.float32.set(ot,3*v)}}function Rt(M,l,m){let v=l[0],S=l[1];return M[0]=m[0]*v+m[4]*S+m[12],M[1]=m[1]*v+m[5]*S+m[13],M[3]=m[3]*v+m[7]*S+m[15],M}let Bt=100;class St{constructor(l,m=new Vo(l.width+200,l.height+200,25),v=new Vo(l.width+200,l.height+200,25)){this.transform=l,this.grid=m,this.ignoredGrid=v,this.pitchfactor=Math.cos(l._pitch)*l.cameraToCenterDistance,this.screenRightBoundary=l.width+Bt,this.screenBottomBoundary=l.height+Bt,this.gridRightBoundary=l.width+200,this.gridBottomBoundary=l.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(l,m,v,S,C,L){let V=this.projectAndGetPerspectiveRatio(S,l.anchorPointX,l.anchorPointY,L),$=v*V.perspectiveRatio,X=l.x1*$+V.point.x,J=l.y1*$+V.point.y,tt=l.x2*$+V.point.x,lt=l.y2*$+V.point.y;return!this.isInsideGrid(X,J,tt,lt)||m!=="always"&&this.grid.hitTest(X,J,tt,lt,m,C)||V.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[X,J,tt,lt],offscreen:this.isOffscreen(X,J,tt,lt)}}placeCollisionCircles(l,m,v,S,C,L,V,$,X,J,tt,lt,bt,yt){let Ct=[],_t=new n.P(m.anchorX,m.anchorY),Zt=Zn(_t,L,yt),ne=Xl(this.transform.cameraToCenterDistance,Zt.signedDistanceFromCamera),Ot=(J?C/ne:C*ne)/n.ap,Gt=Zn(_t,V,yt).point,he=ri(Ot,S,m.lineOffsetX*Ot,m.lineOffsetY*Ot,!1,Gt,_t,m,v,V,{projections:{},offsets:{}},!1,yt),ce=!1,xe=!1,Pe=!0;if(he){let Te=.5*lt*ne+bt,Fe=new n.P(-100,-100),ur=new n.P(this.screenRightBoundary,this.screenBottomBoundary),ki=new vl,We=he.first,Ir=he.last,hr=[];for(let ui=We.path.length-1;ui>=1;ui--)hr.push(We.path[ui]);for(let ui=1;ui<Ir.path.length;ui++)hr.push(Ir.path[ui]);let pn=2.5*Te;if($){let ui=hr.map(Di=>Zn(Di,$,yt));hr=ui.some(Di=>Di.signedDistanceFromCamera<=0)?[]:ui.map(Di=>Di.point)}let Mi=[];if(hr.length>0){let ui=hr[0].clone(),Di=hr[0].clone();for(let bs=1;bs<hr.length;bs++)ui.x=Math.min(ui.x,hr[bs].x),ui.y=Math.min(ui.y,hr[bs].y),Di.x=Math.max(Di.x,hr[bs].x),Di.y=Math.max(Di.y,hr[bs].y);Mi=ui.x>=Fe.x&&Di.x<=ur.x&&ui.y>=Fe.y&&Di.y<=ur.y?[hr]:Di.x<Fe.x||ui.x>ur.x||Di.y<Fe.y||ui.y>ur.y?[]:n.am([hr],Fe.x,Fe.y,ur.x,ur.y)}for(let ui of Mi){ki.reset(ui,.25*Te);let Di=0;Di=ki.length<=.5*Te?1:Math.ceil(ki.paddedLength/pn)+1;for(let bs=0;bs<Di;bs++){let Ln=bs/Math.max(Di-1,1),go=ki.lerp(Ln),qs=go.x+Bt,vs=go.y+Bt;Ct.push(qs,vs,Te,0);let Ia=qs-Te,zn=vs-Te,io=qs+Te,Sl=vs+Te;if(Pe=Pe&&this.isOffscreen(Ia,zn,io,Sl),xe=xe||this.isInsideGrid(Ia,zn,io,Sl),l!=="always"&&this.grid.hitTestCircle(qs,vs,Te,l,tt)&&(ce=!0,!X))return{circles:[],offscreen:!1,collisionDetected:ce}}}}return{circles:!X&&ce||!xe||ne<this.perspectiveRatioCutoff?[]:Ct,offscreen:Pe,collisionDetected:ce}}queryRenderedSymbols(l){if(l.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};let m=[],v=1/0,S=1/0,C=-1/0,L=-1/0;for(let J of l){let tt=new n.P(J.x+Bt,J.y+Bt);v=Math.min(v,tt.x),S=Math.min(S,tt.y),C=Math.max(C,tt.x),L=Math.max(L,tt.y),m.push(tt)}let V=this.grid.query(v,S,C,L).concat(this.ignoredGrid.query(v,S,C,L)),$={},X={};for(let J of V){let tt=J.key;if($[tt.bucketInstanceId]===void 0&&($[tt.bucketInstanceId]={}),$[tt.bucketInstanceId][tt.featureIndex])continue;let lt=[new n.P(J.x1,J.y1),new n.P(J.x2,J.y1),new n.P(J.x2,J.y2),new n.P(J.x1,J.y2)];n.an(m,lt)&&($[tt.bucketInstanceId][tt.featureIndex]=!0,X[tt.bucketInstanceId]===void 0&&(X[tt.bucketInstanceId]=[]),X[tt.bucketInstanceId].push(tt.featureIndex))}return X}insertCollisionBox(l,m,v,S,C,L){(v?this.ignoredGrid:this.grid).insert({bucketInstanceId:S,featureIndex:C,collisionGroupID:L,overlapMode:m},l[0],l[1],l[2],l[3])}insertCollisionCircles(l,m,v,S,C,L){let V=v?this.ignoredGrid:this.grid,$={bucketInstanceId:S,featureIndex:C,collisionGroupID:L,overlapMode:m};for(let X=0;X<l.length;X+=4)V.insertCircle($,l[X],l[X+1],l[X+2])}projectAndGetPerspectiveRatio(l,m,v,S){let C;return S?(C=[m,v,S(m,v),1],n.ag(C,C,l)):(C=[m,v,0,1],Rt(C,C,l)),{point:new n.P((C[0]/C[3]+1)/2*this.transform.width+Bt,(-C[1]/C[3]+1)/2*this.transform.height+Bt),perspectiveRatio:.5+this.transform.cameraToCenterDistance/C[3]*.5}}isOffscreen(l,m,v,S){return v<Bt||l>=this.screenRightBoundary||S<Bt||m>this.screenBottomBoundary}isInsideGrid(l,m,v,S){return v>=0&&l<this.gridRightBoundary&&S>=0&&m<this.gridBottomBoundary}getViewportMatrix(){let l=n.ao([]);return n.$(l,l,[-100,-100,0]),l}}function qt(M,l,m){return l*(n.N/(M.tileSize*Math.pow(2,m-M.tileID.overscaledZ)))}class Lt{constructor(l,m,v,S){this.opacity=l?Math.max(0,Math.min(1,l.opacity+(l.placed?m:-m))):S&&v?1:0,this.placed=v}isHidden(){return this.opacity===0&&!this.placed}}class Qt{constructor(l,m,v,S,C){this.text=new Lt(l?l.text:null,m,v,C),this.icon=new Lt(l?l.icon:null,m,S,C)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class _e{constructor(l,m,v){this.text=l,this.icon=m,this.skipFade=v}}class ye{constructor(){this.invProjMatrix=n.Z(),this.viewportMatrix=n.Z(),this.circles=[]}}class be{constructor(l,m,v,S,C){this.bucketInstanceId=l,this.featureIndex=m,this.sourceLayerIndex=v,this.bucketIndex=S,this.tileID=C}}class xr{constructor(l){this.crossSourceCollisions=l,this.maxGroupID=0,this.collisionGroups={}}get(l){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[l]){let m=++this.maxGroupID;this.collisionGroups[l]={ID:m,predicate:v=>v.collisionGroupID===m}}return this.collisionGroups[l]}}function Or(M,l,m,v,S){let{horizontalAlign:C,verticalAlign:L}=n.au(M);return new n.P(-(C-.5)*l+v[0]*S,-(L-.5)*m+v[1]*S)}function lr(M,l,m,v,S,C){let{x1:L,x2:V,y1:$,y2:X,anchorPointX:J,anchorPointY:tt}=M,lt=new n.P(l,m);return v&&lt._rotate(S?C:-C),{x1:L+lt.x,y1:$+lt.y,x2:V+lt.x,y2:X+lt.y,anchorPointX:J,anchorPointY:tt}}class br{constructor(l,m,v,S,C){this.transform=l.clone(),this.terrain=m,this.collisionIndex=new St(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=v,this.retainedQueryData={},this.collisionGroups=new xr(S),this.collisionCircleArrays={},this.prevPlacement=C,C&&(C.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(l,m,v,S){let C=v.getBucket(m),L=v.latestFeatureIndex;if(!C||!L||m.id!==C.layerIds[0])return;let V=v.collisionBoxArray,$=C.layers[0].layout,X=Math.pow(2,this.transform.zoom-v.tileID.overscaledZ),J=v.tileSize/n.N,tt=this.transform.calculatePosMatrix(v.tileID.toUnwrapped()),lt=$.get("text-pitch-alignment")==="map",bt=$.get("text-rotation-alignment")==="map",yt=qt(v,1,this.transform.zoom),Ct=Ne(tt,lt,bt,this.transform,yt),_t=null;if(lt){let ne=ta(tt,lt,bt,this.transform,yt);_t=n.a1([],this.transform.labelPlaneMatrix,ne)}this.retainedQueryData[C.bucketInstanceId]=new be(C.bucketInstanceId,L,C.sourceLayerIndex,C.index,v.tileID);let Zt={bucket:C,layout:$,posMatrix:tt,textLabelPlaneMatrix:Ct,labelToScreenMatrix:_t,scale:X,textPixelRatio:J,holdingForFade:v.holdingForFade(),collisionBoxArray:V,partiallyEvaluatedTextSize:n.ah(C.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(C.sourceID)};if(S)for(let ne of C.sortKeyRanges){let{sortKey:Ot,symbolInstanceStart:Gt,symbolInstanceEnd:he}=ne;l.push({sortKey:Ot,symbolInstanceStart:Gt,symbolInstanceEnd:he,parameters:Zt})}else l.push({symbolInstanceStart:0,symbolInstanceEnd:C.symbolInstances.length,parameters:Zt})}attemptAnchorPlacement(l,m,v,S,C,L,V,$,X,J,tt,lt,bt,yt,Ct,_t){let Zt=n.aq[l.textAnchor],ne=[l.textOffset0,l.textOffset1],Ot=Or(Zt,v,S,ne,C),Gt=this.collisionIndex.placeCollisionBox(lr(m,Ot.x,Ot.y,L,V,this.transform.angle),tt,$,X,J.predicate,_t);if((!Ct||this.collisionIndex.placeCollisionBox(lr(Ct,Ot.x,Ot.y,L,V,this.transform.angle),tt,$,X,J.predicate,_t).box.length!==0)&&Gt.box.length>0){let he;if(this.prevPlacement&&this.prevPlacement.variableOffsets[lt.crossTileID]&&this.prevPlacement.placements[lt.crossTileID]&&this.prevPlacement.placements[lt.crossTileID].text&&(he=this.prevPlacement.variableOffsets[lt.crossTileID].anchor),lt.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[lt.crossTileID]={textOffset:ne,width:v,height:S,anchor:Zt,textBoxScale:C,prevAnchor:he},this.markUsedJustification(bt,Zt,lt,yt),bt.allowVerticalPlacement&&(this.markUsedOrientation(bt,yt,lt),this.placedOrientations[lt.crossTileID]=yt),{shift:Ot,placedGlyphBoxes:Gt}}}placeLayerBucketPart(l,m,v){let{bucket:S,layout:C,posMatrix:L,textLabelPlaneMatrix:V,labelToScreenMatrix:$,textPixelRatio:X,holdingForFade:J,collisionBoxArray:tt,partiallyEvaluatedTextSize:lt,collisionGroup:bt}=l.parameters,yt=C.get("text-optional"),Ct=C.get("icon-optional"),_t=n.ar(C,"text-overlap","text-allow-overlap"),Zt=_t==="always",ne=n.ar(C,"icon-overlap","icon-allow-overlap"),Ot=ne==="always",Gt=C.get("text-rotation-alignment")==="map",he=C.get("text-pitch-alignment")==="map",ce=C.get("icon-text-fit")!=="none",xe=C.get("symbol-z-order")==="viewport-y",Pe=Zt&&(Ot||!S.hasIconData()||Ct),Te=Ot&&(Zt||!S.hasTextData()||yt);!S.collisionArrays&&tt&&S.deserializeCollisionBoxes(tt);let Fe=this.retainedQueryData[S.bucketInstanceId].tileID,ur=this.terrain?(We,Ir)=>this.terrain.getElevation(Fe,We,Ir):null,ki=(We,Ir)=>{var hr,pn;if(m[We.crossTileID])return;if(J)return void(this.placements[We.crossTileID]=new _e(!1,!1,!1));let Mi=!1,ui=!1,Di=!0,bs=null,Ln={box:null,offscreen:null},go={box:null,offscreen:null},qs=null,vs=null,Ia=null,zn=0,io=0,Sl=0;Ir.textFeatureIndex?zn=Ir.textFeatureIndex:We.useRuntimeCollisionCircles&&(zn=We.featureIndex),Ir.verticalTextFeatureIndex&&(io=Ir.verticalTextFeatureIndex);let bu=Ir.textBox;if(bu){let Do=us=>{let Ys=n.ai.horizontal;if(S.allowVerticalPlacement&&!us&&this.prevPlacement){let oa=this.prevPlacement.placedOrientations[We.crossTileID];oa&&(this.placedOrientations[We.crossTileID]=oa,Ys=oa,this.markUsedOrientation(S,Ys,We))}return Ys},_o=(us,Ys)=>{if(S.allowVerticalPlacement&&We.numVerticalGlyphVertices>0&&Ir.verticalTextBox){for(let oa of S.writingModes)if(oa===n.ai.vertical?(Ln=Ys(),go=Ln):Ln=us(),Ln&&Ln.box&&Ln.box.length)break}else Ln=us()},ws=We.textAnchorOffsetStartIndex,vu=We.textAnchorOffsetEndIndex;if(vu===ws){let us=(Ys,oa)=>{let Ts=this.collisionIndex.placeCollisionBox(Ys,_t,X,L,bt.predicate,ur);return Ts&&Ts.box&&Ts.box.length&&(this.markUsedOrientation(S,oa,We),this.placedOrientations[We.crossTileID]=oa),Ts};_o(()=>us(bu,n.ai.horizontal),()=>{let Ys=Ir.verticalTextBox;return S.allowVerticalPlacement&&We.numVerticalGlyphVertices>0&&Ys?us(Ys,n.ai.vertical):{box:null,offscreen:null}}),Do(Ln&&Ln.box&&Ln.box.length)}else{let us=n.aq[(pn=(hr=this.prevPlacement)===null||hr===void 0?void 0:hr.variableOffsets[We.crossTileID])===null||pn===void 0?void 0:pn.anchor],Ys=(Ts,Eh,Q0)=>{let Z_=Ts.x2-Ts.x1,G_=Ts.y2-Ts.y1,fb=We.textBoxScale,ng=ce&&ne==="never"?Eh:null,nc={box:[],offscreen:!1},Ih=_t==="never"?1:2,El="never";us&&Ih++;for(let Ma=0;Ma<Ih;Ma++){for(let In=ws;In<vu;In++){let sg=S.textAnchorOffsets.get(In);if(us&&sg.textAnchor!==us)continue;let jc=this.attemptAnchorPlacement(sg,Ts,Z_,G_,fb,Gt,he,X,L,bt,El,We,S,Q0,ng,ur);if(jc&&(nc=jc.placedGlyphBoxes,nc&&nc.box&&nc.box.length))return Mi=!0,bs=jc.shift,nc}us?us=null:El=_t}return nc};_o(()=>Ys(bu,Ir.iconBox,n.ai.horizontal),()=>{let Ts=Ir.verticalTextBox;return S.allowVerticalPlacement&&!(Ln&&Ln.box&&Ln.box.length)&&We.numVerticalGlyphVertices>0&&Ts?Ys(Ts,Ir.verticalIconBox,n.ai.vertical):{box:null,offscreen:null}}),Ln&&(Mi=Ln.box,Di=Ln.offscreen);let oa=Do(Ln&&Ln.box);if(!Mi&&this.prevPlacement){let Ts=this.prevPlacement.variableOffsets[We.crossTileID];Ts&&(this.variableOffsets[We.crossTileID]=Ts,this.markUsedJustification(S,Ts.anchor,We,oa))}}}if(qs=Ln,Mi=qs&&qs.box&&qs.box.length>0,Di=qs&&qs.offscreen,We.useRuntimeCollisionCircles){let Do=S.text.placedSymbolArray.get(We.centerJustifiedTextSymbolIndex),_o=n.aj(S.textSizeData,lt,Do),ws=C.get("text-padding");vs=this.collisionIndex.placeCollisionCircles(_t,Do,S.lineVertexArray,S.glyphOffsetArray,_o,L,V,$,v,he,bt.predicate,We.collisionCircleDiameter,ws,ur),vs.circles.length&&vs.collisionDetected&&!v&&n.w("Collisions detected, but collision boxes are not shown"),Mi=Zt||vs.circles.length>0&&!vs.collisionDetected,Di=Di&&vs.offscreen}if(Ir.iconFeatureIndex&&(Sl=Ir.iconFeatureIndex),Ir.iconBox){let Do=_o=>{let ws=ce&&bs?lr(_o,bs.x,bs.y,Gt,he,this.transform.angle):_o;return this.collisionIndex.placeCollisionBox(ws,ne,X,L,bt.predicate,ur)};go&&go.box&&go.box.length&&Ir.verticalIconBox?(Ia=Do(Ir.verticalIconBox),ui=Ia.box.length>0):(Ia=Do(Ir.iconBox),ui=Ia.box.length>0),Di=Di&&Ia.offscreen}let Sh=yt||We.numHorizontalGlyphVertices===0&&We.numVerticalGlyphVertices===0,Cf=Ct||We.numIconVertices===0;if(Sh||Cf?Cf?Sh||(ui=ui&&Mi):Mi=ui&&Mi:ui=Mi=ui&&Mi,Mi&&qs&&qs.box&&this.collisionIndex.insertCollisionBox(qs.box,_t,C.get("text-ignore-placement"),S.bucketInstanceId,go&&go.box&&io?io:zn,bt.ID),ui&&Ia&&this.collisionIndex.insertCollisionBox(Ia.box,ne,C.get("icon-ignore-placement"),S.bucketInstanceId,Sl,bt.ID),vs&&(Mi&&this.collisionIndex.insertCollisionCircles(vs.circles,_t,C.get("text-ignore-placement"),S.bucketInstanceId,zn,bt.ID),v)){let Do=S.bucketInstanceId,_o=this.collisionCircleArrays[Do];_o===void 0&&(_o=this.collisionCircleArrays[Do]=new ye);for(let ws=0;ws<vs.circles.length;ws+=4)_o.circles.push(vs.circles[ws+0]),_o.circles.push(vs.circles[ws+1]),_o.circles.push(vs.circles[ws+2]),_o.circles.push(vs.collisionDetected?1:0)}if(We.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(S.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[We.crossTileID]=new _e(Mi||Pe,ui||Te,Di||S.justReloaded),m[We.crossTileID]=!0};if(xe){if(l.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");let We=S.getSortedSymbolIndexes(this.transform.angle);for(let Ir=We.length-1;Ir>=0;--Ir){let hr=We[Ir];ki(S.symbolInstances.get(hr),S.collisionArrays[hr])}}else for(let We=l.symbolInstanceStart;We<l.symbolInstanceEnd;We++)ki(S.symbolInstances.get(We),S.collisionArrays[We]);if(v&&S.bucketInstanceId in this.collisionCircleArrays){let We=this.collisionCircleArrays[S.bucketInstanceId];n.as(We.invProjMatrix,L),We.viewportMatrix=this.collisionIndex.getViewportMatrix()}S.justReloaded=!1}markUsedJustification(l,m,v,S){let C;C=S===n.ai.vertical?v.verticalPlacedTextSymbolIndex:{left:v.leftJustifiedTextSymbolIndex,center:v.centerJustifiedTextSymbolIndex,right:v.rightJustifiedTextSymbolIndex}[n.at(m)];let L=[v.leftJustifiedTextSymbolIndex,v.centerJustifiedTextSymbolIndex,v.rightJustifiedTextSymbolIndex,v.verticalPlacedTextSymbolIndex];for(let V of L)V>=0&&(l.text.placedSymbolArray.get(V).crossTileID=C>=0&&V!==C?0:v.crossTileID)}markUsedOrientation(l,m,v){let S=m===n.ai.horizontal||m===n.ai.horizontalOnly?m:0,C=m===n.ai.vertical?m:0,L=[v.leftJustifiedTextSymbolIndex,v.centerJustifiedTextSymbolIndex,v.rightJustifiedTextSymbolIndex];for(let V of L)l.text.placedSymbolArray.get(V).placedOrientation=S;v.verticalPlacedTextSymbolIndex&&(l.text.placedSymbolArray.get(v.verticalPlacedTextSymbolIndex).placedOrientation=C)}commit(l){this.commitTime=l,this.zoomAtLastRecencyCheck=this.transform.zoom;let m=this.prevPlacement,v=!1;this.prevZoomAdjustment=m?m.zoomAdjustment(this.transform.zoom):0;let S=m?m.symbolFadeChange(l):1,C=m?m.opacities:{},L=m?m.variableOffsets:{},V=m?m.placedOrientations:{};for(let $ in this.placements){let X=this.placements[$],J=C[$];J?(this.opacities[$]=new Qt(J,S,X.text,X.icon),v=v||X.text!==J.text.placed||X.icon!==J.icon.placed):(this.opacities[$]=new Qt(null,S,X.text,X.icon,X.skipFade),v=v||X.text||X.icon)}for(let $ in C){let X=C[$];if(!this.opacities[$]){let J=new Qt(X,S,!1,!1);J.isHidden()||(this.opacities[$]=J,v=v||X.text.placed||X.icon.placed)}}for(let $ in L)this.variableOffsets[$]||!this.opacities[$]||this.opacities[$].isHidden()||(this.variableOffsets[$]=L[$]);for(let $ in V)this.placedOrientations[$]||!this.opacities[$]||this.opacities[$].isHidden()||(this.placedOrientations[$]=V[$]);if(m&&m.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");v?this.lastPlacementChangeTime=l:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=m?m.lastPlacementChangeTime:l)}updateLayerOpacities(l,m){let v={};for(let S of m){let C=S.getBucket(l);C&&S.latestFeatureIndex&&l.id===C.layerIds[0]&&this.updateBucketOpacities(C,v,S.collisionBoxArray)}}updateBucketOpacities(l,m,v){l.hasTextData()&&(l.text.opacityVertexArray.clear(),l.text.hasVisibleVertices=!1),l.hasIconData()&&(l.icon.opacityVertexArray.clear(),l.icon.hasVisibleVertices=!1),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexArray.clear(),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexArray.clear();let S=l.layers[0],C=S.layout,L=new Qt(null,0,!1,!1,!0),V=C.get("text-allow-overlap"),$=C.get("icon-allow-overlap"),X=S._unevaluatedLayout.hasValue("text-variable-anchor")||S._unevaluatedLayout.hasValue("text-variable-anchor-offset"),J=C.get("text-rotation-alignment")==="map",tt=C.get("text-pitch-alignment")==="map",lt=C.get("icon-text-fit")!=="none",bt=new Qt(null,0,V&&($||!l.hasIconData()||C.get("icon-optional")),$&&(V||!l.hasTextData()||C.get("text-optional")),!0);!l.collisionArrays&&v&&(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData())&&l.deserializeCollisionBoxes(v);let yt=(Ct,_t,Zt)=>{for(let ne=0;ne<_t/4;ne++)Ct.opacityVertexArray.emplaceBack(Zt);Ct.hasVisibleVertices=Ct.hasVisibleVertices||Zt!==va};for(let Ct=0;Ct<l.symbolInstances.length;Ct++){let _t=l.symbolInstances.get(Ct),{numHorizontalGlyphVertices:Zt,numVerticalGlyphVertices:ne,crossTileID:Ot}=_t,Gt=this.opacities[Ot];m[Ot]?Gt=L:Gt||(Gt=bt,this.opacities[Ot]=Gt),m[Ot]=!0;let he=_t.numIconVertices>0,ce=this.placedOrientations[_t.crossTileID],xe=ce===n.ai.vertical,Pe=ce===n.ai.horizontal||ce===n.ai.horizontalOnly;if(Zt>0||ne>0){let Te=Os(Gt.text);yt(l.text,Zt,xe?va:Te),yt(l.text,ne,Pe?va:Te);let Fe=Gt.text.isHidden();[_t.rightJustifiedTextSymbolIndex,_t.centerJustifiedTextSymbolIndex,_t.leftJustifiedTextSymbolIndex].forEach(We=>{We>=0&&(l.text.placedSymbolArray.get(We).hidden=Fe||xe?1:0)}),_t.verticalPlacedTextSymbolIndex>=0&&(l.text.placedSymbolArray.get(_t.verticalPlacedTextSymbolIndex).hidden=Fe||Pe?1:0);let ur=this.variableOffsets[_t.crossTileID];ur&&this.markUsedJustification(l,ur.anchor,_t,ce);let ki=this.placedOrientations[_t.crossTileID];ki&&(this.markUsedJustification(l,"left",_t,ki),this.markUsedOrientation(l,ki,_t))}if(he){let Te=Os(Gt.icon),Fe=!(lt&&_t.verticalPlacedIconSymbolIndex&&xe);_t.placedIconSymbolIndex>=0&&(yt(l.icon,_t.numIconVertices,Fe?Te:va),l.icon.placedSymbolArray.get(_t.placedIconSymbolIndex).hidden=Gt.icon.isHidden()),_t.verticalPlacedIconSymbolIndex>=0&&(yt(l.icon,_t.numVerticalIconVertices,Fe?va:Te),l.icon.placedSymbolArray.get(_t.verticalPlacedIconSymbolIndex).hidden=Gt.icon.isHidden())}if(l.hasIconCollisionBoxData()||l.hasTextCollisionBoxData()){let Te=l.collisionArrays[Ct];if(Te){let Fe=new n.P(0,0);if(Te.textBox||Te.verticalTextBox){let ki=!0;if(X){let We=this.variableOffsets[Ot];We?(Fe=Or(We.anchor,We.width,We.height,We.textOffset,We.textBoxScale),J&&Fe._rotate(tt?this.transform.angle:-this.transform.angle)):ki=!1}Te.textBox&&Ur(l.textCollisionBox.collisionVertexArray,Gt.text.placed,!ki||xe,Fe.x,Fe.y),Te.verticalTextBox&&Ur(l.textCollisionBox.collisionVertexArray,Gt.text.placed,!ki||Pe,Fe.x,Fe.y)}let ur=!!(!Pe&&Te.verticalIconBox);Te.iconBox&&Ur(l.iconCollisionBox.collisionVertexArray,Gt.icon.placed,ur,lt?Fe.x:0,lt?Fe.y:0),Te.verticalIconBox&&Ur(l.iconCollisionBox.collisionVertexArray,Gt.icon.placed,!ur,lt?Fe.x:0,lt?Fe.y:0)}}}if(l.sortFeatures(this.transform.angle),this.retainedQueryData[l.bucketInstanceId]&&(this.retainedQueryData[l.bucketInstanceId].featureSortOrder=l.featureSortOrder),l.hasTextData()&&l.text.opacityVertexBuffer&&l.text.opacityVertexBuffer.updateData(l.text.opacityVertexArray),l.hasIconData()&&l.icon.opacityVertexBuffer&&l.icon.opacityVertexBuffer.updateData(l.icon.opacityVertexArray),l.hasIconCollisionBoxData()&&l.iconCollisionBox.collisionVertexBuffer&&l.iconCollisionBox.collisionVertexBuffer.updateData(l.iconCollisionBox.collisionVertexArray),l.hasTextCollisionBoxData()&&l.textCollisionBox.collisionVertexBuffer&&l.textCollisionBox.collisionVertexBuffer.updateData(l.textCollisionBox.collisionVertexArray),l.text.opacityVertexArray.length!==l.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${l.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${l.text.layoutVertexArray.length}) / 4`);if(l.icon.opacityVertexArray.length!==l.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${l.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${l.icon.layoutVertexArray.length}) / 4`);if(l.bucketInstanceId in this.collisionCircleArrays){let Ct=this.collisionCircleArrays[l.bucketInstanceId];l.placementInvProjMatrix=Ct.invProjMatrix,l.placementViewportMatrix=Ct.viewportMatrix,l.collisionCircleArray=Ct.circles,delete this.collisionCircleArrays[l.bucketInstanceId]}}symbolFadeChange(l){return this.fadeDuration===0?1:(l-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(l){return Math.max(0,(this.transform.zoom-l)/1.5)}hasTransitions(l){return this.stale||l-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(l,m){let v=this.zoomAtLastRecencyCheck===m?1-this.zoomAdjustment(m):1;return this.zoomAtLastRecencyCheck=m,this.commitTime+this.fadeDuration*v>l}setStale(){this.stale=!0}}function Ur(M,l,m,v,S){M.emplaceBack(l?1:0,m?1:0,v||0,S||0),M.emplaceBack(l?1:0,m?1:0,v||0,S||0),M.emplaceBack(l?1:0,m?1:0,v||0,S||0),M.emplaceBack(l?1:0,m?1:0,v||0,S||0)}let an=Math.pow(2,25),gn=Math.pow(2,24),Ui=Math.pow(2,17),di=Math.pow(2,16),Is=Math.pow(2,9),fn=Math.pow(2,8),rs=Math.pow(2,1);function Os(M){if(M.opacity===0&&!M.placed)return 0;if(M.opacity===1&&M.placed)return 4294967295;let l=M.placed?1:0,m=Math.floor(127*M.opacity);return m*an+l*gn+m*Ui+l*di+m*Is+l*fn+m*rs+l}let va=0;class Pm{constructor(l){this._sortAcrossTiles=l.layout.get("symbol-z-order")!=="viewport-y"&&!l.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(l,m,v,S,C){let L=this._bucketParts;for(;this._currentTileIndex<l.length;)if(m.getBucketParts(L,S,l[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,C())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,L.sort((V,$)=>V.sortKey-$.sortKey));this._currentPartIndex<L.length;)if(m.placeLayerBucketPart(L[this._currentPartIndex],this._seenCrossTileIDs,v),this._currentPartIndex++,C())return!0;return!1}}class Zl{constructor(l,m,v,S,C,L,V,$){this.placement=new br(l,m,L,V,$),this._currentPlacementIndex=v.length-1,this._forceFullPlacement=S,this._showCollisionBoxes=C,this._done=!1}isDone(){return this._done}continuePlacement(l,m,v){let S=n.h.now(),C=()=>!this._forceFullPlacement&&n.h.now()-S>2;for(;this._currentPlacementIndex>=0;){let L=m[l[this._currentPlacementIndex]],V=this.placement.collisionIndex.transform.zoom;if(L.type==="symbol"&&(!L.minzoom||L.minzoom<=V)&&(!L.maxzoom||L.maxzoom>V)){if(this._inProgressLayer||(this._inProgressLayer=new Pm(L)),this._inProgressLayer.continuePlacement(v[L.source],this.placement,this._showCollisionBoxes,L,C))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(l){return this.placement.commit(l),this.placement}}let to=512/n.N/2;class _h{constructor(l,m,v){this.tileID=l,this.bucketInstanceId=v,this._symbolsByKey={};let S=new Map;for(let C=0;C<m.length;C++){let L=m.get(C),V=L.key,$=S.get(V);$?$.push(L):S.set(V,[L])}for(let[C,L]of S){let V={positions:L.map($=>({x:Math.floor($.anchorX*to),y:Math.floor($.anchorY*to)})),crossTileIDs:L.map($=>$.crossTileID)};if(V.positions.length>128){let $=new n.av(V.positions.length,16,Uint16Array);for(let{x:X,y:J}of V.positions)$.add(X,J);$.finish(),delete V.positions,V.index=$}this._symbolsByKey[C]=V}}getScaledCoordinates(l,m){let{x:v,y:S,z:C}=this.tileID.canonical,{x:L,y:V,z:$}=m.canonical,X=to/Math.pow(2,$-C),J=(V*n.N+l.anchorY)*X,tt=S*n.N*to;return{x:Math.floor((L*n.N+l.anchorX)*X-v*n.N*to),y:Math.floor(J-tt)}}findMatches(l,m,v){let S=this.tileID.canonical.z<m.canonical.z?1:Math.pow(2,this.tileID.canonical.z-m.canonical.z);for(let C=0;C<l.length;C++){let L=l.get(C);if(L.crossTileID)continue;let V=this._symbolsByKey[L.key];if(!V)continue;let $=this.getScaledCoordinates(L,m);if(V.index){let X=V.index.range($.x-S,$.y-S,$.x+S,$.y+S).sort();for(let J of X){let tt=V.crossTileIDs[J];if(!v[tt]){v[tt]=!0,L.crossTileID=tt;break}}}else if(V.positions)for(let X=0;X<V.positions.length;X++){let J=V.positions[X],tt=V.crossTileIDs[X];if(Math.abs(J.x-$.x)<=S&&Math.abs(J.y-$.y)<=S&&!v[tt]){v[tt]=!0,L.crossTileID=tt;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:l})=>l)}}class Hi{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Qa{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(l){let m=Math.round((l-this.lng)/360);if(m!==0)for(let v in this.indexes){let S=this.indexes[v],C={};for(let L in S){let V=S[L];V.tileID=V.tileID.unwrapTo(V.tileID.wrap+m),C[V.tileID.key]=V}this.indexes[v]=C}this.lng=l}addBucket(l,m,v){if(this.indexes[l.overscaledZ]&&this.indexes[l.overscaledZ][l.key]){if(this.indexes[l.overscaledZ][l.key].bucketInstanceId===m.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(l.overscaledZ,this.indexes[l.overscaledZ][l.key])}for(let C=0;C<m.symbolInstances.length;C++)m.symbolInstances.get(C).crossTileID=0;this.usedCrossTileIDs[l.overscaledZ]||(this.usedCrossTileIDs[l.overscaledZ]={});let S=this.usedCrossTileIDs[l.overscaledZ];for(let C in this.indexes){let L=this.indexes[C];if(Number(C)>l.overscaledZ)for(let V in L){let $=L[V];$.tileID.isChildOf(l)&&$.findMatches(m.symbolInstances,l,S)}else{let V=L[l.scaledTo(Number(C)).key];V&&V.findMatches(m.symbolInstances,l,S)}}for(let C=0;C<m.symbolInstances.length;C++){let L=m.symbolInstances.get(C);L.crossTileID||(L.crossTileID=v.generate(),S[L.crossTileID]=!0)}return this.indexes[l.overscaledZ]===void 0&&(this.indexes[l.overscaledZ]={}),this.indexes[l.overscaledZ][l.key]=new _h(l,m.symbolInstances,m.bucketInstanceId),!0}removeBucketCrossTileIDs(l,m){for(let v of m.getCrossTileIDsLists())for(let S of v)delete this.usedCrossTileIDs[l][S]}removeStaleBuckets(l){let m=!1;for(let v in this.indexes){let S=this.indexes[v];for(let C in S)l[S[C].bucketInstanceId]||(this.removeBucketCrossTileIDs(v,S[C]),delete S[C],m=!0)}return m}}class Dc{constructor(){this.layerIndexes={},this.crossTileIDs=new Hi,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(l,m,v){let S=this.layerIndexes[l.id];S===void 0&&(S=this.layerIndexes[l.id]=new Qa);let C=!1,L={};S.handleWrapJump(v);for(let V of m){let $=V.getBucket(l);$&&l.id===$.layerIds[0]&&($.bucketInstanceId||($.bucketInstanceId=++this.maxBucketInstanceId),S.addBucket(V.tileID,$,this.crossTileIDs)&&(C=!0),L[$.bucketInstanceId]=!0)}return S.removeStaleBuckets(L)&&(C=!0),C}pruneUnusedLayers(l){let m={};l.forEach(v=>{m[v]=!0});for(let v in this.layerIndexes)m[v]||delete this.layerIndexes[v]}}let $n=(M,l)=>n.x(M,l&&l.filter(m=>m.identifier!=="source.canvas")),_s=n.F(n.ax,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setGlyphs","setSprite"]),Rm=n.F(n.ax,["setCenter","setZoom","setBearing","setPitch"]),ea=n.aw();class Ms extends n.E{constructor(l,m={}){super(),this.map=l,this.dispatcher=new Se(Uo(),this,l._getMapId()),this.imageManager=new Et,this.imageManager.setEventedParent(this),this.glyphManager=new xt(l._requestManager,m.localIdeographFontFamily),this.lineAtlas=new Ee(256,512),this.crossTileSymbolIndex=new Dc,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new n.ay,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",n.az());let v=this;this._rtlTextPluginCallback=Ms.registerForPluginStateChange(S=>{v.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:S.pluginStatus,pluginURL:S.pluginURL},(C,L)=>{if(n.aA(C),L&&L.every(V=>V))for(let V in v.sourceCaches){let $=v.sourceCaches[V].getSource().type;$!=="vector"&&$!=="geojson"||v.sourceCaches[V].reload()}})}),this.on("data",S=>{if(S.dataType!=="source"||S.sourceDataType!=="metadata")return;let C=this.sourceCaches[S.sourceId];if(!C)return;let L=C.getSource();if(L&&L.vectorLayerIds)for(let V in this._layers){let $=this._layers[V];$.source===L.id&&this._validateLayer($)}})}loadURL(l,m={},v){this.fire(new n.k("dataloading",{dataType:"style"})),m.validate=typeof m.validate!="boolean"||m.validate;let S=this.map._requestManager.transformRequest(l,z.Style);this._request=n.f(S,(C,L)=>{this._request=null,C?this.fire(new n.j(C)):L&&this._load(L,m,v)})}loadJSON(l,m={},v){this.fire(new n.k("dataloading",{dataType:"style"})),this._request=n.h.frame(()=>{this._request=null,m.validate=m.validate!==!1,this._load(l,m,v)})}loadEmpty(){this.fire(new n.k("dataloading",{dataType:"style"})),this._load(ea,{validate:!1})}_load(l,m,v){var S;let C=m.transformStyle?m.transformStyle(v,l):l;if(!m.validate||!$n(this,n.y(C))){this._loaded=!0,this.stylesheet=C;for(let L in C.sources)this.addSource(L,C.sources[L],{validate:!1});C.sprite?this._loadSprite(C.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(C.glyphs),this._createLayers(),this.light=new de(this.stylesheet.light),this.map.setTerrain((S=this.stylesheet.terrain)!==null&&S!==void 0?S:null),this.fire(new n.k("data",{dataType:"style"})),this.fire(new n.k("style.load"))}}_createLayers(){let l=n.aB(this.stylesheet.layers);this.dispatcher.broadcast("setLayers",l),this._order=l.map(m=>m.id),this._layers={},this._serializedLayers=null;for(let m of l){let v=n.aC(m);v.setEventedParent(this,{layer:{id:m.id}}),this._layers[m.id]=v}}_loadSprite(l,m=!1,v=void 0){this.imageManager.setLoaded(!1),this._spriteRequest=function(S,C,L,V){let $=at(S),X=$.length,J=L>1?"@2x":"",tt={},lt={},bt={};for(let{id:yt,url:Ct}of $){let _t=C.transformRequest(C.normalizeSpriteURL(Ct,J,".json"),z.SpriteJSON),Zt=`${yt}_${_t.url}`;tt[Zt]=n.f(_t,(Gt,he)=>{delete tt[Zt],lt[yt]=he,Dt(V,lt,bt,Gt,X)});let ne=C.transformRequest(C.normalizeSpriteURL(Ct,J,".png"),z.SpriteImage),Ot=`${yt}_${ne.url}`;tt[Ot]=N.getImage(ne,(Gt,he)=>{delete tt[Ot],bt[yt]=he,Dt(V,lt,bt,Gt,X)})}return{cancel(){for(let yt of Object.values(tt))yt.cancel()}}}(l,this.map._requestManager,this.map.getPixelRatio(),(S,C)=>{if(this._spriteRequest=null,S)this.fire(new n.j(S));else if(C)for(let L in C){this._spritesImagesIds[L]=[];let V=this._spritesImagesIds[L]?this._spritesImagesIds[L].filter($=>!($ in C)):[];for(let $ of V)this.imageManager.removeImage($),this._changedImages[$]=!0;for(let $ in C[L]){let X=L==="default"?$:`${L}:${$}`;this._spritesImagesIds[L].push(X),X in this.imageManager.images?this.imageManager.updateImage(X,C[L][$],!1):this.imageManager.addImage(X,C[L][$]),m&&(this._changedImages[X]=!0)}}this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),m&&(this._changed=!0),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new n.k("data",{dataType:"style"})),v&&v(S)})}_unloadSprite(){for(let l of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(l),this._changedImages[l]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new n.k("data",{dataType:"style"}))}_validateLayer(l){let m=this.sourceCaches[l.source];if(!m)return;let v=l.sourceLayer;if(!v)return;let S=m.getSource();(S.type==="geojson"||S.vectorLayerIds&&S.vectorLayerIds.indexOf(v)===-1)&&this.fire(new n.j(new Error(`Source layer "${v}" does not exist on source "${S.id}" as specified by style layer "${l.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(let l in this.sourceCaches)if(!this.sourceCaches[l].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(l){let m=this._serializedAllLayers();if(!l||l.length===0)return Object.values(m);let v=[];for(let S of l)m[S]&&v.push(m[S]);return v}_serializedAllLayers(){let l=this._serializedLayers;if(l)return l;l=this._serializedLayers={};let m=Object.keys(this._layers);for(let v of m){let S=this._layers[v];S.type!=="custom"&&(l[v]=S.serialize())}return l}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(let l in this.sourceCaches)if(this.sourceCaches[l].hasTransition())return!0;for(let l in this._layers)if(this._layers[l].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(l){if(!this._loaded)return;let m=this._changed;if(this._changed){let S=Object.keys(this._updatedLayers),C=Object.keys(this._removedLayers);(S.length||C.length)&&this._updateWorkerLayers(S,C);for(let L in this._updatedSources){let V=this._updatedSources[L];if(V==="reload")this._reloadSource(L);else{if(V!=="clear")throw new Error(`Invalid action ${V}`);this._clearSource(L)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(let L in this._updatedPaintProps)this._layers[L].updateTransitions(l);this.light.updateTransitions(l),this._resetUpdates()}let v={};for(let S in this.sourceCaches){let C=this.sourceCaches[S];v[S]=C.used,C.used=!1}for(let S of this._order){let C=this._layers[S];C.recalculate(l,this._availableImages),!C.isHidden(l.zoom)&&C.source&&(this.sourceCaches[C.source].used=!0)}for(let S in v){let C=this.sourceCaches[S];v[S]!==C.used&&C.fire(new n.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:S}))}this.light.recalculate(l),this.z=l.zoom,m&&this.fire(new n.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){let l=Object.keys(this._changedImages);if(l.length){for(let m in this.sourceCaches)this.sourceCaches[m].reloadTilesForDependencies(["icons","patterns"],l);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(let l in this.sourceCaches)this.sourceCaches[l].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(l,m){this.dispatcher.broadcast("updateLayers",{layers:this._serializeByIds(l),removedIds:m})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(l,m={}){this._checkLoaded();let v=this.serialize();if(l=m.transformStyle?m.transformStyle(v,l):l,$n(this,n.y(l)))return!1;(l=n.aD(l)).layers=n.aB(l.layers);let S=n.aE(v,l).filter(L=>!(L.command in Rm));if(S.length===0)return!1;let C=S.filter(L=>!(L.command in _s));if(C.length>0)throw new Error(`Unimplemented: ${C.map(L=>L.command).join(", ")}.`);for(let L of S)L.command!=="setTransition"&&this[L.command].apply(this,L.args);return this.stylesheet=l,this._serializedLayers=null,!0}addImage(l,m){if(this.getImage(l))return this.fire(new n.j(new Error(`An image named "${l}" already exists.`)));this.imageManager.addImage(l,m),this._afterImageUpdated(l)}updateImage(l,m){this.imageManager.updateImage(l,m)}getImage(l){return this.imageManager.getImage(l)}removeImage(l){if(!this.getImage(l))return this.fire(new n.j(new Error(`An image named "${l}" does not exist.`)));this.imageManager.removeImage(l),this._afterImageUpdated(l)}_afterImageUpdated(l){this._availableImages=this.imageManager.listImages(),this._changedImages[l]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new n.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(l,m,v={}){if(this._checkLoaded(),this.sourceCaches[l]!==void 0)throw new Error(`Source "${l}" already exists.`);if(!m.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(m).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(m.type)>=0&&this._validate(n.y.source,`sources.${l}`,m,null,v))return;this.map&&this.map._collectResourceTiming&&(m.collectResourceTiming=!0);let S=this.sourceCaches[l]=new Xn(l,m,this.dispatcher);S.style=this,S.setEventedParent(this,()=>({isSourceLoaded:S.loaded(),source:S.serialize(),sourceId:l})),S.onAdd(this.map),this._changed=!0}removeSource(l){if(this._checkLoaded(),this.sourceCaches[l]===void 0)throw new Error("There is no source with this ID");for(let v in this._layers)if(this._layers[v].source===l)return this.fire(new n.j(new Error(`Source "${l}" cannot be removed while layer "${v}" is using it.`)));let m=this.sourceCaches[l];delete this.sourceCaches[l],delete this._updatedSources[l],m.fire(new n.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:l})),m.setEventedParent(null),m.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(l,m){if(this._checkLoaded(),this.sourceCaches[l]===void 0)throw new Error(`There is no source with this ID=${l}`);let v=this.sourceCaches[l].getSource();if(v.type!=="geojson")throw new Error(`geojsonSource.type is ${v.type}, which is !== 'geojson`);v.setData(m),this._changed=!0}getSource(l){return this.sourceCaches[l]&&this.sourceCaches[l].getSource()}addLayer(l,m,v={}){this._checkLoaded();let S=l.id;if(this.getLayer(S))return void this.fire(new n.j(new Error(`Layer "${S}" already exists on this map.`)));let C;if(l.type==="custom"){if($n(this,n.aF(l)))return;C=n.aC(l)}else{if("source"in l&&typeof l.source=="object"&&(this.addSource(S,l.source),l=n.aD(l),l=n.e(l,{source:S})),this._validate(n.y.layer,`layers.${S}`,l,{arrayIndex:-1},v))return;C=n.aC(l),this._validateLayer(C),C.setEventedParent(this,{layer:{id:S}})}let L=m?this._order.indexOf(m):this._order.length;if(m&&L===-1)this.fire(new n.j(new Error(`Cannot add layer "${S}" before non-existing layer "${m}".`)));else{if(this._order.splice(L,0,S),this._layerOrderChanged=!0,this._layers[S]=C,this._removedLayers[S]&&C.source&&C.type!=="custom"){let V=this._removedLayers[S];delete this._removedLayers[S],V.type!==C.type?this._updatedSources[C.source]="clear":(this._updatedSources[C.source]="reload",this.sourceCaches[C.source].pause())}this._updateLayer(C),C.onAdd&&C.onAdd(this.map)}}moveLayer(l,m){if(this._checkLoaded(),this._changed=!0,!this._layers[l])return void this.fire(new n.j(new Error(`The layer '${l}' does not exist in the map's style and cannot be moved.`)));if(l===m)return;let v=this._order.indexOf(l);this._order.splice(v,1);let S=m?this._order.indexOf(m):this._order.length;m&&S===-1?this.fire(new n.j(new Error(`Cannot move layer "${l}" before non-existing layer "${m}".`))):(this._order.splice(S,0,l),this._layerOrderChanged=!0)}removeLayer(l){this._checkLoaded();let m=this._layers[l];if(!m)return void this.fire(new n.j(new Error(`Cannot remove non-existing layer "${l}".`)));m.setEventedParent(null);let v=this._order.indexOf(l);this._order.splice(v,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[l]=m,delete this._layers[l],this._serializedLayers&&delete this._serializedLayers[l],delete this._updatedLayers[l],delete this._updatedPaintProps[l],m.onRemove&&m.onRemove(this.map)}getLayer(l){return this._layers[l]}getLayersOrder(){return[...this._order]}hasLayer(l){return l in this._layers}setLayerZoomRange(l,m,v){this._checkLoaded();let S=this.getLayer(l);S?S.minzoom===m&&S.maxzoom===v||(m!=null&&(S.minzoom=m),v!=null&&(S.maxzoom=v),this._updateLayer(S)):this.fire(new n.j(new Error(`Cannot set the zoom range of non-existing layer "${l}".`)))}setFilter(l,m,v={}){this._checkLoaded();let S=this.getLayer(l);if(S){if(!n.aG(S.filter,m))return m==null?(S.filter=void 0,void this._updateLayer(S)):void(this._validate(n.y.filter,`layers.${S.id}.filter`,m,null,v)||(S.filter=n.aD(m),this._updateLayer(S)))}else this.fire(new n.j(new Error(`Cannot filter non-existing layer "${l}".`)))}getFilter(l){return n.aD(this.getLayer(l).filter)}setLayoutProperty(l,m,v,S={}){this._checkLoaded();let C=this.getLayer(l);C?n.aG(C.getLayoutProperty(m),v)||(C.setLayoutProperty(m,v,S),this._updateLayer(C)):this.fire(new n.j(new Error(`Cannot style non-existing layer "${l}".`)))}getLayoutProperty(l,m){let v=this.getLayer(l);if(v)return v.getLayoutProperty(m);this.fire(new n.j(new Error(`Cannot get style of non-existing layer "${l}".`)))}setPaintProperty(l,m,v,S={}){this._checkLoaded();let C=this.getLayer(l);C?n.aG(C.getPaintProperty(m),v)||(C.setPaintProperty(m,v,S)&&this._updateLayer(C),this._changed=!0,this._updatedPaintProps[l]=!0):this.fire(new n.j(new Error(`Cannot style non-existing layer "${l}".`)))}getPaintProperty(l,m){return this.getLayer(l).getPaintProperty(m)}setFeatureState(l,m){this._checkLoaded();let v=l.source,S=l.sourceLayer,C=this.sourceCaches[v];if(C===void 0)return void this.fire(new n.j(new Error(`The source '${v}' does not exist in the map's style.`)));let L=C.getSource().type;L==="geojson"&&S?this.fire(new n.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):L!=="vector"||S?(l.id===void 0&&this.fire(new n.j(new Error("The feature id parameter must be provided."))),C.setFeatureState(S,l.id,m)):this.fire(new n.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(l,m){this._checkLoaded();let v=l.source,S=this.sourceCaches[v];if(S===void 0)return void this.fire(new n.j(new Error(`The source '${v}' does not exist in the map's style.`)));let C=S.getSource().type,L=C==="vector"?l.sourceLayer:void 0;C!=="vector"||L?m&&typeof l.id!="string"&&typeof l.id!="number"?this.fire(new n.j(new Error("A feature id is required to remove its specific state property."))):S.removeFeatureState(L,l.id,m):this.fire(new n.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(l){this._checkLoaded();let m=l.source,v=l.sourceLayer,S=this.sourceCaches[m];if(S!==void 0)return S.getSource().type!=="vector"||v?(l.id===void 0&&this.fire(new n.j(new Error("The feature id parameter must be provided."))),S.getFeatureState(v,l.id)):void this.fire(new n.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new n.j(new Error(`The source '${m}' does not exist in the map's style.`)))}getTransition(){return n.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;let l=n.aH(this.sourceCaches,C=>C.serialize()),m=this._serializeByIds(this._order),v=this.map.getTerrain()||void 0,S=this.stylesheet;return n.aI({version:S.version,name:S.name,metadata:S.metadata,light:S.light,center:S.center,zoom:S.zoom,bearing:S.bearing,pitch:S.pitch,sprite:S.sprite,glyphs:S.glyphs,transition:S.transition,sources:l,layers:m,terrain:v},C=>C!==void 0)}_updateLayer(l){this._updatedLayers[l.id]=!0,l.source&&!this._updatedSources[l.source]&&this.sourceCaches[l.source].getSource().type!=="raster"&&(this._updatedSources[l.source]="reload",this.sourceCaches[l.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(l){let m=L=>this._layers[L].type==="fill-extrusion",v={},S=[];for(let L=this._order.length-1;L>=0;L--){let V=this._order[L];if(m(V)){v[V]=L;for(let $ of l){let X=$[V];if(X)for(let J of X)S.push(J)}}}S.sort((L,V)=>V.intersectionZ-L.intersectionZ);let C=[];for(let L=this._order.length-1;L>=0;L--){let V=this._order[L];if(m(V))for(let $=S.length-1;$>=0;$--){let X=S[$].feature;if(v[X.layer.id]<L)break;C.push(X),S.pop()}else for(let $ of l){let X=$[V];if(X)for(let J of X)C.push(J.feature)}}return C}queryRenderedFeatures(l,m,v){m&&m.filter&&this._validate(n.y.filter,"queryRenderedFeatures.filter",m.filter,null,m);let S={};if(m&&m.layers){if(!Array.isArray(m.layers))return this.fire(new n.j(new Error("parameters.layers must be an Array."))),[];for(let V of m.layers){let $=this._layers[V];if(!$)return this.fire(new n.j(new Error(`The layer '${V}' does not exist in the map's style and cannot be queried for features.`))),[];S[$.source]=!0}}let C=[];m.availableImages=this._availableImages;let L=this._serializedAllLayers();for(let V in this.sourceCaches)m.layers&&!S[V]||C.push(yi(this.sourceCaches[V],this._layers,L,l,m,v));return this.placement&&C.push(function(V,$,X,J,tt,lt,bt){let yt={},Ct=lt.queryRenderedSymbols(J),_t=[];for(let Zt of Object.keys(Ct).map(Number))_t.push(bt[Zt]);_t.sort(tn);for(let Zt of _t){let ne=Zt.featureIndex.lookupSymbolFeatures(Ct[Zt.bucketInstanceId],$,Zt.bucketIndex,Zt.sourceLayerIndex,tt.filter,tt.layers,tt.availableImages,V);for(let Ot in ne){let Gt=yt[Ot]=yt[Ot]||[],he=ne[Ot];he.sort((ce,xe)=>{let Pe=Zt.featureSortOrder;if(Pe){let Te=Pe.indexOf(ce.featureIndex);return Pe.indexOf(xe.featureIndex)-Te}return xe.featureIndex-ce.featureIndex});for(let ce of he)Gt.push(ce)}}for(let Zt in yt)yt[Zt].forEach(ne=>{let Ot=ne.feature,Gt=X[V[Zt].source].getFeatureState(Ot.layer["source-layer"],Ot.id);Ot.source=Ot.layer.source,Ot.layer["source-layer"]&&(Ot.sourceLayer=Ot.layer["source-layer"]),Ot.state=Gt});return yt}(this._layers,L,this.sourceCaches,l,m,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(C)}querySourceFeatures(l,m){m&&m.filter&&this._validate(n.y.filter,"querySourceFeatures.filter",m.filter,null,m);let v=this.sourceCaches[l];return v?function(S,C){let L=S.getRenderableIds().map(X=>S.getTileByID(X)),V=[],$={};for(let X=0;X<L.length;X++){let J=L[X],tt=J.tileID.canonical.key;$[tt]||($[tt]=!0,J.querySourceFeatures(V,C))}return V}(v,m):[]}addSourceType(l,m,v){return Ie(l)?v(new Error(`A source type called "${l}" already exists.`)):(((S,C)=>{jr[S]=C})(l,m),m.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:l,url:m.workerSourceURL},v):v(null,null))}getLight(){return this.light.getLight()}setLight(l,m={}){this._checkLoaded();let v=this.light.getLight(),S=!1;for(let L in l)if(!n.aG(l[L],v[L])){S=!0;break}if(!S)return;let C={now:n.h.now(),transition:n.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(l,m),this.light.updateTransitions(C)}_validate(l,m,v,S,C={}){return(!C||C.validate!==!1)&&$n(this,l.call(n.y,n.e({key:m,style:this.serialize(),value:v,styleSpec:n.v},S)))}_remove(l=!0){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),n.aJ.off("pluginStateChange",this._rtlTextPluginCallback);for(let m in this._layers)this._layers[m].setEventedParent(null);for(let m in this.sourceCaches){let v=this.sourceCaches[m];v.setEventedParent(null),v.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove(l)}_clearSource(l){this.sourceCaches[l].clearTiles()}_reloadSource(l){this.sourceCaches[l].resume(),this.sourceCaches[l].reload()}_updateSources(l){for(let m in this.sourceCaches)this.sourceCaches[m].update(l,this.map.terrain)}_generateCollisionBoxes(){for(let l in this.sourceCaches)this._reloadSource(l)}_updatePlacement(l,m,v,S,C=!1){let L=!1,V=!1,$={};for(let X of this._order){let J=this._layers[X];if(J.type!=="symbol")continue;if(!$[J.source]){let lt=this.sourceCaches[J.source];$[J.source]=lt.getRenderableIds(!0).map(bt=>lt.getTileByID(bt)).sort((bt,yt)=>yt.tileID.overscaledZ-bt.tileID.overscaledZ||(bt.tileID.isLessThan(yt.tileID)?-1:1))}let tt=this.crossTileSymbolIndex.addLayer(J,$[J.source],l.center.lng);L=L||tt}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((C=C||this._layerOrderChanged||v===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(n.h.now(),l.zoom))&&(this.pauseablePlacement=new Zl(l,this.map.terrain,this._order,C,m,v,S,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,$),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(n.h.now()),V=!0),L&&this.pauseablePlacement.placement.setStale()),V||L)for(let X of this._order){let J=this._layers[X];J.type==="symbol"&&this.placement.updateLayerOpacities(J,$[J.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(n.h.now())}_releaseSymbolFadeTiles(){for(let l in this.sourceCaches)this.sourceCaches[l].releaseSymbolFadeTiles()}getImages(l,m,v){this.imageManager.getImages(m.icons,v),this._updateTilesForChangedImages();let S=this.sourceCaches[m.source];S&&S.setDependencies(m.tileID.key,m.type,m.icons)}getGlyphs(l,m,v){this.glyphManager.getGlyphs(m.stacks,v);let S=this.sourceCaches[m.source];S&&S.setDependencies(m.tileID.key,m.type,[""])}getResource(l,m,v){return n.m(m,v)}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(l,m={}){this._checkLoaded(),l&&this._validate(n.y.glyphs,"glyphs",l,null,m)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=l,this.glyphManager.entries={},this.glyphManager.setURL(l))}addSprite(l,m,v={},S){this._checkLoaded();let C=[{id:l,url:m}],L=[...at(this.stylesheet.sprite),...C];this._validate(n.y.sprite,"sprite",L,null,v)||(this.stylesheet.sprite=L,this._loadSprite(C,!0,S))}removeSprite(l){this._checkLoaded();let m=at(this.stylesheet.sprite);if(m.find(v=>v.id===l)){if(this._spritesImagesIds[l])for(let v of this._spritesImagesIds[l])this.imageManager.removeImage(v),this._changedImages[v]=!0;m.splice(m.findIndex(v=>v.id===l),1),this.stylesheet.sprite=m.length>0?m:void 0,delete this._spritesImagesIds[l],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new n.k("data",{dataType:"style"}))}else this.fire(new n.j(new Error(`Sprite "${l}" doesn't exists on this map.`)))}getSprite(){return at(this.stylesheet.sprite)}setSprite(l,m={},v){this._checkLoaded(),l&&this._validate(n.y.sprite,"sprite",l,null,m)||(this.stylesheet.sprite=l,l?this._loadSprite(l,!0,v):(this._unloadSprite(),v&&v(null)))}}Ms.registerForPluginStateChange=n.aK;var ko=n.Q([{name:"a_pos",type:"Int16",components:2}]),Gl="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}";let Fn={prelude:Ki(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:Ki(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:Ki(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Ki(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Ki("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Ki(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:Ki(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Ki("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Ki("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Ki("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:Ki(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:Ki(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:Ki(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:Ki(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Ki(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Ki(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Ki(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Ki(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:Ki(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Ki(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Ki(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Ki(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Ki(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:Ki(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Ki(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Ki(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Ki("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",Gl),terrainDepth:Ki("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",Gl),terrainCoords:Ki("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",Gl)};function Ki(M,l){let m=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,v=l.match(/attribute ([\w]+) ([\w]+)/g),S=M.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),C=l.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),L=C?C.concat(S):S,V={};return{fragmentSource:M=M.replace(m,($,X,J,tt,lt)=>(V[lt]=!0,X==="define"?`
#ifndef HAS_UNIFORM_u_${lt}
varying ${J} ${tt} ${lt};
#else
uniform ${J} ${tt} u_${lt};
#endif
`:`
#ifdef HAS_UNIFORM_u_${lt}
    ${J} ${tt} ${lt} = u_${lt};
#endif
`)),vertexSource:l=l.replace(m,($,X,J,tt,lt)=>{let bt=tt==="float"?"vec2":"vec4",yt=lt.match(/color/)?"color":bt;return V[lt]?X==="define"?`
#ifndef HAS_UNIFORM_u_${lt}
uniform lowp float u_${lt}_t;
attribute ${J} ${bt} a_${lt};
varying ${J} ${tt} ${lt};
#else
uniform ${J} ${tt} u_${lt};
#endif
`:yt==="vec4"?`
#ifndef HAS_UNIFORM_u_${lt}
    ${lt} = a_${lt};
#else
    ${J} ${tt} ${lt} = u_${lt};
#endif
`:`
#ifndef HAS_UNIFORM_u_${lt}
    ${lt} = unpack_mix_${yt}(a_${lt}, u_${lt}_t);
#else
    ${J} ${tt} ${lt} = u_${lt};
#endif
`:X==="define"?`
#ifndef HAS_UNIFORM_u_${lt}
uniform lowp float u_${lt}_t;
attribute ${J} ${bt} a_${lt};
#else
uniform ${J} ${tt} u_${lt};
#endif
`:yt==="vec4"?`
#ifndef HAS_UNIFORM_u_${lt}
    ${J} ${tt} ${lt} = a_${lt};
#else
    ${J} ${tt} ${lt} = u_${lt};
#endif
`:`
#ifndef HAS_UNIFORM_u_${lt}
    ${J} ${tt} ${lt} = unpack_mix_${yt}(a_${lt}, u_${lt}_t);
#else
    ${J} ${tt} ${lt} = u_${lt};
#endif
`}),staticAttributes:v,staticUniforms:L}}class Ql{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(l,m,v,S,C,L,V,$,X){this.context=l;let J=this.boundPaintVertexBuffers.length!==S.length;for(let tt=0;!J&&tt<S.length;tt++)this.boundPaintVertexBuffers[tt]!==S[tt]&&(J=!0);!this.vao||this.boundProgram!==m||this.boundLayoutVertexBuffer!==v||J||this.boundIndexBuffer!==C||this.boundVertexOffset!==L||this.boundDynamicVertexBuffer!==V||this.boundDynamicVertexBuffer2!==$||this.boundDynamicVertexBuffer3!==X?this.freshBind(m,v,S,C,L,V,$,X):(l.bindVertexArray.set(this.vao),V&&V.bind(),C&&C.dynamicDraw&&C.bind(),$&&$.bind(),X&&X.bind())}freshBind(l,m,v,S,C,L,V,$){let X=l.numAttributes,J=this.context,tt=J.gl;this.vao&&this.destroy(),this.vao=J.createVertexArray(),J.bindVertexArray.set(this.vao),this.boundProgram=l,this.boundLayoutVertexBuffer=m,this.boundPaintVertexBuffers=v,this.boundIndexBuffer=S,this.boundVertexOffset=C,this.boundDynamicVertexBuffer=L,this.boundDynamicVertexBuffer2=V,this.boundDynamicVertexBuffer3=$,m.enableAttributes(tt,l);for(let lt of v)lt.enableAttributes(tt,l);L&&L.enableAttributes(tt,l),V&&V.enableAttributes(tt,l),$&&$.enableAttributes(tt,l),m.bind(),m.setVertexAttribPointers(tt,l,C);for(let lt of v)lt.bind(),lt.setVertexAttribPointers(tt,l,C);L&&(L.bind(),L.setVertexAttribPointers(tt,l,C)),S&&S.bind(),V&&(V.bind(),V.setVertexAttribPointers(tt,l,C)),$&&($.bind(),$.setVertexAttribPointers(tt,l,C)),J.currentNumAttributes=X}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}function Hn(M){let l=[];for(let m=0;m<M.length;m++){if(M[m]===null)continue;let v=M[m].split(" ");l.push(v.pop())}return l}class du{constructor(l,m,v,S,C,L){let V=l.gl;this.program=V.createProgram();let $=Hn(m.staticAttributes),X=v?v.getBinderAttributes():[],J=$.concat(X),tt=Fn.prelude.staticUniforms?Hn(Fn.prelude.staticUniforms):[],lt=m.staticUniforms?Hn(m.staticUniforms):[],bt=v?v.getBinderUniforms():[],yt=tt.concat(lt).concat(bt),Ct=[];for(let ce of yt)Ct.indexOf(ce)<0&&Ct.push(ce);let _t=v?v.defines():[];C&&_t.push("#define OVERDRAW_INSPECTOR;"),L&&_t.push("#define TERRAIN3D;");let Zt=_t.concat(Fn.prelude.fragmentSource,m.fragmentSource).join(`
`),ne=_t.concat(Fn.prelude.vertexSource,m.vertexSource).join(`
`),Ot=V.createShader(V.FRAGMENT_SHADER);if(V.isContextLost())return void(this.failedToCreate=!0);if(V.shaderSource(Ot,Zt),V.compileShader(Ot),!V.getShaderParameter(Ot,V.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${V.getShaderInfoLog(Ot)}`);V.attachShader(this.program,Ot);let Gt=V.createShader(V.VERTEX_SHADER);if(V.isContextLost())return void(this.failedToCreate=!0);if(V.shaderSource(Gt,ne),V.compileShader(Gt),!V.getShaderParameter(Gt,V.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${V.getShaderInfoLog(Gt)}`);V.attachShader(this.program,Gt),this.attributes={};let he={};this.numAttributes=J.length;for(let ce=0;ce<this.numAttributes;ce++)J[ce]&&(V.bindAttribLocation(this.program,ce,J[ce]),this.attributes[J[ce]]=ce);if(V.linkProgram(this.program),!V.getProgramParameter(this.program,V.LINK_STATUS))throw new Error(`Program failed to link: ${V.getProgramInfoLog(this.program)}`);V.deleteShader(Gt),V.deleteShader(Ot);for(let ce=0;ce<Ct.length;ce++){let xe=Ct[ce];if(xe&&!he[xe]){let Pe=V.getUniformLocation(this.program,xe);Pe&&(he[xe]=Pe)}}this.fixedUniforms=S(l,he),this.terrainUniforms=((ce,xe)=>({u_depth:new n.aL(ce,xe.u_depth),u_terrain:new n.aL(ce,xe.u_terrain),u_terrain_dim:new n.aM(ce,xe.u_terrain_dim),u_terrain_matrix:new n.aN(ce,xe.u_terrain_matrix),u_terrain_unpack:new n.aO(ce,xe.u_terrain_unpack),u_terrain_exaggeration:new n.aM(ce,xe.u_terrain_exaggeration)}))(l,he),this.binderUniforms=v?v.getUniforms(l,he):[]}draw(l,m,v,S,C,L,V,$,X,J,tt,lt,bt,yt,Ct,_t,Zt,ne){let Ot=l.gl;if(this.failedToCreate)return;if(l.program.set(this.program),l.setDepthMode(v),l.setStencilMode(S),l.setColorMode(C),l.setCullFace(L),$){l.activeTexture.set(Ot.TEXTURE2),Ot.bindTexture(Ot.TEXTURE_2D,$.depthTexture),l.activeTexture.set(Ot.TEXTURE3),Ot.bindTexture(Ot.TEXTURE_2D,$.texture);for(let he in this.terrainUniforms)this.terrainUniforms[he].set($[he])}for(let he in this.fixedUniforms)this.fixedUniforms[he].set(V[he]);Ct&&Ct.setUniforms(l,this.binderUniforms,bt,{zoom:yt});let Gt=0;switch(m){case Ot.LINES:Gt=2;break;case Ot.TRIANGLES:Gt=3;break;case Ot.LINE_STRIP:Gt=1}for(let he of lt.get()){let ce=he.vaos||(he.vaos={});(ce[X]||(ce[X]=new Ql)).bind(l,this,J,Ct?Ct.getPaintVertexBuffers():[],tt,he.vertexOffset,_t,Zt,ne),Ot.drawElements(m,he.primitiveLength*Gt,Ot.UNSIGNED_SHORT,he.primitiveOffset*Gt*2)}}}function Cs(M,l,m){let v=1/qt(m,1,l.transform.tileZoom),S=Math.pow(2,m.tileID.overscaledZ),C=m.tileSize*Math.pow(2,l.transform.tileZoom)/S,L=C*(m.tileID.canonical.x+m.tileID.wrap*S),V=C*m.tileID.canonical.y;return{u_image:0,u_texsize:m.imageAtlasTexture.size,u_scale:[v,M.fromScale,M.toScale],u_fade:M.t,u_pixel_coord_upper:[L>>16,V>>16],u_pixel_coord_lower:[65535&L,65535&V]}}let B0=(M,l,m,v)=>{let S=l.style.light,C=S.properties.get("position"),L=[C.x,C.y,C.z],V=function(){var X=new n.A(9);return n.A!=Float32Array&&(X[1]=0,X[2]=0,X[3]=0,X[5]=0,X[6]=0,X[7]=0),X[0]=1,X[4]=1,X[8]=1,X}();S.properties.get("anchor")==="viewport"&&function(X,J){var tt=Math.sin(J),lt=Math.cos(J);X[0]=lt,X[1]=tt,X[2]=0,X[3]=-tt,X[4]=lt,X[5]=0,X[6]=0,X[7]=0,X[8]=1}(V,-l.transform.angle),function(X,J,tt){var lt=J[0],bt=J[1],yt=J[2];X[0]=lt*tt[0]+bt*tt[3]+yt*tt[6],X[1]=lt*tt[1]+bt*tt[4]+yt*tt[7],X[2]=lt*tt[2]+bt*tt[5]+yt*tt[8]}(L,L,V);let $=S.properties.get("color");return{u_matrix:M,u_lightpos:L,u_lightintensity:S.properties.get("intensity"),u_lightcolor:[$.r,$.g,$.b],u_vertical_gradient:+m,u_opacity:v}},Kl=(M,l,m,v,S,C,L)=>n.e(B0(M,l,m,v),Cs(C,l,L),{u_height_factor:-Math.pow(2,S.overscaledZ)/L.tileSize/8}),Xp=M=>({u_matrix:M}),Zp=(M,l,m,v)=>n.e(Xp(M),Cs(m,l,v)),Gp=(M,l)=>({u_matrix:M,u_world:l}),Qp=(M,l,m,v,S)=>n.e(Zp(M,l,m,v),{u_world:S}),ut=(M,l,m,v)=>{let S=M.transform,C,L;if(v.paint.get("circle-pitch-alignment")==="map"){let V=qt(m,1,S.zoom);C=!0,L=[V,V]}else C=!1,L=S.pixelsToGLUnits;return{u_camera_to_center_distance:S.cameraToCenterDistance,u_scale_with_map:+(v.paint.get("circle-pitch-scale")==="map"),u_matrix:M.translatePosMatrix(l.posMatrix,m,v.paint.get("circle-translate"),v.paint.get("circle-translate-anchor")),u_pitch_with_map:+C,u_device_pixel_ratio:M.pixelRatio,u_extrude_scale:L}},gt=(M,l,m)=>{let v=qt(m,1,l.zoom),S=Math.pow(2,l.zoom-m.tileID.overscaledZ),C=m.tileID.overscaleFactor();return{u_matrix:M,u_camera_to_center_distance:l.cameraToCenterDistance,u_pixels_to_tile_units:v,u_extrude_scale:[l.pixelsToGLUnits[0]/(v*S),l.pixelsToGLUnits[1]/(v*S)],u_overscale_factor:C}},$t=(M,l,m=1)=>({u_matrix:M,u_color:l,u_overlay:0,u_overlay_scale:m}),pe=M=>({u_matrix:M}),Oe=(M,l,m,v)=>({u_matrix:M,u_extrude_scale:qt(l,1,m),u_intensity:v});function ar(M,l){let m=Math.pow(2,l.canonical.z),v=l.canonical.y;return[new n.U(0,v/m).toLngLat().lat,new n.U(0,(v+1)/m).toLngLat().lat]}let Ri=(M,l,m,v)=>{let S=M.transform;return{u_matrix:km(M,l,m,v),u_ratio:1/qt(l,1,S.zoom),u_device_pixel_ratio:M.pixelRatio,u_units_to_pixels:[1/S.pixelsToGLUnits[0],1/S.pixelsToGLUnits[1]]}},Ns=(M,l,m,v,S)=>n.e(Ri(M,l,m,S),{u_image:0,u_image_height:v}),eo=(M,l,m,v,S)=>{let C=M.transform,L=Ka(l,C);return{u_matrix:km(M,l,m,S),u_texsize:l.imageAtlasTexture.size,u_ratio:1/qt(l,1,C.zoom),u_device_pixel_ratio:M.pixelRatio,u_image:0,u_scale:[L,v.fromScale,v.toScale],u_fade:v.t,u_units_to_pixels:[1/C.pixelsToGLUnits[0],1/C.pixelsToGLUnits[1]]}},mo=(M,l,m,v,S,C)=>{let L=M.lineAtlas,V=Ka(l,M.transform),$=m.layout.get("line-cap")==="round",X=L.getDash(v.from,$),J=L.getDash(v.to,$),tt=X.width*S.fromScale,lt=J.width*S.toScale;return n.e(Ri(M,l,m,C),{u_patternscale_a:[V/tt,-X.height/2],u_patternscale_b:[V/lt,-J.height/2],u_sdfgamma:L.width/(256*Math.min(tt,lt)*M.pixelRatio)/2,u_image:0,u_tex_y_a:X.y,u_tex_y_b:J.y,u_mix:S.t})};function Ka(M,l){return 1/qt(M,1,l.tileZoom)}function km(M,l,m,v){return M.translatePosMatrix(v?v.posMatrix:l.tileID.posMatrix,l,m.paint.get("line-translate"),m.paint.get("line-translate-anchor"))}let nb=(M,l,m,v,S)=>{return{u_matrix:M,u_tl_parent:l,u_scale_parent:m,u_buffer_scale:1,u_fade_t:v.mix,u_opacity:v.opacity*S.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:S.paint.get("raster-brightness-min"),u_brightness_high:S.paint.get("raster-brightness-max"),u_saturation_factor:(L=S.paint.get("raster-saturation"),L>0?1-1/(1.001-L):-L),u_contrast_factor:(C=S.paint.get("raster-contrast"),C>0?1/(1-C):1+C),u_spin_weights:sb(S.paint.get("raster-hue-rotate"))};var C,L};function sb(M){M*=Math.PI/180;let l=Math.sin(M),m=Math.cos(M);return[(2*m+1)/3,(-Math.sqrt(3)*l-m+1)/3,(Math.sqrt(3)*l-m+1)/3]}let M_=(M,l,m,v,S,C,L,V,$,X)=>{let J=S.transform;return{u_is_size_zoom_constant:+(M==="constant"||M==="source"),u_is_size_feature_constant:+(M==="constant"||M==="camera"),u_size_t:l?l.uSizeT:0,u_size:l?l.uSize:0,u_camera_to_center_distance:J.cameraToCenterDistance,u_pitch:J.pitch/360*2*Math.PI,u_rotate_symbol:+m,u_aspect_ratio:J.width/J.height,u_fade_change:S.options.fadeDuration?S.symbolFadeChange:1,u_matrix:C,u_label_plane_matrix:L,u_coord_matrix:V,u_is_text:+$,u_pitch_with_map:+v,u_texsize:X,u_texture:0}},C_=(M,l,m,v,S,C,L,V,$,X,J)=>{let tt=S.transform;return n.e(M_(M,l,m,v,S,C,L,V,$,X),{u_gamma_scale:v?Math.cos(tt._pitch)*tt.cameraToCenterDistance:1,u_device_pixel_ratio:S.pixelRatio,u_is_halo:+J})},yf=(M,l,m,v,S,C,L,V,$,X)=>n.e(C_(M,l,m,v,S,C,L,V,!0,$,!0),{u_texsize_icon:X,u_texture_icon:1}),Dm=(M,l,m)=>({u_matrix:M,u_opacity:l,u_color:m}),wl=(M,l,m,v,S,C)=>n.e(function(L,V,$,X){let J=$.imageManager.getPattern(L.from.toString()),tt=$.imageManager.getPattern(L.to.toString()),{width:lt,height:bt}=$.imageManager.getPixelSize(),yt=Math.pow(2,X.tileID.overscaledZ),Ct=X.tileSize*Math.pow(2,$.transform.tileZoom)/yt,_t=Ct*(X.tileID.canonical.x+X.tileID.wrap*yt),Zt=Ct*X.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:J.tl,u_pattern_br_a:J.br,u_pattern_tl_b:tt.tl,u_pattern_br_b:tt.br,u_texsize:[lt,bt],u_mix:V.t,u_pattern_size_a:J.displaySize,u_pattern_size_b:tt.displaySize,u_scale_a:V.fromScale,u_scale_b:V.toScale,u_tile_units_to_pixels:1/qt(X,1,$.transform.tileZoom),u_pixel_coord_upper:[_t>>16,Zt>>16],u_pixel_coord_lower:[65535&_t,65535&Zt]}}(v,C,m,S),{u_matrix:M,u_opacity:l}),Bm={fillExtrusion:(M,l)=>({u_matrix:new n.aN(M,l.u_matrix),u_lightpos:new n.aP(M,l.u_lightpos),u_lightintensity:new n.aM(M,l.u_lightintensity),u_lightcolor:new n.aP(M,l.u_lightcolor),u_vertical_gradient:new n.aM(M,l.u_vertical_gradient),u_opacity:new n.aM(M,l.u_opacity)}),fillExtrusionPattern:(M,l)=>({u_matrix:new n.aN(M,l.u_matrix),u_lightpos:new n.aP(M,l.u_lightpos),u_lightintensity:new n.aM(M,l.u_lightintensity),u_lightcolor:new n.aP(M,l.u_lightcolor),u_vertical_gradient:new n.aM(M,l.u_vertical_gradient),u_height_factor:new n.aM(M,l.u_height_factor),u_image:new n.aL(M,l.u_image),u_texsize:new n.aQ(M,l.u_texsize),u_pixel_coord_upper:new n.aQ(M,l.u_pixel_coord_upper),u_pixel_coord_lower:new n.aQ(M,l.u_pixel_coord_lower),u_scale:new n.aP(M,l.u_scale),u_fade:new n.aM(M,l.u_fade),u_opacity:new n.aM(M,l.u_opacity)}),fill:(M,l)=>({u_matrix:new n.aN(M,l.u_matrix)}),fillPattern:(M,l)=>({u_matrix:new n.aN(M,l.u_matrix),u_image:new n.aL(M,l.u_image),u_texsize:new n.aQ(M,l.u_texsize),u_pixel_coord_upper:new n.aQ(M,l.u_pixel_coord_upper),u_pixel_coord_lower:new n.aQ(M,l.u_pixel_coord_lower),u_scale:new n.aP(M,l.u_scale),u_fade:new n.aM(M,l.u_fade)}),fillOutline:(M,l)=>({u_matrix:new n.aN(M,l.u_matrix),u_world:new n.aQ(M,l.u_world)}),fillOutlinePattern:(M,l)=>({u_matrix:new n.aN(M,l.u_matrix),u_world:new n.aQ(M,l.u_world),u_image:new n.aL(M,l.u_image),u_texsize:new n.aQ(M,l.u_texsize),u_pixel_coord_upper:new n.aQ(M,l.u_pixel_coord_upper),u_pixel_coord_lower:new n.aQ(M,l.u_pixel_coord_lower),u_scale:new n.aP(M,l.u_scale),u_fade:new n.aM(M,l.u_fade)}),circle:(M,l)=>({u_camera_to_center_distance:new n.aM(M,l.u_camera_to_center_distance),u_scale_with_map:new n.aL(M,l.u_scale_with_map),u_pitch_with_map:new n.aL(M,l.u_pitch_with_map),u_extrude_scale:new n.aQ(M,l.u_extrude_scale),u_device_pixel_ratio:new n.aM(M,l.u_device_pixel_ratio),u_matrix:new n.aN(M,l.u_matrix)}),collisionBox:(M,l)=>({u_matrix:new n.aN(M,l.u_matrix),u_camera_to_center_distance:new n.aM(M,l.u_camera_to_center_distance),u_pixels_to_tile_units:new n.aM(M,l.u_pixels_to_tile_units),u_extrude_scale:new n.aQ(M,l.u_extrude_scale),u_overscale_factor:new n.aM(M,l.u_overscale_factor)}),collisionCircle:(M,l)=>({u_matrix:new n.aN(M,l.u_matrix),u_inv_matrix:new n.aN(M,l.u_inv_matrix),u_camera_to_center_distance:new n.aM(M,l.u_camera_to_center_distance),u_viewport_size:new n.aQ(M,l.u_viewport_size)}),debug:(M,l)=>({u_color:new n.aR(M,l.u_color),u_matrix:new n.aN(M,l.u_matrix),u_overlay:new n.aL(M,l.u_overlay),u_overlay_scale:new n.aM(M,l.u_overlay_scale)}),clippingMask:(M,l)=>({u_matrix:new n.aN(M,l.u_matrix)}),heatmap:(M,l)=>({u_extrude_scale:new n.aM(M,l.u_extrude_scale),u_intensity:new n.aM(M,l.u_intensity),u_matrix:new n.aN(M,l.u_matrix)}),heatmapTexture:(M,l)=>({u_matrix:new n.aN(M,l.u_matrix),u_world:new n.aQ(M,l.u_world),u_image:new n.aL(M,l.u_image),u_color_ramp:new n.aL(M,l.u_color_ramp),u_opacity:new n.aM(M,l.u_opacity)}),hillshade:(M,l)=>({u_matrix:new n.aN(M,l.u_matrix),u_image:new n.aL(M,l.u_image),u_latrange:new n.aQ(M,l.u_latrange),u_light:new n.aQ(M,l.u_light),u_shadow:new n.aR(M,l.u_shadow),u_highlight:new n.aR(M,l.u_highlight),u_accent:new n.aR(M,l.u_accent)}),hillshadePrepare:(M,l)=>({u_matrix:new n.aN(M,l.u_matrix),u_image:new n.aL(M,l.u_image),u_dimension:new n.aQ(M,l.u_dimension),u_zoom:new n.aM(M,l.u_zoom),u_unpack:new n.aO(M,l.u_unpack)}),line:(M,l)=>({u_matrix:new n.aN(M,l.u_matrix),u_ratio:new n.aM(M,l.u_ratio),u_device_pixel_ratio:new n.aM(M,l.u_device_pixel_ratio),u_units_to_pixels:new n.aQ(M,l.u_units_to_pixels)}),lineGradient:(M,l)=>({u_matrix:new n.aN(M,l.u_matrix),u_ratio:new n.aM(M,l.u_ratio),u_device_pixel_ratio:new n.aM(M,l.u_device_pixel_ratio),u_units_to_pixels:new n.aQ(M,l.u_units_to_pixels),u_image:new n.aL(M,l.u_image),u_image_height:new n.aM(M,l.u_image_height)}),linePattern:(M,l)=>({u_matrix:new n.aN(M,l.u_matrix),u_texsize:new n.aQ(M,l.u_texsize),u_ratio:new n.aM(M,l.u_ratio),u_device_pixel_ratio:new n.aM(M,l.u_device_pixel_ratio),u_image:new n.aL(M,l.u_image),u_units_to_pixels:new n.aQ(M,l.u_units_to_pixels),u_scale:new n.aP(M,l.u_scale),u_fade:new n.aM(M,l.u_fade)}),lineSDF:(M,l)=>({u_matrix:new n.aN(M,l.u_matrix),u_ratio:new n.aM(M,l.u_ratio),u_device_pixel_ratio:new n.aM(M,l.u_device_pixel_ratio),u_units_to_pixels:new n.aQ(M,l.u_units_to_pixels),u_patternscale_a:new n.aQ(M,l.u_patternscale_a),u_patternscale_b:new n.aQ(M,l.u_patternscale_b),u_sdfgamma:new n.aM(M,l.u_sdfgamma),u_image:new n.aL(M,l.u_image),u_tex_y_a:new n.aM(M,l.u_tex_y_a),u_tex_y_b:new n.aM(M,l.u_tex_y_b),u_mix:new n.aM(M,l.u_mix)}),raster:(M,l)=>({u_matrix:new n.aN(M,l.u_matrix),u_tl_parent:new n.aQ(M,l.u_tl_parent),u_scale_parent:new n.aM(M,l.u_scale_parent),u_buffer_scale:new n.aM(M,l.u_buffer_scale),u_fade_t:new n.aM(M,l.u_fade_t),u_opacity:new n.aM(M,l.u_opacity),u_image0:new n.aL(M,l.u_image0),u_image1:new n.aL(M,l.u_image1),u_brightness_low:new n.aM(M,l.u_brightness_low),u_brightness_high:new n.aM(M,l.u_brightness_high),u_saturation_factor:new n.aM(M,l.u_saturation_factor),u_contrast_factor:new n.aM(M,l.u_contrast_factor),u_spin_weights:new n.aP(M,l.u_spin_weights)}),symbolIcon:(M,l)=>({u_is_size_zoom_constant:new n.aL(M,l.u_is_size_zoom_constant),u_is_size_feature_constant:new n.aL(M,l.u_is_size_feature_constant),u_size_t:new n.aM(M,l.u_size_t),u_size:new n.aM(M,l.u_size),u_camera_to_center_distance:new n.aM(M,l.u_camera_to_center_distance),u_pitch:new n.aM(M,l.u_pitch),u_rotate_symbol:new n.aL(M,l.u_rotate_symbol),u_aspect_ratio:new n.aM(M,l.u_aspect_ratio),u_fade_change:new n.aM(M,l.u_fade_change),u_matrix:new n.aN(M,l.u_matrix),u_label_plane_matrix:new n.aN(M,l.u_label_plane_matrix),u_coord_matrix:new n.aN(M,l.u_coord_matrix),u_is_text:new n.aL(M,l.u_is_text),u_pitch_with_map:new n.aL(M,l.u_pitch_with_map),u_texsize:new n.aQ(M,l.u_texsize),u_texture:new n.aL(M,l.u_texture)}),symbolSDF:(M,l)=>({u_is_size_zoom_constant:new n.aL(M,l.u_is_size_zoom_constant),u_is_size_feature_constant:new n.aL(M,l.u_is_size_feature_constant),u_size_t:new n.aM(M,l.u_size_t),u_size:new n.aM(M,l.u_size),u_camera_to_center_distance:new n.aM(M,l.u_camera_to_center_distance),u_pitch:new n.aM(M,l.u_pitch),u_rotate_symbol:new n.aL(M,l.u_rotate_symbol),u_aspect_ratio:new n.aM(M,l.u_aspect_ratio),u_fade_change:new n.aM(M,l.u_fade_change),u_matrix:new n.aN(M,l.u_matrix),u_label_plane_matrix:new n.aN(M,l.u_label_plane_matrix),u_coord_matrix:new n.aN(M,l.u_coord_matrix),u_is_text:new n.aL(M,l.u_is_text),u_pitch_with_map:new n.aL(M,l.u_pitch_with_map),u_texsize:new n.aQ(M,l.u_texsize),u_texture:new n.aL(M,l.u_texture),u_gamma_scale:new n.aM(M,l.u_gamma_scale),u_device_pixel_ratio:new n.aM(M,l.u_device_pixel_ratio),u_is_halo:new n.aL(M,l.u_is_halo)}),symbolTextAndIcon:(M,l)=>({u_is_size_zoom_constant:new n.aL(M,l.u_is_size_zoom_constant),u_is_size_feature_constant:new n.aL(M,l.u_is_size_feature_constant),u_size_t:new n.aM(M,l.u_size_t),u_size:new n.aM(M,l.u_size),u_camera_to_center_distance:new n.aM(M,l.u_camera_to_center_distance),u_pitch:new n.aM(M,l.u_pitch),u_rotate_symbol:new n.aL(M,l.u_rotate_symbol),u_aspect_ratio:new n.aM(M,l.u_aspect_ratio),u_fade_change:new n.aM(M,l.u_fade_change),u_matrix:new n.aN(M,l.u_matrix),u_label_plane_matrix:new n.aN(M,l.u_label_plane_matrix),u_coord_matrix:new n.aN(M,l.u_coord_matrix),u_is_text:new n.aL(M,l.u_is_text),u_pitch_with_map:new n.aL(M,l.u_pitch_with_map),u_texsize:new n.aQ(M,l.u_texsize),u_texsize_icon:new n.aQ(M,l.u_texsize_icon),u_texture:new n.aL(M,l.u_texture),u_texture_icon:new n.aL(M,l.u_texture_icon),u_gamma_scale:new n.aM(M,l.u_gamma_scale),u_device_pixel_ratio:new n.aM(M,l.u_device_pixel_ratio),u_is_halo:new n.aL(M,l.u_is_halo)}),background:(M,l)=>({u_matrix:new n.aN(M,l.u_matrix),u_opacity:new n.aM(M,l.u_opacity),u_color:new n.aR(M,l.u_color)}),backgroundPattern:(M,l)=>({u_matrix:new n.aN(M,l.u_matrix),u_opacity:new n.aM(M,l.u_opacity),u_image:new n.aL(M,l.u_image),u_pattern_tl_a:new n.aQ(M,l.u_pattern_tl_a),u_pattern_br_a:new n.aQ(M,l.u_pattern_br_a),u_pattern_tl_b:new n.aQ(M,l.u_pattern_tl_b),u_pattern_br_b:new n.aQ(M,l.u_pattern_br_b),u_texsize:new n.aQ(M,l.u_texsize),u_mix:new n.aM(M,l.u_mix),u_pattern_size_a:new n.aQ(M,l.u_pattern_size_a),u_pattern_size_b:new n.aQ(M,l.u_pattern_size_b),u_scale_a:new n.aM(M,l.u_scale_a),u_scale_b:new n.aM(M,l.u_scale_b),u_pixel_coord_upper:new n.aQ(M,l.u_pixel_coord_upper),u_pixel_coord_lower:new n.aQ(M,l.u_pixel_coord_lower),u_tile_units_to_pixels:new n.aM(M,l.u_tile_units_to_pixels)}),terrain:(M,l)=>({u_matrix:new n.aN(M,l.u_matrix),u_texture:new n.aL(M,l.u_texture),u_ele_delta:new n.aM(M,l.u_ele_delta)}),terrainDepth:(M,l)=>({u_matrix:new n.aN(M,l.u_matrix),u_ele_delta:new n.aM(M,l.u_ele_delta)}),terrainCoords:(M,l)=>({u_matrix:new n.aN(M,l.u_matrix),u_texture:new n.aL(M,l.u_texture),u_terrain_coords_id:new n.aM(M,l.u_terrain_coords_id),u_ele_delta:new n.aM(M,l.u_ele_delta)})};class Om{constructor(l,m,v){this.context=l;let S=l.gl;this.buffer=S.createBuffer(),this.dynamicDraw=!!v,this.context.unbindVAO(),l.bindElementBuffer.set(this.buffer),S.bufferData(S.ELEMENT_ARRAY_BUFFER,m.arrayBuffer,this.dynamicDraw?S.DYNAMIC_DRAW:S.STATIC_DRAW),this.dynamicDraw||delete m.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(l){let m=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),m.bufferSubData(m.ELEMENT_ARRAY_BUFFER,0,l.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}let O0={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Nm{constructor(l,m,v,S){this.length=m.length,this.attributes=v,this.itemSize=m.bytesPerElement,this.dynamicDraw=S,this.context=l;let C=l.gl;this.buffer=C.createBuffer(),l.bindVertexBuffer.set(this.buffer),C.bufferData(C.ARRAY_BUFFER,m.arrayBuffer,this.dynamicDraw?C.DYNAMIC_DRAW:C.STATIC_DRAW),this.dynamicDraw||delete m.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(l){if(l.length!==this.length)throw new Error(`Length of new data is ${l.length}, which doesn't match current length of ${this.length}`);let m=this.context.gl;this.bind(),m.bufferSubData(m.ARRAY_BUFFER,0,l.arrayBuffer)}enableAttributes(l,m){for(let v=0;v<this.attributes.length;v++){let S=m.attributes[this.attributes[v].name];S!==void 0&&l.enableVertexAttribArray(S)}}setVertexAttribPointers(l,m,v){for(let S=0;S<this.attributes.length;S++){let C=this.attributes[S],L=m.attributes[C.name];L!==void 0&&l.vertexAttribPointer(L,C.components,l[O0[C.type]],!1,this.itemSize,C.offset+this.itemSize*(v||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}let Kp=new WeakMap;function yh(M){var l;if(Kp.has(M))return Kp.get(M);{let m=(l=M.getParameter(M.VERSION))===null||l===void 0?void 0:l.startsWith("WebGL 2.0");return Kp.set(M,m),m}}class qi{constructor(l){this.gl=l.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(l){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Fm extends qi{getDefault(){return n.aT.transparent}set(l){let m=this.current;(l.r!==m.r||l.g!==m.g||l.b!==m.b||l.a!==m.a||this.dirty)&&(this.gl.clearColor(l.r,l.g,l.b,l.a),this.current=l,this.dirty=!1)}}class Ja extends qi{getDefault(){return 1}set(l){(l!==this.current||this.dirty)&&(this.gl.clearDepth(l),this.current=l,this.dirty=!1)}}class tl extends qi{getDefault(){return 0}set(l){(l!==this.current||this.dirty)&&(this.gl.clearStencil(l),this.current=l,this.dirty=!1)}}class P_ extends qi{getDefault(){return[!0,!0,!0,!0]}set(l){let m=this.current;(l[0]!==m[0]||l[1]!==m[1]||l[2]!==m[2]||l[3]!==m[3]||this.dirty)&&(this.gl.colorMask(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)}}class Lm extends qi{getDefault(){return!0}set(l){(l!==this.current||this.dirty)&&(this.gl.depthMask(l),this.current=l,this.dirty=!1)}}class zm extends qi{getDefault(){return 255}set(l){(l!==this.current||this.dirty)&&(this.gl.stencilMask(l),this.current=l,this.dirty=!1)}}class R_ extends qi{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(l){let m=this.current;(l.func!==m.func||l.ref!==m.ref||l.mask!==m.mask||this.dirty)&&(this.gl.stencilFunc(l.func,l.ref,l.mask),this.current=l,this.dirty=!1)}}class k_ extends qi{getDefault(){let l=this.gl;return[l.KEEP,l.KEEP,l.KEEP]}set(l){let m=this.current;(l[0]!==m[0]||l[1]!==m[1]||l[2]!==m[2]||this.dirty)&&(this.gl.stencilOp(l[0],l[1],l[2]),this.current=l,this.dirty=!1)}}class Um extends qi{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;let m=this.gl;l?m.enable(m.STENCIL_TEST):m.disable(m.STENCIL_TEST),this.current=l,this.dirty=!1}}class D_ extends qi{getDefault(){return[0,1]}set(l){let m=this.current;(l[0]!==m[0]||l[1]!==m[1]||this.dirty)&&(this.gl.depthRange(l[0],l[1]),this.current=l,this.dirty=!1)}}class B_ extends qi{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;let m=this.gl;l?m.enable(m.DEPTH_TEST):m.disable(m.DEPTH_TEST),this.current=l,this.dirty=!1}}class Vm extends qi{getDefault(){return this.gl.LESS}set(l){(l!==this.current||this.dirty)&&(this.gl.depthFunc(l),this.current=l,this.dirty=!1)}}class ob extends qi{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;let m=this.gl;l?m.enable(m.BLEND):m.disable(m.BLEND),this.current=l,this.dirty=!1}}class ab extends qi{getDefault(){let l=this.gl;return[l.ONE,l.ZERO]}set(l){let m=this.current;(l[0]!==m[0]||l[1]!==m[1]||this.dirty)&&(this.gl.blendFunc(l[0],l[1]),this.current=l,this.dirty=!1)}}class Jp extends qi{getDefault(){return n.aT.transparent}set(l){let m=this.current;(l.r!==m.r||l.g!==m.g||l.b!==m.b||l.a!==m.a||this.dirty)&&(this.gl.blendColor(l.r,l.g,l.b,l.a),this.current=l,this.dirty=!1)}}class CT extends qi{getDefault(){return this.gl.FUNC_ADD}set(l){(l!==this.current||this.dirty)&&(this.gl.blendEquation(l),this.current=l,this.dirty=!1)}}class PT extends qi{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;let m=this.gl;l?m.enable(m.CULL_FACE):m.disable(m.CULL_FACE),this.current=l,this.dirty=!1}}class RT extends qi{getDefault(){return this.gl.BACK}set(l){(l!==this.current||this.dirty)&&(this.gl.cullFace(l),this.current=l,this.dirty=!1)}}class kT extends qi{getDefault(){return this.gl.CCW}set(l){(l!==this.current||this.dirty)&&(this.gl.frontFace(l),this.current=l,this.dirty=!1)}}class O_ extends qi{getDefault(){return null}set(l){(l!==this.current||this.dirty)&&(this.gl.useProgram(l),this.current=l,this.dirty=!1)}}class lb extends qi{getDefault(){return this.gl.TEXTURE0}set(l){(l!==this.current||this.dirty)&&(this.gl.activeTexture(l),this.current=l,this.dirty=!1)}}class jm extends qi{getDefault(){let l=this.gl;return[0,0,l.drawingBufferWidth,l.drawingBufferHeight]}set(l){let m=this.current;(l[0]!==m[0]||l[1]!==m[1]||l[2]!==m[2]||l[3]!==m[3]||this.dirty)&&(this.gl.viewport(l[0],l[1],l[2],l[3]),this.current=l,this.dirty=!1)}}class xf extends qi{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;let m=this.gl;m.bindFramebuffer(m.FRAMEBUFFER,l),this.current=l,this.dirty=!1}}class N0 extends qi{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;let m=this.gl;m.bindRenderbuffer(m.RENDERBUFFER,l),this.current=l,this.dirty=!1}}class F0 extends qi{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;let m=this.gl;m.bindTexture(m.TEXTURE_2D,l),this.current=l,this.dirty=!1}}class xh extends qi{getDefault(){return null}set(l){if(l===this.current&&!this.dirty)return;let m=this.gl;m.bindBuffer(m.ARRAY_BUFFER,l),this.current=l,this.dirty=!1}}class td extends qi{getDefault(){return null}set(l){let m=this.gl;m.bindBuffer(m.ELEMENT_ARRAY_BUFFER,l),this.current=l,this.dirty=!1}}class L0 extends qi{getDefault(){return null}set(l){var m;if(l===this.current&&!this.dirty)return;let v=this.gl;yh(v)?v.bindVertexArray(l):(m=v.getExtension("OES_vertex_array_object"))===null||m===void 0||m.bindVertexArrayOES(l),this.current=l,this.dirty=!1}}class Bc extends qi{getDefault(){return 4}set(l){if(l===this.current&&!this.dirty)return;let m=this.gl;m.pixelStorei(m.UNPACK_ALIGNMENT,l),this.current=l,this.dirty=!1}}class se extends qi{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;let m=this.gl;m.pixelStorei(m.UNPACK_PREMULTIPLY_ALPHA_WEBGL,l),this.current=l,this.dirty=!1}}class we extends qi{getDefault(){return!1}set(l){if(l===this.current&&!this.dirty)return;let m=this.gl;m.pixelStorei(m.UNPACK_FLIP_Y_WEBGL,l),this.current=l,this.dirty=!1}}class $e extends qi{constructor(l,m){super(l),this.context=l,this.parent=m}getDefault(){return null}}class Pr extends $e{setDirty(){this.dirty=!0}set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let m=this.gl;m.framebufferTexture2D(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,m.TEXTURE_2D,l,0),this.current=l,this.dirty=!1}}class g extends $e{set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let m=this.gl;m.framebufferRenderbuffer(m.FRAMEBUFFER,m.DEPTH_ATTACHMENT,m.RENDERBUFFER,l),this.current=l,this.dirty=!1}}class bn extends $e{set(l){if(l===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let m=this.gl;m.framebufferRenderbuffer(m.FRAMEBUFFER,m.DEPTH_STENCIL_ATTACHMENT,m.RENDERBUFFER,l),this.current=l,this.dirty=!1}}class _r{constructor(l,m,v,S,C){this.context=l,this.width=m,this.height=v;let L=l.gl,V=this.framebuffer=L.createFramebuffer();if(this.colorAttachment=new Pr(l,V),S)this.depthAttachment=C?new bn(l,V):new g(l,V);else if(C)throw new Error("Stencil cannot be setted without depth");if(L.checkFramebufferStatus(L.FRAMEBUFFER)!==L.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){let l=this.context.gl,m=this.colorAttachment.get();if(m&&l.deleteTexture(m),this.depthAttachment){let v=this.depthAttachment.get();v&&l.deleteRenderbuffer(v)}l.deleteFramebuffer(this.framebuffer)}}class ft{constructor(l,m,v){this.blendFunction=l,this.blendColor=m,this.mask=v}}ft.Replace=[1,0],ft.disabled=new ft(ft.Replace,n.aT.transparent,[!1,!1,!1,!1]),ft.unblended=new ft(ft.Replace,n.aT.transparent,[!0,!0,!0,!0]),ft.alphaBlended=new ft([1,771],n.aT.transparent,[!0,!0,!0,!0]);class ro{constructor(l){var m,v;if(this.gl=l,this.clearColor=new Fm(this),this.clearDepth=new Ja(this),this.clearStencil=new tl(this),this.colorMask=new P_(this),this.depthMask=new Lm(this),this.stencilMask=new zm(this),this.stencilFunc=new R_(this),this.stencilOp=new k_(this),this.stencilTest=new Um(this),this.depthRange=new D_(this),this.depthTest=new B_(this),this.depthFunc=new Vm(this),this.blend=new ob(this),this.blendFunc=new ab(this),this.blendColor=new Jp(this),this.blendEquation=new CT(this),this.cullFace=new PT(this),this.cullFaceSide=new RT(this),this.frontFace=new kT(this),this.program=new O_(this),this.activeTexture=new lb(this),this.viewport=new jm(this),this.bindFramebuffer=new xf(this),this.bindRenderbuffer=new N0(this),this.bindTexture=new F0(this),this.bindVertexBuffer=new xh(this),this.bindElementBuffer=new td(this),this.bindVertexArray=new L0(this),this.pixelStoreUnpack=new Bc(this),this.pixelStoreUnpackPremultiplyAlpha=new se(this),this.pixelStoreUnpackFlipY=new we(this),this.extTextureFilterAnisotropic=l.getExtension("EXT_texture_filter_anisotropic")||l.getExtension("MOZ_EXT_texture_filter_anisotropic")||l.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=l.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=l.getParameter(l.MAX_TEXTURE_SIZE),yh(l)){this.HALF_FLOAT=l.HALF_FLOAT;let S=l.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(m=l.RGBA16F)!==null&&m!==void 0?m:S?.RGBA16F_EXT,this.RGB16F=(v=l.RGB16F)!==null&&v!==void 0?v:S?.RGB16F_EXT,l.getExtension("EXT_color_buffer_float")}else{l.getExtension("EXT_color_buffer_half_float"),l.getExtension("OES_texture_half_float_linear");let S=l.getExtension("OES_texture_half_float");this.HALF_FLOAT=S?.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(l,m){return new Om(this,l,m)}createVertexBuffer(l,m,v){return new Nm(this,l,m,v)}createRenderbuffer(l,m,v){let S=this.gl,C=S.createRenderbuffer();return this.bindRenderbuffer.set(C),S.renderbufferStorage(S.RENDERBUFFER,l,m,v),this.bindRenderbuffer.set(null),C}createFramebuffer(l,m,v,S){return new _r(this,l,m,v,S)}clear({color:l,depth:m,stencil:v}){let S=this.gl,C=0;l&&(C|=S.COLOR_BUFFER_BIT,this.clearColor.set(l),this.colorMask.set([!0,!0,!0,!0])),m!==void 0&&(C|=S.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(m),this.depthMask.set(!0)),v!==void 0&&(C|=S.STENCIL_BUFFER_BIT,this.clearStencil.set(v),this.stencilMask.set(255)),S.clear(C)}setCullFace(l){l.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(l.mode),this.frontFace.set(l.frontFace))}setDepthMode(l){l.func!==this.gl.ALWAYS||l.mask?(this.depthTest.set(!0),this.depthFunc.set(l.func),this.depthMask.set(l.mask),this.depthRange.set(l.range)):this.depthTest.set(!1)}setStencilMode(l){l.test.func!==this.gl.ALWAYS||l.mask?(this.stencilTest.set(!0),this.stencilMask.set(l.mask),this.stencilOp.set([l.fail,l.depthFail,l.pass]),this.stencilFunc.set({func:l.test.func,ref:l.ref,mask:l.test.mask})):this.stencilTest.set(!1)}setColorMode(l){n.aG(l.blendFunction,ft.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(l.blendFunction),this.blendColor.set(l.blendColor)),this.colorMask.set(l.mask)}createVertexArray(){var l;return yh(this.gl)?this.gl.createVertexArray():(l=this.gl.getExtension("OES_vertex_array_object"))===null||l===void 0?void 0:l.createVertexArrayOES()}deleteVertexArray(l){var m;return yh(this.gl)?this.gl.deleteVertexArray(l):(m=this.gl.getExtension("OES_vertex_array_object"))===null||m===void 0?void 0:m.deleteVertexArrayOES(l)}unbindVAO(){this.bindVertexArray.set(null)}}class Vr{constructor(l,m,v){this.func=l,this.mask=m,this.range=v}}Vr.ReadOnly=!1,Vr.ReadWrite=!0,Vr.disabled=new Vr(519,Vr.ReadOnly,[0,1]);let is=7680;class Nr{constructor(l,m,v,S,C,L){this.test=l,this.ref=m,this.mask=v,this.fail=S,this.depthFail=C,this.pass=L}}Nr.disabled=new Nr({func:519,mask:0},0,0,is,is,is);class Qr{constructor(l,m,v){this.enable=l,this.mode=m,this.frontFace=v}}let ys;function ln(M,l,m,v,S,C,L){let V=M.context,$=V.gl,X=M.useProgram("collisionBox"),J=[],tt=0,lt=0;for(let Ot=0;Ot<v.length;Ot++){let Gt=v[Ot],he=l.getTile(Gt),ce=he.getBucket(m);if(!ce)continue;let xe=Gt.posMatrix;S[0]===0&&S[1]===0||(xe=M.translatePosMatrix(Gt.posMatrix,he,S,C));let Pe=L?ce.textCollisionBox:ce.iconCollisionBox,Te=ce.collisionCircleArray;if(Te.length>0){let Fe=n.Z(),ur=xe;n.aU(Fe,ce.placementInvProjMatrix,M.transform.glCoordMatrix),n.aU(Fe,Fe,ce.placementViewportMatrix),J.push({circleArray:Te,circleOffset:lt,transform:ur,invTransform:Fe,coord:Gt}),tt+=Te.length/4,lt=tt}Pe&&X.draw(V,$.LINES,Vr.disabled,Nr.disabled,M.colorModeForRenderPass(),Qr.disabled,gt(xe,M.transform,he),M.style.map.terrain&&M.style.map.terrain.getTerrainData(Gt),m.id,Pe.layoutVertexBuffer,Pe.indexBuffer,Pe.segments,null,M.transform.zoom,null,null,Pe.collisionVertexBuffer)}if(!L||!J.length)return;let bt=M.useProgram("collisionCircle"),yt=new n.aV;yt.resize(4*tt),yt._trim();let Ct=0;for(let Ot of J)for(let Gt=0;Gt<Ot.circleArray.length/4;Gt++){let he=4*Gt,ce=Ot.circleArray[he+0],xe=Ot.circleArray[he+1],Pe=Ot.circleArray[he+2],Te=Ot.circleArray[he+3];yt.emplace(Ct++,ce,xe,Pe,Te,0),yt.emplace(Ct++,ce,xe,Pe,Te,1),yt.emplace(Ct++,ce,xe,Pe,Te,2),yt.emplace(Ct++,ce,xe,Pe,Te,3)}(!ys||ys.length<2*tt)&&(ys=function(Ot){let Gt=2*Ot,he=new n.aX;he.resize(Gt),he._trim();for(let ce=0;ce<Gt;ce++){let xe=6*ce;he.uint16[xe+0]=4*ce+0,he.uint16[xe+1]=4*ce+1,he.uint16[xe+2]=4*ce+2,he.uint16[xe+3]=4*ce+2,he.uint16[xe+4]=4*ce+3,he.uint16[xe+5]=4*ce+0}return he}(tt));let _t=V.createIndexBuffer(ys,!0),Zt=V.createVertexBuffer(yt,n.aW.members,!0);for(let Ot of J){let Gt={u_matrix:Ot.transform,u_inv_matrix:Ot.invTransform,u_camera_to_center_distance:(ne=M.transform).cameraToCenterDistance,u_viewport_size:[ne.width,ne.height]};bt.draw(V,$.TRIANGLES,Vr.disabled,Nr.disabled,M.colorModeForRenderPass(),Qr.disabled,Gt,M.style.map.terrain&&M.style.map.terrain.getTerrainData(Ot.coord),m.id,Zt,_t,n.S.simpleSegment(0,2*Ot.circleOffset,Ot.circleArray.length,Ot.circleArray.length/2),null,M.transform.zoom,null,null,null)}var ne;Zt.destroy(),_t.destroy()}Qr.disabled=new Qr(!1,1029,2305),Qr.backCCW=new Qr(!0,1029,2305);let cn=n.ao(new Float32Array(16));function Au(M,l,m,v,S,C){let{horizontalAlign:L,verticalAlign:V}=n.au(M);return new n.P((-(L-.5)*l/S+v[0])*C,(-(V-.5)*m/S+v[1])*C)}function z0(M,l,m,v,S,C,L,V,$,X,J){let tt=M.text.placedSymbolArray,lt=M.text.dynamicLayoutVertexArray,bt=M.icon.dynamicLayoutVertexArray,yt={};lt.clear();for(let Ct=0;Ct<tt.length;Ct++){let _t=tt.get(Ct),Zt=_t.hidden||!_t.crossTileID||M.allowVerticalPlacement&&!_t.placedOrientation?null:v[_t.crossTileID];if(Zt){let ne=new n.P(_t.anchorX,_t.anchorY),Ot=Zn(ne,m?L:C,J),Gt=Xl(S.cameraToCenterDistance,Ot.signedDistanceFromCamera),he=n.aj(M.textSizeData,$,_t)*Gt/n.ap;m&&(he*=M.tilePixelRatio/V);let{width:ce,height:xe,anchor:Pe,textOffset:Te,textBoxScale:Fe}=Zt,ur=Au(Pe,ce,xe,Te,Fe,he),ki=m?Zn(ne.add(ur),C,J).point:Ot.point.add(l?ur.rotate(-S.angle):ur),We=M.allowVerticalPlacement&&_t.placedOrientation===n.ai.vertical?Math.PI/2:0;for(let Ir=0;Ir<_t.numGlyphs;Ir++)n.ak(lt,ki,We);X&&_t.associatedIconIndex>=0&&(yt[_t.associatedIconIndex]={shiftedAnchor:ki,angle:We})}else At(_t.numGlyphs,lt)}if(X){bt.clear();let Ct=M.icon.placedSymbolArray;for(let _t=0;_t<Ct.length;_t++){let Zt=Ct.get(_t);if(Zt.hidden)At(Zt.numGlyphs,bt);else{let ne=yt[_t];if(ne)for(let Ot=0;Ot<Zt.numGlyphs;Ot++)n.ak(bt,ne.shiftedAnchor,ne.angle);else At(Zt.numGlyphs,bt)}}M.icon.dynamicLayoutVertexBuffer.updateData(bt)}M.text.dynamicLayoutVertexBuffer.updateData(lt)}function $m(M,l,m){return m.iconsInText&&l?"symbolTextAndIcon":M?"symbolSDF":"symbolIcon"}function bf(M,l,m,v,S,C,L,V,$,X,J,tt){let lt=M.context,bt=lt.gl,yt=M.transform,Ct=V==="map",_t=$==="map",Zt=V!=="viewport"&&m.layout.get("symbol-placement")!=="point",ne=Ct&&!_t&&!Zt,Ot=!m.layout.get("symbol-sort-key").isConstant(),Gt=!1,he=M.depthModeForSublayer(0,Vr.ReadOnly),ce=m._unevaluatedLayout.hasValue("text-variable-anchor")||m._unevaluatedLayout.hasValue("text-variable-anchor-offset"),xe=[];for(let Pe of v){let Te=l.getTile(Pe),Fe=Te.getBucket(m);if(!Fe)continue;let ur=S?Fe.text:Fe.icon;if(!ur||!ur.segments.get().length||!ur.hasVisibleVertices)continue;let ki=ur.programConfigurations.get(m.id),We=S||Fe.sdfIcons,Ir=S?Fe.textSizeData:Fe.iconSizeData,hr=_t||yt.pitch!==0,pn=M.useProgram($m(We,S,Fe),ki),Mi=n.ah(Ir,yt.zoom),ui=M.style.map.terrain&&M.style.map.terrain.getTerrainData(Pe),Di,bs,Ln,go,qs=[0,0],vs=null;if(S)bs=Te.glyphAtlasTexture,Ln=bt.LINEAR,Di=Te.glyphAtlasTexture.size,Fe.iconsInText&&(qs=Te.imageAtlasTexture.size,vs=Te.imageAtlasTexture,go=hr||M.options.rotating||M.options.zooming||Ir.kind==="composite"||Ir.kind==="camera"?bt.LINEAR:bt.NEAREST);else{let us=m.layout.get("icon-size").constantOr(0)!==1||Fe.iconsNeedLinear;bs=Te.imageAtlasTexture,Ln=We||M.options.rotating||M.options.zooming||us||hr?bt.LINEAR:bt.NEAREST,Di=Te.imageAtlasTexture.size}let Ia=qt(Te,1,M.transform.zoom),zn=Ne(Pe.posMatrix,_t,Ct,M.transform,Ia),io=ta(Pe.posMatrix,_t,Ct,M.transform,Ia),Sl=ce&&Fe.hasTextData(),bu=m.layout.get("icon-text-fit")!=="none"&&Sl&&Fe.hasIconData();if(Zt){let us=M.style.map.terrain?(oa,Ts)=>M.style.map.terrain.getElevation(Pe,oa,Ts):null,Ys=m.layout.get("text-rotation-alignment")==="map";Ue(Fe,Pe.posMatrix,M,S,zn,io,_t,X,Ys,us)}let Sh=M.translatePosMatrix(Pe.posMatrix,Te,C,L),Cf=Zt||S&&ce||bu?cn:zn,Do=M.translatePosMatrix(io,Te,C,L,!0),_o=We&&m.paint.get(S?"text-halo-width":"icon-halo-width").constantOr(1)!==0,ws;ws=We?Fe.iconsInText?yf(Ir.kind,Mi,ne,_t,M,Sh,Cf,Do,Di,qs):C_(Ir.kind,Mi,ne,_t,M,Sh,Cf,Do,S,Di,!0):M_(Ir.kind,Mi,ne,_t,M,Sh,Cf,Do,S,Di);let vu={program:pn,buffers:ur,uniformValues:ws,atlasTexture:bs,atlasTextureIcon:vs,atlasInterpolation:Ln,atlasInterpolationIcon:go,isSDF:We,hasHalo:_o};if(Ot&&Fe.canOverlap){Gt=!0;let us=ur.segments.get();for(let Ys of us)xe.push({segments:new n.S([Ys]),sortKey:Ys.sortKey,state:vu,terrainData:ui})}else xe.push({segments:ur.segments,sortKey:0,state:vu,terrainData:ui})}Gt&&xe.sort((Pe,Te)=>Pe.sortKey-Te.sortKey);for(let Pe of xe){let Te=Pe.state;if(lt.activeTexture.set(bt.TEXTURE0),Te.atlasTexture.bind(Te.atlasInterpolation,bt.CLAMP_TO_EDGE),Te.atlasTextureIcon&&(lt.activeTexture.set(bt.TEXTURE1),Te.atlasTextureIcon&&Te.atlasTextureIcon.bind(Te.atlasInterpolationIcon,bt.CLAMP_TO_EDGE)),Te.isSDF){let Fe=Te.uniformValues;Te.hasHalo&&(Fe.u_is_halo=1,ra(Te.buffers,Pe.segments,m,M,Te.program,he,J,tt,Fe,Pe.terrainData)),Fe.u_is_halo=0}ra(Te.buffers,Pe.segments,m,M,Te.program,he,J,tt,Te.uniformValues,Pe.terrainData)}}function ra(M,l,m,v,S,C,L,V,$,X){let J=v.context;S.draw(J,J.gl.TRIANGLES,C,L,V,Qr.disabled,$,X,m.id,M.layoutVertexBuffer,M.indexBuffer,l,m.paint,v.transform.zoom,M.programConfigurations.get(m.id),M.dynamicLayoutVertexBuffer,M.opacityVertexBuffer)}function Jl(M,l,m,v,S){if(!m||!v||!v.imageAtlas)return;let C=v.imageAtlas.patternPositions,L=C[m.to.toString()],V=C[m.from.toString()];if(!L&&V&&(L=V),!V&&L&&(V=L),!L||!V){let $=S.getPaintProperty(l);L=C[$],V=C[$]}L&&V&&M.setConstantPatternPositions(L,V)}function ia(M,l,m,v,S,C,L){let V=M.context.gl,$="fill-pattern",X=m.paint.get($),J=X&&X.constantOr(1),tt=m.getCrossfadeParameters(),lt,bt,yt,Ct,_t;L?(bt=J&&!m.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",lt=V.LINES):(bt=J?"fillPattern":"fill",lt=V.TRIANGLES);let Zt=X.constantOr(null);for(let ne of v){let Ot=l.getTile(ne);if(J&&!Ot.patternsLoaded())continue;let Gt=Ot.getBucket(m);if(!Gt)continue;let he=Gt.programConfigurations.get(m.id),ce=M.useProgram(bt,he),xe=M.style.map.terrain&&M.style.map.terrain.getTerrainData(ne);J&&(M.context.activeTexture.set(V.TEXTURE0),Ot.imageAtlasTexture.bind(V.LINEAR,V.CLAMP_TO_EDGE),he.updatePaintBuffers(tt)),Jl(he,$,Zt,Ot,m);let Pe=xe?ne:null,Te=M.translatePosMatrix(Pe?Pe.posMatrix:ne.posMatrix,Ot,m.paint.get("fill-translate"),m.paint.get("fill-translate-anchor"));if(L){Ct=Gt.indexBuffer2,_t=Gt.segments2;let Fe=[V.drawingBufferWidth,V.drawingBufferHeight];yt=bt==="fillOutlinePattern"&&J?Qp(Te,M,tt,Ot,Fe):Gp(Te,Fe)}else Ct=Gt.indexBuffer,_t=Gt.segments,yt=J?Zp(Te,M,tt,Ot):Xp(Te);ce.draw(M.context,lt,S,M.stencilModeForClipping(ne),C,Qr.disabled,yt,xe,m.id,Gt.layoutVertexBuffer,Ct,_t,m.paint,M.transform.zoom,he)}}function bh(M,l,m,v,S,C,L){let V=M.context,$=V.gl,X="fill-extrusion-pattern",J=m.paint.get(X),tt=J.constantOr(1),lt=m.getCrossfadeParameters(),bt=m.paint.get("fill-extrusion-opacity"),yt=J.constantOr(null);for(let Ct of v){let _t=l.getTile(Ct),Zt=_t.getBucket(m);if(!Zt)continue;let ne=M.style.map.terrain&&M.style.map.terrain.getTerrainData(Ct),Ot=Zt.programConfigurations.get(m.id),Gt=M.useProgram(tt?"fillExtrusionPattern":"fillExtrusion",Ot);tt&&(M.context.activeTexture.set($.TEXTURE0),_t.imageAtlasTexture.bind($.LINEAR,$.CLAMP_TO_EDGE),Ot.updatePaintBuffers(lt)),Jl(Ot,X,yt,_t,m);let he=M.translatePosMatrix(Ct.posMatrix,_t,m.paint.get("fill-extrusion-translate"),m.paint.get("fill-extrusion-translate-anchor")),ce=m.paint.get("fill-extrusion-vertical-gradient"),xe=tt?Kl(he,M,ce,bt,Ct,lt,_t):B0(he,M,ce,bt);Gt.draw(V,V.gl.TRIANGLES,S,C,L,Qr.backCCW,xe,ne,m.id,Zt.layoutVertexBuffer,Zt.indexBuffer,Zt.segments,m.paint,M.transform.zoom,Ot,M.style.map.terrain&&Zt.centroidVertexBuffer)}}function cb(M,l,m,v,S,C,L){let V=M.context,$=V.gl,X=m.fbo;if(!X)return;let J=M.useProgram("hillshade"),tt=M.style.map.terrain&&M.style.map.terrain.getTerrainData(l);V.activeTexture.set($.TEXTURE0),$.bindTexture($.TEXTURE_2D,X.colorAttachment.get()),J.draw(V,$.TRIANGLES,S,C,L,Qr.disabled,((lt,bt,yt,Ct)=>{let _t=yt.paint.get("hillshade-shadow-color"),Zt=yt.paint.get("hillshade-highlight-color"),ne=yt.paint.get("hillshade-accent-color"),Ot=yt.paint.get("hillshade-illumination-direction")*(Math.PI/180);yt.paint.get("hillshade-illumination-anchor")==="viewport"&&(Ot-=lt.transform.angle);let Gt=!lt.options.moving;return{u_matrix:Ct?Ct.posMatrix:lt.transform.calculatePosMatrix(bt.tileID.toUnwrapped(),Gt),u_image:0,u_latrange:ar(0,bt.tileID),u_light:[yt.paint.get("hillshade-exaggeration"),Ot],u_shadow:_t,u_highlight:Zt,u_accent:ne}})(M,m,v,tt?l:null),tt,v.id,M.rasterBoundsBuffer,M.quadTriangleIndexBuffer,M.rasterBoundsSegments)}function Oc(M,l,m,v,S,C){let L=M.context,V=L.gl,$=l.dem;if($&&$.data){let X=$.dim,J=$.stride,tt=$.getPixels();if(L.activeTexture.set(V.TEXTURE1),L.pixelStoreUnpackPremultiplyAlpha.set(!1),l.demTexture=l.demTexture||M.getTileTexture(J),l.demTexture){let bt=l.demTexture;bt.update(tt,{premultiply:!1}),bt.bind(V.NEAREST,V.CLAMP_TO_EDGE)}else l.demTexture=new Tt(L,tt,V.RGBA,{premultiply:!1}),l.demTexture.bind(V.NEAREST,V.CLAMP_TO_EDGE);L.activeTexture.set(V.TEXTURE0);let lt=l.fbo;if(!lt){let bt=new Tt(L,{width:X,height:X,data:null},V.RGBA);bt.bind(V.LINEAR,V.CLAMP_TO_EDGE),lt=l.fbo=L.createFramebuffer(X,X,!0,!1),lt.colorAttachment.set(bt.texture)}L.bindFramebuffer.set(lt.framebuffer),L.viewport.set([0,0,X,X]),M.useProgram("hillshadePrepare").draw(L,V.TRIANGLES,v,S,C,Qr.disabled,((bt,yt)=>{let Ct=yt.stride,_t=n.Z();return n.aS(_t,0,n.N,-n.N,0,0,1),n.$(_t,_t,[0,-n.N,0]),{u_matrix:_t,u_image:1,u_dimension:[Ct,Ct],u_zoom:bt.overscaledZ,u_unpack:yt.getUnpackVector()}})(l.tileID,$),null,m.id,M.rasterBoundsBuffer,M.quadTriangleIndexBuffer,M.rasterBoundsSegments),l.needsHillshadePrepare=!1}}function Si(M,l,m,v,S,C){let L=v.paint.get("raster-fade-duration");if(!C&&L>0){let V=n.h.now(),$=(V-M.timeAdded)/L,X=l?(V-l.timeAdded)/L:-1,J=m.getSource(),tt=S.coveringZoomLevel({tileSize:J.tileSize,roundZoom:J.roundZoom}),lt=!l||Math.abs(l.tileID.overscaledZ-tt)>Math.abs(M.tileID.overscaledZ-tt),bt=lt&&M.refreshedUponExpiration?1:n.ad(lt?$:1-X,0,1);return M.refreshedUponExpiration&&$>=1&&(M.refreshedUponExpiration=!1),l?{opacity:1,mix:1-bt}:{opacity:bt,mix:0}}return{opacity:1,mix:0}}let wt=new n.aT(1,0,0,1),Lr=new n.aT(0,1,0,1),U0=new n.aT(0,0,1,1),N_=new n.aT(1,0,1,1),F_=new n.aT(0,1,1,1);function ed(M,l,m,v){pt(M,0,l+m/2,M.transform.width,m,v)}function V0(M,l,m,v){pt(M,l-m/2,0,m,M.transform.height,v)}function pt(M,l,m,v,S,C){let L=M.context,V=L.gl;V.enable(V.SCISSOR_TEST),V.scissor(l*M.pixelRatio,m*M.pixelRatio,v*M.pixelRatio,S*M.pixelRatio),L.clear({color:C}),V.disable(V.SCISSOR_TEST)}function L_(M,l,m){let v=M.context,S=v.gl,C=m.posMatrix,L=M.useProgram("debug"),V=Vr.disabled,$=Nr.disabled,X=M.colorModeForRenderPass(),J="$debug",tt=M.style.map.terrain&&M.style.map.terrain.getTerrainData(m);v.activeTexture.set(S.TEXTURE0);let lt=l.getTileByID(m.key).latestRawTileData,bt=Math.floor((lt&&lt.byteLength||0)/1024),yt=l.getTile(m).tileSize,Ct=512/Math.min(yt,512)*(m.overscaledZ/M.transform.zoom)*.5,_t=m.canonical.toString();m.overscaledZ!==m.canonical.z&&(_t+=` => ${m.overscaledZ}`),function(Zt,ne){Zt.initDebugOverlayCanvas();let Ot=Zt.debugOverlayCanvas,Gt=Zt.context.gl,he=Zt.debugOverlayCanvas.getContext("2d");he.clearRect(0,0,Ot.width,Ot.height),he.shadowColor="white",he.shadowBlur=2,he.lineWidth=1.5,he.strokeStyle="white",he.textBaseline="top",he.font="bold 36px Open Sans, sans-serif",he.fillText(ne,5,5),he.strokeText(ne,5,5),Zt.debugOverlayTexture.update(Ot),Zt.debugOverlayTexture.bind(Gt.LINEAR,Gt.CLAMP_TO_EDGE)}(M,`${_t} ${bt}kB`),L.draw(v,S.TRIANGLES,V,$,ft.alphaBlended,Qr.disabled,$t(C,n.aT.transparent,Ct),null,J,M.debugBuffer,M.quadTriangleIndexBuffer,M.debugSegments),L.draw(v,S.LINE_STRIP,V,$,X,Qr.disabled,$t(C,n.aT.red),tt,J,M.debugBuffer,M.tileBorderIndexBuffer,M.debugSegments)}function cs(M,l,m){let v=M.context,S=v.gl,C=M.colorModeForRenderPass(),L=new Vr(S.LEQUAL,Vr.ReadWrite,M.depthRangeFor3D),V=M.useProgram("terrain"),$=l.getTerrainMesh();v.bindFramebuffer.set(null),v.viewport.set([0,0,M.width,M.height]);for(let X of m){let J=M.renderToTexture.getTexture(X),tt=l.getTerrainData(X.tileID);v.activeTexture.set(S.TEXTURE0),S.bindTexture(S.TEXTURE_2D,J.texture);let lt={u_matrix:M.transform.calculatePosMatrix(X.tileID.toUnwrapped()),u_texture:0,u_ele_delta:l.getMeshFrameDelta(M.transform.zoom)};V.draw(v,S.TRIANGLES,L,Nr.disabled,C,Qr.backCCW,lt,tt,"terrain",$.vertexBuffer,$.indexBuffer,$.segments)}}class vh{constructor(l,m){this.context=new ro(l),this.transform=m,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:n.Z(),renderTime:0},this.setup(),this.numSublayers=Xn.maxUnderzooming+Xn.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Dc}resize(l,m,v){if(this.width=Math.floor(l*v),this.height=Math.floor(m*v),this.pixelRatio=v,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(let S of this.style._order)this.style._layers[S].resize()}setup(){let l=this.context,m=new n.a_;m.emplaceBack(0,0),m.emplaceBack(n.N,0),m.emplaceBack(0,n.N),m.emplaceBack(n.N,n.N),this.tileExtentBuffer=l.createVertexBuffer(m,ko.members),this.tileExtentSegments=n.S.simpleSegment(0,0,4,2);let v=new n.a_;v.emplaceBack(0,0),v.emplaceBack(n.N,0),v.emplaceBack(0,n.N),v.emplaceBack(n.N,n.N),this.debugBuffer=l.createVertexBuffer(v,ko.members),this.debugSegments=n.S.simpleSegment(0,0,4,5);let S=new n.V;S.emplaceBack(0,0,0,0),S.emplaceBack(n.N,0,n.N,0),S.emplaceBack(0,n.N,0,n.N),S.emplaceBack(n.N,n.N,n.N,n.N),this.rasterBoundsBuffer=l.createVertexBuffer(S,Fr.members),this.rasterBoundsSegments=n.S.simpleSegment(0,0,4,2);let C=new n.a_;C.emplaceBack(0,0),C.emplaceBack(1,0),C.emplaceBack(0,1),C.emplaceBack(1,1),this.viewportBuffer=l.createVertexBuffer(C,ko.members),this.viewportSegments=n.S.simpleSegment(0,0,4,2);let L=new n.a$;L.emplaceBack(0),L.emplaceBack(1),L.emplaceBack(3),L.emplaceBack(2),L.emplaceBack(0),this.tileBorderIndexBuffer=l.createIndexBuffer(L);let V=new n.b0;V.emplaceBack(0,1,2),V.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=l.createIndexBuffer(V);let $=this.context.gl;this.stencilClearMode=new Nr({func:$.ALWAYS,mask:0},0,255,$.ZERO,$.ZERO,$.ZERO)}clearStencil(){let l=this.context,m=l.gl;this.nextStencilID=1,this.currentStencilSource=void 0;let v=n.Z();n.aS(v,0,this.width,this.height,0,0,1),n.a0(v,v,[m.drawingBufferWidth,m.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(l,m.TRIANGLES,Vr.disabled,this.stencilClearMode,ft.disabled,Qr.disabled,pe(v),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(l,m){if(this.currentStencilSource===l.source||!l.isTileClipped()||!m||!m.length)return;this.currentStencilSource=l.source;let v=this.context,S=v.gl;this.nextStencilID+m.length>256&&this.clearStencil(),v.setColorMode(ft.disabled),v.setDepthMode(Vr.disabled);let C=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(let L of m){let V=this._tileClippingMaskIDs[L.key]=this.nextStencilID++,$=this.style.map.terrain&&this.style.map.terrain.getTerrainData(L);C.draw(v,S.TRIANGLES,Vr.disabled,new Nr({func:S.ALWAYS,mask:0},V,255,S.KEEP,S.KEEP,S.REPLACE),ft.disabled,Qr.disabled,pe(L.posMatrix),$,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();let l=this.nextStencilID++,m=this.context.gl;return new Nr({func:m.NOTEQUAL,mask:255},l,255,m.KEEP,m.KEEP,m.REPLACE)}stencilModeForClipping(l){let m=this.context.gl;return new Nr({func:m.EQUAL,mask:255},this._tileClippingMaskIDs[l.key],0,m.KEEP,m.KEEP,m.REPLACE)}stencilConfigForOverlap(l){let m=this.context.gl,v=l.sort((L,V)=>V.overscaledZ-L.overscaledZ),S=v[v.length-1].overscaledZ,C=v[0].overscaledZ-S+1;if(C>1){this.currentStencilSource=void 0,this.nextStencilID+C>256&&this.clearStencil();let L={};for(let V=0;V<C;V++)L[V+S]=new Nr({func:m.GEQUAL,mask:255},V+this.nextStencilID,255,m.KEEP,m.KEEP,m.REPLACE);return this.nextStencilID+=C,[L,v]}return[{[S]:Nr.disabled},v]}colorModeForRenderPass(){let l=this.context.gl;return this._showOverdrawInspector?new ft([l.CONSTANT_COLOR,l.ONE],new n.aT(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?ft.unblended:ft.alphaBlended}depthModeForSublayer(l,m,v){if(!this.opaquePassEnabledForLayer())return Vr.disabled;let S=1-((1+this.currentLayer)*this.numSublayers+l)*this.depthEpsilon;return new Vr(v||this.context.gl.LEQUAL,m,[S,S])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(l,m){this.style=l,this.options=m,this.lineAtlas=l.lineAtlas,this.imageManager=l.imageManager,this.glyphManager=l.glyphManager,this.symbolFadeChange=l.placement.symbolFadeChange(n.h.now()),this.imageManager.beginFrame();let v=this.style._order,S=this.style.sourceCaches,C={},L={},V={};for(let $ in S){let X=S[$];X.used&&X.prepare(this.context),C[$]=X.getVisibleCoordinates(),L[$]=C[$].slice().reverse(),V[$]=X.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let $=0;$<v.length;$++)if(this.style._layers[v[$]].is3D()){this.opaquePassCutoff=$;break}if(this.renderToTexture){this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0;let $=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!n.b1(this.terrainFacilitator.matrix,this.transform.projMatrix)||$.length)&&(n.b2(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(X,J){let tt=X.context,lt=tt.gl,bt=ft.unblended,yt=new Vr(lt.LEQUAL,Vr.ReadWrite,[0,1]),Ct=J.getTerrainMesh(),_t=J.sourceCache.getRenderableTiles(),Zt=X.useProgram("terrainDepth");tt.bindFramebuffer.set(J.getFramebuffer("depth").framebuffer),tt.viewport.set([0,0,X.width/devicePixelRatio,X.height/devicePixelRatio]),tt.clear({color:n.aT.transparent,depth:1});for(let ne of _t){let Ot=J.getTerrainData(ne.tileID),Gt={u_matrix:X.transform.calculatePosMatrix(ne.tileID.toUnwrapped()),u_ele_delta:J.getMeshFrameDelta(X.transform.zoom)};Zt.draw(tt,lt.TRIANGLES,yt,Nr.disabled,bt,Qr.backCCW,Gt,Ot,"terrain",Ct.vertexBuffer,Ct.indexBuffer,Ct.segments)}tt.bindFramebuffer.set(null),tt.viewport.set([0,0,X.width,X.height])}(this,this.style.map.terrain),function(X,J){let tt=X.context,lt=tt.gl,bt=ft.unblended,yt=new Vr(lt.LEQUAL,Vr.ReadWrite,[0,1]),Ct=J.getTerrainMesh(),_t=J.getCoordsTexture(),Zt=J.sourceCache.getRenderableTiles(),ne=X.useProgram("terrainCoords");tt.bindFramebuffer.set(J.getFramebuffer("coords").framebuffer),tt.viewport.set([0,0,X.width/devicePixelRatio,X.height/devicePixelRatio]),tt.clear({color:n.aT.transparent,depth:1}),J.coordsIndex=[];for(let Ot of Zt){let Gt=J.getTerrainData(Ot.tileID);tt.activeTexture.set(lt.TEXTURE0),lt.bindTexture(lt.TEXTURE_2D,_t.texture);let he={u_matrix:X.transform.calculatePosMatrix(Ot.tileID.toUnwrapped()),u_terrain_coords_id:(255-J.coordsIndex.length)/255,u_texture:0,u_ele_delta:J.getMeshFrameDelta(X.transform.zoom)};ne.draw(tt,lt.TRIANGLES,yt,Nr.disabled,bt,Qr.backCCW,he,Gt,"terrain",Ct.vertexBuffer,Ct.indexBuffer,Ct.segments),J.coordsIndex.push(Ot.tileID.key)}tt.bindFramebuffer.set(null),tt.viewport.set([0,0,X.width,X.height])}(this,this.style.map.terrain))}this.renderPass="offscreen";for(let $ of v){let X=this.style._layers[$];if(!X.hasOffscreenPass()||X.isHidden(this.transform.zoom))continue;let J=L[X.source];(X.type==="custom"||J.length)&&this.renderLayer(this,S[X.source],X,J)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:m.showOverdrawInspector?n.aT.black:n.aT.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=m.showOverdrawInspector,this.depthRangeFor3D=[0,1-(l._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=v.length-1;this.currentLayer>=0;this.currentLayer--){let $=this.style._layers[v[this.currentLayer]],X=S[$.source],J=C[$.source];this._renderTileClippingMasks($,J),this.renderLayer(this,X,$,J)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<v.length;this.currentLayer++){let $=this.style._layers[v[this.currentLayer]],X=S[$.source];if(this.renderToTexture&&this.renderToTexture.renderLayer($))continue;let J=($.type==="symbol"?V:L)[$.source];this._renderTileClippingMasks($,C[$.source]),this.renderLayer(this,X,$,J)}if(this.options.showTileBoundaries){let $=function(X,J){let tt=null,lt=Object.values(X._layers).flatMap(_t=>_t.source&&!_t.isHidden(J)?[X.sourceCaches[_t.source]]:[]),bt=lt.filter(_t=>_t.getSource().type==="vector"),yt=lt.filter(_t=>_t.getSource().type!=="vector"),Ct=_t=>{(!tt||tt.getSource().maxzoom<_t.getSource().maxzoom)&&(tt=_t)};return bt.forEach(_t=>Ct(_t)),tt||yt.forEach(_t=>Ct(_t)),tt}(this.style,this.transform.zoom);$&&function(X,J,tt){for(let lt=0;lt<tt.length;lt++)L_(X,J,tt[lt])}(this,$,$.getVisibleCoordinates())}this.options.showPadding&&function($){let X=$.transform.padding;ed($,$.transform.height-(X.top||0),3,wt),ed($,X.bottom||0,3,Lr),V0($,X.left||0,3,U0),V0($,$.transform.width-(X.right||0),3,N_);let J=$.transform.centerPoint;(function(tt,lt,bt,yt){pt(tt,lt-1,bt-10,2,20,yt),pt(tt,lt-10,bt-1,20,2,yt)})($,J.x,$.transform.height-J.y,F_)}(this),this.context.setDefault()}renderLayer(l,m,v,S){if(!v.isHidden(this.transform.zoom)&&(v.type==="background"||v.type==="custom"||(S||[]).length))switch(this.id=v.id,v.type){case"symbol":(function(C,L,V,$,X){if(C.renderPass!=="translucent")return;let J=Nr.disabled,tt=C.colorModeForRenderPass();(V._unevaluatedLayout.hasValue("text-variable-anchor")||V._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(lt,bt,yt,Ct,_t,Zt,ne){let Ot=bt.transform,Gt=_t==="map",he=Zt==="map";for(let ce of lt){let xe=Ct.getTile(ce),Pe=xe.getBucket(yt);if(!Pe||!Pe.text||!Pe.text.segments.get().length)continue;let Te=n.ah(Pe.textSizeData,Ot.zoom),Fe=qt(xe,1,bt.transform.zoom),ur=Ne(ce.posMatrix,he,Gt,bt.transform,Fe),ki=yt.layout.get("icon-text-fit")!=="none"&&Pe.hasIconData();if(Te){let We=Math.pow(2,Ot.zoom-xe.tileID.overscaledZ);z0(Pe,Gt,he,ne,Ot,ur,ce.posMatrix,We,Te,ki,bt.style.map.terrain?(Ir,hr)=>bt.style.map.terrain.getElevation(ce,Ir,hr):null)}}}($,C,V,L,V.layout.get("text-rotation-alignment"),V.layout.get("text-pitch-alignment"),X),V.paint.get("icon-opacity").constantOr(1)!==0&&bf(C,L,V,$,!1,V.paint.get("icon-translate"),V.paint.get("icon-translate-anchor"),V.layout.get("icon-rotation-alignment"),V.layout.get("icon-pitch-alignment"),V.layout.get("icon-keep-upright"),J,tt),V.paint.get("text-opacity").constantOr(1)!==0&&bf(C,L,V,$,!0,V.paint.get("text-translate"),V.paint.get("text-translate-anchor"),V.layout.get("text-rotation-alignment"),V.layout.get("text-pitch-alignment"),V.layout.get("text-keep-upright"),J,tt),L.map.showCollisionBoxes&&(ln(C,L,V,$,V.paint.get("text-translate"),V.paint.get("text-translate-anchor"),!0),ln(C,L,V,$,V.paint.get("icon-translate"),V.paint.get("icon-translate-anchor"),!1))})(l,m,v,S,this.style.placement.variableOffsets);break;case"circle":(function(C,L,V,$){if(C.renderPass!=="translucent")return;let X=V.paint.get("circle-opacity"),J=V.paint.get("circle-stroke-width"),tt=V.paint.get("circle-stroke-opacity"),lt=!V.layout.get("circle-sort-key").isConstant();if(X.constantOr(1)===0&&(J.constantOr(1)===0||tt.constantOr(1)===0))return;let bt=C.context,yt=bt.gl,Ct=C.depthModeForSublayer(0,Vr.ReadOnly),_t=Nr.disabled,Zt=C.colorModeForRenderPass(),ne=[];for(let Ot=0;Ot<$.length;Ot++){let Gt=$[Ot],he=L.getTile(Gt),ce=he.getBucket(V);if(!ce)continue;let xe=ce.programConfigurations.get(V.id),Pe=C.useProgram("circle",xe),Te=ce.layoutVertexBuffer,Fe=ce.indexBuffer,ur=C.style.map.terrain&&C.style.map.terrain.getTerrainData(Gt),ki={programConfiguration:xe,program:Pe,layoutVertexBuffer:Te,indexBuffer:Fe,uniformValues:ut(C,Gt,he,V),terrainData:ur};if(lt){let We=ce.segments.get();for(let Ir of We)ne.push({segments:new n.S([Ir]),sortKey:Ir.sortKey,state:ki})}else ne.push({segments:ce.segments,sortKey:0,state:ki})}lt&&ne.sort((Ot,Gt)=>Ot.sortKey-Gt.sortKey);for(let Ot of ne){let{programConfiguration:Gt,program:he,layoutVertexBuffer:ce,indexBuffer:xe,uniformValues:Pe,terrainData:Te}=Ot.state;he.draw(bt,yt.TRIANGLES,Ct,_t,Zt,Qr.disabled,Pe,Te,V.id,ce,xe,Ot.segments,V.paint,C.transform.zoom,Gt)}})(l,m,v,S);break;case"heatmap":(function(C,L,V,$){if(V.paint.get("heatmap-opacity")!==0)if(C.renderPass==="offscreen"){let X=C.context,J=X.gl,tt=Nr.disabled,lt=new ft([J.ONE,J.ONE],n.aT.transparent,[!0,!0,!0,!0]);(function(bt,yt,Ct){let _t=bt.gl;bt.activeTexture.set(_t.TEXTURE1),bt.viewport.set([0,0,yt.width/4,yt.height/4]);let Zt=Ct.heatmapFbo;if(Zt)_t.bindTexture(_t.TEXTURE_2D,Zt.colorAttachment.get()),bt.bindFramebuffer.set(Zt.framebuffer);else{let ne=_t.createTexture();_t.bindTexture(_t.TEXTURE_2D,ne),_t.texParameteri(_t.TEXTURE_2D,_t.TEXTURE_WRAP_S,_t.CLAMP_TO_EDGE),_t.texParameteri(_t.TEXTURE_2D,_t.TEXTURE_WRAP_T,_t.CLAMP_TO_EDGE),_t.texParameteri(_t.TEXTURE_2D,_t.TEXTURE_MIN_FILTER,_t.LINEAR),_t.texParameteri(_t.TEXTURE_2D,_t.TEXTURE_MAG_FILTER,_t.LINEAR),Zt=Ct.heatmapFbo=bt.createFramebuffer(yt.width/4,yt.height/4,!1,!1),function(Ot,Gt,he,ce){var xe,Pe;let Te=Ot.gl,Fe=(xe=Ot.HALF_FLOAT)!==null&&xe!==void 0?xe:Te.UNSIGNED_BYTE,ur=(Pe=Ot.RGBA16F)!==null&&Pe!==void 0?Pe:Te.RGBA;Te.texImage2D(Te.TEXTURE_2D,0,ur,Gt.width/4,Gt.height/4,0,Te.RGBA,Fe,null),ce.colorAttachment.set(he)}(bt,yt,ne,Zt)}})(X,C,V),X.clear({color:n.aT.transparent});for(let bt=0;bt<$.length;bt++){let yt=$[bt];if(L.hasRenderableParent(yt))continue;let Ct=L.getTile(yt),_t=Ct.getBucket(V);if(!_t)continue;let Zt=_t.programConfigurations.get(V.id),ne=C.useProgram("heatmap",Zt),{zoom:Ot}=C.transform;ne.draw(X,J.TRIANGLES,Vr.disabled,tt,lt,Qr.disabled,Oe(yt.posMatrix,Ct,Ot,V.paint.get("heatmap-intensity")),null,V.id,_t.layoutVertexBuffer,_t.indexBuffer,_t.segments,V.paint,C.transform.zoom,Zt)}X.viewport.set([0,0,C.width,C.height])}else C.renderPass==="translucent"&&(C.context.setColorMode(C.colorModeForRenderPass()),function(X,J){let tt=X.context,lt=tt.gl,bt=J.heatmapFbo;if(!bt)return;tt.activeTexture.set(lt.TEXTURE0),lt.bindTexture(lt.TEXTURE_2D,bt.colorAttachment.get()),tt.activeTexture.set(lt.TEXTURE1);let yt=J.colorRampTexture;yt||(yt=J.colorRampTexture=new Tt(tt,J.colorRamp,lt.RGBA)),yt.bind(lt.LINEAR,lt.CLAMP_TO_EDGE),X.useProgram("heatmapTexture").draw(tt,lt.TRIANGLES,Vr.disabled,Nr.disabled,X.colorModeForRenderPass(),Qr.disabled,((Ct,_t,Zt,ne)=>{let Ot=n.Z();n.aS(Ot,0,Ct.width,Ct.height,0,0,1);let Gt=Ct.context.gl;return{u_matrix:Ot,u_world:[Gt.drawingBufferWidth,Gt.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:_t.paint.get("heatmap-opacity")}})(X,J),null,J.id,X.viewportBuffer,X.quadTriangleIndexBuffer,X.viewportSegments,J.paint,X.transform.zoom)}(C,V))})(l,m,v,S);break;case"line":(function(C,L,V,$){if(C.renderPass!=="translucent")return;let X=V.paint.get("line-opacity"),J=V.paint.get("line-width");if(X.constantOr(1)===0||J.constantOr(1)===0)return;let tt=C.depthModeForSublayer(0,Vr.ReadOnly),lt=C.colorModeForRenderPass(),bt=V.paint.get("line-dasharray"),yt=V.paint.get("line-pattern"),Ct=yt.constantOr(1),_t=V.paint.get("line-gradient"),Zt=V.getCrossfadeParameters(),ne=Ct?"linePattern":bt?"lineSDF":_t?"lineGradient":"line",Ot=C.context,Gt=Ot.gl,he=!0;for(let ce of $){let xe=L.getTile(ce);if(Ct&&!xe.patternsLoaded())continue;let Pe=xe.getBucket(V);if(!Pe)continue;let Te=Pe.programConfigurations.get(V.id),Fe=C.context.program.get(),ur=C.useProgram(ne,Te),ki=he||ur.program!==Fe,We=C.style.map.terrain&&C.style.map.terrain.getTerrainData(ce),Ir=yt.constantOr(null);if(Ir&&xe.imageAtlas){let Mi=xe.imageAtlas,ui=Mi.patternPositions[Ir.to.toString()],Di=Mi.patternPositions[Ir.from.toString()];ui&&Di&&Te.setConstantPatternPositions(ui,Di)}let hr=We?ce:null,pn=Ct?eo(C,xe,V,Zt,hr):bt?mo(C,xe,V,bt,Zt,hr):_t?Ns(C,xe,V,Pe.lineClipsArray.length,hr):Ri(C,xe,V,hr);if(Ct)Ot.activeTexture.set(Gt.TEXTURE0),xe.imageAtlasTexture.bind(Gt.LINEAR,Gt.CLAMP_TO_EDGE),Te.updatePaintBuffers(Zt);else if(bt&&(ki||C.lineAtlas.dirty))Ot.activeTexture.set(Gt.TEXTURE0),C.lineAtlas.bind(Ot);else if(_t){let Mi=Pe.gradients[V.id],ui=Mi.texture;if(V.gradientVersion!==Mi.version){let Di=256;if(V.stepInterpolant){let bs=L.getSource().maxzoom,Ln=ce.canonical.z===bs?Math.ceil(1<<C.transform.maxZoom-ce.canonical.z):1;Di=n.ad(n.aY(Pe.maxLineLength/n.N*1024*Ln),256,Ot.maxTextureSize)}Mi.gradient=n.aZ({expression:V.gradientExpression(),evaluationKey:"lineProgress",resolution:Di,image:Mi.gradient||void 0,clips:Pe.lineClipsArray}),Mi.texture?Mi.texture.update(Mi.gradient):Mi.texture=new Tt(Ot,Mi.gradient,Gt.RGBA),Mi.version=V.gradientVersion,ui=Mi.texture}Ot.activeTexture.set(Gt.TEXTURE0),ui.bind(V.stepInterpolant?Gt.NEAREST:Gt.LINEAR,Gt.CLAMP_TO_EDGE)}ur.draw(Ot,Gt.TRIANGLES,tt,C.stencilModeForClipping(ce),lt,Qr.disabled,pn,We,V.id,Pe.layoutVertexBuffer,Pe.indexBuffer,Pe.segments,V.paint,C.transform.zoom,Te,Pe.layoutVertexBuffer2),he=!1}})(l,m,v,S);break;case"fill":(function(C,L,V,$){let X=V.paint.get("fill-color"),J=V.paint.get("fill-opacity");if(J.constantOr(1)===0)return;let tt=C.colorModeForRenderPass(),lt=V.paint.get("fill-pattern"),bt=C.opaquePassEnabledForLayer()&&!lt.constantOr(1)&&X.constantOr(n.aT.transparent).a===1&&J.constantOr(0)===1?"opaque":"translucent";if(C.renderPass===bt){let yt=C.depthModeForSublayer(1,C.renderPass==="opaque"?Vr.ReadWrite:Vr.ReadOnly);ia(C,L,V,$,yt,tt,!1)}if(C.renderPass==="translucent"&&V.paint.get("fill-antialias")){let yt=C.depthModeForSublayer(V.getPaintProperty("fill-outline-color")?2:0,Vr.ReadOnly);ia(C,L,V,$,yt,tt,!0)}})(l,m,v,S);break;case"fill-extrusion":(function(C,L,V,$){let X=V.paint.get("fill-extrusion-opacity");if(X!==0&&C.renderPass==="translucent"){let J=new Vr(C.context.gl.LEQUAL,Vr.ReadWrite,C.depthRangeFor3D);if(X!==1||V.paint.get("fill-extrusion-pattern").constantOr(1))bh(C,L,V,$,J,Nr.disabled,ft.disabled),bh(C,L,V,$,J,C.stencilModeFor3D(),C.colorModeForRenderPass());else{let tt=C.colorModeForRenderPass();bh(C,L,V,$,J,Nr.disabled,tt)}}})(l,m,v,S);break;case"hillshade":(function(C,L,V,$){if(C.renderPass!=="offscreen"&&C.renderPass!=="translucent")return;let X=C.context,J=C.depthModeForSublayer(0,Vr.ReadOnly),tt=C.colorModeForRenderPass(),[lt,bt]=C.renderPass==="translucent"?C.stencilConfigForOverlap($):[{},$];for(let yt of bt){let Ct=L.getTile(yt);Ct.needsHillshadePrepare!==void 0&&Ct.needsHillshadePrepare&&C.renderPass==="offscreen"?Oc(C,Ct,V,J,Nr.disabled,tt):C.renderPass==="translucent"&&cb(C,yt,Ct,V,J,lt[yt.overscaledZ],tt)}X.viewport.set([0,0,C.width,C.height])})(l,m,v,S);break;case"raster":(function(C,L,V,$){if(C.renderPass!=="translucent"||V.paint.get("raster-opacity")===0||!$.length)return;let X=C.context,J=X.gl,tt=L.getSource(),lt=C.useProgram("raster"),bt=C.colorModeForRenderPass(),[yt,Ct]=tt instanceof Dr?[{},$]:C.stencilConfigForOverlap($),_t=Ct[Ct.length-1].overscaledZ,Zt=!C.options.moving;for(let ne of Ct){let Ot=C.depthModeForSublayer(ne.overscaledZ-_t,V.paint.get("raster-opacity")===1?Vr.ReadWrite:Vr.ReadOnly,J.LESS),Gt=L.getTile(ne);Gt.registerFadeDuration(V.paint.get("raster-fade-duration"));let he=L.findLoadedParent(ne,0),ce=Si(Gt,he,L,V,C.transform,C.style.map.terrain),xe,Pe,Te=V.paint.get("raster-resampling")==="nearest"?J.NEAREST:J.LINEAR;X.activeTexture.set(J.TEXTURE0),Gt.texture.bind(Te,J.CLAMP_TO_EDGE,J.LINEAR_MIPMAP_NEAREST),X.activeTexture.set(J.TEXTURE1),he?(he.texture.bind(Te,J.CLAMP_TO_EDGE,J.LINEAR_MIPMAP_NEAREST),xe=Math.pow(2,he.tileID.overscaledZ-Gt.tileID.overscaledZ),Pe=[Gt.tileID.canonical.x*xe%1,Gt.tileID.canonical.y*xe%1]):Gt.texture.bind(Te,J.CLAMP_TO_EDGE,J.LINEAR_MIPMAP_NEAREST);let Fe=C.style.map.terrain&&C.style.map.terrain.getTerrainData(ne),ur=Fe?ne:null,ki=ur?ur.posMatrix:C.transform.calculatePosMatrix(ne.toUnwrapped(),Zt),We=nb(ki,Pe||[0,0],xe||1,ce,V);tt instanceof Dr?lt.draw(X,J.TRIANGLES,Ot,Nr.disabled,bt,Qr.disabled,We,Fe,V.id,tt.boundsBuffer,C.quadTriangleIndexBuffer,tt.boundsSegments):lt.draw(X,J.TRIANGLES,Ot,yt[ne.overscaledZ],bt,Qr.disabled,We,Fe,V.id,C.rasterBoundsBuffer,C.quadTriangleIndexBuffer,C.rasterBoundsSegments)}})(l,m,v,S);break;case"background":(function(C,L,V,$){let X=V.paint.get("background-color"),J=V.paint.get("background-opacity");if(J===0)return;let tt=C.context,lt=tt.gl,bt=C.transform,yt=bt.tileSize,Ct=V.paint.get("background-pattern");if(C.isPatternMissing(Ct))return;let _t=!Ct&&X.a===1&&J===1&&C.opaquePassEnabledForLayer()?"opaque":"translucent";if(C.renderPass!==_t)return;let Zt=Nr.disabled,ne=C.depthModeForSublayer(0,_t==="opaque"?Vr.ReadWrite:Vr.ReadOnly),Ot=C.colorModeForRenderPass(),Gt=C.useProgram(Ct?"backgroundPattern":"background"),he=$||bt.coveringTiles({tileSize:yt,terrain:C.style.map.terrain});Ct&&(tt.activeTexture.set(lt.TEXTURE0),C.imageManager.bind(C.context));let ce=V.getCrossfadeParameters();for(let xe of he){let Pe=$?xe.posMatrix:C.transform.calculatePosMatrix(xe.toUnwrapped()),Te=Ct?wl(Pe,J,C,Ct,{tileID:xe,tileSize:yt},ce):Dm(Pe,J,X),Fe=C.style.map.terrain&&C.style.map.terrain.getTerrainData(xe);Gt.draw(tt,lt.TRIANGLES,ne,Zt,Ot,Qr.disabled,Te,Fe,V.id,C.tileExtentBuffer,C.quadTriangleIndexBuffer,C.tileExtentSegments)}})(l,0,v,S);break;case"custom":(function(C,L,V){let $=C.context,X=V.implementation;if(C.renderPass==="offscreen"){let J=X.prerender;J&&(C.setCustomLayerDefaults(),$.setColorMode(C.colorModeForRenderPass()),J.call(X,$.gl,C.transform.customLayerMatrix()),$.setDirty(),C.setBaseState())}else if(C.renderPass==="translucent"){C.setCustomLayerDefaults(),$.setColorMode(C.colorModeForRenderPass()),$.setStencilMode(Nr.disabled);let J=X.renderingMode==="3d"?new Vr(C.context.gl.LEQUAL,Vr.ReadWrite,C.depthRangeFor3D):C.depthModeForSublayer(0,Vr.ReadOnly);$.setDepthMode(J),X.render($.gl,C.transform.customLayerMatrix()),$.setDirty(),C.setBaseState(),$.bindFramebuffer.set(null)}})(l,0,v)}}translatePosMatrix(l,m,v,S,C){if(!v[0]&&!v[1])return l;let L=C?S==="map"?this.transform.angle:0:S==="viewport"?-this.transform.angle:0;if(L){let X=Math.sin(L),J=Math.cos(L);v=[v[0]*J-v[1]*X,v[0]*X+v[1]*J]}let V=[C?v[0]:qt(m,v[0],this.transform.zoom),C?v[1]:qt(m,v[1],this.transform.zoom),0],$=new Float32Array(16);return n.$($,l,V),$}saveTileTexture(l){let m=this._tileTextures[l.size[0]];m?m.push(l):this._tileTextures[l.size[0]]=[l]}getTileTexture(l){let m=this._tileTextures[l];return m&&m.length>0?m.pop():null}isPatternMissing(l){if(!l)return!1;if(!l.from||!l.to)return!0;let m=this.imageManager.getPattern(l.from.toString()),v=this.imageManager.getPattern(l.to.toString());return!m||!v}useProgram(l,m){this.cache=this.cache||{};let v=l+(m?m.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[v]||(this.cache[v]=new du(this.context,Fn[l],m,Bm[l],this._showOverdrawInspector,this.style.map.terrain)),this.cache[v]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){let l=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(l.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new Tt(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){let{drawingBufferWidth:l,drawingBufferHeight:m}=this.context.gl;return this.width!==l||this.height!==m}}class na{constructor(l,m){this.points=l,this.planes=m}static fromInvProjectionMatrix(l,m,v){let S=Math.pow(2,v),C=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(V=>{let $=1/(V=n.ag([],V,l))[3]/m*S;return n.b3(V,V,[$,$,1/V[3],$])}),L=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(V=>{let $=function(lt,bt){var yt=bt[0],Ct=bt[1],_t=bt[2],Zt=yt*yt+Ct*Ct+_t*_t;return Zt>0&&(Zt=1/Math.sqrt(Zt)),lt[0]=bt[0]*Zt,lt[1]=bt[1]*Zt,lt[2]=bt[2]*Zt,lt}([],function(lt,bt,yt){var Ct=bt[0],_t=bt[1],Zt=bt[2],ne=yt[0],Ot=yt[1],Gt=yt[2];return lt[0]=_t*Gt-Zt*Ot,lt[1]=Zt*ne-Ct*Gt,lt[2]=Ct*Ot-_t*ne,lt}([],Y([],C[V[0]],C[V[1]]),Y([],C[V[2]],C[V[1]]))),X=-((J=$)[0]*(tt=C[V[1]])[0]+J[1]*tt[1]+J[2]*tt[2]);var J,tt;return $.concat(X)});return new na(C,L)}}class vf{constructor(l,m){this.min=l,this.max=m,this.center=function(v,S,C){return v[0]=.5*S[0],v[1]=.5*S[1],v[2]=.5*S[2],v}([],function(v,S,C){return v[0]=S[0]+C[0],v[1]=S[1]+C[1],v[2]=S[2]+C[2],v}([],this.min,this.max))}quadrant(l){let m=[l%2==0,l<2],v=G(this.min),S=G(this.max);for(let C=0;C<m.length;C++)v[C]=m[C]?this.min[C]:this.center[C],S[C]=m[C]?this.center[C]:this.max[C];return S[2]=this.max[2],new vf(v,S)}distanceX(l){return Math.max(Math.min(this.max[0],l[0]),this.min[0])-l[0]}distanceY(l){return Math.max(Math.min(this.max[1],l[1]),this.min[1])-l[1]}intersects(l){let m=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]],v=!0;for(let S=0;S<l.planes.length;S++){let C=l.planes[S],L=0;for(let V=0;V<m.length;V++)n.b4(C,m[V])>=0&&L++;if(L===0)return 0;L!==m.length&&(v=!1)}if(v)return 2;for(let S=0;S<3;S++){let C=Number.MAX_VALUE,L=-Number.MAX_VALUE;for(let V=0;V<l.points.length;V++){let $=l.points[V][S]-this.min[S];C=Math.min(C,$),L=Math.max(L,$)}if(L<0||C>this.max[S]-this.min[S])return 0}return 1}}class rd{constructor(l=0,m=0,v=0,S=0){if(isNaN(l)||l<0||isNaN(m)||m<0||isNaN(v)||v<0||isNaN(S)||S<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=l,this.bottom=m,this.left=v,this.right=S}interpolate(l,m,v){return m.top!=null&&l.top!=null&&(this.top=n.B.number(l.top,m.top,v)),m.bottom!=null&&l.bottom!=null&&(this.bottom=n.B.number(l.bottom,m.bottom,v)),m.left!=null&&l.left!=null&&(this.left=n.B.number(l.left,m.left,v)),m.right!=null&&l.right!=null&&(this.right=n.B.number(l.right,m.right,v)),this}getCenter(l,m){let v=n.ad((this.left+l-this.right)/2,0,l),S=n.ad((this.top+m-this.bottom)/2,0,m);return new n.P(v,S)}equals(l){return this.top===l.top&&this.bottom===l.bottom&&this.left===l.left&&this.right===l.right}clone(){return new rd(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class id{constructor(l,m,v,S,C){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=C===void 0||!!C,this._minZoom=l||0,this._maxZoom=m||22,this._minPitch=v??0,this._maxPitch=S??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new n.L(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new rd,this._posMatrixCache={},this._alignedPosMatrixCache={},this._minEleveationForCurrentTile=0}clone(){let l=new id(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return l.apply(this),l}apply(l){this.tileSize=l.tileSize,this.latRange=l.latRange,this.width=l.width,this.height=l.height,this._center=l._center,this._elevation=l._elevation,this._minEleveationForCurrentTile=l._minEleveationForCurrentTile,this.zoom=l.zoom,this.angle=l.angle,this._fov=l._fov,this._pitch=l._pitch,this._unmodified=l._unmodified,this._edgeInsets=l._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(l){this._minZoom!==l&&(this._minZoom=l,this.zoom=Math.max(this.zoom,l))}get maxZoom(){return this._maxZoom}set maxZoom(l){this._maxZoom!==l&&(this._maxZoom=l,this.zoom=Math.min(this.zoom,l))}get minPitch(){return this._minPitch}set minPitch(l){this._minPitch!==l&&(this._minPitch=l,this.pitch=Math.max(this.pitch,l))}get maxPitch(){return this._maxPitch}set maxPitch(l){this._maxPitch!==l&&(this._maxPitch=l,this.pitch=Math.min(this.pitch,l))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(l){l===void 0?l=!0:l===null&&(l=!1),this._renderWorldCopies=l}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new n.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(l){let m=-n.b5(l,-180,180)*Math.PI/180;this.angle!==m&&(this._unmodified=!1,this.angle=m,this._calcMatrices(),this.rotationMatrix=function(){var v=new n.A(4);return n.A!=Float32Array&&(v[1]=0,v[2]=0),v[0]=1,v[3]=1,v}(),function(v,S,C){var L=S[0],V=S[1],$=S[2],X=S[3],J=Math.sin(C),tt=Math.cos(C);v[0]=L*tt+$*J,v[1]=V*tt+X*J,v[2]=L*-J+$*tt,v[3]=V*-J+X*tt}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(l){let m=n.ad(l,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==m&&(this._unmodified=!1,this._pitch=m,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(l){l=Math.max(.01,Math.min(60,l)),this._fov!==l&&(this._unmodified=!1,this._fov=l/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(l){let m=Math.min(Math.max(l,this.minZoom),this.maxZoom);this._zoom!==m&&(this._unmodified=!1,this._zoom=m,this.tileZoom=Math.max(0,Math.floor(m)),this.scale=this.zoomScale(m),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(l){l.lat===this._center.lat&&l.lng===this._center.lng||(this._unmodified=!1,this._center=l,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(l){l!==this._elevation&&(this._elevation=l,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(l){this._edgeInsets.equals(l)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,l,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(l){return this._edgeInsets.equals(l)}interpolatePadding(l,m,v){this._unmodified=!1,this._edgeInsets.interpolate(l,m,v),this._constrain(),this._calcMatrices()}coveringZoomLevel(l){let m=(l.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/l.tileSize));return Math.max(0,m)}getVisibleUnwrappedCoordinates(l){let m=[new n.b6(0,l)];if(this._renderWorldCopies){let v=this.pointCoordinate(new n.P(0,0)),S=this.pointCoordinate(new n.P(this.width,0)),C=this.pointCoordinate(new n.P(this.width,this.height)),L=this.pointCoordinate(new n.P(0,this.height)),V=Math.floor(Math.min(v.x,S.x,C.x,L.x)),$=Math.floor(Math.max(v.x,S.x,C.x,L.x)),X=1;for(let J=V-X;J<=$+X;J++)J!==0&&m.push(new n.b6(J,l))}return m}coveringTiles(l){var m,v;let S=this.coveringZoomLevel(l),C=S;if(l.minzoom!==void 0&&S<l.minzoom)return[];l.maxzoom!==void 0&&S>l.maxzoom&&(S=l.maxzoom);let L=this.pointCoordinate(this.getCameraPoint()),V=n.U.fromLngLat(this.center),$=Math.pow(2,S),X=[$*L.x,$*L.y,0],J=[$*V.x,$*V.y,0],tt=na.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,S),lt=l.minzoom||0;!l.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(lt=S);let bt=l.terrain?2/Math.min(this.tileSize,l.tileSize)*this.tileSize:3,yt=Ot=>({aabb:new vf([Ot*$,0,0],[(Ot+1)*$,$,0]),zoom:0,x:0,y:0,wrap:Ot,fullyVisible:!1}),Ct=[],_t=[],Zt=S,ne=l.reparseOverscaled?C:S;if(this._renderWorldCopies)for(let Ot=1;Ot<=3;Ot++)Ct.push(yt(-Ot)),Ct.push(yt(Ot));for(Ct.push(yt(0));Ct.length>0;){let Ot=Ct.pop(),Gt=Ot.x,he=Ot.y,ce=Ot.fullyVisible;if(!ce){let ur=Ot.aabb.intersects(tt);if(ur===0)continue;ce=ur===2}let xe=l.terrain?X:J,Pe=Ot.aabb.distanceX(xe),Te=Ot.aabb.distanceY(xe),Fe=Math.max(Math.abs(Pe),Math.abs(Te));if(Ot.zoom===Zt||Fe>bt+(1<<Zt-Ot.zoom)-2&&Ot.zoom>=lt){let ur=Zt-Ot.zoom,ki=X[0]-.5-(Gt<<ur),We=X[1]-.5-(he<<ur);_t.push({tileID:new n.O(Ot.zoom===Zt?ne:Ot.zoom,Ot.wrap,Ot.zoom,Gt,he),distanceSq:st([J[0]-.5-Gt,J[1]-.5-he]),tileDistanceToCamera:Math.sqrt(ki*ki+We*We)})}else for(let ur=0;ur<4;ur++){let ki=(Gt<<1)+ur%2,We=(he<<1)+(ur>>1),Ir=Ot.zoom+1,hr=Ot.aabb.quadrant(ur);if(l.terrain){let pn=new n.O(Ir,Ot.wrap,Ir,ki,We),Mi=l.terrain.getMinMaxElevation(pn),ui=(m=Mi.minElevation)!==null&&m!==void 0?m:this.elevation,Di=(v=Mi.maxElevation)!==null&&v!==void 0?v:this.elevation;hr=new vf([hr.min[0],hr.min[1],ui],[hr.max[0],hr.max[1],Di])}Ct.push({aabb:hr,zoom:Ir,x:ki,y:We,wrap:Ot.wrap,fullyVisible:ce})}}return _t.sort((Ot,Gt)=>Ot.distanceSq-Gt.distanceSq).map(Ot=>Ot.tileID)}resize(l,m){this.width=l,this.height=m,this.pixelsToGLUnits=[2/l,-2/m],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(l){return Math.pow(2,l)}scaleZoom(l){return Math.log(l)/Math.LN2}project(l){let m=n.ad(l.lat,-this.maxValidLatitude,this.maxValidLatitude);return new n.P(n.G(l.lng)*this.worldSize,n.H(m)*this.worldSize)}unproject(l){return new n.U(l.x/this.worldSize,l.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(l){let m=this.pointLocation(this.centerPoint,l),v=l.getElevationForLngLatZoom(m,this.tileZoom);if(!(this.elevation-v))return;let S=this.getCameraPosition(),C=n.U.fromLngLat(S.lngLat,S.altitude),L=n.U.fromLngLat(m,v),V=C.x-L.x,$=C.y-L.y,X=C.z-L.z,J=Math.sqrt(V*V+$*$+X*X),tt=this.scaleZoom(this.cameraToCenterDistance/J/this.tileSize);this._elevation=v,this._center=m,this.zoom=tt}setLocationAtPoint(l,m){let v=this.pointCoordinate(m),S=this.pointCoordinate(this.centerPoint),C=this.locationCoordinate(l),L=new n.U(C.x-(v.x-S.x),C.y-(v.y-S.y));this.center=this.coordinateLocation(L),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(l,m){return m?this.coordinatePoint(this.locationCoordinate(l),m.getElevationForLngLatZoom(l,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(l))}pointLocation(l,m){return this.coordinateLocation(this.pointCoordinate(l,m))}locationCoordinate(l){return n.U.fromLngLat(l)}coordinateLocation(l){return l&&l.toLngLat()}pointCoordinate(l,m){if(m){let lt=m.pointCoordinate(l);if(lt!=null)return lt}let v=[l.x,l.y,0,1],S=[l.x,l.y,1,1];n.ag(v,v,this.pixelMatrixInverse),n.ag(S,S,this.pixelMatrixInverse);let C=v[3],L=S[3],V=v[1]/C,$=S[1]/L,X=v[2]/C,J=S[2]/L,tt=X===J?0:(0-X)/(J-X);return new n.U(n.B.number(v[0]/C,S[0]/L,tt)/this.worldSize,n.B.number(V,$,tt)/this.worldSize)}coordinatePoint(l,m=0,v=this.pixelMatrix){let S=[l.x*this.worldSize,l.y*this.worldSize,m,1];return n.ag(S,S,v),new n.P(S[0]/S[3],S[1]/S[3])}getBounds(){let l=Math.max(0,this.height/2-this.getHorizon());return new ke().extend(this.pointLocation(new n.P(0,l))).extend(this.pointLocation(new n.P(this.width,l))).extend(this.pointLocation(new n.P(this.width,this.height))).extend(this.pointLocation(new n.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new ke([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(l){l?(this.lngRange=[l.getWest(),l.getEast()],this.latRange=[l.getSouth(),l.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(l,m=!1){let v=l.key,S=m?this._alignedPosMatrixCache:this._posMatrixCache;if(S[v])return S[v];let C=l.canonical,L=this.worldSize/this.zoomScale(C.z),V=C.x+Math.pow(2,C.z)*l.wrap,$=n.ao(new Float64Array(16));return n.$($,$,[V*L,C.y*L,0]),n.a0($,$,[L/n.N,L/n.N,1]),n.a1($,m?this.alignedProjMatrix:this.projMatrix,$),S[v]=new Float32Array($),S[v]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let l,m,v,S,C=-90,L=90,V=-180,$=180,X=this.size,J=this._unmodified;if(this.latRange){let bt=this.latRange;C=n.H(bt[1])*this.worldSize,L=n.H(bt[0])*this.worldSize,l=L-C<X.y?X.y/(L-C):0}if(this.lngRange){let bt=this.lngRange;V=n.b5(n.G(bt[0])*this.worldSize,0,this.worldSize),$=n.b5(n.G(bt[1])*this.worldSize,0,this.worldSize),$<V&&($+=this.worldSize),m=$-V<X.x?X.x/($-V):0}let tt=this.point,lt=Math.max(m||0,l||0);if(lt)return this.center=this.unproject(new n.P(m?($+V)/2:tt.x,l?(L+C)/2:tt.y)),this.zoom+=this.scaleZoom(lt),this._unmodified=J,void(this._constraining=!1);if(this.latRange){let bt=tt.y,yt=X.y/2;bt-yt<C&&(S=C+yt),bt+yt>L&&(S=L-yt)}if(this.lngRange){let bt=(V+$)/2,yt=n.b5(tt.x,bt-this.worldSize/2,bt+this.worldSize/2),Ct=X.x/2;yt-Ct<V&&(v=V+Ct),yt+Ct>$&&(v=$-Ct)}v===void 0&&S===void 0||(this.center=this.unproject(new n.P(v!==void 0?v:tt.x,S!==void 0?S:tt.y)).wrap()),this._unmodified=J,this._constraining=!1}_calcMatrices(){if(!this.height)return;let l=this.centerOffset,m=this.point.x,v=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=n.b7(1,this.center.lat)*this.worldSize;let S=n.ao(new Float64Array(16));n.a0(S,S,[this.width/2,-this.height/2,1]),n.$(S,S,[1,-1,0]),this.labelPlaneMatrix=S,S=n.ao(new Float64Array(16)),n.a0(S,S,[1,-1,1]),n.$(S,S,[-1,-1,0]),n.a0(S,S,[2/this.width,2/this.height,1]),this.glCoordMatrix=S;let C=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),L=Math.min(this.elevation,this._minEleveationForCurrentTile),V=C-L*this._pixelPerMeter/Math.cos(this._pitch),$=L<0?V:C,X=Math.PI/2+this._pitch,J=this._fov*(.5+l.y/this.height),tt=Math.sin(J)*$/Math.sin(n.ad(Math.PI-X-J,.01,Math.PI-.01)),lt=this.getHorizon(),bt=2*Math.atan(lt/this.cameraToCenterDistance)*(.5+l.y/(2*lt)),yt=Math.sin(bt)*$/Math.sin(n.ad(Math.PI-X-bt,.01,Math.PI-.01)),Ct=Math.min(tt,yt),_t=1.01*(Math.cos(Math.PI/2-this._pitch)*Ct+$),Zt=this.height/50;S=new Float64Array(16),n.b8(S,this._fov,this.width/this.height,Zt,_t),S[8]=2*-l.x/this.width,S[9]=2*l.y/this.height,n.a0(S,S,[1,-1,1]),n.$(S,S,[0,0,-this.cameraToCenterDistance]),n.b9(S,S,this._pitch),n.ae(S,S,this.angle),n.$(S,S,[-m,-v,0]),this.mercatorMatrix=n.a0([],S,[this.worldSize,this.worldSize,this.worldSize]),n.a0(S,S,[1,1,this._pixelPerMeter]),this.pixelMatrix=n.a1(new Float64Array(16),this.labelPlaneMatrix,S),n.$(S,S,[0,0,-this.elevation]),this.projMatrix=S,this.invProjMatrix=n.as([],S),this.pixelMatrix3D=n.a1(new Float64Array(16),this.labelPlaneMatrix,S);let ne=this.width%2/2,Ot=this.height%2/2,Gt=Math.cos(this.angle),he=Math.sin(this.angle),ce=m-Math.round(m)+Gt*ne+he*Ot,xe=v-Math.round(v)+Gt*Ot+he*ne,Pe=new Float64Array(S);if(n.$(Pe,Pe,[ce>.5?ce-1:ce,xe>.5?xe-1:xe,0]),this.alignedProjMatrix=Pe,S=n.as(new Float64Array(16),this.pixelMatrix),!S)throw new Error("failed to invert matrix");this.pixelMatrixInverse=S,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;let l=this.pointCoordinate(new n.P(0,0)),m=[l.x*this.worldSize,l.y*this.worldSize,0,1];return n.ag(m,m,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){let l=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new n.P(0,l))}getCameraQueryGeometry(l){let m=this.getCameraPoint();if(l.length===1)return[l[0],m];{let v=m.x,S=m.y,C=m.x,L=m.y;for(let V of l)v=Math.min(v,V.x),S=Math.min(S,V.y),C=Math.max(C,V.x),L=Math.max(L,V.y);return[new n.P(v,S),new n.P(C,S),new n.P(C,L),new n.P(v,L),new n.P(v,S)]}}}function mu(M,l){let m,v=!1,S=null,C=null,L=()=>{S=null,v&&(M.apply(C,m),S=setTimeout(L,l),v=!1)};return(...V)=>(v=!0,C=this,m=V,S||L(),S)}class wf{constructor(l){this._getCurrentHash=()=>{let m=window.location.hash.replace("#","");if(this._hashName){let v;return m.split("&").map(S=>S.split("=")).forEach(S=>{S[0]===this._hashName&&(v=S)}),(v&&v[1]||"").split("/")}return m.split("/")},this._onHashChange=()=>{let m=this._getCurrentHash();if(m.length>=3&&!m.some(v=>isNaN(v))){let v=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(m[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+m[2],+m[1]],zoom:+m[0],bearing:v,pitch:+(m[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{let m=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,m)}catch{}},this._updateHash=mu(this._updateHashUnthrottled,300),this._hashName=l&&encodeURIComponent(l)}addTo(l){return this._map=l,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(l){let m=this._map.getCenter(),v=Math.round(100*this._map.getZoom())/100,S=Math.ceil((v*Math.LN2+Math.log(512/360/.5))/Math.LN10),C=Math.pow(10,S),L=Math.round(m.lng*C)/C,V=Math.round(m.lat*C)/C,$=this._map.getBearing(),X=this._map.getPitch(),J="";if(J+=l?`/${L}/${V}/${v}`:`${v}/${V}/${L}`,($||X)&&(J+="/"+Math.round(10*$)/10),X&&(J+=`/${Math.round(X)}`),this._hashName){let tt=this._hashName,lt=!1,bt=window.location.hash.slice(1).split("&").map(yt=>{let Ct=yt.split("=")[0];return Ct===tt?(lt=!0,`${Ct}=${J}`):yt}).filter(yt=>yt);return lt||bt.push(`${tt}=${J}`),`#${bt.join("&")}`}return`#${J}`}}let sa={linearity:.3,easing:n.ba(0,0,.3,1)},Ws=n.e({deceleration:2500,maxSpeed:1400},sa),j0=n.e({deceleration:20,maxSpeed:1400},sa),z_=n.e({deceleration:1e3,maxSpeed:360},sa),U_=n.e({deceleration:1e3,maxSpeed:90},sa);class Hm{constructor(l){this._map=l,this.clear()}clear(){this._inertiaBuffer=[]}record(l){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:n.h.now(),settings:l})}_drainInertiaBuffer(){let l=this._inertiaBuffer,m=n.h.now();for(;l.length>0&&m-l[0].time>160;)l.shift()}_onMoveEnd(l){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;let m={zoom:0,bearing:0,pitch:0,pan:new n.P(0,0),pinchAround:void 0,around:void 0};for(let{settings:C}of this._inertiaBuffer)m.zoom+=C.zoomDelta||0,m.bearing+=C.bearingDelta||0,m.pitch+=C.pitchDelta||0,C.panDelta&&m.pan._add(C.panDelta),C.around&&(m.around=C.around),C.pinchAround&&(m.pinchAround=C.pinchAround);let v=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,S={};if(m.pan.mag()){let C=nd(m.pan.mag(),v,n.e({},Ws,l||{}));S.offset=m.pan.mult(C.amount/m.pan.mag()),S.center=this._map.transform.center,tc(S,C)}if(m.zoom){let C=nd(m.zoom,v,j0);S.zoom=this._map.transform.zoom+C.amount,tc(S,C)}if(m.bearing){let C=nd(m.bearing,v,z_);S.bearing=this._map.transform.bearing+n.ad(C.amount,-179,179),tc(S,C)}if(m.pitch){let C=nd(m.pitch,v,U_);S.pitch=this._map.transform.pitch+C.amount,tc(S,C)}if(S.zoom||S.bearing){let C=m.pinchAround===void 0?m.around:m.pinchAround;S.around=C?this._map.unproject(C):this._map.getCenter()}return this.clear(),n.e(S,{noMoveStart:!0})}}function tc(M,l){(!M.duration||M.duration<l.duration)&&(M.duration=l.duration,M.easing=l.easing)}function nd(M,l,m){let{maxSpeed:v,linearity:S,deceleration:C}=m,L=n.ad(M*S/(l/1e3),-v,v),V=Math.abs(L)/(C*S);return{easing:m.easing,duration:1e3*V,amount:L*(V/2)}}class wa extends n.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,m,v,S={}){let C=c.mousePos(m.getCanvasContainer(),v),L=m.unproject(C);super(l,n.e({point:C,lngLat:L,originalEvent:v},S)),this._defaultPrevented=!1,this.target=m}}class vn extends n.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,m,v){let S=l==="touchend"?v.changedTouches:v.touches,C=c.touchPos(m.getCanvasContainer(),S),L=C.map($=>m.unproject($)),V=C.reduce(($,X,J,tt)=>$.add(X.div(tt.length)),new n.P(0,0));super(l,{points:C,point:V,lngLats:L,lngLat:m.unproject(V),originalEvent:v}),this._defaultPrevented=!1}}class $0 extends n.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(l,m,v){super(l,{originalEvent:v}),this._defaultPrevented=!1}}class Wm{constructor(l,m){this._map=l,this._clickTolerance=m.clickTolerance}reset(){delete this._mousedownPos}wheel(l){return this._firePreventable(new $0(l.type,this._map,l))}mousedown(l,m){return this._mousedownPos=m,this._firePreventable(new wa(l.type,this._map,l))}mouseup(l){this._map.fire(new wa(l.type,this._map,l))}click(l,m){this._mousedownPos&&this._mousedownPos.dist(m)>=this._clickTolerance||this._map.fire(new wa(l.type,this._map,l))}dblclick(l){return this._firePreventable(new wa(l.type,this._map,l))}mouseover(l){this._map.fire(new wa(l.type,this._map,l))}mouseout(l){this._map.fire(new wa(l.type,this._map,l))}touchstart(l){return this._firePreventable(new vn(l.type,this._map,l))}touchmove(l){this._map.fire(new vn(l.type,this._map,l))}touchend(l){this._map.fire(new vn(l.type,this._map,l))}touchcancel(l){this._map.fire(new vn(l.type,this._map,l))}_firePreventable(l){if(this._map.fire(l),l.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class V_{constructor(l){this._map=l}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(l){this._map.fire(new wa(l.type,this._map,l))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new wa("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(l){this._delayContextMenu?this._contextMenuEvent=l:this._ignoreContextMenu||this._map.fire(new wa(l.type,this._map,l)),this._map.listens("contextmenu")&&l.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Nc{constructor(l){this._map=l}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(l){return this.transform.pointLocation(n.P.convert(l),this._map.terrain)}}class j_{constructor(l,m){this._map=l,this._tr=new Nc(l),this._el=l.getCanvasContainer(),this._container=l.getContainer(),this._clickTolerance=m.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(l,m){this.isEnabled()&&l.shiftKey&&l.button===0&&(c.disableDrag(),this._startPos=this._lastPos=m,this._active=!0)}mousemoveWindow(l,m){if(!this._active)return;let v=m;if(this._lastPos.equals(v)||!this._box&&v.dist(this._startPos)<this._clickTolerance)return;let S=this._startPos;this._lastPos=v,this._box||(this._box=c.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",l));let C=Math.min(S.x,v.x),L=Math.max(S.x,v.x),V=Math.min(S.y,v.y),$=Math.max(S.y,v.y);c.setTransform(this._box,`translate(${C}px,${V}px)`),this._box.style.width=L-C+"px",this._box.style.height=$-V+"px"}mouseupWindow(l,m){if(!this._active||l.button!==0)return;let v=this._startPos,S=m;if(this.reset(),c.suppressClick(),v.x!==S.x||v.y!==S.y)return this._map.fire(new n.k("boxzoomend",{originalEvent:l})),{cameraAnimation:C=>C.fitScreenCoordinates(v,S,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",l)}keydown(l){this._active&&l.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",l))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(c.remove(this._box),this._box=null),c.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(l,m){return this._map.fire(new n.k(l,{originalEvent:m}))}}function Ta(M,l){if(M.length!==l.length)throw new Error(`The number of touches and points are not equal - touches ${M.length}, points ${l.length}`);let m={};for(let v=0;v<M.length;v++)m[M[v].identifier]=l[v];return m}class Tl{constructor(l){this.reset(),this.numTouches=l.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(l,m,v){(this.centroid||v.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=l.timeStamp),v.length===this.numTouches&&(this.centroid=function(S){let C=new n.P(0,0);for(let L of S)C._add(L);return C.div(S.length)}(m),this.touches=Ta(v,m)))}touchmove(l,m,v){if(this.aborted||!this.centroid)return;let S=Ta(v,m);for(let C in this.touches){let L=S[C];(!L||L.dist(this.touches[C])>30)&&(this.aborted=!0)}}touchend(l,m,v){if((!this.centroid||l.timeStamp-this.startTime>500)&&(this.aborted=!0),v.length===0){let S=!this.aborted&&this.centroid;if(this.reset(),S)return S}}}class Tf{constructor(l){this.singleTap=new Tl(l),this.numTaps=l.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(l,m,v){this.singleTap.touchstart(l,m,v)}touchmove(l,m,v){this.singleTap.touchmove(l,m,v)}touchend(l,m,v){let S=this.singleTap.touchend(l,m,v);if(S){let C=l.timeStamp-this.lastTime<500,L=!this.lastTap||this.lastTap.dist(S)<30;if(C&&L||this.reset(),this.count++,this.lastTime=l.timeStamp,this.lastTap=S,this.count===this.numTaps)return this.reset(),S}}}class Fc{constructor(l){this._tr=new Nc(l),this._zoomIn=new Tf({numTouches:1,numTaps:2}),this._zoomOut=new Tf({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(l,m,v){this._zoomIn.touchstart(l,m,v),this._zoomOut.touchstart(l,m,v)}touchmove(l,m,v){this._zoomIn.touchmove(l,m,v),this._zoomOut.touchmove(l,m,v)}touchend(l,m,v){let S=this._zoomIn.touchend(l,m,v),C=this._zoomOut.touchend(l,m,v),L=this._tr;return S?(this._active=!0,l.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:V=>V.easeTo({duration:300,zoom:L.zoom+1,around:L.unproject(S)},{originalEvent:l})}):C?(this._active=!0,l.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:V=>V.easeTo({duration:300,zoom:L.zoom-1,around:L.unproject(C)},{originalEvent:l})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Lc{constructor(l){this._enabled=!!l.enable,this._moveStateManager=l.moveStateManager,this._clickTolerance=l.clickTolerance||1,this._moveFunction=l.move,this._activateOnStart=!!l.activateOnStart,l.assignEvents(this),this.reset()}reset(l){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(l)}_move(...l){let m=this._moveFunction(...l);if(m.bearingDelta||m.pitchDelta||m.around||m.panDelta)return this._active=!0,m}dragStart(l,m){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(l)&&(this._moveStateManager.startMove(l),this._lastPoint=m.length?m[0]:m,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(l,m){if(!this.isEnabled())return;let v=this._lastPoint;if(!v)return;if(l.preventDefault(),!this._moveStateManager.isValidMoveEvent(l))return void this.reset(l);let S=m.length?m[0]:m;return!this._moved&&S.dist(v)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=S,this._move(v,S))}dragEnd(l){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(l)&&(this._moved&&c.suppressClick(),this.reset(l))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}let $_={0:1,2:2};class H0{constructor(l){this._correctEvent=l.checkCorrectEvent}startMove(l){let m=c.mouseButton(l);this._eventButton=m}endMove(l){delete this._eventButton}isValidStartEvent(l){return this._correctEvent(l)}isValidMoveEvent(l){return!function(m,v){let S=$_[v];return m.buttons===void 0||(m.buttons&S)!==S}(l,this._eventButton)}isValidEndEvent(l){return c.mouseButton(l)===this._eventButton}}class qm{constructor(){this._firstTouch=void 0}_isOneFingerTouch(l){return l.targetTouches.length===1}_isSameTouchEvent(l){return l.targetTouches[0].identifier===this._firstTouch}startMove(l){this._firstTouch=l.targetTouches[0].identifier}endMove(l){delete this._firstTouch}isValidStartEvent(l){return this._isOneFingerTouch(l)}isValidMoveEvent(l){return this._isOneFingerTouch(l)&&this._isSameTouchEvent(l)}isValidEndEvent(l){return this._isOneFingerTouch(l)&&this._isSameTouchEvent(l)}}let W0=M=>{M.mousedown=M.dragStart,M.mousemoveWindow=M.dragMove,M.mouseup=M.dragEnd,M.contextmenu=function(l){l.preventDefault()}},Sf=({enable:M,clickTolerance:l,bearingDegreesPerPixelMoved:m=.8})=>{let v=new H0({checkCorrectEvent:S=>c.mouseButton(S)===0&&S.ctrlKey||c.mouseButton(S)===2});return new Lc({clickTolerance:l,move:(S,C)=>({bearingDelta:(C.x-S.x)*m}),moveStateManager:v,enable:M,assignEvents:W0})},zc=({enable:M,clickTolerance:l,pitchDegreesPerPixelMoved:m=-.5})=>{let v=new H0({checkCorrectEvent:S=>c.mouseButton(S)===0&&S.ctrlKey||c.mouseButton(S)===2});return new Lc({clickTolerance:l,move:(S,C)=>({pitchDelta:(C.y-S.y)*m}),moveStateManager:v,enable:M,assignEvents:W0})};class Ve{constructor(l,m){this._minTouches=l.cooperativeGestures?2:1,this._clickTolerance=l.clickTolerance||1,this._map=m,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new n.P(0,0),setTimeout(()=>{this._cancelCooperativeMessage=!1},200)}touchstart(l,m,v){return this._calculateTransform(l,m,v)}touchmove(l,m,v){if(this._map._cooperativeGestures&&(this._minTouches===2&&v.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(l,!1,v.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(v.length<this._minTouches))return l.preventDefault(),this._calculateTransform(l,m,v)}touchend(l,m,v){this._calculateTransform(l,m,v),this._active&&v.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(l,m,v){v.length>0&&(this._active=!0);let S=Ta(v,m),C=new n.P(0,0),L=new n.P(0,0),V=0;for(let X in S){let J=S[X],tt=this._touches[X];tt&&(C._add(J),L._add(J.sub(tt)),V++,S[X]=J)}if(this._touches=S,V<this._minTouches||!L.mag())return;let $=L.div(V);return this._sum._add($),this._sum.mag()<this._clickTolerance?void 0:{around:C.div(V),panDelta:$}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ec{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(l,m,v){this._firstTwoTouches||v.length<2||(this._firstTwoTouches=[v[0].identifier,v[1].identifier],this._start([m[0],m[1]]))}touchmove(l,m,v){if(!this._firstTwoTouches)return;l.preventDefault();let[S,C]=this._firstTwoTouches,L=xs(v,m,S),V=xs(v,m,C);if(!L||!V)return;let $=this._aroundCenter?null:L.add(V).div(2);return this._move([L,V],$,l)}touchend(l,m,v){if(!this._firstTwoTouches)return;let[S,C]=this._firstTwoTouches,L=xs(v,m,S),V=xs(v,m,C);L&&V||(this._active&&c.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(l){this._enabled=!0,this._aroundCenter=!!l&&l.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function xs(M,l,m){for(let v=0;v<M.length;v++)if(M[v].identifier===m)return l[v]}function gu(M,l){return Math.log(M/l)/Math.LN2}class Ym extends ec{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(l){this._startDistance=this._distance=l[0].dist(l[1])}_move(l,m){let v=this._distance;if(this._distance=l[0].dist(l[1]),this._active||!(Math.abs(gu(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:gu(this._distance,v),pinchAround:m}}}function qe(M,l){return 180*M.angleWith(l)/Math.PI}class Xm extends ec{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(l){this._startVector=this._vector=l[0].sub(l[1]),this._minDiameter=l[0].dist(l[1])}_move(l,m){let v=this._vector;if(this._vector=l[0].sub(l[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:qe(this._vector,v),pinchAround:m}}_isBelowThreshold(l){this._minDiameter=Math.min(this._minDiameter,l.mag());let m=25/(Math.PI*this._minDiameter)*360,v=qe(l,this._startVector);return Math.abs(v)<m}}function Zm(M){return Math.abs(M.y)>Math.abs(M.x)}class ub extends ec{constructor(l){super(),this._map=l}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(l,m,v){super.touchstart(l,m,v),this._currentTouchCount=v.length}_start(l){this._lastPoints=l,Zm(l[0].sub(l[1]))&&(this._valid=!1)}_move(l,m,v){if(this._map._cooperativeGestures&&this._currentTouchCount<3)return;let S=l[0].sub(this._lastPoints[0]),C=l[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(S,C,v.timeStamp),this._valid?(this._lastPoints=l,this._active=!0,{pitchDelta:(S.y+C.y)/2*-.5}):void 0}gestureBeginsVertically(l,m,v){if(this._valid!==void 0)return this._valid;let S=l.mag()>=2,C=m.mag()>=2;if(!S&&!C)return;if(!S||!C)return this._firstMove===void 0&&(this._firstMove=v),v-this._firstMove<100&&void 0;let L=l.y>0==m.y>0;return Zm(l)&&Zm(m)&&L}}let q0={panStep:100,bearingStep:15,pitchStep:10};class sd{constructor(l){this._tr=new Nc(l);let m=q0;this._panStep=m.panStep,this._bearingStep=m.bearingStep,this._pitchStep=m.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(l){if(l.altKey||l.ctrlKey||l.metaKey)return;let m=0,v=0,S=0,C=0,L=0;switch(l.keyCode){case 61:case 107:case 171:case 187:m=1;break;case 189:case 109:case 173:m=-1;break;case 37:l.shiftKey?v=-1:(l.preventDefault(),C=-1);break;case 39:l.shiftKey?v=1:(l.preventDefault(),C=1);break;case 38:l.shiftKey?S=1:(l.preventDefault(),L=-1);break;case 40:l.shiftKey?S=-1:(l.preventDefault(),L=1);break;default:return}return this._rotationDisabled&&(v=0,S=0),{cameraAnimation:V=>{let $=this._tr;V.easeTo({duration:300,easeId:"keyboardHandler",easing:_u,zoom:m?Math.round($.zoom)+m*(l.shiftKey?2:1):$.zoom,bearing:$.bearing+v*this._bearingStep,pitch:$.pitch+S*this._pitchStep,offset:[-C*this._panStep,-L*this._panStep],center:$.center},{originalEvent:l})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function _u(M){return M*(2-M)}let Gm=4.000244140625;class H_{constructor(l,m){this._onTimeout=v=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(v)},this._map=l,this._tr=new Nc(l),this._el=l.getCanvasContainer(),this._triggerRenderFrame=m,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(l){this._defaultZoomRate=l}setWheelZoomRate(l){this._wheelZoomRate=l}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(l){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!l&&l.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(l){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!l[this._map._metaKey])return;l.preventDefault()}let m=l.deltaMode===WheelEvent.DOM_DELTA_LINE?40*l.deltaY:l.deltaY,v=n.h.now(),S=v-(this._lastWheelEventTime||0);this._lastWheelEventTime=v,m!==0&&m%Gm==0?this._type="wheel":m!==0&&Math.abs(m)<4?this._type="trackpad":S>400?(this._type=null,this._lastValue=m,this._timeout=setTimeout(this._onTimeout,40,l)):this._type||(this._type=Math.abs(S*m)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,m+=this._lastValue)),l.shiftKey&&m&&(m/=4),this._type&&(this._lastWheelEvent=l,this._delta-=m,this._active||this._start(l)),l.preventDefault()}_start(l){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);let m=c.mousePos(this._el,l),v=this._tr;this._around=n.L.convert(this._aroundCenter?v.center:v.unproject(m)),this._aroundPoint=v.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;let l=this._tr.transform;if(this._delta!==0){let V=this._type==="wheel"&&Math.abs(this._delta)>Gm?this._wheelZoomRate:this._defaultZoomRate,$=2/(1+Math.exp(-Math.abs(this._delta*V)));this._delta<0&&$!==0&&($=1/$);let X=typeof this._targetZoom=="number"?l.zoomScale(this._targetZoom):l.scale;this._targetZoom=Math.min(l.maxZoom,Math.max(l.minZoom,l.scaleZoom(X*$))),this._type==="wheel"&&(this._startZoom=l.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}let m=typeof this._targetZoom=="number"?this._targetZoom:l.zoom,v=this._startZoom,S=this._easing,C,L=!1;if(this._type==="wheel"&&v&&S){let V=Math.min((n.h.now()-this._lastWheelEventTime)/200,1),$=S(V);C=n.B.number(v,m,$),V<1?this._frameId||(this._frameId=!0):L=!0}else C=m,L=!0;return this._active=!0,L&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!L,zoomDelta:C-l.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(l){let m=n.bb;if(this._prevEase){let v=this._prevEase,S=(n.h.now()-v.start)/v.duration,C=v.easing(S+.01)-v.easing(S),L=.27/Math.sqrt(C*C+1e-4)*.01,V=Math.sqrt(.0729-L*L);m=n.ba(L,V,.25,1)}return this._prevEase={start:n.h.now(),duration:l,easing:m},m}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Ef{constructor(l,m){this._clickZoom=l,this._tapZoom=m}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Uc{constructor(l){this._tr=new Nc(l),this.reset()}reset(){this._active=!1}dblclick(l,m){return l.preventDefault(),{cameraAnimation:v=>{v.easeTo({duration:300,zoom:this._tr.zoom+(l.shiftKey?-1:1),around:this._tr.unproject(m)},{originalEvent:l})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class rc{constructor(){this._tap=new Tf({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(l,m,v){if(!this._swipePoint)if(this._tapTime){let S=m[0],C=l.timeStamp-this._tapTime<500,L=this._tapPoint.dist(S)<30;C&&L?v.length>0&&(this._swipePoint=S,this._swipeTouch=v[0].identifier):this.reset()}else this._tap.touchstart(l,m,v)}touchmove(l,m,v){if(this._tapTime){if(this._swipePoint){if(v[0].identifier!==this._swipeTouch)return;let S=m[0],C=S.y-this._swipePoint.y;return this._swipePoint=S,l.preventDefault(),this._active=!0,{zoomDelta:C/128}}}else this._tap.touchmove(l,m,v)}touchend(l,m,v){if(this._tapTime)this._swipePoint&&v.length===0&&this.reset();else{let S=this._tap.touchend(l,m,v);S&&(this._tapTime=l.timeStamp,this._tapPoint=S)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Y0{constructor(l,m,v){this._el=l,this._mousePan=m,this._touchPan=v}enable(l){this._inertiaOptions=l||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class jo{constructor(l,m,v){this._pitchWithRotate=l.pitchWithRotate,this._mouseRotate=m,this._mousePitch=v}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class ic{constructor(l,m,v,S){this._el=l,this._touchZoom=m,this._touchRotate=v,this._tapDragZoom=S,this._rotationDisabled=!1,this._enabled=!0}enable(l){this._touchZoom.enable(l),this._rotationDisabled||this._touchRotate.enable(l),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}let od=M=>M.zoom||M.drag||M.pitch||M.rotate;class Qm extends n.k{}function If(M){return M.panDelta&&M.panDelta.mag()||M.zoomDelta||M.bearingDelta||M.pitchDelta}class Km{constructor(l,m){this.handleWindowEvent=S=>{this.handleEvent(S,`${S.type}Window`)},this.handleEvent=(S,C)=>{if(S.type==="blur")return void this.stop(!0);this._updatingCamera=!0;let L=S.type==="renderFrame"?void 0:S,V={needsRenderFrame:!1},$={},X={},J=S.touches,tt=J?this._getMapTouches(J):void 0,lt=tt?c.touchPos(this._el,tt):c.mousePos(this._el,S);for(let{handlerName:Ct,handler:_t,allowed:Zt}of this._handlers){if(!_t.isEnabled())continue;let ne;this._blockedByActive(X,Zt,Ct)?_t.reset():_t[C||S.type]&&(ne=_t[C||S.type](S,lt,tt),this.mergeHandlerResult(V,$,ne,Ct,L),ne&&ne.needsRenderFrame&&this._triggerRenderFrame()),(ne||_t.isActive())&&(X[Ct]=_t)}let bt={};for(let Ct in this._previousActiveHandlers)X[Ct]||(bt[Ct]=L);this._previousActiveHandlers=X,(Object.keys(bt).length||If(V))&&(this._changes.push([V,$,bt]),this._triggerRenderFrame()),(Object.keys(X).length||If(V))&&this._map._stop(!0),this._updatingCamera=!1;let{cameraAnimation:yt}=V;yt&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],yt(this._map))},this._map=l,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Hm(l),this._bearingSnap=m.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(m);let v=this._el;this._listeners=[[v,"touchstart",{passive:!0}],[v,"touchmove",{passive:!1}],[v,"touchend",void 0],[v,"touchcancel",void 0],[v,"mousedown",void 0],[v,"mousemove",void 0],[v,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[v,"mouseover",void 0],[v,"mouseout",void 0],[v,"dblclick",void 0],[v,"click",void 0],[v,"keydown",{capture:!1}],[v,"keyup",void 0],[v,"wheel",{passive:!1}],[v,"contextmenu",void 0],[window,"blur",void 0]];for(let[S,C,L]of this._listeners)c.addEventListener(S,C,S===document?this.handleWindowEvent:this.handleEvent,L)}destroy(){for(let[l,m,v]of this._listeners)c.removeEventListener(l,m,l===document?this.handleWindowEvent:this.handleEvent,v)}_addDefaultHandlers(l){let m=this._map,v=m.getCanvasContainer();this._add("mapEvent",new Wm(m,l));let S=m.boxZoom=new j_(m,l);this._add("boxZoom",S),l.interactive&&l.boxZoom&&S.enable();let C=new Fc(m),L=new Uc(m);m.doubleClickZoom=new Ef(L,C),this._add("tapZoom",C),this._add("clickZoom",L),l.interactive&&l.doubleClickZoom&&m.doubleClickZoom.enable();let V=new rc;this._add("tapDragZoom",V);let $=m.touchPitch=new ub(m);this._add("touchPitch",$),l.interactive&&l.touchPitch&&m.touchPitch.enable(l.touchPitch);let X=Sf(l),J=zc(l);m.dragRotate=new jo(l,X,J),this._add("mouseRotate",X,["mousePitch"]),this._add("mousePitch",J,["mouseRotate"]),l.interactive&&l.dragRotate&&m.dragRotate.enable();let tt=(({enable:Zt,clickTolerance:ne})=>{let Ot=new H0({checkCorrectEvent:Gt=>c.mouseButton(Gt)===0&&!Gt.ctrlKey});return new Lc({clickTolerance:ne,move:(Gt,he)=>({around:he,panDelta:he.sub(Gt)}),activateOnStart:!0,moveStateManager:Ot,enable:Zt,assignEvents:W0})})(l),lt=new Ve(l,m);m.dragPan=new Y0(v,tt,lt),this._add("mousePan",tt),this._add("touchPan",lt,["touchZoom","touchRotate"]),l.interactive&&l.dragPan&&m.dragPan.enable(l.dragPan);let bt=new Xm,yt=new Ym;m.touchZoomRotate=new ic(v,yt,bt,V),this._add("touchRotate",bt,["touchPan","touchZoom"]),this._add("touchZoom",yt,["touchPan","touchRotate"]),l.interactive&&l.touchZoomRotate&&m.touchZoomRotate.enable(l.touchZoomRotate);let Ct=m.scrollZoom=new H_(m,()=>this._triggerRenderFrame());this._add("scrollZoom",Ct,["mousePan"]),l.interactive&&l.scrollZoom&&m.scrollZoom.enable(l.scrollZoom);let _t=m.keyboard=new sd(m);this._add("keyboard",_t),l.interactive&&l.keyboard&&m.keyboard.enable(),this._add("blockableMapEvent",new V_(m))}_add(l,m,v){this._handlers.push({handlerName:l,handler:m,allowed:v}),this._handlersById[l]=m}stop(l){if(!this._updatingCamera){for(let{handler:m}of this._handlers)m.reset();this._inertia.clear(),this._fireEvents({},{},l),this._changes=[]}}isActive(){for(let{handler:l}of this._handlers)if(l.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!od(this._eventsInProgress)||this.isZooming()}_blockedByActive(l,m,v){for(let S in l)if(S!==v&&(!m||m.indexOf(S)<0))return!0;return!1}_getMapTouches(l){let m=[];for(let v of l)this._el.contains(v.target)&&m.push(v);return m}mergeHandlerResult(l,m,v,S,C){if(!v)return;n.e(l,v);let L={handlerName:S,originalEvent:v.originalEvent||C};v.zoomDelta!==void 0&&(m.zoom=L),v.panDelta!==void 0&&(m.drag=L),v.pitchDelta!==void 0&&(m.pitch=L),v.bearingDelta!==void 0&&(m.rotate=L)}_applyChanges(){let l={},m={},v={};for(let[S,C,L]of this._changes)S.panDelta&&(l.panDelta=(l.panDelta||new n.P(0,0))._add(S.panDelta)),S.zoomDelta&&(l.zoomDelta=(l.zoomDelta||0)+S.zoomDelta),S.bearingDelta&&(l.bearingDelta=(l.bearingDelta||0)+S.bearingDelta),S.pitchDelta&&(l.pitchDelta=(l.pitchDelta||0)+S.pitchDelta),S.around!==void 0&&(l.around=S.around),S.pinchAround!==void 0&&(l.pinchAround=S.pinchAround),S.noInertia&&(l.noInertia=S.noInertia),n.e(m,C),n.e(v,L);this._updateMapTransform(l,m,v),this._changes=[]}_updateMapTransform(l,m,v){let S=this._map,C=S._getTransformForUpdate(),L=S.terrain;if(!(If(l)||L&&this._terrainMovement))return this._fireEvents(m,v,!0);let{panDelta:V,zoomDelta:$,bearingDelta:X,pitchDelta:J,around:tt,pinchAround:lt}=l;lt!==void 0&&(tt=lt),S._stop(!0),tt=tt||S.transform.centerPoint;let bt=C.pointLocation(V?tt.sub(V):tt);X&&(C.bearing+=X),J&&(C.pitch+=J),$&&(C.zoom+=$),L?this._terrainMovement||!m.drag&&!m.zoom?m.drag&&this._terrainMovement?C.center=C.pointLocation(C.centerPoint.sub(V)):C.setLocationAtPoint(bt,tt):(this._terrainMovement=!0,this._map._elevationFreeze=!0,C.setLocationAtPoint(bt,tt),this._map.once("moveend",()=>{this._map._elevationFreeze=!1,this._terrainMovement=!1,C.recalculateZoom(S.terrain)})):C.setLocationAtPoint(bt,tt),S._applyUpdatedTransform(C),this._map._update(),l.noInertia||this._inertia.record(l),this._fireEvents(m,v,!0)}_fireEvents(l,m,v){let S=od(this._eventsInProgress),C=od(l),L={};for(let J in l){let{originalEvent:tt}=l[J];this._eventsInProgress[J]||(L[`${J}start`]=tt),this._eventsInProgress[J]=l[J]}!S&&C&&this._fireEvent("movestart",C.originalEvent);for(let J in L)this._fireEvent(J,L[J]);C&&this._fireEvent("move",C.originalEvent);for(let J in l){let{originalEvent:tt}=l[J];this._fireEvent(J,tt)}let V={},$;for(let J in this._eventsInProgress){let{handlerName:tt,originalEvent:lt}=this._eventsInProgress[J];this._handlersById[tt].isActive()||(delete this._eventsInProgress[J],$=m[tt]||lt,V[`${J}end`]=$)}for(let J in V)this._fireEvent(J,V[J]);let X=od(this._eventsInProgress);if(v&&(S||C)&&!X){this._updatingCamera=!0;let J=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),tt=lt=>lt!==0&&-this._bearingSnap<lt&&lt<this._bearingSnap;!J||!J.essential&&n.h.prefersReducedMotion?(this._map.fire(new n.k("moveend",{originalEvent:$})),tt(this._map.getBearing())&&this._map.resetNorth()):(tt(J.bearing||this._map.getBearing())&&(J.bearing=0),J.freezeElevation=!0,this._map.easeTo(J,{originalEvent:$})),this._updatingCamera=!1}}_fireEvent(l,m){this._map.fire(new n.k(l,m?{originalEvent:m}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(l=>{delete this._frameId,this.handleEvent(new Qm("renderFrame",{timeStamp:l})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class W_ extends n.E{constructor(l,m){super(),this._renderFrameCallback=()=>{let v=Math.min((n.h.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(v)),v<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=l,this._bearingSnap=m.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new n.L(this.transform.center.lng,this.transform.center.lat)}setCenter(l,m){return this.jumpTo({center:l},m)}panBy(l,m,v){return l=n.P.convert(l).mult(-1),this.panTo(this.transform.center,n.e({offset:l},m),v)}panTo(l,m,v){return this.easeTo(n.e({center:l},m),v)}getZoom(){return this.transform.zoom}setZoom(l,m){return this.jumpTo({zoom:l},m),this}zoomTo(l,m,v){return this.easeTo(n.e({zoom:l},m),v)}zoomIn(l,m){return this.zoomTo(this.getZoom()+1,l,m),this}zoomOut(l,m){return this.zoomTo(this.getZoom()-1,l,m),this}getBearing(){return this.transform.bearing}setBearing(l,m){return this.jumpTo({bearing:l},m),this}getPadding(){return this.transform.padding}setPadding(l,m){return this.jumpTo({padding:l},m),this}rotateTo(l,m,v){return this.easeTo(n.e({bearing:l},m),v)}resetNorth(l,m){return this.rotateTo(0,n.e({duration:1e3},l),m),this}resetNorthPitch(l,m){return this.easeTo(n.e({bearing:0,pitch:0,duration:1e3},l),m),this}snapToNorth(l,m){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(l,m):this}getPitch(){return this.transform.pitch}setPitch(l,m){return this.jumpTo({pitch:l},m),this}cameraForBounds(l,m){l=ke.convert(l);let v=m&&m.bearing||0;return this._cameraForBoxAndBearing(l.getNorthWest(),l.getSouthEast(),v,m)}_cameraForBoxAndBearing(l,m,v,S){let C={top:0,bottom:0,right:0,left:0};if(typeof(S=n.e({padding:C,offset:[0,0],maxZoom:this.transform.maxZoom},S)).padding=="number"){let he=S.padding;S.padding={top:he,bottom:he,right:he,left:he}}S.padding=n.e(C,S.padding);let L=this.transform,V=L.padding,$=L.project(n.L.convert(l)),X=L.project(n.L.convert(m)),J=$.rotate(-v*Math.PI/180),tt=X.rotate(-v*Math.PI/180),lt=new n.P(Math.max(J.x,tt.x),Math.max(J.y,tt.y)),bt=new n.P(Math.min(J.x,tt.x),Math.min(J.y,tt.y)),yt=lt.sub(bt),Ct=(L.width-(V.left+V.right+S.padding.left+S.padding.right))/yt.x,_t=(L.height-(V.top+V.bottom+S.padding.top+S.padding.bottom))/yt.y;if(_t<0||Ct<0)return void n.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");let Zt=Math.min(L.scaleZoom(L.scale*Math.min(Ct,_t)),S.maxZoom),ne=n.P.convert(S.offset),Ot=new n.P((S.padding.left-S.padding.right)/2,(S.padding.top-S.padding.bottom)/2).rotate(v*Math.PI/180),Gt=ne.add(Ot).mult(L.scale/L.zoomScale(Zt));return{center:L.unproject($.add(X).div(2).sub(Gt)),zoom:Zt,bearing:v}}fitBounds(l,m,v){return this._fitInternal(this.cameraForBounds(l,m),m,v)}fitScreenCoordinates(l,m,v,S,C){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(n.P.convert(l)),this.transform.pointLocation(n.P.convert(m)),v,S),S,C)}_fitInternal(l,m,v){return l?(delete(m=n.e(l,m)).padding,m.linear?this.easeTo(m,v):this.flyTo(m,v)):this}jumpTo(l,m){this.stop();let v=this._getTransformForUpdate(),S=!1,C=!1,L=!1;return"zoom"in l&&v.zoom!==+l.zoom&&(S=!0,v.zoom=+l.zoom),l.center!==void 0&&(v.center=n.L.convert(l.center)),"bearing"in l&&v.bearing!==+l.bearing&&(C=!0,v.bearing=+l.bearing),"pitch"in l&&v.pitch!==+l.pitch&&(L=!0,v.pitch=+l.pitch),l.padding==null||v.isPaddingEqual(l.padding)||(v.padding=l.padding),this._applyUpdatedTransform(v),this.fire(new n.k("movestart",m)).fire(new n.k("move",m)),S&&this.fire(new n.k("zoomstart",m)).fire(new n.k("zoom",m)).fire(new n.k("zoomend",m)),C&&this.fire(new n.k("rotatestart",m)).fire(new n.k("rotate",m)).fire(new n.k("rotateend",m)),L&&this.fire(new n.k("pitchstart",m)).fire(new n.k("pitch",m)).fire(new n.k("pitchend",m)),this.fire(new n.k("moveend",m))}calculateCameraOptionsFromTo(l,m,v,S=0){let C=n.U.fromLngLat(l,m),L=n.U.fromLngLat(v,S),V=L.x-C.x,$=L.y-C.y,X=L.z-C.z,J=Math.hypot(V,$,X);if(J===0)throw new Error("Can't calculate camera options with same From and To");let tt=Math.hypot(V,$),lt=this.transform.scaleZoom(this.transform.cameraToCenterDistance/J/this.transform.tileSize),bt=180*Math.atan2(V,-$)/Math.PI,yt=180*Math.acos(tt/J)/Math.PI;return yt=X<0?90-yt:90+yt,{center:L.toLngLat(),zoom:lt,pitch:yt,bearing:bt}}easeTo(l,m){this._stop(!1,l.easeId),((l=n.e({offset:[0,0],duration:500,easing:n.bb},l)).animate===!1||!l.essential&&n.h.prefersReducedMotion)&&(l.duration=0);let v=this._getTransformForUpdate(),S=this.getZoom(),C=this.getBearing(),L=this.getPitch(),V=this.getPadding(),$="zoom"in l?+l.zoom:S,X="bearing"in l?this._normalizeBearing(l.bearing,C):C,J="pitch"in l?+l.pitch:L,tt="padding"in l?l.padding:v.padding,lt=n.P.convert(l.offset),bt=v.centerPoint.add(lt),yt=v.pointLocation(bt),Ct=n.L.convert(l.center||yt);this._normalizeCenter(Ct);let _t=v.project(yt),Zt=v.project(Ct).sub(_t),ne=v.zoomScale($-S),Ot,Gt;l.around&&(Ot=n.L.convert(l.around),Gt=v.locationPoint(Ot));let he={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||$!==S,this._rotating=this._rotating||C!==X,this._pitching=this._pitching||J!==L,this._padding=!v.isPaddingEqual(tt),this._easeId=l.easeId,this._prepareEase(m,l.noMoveStart,he),this.terrain&&this._prepareElevation(Ct),this._ease(ce=>{if(this._zooming&&(v.zoom=n.B.number(S,$,ce)),this._rotating&&(v.bearing=n.B.number(C,X,ce)),this._pitching&&(v.pitch=n.B.number(L,J,ce)),this._padding&&(v.interpolatePadding(V,tt,ce),bt=v.centerPoint.add(lt)),this.terrain&&!l.freezeElevation&&this._updateElevation(ce),Ot)v.setLocationAtPoint(Ot,Gt);else{let xe=v.zoomScale(v.zoom-S),Pe=$>S?Math.min(2,ne):Math.max(.5,ne),Te=Math.pow(Pe,1-ce),Fe=v.unproject(_t.add(Zt.mult(ce*Te)).mult(xe));v.setLocationAtPoint(v.renderWorldCopies?Fe.wrap():Fe,bt)}this._applyUpdatedTransform(v),this._fireMoveEvents(m)},ce=>{this.terrain&&this._finalizeElevation(),this._afterEase(m,ce)},l),this}_prepareEase(l,m,v={}){this._moving=!0,m||v.moving||this.fire(new n.k("movestart",l)),this._zooming&&!v.zooming&&this.fire(new n.k("zoomstart",l)),this._rotating&&!v.rotating&&this.fire(new n.k("rotatestart",l)),this._pitching&&!v.pitching&&this.fire(new n.k("pitchstart",l))}_prepareElevation(l){this._elevationCenter=l,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(l,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(l){this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);let m=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(l<1&&m!==this._elevationTarget){let v=this._elevationTarget-this._elevationStart;this._elevationStart+=l*(v-(m-(v*l+this._elevationStart))/(1-l)),this._elevationTarget=m}this.transform.elevation=n.B.number(this._elevationStart,this._elevationTarget,l)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(l){if(!this.transformCameraUpdate)return;let m=l.clone(),{center:v,zoom:S,pitch:C,bearing:L,elevation:V}=this.transformCameraUpdate(m);v&&(m.center=v),S!==void 0&&(m.zoom=S),C!==void 0&&(m.pitch=C),L!==void 0&&(m.bearing=L),V!==void 0&&(m.elevation=V),this.transform.apply(m)}_fireMoveEvents(l){this.fire(new n.k("move",l)),this._zooming&&this.fire(new n.k("zoom",l)),this._rotating&&this.fire(new n.k("rotate",l)),this._pitching&&this.fire(new n.k("pitch",l))}_afterEase(l,m){if(this._easeId&&m&&this._easeId===m)return;delete this._easeId;let v=this._zooming,S=this._rotating,C=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,v&&this.fire(new n.k("zoomend",l)),S&&this.fire(new n.k("rotateend",l)),C&&this.fire(new n.k("pitchend",l)),this.fire(new n.k("moveend",l))}flyTo(l,m){if(!l.essential&&n.h.prefersReducedMotion){let hr=n.F(l,["center","zoom","bearing","pitch","around"]);return this.jumpTo(hr,m)}this.stop(),l=n.e({offset:[0,0],speed:1.2,curve:1.42,easing:n.bb},l);let v=this._getTransformForUpdate(),S=this.getZoom(),C=this.getBearing(),L=this.getPitch(),V=this.getPadding(),$="zoom"in l?n.ad(+l.zoom,v.minZoom,v.maxZoom):S,X="bearing"in l?this._normalizeBearing(l.bearing,C):C,J="pitch"in l?+l.pitch:L,tt="padding"in l?l.padding:v.padding,lt=v.zoomScale($-S),bt=n.P.convert(l.offset),yt=v.centerPoint.add(bt),Ct=v.pointLocation(yt),_t=n.L.convert(l.center||Ct);this._normalizeCenter(_t);let Zt=v.project(Ct),ne=v.project(_t).sub(Zt),Ot=l.curve,Gt=Math.max(v.width,v.height),he=Gt/lt,ce=ne.mag();if("minZoom"in l){let hr=n.ad(Math.min(l.minZoom,S,$),v.minZoom,v.maxZoom),pn=Gt/v.zoomScale(hr-S);Ot=Math.sqrt(pn/ce*2)}let xe=Ot*Ot;function Pe(hr){let pn=(he*he-Gt*Gt+(hr?-1:1)*xe*xe*ce*ce)/(2*(hr?he:Gt)*xe*ce);return Math.log(Math.sqrt(pn*pn+1)-pn)}function Te(hr){return(Math.exp(hr)-Math.exp(-hr))/2}function Fe(hr){return(Math.exp(hr)+Math.exp(-hr))/2}let ur=Pe(!1),ki=function(hr){return Fe(ur)/Fe(ur+Ot*hr)},We=function(hr){return Gt*((Fe(ur)*(Te(pn=ur+Ot*hr)/Fe(pn))-Te(ur))/xe)/ce;var pn},Ir=(Pe(!0)-ur)/Ot;if(Math.abs(ce)<1e-6||!isFinite(Ir)){if(Math.abs(Gt-he)<1e-6)return this.easeTo(l,m);let hr=he<Gt?-1:1;Ir=Math.abs(Math.log(he/Gt))/Ot,We=function(){return 0},ki=function(pn){return Math.exp(hr*Ot*pn)}}return l.duration="duration"in l?+l.duration:1e3*Ir/("screenSpeed"in l?+l.screenSpeed/Ot:+l.speed),l.maxDuration&&l.duration>l.maxDuration&&(l.duration=0),this._zooming=!0,this._rotating=C!==X,this._pitching=J!==L,this._padding=!v.isPaddingEqual(tt),this._prepareEase(m,!1),this.terrain&&this._prepareElevation(_t),this._ease(hr=>{let pn=hr*Ir,Mi=1/ki(pn);v.zoom=hr===1?$:S+v.scaleZoom(Mi),this._rotating&&(v.bearing=n.B.number(C,X,hr)),this._pitching&&(v.pitch=n.B.number(L,J,hr)),this._padding&&(v.interpolatePadding(V,tt,hr),yt=v.centerPoint.add(bt)),this.terrain&&!l.freezeElevation&&this._updateElevation(hr);let ui=hr===1?_t:v.unproject(Zt.add(ne.mult(We(pn))).mult(Mi));v.setLocationAtPoint(v.renderWorldCopies?ui.wrap():ui,yt),this._applyUpdatedTransform(v),this._fireMoveEvents(m)},()=>{this.terrain&&this._finalizeElevation(),this._afterEase(m)},l),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(l,m){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){let v=this._onEaseEnd;delete this._onEaseEnd,v.call(this,m)}if(!l){let v=this.handlers;v&&v.stop(!1)}return this}_ease(l,m,v){v.animate===!1||v.duration===0?(l(1),m()):(this._easeStart=n.h.now(),this._easeOptions=v,this._onEaseFrame=l,this._onEaseEnd=m,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(l,m){l=n.b5(l,-180,180);let v=Math.abs(l-m);return Math.abs(l-360-m)<v&&(l-=360),Math.abs(l+360-m)<v&&(l+=360),l}_normalizeCenter(l){let m=this.transform;if(!m.renderWorldCopies||m.lngRange)return;let v=l.lng-m.center.lng;l.lng+=v>180?-360:v<-180?360:0}queryTerrainElevation(l){return this.terrain?this.terrain.getElevationForLngLatZoom(n.L.convert(l),this.transform.tileZoom)-this.transform.elevation:null}}class Sa{constructor(l={}){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=m=>{!m||m.sourceDataType!=="metadata"&&m.sourceDataType!=="visibility"&&m.dataType!=="style"&&m.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=l}getDefaultPosition(){return"bottom-right"}onAdd(l){return this._map=l,this._compact=this.options&&this.options.compact,this._container=c.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=c.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=c.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){c.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(l,m){let v=this._map._getUIString(`AttributionControl.${m}`);l.title=v,l.setAttribute("aria-label",v)}_updateAttributions(){if(!this._map.style)return;let l=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?l=l.concat(this.options.customAttribution.map(S=>typeof S!="string"?"":S)):typeof this.options.customAttribution=="string"&&l.push(this.options.customAttribution)),this._map.style.stylesheet){let S=this._map.style.stylesheet;this.styleOwner=S.owner,this.styleId=S.id}let m=this._map.style.sourceCaches;for(let S in m){let C=m[S];if(C.used||C.usedForTerrain){let L=C.getSource();L.attribution&&l.indexOf(L.attribution)<0&&l.push(L.attribution)}}l=l.filter(S=>String(S).trim()),l.sort((S,C)=>S.length-C.length),l=l.filter((S,C)=>{for(let L=C+1;L<l.length;L++)if(l[L].indexOf(S)>=0)return!1;return!0});let v=l.join(" | ");v!==this._attribHTML&&(this._attribHTML=v,l.length?(this._innerContainer.innerHTML=v,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Wn{constructor(l={}){this._updateCompact=()=>{let m=this._container.children;if(m.length){let v=m[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&v.classList.add("maplibregl-compact"):v.classList.remove("maplibregl-compact")}},this.options=l}getDefaultPosition(){return"bottom-left"}onAdd(l){this._map=l,this._compact=this.options&&this.options.compact,this._container=c.create("div","maplibregl-ctrl");let m=c.create("a","maplibregl-ctrl-logo");return m.target="_blank",m.rel="noopener nofollow",m.href="https://maplibre.org/",m.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),m.setAttribute("rel","noopener nofollow"),this._container.appendChild(m),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){c.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class X0{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(l){let m=++this._id;return this._queue.push({callback:l,id:m,cancelled:!1}),m}remove(l){let m=this._currentlyRunning,v=m?this._queue.concat(m):this._queue;for(let S of v)if(S.id===l)return void(S.cancelled=!0)}run(l=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");let m=this._currentlyRunning=this._queue;this._queue=[];for(let v of m)if(!v.cancelled&&(v.callback(l),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}let Jm={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"};var q_=n.Q([{name:"a_pos3d",type:"Int16",components:3}]);class Y_ extends n.E{constructor(l){super(),this.sourceCache=l,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,l.usedForTerrain=!0,l.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(l,m){this.sourceCache.update(l,m),this._renderableTilesKeys=[];let v={};for(let S of l.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:m}))v[S.key]=!0,this._renderableTilesKeys.push(S.key),this._tiles[S.key]||(S.posMatrix=new Float64Array(16),n.aS(S.posMatrix,0,n.N,0,n.N,0,1),this._tiles[S.key]=new hn(S,this.tileSize));for(let S in this._tiles)v[S]||delete this._tiles[S]}freeRtt(l){for(let m in this._tiles){let v=this._tiles[m];(!l||v.tileID.equals(l)||v.tileID.isChildOf(l)||l.isChildOf(v.tileID))&&(v.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(l=>this.getTileByID(l))}getTileByID(l){return this._tiles[l]}getTerrainCoords(l){let m={};for(let v of this._renderableTilesKeys){let S=this._tiles[v].tileID;if(S.canonical.equals(l.canonical)){let C=l.clone();C.posMatrix=new Float64Array(16),n.aS(C.posMatrix,0,n.N,0,n.N,0,1),m[v]=C}else if(S.canonical.isChildOf(l.canonical)){let C=l.clone();C.posMatrix=new Float64Array(16);let L=S.canonical.z-l.canonical.z,V=S.canonical.x-(S.canonical.x>>L<<L),$=S.canonical.y-(S.canonical.y>>L<<L),X=n.N>>L;n.aS(C.posMatrix,0,X,0,X,0,1),n.$(C.posMatrix,C.posMatrix,[-V*X,-$*X,0]),m[v]=C}else if(l.canonical.isChildOf(S.canonical)){let C=l.clone();C.posMatrix=new Float64Array(16);let L=l.canonical.z-S.canonical.z,V=l.canonical.x-(l.canonical.x>>L<<L),$=l.canonical.y-(l.canonical.y>>L<<L),X=n.N>>L;n.aS(C.posMatrix,0,n.N,0,n.N,0,1),n.$(C.posMatrix,C.posMatrix,[V*X,$*X,0]),n.a0(C.posMatrix,C.posMatrix,[1/2**L,1/2**L,0]),m[v]=C}}return m}getSourceTile(l,m){let v=this.sourceCache._source,S=l.overscaledZ-this.deltaZoom;if(S>v.maxzoom&&(S=v.maxzoom),S<v.minzoom)return null;this._sourceTileCache[l.key]||(this._sourceTileCache[l.key]=l.scaledTo(S).key);let C=this.sourceCache.getTileByID(this._sourceTileCache[l.key]);if((!C||!C.dem)&&m)for(;S>=v.minzoom&&(!C||!C.dem);)C=this.sourceCache.getTileByID(l.scaledTo(S--).key);return C}tilesAfterTime(l=Date.now()){return Object.values(this._tiles).filter(m=>m.timeAdded>=l)}}class ad{constructor(l,m,v){this.painter=l,this.sourceCache=new Y_(m),this.options=v,this.exaggeration=typeof v.exaggeration=="number"?v.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(l,m,v,S=n.N){var C;if(!(m>=0&&m<S&&v>=0&&v<S))return 0;let L=this.getTerrainData(l),V=(C=L.tile)===null||C===void 0?void 0:C.dem;if(!V)return 0;let $=function(yt,Ct,_t){var Zt=Ct[0],ne=Ct[1];return yt[0]=_t[0]*Zt+_t[4]*ne+_t[12],yt[1]=_t[1]*Zt+_t[5]*ne+_t[13],yt}([],[m/S*n.N,v/S*n.N],L.u_terrain_matrix),X=[$[0]*V.dim,$[1]*V.dim],J=Math.floor(X[0]),tt=Math.floor(X[1]),lt=X[0]-J,bt=X[1]-tt;return V.get(J,tt)*(1-lt)*(1-bt)+V.get(J+1,tt)*lt*(1-bt)+V.get(J,tt+1)*(1-lt)*bt+V.get(J+1,tt+1)*lt*bt}getElevationForLngLatZoom(l,m){let{tileID:v,mercatorX:S,mercatorY:C}=this._getOverscaledTileIDFromLngLatZoom(l,m);return this.getElevation(v,S%n.N,C%n.N,n.N)}getElevation(l,m,v,S=n.N){return this.getDEMElevation(l,m,v,S)*this.exaggeration}getTerrainData(l){if(!this._emptyDemTexture){let S=this.painter.context,C=new n.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new Tt(S,C,S.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new Tt(S,new n.R({width:1,height:1}),S.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(S.gl.NEAREST,S.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=n.ao([])}let m=this.sourceCache.getSourceTile(l,!0);if(m&&m.dem&&(!m.demTexture||m.needsTerrainPrepare)){let S=this.painter.context;m.demTexture=this.painter.getTileTexture(m.dem.stride),m.demTexture?m.demTexture.update(m.dem.getPixels(),{premultiply:!1}):m.demTexture=new Tt(S,m.dem.getPixels(),S.gl.RGBA,{premultiply:!1}),m.demTexture.bind(S.gl.NEAREST,S.gl.CLAMP_TO_EDGE),m.needsTerrainPrepare=!1}let v=m&&m+m.tileID.key+l.key;if(v&&!this._demMatrixCache[v]){let S=this.sourceCache.sourceCache._source.maxzoom,C=l.canonical.z-m.tileID.canonical.z;l.overscaledZ>l.canonical.z&&(l.canonical.z>=S?C=l.canonical.z-S:n.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));let L=l.canonical.x-(l.canonical.x>>C<<C),V=l.canonical.y-(l.canonical.y>>C<<C),$=n.bc(new Float64Array(16),[1/(n.N<<C),1/(n.N<<C),0]);n.$($,$,[L*n.N,V*n.N,0]),this._demMatrixCache[l.key]={matrix:$,coord:l}}return{u_depth:2,u_terrain:3,u_terrain_dim:m&&m.dem&&m.dem.dim||1,u_terrain_matrix:v?this._demMatrixCache[l.key].matrix:this._emptyDemMatrix,u_terrain_unpack:m&&m.dem&&m.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(m&&m.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:m}}getFramebuffer(l){let m=this.painter,v=m.width/devicePixelRatio,S=m.height/devicePixelRatio;return!this._fbo||this._fbo.width===v&&this._fbo.height===S||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new Tt(m.context,{width:v,height:S,data:null},m.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(m.context.gl.NEAREST,m.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new Tt(m.context,{width:v,height:S,data:null},m.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(m.context.gl.NEAREST,m.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=m.context.createFramebuffer(v,S,!0,!1),this._fbo.depthAttachment.set(m.context.createRenderbuffer(m.context.gl.DEPTH_COMPONENT16,v,S))),this._fbo.colorAttachment.set(l==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){let l=this.painter.context;if(this._coordsTexture)return this._coordsTexture;let m=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let C=0,L=0;C<this._coordsTextureSize;C++)for(let V=0;V<this._coordsTextureSize;V++,L+=4)m[L+0]=255&V,m[L+1]=255&C,m[L+2]=V>>8<<4|C>>8,m[L+3]=0;let v=new n.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(m.buffer)),S=new Tt(l,v,l.gl.RGBA,{premultiply:!1});return S.bind(l.gl.NEAREST,l.gl.CLAMP_TO_EDGE),this._coordsTexture=S,S}pointCoordinate(l){let m=new Uint8Array(4),v=this.painter.context,S=v.gl;v.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),S.readPixels(l.x,this.painter.height/devicePixelRatio-l.y-1,1,1,S.RGBA,S.UNSIGNED_BYTE,m),v.bindFramebuffer.set(null);let C=m[0]+(m[2]>>4<<8),L=m[1]+((15&m[2])<<8),V=this.coordsIndex[255-m[3]],$=V&&this.sourceCache.getTileByID(V);if(!$)return null;let X=this._coordsTextureSize,J=(1<<$.tileID.canonical.z)*X;return new n.U(this._allowMercatorOverflow(l,($.tileID.canonical.x*X+C)/J),($.tileID.canonical.y*X+L)/J,this.getElevation($.tileID,C,L,X))}getTerrainMesh(){if(this._mesh)return this._mesh;let l=this.painter.context,m=new n.bd,v=new n.b0,S=this.meshSize,C=n.N/S,L=S*S;for(let tt=0;tt<=S;tt++)for(let lt=0;lt<=S;lt++)m.emplaceBack(lt*C,tt*C,0);for(let tt=0;tt<L;tt+=S+1)for(let lt=0;lt<S;lt++)v.emplaceBack(lt+tt,S+lt+tt+1,S+lt+tt+2),v.emplaceBack(lt+tt,S+lt+tt+2,lt+tt+1);let V=m.length,$=V+2*(S+1);for(let tt of[0,1])for(let lt=0;lt<=S;lt++)for(let bt of[0,1])m.emplaceBack(lt*C,tt*n.N,bt);for(let tt=0;tt<2*S;tt+=2)v.emplaceBack($+tt,$+tt+1,$+tt+3),v.emplaceBack($+tt,$+tt+3,$+tt+2),v.emplaceBack(V+tt,V+tt+3,V+tt+1),v.emplaceBack(V+tt,V+tt+2,V+tt+3);let X=m.length,J=X+2*(S+1);for(let tt of[0,1])for(let lt=0;lt<=S;lt++)for(let bt of[0,1])m.emplaceBack(tt*n.N,lt*C,bt);for(let tt=0;tt<2*S;tt+=2)v.emplaceBack(X+tt,X+tt+1,X+tt+3),v.emplaceBack(X+tt,X+tt+3,X+tt+2),v.emplaceBack(J+tt,J+tt+3,J+tt+1),v.emplaceBack(J+tt,J+tt+2,J+tt+3);return this._mesh={indexBuffer:l.createIndexBuffer(v),vertexBuffer:l.createVertexBuffer(m,q_.members),segments:n.S.simpleSegment(0,0,m.length,v.length)},this._mesh}getMeshFrameDelta(l){return 2*Math.PI*n.be/Math.pow(2,l)/5}getMinTileElevationForLngLatZoom(l,m){var v;let{tileID:S}=this._getOverscaledTileIDFromLngLatZoom(l,m);return(v=this.getMinMaxElevation(S).minElevation)!==null&&v!==void 0?v:0}getMinMaxElevation(l){let m=this.getTerrainData(l).tile,v={minElevation:null,maxElevation:null};return m&&m.dem&&(v.minElevation=m.dem.min*this.exaggeration,v.maxElevation=m.dem.max*this.exaggeration),v}_getOverscaledTileIDFromLngLatZoom(l,m){let v=n.U.fromLngLat(l.wrap()),S=(1<<m)*n.N,C=v.x*S,L=v.y*S,V=Math.floor(C/n.N),$=Math.floor(L/n.N);return{tileID:new n.O(m,0,m,V,$),mercatorX:C,mercatorY:L}}_allowMercatorOverflow(l,m){let v=l.x<this.painter.width/2,S=n.bf(m),C=this.painter.transform.center.lng;return v&&Math.sign(S)>0&&Math.sign(C)<0||!v&&Math.sign(S)<0&&Math.sign(C)>0?(S=360*Math.sign(C)+S,n.G(S)):m}}class hb{constructor(l,m,v){this._context=l,this._size=m,this._tileSize=v,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(let l of this._objects)l.texture.destroy(),l.fbo.destroy()}_createObject(l){let m=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),v=new Tt(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return v.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),m.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),m.colorAttachment.set(v.texture),{id:l,fbo:m,texture:v,stamp:-1,inUse:!1}}getObjectForId(l){return this._objects[l]}useObject(l){l.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(m=>l.id!==m),this._recentlyUsed.push(l.id)}stampObject(l){l.stamp=++this._stamp}getOrCreateFreeObject(){for(let m of this._recentlyUsed)if(!this._objects[m].inUse)return this._objects[m];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");let l=this._createObject(this._objects.length);return this._objects.push(l),l}freeObject(l){l.inUse=!1}freeAllObjects(){for(let l of this._objects)this.freeObject(l)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(l=>!l.inUse)===!1}}let $o={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class Z0{constructor(l,m){this.painter=l,this.terrain=m,this.pool=new hb(l.context,30,m.sourceCache.tileSize*m.qualityFactor)}destruct(){this.pool.destruct()}getTexture(l){return this.pool.getObjectForId(l.rtt[this._stacks.length-1].id).texture}prepareForRender(l,m){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=l._order.filter(v=>!l._layers[v].isHidden(m)),this._coordsDescendingInv={};for(let v in l.sourceCaches){this._coordsDescendingInv[v]={};let S=l.sourceCaches[v].getVisibleCoordinates();for(let C of S){let L=this.terrain.sourceCache.getTerrainCoords(C);for(let V in L)this._coordsDescendingInv[v][V]||(this._coordsDescendingInv[v][V]=[]),this._coordsDescendingInv[v][V].push(L[V])}}this._coordsDescendingInvStr={};for(let v of l._order){let S=l._layers[v],C=S.source;if($o[S.type]&&!this._coordsDescendingInvStr[C]){this._coordsDescendingInvStr[C]={};for(let L in this._coordsDescendingInv[C])this._coordsDescendingInvStr[C][L]=this._coordsDescendingInv[C][L].map(V=>V.key).sort().join()}}for(let v of this._renderableTiles)for(let S in this._coordsDescendingInvStr){let C=this._coordsDescendingInvStr[S][v.tileID.key];C&&C!==v.rttCoords[S]&&(v.rtt=[])}}renderLayer(l){if(l.isHidden(this.painter.transform.zoom))return!1;let m=l.type,v=this.painter,S=this._renderableLayerIds[this._renderableLayerIds.length-1]===l.id;if($o[m]&&(this._prevType&&$o[this._prevType]||this._stacks.push([]),this._prevType=m,this._stacks[this._stacks.length-1].push(l.id),!S))return!0;if($o[this._prevType]||$o[m]&&S){this._prevType=m;let C=this._stacks.length-1,L=this._stacks[C]||[];for(let V of this._renderableTiles){if(this.pool.isFull()&&(cs(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(V),V.rtt[C]){let X=this.pool.getObjectForId(V.rtt[C].id);if(X.stamp===V.rtt[C].stamp){this.pool.useObject(X);continue}}let $=this.pool.getOrCreateFreeObject();this.pool.useObject($),this.pool.stampObject($),V.rtt[C]={id:$.id,stamp:$.stamp},v.context.bindFramebuffer.set($.fbo.framebuffer),v.context.clear({color:n.aT.transparent,stencil:0}),v.currentStencilSource=void 0;for(let X=0;X<L.length;X++){let J=v.style._layers[L[X]],tt=J.source?this._coordsDescendingInv[J.source][V.tileID.key]:[V.tileID];v.context.viewport.set([0,0,$.fbo.width,$.fbo.height]),v._renderTileClippingMasks(J,tt),v.renderLayer(v,v.style.sourceCaches[J.source],J,tt),J.source&&(V.rttCoords[J.source]=this._coordsDescendingInvStr[J.source][V.tileID.key])}}return cs(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),$o[m]}return!1}}let cr=o,Rr={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:n.c.MAX_TILE_CACHE_ZOOM_LEVELS,localIdeographFontFamily:"sans-serif",transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,validateStyle:!0,maxCanvasSize:[4096,4096]},wh=M=>{M.touchstart=M.dragStart,M.touchmoveWindow=M.dragMove,M.touchend=M.dragEnd},G0={showCompass:!0,showZoom:!0,visualizePitch:!1};class yu{constructor(l,m,v=!1){this.mousedown=L=>{this.startMouse(n.e({},L,{ctrlKey:!0,preventDefault:()=>L.preventDefault()}),c.mousePos(this.element,L)),c.addEventListener(window,"mousemove",this.mousemove),c.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=L=>{this.moveMouse(L,c.mousePos(this.element,L))},this.mouseup=L=>{this.mouseRotate.dragEnd(L),this.mousePitch&&this.mousePitch.dragEnd(L),this.offTemp()},this.touchstart=L=>{L.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=c.touchPos(this.element,L.targetTouches)[0],this.startTouch(L,this._startPos),c.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),c.addEventListener(window,"touchend",this.touchend))},this.touchmove=L=>{L.targetTouches.length!==1?this.reset():(this._lastPos=c.touchPos(this.element,L.targetTouches)[0],this.moveTouch(L,this._lastPos))},this.touchend=L=>{L.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;let S=l.dragRotate._mouseRotate.getClickTolerance(),C=l.dragRotate._mousePitch.getClickTolerance();this.element=m,this.mouseRotate=Sf({clickTolerance:S,enable:!0}),this.touchRotate=(({enable:L,clickTolerance:V,bearingDegreesPerPixelMoved:$=.8})=>{let X=new qm;return new Lc({clickTolerance:V,move:(J,tt)=>({bearingDelta:(tt.x-J.x)*$}),moveStateManager:X,enable:L,assignEvents:wh})})({clickTolerance:S,enable:!0}),this.map=l,v&&(this.mousePitch=zc({clickTolerance:C,enable:!0}),this.touchPitch=(({enable:L,clickTolerance:V,pitchDegreesPerPixelMoved:$=-.5})=>{let X=new qm;return new Lc({clickTolerance:V,move:(J,tt)=>({pitchDelta:(tt.y-J.y)*$}),moveStateManager:X,enable:L,assignEvents:wh})})({clickTolerance:C,enable:!0})),c.addEventListener(m,"mousedown",this.mousedown),c.addEventListener(m,"touchstart",this.touchstart,{passive:!1}),c.addEventListener(m,"touchcancel",this.reset)}startMouse(l,m){this.mouseRotate.dragStart(l,m),this.mousePitch&&this.mousePitch.dragStart(l,m),c.disableDrag()}startTouch(l,m){this.touchRotate.dragStart(l,m),this.touchPitch&&this.touchPitch.dragStart(l,m),c.disableDrag()}moveMouse(l,m){let v=this.map,{bearingDelta:S}=this.mouseRotate.dragMove(l,m)||{};if(S&&v.setBearing(v.getBearing()+S),this.mousePitch){let{pitchDelta:C}=this.mousePitch.dragMove(l,m)||{};C&&v.setPitch(v.getPitch()+C)}}moveTouch(l,m){let v=this.map,{bearingDelta:S}=this.touchRotate.dragMove(l,m)||{};if(S&&v.setBearing(v.getBearing()+S),this.touchPitch){let{pitchDelta:C}=this.touchPitch.dragMove(l,m)||{};C&&v.setPitch(v.getPitch()+C)}}off(){let l=this.element;c.removeEventListener(l,"mousedown",this.mousedown),c.removeEventListener(l,"touchstart",this.touchstart,{passive:!1}),c.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),c.removeEventListener(window,"touchend",this.touchend),c.removeEventListener(l,"touchcancel",this.reset),this.offTemp()}offTemp(){c.enableDrag(),c.removeEventListener(window,"mousemove",this.mousemove),c.removeEventListener(window,"mouseup",this.mouseup),c.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),c.removeEventListener(window,"touchend",this.touchend)}}let Ps;function ld(M,l,m){if(M=new n.L(M.lng,M.lat),l){let v=new n.L(M.lng-360,M.lat),S=new n.L(M.lng+360,M.lat),C=m.locationPoint(M).distSqr(l);m.locationPoint(v).distSqr(l)<C?M=v:m.locationPoint(S).distSqr(l)<C&&(M=S)}for(;Math.abs(M.lng-m.center.lng)>180;){let v=m.locationPoint(M);if(v.x>=0&&v.y>=0&&v.x<=m.width&&v.y<=m.height)break;M.lng>m.center.lng?M.lng-=360:M.lng+=360}return M}let Ea={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function X_(M,l,m){let v=M.classList;for(let S in Ea)v.remove(`maplibregl-${m}-anchor-${S}`);v.add(`maplibregl-${m}-anchor-${l}`)}class xu extends n.E{constructor(l){if(super(),this._onKeyPress=m=>{let v=m.code,S=m.charCode||m.keyCode;v!=="Space"&&v!=="Enter"&&S!==32&&S!==13||this.togglePopup()},this._onMapClick=m=>{let v=m.originalEvent.target,S=this._element;this._popup&&(v===S||S.contains(v))&&this.togglePopup()},this._update=m=>{if(!this._map)return;let v=this._map.loaded()&&!this._map.isMoving();(m?.type==="terrain"||m?.type==="render"&&!v)&&this._map.once("render",this._update),this._map.transform.renderWorldCopies&&(this._lngLat=ld(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let S="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?S=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(S=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let C="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?C="rotateX(0deg)":this._pitchAlignment==="map"&&(C=`rotateX(${this._map.getPitch()}deg)`),m&&m.type!=="moveend"||(this._pos=this._pos.round()),c.setTransform(this._element,`${Ea[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${C} ${S}`),this._map.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout(()=>{let L=this._map.unproject(this._pos),V=40075016686e-3*Math.abs(Math.cos(this._lngLat.lat*Math.PI/180))/Math.pow(2,this._map.transform.tileZoom+8);this._element.style.opacity=L.distanceTo(this._lngLat)>20*V?"0.2":"1.0",this._opacityTimeout=null},100))},this._onMove=m=>{if(!this._isDragging){let v=this._clickTolerance||this._map._clickTolerance;this._isDragging=m.point.dist(this._pointerdownPos)>=v}this._isDragging&&(this._pos=m.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new n.k("dragstart"))),this.fire(new n.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new n.k("dragend")),this._state="inactive"},this._addDragHandler=m=>{this._element.contains(m.originalEvent.target)&&(m.preventDefault(),this._positionDelta=m.point.sub(this._pos).add(this._offset),this._pointerdownPos=m.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=l&&l.anchor||"center",this._color=l&&l.color||"#3FB1CE",this._scale=l&&l.scale||1,this._draggable=l&&l.draggable||!1,this._clickTolerance=l&&l.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=l&&l.rotation||0,this._rotationAlignment=l&&l.rotationAlignment||"auto",this._pitchAlignment=l&&l.pitchAlignment&&l.pitchAlignment!=="auto"?l.pitchAlignment:this._rotationAlignment,l&&l.element)this._element=l.element,this._offset=n.P.convert(l&&l.offset||[0,0]);else{this._defaultMarker=!0,this._element=c.create("div"),this._element.setAttribute("aria-label","Map marker");let m=c.createNS("http://www.w3.org/2000/svg","svg"),v=41,S=27;m.setAttributeNS(null,"display","block"),m.setAttributeNS(null,"height",`${v}px`),m.setAttributeNS(null,"width",`${S}px`),m.setAttributeNS(null,"viewBox",`0 0 ${S} ${v}`);let C=c.createNS("http://www.w3.org/2000/svg","g");C.setAttributeNS(null,"stroke","none"),C.setAttributeNS(null,"stroke-width","1"),C.setAttributeNS(null,"fill","none"),C.setAttributeNS(null,"fill-rule","evenodd");let L=c.createNS("http://www.w3.org/2000/svg","g");L.setAttributeNS(null,"fill-rule","nonzero");let V=c.createNS("http://www.w3.org/2000/svg","g");V.setAttributeNS(null,"transform","translate(3.0, 29.0)"),V.setAttributeNS(null,"fill","#000000");let $=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(let Zt of $){let ne=c.createNS("http://www.w3.org/2000/svg","ellipse");ne.setAttributeNS(null,"opacity","0.04"),ne.setAttributeNS(null,"cx","10.5"),ne.setAttributeNS(null,"cy","5.80029008"),ne.setAttributeNS(null,"rx",Zt.rx),ne.setAttributeNS(null,"ry",Zt.ry),V.appendChild(ne)}let X=c.createNS("http://www.w3.org/2000/svg","g");X.setAttributeNS(null,"fill",this._color);let J=c.createNS("http://www.w3.org/2000/svg","path");J.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),X.appendChild(J);let tt=c.createNS("http://www.w3.org/2000/svg","g");tt.setAttributeNS(null,"opacity","0.25"),tt.setAttributeNS(null,"fill","#000000");let lt=c.createNS("http://www.w3.org/2000/svg","path");lt.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),tt.appendChild(lt);let bt=c.createNS("http://www.w3.org/2000/svg","g");bt.setAttributeNS(null,"transform","translate(6.0, 7.0)"),bt.setAttributeNS(null,"fill","#FFFFFF");let yt=c.createNS("http://www.w3.org/2000/svg","g");yt.setAttributeNS(null,"transform","translate(8.0, 8.0)");let Ct=c.createNS("http://www.w3.org/2000/svg","circle");Ct.setAttributeNS(null,"fill","#000000"),Ct.setAttributeNS(null,"opacity","0.25"),Ct.setAttributeNS(null,"cx","5.5"),Ct.setAttributeNS(null,"cy","5.5"),Ct.setAttributeNS(null,"r","5.4999962");let _t=c.createNS("http://www.w3.org/2000/svg","circle");_t.setAttributeNS(null,"fill","#FFFFFF"),_t.setAttributeNS(null,"cx","5.5"),_t.setAttributeNS(null,"cy","5.5"),_t.setAttributeNS(null,"r","5.4999962"),yt.appendChild(Ct),yt.appendChild(_t),L.appendChild(V),L.appendChild(X),L.appendChild(tt),L.appendChild(bt),L.appendChild(yt),m.appendChild(L),m.setAttributeNS(null,"height",v*this._scale+"px"),m.setAttributeNS(null,"width",S*this._scale+"px"),this._element.appendChild(m),this._offset=n.P.convert(l&&l.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",m=>{m.preventDefault()}),this._element.addEventListener("mousedown",m=>{m.preventDefault()}),X_(this._element,this._anchor,"marker"),l&&l.className)for(let m of l.className.split(" "))this._element.classList.add(m);this._popup=null}addTo(l){return this.remove(),this._map=l,l.getCanvasContainer().appendChild(this._element),l.on("move",this._update),l.on("moveend",this._update),l.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),c.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(l){return this._lngLat=n.L.convert(l),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(l){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),l){if(!("offset"in l.options)){let S=Math.abs(13.5)/Math.SQRT2;l.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[S,-1*(38.1-13.5+S)],"bottom-right":[-S,-1*(38.1-13.5+S)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=l,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}getPopup(){return this._popup}togglePopup(){let l=this._popup;return l?(l.isOpen()?l.remove():l.addTo(this._map),this):this}getOffset(){return this._offset}setOffset(l){return this._offset=n.P.convert(l),this._update(),this}addClassName(l){this._element.classList.add(l)}removeClassName(l){this._element.classList.remove(l)}toggleClassName(l){return this._element.classList.toggle(l)}setDraggable(l){return this._draggable=!!l,this._map&&(l?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(l){return this._rotation=l||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(l){return this._rotationAlignment=l||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(l){return this._pitchAlignment=l&&l!=="auto"?l:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}let Gn={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},qn=0,Vc=!1,wn={maxWidth:100,unit:"metric"};function cd(M,l,m){let v=m&&m.maxWidth||100,S=M._container.clientHeight/2,C=M.unproject([0,S]),L=M.unproject([v,S]),V=C.distanceTo(L);if(m&&m.unit==="imperial"){let $=3.2808*V;$>5280?Th(l,v,$/5280,M._getUIString("ScaleControl.Miles")):Th(l,v,$,M._getUIString("ScaleControl.Feet"))}else m&&m.unit==="nautical"?Th(l,v,V/1852,M._getUIString("ScaleControl.NauticalMiles")):V>=1e3?Th(l,v,V/1e3,M._getUIString("ScaleControl.Kilometers")):Th(l,v,V,M._getUIString("ScaleControl.Meters"))}function Th(M,l,m,v){let S=function(C){let L=Math.pow(10,`${Math.floor(C)}`.length-1),V=C/L;return V=V>=10?10:V>=5?5:V>=3?3:V>=2?2:V>=1?1:function($){let X=Math.pow(10,Math.ceil(-Math.log($)/Math.LN10));return Math.round($*X)/X}(V),L*V}(m);M.style.width=l*(S/m)+"px",M.innerHTML=`${S}&nbsp;${v}`}let tg={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},eg=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Mf(M){if(M){if(typeof M=="number"){let l=Math.round(Math.abs(M)/Math.SQRT2);return{center:new n.P(0,0),top:new n.P(0,M),"top-left":new n.P(l,l),"top-right":new n.P(-l,l),bottom:new n.P(0,-M),"bottom-left":new n.P(l,-l),"bottom-right":new n.P(-l,-l),left:new n.P(M,0),right:new n.P(-M,0)}}if(M instanceof n.P||Array.isArray(M)){let l=n.P.convert(M);return{center:l,top:l,"top-left":l,"top-right":l,bottom:l,"bottom-left":l,"bottom-right":l,left:l,right:l}}return{center:n.P.convert(M.center||[0,0]),top:n.P.convert(M.top||[0,0]),"top-left":n.P.convert(M["top-left"]||[0,0]),"top-right":n.P.convert(M["top-right"]||[0,0]),bottom:n.P.convert(M.bottom||[0,0]),"bottom-left":n.P.convert(M["bottom-left"]||[0,0]),"bottom-right":n.P.convert(M["bottom-right"]||[0,0]),left:n.P.convert(M.left||[0,0]),right:n.P.convert(M.right||[0,0])}}return Mf(new n.P(0,0))}let rg={extend:(M,...l)=>n.e(M,...l),run(M){M()},logToElement(M,l=!1,m="log"){let v=window.document.getElementById(m);v&&(l&&(v.innerHTML=""),v.innerHTML+=`<br>${M}`)}},ig=o;class ii{static get version(){return ig}static get workerCount(){return Ro.workerCount}static set workerCount(l){Ro.workerCount=l}static get maxParallelImageRequests(){return n.c.MAX_PARALLEL_IMAGE_REQUESTS}static set maxParallelImageRequests(l){n.c.MAX_PARALLEL_IMAGE_REQUESTS=l}static get workerUrl(){return n.c.WORKER_URL}static set workerUrl(l){n.c.WORKER_URL=l}static addProtocol(l,m){n.c.REGISTERED_PROTOCOLS[l]=m}static removeProtocol(l){delete n.c.REGISTERED_PROTOCOLS[l]}}return ii.Map=class extends W_{constructor(M){if(n.bg.mark(n.bh.create),(M=n.e({},Rr,M)).minZoom!=null&&M.maxZoom!=null&&M.minZoom>M.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(M.minPitch!=null&&M.maxPitch!=null&&M.minPitch>M.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(M.minPitch!=null&&M.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(M.maxPitch!=null&&M.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new id(M.minZoom,M.maxZoom,M.minPitch,M.maxPitch,M.renderWorldCopies),{bearingSnap:M.bearingSnap}),this._cooperativeGesturesOnWheel=l=>{this._onCooperativeGesture(l,l[this._metaKey],1)},this._contextLost=l=>{l.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new n.k("webglcontextlost",{originalEvent:l}))},this._contextRestored=l=>{this._setupPainter(),this.resize(),this._update(),this.fire(new n.k("webglcontextrestored",{originalEvent:l}))},this._onMapScroll=l=>{if(l.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=M.interactive,this._cooperativeGestures=M.cooperativeGestures,this._metaKey=navigator.platform.indexOf("Mac")===0?"metaKey":"ctrlKey",this._maxTileCacheSize=M.maxTileCacheSize,this._maxTileCacheZoomLevels=M.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=M.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=M.preserveDrawingBuffer,this._antialias=M.antialias,this._trackResize=M.trackResize,this._bearingSnap=M.bearingSnap,this._refreshExpiredTiles=M.refreshExpiredTiles,this._fadeDuration=M.fadeDuration,this._crossSourceCollisions=M.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=M.collectResourceTiming,this._renderTaskQueue=new X0,this._controls=[],this._mapId=n.a2(),this._locale=n.e({},Jm,M.locale),this._clickTolerance=M.clickTolerance,this._overridePixelRatio=M.pixelRatio,this._maxCanvasSize=M.maxCanvasSize,this.transformCameraUpdate=M.transformCameraUpdate,this._imageQueueHandle=N.addThrottleControl(()=>this.isMoving()),this._requestManager=new U(M.transformRequest),typeof M.container=="string"){if(this._container=document.getElementById(M.container),!this._container)throw new Error(`Container '${M.container}' not found.`)}else{if(!(M.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=M.container}if(M.maxBounds&&this.setMaxBounds(M.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let l=!1,m=mu(v=>{this._trackResize&&!this._removed&&this.resize(v)._update()},50);this._resizeObserver=new ResizeObserver(v=>{l?m(v):l=!0}),this._resizeObserver.observe(this._container)}this.handlers=new Km(this,M),this._cooperativeGestures&&this._setupCooperativeGestures(),this._hash=M.hash&&new wf(typeof M.hash=="string"&&M.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:M.center,zoom:M.zoom,bearing:M.bearing,pitch:M.pitch}),M.bounds&&(this.resize(),this.fitBounds(M.bounds,n.e({},M.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=M.localIdeographFontFamily,this._validateStyle=M.validateStyle,M.style&&this.setStyle(M.style,{localIdeographFontFamily:M.localIdeographFontFamily}),M.attributionControl&&this.addControl(new Sa({customAttribution:M.customAttribution})),M.maplibreLogo&&this.addControl(new Wn,M.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",l=>{this._update(l.dataType==="style"),this.fire(new n.k(`${l.dataType}data`,l))}),this.on("dataloading",l=>{this.fire(new n.k(`${l.dataType}dataloading`,l))}),this.on("dataabort",l=>{this.fire(new n.k("sourcedataabort",l))})}_getMapId(){return this._mapId}addControl(M,l){if(l===void 0&&(l=M.getDefaultPosition?M.getDefaultPosition():"top-right"),!M||!M.onAdd)return this.fire(new n.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));let m=M.onAdd(this);this._controls.push(M);let v=this._controlPositions[l];return l.indexOf("bottom")!==-1?v.insertBefore(m,v.firstChild):v.appendChild(m),this}removeControl(M){if(!M||!M.onRemove)return this.fire(new n.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));let l=this._controls.indexOf(M);return l>-1&&this._controls.splice(l,1),M.onRemove(this),this}hasControl(M){return this._controls.indexOf(M)>-1}calculateCameraOptionsFromTo(M,l,m,v){return v==null&&this.terrain&&(v=this.terrain.getElevationForLngLatZoom(m,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(M,l,m,v)}resize(M){var l;let m=this._containerDimensions(),v=m[0],S=m[1],C=this._getClampedPixelRatio(v,S);if(this._resizeCanvas(v,S,C),this.painter.resize(v,S,C),this.painter.overLimit()){let V=this.painter.context.gl;this._maxCanvasSize=[V.drawingBufferWidth,V.drawingBufferHeight];let $=this._getClampedPixelRatio(v,S);this._resizeCanvas(v,S,$),this.painter.resize(v,S,$)}this.transform.resize(v,S),(l=this._requestedCameraState)===null||l===void 0||l.resize(v,S);let L=!this._moving;return L&&(this.stop(),this.fire(new n.k("movestart",M)).fire(new n.k("move",M))),this.fire(new n.k("resize",M)),L&&this.fire(new n.k("moveend",M)),this}_getClampedPixelRatio(M,l){let{0:m,1:v}=this._maxCanvasSize,S=this.getPixelRatio(),C=M*S,L=l*S;return Math.min(C>m?m/C:1,L>v?v/L:1)*S}getPixelRatio(){var M;return(M=this._overridePixelRatio)!==null&&M!==void 0?M:devicePixelRatio}setPixelRatio(M){this._overridePixelRatio=M,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(M){return this.transform.setMaxBounds(ke.convert(M)),this._update()}setMinZoom(M){if((M=M??-2)>=-2&&M<=this.transform.maxZoom)return this.transform.minZoom=M,this._update(),this.getZoom()<M&&this.setZoom(M),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(M){if((M=M??22)>=this.transform.minZoom)return this.transform.maxZoom=M,this._update(),this.getZoom()>M&&this.setZoom(M),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(M){if((M=M??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(M>=0&&M<=this.transform.maxPitch)return this.transform.minPitch=M,this._update(),this.getPitch()<M&&this.setPitch(M),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(M){if((M=M??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(M>=this.transform.minPitch)return this.transform.maxPitch=M,this._update(),this.getPitch()>M&&this.setPitch(M),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(M){return this.transform.renderWorldCopies=M,this._update()}getCooperativeGestures(){return this._cooperativeGestures}setCooperativeGestures(M){return this._cooperativeGestures=M,this._cooperativeGestures?this._setupCooperativeGestures():this._destroyCooperativeGestures(),this}project(M){return this.transform.locationPoint(n.L.convert(M),this.style&&this.terrain)}unproject(M){return this.transform.pointLocation(n.P.convert(M),this.terrain)}isMoving(){var M;return this._moving||((M=this.handlers)===null||M===void 0?void 0:M.isMoving())}isZooming(){var M;return this._zooming||((M=this.handlers)===null||M===void 0?void 0:M.isZooming())}isRotating(){var M;return this._rotating||((M=this.handlers)===null||M===void 0?void 0:M.isRotating())}_createDelegatedListener(M,l,m){if(M==="mouseenter"||M==="mouseover"){let v=!1;return{layer:l,listener:m,delegates:{mousemove:C=>{let L=this.getLayer(l)?this.queryRenderedFeatures(C.point,{layers:[l]}):[];L.length?v||(v=!0,m.call(this,new wa(M,this,C.originalEvent,{features:L}))):v=!1},mouseout:()=>{v=!1}}}}if(M==="mouseleave"||M==="mouseout"){let v=!1;return{layer:l,listener:m,delegates:{mousemove:L=>{(this.getLayer(l)?this.queryRenderedFeatures(L.point,{layers:[l]}):[]).length?v=!0:v&&(v=!1,m.call(this,new wa(M,this,L.originalEvent)))},mouseout:L=>{v&&(v=!1,m.call(this,new wa(M,this,L.originalEvent)))}}}}{let v=S=>{let C=this.getLayer(l)?this.queryRenderedFeatures(S.point,{layers:[l]}):[];C.length&&(S.features=C,m.call(this,S),delete S.features)};return{layer:l,listener:m,delegates:{[M]:v}}}}on(M,l,m){if(m===void 0)return super.on(M,l);let v=this._createDelegatedListener(M,l,m);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[M]=this._delegatedListeners[M]||[],this._delegatedListeners[M].push(v);for(let S in v.delegates)this.on(S,v.delegates[S]);return this}once(M,l,m){if(m===void 0)return super.once(M,l);let v=this._createDelegatedListener(M,l,m);for(let S in v.delegates)this.once(S,v.delegates[S]);return this}off(M,l,m){return m===void 0?super.off(M,l):(this._delegatedListeners&&this._delegatedListeners[M]&&(v=>{let S=this._delegatedListeners[M];for(let C=0;C<S.length;C++){let L=S[C];if(L.layer===l&&L.listener===m){for(let V in L.delegates)this.off(V,L.delegates[V]);return S.splice(C,1),this}}})(),this)}queryRenderedFeatures(M,l){if(!this.style)return[];let m,v=M instanceof n.P||Array.isArray(M),S=v?M:[[0,0],[this.transform.width,this.transform.height]];if(l=l||(v?{}:M)||{},S instanceof n.P||typeof S[0]=="number")m=[n.P.convert(S)];else{let C=n.P.convert(S[0]),L=n.P.convert(S[1]);m=[C,new n.P(L.x,C.y),L,new n.P(C.x,L.y),C]}return this.style.queryRenderedFeatures(m,l,this.transform)}querySourceFeatures(M,l){return this.style.querySourceFeatures(M,l)}setStyle(M,l){return(l=n.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},l)).diff!==!1&&l.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&M?(this._diffStyle(M,l),this):(this._localIdeographFontFamily=l.localIdeographFontFamily,this._updateStyle(M,l))}setTransformRequest(M){return this._requestManager.setTransformRequest(M),this}_getUIString(M){let l=this._locale[M];if(l==null)throw new Error(`Missing UI string '${M}'`);return l}_updateStyle(M,l){if(l.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(M,l));let m=this.style&&l.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!M)),M?(this.style=new Ms(this,l||{}),this.style.setEventedParent(this,{style:this.style}),typeof M=="string"?this.style.loadURL(M,l,m):this.style.loadJSON(M,l,m),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Ms(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(M,l){if(typeof M=="string"){let m=this._requestManager.transformRequest(M,z.Style);n.f(m,(v,S)=>{v?this.fire(new n.j(v)):S&&this._updateDiff(S,l)})}else typeof M=="object"&&this._updateDiff(M,l)}_updateDiff(M,l){try{this.style.setState(M,l)&&this._update(!0)}catch(m){n.w(`Unable to perform style diff: ${m.message||m.error||m}.  Rebuilding the style from scratch.`),this._updateStyle(M,l)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():n.w("There is no style added to the map.")}addSource(M,l){return this._lazyInitEmptyStyle(),this.style.addSource(M,l),this._update(!0)}isSourceLoaded(M){let l=this.style&&this.style.sourceCaches[M];if(l!==void 0)return l.loaded();this.fire(new n.j(new Error(`There is no source with ID '${M}'`)))}setTerrain(M){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),M){let l=this.style.sourceCaches[M.source];if(!l)throw new Error(`cannot load terrain, because there exists no source with ID: ${M.source}`);for(let m in this.style._layers){let v=this.style._layers[m];v.type==="hillshade"&&v.source===M.source&&n.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new ad(this.painter,l,M),this.painter.renderToTexture=new Z0(this.painter,this.terrain),this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=m=>{m.dataType==="style"?this.terrain.sourceCache.freeRtt():m.dataType==="source"&&m.tile&&(m.sourceId!==M.source||this._elevationFreeze||(this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(m.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform._minEleveationForCurrentTile=0,this.transform.elevation=0;return this.fire(new n.k("terrain",{terrain:M})),this}getTerrain(){var M,l;return(l=(M=this.terrain)===null||M===void 0?void 0:M.options)!==null&&l!==void 0?l:null}areTilesLoaded(){let M=this.style&&this.style.sourceCaches;for(let l in M){let m=M[l]._tiles;for(let v in m){let S=m[v];if(S.state!=="loaded"&&S.state!=="errored")return!1}}return!0}addSourceType(M,l,m){return this._lazyInitEmptyStyle(),this.style.addSourceType(M,l,m)}removeSource(M){return this.style.removeSource(M),this._update(!0)}getSource(M){return this.style.getSource(M)}addImage(M,l,m={}){let{pixelRatio:v=1,sdf:S=!1,stretchX:C,stretchY:L,content:V}=m;if(this._lazyInitEmptyStyle(),!(l instanceof HTMLImageElement||n.a(l))){if(l.width===void 0||l.height===void 0)return this.fire(new n.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{let{width:$,height:X,data:J}=l,tt=l;return this.style.addImage(M,{data:new n.R({width:$,height:X},new Uint8Array(J)),pixelRatio:v,stretchX:C,stretchY:L,content:V,sdf:S,version:0,userImage:tt}),tt.onAdd&&tt.onAdd(this,M),this}}{let{width:$,height:X,data:J}=n.h.getImageData(l);this.style.addImage(M,{data:new n.R({width:$,height:X},J),pixelRatio:v,stretchX:C,stretchY:L,content:V,sdf:S,version:0})}}updateImage(M,l){let m=this.style.getImage(M);if(!m)return this.fire(new n.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));let v=l instanceof HTMLImageElement||n.a(l)?n.h.getImageData(l):l,{width:S,height:C,data:L}=v;if(S===void 0||C===void 0)return this.fire(new n.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(S!==m.data.width||C!==m.data.height)return this.fire(new n.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));let V=!(l instanceof HTMLImageElement||n.a(l));return m.data.replace(L,V),this.style.updateImage(M,m),this}getImage(M){return this.style.getImage(M)}hasImage(M){return M?!!this.style.getImage(M):(this.fire(new n.j(new Error("Missing required image id"))),!1)}removeImage(M){this.style.removeImage(M)}loadImage(M,l){N.getImage(this._requestManager.transformRequest(M,z.Image),l)}listImages(){return this.style.listImages()}addLayer(M,l){return this._lazyInitEmptyStyle(),this.style.addLayer(M,l),this._update(!0)}moveLayer(M,l){return this.style.moveLayer(M,l),this._update(!0)}removeLayer(M){return this.style.removeLayer(M),this._update(!0)}getLayer(M){return this.style.getLayer(M)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(M,l,m){return this.style.setLayerZoomRange(M,l,m),this._update(!0)}setFilter(M,l,m={}){return this.style.setFilter(M,l,m),this._update(!0)}getFilter(M){return this.style.getFilter(M)}setPaintProperty(M,l,m,v={}){return this.style.setPaintProperty(M,l,m,v),this._update(!0)}getPaintProperty(M,l){return this.style.getPaintProperty(M,l)}setLayoutProperty(M,l,m,v={}){return this.style.setLayoutProperty(M,l,m,v),this._update(!0)}getLayoutProperty(M,l){return this.style.getLayoutProperty(M,l)}setGlyphs(M,l={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(M,l),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(M,l,m={}){return this._lazyInitEmptyStyle(),this.style.addSprite(M,l,m,v=>{v||this._update(!0)}),this}removeSprite(M){return this._lazyInitEmptyStyle(),this.style.removeSprite(M),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(M,l={}){return this._lazyInitEmptyStyle(),this.style.setSprite(M,l,m=>{m||this._update(!0)}),this}setLight(M,l={}){return this._lazyInitEmptyStyle(),this.style.setLight(M,l),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(M,l){return this.style.setFeatureState(M,l),this._update()}removeFeatureState(M,l){return this.style.removeFeatureState(M,l),this._update()}getFeatureState(M){return this.style.getFeatureState(M)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let M=0,l=0;return this._container&&(M=this._container.clientWidth||400,l=this._container.clientHeight||300),[M,l]}_setupContainer(){let M=this._container;M.classList.add("maplibregl-map");let l=this._canvasContainer=c.create("div","maplibregl-canvas-container",M);this._interactive&&l.classList.add("maplibregl-interactive"),this._canvas=c.create("canvas","maplibregl-canvas",l),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");let m=this._containerDimensions(),v=this._getClampedPixelRatio(m[0],m[1]);this._resizeCanvas(m[0],m[1],v);let S=this._controlContainer=c.create("div","maplibregl-control-container",M),C=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(L=>{C[L]=c.create("div",`maplibregl-ctrl-${L} `,S)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_setupCooperativeGestures(){this._cooperativeGesturesScreen=c.create("div","maplibregl-cooperative-gesture-screen",this._container);let M=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";navigator.platform.indexOf("Mac")===0&&(M=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use \u2318 + scroll to zoom the map"),this._cooperativeGesturesScreen.innerHTML=`
            <div class="maplibregl-desktop-message">${M}</div>
            <div class="maplibregl-mobile-message">${typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map"}</div>
        `,this._cooperativeGesturesScreen.setAttribute("aria-hidden","true"),this._canvasContainer.addEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.add("maplibregl-cooperative-gestures")}_destroyCooperativeGestures(){c.remove(this._cooperativeGesturesScreen),this._canvasContainer.removeEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.remove("maplibregl-cooperative-gestures")}_resizeCanvas(M,l,m){this._canvas.width=Math.floor(m*M),this._canvas.height=Math.floor(m*l),this._canvas.style.width=`${M}px`,this._canvas.style.height=`${l}px`}_setupPainter(){let M={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1},l=null;this._canvas.addEventListener("webglcontextcreationerror",v=>{l={requestedAttributes:M},v&&(l.statusMessage=v.statusMessage,l.type=v.type)},{once:!0});let m=this._canvas.getContext("webgl2",M)||this._canvas.getContext("webgl",M);if(!m){let v="Failed to initialize WebGL";throw l?(l.message=v,new Error(JSON.stringify(l))):new Error(v)}this.painter=new vh(m,this.transform),f.testSupport(m)}_onCooperativeGesture(M,l,m){return!l&&m<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout(()=>{this._cooperativeGesturesScreen.classList.remove("maplibregl-show")},100)),!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(M){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||M,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(M){return this._update(),this._renderTaskQueue.add(M)}_cancelRenderFrame(M){this._renderTaskQueue.remove(M)}_render(M){let l=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(M),this._removed)return;let m=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;let S=this.transform.zoom,C=n.h.now();this.style.zoomHistory.update(S,C);let L=new n.a8(S,{now:C,fadeDuration:l,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),V=L.crossFadingFactor();V===1&&V===this._crossFadingFactor||(m=!0,this._crossFadingFactor=V),this.style.update(L)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform._minEleveationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,l,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:l,showPadding:this.showPadding}),this.fire(new n.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,n.bg.mark(n.bh.load),this.fire(new n.k("load"))),this.style&&(this.style.hasTransitions()||m)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();let v=this._sourcesDirty||this._styleDirty||this._placementDirty;return v||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new n.k("idle")),!this._loaded||this._fullyLoaded||v||(this._fullyLoaded=!0,n.bg.mark(n.bh.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){var M;this._hash&&this._hash.remove();for(let m of this._controls)m.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),N.removeThrottleControl(this._imageQueueHandle),(M=this._resizeObserver)===null||M===void 0||M.disconnect();let l=this.painter.context.gl.getExtension("WEBGL_lose_context");l&&l.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),c.remove(this._canvasContainer),c.remove(this._controlContainer),this._cooperativeGestures&&this._destroyCooperativeGestures(),this._container.classList.remove("maplibregl-map"),n.bg.clearMetrics(),this._removed=!0,this.fire(new n.k("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=n.h.frame(M=>{n.bg.frame(M),this._frame=null,this._render(M)}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(M){this._showTileBoundaries!==M&&(this._showTileBoundaries=M,this._update())}get showPadding(){return!!this._showPadding}set showPadding(M){this._showPadding!==M&&(this._showPadding=M,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(M){this._showCollisionBoxes!==M&&(this._showCollisionBoxes=M,M?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(M){this._showOverdrawInspector!==M&&(this._showOverdrawInspector=M,this._update())}get repaint(){return!!this._repaint}set repaint(M){this._repaint!==M&&(this._repaint=M,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(M){this._vertices=M,this._update()}get version(){return cr}getCameraTargetElevation(){return this.transform.elevation}},ii.NavigationControl=class{constructor(M){this._updateZoomButtons=()=>{let l=this._map.getZoom(),m=l===this._map.getMaxZoom(),v=l===this._map.getMinZoom();this._zoomInButton.disabled=m,this._zoomOutButton.disabled=v,this._zoomInButton.setAttribute("aria-disabled",m.toString()),this._zoomOutButton.setAttribute("aria-disabled",v.toString())},this._rotateCompassArrow=()=>{let l=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=l},this._setButtonTitle=(l,m)=>{let v=this._map._getUIString(`NavigationControl.${m}`);l.title=v,l.setAttribute("aria-label",v)},this.options=n.e({},G0,M),this._container=c.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",l=>l.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",l=>this._map.zoomIn({},{originalEvent:l})),c.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",l=>this._map.zoomOut({},{originalEvent:l})),c.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",l=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:l}):this._map.resetNorth({},{originalEvent:l})}),this._compassIcon=c.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(M){return this._map=M,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new yu(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){c.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(M,l){let m=c.create("button",M,this._container);return m.type="button",m.addEventListener("click",l),m}},ii.GeolocateControl=class extends n.E{constructor(M){super(),this._onSuccess=l=>{if(this._map){if(this._isOutOfMapMaxBounds(l))return this._setErrorState(),this.fire(new n.k("outofmaxbounds",l)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=l,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(l),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(l),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new n.k("geolocate",l)),this._finish()}},this._updateCamera=l=>{let m=new n.L(l.coords.longitude,l.coords.latitude),v=l.coords.accuracy,S=this._map.getBearing(),C=n.e({bearing:S},this.options.fitBoundsOptions),L=ke.fromLngLat(m,v);this._map.fitBounds(L,C,{geolocateSource:!0})},this._updateMarker=l=>{if(l){let m=new n.L(l.coords.longitude,l.coords.latitude);this._accuracyCircleMarker.setLngLat(m).addTo(this._map),this._userLocationDotMarker.setLngLat(m).addTo(this._map),this._accuracy=l.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=l=>{if(this._map){if(this.options.trackUserLocation)if(l.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;let m=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=m,this._geolocateButton.setAttribute("aria-label",m),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(l.code===3&&Vc)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new n.k("error",l)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=l=>{if(this._map){if(this._container.addEventListener("contextmenu",m=>m.preventDefault()),this._geolocateButton=c.create("button","maplibregl-ctrl-geolocate",this._container),c.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",l===!1){n.w("Geolocation support is not available so the GeolocateControl will be disabled.");let m=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=m,this._geolocateButton.setAttribute("aria-label",m)}else{let m=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=m,this._geolocateButton.setAttribute("aria-label",m)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=c.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new xu({element:this._dotElement}),this._circleElement=c.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new xu({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",m=>{m.geolocateSource||this._watchState!=="ACTIVE_LOCK"||m.originalEvent&&m.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new n.k("trackuserlocationend")))})}},this.options=n.e({},Gn,M)}onAdd(M){return this._map=M,this._container=c.create("div","maplibregl-ctrl maplibregl-ctrl-group"),function(l,m=!1){Ps===void 0||m?window.navigator.permissions!==void 0?window.navigator.permissions.query({name:"geolocation"}).then(v=>{Ps=v.state!=="denied",l(Ps)}).catch(()=>{Ps=!!window.navigator.geolocation,l(Ps)}):(Ps=!!window.navigator.geolocation,l(Ps)):l(Ps)}(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),c.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,qn=0,Vc=!1}_isOutOfMapMaxBounds(M){let l=this._map.getMaxBounds(),m=M.coords;return l&&(m.longitude<l.getWest()||m.longitude>l.getEast()||m.latitude<l.getSouth()||m.latitude>l.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){let M=this._map.getBounds(),l=M.getSouthEast(),m=M.getNorthEast(),v=l.distanceTo(m),S=Math.ceil(this._accuracy/(v/this._map._container.clientHeight)*2);this._circleElement.style.width=`${S}px`,this._circleElement.style.height=`${S}px`}trigger(){if(!this._setup)return n.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new n.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":qn--,Vc=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new n.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new n.k("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let M;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),qn++,qn>1?(M={maximumAge:6e5,timeout:0},Vc=!0):(M=this.options.positionOptions,Vc=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,M)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},ii.AttributionControl=Sa,ii.LogoControl=Wn,ii.ScaleControl=class{constructor(M){this._onMove=()=>{cd(this._map,this._container,this.options)},this.setUnit=l=>{this.options.unit=l,cd(this._map,this._container,this.options)},this.options=n.e({},wn,M)}getDefaultPosition(){return"bottom-left"}onAdd(M){return this._map=M,this._container=c.create("div","maplibregl-ctrl maplibregl-ctrl-scale",M.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){c.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},ii.FullscreenControl=class extends n.E{constructor(M={}){super(),this._onFullscreenChange=()=>{(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,M&&M.container&&(M.container instanceof HTMLElement?this._container=M.container:n.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(M){return this._map=M,this._container||(this._container=this._map.getContainer()),this._controlContainer=c.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){c.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){let M=this._fullscreenButton=c.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);c.create("span","maplibregl-ctrl-icon",M).setAttribute("aria-hidden","true"),M.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){let M=this._getTitle();this._fullscreenButton.setAttribute("aria-label",M),this._fullscreenButton.title=M}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new n.k("fullscreenstart")),this._map._cooperativeGestures&&(this._prevCooperativeGestures=this._map._cooperativeGestures,this._map.setCooperativeGestures())):(this.fire(new n.k("fullscreenend")),this._prevCooperativeGestures&&(this._map.setCooperativeGestures(this._prevCooperativeGestures),delete this._prevCooperativeGestures))}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},ii.TerrainControl=class{constructor(M){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))},this.options=M}onAdd(M){return this._map=M,this._container=c.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=c.create("button","maplibregl-ctrl-terrain",this._container),c.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){c.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},ii.Popup=class extends n.E{constructor(M){super(),this.remove=()=>(this._content&&c.remove(this._content),this._container&&(c.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new n.k("close")),this),this._onMouseUp=l=>{this._update(l.point)},this._onMouseMove=l=>{this._update(l.point)},this._onDrag=l=>{this._update(l.point)},this._update=l=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=c.create("div","maplibregl-popup",this._map.getContainer()),this._tip=c.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(let L of this.options.className.split(" "))this._container.classList.add(L);this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=ld(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!l)return;let m=this._pos=this._trackPointer&&l?l:this._map.project(this._lngLat),v=this.options.anchor,S=Mf(this.options.offset);if(!v){let L=this._container.offsetWidth,V=this._container.offsetHeight,$;$=m.y+S.bottom.y<V?["top"]:m.y>this._map.transform.height-V?["bottom"]:[],m.x<L/2?$.push("left"):m.x>this._map.transform.width-L/2&&$.push("right"),v=$.length===0?"bottom":$.join("-")}let C=m.add(S[v]).round();c.setTransform(this._container,`${Ea[v]} translate(${C.x}px,${C.y}px)`),X_(this._container,v,"popup")},this._onClose=()=>{this.remove()},this.options=n.e(Object.create(tg),M)}addTo(M){return this._map&&this.remove(),this._map=M,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new n.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(M){return this._lngLat=n.L.convert(M),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(M){return this.setDOMContent(document.createTextNode(M))}setHTML(M){let l=document.createDocumentFragment(),m=document.createElement("body"),v;for(m.innerHTML=M;v=m.firstChild,v;)l.appendChild(v);return this.setDOMContent(l)}getMaxWidth(){var M;return(M=this._container)===null||M===void 0?void 0:M.style.maxWidth}setMaxWidth(M){return this.options.maxWidth=M,this._update(),this}setDOMContent(M){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=c.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(M),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(M){this._container&&this._container.classList.add(M)}removeClassName(M){this._container&&this._container.classList.remove(M)}setOffset(M){return this.options.offset=M,this._update(),this}toggleClassName(M){if(this._container)return this._container.classList.toggle(M)}_createCloseButton(){this.options.closeButton&&(this._closeButton=c.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;let M=this._container.querySelector(eg);M&&M.focus()}},ii.Marker=xu,ii.Style=Ms,ii.LngLat=n.L,ii.LngLatBounds=ke,ii.Point=n.P,ii.MercatorCoordinate=n.U,ii.Evented=n.E,ii.AJAXError=n.bi,ii.config=n.c,ii.CanvasSource=Tr,ii.GeoJSONSource=Gr,ii.ImageSource=Dr,ii.RasterDEMTileSource=ci,ii.RasterTileSource=_i,ii.VectorTileSource=Ti,ii.VideoSource=Le,ii.setRTLTextPlugin=n.bj,ii.getRTLTextPluginStatus=n.bk,ii.prewarm=function(){Uo().acquire($i)},ii.clearPrewarmedResources=function(){let M=bl;M&&(M.isPreloaded()&&M.numActive()===1?(M.release($i),bl=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},rg.extend(ii,{isSafari:n.ac,getPerformanceMetrics:n.bg.getPerformanceMetrics}),ii});var s=r;return s})});function aA(e,t){if(!e)throw new Error(t||"loader assertion failed.")}var Nf={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document},Uct=Nf.self||Nf.window||Nf.global||{},Vct=Nf.window||Nf.self||Nf.global||{},jct=Nf.global||Nf.self||Nf.window||{},$ct=Nf.document||{};var ug=!!(typeof process!="object"||String(process)!=="[object process]"||process.browser);var Tz=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version),Hct=Tz&&parseFloat(Tz[1])||0;var GT=globalThis,Wct=globalThis.document||{},QT=globalThis.process||{},qct=globalThis.console,Sz=globalThis.navigator||{};function KT(e){if(typeof window<"u"&&window.process?.type==="renderer"||typeof process<"u"&&process.versions?.electron)return!0;let t=typeof navigator<"u"&&navigator.userAgent,r=e||t;return!!(r&&r.indexOf("Electron")>=0)}function ol(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process?.browser)||KT()}function gP(e){return!e&&!ol()?"Node":KT(e)?"Electron":(e||Sz.userAgent||"").indexOf("Edge")>-1?"Edge":globalThis.chrome?"Chrome":globalThis.safari?"Safari":globalThis.mozInnerScreenX?"Firefox":"Unknown"}var _P="4.0.7";function Xct(e){try{let t=window[e],r="__storage_test__";return t.setItem(r,r),t.removeItem(r),t}catch{return null}}var JT=class{constructor(t,r,i="sessionStorage"){this.storage=Xct(i),this.id=t,this.config=r,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(t){if(Object.assign(this.config,t),this.storage){let r=JSON.stringify(this.config);this.storage.setItem(this.id,r)}}_loadConfiguration(){let t={};if(this.storage){let r=this.storage.getItem(this.id);t=r?JSON.parse(r):{}}return Object.assign(this.config,t),this}};function Ez(e){let t;return e<10?t=`${e.toFixed(2)}ms`:e<100?t=`${e.toFixed(1)}ms`:e<1e3?t=`${e.toFixed(0)}ms`:t=`${(e/1e3).toFixed(2)}s`,t}function Iz(e,t=8){let r=Math.max(t-e.length,0);return`${" ".repeat(r)}${e}`}var t5;(function(e){e[e.BLACK=30]="BLACK",e[e.RED=31]="RED",e[e.GREEN=32]="GREEN",e[e.YELLOW=33]="YELLOW",e[e.BLUE=34]="BLUE",e[e.MAGENTA=35]="MAGENTA",e[e.CYAN=36]="CYAN",e[e.WHITE=37]="WHITE",e[e.BRIGHT_BLACK=90]="BRIGHT_BLACK",e[e.BRIGHT_RED=91]="BRIGHT_RED",e[e.BRIGHT_GREEN=92]="BRIGHT_GREEN",e[e.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",e[e.BRIGHT_BLUE=94]="BRIGHT_BLUE",e[e.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",e[e.BRIGHT_CYAN=96]="BRIGHT_CYAN",e[e.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(t5||(t5={}));var Zct=10;function Mz(e){return typeof e!="string"?e:(e=e.toUpperCase(),t5[e]||t5.WHITE)}function Cz(e,t,r){return!ol&&typeof e=="string"&&(t&&(e=`\x1B[${Mz(t)}m${e}\x1B[39m`),r&&(e=`\x1B[${Mz(r)+Zct}m${e}\x1B[49m`)),e}function Pz(e,t=["constructor"]){let r=Object.getPrototypeOf(e),i=Object.getOwnPropertyNames(r),s=e;for(let n of i){let o=s[n];typeof o=="function"&&(t.find(c=>n===c)||(s[n]=o.bind(e)))}}function Pb(e,t){if(!e)throw new Error(t||"Assertion failed")}function hg(){let e;if(ol()&&GT.performance)e=GT?.performance?.now?.();else if("hrtime"in QT){let t=QT?.hrtime?.();e=t[0]*1e3+t[1]/1e6}else e=Date.now();return e}var ay={debug:ol()&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},Gct={enabled:!0,level:0};function ly(){}var Rz={},kz={once:!0},ac=class{constructor({id:t}={id:""}){this.VERSION=_P,this._startTs=hg(),this._deltaTs=hg(),this.userData={},this.LOG_THROTTLE_TIMEOUT=0,this.id=t,this.userData={},this._storage=new JT(`__probe-${this.id}__`,Gct),this.timeStamp(`${this.id} started`),Pz(this),Object.seal(this)}set level(t){this.setLevel(t)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((hg()-this._startTs).toPrecision(10))}getDelta(){return Number((hg()-this._deltaTs).toPrecision(10))}set priority(t){this.level=t}get priority(){return this.level}getPriority(){return this.level}enable(t=!0){return this._storage.setConfiguration({enabled:t}),this}setLevel(t){return this._storage.setConfiguration({level:t}),this}get(t){return this._storage.config[t]}set(t,r){this._storage.setConfiguration({[t]:r})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(t,r){if(!t)throw new Error(r||"Assertion failed")}warn(t){return this._getLogFunction(0,t,ay.warn,arguments,kz)}error(t){return this._getLogFunction(0,t,ay.error,arguments)}deprecated(t,r){return this.warn(`\`${t}\` is deprecated and will be removed in a later version. Use \`${r}\` instead`)}removed(t,r){return this.error(`\`${t}\` has been removed. Use \`${r}\` instead`)}probe(t,r){return this._getLogFunction(t,r,ay.log,arguments,{time:!0,once:!0})}log(t,r){return this._getLogFunction(t,r,ay.debug,arguments)}info(t,r){return this._getLogFunction(t,r,console.info,arguments)}once(t,r){return this._getLogFunction(t,r,ay.debug||ay.info,arguments,kz)}table(t,r,i){return r?this._getLogFunction(t,r,console.table||ly,i&&[i],{tag:Kct(r)}):ly}time(t,r){return this._getLogFunction(t,r,console.time?console.time:console.info)}timeEnd(t,r){return this._getLogFunction(t,r,console.timeEnd?console.timeEnd:console.info)}timeStamp(t,r){return this._getLogFunction(t,r,console.timeStamp||ly)}group(t,r,i={collapsed:!1}){let s=Dz({logLevel:t,message:r,opts:i}),{collapsed:n}=i;return s.method=(n?console.groupCollapsed:console.group)||console.info,this._getLogFunction(s)}groupCollapsed(t,r,i={}){return this.group(t,r,Object.assign({},i,{collapsed:!0}))}groupEnd(t){return this._getLogFunction(t,"",console.groupEnd||ly)}withGroup(t,r,i){this.group(t,r)();try{i()}finally{this.groupEnd(t)()}}trace(){console.trace&&console.trace()}_shouldLog(t){return this.isEnabled()&&this.getLevel()>=Bz(t)}_getLogFunction(t,r,i,s,n){if(this._shouldLog(t)){n=Dz({logLevel:t,message:r,args:s,opts:n}),i=i||n.method,Pb(i),n.total=this.getTotal(),n.delta=this.getDelta(),this._deltaTs=hg();let o=n.tag||n.message;if(n.once&&o)if(!Rz[o])Rz[o]=hg();else return ly;return r=Qct(this.id,n.message,n),i.bind(console,r,...n.args)}return ly}};ac.VERSION=_P;function Bz(e){if(!e)return 0;let t;switch(typeof e){case"number":t=e;break;case"object":t=e.logLevel||e.priority||0;break;default:return 0}return Pb(Number.isFinite(t)&&t>=0),t}function Dz(e){let{logLevel:t,message:r}=e;e.logLevel=Bz(t);let i=e.args?Array.from(e.args):[];for(;i.length&&i.shift()!==r;);switch(typeof t){case"string":case"function":r!==void 0&&i.unshift(r),e.message=t;break;case"object":Object.assign(e,t);break;default:}typeof e.message=="function"&&(e.message=e.message());let s=typeof e.message;return Pb(s==="string"||s==="object"),Object.assign(e,{args:i},e.opts)}function Qct(e,t,r){if(typeof t=="string"){let i=r.time?Iz(Ez(r.total)):"";t=r.time?`${e}: ${i}  ${t}`:`${e}: ${t}`,t=Cz(t,r.color,r.background)}return t}function Kct(e){for(let t in e)for(let r in e[t])return r||"untitled";return"empty"}globalThis.probe={};var iIt=new ac({id:"@probe.gl/log"});function yP(e,t){return Oz(e||{},t)}function Oz(e,t,r=0){if(r>3)return t;let i={...e};for(let[s,n]of Object.entries(t))n&&typeof n=="object"&&!Array.isArray(n)?i[s]=Oz(i[s]||{},t[s],r+1):i[s]=t[s];return i}var Nz="latest";function Jct(){return globalThis._loadersgl_?.version||(globalThis._loadersgl_=globalThis._loadersgl_||{},globalThis._loadersgl_.version="4.2.0"),globalThis._loadersgl_.version}var xP=Jct();function kl(e,t){if(!e)throw new Error(t||"loaders.gl assertion failed.")}var Ff={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document},uIt=Ff.self||Ff.window||Ff.global||{},hIt=Ff.window||Ff.self||Ff.global||{},fIt=Ff.global||Ff.self||Ff.window||{},pIt=Ff.document||{};var Eu=typeof process!="object"||String(process)!=="[object process]"||process.browser;var Lz=typeof window<"u"&&typeof window.orientation<"u",Fz=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version),dIt=Fz&&parseFloat(Fz[1])||0;var Rb=class{name;workerThread;isRunning=!0;result;_resolve=()=>{};_reject=()=>{};constructor(t,r){this.name=t,this.workerThread=r,this.result=new Promise((i,s)=>{this._resolve=i,this._reject=s})}postMessage(t,r){this.workerThread.postMessage({source:"loaders.gl",type:t,payload:r})}done(t){kl(this.isRunning),this.isRunning=!1,this._resolve(t)}error(t){kl(this.isRunning),this.isRunning=!1,this._reject(t)}};var cy=class{terminate(){}};var bP=new Map;function zz(e){kl(e.source&&!e.url||!e.source&&e.url);let t=bP.get(e.source||e.url);return t||(e.url&&(t=tut(e.url),bP.set(e.url,t)),e.source&&(t=Uz(e.source),bP.set(e.source,t))),kl(t),t}function tut(e){if(!e.startsWith("http"))return e;let t=eut(e);return Uz(t)}function Uz(e){let t=new Blob([e],{type:"application/javascript"});return URL.createObjectURL(t)}function eut(e){return`try {
  importScripts('${e}');
} catch (error) {
  console.error(error);
  throw error;
}`}function vP(e,t=!0,r){let i=r||new Set;if(e){if(Vz(e))i.add(e);else if(Vz(e.buffer))i.add(e.buffer);else if(!ArrayBuffer.isView(e)){if(t&&typeof e=="object")for(let s in e)vP(e[s],t,i)}}return r===void 0?Array.from(i):[]}function Vz(e){return e?e instanceof ArrayBuffer||typeof MessagePort<"u"&&e instanceof MessagePort||typeof ImageBitmap<"u"&&e instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas:!1}var wP=()=>{},lA=class{name;source;url;terminated=!1;worker;onMessage;onError;_loadableURL="";static isSupported(){return typeof Worker<"u"&&Eu||typeof cy<"u"&&!Eu}constructor(t){let{name:r,source:i,url:s}=t;kl(i||s),this.name=r,this.source=i,this.url=s,this.onMessage=wP,this.onError=n=>console.log(n),this.worker=Eu?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=wP,this.onError=wP,this.worker.terminate(),this.terminated=!0}get isRunning(){return!!this.onMessage}postMessage(t,r){r=r||vP(t),this.worker.postMessage(t,r)}_getErrorFromErrorEvent(t){let r="Failed to load ";return r+=`worker ${this.name} from ${this.url}. `,t.message&&(r+=`${t.message} in `),t.lineno&&(r+=`:${t.lineno}:${t.colno}`),new Error(r)}_createBrowserWorker(){this._loadableURL=zz({source:this.source,url:this.url});let t=new Worker(this._loadableURL,{name:this.name});return t.onmessage=r=>{r.data?this.onMessage(r.data):this.onError(new Error("No data received"))},t.onerror=r=>{this.onError(this._getErrorFromErrorEvent(r)),this.terminated=!0},t.onmessageerror=r=>console.error(r),t}_createNodeWorker(){let t;if(this.url){let i=this.url.includes(":/")||this.url.startsWith("/")?this.url:`./${this.url}`;t=new cy(i,{eval:!1})}else if(this.source)t=new cy(this.source,{eval:!0});else throw new Error("no worker");return t.on("message",r=>{this.onMessage(r)}),t.on("error",r=>{this.onError(r)}),t.on("exit",r=>{}),t}};var kb=class{name="unnamed";source;url;maxConcurrency=1;maxMobileConcurrency=1;onDebug=()=>{};reuseWorkers=!0;props={};jobQueue=[];idleQueue=[];count=0;isDestroyed=!1;static isSupported(){return lA.isSupported()}constructor(t){this.source=t.source,this.url=t.url,this.setProps(t)}destroy(){this.idleQueue.forEach(t=>t.destroy()),this.isDestroyed=!0}setProps(t){this.props={...this.props,...t},t.name!==void 0&&(this.name=t.name),t.maxConcurrency!==void 0&&(this.maxConcurrency=t.maxConcurrency),t.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=t.maxMobileConcurrency),t.reuseWorkers!==void 0&&(this.reuseWorkers=t.reuseWorkers),t.onDebug!==void 0&&(this.onDebug=t.onDebug)}async startJob(t,r=(s,n,o)=>s.done(o),i=(s,n)=>s.error(n)){let s=new Promise(n=>(this.jobQueue.push({name:t,onMessage:r,onError:i,onStart:n}),this));return this._startQueuedJob(),await s}async _startQueuedJob(){if(!this.jobQueue.length)return;let t=this._getAvailableWorker();if(!t)return;let r=this.jobQueue.shift();if(r){this.onDebug({message:"Starting job",name:r.name,workerThread:t,backlog:this.jobQueue.length});let i=new Rb(r.name,t);t.onMessage=s=>r.onMessage(i,s.type,s.payload),t.onError=s=>r.onError(i,s),r.onStart(i);try{await i.result}catch(s){console.error(`Worker exception: ${s}`)}finally{this.returnWorkerToQueue(t)}}}returnWorkerToQueue(t){!Eu||this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(t.destroy(),this.count--):this.idleQueue.push(t),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;let t=`${this.name.toLowerCase()} (#${this.count} of ${this.maxConcurrency})`;return new lA({name:t,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return Lz?this.maxMobileConcurrency:this.maxConcurrency}};var rut={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}},fg=class e{props;workerPools=new Map;static _workerFarm;static isSupported(){return lA.isSupported()}static getWorkerFarm(t={}){return e._workerFarm=e._workerFarm||new e({}),e._workerFarm.setProps(t),e._workerFarm}constructor(t){this.props={...rut},this.setProps(t),this.workerPools=new Map}destroy(){for(let t of this.workerPools.values())t.destroy();this.workerPools=new Map}setProps(t){this.props={...this.props,...t};for(let r of this.workerPools.values())r.setProps(this._getWorkerPoolProps())}getWorkerPool(t){let{name:r,source:i,url:s}=t,n=this.workerPools.get(r);return n||(n=new kb({name:r,source:i,url:s}),n.setProps(this._getWorkerPoolProps()),this.workerPools.set(r,n)),n}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}};function TP(e,t={}){let r=t[e.id]||{},i=Eu?`${e.id}-worker.js`:`${e.id}-worker-node.js`,s=r.workerUrl;if(!s&&e.id==="compression"&&(s=t.workerUrl),t._workerType==="test"&&(Eu?s=`modules/${e.module}/dist/${i}`:s=`modules/${e.module}/src/workers/${e.id}-worker-node.ts`),!s){let n=e.version;n==="latest"&&(n=Nz);let o=n?`@${n}`:"";s=`https://unpkg.com/@loaders.gl/${e.module}${o}/dist/${i}`}return kl(s),s}function SP(e,t=xP){kl(e,"no worker provided");let r=e.version;return!(!t||!r)}function EP(e,t){return!fg.isSupported()||!Eu&&!t?._nodeWorkers?!1:e.worker&&t?.worker}async function IP(e,t,r,i,s){let n=e.id,o=TP(e,r),f=fg.getWorkerFarm(r).getWorkerPool({name:n,url:o});r=JSON.parse(JSON.stringify(r)),i=JSON.parse(JSON.stringify(i||{}));let p=await f.startJob("process-on-worker",iut.bind(null,s));return p.postMessage("process",{input:t,options:r,context:i}),await(await p.result).result}async function iut(e,t,r,i){switch(r){case"done":t.done(i);break;case"error":t.error(new Error(i.error));break;case"process":let{id:s,input:n,options:o}=i;try{let c=await e(n,o);t.postMessage("done",{id:s,result:c})}catch(c){let f=c instanceof Error?c.message:"unknown error";t.postMessage("error",{id:s,error:f})}break;default:console.warn(`parse-with-worker unknown message ${r}`)}}function MP(e,t,r){if(r=r||e.byteLength,e.byteLength<r||t.byteLength<r)return!1;let i=new Uint8Array(e),s=new Uint8Array(t);for(let n=0;n<i.length;++n)if(i[n]!==s[n])return!1;return!0}function CP(...e){return jz(e)}function jz(e){let t=e.map(n=>n instanceof ArrayBuffer?new Uint8Array(n):n),r=t.reduce((n,o)=>n+o.byteLength,0),i=new Uint8Array(r),s=0;for(let n of t)i.set(n,s),s+=n.byteLength;return i.buffer}async function PP(e){let t=[];for await(let r of e)t.push(r);return CP(...t)}function Db(){let e;if(typeof window<"u"&&window.performance)e=window.performance.now();else if(typeof process<"u"&&process.hrtime){let t=process.hrtime();e=t[0]*1e3+t[1]/1e6}else e=Date.now();return e}var pg=class{constructor(t,r){this.sampleSize=1,this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this.name=t,this.type=r,this.reset()}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}setSampleSize(t){return this.sampleSize=t,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(t){return this._count+=t,this._samples++,this._checkSampling(),this}subtractCount(t){return this._count-=t,this._samples++,this._checkSampling(),this}addTime(t){return this._time+=t,this.lastTiming=t,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=Db(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(Db()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}};var Iu=class{constructor(t){this.stats={},this.id=t.id,this.stats={},this._initializeStats(t.stats),Object.seal(this)}get(t,r="count"){return this._getOrCreate({name:t,type:r})}get size(){return Object.keys(this.stats).length}reset(){for(let t of Object.values(this.stats))t.reset();return this}forEach(t){for(let r of Object.values(this.stats))t(r)}getTable(){let t={};return this.forEach(r=>{t[r.name]={time:r.time||0,count:r.count||0,average:r.getAverageTime()||0,hz:r.getHz()||0}}),t}_initializeStats(t=[]){t.forEach(r=>this._getOrCreate(r))}_getOrCreate(t){let{name:r,type:i}=t,s=this.stats[r];return s||(t instanceof pg?s=t:s=new pg(r,i),this.stats[r]=s),s}};var nut="",$z={};function RP(e){for(let t in $z)if(e.startsWith(t)){let r=$z[t];e=e.replace(t,r)}return!e.startsWith("http://")&&!e.startsWith("https://")&&(e=`${nut}${e}`),e}function Hz(e){return e&&typeof e=="object"&&e.isBuffer}function e5(e){if(Hz(e))return e;if(e instanceof ArrayBuffer)return e;if(ArrayBuffer.isView(e))return e.byteOffset===0&&e.byteLength===e.buffer.byteLength?e.buffer:e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength);if(typeof e=="string"){let t=e;return new TextEncoder().encode(t).buffer}if(e&&typeof e=="object"&&e._toArrayBuffer)return e._toArrayBuffer();throw new Error("toArrayBuffer")}var dg={};sl(dg,{dirname:()=>out,filename:()=>sut,join:()=>aut,resolve:()=>lut});function Wz(){if(typeof process<"u"&&typeof process.cwd<"u")return process.cwd();let e=window.location?.pathname;return e?.slice(0,e.lastIndexOf("/")+1)||""}function sut(e){let t=e?e.lastIndexOf("/"):-1;return t>=0?e.substr(t+1):""}function out(e){let t=e?e.lastIndexOf("/"):-1;return t>=0?e.substr(0,t):""}function aut(...e){let t="/";return e=e.map((r,i)=>(i&&(r=r.replace(new RegExp(`^${t}`),"")),i!==e.length-1&&(r=r.replace(new RegExp(`${t}$`),"")),r)),e.join(t)}function lut(...e){let t=[];for(let n=0;n<e.length;n++)t[n]=e[n];let r="",i=!1,s;for(let n=t.length-1;n>=-1&&!i;n--){let o;n>=0?o=t[n]:(s===void 0&&(s=Wz()),o=s),o.length!==0&&(r=`${o}/${r}`,i=o.charCodeAt(0)===Bb)}return r=cut(r,!i),i?`/${r}`:r.length>0?r:"."}var Bb=47,kP=46;function cut(e,t){let r="",i=-1,s=0,n,o=!1;for(let c=0;c<=e.length;++c){if(c<e.length)n=e.charCodeAt(c);else{if(n===Bb)break;n=Bb}if(n===Bb){if(!(i===c-1||s===1))if(i!==c-1&&s===2){if(r.length<2||!o||r.charCodeAt(r.length-1)!==kP||r.charCodeAt(r.length-2)!==kP){if(r.length>2){let f=r.length-1,p=f;for(;p>=0&&r.charCodeAt(p)!==Bb;--p);if(p!==f){r=p===-1?"":r.slice(0,p),i=c,s=0,o=!1;continue}}else if(r.length===2||r.length===1){r="",i=c,s=0,o=!1;continue}}t&&(r.length>0?r+="/..":r="..",o=!0)}else{let f=e.slice(i+1,c);r.length>0?r+=`/${f}`:r=f,o=!1}i=c,s=0}else n===kP&&s!==-1?++s:s=-1}return r}var uut=e=>typeof e=="boolean",Ob=e=>typeof e=="function",Ag=e=>e!==null&&typeof e=="object",DP=e=>Ag(e)&&e.constructor==={}.constructor;var qz=e=>!!e&&typeof e[Symbol.iterator]=="function",Yz=e=>e&&typeof e[Symbol.asyncIterator]=="function";var Mu=e=>typeof Response<"u"&&e instanceof Response||e&&e.arrayBuffer&&e.text&&e.json;var Cu=e=>typeof Blob<"u"&&e instanceof Blob,Xz=e=>e&&typeof e=="object"&&e.isBuffer;var hut=e=>typeof ReadableStream<"u"&&e instanceof ReadableStream||Ag(e)&&Ob(e.tee)&&Ob(e.cancel)&&Ob(e.getReader);var fut=e=>Ag(e)&&Ob(e.read)&&Ob(e.pipe)&&uut(e.readable),r5=e=>hut(e)||fut(e);var i5=class extends Error{constructor(t,r){super(t),this.reason=r.reason,this.url=r.url,this.response=r.response}reason;url;response};var put=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,dut=/^([-\w.]+\/[-\w.+]+)/;function BP(e,t){return e.toLowerCase()===t.toLowerCase()}function Zz(e){let t=dut.exec(e);return t?t[1]:e}function OP(e){let t=put.exec(e);return t?t[1]:""}var Gz=/\?.*/;function Qz(e){let t=e.match(Gz);return t&&t[0]}function uy(e){return e.replace(Gz,"")}function Kz(e){if(e.length<50)return e;let t=e.slice(e.length-15);return`${e.substr(0,32)}...${t}`}function mg(e){return Mu(e)?e.url:Cu(e)?e.name||"":typeof e=="string"?e:""}function Nb(e){if(Mu(e)){let t=e,r=t.headers.get("content-type")||"",i=uy(t.url);return Zz(r)||OP(i)}return Cu(e)?e.type||"":typeof e=="string"?OP(e):""}function Jz(e){return Mu(e)?e.headers["content-length"]||-1:Cu(e)?e.size:typeof e=="string"?e.length:e instanceof ArrayBuffer||ArrayBuffer.isView(e)?e.byteLength:-1}async function n5(e){if(Mu(e))return e;let t={},r=Jz(e);r>=0&&(t["content-length"]=String(r));let i=mg(e),s=Nb(e);s&&(t["content-type"]=s);let n=await mut(e);n&&(t["x-first-bytes"]=n),typeof e=="string"&&(e=new TextEncoder().encode(e));let o=new Response(e,{headers:t});return Object.defineProperty(o,"url",{value:i}),o}async function tU(e){if(!e.ok)throw await Aut(e)}async function Aut(e){let t=Kz(e.url),r=`Failed to fetch resource (${e.status}) ${e.statusText}: ${t}`;r=r.length>100?`${r.slice(0,100)}...`:r;let i={reason:e.statusText,url:e.url,response:e};try{let s=e.headers.get("Content-Type");i.reason=s?.includes("application/json")?await e.json():e.text()}catch{}return new i5(r,i)}async function mut(e){if(typeof e=="string")return`data:,${e.slice(0,5)}`;if(e instanceof Blob){let r=e.slice(0,5);return await new Promise(i=>{let s=new FileReader;s.onload=n=>i(n?.target?.result),s.readAsDataURL(r)})}if(e instanceof ArrayBuffer){let r=e.slice(0,5);return`data:base64,${gut(r)}`}return null}function gut(e){let t="",r=new Uint8Array(e);for(let i=0;i<r.byteLength;i++)t+=String.fromCharCode(r[i]);return btoa(t)}function _ut(e){return!yut(e)&&!xut(e)}function yut(e){return e.startsWith("http:")||e.startsWith("https:")}function xut(e){return e.startsWith("data:")}async function NP(e,t){if(typeof e=="string"){let r=RP(e);return _ut(r)&&globalThis.loaders?.fetchNode?globalThis.loaders?.fetchNode(r,t):await fetch(r,t)}return await n5(e)}var FP=new ac({id:"loaders.gl"}),s5=class{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}},o5=class{console;constructor(){this.console=console}log(...t){return this.console.log.bind(this.console,...t)}info(...t){return this.console.info.bind(this.console,...t)}warn(...t){return this.console.warn.bind(this.console,...t)}error(...t){return this.console.error.bind(this.console,...t)}};var LP={fetch:null,mimeType:void 0,nothrow:!1,log:new o5,useLocalLibraries:!1,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:ug,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},eU={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function zP(){globalThis.loaders=globalThis.loaders||{};let{loaders:e}=globalThis;return e._state||(e._state={}),e._state}function UP(){let e=zP();return e.globalOptions=e.globalOptions||{...LP},e.globalOptions}function nU(e,t,r,i){return r=r||[],r=Array.isArray(r)?r:[r],but(e,r),wut(t,e,i)}function but(e,t){rU(e,null,LP,eU,t);for(let r of t){let i=e&&e[r.id]||{},s=r.options&&r.options[r.id]||{},n=r.deprecatedOptions&&r.deprecatedOptions[r.id]||{};rU(i,r.id,s,n,t)}}function rU(e,t,r,i,s){let n=t||"Top level",o=t?`${t}.`:"";for(let c in e){let f=!t&&Ag(e[c]),p=c==="baseUri"&&!t,x=c==="workerUrl"&&t;if(!(c in r)&&!p&&!x){if(c in i)FP.warn(`${n} loader option '${o}${c}' no longer supported, use '${i[c]}'`)();else if(!f){let E=vut(c,s);FP.warn(`${n} loader option '${o}${c}' not recognized. ${E}`)()}}}}function vut(e,t){let r=e.toLowerCase(),i="";for(let s of t)for(let n in s.options){if(e===n)return`Did you mean '${s.id}.${n}'?`;let o=n.toLowerCase();(r.startsWith(o)||o.startsWith(r))&&(i=i||`Did you mean '${s.id}.${n}'?`)}return i}function wut(e,t,r){let s={...e.options||{}};return Tut(s,r),s.log===null&&(s.log=new s5),iU(s,UP()),iU(s,t),s}function iU(e,t){for(let r in t)if(r in t){let i=t[r];DP(i)&&DP(e[r])?e[r]={...e[r],...t[r]}:e[r]=t[r]}}function Tut(e,t){t&&!("baseUri"in e)&&(e.baseUri=t)}function Fb(e){return e?(Array.isArray(e)&&(e=e[0]),Array.isArray(e?.extensions)):!1}function Lb(e){aA(e,"null loader"),aA(Fb(e),"invalid loader");let t;return Array.isArray(e)&&(t=e[1],e=e[0],e={...e,options:{...e.options,...t}}),(e?.parseTextSync||e?.parseText)&&(e.text=!0),e.text||(e.binary=!0),e}var sU=()=>{let e=zP();return e.loaderRegistry=e.loaderRegistry||[],e.loaderRegistry};function VP(e){let t=sU();e=Array.isArray(e)?e:[e];for(let r of e){let i=Lb(r);t.find(s=>i===s)||t.unshift(i)}}function oU(){return sU()}var aU=new ac({id:"loaders.gl"});var Sut=/\.([^.]+)$/;async function uU(e,t=[],r,i){if(!hU(e))return null;let s=lU(e,t,{...r,nothrow:!0},i);if(s)return s;if(Cu(e)&&(e=await e.slice(0,10).arrayBuffer(),s=lU(e,t,r,i)),!s&&!r?.nothrow)throw new Error(fU(e));return s}function lU(e,t=[],r,i){if(!hU(e))return null;if(t&&!Array.isArray(t))return Lb(t);let s=[];t&&(s=s.concat(t)),r?.ignoreRegisteredLoaders||s.push(...oU()),Iut(s);let n=Eut(e,s,r,i);if(!n&&!r?.nothrow)throw new Error(fU(e));return n}function Eut(e,t,r,i){let s=mg(e),n=Nb(e),o=uy(s)||i?.url,c=null,f="";return r?.mimeType&&(c=jP(t,r?.mimeType),f=`match forced by supplied MIME type ${r?.mimeType}`),c=c||Mut(t,o),f=f||(c?`matched url ${o}`:""),c=c||jP(t,n),f=f||(c?`matched MIME type ${n}`:""),c=c||Put(t,e),f=f||(c?`matched initial data ${pU(e)}`:""),r?.fallbackMimeType&&(c=c||jP(t,r?.fallbackMimeType),f=f||(c?`matched fallback MIME type ${n}`:"")),f&&aU.log(1,`selectLoader selected ${c?.name}: ${f}.`),c}function hU(e){return!(e instanceof Response&&e.status===204)}function fU(e){let t=mg(e),r=Nb(e),i="No valid loader found (";i+=t?`${dg.filename(t)}, `:"no url provided, ",i+=`MIME type: ${r?`"${r}"`:"not provided"}, `;let s=e?pU(e):"";return i+=s?` first bytes: "${s}"`:"first bytes: not available",i+=")",i}function Iut(e){for(let t of e)Lb(t)}function Mut(e,t){let r=t&&Sut.exec(t),i=r&&r[1];return i?Cut(e,i):null}function Cut(e,t){t=t.toLowerCase();for(let r of e)for(let i of r.extensions)if(i.toLowerCase()===t)return r;return null}function jP(e,t){for(let r of e)if(r.mimeTypes?.some(i=>BP(t,i))||BP(t,`application/x.${r.id}`))return r;return null}function Put(e,t){if(!t)return null;for(let r of e)if(typeof t=="string"){if(Rut(t,r))return r}else if(ArrayBuffer.isView(t)){if(cU(t.buffer,t.byteOffset,r))return r}else if(t instanceof ArrayBuffer&&cU(t,0,r))return r;return null}function Rut(e,t){return t.testText?t.testText(e):(Array.isArray(t.tests)?t.tests:[t.tests]).some(i=>e.startsWith(i))}function cU(e,t,r){return(Array.isArray(r.tests)?r.tests:[r.tests]).some(s=>kut(e,t,r,s))}function kut(e,t,r,i){if(i instanceof ArrayBuffer)return MP(i,e,i.byteLength);switch(typeof i){case"function":return i(e);case"string":let s=$P(e,t,i.length);return i===s;default:return!1}}function pU(e,t=5){return typeof e=="string"?e.slice(0,t):ArrayBuffer.isView(e)?$P(e.buffer,e.byteOffset,t):e instanceof ArrayBuffer?$P(e,0,t):""}function $P(e,t,r){if(e.byteLength<t+r)return"";let i=new DataView(e),s="";for(let n=0;n<r;n++)s+=String.fromCharCode(i.getUint8(t+n));return s}function*dU(e,t){let r=t?.chunkSize||262144,i=0,s=new TextEncoder;for(;i<e.length;){let n=Math.min(e.length-i,r),o=e.slice(i,i+n);i+=n,yield s.encode(o)}}function*AU(e,t={}){let{chunkSize:r=262144}=t,i=0;for(;i<e.byteLength;){let s=Math.min(e.byteLength-i,r),n=new ArrayBuffer(s),o=new Uint8Array(e,i,s);new Uint8Array(n).set(o),i+=s,yield n}}async function*mU(e,t){let r=t?.chunkSize||1048576,i=0;for(;i<e.size;){let s=i+r,n=await e.slice(i,s).arrayBuffer();i=s,yield n}}function HP(e,t){return ug?Dut(e,t):But(e,t)}async function*Dut(e,t){let r=e.getReader(),i;try{for(;;){let s=i||r.read();t?._streamReadAhead&&(i=r.read());let{done:n,value:o}=await s;if(n)return;yield e5(o)}}catch{r.releaseLock()}}async function*But(e,t){for await(let r of e)yield e5(r)}function gU(e,t){if(typeof e=="string")return dU(e,t);if(e instanceof ArrayBuffer)return AU(e,t);if(Cu(e))return mU(e,t);if(r5(e))return HP(e,t);if(Mu(e))return HP(e.body,t);throw new Error("makeIterator")}var _U="Cannot convert supplied data type";function Out(e,t,r){if(t.text&&typeof e=="string")return e;if(Xz(e)&&(e=e.buffer),e instanceof ArrayBuffer){let i=e;return t.text&&!t.binary?new TextDecoder("utf8").decode(i):i}if(ArrayBuffer.isView(e)){if(t.text&&!t.binary)return new TextDecoder("utf8").decode(e);let i=e.buffer,s=e.byteLength||e.length;return(e.byteOffset!==0||s!==i.byteLength)&&(i=i.slice(e.byteOffset,e.byteOffset+s)),i}throw new Error(_U)}async function yU(e,t,r){let i=e instanceof ArrayBuffer||ArrayBuffer.isView(e);if(typeof e=="string"||i)return Out(e,t,r);if(Cu(e)&&(e=await n5(e)),Mu(e)){let s=e;return await tU(s),t.binary?await s.arrayBuffer():await s.text()}if(r5(e)&&(e=gU(e,r)),qz(e)||Yz(e))return PP(e);throw new Error(_U)}function a5(e,t){let r=UP(),i=e||r;return typeof i.fetch=="function"?i.fetch:Ag(i.fetch)?s=>NP(s,i.fetch):t?.fetch?t?.fetch:NP}function xU(e,t,r){if(r)return r;let i={fetch:a5(t,e),...e};if(i.url){let s=uy(i.url);i.baseUrl=s,i.queryString=Qz(i.url),i.filename=dg.filename(s),i.baseUrl=dg.dirname(s)}return Array.isArray(i.loaders)||(i.loaders=null),i}function bU(e,t){if(e&&!Array.isArray(e))return e;let r;if(e&&(r=Array.isArray(e)?e:[e]),t&&t.loaders){let i=Array.isArray(t.loaders)?t.loaders:[t.loaders];r=r?[...r,...i]:i}return r&&r.length?r:void 0}async function zb(e,t,r,i){t&&!Array.isArray(t)&&!Fb(t)&&(i=void 0,r=t,t=void 0),e=await e,r=r||{};let s=mg(e),o=bU(t,i),c=await uU(e,o,r);return c?(r=nU(r,c,o,s),i=xU({url:s,_parse:zb,loaders:o},r,i||null),await Nut(c,e,r,i)):null}async function Nut(e,t,r,i){if(SP(e),r=yP(e.options,r),Mu(t)){let n=t,{ok:o,redirected:c,status:f,statusText:p,type:x,url:E}=n,T=Object.fromEntries(n.headers.entries());i.response={headers:T,ok:o,redirected:c,status:f,statusText:p,type:x,url:E}}t=await yU(t,e,r);let s=e;if(s.parseTextSync&&typeof t=="string")return s.parseTextSync(t,r,i);if(EP(e,r))return await IP(e,t,r,i,zb);if(s.parseText&&typeof t=="string")return await s.parseText(t,r,i);if(s.parse)return await s.parse(t,r,i);throw kl(!s.parseSync),new Error(`${e.id} loader - no parser found and worker is disabled`)}async function hy(e,t,r,i){let s,n;!Array.isArray(t)&&!Fb(t)?(s=[],n=t,i=void 0):(s=t,n=r);let o=a5(n),c=e;return typeof e=="string"&&(c=await o(e)),Cu(e)&&(c=await o(e)),Array.isArray(s)?await zb(c,s,n):await zb(c,s,n)}var vU="4.2.0";var Fut=globalThis.loaders?.parseImageNode,WP=typeof Image<"u",qP=typeof ImageBitmap<"u",Lut=!!Fut,YP=ug?!0:Lut;function wU(e){switch(e){case"auto":return qP||WP||YP;case"imagebitmap":return qP;case"image":return WP;case"data":return YP;default:throw new Error(`@loaders.gl/images: image ${e} not supported in this environment`)}}function TU(){if(qP)return"imagebitmap";if(WP)return"image";if(YP)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}function zut(e){let t=Uut(e);if(!t)throw new Error("Not an image");return t}function SU(e){switch(zut(e)){case"data":return e;case"image":case"imagebitmap":let t=document.createElement("canvas"),r=t.getContext("2d");if(!r)throw new Error("getImageData");return t.width=e.width,t.height=e.height,r.drawImage(e,0,0),r.getImageData(0,0,e.width,e.height);default:throw new Error("getImageData")}}function Uut(e){return typeof ImageBitmap<"u"&&e instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&e instanceof Image?"image":e&&typeof e=="object"&&e.data&&e.width&&e.height?"data":null}var Vut=/^data:image\/svg\+xml/,jut=/\.svg((\?|#).*)?$/;function l5(e){return e&&(Vut.test(e)||jut.test(e))}function EU(e,t){if(l5(t)){let i=new TextDecoder().decode(e);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(i=unescape(encodeURIComponent(i)))}catch(n){throw new Error(n.message)}return`data:image/svg+xml;base64,${btoa(i)}`}return XP(e,t)}function XP(e,t){if(l5(t))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(e)])}async function c5(e,t,r){let i=EU(e,r),s=self.URL||self.webkitURL,n=typeof i!="string"&&s.createObjectURL(i);try{return await $ut(n||i,t)}finally{n&&s.revokeObjectURL(n)}}async function $ut(e,t){let r=new Image;return r.src=e,t.image&&t.image.decode&&r.decode?(await r.decode(),r):await new Promise((i,s)=>{try{r.onload=()=>i(r),r.onerror=n=>{let o=n instanceof Error?n.message:"error";s(new Error(o))}}catch(n){s(n)}})}var Hut={},IU=!0;async function MU(e,t,r){let i;l5(r)?i=await c5(e,t,r):i=XP(e,r);let s=t&&t.imagebitmap;return await Wut(i,s)}async function Wut(e,t=null){if((qut(t)||!IU)&&(t=null),t)try{return await createImageBitmap(e,t)}catch(r){console.warn(r),IU=!1}return await createImageBitmap(e)}function qut(e){for(let t in e||Hut)return!1;return!0}function CU(e){return!Gut(e,"ftyp",4)||!(e[8]&96)?null:Yut(e)}function Yut(e){switch(Xut(e,8,12).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}}function Xut(e,t,r){return String.fromCharCode(...e.slice(t,r))}function Zut(e){return[...e].map(t=>t.charCodeAt(0))}function Gut(e,t,r=0){let i=Zut(t);for(let s=0;s<i.length;++s)if(i[s]!==e[s+r])return!1;return!0}var Lf=!1,Ub=!0;function u5(e){let t=Vb(e);return Kut(t)||eht(t)||Jut(t)||tht(t)||Qut(t)}function Qut(e){let t=new Uint8Array(e instanceof DataView?e.buffer:e),r=CU(t);return r?{mimeType:r.mimeType,width:0,height:0}:null}function Kut(e){let t=Vb(e);return t.byteLength>=24&&t.getUint32(0,Lf)===2303741511?{mimeType:"image/png",width:t.getUint32(16,Lf),height:t.getUint32(20,Lf)}:null}function Jut(e){let t=Vb(e);return t.byteLength>=10&&t.getUint32(0,Lf)===1195984440?{mimeType:"image/gif",width:t.getUint16(6,Ub),height:t.getUint16(8,Ub)}:null}function tht(e){let t=Vb(e);return t.byteLength>=14&&t.getUint16(0,Lf)===16973&&t.getUint32(2,Ub)===t.byteLength?{mimeType:"image/bmp",width:t.getUint32(18,Ub),height:t.getUint32(22,Ub)}:null}function eht(e){let t=Vb(e);if(!(t.byteLength>=3&&t.getUint16(0,Lf)===65496&&t.getUint8(2)===255))return null;let{tableMarkers:i,sofMarkers:s}=rht(),n=2;for(;n+9<t.byteLength;){let o=t.getUint16(n,Lf);if(s.has(o))return{mimeType:"image/jpeg",height:t.getUint16(n+5,Lf),width:t.getUint16(n+7,Lf)};if(!i.has(o))return null;n+=2,n+=t.getUint16(n,Lf)}return null}function rht(){let e=new Set([65499,65476,65484,65501,65534]);for(let r=65504;r<65520;++r)e.add(r);return{tableMarkers:e,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}function Vb(e){if(e instanceof DataView)return e;if(ArrayBuffer.isView(e))return new DataView(e.buffer);if(e instanceof ArrayBuffer)return new DataView(e);throw new Error("toDataView")}async function PU(e,t){let{mimeType:r}=u5(e)||{},i=globalThis.loaders?.parseImageNode;return aA(i),await i(e,r)}async function RU(e,t,r){t=t||{};let s=(t.image||{}).type||"auto",{url:n}=r||{},o=iht(s),c;switch(o){case"imagebitmap":c=await MU(e,t,n);break;case"image":c=await c5(e,t,n);break;case"data":c=await PU(e,t);break;default:aA(!1)}return s==="data"&&(c=SU(c)),c}function iht(e){switch(e){case"auto":case"data":return TU();default:return wU(e),e}}var nht=["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],sht=["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],oht={image:{type:"auto",decode:!0}},ZP={dataType:null,batchType:null,id:"image",module:"images",name:"Images",version:vU,mimeTypes:sht,extensions:nht,parse:RU,tests:[e=>!!u5(new DataView(e))],options:oht};var aht=new ac({id:"deck"}),mi=aht;var GP={};function kU(e){GP=e}function so(e,t,r,i){mi.level>0&&GP[e]&&GP[e].call(null,t,r,i)}function lht(e){let t=e[0],r=e[e.length-1];return t==="{"&&r==="}"||t==="["&&r==="]"}var DU={dataType:null,batchType:null,id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:lht,parseTextSync:JSON.parse};function cht(){let e="9.0.14",t=globalThis.deck&&globalThis.deck.VERSION;if(t&&t!==e)throw new Error(`deck.gl - multiple versions detected: ${t} vs ${e}`);return t||(mi.log(1,`deck.gl ${e}`)(),globalThis.deck={...globalThis.deck,VERSION:e,version:e,log:mi,_registerLoggers:kU},VP([DU,[ZP,{imagebitmap:{premultiplyAlpha:"none"}}]])),e}var BU=cht();function zf(e,t){if(!e)throw new Error(t||"shadertools: assertion failed.")}var QP={number:{type:"number",validate(e,t){return Number.isFinite(e)&&typeof t=="object"&&(t.max===void 0||e<=t.max)&&(t.min===void 0||e>=t.min)}},array:{type:"array",validate(e,t){return Array.isArray(e)||ArrayBuffer.isView(e)}}};function NU(e){let t={};for(let[r,i]of Object.entries(e))t[r]=uht(i);return t}function FU(e,t,r){let i={};for(let[s,n]of Object.entries(t))e&&s in e&&!n.private?(n.validate&&zf(n.validate(e[s],n),`${r}: invalid ${s}`),i[s]=e[s]):i[s]=n.value;return i}function uht(e){let t=OU(e);if(t!=="object")return{value:e,...QP[t],type:t};if(typeof e=="object")return e?e.type!==void 0?{...e,...QP[e.type],type:e.type}:e.value===void 0?{type:"object",value:e}:(t=OU(e.value),{...e,...QP[t],type:t}):{type:"object",value:null};throw new Error("props")}function OU(e){return Array.isArray(e)||ArrayBuffer.isView(e)?"array":typeof e}var LU=`#ifdef MODULE_LOGDEPTH
logdepth_adjustPosition(gl_Position);
#endif
`,zU=`#ifdef MODULE_MATERIAL
gl_FragColor = material_filterColor(gl_FragColor);
#endif
#ifdef MODULE_LIGHTING
gl_FragColor = lighting_filterColor(gl_FragColor);
#endif
#ifdef MODULE_FOG
gl_FragColor = fog_filterColor(gl_FragColor);
#endif
#ifdef MODULE_PICKING
gl_FragColor = picking_filterHighlightColor(gl_FragColor);
gl_FragColor = picking_filterPickingColor(gl_FragColor);
#endif
#ifdef MODULE_LOGDEPTH
logdepth_setFragDepth();
#endif
`;var hht={vertex:LU,fragment:zU},UU=/void\s+main\s*\([^)]*\)\s*\{\n?/,VU=/}\n?[^{}]*$/,KP=[],jb="__LUMA_INJECT_DECLARATIONS__";function jU(e){let t={vertex:{},fragment:{}};for(let r in e){let i=e[r],s=fht(r);typeof i=="string"&&(i={order:0,injection:i}),t[s][r]=i}return t}function fht(e){let t=e.slice(0,2);switch(t){case"vs":return"vertex";case"fs":return"fragment";default:throw new Error(t)}}function $b(e,t,r,i=!1){let s=t==="vertex";for(let n in r){let o=r[n];o.sort((f,p)=>f.order-p.order),KP.length=o.length;for(let f=0,p=o.length;f<p;++f)KP[f]=o[f].injection;let c=`${KP.join(`
`)}
`;switch(n){case"vs:#decl":s&&(e=e.replace(jb,c));break;case"vs:#main-start":s&&(e=e.replace(UU,f=>f+c));break;case"vs:#main-end":s&&(e=e.replace(VU,f=>c+f));break;case"fs:#decl":s||(e=e.replace(jb,c));break;case"fs:#main-start":s||(e=e.replace(UU,f=>f+c));break;case"fs:#main-end":s||(e=e.replace(VU,f=>c+f));break;default:e=e.replace(n,f=>f+c)}}return e=e.replace(jb,""),i&&(e=e.replace(/\}\s*$/,n=>n+hht[t])),e}var pht=1,fy=class e{name;vs;fs;getModuleUniforms;dependencies;deprecations;defines;injections;uniforms={};uniformTypes={};static instantiateModules(t){return t.map(r=>{if(r instanceof e)return r;zf(typeof r!="string",`Shader module use by name is deprecated. Import shader module '${JSON.stringify(r)}' and use it directly.`),r.name||(console.warn("shader module has no name"),r.name=`shader-module-${pht++}`);let i=new e(r);return i.dependencies=e.instantiateModules(r.dependencies||[]),i})}constructor(t){let{name:r,vs:i,fs:s,dependencies:n=[],uniformTypes:o={},uniformPropTypes:c={},getUniforms:f,deprecations:p=[],defines:x={},inject:E={}}=t;zf(typeof r=="string"),this.name=r,this.vs=i,this.fs=s,this.getModuleUniforms=f,this.dependencies=e.instantiateModules(n),this.deprecations=this._parseDeprecationDefinitions(p),this.defines=x,this.injections=jU(E),this.uniformTypes=o,c&&(this.uniforms=NU(c))}getModuleSource(t){let r;switch(t){case"vertex":r=this.vs||"";break;case"fragment":r=this.fs||"";break;default:zf(!1)}let i=this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_");return`// ----- MODULE ${this.name} ---------------

#define MODULE_${i}
${r}

`}getUniforms(t,r){return this.getModuleUniforms?this.getModuleUniforms(t,r):FU(t,this.uniforms,this.name)}getDefines(){return this.defines}checkDeprecations(t,r){this.deprecations.forEach(i=>{i.regex?.test(t)&&(i.deprecated?r.deprecated(i.old,i.new)():r.removed(i.old,i.new)())})}_parseDeprecationDefinitions(t){return t.forEach(r=>{switch(r.type){case"function":r.regex=new RegExp(`\\b${r.old}\\(`);break;default:r.regex=new RegExp(`${r.type} ${r.old};`)}}),t}_defaultGetUniforms(t={}){let r={},i=this.uniforms;for(let s in i){let n=i[s];s in t&&!n.private?(n.validate&&zf(n.validate(t[s],n),`${this.name}: invalid ${s}`),r[s]=t[s]):r[s]=n.value}return r}};function JP(e){if(e.source&&e.platformInfo.type==="webgpu")return{...e,vs:void 0,fs:void 0};if(!e.vs)throw new Error("no vertex shader");let t=$U(e.platformInfo,e.vs),r;return e.fs&&(r=$U(e.platformInfo,e.fs)),{...e,vs:t,fs:r}}function $U(e,t){if(typeof t=="string")return t;switch(e.type){case"webgpu":if(t?.wgsl)return t.wgsl;throw new Error("WebGPU does not support GLSL shaders");default:if(t?.glsl)return t.glsl;throw new Error("WebGL does not support WGSL shaders")}}function gg(e){let t=fy.instantiateModules(e);return dht(t)}function dht(e){let t={},r={};return HU({modules:e,level:0,moduleMap:t,moduleDepth:r}),Object.keys(r).sort((i,s)=>r[s]-r[i]).map(i=>t[i])}function HU(e){let{modules:t,level:r,moduleMap:i,moduleDepth:s}=e;if(r>=5)throw new Error("Possible loop in shader dependency graph");for(let n of t)i[n.name]=n,(s[n.name]===void 0||s[n.name]<r)&&(s[n.name]=r);for(let n of t)n.dependencies&&HU({modules:n.dependencies,level:r+1,moduleMap:i,moduleDepth:s})}function WU(e){switch(e?.gpu.toLowerCase()){case"apple":return`#define APPLE_GPU
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"nvidia":return`#define NVIDIA_GPU
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
`;case"intel":return`#define INTEL_GPU
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"amd":return`#define AMD_GPU
`;default:return`#define DEFAULT_GPU
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`}}function YU(e,t){if(Number(e.match(/^#version[ \t]+(\d+)/m)?.[1]||100)!==300)throw new Error("luma.gl v9 only supports GLSL 3.00 shader sources");switch(t){case"vertex":return e=qU(e,Aht),e;case"fragment":return e=qU(e,mht),e;default:throw new Error(t)}}var XU=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,`#version 300 es
`],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],Aht=[...XU,[tR("attribute"),"in $1"],[tR("varying"),"out $1"]],mht=[...XU,[tR("varying"),"in $1"]];function qU(e,t){for(let[r,i]of t)e=e.replace(r,i);return e}function tR(e){return new RegExp(`\\b${e}[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)`,"g")}function eR(e,t){let r="";for(let i in e){let s=e[i];if(r+=`void ${s.signature} {
`,s.header&&(r+=`  ${s.header}`),t[i]){let n=t[i];n.sort((o,c)=>o.order-c.order);for(let o of n)r+=`  ${o.injection}
`}s.footer&&(r+=`  ${s.footer}`),r+=`}
`}return r}function rR(e){let t={vertex:{},fragment:{}};for(let r of e){let i,s;typeof r!="string"?(i=r,s=i.hook):(i={},s=r),s=s.trim();let[n,o]=s.split(":"),c=s.replace(/\(.+/,""),f=Object.assign(i,{signature:o});switch(n){case"vs":t.vertex[c]=f;break;case"fs":t.fragment[c]=f;break;default:throw new Error(n)}}return t}function ZU(e,t){return{name:ght(e,t),language:"glsl",version:_ht(e)}}function ght(e,t="unnamed"){let i=/#define[^\S\r\n]*SHADER_NAME[^\S\r\n]*([A-Za-z0-9_-]+)\s*/.exec(e);return i?i[1]:t}function _ht(e){let t=100,r=e.match(/[^\s]+/g);if(r&&r.length>=2&&r[0]==="#version"){let i=parseInt(r[1],10);Number.isFinite(i)&&(t=i)}if(t!==100&&t!==300)throw new Error(`Invalid GLSL version ${t}`);return t}var QU=`

${jb}
`,yht=`precision highp float;
`;function KU(e){let t=gg(e.modules||[]);return{source:iR(e.platformInfo,{...e,source:e.source,stage:"vertex",modules:t}),getUniforms:nR(t)}}function JU(e){let t=gg(e.modules||[]);return{vs:iR(e.platformInfo,{...e,source:e.vs,stage:"vertex",modules:t}),fs:iR(e.platformInfo,{...e,source:e.fs,stage:"fragment",modules:t}),getUniforms:nR(t)}}function tV(e){let{vs:t,fs:r}=e,i=gg(e.modules||[]);return{vs:GU(e.platformInfo,{...e,source:t,stage:"vertex",modules:i}),fs:GU(e.platformInfo,{...e,source:r,stage:"fragment",modules:i}),getUniforms:nR(i)}}function iR(e,t){let{source:r,stage:i,modules:s,hookFunctions:n=[],inject:o={},log:c}=t;zf(typeof r=="string","shader source must be a string");let f=r,p="",x=rR(n),E={},T={},D={};for(let z in o){let U=typeof o[z]=="string"?{injection:o[z],order:0}:o[z],H=/^(v|f)s:(#)?([\w-]+)$/.exec(z);if(H){let G=H[2],Z=H[3];G?Z==="decl"?T[z]=[U]:D[z]=[U]:E[z]=[U]}else D[z]=[U]}let N=e.type!=="webgpu"?s:[];for(let z of N){c&&z.checkDeprecations(f,c);let U=z.getModuleSource(i,"wgsl");p+=U;let H=z.injections[i];for(let G in H){let Z=/^(v|f)s:#([\w-]+)$/.exec(G);if(Z){let st=Z[2]==="decl"?T:D;st[G]=st[G]||[],st[G].push(H[G])}else E[G]=E[G]||[],E[G].push(H[G])}}return p+=QU,p=$b(p,i,T),p+=eR(x[i],E),p+=f,p=$b(p,i,D),p}function GU(e,t){let{id:r,source:i,stage:s,language:n="glsl",modules:o,defines:c={},hookFunctions:f=[],inject:p={},prologue:x=!0,log:E}=t;zf(typeof i=="string","shader source must be a string");let T=n==="glsl"?ZU(i).version:-1,D=e.shaderLanguageVersion,N=T===100?"#version 100":"#version 300 es",U=i.split(`
`).slice(1).join(`
`),H={};o.forEach(Dt=>{Object.assign(H,Dt.getDefines())}),Object.assign(H,c);let G="";switch(n){case"wgsl":break;case"glsl":G=x?`${N}

// ----- PROLOGUE -------------------------
${xht({id:r,source:i,stage:s})}
${`#define SHADER_TYPE_${s.toUpperCase()}`}
${WU(e)}
${s==="fragment"?yht:""}

// ----- APPLICATION DEFINES -------------------------

${bht(H)}

`:`${N}
`;break}let Z=rR(f),Y={},st={},at={};for(let Dt in p){let Tt=typeof p[Dt]=="string"?{injection:p[Dt],order:0}:p[Dt],kt=/^(v|f)s:(#)?([\w-]+)$/.exec(Dt);if(kt){let Et=kt[2],Mt=kt[3];Et?Mt==="decl"?st[Dt]=[Tt]:at[Dt]=[Tt]:Y[Dt]=[Tt]}else at[Dt]=[Tt]}for(let Dt of o){E&&Dt.checkDeprecations(U,E);let Tt=Dt.getModuleSource(s);G+=Tt;let kt=Dt.injections[s];for(let Et in kt){let Mt=/^(v|f)s:#([\w-]+)$/.exec(Et);if(Mt){let Xt=Mt[2]==="decl"?st:at;Xt[Et]=Xt[Et]||[],Xt[Et].push(kt[Et])}else Y[Et]=Y[Et]||[],Y[Et].push(kt[Et])}}return G+="// ----- MAIN SHADER SOURCE -------------------------",G+=QU,G=$b(G,s,st),G+=eR(Z[s],Y),G+=U,G=$b(G,s,at),n==="glsl"&&T!==D&&(G=YU(G,s)),G.trim()}function nR(e){return function(r){let i={};for(let s of e){let n=s.getUniforms(r,i);Object.assign(i,n)}return i}}function xht(e){let{id:t,source:r,stage:i}=e;return t&&r.indexOf("SHADER_NAME")===-1?`
#define SHADER_NAME ${t}_${i}

`:""}function bht(e={}){let t="";for(let r in e){let i=e[r];(i||Number.isFinite(i))&&(t+=`#define ${r.toUpperCase()} ${e[r]}
`)}return t}var _g=class e{static defaultShaderAssembler;_hookFunctions=[];_defaultModules=[];static getDefaultShaderAssembler(){return e.defaultShaderAssembler=e.defaultShaderAssembler||new e,e.defaultShaderAssembler}addDefaultModule(t){this._defaultModules.find(r=>r.name===(typeof t=="string"?t:t.name))||this._defaultModules.push(t)}removeDefaultModule(t){let r=typeof t=="string"?t:t.name;this._defaultModules=this._defaultModules.filter(i=>i.name!==r)}addShaderHook(t,r){r&&(t=Object.assign(r,{hook:t})),this._hookFunctions.push(t)}assembleShader(t){let r=this._getModuleList(t.modules),i=this._hookFunctions,s=JP(t);return{...KU({platformInfo:t.platformInfo,...s,modules:r,hookFunctions:i}),modules:r}}assembleShaderPair(t){let r=JP(t),i=this._getModuleList(t.modules),s=this._hookFunctions,{platformInfo:n}=t;return{...t.platformInfo.shaderLanguage==="wgsl"?JU({platformInfo:n,...r,modules:i,hookFunctions:s}):tV({platformInfo:n,...r,modules:i,hookFunctions:s}),modules:i}}_getModuleList(t=[]){let r=new Array(this._defaultModules.length+t.length),i={},s=0;for(let n=0,o=this._defaultModules.length;n<o;++n){let c=this._defaultModules[n],f=c.name;r[s++]=c,i[f]=!0}for(let n=0,o=t.length;n<o;++n){let c=t[n],f=c.name;i[f]||(r[s++]=c,i[f]=!0)}return r.length=s,fy.instantiateModules(r)}};var vht=`out vec4 transform_output;
void main() {
transform_output = vec4(0);
}`,wht=`#version 300 es
${vht}`;function sR(e){let{input:t,inputChannels:r,output:i}=e||{};if(!t)return wht;if(!r)throw new Error("inputChannels");let s=Tht(r),n=eV(t,r);return`#version 300 es
in ${s} ${t};
out vec4 ${i};
void main() {
  ${i} = ${n};
}`}function Tht(e){switch(e){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error(`invalid channels: ${e}`)}}function eV(e,t){switch(t){case 1:return`vec4(${e}, 0.0, 0.0, 1.0)`;case 2:return`vec4(${e}, 0.0, 1.0)`;case 3:return`vec4(${e}, 1.0)`;case 4:return e;default:throw new Error(`invalid channels: ${t}`)}}var Ce=new ac({id:"luma.gl"});var oR=class{stats=new Map;getStats(t){return this.get(t)}get(t){return this.stats.has(t)||this.stats.set(t,new Iu({id:t})),this.stats.get(t)}},py=new oR;function Sht(){let e="9.0.14",t="set luma.log.level=1 (or higher) to trace rendering";if(globalThis.luma&&globalThis.luma.VERSION!==e)throw new Error(`luma.gl - multiple VERSIONs detected: ${globalThis.luma.VERSION} vs ${e}`);return globalThis.luma||(ol()&&Ce.log(1,`${e} - ${t}`)(),globalThis.luma=globalThis.luma||{VERSION:e,version:e,log:Ce,stats:py}),e}var rV=Sht();function Eht(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)?e:null}function cA(e){return Array.isArray(e)?e.length===0||typeof e[0]=="number"?e:null:Eht(e)}var aR={};function Dl(e="id"){aR[e]=aR[e]||1;let t=aR[e]++;return`${e}-${t}`}function uA(e){let t=!0;for(let r in e){t=!1;break}return t}var Oi=class{static defaultProps={id:"undefined",handle:void 0,userData:void 0};id;props;userData={};_device;destroyed=!1;allocatedBytes=0;_attachedResources=new Set;constructor(t,r,i){if(!t)throw new Error("no device");this._device=t,this.props=Iht(r,i);let s=this.props.id!=="undefined"?this.props.id:Dl(this[Symbol.toStringTag]);this.props.id=s,this.id=s,this.userData=this.props.userData||{},this.addStats()}destroy(){this.destroyResource()}delete(){return this.destroy(),this}toString(){return`${this[Symbol.toStringTag]||this.constructor.name}(${this.id})`}getProps(){return this.props}attachResource(t){this._attachedResources.add(t)}detachResource(t){this._attachedResources.delete(t)}destroyAttachedResource(t){this._attachedResources.delete(t)&&t.destroy()}destroyAttachedResources(){for(let t of Object.values(this._attachedResources))t.destroy();this._attachedResources=new Set}destroyResource(){this.destroyAttachedResources(),this.removeStats(),this.destroyed=!0}removeStats(){let t=this._device.statsManager.getStats("Resource Counts"),r=this[Symbol.toStringTag];t.get(`${r}s Active`).decrementCount()}trackAllocatedMemory(t,r=this[Symbol.toStringTag]){let i=this._device.statsManager.getStats("Resource Counts");i.get("GPU Memory").addCount(t),i.get(`${r} Memory`).addCount(t),this.allocatedBytes=t}trackDeallocatedMemory(t=this[Symbol.toStringTag]){let r=this._device.statsManager.getStats("Resource Counts");r.get("GPU Memory").subtractCount(this.allocatedBytes),r.get(`${t} Memory`).subtractCount(this.allocatedBytes),this.allocatedBytes=0}addStats(){let t=this._device.statsManager.getStats("Resource Counts"),r=this[Symbol.toStringTag];t.get("Resources Created").incrementCount(),t.get(`${r}s Created`).incrementCount(),t.get(`${r}s Active`).incrementCount()}};function Iht(e,t){let r={...t};for(let i in e)e[i]!==void 0&&(r[i]=e[i]);return r}var Tn=class e extends Oi{static defaultProps={...Oi.defaultProps,usage:0,byteLength:0,byteOffset:0,data:null,indexType:"uint16",mappedAtCreation:!1};static MAP_READ=1;static MAP_WRITE=2;static COPY_SRC=4;static COPY_DST=8;static INDEX=16;static VERTEX=32;static UNIFORM=64;static STORAGE=128;static INDIRECT=256;static QUERY_RESOLVE=512;get[Symbol.toStringTag](){return"Buffer"}usage;indexType;updateTimestamp;constructor(t,r){let i={...r};(r.usage||0)&e.INDEX&&!r.indexType&&(r.data instanceof Uint32Array?i.indexType="uint32":r.data instanceof Uint16Array&&(i.indexType="uint16")),super(t,i,e.defaultProps),this.usage=r.usage||0,this.indexType=i.indexType,this.updateTimestamp=t.incrementTimestamp()}readSyncWebGL(t,r){throw new Error("not implemented")}static DEBUG_DATA_MAX_LENGTH=32;debugData=new ArrayBuffer(0);_setDebugData(t,r,i){let s=ArrayBuffer.isView(t)?t.buffer:t,n=Math.min(t?t.byteLength:i,e.DEBUG_DATA_MAX_LENGTH);t===null?this.debugData=new ArrayBuffer(n):r===0&&i===t.byteLength?this.debugData=s.slice(0,n):this.debugData=s.slice(r,r+n)}};function h5(e){let t=iV[e],r=Mht(t),i=e.includes("norm"),s=!i&&!e.startsWith("float"),n=e.startsWith("s");return{dataType:iV[e],byteLength:r,integer:s,signed:n,normalized:i}}function Mht(e){return Cht[e]}var iV={uint8:"uint8",sint8:"sint8",unorm8:"uint8",snorm8:"sint8",uint16:"uint16",sint16:"sint16",unorm16:"uint16",snorm16:"sint16",float16:"float16",float32:"float32",uint32:"uint32",sint32:"sint32"},Cht={uint8:1,sint8:1,uint16:2,sint16:2,float16:2,float32:4,uint32:4,sint32:4};var Pht=["bc1","bc2","bc3","bc4","bc5","bc6","bc7","etc1","etc2","eac","atc","astc","pvrtc"],Rht=/^(rg?b?a?)([0-9]*)([a-z]*)(-srgb)?(-webgl|-unsized)?$/;function nV(e){return Pht.some(t=>e.startsWith(t))}function f5(e){let t=Rht.exec(e);if(t){let[,r,i,s,n,o]=t;if(r){let c=`${s}${i}`,f=h5(c);return{format:r,components:r.length,srgb:n==="-srgb",unsized:o==="-unsized",webgl:o==="-webgl",...f}}}return Dht(e)}var kht={"rgba4unorm-webgl":{format:"rgba",bpp:2},"rgb565unorm-webgl":{format:"rgb",bpp:2},"rgb5a1unorm-webgl":{format:"rgba",bbp:2},rgb9e5ufloat:{format:"rgb",bbp:4},rg11b10ufloat:{format:"rgb",bbp:4},rgb10a2unorm:{format:"rgba",bbp:4},"rgb10a2uint-webgl":{format:"rgba",bbp:4},stencil8:{components:1,bpp:1,a:"stencil"},depth16unorm:{components:1,bpp:2,a:"depth"},depth24plus:{components:1,bpp:3,a:"depth"},depth32float:{components:1,bpp:4,a:"depth"},"depth24plus-stencil8":{components:2,bpp:4,a:"depth-stencil"},"depth24unorm-stencil8":{components:2,bpp:4,a:"depth-stencil"},"depth32float-stencil8":{components:2,bpp:4,a:"depth-stencil"}};function Dht(e){let t=kht[e];if(!t)throw new Error(`Unknown format ${e}`);return{format:t.format||"",components:t.components||t.format?.length||1,byteLength:t.bpp||1,srgb:!1,unsized:!1}}var Hb=class{},Wb=class{features;disabledFeatures;constructor(t=[],r){this.features=new Set(t),this.disabledFeatures=r||{}}*[Symbol.iterator](){yield*this.features}has(t){return!this.disabledFeatures[t]&&this.features.has(t)}},md=class e{static defaultProps={id:null,canvas:null,container:null,manageState:!0,width:800,height:600,requestMaxLimits:!0,debug:!!Ce.get("debug"),spector:!!(Ce.get("spector")||Ce.get("spectorjs")),break:[],initalizeFeatures:!0,disabledFeatures:{"compilation-status-async-webgl":!0},gl:null,onError:t=>Ce.error(t.message)};get[Symbol.toStringTag](){return"Device"}static VERSION=rV;constructor(t){this.props={...e.defaultProps,...t},this.id=this.props.id||Dl(this[Symbol.toStringTag].toLowerCase())}id;props;userData={};statsManager=py;_lumaData={};isTextureFormatCompressed(t){return nV(t)}loseDevice(){return!1}getCanvasContext(){if(!this.canvasContext)throw new Error("Device has no CanvasContext");return this.canvasContext}createTexture(t){return(t instanceof Promise||typeof t=="string")&&(t={data:t}),this._createTexture(t)}createCommandEncoder(t={}){throw new Error("not implemented")}readPixelsToArrayWebGL(t,r){throw new Error("not implemented")}readPixelsToBufferWebGL(t,r){throw new Error("not implemented")}setParametersWebGL(t){throw new Error("not implemented")}getParametersWebGL(t){throw new Error("not implemented")}withParametersWebGL(t,r){throw new Error("not implemented")}clearWebGL(t){throw new Error("not implemented")}resetWebGL(){throw new Error("not implemented")}timestamp=0;incrementTimestamp(){return this.timestamp++}onError(t){this.props.onError(t)}_getBufferProps(t){(t instanceof ArrayBuffer||ArrayBuffer.isView(t))&&(t={data:t});let r={...t};return(t.usage||0)&Tn.INDEX&&!t.indexType&&(t.data instanceof Uint32Array?r.indexType="uint32":t.data instanceof Uint16Array?r.indexType="uint16":Ce.warn("indices buffer content must be of integer type")()),r}};function Zi(e,t){if(!e)throw new Error(t||"luma.gl: assertion failed.")}var qb=new Map,gd=class e{static defaultProps={...md.defaultProps,type:"best-available",devices:void 0};static stats=py;static log=Ce;static registerDevices(t){for(let r of t)Zi(r.type&&r.isSupported&&r.create),qb.set(r.type,r)}static getAvailableDevices(){return Array.from(qb).map(t=>t.type)}static getSupportedDevices(){return Array.from(qb).filter(t=>t.isSupported()).map(t=>t.type)}static setDefaultDeviceProps(t){Object.assign(md.defaultProps,t)}static async attachDevice(t){let r=sV(t.devices)||qb;if(t.handle instanceof WebGL2RenderingContext){let i=r.get("webgl");if(i)return await i.attach(t.handle)}if(t.handle===null){let i=r.get("unknown");if(i)return await i.attach(null)}throw new Error("Failed to attach device. Ensure `@luma.gl/webgl` and/or `@luma.gl/webgpu` modules are imported.")}static async createDevice(t={}){t={...e.defaultProps,...t},t.gl&&(t.type="webgl");let r=sV(t.devices)||qb;switch(t.type){case"webgpu":let i=r.get("webgpu");if(i)return await i.create(t);break;case"webgl":let s=r.get("webgl");if(s)return await s.create(t);break;case"unknown":let n=r.get("unknown");if(n)return await n.create(t);break;case"best-available":if(i=r.get("webgpu"),i?.isSupported?.())return await i.create(t);if(s=r.get("webgl"),s?.isSupported?.())return await s.create(t);break}throw new Error("No matching device found. Ensure `@luma.gl/webgl` and/or `@luma.gl/webgpu` modules are imported.")}static enforceWebGL2(t=!0){let r=HTMLCanvasElement.prototype;if(!t&&r.originalGetContext){r.getContext=r.originalGetContext,r.originalGetContext=void 0;return}r.originalGetContext=r.getContext,r.getContext=function(i,s){return i==="webgl"||i==="experimental-webgl"?this.originalGetContext("webgl2",s):this.originalGetContext(i,s)}}};function sV(e){if(!e||e?.length===0)return null;let t=new Map;for(let r of e)t.set(r.type,r);return t}var Bht=ol()&&typeof document<"u",p5=()=>Bht&&document.readyState==="complete",Oht={canvas:null,width:800,height:600,useDevicePixels:!0,autoResize:!0,container:null,visible:!0,colorSpace:"srgb",alphaMode:"opaque"},yg=class{id;props;canvas;htmlCanvas;offscreenCanvas;type;width=1;height=1;resizeObserver;_canvasSizeInfo={clientWidth:0,clientHeight:0,devicePixelRatio:1};static get isPageLoaded(){return p5()}static pageLoaded=Nht();constructor(t){if(this.props={...Oht,...t},t=this.props,!ol()){this.id="node-canvas-context",this.type="node",this.width=this.props.width,this.height=this.props.height,this.canvas=null;return}if(t.canvas)typeof t.canvas=="string"?this.canvas=Lht(t.canvas):this.canvas=t.canvas;else{let r=zht(t),i=Fht(t?.container||null);i.insertBefore(r,i.firstChild),this.canvas=r,t?.visible||(this.canvas.style.visibility="hidden")}this.canvas instanceof HTMLCanvasElement?(this.id=this.canvas.id,this.type="html-canvas",this.htmlCanvas=this.canvas):(this.id="offscreen-canvas",this.type="offscreen-canvas",this.offscreenCanvas=this.canvas),this.canvas instanceof HTMLCanvasElement&&t.autoResize&&(this.resizeObserver=new ResizeObserver(r=>{for(let i of r)i.target===this.canvas&&this.update()}),this.resizeObserver.observe(this.canvas))}getDevicePixelRatio(t){return typeof OffscreenCanvas<"u"&&this.canvas instanceof OffscreenCanvas||(t=t===void 0?this.props.useDevicePixels:t,!t||t<=0)?1:t===!0?typeof window<"u"&&window.devicePixelRatio||1:t}getPixelSize(){switch(this.type){case"node":return[this.width,this.height];case"offscreen-canvas":return[this.canvas.width,this.canvas.height];case"html-canvas":let t=this.getDevicePixelRatio(),r=this.canvas;return r.parentElement?[r.clientWidth*t,r.clientHeight*t]:[this.canvas.width,this.canvas.height];default:throw new Error(this.type)}}getAspect(){let[t,r]=this.getPixelSize();return t/r}cssToDeviceRatio(){try{let[t]=this.getDrawingBufferSize(),{clientWidth:r}=this._canvasSizeInfo;return r?t/r:1}catch{return 1}}cssToDevicePixels(t,r=!0){let i=this.cssToDeviceRatio(),[s,n]=this.getDrawingBufferSize();return Uht(t,i,s,n,r)}setDevicePixelRatio(t,r={}){if(!this.htmlCanvas)return;let i="width"in r?r.width:this.htmlCanvas.clientWidth,s="height"in r?r.height:this.htmlCanvas.clientHeight;(!i||!s)&&(Ce.log(1,"Canvas clientWidth/clientHeight is 0")(),t=1,i=this.htmlCanvas.width||1,s=this.htmlCanvas.height||1);let n=this._canvasSizeInfo;if(n.clientWidth!==i||n.clientHeight!==s||n.devicePixelRatio!==t){let o=t,c=Math.floor(i*o),f=Math.floor(s*o);this.htmlCanvas.width=c,this.htmlCanvas.height=f;let[p,x]=this.getDrawingBufferSize();(p!==c||x!==f)&&(o=Math.min(p/i,x/s),this.htmlCanvas.width=Math.floor(i*o),this.htmlCanvas.height=Math.floor(s*o),Ce.warn("Device pixel ratio clamped")()),this._canvasSizeInfo.clientWidth=i,this._canvasSizeInfo.clientHeight=s,this._canvasSizeInfo.devicePixelRatio=t}}getDrawingBufferSize(){let t=this.device.gl;if(!t)throw new Error("canvas size");return[t.drawingBufferWidth,t.drawingBufferHeight]}_setAutoCreatedCanvasId(t){this.htmlCanvas?.id==="lumagl-auto-created-canvas"&&(this.htmlCanvas.id=t)}};function Nht(){return p5()||typeof window>"u"?Promise.resolve():new Promise(e=>{window.addEventListener("load",()=>e())})}function Fht(e){if(typeof e=="string"){let t=document.getElementById(e);if(!t&&!p5())throw new Error(`Accessing '${e}' before page was loaded`);if(!t)throw new Error(`${e} is not an HTML element`);return t}else if(e)return e;return document.body}function Lht(e){let t=document.getElementById(e);if(!t&&!p5())throw new Error(`Accessing '${e}' before page was loaded`);if(!(t instanceof HTMLCanvasElement))throw new Error("Object is not a canvas element");return t}function zht(e){let{width:t,height:r}=e,i=document.createElement("canvas");return i.id="lumagl-auto-created-canvas",i.width=t||1,i.height=r||1,i.style.width=Number.isFinite(t)?`${t}px`:"100%",i.style.height=Number.isFinite(r)?`${r}px`:"100%",i}function Uht(e,t,r,i,s){let n=e,o=oV(n[0],t,r),c=aV(n[1],t,i,s),f=oV(n[0]+1,t,r),p=f===r-1?f:f-1;f=aV(n[1]+1,t,i,s);let x;return s?(f=f===0?f:f+1,x=c,c=f):x=f===i-1?f:f-1,{x:o,y:c,width:Math.max(p-o+1,1),height:Math.max(x-c+1,1)}}function oV(e,t,r){return Math.min(Math.round(e*t),r-1)}function aV(e,t,r,i){return i?Math.max(0,r-1-Math.round(e*t)):Math.min(Math.round(e*t),r-1)}var Bo=class e extends Oi{static defaultProps={...Oi.defaultProps,data:null,dimension:"2d",format:"rgba8unorm",width:void 0,height:void 0,depth:1,mipmaps:!0,compressed:!1,usage:0,mipLevels:void 0,samples:void 0,type:void 0,sampler:{},view:void 0};static COPY_SRC=1;static COPY_DST=2;static TEXTURE_BINDING=4;static STORAGE_BINDING=8;static RENDER_ATTACHMENT=16;get[Symbol.toStringTag](){return"Texture"}dimension;format;width;height;depth;updateTimestamp;constructor(t,r,i=e.defaultProps){super(t,r,i),this.dimension=this.props.dimension,this.format=this.props.format,this.width=this.props.width,this.height=this.props.height,this.depth=this.props.depth,this.updateTimestamp=t.incrementTimestamp()}};var xg=class e extends Oi{static defaultProps={...Oi.defaultProps,format:void 0,dimension:void 0,aspect:"all",baseMipLevel:0,mipLevelCount:void 0,baseArrayLayer:0,arrayLayerCount:void 0};get[Symbol.toStringTag](){return"TextureView"}constructor(t,r){super(t,r,e.defaultProps)}};function cV(e,t,r){let i="",s=t.split(/\r?\n/),n=e.slice().sort((o,c)=>o.lineNum-c.lineNum);switch(r?.showSourceCode||"no"){case"all":let o=0;for(let c=1;c<=s.length;c++)for(i+=uV(s[c-1],c,r);n.length>o&&n[o].lineNum===c;){let f=n[o++];i+=lV(f,s,f.lineNum,{...r,inlineSource:!1})}return i;case"issues":case"no":for(let c of e)i+=lV(c,s,c.lineNum,{inlineSource:r?.showSourceCode!=="no"});return i}}function lV(e,t,r,i){if(i?.inlineSource){let s=Vht(t,r),n=e.linePos>0?`${" ".repeat(e.linePos+5)}^^^
`:"";return`
${s}${n}${e.type.toUpperCase()}: ${e.message}

`}return i?.html?`<div class='luma-compiler-log-error' style="color:red;"><b> ${e.type.toUpperCase()}: ${e.message}</b></div>`:`${e.type.toUpperCase()}: ${e.message}`}function Vht(e,t,r){let i="";for(let s=t-2;s<=t;s++){let n=e[s-1];n!==void 0&&(i+=uV(n,t,r))}return i}function uV(e,t,r){let i=r?.html?$ht(e):e;return`${jht(String(t),4)}: ${i}${r?.html?"<br/>":`
`}`}function jht(e,t){let r="";for(let i=e.length;i<t;++i)r+=" ";return r+e}function $ht(e){return e.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;")}function lR(e,t){return{name:Hht(e,t),language:"glsl",version:Wht(e)}}function Hht(e,t="unnamed"){let i=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/.exec(e);return i?i[1]:t}function Wht(e){let t=100,r=e.match(/[^\s]+/g);if(r&&r.length>=2&&r[0]==="#version"){let i=parseInt(r[1],10);Number.isFinite(i)&&(t=i)}return t}var bg=class e extends Oi{static defaultProps={...Oi.defaultProps,language:"auto",stage:void 0,source:"",sourceMap:null,entryPoint:"main",debug:"errors"};get[Symbol.toStringTag](){return"Shader"}stage;source;compilationStatus="pending";constructor(t,r){super(t,{id:qht(r),...r},e.defaultProps),this.stage=this.props.stage,this.source=this.props.source}getCompilationInfoSync(){return null}getTranslatedSource(){return null}async debugShader(t=this.props.debug){switch(t){case"never":return;case"errors":if(this.compilationStatus==="success")return;break;case"warnings":case"always":break}let r=await this.getCompilationInfo();this.props.debug==="warnings"&&r?.length===0||this._displayShaderLog(r)}_displayShaderLog(t){if(typeof document>"u"||!document?.createElement)return;let r=lR(this.source).name,i=`${this.stage} ${r}`,s=cV(t,this.source,{showSourceCode:"all",html:!0}),n=this.getTranslatedSource();n&&(s+=`<br /><br /><h1>Translated Source</h1><br /><br /><code style="user-select:text;"><pre>${n}</pre></code>`);let o=document.createElement("Button");o.innerHTML=`
<h1>Shader Compilation Error in ${i}</h1><br /><br />
<code style="user-select:text;"><pre>
${s}
</pre></code>`,o.style.top="10px",o.style.left="10px",o.style.position="absolute",o.style.zIndex="9999",o.style.width="100%",o.style.textAlign="left",document.body.appendChild(o);let c=document.getElementsByClassName("luma-compiler-log-error");c[0]?.scrollIntoView&&c[0].scrollIntoView(),o.onclick=()=>{let f=`data:text/plain,${encodeURIComponent(this.source)}`;navigator.clipboard.writeText(f)}}};function qht(e){return lR(e.source).name||e.id||Dl(`unnamed ${e.stage}-shader`)}var vg=class e extends Oi{static defaultProps={...Oi.defaultProps,type:"color-sampler",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge",addressModeW:"clamp-to-edge",magFilter:"nearest",minFilter:"nearest",mipmapFilter:"nearest",lodMinClamp:0,lodMaxClamp:32,compare:"less-equal",maxAnisotropy:1};get[Symbol.toStringTag](){return"Sampler"}constructor(t,r){super(t,r,e.defaultProps)}};var wg=class e extends Oi{static defaultProps={...Oi.defaultProps,width:1,height:1,colorAttachments:[],depthStencilAttachment:null};get[Symbol.toStringTag](){return"Framebuffer"}width;height;colorAttachments=[];depthStencilAttachment=null;constructor(t,r={}){super(t,r,e.defaultProps),this.width=this.props.width,this.height=this.props.height}resize(t){let r=!t;if(t){let[i,s]=Array.isArray(t)?t:[t.width,t.height];r=r||s!==this.height||i!==this.width,this.width=i,this.height=s}r&&(Ce.log(2,`Resizing framebuffer ${this.id} to ${this.width}x${this.height}`)(),this.resizeAttachments(this.width,this.height))}autoCreateAttachmentTextures(){if(this.props.colorAttachments.length===0&&!this.props.depthStencilAttachment)throw new Error("Framebuffer has noattachments");this.colorAttachments=this.props.colorAttachments.map(r=>{if(typeof r=="string"){let i=this.createColorTexture(r);return this.attachResource(i),i.view}return r instanceof Bo?r.view:r});let t=this.props.depthStencilAttachment;if(t)if(typeof t=="string"){let r=this.createDepthStencilTexture(t);this.attachResource(r),this.depthStencilAttachment=r.view}else t instanceof Bo?this.depthStencilAttachment=t.view:this.depthStencilAttachment=t}createColorTexture(t){return this.device.createTexture({id:"color-attachment",usage:Bo.RENDER_ATTACHMENT,format:t,width:this.width,height:this.height})}createDepthStencilTexture(t){return this.device.createTexture({id:"depth-stencil-attachment",usage:Bo.RENDER_ATTACHMENT,format:t,width:this.width,height:this.height})}resizeAttachments(t,r){for(let i=0;i<this.colorAttachments.length;++i)if(this.colorAttachments[i]){let s=this.device._createTexture({...this.colorAttachments[i].props,width:t,height:r});this.destroyAttachedResource(this.colorAttachments[i]),this.colorAttachments[i]=s.view,this.attachResource(s.view)}if(this.depthStencilAttachment){let i=this.device._createTexture({...this.depthStencilAttachment.props,width:t,height:r});this.destroyAttachedResource(this.depthStencilAttachment),this.depthStencilAttachment=i.view,this.attachResource(i)}}};var Uf=class e extends Oi{static defaultProps={...Oi.defaultProps,vs:null,vertexEntryPoint:"vertexMain",vsConstants:{},fs:null,fragmentEntryPoint:"fragmentMain",fsConstants:{},shaderLayout:null,bufferLayout:[],topology:"triangle-list",parameters:{},bindings:{},uniforms:{}};get[Symbol.toStringTag](){return"RenderPipeline"}shaderLayout;bufferLayout;linkStatus="pending";hash="";constructor(t,r){super(t,r,e.defaultProps),this.shaderLayout=this.props.shaderLayout,this.bufferLayout=this.props.bufferLayout||[]}setUniformsWebGL(t){throw new Error("Use uniform blocks")}};var Yb=class e extends Oi{static defaultProps={...Oi.defaultProps,framebuffer:null,parameters:void 0,clearColor:[0,0,0,0],clearDepth:1,clearStencil:0,depthReadOnly:!1,stencilReadOnly:!1,discard:!1,occlusionQuerySet:void 0,timestampQuerySet:void 0,beginTimestampIndex:void 0,endTimestampIndex:void 0};get[Symbol.toStringTag](){return"RenderPass"}constructor(t,r){super(t,r,e.defaultProps)}};var dy=class e extends Oi{static defaultProps={...Oi.defaultProps,shader:void 0,entryPoint:void 0,constants:{},shaderLayout:void 0};get[Symbol.toStringTag](){return"ComputePipeline"}hash="";constructor(t,r){super(t,r,e.defaultProps)}};var Xb=class e extends Oi{static defaultProps={...Oi.defaultProps,measureExecutionTime:void 0};get[Symbol.toStringTag](){return"CommandEncoder"}constructor(t,r){super(t,r,e.defaultProps)}};var Zb=class e extends Oi{static defaultProps={...Oi.defaultProps};get[Symbol.toStringTag](){return"CommandBuffer"}constructor(t,r){super(t,r,e.defaultProps)}};function hV(e){let[t,r]=Xht[e],i=t==="i32"||t==="u32",s=t!=="u32",n=Zht[t]*r,o=Yht(t,r);return{dataType:t,components:r,defaultVertexFormat:o,byteLength:n,integer:i,signed:s}}function Yht(e,t){let r;switch(e){case"f32":r="float32";break;case"i32":r="sint32";break;case"u32":r="uint32";break;case"f16":return t<=2?"float16x2":"float16x4"}return t===1?r:`${r}x${t}`}var Xht={f32:["f32",1],"vec2<f32>":["f32",2],"vec3<f32>":["f32",3],"vec4<f32>":["f32",4],f16:["f16",1],"vec2<f16>":["f16",2],"vec3<f16>":["f16",3],"vec4<f16>":["f16",4],i32:["i32",1],"vec2<i32>":["i32",2],"vec3<i32>":["i32",3],"vec4<i32>":["i32",4],u32:["u32",1],"vec2<u32>":["u32",2],"vec3<u32>":["u32",3],"vec4<u32>":["u32",4]},Zht={f32:4,f16:2,i32:4,u32:4};function cR(e){let t;e.endsWith("-webgl")&&(e.replace("-webgl",""),t=!0);let[r,i]=e.split("x"),s=r,n=i?parseInt(i):1,o=h5(s),c={type:s,components:n,byteLength:o.byteLength*n,integer:o.integer,signed:o.signed,normalized:o.normalized};return t&&(c.webglOnly=!0),c}function d5(e,t){let r={};for(let i of e.attributes)r[i.name]=Ght(e,t,i.name);return r}function fV(e,t,r=16){let i=d5(e,t),s=new Array(r).fill(null);for(let n of Object.values(i))s[n.location]=n;return s}function Ght(e,t,r){let i=Qht(e,r),s=Kht(t,r);if(!i)return null;let n=hV(i.type),o=s?.vertexFormat||n.defaultVertexFormat,c=cR(o);return{attributeName:s?.attributeName||i.name,bufferName:s?.bufferName||i.name,location:i.location,shaderType:i.type,shaderDataType:n.dataType,shaderComponents:n.components,vertexFormat:o,bufferDataType:c.type,bufferComponents:c.components,normalized:c.normalized,integer:n.integer,stepMode:s?.stepMode||i.stepMode,byteOffset:s?.byteOffset||0,byteStride:s?.byteStride||0}}function Qht(e,t){let r=e.attributes.find(i=>i.name===t);return r||Ce.warn(`shader layout attribute "${t}" not present in shader`),r||null}function Kht(e,t){Jht(e);let r=tft(e,t);return r||(r=eft(e,t),r)?r:(Ce.warn(`layout for attribute "${t}" not present in buffer layout`),null)}function Jht(e){for(let t of e)(t.attributes&&t.format||!t.attributes&&!t.format)&&Ce.warn(`BufferLayout ${name} must have either 'attributes' or 'format' field`)}function tft(e,t){for(let r of e)if(r.format&&r.name===t)return{attributeName:r.name,bufferName:t,stepMode:r.stepMode,vertexFormat:r.format,byteOffset:0,byteStride:r.byteStride||0};return null}function eft(e,t){for(let r of e){let i=r.byteStride;if(typeof r.byteStride!="number")for(let n of r.attributes||[]){let o=cR(n.format);i+=o.byteLength}let s=r.attributes?.find(n=>n.attribute===t);if(s)return{attributeName:s.attribute,bufferName:r.name,stepMode:r.stepMode,vertexFormat:s.format,byteOffset:s.byteOffset,byteStride:i}}return null}function uR(e,t){let r={...e,attributes:e.attributes.map(i=>({...i}))};for(let i of t?.attributes||[]){let s=r.attributes.find(n=>n.name===i.name);s?(s.type=i.type||s.type,s.stepMode=i.stepMode||s.stepMode):Ce.warn(`shader layout attribute ${i.name} not present in shader`)}return r}var Gb=class e extends Oi{static defaultProps={...Oi.defaultProps,renderPipeline:null};get[Symbol.toStringTag](){return"VertexArray"}maxVertexAttributes;attributeInfos;indexBuffer=null;attributes;constructor(t,r){super(t,r,e.defaultProps),this.maxVertexAttributes=t.limits.maxVertexAttributes,this.attributes=new Array(this.maxVertexAttributes).fill(null),this.attributeInfos=fV(r.renderPipeline.shaderLayout,r.renderPipeline.bufferLayout,this.maxVertexAttributes)}setConstantWebGL(t,r){throw new Error("constant attributes not supported")}};var Qb=class e extends Oi{static defaultProps={...Oi.defaultProps,layout:void 0,buffers:{}};get[Symbol.toStringTag](){return"TransformFeedback"}constructor(t,r){super(t,r,e.defaultProps)}};var Kb=class e extends Oi{static defaultProps={...Oi.defaultProps,type:void 0,count:void 0};get[Symbol.toStringTag](){return"QuerySet"}constructor(t,r){super(t,r,e.defaultProps)}};var rft={f32:{type:"f32",components:1},i32:{type:"i32",components:1},u32:{type:"u32",components:1},"vec2<f32>":{type:"f32",components:2},"vec3<f32>":{type:"f32",components:3},"vec4<f32>":{type:"f32",components:4},"vec2<i32>":{type:"i32",components:2},"vec3<i32>":{type:"i32",components:3},"vec4<i32>":{type:"i32",components:4},"vec2<u32>":{type:"u32",components:2},"vec3<u32>":{type:"u32",components:3},"vec4<u32>":{type:"u32",components:4},"mat2x2<f32>":{type:"f32",components:4},"mat2x3<f32>":{type:"f32",components:6},"mat2x4<f32>":{type:"f32",components:8},"mat3x2<f32>":{type:"f32",components:6},"mat3x3<f32>":{type:"f32",components:9},"mat3x4<f32>":{type:"f32",components:12},"mat4x2<f32>":{type:"f32",components:8},"mat4x3<f32>":{type:"f32",components:12},"mat4x4<f32>":{type:"f32",components:16}};function pV(e){let t=rft[e];return Zi(e),t}function dV(e,t){switch(t){case 1:return e;case 2:return e+e%2;default:return e+(4-e%4)%4}}var A5;function m5(e){return(!A5||A5.byteLength<e)&&(A5=new ArrayBuffer(e)),A5}function hR(e,t){let r=m5(e.BYTES_PER_ELEMENT*t);return new e(r,0,t)}function fR(e){let{target:t,source:r,start:i=0,count:s=1}=e,n=r.length,o=s*n,c=0;for(let f=i;c<n;c++)t[f++]=r[c];for(;c<o;)c<o-c?(t.copyWithin(i+c,i,i+c),c*=2):(t.copyWithin(i+c,i,i+o-c),c=o);return e.target}var AV=1024,g5=class{layout={};byteLength;constructor(t){let r=0;for(let[s,n]of Object.entries(t)){let o=pV(n),{type:c,components:f}=o;r=dV(r,f);let p=r;r+=f,this.layout[s]={type:c,size:f,offset:p}}r+=(4-r%4)%4;let i=r*4;this.byteLength=Math.max(i,AV)}getData(t){let r=Math.max(this.byteLength,AV),i=m5(r),s={i32:new Int32Array(i),u32:new Uint32Array(i),f32:new Float32Array(i),f16:new Uint16Array(i)};for(let[n,o]of Object.entries(t)){let c=this.layout[n];if(!c){Ce.warn(`Supplied uniform value ${n} not present in uniform block layout`)();continue}let{type:f,size:p,offset:x}=c,E=s[f];if(p===1){if(typeof o!="number"&&typeof o!="boolean"){Ce.warn(`Supplied value for single component uniform ${n} is not a number: ${o}`)();continue}E[x]=Number(o)}else{let T=cA(o);if(!T){Ce.warn(`Supplied value for multi component / array uniform ${n} is not a numeric array: ${o}`)();continue}E.set(T,x)}}return new Uint8Array(i)}has(t){return!!this.layout[t]}get(t){return this.layout[t]}};function mV(e,t,r=16){if(e!==t)return!1;let i=cA(e);if(!i)return!1;let s=cA(t);if(s&&i.length===s.length){for(let n=0;n<i.length;++n)if(s[n]!==i[n])return!1}return!0}function gV(e){let t=cA(e);return t?t.slice():e}var _5=class{name;uniforms={};modifiedUniforms={};modified=!0;bindingLayout={};needsRedraw="initialized";constructor(t){if(this.name=t?.name,t?.name&&t?.shaderLayout){let r=t?.shaderLayout.bindings?.find(s=>s.type==="uniform"&&s.name===t?.name);if(!r)throw new Error(t?.name);let i=r;for(let s of i.uniforms||[])this.bindingLayout[s.name]=s}}setUniforms(t){for(let[r,i]of Object.entries(t))this._setUniform(r,i),this.needsRedraw||this.setNeedsRedraw(`${this.name}.${r}=${i}`)}setNeedsRedraw(t){this.needsRedraw=this.needsRedraw||t}getAllUniforms(){return this.modifiedUniforms={},this.needsRedraw=!1,this.uniforms||{}}_setUniform(t,r){mV(this.uniforms[t],r)||(this.uniforms[t]=gV(r),this.modifiedUniforms[t]=!0,this.modified=!0)}};var Jb=class{uniformBlocks=new Map;uniformBufferLayouts=new Map;uniformBuffers=new Map;constructor(t){for(let[r,i]of Object.entries(t)){let s=r,n=new g5(i.uniformTypes||{});this.uniformBufferLayouts.set(s,n);let o=new _5({name:r});o.setUniforms(i.defaultUniforms||{}),this.uniformBlocks.set(s,o)}}destroy(){for(let t of this.uniformBuffers.values())t.destroy()}setUniforms(t){for(let[r,i]of Object.entries(t))this.uniformBlocks.get(r).setUniforms(i);this.updateUniformBuffers()}getUniformBufferByteLength(t){return this.uniformBufferLayouts.get(t).byteLength}getUniformBufferData(t){let r=this.uniformBlocks.get(t).getAllUniforms();return this.uniformBufferLayouts.get(t).getData(r)}createUniformBuffer(t,r,i){i&&this.setUniforms(i);let s=this.getUniformBufferByteLength(r),n=t.createBuffer({usage:Tn.UNIFORM|Tn.COPY_DST,byteLength:s}),o=this.getUniformBufferData(r);return n.write(o),n}getManagedUniformBuffer(t,r){if(!this.uniformBuffers.get(r)){let i=this.getUniformBufferByteLength(r),s=t.createBuffer({usage:Tn.UNIFORM|Tn.COPY_DST,byteLength:i});this.uniformBuffers.set(r,s)}return this.uniformBuffers.get(r)}updateUniformBuffers(){let t=!1;for(let r of this.uniformBlocks.keys()){let i=this.updateUniformBuffer(r);t||=i}return t&&Ce.log(3,`UniformStore.updateUniformBuffers(): ${t}`)(),t}updateUniformBuffer(t){let r=this.uniformBlocks.get(t),i=this.uniformBuffers.get(t),s=!1;if(i&&r.needsRedraw){s||=r.needsRedraw;let n=this.getUniformBufferData(t);this.uniformBuffers.get(t).write(n);let c=this.uniformBlocks.get(t).getAllUniforms();Ce.log(4,`Writing to uniform buffer ${String(t)}`,n,c)()}return s}};function y5(e){let t=ArrayBuffer.isView(e)?e.constructor:e;switch(t){case Float32Array:return"float32";case Uint16Array:return"uint16";case Uint32Array:return"uint32";case Uint8Array:case Uint8ClampedArray:return"uint8";case Int8Array:return"sint8";case Int16Array:return"sint16";case Int32Array:return"sint32";default:throw new Error(t.constructor.name)}}function tv(e){switch(e){case"float32":return Float32Array;case"uint32":return Uint32Array;case"sint32":return Int32Array;case"uint16":case"unorm16":return Uint16Array;case"sint16":case"snorm16":return Int16Array;case"uint8":case"unorm8":return Uint8Array;case"sint8":case"snorm8":return Int8Array;default:throw new Error(e)}}function pR(e,t,r){if(!t||t>4)throw new Error(`size ${t}`);let i=t,s=y5(e);if(s==="uint8"||s==="sint8"){if(i===1||i===3)throw new Error(`size: ${t}`);return r&&(s=s.replace("int","norm")),`${s}x${i}`}if(s==="uint16"||s==="sint16"){if(i===1||i===3)throw new Error(`size: ${t}`);return r&&(s=s.replace("int","norm")),`${s}x${i}`}return i===1?s:`${s}x${i}`}function _V(e){return cA(e)!==null||typeof e=="number"||typeof e=="boolean"}function ev(e){let t={bindings:{},uniforms:{}};return Object.keys(e).forEach(r=>{let i=e[r];_V(i)?t.uniforms[r]=i:t.bindings[r]=i}),t}function dR(e,t,r){let{removedProps:i={},deprecatedProps:s={},replacedProps:n={}}=r;for(let c in i)if(c in t){let p=i[c]?`${e}.${i[c]}`:"N/A";Ce.removed(`${e}.${c}`,p)()}for(let c in s)if(c in t){let f=s[c];Ce.deprecated(`${e}.${c}`,`${e}.${f}`)()}let o=null;for(let[c,f]of Object.entries(n))c in t&&(Ce.deprecated(`${e}.${c}`,`${e}.${f}`)(),o=o||Object.assign({},t),o[f]=t[c],delete o[c]);return o||t}var ift="";async function AR(e,t){return await new Promise((r,i)=>{try{let s=new Image;s.onload=()=>r(s),s.onerror=()=>i(new Error(`Could not load image ${e}.`)),s.crossOrigin=t?.crossOrigin||"anonymous",s.src=e.startsWith("http")?e:ift+e}catch(s){i(s)}})}async function rv(e,t){let r=document.getElementsByTagName("head")[0];if(!r)throw new Error("loadScript");let i=document.createElement("script");return i.setAttribute("type","text/javascript"),i.setAttribute("src",e),t&&(i.id=t),new Promise((s,n)=>{i.onload=s,i.onerror=o=>n(new Error(`Unable to load script '${e}': ${o}`)),r.appendChild(i)})}function iv(e,t,r){if(e===t)return!0;if(!r||!e||!t)return!1;if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(!iv(e[i],t[i],r-1))return!1;return!0}if(Array.isArray(t))return!1;if(typeof e=="object"&&typeof t=="object"){let i=Object.keys(e),s=Object.keys(t);if(i.length!==s.length)return!1;for(let n of i)if(!t.hasOwnProperty(n)||!iv(e[n],t[n],r-1))return!1;return!0}return!1}function mR(e){return typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame(e):setTimeout(e,1e3/60)}function gR(e){return typeof window<"u"&&window.cancelAnimationFrame?window.cancelAnimationFrame(e):clearTimeout(e)}var _R=class{constructor(){this.constants=new Map,this.aliases=new Map,this.structs=new Map}},yd=class{constructor(){}get isAstNode(){return!0}get astNodeType(){return""}evaluate(t){throw new Error("Cannot evaluate node")}evaluateString(t){return this.evaluate(t).toString()}},Ls=class extends yd{constructor(){super()}},x5=class extends Ls{constructor(t,r,i,s){super(),this.name=t,this.args=r,this.returnType=i,this.body=s}get astNodeType(){return"function"}},yR=class extends Ls{constructor(t){super(),this.expression=t}get astNodeType(){return"staticAssert"}},xR=class extends Ls{constructor(t,r){super(),this.condition=t,this.body=r}get astNodeType(){return"while"}},bR=class extends Ls{constructor(t){super(),this.body=t}get astNodeType(){return"continuing"}},vR=class extends Ls{constructor(t,r,i,s){super(),this.init=t,this.condition=r,this.increment=i,this.body=s}get astNodeType(){return"for"}},fA=class extends Ls{constructor(t,r,i,s,n){super(),this.name=t,this.type=r,this.storage=i,this.access=s,this.value=n}get astNodeType(){return"var"}},b5=class extends Ls{constructor(t,r,i){super(),this.name=t,this.type=r,this.value=i}get astNodeType(){return"override"}},v5=class extends Ls{constructor(t,r,i,s,n){super(),this.name=t,this.type=r,this.storage=i,this.access=s,this.value=n}get astNodeType(){return"let"}},w5=class extends Ls{constructor(t,r,i,s,n){super(),this.name=t,this.type=r,this.storage=i,this.access=s,this.value=n}get astNodeType(){return"const"}evaluate(t){return this.value.evaluate(t)}},_y;(function(e){e.increment="++",e.decrement="--"})(_y||(_y={}));(function(e){function t(r){let i=r;if(i=="parse")throw new Error("Invalid value for IncrementOperator");return e[i]}e.parse=t})(_y||(_y={}));var wR=class extends Ls{constructor(t,r){super(),this.operator=t,this.variable=r}get astNodeType(){return"increment"}},sv;(function(e){e.assign="=",e.addAssign="+=",e.subtractAssin="-=",e.multiplyAssign="*=",e.divideAssign="/=",e.moduloAssign="%=",e.andAssign="&=",e.orAssign="|=",e.xorAssign="^=",e.shiftLeftAssign="<<=",e.shiftRightAssign=">>="})(sv||(sv={}));(function(e){function t(r){let i=r;if(i=="parse")throw new Error("Invalid value for AssignOperator");return e[i]}e.parse=t})(sv||(sv={}));var TR=class extends Ls{constructor(t,r,i){super(),this.operator=t,this.variable=r,this.value=i}get astNodeType(){return"assign"}},SR=class extends Ls{constructor(t,r){super(),this.name=t,this.args=r}get astNodeType(){return"call"}},ER=class extends Ls{constructor(t,r){super(),this.body=t,this.continuing=r}get astNodeType(){return"loop"}},IR=class extends Ls{constructor(t,r){super(),this.condition=t,this.body=r}get astNodeType(){return"body"}},MR=class extends Ls{constructor(t,r,i,s){super(),this.condition=t,this.body=r,this.elseif=i,this.else=s}get astNodeType(){return"if"}},CR=class extends Ls{constructor(t){super(),this.value=t}get astNodeType(){return"return"}},PR=class extends Ls{constructor(t){super(),this.name=t}get astNodeType(){return"enable"}},T5=class extends Ls{constructor(t,r){super(),this.name=t,this.type=r}get astNodeType(){return"alias"}},RR=class extends Ls{constructor(){super()}get astNodeType(){return"discard"}},kR=class extends Ls{constructor(){super()}get astNodeType(){return"break"}},DR=class extends Ls{constructor(){super()}get astNodeType(){return"continue"}},xd=class extends Ls{constructor(t){super(),this.name=t}get astNodeType(){return"type"}get isStruct(){return!1}get isArray(){return!1}},_d=class extends xd{constructor(t,r){super(t),this.members=r}get astNodeType(){return"struct"}get isStruct(){return!0}getMemberIndex(t){for(let r=0;r<this.members.length;r++)if(this.members[r].name==t)return r;return-1}},S5=class extends xd{constructor(t,r,i){super(t),this.format=r,this.access=i}get astNodeType(){return"template"}},BR=class extends xd{constructor(t,r,i,s){super(t),this.storage=r,this.type=i,this.access=s}get astNodeType(){return"pointer"}},E5=class extends xd{constructor(t,r,i,s){super(t),this.attributes=r,this.format=i,this.count=s}get astNodeType(){return"array"}get isArray(){return!0}},Tg=class extends xd{constructor(t,r,i){super(t),this.format=r,this.access=i}get astNodeType(){return"sampler"}},Ru=class extends yd{constructor(){super()}},I5=class extends Ru{constructor(t){super(),this.value=t}get astNodeType(){return"stringExpr"}toString(){return this.value}evaluateString(){return this.value}},Sg=class extends Ru{constructor(t,r){super(),this.type=t,this.args=r}get astNodeType(){return"createExpr"}},OR=class extends Ru{constructor(t,r){super(),this.name=t,this.args=r}get astNodeType(){return"callExpr"}evaluate(t){switch(this.name){case"abs":return Math.abs(this.args[0].evaluate(t));case"acos":return Math.acos(this.args[0].evaluate(t));case"acosh":return Math.acosh(this.args[0].evaluate(t));case"asin":return Math.asin(this.args[0].evaluate(t));case"asinh":return Math.asinh(this.args[0].evaluate(t));case"atan":return Math.atan(this.args[0].evaluate(t));case"atan2":return Math.atan2(this.args[0].evaluate(t),this.args[1].evaluate(t));case"atanh":return Math.atanh(this.args[0].evaluate(t));case"ceil":return Math.ceil(this.args[0].evaluate(t));case"clamp":return Math.min(Math.max(this.args[0].evaluate(t),this.args[1].evaluate(t)),this.args[2].evaluate(t));case"cos":return Math.cos(this.args[0].evaluate(t));case"degrees":return this.args[0].evaluate(t)*180/Math.PI;case"distance":return Math.sqrt(Math.pow(this.args[0].evaluate(t)-this.args[1].evaluate(t),2));case"dot":case"exp":return Math.exp(this.args[0].evaluate(t));case"exp2":return Math.pow(2,this.args[0].evaluate(t));case"floor":return Math.floor(this.args[0].evaluate(t));case"fma":return this.args[0].evaluate(t)*this.args[1].evaluate(t)+this.args[2].evaluate(t);case"fract":return this.args[0].evaluate(t)-Math.floor(this.args[0].evaluate(t));case"inverseSqrt":return 1/Math.sqrt(this.args[0].evaluate(t));case"log":return Math.log(this.args[0].evaluate(t));case"log2":return Math.log2(this.args[0].evaluate(t));case"max":return Math.max(this.args[0].evaluate(t),this.args[1].evaluate(t));case"min":return Math.min(this.args[0].evaluate(t),this.args[1].evaluate(t));case"mix":return this.args[0].evaluate(t)*(1-this.args[2].evaluate(t))+this.args[1].evaluate(t)*this.args[2].evaluate(t);case"modf":return this.args[0].evaluate(t)-Math.floor(this.args[0].evaluate(t));case"pow":return Math.pow(this.args[0].evaluate(t),this.args[1].evaluate(t));case"radians":return this.args[0].evaluate(t)*Math.PI/180;case"round":return Math.round(this.args[0].evaluate(t));case"sign":return Math.sign(this.args[0].evaluate(t));case"sin":return Math.sin(this.args[0].evaluate(t));case"sinh":return Math.sinh(this.args[0].evaluate(t));case"saturate":return Math.min(Math.max(this.args[0].evaluate(t),0),1);case"smoothstep":return this.args[0].evaluate(t)*this.args[0].evaluate(t)*(3-2*this.args[0].evaluate(t));case"sqrt":return Math.sqrt(this.args[0].evaluate(t));case"step":return this.args[0].evaluate(t)<this.args[1].evaluate(t)?0:1;case"tan":return Math.tan(this.args[0].evaluate(t));case"tanh":return Math.tanh(this.args[0].evaluate(t));case"trunc":return Math.trunc(this.args[0].evaluate(t));default:throw new Error("Non const function: "+this.name)}}},NR=class extends Ru{constructor(t){super(),this.name=t}get astNodeType(){return"varExpr"}},M5=class extends Ru{constructor(t,r){super(),this.name=t,this.initializer=r}get astNodeType(){return"constExpr"}evaluate(t){var r,i;if(this.initializer instanceof Sg){let s=(r=this.postfix)===null||r===void 0?void 0:r.evaluateString(t),n=(i=this.initializer.type)===null||i===void 0?void 0:i.name,o=t.structs.get(n),c=o?.getMemberIndex(s);if(c!=-1)return this.initializer.args[c].evaluate(t);console.log(c)}return this.initializer.evaluate(t)}},C5=class extends Ru{constructor(t){super(),this.value=t}get astNodeType(){return"literalExpr"}evaluate(){return this.value}},FR=class extends Ru{constructor(t,r){super(),this.type=t,this.value=r}get astNodeType(){return"bitcastExpr"}},LR=class extends Ru{constructor(t,r){super(),this.type=t,this.args=r}get astNodeType(){return"typecastExpr"}evaluate(t){return this.args[0].evaluate(t)}},P5=class extends Ru{constructor(t){super(),this.contents=t}get astNodeType(){return"groupExpr"}evaluate(t){return this.contents[0].evaluate(t)}},R5=class extends Ru{constructor(){super()}},zR=class extends R5{constructor(t,r){super(),this.operator=t,this.right=r}get astNodeType(){return"unaryOp"}evaluate(t){switch(this.operator){case"+":return this.right.evaluate(t);case"-":return-this.right.evaluate(t);case"!":return this.right.evaluate(t)?0:1;case"~":return~this.right.evaluate(t);default:throw new Error("Unknown unary operator: "+this.operator)}}},Pu=class extends R5{constructor(t,r,i){super(),this.operator=t,this.left=r,this.right=i}get astNodeType(){return"binaryOp"}evaluate(t){switch(this.operator){case"+":return this.left.evaluate(t)+this.right.evaluate(t);case"-":return this.left.evaluate(t)-this.right.evaluate(t);case"*":return this.left.evaluate(t)*this.right.evaluate(t);case"/":return this.left.evaluate(t)/this.right.evaluate(t);case"%":return this.left.evaluate(t)%this.right.evaluate(t);case"==":return this.left.evaluate(t)==this.right.evaluate(t)?1:0;case"!=":return this.left.evaluate(t)!=this.right.evaluate(t)?1:0;case"<":return this.left.evaluate(t)<this.right.evaluate(t)?1:0;case">":return this.left.evaluate(t)>this.right.evaluate(t)?1:0;case"<=":return this.left.evaluate(t)<=this.right.evaluate(t)?1:0;case">=":return this.left.evaluate(t)>=this.right.evaluate(t)?1:0;case"&&":return this.left.evaluate(t)&&this.right.evaluate(t)?1:0;case"||":return this.left.evaluate(t)||this.right.evaluate(t)?1:0;default:throw new Error(`Unknown operator ${this.operator}`)}}},k5=class extends yd{constructor(){super()}},UR=class extends k5{constructor(t,r){super(),this.selector=t,this.body=r}get astNodeType(){return"case"}},VR=class extends k5{constructor(t){super(),this.body=t}get astNodeType(){return"default"}},jR=class extends yd{constructor(t,r,i){super(),this.name=t,this.type=r,this.attributes=i}get astNodeType(){return"argument"}},$R=class extends yd{constructor(t,r){super(),this.condition=t,this.body=r}get astNodeType(){return"elseif"}},HR=class extends yd{constructor(t,r,i){super(),this.name=t,this.type=r,this.attributes=i}get astNodeType(){return"member"}},D5=class extends yd{constructor(t,r){super(),this.name=t,this.value=r}get astNodeType(){return"attribute"}},Me,ee;(function(e){e[e.token=0]="token",e[e.keyword=1]="keyword",e[e.reserved=2]="reserved"})(ee||(ee={}));var te=class{constructor(t,r,i){this.name=t,this.type=r,this.rule=i}toString(){return this.name}},Pt=class{};Me=Pt;Pt.none=new te("",ee.reserved,"");Pt.eof=new te("EOF",ee.token,"");Pt.reserved={asm:new te("asm",ee.reserved,"asm"),bf16:new te("bf16",ee.reserved,"bf16"),do:new te("do",ee.reserved,"do"),enum:new te("enum",ee.reserved,"enum"),f16:new te("f16",ee.reserved,"f16"),f64:new te("f64",ee.reserved,"f64"),handle:new te("handle",ee.reserved,"handle"),i8:new te("i8",ee.reserved,"i8"),i16:new te("i16",ee.reserved,"i16"),i64:new te("i64",ee.reserved,"i64"),mat:new te("mat",ee.reserved,"mat"),premerge:new te("premerge",ee.reserved,"premerge"),regardless:new te("regardless",ee.reserved,"regardless"),typedef:new te("typedef",ee.reserved,"typedef"),u8:new te("u8",ee.reserved,"u8"),u16:new te("u16",ee.reserved,"u16"),u64:new te("u64",ee.reserved,"u64"),unless:new te("unless",ee.reserved,"unless"),using:new te("using",ee.reserved,"using"),vec:new te("vec",ee.reserved,"vec"),void:new te("void",ee.reserved,"void")};Pt.keywords={array:new te("array",ee.keyword,"array"),atomic:new te("atomic",ee.keyword,"atomic"),bool:new te("bool",ee.keyword,"bool"),f32:new te("f32",ee.keyword,"f32"),i32:new te("i32",ee.keyword,"i32"),mat2x2:new te("mat2x2",ee.keyword,"mat2x2"),mat2x3:new te("mat2x3",ee.keyword,"mat2x3"),mat2x4:new te("mat2x4",ee.keyword,"mat2x4"),mat3x2:new te("mat3x2",ee.keyword,"mat3x2"),mat3x3:new te("mat3x3",ee.keyword,"mat3x3"),mat3x4:new te("mat3x4",ee.keyword,"mat3x4"),mat4x2:new te("mat4x2",ee.keyword,"mat4x2"),mat4x3:new te("mat4x3",ee.keyword,"mat4x3"),mat4x4:new te("mat4x4",ee.keyword,"mat4x4"),ptr:new te("ptr",ee.keyword,"ptr"),sampler:new te("sampler",ee.keyword,"sampler"),sampler_comparison:new te("sampler_comparison",ee.keyword,"sampler_comparison"),struct:new te("struct",ee.keyword,"struct"),texture_1d:new te("texture_1d",ee.keyword,"texture_1d"),texture_2d:new te("texture_2d",ee.keyword,"texture_2d"),texture_2d_array:new te("texture_2d_array",ee.keyword,"texture_2d_array"),texture_3d:new te("texture_3d",ee.keyword,"texture_3d"),texture_cube:new te("texture_cube",ee.keyword,"texture_cube"),texture_cube_array:new te("texture_cube_array",ee.keyword,"texture_cube_array"),texture_multisampled_2d:new te("texture_multisampled_2d",ee.keyword,"texture_multisampled_2d"),texture_storage_1d:new te("texture_storage_1d",ee.keyword,"texture_storage_1d"),texture_storage_2d:new te("texture_storage_2d",ee.keyword,"texture_storage_2d"),texture_storage_2d_array:new te("texture_storage_2d_array",ee.keyword,"texture_storage_2d_array"),texture_storage_3d:new te("texture_storage_3d",ee.keyword,"texture_storage_3d"),texture_depth_2d:new te("texture_depth_2d",ee.keyword,"texture_depth_2d"),texture_depth_2d_array:new te("texture_depth_2d_array",ee.keyword,"texture_depth_2d_array"),texture_depth_cube:new te("texture_depth_cube",ee.keyword,"texture_depth_cube"),texture_depth_cube_array:new te("texture_depth_cube_array",ee.keyword,"texture_depth_cube_array"),texture_depth_multisampled_2d:new te("texture_depth_multisampled_2d",ee.keyword,"texture_depth_multisampled_2d"),texture_external:new te("texture_external",ee.keyword,"texture_external"),u32:new te("u32",ee.keyword,"u32"),vec2:new te("vec2",ee.keyword,"vec2"),vec3:new te("vec3",ee.keyword,"vec3"),vec4:new te("vec4",ee.keyword,"vec4"),bitcast:new te("bitcast",ee.keyword,"bitcast"),block:new te("block",ee.keyword,"block"),break:new te("break",ee.keyword,"break"),case:new te("case",ee.keyword,"case"),continue:new te("continue",ee.keyword,"continue"),continuing:new te("continuing",ee.keyword,"continuing"),default:new te("default",ee.keyword,"default"),discard:new te("discard",ee.keyword,"discard"),else:new te("else",ee.keyword,"else"),enable:new te("enable",ee.keyword,"enable"),fallthrough:new te("fallthrough",ee.keyword,"fallthrough"),false:new te("false",ee.keyword,"false"),fn:new te("fn",ee.keyword,"fn"),for:new te("for",ee.keyword,"for"),function:new te("function",ee.keyword,"function"),if:new te("if",ee.keyword,"if"),let:new te("let",ee.keyword,"let"),const:new te("const",ee.keyword,"const"),loop:new te("loop",ee.keyword,"loop"),while:new te("while",ee.keyword,"while"),private:new te("private",ee.keyword,"private"),read:new te("read",ee.keyword,"read"),read_write:new te("read_write",ee.keyword,"read_write"),return:new te("return",ee.keyword,"return"),storage:new te("storage",ee.keyword,"storage"),switch:new te("switch",ee.keyword,"switch"),true:new te("true",ee.keyword,"true"),alias:new te("alias",ee.keyword,"alias"),type:new te("type",ee.keyword,"type"),uniform:new te("uniform",ee.keyword,"uniform"),var:new te("var",ee.keyword,"var"),override:new te("override",ee.keyword,"override"),workgroup:new te("workgroup",ee.keyword,"workgroup"),write:new te("write",ee.keyword,"write"),r8unorm:new te("r8unorm",ee.keyword,"r8unorm"),r8snorm:new te("r8snorm",ee.keyword,"r8snorm"),r8uint:new te("r8uint",ee.keyword,"r8uint"),r8sint:new te("r8sint",ee.keyword,"r8sint"),r16uint:new te("r16uint",ee.keyword,"r16uint"),r16sint:new te("r16sint",ee.keyword,"r16sint"),r16float:new te("r16float",ee.keyword,"r16float"),rg8unorm:new te("rg8unorm",ee.keyword,"rg8unorm"),rg8snorm:new te("rg8snorm",ee.keyword,"rg8snorm"),rg8uint:new te("rg8uint",ee.keyword,"rg8uint"),rg8sint:new te("rg8sint",ee.keyword,"rg8sint"),r32uint:new te("r32uint",ee.keyword,"r32uint"),r32sint:new te("r32sint",ee.keyword,"r32sint"),r32float:new te("r32float",ee.keyword,"r32float"),rg16uint:new te("rg16uint",ee.keyword,"rg16uint"),rg16sint:new te("rg16sint",ee.keyword,"rg16sint"),rg16float:new te("rg16float",ee.keyword,"rg16float"),rgba8unorm:new te("rgba8unorm",ee.keyword,"rgba8unorm"),rgba8unorm_srgb:new te("rgba8unorm_srgb",ee.keyword,"rgba8unorm_srgb"),rgba8snorm:new te("rgba8snorm",ee.keyword,"rgba8snorm"),rgba8uint:new te("rgba8uint",ee.keyword,"rgba8uint"),rgba8sint:new te("rgba8sint",ee.keyword,"rgba8sint"),bgra8unorm:new te("bgra8unorm",ee.keyword,"bgra8unorm"),bgra8unorm_srgb:new te("bgra8unorm_srgb",ee.keyword,"bgra8unorm_srgb"),rgb10a2unorm:new te("rgb10a2unorm",ee.keyword,"rgb10a2unorm"),rg11b10float:new te("rg11b10float",ee.keyword,"rg11b10float"),rg32uint:new te("rg32uint",ee.keyword,"rg32uint"),rg32sint:new te("rg32sint",ee.keyword,"rg32sint"),rg32float:new te("rg32float",ee.keyword,"rg32float"),rgba16uint:new te("rgba16uint",ee.keyword,"rgba16uint"),rgba16sint:new te("rgba16sint",ee.keyword,"rgba16sint"),rgba16float:new te("rgba16float",ee.keyword,"rgba16float"),rgba32uint:new te("rgba32uint",ee.keyword,"rgba32uint"),rgba32sint:new te("rgba32sint",ee.keyword,"rgba32sint"),rgba32float:new te("rgba32float",ee.keyword,"rgba32float"),static_assert:new te("static_assert",ee.keyword,"static_assert")};Pt.tokens={decimal_float_literal:new te("decimal_float_literal",ee.token,/((-?[0-9]*\.[0-9]+|-?[0-9]+\.[0-9]*)((e|E)(\+|-)?[0-9]+)?f?)|(-?[0-9]+(e|E)(\+|-)?[0-9]+f?)|([0-9]+f)/),hex_float_literal:new te("hex_float_literal",ee.token,/-?0x((([0-9a-fA-F]*\.[0-9a-fA-F]+|[0-9a-fA-F]+\.[0-9a-fA-F]*)((p|P)(\+|-)?[0-9]+f?)?)|([0-9a-fA-F]+(p|P)(\+|-)?[0-9]+f?))/),int_literal:new te("int_literal",ee.token,/-?0x[0-9a-fA-F]+|0i?|-?[1-9][0-9]*i?/),uint_literal:new te("uint_literal",ee.token,/0x[0-9a-fA-F]+u|0u|[1-9][0-9]*u/),ident:new te("ident",ee.token,/[a-zA-Z][0-9a-zA-Z_]*/),and:new te("and",ee.token,"&"),and_and:new te("and_and",ee.token,"&&"),arrow:new te("arrow ",ee.token,"->"),attr:new te("attr",ee.token,"@"),attr_left:new te("attr_left",ee.token,"[["),attr_right:new te("attr_right",ee.token,"]]"),forward_slash:new te("forward_slash",ee.token,"/"),bang:new te("bang",ee.token,"!"),bracket_left:new te("bracket_left",ee.token,"["),bracket_right:new te("bracket_right",ee.token,"]"),brace_left:new te("brace_left",ee.token,"{"),brace_right:new te("brace_right",ee.token,"}"),colon:new te("colon",ee.token,":"),comma:new te("comma",ee.token,","),equal:new te("equal",ee.token,"="),equal_equal:new te("equal_equal",ee.token,"=="),not_equal:new te("not_equal",ee.token,"!="),greater_than:new te("greater_than",ee.token,">"),greater_than_equal:new te("greater_than_equal",ee.token,">="),shift_right:new te("shift_right",ee.token,">>"),less_than:new te("less_than",ee.token,"<"),less_than_equal:new te("less_than_equal",ee.token,"<="),shift_left:new te("shift_left",ee.token,"<<"),modulo:new te("modulo",ee.token,"%"),minus:new te("minus",ee.token,"-"),minus_minus:new te("minus_minus",ee.token,"--"),period:new te("period",ee.token,"."),plus:new te("plus",ee.token,"+"),plus_plus:new te("plus_plus",ee.token,"++"),or:new te("or",ee.token,"|"),or_or:new te("or_or",ee.token,"||"),paren_left:new te("paren_left",ee.token,"("),paren_right:new te("paren_right",ee.token,")"),semicolon:new te("semicolon",ee.token,";"),star:new te("star",ee.token,"*"),tilde:new te("tilde",ee.token,"~"),underscore:new te("underscore",ee.token,"_"),xor:new te("xor",ee.token,"^"),plus_equal:new te("plus_equal",ee.token,"+="),minus_equal:new te("minus_equal",ee.token,"-="),times_equal:new te("times_equal",ee.token,"*="),division_equal:new te("division_equal",ee.token,"/="),modulo_equal:new te("modulo_equal",ee.token,"%="),and_equal:new te("and_equal",ee.token,"&="),or_equal:new te("or_equal",ee.token,"|="),xor_equal:new te("xor_equal",ee.token,"^="),shift_right_equal:new te("shift_right_equal",ee.token,">>="),shift_left_equal:new te("shift_left_equal",ee.token,"<<=")};Pt.storage_class=[Me.keywords.function,Me.keywords.private,Me.keywords.workgroup,Me.keywords.uniform,Me.keywords.storage];Pt.access_mode=[Me.keywords.read,Me.keywords.write,Me.keywords.read_write];Pt.sampler_type=[Me.keywords.sampler,Me.keywords.sampler_comparison];Pt.sampled_texture_type=[Me.keywords.texture_1d,Me.keywords.texture_2d,Me.keywords.texture_2d_array,Me.keywords.texture_3d,Me.keywords.texture_cube,Me.keywords.texture_cube_array];Pt.multisampled_texture_type=[Me.keywords.texture_multisampled_2d];Pt.storage_texture_type=[Me.keywords.texture_storage_1d,Me.keywords.texture_storage_2d,Me.keywords.texture_storage_2d_array,Me.keywords.texture_storage_3d];Pt.depth_texture_type=[Me.keywords.texture_depth_2d,Me.keywords.texture_depth_2d_array,Me.keywords.texture_depth_cube,Me.keywords.texture_depth_cube_array,Me.keywords.texture_depth_multisampled_2d];Pt.texture_external_type=[Me.keywords.texture_external];Pt.any_texture_type=[...Me.sampled_texture_type,...Me.multisampled_texture_type,...Me.storage_texture_type,...Me.depth_texture_type,...Me.texture_external_type];Pt.texel_format=[Me.keywords.r8unorm,Me.keywords.r8snorm,Me.keywords.r8uint,Me.keywords.r8sint,Me.keywords.r16uint,Me.keywords.r16sint,Me.keywords.r16float,Me.keywords.rg8unorm,Me.keywords.rg8snorm,Me.keywords.rg8uint,Me.keywords.rg8sint,Me.keywords.r32uint,Me.keywords.r32sint,Me.keywords.r32float,Me.keywords.rg16uint,Me.keywords.rg16sint,Me.keywords.rg16float,Me.keywords.rgba8unorm,Me.keywords.rgba8unorm_srgb,Me.keywords.rgba8snorm,Me.keywords.rgba8uint,Me.keywords.rgba8sint,Me.keywords.bgra8unorm,Me.keywords.bgra8unorm_srgb,Me.keywords.rgb10a2unorm,Me.keywords.rg11b10float,Me.keywords.rg32uint,Me.keywords.rg32sint,Me.keywords.rg32float,Me.keywords.rgba16uint,Me.keywords.rgba16sint,Me.keywords.rgba16float,Me.keywords.rgba32uint,Me.keywords.rgba32sint,Me.keywords.rgba32float];Pt.const_literal=[Me.tokens.int_literal,Me.tokens.uint_literal,Me.tokens.decimal_float_literal,Me.tokens.hex_float_literal,Me.keywords.true,Me.keywords.false];Pt.literal_or_ident=[Me.tokens.ident,Me.tokens.int_literal,Me.tokens.uint_literal,Me.tokens.decimal_float_literal,Me.tokens.hex_float_literal];Pt.element_count_expression=[Me.tokens.int_literal,Me.tokens.uint_literal,Me.tokens.ident];Pt.template_types=[Me.keywords.vec2,Me.keywords.vec3,Me.keywords.vec4,Me.keywords.mat2x2,Me.keywords.mat2x3,Me.keywords.mat2x4,Me.keywords.mat3x2,Me.keywords.mat3x3,Me.keywords.mat3x4,Me.keywords.mat4x2,Me.keywords.mat4x3,Me.keywords.mat4x4,Me.keywords.atomic,Me.keywords.bitcast,...Me.any_texture_type];Pt.attribute_name=[Me.tokens.ident,Me.keywords.block];Pt.assignment_operators=[Me.tokens.equal,Me.tokens.plus_equal,Me.tokens.minus_equal,Me.tokens.times_equal,Me.tokens.division_equal,Me.tokens.modulo_equal,Me.tokens.and_equal,Me.tokens.or_equal,Me.tokens.xor_equal,Me.tokens.shift_right_equal,Me.tokens.shift_left_equal];Pt.increment_operators=[Me.tokens.plus_plus,Me.tokens.minus_minus];var B5=class{constructor(t,r,i){this.type=t,this.lexeme=r,this.line=i}toString(){return this.lexeme}isTemplateType(){return Pt.template_types.indexOf(this.type)!=-1}isArrayType(){return this.type==Pt.keywords.array}isArrayOrTemplateType(){return this.isArrayType()||this.isTemplateType()}},WR=class{constructor(t){this._tokens=[],this._start=0,this._current=0,this._line=1,this._source=t??""}scanTokens(){for(;!this._isAtEnd();)if(this._start=this._current,!this.scanToken())throw`Invalid syntax at line ${this._line}`;return this._tokens.push(new B5(Pt.eof,"",this._line)),this._tokens}scanToken(){let t=this._advance();if(t==`
`)return this._line++,!0;if(this._isWhitespace(t))return!0;if(t=="/"){if(this._peekAhead()=="/"){for(;t!=`
`;){if(this._isAtEnd())return!0;t=this._advance()}return this._line++,!0}else if(this._peekAhead()=="*"){this._advance();let i=1;for(;i>0;){if(this._isAtEnd())return!0;if(t=this._advance(),t==`
`)this._line++;else if(t=="*"){if(this._peekAhead()=="/"&&(this._advance(),i--,i==0))return!0}else t=="/"&&this._peekAhead()=="*"&&(this._advance(),i++)}return!0}}let r=Pt.none;for(;;){let i=this._findType(t),s=this._peekAhead();if(t==">"&&(s==">"||s=="=")){let n=!1,o=this._tokens.length-1;for(let c=0;c<5&&o>=0;++c,--o)if(this._tokens[o].type===Pt.tokens.less_than){o>0&&this._tokens[o-1].isArrayOrTemplateType()&&(n=!0);break}if(n)return this._addToken(i),!0}if(i===Pt.none){let n=t,o=0,c=2;for(let f=0;f<c;++f)if(n+=this._peekAhead(f),i=this._findType(n),i!==Pt.none){o=f;break}if(i===Pt.none)return r===Pt.none?!1:(this._current--,this._addToken(r),!0);t=n,this._current+=o+1}if(r=i,this._isAtEnd())break;t+=this._advance()}return r===Pt.none?!1:(this._addToken(r),!0)}_findType(t){for(let r in Pt.keywords){let i=Pt.keywords[r];if(this._match(t,i.rule))return i}for(let r in Pt.tokens){let i=Pt.tokens[r];if(this._match(t,i.rule))return i}return Pt.none}_match(t,r){if(typeof r=="string"){if(r==t)return!0}else{let i=r.exec(t);if(i&&i.index==0&&i[0]==t)return!0}return!1}_isAtEnd(){return this._current>=this._source.length}_isWhitespace(t){return t==" "||t=="	"||t=="\r"}_advance(t=0){let r=this._source[this._current];return t=t||0,t++,this._current+=t,r}_peekAhead(t=0){return t=t||0,this._current+t>=this._source.length?"\0":this._source[this._current+t]}_addToken(t){let r=this._source.substring(this._start,this._current);this._tokens.push(new B5(t,r,this._line))}},qR=class{constructor(){this._tokens=[],this._current=0,this._context=new _R}parse(t){this._initialize(t);let r=[];for(;!this._isAtEnd();){let i=this._global_decl_or_directive();if(!i)break;r.push(i)}return r}_initialize(t){if(t)if(typeof t=="string"){let r=new WR(t);this._tokens=r.scanTokens()}else this._tokens=t;else this._tokens=[];this._current=0}_error(t,r){return console.error(t,r),{token:t,message:r,toString:function(){return`${r}`}}}_isAtEnd(){return this._current>=this._tokens.length||this._peek().type==Pt.eof}_match(t){if(t instanceof te)return this._check(t)?(this._advance(),!0):!1;for(let r=0,i=t.length;r<i;++r){let s=t[r];if(this._check(s))return this._advance(),!0}return!1}_consume(t,r){if(this._check(t))return this._advance();throw this._error(this._peek(),r)}_check(t){if(this._isAtEnd())return!1;let r=this._peek();if(t instanceof Array){let i=r.type;return t.indexOf(i)!=-1}return r.type==t}_advance(){return this._isAtEnd()||this._current++,this._previous()}_peek(){return this._tokens[this._current]}_previous(){return this._tokens[this._current-1]}_global_decl_or_directive(){for(;this._match(Pt.tokens.semicolon)&&!this._isAtEnd(););if(this._match(Pt.keywords.alias)){let r=this._type_alias();return this._consume(Pt.tokens.semicolon,"Expected ';'"),r}if(this._match(Pt.keywords.enable)){let r=this._enable_directive();return this._consume(Pt.tokens.semicolon,"Expected ';'"),r}let t=this._attribute();if(this._check(Pt.keywords.var)){let r=this._global_variable_decl();return r!=null&&(r.attributes=t),this._consume(Pt.tokens.semicolon,"Expected ';'."),r}if(this._check(Pt.keywords.override)){let r=this._override_variable_decl();return r!=null&&(r.attributes=t),this._consume(Pt.tokens.semicolon,"Expected ';'."),r}if(this._check(Pt.keywords.let)){let r=this._global_let_decl();return r!=null&&(r.attributes=t),this._consume(Pt.tokens.semicolon,"Expected ';'."),r}if(this._check(Pt.keywords.const)){let r=this._global_const_decl();return r!=null&&(r.attributes=t),this._consume(Pt.tokens.semicolon,"Expected ';'."),r}if(this._check(Pt.keywords.struct)){let r=this._struct_decl();return r!=null&&(r.attributes=t),r}if(this._check(Pt.keywords.fn)){let r=this._function_decl();return r!=null&&(r.attributes=t),r}return null}_function_decl(){if(!this._match(Pt.keywords.fn))return null;let t=this._consume(Pt.tokens.ident,"Expected function name.").toString();this._consume(Pt.tokens.paren_left,"Expected '(' for function arguments.");let r=[];if(!this._check(Pt.tokens.paren_right))do{if(this._check(Pt.tokens.paren_right))break;let n=this._attribute(),o=this._consume(Pt.tokens.ident,"Expected argument name.").toString();this._consume(Pt.tokens.colon,"Expected ':' for argument type.");let c=this._attribute(),f=this._type_decl();f!=null&&(f.attributes=c,r.push(new jR(o,f,n)))}while(this._match(Pt.tokens.comma));this._consume(Pt.tokens.paren_right,"Expected ')' after function arguments.");let i=null;if(this._match(Pt.tokens.arrow)){let n=this._attribute();i=this._type_decl(),i!=null&&(i.attributes=n)}let s=this._compound_statement();return new x5(t,r,i,s)}_compound_statement(){let t=[];for(this._consume(Pt.tokens.brace_left,"Expected '{' for block.");!this._check(Pt.tokens.brace_right);){let r=this._statement();r!==null&&t.push(r)}return this._consume(Pt.tokens.brace_right,"Expected '}' for block."),t}_statement(){for(;this._match(Pt.tokens.semicolon)&&!this._isAtEnd(););if(this._check(Pt.keywords.if))return this._if_statement();if(this._check(Pt.keywords.switch))return this._switch_statement();if(this._check(Pt.keywords.loop))return this._loop_statement();if(this._check(Pt.keywords.for))return this._for_statement();if(this._check(Pt.keywords.while))return this._while_statement();if(this._check(Pt.keywords.continuing))return this._continuing_statement();if(this._check(Pt.keywords.static_assert))return this._static_assert_statement();if(this._check(Pt.tokens.brace_left))return this._compound_statement();let t=null;return this._check(Pt.keywords.return)?t=this._return_statement():this._check([Pt.keywords.var,Pt.keywords.let,Pt.keywords.const])?t=this._variable_statement():this._match(Pt.keywords.discard)?t=new RR:this._match(Pt.keywords.break)?t=new kR:this._match(Pt.keywords.continue)?t=new DR:t=this._increment_decrement_statement()||this._func_call_statement()||this._assignment_statement(),t!=null&&this._consume(Pt.tokens.semicolon,"Expected ';' after statement."),t}_static_assert_statement(){if(!this._match(Pt.keywords.static_assert))return null;let t=this._optional_paren_expression();return new yR(t)}_while_statement(){if(!this._match(Pt.keywords.while))return null;let t=this._optional_paren_expression(),r=this._compound_statement();return new xR(t,r)}_continuing_statement(){if(!this._match(Pt.keywords.continuing))return null;let t=this._compound_statement();return new bR(t)}_for_statement(){if(!this._match(Pt.keywords.for))return null;this._consume(Pt.tokens.paren_left,"Expected '('.");let t=this._check(Pt.tokens.semicolon)?null:this._for_init();this._consume(Pt.tokens.semicolon,"Expected ';'.");let r=this._check(Pt.tokens.semicolon)?null:this._short_circuit_or_expression();this._consume(Pt.tokens.semicolon,"Expected ';'.");let i=this._check(Pt.tokens.paren_right)?null:this._for_increment();this._consume(Pt.tokens.paren_right,"Expected ')'.");let s=this._compound_statement();return new vR(t,r,i,s)}_for_init(){return this._variable_statement()||this._func_call_statement()||this._assignment_statement()}_for_increment(){return this._func_call_statement()||this._increment_decrement_statement()||this._assignment_statement()}_variable_statement(){if(this._check(Pt.keywords.var)){let t=this._variable_decl();if(t===null)throw this._error(this._peek(),"Variable declaration expected.");let r=null;return this._match(Pt.tokens.equal)&&(r=this._short_circuit_or_expression()),new fA(t.name,t.type,t.storage,t.access,r)}if(this._match(Pt.keywords.let)){let t=this._consume(Pt.tokens.ident,"Expected name for let.").toString(),r=null;if(this._match(Pt.tokens.colon)){let s=this._attribute();r=this._type_decl(),r!=null&&(r.attributes=s)}this._consume(Pt.tokens.equal,"Expected '=' for let.");let i=this._short_circuit_or_expression();return new v5(t,r,null,null,i)}if(this._match(Pt.keywords.const)){let t=this._consume(Pt.tokens.ident,"Expected name for const.").toString(),r=null;if(this._match(Pt.tokens.colon)){let s=this._attribute();r=this._type_decl(),r!=null&&(r.attributes=s)}this._consume(Pt.tokens.equal,"Expected '=' for const.");let i=this._short_circuit_or_expression();return new w5(t,r,null,null,i)}return null}_increment_decrement_statement(){let t=this._current,r=this._unary_expression();if(r==null)return null;if(!this._check(Pt.increment_operators))return this._current=t,null;let i=this._consume(Pt.increment_operators,"Expected increment operator");return new wR(i.type===Pt.tokens.plus_plus?_y.increment:_y.decrement,r)}_assignment_statement(){let t=null;if(this._check(Pt.tokens.brace_right))return null;let r=this._match(Pt.tokens.underscore);if(r||(t=this._unary_expression()),!r&&t==null)return null;let i=this._consume(Pt.assignment_operators,"Expected assignment operator."),s=this._short_circuit_or_expression();return new TR(sv.parse(i.lexeme),t,s)}_func_call_statement(){if(!this._check(Pt.tokens.ident))return null;let t=this._current,r=this._consume(Pt.tokens.ident,"Expected function name."),i=this._argument_expression_list();return i===null?(this._current=t,null):new SR(r.lexeme,i)}_loop_statement(){if(!this._match(Pt.keywords.loop))return null;this._consume(Pt.tokens.brace_left,"Expected '{' for loop.");let t=[],r=this._statement();for(;r!==null;){if(Array.isArray(r))for(let s of r)t.push(s);else t.push(r);r=this._statement()}let i=null;return this._match(Pt.keywords.continuing)&&(i=this._compound_statement()),this._consume(Pt.tokens.brace_right,"Expected '}' for loop."),new ER(t,i)}_switch_statement(){if(!this._match(Pt.keywords.switch))return null;let t=this._optional_paren_expression();this._consume(Pt.tokens.brace_left,"Expected '{' for switch.");let r=this._switch_body();if(r==null||r.length==0)throw this._error(this._previous(),"Expected 'case' or 'default'.");return this._consume(Pt.tokens.brace_right,"Expected '}' for switch."),new IR(t,r)}_switch_body(){let t=[];if(this._match(Pt.keywords.case)){let r=this._case_selectors();this._match(Pt.tokens.colon),this._consume(Pt.tokens.brace_left,"Exected '{' for switch case.");let i=this._case_body();this._consume(Pt.tokens.brace_right,"Exected '}' for switch case."),t.push(new UR(r,i))}if(this._match(Pt.keywords.default)){this._match(Pt.tokens.colon),this._consume(Pt.tokens.brace_left,"Exected '{' for switch default.");let r=this._case_body();this._consume(Pt.tokens.brace_right,"Exected '}' for switch default."),t.push(new VR(r))}if(this._check([Pt.keywords.default,Pt.keywords.case])){let r=this._switch_body();t.push(r[0])}return t}_case_selectors(){var t,r,i,s;let n=[(r=(t=this._shift_expression())===null||t===void 0?void 0:t.evaluate(this._context).toString())!==null&&r!==void 0?r:""];for(;this._match(Pt.tokens.comma);)n.push((s=(i=this._shift_expression())===null||i===void 0?void 0:i.evaluate(this._context).toString())!==null&&s!==void 0?s:"");return n}_case_body(){if(this._match(Pt.keywords.fallthrough))return this._consume(Pt.tokens.semicolon,"Expected ';'"),[];let t=this._statement();if(t==null)return[];t instanceof Array||(t=[t]);let r=this._case_body();return r.length==0?t:[...t,r[0]]}_if_statement(){if(!this._match(Pt.keywords.if))return null;let t=this._optional_paren_expression(),r=this._compound_statement(),i=[];this._match_elseif()&&(i=this._elseif_statement(i));let s=null;return this._match(Pt.keywords.else)&&(s=this._compound_statement()),new MR(t,r,i,s)}_match_elseif(){return this._tokens[this._current].type===Pt.keywords.else&&this._tokens[this._current+1].type===Pt.keywords.if?(this._advance(),this._advance(),!0):!1}_elseif_statement(t=[]){let r=this._optional_paren_expression(),i=this._compound_statement();return t.push(new $R(r,i)),this._match_elseif()&&this._elseif_statement(t),t}_return_statement(){if(!this._match(Pt.keywords.return))return null;let t=this._short_circuit_or_expression();return new CR(t)}_short_circuit_or_expression(){let t=this._short_circuit_and_expr();for(;this._match(Pt.tokens.or_or);)t=new Pu(this._previous().toString(),t,this._short_circuit_and_expr());return t}_short_circuit_and_expr(){let t=this._inclusive_or_expression();for(;this._match(Pt.tokens.and_and);)t=new Pu(this._previous().toString(),t,this._inclusive_or_expression());return t}_inclusive_or_expression(){let t=this._exclusive_or_expression();for(;this._match(Pt.tokens.or);)t=new Pu(this._previous().toString(),t,this._exclusive_or_expression());return t}_exclusive_or_expression(){let t=this._and_expression();for(;this._match(Pt.tokens.xor);)t=new Pu(this._previous().toString(),t,this._and_expression());return t}_and_expression(){let t=this._equality_expression();for(;this._match(Pt.tokens.and);)t=new Pu(this._previous().toString(),t,this._equality_expression());return t}_equality_expression(){let t=this._relational_expression();return this._match([Pt.tokens.equal_equal,Pt.tokens.not_equal])?new Pu(this._previous().toString(),t,this._relational_expression()):t}_relational_expression(){let t=this._shift_expression();for(;this._match([Pt.tokens.less_than,Pt.tokens.greater_than,Pt.tokens.less_than_equal,Pt.tokens.greater_than_equal]);)t=new Pu(this._previous().toString(),t,this._shift_expression());return t}_shift_expression(){let t=this._additive_expression();for(;this._match([Pt.tokens.shift_left,Pt.tokens.shift_right]);)t=new Pu(this._previous().toString(),t,this._additive_expression());return t}_additive_expression(){let t=this._multiplicative_expression();for(;this._match([Pt.tokens.plus,Pt.tokens.minus]);)t=new Pu(this._previous().toString(),t,this._multiplicative_expression());return t}_multiplicative_expression(){let t=this._unary_expression();for(;this._match([Pt.tokens.star,Pt.tokens.forward_slash,Pt.tokens.modulo]);)t=new Pu(this._previous().toString(),t,this._unary_expression());return t}_unary_expression(){return this._match([Pt.tokens.minus,Pt.tokens.bang,Pt.tokens.tilde,Pt.tokens.star,Pt.tokens.and])?new zR(this._previous().toString(),this._unary_expression()):this._singular_expression()}_singular_expression(){let t=this._primary_expression(),r=this._postfix_expression();return r&&(t.postfix=r),t}_postfix_expression(){if(this._match(Pt.tokens.bracket_left)){let t=this._short_circuit_or_expression();this._consume(Pt.tokens.bracket_right,"Expected ']'.");let r=this._postfix_expression();return r&&(t.postfix=r),t}if(this._match(Pt.tokens.period)){let t=this._consume(Pt.tokens.ident,"Expected member name."),r=this._postfix_expression(),i=new I5(t.lexeme);return r&&(i.postfix=r),i}return null}_getStruct(t){return this._context.aliases.has(t)?this._context.aliases.get(t).type:this._context.structs.has(t)?this._context.structs.get(t):null}_primary_expression(){if(this._match(Pt.tokens.ident)){let i=this._previous().toString();if(this._check(Pt.tokens.paren_left)){let s=this._argument_expression_list(),n=this._getStruct(i);return n!=null?new Sg(n,s):new OR(i,s)}if(this._context.constants.has(i)){let s=this._context.constants.get(i);return new M5(i,s.value)}return new NR(i)}if(this._match(Pt.const_literal))return new C5(parseFloat(this._previous().toString()));if(this._check(Pt.tokens.paren_left))return this._paren_expression();if(this._match(Pt.keywords.bitcast)){this._consume(Pt.tokens.less_than,"Expected '<'.");let i=this._type_decl();this._consume(Pt.tokens.greater_than,"Expected '>'.");let s=this._paren_expression();return new FR(i,s)}let t=this._type_decl(),r=this._argument_expression_list();return new LR(t,r)}_argument_expression_list(){if(!this._match(Pt.tokens.paren_left))return null;let t=[];do{if(this._check(Pt.tokens.paren_right))break;let r=this._short_circuit_or_expression();t.push(r)}while(this._match(Pt.tokens.comma));return this._consume(Pt.tokens.paren_right,"Expected ')' for agument list"),t}_optional_paren_expression(){this._match(Pt.tokens.paren_left);let t=this._short_circuit_or_expression();return this._match(Pt.tokens.paren_right),new P5([t])}_paren_expression(){this._consume(Pt.tokens.paren_left,"Expected '('.");let t=this._short_circuit_or_expression();return this._consume(Pt.tokens.paren_right,"Expected ')'."),new P5([t])}_struct_decl(){if(!this._match(Pt.keywords.struct))return null;let t=this._consume(Pt.tokens.ident,"Expected name for struct.").toString();this._consume(Pt.tokens.brace_left,"Expected '{' for struct body.");let r=[];for(;!this._check(Pt.tokens.brace_right);){let s=this._attribute(),n=this._consume(Pt.tokens.ident,"Expected variable name.").toString();this._consume(Pt.tokens.colon,"Expected ':' for struct member type.");let o=this._attribute(),c=this._type_decl();c!=null&&(c.attributes=o),this._check(Pt.tokens.brace_right)?this._match(Pt.tokens.comma):this._consume(Pt.tokens.comma,"Expected ',' for struct member."),r.push(new HR(n,c,s))}this._consume(Pt.tokens.brace_right,"Expected '}' after struct body.");let i=new _d(t,r);return this._context.structs.set(t,i),i}_global_variable_decl(){let t=this._variable_decl();return t&&this._match(Pt.tokens.equal)&&(t.value=this._const_expression()),t}_override_variable_decl(){let t=this._override_decl();return t&&this._match(Pt.tokens.equal)&&(t.value=this._const_expression()),t}_global_const_decl(){if(!this._match(Pt.keywords.const))return null;let t=this._consume(Pt.tokens.ident,"Expected variable name"),r=null;if(this._match(Pt.tokens.colon)){let n=this._attribute();r=this._type_decl(),r!=null&&(r.attributes=n)}let i=null;if(this._match(Pt.tokens.equal)){let n=this._short_circuit_or_expression();if(n instanceof Sg)i=n;else if(n instanceof M5&&n.initializer instanceof Sg)i=n.initializer;else try{let o=n.evaluate(this._context);i=new C5(o)}catch{i=n}}let s=new w5(t.toString(),r,"","",i);return this._context.constants.set(s.name,s),s}_global_let_decl(){if(!this._match(Pt.keywords.let))return null;let t=this._consume(Pt.tokens.ident,"Expected variable name"),r=null;if(this._match(Pt.tokens.colon)){let s=this._attribute();r=this._type_decl(),r!=null&&(r.attributes=s)}let i=null;return this._match(Pt.tokens.equal)&&(i=this._const_expression()),new v5(t.toString(),r,"","",i)}_const_expression(){if(this._match(Pt.const_literal))return new I5(this._previous().toString());let t=this._type_decl();this._consume(Pt.tokens.paren_left,"Expected '('.");let r=[];for(;!this._check(Pt.tokens.paren_right)&&(r.push(this._const_expression()),!!this._check(Pt.tokens.comma));)this._advance();return this._consume(Pt.tokens.paren_right,"Expected ')'."),new Sg(t,r)}_variable_decl(){if(!this._match(Pt.keywords.var))return null;let t="",r="";this._match(Pt.tokens.less_than)&&(t=this._consume(Pt.storage_class,"Expected storage_class.").toString(),this._match(Pt.tokens.comma)&&(r=this._consume(Pt.access_mode,"Expected access_mode.").toString()),this._consume(Pt.tokens.greater_than,"Expected '>'."));let i=this._consume(Pt.tokens.ident,"Expected variable name"),s=null;if(this._match(Pt.tokens.colon)){let n=this._attribute();s=this._type_decl(),s!=null&&(s.attributes=n)}return new fA(i.toString(),s,t,r,null)}_override_decl(){if(!this._match(Pt.keywords.override))return null;let t=this._consume(Pt.tokens.ident,"Expected variable name"),r=null;if(this._match(Pt.tokens.colon)){let i=this._attribute();r=this._type_decl(),r!=null&&(r.attributes=i)}return new b5(t.toString(),r,null)}_enable_directive(){let t=this._consume(Pt.tokens.ident,"identity expected.");return new PR(t.toString())}_type_alias(){let t=this._consume(Pt.tokens.ident,"identity expected.");this._consume(Pt.tokens.equal,"Expected '=' for type alias.");let r=this._type_decl();if(r===null)throw this._error(this._peek(),"Expected Type for Alias.");this._context.aliases.has(r.name)&&(r=this._context.aliases.get(r.name).type);let i=new T5(t.toString(),r);return this._context.aliases.set(i.name,i),i}_type_decl(){if(this._check([Pt.tokens.ident,...Pt.texel_format,Pt.keywords.bool,Pt.keywords.f32,Pt.keywords.i32,Pt.keywords.u32])){let i=this._advance(),s=i.toString();return this._context.structs.has(s)?this._context.structs.get(s):this._context.aliases.has(s)?this._context.aliases.get(s).type:new xd(i.toString())}let t=this._texture_sampler_types();if(t)return t;if(this._check(Pt.template_types)){let i=this._advance().toString(),s=null,n=null;return this._match(Pt.tokens.less_than)&&(s=this._type_decl(),n=null,this._match(Pt.tokens.comma)&&(n=this._consume(Pt.access_mode,"Expected access_mode for pointer").toString()),this._consume(Pt.tokens.greater_than,"Expected '>' for type.")),new S5(i,s,n)}if(this._match(Pt.keywords.ptr)){let i=this._previous().toString();this._consume(Pt.tokens.less_than,"Expected '<' for pointer.");let s=this._consume(Pt.storage_class,"Expected storage_class for pointer");this._consume(Pt.tokens.comma,"Expected ',' for pointer.");let n=this._type_decl(),o=null;return this._match(Pt.tokens.comma)&&(o=this._consume(Pt.access_mode,"Expected access_mode for pointer").toString()),this._consume(Pt.tokens.greater_than,"Expected '>' for pointer."),new BR(i,s.toString(),n,o)}let r=this._attribute();if(this._match(Pt.keywords.array)){let i=null,s=-1,n=this._previous();if(this._match(Pt.tokens.less_than)){i=this._type_decl(),this._context.aliases.has(i.name)&&(i=this._context.aliases.get(i.name).type);let o="";this._match(Pt.tokens.comma)&&(o=this._shift_expression().evaluate(this._context).toString()),this._consume(Pt.tokens.greater_than,"Expected '>' for array."),s=o?parseInt(o):0}return new E5(n.toString(),r,i,s)}return null}_texture_sampler_types(){if(this._match(Pt.sampler_type))return new Tg(this._previous().toString(),null,null);if(this._match(Pt.depth_texture_type))return new Tg(this._previous().toString(),null,null);if(this._match(Pt.sampled_texture_type)||this._match(Pt.multisampled_texture_type)){let t=this._previous();this._consume(Pt.tokens.less_than,"Expected '<' for sampler type.");let r=this._type_decl();return this._consume(Pt.tokens.greater_than,"Expected '>' for sampler type."),new Tg(t.toString(),r,null)}if(this._match(Pt.storage_texture_type)){let t=this._previous();this._consume(Pt.tokens.less_than,"Expected '<' for sampler type.");let r=this._consume(Pt.texel_format,"Invalid texel format.").toString();this._consume(Pt.tokens.comma,"Expected ',' after texel format.");let i=this._consume(Pt.access_mode,"Expected access mode for storage texture type.").toString();return this._consume(Pt.tokens.greater_than,"Expected '>' for sampler type."),new Tg(t.toString(),r,i)}return null}_attribute(){let t=[];for(;this._match(Pt.tokens.attr);){let r=this._consume(Pt.attribute_name,"Expected attribute name"),i=new D5(r.toString(),null);if(this._match(Pt.tokens.paren_left)){if(i.value=this._consume(Pt.literal_or_ident,"Expected attribute value").toString(),this._check(Pt.tokens.comma)){this._advance();do{let s=this._consume(Pt.literal_or_ident,"Expected attribute value").toString();i.value instanceof Array||(i.value=[i.value]),i.value.push(s)}while(this._match(Pt.tokens.comma))}this._consume(Pt.tokens.paren_right,"Expected ')'")}t.push(i)}for(;this._match(Pt.tokens.attr_left);){if(!this._check(Pt.tokens.attr_right))do{let r=this._consume(Pt.attribute_name,"Expected attribute name"),i=new D5(r.toString(),null);if(this._match(Pt.tokens.paren_left)){if(i.value=[this._consume(Pt.literal_or_ident,"Expected attribute value").toString()],this._check(Pt.tokens.comma)){this._advance();do{let s=this._consume(Pt.literal_or_ident,"Expected attribute value").toString();i.value.push(s)}while(this._match(Pt.tokens.comma))}this._consume(Pt.tokens.paren_right,"Expected ')'")}t.push(i)}while(this._match(Pt.tokens.comma));this._consume(Pt.tokens.attr_right,"Expected ']]' after attribute declarations")}return t.length==0?null:t}},pA=class{constructor(t,r){this.name=t,this.attributes=r,this.size=0}get isArray(){return!1}get isStruct(){return!1}get isTemplate(){return!1}},O5=class{constructor(t,r,i){this.name=t,this.type=r,this.attributes=i,this.offset=0,this.size=0}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray?this.type.format:this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}},Ay=class extends pA{constructor(t,r){super(t,r),this.members=[],this.align=0}get isStruct(){return!0}},nv=class extends pA{constructor(t,r){super(t,r),this.count=0,this.stride=0}get isArray(){return!0}},N5=class extends pA{constructor(t,r,i,s){super(t,i),this.format=r,this.access=s}get isTemplate(){return!0}},hA;(function(e){e[e.Uniform=0]="Uniform",e[e.Storage=1]="Storage",e[e.Texture=2]="Texture",e[e.Sampler=3]="Sampler",e[e.StorageTexture=4]="StorageTexture"})(hA||(hA={}));var my=class{constructor(t,r,i,s,n,o,c){this.name=t,this.type=r,this.group=i,this.binding=s,this.attributes=n,this.resourceType=o,this.access=c}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get size(){return this.type.size}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray?this.type.format:this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}},YR=class{constructor(t,r){this.name=t,this.type=r}},gy=class{constructor(t,r){this.align=t,this.size=r}},XR=class{constructor(t,r,i,s){this.name=t,this.type=r,this.locationType=i,this.location=s,this.interpolation=null}},F5=class{constructor(t,r,i,s){this.name=t,this.type=r,this.locationType=i,this.location=s}},ZR=class{constructor(t,r=null){this.stage=null,this.inputs=[],this.outputs=[],this.name=t,this.stage=r}},GR=class{constructor(){this.vertex=[],this.fragment=[],this.compute=[]}},QR=class{constructor(t,r,i,s){this.name=t,this.type=r,this.attributes=i,this.id=s}},Eg=class e{constructor(t){this.uniforms=[],this.storage=[],this.textures=[],this.samplers=[],this.aliases=[],this.overrides=[],this.structs=[],this.entry=new GR,this._types=new Map,t&&this.update(t)}_isStorageTexture(t){return t.name=="texture_storage_1d"||t.name=="texture_storage_2d"||t.name=="texture_storage_2d_array"||t.name=="texture_storage_3d"}update(t){let i=new qR().parse(t);for(let s of i){if(s instanceof _d){let n=this._getTypeInfo(s,null);n instanceof Ay&&this.structs.push(n);continue}if(s instanceof T5){this.aliases.push(this._getAliasInfo(s));continue}if(s instanceof b5){let n=s,o=this._getAttributeNum(n.attributes,"id",0),c=n.type!=null?this._getTypeInfo(n.type,n.attributes):null;this.overrides.push(new QR(n.name,c,n.attributes,o));continue}if(this._isUniformVar(s)){let n=s,o=this._getAttributeNum(n.attributes,"group",0),c=this._getAttributeNum(n.attributes,"binding",0),f=this._getTypeInfo(n.type,n.attributes),p=new my(n.name,f,o,c,n.attributes,hA.Uniform,n.access);this.uniforms.push(p);continue}if(this._isStorageVar(s)){let n=s,o=this._getAttributeNum(n.attributes,"group",0),c=this._getAttributeNum(n.attributes,"binding",0),f=this._getTypeInfo(n.type,n.attributes),p=this._isStorageTexture(f),x=new my(n.name,f,o,c,n.attributes,p?hA.StorageTexture:hA.Storage,n.access);this.storage.push(x);continue}if(this._isTextureVar(s)){let n=s,o=this._getAttributeNum(n.attributes,"group",0),c=this._getAttributeNum(n.attributes,"binding",0),f=this._getTypeInfo(n.type,n.attributes),p=this._isStorageTexture(f),x=new my(n.name,f,o,c,n.attributes,p?hA.StorageTexture:hA.Texture,n.access);p?this.storage.push(x):this.textures.push(x);continue}if(this._isSamplerVar(s)){let n=s,o=this._getAttributeNum(n.attributes,"group",0),c=this._getAttributeNum(n.attributes,"binding",0),f=this._getTypeInfo(n.type,n.attributes),p=new my(n.name,f,o,c,n.attributes,hA.Sampler,n.access);this.samplers.push(p);continue}if(s instanceof x5){let n=this._getAttribute(s,"vertex"),o=this._getAttribute(s,"fragment"),c=this._getAttribute(s,"compute"),f=n||o||c;if(f){let p=new ZR(s.name,f.name);p.inputs=this._getInputs(s.args),p.outputs=this._getOutputs(s.returnType),this.entry[f.name].push(p)}continue}}}getBindGroups(){let t=[];function r(i,s){i>=t.length&&(t.length=i+1),t[i]===void 0&&(t[i]=[]),s>=t[i].length&&(t[i].length=s+1)}for(let i of this.uniforms){r(i.group,i.binding);let s=t[i.group];s[i.binding]=i}for(let i of this.storage){r(i.group,i.binding);let s=t[i.group];s[i.binding]=i}for(let i of this.textures){r(i.group,i.binding);let s=t[i.group];s[i.binding]=i}for(let i of this.samplers){r(i.group,i.binding);let s=t[i.group];s[i.binding]=i}return t}_getOutputs(t,r=void 0){if(r===void 0&&(r=[]),t instanceof _d)this._getStructOutputs(t,r);else{let i=this._getOutputInfo(t);i!==null&&r.push(i)}return r}_getStructOutputs(t,r){for(let i of t.members)if(i.type instanceof _d)this._getStructOutputs(i.type,r);else{let s=this._getAttribute(i,"location")||this._getAttribute(i,"builtin");if(s!==null){let n=this._getTypeInfo(i.type,i.type.attributes),o=this._parseInt(s.value),c=new F5(i.name,n,s.name,o);r.push(c)}}}_getOutputInfo(t){let r=this._getAttribute(t,"location")||this._getAttribute(t,"builtin");if(r!==null){let i=this._getTypeInfo(t,t.attributes),s=this._parseInt(r.value);return new F5("",i,r.name,s)}return null}_getInputs(t,r=void 0){r===void 0&&(r=[]);for(let i of t)if(i.type instanceof _d)this._getStructInputs(i.type,r);else{let s=this._getInputInfo(i);s!==null&&r.push(s)}return r}_getStructInputs(t,r){for(let i of t.members)if(i.type instanceof _d)this._getStructInputs(i.type,r);else{let s=this._getInputInfo(i);s!==null&&r.push(s)}}_getInputInfo(t){let r=this._getAttribute(t,"location")||this._getAttribute(t,"builtin");if(r!==null){let i=this._getAttribute(t,"interpolation"),s=this._getTypeInfo(t.type,t.attributes),n=this._parseInt(r.value),o=new XR(t.name,s,r.name,n);return i!==null&&(o.interpolation=this._parseString(i.value)),o}return null}_parseString(t){return t instanceof Array&&(t=t[0]),t}_parseInt(t){t instanceof Array&&(t=t[0]);let r=parseInt(t);return isNaN(r)?t:r}_getAlias(t){for(let r of this.aliases)if(r.name==t)return r.type;return null}_getAliasInfo(t){return new YR(t.name,this._getTypeInfo(t.type,null))}_getTypeInfo(t,r){if(this._types.has(t))return this._types.get(t);if(t instanceof E5){let s=t,n=this._getTypeInfo(s.format,s.attributes),o=new nv(s.name,r);return o.format=n,o.count=s.count,this._types.set(t,o),this._updateTypeInfo(o),o}if(t instanceof _d){let s=t,n=new Ay(s.name,r);for(let o of s.members){let c=this._getTypeInfo(o.type,o.attributes);n.members.push(new O5(o.name,c,o.attributes))}return this._types.set(t,n),this._updateTypeInfo(n),n}if(t instanceof Tg){let s=t,n=s.format instanceof xd,o=s.format?n?this._getTypeInfo(s.format,null):new pA(s.format,null):null,c=new N5(s.name,o,r,s.access);return this._types.set(t,c),this._updateTypeInfo(c),c}if(t instanceof S5){let s=t,n=s.format?this._getTypeInfo(s.format,null):null,o=new N5(s.name,n,r,s.access);return this._types.set(t,o),this._updateTypeInfo(o),o}let i=new pA(t.name,r);return this._types.set(t,i),this._updateTypeInfo(i),i}_updateTypeInfo(t){var r,i;let s=this._getTypeSize(t);if(t.size=(r=s?.size)!==null&&r!==void 0?r:0,t instanceof nv){let n=this._getTypeSize(t.format);t.stride=(i=n?.size)!==null&&i!==void 0?i:0,this._updateTypeInfo(t.format)}t instanceof Ay&&this._updateStructInfo(t)}_updateStructInfo(t){var r;let i=0,s=0,n=0,o=0;for(let c=0,f=t.members.length;c<f;++c){let p=t.members[c],x=this._getTypeSize(p);if(!x)continue;(r=this._getAlias(p.type.name))!==null&&r!==void 0||p.type;let E=x.align,T=x.size;i=this._roundUp(E,i+s),s=T,n=i,o=Math.max(o,E),p.offset=i,p.size=T,this._updateTypeInfo(p.type)}t.size=this._roundUp(o,n+s),t.align=o}_getTypeSize(t){var r;if(t==null)return null;let i=this._getAttributeNum(t.attributes,"size",0),s=this._getAttributeNum(t.attributes,"align",0);if(t instanceof O5&&(t=t.type),t instanceof pA){let n=this._getAlias(t.name);n!==null&&(t=n)}{let n=e._typeInfo[t.name];if(n!==void 0){let o=t.format==="f16"?2:1;return new gy(Math.max(s,n.align/o),Math.max(i,n.size/o))}}{let n=e._typeInfo[t.name.substring(0,t.name.length-1)];if(n){let o=t.name[t.name.length-1]==="h"?2:1;return new gy(Math.max(s,n.align/o),Math.max(i,n.size/o))}}if(t instanceof nv){let n=t,o=8,c=8,f=this._getTypeSize(n.format);f!==null&&(c=f.size,o=f.align);let p=n.count,x=this._getAttributeNum((r=t?.attributes)!==null&&r!==void 0?r:null,"stride",this._roundUp(o,c));return c=p*x,i&&(c=i),new gy(Math.max(s,o),Math.max(i,c))}if(t instanceof Ay){let n=0,o=0,c=0,f=0,p=0;for(let x of t.members){let E=this._getTypeSize(x.type);E!==null&&(n=Math.max(E.align,n),c=this._roundUp(E.align,c+f),f=E.size,p=c)}return o=this._roundUp(n,p+f),new gy(Math.max(s,n),Math.max(i,o))}return null}_isUniformVar(t){return t instanceof fA&&t.storage=="uniform"}_isStorageVar(t){return t instanceof fA&&t.storage=="storage"}_isTextureVar(t){return t instanceof fA&&t.type!==null&&e._textureTypes.indexOf(t.type.name)!=-1}_isSamplerVar(t){return t instanceof fA&&t.type!==null&&e._samplerTypes.indexOf(t.type.name)!=-1}_getAttribute(t,r){let i=t;if(!i||!i.attributes)return null;let s=i.attributes;for(let n of s)if(n.name==r)return n;return null}_getAttributeNum(t,r,i){if(t===null)return i;for(let s of t)if(s.name==r){let n=s!==null&&s.value!==null?s.value:i;return n instanceof Array&&(n=n[0]),typeof n=="number"?n:typeof n=="string"?parseInt(n):i}return i}_roundUp(t,r){return Math.ceil(r/t)*t}};Eg._typeInfo={f16:{align:2,size:2},i32:{align:4,size:4},u32:{align:4,size:4},f32:{align:4,size:4},atomic:{align:4,size:4},vec2:{align:8,size:8},vec3:{align:16,size:12},vec4:{align:16,size:16},mat2x2:{align:8,size:16},mat3x2:{align:8,size:24},mat4x2:{align:8,size:32},mat2x3:{align:16,size:32},mat3x3:{align:16,size:48},mat4x3:{align:16,size:64},mat2x4:{align:16,size:32},mat3x4:{align:16,size:48},mat4x4:{align:16,size:64}};Eg._textureTypes=Pt.any_texture_type.map(e=>e.name);Eg._samplerTypes=Pt.sampler_type.map(e=>e.name);function KR(e){let t={attributes:[],bindings:[]},r;try{r=nft(e)}catch(n){return Ce.error(n.message)(),t}for(let n of r.uniforms){let o=[];for(let c of n.type.members)o.push({name:c.name,type:yV(c.type)});t.bindings.push({type:"uniform",name:n.name,location:n.binding,group:n.group,members:o})}let i=r.entry.vertex[0],s=i?.inputs.length||0;for(let n=0;n<s;n++){let o=i.inputs[n];if(o.locationType==="location"){let c=yV(o.type);t.attributes.push({name:o.name,location:o.location,type:c})}}return t}function yV(e){return e.format?`${e.name}<${e.format.name}>`:e.name}function nft(e){try{return new Eg(e)}catch(t){if(t instanceof Error)throw t;let r="WGSL parse error";throw typeof t=="object"&&t?.message&&(r+=`: ${t.message} `),typeof t=="object"&&t?.token&&(r+=t.token.line||""),new Error(r,{cause:t})}}var sft=`#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
const float TWO_PI = 6.2831854820251465;
const float PI_2 = 1.5707963705062866;
const float PI_16 = 0.1963495463132858;
const float SIN_TABLE_0 = 0.19509032368659973;
const float SIN_TABLE_1 = 0.3826834261417389;
const float SIN_TABLE_2 = 0.5555702447891235;
const float SIN_TABLE_3 = 0.7071067690849304;
const float COS_TABLE_0 = 0.9807852506637573;
const float COS_TABLE_1 = 0.9238795042037964;
const float COS_TABLE_2 = 0.8314695954322815;
const float COS_TABLE_3 = 0.7071067690849304;
const float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;
const float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;
const float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;
const float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;
float sin_taylor_fp32(float a) {
float r, s, t, x;
if (a == 0.0) {
return 0.0;
}
x = -a * a;
s = a;
r = a;
r = r * x;
t = r * INVERSE_FACTORIAL_3;
s = s + t;
r = r * x;
t = r * INVERSE_FACTORIAL_5;
s = s + t;
r = r * x;
t = r * INVERSE_FACTORIAL_7;
s = s + t;
r = r * x;
t = r * INVERSE_FACTORIAL_9;
s = s + t;
return s;
}
void sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {
if (a == 0.0) {
sin_t = 0.0;
cos_t = 1.0;
}
sin_t = sin_taylor_fp32(a);
cos_t = sqrt(1.0 - sin_t * sin_t);
}
float tan_taylor_fp32(float a) {
float sin_a;
float cos_a;
if (a == 0.0) {
return 0.0;
}
float z = floor(a / TWO_PI);
float r = a - TWO_PI * z;
float t;
float q = floor(r / PI_2 + 0.5);
int j = int(q);
if (j < -2 || j > 2) {
return 1.0 / 0.0;
}
t = r - PI_2 * q;
q = floor(t / PI_16 + 0.5);
int k = int(q);
int abs_k = int(abs(float(k)));
if (abs_k > 4) {
return 1.0 / 0.0;
} else {
t = t - PI_16 * q;
}
float u = 0.0;
float v = 0.0;
float sin_t, cos_t;
float s, c;
sincos_taylor_fp32(t, sin_t, cos_t);
if (k == 0) {
s = sin_t;
c = cos_t;
} else {
if (abs(float(abs_k) - 1.0) < 0.5) {
u = COS_TABLE_0;
v = SIN_TABLE_0;
} else if (abs(float(abs_k) - 2.0) < 0.5) {
u = COS_TABLE_1;
v = SIN_TABLE_1;
} else if (abs(float(abs_k) - 3.0) < 0.5) {
u = COS_TABLE_2;
v = SIN_TABLE_2;
} else if (abs(float(abs_k) - 4.0) < 0.5) {
u = COS_TABLE_3;
v = SIN_TABLE_3;
}
if (k > 0) {
s = u * sin_t + v * cos_t;
c = u * cos_t - v * sin_t;
} else {
s = u * sin_t - v * cos_t;
c = u * cos_t + v * sin_t;
}
}
if (j == 0) {
sin_a = s;
cos_a = c;
} else if (j == 1) {
sin_a = c;
cos_a = -s;
} else if (j == -1) {
sin_a = -c;
cos_a = s;
} else {
sin_a = -s;
cos_a = -c;
}
return sin_a / cos_a;
}
#endif
float tan_fp32(float a) {
#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
return tan_taylor_fp32(a);
#else
return tan(a);
#endif
}
`,JR={name:"fp32",vs:sft};var oft=new Float32Array([0,1,1,1]),aft=`uniform pickingUniforms {
float isActive;
float isAttribute;
float isHighlightActive;
float useFloatColors;
vec3 highlightedObjectColor;
vec4 highlightColor;
} picking;
out vec4 picking_vRGBcolor_Avalid;
vec3 picking_normalizeColor(vec3 color) {
return picking.useFloatColors > 0.5 ? color : color / 255.0;
}
vec4 picking_normalizeColor(vec4 color) {
return picking.useFloatColors > 0.5 ? color : color / 255.0;
}
bool picking_isColorZero(vec3 color) {
return dot(color, vec3(1.0)) < 0.00001;
}
bool picking_isColorValid(vec3 color) {
return dot(color, vec3(1.0)) > 0.00001;
}
bool isVertexHighlighted(vec3 vertexColor) {
vec3 highlightedObjectColor = picking_normalizeColor(picking.highlightedObjectColor);
return
bool(picking.isHighlightActive) && picking_isColorZero(abs(vertexColor - highlightedObjectColor));
}
void picking_setPickingColor(vec3 pickingColor) {
pickingColor = picking_normalizeColor(pickingColor);
if (bool(picking.isActive)) {
picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));
if (!bool(picking.isAttribute)) {
picking_vRGBcolor_Avalid.rgb = pickingColor;
}
} else {
picking_vRGBcolor_Avalid.a = float(isVertexHighlighted(pickingColor));
}
}
void picking_setPickingAttribute(float value) {
if (bool(picking.isAttribute)) {
picking_vRGBcolor_Avalid.r = value;
}
}
void picking_setPickingAttribute(vec2 value) {
if (bool(picking.isAttribute)) {
picking_vRGBcolor_Avalid.rg = value;
}
}
void picking_setPickingAttribute(vec3 value) {
if (bool(picking.isAttribute)) {
picking_vRGBcolor_Avalid.rgb = value;
}
}
`,lft=`uniform pickingUniforms {
float isActive;
float isAttribute;
float isHighlightActive;
float useFloatColors;
vec3 highlightedObjectColor;
vec4 highlightColor;
} picking;
in vec4 picking_vRGBcolor_Avalid;
vec4 picking_filterHighlightColor(vec4 color) {
if (picking.isActive > 0.5) {
return color;
}
bool selected = bool(picking_vRGBcolor_Avalid.a);
if (selected) {
float highLightAlpha = picking.highlightColor.a;
float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);
float highLightRatio = highLightAlpha / blendedAlpha;
vec3 blendedRGB = mix(color.rgb, picking.highlightColor.rgb, highLightRatio);
return vec4(blendedRGB, blendedAlpha);
} else {
return color;
}
}
vec4 picking_filterPickingColor(vec4 color) {
if (bool(picking.isActive)) {
if (picking_vRGBcolor_Avalid.a == 0.0) {
discard;
}
return picking_vRGBcolor_Avalid;
}
return color;
}
vec4 picking_filterColor(vec4 color) {
vec4 highlightColor = picking_filterHighlightColor(color);
return picking_filterPickingColor(highlightColor);
}
`,L5={name:"picking",vs:aft,fs:lft,uniformTypes:{isActive:"f32",isAttribute:"f32",isHighlightActive:"f32",useFloatColors:"f32",highlightedObjectColor:"vec3<f32>",highlightColor:"vec4<f32>"},defaultUniforms:{isActive:!1,isAttribute:!1,isHighlightActive:!1,useFloatColors:!0,highlightedObjectColor:new Float32Array([0,0,0]),highlightColor:oft},getUniforms:cft};function cft(e={},t){let r={};if(e.highlightedObjectColor!==void 0)if(e.highlightedObjectColor===null)r.isHighlightActive=!1;else{r.isHighlightActive=!0;let i=e.highlightedObjectColor.slice(0,3);r.highlightedObjectColor=i}if(e.highlightColor){let i=Array.from(e.highlightColor,s=>s/255);Number.isFinite(i[3])||(i[3]=1),r.highlightColor=i}return e.isActive!==void 0&&(r.isActive=!!e.isActive,r.isAttribute=!!e.isAttribute),e.useFloatColors!==void 0&&(r.useFloatColors=!!e.useFloatColors),r}function tk(e,t=[],r=0){let i=Math.fround(e),s=e-i;return t[r]=i,t[r+1]=s,t}function xV(e){return e-Math.fround(e)}function bV(e){let t=new Float32Array(32);for(let r=0;r<4;++r)for(let i=0;i<4;++i){let s=r*4+i;tk(e[i*4+r],t,s*2)}return t}var vV=`uniform float ONE;
vec2 split(float a) {
const float SPLIT = 4097.0;
float t = a * SPLIT;
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
float a_hi = t * ONE - (t - a);
float a_lo = a * ONE - a_hi;
#else
float a_hi = t - (t - a);
float a_lo = a - a_hi;
#endif
return vec2(a_hi, a_lo);
}
vec2 split2(vec2 a) {
vec2 b = split(a.x);
b.y += a.y;
return b;
}
vec2 quickTwoSum(float a, float b) {
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
float sum = (a + b) * ONE;
float err = b - (sum - a) * ONE;
#else
float sum = a + b;
float err = b - (sum - a);
#endif
return vec2(sum, err);
}
vec2 twoSum(float a, float b) {
float s = (a + b);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
float v = (s * ONE - a) * ONE;
float err = (a - (s - v) * ONE) * ONE * ONE * ONE + (b - v);
#else
float v = s - a;
float err = (a - (s - v)) + (b - v);
#endif
return vec2(s, err);
}
vec2 twoSub(float a, float b) {
float s = (a - b);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
float v = (s * ONE - a) * ONE;
float err = (a - (s - v) * ONE) * ONE * ONE * ONE - (b + v);
#else
float v = s - a;
float err = (a - (s - v)) - (b + v);
#endif
return vec2(s, err);
}
vec2 twoSqr(float a) {
float prod = a * a;
vec2 a_fp64 = split(a);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
float err = ((a_fp64.x * a_fp64.x - prod) * ONE + 2.0 * a_fp64.x *
a_fp64.y * ONE * ONE) + a_fp64.y * a_fp64.y * ONE * ONE * ONE;
#else
float err = ((a_fp64.x * a_fp64.x - prod) + 2.0 * a_fp64.x * a_fp64.y) + a_fp64.y * a_fp64.y;
#endif
return vec2(prod, err);
}
vec2 twoProd(float a, float b) {
float prod = a * b;
vec2 a_fp64 = split(a);
vec2 b_fp64 = split(b);
float err = ((a_fp64.x * b_fp64.x - prod) + a_fp64.x * b_fp64.y +
a_fp64.y * b_fp64.x) + a_fp64.y * b_fp64.y;
return vec2(prod, err);
}
vec2 sum_fp64(vec2 a, vec2 b) {
vec2 s, t;
s = twoSum(a.x, b.x);
t = twoSum(a.y, b.y);
s.y += t.x;
s = quickTwoSum(s.x, s.y);
s.y += t.y;
s = quickTwoSum(s.x, s.y);
return s;
}
vec2 sub_fp64(vec2 a, vec2 b) {
vec2 s, t;
s = twoSub(a.x, b.x);
t = twoSub(a.y, b.y);
s.y += t.x;
s = quickTwoSum(s.x, s.y);
s.y += t.y;
s = quickTwoSum(s.x, s.y);
return s;
}
vec2 mul_fp64(vec2 a, vec2 b) {
vec2 prod = twoProd(a.x, b.x);
prod.y += a.x * b.y;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
prod = split2(prod);
#endif
prod = quickTwoSum(prod.x, prod.y);
prod.y += a.y * b.x;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
prod = split2(prod);
#endif
prod = quickTwoSum(prod.x, prod.y);
return prod;
}
vec2 div_fp64(vec2 a, vec2 b) {
float xn = 1.0 / b.x;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
vec2 yn = mul_fp64(a, vec2(xn, 0));
#else
vec2 yn = a * xn;
#endif
float diff = (sub_fp64(a, mul_fp64(b, yn))).x;
vec2 prod = twoProd(xn, diff);
return sum_fp64(yn, prod);
}
vec2 sqrt_fp64(vec2 a) {
if (a.x == 0.0 && a.y == 0.0) return vec2(0.0, 0.0);
if (a.x < 0.0) return vec2(0.0 / 0.0, 0.0 / 0.0);
float x = 1.0 / sqrt(a.x);
float yn = a.x * x;
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
vec2 yn_sqr = twoSqr(yn) * ONE;
#else
vec2 yn_sqr = twoSqr(yn);
#endif
float diff = sub_fp64(a, yn_sqr).x;
vec2 prod = twoProd(x * 0.5, diff);
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
return sum_fp64(split(yn), prod);
#else
return sum_fp64(vec2(yn, 0.0), prod);
#endif
}
`;var uft={ONE:1};function hft(){return uft}var ek={name:"fp64-arithmetic",vs:vV,getUniforms:hft,fp64ify:tk,fp64LowPart:xV,fp64ifyMatrix4:bV};var s7t=1/Math.PI*180,o7t=1/180*Math.PI,fft={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0,_cartographicRadians:!1};globalThis.mathgl=globalThis.mathgl||{config:{...fft}};var ha=globalThis.mathgl.config;function rk(e,{precision:t=ha.precision}={}){return e=pft(e),`${parseFloat(e.toPrecision(t))}`}function bd(e){return Array.isArray(e)||ArrayBuffer.isView(e)&&!(e instanceof DataView)}function ku(e,t,r){return Aft(e,i=>Math.max(t,Math.min(r,i)))}function Vf(e,t,r){return bd(e)?e.map((i,s)=>Vf(i,t[s],r)):r*t+(1-r)*e}function vd(e,t,r){let i=ha.EPSILON;r&&(ha.EPSILON=r);try{if(e===t)return!0;if(bd(e)&&bd(t)){if(e.length!==t.length)return!1;for(let s=0;s<e.length;++s)if(!vd(e[s],t[s]))return!1;return!0}return e&&e.equals?e.equals(t):t&&t.equals?t.equals(e):typeof e=="number"&&typeof t=="number"?Math.abs(e-t)<=ha.EPSILON*Math.max(1,Math.abs(e),Math.abs(t)):!1}finally{ha.EPSILON=i}}function pft(e){return Math.round(e/ha.EPSILON)*ha.EPSILON}function dft(e){return e.clone?e.clone():new Array(e.length)}function Aft(e,t,r){if(bd(e)){let i=e;r=r||dft(i);for(let s=0;s<r.length&&s<i.length;++s){let n=typeof e=="number"?e:e[s];r[s]=t(n,s,r)}return r}return t(e)}var yy=class extends Array{clone(){return new this.constructor().copy(this)}fromArray(t,r=0){for(let i=0;i<this.ELEMENTS;++i)this[i]=t[i+r];return this.check()}toArray(t=[],r=0){for(let i=0;i<this.ELEMENTS;++i)t[r+i]=this[i];return t}toObject(t){return t}from(t){return Array.isArray(t)?this.copy(t):this.fromObject(t)}to(t){return t===this?this:bd(t)?this.toArray(t):this.toObject(t)}toTarget(t){return t?this.to(t):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(ha)}formatString(t){let r="";for(let i=0;i<this.ELEMENTS;++i)r+=(i>0?", ":"")+rk(this[i],t);return`${t.printTypes?this.constructor.name:""}[${r}]`}equals(t){if(!t||this.length!==t.length)return!1;for(let r=0;r<this.ELEMENTS;++r)if(!vd(this[r],t[r]))return!1;return!0}exactEquals(t){if(!t||this.length!==t.length)return!1;for(let r=0;r<this.ELEMENTS;++r)if(this[r]!==t[r])return!1;return!0}negate(){for(let t=0;t<this.ELEMENTS;++t)this[t]=-this[t];return this.check()}lerp(t,r,i){if(i===void 0)return this.lerp(this,t,r);for(let s=0;s<this.ELEMENTS;++s){let n=t[s],o=typeof r=="number"?r:r[s];this[s]=n+i*(o-n)}return this.check()}min(t){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(t[r],this[r]);return this.check()}max(t){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.max(t[r],this[r]);return this.check()}clamp(t,r){for(let i=0;i<this.ELEMENTS;++i)this[i]=Math.min(Math.max(this[i],t[i]),r[i]);return this.check()}add(...t){for(let r of t)for(let i=0;i<this.ELEMENTS;++i)this[i]+=r[i];return this.check()}subtract(...t){for(let r of t)for(let i=0;i<this.ELEMENTS;++i)this[i]-=r[i];return this.check()}scale(t){if(typeof t=="number")for(let r=0;r<this.ELEMENTS;++r)this[r]*=t;else for(let r=0;r<this.ELEMENTS&&r<t.length;++r)this[r]*=t[r];return this.check()}multiplyByScalar(t){for(let r=0;r<this.ELEMENTS;++r)this[r]*=t;return this.check()}check(){if(ha.debug&&!this.validate())throw new Error(`math.gl: ${this.constructor.name} some fields set to invalid numbers'`);return this}validate(){let t=this.length===this.ELEMENTS;for(let r=0;r<this.ELEMENTS;++r)t=t&&Number.isFinite(this[r]);return t}sub(t){return this.subtract(t)}setScalar(t){for(let r=0;r<this.ELEMENTS;++r)this[r]=t;return this.check()}addScalar(t){for(let r=0;r<this.ELEMENTS;++r)this[r]+=t;return this.check()}subScalar(t){return this.addScalar(-t)}multiplyScalar(t){for(let r=0;r<this.ELEMENTS;++r)this[r]*=t;return this.check()}divideScalar(t){return this.multiplyByScalar(1/t)}clampScalar(t,r){for(let i=0;i<this.ELEMENTS;++i)this[i]=Math.min(Math.max(this[i],t),r);return this.check()}get elements(){return this}};function mft(e,t){if(e.length!==t)return!1;for(let r=0;r<e.length;++r)if(!Number.isFinite(e[r]))return!1;return!0}function al(e){if(!Number.isFinite(e))throw new Error(`Invalid number ${JSON.stringify(e)}`);return e}function z5(e,t,r=""){if(ha.debug&&!mft(e,t))throw new Error(`math.gl: ${r} some fields set to invalid numbers'`);return e}function ik(e,t){if(!e)throw new Error(`math.gl assertion ${t}`)}var U5=class extends yy{get x(){return this[0]}set x(t){this[0]=al(t)}get y(){return this[1]}set y(t){this[1]=al(t)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let t=0;for(let r=0;r<this.ELEMENTS;++r)t+=this[r]*this[r];return t}magnitudeSquared(){return this.lengthSquared()}distance(t){return Math.sqrt(this.distanceSquared(t))}distanceSquared(t){let r=0;for(let i=0;i<this.ELEMENTS;++i){let s=this[i]-t[i];r+=s*s}return al(r)}dot(t){let r=0;for(let i=0;i<this.ELEMENTS;++i)r+=this[i]*t[i];return al(r)}normalize(){let t=this.magnitude();if(t!==0)for(let r=0;r<this.ELEMENTS;++r)this[r]/=t;return this.check()}multiply(...t){for(let r of t)for(let i=0;i<this.ELEMENTS;++i)this[i]*=r[i];return this.check()}divide(...t){for(let r of t)for(let i=0;i<this.ELEMENTS;++i)this[i]/=r[i];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(t){return this.distance(t)}distanceToSquared(t){return this.distanceSquared(t)}getComponent(t){return ik(t>=0&&t<this.ELEMENTS,"index is out of range"),al(this[t])}setComponent(t,r){return ik(t>=0&&t<this.ELEMENTS,"index is out of range"),this[t]=r,this.check()}addVectors(t,r){return this.copy(t).add(r)}subVectors(t,r){return this.copy(t).subtract(r)}multiplyVectors(t,r){return this.copy(t).multiply(r)}addScaledVector(t,r){return this.add(new this.constructor(t).multiplyScalar(r))}};var $f={};sl($f,{add:()=>bft,angle:()=>Uft,ceil:()=>vft,clone:()=>gft,copy:()=>yft,create:()=>wV,cross:()=>Dft,dist:()=>Zft,distance:()=>IV,div:()=>Xft,divide:()=>EV,dot:()=>kft,equals:()=>Hft,exactEquals:()=>$ft,floor:()=>wft,forEach:()=>Kft,fromValues:()=>_ft,inverse:()=>Pft,len:()=>Wft,length:()=>CV,lerp:()=>Bft,max:()=>Sft,min:()=>Tft,mul:()=>Yft,multiply:()=>SV,negate:()=>Cft,normalize:()=>Rft,random:()=>Oft,rotate:()=>zft,round:()=>Eft,scale:()=>Ift,scaleAndAdd:()=>Mft,set:()=>xft,sqrDist:()=>Gft,sqrLen:()=>Qft,squaredDistance:()=>MV,squaredLength:()=>PV,str:()=>jft,sub:()=>qft,subtract:()=>TV,transformMat2:()=>Nft,transformMat2d:()=>Fft,transformMat3:()=>Lft,transformMat4:()=>nk,zero:()=>Vft});var oo=typeof Float32Array<"u"?Float32Array:Array,jf=Math.random;function Du(e){return e>=0?Math.round(e):e%.5===0?Math.floor(e):Math.round(e)}var g7t=Math.PI/180;function wV(){let e=new oo(2);return oo!=Float32Array&&(e[0]=0,e[1]=0),e}function gft(e){let t=new oo(2);return t[0]=e[0],t[1]=e[1],t}function _ft(e,t){let r=new oo(2);return r[0]=e,r[1]=t,r}function yft(e,t){return e[0]=t[0],e[1]=t[1],e}function xft(e,t,r){return e[0]=t,e[1]=r,e}function bft(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e}function TV(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e}function SV(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e}function EV(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e}function vft(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e}function wft(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e}function Tft(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e}function Sft(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e}function Eft(e,t){return e[0]=Du(t[0]),e[1]=Du(t[1]),e}function Ift(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e}function Mft(e,t,r,i){return e[0]=t[0]+r[0]*i,e[1]=t[1]+r[1]*i,e}function IV(e,t){let r=t[0]-e[0],i=t[1]-e[1];return Math.sqrt(r*r+i*i)}function MV(e,t){let r=t[0]-e[0],i=t[1]-e[1];return r*r+i*i}function CV(e){let t=e[0],r=e[1];return Math.sqrt(t*t+r*r)}function PV(e){let t=e[0],r=e[1];return t*t+r*r}function Cft(e,t){return e[0]=-t[0],e[1]=-t[1],e}function Pft(e,t){return e[0]=1/t[0],e[1]=1/t[1],e}function Rft(e,t){let r=t[0],i=t[1],s=r*r+i*i;return s>0&&(s=1/Math.sqrt(s)),e[0]=t[0]*s,e[1]=t[1]*s,e}function kft(e,t){return e[0]*t[0]+e[1]*t[1]}function Dft(e,t,r){let i=t[0]*r[1]-t[1]*r[0];return e[0]=e[1]=0,e[2]=i,e}function Bft(e,t,r,i){let s=t[0],n=t[1];return e[0]=s+i*(r[0]-s),e[1]=n+i*(r[1]-n),e}function Oft(e,t){t=t===void 0?1:t;let r=jf()*2*Math.PI;return e[0]=Math.cos(r)*t,e[1]=Math.sin(r)*t,e}function Nft(e,t,r){let i=t[0],s=t[1];return e[0]=r[0]*i+r[2]*s,e[1]=r[1]*i+r[3]*s,e}function Fft(e,t,r){let i=t[0],s=t[1];return e[0]=r[0]*i+r[2]*s+r[4],e[1]=r[1]*i+r[3]*s+r[5],e}function Lft(e,t,r){let i=t[0],s=t[1];return e[0]=r[0]*i+r[3]*s+r[6],e[1]=r[1]*i+r[4]*s+r[7],e}function nk(e,t,r){let i=t[0],s=t[1];return e[0]=r[0]*i+r[4]*s+r[12],e[1]=r[1]*i+r[5]*s+r[13],e}function zft(e,t,r,i){let s=t[0]-r[0],n=t[1]-r[1],o=Math.sin(i),c=Math.cos(i);return e[0]=s*c-n*o+r[0],e[1]=s*o+n*c+r[1],e}function Uft(e,t){let r=e[0],i=e[1],s=t[0],n=t[1],o=Math.sqrt((r*r+i*i)*(s*s+n*n)),c=o&&(r*s+i*n)/o;return Math.acos(Math.min(Math.max(c,-1),1))}function Vft(e){return e[0]=0,e[1]=0,e}function jft(e){return`vec2(${e[0]}, ${e[1]})`}function $ft(e,t){return e[0]===t[0]&&e[1]===t[1]}function Hft(e,t){let r=e[0],i=e[1],s=t[0],n=t[1];return Math.abs(r-s)<=1e-6*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(i-n)<=1e-6*Math.max(1,Math.abs(i),Math.abs(n))}var Wft=CV,qft=TV,Yft=SV,Xft=EV,Zft=IV,Gft=MV,Qft=PV,Kft=function(){let e=wV();return function(t,r,i,s,n,o){let c,f;for(r||(r=2),i||(i=0),s?f=Math.min(s*r+i,t.length):f=t.length,c=i;c<f;c+=r)e[0]=t[c],e[1]=t[c+1],n(e,e,o),t[c]=e[0],t[c+1]=e[1];return t}}();function RV(e,t,r){let i=t[0],s=t[1],n=r[3]*i+r[7]*s||1;return e[0]=(r[0]*i+r[4]*s)/n,e[1]=(r[1]*i+r[5]*s)/n,e}function j5(e,t,r){let i=t[0],s=t[1],n=t[2],o=r[3]*i+r[7]*s+r[11]*n||1;return e[0]=(r[0]*i+r[4]*s+r[8]*n)/o,e[1]=(r[1]*i+r[5]*s+r[9]*n)/o,e[2]=(r[2]*i+r[6]*s+r[10]*n)/o,e}function kV(e,t,r){let i=t[0],s=t[1];return e[0]=r[0]*i+r[2]*s,e[1]=r[1]*i+r[3]*s,e[2]=t[2],e}var xy={};sl(xy,{add:()=>ipt,angle:()=>fk,bezier:()=>gpt,ceil:()=>npt,clone:()=>Jft,copy:()=>ept,create:()=>DV,cross:()=>ok,dist:()=>Ept,distance:()=>LV,div:()=>Spt,divide:()=>FV,dot:()=>sk,equals:()=>vpt,exactEquals:()=>bpt,floor:()=>spt,forEach:()=>Ppt,fromValues:()=>tpt,hermite:()=>mpt,inverse:()=>fpt,len:()=>Mpt,length:()=>BV,lerp:()=>dpt,max:()=>apt,min:()=>opt,mul:()=>Tpt,multiply:()=>NV,negate:()=>hpt,normalize:()=>ppt,random:()=>_pt,rotateX:()=>ck,rotateY:()=>uk,rotateZ:()=>hk,round:()=>lpt,scale:()=>cpt,scaleAndAdd:()=>upt,set:()=>rpt,slerp:()=>Apt,sqrDist:()=>Ipt,sqrLen:()=>Cpt,squaredDistance:()=>zV,squaredLength:()=>UV,str:()=>xpt,sub:()=>wpt,subtract:()=>OV,transformMat3:()=>ak,transformMat4:()=>ov,transformQuat:()=>lk,zero:()=>ypt});function DV(){let e=new oo(3);return oo!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function Jft(e){let t=new oo(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function BV(e){let t=e[0],r=e[1],i=e[2];return Math.sqrt(t*t+r*r+i*i)}function tpt(e,t,r){let i=new oo(3);return i[0]=e,i[1]=t,i[2]=r,i}function ept(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function rpt(e,t,r,i){return e[0]=t,e[1]=r,e[2]=i,e}function ipt(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e}function OV(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e}function NV(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e}function FV(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e}function npt(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e}function spt(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e}function opt(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e}function apt(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e}function lpt(e,t){return e[0]=Du(t[0]),e[1]=Du(t[1]),e[2]=Du(t[2]),e}function cpt(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e}function upt(e,t,r,i){return e[0]=t[0]+r[0]*i,e[1]=t[1]+r[1]*i,e[2]=t[2]+r[2]*i,e}function LV(e,t){let r=t[0]-e[0],i=t[1]-e[1],s=t[2]-e[2];return Math.sqrt(r*r+i*i+s*s)}function zV(e,t){let r=t[0]-e[0],i=t[1]-e[1],s=t[2]-e[2];return r*r+i*i+s*s}function UV(e){let t=e[0],r=e[1],i=e[2];return t*t+r*r+i*i}function hpt(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}function fpt(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e}function ppt(e,t){let r=t[0],i=t[1],s=t[2],n=r*r+i*i+s*s;return n>0&&(n=1/Math.sqrt(n)),e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e}function sk(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function ok(e,t,r){let i=t[0],s=t[1],n=t[2],o=r[0],c=r[1],f=r[2];return e[0]=s*f-n*c,e[1]=n*o-i*f,e[2]=i*c-s*o,e}function dpt(e,t,r,i){let s=t[0],n=t[1],o=t[2];return e[0]=s+i*(r[0]-s),e[1]=n+i*(r[1]-n),e[2]=o+i*(r[2]-o),e}function Apt(e,t,r,i){let s=Math.acos(Math.min(Math.max(sk(t,r),-1),1)),n=Math.sin(s),o=Math.sin((1-i)*s)/n,c=Math.sin(i*s)/n;return e[0]=o*t[0]+c*r[0],e[1]=o*t[1]+c*r[1],e[2]=o*t[2]+c*r[2],e}function mpt(e,t,r,i,s,n){let o=n*n,c=o*(2*n-3)+1,f=o*(n-2)+n,p=o*(n-1),x=o*(3-2*n);return e[0]=t[0]*c+r[0]*f+i[0]*p+s[0]*x,e[1]=t[1]*c+r[1]*f+i[1]*p+s[1]*x,e[2]=t[2]*c+r[2]*f+i[2]*p+s[2]*x,e}function gpt(e,t,r,i,s,n){let o=1-n,c=o*o,f=n*n,p=c*o,x=3*n*c,E=3*f*o,T=f*n;return e[0]=t[0]*p+r[0]*x+i[0]*E+s[0]*T,e[1]=t[1]*p+r[1]*x+i[1]*E+s[1]*T,e[2]=t[2]*p+r[2]*x+i[2]*E+s[2]*T,e}function _pt(e,t){t=t===void 0?1:t;let r=jf()*2*Math.PI,i=jf()*2-1,s=Math.sqrt(1-i*i)*t;return e[0]=Math.cos(r)*s,e[1]=Math.sin(r)*s,e[2]=i*t,e}function ov(e,t,r){let i=t[0],s=t[1],n=t[2],o=r[3]*i+r[7]*s+r[11]*n+r[15];return o=o||1,e[0]=(r[0]*i+r[4]*s+r[8]*n+r[12])/o,e[1]=(r[1]*i+r[5]*s+r[9]*n+r[13])/o,e[2]=(r[2]*i+r[6]*s+r[10]*n+r[14])/o,e}function ak(e,t,r){let i=t[0],s=t[1],n=t[2];return e[0]=i*r[0]+s*r[3]+n*r[6],e[1]=i*r[1]+s*r[4]+n*r[7],e[2]=i*r[2]+s*r[5]+n*r[8],e}function lk(e,t,r){let i=r[0],s=r[1],n=r[2],o=r[3],c=t[0],f=t[1],p=t[2],x=s*p-n*f,E=n*c-i*p,T=i*f-s*c,D=s*T-n*E,N=n*x-i*T,z=i*E-s*x,U=o*2;return x*=U,E*=U,T*=U,D*=2,N*=2,z*=2,e[0]=c+x+D,e[1]=f+E+N,e[2]=p+T+z,e}function ck(e,t,r,i){let s=[],n=[];return s[0]=t[0]-r[0],s[1]=t[1]-r[1],s[2]=t[2]-r[2],n[0]=s[0],n[1]=s[1]*Math.cos(i)-s[2]*Math.sin(i),n[2]=s[1]*Math.sin(i)+s[2]*Math.cos(i),e[0]=n[0]+r[0],e[1]=n[1]+r[1],e[2]=n[2]+r[2],e}function uk(e,t,r,i){let s=[],n=[];return s[0]=t[0]-r[0],s[1]=t[1]-r[1],s[2]=t[2]-r[2],n[0]=s[2]*Math.sin(i)+s[0]*Math.cos(i),n[1]=s[1],n[2]=s[2]*Math.cos(i)-s[0]*Math.sin(i),e[0]=n[0]+r[0],e[1]=n[1]+r[1],e[2]=n[2]+r[2],e}function hk(e,t,r,i){let s=[],n=[];return s[0]=t[0]-r[0],s[1]=t[1]-r[1],s[2]=t[2]-r[2],n[0]=s[0]*Math.cos(i)-s[1]*Math.sin(i),n[1]=s[0]*Math.sin(i)+s[1]*Math.cos(i),n[2]=s[2],e[0]=n[0]+r[0],e[1]=n[1]+r[1],e[2]=n[2]+r[2],e}function fk(e,t){let r=e[0],i=e[1],s=e[2],n=t[0],o=t[1],c=t[2],f=Math.sqrt((r*r+i*i+s*s)*(n*n+o*o+c*c)),p=f&&sk(e,t)/f;return Math.acos(Math.min(Math.max(p,-1),1))}function ypt(e){return e[0]=0,e[1]=0,e[2]=0,e}function xpt(e){return`vec3(${e[0]}, ${e[1]}, ${e[2]})`}function bpt(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}function vpt(e,t){let r=e[0],i=e[1],s=e[2],n=t[0],o=t[1],c=t[2];return Math.abs(r-n)<=1e-6*Math.max(1,Math.abs(r),Math.abs(n))&&Math.abs(i-o)<=1e-6*Math.max(1,Math.abs(i),Math.abs(o))&&Math.abs(s-c)<=1e-6*Math.max(1,Math.abs(s),Math.abs(c))}var wpt=OV,Tpt=NV,Spt=FV,Ept=LV,Ipt=zV,Mpt=BV,Cpt=UV,Ppt=function(){let e=DV();return function(t,r,i,s,n,o){let c,f;for(r||(r=3),i||(i=0),s?f=Math.min(s*r+i,t.length):f=t.length,c=i;c<f;c+=r)e[0]=t[c],e[1]=t[c+1],e[2]=t[c+2],n(e,e,o),t[c]=e[0],t[c+1]=e[1],t[c+2]=e[2];return t}}();var pk=[0,0,0],$5,ll=class e extends U5{static get ZERO(){return $5||($5=new e(0,0,0),Object.freeze($5)),$5}constructor(t=0,r=0,i=0){super(-0,-0,-0),arguments.length===1&&bd(t)?this.copy(t):(ha.debug&&(al(t),al(r),al(i)),this[0]=t,this[1]=r,this[2]=i)}set(t,r,i){return this[0]=t,this[1]=r,this[2]=i,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this.check()}fromObject(t){return ha.debug&&(al(t.x),al(t.y),al(t.z)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this.check()}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t}get ELEMENTS(){return 3}get z(){return this[2]}set z(t){this[2]=al(t)}angle(t){return fk(this,t)}cross(t){return ok(this,this,t),this.check()}rotateX({radians:t,origin:r=pk}){return ck(this,this,r,t),this.check()}rotateY({radians:t,origin:r=pk}){return uk(this,this,r,t),this.check()}rotateZ({radians:t,origin:r=pk}){return hk(this,this,r,t),this.check()}transform(t){return this.transformAsPoint(t)}transformAsPoint(t){return ov(this,this,t),this.check()}transformAsVector(t){return j5(this,this,t),this.check()}transformByMatrix3(t){return ak(this,this,t),this.check()}transformByMatrix2(t){return kV(this,this,t),this.check()}transformByQuaternion(t){return lk(this,this,t),this.check()}};var H5=class extends yy{toString(){let t="[";if(ha.printRowMajor){t+="row-major:";for(let r=0;r<this.RANK;++r)for(let i=0;i<this.RANK;++i)t+=` ${this[i*this.RANK+r]}`}else{t+="column-major:";for(let r=0;r<this.ELEMENTS;++r)t+=` ${this[r]}`}return t+="]",t}getElementIndex(t,r){return r*this.RANK+t}getElement(t,r){return this[r*this.RANK+t]}setElement(t,r,i){return this[r*this.RANK+t]=al(i),this}getColumn(t,r=new Array(this.RANK).fill(-0)){let i=t*this.RANK;for(let s=0;s<this.RANK;++s)r[s]=this[i+s];return r}setColumn(t,r){let i=t*this.RANK;for(let s=0;s<this.RANK;++s)this[i+s]=r[s];return this}};var qo={};sl(qo,{add:()=>edt,adjoint:()=>Npt,clone:()=>kpt,copy:()=>Dpt,create:()=>Rpt,decompose:()=>qpt,determinant:()=>mk,equals:()=>sdt,exactEquals:()=>ndt,frob:()=>tdt,fromQuat:()=>wk,fromQuat2:()=>$pt,fromRotation:()=>zpt,fromRotationTranslation:()=>jV,fromRotationTranslationScale:()=>Ypt,fromRotationTranslationScaleOrigin:()=>Xpt,fromScaling:()=>Lpt,fromTranslation:()=>Fpt,fromValues:()=>Bpt,fromXRotation:()=>Upt,fromYRotation:()=>Vpt,fromZRotation:()=>jpt,frustum:()=>Tk,getRotation:()=>Wpt,getScaling:()=>$V,getTranslation:()=>Hpt,identity:()=>VV,invert:()=>Ak,lookAt:()=>Ik,mul:()=>odt,multiply:()=>av,multiplyScalar:()=>rdt,multiplyScalarAndAdd:()=>idt,ortho:()=>Ek,orthoNO:()=>WV,orthoZO:()=>Qpt,perspective:()=>Sk,perspectiveFromFieldOfView:()=>Gpt,perspectiveNO:()=>HV,perspectiveZO:()=>Zpt,rotate:()=>yk,rotateX:()=>xk,rotateY:()=>bk,rotateZ:()=>vk,scale:()=>_k,set:()=>Opt,str:()=>Jpt,sub:()=>adt,subtract:()=>qV,targetTo:()=>Kpt,translate:()=>gk,transpose:()=>dk});function Rpt(){let e=new oo(16);return oo!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function kpt(e){let t=new oo(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Dpt(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Bpt(e,t,r,i,s,n,o,c,f,p,x,E,T,D,N,z){let U=new oo(16);return U[0]=e,U[1]=t,U[2]=r,U[3]=i,U[4]=s,U[5]=n,U[6]=o,U[7]=c,U[8]=f,U[9]=p,U[10]=x,U[11]=E,U[12]=T,U[13]=D,U[14]=N,U[15]=z,U}function Opt(e,t,r,i,s,n,o,c,f,p,x,E,T,D,N,z,U){return e[0]=t,e[1]=r,e[2]=i,e[3]=s,e[4]=n,e[5]=o,e[6]=c,e[7]=f,e[8]=p,e[9]=x,e[10]=E,e[11]=T,e[12]=D,e[13]=N,e[14]=z,e[15]=U,e}function VV(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function dk(e,t){if(e===t){let r=t[1],i=t[2],s=t[3],n=t[6],o=t[7],c=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=r,e[6]=t[9],e[7]=t[13],e[8]=i,e[9]=n,e[11]=t[14],e[12]=s,e[13]=o,e[14]=c}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function Ak(e,t){let r=t[0],i=t[1],s=t[2],n=t[3],o=t[4],c=t[5],f=t[6],p=t[7],x=t[8],E=t[9],T=t[10],D=t[11],N=t[12],z=t[13],U=t[14],H=t[15],G=r*c-i*o,Z=r*f-s*o,Y=r*p-n*o,st=i*f-s*c,at=i*p-n*c,Dt=s*p-n*f,Tt=x*z-E*N,kt=x*U-T*N,Et=x*H-D*N,Mt=E*U-T*z,oe=E*H-D*z,Xt=T*H-D*U,xt=G*Xt-Z*oe+Y*Mt+st*Et-at*kt+Dt*Tt;return xt?(xt=1/xt,e[0]=(c*Xt-f*oe+p*Mt)*xt,e[1]=(s*oe-i*Xt-n*Mt)*xt,e[2]=(z*Dt-U*at+H*st)*xt,e[3]=(T*at-E*Dt-D*st)*xt,e[4]=(f*Et-o*Xt-p*kt)*xt,e[5]=(r*Xt-s*Et+n*kt)*xt,e[6]=(U*Y-N*Dt-H*Z)*xt,e[7]=(x*Dt-T*Y+D*Z)*xt,e[8]=(o*oe-c*Et+p*Tt)*xt,e[9]=(i*Et-r*oe-n*Tt)*xt,e[10]=(N*at-z*Y+H*G)*xt,e[11]=(E*Y-x*at-D*G)*xt,e[12]=(c*kt-o*Mt-f*Tt)*xt,e[13]=(r*Mt-i*kt+s*Tt)*xt,e[14]=(z*Z-N*st-U*G)*xt,e[15]=(x*st-E*Z+T*G)*xt,e):null}function Npt(e,t){let r=t[0],i=t[1],s=t[2],n=t[3],o=t[4],c=t[5],f=t[6],p=t[7],x=t[8],E=t[9],T=t[10],D=t[11],N=t[12],z=t[13],U=t[14],H=t[15],G=r*c-i*o,Z=r*f-s*o,Y=r*p-n*o,st=i*f-s*c,at=i*p-n*c,Dt=s*p-n*f,Tt=x*z-E*N,kt=x*U-T*N,Et=x*H-D*N,Mt=E*U-T*z,oe=E*H-D*z,Xt=T*H-D*U;return e[0]=c*Xt-f*oe+p*Mt,e[1]=s*oe-i*Xt-n*Mt,e[2]=z*Dt-U*at+H*st,e[3]=T*at-E*Dt-D*st,e[4]=f*Et-o*Xt-p*kt,e[5]=r*Xt-s*Et+n*kt,e[6]=U*Y-N*Dt-H*Z,e[7]=x*Dt-T*Y+D*Z,e[8]=o*oe-c*Et+p*Tt,e[9]=i*Et-r*oe-n*Tt,e[10]=N*at-z*Y+H*G,e[11]=E*Y-x*at-D*G,e[12]=c*kt-o*Mt-f*Tt,e[13]=r*Mt-i*kt+s*Tt,e[14]=z*Z-N*st-U*G,e[15]=x*st-E*Z+T*G,e}function mk(e){let t=e[0],r=e[1],i=e[2],s=e[3],n=e[4],o=e[5],c=e[6],f=e[7],p=e[8],x=e[9],E=e[10],T=e[11],D=e[12],N=e[13],z=e[14],U=e[15],H=t*o-r*n,G=t*c-i*n,Z=r*c-i*o,Y=p*N-x*D,st=p*z-E*D,at=x*z-E*N,Dt=t*at-r*st+i*Y,Tt=n*at-o*st+c*Y,kt=p*Z-x*G+E*H,Et=D*Z-N*G+z*H;return f*Dt-s*Tt+U*kt-T*Et}function av(e,t,r){let i=t[0],s=t[1],n=t[2],o=t[3],c=t[4],f=t[5],p=t[6],x=t[7],E=t[8],T=t[9],D=t[10],N=t[11],z=t[12],U=t[13],H=t[14],G=t[15],Z=r[0],Y=r[1],st=r[2],at=r[3];return e[0]=Z*i+Y*c+st*E+at*z,e[1]=Z*s+Y*f+st*T+at*U,e[2]=Z*n+Y*p+st*D+at*H,e[3]=Z*o+Y*x+st*N+at*G,Z=r[4],Y=r[5],st=r[6],at=r[7],e[4]=Z*i+Y*c+st*E+at*z,e[5]=Z*s+Y*f+st*T+at*U,e[6]=Z*n+Y*p+st*D+at*H,e[7]=Z*o+Y*x+st*N+at*G,Z=r[8],Y=r[9],st=r[10],at=r[11],e[8]=Z*i+Y*c+st*E+at*z,e[9]=Z*s+Y*f+st*T+at*U,e[10]=Z*n+Y*p+st*D+at*H,e[11]=Z*o+Y*x+st*N+at*G,Z=r[12],Y=r[13],st=r[14],at=r[15],e[12]=Z*i+Y*c+st*E+at*z,e[13]=Z*s+Y*f+st*T+at*U,e[14]=Z*n+Y*p+st*D+at*H,e[15]=Z*o+Y*x+st*N+at*G,e}function gk(e,t,r){let i=r[0],s=r[1],n=r[2],o,c,f,p,x,E,T,D,N,z,U,H;return t===e?(e[12]=t[0]*i+t[4]*s+t[8]*n+t[12],e[13]=t[1]*i+t[5]*s+t[9]*n+t[13],e[14]=t[2]*i+t[6]*s+t[10]*n+t[14],e[15]=t[3]*i+t[7]*s+t[11]*n+t[15]):(o=t[0],c=t[1],f=t[2],p=t[3],x=t[4],E=t[5],T=t[6],D=t[7],N=t[8],z=t[9],U=t[10],H=t[11],e[0]=o,e[1]=c,e[2]=f,e[3]=p,e[4]=x,e[5]=E,e[6]=T,e[7]=D,e[8]=N,e[9]=z,e[10]=U,e[11]=H,e[12]=o*i+x*s+N*n+t[12],e[13]=c*i+E*s+z*n+t[13],e[14]=f*i+T*s+U*n+t[14],e[15]=p*i+D*s+H*n+t[15]),e}function _k(e,t,r){let i=r[0],s=r[1],n=r[2];return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e[4]=t[4]*s,e[5]=t[5]*s,e[6]=t[6]*s,e[7]=t[7]*s,e[8]=t[8]*n,e[9]=t[9]*n,e[10]=t[10]*n,e[11]=t[11]*n,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function yk(e,t,r,i){let s=i[0],n=i[1],o=i[2],c=Math.sqrt(s*s+n*n+o*o),f,p,x,E,T,D,N,z,U,H,G,Z,Y,st,at,Dt,Tt,kt,Et,Mt,oe,Xt,xt,jt;return c<1e-6?null:(c=1/c,s*=c,n*=c,o*=c,p=Math.sin(r),f=Math.cos(r),x=1-f,E=t[0],T=t[1],D=t[2],N=t[3],z=t[4],U=t[5],H=t[6],G=t[7],Z=t[8],Y=t[9],st=t[10],at=t[11],Dt=s*s*x+f,Tt=n*s*x+o*p,kt=o*s*x-n*p,Et=s*n*x-o*p,Mt=n*n*x+f,oe=o*n*x+s*p,Xt=s*o*x+n*p,xt=n*o*x-s*p,jt=o*o*x+f,e[0]=E*Dt+z*Tt+Z*kt,e[1]=T*Dt+U*Tt+Y*kt,e[2]=D*Dt+H*Tt+st*kt,e[3]=N*Dt+G*Tt+at*kt,e[4]=E*Et+z*Mt+Z*oe,e[5]=T*Et+U*Mt+Y*oe,e[6]=D*Et+H*Mt+st*oe,e[7]=N*Et+G*Mt+at*oe,e[8]=E*Xt+z*xt+Z*jt,e[9]=T*Xt+U*xt+Y*jt,e[10]=D*Xt+H*xt+st*jt,e[11]=N*Xt+G*xt+at*jt,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function xk(e,t,r){let i=Math.sin(r),s=Math.cos(r),n=t[4],o=t[5],c=t[6],f=t[7],p=t[8],x=t[9],E=t[10],T=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=n*s+p*i,e[5]=o*s+x*i,e[6]=c*s+E*i,e[7]=f*s+T*i,e[8]=p*s-n*i,e[9]=x*s-o*i,e[10]=E*s-c*i,e[11]=T*s-f*i,e}function bk(e,t,r){let i=Math.sin(r),s=Math.cos(r),n=t[0],o=t[1],c=t[2],f=t[3],p=t[8],x=t[9],E=t[10],T=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=n*s-p*i,e[1]=o*s-x*i,e[2]=c*s-E*i,e[3]=f*s-T*i,e[8]=n*i+p*s,e[9]=o*i+x*s,e[10]=c*i+E*s,e[11]=f*i+T*s,e}function vk(e,t,r){let i=Math.sin(r),s=Math.cos(r),n=t[0],o=t[1],c=t[2],f=t[3],p=t[4],x=t[5],E=t[6],T=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=n*s+p*i,e[1]=o*s+x*i,e[2]=c*s+E*i,e[3]=f*s+T*i,e[4]=p*s-n*i,e[5]=x*s-o*i,e[6]=E*s-c*i,e[7]=T*s-f*i,e}function Fpt(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function Lpt(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function zpt(e,t,r){let i=r[0],s=r[1],n=r[2],o=Math.sqrt(i*i+s*s+n*n),c,f,p;return o<1e-6?null:(o=1/o,i*=o,s*=o,n*=o,f=Math.sin(t),c=Math.cos(t),p=1-c,e[0]=i*i*p+c,e[1]=s*i*p+n*f,e[2]=n*i*p-s*f,e[3]=0,e[4]=i*s*p-n*f,e[5]=s*s*p+c,e[6]=n*s*p+i*f,e[7]=0,e[8]=i*n*p+s*f,e[9]=s*n*p-i*f,e[10]=n*n*p+c,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function Upt(e,t){let r=Math.sin(t),i=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=i,e[6]=r,e[7]=0,e[8]=0,e[9]=-r,e[10]=i,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Vpt(e,t){let r=Math.sin(t),i=Math.cos(t);return e[0]=i,e[1]=0,e[2]=-r,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=r,e[9]=0,e[10]=i,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function jpt(e,t){let r=Math.sin(t),i=Math.cos(t);return e[0]=i,e[1]=r,e[2]=0,e[3]=0,e[4]=-r,e[5]=i,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function jV(e,t,r){let i=t[0],s=t[1],n=t[2],o=t[3],c=i+i,f=s+s,p=n+n,x=i*c,E=i*f,T=i*p,D=s*f,N=s*p,z=n*p,U=o*c,H=o*f,G=o*p;return e[0]=1-(D+z),e[1]=E+G,e[2]=T-H,e[3]=0,e[4]=E-G,e[5]=1-(x+z),e[6]=N+U,e[7]=0,e[8]=T+H,e[9]=N-U,e[10]=1-(x+D),e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function $pt(e,t){let r=new oo(3),i=-t[0],s=-t[1],n=-t[2],o=t[3],c=t[4],f=t[5],p=t[6],x=t[7],E=i*i+s*s+n*n+o*o;return E>0?(r[0]=(c*o+x*i+f*n-p*s)*2/E,r[1]=(f*o+x*s+p*i-c*n)*2/E,r[2]=(p*o+x*n+c*s-f*i)*2/E):(r[0]=(c*o+x*i+f*n-p*s)*2,r[1]=(f*o+x*s+p*i-c*n)*2,r[2]=(p*o+x*n+c*s-f*i)*2),jV(e,t,r),e}function Hpt(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function $V(e,t){let r=t[0],i=t[1],s=t[2],n=t[4],o=t[5],c=t[6],f=t[8],p=t[9],x=t[10];return e[0]=Math.sqrt(r*r+i*i+s*s),e[1]=Math.sqrt(n*n+o*o+c*c),e[2]=Math.sqrt(f*f+p*p+x*x),e}function Wpt(e,t){let r=new oo(3);$V(r,t);let i=1/r[0],s=1/r[1],n=1/r[2],o=t[0]*i,c=t[1]*s,f=t[2]*n,p=t[4]*i,x=t[5]*s,E=t[6]*n,T=t[8]*i,D=t[9]*s,N=t[10]*n,z=o+x+N,U=0;return z>0?(U=Math.sqrt(z+1)*2,e[3]=.25*U,e[0]=(E-D)/U,e[1]=(T-f)/U,e[2]=(c-p)/U):o>x&&o>N?(U=Math.sqrt(1+o-x-N)*2,e[3]=(E-D)/U,e[0]=.25*U,e[1]=(c+p)/U,e[2]=(T+f)/U):x>N?(U=Math.sqrt(1+x-o-N)*2,e[3]=(T-f)/U,e[0]=(c+p)/U,e[1]=.25*U,e[2]=(E+D)/U):(U=Math.sqrt(1+N-o-x)*2,e[3]=(c-p)/U,e[0]=(T+f)/U,e[1]=(E+D)/U,e[2]=.25*U),e}function qpt(e,t,r,i){t[0]=i[12],t[1]=i[13],t[2]=i[14];let s=i[0],n=i[1],o=i[2],c=i[4],f=i[5],p=i[6],x=i[8],E=i[9],T=i[10];r[0]=Math.sqrt(s*s+n*n+o*o),r[1]=Math.sqrt(c*c+f*f+p*p),r[2]=Math.sqrt(x*x+E*E+T*T);let D=1/r[0],N=1/r[1],z=1/r[2],U=s*D,H=n*N,G=o*z,Z=c*D,Y=f*N,st=p*z,at=x*D,Dt=E*N,Tt=T*z,kt=U+Y+Tt,Et=0;return kt>0?(Et=Math.sqrt(kt+1)*2,e[3]=.25*Et,e[0]=(st-Dt)/Et,e[1]=(at-G)/Et,e[2]=(H-Z)/Et):U>Y&&U>Tt?(Et=Math.sqrt(1+U-Y-Tt)*2,e[3]=(st-Dt)/Et,e[0]=.25*Et,e[1]=(H+Z)/Et,e[2]=(at+G)/Et):Y>Tt?(Et=Math.sqrt(1+Y-U-Tt)*2,e[3]=(at-G)/Et,e[0]=(H+Z)/Et,e[1]=.25*Et,e[2]=(st+Dt)/Et):(Et=Math.sqrt(1+Tt-U-Y)*2,e[3]=(H-Z)/Et,e[0]=(at+G)/Et,e[1]=(st+Dt)/Et,e[2]=.25*Et),e}function Ypt(e,t,r,i){let s=t[0],n=t[1],o=t[2],c=t[3],f=s+s,p=n+n,x=o+o,E=s*f,T=s*p,D=s*x,N=n*p,z=n*x,U=o*x,H=c*f,G=c*p,Z=c*x,Y=i[0],st=i[1],at=i[2];return e[0]=(1-(N+U))*Y,e[1]=(T+Z)*Y,e[2]=(D-G)*Y,e[3]=0,e[4]=(T-Z)*st,e[5]=(1-(E+U))*st,e[6]=(z+H)*st,e[7]=0,e[8]=(D+G)*at,e[9]=(z-H)*at,e[10]=(1-(E+N))*at,e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function Xpt(e,t,r,i,s){let n=t[0],o=t[1],c=t[2],f=t[3],p=n+n,x=o+o,E=c+c,T=n*p,D=n*x,N=n*E,z=o*x,U=o*E,H=c*E,G=f*p,Z=f*x,Y=f*E,st=i[0],at=i[1],Dt=i[2],Tt=s[0],kt=s[1],Et=s[2],Mt=(1-(z+H))*st,oe=(D+Y)*st,Xt=(N-Z)*st,xt=(D-Y)*at,jt=(1-(T+H))*at,Wt=(U+G)*at,de=(N+Z)*Dt,Ee=(U-G)*Dt,Se=(1-(T+z))*Dt;return e[0]=Mt,e[1]=oe,e[2]=Xt,e[3]=0,e[4]=xt,e[5]=jt,e[6]=Wt,e[7]=0,e[8]=de,e[9]=Ee,e[10]=Se,e[11]=0,e[12]=r[0]+Tt-(Mt*Tt+xt*kt+de*Et),e[13]=r[1]+kt-(oe*Tt+jt*kt+Ee*Et),e[14]=r[2]+Et-(Xt*Tt+Wt*kt+Se*Et),e[15]=1,e}function wk(e,t){let r=t[0],i=t[1],s=t[2],n=t[3],o=r+r,c=i+i,f=s+s,p=r*o,x=i*o,E=i*c,T=s*o,D=s*c,N=s*f,z=n*o,U=n*c,H=n*f;return e[0]=1-E-N,e[1]=x+H,e[2]=T-U,e[3]=0,e[4]=x-H,e[5]=1-p-N,e[6]=D+z,e[7]=0,e[8]=T+U,e[9]=D-z,e[10]=1-p-E,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Tk(e,t,r,i,s,n,o){let c=1/(r-t),f=1/(s-i),p=1/(n-o);return e[0]=n*2*c,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n*2*f,e[6]=0,e[7]=0,e[8]=(r+t)*c,e[9]=(s+i)*f,e[10]=(o+n)*p,e[11]=-1,e[12]=0,e[13]=0,e[14]=o*n*2*p,e[15]=0,e}function HV(e,t,r,i,s){let n=1/Math.tan(t/2);if(e[0]=n/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,s!=null&&s!==1/0){let o=1/(i-s);e[10]=(s+i)*o,e[14]=2*s*i*o}else e[10]=-1,e[14]=-2*i;return e}var Sk=HV;function Zpt(e,t,r,i,s){let n=1/Math.tan(t/2);if(e[0]=n/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,s!=null&&s!==1/0){let o=1/(i-s);e[10]=s*o,e[14]=s*i*o}else e[10]=-1,e[14]=-i;return e}function Gpt(e,t,r,i){let s=Math.tan(t.upDegrees*Math.PI/180),n=Math.tan(t.downDegrees*Math.PI/180),o=Math.tan(t.leftDegrees*Math.PI/180),c=Math.tan(t.rightDegrees*Math.PI/180),f=2/(o+c),p=2/(s+n);return e[0]=f,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=p,e[6]=0,e[7]=0,e[8]=-((o-c)*f*.5),e[9]=(s-n)*p*.5,e[10]=i/(r-i),e[11]=-1,e[12]=0,e[13]=0,e[14]=i*r/(r-i),e[15]=0,e}function WV(e,t,r,i,s,n,o){let c=1/(t-r),f=1/(i-s),p=1/(n-o);return e[0]=-2*c,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*f,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*p,e[11]=0,e[12]=(t+r)*c,e[13]=(s+i)*f,e[14]=(o+n)*p,e[15]=1,e}var Ek=WV;function Qpt(e,t,r,i,s,n,o){let c=1/(t-r),f=1/(i-s),p=1/(n-o);return e[0]=-2*c,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*f,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=p,e[11]=0,e[12]=(t+r)*c,e[13]=(s+i)*f,e[14]=n*p,e[15]=1,e}function Ik(e,t,r,i){let s,n,o,c,f,p,x,E,T,D,N=t[0],z=t[1],U=t[2],H=i[0],G=i[1],Z=i[2],Y=r[0],st=r[1],at=r[2];return Math.abs(N-Y)<1e-6&&Math.abs(z-st)<1e-6&&Math.abs(U-at)<1e-6?VV(e):(E=N-Y,T=z-st,D=U-at,s=1/Math.sqrt(E*E+T*T+D*D),E*=s,T*=s,D*=s,n=G*D-Z*T,o=Z*E-H*D,c=H*T-G*E,s=Math.sqrt(n*n+o*o+c*c),s?(s=1/s,n*=s,o*=s,c*=s):(n=0,o=0,c=0),f=T*c-D*o,p=D*n-E*c,x=E*o-T*n,s=Math.sqrt(f*f+p*p+x*x),s?(s=1/s,f*=s,p*=s,x*=s):(f=0,p=0,x=0),e[0]=n,e[1]=f,e[2]=E,e[3]=0,e[4]=o,e[5]=p,e[6]=T,e[7]=0,e[8]=c,e[9]=x,e[10]=D,e[11]=0,e[12]=-(n*N+o*z+c*U),e[13]=-(f*N+p*z+x*U),e[14]=-(E*N+T*z+D*U),e[15]=1,e)}function Kpt(e,t,r,i){let s=t[0],n=t[1],o=t[2],c=i[0],f=i[1],p=i[2],x=s-r[0],E=n-r[1],T=o-r[2],D=x*x+E*E+T*T;D>0&&(D=1/Math.sqrt(D),x*=D,E*=D,T*=D);let N=f*T-p*E,z=p*x-c*T,U=c*E-f*x;return D=N*N+z*z+U*U,D>0&&(D=1/Math.sqrt(D),N*=D,z*=D,U*=D),e[0]=N,e[1]=z,e[2]=U,e[3]=0,e[4]=E*U-T*z,e[5]=T*N-x*U,e[6]=x*z-E*N,e[7]=0,e[8]=x,e[9]=E,e[10]=T,e[11]=0,e[12]=s,e[13]=n,e[14]=o,e[15]=1,e}function Jpt(e){return`mat4(${e[0]}, ${e[1]}, ${e[2]}, ${e[3]}, ${e[4]}, ${e[5]}, ${e[6]}, ${e[7]}, ${e[8]}, ${e[9]}, ${e[10]}, ${e[11]}, ${e[12]}, ${e[13]}, ${e[14]}, ${e[15]})`}function tdt(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]+e[3]*e[3]+e[4]*e[4]+e[5]*e[5]+e[6]*e[6]+e[7]*e[7]+e[8]*e[8]+e[9]*e[9]+e[10]*e[10]+e[11]*e[11]+e[12]*e[12]+e[13]*e[13]+e[14]*e[14]+e[15]*e[15])}function edt(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e[9]=t[9]+r[9],e[10]=t[10]+r[10],e[11]=t[11]+r[11],e[12]=t[12]+r[12],e[13]=t[13]+r[13],e[14]=t[14]+r[14],e[15]=t[15]+r[15],e}function qV(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e[9]=t[9]-r[9],e[10]=t[10]-r[10],e[11]=t[11]-r[11],e[12]=t[12]-r[12],e[13]=t[13]-r[13],e[14]=t[14]-r[14],e[15]=t[15]-r[15],e}function rdt(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e[9]=t[9]*r,e[10]=t[10]*r,e[11]=t[11]*r,e[12]=t[12]*r,e[13]=t[13]*r,e[14]=t[14]*r,e[15]=t[15]*r,e}function idt(e,t,r,i){return e[0]=t[0]+r[0]*i,e[1]=t[1]+r[1]*i,e[2]=t[2]+r[2]*i,e[3]=t[3]+r[3]*i,e[4]=t[4]+r[4]*i,e[5]=t[5]+r[5]*i,e[6]=t[6]+r[6]*i,e[7]=t[7]+r[7]*i,e[8]=t[8]+r[8]*i,e[9]=t[9]+r[9]*i,e[10]=t[10]+r[10]*i,e[11]=t[11]+r[11]*i,e[12]=t[12]+r[12]*i,e[13]=t[13]+r[13]*i,e[14]=t[14]+r[14]*i,e[15]=t[15]+r[15]*i,e}function ndt(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]}function sdt(e,t){let r=e[0],i=e[1],s=e[2],n=e[3],o=e[4],c=e[5],f=e[6],p=e[7],x=e[8],E=e[9],T=e[10],D=e[11],N=e[12],z=e[13],U=e[14],H=e[15],G=t[0],Z=t[1],Y=t[2],st=t[3],at=t[4],Dt=t[5],Tt=t[6],kt=t[7],Et=t[8],Mt=t[9],oe=t[10],Xt=t[11],xt=t[12],jt=t[13],Wt=t[14],de=t[15];return Math.abs(r-G)<=1e-6*Math.max(1,Math.abs(r),Math.abs(G))&&Math.abs(i-Z)<=1e-6*Math.max(1,Math.abs(i),Math.abs(Z))&&Math.abs(s-Y)<=1e-6*Math.max(1,Math.abs(s),Math.abs(Y))&&Math.abs(n-st)<=1e-6*Math.max(1,Math.abs(n),Math.abs(st))&&Math.abs(o-at)<=1e-6*Math.max(1,Math.abs(o),Math.abs(at))&&Math.abs(c-Dt)<=1e-6*Math.max(1,Math.abs(c),Math.abs(Dt))&&Math.abs(f-Tt)<=1e-6*Math.max(1,Math.abs(f),Math.abs(Tt))&&Math.abs(p-kt)<=1e-6*Math.max(1,Math.abs(p),Math.abs(kt))&&Math.abs(x-Et)<=1e-6*Math.max(1,Math.abs(x),Math.abs(Et))&&Math.abs(E-Mt)<=1e-6*Math.max(1,Math.abs(E),Math.abs(Mt))&&Math.abs(T-oe)<=1e-6*Math.max(1,Math.abs(T),Math.abs(oe))&&Math.abs(D-Xt)<=1e-6*Math.max(1,Math.abs(D),Math.abs(Xt))&&Math.abs(N-xt)<=1e-6*Math.max(1,Math.abs(N),Math.abs(xt))&&Math.abs(z-jt)<=1e-6*Math.max(1,Math.abs(z),Math.abs(jt))&&Math.abs(U-Wt)<=1e-6*Math.max(1,Math.abs(U),Math.abs(Wt))&&Math.abs(H-de)<=1e-6*Math.max(1,Math.abs(H),Math.abs(de))}var odt=av,adt=qV;var Hf={};sl(Hf,{add:()=>fdt,ceil:()=>pdt,clone:()=>ldt,copy:()=>udt,create:()=>YV,cross:()=>Tdt,dist:()=>Odt,distance:()=>QV,div:()=>Bdt,divide:()=>GV,dot:()=>wdt,equals:()=>Rdt,exactEquals:()=>Pdt,floor:()=>ddt,forEach:()=>zdt,fromValues:()=>cdt,inverse:()=>bdt,len:()=>Fdt,length:()=>JV,lerp:()=>Sdt,max:()=>mdt,min:()=>Adt,mul:()=>Ddt,multiply:()=>ZV,negate:()=>xdt,normalize:()=>vdt,random:()=>Edt,round:()=>gdt,scale:()=>_dt,scaleAndAdd:()=>ydt,set:()=>hdt,sqrDist:()=>Ndt,sqrLen:()=>Ldt,squaredDistance:()=>KV,squaredLength:()=>tj,str:()=>Cdt,sub:()=>kdt,subtract:()=>XV,transformMat4:()=>Mk,transformQuat:()=>Idt,zero:()=>Mdt});function YV(){let e=new oo(4);return oo!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function ldt(e){let t=new oo(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function cdt(e,t,r,i){let s=new oo(4);return s[0]=e,s[1]=t,s[2]=r,s[3]=i,s}function udt(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function hdt(e,t,r,i,s){return e[0]=t,e[1]=r,e[2]=i,e[3]=s,e}function fdt(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e}function XV(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e}function ZV(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e[3]=t[3]*r[3],e}function GV(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e[3]=t[3]/r[3],e}function pdt(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e}function ddt(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e}function Adt(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e[3]=Math.min(t[3],r[3]),e}function mdt(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e[3]=Math.max(t[3],r[3]),e}function gdt(e,t){return e[0]=Du(t[0]),e[1]=Du(t[1]),e[2]=Du(t[2]),e[3]=Du(t[3]),e}function _dt(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e}function ydt(e,t,r,i){return e[0]=t[0]+r[0]*i,e[1]=t[1]+r[1]*i,e[2]=t[2]+r[2]*i,e[3]=t[3]+r[3]*i,e}function QV(e,t){let r=t[0]-e[0],i=t[1]-e[1],s=t[2]-e[2],n=t[3]-e[3];return Math.sqrt(r*r+i*i+s*s+n*n)}function KV(e,t){let r=t[0]-e[0],i=t[1]-e[1],s=t[2]-e[2],n=t[3]-e[3];return r*r+i*i+s*s+n*n}function JV(e){let t=e[0],r=e[1],i=e[2],s=e[3];return Math.sqrt(t*t+r*r+i*i+s*s)}function tj(e){let t=e[0],r=e[1],i=e[2],s=e[3];return t*t+r*r+i*i+s*s}function xdt(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e}function bdt(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e}function vdt(e,t){let r=t[0],i=t[1],s=t[2],n=t[3],o=r*r+i*i+s*s+n*n;return o>0&&(o=1/Math.sqrt(o)),e[0]=r*o,e[1]=i*o,e[2]=s*o,e[3]=n*o,e}function wdt(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function Tdt(e,t,r,i){let s=r[0]*i[1]-r[1]*i[0],n=r[0]*i[2]-r[2]*i[0],o=r[0]*i[3]-r[3]*i[0],c=r[1]*i[2]-r[2]*i[1],f=r[1]*i[3]-r[3]*i[1],p=r[2]*i[3]-r[3]*i[2],x=t[0],E=t[1],T=t[2],D=t[3];return e[0]=E*p-T*f+D*c,e[1]=-(x*p)+T*o-D*n,e[2]=x*f-E*o+D*s,e[3]=-(x*c)+E*n-T*s,e}function Sdt(e,t,r,i){let s=t[0],n=t[1],o=t[2],c=t[3];return e[0]=s+i*(r[0]-s),e[1]=n+i*(r[1]-n),e[2]=o+i*(r[2]-o),e[3]=c+i*(r[3]-c),e}function Edt(e,t){t=t===void 0?1:t;let r,i,s,n,o,c;do r=jf()*2-1,i=jf()*2-1,o=r*r+i*i;while(o>=1);do s=jf()*2-1,n=jf()*2-1,c=s*s+n*n;while(c>=1);let f=Math.sqrt((1-o)/c);return e[0]=t*r,e[1]=t*i,e[2]=t*s*f,e[3]=t*n*f,e}function Mk(e,t,r){let i=t[0],s=t[1],n=t[2],o=t[3];return e[0]=r[0]*i+r[4]*s+r[8]*n+r[12]*o,e[1]=r[1]*i+r[5]*s+r[9]*n+r[13]*o,e[2]=r[2]*i+r[6]*s+r[10]*n+r[14]*o,e[3]=r[3]*i+r[7]*s+r[11]*n+r[15]*o,e}function Idt(e,t,r){let i=t[0],s=t[1],n=t[2],o=r[0],c=r[1],f=r[2],p=r[3],x=p*i+c*n-f*s,E=p*s+f*i-o*n,T=p*n+o*s-c*i,D=-o*i-c*s-f*n;return e[0]=x*p+D*-o+E*-f-T*-c,e[1]=E*p+D*-c+T*-o-x*-f,e[2]=T*p+D*-f+x*-c-E*-o,e[3]=t[3],e}function Mdt(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}function Cdt(e){return`vec4(${e[0]}, ${e[1]}, ${e[2]}, ${e[3]})`}function Pdt(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function Rdt(e,t){let r=e[0],i=e[1],s=e[2],n=e[3],o=t[0],c=t[1],f=t[2],p=t[3];return Math.abs(r-o)<=1e-6*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(i-c)<=1e-6*Math.max(1,Math.abs(i),Math.abs(c))&&Math.abs(s-f)<=1e-6*Math.max(1,Math.abs(s),Math.abs(f))&&Math.abs(n-p)<=1e-6*Math.max(1,Math.abs(n),Math.abs(p))}var kdt=XV,Ddt=ZV,Bdt=GV,Odt=QV,Ndt=KV,Fdt=JV,Ldt=tj,zdt=function(){let e=YV();return function(t,r,i,s,n,o){let c,f;for(r||(r=4),i||(i=0),s?f=Math.min(s*r+i,t.length):f=t.length,c=i;c<f;c+=r)e[0]=t[c],e[1]=t[c+1],e[2]=t[c+2],e[3]=t[c+3],n(e,e,o),t[c]=e[0],t[c+1]=e[1],t[c+2]=e[2],t[c+3]=e[3];return t}}();var Rk;(function(e){e[e.COL0ROW0=0]="COL0ROW0",e[e.COL0ROW1=1]="COL0ROW1",e[e.COL0ROW2=2]="COL0ROW2",e[e.COL0ROW3=3]="COL0ROW3",e[e.COL1ROW0=4]="COL1ROW0",e[e.COL1ROW1=5]="COL1ROW1",e[e.COL1ROW2=6]="COL1ROW2",e[e.COL1ROW3=7]="COL1ROW3",e[e.COL2ROW0=8]="COL2ROW0",e[e.COL2ROW1=9]="COL2ROW1",e[e.COL2ROW2=10]="COL2ROW2",e[e.COL2ROW3=11]="COL2ROW3",e[e.COL3ROW0=12]="COL3ROW0",e[e.COL3ROW1=13]="COL3ROW1",e[e.COL3ROW2=14]="COL3ROW2",e[e.COL3ROW3=15]="COL3ROW3"})(Rk||(Rk={}));var Udt=45*Math.PI/180,Vdt=1,Ck=.1,Pk=500,jdt=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),Da=class extends H5{static get IDENTITY(){return Hdt()}static get ZERO(){return $dt()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return Rk}constructor(t){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(t)?this.copy(t):this.identity()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this[9]=t[9],this[10]=t[10],this[11]=t[11],this[12]=t[12],this[13]=t[13],this[14]=t[14],this[15]=t[15],this.check()}set(t,r,i,s,n,o,c,f,p,x,E,T,D,N,z,U){return this[0]=t,this[1]=r,this[2]=i,this[3]=s,this[4]=n,this[5]=o,this[6]=c,this[7]=f,this[8]=p,this[9]=x,this[10]=E,this[11]=T,this[12]=D,this[13]=N,this[14]=z,this[15]=U,this.check()}setRowMajor(t,r,i,s,n,o,c,f,p,x,E,T,D,N,z,U){return this[0]=t,this[1]=n,this[2]=p,this[3]=D,this[4]=r,this[5]=o,this[6]=x,this[7]=N,this[8]=i,this[9]=c,this[10]=E,this[11]=z,this[12]=s,this[13]=f,this[14]=T,this[15]=U,this.check()}toRowMajor(t){return t[0]=this[0],t[1]=this[4],t[2]=this[8],t[3]=this[12],t[4]=this[1],t[5]=this[5],t[6]=this[9],t[7]=this[13],t[8]=this[2],t[9]=this[6],t[10]=this[10],t[11]=this[14],t[12]=this[3],t[13]=this[7],t[14]=this[11],t[15]=this[15],t}identity(){return this.copy(jdt)}fromObject(t){return this.check()}fromQuaternion(t){return wk(this,t),this.check()}frustum(t){let{left:r,right:i,bottom:s,top:n,near:o=Ck,far:c=Pk}=t;return c===1/0?Wdt(this,r,i,s,n,o):Tk(this,r,i,s,n,o,c),this.check()}lookAt(t){let{eye:r,center:i=[0,0,0],up:s=[0,1,0]}=t;return Ik(this,r,i,s),this.check()}ortho(t){let{left:r,right:i,bottom:s,top:n,near:o=Ck,far:c=Pk}=t;return Ek(this,r,i,s,n,o,c),this.check()}orthographic(t){let{fovy:r=Udt,aspect:i=Vdt,focalDistance:s=1,near:n=Ck,far:o=Pk}=t;ej(r);let c=r/2,f=s*Math.tan(c),p=f*i;return this.ortho({left:-p,right:p,bottom:-f,top:f,near:n,far:o})}perspective(t){let{fovy:r=45*Math.PI/180,aspect:i=1,near:s=.1,far:n=500}=t;return ej(r),Sk(this,r,i,s,n),this.check()}determinant(){return mk(this)}getScale(t=[-0,-0,-0]){return t[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),t[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),t[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),t}getTranslation(t=[-0,-0,-0]){return t[0]=this[12],t[1]=this[13],t[2]=this[14],t}getRotation(t,r){t=t||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],r=r||[-0,-0,-0];let i=this.getScale(r),s=1/i[0],n=1/i[1],o=1/i[2];return t[0]=this[0]*s,t[1]=this[1]*n,t[2]=this[2]*o,t[3]=0,t[4]=this[4]*s,t[5]=this[5]*n,t[6]=this[6]*o,t[7]=0,t[8]=this[8]*s,t[9]=this[9]*n,t[10]=this[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}getRotationMatrix3(t,r){t=t||[-0,-0,-0,-0,-0,-0,-0,-0,-0],r=r||[-0,-0,-0];let i=this.getScale(r),s=1/i[0],n=1/i[1],o=1/i[2];return t[0]=this[0]*s,t[1]=this[1]*n,t[2]=this[2]*o,t[3]=this[4]*s,t[4]=this[5]*n,t[5]=this[6]*o,t[6]=this[8]*s,t[7]=this[9]*n,t[8]=this[10]*o,t}transpose(){return dk(this,this),this.check()}invert(){return Ak(this,this),this.check()}multiplyLeft(t){return av(this,t,this),this.check()}multiplyRight(t){return av(this,this,t),this.check()}rotateX(t){return xk(this,this,t),this.check()}rotateY(t){return bk(this,this,t),this.check()}rotateZ(t){return vk(this,this,t),this.check()}rotateXYZ(t){return this.rotateX(t[0]).rotateY(t[1]).rotateZ(t[2])}rotateAxis(t,r){return yk(this,this,t,r),this.check()}scale(t){return _k(this,this,Array.isArray(t)?t:[t,t,t]),this.check()}translate(t){return gk(this,this,t),this.check()}transform(t,r){return t.length===4?(r=Mk(r||[-0,-0,-0,-0],t,this),z5(r,4),r):this.transformAsPoint(t,r)}transformAsPoint(t,r){let{length:i}=t,s;switch(i){case 2:s=nk(r||[-0,-0],t,this);break;case 3:s=ov(r||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return z5(s,t.length),s}transformAsVector(t,r){let i;switch(t.length){case 2:i=RV(r||[-0,-0],t,this);break;case 3:i=j5(r||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return z5(i,t.length),i}transformPoint(t,r){return this.transformAsPoint(t,r)}transformVector(t,r){return this.transformAsPoint(t,r)}transformDirection(t,r){return this.transformAsVector(t,r)}makeRotationX(t){return this.identity().rotateX(t)}makeTranslation(t,r,i){return this.identity().translate([t,r,i])}},W5,q5;function $dt(){return W5||(W5=new Da([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(W5)),W5}function Hdt(){return q5||(q5=new Da,Object.freeze(q5)),q5}function ej(e){if(e>Math.PI*2)throw Error("expected radians")}function Wdt(e,t,r,i,s,n){let o=2*n/(r-t),c=2*n/(s-i),f=(r+t)/(r-t),p=(s+i)/(s-i),x=-1,E=-1,T=-2*n;return e[0]=o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=c,e[6]=0,e[7]=0,e[8]=f,e[9]=p,e[10]=x,e[11]=E,e[12]=0,e[13]=0,e[14]=T,e[15]=0,e}var kk=`#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))
struct AmbientLight {
vec3 color;
};
struct PointLight {
vec3 color;
vec3 position;
vec3 attenuation;
};
struct DirectionalLight {
vec3 color;
vec3 direction;
};
uniform AmbientLight lighting_uAmbientLight;
uniform PointLight lighting_uPointLight[MAX_LIGHTS];
uniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];
uniform int lighting_uPointLightCount;
uniform int lighting_uDirectionalLightCount;
uniform bool lighting_uEnabled;
float getPointLightAttenuation(PointLight pointLight, float distance) {
return pointLight.attenuation.x
+ pointLight.attenuation.y * distance
+ pointLight.attenuation.z * distance * distance;
}
#endif
`;var qdt={lightSources:{}};function Dk(e={}){let{color:t=[0,0,0],intensity:r=1}=e;return t.map(i=>i*r/255)}function Ydt({ambientLight:e,pointLights:t=[],directionalLights:r=[]}){let i={};return e?i["lighting_uAmbientLight.color"]=Dk(e):i["lighting_uAmbientLight.color"]=[0,0,0],t.forEach((s,n)=>{i[`lighting_uPointLight[${n}].color`]=Dk(s),i[`lighting_uPointLight[${n}].position`]=s.position,i[`lighting_uPointLight[${n}].attenuation`]=s.attenuation||[1,0,0]}),i.lighting_uPointLightCount=t.length,r.forEach((s,n)=>{i[`lighting_uDirectionalLight[${n}].color`]=Dk(s),i[`lighting_uDirectionalLight[${n}].direction`]=s.direction}),i.lighting_uDirectionalLightCount=r.length,i}function rj(e=qdt){if("lightSources"in e){let{ambientLight:t,pointLights:r,directionalLights:i}=e.lightSources||{};return t||r&&r.length>0||i&&i.length>0?Object.assign({},Ydt({ambientLight:t,pointLights:r,directionalLights:i}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in e){let t={pointLights:[],directionalLights:[]};for(let r of e.lights||[])switch(r.type){case"ambient":t.ambientLight=r;break;case"directional":t.directionalLights?.push(r);break;case"point":t.pointLights?.push(r);break;default:}return rj({lightSources:t})}return{}}var Bk={name:"lights",vs:kk,fs:kk,getUniforms:rj,defines:{MAX_LIGHTS:3}};var Ok=`uniform float lighting_uAmbient;
uniform float lighting_uDiffuse;
uniform float lighting_uShininess;
uniform vec3  lighting_uSpecularColor;
vec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {
vec3 halfway_direction = normalize(light_direction + view_direction);
float lambertian = dot(light_direction, normal_worldspace);
float specular = 0.0;
if (lambertian > 0.0) {
float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);
specular = pow(specular_angle, lighting_uShininess);
}
lambertian = max(lambertian, 0.0);
return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;
}
vec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
vec3 lightColor = surfaceColor;
if (lighting_uEnabled) {
vec3 view_direction = normalize(cameraPosition - position_worldspace);
lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;
for (int i = 0; i < MAX_LIGHTS; i++) {
if (i >= lighting_uPointLightCount) {
break;
}
PointLight pointLight = lighting_uPointLight[i];
vec3 light_position_worldspace = pointLight.position;
vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
}
for (int i = 0; i < MAX_LIGHTS; i++) {
if (i >= lighting_uDirectionalLightCount) {
break;
}
DirectionalLight directionalLight = lighting_uDirectionalLight[i];
lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
}
}
return lightColor;
}
vec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
vec3 lightColor = vec3(0, 0, 0);
vec3 surfaceColor = vec3(0, 0, 0);
if (lighting_uEnabled) {
vec3 view_direction = normalize(cameraPosition - position_worldspace);
for (int i = 0; i < MAX_LIGHTS; i++) {
if (i >= lighting_uPointLightCount) {
break;
}
PointLight pointLight = lighting_uPointLight[i];
vec3 light_position_worldspace = pointLight.position;
vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
}
for (int i = 0; i < MAX_LIGHTS; i++) {
if (i >= lighting_uDirectionalLightCount) {
break;
}
DirectionalLight directionalLight = lighting_uDirectionalLight[i];
lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
}
}
return lightColor;
}
`;var Xdt={};function Zdt(e){let{ambient:t=.35,diffuse:r=.6,shininess:i=32,specularColor:s=[30,30,30]}=e;return{lighting_uAmbient:t,lighting_uDiffuse:r,lighting_uShininess:i,lighting_uSpecularColor:s.map(n=>n/255)}}function ij(e=Xdt){if(!("material"in e))return{};let{material:t}=e;return t?Zdt(t):{lighting_uEnabled:!1}}var Ig={name:"gouraud-lighting",dependencies:[Bk],vs:Ok,defines:{LIGHTING_VERTEX:1},getUniforms:ij},lv={name:"phong-lighting",dependencies:[Bk],fs:Ok,defines:{LIGHTING_FRAGMENT:1},getUniforms:ij};var nj="#define SMOOTH_EDGE_RADIUS 0.5",Gdt=`
${nj}

struct VertexGeometry {
  vec4 position;
  vec3 worldPosition;
  vec3 worldPositionAlt;
  vec3 normal;
  vec2 uv;
  vec3 pickingColor;
} geometry = VertexGeometry(
  vec4(0.0, 0.0, 1.0, 0.0),
  vec3(0.0),
  vec3(0.0),
  vec3(0.0),
  vec2(0.0),
  vec3(0.0)
);
`,Qdt=`
${nj}

struct FragmentGeometry {
  vec2 uv;
} geometry;

float smoothedge(float edge, float x) {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`,sj={name:"geometry",vs:Gdt,fs:Qdt};var en={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(en,"IDENTITY",{get:()=>(mi.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});var lc={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},wd={common:0,meters:1,pixels:2},cv={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}};var Kdt=Object.keys(en).map(e=>`const int COORDINATE_SYSTEM_${e} = ${en[e]};`).join(""),Jdt=Object.keys(lc).map(e=>`const int PROJECTION_MODE_${e} = ${lc[e]};`).join(""),t0t=Object.keys(wd).map(e=>`const int UNIT_${e.toUpperCase()} = ${wd[e]};`).join(""),oj=`${Kdt}
${Jdt}
${t0t}
uniform int project_uCoordinateSystem;
uniform int project_uProjectionMode;
uniform float project_uScale;
uniform bool project_uWrapLongitude;
uniform vec3 project_uCommonUnitsPerMeter;
uniform vec3 project_uCommonUnitsPerWorldUnit;
uniform vec3 project_uCommonUnitsPerWorldUnit2;
uniform vec4 project_uCenter;
uniform mat4 project_uModelMatrix;
uniform mat4 project_uViewProjectionMatrix;
uniform vec2 project_uViewportSize;
uniform float project_uDevicePixelRatio;
uniform float project_uFocalDistance;
uniform vec3 project_uCameraPosition;
uniform vec3 project_uCoordinateOrigin;
uniform vec3 project_uCommonOrigin;
uniform bool project_uPseudoMeters;
const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / (PI * 2.0);
const vec3 ZERO_64_LOW = vec3(0.0);
const float EARTH_RADIUS = 6370972.0;
const float GLOBE_RADIUS = 256.0;
float project_size_at_latitude(float lat) {
float y = clamp(lat, -89.9, 89.9);
return 1.0 / cos(radians(y));
}
float project_size() {
if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&
project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
project_uPseudoMeters == false) {
if (geometry.position.w == 0.0) {
return project_size_at_latitude(geometry.worldPosition.y);
}
float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
float y2 = y * y;
float y4 = y2 * y2;
float y6 = y4 * y2;
return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
}
return 1.0;
}
float project_size_at_latitude(float meters, float lat) {
return meters * project_uCommonUnitsPerMeter.z * project_size_at_latitude(lat);
}
float project_size(float meters) {
return meters * project_uCommonUnitsPerMeter.z * project_size();
}
vec2 project_size(vec2 meters) {
return meters * project_uCommonUnitsPerMeter.xy * project_size();
}
vec3 project_size(vec3 meters) {
return meters * project_uCommonUnitsPerMeter * project_size();
}
vec4 project_size(vec4 meters) {
return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);
}
mat3 project_get_orientation_matrix(vec3 up) {
vec3 uz = normalize(up);
vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));
vec3 uy = cross(uz, ux);
return mat3(ux, uy, uz);
}
bool project_needs_rotation(vec3 commonPosition, out mat3 transform) {
if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
transform = project_get_orientation_matrix(commonPosition);
return true;
}
return false;
}
vec3 project_normal(vec3 vector) {
vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);
vec3 n = normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);
mat3 rotation;
if (project_needs_rotation(geometry.position.xyz, rotation)) {
n = rotation * n;
}
return n;
}
vec4 project_offset_(vec4 offset) {
float dy = offset.y;
vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;
return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}
vec2 project_mercator_(vec2 lnglat) {
float x = lnglat.x;
if (project_uWrapLongitude) {
x = mod(x + 180., 360.0) - 180.;
}
float y = clamp(lnglat.y, -89.9, 89.9);
return vec2(
radians(x) + PI,
PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))
) * WORLD_SCALE;
}
vec3 project_globe_(vec3 lnglatz) {
float lambda = radians(lnglatz.x);
float phi = radians(lnglatz.y);
float cosPhi = cos(phi);
float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;
return vec3(
sin(lambda) * cosPhi,
-cos(lambda) * cosPhi,
sin(phi)
) * D;
}
vec4 project_position(vec4 position, vec3 position64Low) {
vec4 position_world = project_uModelMatrix * position;
if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {
if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
return vec4(
project_mercator_(position_world.xy),
project_size_at_latitude(position_world.z, position_world.y),
position_world.w
);
}
if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
position_world.xyz += project_uCoordinateOrigin;
}
}
if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
return vec4(
project_globe_(position_world.xyz),
position_world.w
);
}
}
if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {
return vec4(
project_mercator_(position_world.xy) - project_uCommonOrigin.xy,
project_size(position_world.z),
position_world.w
);
}
}
}
if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||
(project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
(project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
position_world.xyz -= project_uCoordinateOrigin;
}
return project_offset_(position_world) + project_offset_(project_uModelMatrix * vec4(position64Low, 0.0));
}
vec4 project_position(vec4 position) {
return project_position(position, ZERO_64_LOW);
}
vec3 project_position(vec3 position, vec3 position64Low) {
vec4 projected_position = project_position(vec4(position, 1.0), position64Low);
return projected_position.xyz;
}
vec3 project_position(vec3 position) {
vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);
return projected_position.xyz;
}
vec2 project_position(vec2 position) {
vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);
return projected_position.xy;
}
vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
return viewProjectionMatrix * position + center;
}
vec4 project_common_position_to_clipspace(vec4 position) {
return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;
return offset * project_uFocalDistance;
}
float project_size_to_pixel(float meters) {
return project_size(meters) * project_uScale;
}
float project_size_to_pixel(float size, int unit) {
if (unit == UNIT_METERS) return project_size_to_pixel(size);
if (unit == UNIT_COMMON) return size * project_uScale;
return size;
}
float project_pixel_size(float pixels) {
return pixels / project_uScale;
}
vec2 project_pixel_size(vec2 pixels) {
return pixels / project_uScale;
}
`;function e0t(e,t){if(e===t)return!0;if(Array.isArray(e)){let r=e.length;if(!t||t.length!==r)return!1;for(let i=0;i<r;i++)if(e[i]!==t[i])return!1;return!0}return!1}function Wf(e){let t={},r;return i=>{for(let s in i)if(!e0t(i[s],t[s])){r=e(i),t=i;break}return r}}var aj=[0,0,0,0],r0t=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],lj=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],i0t=[0,0,0],cj=[0,0,0],n0t=Wf(o0t);function Nk(e,t,r=cj){r.length<3&&(r=[r[0],r[1],0]);let i=r,s,n=!0;switch(t===en.LNGLAT_OFFSETS||t===en.METER_OFFSETS?s=r:s=e.isGeospatial?[Math.fround(e.longitude),Math.fround(e.latitude),0]:null,e.projectionMode){case lc.WEB_MERCATOR:(t===en.LNGLAT||t===en.CARTESIAN)&&(s=[0,0,0],n=!1);break;case lc.WEB_MERCATOR_AUTO_OFFSET:t===en.LNGLAT?i=s:t===en.CARTESIAN&&(i=[Math.fround(e.center[0]),Math.fround(e.center[1]),0],s=e.unprojectPosition(i),i[0]-=r[0],i[1]-=r[1],i[2]-=r[2]);break;case lc.IDENTITY:i=e.position.map(Math.fround),i[2]=i[2]||0;break;case lc.GLOBE:n=!1,s=null;break;default:n=!1}return{geospatialOrigin:s,shaderCoordinateOrigin:i,offsetMode:n}}function s0t(e,t,r){let{viewMatrixUncentered:i,projectionMatrix:s}=e,{viewMatrix:n,viewProjectionMatrix:o}=e,c=aj,f=aj,p=e.cameraPosition,{geospatialOrigin:x,shaderCoordinateOrigin:E,offsetMode:T}=Nk(e,t,r);return T&&(f=e.projectPosition(x||E),p=[p[0]-f[0],p[1]-f[1],p[2]-f[2]],f[3]=1,c=Hf.transformMat4([],f,o),n=i||n,o=qo.multiply([],s,n),o=qo.multiply([],o,r0t)),{viewMatrix:n,viewProjectionMatrix:o,projectionCenter:c,originCommon:f,cameraPosCommon:p,shaderCoordinateOrigin:E,geospatialOrigin:x}}function uj({viewport:e,devicePixelRatio:t=1,modelMatrix:r=null,coordinateSystem:i=en.DEFAULT,coordinateOrigin:s=cj,autoWrapLongitude:n=!1}){i===en.DEFAULT&&(i=e.isGeospatial?en.LNGLAT:en.CARTESIAN);let o=n0t({viewport:e,devicePixelRatio:t,coordinateSystem:i,coordinateOrigin:s});return o.project_uWrapLongitude=n,o.project_uModelMatrix=r||lj,o}function o0t({viewport:e,devicePixelRatio:t,coordinateSystem:r,coordinateOrigin:i}){let{projectionCenter:s,viewProjectionMatrix:n,originCommon:o,cameraPosCommon:c,shaderCoordinateOrigin:f,geospatialOrigin:p}=s0t(e,r,i),x=e.getDistanceScales(),E=[e.width*t,e.height*t],T=Hf.transformMat4([],[0,0,-e.focalDistance,1],e.projectionMatrix)[3]||1,D={project_uCoordinateSystem:r,project_uProjectionMode:e.projectionMode,project_uCoordinateOrigin:f,project_uCommonOrigin:o.slice(0,3),project_uCenter:s,project_uPseudoMeters:!!e._pseudoMeters,project_uViewportSize:E,project_uDevicePixelRatio:t,project_uFocalDistance:T,project_uCommonUnitsPerMeter:x.unitsPerMeter,project_uCommonUnitsPerWorldUnit:x.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:i0t,project_uScale:e.scale,project_uWrapLongitude:!1,project_uViewProjectionMatrix:n,project_uModelMatrix:lj,project_uCameraPosition:c};if(p){let N=e.getDistanceScales(p);switch(r){case en.METER_OFFSETS:D.project_uCommonUnitsPerWorldUnit=N.unitsPerMeter,D.project_uCommonUnitsPerWorldUnit2=N.unitsPerMeter2;break;case en.LNGLAT:case en.LNGLAT_OFFSETS:e._pseudoMeters||(D.project_uCommonUnitsPerMeter=N.unitsPerMeter),D.project_uCommonUnitsPerWorldUnit=N.unitsPerDegree,D.project_uCommonUnitsPerWorldUnit2=N.unitsPerDegree2;break;case en.CARTESIAN:D.project_uCommonUnitsPerWorldUnit=[1,1,N.unitsPerMeter[2]],D.project_uCommonUnitsPerWorldUnit2=[0,0,N.unitsPerMeter2[2]];break;default:break}}return D}var a0t={};function l0t(e=a0t){return"viewport"in e?uj(e):{}}var Mg={name:"project",dependencies:[JR,sj],vs:oj,getUniforms:l0t};var c0t=`
vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition
) {
  vec3 projectedPosition = project_position(position, position64Low);
  mat3 rotation;
  if (project_needs_rotation(projectedPosition, rotation)) {
    // offset is specified as ENU
    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe
    offset = rotation * offset;
  }
  commonPosition = vec4(projectedPosition + offset, 1.0);
  return project_common_position_to_clipspace(commonPosition);
}

vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset
) {
  vec4 commonPosition;
  return project_position_to_clipspace(position, position64Low, offset, commonPosition);
}
`,dA={name:"project32",dependencies:[Mg],vs:c0t};function Fk(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function AA(e,t){let r=Hf.transformMat4([],t,e);return Hf.scale(r,r,1/r[3]),r}function Lk(e,t){let r=e%t;return r<0?t+r:r}function uv(e,t,r){return e<t?t:e>r?r:e}function u0t(e){return Math.log(e)*Math.LOG2E}var by=Math.log2||u0t;function Dh(e,t){if(!e)throw new Error(t||"@math.gl/web-mercator: assertion failed.")}var Bh=Math.PI,hj=Bh/4,Bu=Bh/180,zk=180/Bh,vy=512,Y5=4003e4,wy=85.051129,fj=1.5;function Uk(e){return by(e)}function Oh(e){let[t,r]=e;Dh(Number.isFinite(t)),Dh(Number.isFinite(r)&&r>=-90&&r<=90,"invalid latitude");let i=t*Bu,s=r*Bu,n=vy*(i+Bh)/(2*Bh),o=vy*(Bh+Math.log(Math.tan(hj+s*.5)))/(2*Bh);return[n,o]}function Yc(e){let[t,r]=e,i=t/vy*(2*Bh)-Bh,s=2*(Math.atan(Math.exp(r/vy*(2*Bh)-Bh))-hj);return[i*zk,s*zk]}function Vk(e){let{latitude:t}=e;Dh(Number.isFinite(t));let r=Math.cos(t*Bu);return Uk(Y5*r)-9}function Pg(e){let t=Math.cos(e*Bu);return vy/Y5/t}function Ty(e){let{latitude:t,longitude:r,highPrecision:i=!1}=e;Dh(Number.isFinite(t)&&Number.isFinite(r));let s=vy,n=Math.cos(t*Bu),o=s/360,c=o/n,f=s/Y5/n,p={unitsPerMeter:[f,f,f],metersPerUnit:[1/f,1/f,1/f],unitsPerDegree:[o,c,f],degreesPerUnit:[1/o,1/c,1/f]};if(i){let x=Bu*Math.tan(t*Bu)/n,E=o*x/2,T=s/Y5*x,D=T/c*f;p.unitsPerDegree2=[0,E,T],p.unitsPerMeter2=[D,0,D]}return p}function hv(e,t){let[r,i,s]=e,[n,o,c]=t,{unitsPerMeter:f,unitsPerMeter2:p}=Ty({longitude:r,latitude:i,highPrecision:!0}),x=Oh(e);x[0]+=n*(f[0]+p[0]*o),x[1]+=o*(f[1]+p[1]*o);let E=Yc(x),T=(s||0)+(c||0);return Number.isFinite(s)||Number.isFinite(c)?[E[0],E[1],T]:E}function X5(e){let{height:t,pitch:r,bearing:i,altitude:s,scale:n,center:o}=e,c=Fk();qo.translate(c,c,[0,0,-s]),qo.rotateX(c,c,-r*Bu),qo.rotateZ(c,c,i*Bu);let f=n/t;return qo.scale(c,c,[f,f,f]),o&&qo.translate(c,c,xy.negate([],o)),c}function jk(e){let{width:t,height:r,altitude:i,pitch:s=0,offset:n,center:o,scale:c,nearZMultiplier:f=1,farZMultiplier:p=1}=e,{fovy:x=Cg(fj)}=e;i!==void 0&&(x=Cg(i));let E=x*Bu,T=s*Bu,D=fv(x),N=D;o&&(N+=o[2]*c/Math.cos(T)/r);let z=E*(.5+(n?n[1]:0)/r),U=Math.sin(z)*N/Math.sin(uv(Math.PI/2-T-z,.01,Math.PI-.01)),H=Math.sin(T)*U+N,G=N*10,Z=Math.min(H*p,G);return{fov:E,aspect:t/r,focalDistance:D,near:f,far:Z}}function Cg(e){return 2*Math.atan(.5/e)*zk}function fv(e){return .5/Math.tan(.5*e*Bu)}function Sy(e,t){let[r,i,s=0]=e;return Dh(Number.isFinite(r)&&Number.isFinite(i)&&Number.isFinite(s)),AA(t,[r,i,s,1])}function mA(e,t,r=0){let[i,s,n]=e;if(Dh(Number.isFinite(i)&&Number.isFinite(s),"invalid pixel coordinate"),Number.isFinite(n))return AA(t,[i,s,n,1]);let o=AA(t,[i,s,0,1]),c=AA(t,[i,s,1,1]),f=o[2],p=c[2],x=f===p?0:((r||0)-f)/(p-f);return $f.lerp([],o,c,x)}function Z5(e){let{width:t,height:r,bounds:i,minExtent:s=0,maxZoom:n=24,offset:o=[0,0]}=e,[[c,f],[p,x]]=i,E=h0t(e.padding),T=Oh([c,uv(x,-wy,wy)]),D=Oh([p,uv(f,-wy,wy)]),N=[Math.max(Math.abs(D[0]-T[0]),s),Math.max(Math.abs(D[1]-T[1]),s)],z=[t-E.left-E.right-Math.abs(o[0])*2,r-E.top-E.bottom-Math.abs(o[1])*2];Dh(z[0]>0&&z[1]>0);let U=z[0]/N[0],H=z[1]/N[1],G=(E.right-E.left)/2/U,Z=(E.top-E.bottom)/2/H,Y=[(D[0]+T[0])/2+G,(D[1]+T[1])/2+Z],st=Yc(Y),at=Math.min(n,by(Math.abs(Math.min(U,H))));return Dh(Number.isFinite(at)),{longitude:st[0],latitude:st[1],zoom:at}}function h0t(e=0){return typeof e=="number"?{top:e,bottom:e,left:e,right:e}:(Dh(Number.isFinite(e.top)&&Number.isFinite(e.bottom)&&Number.isFinite(e.left)&&Number.isFinite(e.right)),e)}var pj=Math.PI/180;function G5(e,t=0){let{width:r,height:i,unproject:s}=e,n={targetZ:t},o=s([0,i],n),c=s([r,i],n),f,p,x=e.fovy?.5*e.fovy*pj:Math.atan(.5/e.altitude),E=(90-e.pitch)*pj;return x>E-.01?(f=dj(e,0,t),p=dj(e,r,t)):(f=s([0,0],n),p=s([r,0],n)),[o,c,p,f]}function dj(e,t,r){let{pixelUnprojectionMatrix:i}=e,s=AA(i,[t,0,1,1]),n=AA(i,[t,e.height,1,1]),c=(r*e.distanceScales.unitsPerMeter[2]-s[2])/(n[2]-s[2]),f=$f.lerp([],s,n,c),p=Yc(f);return p.push(r),p}var mj=512;function $k(e){let{width:t,height:r,pitch:i=0}=e,{longitude:s,latitude:n,zoom:o,bearing:c=0}=e;(s<-180||s>180)&&(s=Lk(s+180,360)-180),(c<-180||c>180)&&(c=Lk(c+180,360)-180);let f=by(r/mj);if(o<=f)o=f,n=0;else{let p=r/2/Math.pow(2,o),x=Yc([0,p])[1];if(n<x)n=x;else{let E=Yc([0,mj-p])[1];n>E&&(n=E)}}return{width:t,height:r,longitude:s,latitude:n,zoom:o,pitch:i,bearing:c}}var d0t=`
const int max_lights = 2;
uniform mat4 shadow_uViewProjectionMatrices[max_lights];
uniform vec4 shadow_uProjectCenters[max_lights];
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform int shadow_uLightId;
uniform float shadow_uLightCount;

out vec3 shadow_vPosition[max_lights];

vec4 shadow_setVertexPosition(vec4 position_commonspace) {
  if (shadow_uDrawShadowMap) {
    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);
  }
  if (shadow_uUseShadowMap) {
    for (int i = 0; i < max_lights; i++) {
      if(i < int(shadow_uLightCount)) {
        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);
        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;
      }
    }
  }
  return gl_Position;
}
`,A0t=`
const int max_lights = 2;
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform sampler2D shadow_uShadowMap0;
uniform sampler2D shadow_uShadowMap1;
uniform vec4 shadow_uColor;
uniform float shadow_uLightCount;

in vec3 shadow_vPosition[max_lights];

const vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);
const vec4 bitUnpackShift = 1.0 / bitPackShift;
const vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);

float shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {
  vec4 rgbaDepth = texture(shadowMap, position.xy);

  float z = dot(rgbaDepth, bitUnpackShift);
  return smoothstep(0.001, 0.01, position.z - z);
}

vec4 shadow_filterShadowColor(vec4 color) {
  if (shadow_uDrawShadowMap) {
    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);
    rgbaDepth -= rgbaDepth.gbaa * bitMask;
    return rgbaDepth;
  }
  if (shadow_uUseShadowMap) {
    float shadowAlpha = 0.0;
    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);
    if(shadow_uLightCount > 1.0) {
      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);
    }
    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;
    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);

    return vec4(
      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),
      blendedAlpha
    );
  }
  return color;
}
`,m0t=Wf(b0t),g0t=Wf(v0t),_0t=[0,0,0,1],y0t=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];function x0t(e,t){let[r,i,s]=e,n=mA([r,i,s],t);return Number.isFinite(s)?n:[n[0],n[1],0]}function b0t({viewport:e,center:t}){return new Da(e.viewProjectionMatrix).invert().transform(t)}function v0t({viewport:e,shadowMatrices:t}){let r=[],i=e.pixelUnprojectionMatrix,s=e.isGeospatial?void 0:1,n=[[0,0,s],[e.width,0,s],[0,e.height,s],[e.width,e.height,s],[0,0,-1],[e.width,0,-1],[0,e.height,-1],[e.width,e.height,-1]].map(o=>x0t(o,i));for(let o of t){let c=o.clone().translate(new ll(e.center).negate()),f=n.map(x=>c.transform(x)),p=new Da().ortho({left:Math.min(...f.map(x=>x[0])),right:Math.max(...f.map(x=>x[0])),bottom:Math.min(...f.map(x=>x[1])),top:Math.max(...f.map(x=>x[1])),near:Math.min(...f.map(x=>-x[2])),far:Math.max(...f.map(x=>-x[2]))});r.push(p.multiplyRight(o))}return r}function w0t(e,t){let{shadowEnabled:r=!0}=e;if(!r||!e.shadowMatrices||!e.shadowMatrices.length)return{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1,shadow_uShadowMap0:e.dummyShadowMap,shadow_uShadowMap1:e.dummyShadowMap};let i={shadow_uDrawShadowMap:!!e.drawToShadowMap,shadow_uUseShadowMap:e.shadowMaps?e.shadowMaps.length>0:!1,shadow_uColor:e.shadowColor||_0t,shadow_uLightId:e.shadowLightId||0,shadow_uLightCount:e.shadowMatrices.length},s=m0t({viewport:e.viewport,center:t.project_uCenter}),n=[],o=g0t({shadowMatrices:e.shadowMatrices,viewport:e.viewport}).slice();for(let c=0;c<e.shadowMatrices.length;c++){let f=o[c],p=f.clone().translate(new ll(e.viewport.center).negate());t.project_uCoordinateSystem===en.LNGLAT&&t.project_uProjectionMode===lc.WEB_MERCATOR?(o[c]=p,n[c]=s):(o[c]=f.clone().multiplyRight(y0t),n[c]=p.transform(s))}for(let c=0;c<o.length;c++)i[`shadow_uViewProjectionMatrices[${c}]`]=o[c],i[`shadow_uProjectCenters[${c}]`]=n[c];for(let c=0;c<2;c++)i[`shadow_uShadowMap${c}`]=e.shadowMaps&&e.shadowMaps[c]||e.dummyShadowMap;return i}var Q5={name:"shadow",dependencies:[Mg],vs:d0t,fs:A0t,inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    position = shadow_setVertexPosition(geometry.position);
    `,"fs:DECKGL_FILTER_COLOR":`
    color = shadow_filterShadowColor(color);
    `},getUniforms:(e={},t={})=>"viewport"in e&&(e.drawToShadowMap||e.shadowMaps&&e.shadowMaps.length>0)?w0t(e,t):{}};var gA={...L5,defaultUniforms:{...L5.defaultUniforms,useFloatColors:!1},inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    // for picking depth values
    picking_setPickingAttribute(position.z / position.w);
  `,"vs:DECKGL_FILTER_COLOR":`
  picking_setPickingColor(geometry.pickingColor);
  `,"fs:DECKGL_FILTER_COLOR":{order:99,injection:`
  // use highlight color if this fragment belongs to the selected object.
  color = picking_filterHighlightColor(color);

  // use picking color if rendering to picking FBO.
  color = picking_filterPickingColor(color);
    `}}};var T0t=[Mg],S0t=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function gj(){let e=_g.getDefaultShaderAssembler();for(let t of T0t)e.addDefaultModule(t);for(let t of S0t)e.addShaderHook(t);return e}var E0t=[255,255,255],I0t=1,M0t=0,K5=class{constructor(t={}){this.type="ambient";let{color:r=E0t}=t,{intensity:i=I0t}=t;this.id=t.id||`ambient-${M0t++}`,this.color=r,this.intensity=i}};var C0t=[255,255,255],P0t=1,R0t=[0,0,-1],k0t=0,pv=class{constructor(t={}){this.type="directional";let{color:r=C0t}=t,{intensity:i=P0t}=t,{direction:s=R0t}=t,{_shadow:n=!1}=t;this.id=t.id||`directional-${k0t++}`,this.color=r,this.intensity=i,this.type="directional",this.direction=new ll(s).normalize().toArray(),this.shadow=n}getProjectedLight(t){return this}};var dv=class{constructor(t,r={id:"pass"}){let{id:i}=r;this.id=i,this.device=t,this.props={...r}}setProps(t){Object.assign(this.props,t)}render(t){}cleanup(){}};var Td=class extends dv{constructor(){super(...arguments),this._lastRenderIndex=-1}render(t){let[r,i]=this.device.canvasContext.getDrawingBufferSize(),s=t.clearCanvas??!0,n=t.clearColor??(s?[0,0,0,0]:!1),o=s?1:!1,c=s?0:!1,f=t.colorMask??15,p={viewport:[0,0,r,i]};t.colorMask&&(p.colorMask=f),t.scissorRect&&(p.scissorRect=t.scissorRect);let x=this.device.beginRenderPass({framebuffer:t.target,parameters:p,clearColor:n,clearDepth:o,clearStencil:c});try{return this._drawLayers(x,t)}finally{x.end()}}_drawLayers(t,r){let{target:i,moduleParameters:s,viewports:n,views:o,onViewportActive:c,clearStack:f=!0}=r;r.pass=r.pass||"unknown",f&&(this._lastRenderIndex=-1);let p=[];for(let x of n){let E=o&&o[x.id];c?.(x);let T=this._getDrawLayerParams(x,r),D=x.subViewports||[x];for(let N of D){let z=this._drawLayersInViewport(t,{target:i,moduleParameters:s,viewport:N,view:E,pass:r.pass,layers:r.layers},T);p.push(z)}}return p}_getDrawLayerParams(t,{layers:r,pass:i,isPicking:s=!1,layerFilter:n,cullRect:o,effects:c,moduleParameters:f},p=!1){let x=[],E=_j(this._lastRenderIndex+1),T={layer:r[0],viewport:t,isPicking:s,renderPass:i,cullRect:o},D={};for(let N=0;N<r.length;N++){let z=r[N],U=this._shouldDrawLayer(z,T,n,D),H={shouldDrawLayer:U};U&&!p&&(H.layerRenderIndex=E(z,U),H.moduleParameters=this._getModuleParameters(z,c,i,f),H.layerParameters={...z.context.deck?.props.parameters,...this.getLayerParameters(z,N,t)}),x[N]=H}return x}_drawLayersInViewport(t,{layers:r,moduleParameters:i,pass:s,target:n,viewport:o,view:c},f){let p=D0t(this.device,{moduleParameters:i,target:n,viewport:o});if(c&&c.props.clear){let E=c.props.clear===!0?{color:!0,depth:!0}:c.props.clear;this.device.withParametersWebGL({scissorTest:!0,scissor:p},()=>this.device.clearWebGL(E))}let x={totalCount:r.length,visibleCount:0,compositeCount:0,pickableCount:0};t.setParameters({viewport:p});for(let E=0;E<r.length;E++){let T=r[E],{shouldDrawLayer:D,layerRenderIndex:N,moduleParameters:z,layerParameters:U}=f[E];if(D&&T.props.pickable&&x.pickableCount++,T.isComposite)x.compositeCount++;else if(D){x.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,N),z.viewport=o,T.context.renderPass=t;try{T._drawLayer({renderPass:t,moduleParameters:z,uniforms:{layerIndex:N},parameters:U})}catch(H){T.raiseError(H,`drawing ${T} to ${s}`)}}}return x}shouldDrawLayer(t){return!0}getModuleParameters(t,r){return null}getLayerParameters(t,r,i){return t.props.parameters}_shouldDrawLayer(t,r,i,s){if(!(t.props.visible&&this.shouldDrawLayer(t)))return!1;r.layer=t;let o=t.parent;for(;o;){if(!o.props.visible||!o.filterSubLayer(r))return!1;r.layer=o,o=o.parent}if(i){let c=r.layer.id;if(c in s||(s[c]=i(r)),!s[c])return!1}return t.activateViewport(r.viewport),!0}_getModuleParameters(t,r,i,s){let n=this.device.canvasContext.cssToDeviceRatio(),o=Object.assign(Object.create(t.internalState?.propsInTransition||t.props),{autoWrapLongitude:t.wrapLongitude,viewport:t.context.viewport,mousePosition:t.context.mousePosition,picking:{isActive:0},devicePixelRatio:n});if(r)for(let c of r)Object.assign(o,c.getModuleParameters?.(t));return Object.assign(o,this.getModuleParameters(t,r),s)}};function _j(e=0,t={}){let r={},i=(s,n)=>{let o=s.props._offset,c=s.id,f=s.parent&&s.parent.id,p;if(f&&!(f in t)&&i(s.parent,!1),f in r){let x=r[f]=r[f]||_j(t[f],t);p=x(s,n),r[c]=x}else Number.isFinite(o)?(p=o+(t[f]||0),r[c]=null):p=e;return n&&p>=e&&(e=p+1),t[c]=p,p};return i}function D0t(e,{moduleParameters:t,target:r,viewport:i}){let s=t&&t.devicePixelRatio||e.canvasContext.cssToDeviceRatio(),[,n]=e.canvasContext.getDrawingBufferSize(),o=r?r.height:n,c=i;return[c.x*s,o-(c.y+c.height)*s,c.width*s,c.height*s]}var Av=class extends Td{constructor(t,r){super(t,r),this.shadowMap=t.createTexture({width:1,height:1,sampler:{minFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}}),this.depthBuffer=t.createTexture({format:"depth16unorm",width:1,height:1,mipmaps:!1,dataFormat:6402,type:5125}),this.fbo=t.createFramebuffer({id:"shadowmap",width:1,height:1,colorAttachments:[this.shadowMap],depthStencilAttachment:this.depthBuffer})}render(t){let r=this.fbo,i=this.device.canvasContext.cssToDeviceRatio(),s=t.viewports[0],n=s.width*i,o=s.height*i,c=[1,1,1,1];(n!==r.width||o!==r.height)&&r.resize({width:n,height:o}),super.render({...t,clearColor:c,target:r,pass:"shadow"})}getLayerParameters(t,r,i){return{...t.props.parameters,blend:!1,depthRange:[0,1],depthTest:!0}}shouldDrawLayer(t){return t.props.shadowEnabled!==!1}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.destroy(),this.fbo=null),this.shadowMap&&(this.shadowMap.destroy(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.destroy(),this.depthBuffer=null)}};var B0t={color:[255,255,255],intensity:1},yj=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],O0t=[0,0,0,200/255],Ey=class{constructor(t={}){this.id="lighting-effect",this.shadowColor=O0t,this.shadow=!1,this.ambientLight=null,this.directionalLights=[],this.pointLights=[],this.shadowPasses=[],this.shadowMaps=[],this.dummyShadowMap=null,this.setProps(t)}setup(t){this.context=t;let{device:r,deck:i}=t;this.shadow&&!this.dummyShadowMap&&(this._createShadowPasses(r),i._addDefaultShaderModule(Q5),this.dummyShadowMap=r.createTexture({width:1,height:1}))}setProps(t){this.ambientLight=null,this.directionalLights=[],this.pointLights=[];for(let r in t){let i=t[r];switch(i.type){case"ambient":this.ambientLight=i;break;case"directional":this.directionalLights.push(i);break;case"point":this.pointLights.push(i);break;default:}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(r=>r.shadow),this.context&&this.setup(this.context),this.props=t}preRender({layers:t,layerFilter:r,viewports:i,onViewportActive:s,views:n}){if(this.shadow){this.shadowMatrices=this._calculateMatrices();for(let o=0;o<this.shadowPasses.length;o++)this.shadowPasses[o].render({layers:t,layerFilter:r,viewports:i,onViewportActive:s,views:n,moduleParameters:{shadowLightId:o,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}getModuleParameters(t){let r=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return r.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(i=>i.getProjectedLight({layer:t})),pointLights:this.pointLights.map(i=>i.getProjectedLight({layer:t}))},r}cleanup(t){for(let r of this.shadowPasses)r.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.destroy(),this.dummyShadowMap=null,t.deck._removeDefaultShaderModule(Q5))}_calculateMatrices(){let t=[];for(let r of this.directionalLights){let i=new Da().lookAt({eye:new ll(r.direction).negate()});t.push(i)}return t}_createShadowPasses(t){for(let r=0;r<this.directionalLights.length;r++){let i=new Av(t);this.shadowPasses[r]=i,this.shadowMaps[r]=i.shadowMap}}_applyDefaultLights(){let{ambientLight:t,pointLights:r,directionalLights:i}=this;!t&&r.length===0&&i.length===0&&(this.ambientLight=new K5(B0t),this.directionalLights.push(new pv(yj[0]),new pv(yj[1])))}};var Hk=class{constructor(t={}){this._pool=[],this.opts={overAlloc:2,poolSize:100},this.setOptions(t)}setOptions(t){Object.assign(this.opts,t)}allocate(t,r,{size:i=1,type:s,padding:n=0,copy:o=!1,initialize:c=!1,maxCount:f}){let p=s||t&&t.constructor||Float32Array,x=r*i+n;if(ArrayBuffer.isView(t)){if(x<=t.length)return t;if(x*t.BYTES_PER_ELEMENT<=t.buffer.byteLength)return new p(t.buffer,0,x)}let E=1/0;f&&(E=f*i+n);let T=this._allocate(p,x,c,E);return t&&o?T.set(t):c||T.fill(0,0,4),this._release(t),T}release(t){this._release(t)}_allocate(t,r,i,s){let n=Math.max(Math.ceil(r*this.opts.overAlloc),1);n>s&&(n=s);let o=this._pool,c=t.BYTES_PER_ELEMENT*n,f=o.findIndex(p=>p.byteLength>=c);if(f>=0){let p=new t(o.splice(f,1)[0],0,n);return i&&p.fill(0),p}return new t(n)}_release(t){if(!ArrayBuffer.isView(t))return;let r=this._pool,{buffer:i}=t,{byteLength:s}=i,n=r.findIndex(o=>o.byteLength>=s);n<0?r.push(i):(n>0||r.length<this.opts.poolSize)&&r.splice(n,0,i),r.length>this.opts.poolSize&&r.shift()}},Nh=new Hk;function My(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function bj(e){return[e[12],e[13],e[14]]}function vj(e){return{left:Iy(e[3]+e[0],e[7]+e[4],e[11]+e[8],e[15]+e[12]),right:Iy(e[3]-e[0],e[7]-e[4],e[11]-e[8],e[15]-e[12]),bottom:Iy(e[3]+e[1],e[7]+e[5],e[11]+e[9],e[15]+e[13]),top:Iy(e[3]-e[1],e[7]-e[5],e[11]-e[9],e[15]-e[13]),near:Iy(e[3]+e[2],e[7]+e[6],e[11]+e[10],e[15]+e[14]),far:Iy(e[3]-e[2],e[7]-e[6],e[11]-e[10],e[15]-e[14])}}var xj=new ll;function Iy(e,t,r,i){xj.set(e,t,r);let s=xj.len();return{distance:i/s,normal:new ll(-e/s,-t/s,-r/s)}}function N0t(e){return e-Math.fround(e)}var mv;function J5(e,t){let{size:r=1,startIndex:i=0}=t,s=t.endIndex!==void 0?t.endIndex:e.length,n=(s-i)/r;mv=Nh.allocate(mv,n,{type:Float32Array,size:r*2});let o=i,c=0;for(;o<s;){for(let f=0;f<r;f++){let p=e[o++];mv[c+f]=p,mv[c+f+r]=N0t(p)}c+=r*2}return mv.subarray(0,n*r*2)}function wj(e){let t=null,r=!1;for(let i of e)i&&(t?(r||(t=[[t[0][0],t[0][1]],[t[1][0],t[1][1]]],r=!0),t[0][0]=Math.min(t[0][0],i[0][0]),t[0][1]=Math.min(t[0][1],i[0][1]),t[1][0]=Math.max(t[1][0],i[1][0]),t[1][1]=Math.max(t[1][1],i[1][1])):t=i);return t}var F0t=Math.PI/180,L0t=My(),Tj=[0,0,0],z0t={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};function U0t({width:e,height:t,orthographic:r,fovyRadians:i,focalDistance:s,padding:n,near:o,far:c}){let f=e/t,p=r?new Da().orthographic({fovy:i,aspect:f,focalDistance:s,near:o,far:c}):new Da().perspective({fovy:i,aspect:f,near:o,far:c});if(n){let{left:x=0,right:E=0,top:T=0,bottom:D=0}=n,N=ku((x+e-E)/2,0,e)-e/2,z=ku((T+t-D)/2,0,t)-t/2;p[8]-=N*2/e,p[9]+=z*2/t}return p}var Rg=class e{static{this.displayName="Viewport"}constructor(t={}){this._frustumPlanes={},this.id=t.id||this.constructor.displayName||"viewport",this.x=t.x||0,this.y=t.y||0,this.width=t.width||1,this.height=t.height||1,this.zoom=t.zoom||0,this.padding=t.padding,this.distanceScales=t.distanceScales||z0t,this.focalDistance=t.focalDistance||1,this.position=t.position||Tj,this.modelMatrix=t.modelMatrix||null;let{longitude:r,latitude:i}=t;this.isGeospatial=Number.isFinite(i)&&Number.isFinite(r),this._initProps(t),this._initMatrices(t),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?lc.WEB_MERCATOR:lc.WEB_MERCATOR_AUTO_OFFSET:lc.IDENTITY}equals(t){return t instanceof e?this===t?!0:t.width===this.width&&t.height===this.height&&t.scale===this.scale&&vd(t.projectionMatrix,this.projectionMatrix)&&vd(t.viewMatrix,this.viewMatrix):!1}project(t,{topLeft:r=!0}={}){let i=this.projectPosition(t),s=Sy(i,this.pixelProjectionMatrix),[n,o]=s,c=r?o:this.height-o;return t.length===2?[n,c]:[n,c,s[2]]}unproject(t,{topLeft:r=!0,targetZ:i}={}){let[s,n,o]=t,c=r?n:this.height-n,f=i&&i*this.distanceScales.unitsPerMeter[2],p=mA([s,c,o],this.pixelUnprojectionMatrix,f),[x,E,T]=this.unprojectPosition(p);return Number.isFinite(o)?[x,E,T]:Number.isFinite(i)?[x,E,i]:[x,E]}projectPosition(t){let[r,i]=this.projectFlat(t),s=(t[2]||0)*this.distanceScales.unitsPerMeter[2];return[r,i,s]}unprojectPosition(t){let[r,i]=this.unprojectFlat(t),s=(t[2]||0)*this.distanceScales.metersPerUnit[2];return[r,i,s]}projectFlat(t){if(this.isGeospatial){let r=Oh(t);return r[1]=ku(r[1],-318,830),r}return t}unprojectFlat(t){return this.isGeospatial?Yc(t):t}getBounds(t={}){let r={targetZ:t.z||0},i=this.unproject([0,0],r),s=this.unproject([this.width,0],r),n=this.unproject([0,this.height],r),o=this.unproject([this.width,this.height],r);return[Math.min(i[0],s[0],n[0],o[0]),Math.min(i[1],s[1],n[1],o[1]),Math.max(i[0],s[0],n[0],o[0]),Math.max(i[1],s[1],n[1],o[1])]}getDistanceScales(t){return t?Ty({longitude:t[0],latitude:t[1],highPrecision:!0}):this.distanceScales}containsPixel({x:t,y:r,width:i=1,height:s=1}){return t<this.x+this.width&&this.x<t+i&&r<this.y+this.height&&this.y<r+s}getFrustumPlanes(){return this._frustumPlanes.near?this._frustumPlanes:(Object.assign(this._frustumPlanes,vj(this.viewProjectionMatrix)),this._frustumPlanes)}panByPosition(t,r){return null}_initProps(t){let r=t.longitude,i=t.latitude;this.isGeospatial&&(Number.isFinite(t.zoom)||(this.zoom=Vk({latitude:i})+Math.log2(this.focalDistance)),this.distanceScales=t.distanceScales||Ty({latitude:i,longitude:r}));let s=Math.pow(2,this.zoom);this.scale=s;let{position:n,modelMatrix:o}=t,c=Tj;if(n&&(c=o?new Da(o).transformAsVector(n,[]):n),this.isGeospatial){let f=this.projectPosition([r,i,0]);this.center=new ll(c).scale(this.distanceScales.unitsPerMeter).add(f)}else this.center=this.projectPosition(c)}_initMatrices(t){let{viewMatrix:r=L0t,projectionMatrix:i=null,orthographic:s=!1,fovyRadians:n,fovy:o=75,near:c=.1,far:f=1e3,padding:p=null,focalDistance:x=1}=t;this.viewMatrixUncentered=r,this.viewMatrix=new Da().multiplyRight(r).translate(new ll(this.center).negate()),this.projectionMatrix=i||U0t({width:this.width,height:this.height,orthographic:s,fovyRadians:n||o*F0t,focalDistance:x,padding:p,near:c,far:f});let E=My();qo.multiply(E,E,this.projectionMatrix),qo.multiply(E,E,this.viewMatrix),this.viewProjectionMatrix=E,this.viewMatrixInverse=qo.invert([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=bj(this.viewMatrixInverse);let T=My(),D=My();qo.scale(T,T,[this.width/2,-this.height/2,1]),qo.translate(T,T,[1,-1,0]),qo.multiply(D,T,this.viewProjectionMatrix),this.pixelProjectionMatrix=D,this.pixelUnprojectionMatrix=qo.invert(My(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||mi.warn("Pixel project matrix not invertible")()}};var qf=class e extends Rg{static{this.displayName="WebMercatorViewport"}constructor(t={}){let{latitude:r=0,longitude:i=0,zoom:s=0,pitch:n=0,bearing:o=0,nearZMultiplier:c=.1,farZMultiplier:f=1.01,nearZ:p,farZ:x,orthographic:E=!1,projectionMatrix:T,repeat:D=!1,worldOffset:N=0,position:z,padding:U,legacyMeterSizes:H=!1}=t,{width:G,height:Z,altitude:Y=1.5}=t,st=Math.pow(2,s);G=G||1,Z=Z||1;let at,Dt=null;if(T)Y=T[5]/2,at=Cg(Y);else{t.fovy?(at=t.fovy,Y=fv(at)):at=Cg(Y);let kt;if(U){let{top:Et=0,bottom:Mt=0}=U;kt=[0,ku((Et+Z-Mt)/2,0,Z)-Z/2]}Dt=jk({width:G,height:Z,scale:st,center:z&&[0,0,z[2]*Pg(r)],offset:kt,pitch:n,fovy:at,nearZMultiplier:c,farZMultiplier:f}),Number.isFinite(p)&&(Dt.near=p),Number.isFinite(x)&&(Dt.far=x)}let Tt=X5({height:Z,pitch:n,bearing:o,scale:st,altitude:Y});N&&(Tt=new Da().translate([512*N,0,0]).multiplyLeft(Tt)),super({...t,width:G,height:Z,viewMatrix:Tt,longitude:i,latitude:r,zoom:s,...Dt,fovy:at,focalDistance:Y}),this.latitude=r,this.longitude=i,this.zoom=s,this.pitch=n,this.bearing=o,this.altitude=Y,this.fovy=at,this.orthographic=E,this._subViewports=D?[]:null,this._pseudoMeters=H,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){let t=this.getBounds(),r=Math.floor((t[0]+180)/360),i=Math.ceil((t[2]-180)/360);for(let s=r;s<=i;s++){let n=s?new e({...this,worldOffset:s}):this;this._subViewports.push(n)}}return this._subViewports}projectPosition(t){if(this._pseudoMeters)return super.projectPosition(t);let[r,i]=this.projectFlat(t),s=(t[2]||0)*Pg(t[1]);return[r,i,s]}unprojectPosition(t){if(this._pseudoMeters)return super.unprojectPosition(t);let[r,i]=this.unprojectFlat(t),s=(t[2]||0)/Pg(i);return[r,i,s]}addMetersToLngLat(t,r){return hv(t,r)}panByPosition(t,r){let i=mA(r,this.pixelUnprojectionMatrix),s=this.projectFlat(t),n=$f.add([],s,$f.negate([],i)),o=$f.add([],this.center,n),[c,f]=this.unprojectFlat(o);return{longitude:c,latitude:f}}getBounds(t={}){let r=G5(this,t.z||0);return[Math.min(r[0][0],r[1][0],r[2][0],r[3][0]),Math.min(r[0][1],r[1][1],r[2][1],r[3][1]),Math.max(r[0][0],r[1][0],r[2][0],r[3][0]),Math.max(r[0][1],r[1][1],r[2][1],r[3][1])]}fitBounds(t,r={}){let{width:i,height:s}=this,{longitude:n,latitude:o,zoom:c}=Z5({width:i,height:s,bounds:t,...r});return new e({width:i,height:s,longitude:n,latitude:o,zoom:c})}};var Sj=[0,0,0];function Wk(e,t,r=!1){let i=t.projectPosition(e);if(r&&t instanceof qf){let[s,n,o=0]=e,c=t.getDistanceScales([s,n]);i[2]=o*c.unitsPerMeter[2]}return i}function V0t(e){let{viewport:t,modelMatrix:r,coordinateOrigin:i}=e,{coordinateSystem:s,fromCoordinateSystem:n,fromCoordinateOrigin:o}=e;return s===en.DEFAULT&&(s=t.isGeospatial?en.LNGLAT:en.CARTESIAN),n===void 0&&(n=s),o===void 0&&(o=i),{viewport:t,coordinateSystem:s,coordinateOrigin:i,modelMatrix:r,fromCoordinateSystem:n,fromCoordinateOrigin:o}}function qk(e,{viewport:t,modelMatrix:r,coordinateSystem:i,coordinateOrigin:s,offsetMode:n}){let[o,c,f=0]=e;switch(r&&([o,c,f]=Hf.transformMat4([],[o,c,f,1],r)),i){case en.LNGLAT:return Wk([o,c,f],t,n);case en.LNGLAT_OFFSETS:return Wk([o+s[0],c+s[1],f+(s[2]||0)],t,n);case en.METER_OFFSETS:return Wk(hv(s,[o,c,f]),t,n);case en.CARTESIAN:default:return t.isGeospatial?[o+s[0],c+s[1],f+s[2]]:t.projectPosition([o,c,f])}}function Ej(e,t){let{viewport:r,coordinateSystem:i,coordinateOrigin:s,modelMatrix:n,fromCoordinateSystem:o,fromCoordinateOrigin:c}=V0t(t),{autoOffset:f=!0}=t,{geospatialOrigin:p=Sj,shaderCoordinateOrigin:x=Sj,offsetMode:E=!1}=f?Nk(r,i,s):{},T=qk(e,{viewport:r,modelMatrix:n,coordinateSystem:o,coordinateOrigin:c,offsetMode:E});if(E){let D=r.projectPosition(p||x);xy.sub(T,T,D)}return T}var j0t=1,$0t=1,kg=class{time=0;channels=new Map;animations=new Map;playing=!1;lastEngineTime=-1;constructor(){}addChannel(t){let{delay:r=0,duration:i=Number.POSITIVE_INFINITY,rate:s=1,repeat:n=1}=t,o=j0t++,c={time:0,delay:r,duration:i,rate:s,repeat:n};return this._setChannelTime(c,this.time),this.channels.set(o,c),o}removeChannel(t){this.channels.delete(t);for(let[r,i]of this.animations)i.channel===t&&this.detachAnimation(r)}isFinished(t){let r=this.channels.get(t);return r===void 0?!1:this.time>=r.delay+r.duration*r.repeat}getTime(t){if(t===void 0)return this.time;let r=this.channels.get(t);return r===void 0?-1:r.time}setTime(t){this.time=Math.max(0,t);let r=this.channels.values();for(let s of r)this._setChannelTime(s,this.time);let i=this.animations.values();for(let s of i){let{animation:n,channel:o}=s;n.setTime(this.getTime(o))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(t,r){let i=$0t++;return this.animations.set(i,{animation:t,channel:r}),t.setTime(this.getTime(r)),i}detachAnimation(t){this.animations.delete(t)}update(t){this.playing&&(this.lastEngineTime===-1&&(this.lastEngineTime=t),this.setTime(this.time+(t-this.lastEngineTime)),this.lastEngineTime=t)}_setChannelTime(t,r){let i=r-t.delay,s=t.duration*t.repeat;i>=s?t.time=t.duration*t.rate:(t.time=Math.max(0,i)%t.duration,t.time*=t.rate)}};var H0t=0,W0t={device:null,onAddHTML:()=>"",onInitialize:async()=>null,onRender:()=>{},onFinalize:()=>{},onError:e=>console.error(e),stats:gd.stats.get(`animation-loop-${H0t++}`),useDevicePixels:!0,autoResizeViewport:!1,autoResizeDrawingBuffer:!1},gv=class{device=null;canvas=null;props;animationProps=null;timeline=null;stats;cpuTime;gpuTime;frameRate;display;needsRedraw="initialized";_initialized=!1;_running=!1;_animationFrameId=null;_nextFramePromise=null;_resolveNextFrame=null;_cpuStartTime=0;constructor(t){if(this.props={...W0t,...t},t=this.props,!t.device)throw new Error("No device provided");let{useDevicePixels:r=!0}=this.props;this.stats=t.stats||new Iu({id:"animation-loop-stats"}),this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this.setProps({autoResizeViewport:t.autoResizeViewport,autoResizeDrawingBuffer:t.autoResizeDrawingBuffer,useDevicePixels:r}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}destroy(){this.stop(),this._setDisplay(null)}delete(){this.destroy()}setNeedsRedraw(t){return this.needsRedraw=this.needsRedraw||t,this}setProps(t){return"autoResizeViewport"in t&&(this.props.autoResizeViewport=t.autoResizeViewport||!1),"autoResizeDrawingBuffer"in t&&(this.props.autoResizeDrawingBuffer=t.autoResizeDrawingBuffer||!1),"useDevicePixels"in t&&(this.props.useDevicePixels=t.useDevicePixels||!1),this}async start(){if(this._running)return this;this._running=!0;try{let t;return this._initialized||(this._initialized=!0,await this._initDevice(),this._initialize(),await this.props.onInitialize(this._getAnimationProps())),this._running?(t!==!1&&(this._cancelAnimationFrame(),this._requestAnimationFrame()),this):null}catch(t){let r=t instanceof Error?t:new Error("Unknown error");throw this.props.onError(r),r}}stop(){return this._running&&(this.animationProps&&this.props.onFinalize(this.animationProps),this._cancelAnimationFrame(),this._nextFramePromise=null,this._resolveNextFrame=null,this._running=!1),this}redraw(){return this.device?.isLost?this:(this._beginFrameTimers(),this._setupFrame(),this._updateAnimationProps(),this._renderFrame(this._getAnimationProps()),this._clearNeedsRedraw(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endFrameTimers(),this)}attachTimeline(t){return this.timeline=t,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(t=>{this._resolveNextFrame=t})),this._nextFramePromise}async toDataURL(){if(this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.canvas instanceof HTMLCanvasElement)return this.canvas.toDataURL();throw new Error("OffscreenCanvas")}_initialize(){this._startEventHandling(),this._initializeAnimationProps(),this._updateAnimationProps(),this._resizeCanvasDrawingBuffer(),this._resizeViewport()}_setDisplay(t){this.display&&(this.display.destroy(),this.display.animationLoop=null),t&&(t.animationLoop=this),this.display=t}_requestAnimationFrame(){this._running&&(this._animationFrameId=mR(this._animationFrame.bind(this)))}_cancelAnimationFrame(){this._animationFrameId!==null&&(gR(this._animationFrameId),this._animationFrameId=null)}_animationFrame(){this._running&&(this.redraw(),this._requestAnimationFrame())}_renderFrame(t){if(this.display){this.display._renderFrame(t);return}this.props.onRender(this._getAnimationProps()),this.device.submit()}_clearNeedsRedraw(){this.needsRedraw=!1}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport()}_initializeAnimationProps(){if(!this.device)throw new Error("loop");this.animationProps={animationLoop:this,device:this.device,canvas:this.device?.canvasContext?.canvas,timeline:this.timeline,useDevicePixels:this.props.useDevicePixels,needsRedraw:!1,width:1,height:1,aspect:1,time:0,startTime:Date.now(),engineTime:0,tick:0,tock:0,_mousePosition:null}}_getAnimationProps(){if(!this.animationProps)throw new Error("animationProps");return this.animationProps}_updateAnimationProps(){if(!this.animationProps)return;let{width:t,height:r,aspect:i}=this._getSizeAndAspect();(t!==this.animationProps.width||r!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),i!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=t,this.animationProps.height=r,this.animationProps.aspect=i,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime}async _initDevice(){if(this.device=await this.props.device,!this.device)throw new Error("No device provided");this.canvas=this.device.canvasContext?.canvas||null}_createInfoDiv(){if(this.canvas&&this.props.onAddHTML){let t=document.createElement("div");document.body.appendChild(t),t.style.position="relative";let r=document.createElement("div");r.style.position="absolute",r.style.left="10px",r.style.bottom="10px",r.style.width="300px",r.style.background="white",this.canvas instanceof HTMLCanvasElement&&t.appendChild(this.canvas),t.appendChild(r);let i=this.props.onAddHTML(r);i&&(r.innerHTML=i)}}_getSizeAndAspect(){if(!this.device)return{width:1,height:1,aspect:1};let[t,r]=this.device?.canvasContext?.getPixelSize()||[1,1],i=1,s=this.device?.canvasContext?.canvas;return s&&s.clientHeight?i=s.clientWidth/s.clientHeight:t>0&&r>0&&(i=t/r),{width:t,height:r,aspect:i}}_resizeViewport(){this.props.autoResizeViewport&&this.device.gl&&this.device.gl.viewport(0,0,this.device.gl.drawingBufferWidth,this.device.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.props.autoResizeDrawingBuffer&&this.device?.canvasContext?.resize({useDevicePixels:this.props.useDevicePixels})}_beginFrameTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this.cpuTime.timeStart()}_endFrameTimers(){this.cpuTime.timeEnd()}_startEventHandling(){this.canvas&&(this.canvas.addEventListener("mousemove",this._onMousemove.bind(this)),this.canvas.addEventListener("mouseleave",this._onMouseleave.bind(this)))}_onMousemove(t){t instanceof MouseEvent&&(this._getAnimationProps()._mousePosition=[t.offsetX,t.offsetY])}_onMouseleave(t){this._getAnimationProps()._mousePosition=null}};var tS=class{id;userData={};topology;bufferLayout=[];vertexCount;indices;attributes;constructor(t){this.id=t.id||Dl("geometry"),this.topology=t.topology,this.indices=t.indices||null,this.attributes=t.attributes,this.vertexCount=t.vertexCount,this.bufferLayout=t.bufferLayout||[],this.indices&&Zi(this.indices.usage===Tn.INDEX)}destroy(){this.indices?.destroy();for(let t of Object.values(this.attributes))t.destroy()}getVertexCount(){return this.vertexCount}getAttributes(){return this.attributes}getIndexes(){return this.indices}_calculateVertexCount(t){return t.byteLength/12}};function Ij(e,t){if(t instanceof tS)return t;let r=q0t(e,t),{attributes:i,bufferLayout:s}=Y0t(e,t);return new tS({topology:t.topology||"triangle-list",bufferLayout:s,vertexCount:t.vertexCount,indices:r,attributes:i})}function q0t(e,t){if(!t.indices)return;let r=t.indices.value;return e.createBuffer({usage:Tn.INDEX,data:r})}function Y0t(e,t){let r=[],i={};for(let[n,o]of Object.entries(t.attributes)){let c=n;switch(n){case"POSITION":c="positions";break;case"NORMAL":c="normals";break;case"TEXCOORD_0":c="texCoords";break;case"COLOR_0":c="colors";break}i[c]=e.createBuffer({data:o.value,id:`${n}-buffer`});let{value:f,size:p,normalized:x}=o;r.push({name:c,format:pR(f,p,x)})}let s=t._calculateVertexCount(t.attributes,t.indices);return{attributes:i,bufferLayout:r,vertexCount:s}}var eS=class{modules;moduleUniforms;moduleBindings;moduleUniformsChanged;constructor(t){let r=gg(Object.values(t).filter(i=>i.dependencies));for(let i of r)t[i.name]=i;Ce.log(1,"Creating ShaderInputs with modules",Object.keys(t))(),this.modules=t,this.moduleUniforms={},this.moduleBindings={};for(let[i,s]of Object.entries(t)){let n=i;this.moduleUniforms[n]=s.defaultUniforms||{},this.moduleBindings[n]={}}}destroy(){}setProps(t){for(let r of Object.keys(t)){let i=r,s=t[i],n=this.modules[i];if(!n){Ce.warn(`Module ${r} not found`)();continue}let o=this.moduleUniforms[i],c=n.getUniforms?.(s,this.moduleUniforms[i])||s;this.moduleUniforms[i]={...o,...c}}}getModules(){return Object.values(this.modules)}getUniformValues(){return this.moduleUniforms}getBindings(){let t={};for(let r of Object.values(this.moduleBindings))Object.assign(t,r);return t}getDebugTable(){let t={};for(let[r,i]of Object.entries(this.moduleUniforms))for(let[s,n]of Object.entries(i))t[`${r}.${s}`]={type:this.modules[r].uniformTypes?.[s],value:String(n)};return t}};var rS=class e{static defaultProps={...Uf.defaultProps};device;_hashCounter=0;_hashes={};_renderPipelineCache={};_computePipelineCache={};static getDefaultPipelineFactory(t){return t._lumaData.defaultPipelineFactory=t._lumaData.defaultPipelineFactory||new e(t),t._lumaData.defaultPipelineFactory}constructor(t){this.device=t}createRenderPipeline(t){let r={...Uf.defaultProps,...t},i=this._hashRenderPipeline(r);if(!this._renderPipelineCache[i]){let s=this.device.createRenderPipeline({...r,id:r.id?`${r.id}-cached`:void 0});s.hash=i,this._renderPipelineCache[i]={pipeline:s,useCount:0}}return this._renderPipelineCache[i].useCount++,this._renderPipelineCache[i].pipeline}createComputePipeline(t){let r={...dy.defaultProps,...t},i=this._hashComputePipeline(r);if(!this._computePipelineCache[i]){let s=this.device.createComputePipeline({...r,id:r.id?`${r.id}-cached`:void 0});s.hash=i,this._computePipelineCache[i]={pipeline:s,useCount:0}}return this._computePipelineCache[i].useCount++,this._computePipelineCache[i].pipeline}release(t){let r=t.hash,i=t instanceof dy?this._computePipelineCache:this._renderPipelineCache;i[r].useCount--,i[r].useCount===0&&(i[r].pipeline.destroy(),delete i[r])}_hashComputePipeline(t){return`${this._getHash(t.shader.source)}`}_hashRenderPipeline(t){let r=this._getHash(t.vs.source),i=t.fs?this._getHash(t.fs.source):0,s="-",n=this._getHash(JSON.stringify(t.bufferLayout));switch(this.device.type){case"webgl":return`${r}/${i}V${s}BL${n}`;default:let o=this._getHash(JSON.stringify(t.parameters));return`${r}/${i}V${s}T${t.topology}P${o}BL${n}`}}_getHash(t){return this._hashes[t]===void 0&&(this._hashes[t]=this._hashCounter++),this._hashes[t]}};var iS=class e{static defaultProps={...bg.defaultProps};device;_cache={};static getDefaultShaderFactory(t){return t._lumaData.defaultShaderFactory||=new e(t),t._lumaData.defaultShaderFactory}constructor(t){this.device=t}createShader(t){let r=this._hashShader(t),i=this._cache[r];if(!i){let s=this.device.createShader({...t,id:t.id?`${t.id}-cached`:void 0});this._cache[r]=i={shader:s,useCount:0}}return i.useCount++,i.shader}release(t){let r=this._hashShader(t),i=this._cache[r];i&&(i.useCount--,i.useCount===0&&(delete this._cache[r],i.shader.destroy()))}_hashShader(t){return`${t.stage}:${t.source}`}};function Mj(e,t){let r={},i="Values";if(e.attributes.length===0&&!e.varyings?.length)return{"No attributes or varyings":{[i]:"N/A"}};for(let s of e.attributes)if(s){let n=`${s.location} ${s.name}: ${s.type}`;r[`in ${n}`]={[i]:s.stepMode||"vertex"}}for(let s of e.varyings||[]){let n=`${s.location} ${s.name}`;r[`out ${n}`]={[i]:JSON.stringify(s.accessor)}}return r}var fa=null,Yk=null;function Cj(e,{id:t,minimap:r,opaque:i,top:s="0",left:n="0",rgbaScale:o=1}){fa||(fa=document.createElement("canvas"),fa.id=t,fa.title=t,fa.style.zIndex="100",fa.style.position="absolute",fa.style.top=s,fa.style.left=n,fa.style.border="blue 1px solid",fa.style.transform="scaleY(-1)",document.body.appendChild(fa),Yk=fa.getContext("2d")),(fa.width!==e.width||fa.height!==e.height)&&(fa.width=e.width/2,fa.height=e.height/2,fa.style.width="400px",fa.style.height="400px");let c=e.device.readPixelsToArrayWebGL(e),f=Yk.createImageData(e.width,e.height),p=0;for(let x=0;x<c.length;x+=4)f.data[p+x+0]=c[x+0]*o,f.data[p+x+1]=c[x+1]*o,f.data[p+x+2]=c[x+2]*o,f.data[p+x+3]=i?255:c[x+3]*o;Yk.putImageData(f,0,0)}var Cy=2,X0t=1e4,Bl=class e{static defaultProps={...Uf.defaultProps,source:null,vs:null,fs:null,id:"unnamed",handle:void 0,userData:{},defines:{},modules:[],moduleSettings:void 0,geometry:null,indexBuffer:null,attributes:{},constantAttributes:{},varyings:[],isInstanced:void 0,instanceCount:0,vertexCount:0,shaderInputs:void 0,pipelineFactory:void 0,shaderFactory:void 0,transformFeedback:void 0,shaderAssembler:_g.getDefaultShaderAssembler(),debugShaders:void 0,disableWarnings:void 0};device;id;source;vs;fs;pipelineFactory;shaderFactory;userData={};parameters;topology;bufferLayout;isInstanced=void 0;instanceCount=0;vertexCount;indexBuffer=null;bufferAttributes={};constantAttributes={};bindings={};uniforms={};vertexArray;transformFeedback=null;pipeline;shaderInputs;_uniformStore;_attributeInfos={};_gpuGeometry=null;_getModuleUniforms;props;_pipelineNeedsUpdate="newly created";_needsRedraw="initializing";_destroyed=!1;_lastDrawTimestamp=-1;constructor(t,r){this.props={...e.defaultProps,...r},r=this.props,this.id=r.id||Dl("model"),this.device=t,Object.assign(this.userData,r.userData);let i=Object.fromEntries(this.props.modules?.map(c=>[c.name,c])||[]);this.setShaderInputs(r.shaderInputs||new eS(i));let s=Z0t(t),n=(this.props.modules?.length>0?this.props.modules:this.shaderInputs?.getModules())||[];if(this.device.type==="webgpu"&&this.props.source){this.props.shaderLayout||=KR(this.props.source);let{source:c,getUniforms:f}=this.props.shaderAssembler.assembleShader({platformInfo:s,...this.props,modules:n});this.source=c,this._getModuleUniforms=f}else{let{vs:c,fs:f,getUniforms:p}=this.props.shaderAssembler.assembleShaderPair({platformInfo:s,...this.props,modules:n});this.vs=c,this.fs=f,this._getModuleUniforms=p}this.vertexCount=this.props.vertexCount,this.instanceCount=this.props.instanceCount,this.topology=this.props.topology,this.bufferLayout=this.props.bufferLayout,this.parameters=this.props.parameters,r.geometry&&this.setGeometry(r.geometry),this.pipelineFactory=r.pipelineFactory||rS.getDefaultPipelineFactory(this.device),this.shaderFactory=r.shaderFactory||iS.getDefaultShaderFactory(this.device),this.pipeline=this._updatePipeline(),this.vertexArray=t.createVertexArray({renderPipeline:this.pipeline}),this._gpuGeometry&&this._setGeometryAttributes(this._gpuGeometry),"isInstanced"in r&&(this.isInstanced=r.isInstanced),r.instanceCount&&this.setInstanceCount(r.instanceCount),r.vertexCount&&this.setVertexCount(r.vertexCount),r.indexBuffer&&this.setIndexBuffer(r.indexBuffer),r.attributes&&this.setAttributes(r.attributes),r.constantAttributes&&this.setConstantAttributes(r.constantAttributes),r.bindings&&this.setBindings(r.bindings),r.uniforms&&this.setUniforms(r.uniforms),r.moduleSettings&&this.updateModuleSettings(r.moduleSettings),r.transformFeedback&&(this.transformFeedback=r.transformFeedback),Object.seal(this)}destroy(){this._destroyed||(this.pipelineFactory.release(this.pipeline),this.shaderFactory.release(this.pipeline.vs),this.pipeline.fs&&this.shaderFactory.release(this.pipeline.fs),this._uniformStore.destroy(),this._gpuGeometry?.destroy(),this._destroyed=!0)}needsRedraw(){this._getBindingsUpdateTimestamp()>this._lastDrawTimestamp&&this.setNeedsRedraw("contents of bound textures or buffers updated");let t=this._needsRedraw;return this._needsRedraw=!1,t}setNeedsRedraw(t){this._needsRedraw||=t}predraw(){this.updateShaderInputs(),this.pipeline=this._updatePipeline()}draw(t){this.predraw();let r;try{this._logDrawCallStart(),this.pipeline=this._updatePipeline(),this.pipeline.setBindings(this.bindings,{disableWarnings:this.props.disableWarnings}),uA(this.uniforms)||this.pipeline.setUniformsWebGL(this.uniforms);let{indexBuffer:i}=this.vertexArray,s=i?i.byteLength/(i.indexType==="uint32"?4:2):void 0;r=this.pipeline.draw({renderPass:t,vertexArray:this.vertexArray,isInstanced:this.isInstanced,vertexCount:this.vertexCount,instanceCount:this.instanceCount,indexCount:s,transformFeedback:this.transformFeedback||void 0,parameters:this.parameters,topology:this.topology})}finally{this._logDrawCallEnd()}return this._logFramebuffer(t),r?(this._lastDrawTimestamp=this.device.timestamp,this._needsRedraw=!1):this._needsRedraw="waiting for resource initialization",r}setGeometry(t){this._gpuGeometry?.destroy();let r=t&&Ij(this.device,t);r&&(this.setTopology(r.topology||"triangle-list"),this.bufferLayout=Pj(r.bufferLayout,this.bufferLayout),this.vertexArray&&this._setGeometryAttributes(r)),this._gpuGeometry=r}setTopology(t){t!==this.topology&&(this.topology=t,this._setPipelineNeedsUpdate("topology"))}setBufferLayout(t){this.bufferLayout=this._gpuGeometry?Pj(t,this._gpuGeometry.bufferLayout):t,this._setPipelineNeedsUpdate("bufferLayout"),this.pipeline=this._updatePipeline(),this.vertexArray=this.device.createVertexArray({renderPipeline:this.pipeline}),this._gpuGeometry&&this._setGeometryAttributes(this._gpuGeometry)}setParameters(t){iv(t,this.parameters,2)||(this.parameters=t,this._setPipelineNeedsUpdate("parameters"))}setInstanceCount(t){this.instanceCount=t,this.isInstanced===void 0&&t>0&&(this.isInstanced=!0),this.setNeedsRedraw("instanceCount")}setVertexCount(t){this.vertexCount=t,this.setNeedsRedraw("vertexCount")}setShaderInputs(t){this.shaderInputs=t,this._uniformStore=new Jb(this.shaderInputs.modules);for(let r of Object.keys(this.shaderInputs.modules)){let i=this._uniformStore.getManagedUniformBuffer(this.device,r);this.bindings[`${r}Uniforms`]=i}this.setNeedsRedraw("shaderInputs")}updateShaderInputs(){this._uniformStore.setUniforms(this.shaderInputs.getUniformValues()),this.setNeedsRedraw("shaderInputs")}setBindings(t){Object.assign(this.bindings,t),this.setNeedsRedraw("bindings")}setTransformFeedback(t){this.transformFeedback=t,this.setNeedsRedraw("transformFeedback")}setIndexBuffer(t){this.vertexArray.setIndexBuffer(t),this.setNeedsRedraw("indexBuffer")}setAttributes(t,r){t.indices&&Ce.warn(`Model:${this.id} setAttributes() - indexBuffer should be set using setIndexBuffer()`)();for(let[i,s]of Object.entries(t)){let n=this.bufferLayout.find(f=>Rj(f).includes(i));if(!n){Ce.warn(`Model(${this.id}): Missing layout for buffer "${i}".`)();continue}let o=Rj(n),c=!1;for(let f of o){let p=this._attributeInfos[f];p&&(this.vertexArray.setBuffer(p.location,s),c=!0)}!c&&!(r?.disableWarnings??this.props.disableWarnings)&&Ce.warn(`Model(${this.id}): Ignoring buffer "${s.id}" for unknown attribute "${i}"`)()}this.setNeedsRedraw("attributes")}setConstantAttributes(t,r){for(let[i,s]of Object.entries(t)){let n=this._attributeInfos[i];n?this.vertexArray.setConstantWebGL(n.location,s):(r?.disableWarnings??this.props.disableWarnings)||Ce.warn(`Model "${this.id}: Ignoring constant supplied for unknown attribute "${i}"`)()}this.setNeedsRedraw("constants")}setUniforms(t){uA(t)||(this.pipeline.setUniformsWebGL(t),Object.assign(this.uniforms,t)),this.setNeedsRedraw("uniforms")}updateModuleSettings(t){let{bindings:r,uniforms:i}=ev(this._getModuleUniforms(t));Object.assign(this.bindings,r),Object.assign(this.uniforms,i),this.setNeedsRedraw("moduleSettings")}_getBindingsUpdateTimestamp(){let t=0;for(let r of Object.values(this.bindings))r instanceof xg?t=Math.max(t,r.texture.updateTimestamp):r instanceof Tn||r instanceof Bo?t=Math.max(t,r.updateTimestamp):r instanceof vg||(t=Math.max(t,r.buffer.updateTimestamp));return t}_setGeometryAttributes(t){let r={...t.attributes};for(let[i]of Object.entries(r))!this.pipeline.shaderLayout.attributes.find(s=>s.name===i)&&i!=="positions"&&delete r[i];this.vertexCount=t.vertexCount,this.setIndexBuffer(t.indices||null),this.setAttributes(t.attributes,{disableWarnings:!0}),this.setAttributes(r,{disableWarnings:this.props.disableWarnings}),this.setNeedsRedraw("geometry attributes")}_setPipelineNeedsUpdate(t){this._pipelineNeedsUpdate||=t,this.setNeedsRedraw(t)}_updatePipeline(){if(this._pipelineNeedsUpdate){let t=null,r=null;this.pipeline&&(Ce.log(1,`Model ${this.id}: Recreating pipeline because "${this._pipelineNeedsUpdate}".`)(),t=this.pipeline.vs,r=this.pipeline.fs),this._pipelineNeedsUpdate=!1;let i=this.shaderFactory.createShader({id:`${this.id}-vertex`,stage:"vertex",source:this.source||this.vs,debug:this.props.debugShaders}),s=null;this.source?s=i:this.fs&&(s=this.shaderFactory.createShader({id:`${this.id}-fragment`,stage:"fragment",source:this.source||this.fs,debug:this.props.debugShaders})),this.pipeline=this.pipelineFactory.createRenderPipeline({...this.props,bufferLayout:this.bufferLayout,topology:this.topology,parameters:this.parameters,vs:i,fs:s}),this._attributeInfos=d5(this.pipeline.shaderLayout,this.bufferLayout),t&&this.shaderFactory.release(t),r&&this.shaderFactory.release(r)}return this.pipeline}_lastLogTime=0;_logOpen=!1;_logDrawCallStart(){let t=Ce.level>3?0:X0t;Ce.level<2||Date.now()-this._lastLogTime<t||(this._lastLogTime=Date.now(),this._logOpen=!0,Ce.group(Cy,`>>> DRAWING MODEL ${this.id}`,{collapsed:Ce.level<=2})())}_logDrawCallEnd(){if(this._logOpen){let t=Mj(this.pipeline.shaderLayout,this.id);Ce.table(Cy,t)();let r=this.shaderInputs.getDebugTable();for(let[s,n]of Object.entries(this.uniforms))r[s]={value:n};Ce.table(Cy,r)();let i=this._getAttributeDebugTable();Ce.table(Cy,this._attributeInfos)(),Ce.table(Cy,i)(),Ce.groupEnd(Cy)(),this._logOpen=!1}}_drawCount=0;_logFramebuffer(t){let r=Ce.get("framebuffer");if(this._drawCount++,!r||this._drawCount++>3&&this._drawCount%60)return;let i=t.props.framebuffer;i&&Cj(i,{id:i.id,minimap:!0})}_getAttributeDebugTable(){let t={};for(let[r,i]of Object.entries(this._attributeInfos))t[i.location]={name:r,type:i.shaderType,values:this._getBufferOrConstantValues(this.vertexArray.attributes[i.location],i.bufferDataType)};if(this.vertexArray.indexBuffer){let{indexBuffer:r}=this.vertexArray,i=r.indexType==="uint32"?new Uint32Array(r.debugData):new Uint16Array(r.debugData);t.indices={name:"indices",type:r.indexType,values:i.toString()}}return t}_getBufferOrConstantValues(t,r){let i=tv(r);return(t instanceof Tn?new i(t.debugData):t).toString()}};function Pj(e,t){let r=[...e];for(let i of t){let s=r.findIndex(n=>n.name===i.name);s<0?r.push(i):r[s]=i}return r}function Z0t(e){return{type:e.type,shaderLanguage:e.info.shadingLanguage,shaderLanguageVersion:e.info.shadingLanguageVersion,gpu:e.info.gpu,features:e.features}}function Rj(e){return e.attributes?e.attributes?.map(t=>t.attribute):[e.name]}var _A=class e{device;model;transformFeedback;static isSupported(t){return t?.info?.type==="webgl"}constructor(t,r=Bl.defaultProps){Zi(e.isSupported(t),"BufferTransform not yet implemented on WebGPU"),this.device=t,this.model=new Bl(this.device,{id:r.id||"buffer-transform-model",fs:r.fs||sR(),topology:r.topology||"point-list",...r}),this.transformFeedback=this.device.createTransformFeedback({layout:this.model.pipeline.shaderLayout,buffers:r.feedbackBuffers}),this.model.setTransformFeedback(this.transformFeedback),Object.seal(this)}destroy(){this.model&&this.model.destroy()}delete(){this.destroy()}run(t){let r=this.device.beginRenderPass(t);this.model.draw(r),r.end()}update(...t){console.warn("TextureTransform#update() not implemented")}getBuffer(t){return this.transformFeedback.getBuffer(t)}readAsync(t){let r=this.getBuffer(t);if(r instanceof Tn)return r.readAsync();let{buffer:i,byteOffset:s=0,byteLength:n=i.byteLength}=r;return i.readAsync(s,n)}};var Yf=class{id;topology;vertexCount;indices;attributes;userData={};constructor(t){let{attributes:r={},indices:i=null,vertexCount:s=null}=t;this.id=t.id||Dl("geometry"),this.topology=t.topology,i&&(this.indices=ArrayBuffer.isView(i)?{value:i,size:1}:i),this.attributes={};for(let[n,o]of Object.entries(r)){let c=ArrayBuffer.isView(o)?{value:o}:o;Zi(ArrayBuffer.isView(c.value),`${this._print(n)}: must be typed array or object with value as typed array`),(n==="POSITION"||n==="positions")&&!c.size&&(c.size=3),n==="indices"?(Zi(!this.indices),this.indices=c):this.attributes[n]=c}this.indices&&this.indices.isIndexed!==void 0&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this.vertexCount=s||this._calculateVertexCount(this.attributes,this.indices)}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(t){return`Geometry ${this.id} attribute ${t}`}_setAttributes(t,r){return this}_calculateVertexCount(t,r){if(r)return r.value.length;let i=1/0;for(let s of Object.values(t)){let{value:n,size:o,constant:c}=s;!c&&n&&o>=1&&(i=Math.min(i,n.length/o))}return Zi(Number.isFinite(i)),i}};var G0t={blendColorOperation:"add",blendColorSrcFactor:"one",blendColorDstFactor:"zero",blendAlphaOperation:"add",blendAlphaSrcFactor:"constant-alpha",blendAlphaDstFactor:"zero"},Dg=class extends Td{constructor(){super(...arguments),this._colorEncoderState=null}render(t){return"pickingFBO"in t?this._drawPickingBuffer(t):super.render(t)}_drawPickingBuffer({layers:t,layerFilter:r,views:i,viewports:s,onViewportActive:n,pickingFBO:o,deviceRect:{x:c,y:f,width:p,height:x},cullRect:E,effects:T,pass:D="picking",pickZ:N,moduleParameters:z}){this.pickZ=N;let U=this._resetColorEncoder(N),H=[c,f,p,x],G=super.render({target:o,layers:t,layerFilter:r,views:i,viewports:s,onViewportActive:n,cullRect:E,effects:T?.filter(Y=>Y.useInPicking),pass:D,isPicking:!0,moduleParameters:z,clearColor:[0,0,0,0],colorMask:15,scissorRect:H});return this._colorEncoderState=null,{decodePickingColor:U&&K0t.bind(null,U),stats:G}}shouldDrawLayer(t){let{pickable:r,operation:i}=t.props;return r&&i.includes("draw")||i.includes("terrain")||i.includes("mask")}getModuleParameters(){return{picking:{isActive:1,isAttribute:this.pickZ},lightSources:{}}}getLayerParameters(t,r,i){let s={depthMask:!0,depthTest:!0,depthRange:[0,1],...t.props.parameters},{pickable:n,operation:o}=t.props;return!this._colorEncoderState||o.includes("terrain")?s.blend=!1:n&&o.includes("draw")&&(Object.assign(s,G0t),s.blend=!0,s.blendColor=Q0t(this._colorEncoderState,t,i)),s}_resetColorEncoder(t){return this._colorEncoderState=t?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}};function Q0t(e,t,r){let{byLayer:i,byAlpha:s}=e,n,o=i.get(t);return o?(o.viewports.push(r),n=o.a):(n=i.size+1,n<=255?(o={a:n,layer:t,viewports:[r]},i.set(t,o),s[n]=o):(mi.warn("Too many pickable layers, only picking the first 255")(),n=0)),[0,0,0,n/255]}function K0t(e,t){let r=e.byAlpha[t[3]];return r&&{pickedLayer:r.layer,pickedViewports:r.viewports,pickedObjectIndex:r.layer.decodePickingColor(t)}}var yA={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},Py=Symbol.for("component"),Ou=Symbol.for("propTypes"),nS=Symbol.for("deprecatedProps"),Sd=Symbol.for("asyncPropDefaults"),Xf=Symbol.for("asyncPropOriginal"),Fh=Symbol.for("asyncPropResolved");function Nu(e,t=()=>!0){return Array.isArray(e)?kj(e,t,[]):t(e)?[e]:[]}function kj(e,t,r){let i=-1;for(;++i<e.length;){let s=e[i];Array.isArray(s)?kj(s,t,r):t(s)&&r.push(s)}return r}function Xk({target:e,source:t,start:r=0,count:i=1}){let s=t.length,n=i*s,o=0;for(let c=r;o<s;o++)e[c++]=t[o];for(;o<n;)o<n-o?(e.copyWithin(r+o,r,r+o),o*=2):(e.copyWithin(r+o,r,r+n-o),o=n);return e}var _v=class{constructor(t,r,i){this._loadCount=0,this._subscribers=new Set,this.id=t,this.context=i,this.setData(r)}subscribe(t){this._subscribers.add(t)}unsubscribe(t){this._subscribers.delete(t)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(t,r){if(t===this._data&&!r)return;this._data=t;let i=++this._loadCount,s=t;typeof t=="string"&&(s=hy(t)),s instanceof Promise?(this.isLoaded=!1,this._loader=s.then(n=>{this._loadCount===i&&(this.isLoaded=!0,this._error=void 0,this._content=n)}).catch(n=>{this._loadCount===i&&(this.isLoaded=!0,this._error=n||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=t);for(let n of this._subscribers)n.onChange(this.getData())}};var yv=class{constructor(t){this.protocol=t.protocol||"resource://",this._context={device:t.device,gl:t.device?.gl,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(t){return t.startsWith(this.protocol)?!0:t in this._resources}add({resourceId:t,data:r,forceUpdate:i=!1,persistent:s=!0}){let n=this._resources[t];n?n.setData(r,i):(n=new _v(t,r,this._context),this._resources[t]=n),n.persistent=s}remove(t){let r=this._resources[t];r&&(r.delete(),delete this._resources[t])}unsubscribe({consumerId:t}){let r=this._consumers[t];if(r){for(let i in r){let s=r[i],n=this._resources[s.resourceId];n&&n.unsubscribe(s)}delete this._consumers[t],this.prune()}}subscribe({resourceId:t,onChange:r,consumerId:i,requestId:s="default"}){let{_resources:n,protocol:o}=this;t.startsWith(o)&&(t=t.replace(o,""),n[t]||this.add({resourceId:t,data:null,persistent:!1}));let c=n[t];if(this._track(i,s,c,r),c)return c.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(let t in this._resources)this._resources[t].delete()}_track(t,r,i,s){let n=this._consumers,o=n[t]=n[t]||{},c=o[r],f=c&&c.resourceId&&this._resources[c.resourceId];f&&(f.unsubscribe(c),this.prune()),i&&(c?(c.onChange=s,c.resourceId=i.id):c={onChange:s,resourceId:i.id},o[r]=c,i.subscribe(c))}_prune(){this._pruneRequest=null;for(let t of Object.keys(this._resources)){let r=this._resources[t];!r.persistent&&!r.inUse()&&(r.delete(),delete this._resources[t])}}};var J0t="layerManager.setLayers",tAt="layerManager.activateViewport",xv=class{constructor(t,r){this._lastRenderedLayers=[],this._needsRedraw=!1,this._needsUpdate=!1,this._nextLayers=null,this._debug=!1,this._defaultShaderModulesChanged=!1,this.activateViewport=c=>{so(tAt,this,c),c&&(this.context.viewport=c)};let{deck:i,stats:s,viewport:n,timeline:o}=r||{};this.layers=[],this.resourceManager=new yv({device:t,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,device:t,gl:t?.gl,deck:i,shaderAssembler:gj(),defaultShaderModules:[],renderPass:void 0,stats:s||new Iu({id:"deck.gl"}),viewport:n||new Rg({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:o||new kg,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(let t of this.layers)this._finalizeLayer(t)}needsRedraw(t={clearRedrawFlags:!1}){let r=this._needsRedraw;t.clearRedrawFlags&&(this._needsRedraw=!1);for(let i of this.layers){let s=i.getNeedsRedraw(t);r=r||s}return r}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._defaultShaderModulesChanged?"shader modules changed":this._needsUpdate}setNeedsRedraw(t){this._needsRedraw=this._needsRedraw||t}setNeedsUpdate(t){this._needsUpdate=this._needsUpdate||t}getLayers({layerIds:t}={}){return t?this.layers.filter(r=>t.find(i=>r.id.indexOf(i)===0)):this.layers}setProps(t){"debug"in t&&(this._debug=t.debug),"userData"in t&&(this.context.userData=t.userData),"layers"in t&&(this._nextLayers=t.layers),"onError"in t&&(this.context.onError=t.onError)}setLayers(t,r){so(J0t,this,r,t),this._lastRenderedLayers=t;let i=Nu(t,Boolean);for(let s of i)s.context=this.context;this._updateLayers(this.layers,i)}updateLayers(){let t=this.needsUpdate();t&&(this.setNeedsRedraw(`updating layers: ${t}`),this.setLayers(this._nextLayers||this._lastRenderedLayers,t)),this._nextLayers=null}addDefaultShaderModule(t){let{defaultShaderModules:r}=this.context;r.find(i=>i.name===t.name)||(r.push(t),this._defaultShaderModulesChanged=!0)}removeDefaultShaderModule(t){let{defaultShaderModules:r}=this.context,i=r.findIndex(s=>s.name===t.name);i>=0&&(r.splice(i,1),this._defaultShaderModulesChanged=!0)}_handleError(t,r,i){i.raiseError(r,`${t} of ${i}`)}_updateLayers(t,r){let i={};for(let o of t)i[o.id]?mi.warn(`Multiple old layers with same id ${o.id}`)():i[o.id]=o;if(this._defaultShaderModulesChanged){for(let o of t)o.setNeedsUpdate(),o.setChangeFlags({extensionsChanged:!0});this._defaultShaderModulesChanged=!1}let s=[];this._updateSublayersRecursively(r,i,s),this._finalizeOldLayers(i);let n=!1;for(let o of s)if(o.hasUniformTransition()){n=`Uniform transition in ${o}`;break}this._needsUpdate=n,this.layers=s}_updateSublayersRecursively(t,r,i){for(let s of t){s.context=this.context;let n=r[s.id];n===null&&mi.warn(`Multiple new layers with same id ${s.id}`)(),r[s.id]=null;let o=null;try{this._debug&&n!==s&&s.validateProps(),n?(this._transferLayerState(n,s),this._updateLayer(s)):this._initializeLayer(s),i.push(s),o=s.isComposite?s.getSubLayers():null}catch(c){this._handleError("matching",c,s)}o&&this._updateSublayersRecursively(o,r,i)}}_finalizeOldLayers(t){for(let r in t){let i=t[r];i&&this._finalizeLayer(i)}}_initializeLayer(t){try{t._initialize(),t.lifecycle=yA.INITIALIZED}catch(r){this._handleError("initialization",r,t)}}_transferLayerState(t,r){r._transferState(t),r.lifecycle=yA.MATCHED,r!==t&&(t.lifecycle=yA.AWAITING_GC)}_updateLayer(t){try{t._update()}catch(r){this._handleError("update",r,t)}}_finalizeLayer(t){this._needsRedraw=this._needsRedraw||`finalized ${t}`,t.lifecycle=yA.AWAITING_FINALIZATION;try{t._finalize(),t.lifecycle=yA.FINALIZED}catch(r){this._handleError("finalization",r,t)}}};function Ba(e,t,r){if(e===t)return!0;if(!r||!e||!t)return!1;if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(!Ba(e[i],t[i],r-1))return!1;return!0}if(Array.isArray(t))return!1;if(typeof e=="object"&&typeof t=="object"){let i=Object.keys(e),s=Object.keys(t);if(i.length!==s.length)return!1;for(let n of i)if(!t.hasOwnProperty(n)||!Ba(e[n],t[n],r-1))return!1;return!0}return!1}var bv=class{constructor(t){this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=t.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=t.eventManager,this._eventCallbacks={onViewStateChange:t.onViewStateChange,onInteractionStateChange:t.onInteractionStateChange},Object.seal(this),this.setProps(t)}finalize(){for(let t in this.controllers){let r=this.controllers[t];r&&r.finalize()}this.controllers={}}needsRedraw(t={clearRedrawFlags:!1}){let r=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),r}setNeedsUpdate(t){this._needsUpdate=this._needsUpdate||t,this._needsRedraw=this._needsRedraw||t}updateViewStates(){for(let t in this.controllers){let r=this.controllers[t];r&&r.updateTransition()}}getViewports(t){return t?this._viewports.filter(r=>r.containsPixel(t)):this._viewports}getViews(){let t={};return this.views.forEach(r=>{t[r.id]=r}),t}getView(t){return this.views.find(r=>r.id===t)}getViewState(t){let r=typeof t=="string"?this.getView(t):t,i=r&&this.viewState[r.getViewStateId()]||this.viewState;return r?r.filterViewState(i):i}getViewport(t){return this._viewportMap[t]}unproject(t,r){let i=this.getViewports(),s={x:t[0],y:t[1]};for(let n=i.length-1;n>=0;--n){let o=i[n];if(o.containsPixel(s)){let c=t.slice();return c[0]-=o.x,c[1]-=o.y,o.unproject(c,r)}}return null}setProps(t){t.views&&this._setViews(t.views),t.viewState&&this._setViewState(t.viewState),("width"in t||"height"in t)&&this._setSize(t.width,t.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(t,r){(t!==this.width||r!==this.height)&&(this.width=t,this.height=r,this.setNeedsUpdate("Size changed"))}_setViews(t){t=Nu(t,Boolean),this._diffViews(t,this.views)&&this.setNeedsUpdate("views changed"),this.views=t}_setViewState(t){t?(!Ba(t,this.viewState,3)&&this.setNeedsUpdate("viewState changed"),this.viewState=t):mi.warn("missing `viewState` or `initialViewState`")()}_createController(t,r){let i=r.type;return new i({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._eventCallbacks.onViewStateChange,onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:n=>this.getView(t.id)?.makeViewport({viewState:n,width:this.width,height:this.height})})}_updateController(t,r,i,s){let n=t.controller;if(n&&i){let o={...r,...n,id:t.id,x:i.x,y:i.y,width:i.width,height:i.height};return(!s||s.constructor!==n.type)&&(s=this._createController(t,o)),s&&s.setProps(o),s}return null}_rebuildViewports(){let{views:t}=this,r=this.controllers;this._viewports=[],this.controllers={};let i=!1;for(let s=t.length;s--;){let n=t[s],o=this.getViewState(n),c=n.makeViewport({viewState:o,width:this.width,height:this.height}),f=r[n.id],p=!!n.controller;p&&!f&&(i=!0),(i||!p)&&f&&(f.finalize(),f=null),this.controllers[n.id]=this._updateController(n,o,c,f),c&&this._viewports.unshift(c)}for(let s in r){let n=r[s];n&&!this.controllers[s]&&n.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(t=>{t.id&&(this._viewportMap[t.id]=this._viewportMap[t.id]||t)})}_diffViews(t,r){return t.length!==r.length?!0:t.some((i,s)=>!t[s].equals(r[s]))}};var eAt=/([0-9]+\.?[0-9]*)(%|px)/;function Ed(e){switch(typeof e){case"number":return{position:e,relative:!1};case"string":let t=eAt.exec(e);if(t&&t.length>=3){let r=t[2]==="%",i=parseFloat(t[1]);return{position:r?i/100:i,relative:r}}default:throw new Error(`Could not parse position string ${e}`)}}function Id(e,t){return e.relative?Math.round(e.position*t):e.position}var vv=class{constructor(t){let{id:r,x:i=0,y:s=0,width:n="100%",height:o="100%",padding:c=null}=t;this.id=r||this.constructor.displayName||"view",this.props={...t,id:this.id},this._x=Ed(i),this._y=Ed(s),this._width=Ed(n),this._height=Ed(o),this._padding=c&&{left:Ed(c.left||0),right:Ed(c.right||0),top:Ed(c.top||0),bottom:Ed(c.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(t){return this===t?!0:this.ViewportType===t.ViewportType&&Ba(this.props,t.props,2)}makeViewport({width:t,height:r,viewState:i}){i=this.filterViewState(i);let s=this.getDimensions({width:t,height:r});return!s.height||!s.width?null:new this.ViewportType({...i,...this.props,...s})}getViewStateId(){let{viewState:t}=this.props;return typeof t=="string"?t:t?.id||this.id}filterViewState(t){if(this.props.viewState&&typeof this.props.viewState=="object"){if(!this.props.viewState.id)return this.props.viewState;let r={...t};for(let i in this.props.viewState)i!=="id"&&(r[i]=this.props.viewState[i]);return r}return t}getDimensions({width:t,height:r}){let i={x:Id(this._x,t),y:Id(this._y,r),width:Id(this._width,t),height:Id(this._height,r)};return this._padding&&(i.padding={left:Id(this._padding.left,t),top:Id(this._padding.top,r),right:Id(this._padding.right,t),bottom:Id(this._padding.bottom,r)}),i}get controller(){let t=this.props.controller;return t?t===!0?{type:this.ControllerType}:typeof t=="function"?{type:t}:{type:this.ControllerType,...t}:null}};var Lh=class{constructor(t){this._inProgress=!1,this._handle=null,this.time=0,this.settings={duration:0},this._timeline=t}get inProgress(){return this._inProgress}start(t){this.cancel(),this.settings=t,this._inProgress=!0,this.settings.onStart?.(this)}end(){this._inProgress&&(this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,this.settings.onEnd?.(this))}cancel(){this._inProgress&&(this.settings.onInterrupt?.(this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1)}update(){if(!this._inProgress)return!1;if(this._handle===null){let{_timeline:t,settings:r}=this;this._handle=t.addChannel({delay:t.getTime(),duration:r.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),this.settings.onUpdate?.(this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}};var Dj=()=>{},Zk={BREAK:1,SNAP_TO_END:2,IGNORE:3},rAt=e=>e,iAt=Zk.BREAK,wv=class{constructor(t){this._onTransitionUpdate=r=>{let{time:i,settings:{interpolator:s,startProps:n,endProps:o,duration:c,easing:f}}=r,p=f(i/c),x=s.interpolateProps(n,o,p);this.propsInTransition=this.getControllerState({...this.props,...x}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})},this.getControllerState=t.getControllerState,this.propsInTransition=null,this.transition=new Lh(t.timeline),this.onViewStateChange=t.onViewStateChange||Dj,this.onStateChange=t.onStateChange||Dj}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(t){let r=!1,i=this.props;if(this.props=t,!i||this._shouldIgnoreViewportChange(i,t))return!1;if(this._isTransitionEnabled(t)){let s=i;if(this.transition.inProgress){let{interruption:n,endProps:o}=this.transition.settings;s={...i,...n===Zk.SNAP_TO_END?o:this.propsInTransition||i}}this._triggerTransition(s,t),r=!0}else this.transition.cancel();return r}updateTransition(){this.transition.update()}_isTransitionEnabled(t){let{transitionDuration:r,transitionInterpolator:i}=t;return(r>0||r==="auto")&&!!i}_isUpdateDueToCurrentTransition(t){return this.transition.inProgress&&this.propsInTransition?this.transition.settings.interpolator.arePropsEqual(t,this.propsInTransition):!1}_shouldIgnoreViewportChange(t,r){return this.transition.inProgress?this.transition.settings.interruption===Zk.IGNORE||this._isUpdateDueToCurrentTransition(r):this._isTransitionEnabled(r)?r.transitionInterpolator.arePropsEqual(t,r):!0}_triggerTransition(t,r){let i=this.getControllerState(t),s=this.getControllerState(r).shortestPathFrom(i),n=r.transitionInterpolator,o=n.getDuration?n.getDuration(t,r):r.transitionDuration;if(o===0)return;let c=n.initializeProps(t,s);this.propsInTransition={};let f={duration:o,easing:r.transitionEasing||rAt,interpolator:n,interruption:r.transitionInterruption||iAt,startProps:c.start,endProps:c.end,onStart:r.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(r.onTransitionInterrupt),onEnd:this._onTransitionEnd(r.onTransitionEnd)};this.transition.start(f),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(t){return r=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),t?.(r)}}};function Qn(e,t){if(!e)throw new Error(t||"deck.gl: assertion failed.")}var Tv=class{constructor(t){let{compare:r,extract:i,required:s}=t;this._propsToCompare=r,this._propsToExtract=i||r,this._requiredProps=s}arePropsEqual(t,r){for(let i of this._propsToCompare)if(!(i in t)||!(i in r)||!vd(t[i],r[i]))return!1;return!0}initializeProps(t,r){let i={},s={};for(let n of this._propsToExtract)(n in t||n in r)&&(i[n]=t[n],s[n]=r[n]);return this._checkRequiredProps(i),this._checkRequiredProps(s),{start:i,end:s}}getDuration(t,r){return r.transitionDuration}_checkRequiredProps(t){this._requiredProps&&this._requiredProps.forEach(r=>{let i=t[r];Qn(Number.isFinite(i)||Array.isArray(i),`${r} is required for transition`)})}};var nAt=["longitude","latitude","zoom","bearing","pitch"],sAt=["longitude","latitude","zoom"],Bg=class extends Tv{constructor(t={}){let r=Array.isArray(t)?t:t.transitionProps,i=Array.isArray(t)?{}:t;i.transitionProps=Array.isArray(r)?{compare:r,required:r}:r||{compare:nAt,required:sAt},super(i.transitionProps),this.opts=i}initializeProps(t,r){let i=super.initializeProps(t,r),{makeViewport:s,around:n}=this.opts;if(s&&n){let o=s(t),c=s(r),f=o.unproject(n);i.start.around=n,Object.assign(i.end,{around:c.project(f),aroundPosition:f,width:r.width,height:r.height})}return i}interpolateProps(t,r,i){let s={};for(let n of this._propsToExtract)s[n]=Vf(t[n]||0,r[n]||0,i);if(r.aroundPosition&&this.opts.makeViewport){let n=this.opts.makeViewport({...r,...s});Object.assign(s,n.panByPosition(r.aroundPosition,Vf(t.around,r.around,i)))}return s}};var xA={transitionDuration:0},oAt=300,sS=e=>1-(1-e)*(1-e),Ry={WHEEL:["wheel"],PAN:["panstart","panmove","panend"],PINCH:["pinchstart","pinchmove","pinchend"],TRIPLE_PAN:["tripanstart","tripanmove","tripanend"],DOUBLE_TAP:["doubletap"],KEYBOARD:["keydown"]},Og={},Sv=class{constructor(t){this.state={},this._events={},this._interactionState={isDragging:!1},this._customEvents=[],this._eventStartBlocked=null,this._panMove=!1,this.invertPan=!1,this.dragMode="rotate",this.inertia=0,this.scrollZoom=!0,this.dragPan=!0,this.dragRotate=!0,this.doubleClickZoom=!0,this.touchZoom=!0,this.touchRotate=!1,this.keyboard=!0,this.transitionManager=new wv({...t,getControllerState:r=>new this.ControllerState(r),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=t.eventManager,this.onViewStateChange=t.onViewStateChange||(()=>{}),this.onStateChange=t.onStateChange||(()=>{}),this.makeViewport=t.makeViewport}set events(t){this.toggleEvents(this._customEvents,!1),this.toggleEvents(t,!0),this._customEvents=t,this.props&&this.setProps(this.props)}finalize(){for(let t in this._events)this._events[t]&&this.eventManager?.off(t,this.handleEvent);this.transitionManager.finalize()}handleEvent(t){this._controllerState=void 0;let r=this._eventStartBlocked;switch(t.type){case"panstart":return r?!1:this._onPanStart(t);case"panmove":return this._onPan(t);case"panend":return this._onPanEnd(t);case"pinchstart":return r?!1:this._onPinchStart(t);case"pinchmove":return this._onPinch(t);case"pinchend":return this._onPinchEnd(t);case"tripanstart":return r?!1:this._onTriplePanStart(t);case"tripanmove":return this._onTriplePan(t);case"tripanend":return this._onTriplePanEnd(t);case"doubletap":return this._onDoubleTap(t);case"wheel":return this._onWheel(t);case"keydown":return this._onKeyDown(t);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(t){let{x:r,y:i}=this.props,{offsetCenter:s}=t;return[s.x-r,s.y-i]}isPointInBounds(t,r){let{width:i,height:s}=this.props;if(r&&r.handled)return!1;let n=t[0]>=0&&t[0]<=i&&t[1]>=0&&t[1]<=s;return n&&r&&r.stopPropagation(),n}isFunctionKeyPressed(t){let{srcEvent:r}=t;return!!(r.metaKey||r.altKey||r.ctrlKey||r.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(t){let r=setTimeout(()=>{this._eventStartBlocked===r&&(this._eventStartBlocked=null)},t);this._eventStartBlocked=r}setProps(t){t.dragMode&&(this.dragMode=t.dragMode),this.props=t,"transitionInterpolator"in t||(t.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(t);let{inertia:r}=t;this.inertia=Number.isFinite(r)?r:r===!0?oAt:0;let{scrollZoom:i=!0,dragPan:s=!0,dragRotate:n=!0,doubleClickZoom:o=!0,touchZoom:c=!0,touchRotate:f=!1,keyboard:p=!0}=t,x=!!this.onViewStateChange;this.toggleEvents(Ry.WHEEL,x&&i),this.toggleEvents(Ry.PAN,x),this.toggleEvents(Ry.PINCH,x&&(c||f)),this.toggleEvents(Ry.TRIPLE_PAN,x&&f),this.toggleEvents(Ry.DOUBLE_TAP,x&&o),this.toggleEvents(Ry.KEYBOARD,x&&p),this.scrollZoom=i,this.dragPan=s,this.dragRotate=n,this.doubleClickZoom=o,this.touchZoom=c,this.touchRotate=f,this.keyboard=p}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(t,r){this.eventManager&&t.forEach(i=>{this._events[i]!==r&&(this._events[i]=r,r?this.eventManager.on(i,this.handleEvent):this.eventManager.off(i,this.handleEvent))})}updateViewport(t,r=null,i={}){let s={...t.getViewportProps(),...r},n=this.controllerState!==t;if(this.state=t.getState(),this._setInteractionState(i),n){let o=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:s,interactionState:this._interactionState,oldViewState:o,viewId:this.props.id})}}_onTransition(t){this.onViewStateChange({...t,interactionState:this._interactionState,viewId:this.props.id})}_setInteractionState(t){Object.assign(this._interactionState,t),this.onStateChange(this._interactionState)}_onPanStart(t){let r=this.getCenter(t);if(!this.isPointInBounds(r,t))return!1;let i=this.isFunctionKeyPressed(t)||t.rightButton||!1;(this.invertPan||this.dragMode==="pan")&&(i=!i);let s=this.controllerState[i?"panStart":"rotateStart"]({pos:r});return this._panMove=i,this.updateViewport(s,xA,{isDragging:!0}),!0}_onPan(t){return this.isDragging()?this._panMove?this._onPanMove(t):this._onPanRotate(t):!1}_onPanEnd(t){return this.isDragging()?this._panMove?this._onPanMoveEnd(t):this._onPanRotateEnd(t):!1}_onPanMove(t){if(!this.dragPan)return!1;let r=this.getCenter(t),i=this.controllerState.pan({pos:r});return this.updateViewport(i,xA,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(t){let{inertia:r}=this;if(this.dragPan&&r&&t.velocity){let i=this.getCenter(t),s=[i[0]+t.velocityX*r/2,i[1]+t.velocityY*r/2],n=this.controllerState.pan({pos:s}).panEnd();this.updateViewport(n,{...this._getTransitionProps(),transitionDuration:r,transitionEasing:sS},{isDragging:!1,isPanning:!0})}else{let i=this.controllerState.panEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(t){if(!this.dragRotate)return!1;let r=this.getCenter(t),i=this.controllerState.rotate({pos:r});return this.updateViewport(i,xA,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(t){let{inertia:r}=this;if(this.dragRotate&&r&&t.velocity){let i=this.getCenter(t),s=[i[0]+t.velocityX*r/2,i[1]+t.velocityY*r/2],n=this.controllerState.rotate({pos:s}).rotateEnd();this.updateViewport(n,{...this._getTransitionProps(),transitionDuration:r,transitionEasing:sS},{isDragging:!1,isRotating:!0})}else{let i=this.controllerState.rotateEnd();this.updateViewport(i,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(t){if(!this.scrollZoom)return!1;let r=this.getCenter(t);if(!this.isPointInBounds(r,t))return!1;t.srcEvent.preventDefault();let{speed:i=.01,smooth:s=!1}=this.scrollZoom===!0?{}:this.scrollZoom,{delta:n}=t,o=2/(1+Math.exp(-Math.abs(n*i)));n<0&&o!==0&&(o=1/o);let c=this.controllerState.zoom({pos:r,scale:o});return this.updateViewport(c,{...this._getTransitionProps({around:r}),transitionDuration:s?250:1},{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(t){let r=this.getCenter(t);if(!this.isPointInBounds(r,t))return!1;let i=this.controllerState.rotateStart({pos:r});return this.updateViewport(i,xA,{isDragging:!0}),!0}_onTriplePan(t){if(!this.touchRotate||!this.isDragging())return!1;let r=this.getCenter(t);r[0]-=t.deltaX;let i=this.controllerState.rotate({pos:r});return this.updateViewport(i,xA,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(t){if(!this.isDragging())return!1;let{inertia:r}=this;if(this.touchRotate&&r&&t.velocityY){let i=this.getCenter(t),s=[i[0],i[1]+=t.velocityY*r/2],n=this.controllerState.rotate({pos:s});this.updateViewport(n,{...this._getTransitionProps(),transitionDuration:r,transitionEasing:sS},{isDragging:!1,isRotating:!0}),this.blockEvents(r)}else{let i=this.controllerState.rotateEnd();this.updateViewport(i,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(t){let r=this.getCenter(t);if(!this.isPointInBounds(r,t))return!1;let i=this.controllerState.zoomStart({pos:r}).rotateStart({pos:r});return Og._startPinchRotation=t.rotation,Og._lastPinchEvent=t,this.updateViewport(i,xA,{isDragging:!0}),!0}_onPinch(t){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let r=this.controllerState;if(this.touchZoom){let{scale:i}=t,s=this.getCenter(t);r=r.zoom({pos:s,scale:i})}if(this.touchRotate){let{rotation:i}=t;r=r.rotate({deltaAngleX:Og._startPinchRotation-i})}return this.updateViewport(r,xA,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),Og._lastPinchEvent=t,!0}_onPinchEnd(t){if(!this.isDragging())return!1;let{inertia:r}=this,{_lastPinchEvent:i}=Og;if(this.touchZoom&&r&&i&&t.scale!==i.scale){let s=this.getCenter(t),n=this.controllerState.rotateEnd(),o=Math.log2(t.scale),c=(o-Math.log2(i.scale))/(t.deltaTime-i.deltaTime),f=Math.pow(2,o+c*r/2);n=n.zoom({pos:s,scale:f}).zoomEnd(),this.updateViewport(n,{...this._getTransitionProps({around:s}),transitionDuration:r,transitionEasing:sS},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(r)}else{let s=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(s,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return Og._startPinchRotation=null,Og._lastPinchEvent=null,!0}_onDoubleTap(t){if(!this.doubleClickZoom)return!1;let r=this.getCenter(t);if(!this.isPointInBounds(r,t))return!1;let i=this.isFunctionKeyPressed(t),s=this.controllerState.zoom({pos:r,scale:i?.5:2});return this.updateViewport(s,this._getTransitionProps({around:r}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(t){if(!this.keyboard)return!1;let r=this.isFunctionKeyPressed(t),{zoomSpeed:i,moveSpeed:s,rotateSpeedX:n,rotateSpeedY:o}=this.keyboard===!0?{}:this.keyboard,{controllerState:c}=this,f,p={};switch(t.srcEvent.code){case"Minus":f=r?c.zoomOut(i).zoomOut(i):c.zoomOut(i),p.isZooming=!0;break;case"Equal":f=r?c.zoomIn(i).zoomIn(i):c.zoomIn(i),p.isZooming=!0;break;case"ArrowLeft":r?(f=c.rotateLeft(n),p.isRotating=!0):(f=c.moveLeft(s),p.isPanning=!0);break;case"ArrowRight":r?(f=c.rotateRight(n),p.isRotating=!0):(f=c.moveRight(s),p.isPanning=!0);break;case"ArrowUp":r?(f=c.rotateUp(o),p.isRotating=!0):(f=c.moveUp(s),p.isPanning=!0);break;case"ArrowDown":r?(f=c.rotateDown(o),p.isRotating=!0):(f=c.moveDown(s),p.isPanning=!0);break;default:return!1}return this.updateViewport(f,this._getTransitionProps(),p),!0}_getTransitionProps(t){let{transition:r}=this;return!r||!r.transitionInterpolator?xA:t?{...r,transitionInterpolator:new Bg({...t,...r.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:r}};var Ev=class{constructor(t,r){this._viewportProps=this.applyConstraints(t),this._state=r}getViewportProps(){return this._viewportProps}getState(){return this._state}};var Bj=5,aAt=1.2,Gk=class extends Ev{constructor(t){let{width:r,height:i,latitude:s,longitude:n,zoom:o,bearing:c=0,pitch:f=0,altitude:p=1.5,position:x=[0,0,0],maxZoom:E=20,minZoom:T=0,maxPitch:D=60,minPitch:N=0,startPanLngLat:z,startZoomLngLat:U,startRotatePos:H,startBearing:G,startPitch:Z,startZoom:Y,normalize:st=!0}=t;Qn(Number.isFinite(n)),Qn(Number.isFinite(s)),Qn(Number.isFinite(o)),super({width:r,height:i,latitude:s,longitude:n,zoom:o,bearing:c,pitch:f,altitude:p,maxZoom:E,minZoom:T,maxPitch:D,minPitch:N,normalize:st,position:x},{startPanLngLat:z,startZoomLngLat:U,startRotatePos:H,startBearing:G,startPitch:Z,startZoom:Y}),this.makeViewport=t.makeViewport}panStart({pos:t}){return this._getUpdatedState({startPanLngLat:this._unproject(t)})}pan({pos:t,startPos:r}){let i=this.getState().startPanLngLat||this._unproject(r);if(!i)return this;let n=this.makeViewport(this.getViewportProps()).panByPosition(i,t);return this._getUpdatedState(n)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:t}){return this._getUpdatedState({startRotatePos:t,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:t,deltaAngleX:r=0,deltaAngleY:i=0}){let{startRotatePos:s,startBearing:n,startPitch:o}=this.getState();if(!s||n===void 0||o===void 0)return this;let c;return t?c=this._getNewRotation(t,s,o,n):c={bearing:n+r,pitch:o+i},this._getUpdatedState(c)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:t}){return this._getUpdatedState({startZoomLngLat:this._unproject(t),startZoom:this.getViewportProps().zoom})}zoom({pos:t,startPos:r,scale:i}){let{startZoom:s,startZoomLngLat:n}=this.getState();if(n||(s=this.getViewportProps().zoom,n=this._unproject(r)||this._unproject(t)),!n)return this;let{maxZoom:o,minZoom:c}=this.getViewportProps(),f=s+Math.log2(i);f=ku(f,c,o);let p=this.makeViewport({...this.getViewportProps(),zoom:f});return this._getUpdatedState({zoom:f,...p.panByPosition(n,t)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(t=2){return this._zoomFromCenter(t)}zoomOut(t=2){return this._zoomFromCenter(1/t)}moveLeft(t=100){return this._panFromCenter([t,0])}moveRight(t=100){return this._panFromCenter([-t,0])}moveUp(t=100){return this._panFromCenter([0,t])}moveDown(t=100){return this._panFromCenter([0,-t])}rotateLeft(t=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-t})}rotateRight(t=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+t})}rotateUp(t=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+t})}rotateDown(t=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-t})}shortestPathFrom(t){let r=t.getViewportProps(),i={...this.getViewportProps()},{bearing:s,longitude:n}=i;return Math.abs(s-r.bearing)>180&&(i.bearing=s<0?s+360:s-360),Math.abs(n-r.longitude)>180&&(i.longitude=n<0?n+360:n-360),i}applyConstraints(t){let{maxZoom:r,minZoom:i,zoom:s}=t;t.zoom=ku(s,i,r);let{maxPitch:n,minPitch:o,pitch:c}=t;t.pitch=ku(c,o,n);let{normalize:f=!0}=t;return f&&Object.assign(t,$k(t)),t}_zoomFromCenter(t){let{width:r,height:i}=this.getViewportProps();return this.zoom({pos:[r/2,i/2],scale:t})}_panFromCenter(t){let{width:r,height:i}=this.getViewportProps();return this.pan({startPos:[r/2,i/2],pos:[r/2+t[0],i/2+t[1]]})}_getUpdatedState(t){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...t})}_unproject(t){let r=this.makeViewport(this.getViewportProps());return t&&r.unproject(t)}_getNewRotation(t,r,i,s){let n=t[0]-r[0],o=t[1]-r[1],c=t[1],f=r[1],{width:p,height:x}=this.getViewportProps(),E=n/p,T=0;o>0?Math.abs(x-f)>Bj&&(T=o/(f-x)*aAt):o<0&&f>Bj&&(T=1-c/f),T=ku(T,-1,1);let{minPitch:D,maxPitch:N}=this.getViewportProps(),z=s+180*E,U=i;return T>0?U=i+T*(N-i):T<0&&(U=i-T*(D-i)),{pitch:U,bearing:z}}},Iv=class extends Sv{constructor(){super(...arguments),this.ControllerState=Gk,this.transition={transitionDuration:300,transitionInterpolator:new Bg({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})},this.dragMode="pan"}setProps(t){t.position=t.position||[0,0,0];let r=this.props;super.setProps(t),(!r||r.height!==t.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...t,...this.state}))}};var bA=class extends vv{static{this.displayName="MapView"}constructor(t={}){super(t)}get ViewportType(){return qf}get ControllerType(){return Iv}};var lAt=new Ey;function cAt(e,t){let r=e.order??1/0,i=t.order??1/0;return r-i}var Mv=class{constructor(t){this._resolvedEffects=[],this._defaultEffects=[],this.effects=[],this._context=t,this._needsRedraw="Initial render",this._setEffects([])}addDefaultEffect(t){let r=this._defaultEffects;if(!r.find(i=>i.id===t.id)){let i=r.findIndex(s=>cAt(s,t)>0);i<0?r.push(t):r.splice(i,0,t),t.setup(this._context),this._setEffects(this.effects)}}setProps(t){"effects"in t&&(Ba(t.effects,this.effects,1)||this._setEffects(t.effects))}needsRedraw(t={clearRedrawFlags:!1}){let r=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),r}getEffects(){return this._resolvedEffects}_setEffects(t){let r={};for(let s of this.effects)r[s.id]=s;let i=[];for(let s of t){let n=r[s.id],o=s;n&&n!==s?n.setProps?(n.setProps(s.props),o=n):n.cleanup(this._context):n||s.setup(this._context),i.push(o),delete r[s.id]}for(let s in r)r[s].cleanup(this._context);this.effects=i,this._resolvedEffects=i.concat(this._defaultEffects),t.some(s=>s instanceof Ey)||this._resolvedEffects.push(lAt),this._needsRedraw="effects changed"}finalize(){for(let t of this._resolvedEffects)t.cleanup(this._context);this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}};var Cv=class extends Td{shouldDrawLayer(t){let{operation:r}=t.props;return r.includes("draw")||r.includes("terrain")}};var uAt="deckRenderer.renderLayers",Pv=class{constructor(t){this.device=t,this.gl=t.gl,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new Cv(t),this.pickLayersPass=new Dg(t),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(t){this.layerFilter!==t.layerFilter&&(this.layerFilter=t.layerFilter,this._needsRedraw="layerFilter changed"),this.drawPickingColors!==t.drawPickingColors&&(this.drawPickingColors=t.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(t){if(!t.viewports.length)return;let r=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,i={layerFilter:this.layerFilter,isPicking:this.drawPickingColors,...t};i.effects&&this._preRender(i.effects,i);let s=this.lastPostProcessEffect?this.renderBuffers[0]:i.target;this.lastPostProcessEffect&&(i.clearColor=[0,0,0,0],i.clearCanvas=!0);let n=r.render({...i,target:s});i.effects&&this._postRender(i.effects,i),this.renderCount++,so(uAt,this,n,t)}needsRedraw(t={clearRedrawFlags:!1}){let r=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),r}finalize(){let{renderBuffers:t}=this;for(let r of t)r.delete();t.length=0}_preRender(t,r){this.lastPostProcessEffect=null,r.preRenderStats=r.preRenderStats||{};for(let i of t)r.preRenderStats[i.id]=i.preRender(r),i.postRender&&(this.lastPostProcessEffect=i.id);this.lastPostProcessEffect&&this._resizeRenderBuffers()}_resizeRenderBuffers(){let{renderBuffers:t}=this,r=this.device.canvasContext.getDrawingBufferSize();t.length===0&&[0,1].map(i=>{let s=this.device.createTexture({sampler:{minFilter:"linear",magFilter:"linear"}});t.push(this.device.createFramebuffer({id:`deck-renderbuffer-${i}`,colorAttachments:[s]}))});for(let i of t)i.resize(r)}_postRender(t,r){let{renderBuffers:i}=this,s={...r,inputBuffer:i[0],swapBuffer:i[1]};for(let n of t)if(n.postRender){s.target=n.id===this.lastPostProcessEffect?r.target:void 0;let o=n.postRender(s);s.inputBuffer=o,s.swapBuffer=o===i[0]?i[1]:i[0]}}};var hAt={pickedColor:null,pickedObjectIndex:-1};function Oj({pickedColors:e,decodePickingColor:t,deviceX:r,deviceY:i,deviceRadius:s,deviceRect:n}){let{x:o,y:c,width:f,height:p}=n,x=s*s,E=-1,T=0;for(let D=0;D<p;D++){let N=D+c-i,z=N*N;if(z>x)T+=4*f;else for(let U=0;U<f;U++){if(e[T+3]-1>=0){let G=U+o-r,Z=G*G+z;Z<=x&&(x=Z,E=T)}T+=4}}if(E>=0){let D=e.slice(E,E+4),N=t(D);if(N){let z=Math.floor(E/4/f),U=E/4-z*f;return{...N,pickedColor:D,pickedX:o+U,pickedY:c+z}}mi.error("Picked non-existent layer. Is picking buffer corrupt?")()}return hAt}function Nj({pickedColors:e,decodePickingColor:t}){let r=new Map;if(e){for(let i=0;i<e.length;i+=4)if(e[i+3]-1>=0){let n=e.slice(i,i+4),o=n.join(",");if(!r.has(o)){let c=t(n);c?r.set(o,{...c,color:n}):mi.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(r.values())}function Qk({pickInfo:e,viewports:t,pixelRatio:r,x:i,y:s,z:n}){let o=t[0];t.length>1&&(o=fAt(e?.pickedViewports||t,{x:i,y:s}));let c;if(o){let f=[i-o.x,s-o.y];n!==void 0&&(f[2]=n),c=o.unproject(f)}return{color:null,layer:null,viewport:o,index:-1,picked:!1,x:i,y:s,pixel:[i,s],coordinate:c,devicePixel:e&&"pickedX"in e?[e.pickedX,e.pickedY]:void 0,pixelRatio:r}}function Fj(e){let{pickInfo:t,lastPickedInfo:r,mode:i,layers:s}=e,{pickedColor:n,pickedLayer:o,pickedObjectIndex:c}=t,f=o?[o]:[];if(i==="hover"){let E=r.index,T=r.layerId,D=o?o.props.id:null;if(D!==T||c!==E){if(D!==T){let N=s.find(z=>z.props.id===T);N&&f.unshift(N)}r.layerId=D,r.index=c,r.info=null}}let p=Qk(e),x=new Map;return x.set(null,p),f.forEach(E=>{let T={...p};E===o&&(T.color=n,T.index=c,T.picked=!0),T=Kk({layer:E,info:T,mode:i});let D=T.layer;E===o&&i==="hover"&&(r.info=T),x.set(D.id,T),i==="hover"&&D.updateAutoHighlight(T)}),x}function Kk({layer:e,info:t,mode:r}){for(;e&&t;){let i=t.layer||null;t.sourceLayer=i,t.layer=e,t=e.getPickingInfo({info:t,mode:r,sourceLayer:i}),e=e.parent}return t}function fAt(e,t){for(let r=e.length-1;r>=0;r--){let i=e[r];if(i.containsPixel(t))return i}return e[0]}var Rv=class{constructor(t){this._pickable=!0,this.device=t,this.pickLayersPass=new Dg(t),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(t){"layerFilter"in t&&(this.layerFilter=t.layerFilter),"_pickable"in t&&(this._pickable=t._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.destroy(),this.depthFBO&&this.depthFBO.destroy()}pickObject(t){return this._pickClosestObject(t)}pickObjects(t){return this._pickVisibleObjects(t)}getLastPickedObject({x:t,y:r,layers:i,viewports:s},n=this.lastPickedInfo.info){let o=n&&n.layer&&n.layer.id,c=n&&n.viewport&&n.viewport.id,f=o?i.find(T=>T.id===o):null,p=c&&s.find(T=>T.id===c)||s[0],x=p&&p.unproject([t-p.x,r-p.y]);return{...n,...{x:t,y:r,viewport:p,coordinate:x,layer:f}}}_resizeBuffer(){if(!this.pickingFBO&&(this.pickingFBO=this.device.createFramebuffer({colorAttachments:["rgba8unorm"],depthStencilAttachment:"depth16unorm"}),this.device.isTextureFormatRenderable("rgba32float"))){let r=this.device.createFramebuffer({colorAttachments:["rgba32float"],depthStencilAttachment:"depth16unorm"});this.depthFBO=r}let t=this.device.gl;this.pickingFBO?.resize({width:t.canvas.width,height:t.canvas.height}),this.depthFBO?.resize({width:t.canvas.width,height:t.canvas.height})}_getPickable(t){if(this._pickable===!1)return null;let r=t.filter(i=>this.pickLayersPass.shouldDrawLayer(i)&&!i.isComposite);return r.length?r:null}_pickClosestObject({layers:t,views:r,viewports:i,x:s,y:n,radius:o=0,depth:c=1,mode:f="query",unproject3D:p,onViewportActive:x,effects:E}){let T=this.device.canvasContext.cssToDeviceRatio(),D=this._getPickable(t);if(!D||i.length===0)return{result:[],emptyInfo:Qk({viewports:i,x:s,y:n,pixelRatio:T})};this._resizeBuffer();let N=this.device.canvasContext.cssToDevicePixels([s,n],!0),z=[N.x+Math.floor(N.width/2),N.y+Math.floor(N.height/2)],U=Math.round(o*T),{width:H,height:G}=this.pickingFBO,Z=this._getPickingRect({deviceX:z[0],deviceY:z[1],deviceRadius:U,deviceWidth:H,deviceHeight:G}),Y={x:s-o,y:n-o,width:o*2+1,height:o*2+1},st,at=[],Dt=new Set;for(let Tt=0;Tt<c;Tt++){let kt;if(Z){let Mt=this._drawAndSample({layers:D,views:r,viewports:i,onViewportActive:x,deviceRect:Z,cullRect:Y,effects:E,pass:`picking:${f}`});kt=Oj({...Mt,deviceX:z[0],deviceY:z[1],deviceRadius:U,deviceRect:Z})}else kt={pickedColor:null,pickedObjectIndex:-1};let Et;if(kt.pickedLayer&&p&&this.depthFBO){let{pickedColors:Mt}=this._drawAndSample({layers:[kt.pickedLayer],views:r,viewports:i,onViewportActive:x,deviceRect:{x:kt.pickedX,y:kt.pickedY,width:1,height:1},cullRect:Y,effects:E,pass:`picking:${f}:z`},!0);Mt[3]&&(Et=Mt[0])}kt.pickedLayer&&Tt+1<c&&(Dt.add(kt.pickedLayer),kt.pickedLayer.disablePickingIndex(kt.pickedObjectIndex)),st=Fj({pickInfo:kt,lastPickedInfo:this.lastPickedInfo,mode:f,layers:D,viewports:i,x:s,y:n,z:Et,pixelRatio:T});for(let Mt of st.values())Mt.layer&&at.push(Mt);if(!kt.pickedColor)break}for(let Tt of Dt)Tt.restorePickingColors();return{result:at,emptyInfo:st.get(null)}}_pickVisibleObjects({layers:t,views:r,viewports:i,x:s,y:n,width:o=1,height:c=1,mode:f="query",maxObjects:p=null,onViewportActive:x,effects:E}){let T=this._getPickable(t);if(!T||i.length===0)return[];this._resizeBuffer();let D=this.device.canvasContext.cssToDeviceRatio(),N=this.device.canvasContext.cssToDevicePixels([s,n],!0),z=N.x,U=N.y+N.height,H=this.device.canvasContext.cssToDevicePixels([s+o,n+c],!0),G=H.x+H.width,Z=H.y,Y={x:z,y:Z,width:G-z,height:U-Z},st=this._drawAndSample({layers:T,views:r,viewports:i,onViewportActive:x,deviceRect:Y,cullRect:{x:s,y:n,width:o,height:c},effects:E,pass:`picking:${f}`}),at=Nj(st),Dt=new Map,Tt=[],kt=Number.isFinite(p);for(let Et=0;Et<at.length&&!(kt&&Tt.length>=p);Et++){let Mt=at[Et],oe={color:Mt.pickedColor,layer:null,index:Mt.pickedObjectIndex,picked:!0,x:s,y:n,pixelRatio:D};oe=Kk({layer:Mt.pickedLayer,info:oe,mode:f});let Xt=oe.layer.id;Dt.has(Xt)||Dt.set(Xt,new Set);let xt=Dt.get(Xt),jt=oe.object??oe.index;xt.has(jt)||(xt.add(jt),Tt.push(oe))}return Tt}_drawAndSample({layers:t,views:r,viewports:i,onViewportActive:s,deviceRect:n,cullRect:o,effects:c,pass:f},p=!1){let x=p?this.depthFBO:this.pickingFBO,E={layers:t,layerFilter:this.layerFilter,views:r,viewports:i,onViewportActive:s,pickingFBO:x,deviceRect:n,cullRect:o,effects:c,pass:f,pickZ:p,preRenderStats:{}};for(let G of c)G.useInPicking&&(E.preRenderStats[G.id]=G.preRender(E));let{decodePickingColor:T}=this.pickLayersPass.render(E),{x:D,y:N,width:z,height:U}=n,H=new(p?Float32Array:Uint8Array)(z*U*4);return this.device.readPixelsToArrayWebGL(x,{sourceX:D,sourceY:N,sourceWidth:z,sourceHeight:U,target:H}),{pickedColors:H,decodePickingColor:T}}_getPickingRect({deviceX:t,deviceY:r,deviceRadius:i,deviceWidth:s,deviceHeight:n}){let o=Math.max(0,t-i),c=Math.max(0,r-i),f=Math.min(s,t+i+1)-o,p=Math.min(n,r+i+1)-c;return f<=0||p<=0?null:{x:o,y:c,width:f,height:p}}};var pAt={"top-left":{top:0,left:0},"top-right":{top:0,right:0},"bottom-left":{bottom:0,left:0},"bottom-right":{bottom:0,right:0},fill:{top:0,left:0,bottom:0,right:0}},dAt="top-left",Lj="__root",oS=class{constructor({deck:t,parentElement:r}){this.defaultWidgets=[],this.widgets=[],this.resolvedWidgets=[],this.containers={},this.lastViewports={},this.deck=t,this.parentElement=r}getWidgets(){return this.resolvedWidgets}setProps(t){t.widgets&&!Ba(t.widgets,this.widgets,1)&&this._setWidgets(t.widgets)}finalize(){for(let t of this.getWidgets())this._remove(t);this.defaultWidgets.length=0,this.resolvedWidgets.length=0;for(let t in this.containers)this.containers[t].remove()}addDefault(t){this.defaultWidgets.find(r=>r.id===t.id)||(this._add(t),this.defaultWidgets.push(t),this._setWidgets(this.widgets))}_setWidgets(t){let r={};for(let i of this.resolvedWidgets)r[i.id]=i;this.resolvedWidgets.length=0;for(let i of this.defaultWidgets)r[i.id]=null,this.resolvedWidgets.push(i);for(let i of t){let s=r[i.id];s?s.viewId!==i.viewId||s.placement!==i.placement?(this._remove(s),this._add(i)):i!==s&&(s.setProps(i.props),i=s):this._add(i),r[i.id]=null,this.resolvedWidgets.push(i)}for(let i in r){let s=r[i];s&&this._remove(s)}this.widgets=t}_add(t){let{viewId:r=null,placement:i=dAt}=t,s=t.onAdd({deck:this.deck,viewId:r});s&&this._getContainer(r,i).append(s),t._element=s}_remove(t){t.onRemove(),t._element&&t._element.remove(),t._element=void 0}_getContainer(t,r){let i=t||Lj,s=this.containers[i];s||(s=document.createElement("div"),s.style.pointerEvents="none",s.style.position="absolute",s.style.overflow="hidden",this.parentElement?.append(s),this.containers[i]=s);let n=s.querySelector(`.${r}`);return n||(n=document.createElement("div"),n.className=r,n.style.position="absolute",Object.assign(n.style,pAt[r]),s.append(n)),n}_updateContainers(){let t=this.deck.width,r=this.deck.height;for(let i in this.containers){let s=this.lastViewports[i]||null,n=i===Lj||s,o=this.containers[i];n?(o.style.display="block",o.style.left=`${s?s.x:0}px`,o.style.top=`${s?s.y:0}px`,o.style.width=`${s?s.width:t}px`,o.style.height=`${s?s.height:r}px`):o.style.display="none"}}onRedraw({viewports:t,layers:r}){let i=t.reduce((n,o)=>(n[o.id]=o,n),{}),{lastViewports:s}=this;for(let n of this.getWidgets()){let{viewId:o}=n;if(o){let c=i[o];c&&(n.onViewportChange&&!c.equals(s[o])&&n.onViewportChange(c),n.onRedraw?.({viewports:[c],layers:r}))}else{if(n.onViewportChange)for(let c of t)c.equals(s[c.id])||n.onViewportChange(c);n.onRedraw?.({viewports:t,layers:r})}}this.lastViewports=i,this._updateContainers()}onHover(t,r){for(let i of this.getWidgets()){let{viewId:s}=i;(!s||s===t.viewport?.id)&&i.onHover?.(t,r)}}onEvent(t,r){let i=cv[r.type];if(i)for(let s of this.getWidgets()){let{viewId:n}=s;(!n||n===t.viewport?.id)&&s[i.handler]?.(t,r)}}};var AAt={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"},kv=class{constructor(){this.id="default-tooltip",this.placement="fill",this.props={},this.isVisible=!1}onAdd({deck:t}){let r=document.createElement("div");return r.className="deck-tooltip",Object.assign(r.style,AAt),this.deck=t,this.element=r,r}onRemove(){this.deck=void 0,this.element=void 0}setProps(){}onViewportChange(t){this.isVisible&&t.id===this.lastViewport?.id&&t!==this.lastViewport&&this.setTooltip(null)}onHover(t){let{deck:r}=this,i=r&&r.props.getTooltip;if(!i)return;let s=i(t);this.lastViewport=t.viewport,this.setTooltip(s,t.x,t.y)}setTooltip(t,r,i){let s=this.element;if(s){if(typeof t=="string")s.innerText=t;else if(t)t.text&&(s.innerText=t.text),t.html&&(s.innerHTML=t.html),t.className&&(s.className=t.className);else{this.isVisible=!1,s.style.display="none";return}this.isVisible=!0,s.style.display="block",s.style.transform=`translate(${r}px, ${i}px)`,t&&typeof t=="object"&&"style"in t&&Object.assign(s.style,t.style)}}};var vA;(function(e){e[e.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",e[e.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",e[e.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN",e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.SRC_COLOR=768]="SRC_COLOR",e[e.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",e[e.SRC_ALPHA=770]="SRC_ALPHA",e[e.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",e[e.DST_ALPHA=772]="DST_ALPHA",e[e.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",e[e.DST_COLOR=774]="DST_COLOR",e[e.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",e[e.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",e[e.CONSTANT_COLOR=32769]="CONSTANT_COLOR",e[e.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",e[e.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",e[e.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",e[e.FUNC_ADD=32774]="FUNC_ADD",e[e.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",e[e.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",e[e.BLEND_EQUATION=32777]="BLEND_EQUATION",e[e.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",e[e.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",e[e.BLEND_DST_RGB=32968]="BLEND_DST_RGB",e[e.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",e[e.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",e[e.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",e[e.BLEND_COLOR=32773]="BLEND_COLOR",e[e.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",e[e.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",e[e.LINE_WIDTH=2849]="LINE_WIDTH",e[e.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",e[e.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",e[e.CULL_FACE_MODE=2885]="CULL_FACE_MODE",e[e.FRONT_FACE=2886]="FRONT_FACE",e[e.DEPTH_RANGE=2928]="DEPTH_RANGE",e[e.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",e[e.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",e[e.DEPTH_FUNC=2932]="DEPTH_FUNC",e[e.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",e[e.STENCIL_FUNC=2962]="STENCIL_FUNC",e[e.STENCIL_FAIL=2964]="STENCIL_FAIL",e[e.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",e[e.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",e[e.STENCIL_REF=2967]="STENCIL_REF",e[e.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",e[e.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",e[e.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",e[e.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",e[e.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",e[e.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",e[e.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",e[e.VIEWPORT=2978]="VIEWPORT",e[e.SCISSOR_BOX=3088]="SCISSOR_BOX",e[e.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",e[e.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",e[e.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",e[e.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",e[e.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",e[e.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",e[e.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",e[e.RED_BITS=3410]="RED_BITS",e[e.GREEN_BITS=3411]="GREEN_BITS",e[e.BLUE_BITS=3412]="BLUE_BITS",e[e.ALPHA_BITS=3413]="ALPHA_BITS",e[e.DEPTH_BITS=3414]="DEPTH_BITS",e[e.STENCIL_BITS=3415]="STENCIL_BITS",e[e.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",e[e.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",e[e.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",e[e.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",e[e.SAMPLES=32937]="SAMPLES",e[e.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",e[e.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",e[e.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",e[e.VENDOR=7936]="VENDOR",e[e.RENDERER=7937]="RENDERER",e[e.VERSION=7938]="VERSION",e[e.IMPLEMENTATION_COLOR_READ_TYPE=35738]="IMPLEMENTATION_COLOR_READ_TYPE",e[e.IMPLEMENTATION_COLOR_READ_FORMAT=35739]="IMPLEMENTATION_COLOR_READ_FORMAT",e[e.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",e[e.STATIC_DRAW=35044]="STATIC_DRAW",e[e.STREAM_DRAW=35040]="STREAM_DRAW",e[e.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",e[e.ARRAY_BUFFER=34962]="ARRAY_BUFFER",e[e.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",e[e.BUFFER_SIZE=34660]="BUFFER_SIZE",e[e.BUFFER_USAGE=34661]="BUFFER_USAGE",e[e.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",e[e.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",e[e.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",e[e.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",e[e.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",e[e.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",e[e.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",e[e.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",e[e.CULL_FACE=2884]="CULL_FACE",e[e.FRONT=1028]="FRONT",e[e.BACK=1029]="BACK",e[e.FRONT_AND_BACK=1032]="FRONT_AND_BACK",e[e.BLEND=3042]="BLEND",e[e.DEPTH_TEST=2929]="DEPTH_TEST",e[e.DITHER=3024]="DITHER",e[e.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",e[e.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",e[e.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",e[e.SCISSOR_TEST=3089]="SCISSOR_TEST",e[e.STENCIL_TEST=2960]="STENCIL_TEST",e[e.NO_ERROR=0]="NO_ERROR",e[e.INVALID_ENUM=1280]="INVALID_ENUM",e[e.INVALID_VALUE=1281]="INVALID_VALUE",e[e.INVALID_OPERATION=1282]="INVALID_OPERATION",e[e.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",e[e.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",e[e.CW=2304]="CW",e[e.CCW=2305]="CCW",e[e.DONT_CARE=4352]="DONT_CARE",e[e.FASTEST=4353]="FASTEST",e[e.NICEST=4354]="NICEST",e[e.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",e[e.BYTE=5120]="BYTE",e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.SHORT=5122]="SHORT",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.INT=5124]="INT",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.FLOAT=5126]="FLOAT",e[e.DOUBLE=5130]="DOUBLE",e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.ALPHA=6406]="ALPHA",e[e.RGB=6407]="RGB",e[e.RGBA=6408]="RGBA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",e[e.VERTEX_SHADER=35633]="VERTEX_SHADER",e[e.COMPILE_STATUS=35713]="COMPILE_STATUS",e[e.DELETE_STATUS=35712]="DELETE_STATUS",e[e.LINK_STATUS=35714]="LINK_STATUS",e[e.VALIDATE_STATUS=35715]="VALIDATE_STATUS",e[e.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",e[e.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",e[e.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",e[e.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",e[e.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",e[e.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",e[e.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",e[e.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",e[e.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",e[e.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",e[e.SHADER_TYPE=35663]="SHADER_TYPE",e[e.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",e[e.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",e[e.NEVER=512]="NEVER",e[e.LESS=513]="LESS",e[e.EQUAL=514]="EQUAL",e[e.LEQUAL=515]="LEQUAL",e[e.GREATER=516]="GREATER",e[e.NOTEQUAL=517]="NOTEQUAL",e[e.GEQUAL=518]="GEQUAL",e[e.ALWAYS=519]="ALWAYS",e[e.KEEP=7680]="KEEP",e[e.REPLACE=7681]="REPLACE",e[e.INCR=7682]="INCR",e[e.DECR=7683]="DECR",e[e.INVERT=5386]="INVERT",e[e.INCR_WRAP=34055]="INCR_WRAP",e[e.DECR_WRAP=34056]="DECR_WRAP",e[e.NEAREST=9728]="NEAREST",e[e.LINEAR=9729]="LINEAR",e[e.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",e[e.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",e[e.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",e[e.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",e[e.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",e[e.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",e[e.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",e[e.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE=5890]="TEXTURE",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",e[e.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",e[e.TEXTURE0=33984]="TEXTURE0",e[e.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",e[e.REPEAT=10497]="REPEAT",e[e.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",e[e.TEXTURE_WIDTH=4096]="TEXTURE_WIDTH",e[e.TEXTURE_HEIGHT=4097]="TEXTURE_HEIGHT",e[e.FLOAT_VEC2=35664]="FLOAT_VEC2",e[e.FLOAT_VEC3=35665]="FLOAT_VEC3",e[e.FLOAT_VEC4=35666]="FLOAT_VEC4",e[e.INT_VEC2=35667]="INT_VEC2",e[e.INT_VEC3=35668]="INT_VEC3",e[e.INT_VEC4=35669]="INT_VEC4",e[e.BOOL=35670]="BOOL",e[e.BOOL_VEC2=35671]="BOOL_VEC2",e[e.BOOL_VEC3=35672]="BOOL_VEC3",e[e.BOOL_VEC4=35673]="BOOL_VEC4",e[e.FLOAT_MAT2=35674]="FLOAT_MAT2",e[e.FLOAT_MAT3=35675]="FLOAT_MAT3",e[e.FLOAT_MAT4=35676]="FLOAT_MAT4",e[e.SAMPLER_2D=35678]="SAMPLER_2D",e[e.SAMPLER_CUBE=35680]="SAMPLER_CUBE",e[e.LOW_FLOAT=36336]="LOW_FLOAT",e[e.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",e[e.HIGH_FLOAT=36338]="HIGH_FLOAT",e[e.LOW_INT=36339]="LOW_INT",e[e.MEDIUM_INT=36340]="MEDIUM_INT",e[e.HIGH_INT=36341]="HIGH_INT",e[e.FRAMEBUFFER=36160]="FRAMEBUFFER",e[e.RENDERBUFFER=36161]="RENDERBUFFER",e[e.RGBA4=32854]="RGBA4",e[e.RGB5_A1=32855]="RGB5_A1",e[e.RGB565=36194]="RGB565",e[e.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",e[e.STENCIL_INDEX=6401]="STENCIL_INDEX",e[e.STENCIL_INDEX8=36168]="STENCIL_INDEX8",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e[e.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",e[e.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",e[e.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",e[e.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",e[e.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",e[e.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",e[e.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",e[e.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",e[e.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",e[e.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",e[e.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",e[e.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",e[e.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",e[e.NONE=0]="NONE",e[e.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",e[e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",e[e.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",e[e.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",e[e.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",e[e.READ_FRAMEBUFFER=36008]="READ_FRAMEBUFFER",e[e.DRAW_FRAMEBUFFER=36009]="DRAW_FRAMEBUFFER",e[e.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",e[e.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",e[e.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",e[e.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",e[e.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",e[e.READ_BUFFER=3074]="READ_BUFFER",e[e.UNPACK_ROW_LENGTH=3314]="UNPACK_ROW_LENGTH",e[e.UNPACK_SKIP_ROWS=3315]="UNPACK_SKIP_ROWS",e[e.UNPACK_SKIP_PIXELS=3316]="UNPACK_SKIP_PIXELS",e[e.PACK_ROW_LENGTH=3330]="PACK_ROW_LENGTH",e[e.PACK_SKIP_ROWS=3331]="PACK_SKIP_ROWS",e[e.PACK_SKIP_PIXELS=3332]="PACK_SKIP_PIXELS",e[e.TEXTURE_BINDING_3D=32874]="TEXTURE_BINDING_3D",e[e.UNPACK_SKIP_IMAGES=32877]="UNPACK_SKIP_IMAGES",e[e.UNPACK_IMAGE_HEIGHT=32878]="UNPACK_IMAGE_HEIGHT",e[e.MAX_3D_TEXTURE_SIZE=32883]="MAX_3D_TEXTURE_SIZE",e[e.MAX_ELEMENTS_VERTICES=33e3]="MAX_ELEMENTS_VERTICES",e[e.MAX_ELEMENTS_INDICES=33001]="MAX_ELEMENTS_INDICES",e[e.MAX_TEXTURE_LOD_BIAS=34045]="MAX_TEXTURE_LOD_BIAS",e[e.MAX_FRAGMENT_UNIFORM_COMPONENTS=35657]="MAX_FRAGMENT_UNIFORM_COMPONENTS",e[e.MAX_VERTEX_UNIFORM_COMPONENTS=35658]="MAX_VERTEX_UNIFORM_COMPONENTS",e[e.MAX_ARRAY_TEXTURE_LAYERS=35071]="MAX_ARRAY_TEXTURE_LAYERS",e[e.MIN_PROGRAM_TEXEL_OFFSET=35076]="MIN_PROGRAM_TEXEL_OFFSET",e[e.MAX_PROGRAM_TEXEL_OFFSET=35077]="MAX_PROGRAM_TEXEL_OFFSET",e[e.MAX_VARYING_COMPONENTS=35659]="MAX_VARYING_COMPONENTS",e[e.FRAGMENT_SHADER_DERIVATIVE_HINT=35723]="FRAGMENT_SHADER_DERIVATIVE_HINT",e[e.RASTERIZER_DISCARD=35977]="RASTERIZER_DISCARD",e[e.VERTEX_ARRAY_BINDING=34229]="VERTEX_ARRAY_BINDING",e[e.MAX_VERTEX_OUTPUT_COMPONENTS=37154]="MAX_VERTEX_OUTPUT_COMPONENTS",e[e.MAX_FRAGMENT_INPUT_COMPONENTS=37157]="MAX_FRAGMENT_INPUT_COMPONENTS",e[e.MAX_SERVER_WAIT_TIMEOUT=37137]="MAX_SERVER_WAIT_TIMEOUT",e[e.MAX_ELEMENT_INDEX=36203]="MAX_ELEMENT_INDEX",e[e.RED=6403]="RED",e[e.RGB8=32849]="RGB8",e[e.RGBA8=32856]="RGBA8",e[e.RGB10_A2=32857]="RGB10_A2",e[e.TEXTURE_3D=32879]="TEXTURE_3D",e[e.TEXTURE_WRAP_R=32882]="TEXTURE_WRAP_R",e[e.TEXTURE_MIN_LOD=33082]="TEXTURE_MIN_LOD",e[e.TEXTURE_MAX_LOD=33083]="TEXTURE_MAX_LOD",e[e.TEXTURE_BASE_LEVEL=33084]="TEXTURE_BASE_LEVEL",e[e.TEXTURE_MAX_LEVEL=33085]="TEXTURE_MAX_LEVEL",e[e.TEXTURE_COMPARE_MODE=34892]="TEXTURE_COMPARE_MODE",e[e.TEXTURE_COMPARE_FUNC=34893]="TEXTURE_COMPARE_FUNC",e[e.SRGB=35904]="SRGB",e[e.SRGB8=35905]="SRGB8",e[e.SRGB8_ALPHA8=35907]="SRGB8_ALPHA8",e[e.COMPARE_REF_TO_TEXTURE=34894]="COMPARE_REF_TO_TEXTURE",e[e.RGBA32F=34836]="RGBA32F",e[e.RGB32F=34837]="RGB32F",e[e.RGBA16F=34842]="RGBA16F",e[e.RGB16F=34843]="RGB16F",e[e.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",e[e.TEXTURE_BINDING_2D_ARRAY=35869]="TEXTURE_BINDING_2D_ARRAY",e[e.R11F_G11F_B10F=35898]="R11F_G11F_B10F",e[e.RGB9_E5=35901]="RGB9_E5",e[e.RGBA32UI=36208]="RGBA32UI",e[e.RGB32UI=36209]="RGB32UI",e[e.RGBA16UI=36214]="RGBA16UI",e[e.RGB16UI=36215]="RGB16UI",e[e.RGBA8UI=36220]="RGBA8UI",e[e.RGB8UI=36221]="RGB8UI",e[e.RGBA32I=36226]="RGBA32I",e[e.RGB32I=36227]="RGB32I",e[e.RGBA16I=36232]="RGBA16I",e[e.RGB16I=36233]="RGB16I",e[e.RGBA8I=36238]="RGBA8I",e[e.RGB8I=36239]="RGB8I",e[e.RED_INTEGER=36244]="RED_INTEGER",e[e.RGB_INTEGER=36248]="RGB_INTEGER",e[e.RGBA_INTEGER=36249]="RGBA_INTEGER",e[e.R8=33321]="R8",e[e.RG8=33323]="RG8",e[e.R16F=33325]="R16F",e[e.R32F=33326]="R32F",e[e.RG16F=33327]="RG16F",e[e.RG32F=33328]="RG32F",e[e.R8I=33329]="R8I",e[e.R8UI=33330]="R8UI",e[e.R16I=33331]="R16I",e[e.R16UI=33332]="R16UI",e[e.R32I=33333]="R32I",e[e.R32UI=33334]="R32UI",e[e.RG8I=33335]="RG8I",e[e.RG8UI=33336]="RG8UI",e[e.RG16I=33337]="RG16I",e[e.RG16UI=33338]="RG16UI",e[e.RG32I=33339]="RG32I",e[e.RG32UI=33340]="RG32UI",e[e.R8_SNORM=36756]="R8_SNORM",e[e.RG8_SNORM=36757]="RG8_SNORM",e[e.RGB8_SNORM=36758]="RGB8_SNORM",e[e.RGBA8_SNORM=36759]="RGBA8_SNORM",e[e.RGB10_A2UI=36975]="RGB10_A2UI",e[e.TEXTURE_IMMUTABLE_FORMAT=37167]="TEXTURE_IMMUTABLE_FORMAT",e[e.TEXTURE_IMMUTABLE_LEVELS=33503]="TEXTURE_IMMUTABLE_LEVELS",e[e.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",e[e.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",e[e.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",e[e.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",e[e.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",e[e.HALF_FLOAT=5131]="HALF_FLOAT",e[e.RG=33319]="RG",e[e.RG_INTEGER=33320]="RG_INTEGER",e[e.INT_2_10_10_10_REV=36255]="INT_2_10_10_10_REV",e[e.CURRENT_QUERY=34917]="CURRENT_QUERY",e[e.QUERY_RESULT=34918]="QUERY_RESULT",e[e.QUERY_RESULT_AVAILABLE=34919]="QUERY_RESULT_AVAILABLE",e[e.ANY_SAMPLES_PASSED=35887]="ANY_SAMPLES_PASSED",e[e.ANY_SAMPLES_PASSED_CONSERVATIVE=36202]="ANY_SAMPLES_PASSED_CONSERVATIVE",e[e.MAX_DRAW_BUFFERS=34852]="MAX_DRAW_BUFFERS",e[e.DRAW_BUFFER0=34853]="DRAW_BUFFER0",e[e.DRAW_BUFFER1=34854]="DRAW_BUFFER1",e[e.DRAW_BUFFER2=34855]="DRAW_BUFFER2",e[e.DRAW_BUFFER3=34856]="DRAW_BUFFER3",e[e.DRAW_BUFFER4=34857]="DRAW_BUFFER4",e[e.DRAW_BUFFER5=34858]="DRAW_BUFFER5",e[e.DRAW_BUFFER6=34859]="DRAW_BUFFER6",e[e.DRAW_BUFFER7=34860]="DRAW_BUFFER7",e[e.DRAW_BUFFER8=34861]="DRAW_BUFFER8",e[e.DRAW_BUFFER9=34862]="DRAW_BUFFER9",e[e.DRAW_BUFFER10=34863]="DRAW_BUFFER10",e[e.DRAW_BUFFER11=34864]="DRAW_BUFFER11",e[e.DRAW_BUFFER12=34865]="DRAW_BUFFER12",e[e.DRAW_BUFFER13=34866]="DRAW_BUFFER13",e[e.DRAW_BUFFER14=34867]="DRAW_BUFFER14",e[e.DRAW_BUFFER15=34868]="DRAW_BUFFER15",e[e.MAX_COLOR_ATTACHMENTS=36063]="MAX_COLOR_ATTACHMENTS",e[e.COLOR_ATTACHMENT1=36065]="COLOR_ATTACHMENT1",e[e.COLOR_ATTACHMENT2=36066]="COLOR_ATTACHMENT2",e[e.COLOR_ATTACHMENT3=36067]="COLOR_ATTACHMENT3",e[e.COLOR_ATTACHMENT4=36068]="COLOR_ATTACHMENT4",e[e.COLOR_ATTACHMENT5=36069]="COLOR_ATTACHMENT5",e[e.COLOR_ATTACHMENT6=36070]="COLOR_ATTACHMENT6",e[e.COLOR_ATTACHMENT7=36071]="COLOR_ATTACHMENT7",e[e.COLOR_ATTACHMENT8=36072]="COLOR_ATTACHMENT8",e[e.COLOR_ATTACHMENT9=36073]="COLOR_ATTACHMENT9",e[e.COLOR_ATTACHMENT10=36074]="COLOR_ATTACHMENT10",e[e.COLOR_ATTACHMENT11=36075]="COLOR_ATTACHMENT11",e[e.COLOR_ATTACHMENT12=36076]="COLOR_ATTACHMENT12",e[e.COLOR_ATTACHMENT13=36077]="COLOR_ATTACHMENT13",e[e.COLOR_ATTACHMENT14=36078]="COLOR_ATTACHMENT14",e[e.COLOR_ATTACHMENT15=36079]="COLOR_ATTACHMENT15",e[e.SAMPLER_3D=35679]="SAMPLER_3D",e[e.SAMPLER_2D_SHADOW=35682]="SAMPLER_2D_SHADOW",e[e.SAMPLER_2D_ARRAY=36289]="SAMPLER_2D_ARRAY",e[e.SAMPLER_2D_ARRAY_SHADOW=36292]="SAMPLER_2D_ARRAY_SHADOW",e[e.SAMPLER_CUBE_SHADOW=36293]="SAMPLER_CUBE_SHADOW",e[e.INT_SAMPLER_2D=36298]="INT_SAMPLER_2D",e[e.INT_SAMPLER_3D=36299]="INT_SAMPLER_3D",e[e.INT_SAMPLER_CUBE=36300]="INT_SAMPLER_CUBE",e[e.INT_SAMPLER_2D_ARRAY=36303]="INT_SAMPLER_2D_ARRAY",e[e.UNSIGNED_INT_SAMPLER_2D=36306]="UNSIGNED_INT_SAMPLER_2D",e[e.UNSIGNED_INT_SAMPLER_3D=36307]="UNSIGNED_INT_SAMPLER_3D",e[e.UNSIGNED_INT_SAMPLER_CUBE=36308]="UNSIGNED_INT_SAMPLER_CUBE",e[e.UNSIGNED_INT_SAMPLER_2D_ARRAY=36311]="UNSIGNED_INT_SAMPLER_2D_ARRAY",e[e.MAX_SAMPLES=36183]="MAX_SAMPLES",e[e.SAMPLER_BINDING=35097]="SAMPLER_BINDING",e[e.PIXEL_PACK_BUFFER=35051]="PIXEL_PACK_BUFFER",e[e.PIXEL_UNPACK_BUFFER=35052]="PIXEL_UNPACK_BUFFER",e[e.PIXEL_PACK_BUFFER_BINDING=35053]="PIXEL_PACK_BUFFER_BINDING",e[e.PIXEL_UNPACK_BUFFER_BINDING=35055]="PIXEL_UNPACK_BUFFER_BINDING",e[e.COPY_READ_BUFFER=36662]="COPY_READ_BUFFER",e[e.COPY_WRITE_BUFFER=36663]="COPY_WRITE_BUFFER",e[e.COPY_READ_BUFFER_BINDING=36662]="COPY_READ_BUFFER_BINDING",e[e.COPY_WRITE_BUFFER_BINDING=36663]="COPY_WRITE_BUFFER_BINDING",e[e.FLOAT_MAT2x3=35685]="FLOAT_MAT2x3",e[e.FLOAT_MAT2x4=35686]="FLOAT_MAT2x4",e[e.FLOAT_MAT3x2=35687]="FLOAT_MAT3x2",e[e.FLOAT_MAT3x4=35688]="FLOAT_MAT3x4",e[e.FLOAT_MAT4x2=35689]="FLOAT_MAT4x2",e[e.FLOAT_MAT4x3=35690]="FLOAT_MAT4x3",e[e.UNSIGNED_INT_VEC2=36294]="UNSIGNED_INT_VEC2",e[e.UNSIGNED_INT_VEC3=36295]="UNSIGNED_INT_VEC3",e[e.UNSIGNED_INT_VEC4=36296]="UNSIGNED_INT_VEC4",e[e.UNSIGNED_NORMALIZED=35863]="UNSIGNED_NORMALIZED",e[e.SIGNED_NORMALIZED=36764]="SIGNED_NORMALIZED",e[e.VERTEX_ATTRIB_ARRAY_INTEGER=35069]="VERTEX_ATTRIB_ARRAY_INTEGER",e[e.VERTEX_ATTRIB_ARRAY_DIVISOR=35070]="VERTEX_ATTRIB_ARRAY_DIVISOR",e[e.TRANSFORM_FEEDBACK_BUFFER_MODE=35967]="TRANSFORM_FEEDBACK_BUFFER_MODE",e[e.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS=35968]="MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS",e[e.TRANSFORM_FEEDBACK_VARYINGS=35971]="TRANSFORM_FEEDBACK_VARYINGS",e[e.TRANSFORM_FEEDBACK_BUFFER_START=35972]="TRANSFORM_FEEDBACK_BUFFER_START",e[e.TRANSFORM_FEEDBACK_BUFFER_SIZE=35973]="TRANSFORM_FEEDBACK_BUFFER_SIZE",e[e.TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN=35976]="TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN",e[e.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS=35978]="MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS",e[e.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS=35979]="MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS",e[e.INTERLEAVED_ATTRIBS=35980]="INTERLEAVED_ATTRIBS",e[e.SEPARATE_ATTRIBS=35981]="SEPARATE_ATTRIBS",e[e.TRANSFORM_FEEDBACK_BUFFER=35982]="TRANSFORM_FEEDBACK_BUFFER",e[e.TRANSFORM_FEEDBACK_BUFFER_BINDING=35983]="TRANSFORM_FEEDBACK_BUFFER_BINDING",e[e.TRANSFORM_FEEDBACK=36386]="TRANSFORM_FEEDBACK",e[e.TRANSFORM_FEEDBACK_PAUSED=36387]="TRANSFORM_FEEDBACK_PAUSED",e[e.TRANSFORM_FEEDBACK_ACTIVE=36388]="TRANSFORM_FEEDBACK_ACTIVE",e[e.TRANSFORM_FEEDBACK_BINDING=36389]="TRANSFORM_FEEDBACK_BINDING",e[e.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING=33296]="FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING",e[e.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE=33297]="FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE",e[e.FRAMEBUFFER_ATTACHMENT_RED_SIZE=33298]="FRAMEBUFFER_ATTACHMENT_RED_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_GREEN_SIZE=33299]="FRAMEBUFFER_ATTACHMENT_GREEN_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_BLUE_SIZE=33300]="FRAMEBUFFER_ATTACHMENT_BLUE_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE=33301]="FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE=33302]="FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE=33303]="FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE",e[e.FRAMEBUFFER_DEFAULT=33304]="FRAMEBUFFER_DEFAULT",e[e.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",e[e.DRAW_FRAMEBUFFER_BINDING=36006]="DRAW_FRAMEBUFFER_BINDING",e[e.READ_FRAMEBUFFER_BINDING=36010]="READ_FRAMEBUFFER_BINDING",e[e.RENDERBUFFER_SAMPLES=36011]="RENDERBUFFER_SAMPLES",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER=36052]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER",e[e.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE=36182]="FRAMEBUFFER_INCOMPLETE_MULTISAMPLE",e[e.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",e[e.UNIFORM_BUFFER_BINDING=35368]="UNIFORM_BUFFER_BINDING",e[e.UNIFORM_BUFFER_START=35369]="UNIFORM_BUFFER_START",e[e.UNIFORM_BUFFER_SIZE=35370]="UNIFORM_BUFFER_SIZE",e[e.MAX_VERTEX_UNIFORM_BLOCKS=35371]="MAX_VERTEX_UNIFORM_BLOCKS",e[e.MAX_FRAGMENT_UNIFORM_BLOCKS=35373]="MAX_FRAGMENT_UNIFORM_BLOCKS",e[e.MAX_COMBINED_UNIFORM_BLOCKS=35374]="MAX_COMBINED_UNIFORM_BLOCKS",e[e.MAX_UNIFORM_BUFFER_BINDINGS=35375]="MAX_UNIFORM_BUFFER_BINDINGS",e[e.MAX_UNIFORM_BLOCK_SIZE=35376]="MAX_UNIFORM_BLOCK_SIZE",e[e.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS=35377]="MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS",e[e.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS=35379]="MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS",e[e.UNIFORM_BUFFER_OFFSET_ALIGNMENT=35380]="UNIFORM_BUFFER_OFFSET_ALIGNMENT",e[e.ACTIVE_UNIFORM_BLOCKS=35382]="ACTIVE_UNIFORM_BLOCKS",e[e.UNIFORM_TYPE=35383]="UNIFORM_TYPE",e[e.UNIFORM_SIZE=35384]="UNIFORM_SIZE",e[e.UNIFORM_BLOCK_INDEX=35386]="UNIFORM_BLOCK_INDEX",e[e.UNIFORM_OFFSET=35387]="UNIFORM_OFFSET",e[e.UNIFORM_ARRAY_STRIDE=35388]="UNIFORM_ARRAY_STRIDE",e[e.UNIFORM_MATRIX_STRIDE=35389]="UNIFORM_MATRIX_STRIDE",e[e.UNIFORM_IS_ROW_MAJOR=35390]="UNIFORM_IS_ROW_MAJOR",e[e.UNIFORM_BLOCK_BINDING=35391]="UNIFORM_BLOCK_BINDING",e[e.UNIFORM_BLOCK_DATA_SIZE=35392]="UNIFORM_BLOCK_DATA_SIZE",e[e.UNIFORM_BLOCK_ACTIVE_UNIFORMS=35394]="UNIFORM_BLOCK_ACTIVE_UNIFORMS",e[e.UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES=35395]="UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES",e[e.UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER=35396]="UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER",e[e.UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER=35398]="UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER",e[e.OBJECT_TYPE=37138]="OBJECT_TYPE",e[e.SYNC_CONDITION=37139]="SYNC_CONDITION",e[e.SYNC_STATUS=37140]="SYNC_STATUS",e[e.SYNC_FLAGS=37141]="SYNC_FLAGS",e[e.SYNC_FENCE=37142]="SYNC_FENCE",e[e.SYNC_GPU_COMMANDS_COMPLETE=37143]="SYNC_GPU_COMMANDS_COMPLETE",e[e.UNSIGNALED=37144]="UNSIGNALED",e[e.SIGNALED=37145]="SIGNALED",e[e.ALREADY_SIGNALED=37146]="ALREADY_SIGNALED",e[e.TIMEOUT_EXPIRED=37147]="TIMEOUT_EXPIRED",e[e.CONDITION_SATISFIED=37148]="CONDITION_SATISFIED",e[e.WAIT_FAILED=37149]="WAIT_FAILED",e[e.SYNC_FLUSH_COMMANDS_BIT=1]="SYNC_FLUSH_COMMANDS_BIT",e[e.COLOR=6144]="COLOR",e[e.DEPTH=6145]="DEPTH",e[e.STENCIL=6146]="STENCIL",e[e.MIN=32775]="MIN",e[e.MAX=32776]="MAX",e[e.DEPTH_COMPONENT24=33190]="DEPTH_COMPONENT24",e[e.STREAM_READ=35041]="STREAM_READ",e[e.STREAM_COPY=35042]="STREAM_COPY",e[e.STATIC_READ=35045]="STATIC_READ",e[e.STATIC_COPY=35046]="STATIC_COPY",e[e.DYNAMIC_READ=35049]="DYNAMIC_READ",e[e.DYNAMIC_COPY=35050]="DYNAMIC_COPY",e[e.DEPTH_COMPONENT32F=36012]="DEPTH_COMPONENT32F",e[e.DEPTH32F_STENCIL8=36013]="DEPTH32F_STENCIL8",e[e.INVALID_INDEX=4294967295]="INVALID_INDEX",e[e.TIMEOUT_IGNORED=-1]="TIMEOUT_IGNORED",e[e.MAX_CLIENT_WAIT_TIMEOUT_WEBGL=37447]="MAX_CLIENT_WAIT_TIMEOUT_WEBGL",e[e.UNMASKED_VENDOR_WEBGL=37445]="UNMASKED_VENDOR_WEBGL",e[e.UNMASKED_RENDERER_WEBGL=37446]="UNMASKED_RENDERER_WEBGL",e[e.MAX_TEXTURE_MAX_ANISOTROPY_EXT=34047]="MAX_TEXTURE_MAX_ANISOTROPY_EXT",e[e.TEXTURE_MAX_ANISOTROPY_EXT=34046]="TEXTURE_MAX_ANISOTROPY_EXT",e[e.R16_EXT=33322]="R16_EXT",e[e.RG16_EXT=33324]="RG16_EXT",e[e.RGB16_EXT=32852]="RGB16_EXT",e[e.RGBA16_EXT=32859]="RGBA16_EXT",e[e.R16_SNORM_EXT=36760]="R16_SNORM_EXT",e[e.RG16_SNORM_EXT=36761]="RG16_SNORM_EXT",e[e.RGB16_SNORM_EXT=36762]="RGB16_SNORM_EXT",e[e.RGBA16_SNORM_EXT=36763]="RGBA16_SNORM_EXT",e[e.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",e[e.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",e[e.COMPRESSED_RED_RGTC1_EXT=36283]="COMPRESSED_RED_RGTC1_EXT",e[e.COMPRESSED_SIGNED_RED_RGTC1_EXT=36284]="COMPRESSED_SIGNED_RED_RGTC1_EXT",e[e.COMPRESSED_RED_GREEN_RGTC2_EXT=36285]="COMPRESSED_RED_GREEN_RGTC2_EXT",e[e.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT=36286]="COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT",e[e.COMPRESSED_RGBA_BPTC_UNORM_EXT=36492]="COMPRESSED_RGBA_BPTC_UNORM_EXT",e[e.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=36493]="COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT",e[e.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT=36494]="COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT",e[e.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT=36495]="COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT",e[e.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",e[e.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",e[e.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",e[e.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",e[e.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",e[e.COMPRESSED_RGBA8_ETC2_EAC=37493]="COMPRESSED_RGBA8_ETC2_EAC",e[e.COMPRESSED_SRGB8_ETC2=37494]="COMPRESSED_SRGB8_ETC2",e[e.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37495]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",e[e.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37496]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37497]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",e[e.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",e[e.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",e[e.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",e[e.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",e[e.COMPRESSED_RGBA_ASTC_5x4_KHR=37809]="COMPRESSED_RGBA_ASTC_5x4_KHR",e[e.COMPRESSED_RGBA_ASTC_5x5_KHR=37810]="COMPRESSED_RGBA_ASTC_5x5_KHR",e[e.COMPRESSED_RGBA_ASTC_6x5_KHR=37811]="COMPRESSED_RGBA_ASTC_6x5_KHR",e[e.COMPRESSED_RGBA_ASTC_6x6_KHR=37812]="COMPRESSED_RGBA_ASTC_6x6_KHR",e[e.COMPRESSED_RGBA_ASTC_8x5_KHR=37813]="COMPRESSED_RGBA_ASTC_8x5_KHR",e[e.COMPRESSED_RGBA_ASTC_8x6_KHR=37814]="COMPRESSED_RGBA_ASTC_8x6_KHR",e[e.COMPRESSED_RGBA_ASTC_8x8_KHR=37815]="COMPRESSED_RGBA_ASTC_8x8_KHR",e[e.COMPRESSED_RGBA_ASTC_10x5_KHR=37816]="COMPRESSED_RGBA_ASTC_10x5_KHR",e[e.COMPRESSED_RGBA_ASTC_10x6_KHR=37817]="COMPRESSED_RGBA_ASTC_10x6_KHR",e[e.COMPRESSED_RGBA_ASTC_10x8_KHR=37818]="COMPRESSED_RGBA_ASTC_10x8_KHR",e[e.COMPRESSED_RGBA_ASTC_10x10_KHR=37819]="COMPRESSED_RGBA_ASTC_10x10_KHR",e[e.COMPRESSED_RGBA_ASTC_12x10_KHR=37820]="COMPRESSED_RGBA_ASTC_12x10_KHR",e[e.COMPRESSED_RGBA_ASTC_12x12_KHR=37821]="COMPRESSED_RGBA_ASTC_12x12_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR=37840]="COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR=37841]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR=37842]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR=37843]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR=37844]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR=37845]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR=37846]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR=37847]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR=37848]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR=37849]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR=37850]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR=37851]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR=37852]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR=37853]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR",e[e.QUERY_COUNTER_BITS_EXT=34916]="QUERY_COUNTER_BITS_EXT",e[e.CURRENT_QUERY_EXT=34917]="CURRENT_QUERY_EXT",e[e.QUERY_RESULT_EXT=34918]="QUERY_RESULT_EXT",e[e.QUERY_RESULT_AVAILABLE_EXT=34919]="QUERY_RESULT_AVAILABLE_EXT",e[e.TIME_ELAPSED_EXT=35007]="TIME_ELAPSED_EXT",e[e.TIMESTAMP_EXT=36392]="TIMESTAMP_EXT",e[e.GPU_DISJOINT_EXT=36795]="GPU_DISJOINT_EXT",e[e.COMPLETION_STATUS_KHR=37297]="COMPLETION_STATUS_KHR",e[e.DEPTH_CLAMP_EXT=34383]="DEPTH_CLAMP_EXT",e[e.FIRST_VERTEX_CONVENTION_WEBGL=36429]="FIRST_VERTEX_CONVENTION_WEBGL",e[e.LAST_VERTEX_CONVENTION_WEBGL=36430]="LAST_VERTEX_CONVENTION_WEBGL",e[e.PROVOKING_VERTEX_WEBL=36431]="PROVOKING_VERTEX_WEBL",e[e.POLYGON_MODE_WEBGL=2880]="POLYGON_MODE_WEBGL",e[e.POLYGON_OFFSET_LINE_WEBGL=10754]="POLYGON_OFFSET_LINE_WEBGL",e[e.LINE_WEBGL=6913]="LINE_WEBGL",e[e.FILL_WEBGL=6914]="FILL_WEBGL",e[e.MAX_CLIP_DISTANCES_WEBGL=3378]="MAX_CLIP_DISTANCES_WEBGL",e[e.MAX_CULL_DISTANCES_WEBGL=33529]="MAX_CULL_DISTANCES_WEBGL",e[e.MAX_COMBINED_CLIP_AND_CULL_DISTANCES_WEBGL=33530]="MAX_COMBINED_CLIP_AND_CULL_DISTANCES_WEBGL",e[e.CLIP_DISTANCE0_WEBGL=12288]="CLIP_DISTANCE0_WEBGL",e[e.CLIP_DISTANCE1_WEBGL=12289]="CLIP_DISTANCE1_WEBGL",e[e.CLIP_DISTANCE2_WEBGL=12290]="CLIP_DISTANCE2_WEBGL",e[e.CLIP_DISTANCE3_WEBGL=12291]="CLIP_DISTANCE3_WEBGL",e[e.CLIP_DISTANCE4_WEBGL=12292]="CLIP_DISTANCE4_WEBGL",e[e.CLIP_DISTANCE5_WEBGL=12293]="CLIP_DISTANCE5_WEBGL",e[e.CLIP_DISTANCE6_WEBGL=12294]="CLIP_DISTANCE6_WEBGL",e[e.CLIP_DISTANCE7_WEBGL=12295]="CLIP_DISTANCE7_WEBGL",e[e.POLYGON_OFFSET_CLAMP_EXT=36379]="POLYGON_OFFSET_CLAMP_EXT",e[e.LOWER_LEFT_EXT=36001]="LOWER_LEFT_EXT",e[e.UPPER_LEFT_EXT=36002]="UPPER_LEFT_EXT",e[e.NEGATIVE_ONE_TO_ONE_EXT=37726]="NEGATIVE_ONE_TO_ONE_EXT",e[e.ZERO_TO_ONE_EXT=37727]="ZERO_TO_ONE_EXT",e[e.CLIP_ORIGIN_EXT=37724]="CLIP_ORIGIN_EXT",e[e.CLIP_DEPTH_MODE_EXT=37725]="CLIP_DEPTH_MODE_EXT",e[e.SRC1_COLOR_WEBGL=35065]="SRC1_COLOR_WEBGL",e[e.SRC1_ALPHA_WEBGL=34185]="SRC1_ALPHA_WEBGL",e[e.ONE_MINUS_SRC1_COLOR_WEBGL=35066]="ONE_MINUS_SRC1_COLOR_WEBGL",e[e.ONE_MINUS_SRC1_ALPHA_WEBGL=35067]="ONE_MINUS_SRC1_ALPHA_WEBGL",e[e.MAX_DUAL_SOURCE_DRAW_BUFFERS_WEBGL=35068]="MAX_DUAL_SOURCE_DRAW_BUFFERS_WEBGL",e[e.MIRROR_CLAMP_TO_EDGE_EXT=34627]="MIRROR_CLAMP_TO_EDGE_EXT"})(vA||(vA={}));var Bv={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,35725:null,36006:null,36007:null,34229:null,34964:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32926:!1,32928:!1,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],36389:null,36662:null,36663:null,35053:null,35055:null,35723:4352,36010:null,35977:!1,3333:4,3317:4,37440:!1,37441:!1,37443:37444,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},Oo=(e,t,r)=>t?e.enable(r):e.disable(r),zj=(e,t,r)=>e.hint(r,t),Xc=(e,t,r)=>e.pixelStorei(r,t),Uj=(e,t,r)=>{let i=r===36006?36009:36008;return e.bindFramebuffer(i,t)},Dv=(e,t,r)=>{let s={34964:34962,36662:36662,36663:36663,35053:35051,35055:35052}[r];e.bindBuffer(s,t)};function Jk(e){return Array.isArray(e)||ArrayBuffer.isView(e)&&!(e instanceof DataView)}var Vj={3042:Oo,32773:(e,t)=>e.blendColor(...t),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(e,t)=>e.clearColor(...t),3107:(e,t)=>e.colorMask(...t),2884:Oo,2885:(e,t)=>e.cullFace(t),2929:Oo,2931:(e,t)=>e.clearDepth(t),2932:(e,t)=>e.depthFunc(t),2928:(e,t)=>e.depthRange(...t),2930:(e,t)=>e.depthMask(t),3024:Oo,35723:zj,35725:(e,t)=>e.useProgram(t),36007:(e,t)=>e.bindRenderbuffer(36161,t),36389:(e,t)=>e.bindTransformFeedback?.(36386,t),34229:(e,t)=>e.bindVertexArray(t),36006:Uj,36010:Uj,34964:Dv,36662:Dv,36663:Dv,35053:Dv,35055:Dv,2886:(e,t)=>e.frontFace(t),33170:zj,2849:(e,t)=>e.lineWidth(t),32823:Oo,32824:"polygonOffset",10752:"polygonOffset",35977:Oo,32926:Oo,32928:Oo,32938:"sampleCoverage",32939:"sampleCoverage",3089:Oo,3088:(e,t)=>e.scissor(...t),2960:Oo,2961:(e,t)=>e.clearStencil(t),2968:(e,t)=>e.stencilMaskSeparate(1028,t),36005:(e,t)=>e.stencilMaskSeparate(1029,t),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(e,t)=>e.viewport(...t),34383:Oo,10754:Oo,12288:Oo,12289:Oo,12290:Oo,12291:Oo,12292:Oo,12293:Oo,12294:Oo,12295:Oo,3333:Xc,3317:Xc,37440:Xc,37441:Xc,37443:Xc,3330:Xc,3332:Xc,3331:Xc,3314:Xc,32878:Xc,3316:Xc,3315:Xc,32877:Xc,framebuffer:(e,t)=>{let r=t&&"handle"in t?t.handle:t;return e.bindFramebuffer(36160,r)},blend:(e,t)=>t?e.enable(3042):e.disable(3042),blendColor:(e,t)=>e.blendColor(...t),blendEquation:(e,t)=>{let r=typeof t=="number"?[t,t]:t;e.blendEquationSeparate(...r)},blendFunc:(e,t)=>{let r=t?.length===2?[...t,...t]:t;e.blendFuncSeparate(...r)},clearColor:(e,t)=>e.clearColor(...t),clearDepth:(e,t)=>e.clearDepth(t),clearStencil:(e,t)=>e.clearStencil(t),colorMask:(e,t)=>e.colorMask(...t),cull:(e,t)=>t?e.enable(2884):e.disable(2884),cullFace:(e,t)=>e.cullFace(t),depthTest:(e,t)=>t?e.enable(2929):e.disable(2929),depthFunc:(e,t)=>e.depthFunc(t),depthMask:(e,t)=>e.depthMask(t),depthRange:(e,t)=>e.depthRange(...t),dither:(e,t)=>t?e.enable(3024):e.disable(3024),derivativeHint:(e,t)=>{e.hint(35723,t)},frontFace:(e,t)=>e.frontFace(t),mipmapHint:(e,t)=>e.hint(33170,t),lineWidth:(e,t)=>e.lineWidth(t),polygonOffsetFill:(e,t)=>t?e.enable(32823):e.disable(32823),polygonOffset:(e,t)=>e.polygonOffset(...t),sampleCoverage:(e,t)=>e.sampleCoverage(...t),scissorTest:(e,t)=>t?e.enable(3089):e.disable(3089),scissor:(e,t)=>e.scissor(...t),stencilTest:(e,t)=>t?e.enable(2960):e.disable(2960),stencilMask:(e,t)=>{t=Jk(t)?t:[t,t];let[r,i]=t;e.stencilMaskSeparate(1028,r),e.stencilMaskSeparate(1029,i)},stencilFunc:(e,t)=>{t=Jk(t)&&t.length===3?[...t,...t]:t;let[r,i,s,n,o,c]=t;e.stencilFuncSeparate(1028,r,i,s),e.stencilFuncSeparate(1029,n,o,c)},stencilOp:(e,t)=>{t=Jk(t)&&t.length===3?[...t,...t]:t;let[r,i,s,n,o,c]=t;e.stencilOpSeparate(1028,r,i,s),e.stencilOpSeparate(1029,n,o,c)},viewport:(e,t)=>e.viewport(...t)};function ao(e,t,r){return t[e]!==void 0?t[e]:r[e]}var jj={blendEquation:(e,t,r)=>e.blendEquationSeparate(ao(32777,t,r),ao(34877,t,r)),blendFunc:(e,t,r)=>e.blendFuncSeparate(ao(32969,t,r),ao(32968,t,r),ao(32971,t,r),ao(32970,t,r)),polygonOffset:(e,t,r)=>e.polygonOffset(ao(32824,t,r),ao(10752,t,r)),sampleCoverage:(e,t,r)=>e.sampleCoverage(ao(32938,t,r),ao(32939,t,r)),stencilFuncFront:(e,t,r)=>e.stencilFuncSeparate(1028,ao(2962,t,r),ao(2967,t,r),ao(2963,t,r)),stencilFuncBack:(e,t,r)=>e.stencilFuncSeparate(1029,ao(34816,t,r),ao(36003,t,r),ao(36004,t,r)),stencilOpFront:(e,t,r)=>e.stencilOpSeparate(1028,ao(2964,t,r),ao(2965,t,r),ao(2966,t,r)),stencilOpBack:(e,t,r)=>e.stencilOpSeparate(1029,ao(34817,t,r),ao(34818,t,r),ao(34819,t,r))},t7={enable:(e,t)=>e({[t]:!0}),disable:(e,t)=>e({[t]:!1}),pixelStorei:(e,t,r)=>e({[t]:r}),hint:(e,t,r)=>e({[t]:r}),useProgram:(e,t)=>e({35725:t}),bindRenderbuffer:(e,t,r)=>e({36007:r}),bindTransformFeedback:(e,t,r)=>e({36389:r}),bindVertexArray:(e,t)=>e({34229:t}),bindFramebuffer:(e,t,r)=>{switch(t){case 36160:return e({36006:r,36010:r});case 36009:return e({36006:r});case 36008:return e({36010:r});default:return null}},bindBuffer:(e,t,r)=>{let i={34962:[34964],36662:[36662],36663:[36663],35051:[35053],35052:[35055]}[t];return i?e({[i]:r}):{valueChanged:!0}},blendColor:(e,t,r,i,s)=>e({32773:new Float32Array([t,r,i,s])}),blendEquation:(e,t)=>e({32777:t,34877:t}),blendEquationSeparate:(e,t,r)=>e({32777:t,34877:r}),blendFunc:(e,t,r)=>e({32969:t,32968:r,32971:t,32970:r}),blendFuncSeparate:(e,t,r,i,s)=>e({32969:t,32968:r,32971:i,32970:s}),clearColor:(e,t,r,i,s)=>e({3106:new Float32Array([t,r,i,s])}),clearDepth:(e,t)=>e({2931:t}),clearStencil:(e,t)=>e({2961:t}),colorMask:(e,t,r,i,s)=>e({3107:[t,r,i,s]}),cullFace:(e,t)=>e({2885:t}),depthFunc:(e,t)=>e({2932:t}),depthRange:(e,t,r)=>e({2928:new Float32Array([t,r])}),depthMask:(e,t)=>e({2930:t}),frontFace:(e,t)=>e({2886:t}),lineWidth:(e,t)=>e({2849:t}),polygonOffset:(e,t,r)=>e({32824:t,10752:r}),sampleCoverage:(e,t,r)=>e({32938:t,32939:r}),scissor:(e,t,r,i,s)=>e({3088:new Int32Array([t,r,i,s])}),stencilMask:(e,t)=>e({2968:t,36005:t}),stencilMaskSeparate:(e,t,r)=>e({[t===1028?2968:36005]:r}),stencilFunc:(e,t,r,i)=>e({2962:t,2967:r,2963:i,34816:t,36003:r,36004:i}),stencilFuncSeparate:(e,t,r,i,s)=>e({[t===1028?2962:34816]:r,[t===1028?2967:36003]:i,[t===1028?2963:36004]:s}),stencilOp:(e,t,r,i)=>e({2964:t,2965:r,2966:i,34817:t,34818:r,34819:i}),stencilOpSeparate:(e,t,r,i,s)=>e({[t===1028?2964:34817]:r,[t===1028?2965:34818]:i,[t===1028?2966:34819]:s}),viewport:(e,t,r,i,s)=>e({2978:[t,r,i,s]})},Zf=(e,t)=>e.isEnabled(t),e7={3042:Zf,2884:Zf,2929:Zf,3024:Zf,32823:Zf,32926:Zf,32928:Zf,3089:Zf,2960:Zf,35977:Zf},$j=new Set([34016,36388,36387,35983,35368,34965,35739,35738,3074,34853,34854,34855,34856,34857,34858,34859,34860,34861,34862,34863,34864,34865,34866,34867,34868,35097,32873,35869,32874,34068]);function zh(e,t){if(mAt(t))return;let r={};for(let s in t){let n=Number(s),o=Vj[s];o&&(typeof o=="string"?r[o]=!0:o(e,t[s],n))}let i=e.state&&e.state.cache;if(i)for(let s in r){let n=jj[s];n(e,t,i)}}function aS(e,t=Bv){if(typeof t=="number"){let s=t,n=e7[s];return n?n(e,s):e.getParameter(s)}let r=Array.isArray(t)?t:Object.keys(t),i={};for(let s of r){let n=e7[s];i[s]=n?n(e,Number(s)):e.getParameter(Number(s))}return i}function Hj(e){zh(e,Bv)}function mAt(e){for(let t in e)return!1;return!0}function Wj(e,t){if(e===t)return!0;let r=Array.isArray(e)||ArrayBuffer.isView(e),i=Array.isArray(t)||ArrayBuffer.isView(t);if(r&&i&&e.length===t.length){for(let s=0;s<e.length;++s)if(e[s]!==t[s])return!1;return!0}return!1}var r7=class{gl;program=null;stateStack=[];enable=!0;cache;log;constructor(t,{copyState:r=!1,log:i=()=>{}}={}){this.gl=t,this.cache=r?aS(t):Object.assign({},Bv),this.log=i,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(t={}){this.stateStack.push({})}pop(){Zi(this.stateStack.length>0);let t=this.stateStack[this.stateStack.length-1];zh(this.gl,t),this.stateStack.pop()}_updateCache(t){let r=!1,i,s=this.stateStack.length>0?this.stateStack[this.stateStack.length-1]:null;for(let n in t){Zi(n!==void 0);let o=t[n],c=this.cache[n];Wj(o,c)||(r=!0,i=c,s&&!(n in s)&&(s[n]=c),this.cache[n]=o)}return{valueChanged:r,oldValue:i}}};function Ng(e){return e.state}function i7(e,t){let{enable:r=!0,copyState:i}=t;if(Zi(i!==void 0),!e.state){e.state=new r7(e,{copyState:i}),_At(e);for(let n in t7){let o=t7[n];gAt(e,n,o)}qj(e,"getParameter"),qj(e,"isEnabled")}let s=Ng(e);return s.enable=r,e}function wA(e){let t=Ng(e);t||(i7(e,{copyState:!1}),t=Ng(e)),t.push()}function Md(e){let t=Ng(e);Zi(t),t.pop()}function qj(e,t){let r=e[t].bind(e);e[t]=function(s){if(s===void 0||$j.has(s))return r(s);let n=Ng(e);return s in n.cache||(n.cache[s]=r(s)),n.enable?n.cache[s]:r(s)},Object.defineProperty(e[t],"name",{value:`${t}-from-cache`,configurable:!1})}function gAt(e,t,r){if(!e[t])return;let i=e[t].bind(e);e[t]=function(...n){let o=Ng(e),{valueChanged:c,oldValue:f}=r(o._updateCache,...n);return c&&i(...n),f},Object.defineProperty(e[t],"name",{value:`${t}-to-cache`,configurable:!1})}function _At(e){let t=e.useProgram.bind(e);e.useProgram=function(i){let s=Ng(e);s.program!==i&&(t(i),s.program=i)}}var yAt={powerPreference:"high-performance",onContextLost:()=>console.error("WebGL context lost"),onContextRestored:()=>console.info("WebGL context restored")};function Yj(e,t){t={...yAt,...t};let r=null,i=n=>r=n.statusMessage||r;e.addEventListener("webglcontextcreationerror",i,!1);let s=null;if(s||=e.getContext("webgl2",t),e.removeEventListener("webglcontextcreationerror",i,!1),!s)throw new Error(`Failed to create WebGL context: ${r||"Unknown error"}`);if(t.onContextLost){let{onContextLost:n}=t;e.addEventListener("webglcontextlost",o=>n(o),!1)}if(t.onContextRestored){let{onContextRestored:n}=t;e.addEventListener("webglcontextrestored",o=>n(o),!1)}return s}function Fu(e,t,r){return r[t]===void 0&&(r[t]=e.getExtension(t)||null),r[t]}function Xj(e,t){let r=e.getParameter(7936),i=e.getParameter(7937);Fu(e,"WEBGL_debug_renderer_info",t);let s=t.WEBGL_debug_renderer_info,n=e.getParameter(s?s.UNMASKED_VENDOR_WEBGL:7936),o=e.getParameter(s?s.UNMASKED_RENDERER_WEBGL:7937),c=n||r,f=o||i,p=e.getParameter(7938),x=Zj(c,f),E=xAt(c,f),T=bAt(c,f);return{type:"webgl",gpu:x,gpuType:T,gpuBackend:E,vendor:c,renderer:f,version:p,shadingLanguage:"glsl",shadingLanguageVersion:300}}function Zj(e,t){return/NVIDIA/i.exec(e)||/NVIDIA/i.exec(t)?"nvidia":/INTEL/i.exec(e)||/INTEL/i.exec(t)?"intel":/Apple/i.exec(e)||/Apple/i.exec(t)?"apple":/AMD/i.exec(e)||/AMD/i.exec(t)||/ATI/i.exec(e)||/ATI/i.exec(t)?"amd":/SwiftShader/i.exec(e)||/SwiftShader/i.exec(t)?"software":"unknown"}function xAt(e,t){return/Metal/i.exec(e)||/Metal/i.exec(t)?"metal":/ANGLE/i.exec(e)||/ANGLE/i.exec(t)?"opengl":"unknown"}function bAt(e,t){if(/SwiftShader/i.exec(e)||/SwiftShader/i.exec(t))return"cpu";switch(Zj(e,t)){case"intel":return"integrated";case"software":return"cpu";case"unknown":return"unknown";default:return"discrete"}}function lS(e){switch(e){case"uint8":return 5121;case"sint8":return 5120;case"unorm8":return 5121;case"snorm8":return 5120;case"uint16":return 5123;case"sint16":return 5122;case"unorm16":return 5123;case"snorm16":return 5122;case"uint32":return 5125;case"sint32":return 5124;case"float16":return 5131;case"float32":return 5126}throw new Error(String(e))}var cl="texture-compression-bc",ss="texture-compression-astc",Gf="texture-compression-etc2",vAt="texture-compression-etc1-webgl",cS="texture-compression-pvrtc-webgl",n7="texture-compression-atc-webgl",Ov="float32-renderable-webgl",s7="float16-renderable-webgl",wAt="rgb9e5ufloat_renderable-webgl",o7="snorm8-renderable-webgl",Nv="norm16-renderable-webgl",a7="snorm16-renderable-webgl",uS="float32-filterable",Gj="float16-filterable-webgl",Fv="WEBGL_compressed_texture_s3tc",Lv="WEBGL_compressed_texture_s3tc_srgb",ky="EXT_texture_compression_rgtc",Dy="EXT_texture_compression_bptc",TAt="WEBGL_compressed_texture_etc",SAt="WEBGL_compressed_texture_astc",EAt="WEBGL_compressed_texture_etc1",IAt="WEBGL_compressed_texture_pvrtc",MAt="WEBGL_compressed_texture_atc",Qj="EXT_texture_norm16",Kj="EXT_render_snorm",CAt="EXT_color_buffer_float",hS={"float32-renderable-webgl":["EXT_color_buffer_float"],"float16-renderable-webgl":["EXT_color_buffer_half_float"],"rgb9e5ufloat_renderable-webgl":["WEBGL_render_shared_exponent"],"snorm8-renderable-webgl":[Kj],"norm16-renderable-webgl":[Qj],"snorm16-renderable-webgl":[Qj,Kj],"float32-filterable":["OES_texture_float_linear"],"float16-filterable-webgl":["OES_texture_half_float_linear"],"texture-filterable-anisotropic-webgl":["EXT_texture_filter_anisotropic"],"texture-blend-float-webgl":["EXT_float_blend"],"texture-compression-bc":[Fv,Lv,ky,Dy],"texture-compression-bc5-webgl":[ky],"texture-compression-bc7-webgl":[Dy],"texture-compression-etc2":[TAt],"texture-compression-astc":[SAt],"texture-compression-etc1-webgl":[EAt],"texture-compression-pvrtc-webgl":[IAt],"texture-compression-atc-webgl":[MAt]};function Jj(e){return e in hS}function t$(e,t,r){return(hS[t]||[]).every(s=>Fu(e,s,r))}var fS={"rgb8unorm-unsized":{gl:6407,b:4,c:2,bpp:4,dataFormat:6407,types:[5121,33635]},"rgba8unorm-unsized":{gl:6408,b:4,c:2,bpp:4,dataFormat:6408,types:[5121,32819,32820]},r8unorm:{gl:33321,b:1,c:1,rb:!0},r8snorm:{gl:36756,b:1,c:1,render:o7},r8uint:{gl:33330,b:1,c:1,rb:!0},r8sint:{gl:33329,b:1,c:1,rb:!0},rg8unorm:{gl:33323,b:2,c:2,rb:!0},rg8snorm:{gl:36757,b:2,c:2,render:o7},rg8uint:{gl:33336,b:2,c:2,rb:!0},rg8sint:{gl:33335,b:2,c:2,rb:!0},r16uint:{gl:33332,b:2,c:1,rb:!0},r16sint:{gl:33331,b:2,c:1,rb:!0},r16float:{gl:33325,b:2,c:1,render:s7,filter:"float16-filterable-webgl",rb:!0},"r16unorm-webgl":{gl:33322,b:2,c:1,f:Nv,rb:!0},"r16snorm-webgl":{gl:36760,b:2,c:1,f:a7},"rgba4unorm-webgl":{gl:32854,b:2,c:4,wgpu:!1,rb:!0},"rgb565unorm-webgl":{gl:36194,b:2,c:4,wgpu:!1,rb:!0},"rgb5a1unorm-webgl":{gl:32855,b:2,c:4,wgpu:!1,rb:!0},"rgb8unorm-webgl":{gl:32849,b:3,c:3,wgpu:!1},"rgb8snorm-webgl":{gl:36758,b:3,c:3,wgpu:!1},rgba8unorm:{gl:32856,b:4,c:2,bpp:4},"rgba8unorm-srgb":{gl:35907,b:4,c:4,bpp:4},rgba8snorm:{gl:36759,b:4,c:4,render:o7},rgba8uint:{gl:36220,b:4,c:4,bpp:4},rgba8sint:{gl:36238,b:4,c:4,bpp:4},bgra8unorm:{b:4,c:4},"bgra8unorm-srgb":{b:4,c:4},rg16uint:{gl:33338,b:4,c:1,bpp:4},rg16sint:{gl:33337,b:4,c:2,bpp:4},rg16float:{gl:33327,bpp:4,b:4,c:2,render:s7,filter:Gj,rb:!0},"rg16unorm-webgl":{gl:33324,b:2,c:2,render:Nv},"rg16snorm-webgl":{gl:36761,b:2,c:2,render:a7},r32uint:{gl:33334,b:4,c:1,bpp:4,rb:!0},r32sint:{gl:33333,b:4,c:1,bpp:4,rb:!0},r32float:{gl:33326,bpp:4,b:4,c:1,render:Ov,filter:uS},rgb9e5ufloat:{gl:35901,b:4,c:3,p:1,render:wAt},rg11b10ufloat:{gl:35898,b:4,c:3,p:1,render:Ov,rb:!0},rgb10a2unorm:{gl:32857,b:4,c:4,p:1,rb:!0},"rgb10a2uint-webgl":{b:4,c:4,gl:36975,p:1,wgpu:!1,bpp:4,rb:!0},"rgb16unorm-webgl":{gl:32852,b:2,c:3,f:Nv},"rgb16snorm-webgl":{gl:36762,b:2,c:3,f:Nv},rg32uint:{gl:33340,b:8,c:2,rb:!0},rg32sint:{gl:33339,b:8,c:2,rb:!0},rg32float:{gl:33328,b:8,c:2,render:Ov,filter:uS,rb:!0},rgba16uint:{gl:36214,b:8,c:4,rb:!0},rgba16sint:{gl:36232,b:8,c:4,rb:!0},rgba16float:{gl:34842,b:8,c:4,render:s7,filter:Gj},"rgba16unorm-webgl":{gl:32859,b:2,c:4,render:Nv,rb:!0},"rgba16snorm-webgl":{gl:36763,b:2,c:4,render:a7},"rgb32float-webgl":{gl:34837,render:Ov,filter:uS,gl2ext:CAt,dataFormat:6407,types:[5126]},rgba32uint:{gl:36208,b:16,c:4,rb:!0},rgba32sint:{gl:36226,b:16,c:4,rb:!0},rgba32float:{gl:34836,b:16,c:4,render:Ov,filter:uS,rb:!0},stencil8:{gl:36168,b:1,c:1,attachment:36128,rb:!0},depth16unorm:{gl:33189,b:2,c:1,attachment:36096,dataFormat:6402,types:[5123],rb:!0},depth24plus:{gl:33190,b:3,c:1,attachment:36096,dataFormat:6402,types:[5125]},depth32float:{gl:36012,b:4,c:1,attachment:36096,dataFormat:6402,types:[5126],rb:!0},"depth24plus-stencil8":{gl:35056,b:4,c:2,p:1,attachment:33306,rb:!0,depthTexture:!0,dataFormat:34041,types:[34042]},"depth24unorm-stencil8":{gl:35056,b:4,c:2,p:1,attachment:33306,dataFormat:34041,types:[34042],rb:!0},"depth32float-stencil8":{gl:36013,b:5,c:2,p:1,attachment:33306,dataFormat:34041,types:[36269],rb:!0},"bc1-rgb-unorm-webgl":{gl:33776,x:Fv,f:cl},"bc1-rgb-unorm-srgb-webgl":{gl:35916,x:Lv,f:cl},"bc1-rgba-unorm":{gl:33777,x:Fv,f:cl},"bc1-rgba-unorm-srgb":{gl:35916,x:Lv,f:cl},"bc2-rgba-unorm":{gl:33778,x:Fv,f:cl},"bc2-rgba-unorm-srgb":{gl:35918,x:Lv,f:cl},"bc3-rgba-unorm":{gl:33779,x:Fv,f:cl},"bc3-rgba-unorm-srgb":{gl:35919,x:Lv,f:cl},"bc4-r-unorm":{gl:36283,x:ky,f:cl},"bc4-r-snorm":{gl:36284,x:ky,f:cl},"bc5-rg-unorm":{gl:36285,x:ky,f:cl},"bc5-rg-snorm":{gl:36286,x:ky,f:cl},"bc6h-rgb-ufloat":{gl:36495,x:Dy,f:cl},"bc6h-rgb-float":{gl:36494,x:Dy,f:cl},"bc7-rgba-unorm":{gl:36492,x:Dy,f:cl},"bc7-rgba-unorm-srgb":{gl:36493,x:Dy,f:cl},"etc2-rgb8unorm":{gl:37492,f:Gf},"etc2-rgb8unorm-srgb":{gl:37494,f:Gf},"etc2-rgb8a1unorm":{gl:37496,f:Gf},"etc2-rgb8a1unorm-srgb":{gl:37497,f:Gf},"etc2-rgba8unorm":{gl:37493,f:Gf},"etc2-rgba8unorm-srgb":{gl:37495,f:Gf},"eac-r11unorm":{gl:37488,f:Gf},"eac-r11snorm":{gl:37489,f:Gf},"eac-rg11unorm":{gl:37490,f:Gf},"eac-rg11snorm":{gl:37491,f:Gf},"astc-4x4-unorm":{gl:37808,f:ss},"astc-4x4-unorm-srgb":{gl:37840,f:ss},"astc-5x4-unorm":{gl:37809,f:ss},"astc-5x4-unorm-srgb":{gl:37841,f:ss},"astc-5x5-unorm":{gl:37810,f:ss},"astc-5x5-unorm-srgb":{gl:37842,f:ss},"astc-6x5-unorm":{gl:37811,f:ss},"astc-6x5-unorm-srgb":{gl:37843,f:ss},"astc-6x6-unorm":{gl:37812,f:ss},"astc-6x6-unorm-srgb":{gl:37844,f:ss},"astc-8x5-unorm":{gl:37813,f:ss},"astc-8x5-unorm-srgb":{gl:37845,f:ss},"astc-8x6-unorm":{gl:37814,f:ss},"astc-8x6-unorm-srgb":{gl:37846,f:ss},"astc-8x8-unorm":{gl:37815,f:ss},"astc-8x8-unorm-srgb":{gl:37847,f:ss},"astc-10x5-unorm":{gl:37819,f:ss},"astc-10x5-unorm-srgb":{gl:37851,f:ss},"astc-10x6-unorm":{gl:37817,f:ss},"astc-10x6-unorm-srgb":{gl:37849,f:ss},"astc-10x8-unorm":{gl:37818,f:ss},"astc-10x8-unorm-srgb":{gl:37850,f:ss},"astc-10x10-unorm":{gl:37819,f:ss},"astc-10x10-unorm-srgb":{gl:37851,f:ss},"astc-12x10-unorm":{gl:37820,f:ss},"astc-12x10-unorm-srgb":{gl:37852,f:ss},"astc-12x12-unorm":{gl:37821,f:ss},"astc-12x12-unorm-srgb":{gl:37853,f:ss},"pvrtc-rgb4unorm-webgl":{gl:35840,f:cS},"pvrtc-rgba4unorm-webgl":{gl:35842,f:cS},"pvrtc-rbg2unorm-webgl":{gl:35841,f:cS},"pvrtc-rgba2unorm-webgl":{gl:35843,f:cS},"etc1-rbg-unorm-webgl":{gl:36196,f:vAt},"atc-rgb-unorm-webgl":{gl:35986,f:n7},"atc-rgba-unorm-webgl":{gl:35986,f:n7},"atc-rgbai-unorm-webgl":{gl:34798,f:n7}},PAt={6403:1,36244:1,33319:2,33320:2,6407:3,36248:3,6408:4,36249:4,6402:1,34041:1,6406:1,6409:1,6410:2},RAt={5126:4,5125:4,5124:4,5123:2,5122:2,5131:2,5120:1,5121:1};function pS(e,t,r){let i=fS[t];if(!i||i.gl===void 0)return!1;let s=i.x||i.gl2ext;return s?!!Fu(e,s,r):!0}function l7(e){let r=fS[e]?.gl;if(r===void 0)throw new Error(`Unsupported texture format ${e}`);return r}function e$(e,t,r){if(!pS(e,t,r)||t.startsWith("depth")||t.startsWith("stencil"))return!1;try{if(f5(t).signed)return!1}catch{return!1}return t.endsWith("32float")?!!Fu(e,"OES_texture_float_linear, extensions",r):t.endsWith("16float")?!!Fu(e,"OES_texture_half_float_linear, extensions",r):!0}function r$(e,t,r){return!(!pS(e,t,r)||typeof t=="number")}function By(e){let t=fS[e],r=l7(e),i=f5(e);return{format:r,dataFormat:t?.dataFormat||kAt(i.format,i.integer,i.normalized,r),type:i.dataType?lS(i.dataType):t?.types?.[0]||5121,compressed:i.compressed}}function i$(e){let t=fS[e];if(!t?.attachment)throw new Error(`${e} is not a depth stencil format`);return t.attachment}function c7(e){let t=By(e),r=PAt[t.dataFormat]||4,i=RAt[t.type]||1;return r*i}function kAt(e,t,r,i){if(i===6408||i===6407)return i;switch(e){case"r":return t&&!r?36244:6403;case"rg":return t&&!r?33320:33319;case"rgb":return t&&!r?36248:6407;case"rgba":return t&&!r?36249:6408;default:return 6408}}var n$={"depth-clip-control":"EXT_depth_clamp","timer-query-webgl":"EXT_disjoint_timer_query_webgl2","compilation-status-async-webgl":"KHR_parallel_shader_compile","polygon-mode-webgl":"WEBGL_polygon_mode","provoking-vertex-webgl":"WEBGL_provoking_vertex","shader-clip-cull-distance-webgl":"WEBGL_clip_cull_distance","shader-noperspective-interpolation-webgl":"NV_shader_noperspective_interpolation","shader-conservative-depth-webgl":"EXT_conservative_depth"},dS=class extends Wb{gl;extensions;testedFeatures=new Set;constructor(t,r,i){super([],i),this.gl=t,this.extensions=r,Fu(t,"EXT_color_buffer_float",r)}*[Symbol.iterator](){let t=this.getFeatures();for(let r of t)this.has(r)&&(yield r);return[]}has(t){return this.disabledFeatures[t]?!1:(this.testedFeatures.has(t)||(this.testedFeatures.add(t),Jj(t)&&t$(this.gl,t,this.extensions)&&this.features.add(t),this.getWebGLFeature(t)&&this.features.add(t)),this.features.has(t))}initializeFeatures(){let t=this.getFeatures().filter(r=>r!=="polygon-mode-webgl");for(let r of t)this.has(r)}getFeatures(){return[...Object.keys(n$),...Object.keys(hS)]}getWebGLFeature(t){let r=n$[t];return typeof r=="string"?!!Fu(this.gl,r,this.extensions):!!r}};var AS=class extends Hb{get maxTextureDimension1D(){return 0}get maxTextureDimension2D(){return this.getParameter(3379)}get maxTextureDimension3D(){return this.getParameter(32883)}get maxTextureArrayLayers(){return this.getParameter(35071)}get maxBindGroups(){return 0}get maxDynamicUniformBuffersPerPipelineLayout(){return 0}get maxDynamicStorageBuffersPerPipelineLayout(){return 0}get maxSampledTexturesPerShaderStage(){return this.getParameter(35660)}get maxSamplersPerShaderStage(){return this.getParameter(35661)}get maxStorageBuffersPerShaderStage(){return 0}get maxStorageTexturesPerShaderStage(){return 0}get maxUniformBuffersPerShaderStage(){return this.getParameter(35375)}get maxUniformBufferBindingSize(){return this.getParameter(35376)}get maxStorageBufferBindingSize(){return 0}get minUniformBufferOffsetAlignment(){return this.getParameter(35380)}get minStorageBufferOffsetAlignment(){return 0}get maxVertexBuffers(){return 16}get maxVertexAttributes(){return this.getParameter(34921)}get maxVertexBufferArrayStride(){return 2048}get maxInterStageShaderComponents(){return this.getParameter(35659)}get maxComputeWorkgroupStorageSize(){return 0}get maxComputeInvocationsPerWorkgroup(){return 0}get maxComputeWorkgroupSizeX(){return 0}get maxComputeWorkgroupSizeY(){return 0}get maxComputeWorkgroupSizeZ(){return 0}get maxComputeWorkgroupsPerDimension(){return 0}gl;limits={};constructor(t){super(),this.gl=t}getParameter(t){return this.limits[t]===void 0&&(this.limits[t]=this.gl.getParameter(t)),this.limits[t]}};function Lu(e,t,r){if(DAt(t))return r(e);let{nocatch:i=!0}=t;wA(e),zh(e,t);let s;if(i)s=r(e),Md(e);else try{s=r(e)}finally{Md(e)}return s}function DAt(e){for(let t in e)return!1;return!0}function o$(e,t,r,i){if(uA(t))return i(e);let s=e;wA(s.gl);try{return BAt(e,t),zh(s.gl,r),i(e)}finally{Md(s.gl)}}function BAt(e,t){let r=e,{gl:i}=r;if(t.cullMode)switch(t.cullMode){case"none":i.disable(2884);break;case"front":i.enable(2884),i.cullFace(1028);break;case"back":i.enable(2884),i.cullFace(1029);break}if(t.frontFace&&i.frontFace(Fg("frontFace",t.frontFace,{ccw:2305,cw:2304})),t.unclippedDepth&&e.features.has("depth-clip-control")&&i.enable(34383),t.depthBias!==void 0&&(i.enable(32823),i.polygonOffset(t.depthBias,t.depthBiasSlopeScale||0)),t.provokingVertex&&e.features.has("provoking-vertex-webgl")){let n=r.getExtension("WEBGL_provoking_vertex").WEBGL_provoking_vertex,o=Fg("provokingVertex",t.provokingVertex,{first:36429,last:36430});n?.provokingVertexWEBGL(o)}if((t.polygonMode||t.polygonOffsetLine)&&e.features.has("polygon-mode-webgl")){if(t.polygonMode){let n=r.getExtension("WEBGL_polygon_mode").WEBGL_polygon_mode,o=Fg("polygonMode",t.polygonMode,{fill:6914,line:6913});n?.polygonModeWEBGL(1028,o),n?.polygonModeWEBGL(1029,o)}t.polygonOffsetLine&&i.enable(10754)}if(e.features.has("shader-clip-cull-distance-webgl")&&(t.clipDistance0&&i.enable(12288),t.clipDistance1&&i.enable(12289),t.clipDistance2&&i.enable(12290),t.clipDistance3&&i.enable(12291),t.clipDistance4&&i.enable(12292),t.clipDistance5&&i.enable(12293),t.clipDistance6&&i.enable(12294),t.clipDistance7&&i.enable(12295)),t.depthWriteEnabled!==void 0&&i.depthMask(NAt("depthWriteEnabled",t.depthWriteEnabled)),t.depthCompare&&(t.depthCompare!=="always"?i.enable(2929):i.disable(2929),i.depthFunc(gS("depthCompare",t.depthCompare))),t.stencilWriteMask){let s=t.stencilWriteMask;i.stencilMaskSeparate(1028,s),i.stencilMaskSeparate(1029,s)}if(t.stencilReadMask&&Ce.warn("stencilReadMask not supported under WebGL"),t.stencilCompare){let s=t.stencilReadMask||4294967295,n=gS("depthCompare",t.stencilCompare);t.stencilCompare!=="always"?i.enable(2960):i.disable(2960),i.stencilFuncSeparate(1028,n,0,s),i.stencilFuncSeparate(1029,n,0,s)}if(t.stencilPassOperation&&t.stencilFailOperation&&t.stencilDepthFailOperation){let s=u7("stencilPassOperation",t.stencilPassOperation),n=u7("stencilFailOperation",t.stencilFailOperation),o=u7("stencilDepthFailOperation",t.stencilDepthFailOperation);i.stencilOpSeparate(1028,n,o,s),i.stencilOpSeparate(1029,n,o,s)}if(t.blendColorOperation||t.blendAlphaOperation){i.enable(3042);let s=s$("blendColorOperation",t.blendColorOperation||"add"),n=s$("blendAlphaOperation",t.blendAlphaOperation||"add");i.blendEquationSeparate(s,n);let o=mS("blendColorSrcFactor",t.blendColorSrcFactor||"one"),c=mS("blendColorDstFactor",t.blendColorDstFactor||"zero"),f=mS("blendAlphaSrcFactor",t.blendAlphaSrcFactor||"one"),p=mS("blendAlphaDstFactor",t.blendAlphaDstFactor||"zero");i.blendFuncSeparate(o,c,f,p)}}function gS(e,t){return Fg(e,t,{never:512,less:513,equal:514,"less-equal":515,greater:516,"not-equal":517,"greater-equal":518,always:519})}function u7(e,t){return Fg(e,t,{keep:7680,zero:0,replace:7681,invert:5386,"increment-clamp":7682,"decrement-clamp":7683,"increment-wrap":34055,"decrement-wrap":34056})}function s$(e,t){return Fg(e,t,{add:32774,subtract:32778,"reverse-subtract":32779,min:32775,max:32776})}function mS(e,t){return Fg(e,t,{one:1,zero:0,"src-color":768,"one-minus-src-color":769,"dst-color":774,"one-minus-dst-color":775,"src-alpha":770,"one-minus-src-alpha":771,"dst-alpha":772,"one-minus-dst-alpha":773,"src-alpha-saturated":776,"constant-color":32769,"one-minus-constant-color":32770,"constant-alpha":32771,"one-minus-constant-alpha":32772})}function OAt(e,t){return`Illegal parameter ${t} for ${e}`}function Fg(e,t,r){if(!(t in r))throw new Error(OAt(e,t));return r[t]}function NAt(e,t){return t}function _S(e){let t={};return e.addressModeU&&(t[10242]=h7(e.addressModeU)),e.addressModeV&&(t[10243]=h7(e.addressModeV)),e.addressModeW&&(t[32882]=h7(e.addressModeW)),e.magFilter&&(t[10240]=a$(e.magFilter)),(e.minFilter||e.mipmapFilter)&&(t[10241]=FAt(e.minFilter||"linear",e.mipmapFilter)),e.lodMinClamp!==void 0&&(t[33082]=e.lodMinClamp),e.lodMaxClamp!==void 0&&(t[33083]=e.lodMaxClamp),e.type==="comparison-sampler"&&(t[34892]=34894),e.compare&&(t[34893]=gS("compare",e.compare)),e.maxAnisotropy&&(t[34046]=e.maxAnisotropy),t}function h7(e){switch(e){case"clamp-to-edge":return 33071;case"repeat":return 10497;case"mirror-repeat":return 33648}}function a$(e){switch(e){case"nearest":return 9728;case"linear":return 9729}}function FAt(e,t){if(!t)return a$(e);switch(e){case"nearest":return t==="nearest"?9984:9986;case"linear":return t==="nearest"?9985:9987}}var Ol=class extends Tn{device;gl;handle;glTarget;glUsage;glIndexType=5123;byteLength;bytesUsed;constructor(t,r={}){super(t,r),this.device=t,this.gl=this.device.gl;let i=typeof r=="object"?r.handle:void 0;this.handle=i||this.gl.createBuffer(),t.setSpectorMetadata(this.handle,{...this.props,data:typeof this.props.data}),this.glTarget=LAt(this.props.usage),this.glUsage=zAt(this.props.usage),this.glIndexType=this.props.indexType==="uint32"?5125:5123,r.data?this._initWithData(r.data,r.byteOffset,r.byteLength):this._initWithByteLength(r.byteLength||0)}_initWithData(t,r=0,i=t.byteLength+r){let s=this.glTarget;this.gl.bindBuffer(s,this.handle),this.gl.bufferData(s,i,this.glUsage),this.gl.bufferSubData(s,r,t),this.gl.bindBuffer(s,null),this.bytesUsed=i,this.byteLength=i,this._setDebugData(t,r,i),this.trackAllocatedMemory(i)}_initWithByteLength(t){Zi(t>=0);let r=t;t===0&&(r=new Float32Array(0));let i=this.glTarget;return this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,r,this.glUsage),this.gl.bindBuffer(i,null),this.bytesUsed=t,this.byteLength=t,this._setDebugData(null,0,t),this.trackAllocatedMemory(t),this}destroy(){!this.destroyed&&this.handle&&(this.removeStats(),this.trackDeallocatedMemory(),this.gl.deleteBuffer(this.handle),this.destroyed=!0,this.handle=null)}write(t,r=0){this.gl.bindBuffer(36663,this.handle),this.gl.bufferSubData(36663,r,t),this.gl.bindBuffer(36663,null),this._setDebugData(t,r,t.byteLength)}async readAsync(t=0,r){return this.readSyncWebGL(t,r)}readSyncWebGL(t=0,r){r=r??this.byteLength-t;let i=new Uint8Array(r),s=0;return this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,t,i,s,r),this.gl.bindBuffer(36662,null),this._setDebugData(i,t,r),i}};function LAt(e){return e&Tn.INDEX?34963:e&Tn.VERTEX?34962:e&Tn.UNIFORM?35345:34962}function zAt(e){return e&Tn.INDEX||e&Tn.VERTEX?35044:e&Tn.UNIFORM?35048:35044}var Lg=class extends vg{device;handle;parameters;constructor(t,r){super(t,r),this.device=t,this.parameters=_S(r),this.handle=this.handle||this.device.gl.createSampler(),this._setSamplerParameters(this.parameters)}destroy(){this.handle&&(this.device.gl.deleteSampler(this.handle),this.handle=void 0)}toString(){return`Sampler(${this.id},${JSON.stringify(this.props)})`}_setSamplerParameters(t){for(let[r,i]of Object.entries(t)){let s=Number(r);switch(s){case 33082:case 33083:this.device.gl.samplerParameterf(this.handle,s,i);break;default:this.device.gl.samplerParameteri(this.handle,s,i);break}}}};var Uh=class extends xg{device;gl;handle;texture;constructor(t,r){super(t,{...Bo.defaultProps,...r}),this.device=t,this.gl=this.device.gl,this.handle=null,this.texture=r.texture}};var UAt={parameters:{},pixelStore:{},pixels:null,border:0,dataFormat:void 0,textureUnit:void 0,target:void 0},cc=class e extends Bo{static FACES=[34069,34070,34071,34072,34073,34074];MAX_ATTRIBUTES;device;gl;handle;sampler=void 0;view=void 0;glFormat=void 0;type=void 0;dataFormat=void 0;mipmaps=void 0;target;textureUnit=void 0;loaded=!1;_video;constructor(t,r){super(t,{...UAt,format:"rgba8unorm",...r}),this.device=t,this.gl=this.device.gl,this.handle=this.props.handle||this.gl.createTexture(),this.device.setSpectorMetadata(this.handle,{...this.props,data:typeof this.props.data}),this.glFormat=6408,this.target=VAt(this.props),this.loaded=!1,typeof this.props?.data=="string"&&Object.assign(this.props,{data:AR(this.props.data)}),this.initialize(this.props),Object.seal(this)}destroy(){this.handle&&(this.gl.deleteTexture(this.handle),this.removeStats(),this.trackDeallocatedMemory("Texture"),this.destroyed=!0)}toString(){return`Texture(${this.id},${this.width}x${this.height})`}createView(t){return new Uh(this.device,{...t,texture:this})}initialize(t={}){if(this.props.dimension==="cube")return this.initializeCube(t);let r=t.data;if(r instanceof Promise)return r.then(U=>this.initialize(Object.assign({},t,{pixels:U,data:U}))),this;let i=typeof HTMLVideoElement<"u"&&r instanceof HTMLVideoElement;if(i&&r.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,r.addEventListener("loadeddata",()=>this.initialize(t)),this;let{parameters:s={}}=t,{pixels:n=null,pixelStore:o={},textureUnit:c=void 0,mipmaps:f=!0}=t;r||(r=n);let{width:p,height:x,dataFormat:E,type:T,compressed:D=!1}=t,{depth:N=0}=t,z=l7(t.format);return{width:p,height:x,compressed:D,dataFormat:E,type:T}=this._deduceParameters({format:t.format,type:T,dataFormat:E,compressed:D,data:r,width:p,height:x}),this.width=p,this.height=x,this.glFormat=z,this.type=T,this.dataFormat=E,this.textureUnit=c,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),this.mipmaps=f,this.setImageData({data:r,width:p,height:x,depth:N,format:z,type:T,dataFormat:E,parameters:o,compressed:D}),this.setSampler(t.sampler),this._setSamplerParameters(s),this.view=this.createView({...this.props,mipLevelCount:1,arrayLayerCount:1}),f&&this.device.isTextureFormatFilterable(t.format)&&this.generateMipmap(),i&&(this._video={video:r,parameters:s,lastTime:r.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?r.currentTime:-1}),this}initializeCube(t){let{mipmaps:r=!0,parameters:i={}}=t;return this.setCubeMapImageData(t).then(()=>{this.loaded=!0,r&&this.generateMipmap(t),this.setSampler(t.sampler),this._setSamplerParameters(i)}),this}setSampler(t={}){let r;t instanceof Lg?(this.sampler=t,r=t.props):(this.sampler=new Lg(this.device,t),r=t);let i=_S(r);return this._setSamplerParameters(i),this}resize(t){let{height:r,width:i,mipmaps:s=!1}=t;return i!==this.width||r!==this.height?this.initialize({width:i,height:r,format:this.format,type:this.type,dataFormat:this.dataFormat,mipmaps:s}):this}update(){if(this._video){let{video:t,parameters:r,lastTime:i}=this._video;if(i===t.currentTime||t.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:t,parameters:r}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=t.currentTime}}generateMipmap(t={}){return this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),Lu(this.gl,t,()=>{this.gl.generateMipmap(this.target)}),this.gl.bindTexture(this.target,null),this}setImageData(t){if(this.props.dimension==="3d"||this.props.dimension==="2d-array")return this.setImageData3D(t);this.trackDeallocatedMemory("Texture");let{target:r=this.target,pixels:i=null,level:s=0,glFormat:n=this.glFormat,offset:o=0,parameters:c={}}=t,{data:f=null,type:p=this.type,width:x=this.width,height:E=this.height,dataFormat:T=this.dataFormat,compressed:D=!1}=t;f||(f=i),{type:p,dataFormat:T,compressed:D,width:x,height:E}=this._deduceParameters({format:this.props.format,type:p,dataFormat:T,compressed:D,data:f,width:x,height:E});let{gl:N}=this;N.bindTexture(this.target,this.handle);let z=null;if({data:f,dataType:z}=this._getDataType({data:f,compressed:D}),Lu(this.gl,c,()=>{switch(z){case"null":N.texImage2D(r,s,n,x,E,0,T,p,f);break;case"typed-array":N.texImage2D(r,s,n,x,E,0,T,p,f,o);break;case"buffer":this.device.gl.bindBuffer(35052,f.handle||f),this.device.gl.texImage2D(r,s,n,x,E,0,T,p,o),this.device.gl.bindBuffer(35052,null);break;case"browser-object":N.texImage2D(r,s,n,x,E,0,T,p,f);break;case"compressed":for(let[U,H]of f.entries())N.compressedTexImage2D(r,U,H.format,H.width,H.height,0,H.data);break;default:Zi(!1,"Unknown image data type")}}),f&&f.byteLength)this.trackAllocatedMemory(f.byteLength,"Texture");else{let U=c7(this.props.format);this.trackAllocatedMemory(this.width*this.height*U,"Texture")}return this.loaded=!0,this}setSubImageData({target:t=this.target,pixels:r=null,data:i=null,x:s=0,y:n=0,width:o=this.width,height:c=this.height,level:f=0,glFormat:p=this.glFormat,type:x=this.type,dataFormat:E=this.dataFormat,compressed:T=!1,offset:D=0,parameters:N={}}){if({type:x,dataFormat:E,compressed:T,width:o,height:c}=this._deduceParameters({format:this.props.format,type:x,dataFormat:E,compressed:T,data:i,width:o,height:c}),Zi(this.depth===1,"texSubImage not supported for 3D textures"),i||(i=r),i&&i.data){let z=i;i=z.data,o=z.shape[0],c=z.shape[1]}i instanceof Ol&&(i=i.handle),this.gl.bindTexture(this.target,this.handle),Lu(this.gl,N,()=>{T?this.gl.compressedTexSubImage2D(t,f,s,n,o,c,p,i):i===null?this.gl.texSubImage2D(t,f,s,n,o,c,E,x,null):ArrayBuffer.isView(i)?this.gl.texSubImage2D(t,f,s,n,o,c,E,x,i,D):typeof WebGLBuffer<"u"&&i instanceof WebGLBuffer?(this.device.gl.bindBuffer(35052,i),this.device.gl.texSubImage2D(t,f,s,n,o,c,E,x,D),this.device.gl.bindBuffer(35052,null)):this.device.gl.texSubImage2D(t,f,s,n,o,c,E,x,i)}),this.gl.bindTexture(this.target,null)}copyFramebuffer(t={}){return Ce.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(t=this.textureUnit){let{gl:r}=this;return t!==void 0&&(this.textureUnit=t,r.activeTexture(33984+t)),r.bindTexture(this.target,this.handle),t}unbind(t=this.textureUnit){let{gl:r}=this;return t!==void 0&&(this.textureUnit=t,r.activeTexture(33984+t)),r.bindTexture(this.target,null),t}_getDataType({data:t,compressed:r=!1}){return r?{data:t,dataType:"compressed"}:t===null?{data:t,dataType:"null"}:ArrayBuffer.isView(t)?{data:t,dataType:"typed-array"}:t instanceof Ol?{data:t.handle,dataType:"buffer"}:typeof WebGLBuffer<"u"&&t instanceof WebGLBuffer?{data:t,dataType:"buffer"}:{data:t,dataType:"browser-object"}}_deduceParameters(t){let{format:r,data:i}=t,{width:s,height:n,dataFormat:o,type:c,compressed:f}=t,p=By(r);return o=o||p.dataFormat,c=c||p.type,f=f||p.compressed,{width:s,height:n}=this._deduceImageSize(i,s,n),{dataFormat:o,type:c,compressed:f,width:s,height:n,format:r,data:i}}_deduceImageSize(t,r,i){let s;return typeof ImageData<"u"&&t instanceof ImageData?s={width:t.width,height:t.height}:typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement?s={width:t.naturalWidth,height:t.naturalHeight}:typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement?s={width:t.width,height:t.height}:typeof ImageBitmap<"u"&&t instanceof ImageBitmap?s={width:t.width,height:t.height}:typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement?s={width:t.videoWidth,height:t.videoHeight}:t?s={width:r,height:i}:s={width:r>=0?r:1,height:i>=0?i:1},Zi(s,"Could not deduced texture size"),Zi(r===void 0||s.width===r,"Deduced texture width does not match supplied width"),Zi(i===void 0||s.height===i,"Deduced texture height does not match supplied height"),s}async setCubeMapImageData(t){let{gl:r}=this,{width:i,height:s,pixels:n,data:o,format:c=6408,type:f=5121}=t,p=n||o,x=await Promise.all(e.FACES.map(E=>{let T=p[E];return Promise.all(Array.isArray(T)?T:[T])}));this.bind(),e.FACES.forEach((E,T)=>{x[T].length>1&&this.props.mipmaps!==!1&&Ce.warn(`${this.id} has mipmap and multiple LODs.`)(),x[T].forEach((D,N)=>{i&&s?r.texImage2D(E,N,c,i,s,0,c,f,D):r.texImage2D(E,N,c,c,f,D)})}),this.unbind()}setImageDataForFace(t){let{face:r,width:i,height:s,pixels:n,data:o,format:c=6408,type:f=5121}=t,{gl:p}=this,x=n||o;return this.bind(),x instanceof Promise?x.then(E=>this.setImageDataForFace(Object.assign({},t,{face:r,data:E,pixels:E}))):this.width||this.height?p.texImage2D(r,0,c,i,s,0,c,f,x):p.texImage2D(r,0,c,c,f,x),this}setImageData3D(t){let{level:r=0,dataFormat:i,format:s,type:n,width:o,height:c,depth:f=1,offset:p=0,data:x,parameters:E={}}=t;this.trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle);let T=By(s);if(Lu(this.gl,E,()=>{ArrayBuffer.isView(x)&&this.gl.texImage3D(this.target,r,T.format,o,c,f,0,T.dataFormat,T.type,x),x instanceof Ol&&(this.gl.bindBuffer(35052,x.handle),this.gl.texImage3D(this.target,r,i,o,c,f,0,s,n,p))}),x&&x.byteLength)this.trackAllocatedMemory(x.byteLength,"Texture");else{let D=c7(this.props.format);this.trackAllocatedMemory(this.width*this.height*this.depth*D,"Texture")}return this.loaded=!0,this}_setSamplerParameters(t){if(!uA(t)){jAt(t),this.gl.bindTexture(this.target,this.handle);for(let[r,i]of Object.entries(t)){let s=Number(r),n=i;switch(s){case 33082:case 33083:this.gl.texParameterf(this.target,s,n);break;default:this.gl.texParameteri(this.target,s,n);break}}this.gl.bindTexture(this.target,null)}}};function VAt(e){switch(e.dimension){case"2d":return 3553;case"cube":return 34067;case"2d-array":return 35866;case"3d":return 32879;case"1d":case"cube-array":default:throw new Error(e.dimension)}}function jAt(e){Ce.log(1,"texture sampler parameters",e)()}var Qf=class extends wg{device;gl;handle;get texture(){return this.colorAttachments[0]}constructor(t,r){super(t,r);let i=r.handle===null;if(this.device=t,this.gl=t.gl,this.handle=this.props.handle||i?this.props.handle:this.gl.createFramebuffer(),!i){t.setSpectorMetadata(this.handle,{id:this.props.id,props:this.props}),this.autoCreateAttachmentTextures();let s=this.gl.bindFramebuffer(36160,this.handle);for(let n=0;n<this.colorAttachments.length;++n){let o=this.colorAttachments[n],c=36064+n;o&&this._attachOne(c,o)}if(this.depthStencilAttachment&&this._attachOne(i$(this.depthStencilAttachment.props.format),this.depthStencilAttachment),r.check!==!1){let n=this.gl.checkFramebufferStatus(36160);if(n!==36053)throw new Error(`Framebuffer ${HAt(n)}`)}this.gl.bindFramebuffer(36160,s)}}destroy(){super.destroy(),!this.destroyed&&this.handle!==null&&this.gl.deleteFramebuffer(this.handle)}createDepthStencilTexture(t){return new cc(this.device,{id:`${this.id}-depth-stencil`,format:t,width:this.width,height:this.height,mipmaps:!1})}resizeAttachments(t,r){if(this.handle===null)return this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;t===void 0&&(t=this.gl.drawingBufferWidth),r===void 0&&(r=this.gl.drawingBufferHeight);for(let i of this.colorAttachments)i.texture.resize({width:t,height:r});return this.depthStencilAttachment&&this.depthStencilAttachment.texture.resize({width:t,height:r}),this}_attachOne(t,r){if(Array.isArray(r)){let[i,s=0,n=0]=r;return this._attachTexture(t,i,s,n),i}if(r instanceof cc)return this._attachTexture(t,r,0,0),r;if(r instanceof Uh){let i=r;return this._attachTexture(t,i.texture,i.props.baseMipLevel,i.props.baseArrayLayer),r.texture}throw new Error("attach")}_attachTexture(t,r,i,s){let{gl:n}=this.device;switch(n.bindTexture(r.target,r.handle),r.target){case 35866:case 32879:n.framebufferTextureLayer(36160,t,r.target,s,i);break;case 34067:let o=$At(i);n.framebufferTexture2D(36160,t,o,r.handle,s);break;case 3553:n.framebufferTexture2D(36160,t,3553,r.handle,s);break;default:Zi(!1,"Illegal texture type")}n.bindTexture(r.target,null)}};function $At(e){return e<34069?e+34069:e}function HAt(e){switch(e){case 36053:return"success";case 36054:return"Mismatched attachments";case 36055:return"No attachments";case 36057:return"Height/width mismatch";case 36061:return"Unsupported or split attachments";case 36182:return"Samples mismatch";default:return`${e}`}}var yS=class extends yg{device;presentationSize;_framebuffer=null;constructor(t,r){super(r),this.device=t,this.presentationSize=[-1,-1],this._setAutoCreatedCanvasId(`${this.device.id}-canvas`),this.update()}getCurrentFramebuffer(){return this.update(),this._framebuffer=this._framebuffer||new Qf(this.device,{handle:null}),this._framebuffer}update(){let t=this.getPixelSize();(t[0]!==this.presentationSize[0]||t[1]!==this.presentationSize[1])&&(this.presentationSize=t,this.resize())}resize(t){if(this.device.gl&&this.canvas){let r=this.getDevicePixelRatio(t?.useDevicePixels);this.setDevicePixelRatio(r,t);return}}commit(){}};var WAt={spector:Ce.get("spector")||Ce.get("spectorjs")},qAt="https://cdn.jsdelivr.net/npm/spectorjs@0.9.30/dist/spector.bundle.js",YAt=1,uc=null,l$=!1;async function c$(e){if(!globalThis.SPECTOR)try{await rv(qAt)}catch(t){Ce.warn(String(t))}}function u$(e){if(e={...WAt,...e},!e?.spector||(!uc&&globalThis.SPECTOR&&(Ce.probe(YAt,"SPECTOR found and initialized")(),uc=new globalThis.SPECTOR.Spector,globalThis.luma&&(globalThis.luma.spector=uc)),!uc))return null;if(l$||(l$=!0,uc.spyCanvases(),uc?.onCaptureStarted.add(t=>Ce.info("Spector capture started:",t)()),uc?.onCapture.add(t=>{Ce.info("Spector capture complete:",t)(),uc?.getResultUI(),uc?.resultView.display(),uc?.resultView.addCapture(t)})),e?.canvas){if(typeof e.spector=="string"&&e.spector!==e.canvas.id)return uc;uc?.startCapture(e?.canvas,500),new Promise(t=>setTimeout(t,2e3)).then(t=>{Ce.info("Spector capture stopped after 2 seconds")(),uc?.stopCapture()})}return uc}var XAt="https://unpkg.com/webgl-debug@2.0.1/index.js";function h$(e){return e.luma=e.luma||{},e.luma}async function f$(){ol()&&!globalThis.WebGLDebugUtils&&(globalThis.global=globalThis.global||globalThis,globalThis.global.module={},await rv(XAt))}function p$(e,t={}){return e?t.debug?GAt(e,t):ZAt(e):null}function ZAt(e){let t=h$(e);return t.realContext?t.realContext:e}function GAt(e,t){if(!globalThis.WebGLDebugUtils)return Ce.warn("webgl-debug not loaded")(),e;let r=h$(e);if(r.debugContext)return r.debugContext;globalThis.WebGLDebugUtils.init({...vA,...e});let i=globalThis.WebGLDebugUtils.makeDebugContext(e,QAt.bind(null,t),KAt.bind(null,t));for(let o in vA)!(o in i)&&typeof vA[o]=="number"&&(i[o]=vA[o]);class s{}Object.setPrototypeOf(i,Object.getPrototypeOf(e)),Object.setPrototypeOf(s,i);let n=Object.create(s);return r.realContext=e,r.debugContext=n,n.debug=!0,n}function f7(e,t){t=Array.from(t).map(i=>i===void 0?"undefined":i);let r=globalThis.WebGLDebugUtils.glFunctionArgsToString(e,t);return r=`${r.slice(0,100)}${r.length>100?"...":""}`,`gl.${e}(${r})`}function QAt(e,t,r,i){i=Array.from(i).map(c=>c===void 0?"undefined":c);let s=globalThis.WebGLDebugUtils.glEnumToString(t),n=globalThis.WebGLDebugUtils.glFunctionArgsToString(r,i),o=`${s} in gl.${r}(${n})`;Ce.error(o)();debugger;if(e.throwOnError)throw new Error(o)}function KAt(e,t,r){let i="";if(Ce.level>=1&&(i=f7(t,r),Ce.log(1,i)()),e.break&&e.break.length>0&&(i=i||f7(t,r),e.break.every(n=>i.indexOf(n)!==-1)))debugger;for(let s of r)if(s===void 0){if(i=i||f7(t,r),e.throwOnError)throw new Error(`Undefined argument: ${i}`);Ce.error(`Undefined argument: ${i}`)();debugger}}function A$(e){let t=e.split(/\r?\n/),r=[];for(let i of t){if(i.length<=1)continue;let s=i.split(":");if(s.length===2){let[E,T]=s;r.push({message:T.trim(),type:d$(E),lineNum:0,linePos:0});continue}let[n,o,c,...f]=s,p=parseInt(c,10);isNaN(p)&&(p=0);let x=parseInt(o,10);isNaN(x)&&(x=0),r.push({message:f.join(":").trim(),type:d$(n),lineNum:p,linePos:x})}return r}function d$(e){let t=["warning","error","info"],r=e.toLowerCase();return t.includes(r)?r:"info"}var xS=class extends bg{device;handle;constructor(t,r){switch(super(t,r),this.device=t,this.props.stage){case"vertex":this.handle=this.props.handle||this.device.gl.createShader(35633);break;case"fragment":this.handle=this.props.handle||this.device.gl.createShader(35632);break;default:throw new Error(this.props.stage)}this._compile(this.source)}destroy(){this.handle&&(this.removeStats(),this.device.gl.deleteShader(this.handle),this.destroyed=!0)}async getCompilationInfo(){return await this._waitForCompilationComplete(),this.getCompilationInfoSync()}getCompilationInfoSync(){let t=this.device.gl.getShaderInfoLog(this.handle);return A$(t)}getTranslatedSource(){return this.device.getExtension("WEBGL_debug_shaders").WEBGL_debug_shaders?.getTranslatedShaderSource(this.handle)}async _compile(t){t=(s=>s.startsWith("#version ")?s:`#version 100
${s}`)(t);let{gl:i}=this.device;if(i.shaderSource(this.handle,t),i.compileShader(this.handle),Ce.level===0){this.compilationStatus="pending";return}if(!this.device.features.has("compilation-status-async-webgl")){if(this._getCompilationStatus(),this.debugShader(),this.compilationStatus==="error")throw new Error(`GLSL compilation errors in ${this.props.stage} shader ${this.props.id}`);return}Ce.once(1,"Shader compilation is asynchronous")(),await this._waitForCompilationComplete(),Ce.info(2,`Shader ${this.id} - async compilation complete: ${this.compilationStatus}`)(),this._getCompilationStatus(),this.debugShader()}async _waitForCompilationComplete(){let t=async s=>await new Promise(n=>setTimeout(n,s));if(!this.device.features.has("compilation-status-async-webgl")){await t(10);return}let{gl:i}=this.device;for(;;){if(i.getShaderParameter(this.handle,37297))return;await t(10)}}_getCompilationStatus(){this.compilationStatus=this.device.gl.getShaderParameter(this.handle,35713)?"success":"error"}};var JAt=256,tmt=1024,emt=16384,p7=6144,rmt=[1,2,4,8],bS=class extends Yb{device;glParameters;constructor(t,r){super(t,r),this.device=t,wA(this.device.gl),this.setParameters(this.props.parameters),this.clear()}end(){Md(this.device.gl)}pushDebugGroup(t){}popDebugGroup(){}insertDebugMarker(t){}setParameters(t={}){let r={...this.glParameters};this.props.framebuffer&&(r.framebuffer=this.props.framebuffer),this.props.depthReadOnly&&(r.depthMask=!this.props.depthReadOnly),r.stencilMask=this.props.stencilReadOnly?0:1,r[35977]=this.props.discard,t.viewport&&(t.viewport.length>=6?(r.viewport=t.viewport.slice(0,4),r.depthRange=[t.viewport[4],t.viewport[5]]):r.viewport=t.viewport),t.scissorRect&&(r.scissorTest=!0,r.scissor=t.scissorRect),t.blendConstant&&(r.blendColor=t.blendConstant),t.stencilReference&&(console.warn("RenderPassParameters.stencilReference not yet implemented in WebGL"),t[2967]=t.stencilReference),t.colorMask&&(r.colorMask=rmt.map(i=>!!(i&t.colorMask))),this.glParameters=r,zh(this.device.gl,r)}beginOcclusionQuery(t){this.props.occlusionQuerySet?.beginOcclusionQuery()}endOcclusionQuery(){this.props.occlusionQuerySet?.endOcclusionQuery()}clear(){let t={...this.glParameters},r=0;this.props.clearColor!==!1&&(r|=emt,t.clearColor=this.props.clearColor),this.props.clearDepth!==!1&&(r|=JAt,t.clearDepth=this.props.clearDepth),this.props.clearStencil!==!1&&(r|=tmt,t.clearStencil=this.props.clearStencil),r!==0&&Lu(this.device.gl,t,()=>{this.device.gl.clear(r)})}clearColorBuffer(t=0,r=[0,0,0,0]){Lu(this.device.gl,{framebuffer:this.props.framebuffer},()=>{switch(r.constructor){case Int32Array:this.device.gl.clearBufferiv(p7,t,r);break;case Uint32Array:this.device.gl.clearBufferuiv(p7,t,r);break;case Float32Array:default:this.device.gl.clearBufferfv(p7,t,r);break}})}};var imt="Failed to deduce GL constant from typed array";function m$(e){switch(ArrayBuffer.isView(e)?e.constructor:e){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:return 5121;case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(imt)}}function zv(e,t){let{clamped:r=!0}=t||{};switch(e){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return r?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}var nmt={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},smt={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}},vS=class e{offset;stride;type;size;divisor;normalized;integer;buffer;index;static getBytesPerElement(t){return zv(t.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(t){return Zi(t.size),zv(t.type||5126).BYTES_PER_ELEMENT*t.size}static resolve(...t){return new e(nmt,...t)}constructor(...t){t.forEach(r=>this._assign(r)),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return e.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return e.getBytesPerVertex(this)}_assign(t={}){return t=dR("Accessor",t,smt),t.type!==void 0&&(this.type=t.type,(t.type===5124||t.type===5125)&&(this.integer=!0)),t.size!==void 0&&(this.size=t.size),t.offset!==void 0&&(this.offset=t.offset),t.stride!==void 0&&(this.stride=t.stride),t.normalize!==void 0&&(this.normalized=t.normalize),t.normalized!==void 0&&(this.normalized=t.normalized),t.integer!==void 0&&(this.integer=t.integer),t.divisor!==void 0&&(this.divisor=t.divisor),t.buffer!==void 0&&(this.buffer=t.buffer),t.index!==void 0&&(typeof t.index=="boolean"?this.index=t.index?1:0:this.index=t.index),t.instanced!==void 0&&(this.divisor=t.instanced?1:0),t.isInstanced!==void 0&&(this.divisor=t.isInstanced?1:0),this.offset===void 0&&delete this.offset,this.stride===void 0&&delete this.stride,this.type===void 0&&delete this.type,this.size===void 0&&delete this.size,this.divisor===void 0&&delete this.divisor,this.normalized===void 0&&delete this.normalized,this.integer===void 0&&delete this.integer,this.buffer===void 0&&delete this.buffer,this.index===void 0&&delete this.index,this}};function g$(e){return omt.includes(e)}var omt=[35678,35680,35679,35682,36289,36292,36293,36298,36299,36300,36303,36306,36307,36308,36311],_$={5126:[5126,1,"float","f32","float32"],35664:[5126,2,"vec2","vec2<f32>","float32x2"],35665:[5126,3,"vec3","vec3<f32>","float32x3"],35666:[5126,4,"vec4","vec4<f32>","float32x4"],5124:[5124,1,"int","i32","sint32"],35667:[5124,2,"ivec2","vec2<i32>","sint32x2"],35668:[5124,3,"ivec3","vec3<i32>","sint32x3"],35669:[5124,4,"ivec4","vec4<i32>","sint32x4"],5125:[5125,1,"uint","u32","uint32"],36294:[5125,2,"uvec2","vec2<u32>","uint32x2"],36295:[5125,3,"uvec3","vec3<u32>","uint32x3"],36296:[5125,4,"uvec4","vec4<u32>","uint32x4"],35670:[5126,1,"bool","f32","float32"],35671:[5126,2,"bvec2","vec2<f32>","float32x2"],35672:[5126,3,"bvec3","vec3<f32>","float32x3"],35673:[5126,4,"bvec4","vec4<f32>","float32x4"],35674:[5126,8,"mat2","mat2x2<f32>"],35685:[5126,8,"mat2x3","mat2x3<f32>"],35686:[5126,8,"mat2x4","mat2x4<f32>"],35687:[5126,12,"mat3x2","mat3x2<f32>"],35675:[5126,12,"mat3","mat3x3<f32>"],35688:[5126,12,"mat3x4","mat3x4<f32>"],35689:[5126,16,"mat4x2","mat4x2<f32>"],35690:[5126,16,"mat4x3","mat4x3<f32>"],35676:[5126,16,"mat4","mat4x4<f32>"]};function d7(e){let t=_$[e];if(!t)throw new Error("uniform");let[r,i,,s]=t;return{format:s,components:i,glType:r}}function y$(e){let t=_$[e];if(!t)throw new Error("attribute");let[,r,,i,s]=t;return{attributeType:i,vertexFormat:s,components:r}}function x$(e,t){let r={attributes:[],bindings:[]};r.attributes=amt(e,t);let i=umt(e,t);for(let c of i){let f=c.uniforms.map(p=>({name:p.name,format:p.format,byteOffset:p.byteOffset,byteStride:p.byteStride,arrayLength:p.arrayLength}));r.bindings.push({type:"uniform",name:c.name,location:c.location,visibility:(c.vertex?1:0)&(c.fragment?2:0),minBindingSize:c.byteLength,uniforms:f})}let s=cmt(e,t),n=0;for(let c of s)if(g$(c.type)){let{viewDimension:f,sampleType:p}=fmt(c.type);r.bindings.push({type:"texture",name:c.name,location:n,viewDimension:f,sampleType:p}),c.textureUnit=n,n+=1}s.length&&(r.uniforms=s);let o=lmt(e,t);return o?.length&&(r.varyings=o),r}function amt(e,t){let r=[],i=e.getProgramParameter(t,35721);for(let s=0;s<i;s++){let n=e.getActiveAttrib(t,s);if(!n)throw new Error("activeInfo");let{name:o,type:c}=n,f=e.getAttribLocation(t,o);if(f>=0){let{attributeType:p}=y$(c),x=/instance/i.test(o)?"instance":"vertex";r.push({name:o,location:f,stepMode:x,type:p})}}return r.sort((s,n)=>s.location-n.location),r}function lmt(e,t){let r=[],i=e.getProgramParameter(t,35971);for(let s=0;s<i;s++){let n=e.getTransformFeedbackVarying(t,s);if(!n)throw new Error("activeInfo");let{name:o,type:c,size:f}=n,{glType:p,components:x}=d7(c),E=new vS({type:p,size:f*x}),T={location:s,name:o,accessor:E};r.push(T)}return r.sort((s,n)=>s.location-n.location),r}function cmt(e,t){let r=[],i=e.getProgramParameter(t,35718);for(let s=0;s<i;s++){let n=e.getActiveUniform(t,s);if(!n)throw new Error("activeInfo");let{name:o,size:c,type:f}=n,{name:p,isArray:x}=pmt(o),E=e.getUniformLocation(t,p),T={location:E,name:p,size:c,type:f,isArray:x};if(r.push(T),T.size>1)for(let D=0;D<T.size;D++){let N=`${p}[${D}]`;E=e.getUniformLocation(t,N);let z={...T,name:N,location:E};r.push(z)}}return r}function umt(e,t){let r=(n,o)=>e.getActiveUniformBlockParameter(t,n,o),i=[],s=e.getProgramParameter(t,35382);for(let n=0;n<s;n++){let o={name:e.getActiveUniformBlockName(t,n)||"",location:r(n,35391),byteLength:r(n,35392),vertex:r(n,35396),fragment:r(n,35398),uniformCount:r(n,35394),uniforms:[]},c=r(n,35395)||[],f=e.getActiveUniforms(t,c,35383),p=e.getActiveUniforms(t,c,35384),x=e.getActiveUniforms(t,c,35387),E=e.getActiveUniforms(t,c,35388);for(let T=0;T<o.uniformCount;++T){let D=e.getActiveUniform(t,c[T]);if(!D)throw new Error("activeInfo");o.uniforms.push({name:D.name,format:d7(f[T]).format,type:f[T],arrayLength:p[T],byteOffset:x[T],byteStride:E[T]})}i.push(o)}return i.sort((n,o)=>n.location-o.location),i}var hmt={35678:["2d","float"],35680:["cube","float"],35679:["3d","float"],35682:["3d","depth"],36289:["2d-array","float"],36292:["2d-array","depth"],36293:["cube","float"],36298:["2d","sint"],36299:["3d","sint"],36300:["cube","sint"],36303:["2d-array","uint"],36306:["2d","uint"],36307:["3d","uint"],36308:["cube","uint"],36311:["2d-array","uint"]};function fmt(e){let t=hmt[e];if(!t)throw new Error("sampler");let[r,i]=t;return{viewDimension:r,sampleType:i}}function pmt(e){if(e[e.length-1]!=="]")return{name:e,length:1,isArray:!1};let r=/([^[]*)(\[[0-9]+\])?/.exec(e);if(!r||r.length<2)throw new Error(`Failed to parse GLSL uniform name ${e}`);return{name:r[1],length:r[2]?1:0,isArray:!!r[2]}}function b$(e,t,r,i){let s=e,n=i;n===!0&&(n=1),n===!1&&(n=0);let o=typeof n=="number"?[n]:n;switch(r){case 35678:case 35680:case 35679:case 35682:case 36289:case 36292:case 36293:case 36298:case 36299:case 36300:case 36303:case 36306:case 36307:case 36308:case 36311:if(typeof i!="number")throw new Error("samplers must be set to integers");return e.uniform1i(t,i);case 5126:return e.uniform1fv(t,o);case 35664:return e.uniform2fv(t,o);case 35665:return e.uniform3fv(t,o);case 35666:return e.uniform4fv(t,o);case 5124:return e.uniform1iv(t,o);case 35667:return e.uniform2iv(t,o);case 35668:return e.uniform3iv(t,o);case 35669:return e.uniform4iv(t,o);case 35670:return e.uniform1iv(t,o);case 35671:return e.uniform2iv(t,o);case 35672:return e.uniform3iv(t,o);case 35673:return e.uniform4iv(t,o);case 5125:return s.uniform1uiv(t,o,1);case 36294:return s.uniform2uiv(t,o,2);case 36295:return s.uniform3uiv(t,o,3);case 36296:return s.uniform4uiv(t,o,4);case 35674:return e.uniformMatrix2fv(t,!1,o);case 35675:return e.uniformMatrix3fv(t,!1,o);case 35676:return e.uniformMatrix4fv(t,!1,o);case 35685:return s.uniformMatrix2x3fv(t,!1,o);case 35686:return s.uniformMatrix2x4fv(t,!1,o);case 35687:return s.uniformMatrix3x2fv(t,!1,o);case 35688:return s.uniformMatrix3x4fv(t,!1,o);case 35689:return s.uniformMatrix4x2fv(t,!1,o);case 35690:return s.uniformMatrix4x3fv(t,!1,o)}throw new Error("Illegal uniform")}function v$(e){switch(e){case"point-list":return 0;case"line-list":return 1;case"line-strip":return 3;case"line-loop-webgl":return 2;case"triangle-list":return 4;case"triangle-strip":return 5;case"triangle-fan-webgl":return 6;default:throw new Error(e)}}function w$(e){switch(e){case"point-list":return 0;case"line-list":return 1;case"line-strip":return 1;case"line-loop-webgl":return 1;case"triangle-list":return 4;case"triangle-strip":return 4;case"triangle-fan-webgl":return 4;default:throw new Error(e)}}var T$=4,wS=class extends Uf{device;handle;vs;fs;introspectedLayout;uniforms={};bindings={};varyings=null;_uniformCount=0;_uniformSetters={};constructor(t,r){super(t,r),this.device=t,this.handle=this.props.handle||this.device.gl.createProgram(),this.device.setSpectorMetadata(this.handle,{id:this.props.id}),this.vs=r.vs,this.fs=r.fs;let{varyings:i,bufferMode:s=35981}=r;switch(i&&i.length>0&&(this.varyings=i,this.device.gl.transformFeedbackVaryings(this.handle,i,s)),this._linkShaders(),Ce.time(1,`RenderPipeline ${this.id} - shaderLayout introspection`)(),this.introspectedLayout=x$(this.device.gl,this.handle),Ce.timeEnd(1,`RenderPipeline ${this.id} - shaderLayout introspection`)(),this.shaderLayout=uR(this.introspectedLayout,r.shaderLayout),this.props.topology){case"triangle-fan-webgl":case"line-loop-webgl":Ce.warn(`Primitive topology ${this.props.topology} is deprecated and will be removed in v9.1`);break;default:}}destroy(){this.handle&&(this.device.gl.deleteProgram(this.handle),this.destroyed=!0)}setBindings(t,r){for(let[i,s]of Object.entries(t)){let n=this.shaderLayout.bindings.find(o=>o.name===i)||this.shaderLayout.bindings.find(o=>o.name===`${i}Uniforms`);if(!n){let o=this.shaderLayout.bindings.map(c=>`"${c.name}"`).join(", ");r?.disableWarnings||Ce.warn(`Unknown binding "${i}" in render pipeline "${this.id}", expected one of ${o}`)();continue}switch(s||Ce.warn(`Unsetting binding "${i}" in render pipeline "${this.id}"`)(),n.type){case"uniform":if(!(s instanceof Ol)&&!(s.buffer instanceof Ol))throw new Error("buffer value");break;case"texture":if(!(s instanceof Uh||s instanceof cc||s instanceof Qf))throw new Error("texture value");break;case"sampler":Ce.warn(`Ignoring sampler ${i}`)();break;default:throw new Error(n.type)}this.bindings[i]=s}}draw(t){let{renderPass:r,parameters:i=this.props.parameters,topology:s=this.props.topology,vertexArray:n,vertexCount:o,instanceCount:c,isInstanced:f=!1,firstVertex:p=0,transformFeedback:x}=t,E=v$(s),T=!!n.indexBuffer,D=n.indexBuffer?.glIndexType;if(this.linkStatus!=="success")return Ce.info(2,`RenderPipeline:${this.id}.draw() aborted - waiting for shader linking`)(),!1;if(!this._areTexturesRenderable()||o===0)return Ce.info(2,`RenderPipeline:${this.id}.draw() aborted - textures not yet loaded`)(),!1;if(o===0)return Ce.info(2,`RenderPipeline:${this.id}.draw() aborted - no vertices to draw`)(),!0;this.device.gl.useProgram(this.handle),n.bindBeforeRender(r),x&&x.begin(this.props.topology),this._applyBindings(),this._applyUniforms();let N=r;return o$(this.device,i,N.glParameters,()=>{T&&f?this.device.gl.drawElementsInstanced(E,o||0,D,p,c||0):T?this.device.gl.drawElements(E,o||0,D,p):f?this.device.gl.drawArraysInstanced(E,p,o||0,c||0):this.device.gl.drawArrays(E,p,o||0),x&&x.end()}),n.unbindAfterRender(r),!0}setUniformsWebGL(t){let{bindings:r}=ev(t);Object.keys(r).forEach(i=>{Ce.warn(`Unsupported value "${JSON.stringify(r[i])}" used in setUniforms() for key ${i}. Use setBindings() instead?`)()}),Object.assign(this.uniforms,t)}async _linkShaders(){let{gl:t}=this.device;if(t.attachShader(this.handle,this.vs.handle),t.attachShader(this.handle,this.fs.handle),Ce.time(T$,`linkProgram for ${this.id}`)(),t.linkProgram(this.handle),Ce.timeEnd(T$,`linkProgram for ${this.id}`)(),Ce.level,!this.device.features.has("compilation-status-async-webgl")){let i=this._getLinkStatus();this._reportLinkStatus(i);return}Ce.once(1,"RenderPipeline linking is asynchronous")(),await this._waitForLinkComplete(),Ce.info(2,`RenderPipeline ${this.id} - async linking complete: ${this.linkStatus}`)();let r=this._getLinkStatus();this._reportLinkStatus(r)}_reportLinkStatus(t){switch(t){case"success":return;default:throw this.vs.compilationStatus==="error"?(this.vs.debugShader(),new Error(`Error during compilation of shader ${this.vs.id}`)):this.fs?.compilationStatus==="error"?(this.fs.debugShader(),new Error(`Error during compilation of shader ${this.fs.id}`)):new Error(`Error during ${t}: ${this.device.gl.getProgramInfoLog(this.handle)}`)}}_getLinkStatus(){let{gl:t}=this.device;return t.getProgramParameter(this.handle,35714)?(t.validateProgram(this.handle),t.getProgramParameter(this.handle,35715)?(this.linkStatus="success","success"):(this.linkStatus="error","validation")):(this.linkStatus="error","linking")}async _waitForLinkComplete(){let t=async s=>await new Promise(n=>setTimeout(n,s));if(!this.device.features.has("compilation-status-async-webgl")){await t(10);return}let{gl:i}=this.device;for(;;){if(i.getProgramParameter(this.handle,37297))return;await t(10)}}_areTexturesRenderable(){let t=!0;for(let[,r]of Object.entries(this.bindings))r instanceof cc&&(r.update(),t=t&&r.loaded);return t}_applyBindings(){if(this.linkStatus!=="success")return;let{gl:t}=this.device;t.useProgram(this.handle);let r=0,i=0;for(let s of this.shaderLayout.bindings){let n=this.bindings[s.name]||this.bindings[s.name.replace(/Uniforms$/,"")];if(!n)throw new Error(`No value for binding ${s.name} in ${this.id}`);switch(s.type){case"uniform":let{name:o}=s,c=t.getUniformBlockIndex(this.handle,o);if(c===4294967295)throw new Error(`Invalid uniform block name ${o}`);t.uniformBlockBinding(this.handle,i,c),n instanceof Ol?t.bindBufferBase(35345,i,n.handle):t.bindBufferRange(35345,i,n.buffer.handle,n.offset||0,n.size||n.buffer.byteLength-n.offset),i+=1;break;case"texture":if(!(n instanceof Uh||n instanceof cc||n instanceof Qf))throw new Error("texture");let f;if(n instanceof Uh)f=n.texture;else if(n instanceof cc)f=n;else if(n instanceof Qf&&n.colorAttachments[0]instanceof Uh)Ce.warn("Passing framebuffer in texture binding may be deprecated. Use fbo.colorAttachments[0] instead")(),f=n.colorAttachments[0].texture;else throw new Error("No texture");t.activeTexture(33984+r),t.bindTexture(f.target,f.handle),r+=1;break;case"sampler":break;case"storage":case"read-only-storage":throw new Error(`binding type '${s.type}' not supported in WebGL`)}}}_applyUniforms(){for(let t of this.shaderLayout.uniforms||[]){let{name:r,location:i,type:s,textureUnit:n}=t,o=this.uniforms[r]??n;o!==void 0&&b$(this.device.gl,i,s,o)}}};var TS=class extends Zb{device;commands=[];constructor(t){super(t,{}),this.device=t}submitCommands(t=this.commands){for(let r of t)switch(r.name){case"copy-buffer-to-buffer":dmt(this.device,r.options);break;case"copy-buffer-to-texture":Amt(this.device,r.options);break;case"copy-texture-to-buffer":mmt(this.device,r.options);break;case"copy-texture-to-texture":gmt(this.device,r.options);break}}};function dmt(e,t){let r=t.source,i=t.destination;e.gl.bindBuffer(36662,r.handle),e.gl.bindBuffer(36663,i.handle),e.gl.copyBufferSubData(36662,36663,t.sourceOffset??0,t.destinationOffset??0,t.size),e.gl.bindBuffer(36662,null),e.gl.bindBuffer(36663,null)}function Amt(e,t){throw new Error("Not implemented")}function mmt(e,t){let{source:r,mipLevel:i=0,aspect:s="all",width:n=t.source.width,height:o=t.source.height,depthOrArrayLayers:c=0,origin:f=[0,0],destination:p,byteOffset:x=0,bytesPerRow:E,rowsPerImage:T}=t;if(s!=="all")throw new Error("not supported");if(i!==0||c!==0||E||T)throw new Error("not implemented");let{framebuffer:D,destroyFramebuffer:N}=S$(r),z;try{let U=p,H=n||D.width,G=o||D.height,Z=By(D.texture.props.format),Y=Z.dataFormat,st=Z.type;e.gl.bindBuffer(35051,U.handle),z=e.gl.bindFramebuffer(36160,D.handle),e.gl.readPixels(f[0],f[1],H,G,Y,st,x)}finally{e.gl.bindBuffer(35051,null),z!==void 0&&e.gl.bindFramebuffer(36160,z),N&&D.destroy()}}function gmt(e,t){let{source:r,destinationMipLevel:i=0,origin:s=[0,0],destinationOrigin:n=[0,0],destination:o}=t,{width:c=t.destination.width,height:f=t.destination.height}=t,{framebuffer:p,destroyFramebuffer:x}=S$(r),[E,T]=s,[D,N,z]=n,U=e.gl.bindFramebuffer(36160,p.handle),H=null,G;if(o instanceof cc)H=o,c=Number.isFinite(c)?c:H.width,f=Number.isFinite(f)?f:H.height,H.bind(0),G=H.target;else throw new Error("invalid destination");switch(G){case 3553:case 34067:e.gl.copyTexSubImage2D(G,i,D,N,E,T,c,f);break;case 35866:case 32879:e.gl.copyTexSubImage3D(G,i,D,N,z,E,T,c,f);break;default:}H&&H.unbind(),e.gl.bindFramebuffer(36160,U),x&&p.destroy()}function S$(e){if(e instanceof Bo){let{width:t,height:r,id:i}=e;return{framebuffer:e.device.createFramebuffer({id:`framebuffer-for-${i}`,width:t,height:r,colorAttachments:[e]}),destroyFramebuffer:!0}}return{framebuffer:e,destroyFramebuffer:!1}}var SS=class extends Xb{device;commandBuffer;constructor(t,r){super(t,r),this.device=t,this.commandBuffer=new TS(t)}destroy(){}finish(){this.commandBuffer.submitCommands()}copyBufferToBuffer(t){this.commandBuffer.commands.push({name:"copy-buffer-to-buffer",options:t})}copyBufferToTexture(t){this.commandBuffer.commands.push({name:"copy-buffer-to-texture",options:t})}copyTextureToBuffer(t){this.commandBuffer.commands.push({name:"copy-texture-to-buffer",options:t})}copyTextureToTexture(t){this.commandBuffer.commands.push({name:"copy-texture-to-texture",options:t})}pushDebugGroup(t){}popDebugGroup(){}insertDebugMarker(t){}resolveQuerySet(t,r,i){}};var ES=class e extends Gb{get[Symbol.toStringTag](){return"VertexArray"}device;handle;buffer=null;bufferValue=null;static isConstantAttributeZeroSupported(t){return gP()==="Chrome"}constructor(t,r){super(t,r),this.device=t,this.handle=this.device.gl.createVertexArray()}destroy(){super.destroy(),this.buffer&&this.buffer?.destroy(),this.handle&&(this.device.gl.deleteVertexArray(this.handle),this.handle=void 0)}setIndexBuffer(t){let r=t;if(r&&r.glTarget!==34963)throw new Error("Use .setBuffer()");this.device.gl.bindVertexArray(this.handle),this.device.gl.bindBuffer(34963,r?r.handle:null),this.indexBuffer=r,this.device.gl.bindVertexArray(null)}setBuffer(t,r){let i=r;if(i.glTarget===34963)throw new Error("Use .setIndexBuffer()");let{size:s,type:n,stride:o,offset:c,normalized:f,integer:p,divisor:x}=this._getAccessor(t);this.device.gl.bindVertexArray(this.handle),this.device.gl.bindBuffer(34962,i.handle),p?this.device.gl.vertexAttribIPointer(t,s,n,o,c):this.device.gl.vertexAttribPointer(t,s,n,f,o,c),this.device.gl.bindBuffer(34962,null),this.device.gl.enableVertexAttribArray(t),this.device.gl.vertexAttribDivisor(t,x||0),this.attributes[t]=i,this.device.gl.bindVertexArray(null)}setConstantWebGL(t,r){this._enable(t,!1),this.attributes[t]=r}bindBeforeRender(){this.device.gl.bindVertexArray(this.handle),this._applyConstantAttributes()}unbindAfterRender(){this.device.gl.bindVertexArray(null)}_applyConstantAttributes(){for(let t=0;t<this.maxVertexAttributes;++t){let r=this.attributes[t];ArrayBuffer.isView(r)&&this.device.setConstantAttributeWebGL(t,r)}}_getAccessor(t){let r=this.attributeInfos[t];if(!r)throw new Error(`Unknown attribute location ${t}`);let i=lS(r.bufferDataType);return{size:r.bufferComponents,type:i,stride:r.byteStride,offset:r.byteOffset,normalized:r.normalized,integer:r.integer,divisor:r.stepMode==="instance"?1:0}}_enable(t,r=!0){let s=e.isConstantAttributeZeroSupported(this.device)||t!==0;(r||s)&&(t=Number(t),this.device.gl.bindVertexArray(this.handle),r?this.device.gl.enableVertexAttribArray(t):this.device.gl.disableVertexAttribArray(t),this.device.gl.bindVertexArray(null))}getConstantBuffer(t,r){let i=_mt(r),s=i.byteLength*t,n=i.length*t;if(this.buffer&&s!==this.buffer.byteLength)throw new Error(`Buffer size is immutable, byte length ${s} !== ${this.buffer.byteLength}.`);let o=!this.buffer;if(this.buffer=this.buffer||this.device.createBuffer({byteLength:s}),o=o||!ymt(i,this.bufferValue),o){let c=hR(r.constructor,n);fR({target:c,source:i,start:0,count:n}),this.buffer.write(c),this.bufferValue=r}return this.buffer}};function _mt(e){return Array.isArray(e)?new Float32Array(e):e}function ymt(e,t){if(!e||!t||e.length!==t.length||e.constructor!==t.constructor)return!1;for(let r=0;r<e.length;++r)if(e[r]!==t[r])return!1;return!0}var IS=class extends Qb{device;gl;handle;layout;buffers={};unusedBuffers={};bindOnUse=!0;_bound=!1;constructor(t,r){super(t,r),this.device=t,this.gl=t.gl,this.handle=this.props.handle||this.gl.createTransformFeedback(),this.layout=this.props.layout,r.buffers&&this.setBuffers(r.buffers),Object.seal(this)}destroy(){this.gl.deleteTransformFeedback(this.handle),super.destroy()}begin(t="point-list"){this.gl.bindTransformFeedback(36386,this.handle),this.bindOnUse&&this._bindBuffers(),this.gl.beginTransformFeedback(w$(t))}end(){this.gl.endTransformFeedback(),this.bindOnUse&&this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null)}setBuffers(t){this.buffers={},this.unusedBuffers={},this.bind(()=>{for(let r in t)this.setBuffer(r,t[r])})}setBuffer(t,r){let i=this._getVaryingIndex(t),{buffer:s,byteLength:n,byteOffset:o}=this._getBufferRange(r);if(i<0){this.unusedBuffers[t]=s,Ce.warn(`${this.id} unusedBuffers varying buffer ${t}`)();return}this.buffers[i]={buffer:s,byteLength:n,byteOffset:o},this.bindOnUse||this._bindBuffer(i,s,o,n)}getBuffer(t){if(E$(t))return this.buffers[t]||null;let r=this._getVaryingIndex(t);return r>=0?this.buffers[r]:null}bind(t=this.handle){if(typeof t!="function")return this.gl.bindTransformFeedback(36386,t),this;let r;return this._bound?r=t():(this.gl.bindTransformFeedback(36386,this.handle),this._bound=!0,r=t(),this._bound=!1,this.gl.bindTransformFeedback(36386,null)),r}unbind(){this.bind(null)}_getBufferRange(t){if(t instanceof Ol)return{buffer:t,byteOffset:0,byteLength:t.byteLength};let{buffer:r,byteOffset:i=0,byteLength:s=t.buffer.byteLength}=t;return{buffer:r,byteOffset:i,byteLength:s}}_getVaryingIndex(t){if(E$(t))return Number(t);for(let r of this.layout.varyings)if(t===r.name)return r.location;return-1}_bindBuffers(){for(let t in this.buffers){let{buffer:r,byteLength:i,byteOffset:s}=this._getBufferRange(this.buffers[t]);this._bindBuffer(Number(t),r,s,i)}}_unbindBuffers(){for(let t in this.buffers)this.gl.bindBufferBase(35982,Number(t),null)}_bindBuffer(t,r,i=0,s){let n=r&&r.handle;!n||s===void 0?this.gl.bindBufferBase(35982,t,n):this.gl.bindBufferRange(35982,t,n,i,s)}};function E$(e){return typeof e=="number"?Number.isInteger(e):/^\d+$/.test(e)}var MS=class extends Kb{device;handle;target=null;_queryPending=!1;_pollingPromise=null;get[Symbol.toStringTag](){return"Query"}constructor(t,r){if(super(t,r),this.device=t,r.count>1)throw new Error("WebGL QuerySet can only have one value");this.handle=this.device.gl.createQuery(),Object.seal(this)}destroy(){this.device.gl.deleteQuery(this.handle)}beginTimestampQuery(){return this._begin(35007)}endTimestampQuery(){this._end()}beginOcclusionQuery(t){return this._begin(t?.conservative?36202:35887)}endOcclusionQuery(){this._end()}beginTransformFeedbackQuery(){return this._begin(35976)}endTransformFeedbackQuery(){this._end()}async resolveQuery(){return[await this.pollQuery()]}_begin(t){this._queryPending||(this.target=t,this.device.gl.beginQuery(this.target,this.handle))}_end(){this._queryPending||this.target&&(this.device.gl.endQuery(this.target),this.target=null,this._queryPending=!0)}isResultAvailable(){if(!this._queryPending)return!1;let t=this.device.gl.getQueryParameter(this.handle,34919);return t&&(this._queryPending=!1),t}isTimerDisjoint(){return this.device.gl.getParameter(36795)}getResult(){return this.device.gl.getQueryParameter(this.handle,34918)}getTimerMilliseconds(){return this.getResult()/1e6}pollQuery(t=Number.POSITIVE_INFINITY){if(this._pollingPromise)return this._pollingPromise;let r=0;return this._pollingPromise=new Promise((i,s)=>{let n=()=>{this.isResultAvailable()?(i(this.getResult()),this._pollingPromise=null):r++>t?(s("Timed out"),this._pollingPromise=null):requestAnimationFrame(n)};requestAnimationFrame(n)}),this._pollingPromise}};function A7(e){switch(e){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return Zi(!1),0}}function I$(e){switch(e){case 5121:return 1;case 33635:case 32819:case 32820:return 2;case 5126:return 4;default:return Zi(!1),0}}function M$(e,t){let{sourceX:r=0,sourceY:i=0,sourceFormat:s=6408,sourceAttachment:n=36064}=t||{},{target:o=null,sourceWidth:c,sourceHeight:f,sourceType:p}=t||{},{framebuffer:x,deleteFramebuffer:E}=P$(e);Zi(x);let{gl:T,handle:D}=x;c=c||x.width,f=f||x.height;let N=n-36064;p=p||x.colorAttachments[N]?.texture?.type||5121,o=bmt(o,p,s,c,f),p=p||m$(o);let z=T.bindFramebuffer(36160,D);return T.readPixels(r,i,c,f,s,p,o),T.bindFramebuffer(36160,z||null),E&&x.destroy(),o}function C$(e,t){let{target:r,sourceX:i=0,sourceY:s=0,sourceFormat:n=6408,targetByteOffset:o=0}=t||{},{sourceWidth:c,sourceHeight:f,sourceType:p}=t||{},{framebuffer:x,deleteFramebuffer:E}=P$(e);Zi(x),c=c||x.width,f=f||x.height;let T=x;p=p||5121;let D=r;if(!D){let z=A7(n),U=I$(p),H=o+c*f*z*U;D=T.device.createBuffer({byteLength:H})}let N=e.device.createCommandEncoder();return N.copyTextureToBuffer({source:e,width:c,height:f,origin:[i,s],destination:D,byteOffset:o}),N.destroy(),E&&x.destroy(),D}function P$(e){return e instanceof wg?{framebuffer:e,deleteFramebuffer:!1}:{framebuffer:xmt(e),deleteFramebuffer:!0}}function xmt(e,t){let{device:r,width:i,height:s,id:n}=e;return r.createFramebuffer({...t,id:`framebuffer-for-${n}`,width:i,height:s,colorAttachments:[e]})}function bmt(e,t,r,i,s){if(e)return e;t=t||5121;let n=zv(t,{clamped:!1}),o=A7(r);return new n(i*s*o)}var vmt=256,wmt=1024,Tmt=16384;var Smt="clear: bad arguments";function R$(e,t){let{framebuffer:r=null,color:i=null,depth:s=null,stencil:n=null}=t||{},o={};r&&(o.framebuffer=r);let c=0;i&&(c|=Tmt,i!==!0&&(o.clearColor=i)),s&&(c|=vmt,s!==!0&&(o.clearDepth=s)),n&&(c|=wmt,s!==!0&&(o.clearStencil=s)),Zi(c!==0,Smt);let f=e.gl;Lu(f,o,()=>{f.clear(c)})}var Uv=1,zg=class e extends md{static type="webgl";type="webgl";handle;features;limits;info;canvasContext;lost;_resolveContextLost;static isSupported(){return typeof WebGL2RenderingContext<"u"}static attach(t){if(t instanceof e)return t;if(t?.device instanceof md)return t.device;if(!Emt(t))throw new Error("Invalid WebGL2RenderingContext");return new e({gl:t})}static async create(t={}){Ce.groupCollapsed(Uv,"WebGLDevice created")();let r=[];t.debug&&r.push(f$()),t.spector&&r.push(c$()),typeof t.canvas=="string"&&r.push(yg.pageLoaded);let i=await Promise.allSettled(r);for(let o of i)o.status==="rejected"&&Ce.error(`Failed to initialize debug libraries ${o.reason}`)();if(Ce.probe(Uv+1,"DOM is loaded")(),t.gl?.device)return Ce.warn("reattaching existing device")(),e.attach(t.gl);let s=new e(t),n=`Created ${s.type}${s.debug?" debug":""} context: ${s.info.vendor}, ${s.info.renderer} for canvas: ${s.canvasContext.id}`;return Ce.probe(Uv,n)(),Ce.table(Uv,s.info)(),Ce.groupEnd(Uv)(),s}constructor(t){super({...t,id:t.id||Dl("webgl-device")});let r=t.gl?.device;if(r)throw new Error(`WebGL context already attached to device ${r.id}`);let i=t.gl?.canvas||t.canvas;this.canvasContext=new yS(this,{...t,canvas:i}),this.lost=new Promise(c=>{this._resolveContextLost=c});let s=t.gl||null;if(s||=Yj(this.canvasContext.canvas,{...t,onContextLost:c=>this._resolveContextLost?.({reason:"destroyed",message:"Entered sleep mode, or too many apps or browser tabs are using the GPU."})}),!s)throw new Error("WebGL context creation failed");this.handle=s,this.gl=s,this.gl.device=this,this.gl._version=2,t.spector&&(this.spectorJS=u$({...this.props,canvas:this.handle.canvas})),this.info=Xj(this.gl,this._extensions),this.limits=new AS(this.gl),this.features=new dS(this.gl,this._extensions,this.props.disabledFeatures),this.props.initalizeFeatures&&this.features.initializeFeatures(),this.canvasContext.resize();let{enable:n=!0,copyState:o=!1}=t;i7(this.gl,{enable:n,copyState:o,log:(...c)=>Ce.log(1,...c)()}),t.debug&&(this.gl=p$(this.gl,{...t,throwOnError:!0}),this.debug=!0,Ce.level=Math.max(Ce.level,1),Ce.warn("WebGL debug mode activated. Performance reduced.")())}destroy(){}get isLost(){return this.gl.isContextLost()}getSize(){return[this.gl.drawingBufferWidth,this.gl.drawingBufferHeight]}isTextureFormatSupported(t){return pS(this.gl,t,this._extensions)}isTextureFormatFilterable(t){return e$(this.gl,t,this._extensions)}isTextureFormatRenderable(t){return r$(this.gl,t,this._extensions)}createCanvasContext(t){throw new Error("WebGL only supports a single canvas")}createBuffer(t){let r=this._getBufferProps(t);return new Ol(this,r)}_createTexture(t){return new cc(this,t)}createExternalTexture(t){throw new Error("createExternalTexture() not implemented")}createSampler(t){return new Lg(this,t)}createShader(t){return new xS(this,t)}createFramebuffer(t){return new Qf(this,t)}createVertexArray(t){return new ES(this,t)}createTransformFeedback(t){return new IS(this,t)}createQuerySet(t){return new MS(this,t)}createRenderPipeline(t){return new wS(this,t)}beginRenderPass(t){return new bS(this,t)}createComputePipeline(t){throw new Error("ComputePipeline not supported in WebGL")}beginComputePass(t){throw new Error("ComputePass not supported in WebGL")}renderPass=null;createCommandEncoder(t){return new SS(this,t)}submit(){this.renderPass?.end(),this.renderPass=null}readPixelsToArrayWebGL(t,r){return M$(t,r)}readPixelsToBufferWebGL(t,r){return C$(t,r)}setParametersWebGL(t){zh(this.gl,t)}getParametersWebGL(t){return aS(this.gl,t)}withParametersWebGL(t,r){return Lu(this.gl,t,r)}clearWebGL(t){R$(this,t)}resetWebGL(){Ce.warn("WebGLDevice.resetWebGL is deprecated, use only for debugging")(),Hj(this.gl)}gl;debug=!1;_canvasSizeInfo={clientWidth:0,clientHeight:0,devicePixelRatio:1};_extensions={};_polyfilled=!1;spectorJS;loseDevice(){let t=!1,i=this.getExtension("WEBGL_lose_context").WEBGL_lose_context;return i&&(t=!0,i.loseContext()),this._resolveContextLost?.({reason:"destroyed",message:"Application triggered context loss"}),t}pushState(){wA(this.gl)}popState(){Md(this.gl)}setSpectorMetadata(t,r){t.__SPECTOR_Metadata=r}getGLKey(t,r){r=r||this.gl2||this.gl;let i=Number(t);for(let s in r)if(r[s]===i)return`GL.${s}`;return String(t)}_constants;setConstantAttributeWebGL(t,r){let i=this.limits.maxVertexAttributes;this._constants=this._constants||new Array(i).fill(null);let s=this._constants[t];switch(s&&Pmt(s,r)&&Ce.info(1,`setConstantAttributeWebGL(${t}) could have been skipped, value unchanged`)(),this._constants[t]=r,r.constructor){case Float32Array:Imt(this,t,r);break;case Int32Array:Mmt(this,t,r);break;case Uint32Array:Cmt(this,t,r);break;default:Zi(!1)}}getExtension(t){return Fu(this.gl,t,this._extensions),this._extensions}};function Emt(e){return typeof WebGL2RenderingContext<"u"&&e instanceof WebGL2RenderingContext?!0:!!(e&&Number.isFinite(e._version))}function Imt(e,t,r){switch(r.length){case 1:e.gl.vertexAttrib1fv(t,r);break;case 2:e.gl.vertexAttrib2fv(t,r);break;case 3:e.gl.vertexAttrib3fv(t,r);break;case 4:e.gl.vertexAttrib4fv(t,r);break;default:Zi(!1)}}function Mmt(e,t,r){e.gl.vertexAttribI4iv(t,r)}function Cmt(e,t,r){e.gl.vertexAttribI4uiv(t,r)}function Pmt(e,t){if(!e||!t||e.length!==t.length||e.constructor!==t.constructor)return!1;for(let r=0;r<e.length;++r)if(e[r]!==t[r])return!1;return!0}var Ug=mP(k$());var Rmt={mousedown:1,mousemove:2,mouseup:4};function kmt(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return!0;return!1}function D$(e){let t=e.prototype.handler;e.prototype.handler=function(i){let s=this.store;i.button>0&&i.type==="pointerdown"&&(kmt(s,n=>n.pointerId===i.pointerId)||s.push(i)),t.call(this,i)}}function B$(e){e.prototype.handler=function(r){let i=Rmt[r.type];i&1&&r.button>=0&&(this.pressed=!0),i&2&&r.buttons===0&&(i=4),this.pressed&&(i&4&&(this.pressed=!1),this.callback(this.manager,i,{pointers:[r],changedPointers:[r],pointerType:"mouse",srcEvent:r}))}}D$(Ug.PointerEventInput);B$(Ug.MouseInput);var O$=Ug.Manager,Vh=Ug;var jh=class{constructor(t,r,i){this.element=t,this.callback=r,this.options={enable:!0,...i}}};var N$=Vh?[[Vh.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[Vh.Rotate,{enable:!1}],[Vh.Pinch,{enable:!1}],[Vh.Swipe,{enable:!1}],[Vh.Pan,{threshold:0,enable:!1}],[Vh.Press,{enable:!1}],[Vh.Tap,{event:"doubletap",taps:2,enable:!1}],[Vh.Tap,{event:"anytap",enable:!1}],[Vh.Tap,{enable:!1}]]:null,m7={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},F$={doubletap:["tap"]},L$={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},Oy={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},z$={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},g7={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"};var U$=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",Vg=typeof window<"u"?window:global;var PS=!1;try{let e={get passive(){return PS=!0,!0}};Vg.addEventListener("test",null,e),Vg.removeEventListener("test",null)}catch{PS=!1}var Dmt=U$.indexOf("firefox")!==-1,{WHEEL_EVENTS:Bmt}=Oy,V$="wheel",j$=4.000244140625,Omt=40,Nmt=.25,Vv=class extends jh{constructor(t,r,i){super(t,r,i),this.handleEvent=s=>{if(!this.options.enable)return;let n=s.deltaY;Vg.WheelEvent&&(Dmt&&s.deltaMode===Vg.WheelEvent.DOM_DELTA_PIXEL&&(n/=Vg.devicePixelRatio),s.deltaMode===Vg.WheelEvent.DOM_DELTA_LINE&&(n*=Omt)),n!==0&&n%j$===0&&(n=Math.floor(n/j$)),s.shiftKey&&n&&(n=n*Nmt),this.callback({type:V$,center:{x:s.clientX,y:s.clientY},delta:-n,srcEvent:s,pointerType:"mouse",target:s.target})},this.events=(this.options.events||[]).concat(Bmt),this.events.forEach(s=>t.addEventListener(s,this.handleEvent,PS?{passive:!1}:!1))}destroy(){this.events.forEach(t=>this.element.removeEventListener(t,this.handleEvent))}enableEventType(t,r){t===V$&&(this.options.enable=r)}};var{MOUSE_EVENTS:Fmt}=Oy,$$="pointermove",H$="pointerover",W$="pointerout",q$="pointerenter",Y$="pointerleave",jv=class extends jh{constructor(t,r,i){super(t,r,i),this.handleEvent=n=>{this.handleOverEvent(n),this.handleOutEvent(n),this.handleEnterEvent(n),this.handleLeaveEvent(n),this.handleMoveEvent(n)},this.pressed=!1;let{enable:s}=this.options;this.enableMoveEvent=s,this.enableLeaveEvent=s,this.enableEnterEvent=s,this.enableOutEvent=s,this.enableOverEvent=s,this.events=(this.options.events||[]).concat(Fmt),this.events.forEach(n=>t.addEventListener(n,this.handleEvent))}destroy(){this.events.forEach(t=>this.element.removeEventListener(t,this.handleEvent))}enableEventType(t,r){t===$$&&(this.enableMoveEvent=r),t===H$&&(this.enableOverEvent=r),t===W$&&(this.enableOutEvent=r),t===q$&&(this.enableEnterEvent=r),t===Y$&&(this.enableLeaveEvent=r)}handleOverEvent(t){this.enableOverEvent&&t.type==="mouseover"&&this._emit(H$,t)}handleOutEvent(t){this.enableOutEvent&&t.type==="mouseout"&&this._emit(W$,t)}handleEnterEvent(t){this.enableEnterEvent&&t.type==="mouseenter"&&this._emit(q$,t)}handleLeaveEvent(t){this.enableLeaveEvent&&t.type==="mouseleave"&&this._emit(Y$,t)}handleMoveEvent(t){if(this.enableMoveEvent)switch(t.type){case"mousedown":t.button>=0&&(this.pressed=!0);break;case"mousemove":t.buttons===0&&(this.pressed=!1),this.pressed||this._emit($$,t);break;case"mouseup":this.pressed=!1;break;default:}}_emit(t,r){this.callback({type:t,center:{x:r.clientX,y:r.clientY},srcEvent:r,pointerType:"mouse",target:r.target})}};var{KEY_EVENTS:Lmt}=Oy,X$="keydown",Z$="keyup",$v=class extends jh{constructor(t,r,i){super(t,r,i),this.handleEvent=s=>{let n=s.target||s.srcElement;n.tagName==="INPUT"&&n.type==="text"||n.tagName==="TEXTAREA"||(this.enableDownEvent&&s.type==="keydown"&&this.callback({type:X$,srcEvent:s,key:s.key,target:s.target}),this.enableUpEvent&&s.type==="keyup"&&this.callback({type:Z$,srcEvent:s,key:s.key,target:s.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=(this.options.events||[]).concat(Lmt),t.tabIndex=this.options.tabIndex||0,t.style.outline="none",this.events.forEach(s=>t.addEventListener(s,this.handleEvent))}destroy(){this.events.forEach(t=>this.element.removeEventListener(t,this.handleEvent))}enableEventType(t,r){t===X$&&(this.enableDownEvent=r),t===Z$&&(this.enableUpEvent=r)}};var G$="contextmenu",Hv=class extends jh{constructor(t,r,i){super(t,r,i),this.handleEvent=s=>{this.options.enable&&this.callback({type:G$,center:{x:s.clientX,y:s.clientY},srcEvent:s,pointerType:"mouse",target:s.target})},t.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(t,r){t===G$&&(this.options.enable=r)}};var zmt={pointerdown:1,pointermove:2,pointerup:4,mousedown:1,mousemove:2,mouseup:4},Umt=0,Vmt=1,jmt=2,$mt=1,Hmt=2,Wmt=4;function Q$(e){let t=zmt[e.srcEvent.type];if(!t)return null;let{buttons:r,button:i}=e.srcEvent,s=!1,n=!1,o=!1;return t===2?(s=!!(r&$mt),n=!!(r&Wmt),o=!!(r&Hmt)):(s=i===Umt,n=i===Vmt,o=i===jmt),{leftButton:s,middleButton:n,rightButton:o}}function K$(e,t){let r=e.center;if(!r)return null;let i=t.getBoundingClientRect(),s=i.width/t.offsetWidth||1,n=i.height/t.offsetHeight||1,o={x:(r.x-i.left-t.clientLeft)/s,y:(r.y-i.top-t.clientTop)/n};return{center:r,offsetCenter:o}}var _7={srcElement:"root",priority:0},Wv=class{constructor(t){this.handleEvent=r=>{if(this.isEmpty())return;let i=this._normalizeEvent(r),s=r.srcEvent.target;for(;s&&s!==i.rootElement;){if(this._emit(i,s),i.handled)return;s=s.parentNode}this._emit(i,"root")},this.eventManager=t,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(t,r,i,s=!1,n=!1){let{handlers:o,handlersByElement:c}=this,f=_7;typeof i=="string"||i&&i.addEventListener?f={..._7,srcElement:i}:i&&(f={..._7,...i});let p=c.get(f.srcElement);p||(p=[],c.set(f.srcElement,p));let x={type:t,handler:r,srcElement:f.srcElement,priority:f.priority};s&&(x.once=!0),n&&(x.passive=!0),o.push(x),this._active=this._active||!x.passive;let E=p.length-1;for(;E>=0&&!(p[E].priority>=x.priority);)E--;p.splice(E+1,0,x)}remove(t,r){let{handlers:i,handlersByElement:s}=this;for(let n=i.length-1;n>=0;n--){let o=i[n];if(o.type===t&&o.handler===r){i.splice(n,1);let c=s.get(o.srcElement);c.splice(c.indexOf(o),1),c.length===0&&s.delete(o.srcElement)}}this._active=i.some(n=>!n.passive)}_emit(t,r){let i=this.handlersByElement.get(r);if(i){let s=!1,n=()=>{t.handled=!0},o=()=>{t.handled=!0,s=!0},c=[];for(let f=0;f<i.length;f++){let{type:p,handler:x,once:E}=i[f];if(x({...t,type:p,stopPropagation:n,stopImmediatePropagation:o}),E&&c.push(i[f]),s)break}for(let f=0;f<c.length;f++){let{type:p,handler:x}=c[f];this.remove(p,x)}}}_normalizeEvent(t){let r=this.eventManager.getElement();return{...t,...Q$(t),...K$(t,r),preventDefault:()=>{t.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:r}}};var qmt={events:null,recognizers:null,recognizerOptions:{},Manager:O$,touchAction:"none",tabIndex:0},Ny=class{constructor(t=null,r){this._onBasicInput=s=>{let{srcEvent:n}=s,o=L$[n.type];o&&this.manager.emit(o,s)},this._onOtherEvent=s=>{this.manager.emit(s.type,s)},this.options={...qmt,...r},this.events=new Map,this.setElement(t);let{events:i}=this.options;i&&this.on(i)}getElement(){return this.element}setElement(t){if(this.element&&this.destroy(),this.element=t,!t)return;let{options:r}=this,i=r.Manager;this.manager=new i(t,{touchAction:r.touchAction,recognizers:r.recognizers||N$}).on("hammer.input",this._onBasicInput),r.recognizers||Object.keys(m7).forEach(s=>{let n=this.manager.get(s);n&&m7[s].forEach(o=>{n.recognizeWith(o)})});for(let s in r.recognizerOptions){let n=this.manager.get(s);if(n){let o=r.recognizerOptions[s];delete o.enable,n.set(o)}}this.wheelInput=new Vv(t,this._onOtherEvent,{enable:!1}),this.moveInput=new jv(t,this._onOtherEvent,{enable:!1}),this.keyInput=new $v(t,this._onOtherEvent,{enable:!1,tabIndex:r.tabIndex}),this.contextmenuInput=new Hv(t,this._onOtherEvent,{enable:!1});for(let[s,n]of this.events)n.isEmpty()||(this._toggleRecognizer(n.recognizerName,!0),this.manager.on(s,n.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(t,r,i){this._addEventHandler(t,r,i,!1)}once(t,r,i){this._addEventHandler(t,r,i,!0)}watch(t,r,i){this._addEventHandler(t,r,i,!1,!0)}off(t,r){this._removeEventHandler(t,r)}_toggleRecognizer(t,r){let{manager:i}=this;if(!i)return;let s=i.get(t);if(s&&s.options.enable!==r){s.set({enable:r});let n=F$[t];n&&!this.options.recognizers&&n.forEach(o=>{let c=i.get(o);r?(c.requireFailure(t),s.dropRequireFailure(o)):c.dropRequireFailure(t)})}this.wheelInput.enableEventType(t,r),this.moveInput.enableEventType(t,r),this.keyInput.enableEventType(t,r),this.contextmenuInput.enableEventType(t,r)}_addEventHandler(t,r,i,s,n){if(typeof t!="string"){i=r;for(let x in t)this._addEventHandler(x,t[x],i,s,n);return}let{manager:o,events:c}=this,f=g7[t]||t,p=c.get(f);p||(p=new Wv(this),c.set(f,p),p.recognizerName=z$[f]||f,o&&o.on(f,p.handleEvent)),p.add(t,r,i,s,n),p.isEmpty()||this._toggleRecognizer(p.recognizerName,!0)}_removeEventHandler(t,r){if(typeof t!="string"){for(let o in t)this._removeEventHandler(o,t[o]);return}let{events:i}=this,s=g7[t]||t,n=i.get(s);if(n&&(n.remove(t,r),n.isEmpty())){let{recognizerName:o}=n,c=!1;for(let f of i.values())if(f.recognizerName===o&&!f.isEmpty()){c=!0;break}c||this._toggleRecognizer(o,!1)}}};function TA(){}var Ymt=({isDragging:e})=>e?"grabbing":"grab",J$={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,parameters:{},parent:null,device:null,deviceProps:{type:"webgl"},gl:null,glOptions:{},canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,widgets:[],onDeviceInitialized:TA,onWebGLInitialized:TA,onResize:TA,onViewStateChange:TA,onInteractionStateChange:TA,onBeforeRender:TA,onAfterRender:TA,onLoad:TA,onError:e=>mi.error(e.message,e.cause)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:Ymt,getTooltip:null,debug:!1,drawPickingColors:!1},Cd=class{static{this.defaultProps=J$}static{this.VERSION=BU}constructor(t){this.width=0,this.height=0,this.userData={},this.device=null,this.canvas=null,this.viewManager=null,this.layerManager=null,this.effectManager=null,this.deckRenderer=null,this.deckPicker=null,this.eventManager=null,this.widgetManager=null,this.tooltip=null,this.animationLoop=null,this.cursorState={isHovering:!1,isDragging:!1},this.stats=new Iu({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this._lastPointerDownInfo=null,this._onPointerMove=i=>{let{_pickRequest:s}=this;if(i.type==="pointerleave")s.x=-1,s.y=-1,s.radius=0;else{if(i.leftButton||i.rightButton)return;{let n=i.offsetCenter;if(!n)return;s.x=n.x,s.y=n.y,s.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:s.x,y:s.y}),s.event=i},this._onEvent=i=>{let s=cv[i.type],n=i.offsetCenter;if(!s||!n||!this.layerManager)return;let o=this.layerManager.getLayers(),c=this.deckPicker.getLastPickedObject({x:n.x,y:n.y,layers:o,viewports:this.getViewports(n)},this._lastPointerDownInfo),{layer:f}=c,p=f&&(f[s.handler]||f.props[s.handler]),x=this.props[s.handler],E=!1;p&&(E=p.call(f,c,i)),E||(x?.(c,i),this.widgetManager.onEvent(c,i))},this._onPointerDown=i=>{let s=i.offsetCenter,n=this._pick("pickObject","pickObject Time",{x:s.x,y:s.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=n.result[0]||n.emptyInfo},this.props={...J$,...t},t=this.props,t.viewState&&t.initialViewState&&mi.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),this.viewState=this.props.initialViewState,t.device?this.device=t.device:t.gl&&(t.gl instanceof WebGLRenderingContext&&mi.error("WebGL1 context not supported.")(),this.device=zg.attach(t.gl));let r=this.device;r||(gd.registerDevices([zg]),r=gd.createDevice({...t.deviceProps,canvas:this._createCanvas(t)})),this.animationLoop=this._createAnimationLoop(r,t),this.setProps(t),t._typedArrayManagerProps&&Nh.setOptions(t._typedArrayManagerProps),this.animationLoop.start()}finalize(){this.animationLoop?.stop(),this.animationLoop?.destroy(),this.animationLoop=null,this._lastPointerDownInfo=null,this.layerManager?.finalize(),this.layerManager=null,this.viewManager?.finalize(),this.viewManager=null,this.effectManager?.finalize(),this.effectManager=null,this.deckRenderer?.finalize(),this.deckRenderer=null,this.deckPicker?.finalize(),this.deckPicker=null,this.eventManager?.destroy(),this.eventManager=null,this.widgetManager?.finalize(),this.widgetManager=null,!this.props.canvas&&!this.props.device&&!this.props.gl&&this.canvas&&(this.canvas.parentElement?.removeChild(this.canvas),this.canvas=null)}setProps(t){this.stats.get("setProps Time").timeStart(),"onLayerHover"in t&&mi.removed("onLayerHover","onHover")(),"onLayerClick"in t&&mi.removed("onLayerClick","onClick")(),t.initialViewState&&!Ba(this.props.initialViewState,t.initialViewState,3)&&(this.viewState=t.initialViewState),Object.assign(this.props,t),this._setCanvasSize(this.props);let r=Object.create(this.props);Object.assign(r,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop?.setProps(r),this.layerManager&&(this.viewManager.setProps(r),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(r),this.effectManager.setProps(r),this.deckRenderer.setProps(r),this.deckPicker.setProps(r),this.widgetManager.setProps(r)),this.stats.get("setProps Time").timeEnd()}needsRedraw(t={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let r=this._needsRedraw;t.clearRedrawFlags&&(this._needsRedraw=!1);let i=this.viewManager.needsRedraw(t),s=this.layerManager.needsRedraw(t),n=this.effectManager.needsRedraw(t),o=this.deckRenderer.needsRedraw(t);return r=r||i||s||n||o,r}redraw(t){if(!this.layerManager)return;let r=this.needsRedraw({clearRedrawFlags:!0});r=t||r,r&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(r):this._drawLayers(r))}get isInitialized(){return this.viewManager!==null}getViews(){return Qn(this.viewManager),this.viewManager.views}getViewports(t){return Qn(this.viewManager),this.viewManager.getViewports(t)}getCanvas(){return this.canvas}pickObject(t){let r=this._pick("pickObject","pickObject Time",t).result;return r.length?r[0]:null}pickMultipleObjects(t){return t.depth=t.depth||10,this._pick("pickObject","pickMultipleObjects Time",t).result}pickObjects(t){return this._pick("pickObjects","pickObjects Time",t)}_addResources(t,r=!1){for(let i in t)this.layerManager.resourceManager.add({resourceId:i,data:t[i],forceUpdate:r})}_removeResources(t){for(let r of t)this.layerManager.resourceManager.remove(r)}_addDefaultEffect(t){this.effectManager.addDefaultEffect(t)}_addDefaultShaderModule(t){this.layerManager.addDefaultShaderModule(t)}_removeDefaultShaderModule(t){this.layerManager?.removeDefaultShaderModule(t)}_pick(t,r,i){Qn(this.deckPicker);let{stats:s}=this;s.get("Pick Count").incrementCount(),s.get(r).timeStart();let n=this.deckPicker[t]({layers:this.layerManager.getLayers(i),views:this.viewManager.getViews(),viewports:this.getViewports(i),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...i});return s.get(r).timeEnd(),n}_createCanvas(t){let r=t.canvas;return typeof r=="string"&&(r=document.getElementById(r),Qn(r)),r||(r=document.createElement("canvas"),r.id=t.id||"deckgl-overlay",(t.parent||document.body).appendChild(r)),Object.assign(r.style,t.style),r}_setCanvasSize(t){if(!this.canvas)return;let{width:r,height:i}=t;if(r||r===0){let s=Number.isFinite(r)?`${r}px`:r;this.canvas.style.width=s}if(i||i===0){let s=Number.isFinite(i)?`${i}px`:i;this.canvas.style.position=t.style?.position||"absolute",this.canvas.style.height=s}}_updateCanvasSize(){let{canvas:t}=this;if(!t)return;let r=t.clientWidth??t.width,i=t.clientHeight??t.height;(r!==this.width||i!==this.height)&&(this.width=r,this.height=i,this.viewManager?.setProps({width:r,height:i}),this.layerManager?.activateViewport(this.getViewports()[0]),this.props.onResize({width:r,height:i}))}_createAnimationLoop(t,r){let{gl:i,onError:s,useDevicePixels:n}=r;return new gv({device:t,useDevicePixels:n,autoResizeDrawingBuffer:!i,autoResizeViewport:!1,onInitialize:o=>this._setDevice(o.device),onRender:this._onRenderFrame.bind(this),onError:s})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let{views:t}=this.props,r=Array.isArray(t)?t:t?[t]:[new bA({id:"default-view"})];return r.length&&this.props.controller&&(r[0].props.controller=this.props.controller),r}_onContextLost(){let{onError:t}=this.props;this.animationLoop&&t&&t(new Error("WebGL context is lost"))}_pickAndCallback(){let{_pickRequest:t}=this;if(t.event){let{result:r,emptyInfo:i}=this._pick("pickObject","pickObject Time",t);this.cursorState.isHovering=r.length>0;let s=i,n=!1;for(let o of r)s=o,n=o.layer?.onHover(o,t.event)||n;n||(this.props.onHover?.(s,t.event),this.widgetManager.onHover(s,t.event)),t.event=null}}_updateCursor(){let t=this.props.parent||this.canvas;t&&(t.style.cursor=this.props.getCursor(this.cursorState))}_setDevice(t){if(this.device=t,!this.animationLoop)return;this.canvas||(this.canvas=this.device.canvasContext?.canvas),this.device.setParametersWebGL({blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onDeviceInitialized(this.device),this.device instanceof zg&&this.props.onWebGLInitialized(this.device.gl);let r=new kg;r.play(),this.animationLoop.attachTimeline(r),this.eventManager=new Ny(this.props.parent||this.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(let s in cv)this.eventManager.on(s,this._onEvent);this.viewManager=new bv({timeline:r,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});let i=this.viewManager.getViewports()[0];this.layerManager=new xv(this.device,{deck:this,stats:this.stats,viewport:i,timeline:r}),this.effectManager=new Mv({deck:this,device:this.device}),this.deckRenderer=new Pv(this.device),this.deckPicker=new Rv(this.device),this.widgetManager=new oS({deck:this,parentElement:this.canvas?.parentElement}),this.widgetManager.addDefault(new kv),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(t,r){let{device:i,gl:s}=this.layerManager.context;this.props.onBeforeRender({device:i,gl:s});let n={target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",effects:this.effectManager.getEffects(),...r};this.deckRenderer?.renderLayers(n),n.pass==="screen"&&this.widgetManager.onRedraw({viewports:n.viewports,layers:n.layers}),this.props.onAfterRender({device:i,gl:s})}_onRenderFrame(){this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),mi.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(t){let r=this.props.onViewStateChange(t)||t.viewState;this.viewState&&(this.viewState={...this.viewState,[t.viewId]:r},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(t){this.cursorState.isDragging=t.isDragging||!1,this.props.onInteractionStateChange(t)}_getFrameStats(){let{stats:t}=this;t.get("frameRate").timeEnd(),t.get("frameRate").timeStart();let r=this.animationLoop.stats;t.get("GPU Time").addTime(r.get("GPU Time").lastTiming),t.get("CPU Time").addTime(r.get("CPU Time").lastTiming)}_getMetrics(){let{metrics:t,stats:r}=this;t.fps=r.get("frameRate").getHz(),t.setPropsTime=r.get("setProps Time").time,t.updateAttributesTime=r.get("Update Attributes").time,t.framesRedrawn=r.get("Redraw Count").count,t.pickTime=r.get("pickObject Time").time+r.get("pickMultipleObjects Time").time+r.get("pickObjects Time").time,t.pickCount=r.get("Pick Count").count,t.gpuTime=r.get("GPU Time").time,t.cpuTime=r.get("CPU Time").time,t.gpuTimePerFrame=r.get("GPU Time").getAverageTime(),t.cpuTimePerFrame=r.get("CPU Time").getAverageTime();let i=gd.stats.get("Memory Usage");t.bufferMemory=i.get("Buffer Memory").count,t.textureMemory=i.get("Texture Memory").count,t.renderbufferMemory=i.get("Renderbuffer Memory").count,t.gpuMemory=i.get("GPU Memory").count}};function tH(e){switch(e){case"float64":return Float64Array;case"uint8":case"unorm8":return Uint8ClampedArray;default:return tv(e)}}var eH=y5;function qv(e,t){return{attribute:e,format:t.size>1?`${t.type}x${t.size}`:t.type,byteOffset:t.offset||0}}function SA(e){return e.stride||e.size*e.bytesPerElement}function rH(e,t){return e.type===t.type&&e.size===t.size&&SA(e)===SA(t)&&(e.offset||0)===(t.offset||0)}function y7(e,t){t.offset&&mi.removed("shaderAttribute.offset","vertexOffset, elementOffset")();let r=SA(e),i=t.vertexOffset!==void 0?t.vertexOffset:e.vertexOffset||0,s=t.elementOffset||0,n=i*r+s*e.bytesPerElement+(e.offset||0);return{...t,offset:n,stride:r}}function Xmt(e,t){let r=y7(e,t);return{high:r,low:{...r,offset:r.offset+e.size*4}}}var Yv=class{constructor(t,r,i){this._buffer=null,this.device=t,this.id=r.id||"",this.size=r.size||1;let s=r.logicalType||r.type,n=s==="float64",{defaultValue:o}=r;o=Number.isFinite(o)?[o]:o||new Array(this.size).fill(0);let c;n?c="float32":!s&&r.isIndexed?c="uint32":c=s||"float32";let f=tH(s||c);this.doublePrecision=n,n&&r.fp64===!1&&(f=Float32Array),this.value=null,this.settings={...r,defaultType:f,defaultValue:o,logicalType:s,type:c,normalized:c.includes("norm"),size:this.size,bytesPerElement:f.BYTES_PER_ELEMENT},this.state={...i,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1}}get isConstant(){return this.state.constant}get buffer(){return this._buffer}get byteOffset(){let t=this.getAccessor();return t.vertexOffset?t.vertexOffset*SA(t):0}get numInstances(){return this.state.numInstances}set numInstances(t){this.state.numInstances=t}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),Nh.release(this.state.allocatedValue)}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(t=this.id,r=null){let i={};if(this.state.constant){let s=this.value;if(r){let n=y7(this.getAccessor(),r),o=n.offset/s.BYTES_PER_ELEMENT,c=n.size||this.size;i[t]=s.subarray(o,o+c)}else i[t]=s}else i[t]=this.getBuffer();return this.doublePrecision&&(this.value instanceof Float64Array?i[`${t}64Low`]=i[t]:i[`${t}64Low`]=new Float32Array(this.size)),i}_getBufferLayout(t=this.id,r=null){let i=this.getAccessor(),s=[],n={name:this.id,byteStride:SA(i),attributes:s};if(this.doublePrecision){let o=Xmt(i,r||{});s.push(qv(t,{...i,...o.high}),qv(`${t}64Low`,{...i,...o.low}))}else if(r){let o=y7(i,r);s.push(qv(t,{...i,...o}))}else s.push(qv(t,i));return n}setAccessor(t){this.state.bufferAccessor=t}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let t=null;if(this.state.constant&&this.value){let r=Array.from(this.value);t=[r,r]}else{let{value:r,numInstances:i,size:s}=this,n=i*s;if(r&&n&&r.length>=n){let o=new Array(s).fill(1/0),c=new Array(s).fill(-1/0);for(let f=0;f<n;)for(let p=0;p<s;p++){let x=r[f++];x<o[p]&&(o[p]=x),x>c[p]&&(c[p]=x)}t=[o,c]}}return this.state.bounds=t,t}setData(t){let{state:r}=this,i;ArrayBuffer.isView(t)?i={value:t}:t instanceof Tn?i={buffer:t}:i=t;let s={...this.settings,...i};if(ArrayBuffer.isView(i.value)){if(!i.type)if(this.doublePrecision&&i.value instanceof Float64Array)s.type="float32";else{let o=eH(i.value);s.type=s.normalized?o.replace("int","norm"):o}s.bytesPerElement=i.value.BYTES_PER_ELEMENT,s.stride=SA(s)}if(r.bounds=null,i.constant){let n=i.value;if(n=this._normalizeValue(n,[],0),this.settings.normalized&&(n=this.normalizeConstant(n)),!(!r.constant||!this._areValuesEqual(n,this.value)))return!1;r.externalBuffer=null,r.constant=!0,this.value=ArrayBuffer.isView(n)?n:new Float32Array(n)}else if(i.buffer){let n=i.buffer;r.externalBuffer=n,r.constant=!1,this.value=i.value||null}else if(i.value){this._checkExternalBuffer(i);let n=i.value;r.externalBuffer=null,r.constant=!1,this.value=n;let{buffer:o}=this,c=SA(s),f=(s.vertexOffset||0)*c;if(this.doublePrecision&&n instanceof Float64Array&&(n=J5(n,s)),this.settings.isIndexed){let x=this.settings.defaultType;n.constructor!==x&&(n=new x(n))}let p=n.byteLength+f+c*2;(!o||o.byteLength<p)&&(o=this._createBuffer(p)),o.write(n,f)}return this.setAccessor(s),!0}updateSubBuffer(t={}){this.state.bounds=null;let r=this.value,{startOffset:i=0,endOffset:s}=t;this.buffer.write(this.doublePrecision&&r instanceof Float64Array?J5(r,{size:this.size,startIndex:i,endIndex:s}):r.subarray(i,s),i*r.BYTES_PER_ELEMENT+this.byteOffset)}allocate(t,r=!1){let{state:i}=this,s=i.allocatedValue,n=Nh.allocate(s,t+1,{size:this.size,type:this.settings.defaultType,copy:r});this.value=n;let{byteOffset:o}=this,{buffer:c}=this;return(!c||c.byteLength<n.byteLength+o)&&(c=this._createBuffer(n.byteLength+o),r&&s&&c.write(s instanceof Float64Array?J5(s,this):s,o)),i.allocatedValue=n,i.constant=!1,i.externalBuffer=null,this.setAccessor(this.settings),!0}_checkExternalBuffer(t){let{value:r}=t;if(!ArrayBuffer.isView(r))throw new Error(`Attribute ${this.id} value is not TypedArray`);let i=this.settings.defaultType,s=!1;if(this.doublePrecision&&(s=r.BYTES_PER_ELEMENT<4),s)throw new Error(`Attribute ${this.id} does not support ${r.constructor.name}`);!(r instanceof i)&&this.settings.normalized&&!("normalized"in t)&&mi.warn(`Attribute ${this.id} is normalized`)()}normalizeConstant(t){switch(this.settings.type){case"snorm8":return new Float32Array(t).map(r=>(r+128)/255*2-1);case"snorm16":return new Float32Array(t).map(r=>(r+32768)/65535*2-1);case"unorm8":return new Float32Array(t).map(r=>r/255);case"unorm16":return new Float32Array(t).map(r=>r/65535);default:return t}}_normalizeValue(t,r,i){let{defaultValue:s,size:n}=this.settings;if(Number.isFinite(t))return r[i]=t,r;if(!t){let o=n;for(;--o>=0;)r[i+o]=s[o];return r}switch(n){case 4:r[i+3]=Number.isFinite(t[3])?t[3]:s[3];case 3:r[i+2]=Number.isFinite(t[2])?t[2]:s[2];case 2:r[i+1]=Number.isFinite(t[1])?t[1]:s[1];case 1:r[i+0]=Number.isFinite(t[0])?t[0]:s[0];break;default:let o=n;for(;--o>=0;)r[i+o]=Number.isFinite(t[o])?t[o]:s[o]}return r}_areValuesEqual(t,r){if(!t||!r)return!1;let{size:i}=this;for(let s=0;s<i;s++)if(t[s]!==r[s])return!1;return!0}_createBuffer(t){this._buffer&&this._buffer.destroy();let{isIndexed:r,type:i}=this.settings;return this._buffer=this.device.createBuffer({...this._buffer?.props,id:this.id,usage:r?Tn.INDEX:Tn.VERTEX,indexType:r?i:void 0,byteLength:t}),this._buffer}};var iH=[],nH=[];function Pd(e,t=0,r=1/0){let i=iH,s={index:-1,data:e,target:[]};return e?typeof e[Symbol.iterator]=="function"?i=e:e.length>0&&(nH.length=e.length,i=nH):i=iH,(t>0||Number.isFinite(r))&&(i=(Array.isArray(i)?i:Array.from(i)).slice(t,r),s.index=t-1),{iterable:i,objectInfo:s}}function RS(e){return e&&e[Symbol.asyncIterator]}function kS(e,t){let{size:r,stride:i,offset:s,startIndices:n,nested:o}=t,c=e.BYTES_PER_ELEMENT,f=i?i/c:r,p=s?s/c:0,x=Math.floor((e.length-p)/f);return(E,{index:T,target:D})=>{if(!n){let H=T*f+p;for(let G=0;G<r;G++)D[G]=e[H+G];return D}let N=n[T],z=n[T+1]||x,U;if(o){U=new Array(z-N);for(let H=N;H<z;H++){let G=H*f+p;D=new Array(r);for(let Z=0;Z<r;Z++)D[Z]=e[G+Z];U[H-N]=D}}else if(f===r)U=e.subarray(N*r+p,z*r+p);else{U=new e.constructor((z-N)*r);let H=0;for(let G=N;G<z;G++){let Z=G*f+p;for(let Y=0;Y<r;Y++)U[H++]=e[Z+Y]}}return U}}var sH=[],Xv=[[0,1/0]];function oH(e,t){if(e===Xv||(t[0]<0&&(t[0]=0),t[0]>=t[1]))return e;let r=[],i=e.length,s=0;for(let n=0;n<i;n++){let o=e[n];o[1]<t[0]?(r.push(o),s=n+1):o[0]>t[1]?r.push(o):t=[Math.min(o[0],t[0]),Math.max(o[1],t[1])]}return r.splice(s,0,t),r}var Gmt={interpolation:{duration:0,easing:e=>e},spring:{stiffness:.05,damping:.5}};function DS(e,t){if(!e)return null;Number.isFinite(e)&&(e={type:"interpolation",duration:e});let r=e.type||"interpolation";return{...Gmt[r],...t,...e,type:r}}var jg=class extends Yv{constructor(t,r){super(t,r,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,layoutChanged:!1,updateRanges:Xv}),this.constant=!1,this.settings.update=r.update||(r.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(t){this.state.startIndices=t}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:t=!1}={}){let r=this.state.needsRedraw;return this.state.needsRedraw=r&&!t,r}layoutChanged(){return this.state.layoutChanged}setAccessor(t){this.state.layoutChanged||=!rH(t,this.getAccessor()),super.setAccessor(t)}getUpdateTriggers(){let{accessor:t}=this.settings;return[this.id].concat(typeof t!="function"&&t||[])}supportsTransition(){return!!this.settings.transition}getTransitionSetting(t){if(!t||!this.supportsTransition())return null;let{accessor:r}=this.settings,i=this.settings.transition,s=Array.isArray(r)?t[r.find(n=>t[n])]:t[r];return DS(s,i)}setNeedsUpdate(t=this.id,r){if(this.state.needsUpdate=this.state.needsUpdate||t,this.setNeedsRedraw(t),r){let{startRow:i=0,endRow:s=1/0}=r;this.state.updateRanges=oH(this.state.updateRanges,[i,s])}else this.state.updateRanges=Xv}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=sH}setNeedsRedraw(t=this.id){this.state.needsRedraw=this.state.needsRedraw||t}allocate(t){let{state:r,settings:i}=this;return i.noAlloc?!1:i.update?(super.allocate(t,r.updateRanges!==Xv),!0):!1}updateBuffer({numInstances:t,data:r,props:i,context:s}){if(!this.needsUpdate())return!1;let{state:{updateRanges:n},settings:{update:o,noAlloc:c}}=this,f=!0;if(o){for(let[p,x]of n)o.call(s,this,{data:r,startRow:p,endRow:x,props:i,numInstances:t});if(this.value)if(this.constant||!this.buffer||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(let[p,x]of n){let E=Number.isFinite(p)?this.getVertexOffset(p):0,T=Number.isFinite(x)?this.getVertexOffset(x):c||!Number.isFinite(t)?this.value.length:t*this.size;super.updateSubBuffer({startOffset:E,endOffset:T})}this._checkAttributeArray()}else f=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),f}setConstantValue(t){return t===void 0||typeof t=="function"?!1:(this.setData({constant:!0,value:t})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(t){let{state:r}=this;return t?(this.clearNeedsUpdate(),r.lastExternalBuffer===t||(r.lastExternalBuffer=t,this.setNeedsRedraw(),this.setData(t)),!0):(r.lastExternalBuffer=null,!1)}setBinaryValue(t,r=null){let{state:i,settings:s}=this;if(!t)return i.binaryValue=null,i.binaryAccessor=null,!1;if(s.noAlloc)return!1;if(i.binaryValue===t)return this.clearNeedsUpdate(),!0;if(i.binaryValue=t,this.setNeedsRedraw(),s.transform||r!==this.startIndices){ArrayBuffer.isView(t)&&(t={value:t});let o=t;Qn(ArrayBuffer.isView(o.value),`invalid ${s.accessor}`);let c=!!o.size&&o.size!==this.size;return i.binaryAccessor=kS(o.value,{size:o.size||this.size,stride:o.stride,offset:o.offset,startIndices:r,nested:c}),!1}return this.clearNeedsUpdate(),this.setData(t),!0}getVertexOffset(t){let{startIndices:r}=this;return(r?t<r.length?r[t]:this.numInstances:t)*this.size}getValue(){let t=this.settings.shaderAttributes,r=super.getValue();if(!t)return r;for(let i in t)Object.assign(r,super.getValue(i,t[i]));return r}getBufferLayout(t){this.state.layoutChanged=!1;let r=this.settings.shaderAttributes,i=super._getBufferLayout(),{stepMode:s}=this.settings;if(s==="dynamic"?i.stepMode=t?t.isInstanced?"instance":"vertex":"instance":i.stepMode=s??"vertex",!r)return i;for(let n in r){let o=super._getBufferLayout(n,r[n]);i.attributes.push(...o.attributes)}return i}_autoUpdater(t,{data:r,startRow:i,endRow:s,props:n,numInstances:o}){if(t.constant)return;let{settings:c,state:f,value:p,size:x,startIndices:E}=t,{accessor:T,transform:D}=c,N=f.binaryAccessor||(typeof T=="function"?T:n[T]);Qn(typeof N=="function",`accessor "${T}" is not a function`);let z=t.getVertexOffset(i),{iterable:U,objectInfo:H}=Pd(r,i,s);for(let G of U){H.index++;let Z=N(G,H);if(D&&(Z=D.call(this,Z)),E){let Y=(H.index<E.length-1?E[H.index+1]:o)-E[H.index];if(Z&&Array.isArray(Z[0])){let st=z;for(let at of Z)t._normalizeValue(at,p,st),st+=x}else Z&&Z.length>x?p.set(Z,z):(t._normalizeValue(Z,H.target,0),Xk({target:p,source:H.target,start:z,count:Y}));z+=Y*x}else t._normalizeValue(Z,p,z),z+=x}}_validateAttributeUpdaters(){let{settings:t}=this;if(!(t.noAlloc||typeof t.update=="function"))throw new Error(`Attribute ${this.id} missing update or accessor`)}_checkAttributeArray(){let{value:t}=this,r=Math.min(4,this.size);if(t&&t.length>=r){let i=!0;switch(r){case 4:i=i&&Number.isFinite(t[3]);case 3:i=i&&Number.isFinite(t[2]);case 2:i=i&&Number.isFinite(t[1]);case 1:i=i&&Number.isFinite(t[0]);break;default:i=!1}if(!i)throw new Error(`Illegal attribute generated for ${this.id}`)}}};function x7(e){let{source:t,target:r,start:i=0,size:s,getData:n}=e,o=e.end||r.length,c=t.length,f=o-i;if(c>f){r.set(t.subarray(0,f),i);return}if(r.set(t,i),!n)return;let p=c;for(;p<f;){let x=n(p,t);for(let E=0;E<s;E++)r[i+p]=x[E]||0,p++}}function aH({source:e,target:t,size:r,getData:i,sourceStartIndices:s,targetStartIndices:n}){if(!s||!n)return x7({source:e,target:t,size:r,getData:i}),t;let o=0,c=0,f=i&&((x,E)=>i(x+c,E)),p=Math.min(s.length,n.length);for(let x=1;x<p;x++){let E=s[x]*r,T=n[x]*r;x7({source:e.subarray(o,E),target:t,start:c,end:T,size:r,getData:f}),o=E,c=T}return c<t.length&&x7({source:[],target:t,start:c,size:r,getData:f}),t}function lH(e){let{device:t,settings:r,value:i}=e,s=new jg(t,r);return s.setData({value:i instanceof Float64Array?new Float64Array(0):new Float32Array(0),normalized:r.normalized}),s}function BS(e){switch(e){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error(`No defined attribute type for size "${e}"`)}}function OS(e){switch(e){case 1:return"float32";case 2:return"float32x2";case 3:return"float32x3";case 4:return"float32x4";default:throw new Error("invalid type size")}}function NS(e){e.push(e.shift())}function cH(e,t){let{doublePrecision:r,settings:i,value:s,size:n}=e,o=r&&s instanceof Float64Array?2:1,c=0,{shaderAttributes:f}=e.settings;if(f)for(let p of Object.values(f))c=Math.max(c,p.vertexOffset??0);return(i.noAlloc?s.length:(t+c)*n)*o}function FS({device:e,source:t,target:r}){return(!r||r.byteLength<t.byteLength)&&(r?.destroy(),r=e.createBuffer({byteLength:t.byteLength,usage:t.usage})),r}function LS({device:e,buffer:t,attribute:r,fromLength:i,toLength:s,fromStartIndices:n,getData:o=c=>c}){let c=r.doublePrecision&&r.value instanceof Float64Array?2:1,f=r.size*c,p=r.byteOffset,x=r.settings.bytesPerElement<4?p/r.settings.bytesPerElement*4:p,E=r.startIndices,T=n&&E,D=r.isConstant;if(!T&&t&&i>=s)return t;let N=r.value instanceof Float64Array?Float32Array:r.value.constructor,z=D?r.value:new N(r.getBuffer().readSyncWebGL(p,s*N.BYTES_PER_ELEMENT).buffer);if(r.settings.normalized&&!D){let Z=o;o=(Y,st)=>r.normalizeConstant(Z(Y,st))}let U=D?(Z,Y)=>o(z,Y):(Z,Y)=>o(z.subarray(Z+p,Z+p+f),Y),H=t?new Float32Array(t.readSyncWebGL(x,i*4).buffer):new Float32Array(0),G=new Float32Array(s);return aH({source:H,target:G,sourceStartIndices:n,targetStartIndices:E,size:f,getData:U}),(!t||t.byteLength<G.byteLength+x)&&(t?.destroy(),t=e.createBuffer({byteLength:G.byteLength+x,usage:35050})),t.write(G,x),t}var Fy=class{constructor({device:t,attribute:r,timeline:i}){this.buffers=[],this.currentLength=0,this.device=t,this.transition=new Lh(i),this.attribute=r,this.attributeInTransition=lH(r),this.currentStartIndices=r.startIndices}get inProgress(){return this.transition.inProgress}start(t,r,i=1/0){this.settings=t,this.currentStartIndices=this.attribute.startIndices,this.currentLength=cH(this.attribute,r),this.transition.start({...t,duration:i})}update(){let t=this.transition.update();return t&&this.onUpdate(),t}setBuffer(t){this.attributeInTransition.setData({buffer:t,normalized:this.attribute.settings.normalized,value:this.attributeInTransition.value})}cancel(){this.transition.cancel()}delete(){this.cancel();for(let t of this.buffers)t.destroy();this.buffers.length=0}};var Zv=class extends Fy{constructor({device:t,attribute:r,timeline:i}){super({device:t,attribute:r,timeline:i}),this.type="interpolation",this.transform=Jmt(t,r)}start(t,r){let i=this.currentLength,s=this.currentStartIndices;if(super.start(t,r,t.duration),t.duration<=0){this.transition.cancel();return}let{buffers:n,attribute:o}=this;NS(n),n[0]=LS({device:this.device,buffer:n[0],attribute:o,fromLength:i,toLength:this.currentLength,fromStartIndices:s,getData:t.enter}),n[1]=FS({device:this.device,source:n[0],target:n[1]}),this.setBuffer(n[1]);let{transform:c}=this,f=c.model,p=Math.floor(this.currentLength/o.size);uH(o)&&(p/=2),f.setVertexCount(p),o.isConstant?(f.setAttributes({aFrom:n[0]}),f.setConstantAttributes({aTo:o.value})):f.setAttributes({aFrom:n[0],aTo:o.getBuffer()}),c.transformFeedback.setBuffers({vCurrent:n[1]})}onUpdate(){let{duration:t,easing:r}=this.settings,{time:i}=this.transition,s=i/t;r&&(s=r(s));let{model:n}=this.transform;n.setUniforms({time:s}),n.device.gl.bindBuffer(34962,null),this.transform.run({discard:!0})}delete(){super.delete(),this.transform.destroy()}},Qmt=`#version 300 es
#define SHADER_NAME interpolation-transition-vertex-shader

uniform float time;
in ATTRIBUTE_TYPE aFrom;
in ATTRIBUTE_TYPE aTo;
out ATTRIBUTE_TYPE vCurrent;

void main(void) {
  vCurrent = mix(aFrom, aTo, time);
  gl_Position = vec4(0.0);
}
`,Kmt=`#version 300 es
#define SHADER_NAME interpolation-transition-vertex-shader

uniform float time;
in ATTRIBUTE_TYPE aFrom;
in ATTRIBUTE_TYPE aFrom64Low;
in ATTRIBUTE_TYPE aTo;
in ATTRIBUTE_TYPE aTo64Low;
out ATTRIBUTE_TYPE vCurrent;
out ATTRIBUTE_TYPE vCurrent64Low;

vec2 mix_fp64(vec2 a, vec2 b, float x) {
  vec2 range = sub_fp64(b, a);
  return sum_fp64(a, mul_fp64(range, vec2(x, 0.0)));
}

void main(void) {
  for (int i=0; i<ATTRIBUTE_SIZE; i++) {
    vec2 value = mix_fp64(vec2(aFrom[i], aFrom64Low[i]), vec2(aTo[i], aTo64Low[i]), time);
    vCurrent[i] = value.x;
    vCurrent64Low[i] = value.y;
  }
  gl_Position = vec4(0.0);
}
`;function uH(e){return e.doublePrecision&&e.value instanceof Float64Array}function Jmt(e,t){let r=t.size,i=BS(r),s=OS(r),n=t.getBufferLayout();return uH(t)?new _A(e,{vs:Kmt,bufferLayout:[{name:"aFrom",byteStride:8*r,attributes:[{attribute:"aFrom",format:s,byteOffset:0},{attribute:"aFrom64Low",format:s,byteOffset:4*r}]},{name:"aTo",byteStride:8*r,attributes:[{attribute:"aTo",format:s,byteOffset:0},{attribute:"aTo64Low",format:s,byteOffset:4*r}]}],modules:[ek],defines:{ATTRIBUTE_TYPE:i,ATTRIBUTE_SIZE:r},moduleSettings:{},varyings:["vCurrent","vCurrent64Low"],bufferMode:35980,disableWarnings:!0}):new _A(e,{vs:Qmt,bufferLayout:[{name:"aFrom",format:s},{name:"aTo",format:n.attributes[0].format}],defines:{ATTRIBUTE_TYPE:i},varyings:["vCurrent"],disableWarnings:!0})}var Gv=class extends Fy{constructor({device:t,attribute:r,timeline:i}){super({device:t,attribute:r,timeline:i}),this.type="spring",this.texture=igt(t),this.framebuffer=ngt(t,this.texture),this.transform=rgt(t,r)}start(t,r){let i=this.currentLength,s=this.currentStartIndices;super.start(t,r);let{buffers:n,attribute:o}=this;for(let f=0;f<2;f++)n[f]=LS({device:this.device,buffer:n[f],attribute:o,fromLength:i,toLength:this.currentLength,fromStartIndices:s,getData:t.enter});n[2]=FS({device:this.device,source:n[0],target:n[2]}),this.setBuffer(n[1]);let{model:c}=this.transform;c.setVertexCount(Math.floor(this.currentLength/o.size)),o.isConstant?c.setConstantAttributes({aTo:o.value}):c.setAttributes({aTo:o.getBuffer()})}onUpdate(){let{buffers:t,transform:r,framebuffer:i,transition:s}=this,n=this.settings;r.model.setAttributes({aPrev:t[0],aCur:t[1]}),r.transformFeedback.setBuffers({vNext:t[2]}),r.model.setUniforms({stiffness:n.stiffness,damping:n.damping}),r.run({framebuffer:i,discard:!1,parameters:{viewport:[0,0,1,1]},clearColor:[0,0,0,0]}),NS(t),this.setBuffer(t[1]),this.device.readPixelsToArrayWebGL(i)[0]>0||s.end()}delete(){super.delete(),this.transform.destroy(),this.texture.destroy(),this.framebuffer.destroy()}},tgt=`#version 300 es
#define SHADER_NAME spring-transition-vertex-shader

#define EPSILON 0.00001

uniform float stiffness;
uniform float damping;
in ATTRIBUTE_TYPE aPrev;
in ATTRIBUTE_TYPE aCur;
in ATTRIBUTE_TYPE aTo;
out ATTRIBUTE_TYPE vNext;
out float vIsTransitioningFlag;

ATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {
  ATTRIBUTE_TYPE velocity = cur - prev;
  ATTRIBUTE_TYPE delta = dest - cur;
  ATTRIBUTE_TYPE spring = delta * stiffness;
  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;
  return spring + damper + velocity + cur;
}

void main(void) {
  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;
  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;

  vNext = getNextValue(aCur, aPrev, aTo);
  gl_Position = vec4(0, 0, 0, 1);
  gl_PointSize = 100.0;
}
`,egt=`#version 300 es
#define SHADER_NAME spring-transition-is-transitioning-fragment-shader

in float vIsTransitioningFlag;

out vec4 fragColor;

void main(void) {
  if (vIsTransitioningFlag == 0.0) {
    discard;
  }
  fragColor = vec4(1.0);
}`;function rgt(e,t){let r=BS(t.size),i=OS(t.size);return new _A(e,{vs:tgt,fs:egt,bufferLayout:[{name:"aPrev",format:i},{name:"aCur",format:i},{name:"aTo",format:t.getBufferLayout().attributes[0].format}],varyings:["vNext"],defines:{ATTRIBUTE_TYPE:r},parameters:{depthCompare:"always",blendColorOperation:"max",blendColorSrcFactor:"one",blendColorDstFactor:"one",blendAlphaOperation:"max",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one"}})}function igt(e){return e.createTexture({data:new Uint8Array(4),format:"rgba8unorm",mipmaps:!1,width:1,height:1})}function ngt(e,t){return e.createFramebuffer({id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,colorAttachments:[t]})}var sgt={interpolation:Zv,spring:Gv},Qv=class{constructor(t,{id:r,timeline:i}){if(!t)throw new Error("AttributeTransitionManager is constructed without device");this.id=r,this.device=t,this.timeline=i,this.transitions={},this.needsRedraw=!1,this.numInstances=1}finalize(){for(let t in this.transitions)this._removeTransition(t)}update({attributes:t,transitions:r,numInstances:i}){this.numInstances=i||1;for(let s in t){let n=t[s],o=n.getTransitionSetting(r);o&&this._updateAttribute(s,n,o)}for(let s in this.transitions){let n=t[s];(!n||!n.getTransitionSetting(r))&&this._removeTransition(s)}}hasAttribute(t){let r=this.transitions[t];return r&&r.inProgress}getAttributes(){let t={};for(let r in this.transitions){let i=this.transitions[r];i.inProgress&&(t[r]=i.attributeInTransition)}return t}run(){if(this.numInstances===0)return!1;for(let r in this.transitions)this.transitions[r].update()&&(this.needsRedraw=!0);let t=this.needsRedraw;return this.needsRedraw=!1,t}_removeTransition(t){this.transitions[t].delete(),delete this.transitions[t]}_updateAttribute(t,r,i){let s=this.transitions[t],n=!s||s.type!==i.type;if(n){s&&this._removeTransition(t);let o=sgt[i.type];o?this.transitions[t]=new o({attribute:r,timeline:this.timeline,device:this.device}):(mi.error(`unsupported transition type '${i.type}'`)(),n=!1)}(n||r.needsRedraw())&&(this.needsRedraw=!0,this.transitions[t].start(i,this.numInstances))}};var hH="attributeManager.invalidate",ogt="attributeManager.updateStart",agt="attributeManager.updateEnd",lgt="attribute.updateStart",cgt="attribute.allocate",ugt="attribute.updateEnd",Kv=class{constructor(t,{id:r="attribute-manager",stats:i,timeline:s}={}){this.mergeBoundsMemoized=Wf(wj),this.id=r,this.device=t,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=i,this.attributeTransitionManager=new Qv(t,{id:`${r}-transitions`,timeline:s}),Object.seal(this)}finalize(){for(let t in this.attributes)this.attributes[t].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(t={clearRedrawFlags:!1}){let r=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!t.clearRedrawFlags,r&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(t){this._add(t)}addInstanced(t){this._add(t,{stepMode:"instance"})}remove(t){for(let r of t)this.attributes[r]!==void 0&&(this.attributes[r].delete(),delete this.attributes[r])}invalidate(t,r){let i=this._invalidateTrigger(t,r);so(hH,this,t,i)}invalidateAll(t){for(let r in this.attributes)this.attributes[r].setNeedsUpdate(r,t);so(hH,this,"all")}update({data:t,numInstances:r,startIndices:i=null,transitions:s,props:n={},buffers:o={},context:c={}}){let f=!1;so(ogt,this),this.stats&&this.stats.get("Update Attributes").timeStart();for(let p in this.attributes){let x=this.attributes[p],E=x.settings.accessor;x.startIndices=i,x.numInstances=r,n[p]&&mi.removed(`props.${p}`,`data.attributes.${p}`)(),x.setExternalBuffer(o[p])||x.setBinaryValue(typeof E=="string"?o[E]:void 0,t.startIndices)||typeof E=="string"&&!o[E]&&x.setConstantValue(n[E])||x.needsUpdate()&&(f=!0,this._updateAttribute({attribute:x,numInstances:r,data:t,props:n,context:c})),this.needsRedraw=this.needsRedraw||x.needsRedraw()}f&&so(agt,this,r),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:r,transitions:s})}updateTransition(){let{attributeTransitionManager:t}=this,r=t.run();return this.needsRedraw=this.needsRedraw||r,r}getAttributes(){return{...this.attributes,...this.attributeTransitionManager.getAttributes()}}getBounds(t){let r=t.map(i=>this.attributes[i]?.getBounds());return this.mergeBoundsMemoized(r)}getChangedAttributes(t={clearChangedFlags:!1}){let{attributes:r,attributeTransitionManager:i}=this,s={...i.getAttributes()};for(let n in r){let o=r[n];o.needsRedraw(t)&&!i.hasAttribute(n)&&(s[n]=o)}return s}getBufferLayouts(t){return Object.values(this.getAttributes()).map(r=>r.getBufferLayout(t))}_add(t,r){for(let i in t){let s=t[i],n={...s,id:i,size:s.isIndexed&&1||s.size||1,...r};this.attributes[i]=new jg(this.device,n)}this._mapUpdateTriggersToAttributes()}_mapUpdateTriggersToAttributes(){let t={};for(let r in this.attributes)this.attributes[r].getUpdateTriggers().forEach(s=>{t[s]||(t[s]=[]),t[s].push(r)});this.updateTriggers=t}_invalidateTrigger(t,r){let{attributes:i,updateTriggers:s}=this,n=s[t];return n&&n.forEach(o=>{let c=i[o];c&&c.setNeedsUpdate(c.id,r)}),n}_updateAttribute(t){let{attribute:r,numInstances:i}=t;if(so(lgt,r),r.constant){r.setConstantValue(r.value);return}r.allocate(i)&&so(cgt,r,i),r.updateBuffer(t)&&(this.needsRedraw=!0,so(ugt,r,i))}};var Jv=class extends Lh{get value(){return this._value}_onUpdate(){let{time:t,settings:{fromValue:r,toValue:i,duration:s,easing:n}}=this,o=n(t/s);this._value=Vf(r,i,o)}};var fH=1e-5;function pH(e,t,r,i,s){let n=t-e,c=(r-t)*s,f=-n*i;return c+f+n+t}function hgt(e,t,r,i,s){if(Array.isArray(r)){let n=[];for(let o=0;o<r.length;o++)n[o]=pH(e[o],t[o],r[o],i,s);return n}return pH(e,t,r,i,s)}function dH(e,t){if(Array.isArray(e)){let r=0;for(let i=0;i<e.length;i++){let s=e[i]-t[i];r+=s*s}return Math.sqrt(r)}return Math.abs(e-t)}var tw=class extends Lh{get value(){return this._currValue}_onUpdate(){let{fromValue:t,toValue:r,damping:i,stiffness:s}=this.settings,{_prevValue:n=t,_currValue:o=t}=this,c=hgt(n,o,r,i,s),f=dH(c,r),p=dH(c,o);f<fH&&p<fH&&(c=r,this.end()),this._prevValue=o,this._currValue=c}};var fgt={interpolation:Jv,spring:tw},ew=class{constructor(t){this.transitions=new Map,this.timeline=t}get active(){return this.transitions.size>0}add(t,r,i,s){let{transitions:n}=this;if(n.has(t)){let f=n.get(t),{value:p=f.settings.fromValue}=f;r=p,this.remove(t)}if(s=DS(s),!s)return;let o=fgt[s.type];if(!o){mi.error(`unsupported transition type '${s.type}'`)();return}let c=new o(this.timeline);c.start({...s,fromValue:r,toValue:i}),n.set(t,c)}remove(t){let{transitions:r}=this;r.has(t)&&(r.get(t).cancel(),r.delete(t))}update(){let t={};for(let[r,i]of this.transitions)i.update(),t[r]=i.value,i.inProgress||this.remove(r);return t}clear(){for(let t of this.transitions.keys())this.remove(t)}};function mH(e){let t=e[Ou];for(let r in t){let i=t[r],{validate:s}=i;if(s&&!s(e[r],i))throw new Error(`Invalid prop ${r}: ${e[r]}`)}}function gH(e,t){let r=_H({newProps:e,oldProps:t,propTypes:e[Ou],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),i=dgt(e,t),s=!1;return i||(s=Agt(e,t)),{dataChanged:i,propsChanged:r,updateTriggersChanged:s,extensionsChanged:mgt(e,t),transitionsChanged:pgt(e,t)}}function pgt(e,t){if(!e.transitions)return!1;let r={},i=e[Ou],s=!1;for(let n in e.transitions){let o=i[n],c=o&&o.type;(c==="number"||c==="color"||c==="array")&&b7(e[n],t[n],o)&&(r[n]=!0,s=!0)}return s?r:!1}function _H({newProps:e,oldProps:t,ignoreProps:r={},propTypes:i={},triggerName:s="props"}){if(t===e)return!1;if(typeof e!="object"||e===null)return`${s} changed shallowly`;if(typeof t!="object"||t===null)return`${s} changed shallowly`;for(let n of Object.keys(e))if(!(n in r)){if(!(n in t))return`${s}.${n} added`;let o=b7(e[n],t[n],i[n]);if(o)return`${s}.${n} ${o}`}for(let n of Object.keys(t))if(!(n in r)){if(!(n in e))return`${s}.${n} dropped`;if(!Object.hasOwnProperty.call(e,n)){let o=b7(e[n],t[n],i[n]);if(o)return`${s}.${n} ${o}`}}return!1}function b7(e,t,r){let i=r&&r.equal;return i&&!i(e,t,r)||!i&&(i=e&&t&&e.equals,i&&!i.call(e,t))?"changed deeply":!i&&t!==e?"changed shallowly":null}function dgt(e,t){if(t===null)return"oldProps is null, initial diff";let r=!1,{dataComparator:i,_dataDiff:s}=e;return i?i(e.data,t.data)||(r="Data comparator detected a change"):e.data!==t.data&&(r="A new data container was supplied"),r&&s&&(r=s(e.data,t.data)||r),r}function Agt(e,t){if(t===null)return{all:!0};if("all"in e.updateTriggers&&AH(e,t,"all"))return{all:!0};let r={},i=!1;for(let s in e.updateTriggers)s!=="all"&&AH(e,t,s)&&(r[s]=!0,i=!0);return i?r:!1}function mgt(e,t){if(t===null)return!0;let r=t.extensions,{extensions:i}=e;if(i===r)return!1;if(!r||!i||i.length!==r.length)return!0;for(let s=0;s<i.length;s++)if(!i[s].equals(r[s]))return!0;return!1}function AH(e,t,r){let i=e.updateTriggers[r];i=i??{};let s=t.updateTriggers[r];return s=s??{},_H({oldProps:s,newProps:i,triggerName:r})}var ggt="count(): argument not an object",_gt="count(): argument not a container";function yH(e){if(!xgt(e))throw new Error(ggt);if(typeof e.count=="function")return e.count();if(Number.isFinite(e.size))return e.size;if(Number.isFinite(e.length))return e.length;if(ygt(e))return Object.keys(e).length;throw new Error(_gt)}function ygt(e){return e!==null&&typeof e=="object"&&e.constructor===Object}function xgt(e){return e!==null&&typeof e=="object"}function v7(e,t){if(!t)return e;let r={...e,...t};if("defines"in t&&(r.defines={...e.defines,...t.defines}),"modules"in t&&(r.modules=(e.modules||[]).concat(t.modules),t.modules.some(i=>i.name==="project64"))){let i=r.modules.findIndex(s=>s.name==="project32");i>=0&&r.modules.splice(i,1)}if("inject"in t)if(!e.inject)r.inject=t.inject;else{let i={...e.inject};for(let s in t.inject)i[s]=(i[s]||"")+t.inject[s];r.inject=i}return r}var bgt={minFilter:"linear",mipmapFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},w7={};function xH(e,t,r,i){if(r instanceof Bo)return r;r.constructor&&r.constructor.name!=="Object"&&(r={data:r});let s=null;r.compressed&&(s={minFilter:"linear",mipmapFilter:r.data.length>1?"nearest":"linear"});let n=t.createTexture({...r,sampler:{...bgt,...s,...i}});return w7[n.id]=e,n}function bH(e,t){!t||!(t instanceof Bo)||w7[t.id]===e&&(t.delete(),delete w7[t.id])}var vgt={boolean:{validate(e,t){return!0},equal(e,t,r){return!!e==!!t}},number:{validate(e,t){return Number.isFinite(e)&&(!("max"in t)||e<=t.max)&&(!("min"in t)||e>=t.min)}},color:{validate(e,t){return t.optional&&!e||T7(e)&&(e.length===3||e.length===4)},equal(e,t,r){return Ba(e,t,1)}},accessor:{validate(e,t){let r=zS(e);return r==="function"||r===zS(t.value)},equal(e,t,r){return typeof t=="function"?!0:Ba(e,t,1)}},array:{validate(e,t){return t.optional&&!e||T7(e)},equal(e,t,r){let{compare:i}=r,s=Number.isInteger(i)?i:i?1:0;return i?Ba(e,t,s):e===t}},object:{equal(e,t,r){if(r.ignore)return!0;let{compare:i}=r,s=Number.isInteger(i)?i:i?1:0;return i?Ba(e,t,s):e===t}},function:{validate(e,t){return t.optional&&!e||typeof e=="function"},equal(e,t,r){return!r.compare&&r.ignore!==!1||e===t}},data:{transform:(e,t,r)=>{if(!e)return e;let{dataTransform:i}=r.props;return i?i(e):typeof e.shape=="string"&&e.shape.endsWith("-table")&&Array.isArray(e.data)?e.data:e}},image:{transform:(e,t,r)=>{let i=r.context;return!i||!i.device?null:xH(r.id,i.device,e,{...t.parameters,...r.props.textureParameters})},release:(e,t,r)=>{bH(r.id,e)}}};function vH(e){let t={},r={},i={};for(let[s,n]of Object.entries(e)){let o=n?.deprecatedFor;if(o)i[s]=Array.isArray(o)?o:[o];else{let c=wgt(s,n);t[s]=c,r[s]=c.value}}return{propTypes:t,defaultProps:r,deprecatedProps:i}}function wgt(e,t){switch(zS(t)){case"object":return rw(e,t);case"array":return rw(e,{type:"array",value:t,compare:!1});case"boolean":return rw(e,{type:"boolean",value:t});case"number":return rw(e,{type:"number",value:t});case"function":return rw(e,{type:"function",value:t,compare:!0});default:return{name:e,type:"unknown",value:t}}}function rw(e,t){return"type"in t?{name:e,...vgt[t.type],...t}:"value"in t?{name:e,type:zS(t.value),...t}:{name:e,type:"object",value:t}}function T7(e){return Array.isArray(e)||ArrayBuffer.isView(e)}function zS(e){return T7(e)?"array":e===null?"null":typeof e}function wH(e,t){let r;for(let n=t.length-1;n>=0;n--){let o=t[n];"extensions"in o&&(r=o.extensions)}let i=S7(e.constructor,r),s=Object.create(i);s[Py]=e,s[Xf]={},s[Fh]={};for(let n=0;n<t.length;++n){let o=t[n];for(let c in o)s[c]=o[c]}return Object.freeze(s),s}var Tgt="_mergedDefaultProps";function S7(e,t){let r=Tgt;if(t)for(let s of t){let n=s.constructor;n&&(r+=`:${n.extensionName||n.name}`)}let i=TH(e,r);return i||(e[r]=Sgt(e,t||[]))}function Sgt(e,t){if(!e.prototype)return null;let i=Object.getPrototypeOf(e),s=S7(i),n=TH(e,"defaultProps")||{},o=vH(n),c=Object.assign(Object.create(null),s,o.defaultProps),f=Object.assign(Object.create(null),s?.[Ou],o.propTypes),p=Object.assign(Object.create(null),s?.[nS],o.deprecatedProps);for(let x of t){let E=S7(x.constructor);E&&(Object.assign(c,E),Object.assign(f,E[Ou]),Object.assign(p,E[nS]))}return Egt(c,e),Mgt(c,f),Igt(c,p),c[Ou]=f,c[nS]=p,t.length===0&&!E7(e,"_propTypes")&&(e._propTypes=f),c}function Egt(e,t){let r=Pgt(t);Object.defineProperties(e,{id:{writable:!0,value:r}})}function Igt(e,t){for(let r in t)Object.defineProperty(e,r,{enumerable:!1,set(i){let s=`${this.id}: ${r}`;for(let n of t[r])E7(this,n)||(this[n]=i);mi.deprecated(s,t[r].join("/"))()}})}function Mgt(e,t){let r={},i={};for(let s in t){let n=t[s],{name:o,value:c}=n;n.async&&(r[o]=c,i[o]=Cgt(o))}e[Sd]=r,e[Xf]={},Object.defineProperties(e,i)}function Cgt(e){return{enumerable:!0,set(t){typeof t=="string"||t instanceof Promise||RS(t)?this[Xf][e]=t:this[Fh][e]=t},get(){if(this[Fh]){if(e in this[Fh])return this[Fh][e]||this[Sd][e];if(e in this[Xf]){let t=this[Py]&&this[Py].internalState;if(t&&t.hasAsyncProp(e))return t.getAsyncProp(e)||this[Sd][e]}}return this[Sd][e]}}}function E7(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function TH(e,t){return E7(e,t)&&e[t]}function Pgt(e){let t=e.componentName;return t||mi.warn(`${e.name}.componentName not specified`)(),t||e.name}var Rgt=0,iw=class{static{this.componentName="Component"}static{this.defaultProps={}}constructor(...t){this.props=wH(this,t),this.id=this.props.id,this.count=Rgt++}clone(t){let{props:r}=this,i={};for(let s in r[Sd])s in r[Fh]?i[s]=r[Fh][s]:s in r[Xf]&&(i[s]=r[Xf][s]);return new this.constructor({...r,...i,...t})}};var kgt=Object.freeze({}),nw=class{constructor(t){this.component=t,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(let t in this.asyncProps){let r=this.asyncProps[t];r&&r.type&&r.type.release&&r.type.release(r.resolvedValue,r.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||kgt}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp(t){return t in this.asyncProps}getAsyncProp(t){let r=this.asyncProps[t];return r&&r.resolvedValue}isAsyncPropLoading(t){if(t){let r=this.asyncProps[t];return!!(r&&r.pendingLoadCount>0&&r.pendingLoadCount!==r.resolvedLoadCount)}for(let r in this.asyncProps)if(this.isAsyncPropLoading(r))return!0;return!1}reloadAsyncProp(t,r){this._watchPromise(t,Promise.resolve(r))}setAsyncProps(t){this.component=t[Py]||this.component;let r=t[Fh]||{},i=t[Xf]||t,s=t[Sd]||{};for(let n in r){let o=r[n];this._createAsyncPropData(n,s[n]),this._updateAsyncProp(n,o),r[n]=this.getAsyncProp(n)}for(let n in i){let o=i[n];this._createAsyncPropData(n,s[n]),this._updateAsyncProp(n,o)}}_fetch(t,r){return null}_onResolve(t,r){}_onError(t,r){}_updateAsyncProp(t,r){if(this._didAsyncInputValueChange(t,r)){if(typeof r=="string"&&(r=this._fetch(t,r)),r instanceof Promise){this._watchPromise(t,r);return}if(RS(r)){this._resolveAsyncIterable(t,r);return}this._setPropValue(t,r)}}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(let t in this.asyncProps)Object.defineProperty(this.oldAsyncProps,t,{enumerable:!0,value:this.oldProps[t]})}}_didAsyncInputValueChange(t,r){let i=this.asyncProps[t];return r===i.resolvedValue||r===i.lastValue?!1:(i.lastValue=r,!0)}_setPropValue(t,r){this._freezeAsyncOldProps();let i=this.asyncProps[t];i&&(r=this._postProcessValue(i,r),i.resolvedValue=r,i.pendingLoadCount++,i.resolvedLoadCount=i.pendingLoadCount)}_setAsyncPropValue(t,r,i){let s=this.asyncProps[t];s&&i>=s.resolvedLoadCount&&r!==void 0&&(this._freezeAsyncOldProps(),s.resolvedValue=r,s.resolvedLoadCount=i,this.onAsyncPropUpdated(t,r))}_watchPromise(t,r){let i=this.asyncProps[t];if(i){i.pendingLoadCount++;let s=i.pendingLoadCount;r.then(n=>{this.component&&(n=this._postProcessValue(i,n),this._setAsyncPropValue(t,n,s),this._onResolve(t,n))}).catch(n=>{this._onError(t,n)})}}async _resolveAsyncIterable(t,r){if(t!=="data"){this._setPropValue(t,r);return}let i=this.asyncProps[t];if(!i)return;i.pendingLoadCount++;let s=i.pendingLoadCount,n=[],o=0;for await(let c of r){if(!this.component)return;let{dataTransform:f}=this.component.props;f?n=f(c,n):n=n.concat(c),Object.defineProperty(n,"__diff",{enumerable:!1,value:[{startRow:o,endRow:n.length}]}),o=n.length,this._setAsyncPropValue(t,n,s)}this._onResolve(t,n)}_postProcessValue(t,r){let i=t.type;return i&&this.component&&(i.release&&i.release(t.resolvedValue,i,this.component),i.transform)?i.transform(r,i,this.component):r}_createAsyncPropData(t,r){if(!this.asyncProps[t]){let s=this.component&&this.component.props[Ou];this.asyncProps[t]={type:s&&s[t],lastValue:null,resolvedValue:r,pendingLoadCount:0,resolvedLoadCount:0}}}};var sw=class extends nw{constructor({attributeManager:t,layer:r}){super(r),this.attributeManager=t,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch(t,r){let i=this.layer,s=i?.props.fetch;return s?s(r,{propName:t,layer:i}):super._fetch(t,r)}_onResolve(t,r){let i=this.layer;if(i){let s=i.props.onDataLoad;t==="data"&&s&&s(r,{propName:t,layer:i})}}_onError(t,r){let i=this.layer;i&&i.raiseError(r,`loading ${t} of ${this.layer}`)}};var Dgt="layer.changeFlag",Bgt="layer.initialize",Ogt="layer.update",Ngt="layer.finalize",Fgt="layer.matched",SH=2**24-1,Lgt=Object.freeze([]),zgt=Wf(({oldViewport:e,viewport:t})=>e.equals(t)),Kf=new Uint8ClampedArray(0),Ugt={data:{type:"data",value:Lgt,async:!0},dataComparator:{type:"function",value:null,optional:!0},_dataDiff:{type:"function",value:e=>e&&e.__diff,optional:!0},dataTransform:{type:"function",value:null,optional:!0},onDataLoad:{type:"function",value:null,optional:!0},onError:{type:"function",value:null,optional:!0},fetch:{type:"function",value:(e,{propName:t,layer:r,loaders:i,loadOptions:s,signal:n})=>{let{resourceManager:o}=r.context;s=s||r.getLoadOptions(),i=i||r.props.loaders,n&&(s={...s,fetch:{...s?.fetch,signal:n}});let c=o.contains(e);return!c&&!s&&(o.add({resourceId:e,data:hy(e,i),persistent:!1}),c=!0),c?o.subscribe({resourceId:e,onChange:f=>r.internalState?.reloadAsyncProp(t,f),consumerId:r.id,requestId:t}):hy(e,i,s)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,optional:!0},onClick:{type:"function",value:null,optional:!0},onDragStart:{type:"function",value:null,optional:!0},onDrag:{type:"function",value:null,optional:!0},onDragEnd:{type:"function",value:null,optional:!0},coordinateSystem:en.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:2},loadOptions:{type:"object",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:"function",value:({layerIndex:e})=>[0,-e*100]},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}},zu=class extends iw{constructor(){super(...arguments),this.internalState=null,this.lifecycle=yA.NO_STATE,this.parent=null}static{this.defaultProps=Ugt}static{this.layerName="Layer"}static get componentName(){return Object.prototype.hasOwnProperty.call(this,"layerName")?this.layerName:""}get root(){let t=this;for(;t.parent;)t=t.parent;return t}toString(){return`${this.constructor.layerName||this.constructor.name}({id: '${this.props.id}'})`}project(t){Qn(this.internalState);let r=this.internalState.viewport||this.context.viewport,i=qk(t,{viewport:r,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[s,n,o]=Sy(i,r.pixelProjectionMatrix);return t.length===2?[s,n]:[s,n,o]}unproject(t){return Qn(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(t)}projectPosition(t,r){Qn(this.internalState);let i=this.internalState.viewport||this.context.viewport;return Ej(t,{viewport:i,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...r})}get isComposite(){return!1}setState(t){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,t),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return this.internalState?!this.internalState.isAsyncPropLoading():!1}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){let t=this.state;return t&&(t.models||t.model&&[t.model])||[]}setModuleParameters(t){for(let r of this.getModels())r.updateModuleSettings(t)}setShaderModuleProps(...t){for(let r of this.getModels())r.shaderInputs.setProps(...t)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){let{coordinateSystem:t}=this.props;return t===en.DEFAULT||t===en.LNGLAT||t===en.CARTESIAN}onHover(t,r){return this.props.onHover&&this.props.onHover(t,r)||!1}onClick(t,r){return this.props.onClick&&this.props.onClick(t,r)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(t,r=[]){return r[0]=t+1&255,r[1]=t+1>>8&255,r[2]=t+1>>8>>8&255,r}decodePickingColor(t){Qn(t instanceof Uint8Array);let[r,i,s]=t;return r+i*256+s*65536-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&this.state.numInstances!==void 0?this.state.numInstances:yH(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){return this.getAttributeManager()?.getBounds(["positions","instancePositions"])}getShaders(t){t=v7(t,{disableWarnings:!0,modules:this.context.defaultShaderModules});for(let r of this.props.extensions)t=v7(t,r.getShaders.call(this,r));return t}shouldUpdateState(t){return t.changeFlags.propsOrDataChanged}updateState(t){let r=this.getAttributeManager(),{dataChanged:i}=t.changeFlags;if(i&&r)if(Array.isArray(i))for(let s of i)r.invalidateAll(s);else r.invalidateAll();if(r){let{props:s}=t,n=this.internalState.hasPickingBuffer,o=Number.isInteger(s.highlightedObjectIndex)||s.pickable||s.extensions.some(c=>c.getNeedsPickingBuffer.call(this,c));if(n!==o){this.internalState.hasPickingBuffer=o;let{pickingColors:c,instancePickingColors:f}=r.attributes,p=c||f;p&&(o&&p.constant&&(p.constant=!1,r.invalidate(p.id)),!p.value&&!o&&(p.constant=!0,p.value=[0,0,0]))}}}finalizeState(t){for(let i of this.getModels())i.destroy();let r=this.getAttributeManager();r&&r.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(t){for(let r of this.getModels())r.draw(t)}getPickingInfo({info:t,mode:r,sourceLayer:i}){let{index:s}=t;return s>=0&&Array.isArray(this.props.data)&&(t.object=this.props.data[s]),t}raiseError(t,r){r&&(t=new Error(`${r}: ${t.message}`,{cause:t})),this.props.onError?.(t)||this.context?.onError?.(t,this)}getNeedsRedraw(t={clearRedrawFlags:!1}){return this._getNeedsRedraw(t)}needsUpdate(){return this.internalState?this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()):!1}hasUniformTransition(){return this.internalState?.uniformTransitions.active||!1}activateViewport(t){if(!this.internalState)return;let r=this.internalState.viewport;this.internalState.viewport=t,(!r||!zgt({oldViewport:r,viewport:t}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(t="all"){let r=this.getAttributeManager();r&&(t==="all"?r.invalidateAll():r.invalidate(t))}updateAttributes(t){let r=!1;for(let i in t)t[i].layoutChanged()&&(r=!0);for(let i of this.getModels())this._setModelAttributes(i,t,r)}_updateAttributes(){let t=this.getAttributeManager();if(!t)return;let r=this.props,i=this.getNumInstances(),s=this.getStartIndices();t.update({data:r.data,numInstances:i,startIndices:s,props:r,transitions:r.transitions,buffers:r.data.attributes,context:this});let n=t.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(n)}_updateAttributeTransition(){let t=this.getAttributeManager();t&&t.updateTransition()}_updateUniformTransition(){let{uniformTransitions:t}=this.internalState;if(t.active){let r=t.update(),i=Object.create(this.props);for(let s in r)Object.defineProperty(i,s,{value:r[s]});return i}return this.props}calculateInstancePickingColors(t,{numInstances:r}){if(t.constant)return;let i=Math.floor(Kf.length/4);if(this.internalState.usesPickingColorCache=!0,i<r){r>SH&&mi.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),Kf=Nh.allocate(Kf,r,{size:4,copy:!0,maxCount:Math.max(r,SH)});let s=Math.floor(Kf.length/4),n=[];for(let o=i;o<s;o++)this.encodePickingColor(o,n),Kf[o*4+0]=n[0],Kf[o*4+1]=n[1],Kf[o*4+2]=n[2]}t.value=Kf.subarray(0,r*4)}_setModelAttributes(t,r,i=!1){if(!Object.keys(r).length)return;if(i){let c=this.getAttributeManager();t.setBufferLayout(c.getBufferLayouts(t)),r=c.getAttributes()}let s=t.userData?.excludeAttributes||{},n={},o={};for(let c in r){if(s[c])continue;let f=r[c].getValue();for(let p in f){let x=f[p];x instanceof Tn?r[c].settings.isIndexed?t.setIndexBuffer(x):n[p]=x:x&&(o[p]=x)}}t.setAttributes(n),t.setConstantAttributes(o)}disablePickingIndex(t){let r=this.props.data;if(!("attributes"in r)){this._disablePickingIndex(t);return}let{pickingColors:i,instancePickingColors:s}=this.getAttributeManager().attributes,n=i||s,o=n&&r.attributes&&r.attributes[n.id];if(o&&o.value){let c=o.value,f=this.encodePickingColor(t);for(let p=0;p<r.length;p++){let x=n.getVertexOffset(p);c[x]===f[0]&&c[x+1]===f[1]&&c[x+2]===f[2]&&this._disablePickingIndex(p)}}else this._disablePickingIndex(t)}_disablePickingIndex(t){let{pickingColors:r,instancePickingColors:i}=this.getAttributeManager().attributes,s=r||i;if(!s)return;let n=s.getVertexOffset(t),o=s.getVertexOffset(t+1);s.buffer.write(new Uint8Array(o-n),n)}restorePickingColors(){let{pickingColors:t,instancePickingColors:r}=this.getAttributeManager().attributes,i=t||r;i&&(this.internalState.usesPickingColorCache&&i.value.buffer!==Kf.buffer&&(i.value=Kf.subarray(0,i.value.length)),i.updateSubBuffer({startOffset:0}))}_initialize(){Qn(!this.internalState),Qn(Number.isFinite(this.props.coordinateSystem)),so(Bgt,this);let t=this._getAttributeManager();t&&t.addInstanced({instancePickingColors:{type:"uint8",size:4,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new sw({attributeManager:t,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(mi.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),t)}),this.internalState.uniformTransitions=new ew(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(let r of this.props.extensions)r.initializeState.call(this,this.context,r);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(t){so(Fgt,this,this===t);let{state:r,internalState:i}=t;this!==t&&(this.internalState=i,this.state=r,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){let t=this.needsUpdate();if(so(Ogt,this,t),!t)return;let r=this.props,i=this.context,s=this.internalState,n=i.viewport,o=this._updateUniformTransition();s.propsInTransition=o,i.viewport=s.viewport||n,this.props=o;try{let c=this._getUpdateParams(),f=this.getModels();if(i.device)this.updateState(c);else try{this.updateState(c)}catch{}for(let x of this.props.extensions)x.updateState.call(this,c,x);let p=this.getModels()[0]!==f[0];this._postUpdate(c,p)}finally{i.viewport=n,this.props=r,this._clearChangeFlags(),s.needsUpdate=!1,s.resetOldProps()}}_finalize(){so(Ngt,this),this.finalizeState(this.context);for(let t of this.props.extensions)t.finalizeState.call(this,this.context,t)}_drawLayer({renderPass:t,moduleParameters:r=null,uniforms:i={},parameters:s={}}){this._updateAttributeTransition();let n=this.props,o=this.context;this.props=this.internalState.propsInTransition||n;let c=this.props.opacity;i.opacity=Math.pow(c,1/2.2);try{if(r){let{isActive:x,isAttribute:E}=r.picking;this.setModuleParameters(r),this.setShaderModuleProps({picking:{isActive:x,isAttribute:E}})}let{getPolygonOffset:f}=this.props,p=f&&f(i)||[0,0];o.device.setParametersWebGL({polygonOffset:p});for(let x of this.getModels())x.setParameters(s);o.device.withParametersWebGL(s,()=>{let x={renderPass:t,moduleParameters:r,uniforms:i,parameters:s,context:o};for(let E of this.props.extensions)E.draw.call(this,x,E);this.draw(x)})}finally{this.props=n}}getChangeFlags(){return this.internalState?.changeFlags}setChangeFlags(t){if(!this.internalState)return;let{changeFlags:r}=this.internalState;for(let s in t)if(t[s]){let n=!1;switch(s){case"dataChanged":let o=t[s],c=r[s];o&&Array.isArray(c)&&(r.dataChanged=Array.isArray(o)?c.concat(o):o,n=!0);default:r[s]||(r[s]=t[s],n=!0)}n&&so(Dgt,this,s,t)}let i=!!(r.dataChanged||r.updateTriggersChanged||r.propsChanged||r.extensionsChanged);r.propsOrDataChanged=i,r.somethingChanged=i||r.viewportChanged||r.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(t,r){let i=gH(t,r);if(i.updateTriggersChanged)for(let s in i.updateTriggersChanged)i.updateTriggersChanged[s]&&this.invalidateAttribute(s);if(i.transitionsChanged)for(let s in i.transitionsChanged)this.internalState.uniformTransitions.add(s,r[s],t[s],t.transitions?.[s]);return this.setChangeFlags(i)}validateProps(){mH(this.props)}updateAutoHighlight(t){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(t)}_updateAutoHighlight(t){let r={highlightedObjectColor:t.picked?t.color:null},{highlightColor:i}=this.props;t.picked&&typeof i=="function"&&(r.highlightColor=i(t)),this.setShaderModuleProps({picking:r}),this.setNeedsRedraw()}_getAttributeManager(){let t=this.context;return new Kv(t.device,{id:this.props.id,stats:t.stats,timeline:t.timeline})}_postUpdate(t,r){let{props:i,oldProps:s}=t;this.setNeedsRedraw(),this._updateAttributes();let n=this.state.model;n?.isInstanced&&n.setInstanceCount(this.getNumInstances());let{autoHighlight:o,highlightedObjectIndex:c,highlightColor:f}=i;if(r||s.autoHighlight!==o||s.highlightedObjectIndex!==c||s.highlightColor!==f){let p={};o||(p.highlightedObjectColor=null),Array.isArray(f)&&(p.highlightColor=f),(r||c!==s.highlightedObjectIndex)&&(p.highlightedObjectColor=Number.isFinite(c)&&c>=0?this.encodePickingColor(c):null),this.setShaderModuleProps({picking:p})}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(t){if(!this.internalState)return!1;let r=!1;r=r||this.internalState.needsRedraw&&this.id;let i=this.getAttributeManager(),s=i?i.getNeedsRedraw(t):!1;if(r=r||s,r)for(let n of this.props.extensions)n.onNeedsRedraw.call(this,n);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!t.clearRedrawFlags,r}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}};var Vgt="compositeLayer.renderLayers",EA=class extends zu{static{this.layerName="CompositeLayer"}get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(t=>t.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(t){}setState(t){super.setState(t),this.setNeedsUpdate()}getPickingInfo({info:t}){let{object:r}=t;return r&&r.__source&&r.__source.parent&&r.__source.parent.id===this.id&&(t.object=r.__source.object,t.index=r.__source.index),t}filterSubLayer(t){return!0}shouldRenderSubLayer(t,r){return r&&r.length}getSubLayerClass(t,r){let{_subLayerProps:i}=this.props;return i&&i[t]&&i[t].type||r}getSubLayerRow(t,r,i){return t.__source={parent:this,object:r,index:i},t}getSubLayerAccessor(t){if(typeof t=="function"){let r={index:-1,data:this.props.data,target:[]};return(i,s)=>i&&i.__source?(r.index=i.__source.index,t(i.__source.object,r)):t(i,s)}return t}getSubLayerProps(t={}){let{opacity:r,pickable:i,visible:s,parameters:n,getPolygonOffset:o,highlightedObjectIndex:c,autoHighlight:f,highlightColor:p,coordinateSystem:x,coordinateOrigin:E,wrapLongitude:T,positionFormat:D,modelMatrix:N,extensions:z,fetch:U,operation:H,_subLayerProps:G}=this.props,Z={id:"",updateTriggers:{},opacity:r,pickable:i,visible:s,parameters:n,getPolygonOffset:o,highlightedObjectIndex:c,autoHighlight:f,highlightColor:p,coordinateSystem:x,coordinateOrigin:E,wrapLongitude:T,positionFormat:D,modelMatrix:N,extensions:z,fetch:U,operation:H},Y=G&&t.id&&G[t.id],st=Y&&Y.updateTriggers,at=t.id||"sublayer";if(Y){let Dt=this.props[Ou],Tt=t.type?t.type._propTypes:{};for(let kt in Y){let Et=Tt[kt]||Dt[kt];Et&&Et.type==="accessor"&&(Y[kt]=this.getSubLayerAccessor(Y[kt]))}}Object.assign(Z,t,Y),Z.id=`${this.props.id}-${at}`,Z.updateTriggers={all:this.props.updateTriggers?.all,...t.updateTriggers,...st};for(let Dt of z){let Tt=Dt.getSubLayerProps.call(this,Dt);Tt&&Object.assign(Z,Tt,{updateTriggers:Object.assign(Z.updateTriggers,Tt.updateTriggers)})}return Z}_updateAutoHighlight(t){for(let r of this.getSubLayers())r.updateAutoHighlight(t)}_getAttributeManager(){return null}_postUpdate(t,r){let i=this.internalState.subLayers,s=!i||this.needsUpdate();if(s){let n=this.renderLayers();i=Nu(n,Boolean),this.internalState.subLayers=i}so(Vgt,this,s,i);for(let n of i)n.parent=this}};var IA=class{constructor(t){this.indexStarts=[0],this.vertexStarts=[0],this.vertexCount=0,this.instanceCount=0;let{attributes:r={}}=t;this.typedArrayManager=Nh,this.attributes={},this._attributeDefs=r,this.opts=t,this.updateGeometry(t)}updateGeometry(t){Object.assign(this.opts,t);let{data:r,buffers:i={},getGeometry:s,geometryBuffer:n,positionFormat:o,dataChanged:c,normalize:f=!0}=this.opts;if(this.data=r,this.getGeometry=s,this.positionSize=n&&n.size||(o==="XY"?2:3),this.buffers=i,this.normalize=f,n&&(Qn(r.startIndices),this.getGeometry=this.getGeometryFromBuffer(n),f||(i.vertexPositions=n)),this.geometryBuffer=i.vertexPositions,Array.isArray(c))for(let p of c)this._rebuildGeometry(p);else this._rebuildGeometry()}updatePartialGeometry({startRow:t,endRow:r}){this._rebuildGeometry({startRow:t,endRow:r})}getGeometryFromBuffer(t){let r=t.value||t;return ArrayBuffer.isView(r)?kS(r,{size:this.positionSize,offset:t.offset,stride:t.stride,startIndices:this.data.startIndices}):null}_allocate(t,r){let{attributes:i,buffers:s,_attributeDefs:n,typedArrayManager:o}=this;for(let c in n)if(c in s)o.release(i[c]),i[c]=null;else{let f=n[c];f.copy=r,i[c]=o.allocate(i[c],t,f)}}_forEachGeometry(t,r,i){let{data:s,getGeometry:n}=this,{iterable:o,objectInfo:c}=Pd(s,r,i);for(let f of o){c.index++;let p=n?n(f,c):null;t(p,c.index)}}_rebuildGeometry(t){if(!this.data)return;let{indexStarts:r,vertexStarts:i,instanceCount:s}=this,{data:n,geometryBuffer:o}=this,{startRow:c=0,endRow:f=1/0}=t||{},p={};if(t||(r=[0],i=[0]),this.normalize||!o)this._forEachGeometry((E,T)=>{let D=E&&this.normalizeGeometry(E);p[T]=D,i[T+1]=i[T]+(D?this.getGeometrySize(D):0)},c,f),s=i[i.length-1];else if(i=n.startIndices,s=i[n.length]||0,ArrayBuffer.isView(o))s=s||o.length/this.positionSize;else if(o instanceof Tn){let E=this.positionSize*4;s=s||o.byteLength/E}else if(o.buffer){let E=o.stride||this.positionSize*4;s=s||o.buffer.byteLength/E}else if(o.value){let E=o.value,T=o.stride/E.BYTES_PER_ELEMENT||this.positionSize;s=s||E.length/T}this._allocate(s,!!t),this.indexStarts=r,this.vertexStarts=i,this.instanceCount=s;let x={};this._forEachGeometry((E,T)=>{let D=p[T]||E;x.vertexStart=i[T],x.indexStart=r[T];let N=T<i.length-1?i[T+1]:s;x.geometrySize=N-i[T],x.geometryIndex=T,this.updateGeometryAttributes(D,x)},c,f),this.vertexCount=r[r.length-1]}};var I7=512,jgt=Math.PI/180;function US({map:e,gl:t,deck:r}){if(e.__deck)return e.__deck;let i=r?.props._customRender,s=r?.props.onLoad,n=C7({...r?.props,_customRender:()=>{e.triggerRepaint(),i?.("")}}),o;return(!r||r.props.gl===t)&&(Object.assign(n,{gl:t,width:null,height:null,touchAction:"unset",viewState:Ly(e)}),r?.isInitialized?EH(r,e):n.onLoad=()=>{s?.(),EH(o,e)}),r?(o=r,r.setProps(n),r.userData.isExternal=!0):(o=new Cd(n),e.on("remove",()=>{M7(e)})),o.userData.mapboxLayers=new Set,e.__deck=o,e.on("render",()=>{o.isInitialized&&Hgt(o,e)}),o}function EH(e,t){let r=()=>{e.isInitialized?Wgt(e,t):t.off("move",r)};t.on("move",r)}function M7(e){e.__deck?.finalize(),e.__deck=null}function C7(e){return{...e,parameters:{depthMask:!0,depthTest:!0,blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthFunc:515,blendEquation:32774,...e.parameters},views:e.views||[new bA({id:"mapbox"})]}}function IH(e,t){e.userData.mapboxLayers.add(t),P7(e)}function MH(e,t){e.userData.mapboxLayers.delete(t),P7(e)}function CH(e,t){P7(e)}function PH(e,t,r){let{currentViewport:i}=e.userData,s=!1;i||(i=RH(e,t,!0),e.userData.currentViewport=i,s=!0),e.isInitialized&&e._drawLayers("mapbox-repaint",{viewports:[i],layerFilter:({layer:n})=>r.id===n.id||n.props.operation.includes("terrain"),clearStack:s,clearCanvas:!1})}function Ly(e){let{lng:t,lat:r}=e.getCenter(),i={longitude:(t+540)%360-180,latitude:r,zoom:e.getZoom(),bearing:e.getBearing(),pitch:e.getPitch(),padding:e.getPadding(),repeat:e.getRenderWorldCopies()};return e.getTerrain?.()&&$gt(e,i),i}function $gt(e,t){if(e.getFreeCameraOptions){let{position:r}=e.getFreeCameraOptions();if(!r||r.z===void 0)return;let i=e.transform.height,{longitude:s,latitude:n,pitch:o}=t,c=r.x*I7,f=(1-r.y)*I7,p=r.z*I7,x=Oh([s,n]),E=c-x[0],T=f-x[1],D=Math.sqrt(E*E+T*T),N=o*jgt,z=1.5*i,U=N<.001?z*Math.cos(N)/p:z*Math.sin(N)/D;t.zoom=Math.log2(U);let H=z*Math.cos(N)/U,G=p-H;t.position=[0,0,G/Pg(n)]}else typeof e.transform.elevation=="number"&&(t.position=[0,0,e.transform.elevation])}function RH(e,t,r=!0){return new qf({id:"mapbox",x:0,y:0,width:e.width,height:e.height,...Ly(t),nearZMultiplier:r?.02:.1,nearZ:t.transform._nearZ/t.transform.height,farZ:t.transform._farZ/t.transform.height})}function Hgt(e,t){let{mapboxLayers:r,isExternal:i}=e.userData;if(i){let s=Array.from(r,x=>x.id),o=Nu(e.props.layers,Boolean).some(x=>x&&!s.includes(x.id)),c=e.getViewports(),f=c.findIndex(x=>x.id==="mapbox"),p=c.length>1||f<0;(o||p)&&(f>=0&&(c=c.slice(),c[f]=RH(e,t,!1)),e._drawLayers("mapbox-repaint",{viewports:c,layerFilter:x=>(!e.props.layerFilter||e.props.layerFilter(x))&&(x.viewport.id!=="mapbox"||!s.includes(x.layer.id)),clearCanvas:!1}))}e.userData.currentViewport=null}function Wgt(e,t){e.setProps({viewState:Ly(t)}),e.needsRedraw({clearRedrawFlags:!0})}function P7(e){if(e.userData.isExternal)return;let t=[];e.userData.mapboxLayers.forEach(r=>{let i=r.props.type,s=new i(r.props);t.push(s)}),e.setProps({layers:t})}var ow=class{constructor(t){if(!t.id)throw new Error("Layer must have an unique id");this.id=t.id,this.type="custom",this.renderingMode=t.renderingMode||"3d",this.map=null,this.deck=null,this.props=t}onAdd(t,r){this.map=t,this.deck=US({map:t,gl:r,deck:this.props.deck}),IH(this.deck,this)}onRemove(){this.deck&&MH(this.deck,this)}setProps(t){Object.assign(this.props,t,{id:this.id}),this.deck&&CH(this.deck,this)}render(){PH(this.deck,this.map,this)}};var R7="__UNDEFINED__";function aw(e,t,r,i){if(!e||!t||!e.style||!e.style._loaded)return;let s=Nu(i,Boolean);if(r!==i){let c=Nu(r,Boolean),f=new Set(c.map(p=>p.id));for(let p of s)f.delete(p.id);for(let p of f)e.getLayer(p)&&e.removeLayer(p)}for(let c of s){let f=e.getLayer(c.id);f?f.implementation.setProps(c.props):e.addLayer(new ow({id:c.id,deck:t}),c.props.beforeId)}let n=e.style._order,o={};for(let c of s){let{beforeId:f}=c.props;(!f||!n.includes(f))&&(f=R7),o[f]=o[f]||[],o[f].push(c.id)}for(let c in o){let f=o[c],p=c===R7?n.length:n.indexOf(c),x=c===R7?void 0:c;for(let E=f.length-1;E>=0;E--){let T=f[E],D=n.indexOf(T);D!==p-1&&(e.moveLayer(T,x),D>p&&p++),p--,x=T}}}var zy=class{constructor(t){this._handleStyleChange=()=>{aw(this._map,this._deck,this._props.layers,this._props.layers)},this._updateContainerSize=()=>{if(this._map&&this._container){let{clientWidth:s,clientHeight:n}=this._map.getContainer();Object.assign(this._container.style,{width:`${s}px`,height:`${n}px`})}},this._updateViewState=()=>{let s=this._deck;s&&(s.setProps({viewState:Ly(this._map)}),s.isInitialized&&s.redraw())},this._handleMouseEvent=s=>{let n=this._deck;if(!n||!n.isInitialized)return;let o={type:s.type,offsetCenter:s.point,srcEvent:s},c=this._lastMouseDownPoint;switch(!s.point&&c&&(o.deltaX=s.originalEvent.clientX-c.clientX,o.deltaY=s.originalEvent.clientY-c.clientY,o.offsetCenter={x:c.x+o.deltaX,y:c.y+o.deltaY}),o.type){case"mousedown":n._onPointerDown(o),this._lastMouseDownPoint={...s.point,clientX:s.originalEvent.clientX,clientY:s.originalEvent.clientY};break;case"dragstart":o.type="panstart",n._onEvent(o);break;case"drag":o.type="panmove",n._onEvent(o);break;case"dragend":o.type="panend",n._onEvent(o);break;case"click":o.tapCount=1,n._onEvent(o);break;case"dblclick":o.type="click",o.tapCount=2,n._onEvent(o);break;case"mousemove":o.type="pointermove",n._onPointerMove(o);break;case"mouseout":o.type="pointerleave",n._onPointerMove(o);break;default:return}};let{interleaved:r=!1,...i}=t;this._interleaved=r,this._props=i}setProps(t){this._interleaved&&t.layers&&aw(this._map,this._deck,this._props.layers,t.layers),Object.assign(this._props,t),this._deck&&this._deck.setProps(this._interleaved?C7(this._props):this._props)}onAdd(t){return this._map=t,this._interleaved?this._onAddInterleaved(t):this._onAddOverlaid(t)}_onAddOverlaid(t){let r=document.createElement("div");return Object.assign(r.style,{position:"absolute",left:0,top:0,textAlign:"initial",pointerEvents:"none"}),this._container=r,this._deck=new Cd({...this._props,parent:r,viewState:Ly(t)}),t.on("resize",this._updateContainerSize),t.on("render",this._updateViewState),t.on("mousedown",this._handleMouseEvent),t.on("dragstart",this._handleMouseEvent),t.on("drag",this._handleMouseEvent),t.on("dragend",this._handleMouseEvent),t.on("mousemove",this._handleMouseEvent),t.on("mouseout",this._handleMouseEvent),t.on("click",this._handleMouseEvent),t.on("dblclick",this._handleMouseEvent),this._updateContainerSize(),r}_onAddInterleaved(t){let r=t.painter.context.gl;return r instanceof WebGLRenderingContext&&mi.warn("Incompatible basemap library. See: https://deck.gl/docs/api-reference/mapbox/overview#compatibility")(),this._deck=US({map:t,gl:r,deck:new Cd({...this._props,gl:r})}),t.on("styledata",this._handleStyleChange),aw(t,this._deck,[],this._props.layers),document.createElement("div")}onRemove(){let t=this._map;t&&(this._interleaved?this._onRemoveInterleaved(t):this._onRemoveOverlaid(t)),this._deck=void 0,this._map=void 0,this._container=void 0}_onRemoveOverlaid(t){t.off("resize",this._updateContainerSize),t.off("render",this._updateViewState),t.off("mousedown",this._handleMouseEvent),t.off("dragstart",this._handleMouseEvent),t.off("drag",this._handleMouseEvent),t.off("dragend",this._handleMouseEvent),t.off("mousemove",this._handleMouseEvent),t.off("mouseout",this._handleMouseEvent),t.off("click",this._handleMouseEvent),t.off("dblclick",this._handleMouseEvent),this._deck?.finalize()}_onRemoveInterleaved(t){t.off("styledata",this._handleStyleChange),aw(t,this._deck,this._props.layers,[]),M7(t)}getDefaultPosition(){return"top-left"}pickObject(t){return Qn(this._deck),this._deck.pickObject(t)}pickMultipleObjects(t){return Qn(this._deck),this._deck.pickMultipleObjects(t)}pickObjects(t){return Qn(this._deck),this._deck.pickObjects(t)}finalize(){this._map&&this._map.removeControl(this)}getCanvas(){return this._map?this._interleaved?this._map.getCanvas():this._deck.getCanvas():null}};var Uy={CLOCKWISE:1,COUNTER_CLOCKWISE:-1};function $g(e,t,r={}){return kH(e,r)!==t?(qgt(e,r),!0):!1}function kH(e,t={}){return Math.sign(VS(e,t))}var k7={x:0,y:1,z:2};function VS(e,t={}){let{start:r=0,end:i=e.length,plane:s="xy"}=t,n=t.size||2,o=0,c=k7[s[0]],f=k7[s[1]];for(let p=r,x=i-n;p<i;p+=n)o+=(e[p+c]-e[x+c])*(e[p+f]+e[x+f]),x=p;return o/2}function qgt(e,t){let{start:r=0,end:i=e.length,size:s=2}=t,n=(i-r)/s,o=Math.floor(n/2);for(let c=0;c<o;++c){let f=r+c*s,p=r+(n-1-c)*s;for(let x=0;x<s;++x){let E=e[f+x];e[f+x]=e[p+x],e[p+x]=E}}}function hc(e,t){let r=t.length,i=e.length;if(i>0){let s=!0;for(let n=0;n<r;n++)if(e[i-r+n]!==t[n]){s=!1;break}if(s)return!1}for(let s=0;s<r;s++)e[i+s]=t[s];return!0}function lw(e,t){let r=t.length;for(let i=0;i<r;i++)e[i]=t[i]}function MA(e,t,r,i,s=[]){let n=i+t*r;for(let o=0;o<r;o++)s[o]=e[n+o];return s}function jS(e,t,r,i,s=[]){let n,o;if(r&8)n=(i[3]-e[1])/(t[1]-e[1]),o=3;else if(r&4)n=(i[1]-e[1])/(t[1]-e[1]),o=1;else if(r&2)n=(i[2]-e[0])/(t[0]-e[0]),o=2;else if(r&1)n=(i[0]-e[0])/(t[0]-e[0]),o=0;else return null;for(let c=0;c<e.length;c++)s[c]=(o&1)===c?i[o]:n*(t[c]-e[c])+e[c];return s}function cw(e,t){let r=0;return e[0]<t[0]?r|=1:e[0]>t[2]&&(r|=2),e[1]<t[1]?r|=4:e[1]>t[3]&&(r|=8),r}function uw(e,t){let{size:r=2,broken:i=!1,gridResolution:s=10,gridOffset:n=[0,0],startIndex:o=0,endIndex:c=e.length}=t||{},f=(c-o)/r,p=[],x=[p],E=MA(e,0,r,o),T,D,N=OH(E,s,n,[]),z=[];hc(p,E);for(let U=1;U<f;U++){for(T=MA(e,U,r,o,T),D=cw(T,N);D;){jS(E,T,D,N,z);let H=cw(z,N);H&&(jS(E,z,H,N,z),D=H),hc(p,z),lw(E,z),Zgt(N,s,D),i&&p.length>r&&(p=[],x.push(p),hc(p,E)),D=cw(T,N)}hc(p,T),lw(E,T)}return i?x:x[0]}var DH=0,Xgt=1;function hw(e,t=null,r){if(!e.length)return[];let{size:i=2,gridResolution:s=10,gridOffset:n=[0,0],edgeTypes:o=!1}=r||{},c=[],f=[{pos:e,types:o?new Array(e.length/i).fill(Xgt):null,holes:t||[]}],p=[[],[]],x=[];for(;f.length;){let{pos:E,types:T,holes:D}=f.shift();Ggt(E,i,D[0]||E.length,p),x=OH(p[0],s,n,x);let N=cw(p[1],x);if(N){let z=BH(E,T,i,0,D[0]||E.length,x,N),U={pos:z[0].pos,types:z[0].types,holes:[]},H={pos:z[1].pos,types:z[1].types,holes:[]};f.push(U,H);for(let G=0;G<D.length;G++)z=BH(E,T,i,D[G],D[G+1]||E.length,x,N),z[0]&&(U.holes.push(U.pos.length),U.pos=$S(U.pos,z[0].pos),o&&(U.types=$S(U.types,z[0].types))),z[1]&&(H.holes.push(H.pos.length),H.pos=$S(H.pos,z[1].pos),o&&(H.types=$S(H.types,z[1].types)))}else{let z={positions:E};o&&(z.edgeTypes=T),D.length&&(z.holeIndices=D),c.push(z)}}return c}function BH(e,t,r,i,s,n,o){let c=(s-i)/r,f=[],p=[],x=[],E=[],T=[],D,N,z,U=MA(e,c-1,r,i),H=Math.sign(o&8?U[1]-n[3]:U[0]-n[2]),G=t&&t[c-1],Z=0,Y=0;for(let st=0;st<c;st++)D=MA(e,st,r,i,D),N=Math.sign(o&8?D[1]-n[3]:D[0]-n[2]),z=t&&t[i/r+st],N&&H&&H!==N&&(jS(U,D,o,n,T),hc(f,T)&&x.push(G),hc(p,T)&&E.push(G)),N<=0?(hc(f,D)&&x.push(z),Z-=N):x.length&&(x[x.length-1]=DH),N>=0?(hc(p,D)&&E.push(z),Y+=N):E.length&&(E[E.length-1]=DH),lw(U,D),H=N,G=z;return[Z?{pos:f,types:t&&x}:null,Y?{pos:p,types:t&&E}:null]}function OH(e,t,r,i){let s=Math.floor((e[0]-r[0])/t)*t+r[0],n=Math.floor((e[1]-r[1])/t)*t+r[1];return i[0]=s,i[1]=n,i[2]=s+t,i[3]=n+t,i}function Zgt(e,t,r){r&8?(e[1]+=t,e[3]+=t):r&4?(e[1]-=t,e[3]-=t):r&2?(e[0]+=t,e[2]+=t):r&1&&(e[0]-=t,e[2]-=t)}function Ggt(e,t,r,i){let s=1/0,n=-1/0,o=1/0,c=-1/0;for(let f=0;f<r;f+=t){let p=e[f],x=e[f+1];s=p<s?p:s,n=p>n?p:n,o=x<o?x:o,c=x>c?x:c}return i[0][0]=s,i[0][1]=o,i[1][0]=n,i[1][1]=c,i}function $S(e,t){for(let r=0;r<t.length;r++)e.push(t[r]);return e}var Qgt=85.051129;function D7(e,t){let{size:r=2,startIndex:i=0,endIndex:s=e.length,normalize:n=!0}=t||{},o=e.slice(i,s);NH(o,r,0,s-i);let c=uw(o,{size:r,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(n)for(let f of c)FH(f,r);return c}function B7(e,t=null,r){let{size:i=2,normalize:s=!0,edgeTypes:n=!1}=r||{};t=t||[];let o=[],c=[],f=0,p=0;for(let E=0;E<=t.length;E++){let T=t[E]||e.length,D=p,N=Kgt(e,i,f,T);for(let z=N;z<T;z++)o[p++]=e[z];for(let z=f;z<N;z++)o[p++]=e[z];NH(o,i,D,p),Jgt(o,i,D,p,r?.maxLatitude),f=T,c[E]=p}c.pop();let x=hw(o,c,{size:i,gridResolution:360,gridOffset:[-180,-180],edgeTypes:n});if(s)for(let E of x)FH(E.positions,i);return x}function Kgt(e,t,r,i){let s=-1,n=-1;for(let o=r+1;o<i;o+=t){let c=Math.abs(e[o]);c>s&&(s=c,n=o-1)}return n}function Jgt(e,t,r,i,s=Qgt){let n=e[r],o=e[i-t];if(Math.abs(n-o)>180){let c=MA(e,0,t,r);c[0]+=Math.round((o-n)/360)*360,hc(e,c),c[1]=Math.sign(c[1])*s,hc(e,c),c[0]=n,hc(e,c)}}function NH(e,t,r,i){let s=e[0],n;for(let o=r;o<i;o+=t){n=e[o];let c=n-s;(c>180||c<-180)&&(n-=Math.round(c/360)*360),e[o]=s=n}}function FH(e,t){let r,i=e.length/t;for(let n=0;n<i&&(r=e[n*t],(r+180)%360===0);n++);let s=-Math.round(r/360)*360;if(s!==0)for(let n=0;n<i;n++)e[n*t]+=s}var fw=class extends Yf{constructor(t){let{indices:r,attributes:i}=e1t(t);super({...t,indices:r,attributes:i})}};function e1t(e){let{radius:t,height:r=1,nradial:i=10}=e,{vertices:s}=e;s&&(mi.assert(s.length>=i),s=s.flatMap(D=>[D[0],D[1]]),$g(s,Uy.COUNTER_CLOCKWISE));let n=r>0,o=i+1,c=n?o*3+1:i,f=Math.PI*2/i,p=new Uint16Array(n?i*3*2:0),x=new Float32Array(c*3),E=new Float32Array(c*3),T=0;if(n){for(let D=0;D<o;D++){let N=D*f,z=D%i,U=Math.sin(N),H=Math.cos(N);for(let G=0;G<2;G++)x[T+0]=s?s[z*2]:H*t,x[T+1]=s?s[z*2+1]:U*t,x[T+2]=(1/2-G)*r,E[T+0]=s?s[z*2]:H,E[T+1]=s?s[z*2+1]:U,T+=3}x[T+0]=x[T-3],x[T+1]=x[T-2],x[T+2]=x[T-1],T+=3}for(let D=n?0:1;D<o;D++){let N=Math.floor(D/2)*Math.sign(.5-D%2),z=N*f,U=(N+i)%i,H=Math.sin(z),G=Math.cos(z);x[T+0]=s?s[U*2]:G*t,x[T+1]=s?s[U*2+1]:H*t,x[T+2]=r/2,E[T+2]=1,T+=3}if(n){let D=0;for(let N=0;N<i;N++)p[D++]=N*2+0,p[D++]=N*2+2,p[D++]=N*2+0,p[D++]=N*2+1,p[D++]=N*2+1,p[D++]=N*2+3}return{indices:p,attributes:{POSITION:{size:3,value:x},NORMAL:{size:3,value:E}}}}var LH=`#version 300 es
#define SHADER_NAME column-layer-vertex-shader
in vec3 positions;
in vec3 normals;
in vec3 instancePositions;
in float instanceElevations;
in vec3 instancePositions64Low;
in vec4 instanceFillColors;
in vec4 instanceLineColors;
in float instanceStrokeWidths;
in vec3 instancePickingColors;
uniform float opacity;
uniform float radius;
uniform float angle;
uniform vec2 offset;
uniform bool extruded;
uniform bool stroked;
uniform bool isStroke;
uniform float coverage;
uniform float elevationScale;
uniform float edgeDistance;
uniform float widthScale;
uniform float widthMinPixels;
uniform float widthMaxPixels;
uniform int radiusUnits;
uniform int widthUnits;
out vec4 vColor;
#ifdef FLAT_SHADING
out vec4 position_commonspace;
#endif
void main(void) {
geometry.worldPosition = instancePositions;
vec4 color = isStroke ? instanceLineColors : instanceFillColors;
mat2 rotationMatrix = mat2(cos(angle), sin(angle), -sin(angle), cos(angle));
float elevation = 0.0;
float strokeOffsetRatio = 1.0;
if (extruded) {
elevation = instanceElevations * (positions.z + 1.0) / 2.0 * elevationScale;
} else if (stroked) {
float widthPixels = clamp(
project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),
widthMinPixels, widthMaxPixels) / 2.0;
float halfOffset = project_pixel_size(widthPixels) / project_size(edgeDistance * coverage * radius);
if (isStroke) {
strokeOffsetRatio -= sign(positions.z) * halfOffset;
} else {
strokeOffsetRatio -= halfOffset;
}
}
float shouldRender = float(color.a > 0.0 && instanceElevations >= 0.0);
float dotRadius = radius * coverage * shouldRender;
geometry.pickingColor = instancePickingColors;
vec3 centroidPosition = vec3(instancePositions.xy, instancePositions.z + elevation);
vec3 centroidPosition64Low = instancePositions64Low;
vec2 offset = (rotationMatrix * positions.xy * strokeOffsetRatio + offset) * dotRadius;
if (radiusUnits == UNIT_METERS) {
offset = project_size(offset);
}
vec3 pos = vec3(offset, 0.);
DECKGL_FILTER_SIZE(pos, geometry);
gl_Position = project_position_to_clipspace(centroidPosition, centroidPosition64Low, pos, geometry.position);
geometry.normal = project_normal(vec3(rotationMatrix * normals.xy, normals.z));
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
if (extruded && !isStroke) {
#ifdef FLAT_SHADING
position_commonspace = geometry.position;
vColor = vec4(color.rgb, color.a * opacity);
#else
vec3 lightColor = lighting_getLightColor(color.rgb, project_uCameraPosition, geometry.position.xyz, geometry.normal);
vColor = vec4(lightColor, color.a * opacity);
#endif
} else {
vColor = vec4(color.rgb, color.a * opacity);
}
DECKGL_FILTER_COLOR(vColor, geometry);
}
`;var zH=`#version 300 es
#define SHADER_NAME column-layer-fragment-shader
precision highp float;
uniform vec3 project_uCameraPosition;
uniform bool extruded;
uniform bool isStroke;
out vec4 fragColor;
in vec4 vColor;
#ifdef FLAT_SHADING
in vec4 position_commonspace;
#endif
void main(void) {
fragColor = vColor;
geometry.uv = vec2(0.);
#ifdef FLAT_SHADING
if (extruded && !isStroke && !bool(picking.isActive)) {
vec3 normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));
fragColor.rgb = lighting_getLightColor(vColor.rgb, project_uCameraPosition, position_commonspace.xyz, normal);
}
#endif
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`;var HS=[0,0,0,255],r1t={diskResolution:{type:"number",min:4,value:20},vertices:null,radius:{type:"number",min:0,value:1e3},angle:{type:"number",value:0},offset:{type:"array",value:[0,0]},coverage:{type:"number",min:0,max:1,value:1},elevationScale:{type:"number",min:0,value:1},radiusUnits:"meters",lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,extruded:!0,wireframe:!1,filled:!0,stroked:!1,flatShading:!1,getPosition:{type:"accessor",value:e=>e.position},getFillColor:{type:"accessor",value:HS},getLineColor:{type:"accessor",value:HS},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0,getColor:{deprecatedFor:["getFillColor","getLineColor"]}},Vy=class extends zu{static{this.layerName="ColumnLayer"}static{this.defaultProps=r1t}getShaders(){let t={},{flatShading:r}=this.props;return r&&(t.FLAT_SHADING=1),super.getShaders({vs:LH,fs:zH,defines:t,modules:[dA,r?lv:Ig,gA]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceElevations:{size:1,transition:!0,accessor:"getElevation"},instanceFillColors:{size:this.props.colorFormat.length,type:"unorm8",transition:!0,accessor:"getFillColor",defaultValue:HS},instanceLineColors:{size:this.props.colorFormat.length,type:"unorm8",transition:!0,accessor:"getLineColor",defaultValue:HS},instanceStrokeWidths:{size:1,accessor:"getLineWidth",transition:!0}})}updateState(t){super.updateState(t);let{props:r,oldProps:i,changeFlags:s}=t,n=s.extensionsChanged||r.flatShading!==i.flatShading;n&&(this.state.models?.forEach(c=>c.destroy()),this.setState(this._getModels()),this.getAttributeManager().invalidateAll());let o=this.getNumInstances();this.state.fillModel.setInstanceCount(o),this.state.wireframeModel.setInstanceCount(o),(n||r.diskResolution!==i.diskResolution||r.vertices!==i.vertices||(r.extruded||r.stroked)!==(i.extruded||i.stroked))&&this._updateGeometry(r)}getGeometry(t,r,i){let s=new fw({radius:1,height:i?2:0,vertices:r,nradial:t}),n=0;if(r)for(let o=0;o<t;o++){let c=r[o],f=Math.sqrt(c[0]*c[0]+c[1]*c[1]);n+=f/t}else n=1;return this.setState({edgeDistance:Math.cos(Math.PI/t)*n}),s}_getModels(){let t=this.getShaders(),r=this.getAttributeManager().getBufferLayouts(),i=new Bl(this.context.device,{...t,id:`${this.props.id}-fill`,bufferLayout:r,isInstanced:!0}),s=new Bl(this.context.device,{...t,id:`${this.props.id}-wireframe`,bufferLayout:r,isInstanced:!0});return{fillModel:i,wireframeModel:s,models:[s,i]}}_updateGeometry({diskResolution:t,vertices:r,extruded:i,stroked:s}){let n=this.getGeometry(t,r,i||s);this.setState({fillVertexCount:n.attributes.POSITION.value.length/3});let o=this.state.fillModel,c=this.state.wireframeModel;o.setGeometry(n),o.setTopology("triangle-strip"),o.setIndexBuffer(null),c.setGeometry(n),c.setTopology("line-list")}draw({uniforms:t}){let{lineWidthUnits:r,lineWidthScale:i,lineWidthMinPixels:s,lineWidthMaxPixels:n,radiusUnits:o,elevationScale:c,extruded:f,filled:p,stroked:x,wireframe:E,offset:T,coverage:D,radius:N,angle:z}=this.props,U=this.state.fillModel,H=this.state.wireframeModel,{fillVertexCount:G,edgeDistance:Z}=this.state,Y={...t,radius:N,angle:z/180*Math.PI,offset:T,extruded:f,stroked:x,coverage:D,elevationScale:c,edgeDistance:Z,radiusUnits:wd[o],widthUnits:wd[r],widthScale:i,widthMinPixels:s,widthMaxPixels:n};f&&E&&(H.setUniforms(Y),H.setUniforms({isStroke:!0}),H.draw(this.context.renderPass)),U.setUniforms(Y),p&&(U.setVertexCount(G),U.setUniforms({isStroke:!1}),U.draw(this.context.renderPass)),!f&&x&&(U.setVertexCount(G*2/3),U.setUniforms({isStroke:!0}),U.draw(this.context.renderPass))}};function UH(e,t,r,i){let s;if(Array.isArray(e[0])){let n=e.length*t;s=new Array(n);for(let o=0;o<e.length;o++)for(let c=0;c<t;c++)s[o*t+c]=e[o][c]||0}else s=e;return r?uw(s,{size:t,gridResolution:r}):i?D7(s,{size:t}):s}var i1t=1,n1t=2,O7=4,pw=class extends IA{constructor(t){super({...t,attributes:{positions:{size:3,padding:18,initialize:!0,type:t.fp64?Float64Array:Float32Array},segmentTypes:{size:1,type:Uint8ClampedArray}}})}get(t){return this.attributes[t]}getGeometryFromBuffer(t){return this.normalize?super.getGeometryFromBuffer(t):null}normalizeGeometry(t){return this.normalize?UH(t,this.positionSize,this.opts.resolution,this.opts.wrapLongitude):t}getGeometrySize(t){if(VH(t)){let i=0;for(let s of t)i+=this.getGeometrySize(s);return i}let r=this.getPathLength(t);return r<2?0:this.isClosed(t)?r<3?0:r+2:r}updateGeometryAttributes(t,r){if(r.geometrySize!==0)if(t&&VH(t))for(let i of t){let s=this.getGeometrySize(i);r.geometrySize=s,this.updateGeometryAttributes(i,r),r.vertexStart+=s}else this._updateSegmentTypes(t,r),this._updatePositions(t,r)}_updateSegmentTypes(t,r){let i=this.attributes.segmentTypes,s=t?this.isClosed(t):!1,{vertexStart:n,geometrySize:o}=r;i.fill(0,n,n+o),s?(i[n]=O7,i[n+o-2]=O7):(i[n]+=i1t,i[n+o-2]+=n1t),i[n+o-1]=O7}_updatePositions(t,r){let{positions:i}=this.attributes;if(!i||!t)return;let{vertexStart:s,geometrySize:n}=r,o=new Array(3);for(let c=s,f=0;f<n;c++,f++)this.getPointOnPath(t,f,o),i[c*3]=o[0],i[c*3+1]=o[1],i[c*3+2]=o[2]}getPathLength(t){return t.length/this.positionSize}getPointOnPath(t,r,i=[]){let{positionSize:s}=this;r*s>=t.length&&(r+=1-t.length/s);let n=r*s;return i[0]=t[n],i[1]=t[n+1],i[2]=s===3&&t[n+2]||0,i}isClosed(t){if(!this.normalize)return!!this.opts.loop;let{positionSize:r}=this,i=t.length-r;return t[0]===t[i]&&t[1]===t[i+1]&&(r===2||t[2]===t[i+2])}};function VH(e){return Array.isArray(e[0])}var jH=`#version 300 es
#define SHADER_NAME path-layer-vertex-shader
in vec2 positions;
in float instanceTypes;
in vec3 instanceStartPositions;
in vec3 instanceEndPositions;
in vec3 instanceLeftPositions;
in vec3 instanceRightPositions;
in vec3 instanceLeftPositions64Low;
in vec3 instanceStartPositions64Low;
in vec3 instanceEndPositions64Low;
in vec3 instanceRightPositions64Low;
in float instanceStrokeWidths;
in vec4 instanceColors;
in vec3 instancePickingColors;
uniform float widthScale;
uniform float widthMinPixels;
uniform float widthMaxPixels;
uniform float jointType;
uniform float capType;
uniform float miterLimit;
uniform bool billboard;
uniform int widthUnits;
uniform float opacity;
out vec4 vColor;
out vec2 vCornerOffset;
out float vMiterLength;
out vec2 vPathPosition;
out float vPathLength;
out float vJointType;
const float EPSILON = 0.001;
const vec3 ZERO_OFFSET = vec3(0.0);
float flipIfTrue(bool flag) {
return -(float(flag) * 2. - 1.);
}
vec3 getLineJoinOffset(
vec3 prevPoint, vec3 currPoint, vec3 nextPoint,
vec2 width
) {
bool isEnd = positions.x > 0.0;
float sideOfPath = positions.y;
float isJoint = float(sideOfPath == 0.0);
vec3 deltaA3 = (currPoint - prevPoint);
vec3 deltaB3 = (nextPoint - currPoint);
mat3 rotationMatrix;
bool needsRotation = !billboard && project_needs_rotation(currPoint, rotationMatrix);
if (needsRotation) {
deltaA3 = deltaA3 * rotationMatrix;
deltaB3 = deltaB3 * rotationMatrix;
}
vec2 deltaA = deltaA3.xy / width;
vec2 deltaB = deltaB3.xy / width;
float lenA = length(deltaA);
float lenB = length(deltaB);
vec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);
vec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);
vec2 perpA = vec2(-dirA.y, dirA.x);
vec2 perpB = vec2(-dirB.y, dirB.x);
vec2 tangent = dirA + dirB;
tangent = length(tangent) > 0. ? normalize(tangent) : perpA;
vec2 miterVec = vec2(-tangent.y, tangent.x);
vec2 dir = isEnd ? dirA : dirB;
vec2 perp = isEnd ? perpA : perpB;
float L = isEnd ? lenA : lenB;
float sinHalfA = abs(dot(miterVec, perp));
float cosHalfA = abs(dot(dirA, miterVec));
float turnDirection = flipIfTrue(dirA.x * dirB.y >= dirA.y * dirB.x);
float cornerPosition = sideOfPath * turnDirection;
float miterSize = 1.0 / max(sinHalfA, EPSILON);
miterSize = mix(
min(miterSize, max(lenA, lenB) / max(cosHalfA, EPSILON)),
miterSize,
step(0.0, cornerPosition)
);
vec2 offsetVec = mix(miterVec * miterSize, perp, step(0.5, cornerPosition))
* (sideOfPath + isJoint * turnDirection);
bool isStartCap = lenA == 0.0 || (!isEnd && (instanceTypes == 1.0 || instanceTypes == 3.0));
bool isEndCap = lenB == 0.0 || (isEnd && (instanceTypes == 2.0 || instanceTypes == 3.0));
bool isCap = isStartCap || isEndCap;
if (isCap) {
offsetVec = mix(perp * sideOfPath, dir * capType * 4.0 * flipIfTrue(isStartCap), isJoint);
vJointType = capType;
} else {
vJointType = jointType;
}
vPathLength = L;
vCornerOffset = offsetVec;
vMiterLength = dot(vCornerOffset, miterVec * turnDirection);
vMiterLength = isCap ? isJoint : vMiterLength;
vec2 offsetFromStartOfPath = vCornerOffset + deltaA * float(isEnd);
vPathPosition = vec2(
dot(offsetFromStartOfPath, perp),
dot(offsetFromStartOfPath, dir)
);
geometry.uv = vPathPosition;
float isValid = step(instanceTypes, 3.5);
vec3 offset = vec3(offsetVec * width * isValid, 0.0);
if (needsRotation) {
offset = rotationMatrix * offset;
}
return offset;
}
void clipLine(inout vec4 position, vec4 refPosition) {
if (position.w < EPSILON) {
float r = (EPSILON - refPosition.w) / (position.w - refPosition.w);
position = refPosition + (position - refPosition) * r;
}
}
void main() {
geometry.pickingColor = instancePickingColors;
vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);
float isEnd = positions.x;
vec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);
vec3 prevPosition64Low = mix(instanceLeftPositions64Low, instanceStartPositions64Low, isEnd);
vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);
vec3 currPosition64Low = mix(instanceStartPositions64Low, instanceEndPositions64Low, isEnd);
vec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);
vec3 nextPosition64Low = mix(instanceEndPositions64Low, instanceRightPositions64Low, isEnd);
geometry.worldPosition = currPosition;
vec2 widthPixels = vec2(clamp(
project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),
widthMinPixels, widthMaxPixels) / 2.0);
vec3 width;
if (billboard) {
vec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64Low, ZERO_OFFSET);
vec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64Low, ZERO_OFFSET, geometry.position);
vec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64Low, ZERO_OFFSET);
clipLine(prevPositionScreen, currPositionScreen);
clipLine(nextPositionScreen, currPositionScreen);
clipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));
width = vec3(widthPixels, 0.0);
DECKGL_FILTER_SIZE(width, geometry);
vec3 offset = getLineJoinOffset(
prevPositionScreen.xyz / prevPositionScreen.w,
currPositionScreen.xyz / currPositionScreen.w,
nextPositionScreen.xyz / nextPositionScreen.w,
project_pixel_size_to_clipspace(width.xy)
);
DECKGL_FILTER_GL_POSITION(currPositionScreen, geometry);
gl_Position = vec4(currPositionScreen.xyz + offset * currPositionScreen.w, currPositionScreen.w);
} else {
prevPosition = project_position(prevPosition, prevPosition64Low);
currPosition = project_position(currPosition, currPosition64Low);
nextPosition = project_position(nextPosition, nextPosition64Low);
width = vec3(project_pixel_size(widthPixels), 0.0);
DECKGL_FILTER_SIZE(width, geometry);
vec3 offset = getLineJoinOffset(prevPosition, currPosition, nextPosition, width.xy);
geometry.position = vec4(currPosition + offset, 1.0);
gl_Position = project_common_position_to_clipspace(geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
}
DECKGL_FILTER_COLOR(vColor, geometry);
}
`;var $H=`#version 300 es
#define SHADER_NAME path-layer-fragment-shader
precision highp float;
uniform float miterLimit;
in vec4 vColor;
in vec2 vCornerOffset;
in float vMiterLength;
in vec2 vPathPosition;
in float vPathLength;
in float vJointType;
out vec4 fragColor;
void main(void) {
geometry.uv = vPathPosition;
if (vPathPosition.y < 0.0 || vPathPosition.y > vPathLength) {
if (vJointType > 0.5 && length(vCornerOffset) > 1.0) {
discard;
}
if (vJointType < 0.5 && vMiterLength > miterLimit + 1.0) {
discard;
}
}
fragColor = vColor;
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`;var HH=[0,0,0,255],s1t={widthUnits:"meters",widthScale:{type:"number",min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},jointRounded:!1,capRounded:!1,miterLimit:{type:"number",min:0,value:4},billboard:!1,_pathType:null,getPath:{type:"accessor",value:e=>e.path},getColor:{type:"accessor",value:HH},getWidth:{type:"accessor",value:1},rounded:{deprecatedFor:["jointRounded","capRounded"]}},N7={enter:(e,t)=>t.length?t.subarray(t.length-e.length):e},dw=class extends zu{static{this.defaultProps=s1t}static{this.layerName="PathLayer"}getShaders(){return super.getShaders({vs:jH,fs:$H,modules:[dA,gA]})}get wrapLongitude(){return!1}getBounds(){return this.getAttributeManager()?.getBounds(["vertexPositions"])}initializeState(){this.getAttributeManager().addInstanced({vertexPositions:{size:3,vertexOffset:1,type:"float64",fp64:this.use64bitPositions(),transition:N7,accessor:"getPath",update:this.calculatePositions,noAlloc:!0,shaderAttributes:{instanceLeftPositions:{vertexOffset:0},instanceStartPositions:{vertexOffset:1},instanceEndPositions:{vertexOffset:2},instanceRightPositions:{vertexOffset:3}}},instanceTypes:{size:1,type:"uint8",update:this.calculateSegmentTypes,noAlloc:!0},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:N7,defaultValue:1},instanceColors:{size:this.props.colorFormat.length,type:"unorm8",accessor:"getColor",transition:N7,defaultValue:HH},instancePickingColors:{size:4,type:"uint8",accessor:(i,{index:s,target:n})=>this.encodePickingColor(i&&i.__source?i.__source.index:s,n)}}),this.setState({pathTesselator:new pw({fp64:this.use64bitPositions()})})}updateState(t){super.updateState(t);let{props:r,changeFlags:i}=t,s=this.getAttributeManager();if(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getPath)){let{pathTesselator:o}=this.state,c=r.data.attributes||{};o.updateGeometry({data:r.data,geometryBuffer:c.getPath,buffers:c,normalize:!r._pathType,loop:r._pathType==="loop",getGeometry:r.getPath,positionFormat:r.positionFormat,wrapLongitude:r.wrapLongitude,resolution:this.context.viewport.resolution,dataChanged:i.dataChanged}),this.setState({numInstances:o.instanceCount,startIndices:o.vertexStarts}),i.dataChanged||s.invalidateAll()}i.extensionsChanged&&(this.state.model?.destroy(),this.state.model=this._getModel(),s.invalidateAll())}getPickingInfo(t){let r=super.getPickingInfo(t),{index:i}=r,s=this.props.data;return s[0]&&s[0].__source&&(r.object=s.find(n=>n.__source.index===i)),r}disablePickingIndex(t){let r=this.props.data;if(r[0]&&r[0].__source)for(let i=0;i<r.length;i++)r[i].__source.index===t&&this._disablePickingIndex(i);else super.disablePickingIndex(t)}draw({uniforms:t}){let{jointRounded:r,capRounded:i,billboard:s,miterLimit:n,widthUnits:o,widthScale:c,widthMinPixels:f,widthMaxPixels:p}=this.props,x=this.state.model;x.setUniforms(t),x.setUniforms({jointType:Number(r),capType:Number(i),billboard:s,widthUnits:wd[o],widthScale:c,miterLimit:n,widthMinPixels:f,widthMaxPixels:p}),x.draw(this.context.renderPass)}_getModel(){let t=[0,1,2,1,4,2,1,3,4,3,5,4],r=[0,0,0,-1,0,1,1,-1,1,1,1,0];return new Bl(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new Yf({topology:"triangle-list",attributes:{indices:new Uint16Array(t),positions:{value:new Float32Array(r),size:2}}}),isInstanced:!0})}calculatePositions(t){let{pathTesselator:r}=this.state;t.startIndices=r.vertexStarts,t.value=r.get("positions")}calculateSegmentTypes(t){let{pathTesselator:r}=this.state;t.startIndices=r.vertexStarts,t.value=r.get("segmentTypes")}};var tW=mP(ZH(),1);var ZS=Uy.CLOCKWISE,GH=Uy.COUNTER_CLOCKWISE,CA={isClosed:!0};function b1t(e){if(e=e&&e.positions||e,!Array.isArray(e)&&!ArrayBuffer.isView(e))throw new Error("invalid polygon")}function $y(e){return"positions"in e?e.positions:e}function _w(e){return"holeIndices"in e?e.holeIndices:null}function v1t(e){return Array.isArray(e[0])}function w1t(e){return e.length>=1&&e[0].length>=2&&Number.isFinite(e[0][0])}function T1t(e){let t=e[0],r=e[e.length-1];return t[0]===r[0]&&t[1]===r[1]&&t[2]===r[2]}function S1t(e,t,r,i){for(let s=0;s<t;s++)if(e[r+s]!==e[i-t+s])return!1;return!0}function QH(e,t,r,i,s){let n=t,o=r.length;for(let c=0;c<o;c++)for(let f=0;f<i;f++)e[n++]=r[c][f]||0;if(!T1t(r))for(let c=0;c<i;c++)e[n++]=r[0][c]||0;return CA.start=t,CA.end=n,CA.size=i,$g(e,s,CA),n}function KH(e,t,r,i,s=0,n,o){n=n||r.length;let c=n-s;if(c<=0)return t;let f=t;for(let p=0;p<c;p++)e[f++]=r[s+p];if(!S1t(r,i,s,n))for(let p=0;p<i;p++)e[f++]=r[s+p];return CA.start=t,CA.end=f,CA.size=i,$g(e,o,CA),f}function GS(e,t){b1t(e);let r=[],i=[];if("positions"in e){let{positions:s,holeIndices:n}=e;if(n){let o=0;for(let c=0;c<=n.length;c++)o=KH(r,o,s,t,n[c-1],n[c],c===0?ZS:GH),i.push(o);return i.pop(),{positions:r,holeIndices:i}}e=s}if(!v1t(e))return KH(r,0,e,t,0,r.length,ZS),r;if(!w1t(e)){let s=0;for(let[n,o]of e.entries())s=QH(r,s,o,t,n===0?ZS:GH),i.push(s);return i.pop(),{positions:r,holeIndices:i}}return QH(r,0,e,t,ZS),r}function V7(e,t,r){let i=e.length/3,s=0;for(let n=0;n<i;n++){let o=(n+1)%i;s+=e[n*3+t]*e[o*3+r],s-=e[o*3+t]*e[n*3+r]}return Math.abs(s/2)}function JH(e,t,r,i){let s=e.length/3;for(let n=0;n<s;n++){let o=n*3,c=e[o+0],f=e[o+1],p=e[o+2];e[o+t]=c,e[o+r]=f,e[o+i]=p}}function eW(e,t,r,i){let s=_w(e);s&&(s=s.map(c=>c/t));let n=$y(e),o=i&&t===3;if(r){let c=n.length;n=n.slice();let f=[];for(let p=0;p<c;p+=t){f[0]=n[p],f[1]=n[p+1],o&&(f[2]=n[p+2]);let x=r(f);n[p]=x[0],n[p+1]=x[1],o&&(n[p+2]=x[2])}}if(o){let c=V7(n,0,1),f=V7(n,0,2),p=V7(n,1,2);if(!c&&!f&&!p)return[];c>f&&c>p||(f>p?(r||(n=n.slice()),JH(n,0,2,1)):(r||(n=n.slice()),JH(n,2,0,1)))}return(0,tW.default)(n,s,t)}var yw=class extends IA{constructor(t){let{fp64:r,IndexType:i=Uint32Array}=t;super({...t,attributes:{positions:{size:3,type:r?Float64Array:Float32Array},vertexValid:{type:Uint16Array,size:1},indices:{type:i,size:1}}})}get(t){let{attributes:r}=this;return t==="indices"?r.indices&&r.indices.subarray(0,this.vertexCount):r[t]}updateGeometry(t){super.updateGeometry(t);let r=this.buffers.indices;if(r)this.vertexCount=(r.value||r).length;else if(this.data&&!this.getGeometry)throw new Error("missing indices buffer")}normalizeGeometry(t){if(this.normalize){let r=GS(t,this.positionSize);return this.opts.resolution?hw($y(r),_w(r),{size:this.positionSize,gridResolution:this.opts.resolution,edgeTypes:!0}):this.opts.wrapLongitude?B7($y(r),_w(r),{size:this.positionSize,maxLatitude:86,edgeTypes:!0}):r}return t}getGeometrySize(t){if(iW(t)){let r=0;for(let i of t)r+=this.getGeometrySize(i);return r}return $y(t).length/this.positionSize}getGeometryFromBuffer(t){return this.normalize||!this.buffers.indices?super.getGeometryFromBuffer(t):null}updateGeometryAttributes(t,r){if(t&&iW(t))for(let i of t){let s=this.getGeometrySize(i);r.geometrySize=s,this.updateGeometryAttributes(i,r),r.vertexStart+=s,r.indexStart=this.indexStarts[r.geometryIndex+1]}else{let i=t;this._updateIndices(i,r),this._updatePositions(i,r),this._updateVertexValid(i,r)}}_updateIndices(t,{geometryIndex:r,vertexStart:i,indexStart:s}){let{attributes:n,indexStarts:o,typedArrayManager:c}=this,f=n.indices;if(!f||!t)return;let p=s,x=eW(t,this.positionSize,this.opts.preproject,this.opts.full3d);f=c.allocate(f,s+x.length,{copy:!0});for(let E=0;E<x.length;E++)f[p++]=x[E]+i;o[r+1]=s+x.length,n.indices=f}_updatePositions(t,{vertexStart:r,geometrySize:i}){let{attributes:{positions:s},positionSize:n}=this;if(!s||!t)return;let o=$y(t);for(let c=r,f=0;f<i;c++,f++){let p=o[f*n],x=o[f*n+1],E=n>2?o[f*n+2]:0;s[c*3]=p,s[c*3+1]=x,s[c*3+2]=E}}_updateVertexValid(t,{vertexStart:r,geometrySize:i}){let{positionSize:s}=this,n=this.attributes.vertexValid,o=t&&_w(t);if(t&&t.edgeTypes?n.set(t.edgeTypes,r):n.fill(1,r,r+i),o)for(let c=0;c<o.length;c++)n[r+o[c]/s-1]=0;n[r+i-1]=0}};function iW(e){return Array.isArray(e)&&e.length>0&&!Number.isFinite(e[0])}var QS=`uniform bool extruded;
uniform bool isWireframe;
uniform float elevationScale;
uniform float opacity;
in vec4 fillColors;
in vec4 lineColors;
in vec3 pickingColors;
out vec4 vColor;
struct PolygonProps {
vec3 positions;
vec3 positions64Low;
vec3 normal;
float elevations;
};
vec3 project_offset_normal(vec3 vector) {
if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {
return normalize(vector * project_uCommonUnitsPerWorldUnit);
}
return project_normal(vector);
}
void calculatePosition(PolygonProps props) {
vec3 pos = props.positions;
vec3 pos64Low = props.positions64Low;
vec3 normal = props.normal;
vec4 colors = isWireframe ? lineColors : fillColors;
geometry.worldPosition = props.positions;
geometry.pickingColor = pickingColors;
if (extruded) {
pos.z += props.elevations * elevationScale;
}
gl_Position = project_position_to_clipspace(pos, pos64Low, vec3(0.), geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
if (extruded) {
#ifdef IS_SIDE_VERTEX
normal = project_offset_normal(normal);
#else
normal = project_normal(normal);
#endif
geometry.normal = normal;
vec3 lightColor = lighting_getLightColor(colors.rgb, project_uCameraPosition, geometry.position.xyz, geometry.normal);
vColor = vec4(lightColor, colors.a * opacity);
} else {
vColor = vec4(colors.rgb, colors.a * opacity);
}
DECKGL_FILTER_COLOR(vColor, geometry);
}
`;var nW=`#version 300 es
#define SHADER_NAME solid-polygon-layer-vertex-shader
in vec3 vertexPositions;
in vec3 vertexPositions64Low;
in float elevations;
${QS}
void main(void) {
PolygonProps props;
props.positions = vertexPositions;
props.positions64Low = vertexPositions64Low;
props.elevations = elevations;
props.normal = vec3(0.0, 0.0, 1.0);
calculatePosition(props);
}
`;var sW=`#version 300 es
#define SHADER_NAME solid-polygon-layer-vertex-shader-side
#define IS_SIDE_VERTEX
in vec2 positions;
in vec3 vertexPositions;
in vec3 nextVertexPositions;
in vec3 vertexPositions64Low;
in vec3 nextVertexPositions64Low;
in float elevations;
in float instanceVertexValid;
${QS}
void main(void) {
if(instanceVertexValid < 0.5){
gl_Position = vec4(0.);
return;
}
PolygonProps props;
vec3 pos;
vec3 pos64Low;
vec3 nextPos;
vec3 nextPos64Low;
#if RING_WINDING_ORDER_CW == 1
pos = vertexPositions;
pos64Low = vertexPositions64Low;
nextPos = nextVertexPositions;
nextPos64Low = nextVertexPositions64Low;
#else
pos = nextVertexPositions;
pos64Low = nextVertexPositions64Low;
nextPos = vertexPositions;
nextPos64Low = vertexPositions64Low;
#endif
props.positions = mix(pos, nextPos, positions.x);
props.positions64Low = mix(pos64Low, nextPos64Low, positions.x);
props.normal = vec3(
pos.y - nextPos.y + (pos64Low.y - nextPos64Low.y),
nextPos.x - pos.x + (nextPos64Low.x - pos64Low.x),
0.0);
props.elevations = elevations * positions.y;
calculatePosition(props);
}
`;var oW=`#version 300 es
#define SHADER_NAME solid-polygon-layer-fragment-shader
precision highp float;
in vec4 vColor;
out vec4 fragColor;
void main(void) {
fragColor = vColor;
geometry.uv = vec2(0.);
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`;var JS=[0,0,0,255],E1t={filled:!0,extruded:!1,wireframe:!1,_normalize:!0,_windingOrder:"CW",_full3d:!1,elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:e=>e.polygon},getElevation:{type:"accessor",value:1e3},getFillColor:{type:"accessor",value:JS},getLineColor:{type:"accessor",value:JS},material:!0},KS={enter:(e,t)=>t.length?t.subarray(t.length-e.length):e},xw=class extends zu{static{this.defaultProps=E1t}static{this.layerName="SolidPolygonLayer"}getShaders(t){return super.getShaders({vs:t==="top"?nW:sW,fs:oW,defines:{RING_WINDING_ORDER_CW:!this.props._normalize&&this.props._windingOrder==="CCW"?0:1},modules:[dA,Ig,gA]})}get wrapLongitude(){return!1}getBounds(){return this.getAttributeManager()?.getBounds(["vertexPositions"])}initializeState(){let{viewport:t}=this.context,{coordinateSystem:r}=this.props,{_full3d:i}=this.props;t.isGeospatial&&r===en.DEFAULT&&(r=en.LNGLAT);let s;r===en.LNGLAT&&(i?s=t.projectPosition.bind(t):s=t.projectFlat.bind(t)),this.setState({numInstances:0,polygonTesselator:new yw({preproject:s,fp64:this.use64bitPositions(),IndexType:Uint32Array})});let n=this.getAttributeManager(),o=!0;n.remove(["instancePickingColors"]),n.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:o},vertexPositions:{size:3,type:"float64",stepMode:"dynamic",fp64:this.use64bitPositions(),transition:KS,accessor:"getPolygon",update:this.calculatePositions,noAlloc:o,shaderAttributes:{nextVertexPositions:{vertexOffset:1}}},instanceVertexValid:{size:1,type:"uint16",stepMode:"instance",update:this.calculateVertexValid,noAlloc:o},elevations:{size:1,stepMode:"dynamic",transition:KS,accessor:"getElevation"},fillColors:{size:this.props.colorFormat.length,type:"unorm8",stepMode:"dynamic",transition:KS,accessor:"getFillColor",defaultValue:JS},lineColors:{size:this.props.colorFormat.length,type:"unorm8",stepMode:"dynamic",transition:KS,accessor:"getLineColor",defaultValue:JS},pickingColors:{size:4,type:"uint8",stepMode:"dynamic",accessor:(c,{index:f,target:p})=>this.encodePickingColor(c&&c.__source?c.__source.index:f,p)}})}getPickingInfo(t){let r=super.getPickingInfo(t),{index:i}=r,s=this.props.data;return s[0]&&s[0].__source&&(r.object=s.find(n=>n.__source.index===i)),r}disablePickingIndex(t){let r=this.props.data;if(r[0]&&r[0].__source)for(let i=0;i<r.length;i++)r[i].__source.index===t&&this._disablePickingIndex(i);else super.disablePickingIndex(t)}draw({uniforms:t}){let{extruded:r,filled:i,wireframe:s,elevationScale:n}=this.props,{topModel:o,sideModel:c,wireframeModel:f,polygonTesselator:p}=this.state,x={...t,extruded:!!r,elevationScale:n};f&&s&&(f.setInstanceCount(p.instanceCount-1),f.setUniforms(x),f.draw(this.context.renderPass)),c&&i&&(c.setInstanceCount(p.instanceCount-1),c.setUniforms(x),c.draw(this.context.renderPass)),o&&i&&(o.setVertexCount(p.vertexCount),o.setUniforms(x),o.draw(this.context.renderPass))}updateState(t){super.updateState(t),this.updateGeometry(t);let{props:r,oldProps:i,changeFlags:s}=t,n=this.getAttributeManager();(s.extensionsChanged||r.filled!==i.filled||r.extruded!==i.extruded)&&(this.state.models?.forEach(c=>c.destroy()),this.setState(this._getModels()),n.invalidateAll())}updateGeometry({props:t,oldProps:r,changeFlags:i}){if(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getPolygon)){let{polygonTesselator:n}=this.state,o=t.data.attributes||{};n.updateGeometry({data:t.data,normalize:t._normalize,geometryBuffer:o.getPolygon,buffers:o,getGeometry:t.getPolygon,positionFormat:t.positionFormat,wrapLongitude:t.wrapLongitude,resolution:this.context.viewport.resolution,fp64:this.use64bitPositions(),dataChanged:i.dataChanged,full3d:t._full3d}),this.setState({numInstances:n.instanceCount,startIndices:n.vertexStarts}),i.dataChanged||this.getAttributeManager().invalidateAll()}}_getModels(){let{id:t,filled:r,extruded:i}=this.props,s,n,o;if(r){let c=this.getShaders("top");c.defines.NON_INSTANCED_MODEL=1;let f=this.getAttributeManager().getBufferLayouts({isInstanced:!1});s=new Bl(this.context.device,{...c,id:`${t}-top`,topology:"triangle-list",uniforms:{isWireframe:!1},bufferLayout:f,isIndexed:!0,userData:{excludeAttributes:{instanceVertexValid:!0}}})}if(i){let c=this.getAttributeManager().getBufferLayouts({isInstanced:!0});n=new Bl(this.context.device,{...this.getShaders("side"),id:`${t}-side`,bufferLayout:c,uniforms:{isWireframe:!1},geometry:new Yf({topology:"triangle-strip",attributes:{positions:{size:2,value:new Float32Array([1,0,0,0,1,1,0,1])}}}),isInstanced:!0,userData:{excludeAttributes:{indices:!0}}}),o=new Bl(this.context.device,{...this.getShaders("side"),id:`${t}-wireframe`,bufferLayout:c,uniforms:{isWireframe:!0},geometry:new Yf({topology:"line-strip",attributes:{positions:{size:2,value:new Float32Array([1,0,0,0,0,1,1,1])}}}),isInstanced:!0,userData:{excludeAttributes:{indices:!0}}})}return{models:[n,o,s].filter(Boolean),topModel:s,sideModel:n,wireframeModel:o}}calculateIndices(t){let{polygonTesselator:r}=this.state;t.startIndices=r.indexStarts,t.value=r.get("indices")}calculatePositions(t){let{polygonTesselator:r}=this.state;t.startIndices=r.vertexStarts,t.value=r.get("positions")}calculateVertexValid(t){t.value=this.state.polygonTesselator.get("vertexValid")}};function aW({data:e,getIndex:t,dataRange:r,replace:i}){let{startRow:s=0,endRow:n=1/0}=r,o=e.length,c=o,f=o;for(let T=0;T<o;T++){let D=t(e[T]);if(c>T&&D>=s&&(c=T),D>=n){f=T;break}}let p=c,E=f-c!==i.length?e.slice(f):void 0;for(let T=0;T<i.length;T++)e[p++]=i[T];if(E){for(let T=0;T<E.length;T++)e[p++]=E[T];e.length=p}return{startRow:c,endRow:c+i.length}}var lW=[0,0,0,255],I1t=[0,0,0,255],M1t={stroked:!0,filled:!0,extruded:!1,elevationScale:1,wireframe:!1,_normalize:!0,_windingOrder:"CW",lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,lineJointRounded:!1,lineMiterLimit:4,getPolygon:{type:"accessor",value:e=>e.polygon},getFillColor:{type:"accessor",value:I1t},getLineColor:{type:"accessor",value:lW},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0},Wg=class extends EA{static{this.layerName="PolygonLayer"}static{this.defaultProps=M1t}initializeState(){this.state={paths:[],pathsDiff:null},this.props.getLineDashArray&&mi.removed("getLineDashArray","PathStyleExtension")()}updateState({changeFlags:t}){let r=t.dataChanged||t.updateTriggersChanged&&(t.updateTriggersChanged.all||t.updateTriggersChanged.getPolygon);if(r&&Array.isArray(t.dataChanged)){let i=this.state.paths.slice(),s=t.dataChanged.map(n=>aW({data:i,getIndex:o=>o.__source.index,dataRange:n,replace:this._getPaths(n)}));this.setState({paths:i,pathsDiff:s})}else r&&this.setState({paths:this._getPaths(),pathsDiff:null})}_getPaths(t={}){let{data:r,getPolygon:i,positionFormat:s,_normalize:n}=this.props,o=[],c=s==="XY"?2:3,{startRow:f,endRow:p}=t,{iterable:x,objectInfo:E}=Pd(r,f,p);for(let T of x){E.index++;let D=i(T,E);n&&(D=GS(D,c));let{holeIndices:N}=D,z=D.positions||D;if(N)for(let U=0;U<=N.length;U++){let H=z.slice(N[U-1]||0,N[U]||z.length);o.push(this.getSubLayerRow({path:H},T,E.index))}else o.push(this.getSubLayerRow({path:z},T,E.index))}return o}renderLayers(){let{data:t,_dataDiff:r,stroked:i,filled:s,extruded:n,wireframe:o,_normalize:c,_windingOrder:f,elevationScale:p,transitions:x,positionFormat:E}=this.props,{lineWidthUnits:T,lineWidthScale:D,lineWidthMinPixels:N,lineWidthMaxPixels:z,lineJointRounded:U,lineMiterLimit:H,lineDashJustified:G}=this.props,{getFillColor:Z,getLineColor:Y,getLineWidth:st,getLineDashArray:at,getElevation:Dt,getPolygon:Tt,updateTriggers:kt,material:Et}=this.props,{paths:Mt,pathsDiff:oe}=this.state,Xt=this.getSubLayerClass("fill",xw),xt=this.getSubLayerClass("stroke",dw),jt=this.shouldRenderSubLayer("fill",Mt)&&new Xt({_dataDiff:r,extruded:n,elevationScale:p,filled:s,wireframe:o,_normalize:c,_windingOrder:f,getElevation:Dt,getFillColor:Z,getLineColor:n&&o?Y:lW,material:Et,transitions:x},this.getSubLayerProps({id:"fill",updateTriggers:kt&&{getPolygon:kt.getPolygon,getElevation:kt.getElevation,getFillColor:kt.getFillColor,lineColors:n&&o,getLineColor:kt.getLineColor}}),{data:t,positionFormat:E,getPolygon:Tt}),Wt=!n&&i&&this.shouldRenderSubLayer("stroke",Mt)&&new xt({_dataDiff:oe&&(()=>oe),widthUnits:T,widthScale:D,widthMinPixels:N,widthMaxPixels:z,jointRounded:U,miterLimit:H,dashJustified:G,_pathType:"loop",transitions:x&&{getWidth:x.getLineWidth,getColor:x.getLineColor,getPath:x.getPolygon},getColor:this.getSubLayerAccessor(Y),getWidth:this.getSubLayerAccessor(st),getDashArray:this.getSubLayerAccessor(at)},this.getSubLayerProps({id:"stroke",updateTriggers:kt&&{getWidth:kt.getLineWidth,getColor:kt.getLineColor,getDashArray:kt.getLineDashArray}}),{data:Mt,positionFormat:E,getPath:de=>de.path});return[!n&&jt,Wt,n&&jt]}};var Z7={};sl(Z7,{UNITS:()=>fc,areNeighborCells:()=>__t,cellArea:()=>P_t,cellToBoundary:()=>q7,cellToCenterChild:()=>c_t,cellToChildPos:()=>u_t,cellToChildren:()=>l_t,cellToChildrenSize:()=>TW,cellToLatLng:()=>Xy,cellToLocalIj:()=>I_t,cellToParent:()=>Y7,cellToVertex:()=>k_t,cellToVertexes:()=>D_t,cellsToDirectedEdge:()=>y_t,cellsToMultiPolygon:()=>A_t,childPosToCell:()=>h_t,compactCells:()=>m_t,degsToRads:()=>sE,directedEdgeToBoundary:()=>S_t,directedEdgeToCells:()=>w_t,edgeLength:()=>R_t,getBaseCellNumber:()=>o_t,getDirectedEdgeDestination:()=>b_t,getDirectedEdgeOrigin:()=>x_t,getHexagonAreaAvg:()=>X7,getHexagonEdgeLengthAvg:()=>Ew,getIcosahedronFaces:()=>a_t,getNumCells:()=>N_t,getPentagons:()=>L_t,getRes0Cells:()=>F_t,getResolution:()=>Yg,greatCircleDistance:()=>C_t,gridDisk:()=>Sw,gridDiskDistances:()=>f_t,gridDistance:()=>Zy,gridPathCells:()=>E_t,gridRingUnsafe:()=>p_t,h3IndexToSplitLong:()=>Wi,isPentagon:()=>W7,isResClassIII:()=>s_t,isValidCell:()=>H7,isValidDirectedEdge:()=>v_t,isValidVertex:()=>O_t,latLngToCell:()=>Tw,localIjToCell:()=>M_t,originToDirectedEdges:()=>T_t,polygonToCells:()=>d_t,radsToDegs:()=>EW,splitLongToH3Index:()=>xW,uncompactCells:()=>g_t,vertexToLatLng:()=>B_t});var me=function(e){e=e||{};var t=typeof e<"u"?e:{},r={},i;for(i in t)t.hasOwnProperty(i)&&(r[i]=t[i]);var s=[],n="";function o(se){return t.locateFile?t.locateFile(se,n):n+se}var c;typeof document<"u"&&document.currentScript&&(n=document.currentScript.src),n.indexOf("blob:")!==0?n=n.substr(0,n.lastIndexOf("/")+1):n="",c=function(we,$e,Pr){var g=new XMLHttpRequest;g.open("GET",we,!0),g.responseType="arraybuffer",g.onload=function(){if(g.status==200||g.status==0&&g.response){$e(g.response);return}var _r=At(we);if(_r){$e(_r.buffer);return}Pr()},g.onerror=Pr,g.send(null)};var f=t.print||console.log.bind(console),p=t.printErr||console.warn.bind(console);for(i in r)r.hasOwnProperty(i)&&(t[i]=r[i]);r=null,t.arguments&&(s=t.arguments);var x=0,E=function(se){x=se},T=function(){return x},D=8;function N(se,we,$e,Pr){switch($e=$e||"i8",$e.charAt($e.length-1)==="*"&&($e="i32"),$e){case"i1":xt[se>>0]=we;break;case"i8":xt[se>>0]=we;break;case"i16":Wt[se>>1]=we;break;case"i32":Ee[se>>2]=we;break;case"i64":Ne=[we>>>0,(Vo=we,+Sr(Vo)>=1?Vo>0?(on(+Xn(Vo/4294967296),4294967295)|0)>>>0:~~+ae((Vo-+(~~Vo>>>0))/4294967296)>>>0:0)],Ee[se>>2]=Ne[0],Ee[se+4>>2]=Ne[1];break;case"float":ze[se>>2]=we;break;case"double":ke[se>>3]=we;break;default:Bc("invalid type for setValue: "+$e)}}function z(se,we,$e){switch(we=we||"i8",we.charAt(we.length-1)==="*"&&(we="i32"),we){case"i1":return xt[se>>0];case"i8":return xt[se>>0];case"i16":return Wt[se>>1];case"i32":return Ee[se>>2];case"i64":return Ee[se>>2];case"float":return ze[se>>2];case"double":return ke[se>>3];default:Bc("invalid type for getValue: "+we)}return null}var U=!1;function H(se,we){se||Bc("Assertion failed: "+we)}function G(se){var we=t["_"+se];return H(we,"Cannot call unknown function "+se+", make sure it is exported"),we}function Z(se,we,$e,Pr,g){var bn={string:function(ys){var ln=0;if(ys!=null&&ys!==0){var cn=(ys.length<<2)+1;ln=O_(cn),kt(ys,ln,cn)}return ln},array:function(ys){var ln=O_(ys.length);return Mt(ys,ln),ln}};function _r(ys){return we==="string"?Dt(ys):we==="boolean"?!!ys:ys}var ft=G(se),ro=[],Vr=0;if(Pr)for(var is=0;is<Pr.length;is++){var Nr=bn[$e[is]];Nr?(Vr===0&&(Vr=jm()),ro[is]=Nr(Pr[is])):ro[is]=Pr[is]}var Qr=ft.apply(null,ro);return Qr=_r(Qr),Vr!==0&&lb(Vr),Qr}function Y(se,we,$e,Pr){$e=$e||[];var g=$e.every(function(_r){return _r==="number"}),bn=we!=="string";return bn&&g&&!Pr?G(se):function(){return Z(se,we,$e,arguments,Pr)}}var st=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function at(se,we,$e){for(var Pr=we+$e,g=we;se[g]&&!(g>=Pr);)++g;if(g-we>16&&se.subarray&&st)return st.decode(se.subarray(we,g));for(var bn="";we<g;){var _r=se[we++];if(!(_r&128)){bn+=String.fromCharCode(_r);continue}var ft=se[we++]&63;if((_r&224)==192){bn+=String.fromCharCode((_r&31)<<6|ft);continue}var ro=se[we++]&63;if((_r&240)==224?_r=(_r&15)<<12|ft<<6|ro:_r=(_r&7)<<18|ft<<12|ro<<6|se[we++]&63,_r<65536)bn+=String.fromCharCode(_r);else{var Vr=_r-65536;bn+=String.fromCharCode(55296|Vr>>10,56320|Vr&1023)}}return bn}function Dt(se,we){return se?at(jt,se,we):""}function Tt(se,we,$e,Pr){if(!(Pr>0))return 0;for(var g=$e,bn=$e+Pr-1,_r=0;_r<se.length;++_r){var ft=se.charCodeAt(_r);if(ft>=55296&&ft<=57343){var ro=se.charCodeAt(++_r);ft=65536+((ft&1023)<<10)|ro&1023}if(ft<=127){if($e>=bn)break;we[$e++]=ft}else if(ft<=2047){if($e+1>=bn)break;we[$e++]=192|ft>>6,we[$e++]=128|ft&63}else if(ft<=65535){if($e+2>=bn)break;we[$e++]=224|ft>>12,we[$e++]=128|ft>>6&63,we[$e++]=128|ft&63}else{if($e+3>=bn)break;we[$e++]=240|ft>>18,we[$e++]=128|ft>>12&63,we[$e++]=128|ft>>6&63,we[$e++]=128|ft&63}}return we[$e]=0,$e-g}function kt(se,we,$e){return Tt(se,jt,we,$e)}var Et=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0;function Mt(se,we){xt.set(se,we)}function oe(se,we){return se%we>0&&(se+=we-se%we),se}var Xt,xt,jt,Wt,de,Ee,Se,ze,ke;function ir(se){Xt=se,t.HEAP8=xt=new Int8Array(se),t.HEAP16=Wt=new Int16Array(se),t.HEAP32=Ee=new Int32Array(se),t.HEAPU8=jt=new Uint8Array(se),t.HEAPU16=de=new Uint16Array(se),t.HEAPU32=Se=new Uint32Array(se),t.HEAPF32=ze=new Float32Array(se),t.HEAPF64=ke=new Float64Array(se)}var Ti=5267040,_i=24128,ci=t.TOTAL_MEMORY||33554432;t.buffer?Xt=t.buffer:Xt=new ArrayBuffer(ci),ci=Xt.byteLength,ir(Xt),Ee[_i>>2]=Ti;function Gr(se){for(;se.length>0;){var we=se.shift();if(typeof we=="function"){we();continue}var $e=we.func;typeof $e=="number"?we.arg===void 0?t.dynCall_v($e):t.dynCall_vi($e,we.arg):$e(we.arg===void 0?null:we.arg)}}var Fr=[],Dr=[],Le=[],Tr=[];function jr(){if(t.preRun)for(typeof t.preRun=="function"&&(t.preRun=[t.preRun]);t.preRun.length;)tn(t.preRun.shift());Gr(Fr)}function Ie(){Gr(Dr)}function Ji(){Gr(Le)}function yi(){if(t.postRun)for(typeof t.postRun=="function"&&(t.postRun=[t.postRun]);t.postRun.length;)hn(t.postRun.shift());Gr(Tr)}function tn(se){Fr.unshift(se)}function hn(se){Tr.unshift(se)}var Sr=Math.abs,ae=Math.ceil,Xn=Math.floor,on=Math.min,Qi=0,$i=null,Ro=null;function pu(se){Qi++,t.monitorRunDependencies&&t.monitorRunDependencies(Qi)}function bl(se){if(Qi--,t.monitorRunDependencies&&t.monitorRunDependencies(Qi),Qi==0&&($i!==null&&(clearInterval($i),$i=null),Ro)){var we=Ro;Ro=null,we()}}t.preloadedImages={},t.preloadedAudios={};var Uo=null,vl="data:application/octet-stream;base64,";function Xa(se){return String.prototype.startsWith?se.startsWith(vl):se.indexOf(vl)===0}var Vo,Ne;Uo="data:application/octet-stream;base64,AAAAAAAAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAAAQAAAAQAAAADAAAABgAAAAUAAAACAAAAAAAAAAIAAAADAAAAAQAAAAQAAAAGAAAAAAAAAAUAAAADAAAABgAAAAQAAAAFAAAAAAAAAAEAAAACAAAABAAAAAUAAAAGAAAAAAAAAAIAAAADAAAAAQAAAAUAAAACAAAAAAAAAAEAAAADAAAABgAAAAQAAAAGAAAAAAAAAAUAAAACAAAAAQAAAAQAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAAAAAAEAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAYAAAAAAAAABQAAAAAAAAAAAAAABAAAAAUAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAYAAAAAAAAABgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAIAAAAAAAAAAAAAAAYAAAAAAAAAAwAAAAIAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAFAAAABAAAAAAAAAABAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAYAAAAAAAAABAAAAAAAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAgAAAAQAAAADAAAACAAAAAEAAAAHAAAABgAAAAkAAAAAAAAAAwAAAAIAAAACAAAABgAAAAoAAAALAAAAAAAAAAEAAAAFAAAAAwAAAA0AAAABAAAABwAAAAQAAAAMAAAAAAAAAAQAAAB/AAAADwAAAAgAAAADAAAAAAAAAAwAAAAFAAAAAgAAABIAAAAKAAAACAAAAAAAAAAQAAAABgAAAA4AAAALAAAAEQAAAAEAAAAJAAAAAgAAAAcAAAAVAAAACQAAABMAAAADAAAADQAAAAEAAAAIAAAABQAAABYAAAAQAAAABAAAAAAAAAAPAAAACQAAABMAAAAOAAAAFAAAAAEAAAAHAAAABgAAAAoAAAALAAAAGAAAABcAAAAFAAAAAgAAABIAAAALAAAAEQAAABcAAAAZAAAAAgAAAAYAAAAKAAAADAAAABwAAAANAAAAGgAAAAQAAAAPAAAAAwAAAA0AAAAaAAAAFQAAAB0AAAADAAAADAAAAAcAAAAOAAAAfwAAABEAAAAbAAAACQAAABQAAAAGAAAADwAAABYAAAAcAAAAHwAAAAQAAAAIAAAADAAAABAAAAASAAAAIQAAAB4AAAAIAAAABQAAABYAAAARAAAACwAAAA4AAAAGAAAAIwAAABkAAAAbAAAAEgAAABgAAAAeAAAAIAAAAAUAAAAKAAAAEAAAABMAAAAiAAAAFAAAACQAAAAHAAAAFQAAAAkAAAAUAAAADgAAABMAAAAJAAAAKAAAABsAAAAkAAAAFQAAACYAAAATAAAAIgAAAA0AAAAdAAAABwAAABYAAAAQAAAAKQAAACEAAAAPAAAACAAAAB8AAAAXAAAAGAAAAAsAAAAKAAAAJwAAACUAAAAZAAAAGAAAAH8AAAAgAAAAJQAAAAoAAAAXAAAAEgAAABkAAAAXAAAAEQAAAAsAAAAtAAAAJwAAACMAAAAaAAAAKgAAAB0AAAArAAAADAAAABwAAAANAAAAGwAAACgAAAAjAAAALgAAAA4AAAAUAAAAEQAAABwAAAAfAAAAKgAAACwAAAAMAAAADwAAABoAAAAdAAAAKwAAACYAAAAvAAAADQAAABoAAAAVAAAAHgAAACAAAAAwAAAAMgAAABAAAAASAAAAIQAAAB8AAAApAAAALAAAADUAAAAPAAAAFgAAABwAAAAgAAAAHgAAABgAAAASAAAANAAAADIAAAAlAAAAIQAAAB4AAAAxAAAAMAAAABYAAAAQAAAAKQAAACIAAAATAAAAJgAAABUAAAA2AAAAJAAAADMAAAAjAAAALgAAAC0AAAA4AAAAEQAAABsAAAAZAAAAJAAAABQAAAAiAAAAEwAAADcAAAAoAAAANgAAACUAAAAnAAAANAAAADkAAAAYAAAAFwAAACAAAAAmAAAAfwAAACIAAAAzAAAAHQAAAC8AAAAVAAAAJwAAACUAAAAZAAAAFwAAADsAAAA5AAAALQAAACgAAAAbAAAAJAAAABQAAAA8AAAALgAAADcAAAApAAAAMQAAADUAAAA9AAAAFgAAACEAAAAfAAAAKgAAADoAAAArAAAAPgAAABwAAAAsAAAAGgAAACsAAAA+AAAALwAAAEAAAAAaAAAAKgAAAB0AAAAsAAAANQAAADoAAABBAAAAHAAAAB8AAAAqAAAALQAAACcAAAAjAAAAGQAAAD8AAAA7AAAAOAAAAC4AAAA8AAAAOAAAAEQAAAAbAAAAKAAAACMAAAAvAAAAJgAAACsAAAAdAAAARQAAADMAAABAAAAAMAAAADEAAAAeAAAAIQAAAEMAAABCAAAAMgAAADEAAAB/AAAAPQAAAEIAAAAhAAAAMAAAACkAAAAyAAAAMAAAACAAAAAeAAAARgAAAEMAAAA0AAAAMwAAAEUAAAA2AAAARwAAACYAAAAvAAAAIgAAADQAAAA5AAAARgAAAEoAAAAgAAAAJQAAADIAAAA1AAAAPQAAAEEAAABLAAAAHwAAACkAAAAsAAAANgAAAEcAAAA3AAAASQAAACIAAAAzAAAAJAAAADcAAAAoAAAANgAAACQAAABIAAAAPAAAAEkAAAA4AAAARAAAAD8AAABNAAAAIwAAAC4AAAAtAAAAOQAAADsAAABKAAAATgAAACUAAAAnAAAANAAAADoAAAB/AAAAPgAAAEwAAAAsAAAAQQAAACoAAAA7AAAAPwAAAE4AAABPAAAAJwAAAC0AAAA5AAAAPAAAAEgAAABEAAAAUAAAACgAAAA3AAAALgAAAD0AAAA1AAAAMQAAACkAAABRAAAASwAAAEIAAAA+AAAAKwAAADoAAAAqAAAAUgAAAEAAAABMAAAAPwAAAH8AAAA4AAAALQAAAE8AAAA7AAAATQAAAEAAAAAvAAAAPgAAACsAAABUAAAARQAAAFIAAABBAAAAOgAAADUAAAAsAAAAVgAAAEwAAABLAAAAQgAAAEMAAABRAAAAVQAAADEAAAAwAAAAPQAAAEMAAABCAAAAMgAAADAAAABXAAAAVQAAAEYAAABEAAAAOAAAADwAAAAuAAAAWgAAAE0AAABQAAAARQAAADMAAABAAAAALwAAAFkAAABHAAAAVAAAAEYAAABDAAAANAAAADIAAABTAAAAVwAAAEoAAABHAAAAWQAAAEkAAABbAAAAMwAAAEUAAAA2AAAASAAAAH8AAABJAAAANwAAAFAAAAA8AAAAWAAAAEkAAABbAAAASAAAAFgAAAA2AAAARwAAADcAAABKAAAATgAAAFMAAABcAAAANAAAADkAAABGAAAASwAAAEEAAAA9AAAANQAAAF4AAABWAAAAUQAAAEwAAABWAAAAUgAAAGAAAAA6AAAAQQAAAD4AAABNAAAAPwAAAEQAAAA4AAAAXQAAAE8AAABaAAAATgAAAEoAAAA7AAAAOQAAAF8AAABcAAAATwAAAE8AAABOAAAAPwAAADsAAABdAAAAXwAAAE0AAABQAAAARAAAAEgAAAA8AAAAYwAAAFoAAABYAAAAUQAAAFUAAABeAAAAZQAAAD0AAABCAAAASwAAAFIAAABgAAAAVAAAAGIAAAA+AAAATAAAAEAAAABTAAAAfwAAAEoAAABGAAAAZAAAAFcAAABcAAAAVAAAAEUAAABSAAAAQAAAAGEAAABZAAAAYgAAAFUAAABXAAAAZQAAAGYAAABCAAAAQwAAAFEAAABWAAAATAAAAEsAAABBAAAAaAAAAGAAAABeAAAAVwAAAFMAAABmAAAAZAAAAEMAAABGAAAAVQAAAFgAAABIAAAAWwAAAEkAAABjAAAAUAAAAGkAAABZAAAAYQAAAFsAAABnAAAARQAAAFQAAABHAAAAWgAAAE0AAABQAAAARAAAAGoAAABdAAAAYwAAAFsAAABJAAAAWQAAAEcAAABpAAAAWAAAAGcAAABcAAAAUwAAAE4AAABKAAAAbAAAAGQAAABfAAAAXQAAAE8AAABaAAAATQAAAG0AAABfAAAAagAAAF4AAABWAAAAUQAAAEsAAABrAAAAaAAAAGUAAABfAAAAXAAAAE8AAABOAAAAbQAAAGwAAABdAAAAYAAAAGgAAABiAAAAbgAAAEwAAABWAAAAUgAAAGEAAAB/AAAAYgAAAFQAAABnAAAAWQAAAG8AAABiAAAAbgAAAGEAAABvAAAAUgAAAGAAAABUAAAAYwAAAFAAAABpAAAAWAAAAGoAAABaAAAAcQAAAGQAAABmAAAAUwAAAFcAAABsAAAAcgAAAFwAAABlAAAAZgAAAGsAAABwAAAAUQAAAFUAAABeAAAAZgAAAGUAAABXAAAAVQAAAHIAAABwAAAAZAAAAGcAAABbAAAAYQAAAFkAAAB0AAAAaQAAAG8AAABoAAAAawAAAG4AAABzAAAAVgAAAF4AAABgAAAAaQAAAFgAAABnAAAAWwAAAHEAAABjAAAAdAAAAGoAAABdAAAAYwAAAFoAAAB1AAAAbQAAAHEAAABrAAAAfwAAAGUAAABeAAAAcwAAAGgAAABwAAAAbAAAAGQAAABfAAAAXAAAAHYAAAByAAAAbQAAAG0AAABsAAAAXQAAAF8AAAB1AAAAdgAAAGoAAABuAAAAYgAAAGgAAABgAAAAdwAAAG8AAABzAAAAbwAAAGEAAABuAAAAYgAAAHQAAABnAAAAdwAAAHAAAABrAAAAZgAAAGUAAAB4AAAAcwAAAHIAAABxAAAAYwAAAHQAAABpAAAAdQAAAGoAAAB5AAAAcgAAAHAAAABkAAAAZgAAAHYAAAB4AAAAbAAAAHMAAABuAAAAawAAAGgAAAB4AAAAdwAAAHAAAAB0AAAAZwAAAHcAAABvAAAAcQAAAGkAAAB5AAAAdQAAAH8AAABtAAAAdgAAAHEAAAB5AAAAagAAAHYAAAB4AAAAbAAAAHIAAAB1AAAAeQAAAG0AAAB3AAAAbwAAAHMAAABuAAAAeQAAAHQAAAB4AAAAeAAAAHMAAAByAAAAcAAAAHkAAAB3AAAAdgAAAHkAAAB0AAAAeAAAAHcAAAB1AAAAcQAAAHYAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAACAAAABQAAAAEAAAAAAAAA/////wEAAAAAAAAAAwAAAAQAAAACAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAEAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAUAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABAAAAAUAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAIAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAD/////AQAAAAAAAAADAAAABAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAUAAAABAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAEAAAD//////////wEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAAAAAAAAAAABAAAAAgAAAAYAAAAEAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAAAAAAAAAAAAQAAAAEAAAAFAAAABgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAACAAAAAAAAAAAAAAABAAAAAwAAAAcAAAAGAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAADgAAAAIAAAAAAAAAAAAAAAEAAAAAAAAACQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAIAAAAAAAAAAAAAAAEAAAAEAAAACAAAAAoAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAALAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAAAAAAAAAAAAQAAAAsAAAAPAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAIAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAgAAAAAAAAAAAAAAAQAAAAwAAAAQAAAADAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAoAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAADwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAACAAAAAAAAAAAAAAABAAAACgAAABMAAAAIAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAAAAAAAAAAAAAEAAAANAAAAEQAAAA0AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAARAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA0AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAACAAAAAAAAAAAAAAABAAAADgAAABIAAAAPAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAADwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAASAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABIAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAgAAAAAAAAAAAAAAAQAAAP//////////EwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAASAAAAAAAAABgAAAAAAAAAIQAAAAAAAAAeAAAAAAAAACAAAAADAAAAMQAAAAEAAAAwAAAAAwAAADIAAAADAAAACAAAAAAAAAAFAAAABQAAAAoAAAAFAAAAFgAAAAAAAAAQAAAAAAAAABIAAAAAAAAAKQAAAAEAAAAhAAAAAAAAAB4AAAAAAAAABAAAAAAAAAAAAAAABQAAAAIAAAAFAAAADwAAAAEAAAAIAAAAAAAAAAUAAAAFAAAAHwAAAAEAAAAWAAAAAAAAABAAAAAAAAAAAgAAAAAAAAAGAAAAAAAAAA4AAAAAAAAACgAAAAAAAAALAAAAAAAAABEAAAADAAAAGAAAAAEAAAAXAAAAAwAAABkAAAADAAAAAAAAAAAAAAABAAAABQAAAAkAAAAFAAAABQAAAAAAAAACAAAAAAAAAAYAAAAAAAAAEgAAAAEAAAAKAAAAAAAAAAsAAAAAAAAABAAAAAEAAAADAAAABQAAAAcAAAAFAAAACAAAAAEAAAAAAAAAAAAAAAEAAAAFAAAAEAAAAAEAAAAFAAAAAAAAAAIAAAAAAAAABwAAAAAAAAAVAAAAAAAAACYAAAAAAAAACQAAAAAAAAATAAAAAAAAACIAAAADAAAADgAAAAEAAAAUAAAAAwAAACQAAAADAAAAAwAAAAAAAAANAAAABQAAAB0AAAAFAAAAAQAAAAAAAAAHAAAAAAAAABUAAAAAAAAABgAAAAEAAAAJAAAAAAAAABMAAAAAAAAABAAAAAIAAAAMAAAABQAAABoAAAAFAAAAAAAAAAEAAAADAAAAAAAAAA0AAAAFAAAAAgAAAAEAAAABAAAAAAAAAAcAAAAAAAAAGgAAAAAAAAAqAAAAAAAAADoAAAAAAAAAHQAAAAAAAAArAAAAAAAAAD4AAAADAAAAJgAAAAEAAAAvAAAAAwAAAEAAAAADAAAADAAAAAAAAAAcAAAABQAAACwAAAAFAAAADQAAAAAAAAAaAAAAAAAAACoAAAAAAAAAFQAAAAEAAAAdAAAAAAAAACsAAAAAAAAABAAAAAMAAAAPAAAABQAAAB8AAAAFAAAAAwAAAAEAAAAMAAAAAAAAABwAAAAFAAAABwAAAAEAAAANAAAAAAAAABoAAAAAAAAAHwAAAAAAAAApAAAAAAAAADEAAAAAAAAALAAAAAAAAAA1AAAAAAAAAD0AAAADAAAAOgAAAAEAAABBAAAAAwAAAEsAAAADAAAADwAAAAAAAAAWAAAABQAAACEAAAAFAAAAHAAAAAAAAAAfAAAAAAAAACkAAAAAAAAAKgAAAAEAAAAsAAAAAAAAADUAAAAAAAAABAAAAAQAAAAIAAAABQAAABAAAAAFAAAADAAAAAEAAAAPAAAAAAAAABYAAAAFAAAAGgAAAAEAAAAcAAAAAAAAAB8AAAAAAAAAMgAAAAAAAAAwAAAAAAAAADEAAAADAAAAIAAAAAAAAAAeAAAAAwAAACEAAAADAAAAGAAAAAMAAAASAAAAAwAAABAAAAADAAAARgAAAAAAAABDAAAAAAAAAEIAAAADAAAANAAAAAMAAAAyAAAAAAAAADAAAAAAAAAAJQAAAAMAAAAgAAAAAAAAAB4AAAADAAAAUwAAAAAAAABXAAAAAwAAAFUAAAADAAAASgAAAAMAAABGAAAAAAAAAEMAAAAAAAAAOQAAAAEAAAA0AAAAAwAAADIAAAAAAAAAGQAAAAAAAAAXAAAAAAAAABgAAAADAAAAEQAAAAAAAAALAAAAAwAAAAoAAAADAAAADgAAAAMAAAAGAAAAAwAAAAIAAAADAAAALQAAAAAAAAAnAAAAAAAAACUAAAADAAAAIwAAAAMAAAAZAAAAAAAAABcAAAAAAAAAGwAAAAMAAAARAAAAAAAAAAsAAAADAAAAPwAAAAAAAAA7AAAAAwAAADkAAAADAAAAOAAAAAMAAAAtAAAAAAAAACcAAAAAAAAALgAAAAMAAAAjAAAAAwAAABkAAAAAAAAAJAAAAAAAAAAUAAAAAAAAAA4AAAADAAAAIgAAAAAAAAATAAAAAwAAAAkAAAADAAAAJgAAAAMAAAAVAAAAAwAAAAcAAAADAAAANwAAAAAAAAAoAAAAAAAAABsAAAADAAAANgAAAAMAAAAkAAAAAAAAABQAAAAAAAAAMwAAAAMAAAAiAAAAAAAAABMAAAADAAAASAAAAAAAAAA8AAAAAwAAAC4AAAADAAAASQAAAAMAAAA3AAAAAAAAACgAAAAAAAAARwAAAAMAAAA2AAAAAwAAACQAAAAAAAAAQAAAAAAAAAAvAAAAAAAAACYAAAADAAAAPgAAAAAAAAArAAAAAwAAAB0AAAADAAAAOgAAAAMAAAAqAAAAAwAAABoAAAADAAAAVAAAAAAAAABFAAAAAAAAADMAAAADAAAAUgAAAAMAAABAAAAAAAAAAC8AAAAAAAAATAAAAAMAAAA+AAAAAAAAACsAAAADAAAAYQAAAAAAAABZAAAAAwAAAEcAAAADAAAAYgAAAAMAAABUAAAAAAAAAEUAAAAAAAAAYAAAAAMAAABSAAAAAwAAAEAAAAAAAAAASwAAAAAAAABBAAAAAAAAADoAAAADAAAAPQAAAAAAAAA1AAAAAwAAACwAAAADAAAAMQAAAAMAAAApAAAAAwAAAB8AAAADAAAAXgAAAAAAAABWAAAAAAAAAEwAAAADAAAAUQAAAAMAAABLAAAAAAAAAEEAAAAAAAAAQgAAAAMAAAA9AAAAAAAAADUAAAADAAAAawAAAAAAAABoAAAAAwAAAGAAAAADAAAAZQAAAAMAAABeAAAAAAAAAFYAAAAAAAAAVQAAAAMAAABRAAAAAwAAAEsAAAAAAAAAOQAAAAAAAAA7AAAAAAAAAD8AAAADAAAASgAAAAAAAABOAAAAAwAAAE8AAAADAAAAUwAAAAMAAABcAAAAAwAAAF8AAAADAAAAJQAAAAAAAAAnAAAAAwAAAC0AAAADAAAANAAAAAAAAAA5AAAAAAAAADsAAAAAAAAARgAAAAMAAABKAAAAAAAAAE4AAAADAAAAGAAAAAAAAAAXAAAAAwAAABkAAAADAAAAIAAAAAMAAAAlAAAAAAAAACcAAAADAAAAMgAAAAMAAAA0AAAAAAAAADkAAAAAAAAALgAAAAAAAAA8AAAAAAAAAEgAAAADAAAAOAAAAAAAAABEAAAAAwAAAFAAAAADAAAAPwAAAAMAAABNAAAAAwAAAFoAAAADAAAAGwAAAAAAAAAoAAAAAwAAADcAAAADAAAAIwAAAAAAAAAuAAAAAAAAADwAAAAAAAAALQAAAAMAAAA4AAAAAAAAAEQAAAADAAAADgAAAAAAAAAUAAAAAwAAACQAAAADAAAAEQAAAAMAAAAbAAAAAAAAACgAAAADAAAAGQAAAAMAAAAjAAAAAAAAAC4AAAAAAAAARwAAAAAAAABZAAAAAAAAAGEAAAADAAAASQAAAAAAAABbAAAAAwAAAGcAAAADAAAASAAAAAMAAABYAAAAAwAAAGkAAAADAAAAMwAAAAAAAABFAAAAAwAAAFQAAAADAAAANgAAAAAAAABHAAAAAAAAAFkAAAAAAAAANwAAAAMAAABJAAAAAAAAAFsAAAADAAAAJgAAAAAAAAAvAAAAAwAAAEAAAAADAAAAIgAAAAMAAAAzAAAAAAAAAEUAAAADAAAAJAAAAAMAAAA2AAAAAAAAAEcAAAAAAAAAYAAAAAAAAABoAAAAAAAAAGsAAAADAAAAYgAAAAAAAABuAAAAAwAAAHMAAAADAAAAYQAAAAMAAABvAAAAAwAAAHcAAAADAAAATAAAAAAAAABWAAAAAwAAAF4AAAADAAAAUgAAAAAAAABgAAAAAAAAAGgAAAAAAAAAVAAAAAMAAABiAAAAAAAAAG4AAAADAAAAOgAAAAAAAABBAAAAAwAAAEsAAAADAAAAPgAAAAMAAABMAAAAAAAAAFYAAAADAAAAQAAAAAMAAABSAAAAAAAAAGAAAAAAAAAAVQAAAAAAAABXAAAAAAAAAFMAAAADAAAAZQAAAAAAAABmAAAAAwAAAGQAAAADAAAAawAAAAMAAABwAAAAAwAAAHIAAAADAAAAQgAAAAAAAABDAAAAAwAAAEYAAAADAAAAUQAAAAAAAABVAAAAAAAAAFcAAAAAAAAAXgAAAAMAAABlAAAAAAAAAGYAAAADAAAAMQAAAAAAAAAwAAAAAwAAADIAAAADAAAAPQAAAAMAAABCAAAAAAAAAEMAAAADAAAASwAAAAMAAABRAAAAAAAAAFUAAAAAAAAAXwAAAAAAAABcAAAAAAAAAFMAAAAAAAAATwAAAAAAAABOAAAAAAAAAEoAAAADAAAAPwAAAAEAAAA7AAAAAwAAADkAAAADAAAAbQAAAAAAAABsAAAAAAAAAGQAAAAFAAAAXQAAAAEAAABfAAAAAAAAAFwAAAAAAAAATQAAAAEAAABPAAAAAAAAAE4AAAAAAAAAdQAAAAQAAAB2AAAABQAAAHIAAAAFAAAAagAAAAEAAABtAAAAAAAAAGwAAAAAAAAAWgAAAAEAAABdAAAAAQAAAF8AAAAAAAAAWgAAAAAAAABNAAAAAAAAAD8AAAAAAAAAUAAAAAAAAABEAAAAAAAAADgAAAADAAAASAAAAAEAAAA8AAAAAwAAAC4AAAADAAAAagAAAAAAAABdAAAAAAAAAE8AAAAFAAAAYwAAAAEAAABaAAAAAAAAAE0AAAAAAAAAWAAAAAEAAABQAAAAAAAAAEQAAAAAAAAAdQAAAAMAAABtAAAABQAAAF8AAAAFAAAAcQAAAAEAAABqAAAAAAAAAF0AAAAAAAAAaQAAAAEAAABjAAAAAQAAAFoAAAAAAAAAaQAAAAAAAABYAAAAAAAAAEgAAAAAAAAAZwAAAAAAAABbAAAAAAAAAEkAAAADAAAAYQAAAAEAAABZAAAAAwAAAEcAAAADAAAAcQAAAAAAAABjAAAAAAAAAFAAAAAFAAAAdAAAAAEAAABpAAAAAAAAAFgAAAAAAAAAbwAAAAEAAABnAAAAAAAAAFsAAAAAAAAAdQAAAAIAAABqAAAABQAAAFoAAAAFAAAAeQAAAAEAAABxAAAAAAAAAGMAAAAAAAAAdwAAAAEAAAB0AAAAAQAAAGkAAAAAAAAAdwAAAAAAAABvAAAAAAAAAGEAAAAAAAAAcwAAAAAAAABuAAAAAAAAAGIAAAADAAAAawAAAAEAAABoAAAAAwAAAGAAAAADAAAAeQAAAAAAAAB0AAAAAAAAAGcAAAAFAAAAeAAAAAEAAAB3AAAAAAAAAG8AAAAAAAAAcAAAAAEAAABzAAAAAAAAAG4AAAAAAAAAdQAAAAEAAABxAAAABQAAAGkAAAAFAAAAdgAAAAEAAAB5AAAAAAAAAHQAAAAAAAAAcgAAAAEAAAB4AAAAAQAAAHcAAAAAAAAAcgAAAAAAAABwAAAAAAAAAGsAAAAAAAAAZAAAAAAAAABmAAAAAAAAAGUAAAADAAAAUwAAAAEAAABXAAAAAwAAAFUAAAADAAAAdgAAAAAAAAB4AAAAAAAAAHMAAAAFAAAAbAAAAAEAAAByAAAAAAAAAHAAAAAAAAAAXAAAAAEAAABkAAAAAAAAAGYAAAAAAAAAdQAAAAAAAAB5AAAABQAAAHcAAAAFAAAAbQAAAAEAAAB2AAAAAAAAAHgAAAAAAAAAXwAAAAEAAABsAAAAAQAAAHIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAGAAAAAgAAAAUAAAABAAAABAAAAAAAAAAAAAAABQAAAAMAAAABAAAABgAAAAQAAAACAAAAAAAAAH6iBfbytuk/Gq6akm/58z/Xrm0Liez0P5doSdOpSwRAWs602ULg8D/dT7Rcbo/1v1N1RQHFNOM/g9Snx7HW3L8HWsP8Q3jfP6VwOLosutk/9rjk1YQcxj+gnmKMsNn6P/HDeuPFY+M/YHwDjqKhB0Ci19/fCVrbP4UxKkDWOP6/pvljWa09tL9wi7wrQXjnv/Z6yLImkM2/3yTlOzY14D+m+WNZrT20PzwKVQnrQwNA9nrIsiaQzT/g40rFrRQFwPa45NWEHMa/kbslHEZq97/xw3rjxWPjv4cLC2SMBci/otff3wla27+rKF5oIAv0P1N1RQHFNOO/iDJPGyWHBUAHWsP8Q3jfvwQf/by16gXAfqIF9vK26b8XrO0Vh0r+v9eubQuJ7PS/BxLrA0ZZ479azrTZQuDwv1MK1EuItPw/yscgV9Z6FkAwHBR2WjQMQJNRzXsQ5vY/GlUHVJYKF0DONuFv2lMNQNCGZ28QJfk/0WUwoIL36D8ggDOMQuATQNqMOeAy/wZAWFYOYM+M2z/LWC4uH3oSQDE+LyTsMgRAkJzhRGWFGEDd4soovCQQQKqk0DJMEP8/rGmNdwOLBUAW2X/9xCbjP4hu3dcqJhNAzuYItRvdB0CgzW3zJW/sPxotm/Y2TxRAQAk9XmdDDEC1Kx9MKgT3P1M+NctcghZAFVqcLlb0C0Bgzd3sB2b2P77mZDPUWhZAFROHJpUGCEDAfma5CxXtPz1DWq/zYxRAmhYY5824F0DOuQKWSbAOQNCMqrvu3fs/L6DR22K2wT9nAAxPBU8RQGiN6mW43AFAZhu25b633D8c1YgmzowSQNM25BRKWARArGS08/lNxD+LFssHwmMRQLC5aNcxBgJABL9HT0WRF0CjCmJmOGEOQHsuaVzMP/s/TWJCaGGwBUCeu1PAPLzjP9nqN9DZOBNAKE4JcydbCkCGtbd1qjPzP8dgm9U8jhVAtPeKTkVwDkCeCLss5l37P401XMPLmBdAFd29VMVQDUBg0yA55h75Pz6odcYLCRdApBM4rBrkAkDyAVWgQxbRP4XDMnK20hFAymLlF7EmzD8GUgo9XBHlP3lbK7T9COc/k+OhPthhy7+YGEpnrOvCPzBFhLs15u4/epbqB6H4uz9IuuLF5svev6lzLKY31es/CaQ0envF5z8ZY0xlUADXv7zaz7HYEuI/CfbK1sn16T8uAQfWwxLWPzKn/YuFN94/5KdbC1AFu793fyCSnlfvPzK2y4doAMY/NRg5t1/X6b/shq4QJaHDP5yNIAKPOeI/vpn7BSE30r/X4YQrO6nrv78Ziv/Thto/DqJ1Y6+y5z9l51NaxFrlv8QlA65HOLS/86dxiEc96z+Hj0+LFjneP6LzBZ8LTc2/DaJ1Y6+y579l51NaxFrlP8QlA65HOLQ/8qdxiEc967+Jj0+LFjnev6LzBZ8LTc0/1qdbC1AFuz93fyCSnlfvvzK2y4doAMa/NRg5t1/X6T/vhq4QJaHDv5yNIAKPOeK/wJn7BSE30j/W4YQrO6nrP78Ziv/Thtq/CaQ0envF578XY0xlUADXP7zaz7HYEuK/CvbK1sn16b8rAQfWwxLWvzKn/YuFN96/zWLlF7EmzL8GUgo9XBHlv3lbK7T9COe/kOOhPthhyz+cGEpnrOvCvzBFhLs15u6/c5bqB6H4u79IuuLF5sveP6lzLKY31eu/AQAAAP////8HAAAA/////zEAAAD/////VwEAAP////9hCQAA/////6dBAAD/////kcsBAP/////3kAwA/////8H2VwAAAAAAAAAAAAAAAAACAAAA/////w4AAAD/////YgAAAP////+uAgAA/////8ISAAD/////ToMAAP////8ilwMA/////+4hGQD/////gu2vAAAAAAAAAAAAAAAAAAAAAAACAAAA//////////8BAAAAAwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////AgAAAP//////////AQAAAAAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD/////////////////////AQAAAP///////////////wIAAAD///////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP///////////////////////////////wIAAAD///////////////8BAAAA/////////////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAABAAAA//////////8CAAAA//////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAAAQAAAP//////////AgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAACAAAAAAAAAAIAAAABAAAAAQAAAAIAAAACAAAAAAAAAAUAAAAFAAAAAAAAAAIAAAACAAAAAwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAgAAAAEAAAACAAAAAgAAAAIAAAAAAAAABQAAAAYAAAAAAAAAAgAAAAIAAAADAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAAAAAACAAAAAQAAAAMAAAACAAAAAgAAAAAAAAAFAAAABwAAAAAAAAACAAAAAgAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAACAAAAAAAAAAIAAAABAAAABAAAAAIAAAACAAAAAAAAAAUAAAAIAAAAAAAAAAIAAAACAAAAAwAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAIAAAAAAAAAAgAAAAEAAAAAAAAAAgAAAAIAAAAAAAAABQAAAAkAAAAAAAAAAgAAAAIAAAADAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAIAAAAAAAAAAwAAAA4AAAACAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAgAAAAMAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAgAAAAAAAAADAAAACgAAAAIAAAAAAAAAAgAAAAMAAAABAAAAAAAAAAIAAAACAAAAAwAAAAcAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAIAAAACAAAAAAAAAAMAAAALAAAAAgAAAAAAAAACAAAAAwAAAAIAAAAAAAAAAgAAAAIAAAADAAAACAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAgAAAAIAAAAAAAAAAwAAAAwAAAACAAAAAAAAAAIAAAADAAAAAwAAAAAAAAACAAAAAgAAAAMAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAACAAAAAgAAAAAAAAADAAAADQAAAAIAAAAAAAAAAgAAAAMAAAAEAAAAAAAAAAIAAAACAAAAAwAAAAoAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAIAAAACAAAAAAAAAAMAAAAGAAAAAgAAAAAAAAACAAAAAwAAAA8AAAAAAAAAAgAAAAIAAAADAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAIAAAAAAAAAAwAAAAcAAAACAAAAAAAAAAIAAAADAAAAEAAAAAAAAAACAAAAAgAAAAMAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAACAAAAAgAAAAAAAAADAAAACAAAAAIAAAAAAAAAAgAAAAMAAAARAAAAAAAAAAIAAAACAAAAAwAAAA0AAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAACAAAAAAAAAAMAAAAJAAAAAgAAAAAAAAACAAAAAwAAABIAAAAAAAAAAgAAAAIAAAADAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAgAAAAIAAAAAAAAAAwAAAAUAAAACAAAAAAAAAAIAAAADAAAAEwAAAAAAAAACAAAAAgAAAAMAAAAPAAAAAAAAAAAAAAAAAAAAAAAAABAAAAACAAAAAAAAAAIAAAABAAAAEwAAAAIAAAACAAAAAAAAAAUAAAAKAAAAAAAAAAIAAAACAAAAAwAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAIAAAAAAAAAAgAAAAEAAAAPAAAAAgAAAAIAAAAAAAAABQAAAAsAAAAAAAAAAgAAAAIAAAADAAAAEQAAAAAAAAAAAAAAAAAAAAAAAAASAAAAAgAAAAAAAAACAAAAAQAAABAAAAACAAAAAgAAAAAAAAAFAAAADAAAAAAAAAACAAAAAgAAAAMAAAASAAAAAAAAAAAAAAAAAAAAAAAAABMAAAACAAAAAAAAAAIAAAABAAAAEQAAAAIAAAACAAAAAAAAAAUAAAANAAAAAAAAAAIAAAACAAAAAwAAABMAAAAAAAAAAAAAAAAAAAAAAAAADwAAAAIAAAAAAAAAAgAAAAEAAAASAAAAAgAAAAIAAAAAAAAABQAAAA4AAAAAAAAAAgAAAAIAAAADAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAEAAAACAAAAAQAAAAAAAAACAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAAAAAACAAAAAQAAAAAAAAABAAAAAgAAAAAAAAAAAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAABAAAAAAAAAAIAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAOgehWlKfUEEz1zLi+JsiQa2og3wcMfVAWCbHorc0yEDi+Yn/Y6mbQJ11/mfsnG9At6bnG4UQQkBvMCQWKqUUQJVmwwswmOc/3hVgVBL3uj//qqOEOdGOPw/WDN4gnGE/H3ANkCUgND+AA8btKgAHPwTXBqJVSdo+XfRQAqsKrj4fc+zLYbSPQklEmCZHv2FCUP+uDso1NEKYtPhwphUHQptxnyFXYdpB7CddZAMmrkGAt1AxSTqBQUibBVdTsFNBSuX3MV+AJkFocv82SLf5QAqmgj7AY81A23VDSEnLoEDGEJVSeDFzQDYrqvBk70VA8U157pcRGUBWfEF+ZKbsP7KBdLHZTpFAqKYk69AqekDbeGY41MdjQD8AZzHK501A1vcrrjubNkD5LnquvBYhQCbiRRD71QlAqt72EbOH8z8Eu+jL1YbdP4uaox/xUcY/abedg1XfsD+BsUdzJ4KZP5wE9YFySIM/rW1kAKMpbT+rZFthVRhWPy4PKlXIs0A/qMZLlwDnMEHByqEF0I0ZQQYSFD8lUQNBPpY+dFs07UAH8BZImBPWQN9RY0I0sMBA2T7kLfc6qUByFYvfhBKTQMq+0Mis1XxA0XQbeQXMZUBJJ5aEGXpQQP7/SY0a6ThAaMD92b/UIkAs8s8yqXoMQNIegOvCk/U/aOi7NZJP4D8AAAAA/////wAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAD/////AAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAA/////wAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAP////8AAAAABQAAAAAAAAAAAAAAAAAAAAAAAAD/////BQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAA/////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAQAAAAAAAAABAAAAAAAAAAUAAAABAAAAAQAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAEAAQAAAQEAAAAAAAEAAAABAAAAAQABAAAAAAAAAAAAAAAAAAAAAAcAAAAHAAAAAQAAAAIAAAAEAAAAAwAAAAAAAAAAAAAABwAAAAMAAAABAAAAAgAAAAUAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAACAAAAAQAAAAMAAAAOAAAABgAAAAsAAAACAAAABwAAAAEAAAAYAAAABQAAAAoAAAABAAAABgAAAAAAAAAmAAAABwAAAAwAAAADAAAACAAAAAIAAAAxAAAACQAAAA4AAAAAAAAABQAAAAQAAAA6AAAACAAAAA0AAAAEAAAACQAAAAMAAAA/AAAACwAAAAYAAAAPAAAACgAAABAAAABIAAAADAAAAAcAAAAQAAAACwAAABEAAABTAAAACgAAAAUAAAATAAAADgAAAA8AAABhAAAADQAAAAgAAAARAAAADAAAABIAAABrAAAADgAAAAkAAAASAAAADQAAABMAAAB1AAAADwAAABMAAAARAAAAEgAAABAAAAAGAAAAAgAAAAMAAAAFAAAABAAAAAAAAAAAAAAAAAAAAAYAAAACAAAAAwAAAAEAAAAFAAAABAAAAAAAAAAAAAAABwAAAAUAAAADAAAABAAAAAEAAAAAAAAAAgAAAAAAAAACAAAAAwAAAAEAAAAFAAAABAAAAAYAAAAAAAAAAAAAAGFsZ29zLmMAaDNOZWlnaGJvclJvdGF0aW9ucwBjb29yZGlqay5jAF91cEFwN0NoZWNrZWQAX3VwQXA3ckNoZWNrZWQAZGlyZWN0ZWRFZGdlLmMAZGlyZWN0ZWRFZGdlVG9Cb3VuZGFyeQBhZGphY2VudEZhY2VEaXJbdG1wRmlqay5mYWNlXVtmaWprLmZhY2VdID09IEtJAGZhY2VpamsuYwBfZmFjZUlqa1BlbnRUb0NlbGxCb3VuZGFyeQBhZGphY2VudEZhY2VEaXJbY2VudGVySUpLLmZhY2VdW2ZhY2UyXSA9PSBLSQBfZmFjZUlqa1RvQ2VsbEJvdW5kYXJ5AGgzSW5kZXguYwBjb21wYWN0Q2VsbHMAbGF0TG5nVG9DZWxsAGNlbGxUb0NoaWxkUG9zAHZhbGlkYXRlQ2hpbGRQb3MAbGF0TG5nLmMAY2VsbEFyZWFSYWRzMgBwb2x5Z29uLT5uZXh0ID09IE5VTEwAbGlua2VkR2VvLmMAYWRkTmV3TGlua2VkUG9seWdvbgBuZXh0ICE9IE5VTEwAbG9vcCAhPSBOVUxMAGFkZE5ld0xpbmtlZExvb3AAcG9seWdvbi0+Zmlyc3QgPT0gTlVMTABhZGRMaW5rZWRMb29wAGNvb3JkICE9IE5VTEwAYWRkTGlua2VkQ29vcmQAbG9vcC0+Zmlyc3QgPT0gTlVMTABpbm5lckxvb3BzICE9IE5VTEwAbm9ybWFsaXplTXVsdGlQb2x5Z29uAGJib3hlcyAhPSBOVUxMAGNhbmRpZGF0ZXMgIT0gTlVMTABmaW5kUG9seWdvbkZvckhvbGUAY2FuZGlkYXRlQkJveGVzICE9IE5VTEwAcmV2RGlyICE9IElOVkFMSURfRElHSVQAbG9jYWxpai5jAGNlbGxUb0xvY2FsSWprAGJhc2VDZWxsICE9IG9yaWdpbkJhc2VDZWxsACEob3JpZ2luT25QZW50ICYmIGluZGV4T25QZW50KQBiYXNlQ2VsbCA9PSBvcmlnaW5CYXNlQ2VsbABiYXNlQ2VsbCAhPSBJTlZBTElEX0JBU0VfQ0VMTABsb2NhbElqa1RvQ2VsbAAhX2lzQmFzZUNlbGxQZW50YWdvbihiYXNlQ2VsbCkAYmFzZUNlbGxSb3RhdGlvbnMgPj0gMABncmlkUGF0aENlbGxzADAAdmVydGV4LmMAY2VsbFRvVmVydGV4AGdyYXBoLT5idWNrZXRzICE9IE5VTEwAdmVydGV4R3JhcGguYwBpbml0VmVydGV4R3JhcGgAbm9kZSAhPSBOVUxMAGFkZFZlcnRleE5vZGU=";var ta=24144;function Zn(se){return se}function Xl(se){var we=/\b__Z[\w\d_]+/g;return se.replace(we,function($e){var Pr=$e;return $e===Pr?$e:Pr+" ["+$e+"]"})}function Za(){var se=new Error;if(!se.stack){try{throw new Error(0)}catch(we){se=we}if(!se.stack)return"(no stack trace available)"}return se.stack.toString()}function Ue(){var se=Za();return t.extraStackTrace&&(se+=`
`+t.extraStackTrace()),Xl(se)}function ri(se,we,$e,Pr){Bc("Assertion failed: "+Dt(se)+", at: "+[we?Dt(we):"unknown filename",$e,Pr?Dt(Pr):"unknown function"])}function Br(){return xt.length}function Ao(se,we,$e){jt.set(jt.subarray(we,we+$e),se)}function Ga(se){return t.___errno_location&&(Ee[t.___errno_location()>>2]=se),se}function Hr(se){Bc("OOM")}function ba(se){try{var we=new ArrayBuffer(se);return we.byteLength!=se?void 0:(new Int8Array(we).set(xt),ko(we),ir(we),1)}catch{}}function It(se){var we=Br(),$e=16777216,Pr=2147483648-$e;if(se>Pr)return!1;for(var g=16777216,bn=Math.max(we,g);bn<se;)bn<=536870912?bn=oe(2*bn,$e):bn=Math.min(oe((3*bn+2147483648)/4,$e),Pr);var _r=ba(bn);return!!_r}var rt=typeof atob=="function"?atob:function(se){var we="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",$e="",Pr,g,bn,_r,ft,ro,Vr,is=0;se=se.replace(/[^A-Za-z0-9\+\/\=]/g,"");do _r=we.indexOf(se.charAt(is++)),ft=we.indexOf(se.charAt(is++)),ro=we.indexOf(se.charAt(is++)),Vr=we.indexOf(se.charAt(is++)),Pr=_r<<2|ft>>4,g=(ft&15)<<4|ro>>2,bn=(ro&3)<<6|Vr,$e=$e+String.fromCharCode(Pr),ro!==64&&($e=$e+String.fromCharCode(g)),Vr!==64&&($e=$e+String.fromCharCode(bn));while(is<se.length);return $e};function ot(se){try{for(var we=rt(se),$e=new Uint8Array(we.length),Pr=0;Pr<we.length;++Pr)$e[Pr]=we.charCodeAt(Pr);return $e}catch{throw new Error("Converting base64 string to bytes failed.")}}function At(se){if(Xa(se))return ot(se.slice(vl.length))}var Rt={Math,Int8Array,Int32Array,Uint8Array,Float32Array,Float64Array},Bt={a:Bc,b:E,c:T,d:ri,e:Ga,f:Br,g:Ao,h:It,i:Hr,j:Zn,k:Xl,l:ba,m:Za,n:Ue,o:ta,p:_i},St=function(se,we,$e){"almost asm";var Pr=new se.Int8Array($e),g=new se.Int32Array($e),bn=new se.Uint8Array($e),_r=new se.Float32Array($e),ft=new se.Float64Array($e),ro=we.o|0,Vr=we.p|0,is=se.Math.floor,Nr=se.Math.abs,Qr=se.Math.sqrt,ys=se.Math.pow,ln=se.Math.cos,cn=se.Math.sin,Au=se.Math.tan,z0=se.Math.acos,$m=se.Math.asin,bf=se.Math.atan,ra=se.Math.atan2,Jl=se.Math.ceil,ia=se.Math.imul,bh=se.Math.min,cb=se.Math.max,Oc=se.Math.clz32,Si=we.b,wt=we.c,Lr=we.d,U0=we.e,N_=we.f,F_=we.g,ed=we.h,V0=we.i,pt=24160;function L_(A){return Pr=new Int8Array(A),bn=new Uint8Array(A),g=new Int32Array(A),_r=new Float32Array(A),ft=new Float64Array(A),$e=A,!0}function cs(A){A=A|0;var d=0;return d=pt,pt=pt+A|0,pt=pt+15&-16,d|0}function vh(){return pt|0}function na(A){A=A|0,pt=A}function vf(A,d){A=A|0,d=d|0,pt=A}function rd(A,d){A=A|0,d=d|0;var _=0,b=0,I=0;return(A|0)<0?(d=2,d|0):(A|0)>13780509?(d=Ir(15,d)|0,d|0):(_=((A|0)<0)<<31>>31,I=Ho(A|0,_|0,3,0)|0,b=wt()|0,_=Ei(A|0,_|0,1,0)|0,_=Ho(I|0,b|0,_|0,wt()|0)|0,_=Ei(_|0,wt()|0,1,0)|0,A=wt()|0,g[d>>2]=_,g[d+4>>2]=A,d=0,d|0)}function id(A,d,_,b){return A=A|0,d=d|0,_=_|0,b=b|0,mu(A,d,_,b,0)|0}function mu(A,d,_,b,I){A=A|0,d=d|0,_=_|0,b=b|0,I=I|0;var P=0,B=0,O=0,W=0,Q=0;if(W=pt,pt=pt+16|0,B=W,!(wf(A,d,_,b,I)|0))return b=0,pt=W,b|0;do if((_|0)>=0){if((_|0)>13780509){if(P=Ir(15,B)|0,P|0)break;O=B,B=g[O>>2]|0,O=g[O+4>>2]|0}else P=((_|0)<0)<<31>>31,Q=Ho(_|0,P|0,3,0)|0,O=wt()|0,P=Ei(_|0,P|0,1,0)|0,P=Ho(Q|0,O|0,P|0,wt()|0)|0,P=Ei(P|0,wt()|0,1,0)|0,O=wt()|0,g[B>>2]=P,g[B+4>>2]=O,B=P;if(Df(b|0,0,B<<3|0)|0,I|0){Df(I|0,0,B<<2|0)|0,P=sa(A,d,_,b,I,B,O,0)|0;break}P=$c(B,4)|0,P?(Q=sa(A,d,_,b,P,B,O,0)|0,ni(P),P=Q):P=13}else P=2;while(!1);return Q=P,pt=W,Q|0}function wf(A,d,_,b,I){A=A|0,d=d|0,_=_|0,b=b|0,I=I|0;var P=0,B=0,O=0,W=0,Q=0,nt=0,mt=0,Vt=0,Yt=0,zt=0,re=0;if(re=pt,pt=pt+16|0,Yt=re,zt=re+8|0,Vt=Yt,g[Vt>>2]=A,g[Vt+4>>2]=d,(_|0)<0)return zt=2,pt=re,zt|0;if(P=b,g[P>>2]=A,g[P+4>>2]=d,P=(I|0)!=0,P&&(g[I>>2]=0),wn(A,d)|0)return zt=9,pt=re,zt|0;g[zt>>2]=0;t:do if((_|0)>=1)if(P)for(nt=1,Q=0,mt=0,Vt=1,P=A;;){if(!(Q|mt)){if(P=Ws(P,d,4,zt,Yt)|0,P|0)break t;if(d=Yt,P=g[d>>2]|0,d=g[d+4>>2]|0,wn(P,d)|0){P=9;break t}}if(P=Ws(P,d,g[22384+(mt<<2)>>2]|0,zt,Yt)|0,P|0)break t;if(d=Yt,P=g[d>>2]|0,d=g[d+4>>2]|0,A=b+(nt<<3)|0,g[A>>2]=P,g[A+4>>2]=d,g[I+(nt<<2)>>2]=Vt,A=Q+1|0,B=(A|0)==(Vt|0),O=mt+1|0,W=(O|0)==6,wn(P,d)|0){P=9;break t}if(Vt=Vt+(W&B&1)|0,(Vt|0)>(_|0)){P=0;break}else nt=nt+1|0,Q=B?0:A,mt=B?W?0:O:mt}else for(nt=1,Q=0,mt=0,Vt=1,P=A;;){if(!(Q|mt)){if(P=Ws(P,d,4,zt,Yt)|0,P|0)break t;if(d=Yt,P=g[d>>2]|0,d=g[d+4>>2]|0,wn(P,d)|0){P=9;break t}}if(P=Ws(P,d,g[22384+(mt<<2)>>2]|0,zt,Yt)|0,P|0)break t;if(d=Yt,P=g[d>>2]|0,d=g[d+4>>2]|0,A=b+(nt<<3)|0,g[A>>2]=P,g[A+4>>2]=d,A=Q+1|0,B=(A|0)==(Vt|0),O=mt+1|0,W=(O|0)==6,wn(P,d)|0){P=9;break t}if(Vt=Vt+(W&B&1)|0,(Vt|0)>(_|0)){P=0;break}else nt=nt+1|0,Q=B?0:A,mt=B?W?0:O:mt}else P=0;while(!1);return zt=P,pt=re,zt|0}function sa(A,d,_,b,I,P,B,O){A=A|0,d=d|0,_=_|0,b=b|0,I=I|0,P=P|0,B=B|0,O=O|0;var W=0,Q=0,nt=0,mt=0,Vt=0,Yt=0,zt=0,re=0,ge=0,Ae=0;if(re=pt,pt=pt+16|0,Yt=re+8|0,zt=re,W=Xs(A|0,d|0,P|0,B|0)|0,nt=wt()|0,mt=b+(W<<3)|0,ge=mt,Ae=g[ge>>2]|0,ge=g[ge+4>>2]|0,Q=(Ae|0)==(A|0)&(ge|0)==(d|0),!((Ae|0)==0&(ge|0)==0|Q))do W=Ei(W|0,nt|0,1,0)|0,W=K_(W|0,wt()|0,P|0,B|0)|0,nt=wt()|0,mt=b+(W<<3)|0,Ae=mt,ge=g[Ae>>2]|0,Ae=g[Ae+4>>2]|0,Q=(ge|0)==(A|0)&(Ae|0)==(d|0);while(!((ge|0)==0&(Ae|0)==0|Q));if(W=I+(W<<2)|0,Q&&(g[W>>2]|0)<=(O|0)||(Ae=mt,g[Ae>>2]=A,g[Ae+4>>2]=d,g[W>>2]=O,(O|0)>=(_|0)))return Ae=0,pt=re,Ae|0;switch(Q=O+1|0,g[Yt>>2]=0,W=Ws(A,d,2,Yt,zt)|0,W|0){case 9:{Vt=9;break}case 0:{W=zt,W=sa(g[W>>2]|0,g[W+4>>2]|0,_,b,I,P,B,Q)|0,W||(Vt=9);break}default:}t:do if((Vt|0)==9){switch(g[Yt>>2]=0,W=Ws(A,d,3,Yt,zt)|0,W|0){case 9:break;case 0:{if(W=zt,W=sa(g[W>>2]|0,g[W+4>>2]|0,_,b,I,P,B,Q)|0,W|0)break t;break}default:break t}switch(g[Yt>>2]=0,W=Ws(A,d,1,Yt,zt)|0,W|0){case 9:break;case 0:{if(W=zt,W=sa(g[W>>2]|0,g[W+4>>2]|0,_,b,I,P,B,Q)|0,W|0)break t;break}default:break t}switch(g[Yt>>2]=0,W=Ws(A,d,5,Yt,zt)|0,W|0){case 9:break;case 0:{if(W=zt,W=sa(g[W>>2]|0,g[W+4>>2]|0,_,b,I,P,B,Q)|0,W|0)break t;break}default:break t}switch(g[Yt>>2]=0,W=Ws(A,d,4,Yt,zt)|0,W|0){case 9:break;case 0:{if(W=zt,W=sa(g[W>>2]|0,g[W+4>>2]|0,_,b,I,P,B,Q)|0,W|0)break t;break}default:break t}switch(g[Yt>>2]=0,W=Ws(A,d,6,Yt,zt)|0,W|0){case 9:break;case 0:{if(W=zt,W=sa(g[W>>2]|0,g[W+4>>2]|0,_,b,I,P,B,Q)|0,W|0)break t;break}default:break t}return Ae=0,pt=re,Ae|0}while(!1);return Ae=W,pt=re,Ae|0}function Ws(A,d,_,b,I){A=A|0,d=d|0,_=_|0,b=b|0,I=I|0;var P=0,B=0,O=0,W=0,Q=0,nt=0,mt=0,Vt=0,Yt=0,zt=0;if(_>>>0>6)return I=1,I|0;if(mt=(g[b>>2]|0)%6|0,g[b>>2]=mt,(mt|0)>0){P=0;do _=Uc(_)|0,P=P+1|0;while((P|0)<(g[b>>2]|0))}if(mt=De(A|0,d|0,45)|0,wt()|0,nt=mt&127,nt>>>0>121)return I=5,I|0;W=ii(A,d)|0,P=De(A|0,d|0,52)|0,wt()|0,P=P&15;t:do if(!P)Q=8;else{for(;;){if(B=(15-P|0)*3|0,O=De(A|0,d|0,B|0)|0,wt()|0,O=O&7,(O|0)==7){d=5;break}if(zt=(C(P)|0)==0,P=P+-1|0,Vt=Ge(7,0,B|0)|0,d=d&~(wt()|0),Yt=Ge(g[(zt?432:16)+(O*28|0)+(_<<2)>>2]|0,0,B|0)|0,B=wt()|0,_=g[(zt?640:224)+(O*28|0)+(_<<2)>>2]|0,A=Yt|A&~Vt,d=B|d,!_){_=0;break t}if(!P){Q=8;break t}}return d|0}while(!1);(Q|0)==8&&(zt=g[848+(nt*28|0)+(_<<2)>>2]|0,Yt=Ge(zt|0,0,45)|0,A=Yt|A,d=wt()|0|d&-1040385,_=g[4272+(nt*28|0)+(_<<2)>>2]|0,(zt&127|0)==127&&(zt=Ge(g[848+(nt*28|0)+20>>2]|0,0,45)|0,d=wt()|0|d&-1040385,_=g[4272+(nt*28|0)+20>>2]|0,A=l(zt|A,d)|0,d=wt()|0,g[b>>2]=(g[b>>2]|0)+1)),O=De(A|0,d|0,45)|0,wt()|0,O=O&127;t:do if(vn(O)|0){e:do if((ii(A,d)|0)==1){if((nt|0)!=(O|0))if(Ta(O,g[7696+(nt*28|0)>>2]|0)|0){A=v(A,d)|0,B=1,d=wt()|0;break}else Lr(23313,22416,436,22424);switch(W|0){case 3:{A=l(A,d)|0,d=wt()|0,g[b>>2]=(g[b>>2]|0)+1,B=0;break e}case 5:{A=v(A,d)|0,d=wt()|0,g[b>>2]=(g[b>>2]|0)+5,B=0;break e}case 0:return zt=9,zt|0;default:return zt=1,zt|0}}else B=0;while(!1);if((_|0)>0){P=0;do A=M(A,d)|0,d=wt()|0,P=P+1|0;while((P|0)!=(_|0))}if((nt|0)!=(O|0)){if(!($0(O)|0)){if((B|0)!=0|(ii(A,d)|0)!=5)break;g[b>>2]=(g[b>>2]|0)+1;break}switch(mt&127){case 8:case 118:break t;default:}(ii(A,d)|0)!=3&&(g[b>>2]=(g[b>>2]|0)+1)}}else if((_|0)>0){P=0;do A=l(A,d)|0,d=wt()|0,P=P+1|0;while((P|0)!=(_|0))}while(!1);return g[b>>2]=((g[b>>2]|0)+_|0)%6|0,zt=I,g[zt>>2]=A,g[zt+4>>2]=d,zt=0,zt|0}function j0(A,d,_,b){A=A|0,d=d|0,_=_|0,b=b|0;var I=0,P=0,B=0,O=0,W=0,Q=0;for(O=pt,pt=pt+16|0,P=O,B=O+8|0,I=(wn(A,d)|0)==0,I=I?1:2;;){if(g[B>>2]=0,Q=(Ws(A,d,I,B,P)|0)==0,W=P,Q&((g[W>>2]|0)==(_|0)?(g[W+4>>2]|0)==(b|0):0)){A=4;break}if(I=I+1|0,I>>>0>=7){I=7,A=4;break}}return(A|0)==4?(pt=O,I|0):0}function z_(A,d,_,b){A=A|0,d=d|0,_=_|0,b=b|0;var I=0,P=0,B=0,O=0,W=0,Q=0,nt=0,mt=0,Vt=0,Yt=0,zt=0;if(zt=pt,pt=pt+16|0,Vt=zt,Yt=zt+8|0,mt=Vt,g[mt>>2]=A,g[mt+4>>2]=d,!_)return Yt=b,g[Yt>>2]=A,g[Yt+4>>2]=d,Yt=0,pt=zt,Yt|0;g[Yt>>2]=0;t:do if(wn(A,d)|0)A=9;else{if(P=(_|0)>0,P){I=0,mt=A;do{if(A=Ws(mt,d,4,Yt,Vt)|0,A|0)break t;if(d=Vt,mt=g[d>>2]|0,d=g[d+4>>2]|0,I=I+1|0,wn(mt,d)|0){A=9;break t}}while((I|0)<(_|0));if(nt=b,g[nt>>2]=mt,g[nt+4>>2]=d,nt=_+-1|0,P){Q=0,A=1;do{if(I=22384+(Q<<2)|0,(Q|0)==5)for(B=g[I>>2]|0,P=0,I=A;;){if(A=Vt,A=Ws(g[A>>2]|0,g[A+4>>2]|0,B,Yt,Vt)|0,A|0)break t;if((P|0)!=(nt|0))if(W=Vt,O=g[W>>2]|0,W=g[W+4>>2]|0,A=b+(I<<3)|0,g[A>>2]=O,g[A+4>>2]=W,!(wn(O,W)|0))A=I+1|0;else{A=9;break t}else A=I;if(P=P+1|0,(P|0)>=(_|0))break;I=A}else for(B=Vt,W=g[I>>2]|0,O=0,I=A,P=g[B>>2]|0,B=g[B+4>>2]|0;;){if(A=Ws(P,B,W,Yt,Vt)|0,A|0)break t;if(B=Vt,P=g[B>>2]|0,B=g[B+4>>2]|0,A=b+(I<<3)|0,g[A>>2]=P,g[A+4>>2]=B,A=I+1|0,wn(P,B)|0){A=9;break t}if(O=O+1|0,(O|0)>=(_|0))break;I=A}Q=Q+1|0}while(Q>>>0<6);A=Vt,B=mt,I=g[A>>2]|0,P=d,A=g[A+4>>2]|0}else B=mt,I=mt,P=d,A=d}else B=b,g[B>>2]=A,g[B+4>>2]=d,B=A,I=A,P=d,A=d;A=(B|0)==(I|0)&(P|0)==(A|0)?0:9}while(!1);return Yt=A,pt=zt,Yt|0}function U_(A,d,_,b){A=A|0,d=d|0,_=_|0,b=b|0;var I=0,P=0,B=0,O=0,W=0,Q=0;if(O=pt,pt=pt+48|0,I=O+16|0,P=O+8|0,B=O,_|0)return B=15,pt=O,B|0;if(Q=A,W=g[Q+4>>2]|0,_=P,g[_>>2]=g[Q>>2],g[_+4>>2]=W,us(P,I),d=qm(I,d,B)|0,!d){if(_=g[P>>2]|0,P=g[A+8>>2]|0,(P|0)>0){I=g[A+12>>2]|0,d=0;do _=(g[I+(d<<3)>>2]|0)+_|0,d=d+1|0;while((d|0)<(P|0))}d=B,I=g[d>>2]|0,d=g[d+4>>2]|0,P=((_|0)<0)<<31>>31,(d|0)<(P|0)|(d|0)==(P|0)&I>>>0<_>>>0?(d=B,g[d>>2]=_,g[d+4>>2]=P,d=P):_=I,W=Ei(_|0,d|0,12,0)|0,Q=wt()|0,d=B,g[d>>2]=W,g[d+4>>2]=Q,d=b,g[d>>2]=W,g[d+4>>2]=Q,d=0}return Q=d,pt=O,Q|0}function Hm(A,d,_,b,I,P,B){A=A|0,d=d|0,_=_|0,b=b|0,I=I|0,P=P|0,B=B|0;var O=0,W=0,Q=0,nt=0,mt=0,Vt=0,Yt=0,zt=0,re=0,ge=0,Ae=0,ue=0,fe=0,ie=0,tr=0,fr=0,Xe=0,er=0,_n=0,un=0,Yi=0,Ci=0,Ar=0,Ai=0,Rn=0,Kr=0,kn=0,yo=0,gb=0;if(Rn=pt,pt=pt+64|0,Yi=Rn+48|0,Ci=Rn+32|0,Ar=Rn+24|0,tr=Rn+8|0,fr=Rn,W=g[A>>2]|0,(W|0)<=0)return Ai=0,pt=Rn,Ai|0;for(Xe=A+4|0,er=Yi+8|0,_n=Ci+8|0,un=tr+8|0,O=0,fe=0;;){Q=g[Xe>>2]|0,ue=Q+(fe<<4)|0,g[Yi>>2]=g[ue>>2],g[Yi+4>>2]=g[ue+4>>2],g[Yi+8>>2]=g[ue+8>>2],g[Yi+12>>2]=g[ue+12>>2],(fe|0)==(W+-1|0)?(g[Ci>>2]=g[Q>>2],g[Ci+4>>2]=g[Q+4>>2],g[Ci+8>>2]=g[Q+8>>2],g[Ci+12>>2]=g[Q+12>>2]):(ue=Q+(fe+1<<4)|0,g[Ci>>2]=g[ue>>2],g[Ci+4>>2]=g[ue+4>>2],g[Ci+8>>2]=g[ue+8>>2],g[Ci+12>>2]=g[ue+12>>2]),W=W0(Yi,Ci,b,Ar)|0;t:do if(W)Q=0,O=W;else if(Q=Ar,W=g[Q>>2]|0,Q=g[Q+4>>2]|0,(Q|0)>0|(Q|0)==0&W>>>0>0){Ae=0,ue=0;e:for(;;){if(gb=+ft[Yi>>3],ge=aa(W|0,Q|0,Ae|0,ue|0)|0,yo=+(ge>>>0)+4294967296*+(wt()|0),Kr=+(W>>>0)+4294967296*+(Q|0),kn=+(Ae>>>0)+4294967296*+(ue|0),ft[tr>>3]=gb*yo/Kr+ +ft[Ci>>3]*kn/Kr,ft[un>>3]=+ft[er>>3]*yo/Kr+ +ft[_n>>3]*kn/Kr,W=L(tr,b,fr)|0,W|0){O=W;break}ge=fr,re=g[ge>>2]|0,ge=g[ge+4>>2]|0,Vt=Xs(re|0,ge|0,d|0,_|0)|0,nt=wt()|0,W=B+(Vt<<3)|0,mt=W,Q=g[mt>>2]|0,mt=g[mt+4>>2]|0;r:do if((Q|0)==0&(mt|0)==0)ie=W,Ai=16;else for(Yt=0,zt=0;;){if((Yt|0)>(_|0)|(Yt|0)==(_|0)&zt>>>0>d>>>0){O=1;break e}if((Q|0)==(re|0)&(mt|0)==(ge|0))break r;if(W=Ei(Vt|0,nt|0,1,0)|0,Vt=K_(W|0,wt()|0,d|0,_|0)|0,nt=wt()|0,zt=Ei(zt|0,Yt|0,1,0)|0,Yt=wt()|0,W=B+(Vt<<3)|0,mt=W,Q=g[mt>>2]|0,mt=g[mt+4>>2]|0,(Q|0)==0&(mt|0)==0){ie=W,Ai=16;break}}while(!1);if((Ai|0)==16&&(Ai=0,!((re|0)==0&(ge|0)==0))&&(zt=ie,g[zt>>2]=re,g[zt+4>>2]=ge,zt=P+(g[I>>2]<<3)|0,g[zt>>2]=re,g[zt+4>>2]=ge,zt=I,zt=Ei(g[zt>>2]|0,g[zt+4>>2]|0,1,0)|0,re=wt()|0,ge=I,g[ge>>2]=zt,g[ge+4>>2]=re),Ae=Ei(Ae|0,ue|0,1,0)|0,ue=wt()|0,Q=Ar,W=g[Q>>2]|0,Q=g[Q+4>>2]|0,!((Q|0)>(ue|0)|(Q|0)==(ue|0)&W>>>0>Ae>>>0)){Q=1;break t}}Q=0}else Q=1;while(!1);if(fe=fe+1|0,!Q){Ai=21;break}if(W=g[A>>2]|0,(fe|0)>=(W|0)){O=0,Ai=21;break}}return(Ai|0)==21?(pt=Rn,O|0):0}function tc(A,d,_,b){A=A|0,d=d|0,_=_|0,b=b|0;var I=0,P=0,B=0,O=0,W=0,Q=0,nt=0,mt=0,Vt=0,Yt=0,zt=0,re=0,ge=0,Ae=0,ue=0,fe=0,ie=0,tr=0,fr=0,Xe=0,er=0,_n=0,un=0,Yi=0,Ci=0,Ar=0,Ai=0,Rn=0,Kr=0,kn=0,yo=0;if(yo=pt,pt=pt+112|0,Ai=yo+80|0,W=yo+72|0,Rn=yo,Kr=yo+56|0,_|0)return kn=15,pt=yo,kn|0;if(Q=A+8|0,kn=sc((g[Q>>2]<<5)+32|0)|0,!kn)return kn=13,pt=yo,kn|0;if(Ys(A,kn),Ci=A,Ar=g[Ci+4>>2]|0,_=W,g[_>>2]=g[Ci>>2],g[_+4>>2]=Ar,us(W,Ai),_=qm(Ai,d,Rn)|0,_)Ci=0,Ar=0;else{if(_=g[W>>2]|0,P=g[Q>>2]|0,(P|0)>0){B=g[A+12>>2]|0,I=0;do _=(g[B+(I<<3)>>2]|0)+_|0,I=I+1|0;while((I|0)!=(P|0));I=_}else I=_;_=Rn,P=g[_>>2]|0,_=g[_+4>>2]|0,B=((I|0)<0)<<31>>31,(_|0)<(B|0)|(_|0)==(B|0)&P>>>0<I>>>0?(_=Rn,g[_>>2]=I,g[_+4>>2]=B,_=B):I=P,Ci=Ei(I|0,_|0,12,0)|0,Ar=wt()|0,_=Rn,g[_>>2]=Ci,g[_+4>>2]=Ar,_=0}if(_|0)return ni(kn),kn=_,pt=yo,kn|0;if(I=$c(Ci,8)|0,!I)return ni(kn),kn=13,pt=yo,kn|0;if(O=$c(Ci,8)|0,!O)return ni(kn),ni(I),kn=13,pt=yo,kn|0;un=Ai,g[un>>2]=0,g[un+4>>2]=0,un=A,Yi=g[un+4>>2]|0,_=W,g[_>>2]=g[un>>2],g[_+4>>2]=Yi,_=Hm(W,Ci,Ar,d,Ai,I,O)|0;t:do if(_)ni(I),ni(O),ni(kn);else{e:do if((g[Q>>2]|0)>0){for(B=A+12|0,P=0;_=Hm((g[B>>2]|0)+(P<<3)|0,Ci,Ar,d,Ai,I,O)|0,P=P+1|0,!(_|0);)if((P|0)>=(g[Q>>2]|0))break e;ni(I),ni(O),ni(kn);break t}while(!1);(Ar|0)>0|(Ar|0)==0&Ci>>>0>0&&Df(O|0,0,Ci<<3|0)|0,Yi=Ai,un=g[Yi+4>>2]|0;e:do if((un|0)>0|(un|0)==0&(g[Yi>>2]|0)>>>0>0){Xe=I,er=O,_n=I,un=O,Yi=I,_=I,ie=I,tr=O,fr=O,I=O;r:for(;;){for(ge=0,Ae=0,ue=0,fe=0,P=0,B=0;;){O=Rn,W=O+56|0;do g[O>>2]=0,O=O+4|0;while((O|0)<(W|0));if(d=Xe+(ge<<3)|0,Q=g[d>>2]|0,d=g[d+4>>2]|0,wf(Q,d,1,Rn,0)|0){O=Rn,W=O+56|0;do g[O>>2]=0,O=O+4|0;while((O|0)<(W|0));O=$c(7,4)|0,O|0&&(sa(Q,d,1,Rn,O,7,0,0)|0,ni(O))}for(re=0;;){zt=Rn+(re<<3)|0,Yt=g[zt>>2]|0,zt=g[zt+4>>2]|0;i:do if((Yt|0)==0&(zt|0)==0)O=P,W=B;else{if(nt=Xs(Yt|0,zt|0,Ci|0,Ar|0)|0,Q=wt()|0,O=b+(nt<<3)|0,d=O,W=g[d>>2]|0,d=g[d+4>>2]|0,!((W|0)==0&(d|0)==0)){mt=0,Vt=0;do{if((mt|0)>(Ar|0)|(mt|0)==(Ar|0)&Vt>>>0>Ci>>>0)break r;if((W|0)==(Yt|0)&(d|0)==(zt|0)){O=P,W=B;break i}O=Ei(nt|0,Q|0,1,0)|0,nt=K_(O|0,wt()|0,Ci|0,Ar|0)|0,Q=wt()|0,Vt=Ei(Vt|0,mt|0,1,0)|0,mt=wt()|0,O=b+(nt<<3)|0,d=O,W=g[d>>2]|0,d=g[d+4>>2]|0}while(!((W|0)==0&(d|0)==0))}(Yt|0)==0&(zt|0)==0?(O=P,W=B):(X(Yt,zt,Kr)|0,oa(A,kn,Kr)|0&&(Vt=Ei(P|0,B|0,1,0)|0,B=wt()|0,mt=O,g[mt>>2]=Yt,g[mt+4>>2]=zt,P=er+(P<<3)|0,g[P>>2]=Yt,g[P+4>>2]=zt,P=Vt),O=P,W=B)}while(!1);if(re=re+1|0,re>>>0>=7)break;P=O,B=W}if(ge=Ei(ge|0,Ae|0,1,0)|0,Ae=wt()|0,ue=Ei(ue|0,fe|0,1,0)|0,fe=wt()|0,B=Ai,P=g[B>>2]|0,B=g[B+4>>2]|0,(fe|0)<(B|0)|(fe|0)==(B|0)&ue>>>0<P>>>0)P=O,B=W;else break}if((B|0)>0|(B|0)==0&P>>>0>0){P=0,B=0;do fe=Xe+(P<<3)|0,g[fe>>2]=0,g[fe+4>>2]=0,P=Ei(P|0,B|0,1,0)|0,B=wt()|0,fe=Ai,ue=g[fe+4>>2]|0;while((B|0)<(ue|0)|((B|0)==(ue|0)?P>>>0<(g[fe>>2]|0)>>>0:0))}if(fe=Ai,g[fe>>2]=O,g[fe+4>>2]=W,(W|0)>0|(W|0)==0&O>>>0>0)re=I,ge=fr,Ae=Yi,ue=tr,fe=er,I=ie,fr=_,tr=_n,ie=re,_=ge,Yi=un,un=Ae,_n=ue,er=Xe,Xe=fe;else break e}ni(_n),ni(un),ni(kn),_=1;break t}else _=O;while(!1);ni(kn),ni(I),ni(_),_=0}while(!1);return kn=_,pt=yo,kn|0}function nd(A,d,_){A=A|0,d=d|0,_=_|0;var b=0,I=0,P=0,B=0,O=0,W=0,Q=0,nt=0;if(nt=pt,pt=pt+176|0,W=nt,(d|0)<1)return Pf(_,0,0),Q=0,pt=nt,Q|0;for(O=A,O=De(g[O>>2]|0,g[O+4>>2]|0,52)|0,wt()|0,Pf(_,(d|0)>6?d:6,O&15),O=0;b=A+(O<<3)|0,b=J(g[b>>2]|0,g[b+4>>2]|0,W)|0,!(b|0);){if(b=g[W>>2]|0,(b|0)>0){B=0;do P=W+8+(B<<4)|0,B=B+1|0,b=W+8+(((B|0)%(b|0)|0)<<4)|0,I=kC(_,b,P)|0,I?Q_(_,I)|0:BT(_,P,b)|0,b=g[W>>2]|0;while((B|0)<(b|0))}if(O=O+1|0,(O|0)>=(d|0)){b=0,Q=13;break}}return(Q|0)==13?(pt=nt,b|0):(Rf(_),Q=b,pt=nt,Q|0)}function wa(A,d,_){A=A|0,d=d|0,_=_|0;var b=0,I=0,P=0,B=0;if(P=pt,pt=pt+32|0,b=P,I=P+16|0,A=nd(A,d,I)|0,A|0)return _=A,pt=P,_|0;if(g[_>>2]=0,g[_+4>>2]=0,g[_+8>>2]=0,A=ag(I)|0,A|0)do{d=go(_)|0;do qs(d,A)|0,B=A+16|0,g[b>>2]=g[B>>2],g[b+4>>2]=g[B+4>>2],g[b+8>>2]=g[B+8>>2],g[b+12>>2]=g[B+12>>2],Q_(I,A)|0,A=OT(I,b)|0;while(A|0);A=ag(I)|0}while(A|0);return Rf(I),A=Ia(_)|0,A?(vs(_),B=A,pt=P,B|0):(B=0,pt=P,B|0)}function vn(A){return A=A|0,A>>>0>121?(A=0,A|0):(A=g[7696+(A*28|0)+16>>2]|0,A|0)}function $0(A){return A=A|0,(A|0)==4|(A|0)==117|0}function Wm(A){return A=A|0,g[11120+((g[A>>2]|0)*216|0)+((g[A+4>>2]|0)*72|0)+((g[A+8>>2]|0)*24|0)+(g[A+12>>2]<<3)>>2]|0}function V_(A){return A=A|0,g[11120+((g[A>>2]|0)*216|0)+((g[A+4>>2]|0)*72|0)+((g[A+8>>2]|0)*24|0)+(g[A+12>>2]<<3)+4>>2]|0}function Nc(A,d){A=A|0,d=d|0,A=7696+(A*28|0)|0,g[d>>2]=g[A>>2],g[d+4>>2]=g[A+4>>2],g[d+8>>2]=g[A+8>>2],g[d+12>>2]=g[A+12>>2]}function j_(A,d){A=A|0,d=d|0;var _=0,b=0;if(d>>>0>20)return d=-1,d|0;do if((g[11120+(d*216|0)>>2]|0)!=(A|0))if((g[11120+(d*216|0)+8>>2]|0)!=(A|0))if((g[11120+(d*216|0)+16>>2]|0)!=(A|0))if((g[11120+(d*216|0)+24>>2]|0)!=(A|0))if((g[11120+(d*216|0)+32>>2]|0)!=(A|0))if((g[11120+(d*216|0)+40>>2]|0)!=(A|0))if((g[11120+(d*216|0)+48>>2]|0)!=(A|0))if((g[11120+(d*216|0)+56>>2]|0)!=(A|0))if((g[11120+(d*216|0)+64>>2]|0)!=(A|0))if((g[11120+(d*216|0)+72>>2]|0)!=(A|0))if((g[11120+(d*216|0)+80>>2]|0)!=(A|0))if((g[11120+(d*216|0)+88>>2]|0)!=(A|0))if((g[11120+(d*216|0)+96>>2]|0)!=(A|0))if((g[11120+(d*216|0)+104>>2]|0)!=(A|0))if((g[11120+(d*216|0)+112>>2]|0)!=(A|0))if((g[11120+(d*216|0)+120>>2]|0)!=(A|0))if((g[11120+(d*216|0)+128>>2]|0)!=(A|0))if((g[11120+(d*216|0)+136>>2]|0)==(A|0))A=2,_=1,b=2;else{if((g[11120+(d*216|0)+144>>2]|0)==(A|0)){A=0,_=2,b=0;break}if((g[11120+(d*216|0)+152>>2]|0)==(A|0)){A=0,_=2,b=1;break}if((g[11120+(d*216|0)+160>>2]|0)==(A|0)){A=0,_=2,b=2;break}if((g[11120+(d*216|0)+168>>2]|0)==(A|0)){A=1,_=2,b=0;break}if((g[11120+(d*216|0)+176>>2]|0)==(A|0)){A=1,_=2,b=1;break}if((g[11120+(d*216|0)+184>>2]|0)==(A|0)){A=1,_=2,b=2;break}if((g[11120+(d*216|0)+192>>2]|0)==(A|0)){A=2,_=2,b=0;break}if((g[11120+(d*216|0)+200>>2]|0)==(A|0)){A=2,_=2,b=1;break}if((g[11120+(d*216|0)+208>>2]|0)==(A|0)){A=2,_=2,b=2;break}else A=-1;return A|0}else A=2,_=1,b=1;else A=2,_=1,b=0;else A=1,_=1,b=2;else A=1,_=1,b=1;else A=1,_=1,b=0;else A=0,_=1,b=2;else A=0,_=1,b=1;else A=0,_=1,b=0;else A=2,_=0,b=2;else A=2,_=0,b=1;else A=2,_=0,b=0;else A=1,_=0,b=2;else A=1,_=0,b=1;else A=1,_=0,b=0;else A=0,_=0,b=2;else A=0,_=0,b=1;else A=0,_=0,b=0;while(!1);return d=g[11120+(d*216|0)+(_*72|0)+(A*24|0)+(b<<3)+4>>2]|0,d|0}function Ta(A,d){return A=A|0,d=d|0,(g[7696+(A*28|0)+20>>2]|0)==(d|0)?(d=1,d|0):(d=(g[7696+(A*28|0)+24>>2]|0)==(d|0),d|0)}function Tl(A,d){return A=A|0,d=d|0,g[848+(A*28|0)+(d<<2)>>2]|0}function Tf(A,d){return A=A|0,d=d|0,(g[848+(A*28|0)>>2]|0)==(d|0)?(d=0,d|0):(g[848+(A*28|0)+4>>2]|0)==(d|0)?(d=1,d|0):(g[848+(A*28|0)+8>>2]|0)==(d|0)?(d=2,d|0):(g[848+(A*28|0)+12>>2]|0)==(d|0)?(d=3,d|0):(g[848+(A*28|0)+16>>2]|0)==(d|0)?(d=4,d|0):(g[848+(A*28|0)+20>>2]|0)==(d|0)?(d=5,d|0):((g[848+(A*28|0)+24>>2]|0)==(d|0)?6:7)|0}function Fc(){return 122}function Lc(A){A=A|0;var d=0,_=0,b=0;d=0;do Ge(d|0,0,45)|0,b=wt()|0|134225919,_=A+(d<<3)|0,g[_>>2]=-1,g[_+4>>2]=b,d=d+1|0;while((d|0)!=122);return 0}function $_(A){return A=A|0,+ft[A+16>>3]<+ft[A+24>>3]|0}function H0(A,d){A=A|0,d=d|0;var _=0,b=0,I=0;return _=+ft[d>>3],!(_>=+ft[A+8>>3])||!(_<=+ft[A>>3])?(d=0,d|0):(b=+ft[A+16>>3],_=+ft[A+24>>3],I=+ft[d+8>>3],d=I>=_,A=I<=b&1,b<_?d&&(A=1):d||(A=0),d=(A|0)!=0,d|0)}function qm(A,d,_){A=A|0,d=d|0,_=_|0;var b=0,I=0,P=0,B=0,O=0,W=0,Q=0,nt=0,mt=0,Vt=0,Yt=0,zt=0,re=0,ge=0;zt=pt,pt=pt+288|0,nt=zt+264|0,mt=zt+96|0,Q=zt,O=Q,W=O+96|0;do g[O>>2]=0,O=O+4|0;while((O|0)<(W|0));return d=yt(d,Q)|0,d|0?(Yt=d,pt=zt,Yt|0):(W=Q,Q=g[W>>2]|0,W=g[W+4>>2]|0,X(Q,W,nt)|0,J(Q,W,mt)|0,B=+ce(nt,mt+8|0),ft[nt>>3]=+ft[A>>3],W=nt+8|0,ft[W>>3]=+ft[A+16>>3],ft[mt>>3]=+ft[A+8>>3],Q=mt+8|0,ft[Q>>3]=+ft[A+24>>3],I=+ce(nt,mt),ge=+ft[W>>3]-+ft[Q>>3],P=+Nr(+ge),re=+ft[nt>>3]-+ft[mt>>3],b=+Nr(+re),!(ge==0|re==0)&&(ge=+tA(+P,+b),ge=+Jl(+(I*I/+Ab(+(ge/+Ab(+P,+b)),3)/(B*(B*2.59807621135)*.8))),ft[ro>>3]=ge,Vt=~~ge>>>0,Yt=+Nr(ge)>=1?ge>0?~~+bh(+is(ge/4294967296),4294967295)>>>0:~~+Jl((ge-+(~~ge>>>0))/4294967296)>>>0:0,(g[ro+4>>2]&2146435072|0)!=2146435072)?(mt=(Vt|0)==0&(Yt|0)==0,d=_,g[d>>2]=mt?1:Vt,g[d+4>>2]=mt?0:Yt,d=0):d=1,Yt=d,pt=zt,Yt|0)}function W0(A,d,_,b){A=A|0,d=d|0,_=_|0,b=b|0;var I=0,P=0,B=0,O=0,W=0,Q=0,nt=0;Q=pt,pt=pt+288|0,B=Q+264|0,O=Q+96|0,W=Q,I=W,P=I+96|0;do g[I>>2]=0,I=I+4|0;while((I|0)<(P|0));return _=yt(_,W)|0,_|0?(b=_,pt=Q,b|0):(_=W,I=g[_>>2]|0,_=g[_+4>>2]|0,X(I,_,B)|0,J(I,_,O)|0,nt=+ce(B,O+8|0),nt=+Jl(+(+ce(A,d)/(nt*2))),ft[ro>>3]=nt,_=~~nt>>>0,I=+Nr(nt)>=1?nt>0?~~+bh(+is(nt/4294967296),4294967295)>>>0:~~+Jl((nt-+(~~nt>>>0))/4294967296)>>>0:0,(g[ro+4>>2]&2146435072|0)==2146435072?(b=1,pt=Q,b|0):(W=(_|0)==0&(I|0)==0,g[b>>2]=W?1:_,g[b+4>>2]=W?0:I,b=0,pt=Q,b|0))}function Sf(A,d,_,b){A=A|0,d=d|0,_=_|0,b=b|0,g[A>>2]=d,g[A+4>>2]=_,g[A+8>>2]=b}function zc(A,d){A=A|0,d=d|0;var _=0,b=0,I=0,P=0,B=0,O=0,W=0,Q=0,nt=0,mt=0,Vt=0;mt=d+8|0,g[mt>>2]=0,W=+ft[A>>3],B=+Nr(+W),Q=+ft[A+8>>3],O=+Nr(+Q)/.8660254037844386,B=B+O*.5,_=~~B,A=~~O,B=B-+(_|0),O=O-+(A|0);do if(B<.5)if(B<.3333333333333333)if(g[d>>2]=_,O<(B+1)*.5){g[d+4>>2]=A;break}else{A=A+1|0,g[d+4>>2]=A;break}else if(Vt=1-B,A=(!(O<Vt)&1)+A|0,g[d+4>>2]=A,Vt<=O&O<B*2){_=_+1|0,g[d>>2]=_;break}else{g[d>>2]=_;break}else{if(!(B<.6666666666666666))if(_=_+1|0,g[d>>2]=_,O<B*.5){g[d+4>>2]=A;break}else{A=A+1|0,g[d+4>>2]=A;break}if(O<1-B){if(g[d+4>>2]=A,B*2+-1<O){g[d>>2]=_;break}}else A=A+1|0,g[d+4>>2]=A;_=_+1|0,g[d>>2]=_}while(!1);do if(W<0)if(A&1){nt=(A+1|0)/2|0,nt=aa(_|0,((_|0)<0)<<31>>31|0,nt|0,((nt|0)<0)<<31>>31|0)|0,_=~~(+(_|0)-((+(nt>>>0)+4294967296*+(wt()|0))*2+1)),g[d>>2]=_;break}else{nt=(A|0)/2|0,nt=aa(_|0,((_|0)<0)<<31>>31|0,nt|0,((nt|0)<0)<<31>>31|0)|0,_=~~(+(_|0)-(+(nt>>>0)+4294967296*+(wt()|0))*2),g[d>>2]=_;break}while(!1);nt=d+4|0,Q<0&&(_=_-((A<<1|1|0)/2|0)|0,g[d>>2]=_,A=0-A|0,g[nt>>2]=A),b=A-_|0,(_|0)<0?(I=0-_|0,g[nt>>2]=b,g[mt>>2]=I,g[d>>2]=0,A=b,_=0):I=0,(A|0)<0&&(_=_-A|0,g[d>>2]=_,I=I-A|0,g[mt>>2]=I,g[nt>>2]=0,A=0),P=_-I|0,b=A-I|0,(I|0)<0&&(g[d>>2]=P,g[nt>>2]=b,g[mt>>2]=0,A=b,_=P,I=0),b=(A|0)<(_|0)?A:_,b=(I|0)<(b|0)?I:b,!((b|0)<=0)&&(g[d>>2]=_-b,g[nt>>2]=A-b,g[mt>>2]=I-b)}function Ve(A){A=A|0;var d=0,_=0,b=0,I=0,P=0,B=0;d=g[A>>2]|0,B=A+4|0,_=g[B>>2]|0,(d|0)<0&&(_=_-d|0,g[B>>2]=_,P=A+8|0,g[P>>2]=(g[P>>2]|0)-d,g[A>>2]=0,d=0),(_|0)<0?(d=d-_|0,g[A>>2]=d,P=A+8|0,I=(g[P>>2]|0)-_|0,g[P>>2]=I,g[B>>2]=0,_=0):(I=A+8|0,P=I,I=g[I>>2]|0),(I|0)<0&&(d=d-I|0,g[A>>2]=d,_=_-I|0,g[B>>2]=_,g[P>>2]=0,I=0),b=(_|0)<(d|0)?_:d,b=(I|0)<(b|0)?I:b,!((b|0)<=0)&&(g[A>>2]=d-b,g[B>>2]=_-b,g[P>>2]=I-b)}function ec(A,d){A=A|0,d=d|0;var _=0,b=0;b=g[A+8>>2]|0,_=+((g[A+4>>2]|0)-b|0),ft[d>>3]=+((g[A>>2]|0)-b|0)-_*.5,ft[d+8>>3]=_*.8660254037844386}function xs(A,d,_){A=A|0,d=d|0,_=_|0,g[_>>2]=(g[d>>2]|0)+(g[A>>2]|0),g[_+4>>2]=(g[d+4>>2]|0)+(g[A+4>>2]|0),g[_+8>>2]=(g[d+8>>2]|0)+(g[A+8>>2]|0)}function gu(A,d,_){A=A|0,d=d|0,_=_|0,g[_>>2]=(g[A>>2]|0)-(g[d>>2]|0),g[_+4>>2]=(g[A+4>>2]|0)-(g[d+4>>2]|0),g[_+8>>2]=(g[A+8>>2]|0)-(g[d+8>>2]|0)}function Ym(A,d){A=A|0,d=d|0;var _=0,b=0;_=ia(g[A>>2]|0,d)|0,g[A>>2]=_,_=A+4|0,b=ia(g[_>>2]|0,d)|0,g[_>>2]=b,A=A+8|0,d=ia(g[A>>2]|0,d)|0,g[A>>2]=d}function qe(A){A=A|0;var d=0,_=0,b=0,I=0,P=0,B=0,O=0;B=g[A>>2]|0,O=(B|0)<0,b=(g[A+4>>2]|0)-(O?B:0)|0,P=(b|0)<0,I=(P?0-b|0:0)+((g[A+8>>2]|0)-(O?B:0))|0,_=(I|0)<0,A=_?0:I,d=(P?0:b)-(_?I:0)|0,I=(O?0:B)-(P?b:0)-(_?I:0)|0,_=(d|0)<(I|0)?d:I,_=(A|0)<(_|0)?A:_,b=(_|0)>0,A=A-(b?_:0)|0,d=d-(b?_:0)|0;t:do switch(I-(b?_:0)|0){case 0:switch(d|0){case 0:return O=A|0?(A|0)==1?1:7:0,O|0;case 1:return O=A|0?(A|0)==1?3:7:2,O|0;default:break t}case 1:switch(d|0){case 0:return O=A|0?(A|0)==1?5:7:4,O|0;case 1:{if(!A)A=6;else break t;return A|0}default:break t}default:}while(!1);return O=7,O|0}function Xm(A){A=A|0;var d=0,_=0,b=0,I=0,P=0,B=0,O=0;B=A+8|0,I=g[B>>2]|0,P=(g[A>>2]|0)-I|0,O=A+4|0,I=(g[O>>2]|0)-I|0;do if(P>>>0>715827881|I>>>0>715827881){if(_=(P|0)>0,_){if((2147483647-P|0)<(P|0)||(2147483647-(P<<1)|0)<(P|0))return O=1,O|0}else if((-2147483648-P|0)>(P|0)||(-2147483648-(P<<1)|0)>(P|0))return O=1,O|0;if(d=P*3|0,(I|0)>0){if((2147483647-I|0)<(I|0))return O=1,O|0}else if((-2147483648-I|0)>(I|0))return O=1,O|0;if(b=I<<1,(P|0)>-1){if((d|-2147483648|0)>=(I|0))return O=1,O|0}else if((d^-2147483648|0)<(I|0))return O=1,O|0;if(_){if((2147483647-P|0)<(b|0))d=1;else{_=b;break}return d|0}else{if((-2147483648-P|0)>(b|0))d=1;else{_=b;break}return d|0}}else _=I<<1,d=P*3|0;while(!1);b=kf(+(d-I|0)/7)|0,g[A>>2]=b,I=kf(+(_+P|0)/7)|0,g[O>>2]=I,g[B>>2]=0,_=(I|0)<(b|0),d=_?b:I,_=_?I:b;do if((_|0)<0){if((d|0)>0){if((d|-2147483648|0)<(_|0)&((_|0)!=-2147483648&(2147483647-d|0)>=(_|0)))break;Lr(23313,22444,355,22455)}if((_|0)==-2147483648|(-2147483648-d|0)>(_|0)&&Lr(23313,22444,355,22455),(d|0)>-1){if((d|-2147483648|0)<(_|0))break;Lr(23313,22444,355,22455)}else{if((d^-2147483648|0)>=(_|0))break;Lr(23313,22444,355,22455)}}while(!1);return d=I-b|0,(b|0)<0?(_=0-b|0,g[O>>2]=d,g[B>>2]=_,g[A>>2]=0,b=0):(d=I,_=0),(d|0)<0&&(b=b-d|0,g[A>>2]=b,_=_-d|0,g[B>>2]=_,g[O>>2]=0,d=0),P=b-_|0,I=d-_|0,(_|0)<0?(g[A>>2]=P,g[O>>2]=I,g[B>>2]=0,d=I,I=P,_=0):I=b,b=(d|0)<(I|0)?d:I,b=(_|0)<(b|0)?_:b,(b|0)<=0?(O=0,O|0):(g[A>>2]=I-b,g[O>>2]=d-b,g[B>>2]=_-b,O=0,O|0)}function Zm(A){A=A|0;var d=0,_=0,b=0,I=0,P=0,B=0,O=0;B=A+8|0,I=g[B>>2]|0,P=(g[A>>2]|0)-I|0,O=A+4|0,I=(g[O>>2]|0)-I|0;do if(P>>>0>715827881|I>>>0>715827881){if(_=(P|0)>0,_){if((2147483647-P|0)<(P|0))return O=1,O|0}else if((-2147483648-P|0)>(P|0))return O=1,O|0;if(d=P<<1,(I|0)>0){if((2147483647-I|0)<(I|0)||(2147483647-(I<<1)|0)<(I|0))return O=1,O|0}else if((-2147483648-I|0)>(I|0)||(-2147483648-(I<<1)|0)>(I|0))return O=1,O|0;if(b=I*3|0,_){if((2147483647-d|0)<(I|0))return O=1,O|0}else if((-2147483648-d|0)>(I|0))return O=1,O|0;if((I|0)>-1){if((b|-2147483648|0)<(P|0)){_=b;break}else d=1;return d|0}else{if((b^-2147483648|0)<(P|0))d=1;else{_=b;break}return d|0}}else _=I*3|0,d=P<<1;while(!1);b=kf(+(d+I|0)/7)|0,g[A>>2]=b,I=kf(+(_-P|0)/7)|0,g[O>>2]=I,g[B>>2]=0,_=(I|0)<(b|0),d=_?b:I,_=_?I:b;do if((_|0)<0){if((d|0)>0){if((d|-2147483648|0)<(_|0)&((_|0)!=-2147483648&(2147483647-d|0)>=(_|0)))break;Lr(23313,22444,404,22469)}if((_|0)==-2147483648|(-2147483648-d|0)>(_|0)&&Lr(23313,22444,404,22469),(d|0)>-1){if((d|-2147483648|0)<(_|0))break;Lr(23313,22444,404,22469)}else{if((d^-2147483648|0)>=(_|0))break;Lr(23313,22444,404,22469)}}while(!1);return d=I-b|0,(b|0)<0?(_=0-b|0,g[O>>2]=d,g[B>>2]=_,g[A>>2]=0,b=0):(d=I,_=0),(d|0)<0&&(b=b-d|0,g[A>>2]=b,_=_-d|0,g[B>>2]=_,g[O>>2]=0,d=0),P=b-_|0,I=d-_|0,(_|0)<0?(g[A>>2]=P,g[O>>2]=I,g[B>>2]=0,d=I,I=P,_=0):I=b,b=(d|0)<(I|0)?d:I,b=(_|0)<(b|0)?_:b,(b|0)<=0?(O=0,O|0):(g[A>>2]=I-b,g[O>>2]=d-b,g[B>>2]=_-b,O=0,O|0)}function ub(A){A=A|0;var d=0,_=0,b=0,I=0,P=0,B=0,O=0;B=A+8|0,_=g[B>>2]|0,d=(g[A>>2]|0)-_|0,O=A+4|0,_=(g[O>>2]|0)-_|0,b=kf(+((d*3|0)-_|0)/7)|0,g[A>>2]=b,d=kf(+((_<<1)+d|0)/7)|0,g[O>>2]=d,g[B>>2]=0,_=d-b|0,(b|0)<0?(P=0-b|0,g[O>>2]=_,g[B>>2]=P,g[A>>2]=0,d=_,b=0,_=P):_=0,(d|0)<0&&(b=b-d|0,g[A>>2]=b,_=_-d|0,g[B>>2]=_,g[O>>2]=0,d=0),P=b-_|0,I=d-_|0,(_|0)<0?(g[A>>2]=P,g[O>>2]=I,g[B>>2]=0,d=I,I=P,_=0):I=b,b=(d|0)<(I|0)?d:I,b=(_|0)<(b|0)?_:b,!((b|0)<=0)&&(g[A>>2]=I-b,g[O>>2]=d-b,g[B>>2]=_-b)}function q0(A){A=A|0;var d=0,_=0,b=0,I=0,P=0,B=0,O=0;B=A+8|0,_=g[B>>2]|0,d=(g[A>>2]|0)-_|0,O=A+4|0,_=(g[O>>2]|0)-_|0,b=kf(+((d<<1)+_|0)/7)|0,g[A>>2]=b,d=kf(+((_*3|0)-d|0)/7)|0,g[O>>2]=d,g[B>>2]=0,_=d-b|0,(b|0)<0?(P=0-b|0,g[O>>2]=_,g[B>>2]=P,g[A>>2]=0,d=_,b=0,_=P):_=0,(d|0)<0&&(b=b-d|0,g[A>>2]=b,_=_-d|0,g[B>>2]=_,g[O>>2]=0,d=0),P=b-_|0,I=d-_|0,(_|0)<0?(g[A>>2]=P,g[O>>2]=I,g[B>>2]=0,d=I,I=P,_=0):I=b,b=(d|0)<(I|0)?d:I,b=(_|0)<(b|0)?_:b,!((b|0)<=0)&&(g[A>>2]=I-b,g[O>>2]=d-b,g[B>>2]=_-b)}function sd(A){A=A|0;var d=0,_=0,b=0,I=0,P=0,B=0,O=0;d=g[A>>2]|0,B=A+4|0,_=g[B>>2]|0,O=A+8|0,b=g[O>>2]|0,I=_+(d*3|0)|0,g[A>>2]=I,_=b+(_*3|0)|0,g[B>>2]=_,d=(b*3|0)+d|0,g[O>>2]=d,b=_-I|0,(I|0)<0?(d=d-I|0,g[B>>2]=b,g[O>>2]=d,g[A>>2]=0,_=b,b=0):b=I,(_|0)<0&&(b=b-_|0,g[A>>2]=b,d=d-_|0,g[O>>2]=d,g[B>>2]=0,_=0),P=b-d|0,I=_-d|0,(d|0)<0?(g[A>>2]=P,g[B>>2]=I,g[O>>2]=0,b=P,d=0):I=_,_=(I|0)<(b|0)?I:b,_=(d|0)<(_|0)?d:_,!((_|0)<=0)&&(g[A>>2]=b-_,g[B>>2]=I-_,g[O>>2]=d-_)}function _u(A){A=A|0;var d=0,_=0,b=0,I=0,P=0,B=0,O=0;I=g[A>>2]|0,B=A+4|0,d=g[B>>2]|0,O=A+8|0,_=g[O>>2]|0,b=(d*3|0)+I|0,I=_+(I*3|0)|0,g[A>>2]=I,g[B>>2]=b,d=(_*3|0)+d|0,g[O>>2]=d,_=b-I|0,(I|0)<0?(d=d-I|0,g[B>>2]=_,g[O>>2]=d,g[A>>2]=0,I=0):_=b,(_|0)<0&&(I=I-_|0,g[A>>2]=I,d=d-_|0,g[O>>2]=d,g[B>>2]=0,_=0),P=I-d|0,b=_-d|0,(d|0)<0?(g[A>>2]=P,g[B>>2]=b,g[O>>2]=0,I=P,d=0):b=_,_=(b|0)<(I|0)?b:I,_=(d|0)<(_|0)?d:_,!((_|0)<=0)&&(g[A>>2]=I-_,g[B>>2]=b-_,g[O>>2]=d-_)}function Gm(A,d){A=A|0,d=d|0;var _=0,b=0,I=0,P=0,B=0,O=0;(d+-1|0)>>>0>=6||(I=(g[15440+(d*12|0)>>2]|0)+(g[A>>2]|0)|0,g[A>>2]=I,O=A+4|0,b=(g[15440+(d*12|0)+4>>2]|0)+(g[O>>2]|0)|0,g[O>>2]=b,B=A+8|0,d=(g[15440+(d*12|0)+8>>2]|0)+(g[B>>2]|0)|0,g[B>>2]=d,_=b-I|0,(I|0)<0?(d=d-I|0,g[O>>2]=_,g[B>>2]=d,g[A>>2]=0,b=0):(_=b,b=I),(_|0)<0&&(b=b-_|0,g[A>>2]=b,d=d-_|0,g[B>>2]=d,g[O>>2]=0,_=0),P=b-d|0,I=_-d|0,(d|0)<0?(g[A>>2]=P,g[O>>2]=I,g[B>>2]=0,b=P,d=0):I=_,_=(I|0)<(b|0)?I:b,_=(d|0)<(_|0)?d:_,!((_|0)<=0)&&(g[A>>2]=b-_,g[O>>2]=I-_,g[B>>2]=d-_))}function H_(A){A=A|0;var d=0,_=0,b=0,I=0,P=0,B=0,O=0;I=g[A>>2]|0,B=A+4|0,d=g[B>>2]|0,O=A+8|0,_=g[O>>2]|0,b=d+I|0,I=_+I|0,g[A>>2]=I,g[B>>2]=b,d=_+d|0,g[O>>2]=d,_=b-I|0,(I|0)<0?(d=d-I|0,g[B>>2]=_,g[O>>2]=d,g[A>>2]=0,b=0):(_=b,b=I),(_|0)<0&&(b=b-_|0,g[A>>2]=b,d=d-_|0,g[O>>2]=d,g[B>>2]=0,_=0),P=b-d|0,I=_-d|0,(d|0)<0?(g[A>>2]=P,g[B>>2]=I,g[O>>2]=0,b=P,d=0):I=_,_=(I|0)<(b|0)?I:b,_=(d|0)<(_|0)?d:_,!((_|0)<=0)&&(g[A>>2]=b-_,g[B>>2]=I-_,g[O>>2]=d-_)}function Ef(A){A=A|0;var d=0,_=0,b=0,I=0,P=0,B=0,O=0;d=g[A>>2]|0,B=A+4|0,b=g[B>>2]|0,O=A+8|0,_=g[O>>2]|0,I=b+d|0,g[A>>2]=I,b=_+b|0,g[B>>2]=b,d=_+d|0,g[O>>2]=d,_=b-I|0,(I|0)<0?(d=d-I|0,g[B>>2]=_,g[O>>2]=d,g[A>>2]=0,b=0):(_=b,b=I),(_|0)<0&&(b=b-_|0,g[A>>2]=b,d=d-_|0,g[O>>2]=d,g[B>>2]=0,_=0),P=b-d|0,I=_-d|0,(d|0)<0?(g[A>>2]=P,g[B>>2]=I,g[O>>2]=0,b=P,d=0):I=_,_=(I|0)<(b|0)?I:b,_=(d|0)<(_|0)?d:_,!((_|0)<=0)&&(g[A>>2]=b-_,g[B>>2]=I-_,g[O>>2]=d-_)}function Uc(A){switch(A=A|0,A|0){case 1:{A=5;break}case 5:{A=4;break}case 4:{A=6;break}case 6:{A=2;break}case 2:{A=3;break}case 3:{A=1;break}default:}return A|0}function rc(A){switch(A=A|0,A|0){case 1:{A=3;break}case 3:{A=2;break}case 2:{A=6;break}case 6:{A=4;break}case 4:{A=5;break}case 5:{A=1;break}default:}return A|0}function Y0(A){A=A|0;var d=0,_=0,b=0,I=0,P=0,B=0,O=0;d=g[A>>2]|0,B=A+4|0,_=g[B>>2]|0,O=A+8|0,b=g[O>>2]|0,I=_+(d<<1)|0,g[A>>2]=I,_=b+(_<<1)|0,g[B>>2]=_,d=(b<<1)+d|0,g[O>>2]=d,b=_-I|0,(I|0)<0?(d=d-I|0,g[B>>2]=b,g[O>>2]=d,g[A>>2]=0,_=b,b=0):b=I,(_|0)<0&&(b=b-_|0,g[A>>2]=b,d=d-_|0,g[O>>2]=d,g[B>>2]=0,_=0),P=b-d|0,I=_-d|0,(d|0)<0?(g[A>>2]=P,g[B>>2]=I,g[O>>2]=0,b=P,d=0):I=_,_=(I|0)<(b|0)?I:b,_=(d|0)<(_|0)?d:_,!((_|0)<=0)&&(g[A>>2]=b-_,g[B>>2]=I-_,g[O>>2]=d-_)}function jo(A){A=A|0;var d=0,_=0,b=0,I=0,P=0,B=0,O=0;I=g[A>>2]|0,B=A+4|0,d=g[B>>2]|0,O=A+8|0,_=g[O>>2]|0,b=(d<<1)+I|0,I=_+(I<<1)|0,g[A>>2]=I,g[B>>2]=b,d=(_<<1)+d|0,g[O>>2]=d,_=b-I|0,(I|0)<0?(d=d-I|0,g[B>>2]=_,g[O>>2]=d,g[A>>2]=0,I=0):_=b,(_|0)<0&&(I=I-_|0,g[A>>2]=I,d=d-_|0,g[O>>2]=d,g[B>>2]=0,_=0),P=I-d|0,b=_-d|0,(d|0)<0?(g[A>>2]=P,g[B>>2]=b,g[O>>2]=0,I=P,d=0):b=_,_=(b|0)<(I|0)?b:I,_=(d|0)<(_|0)?d:_,!((_|0)<=0)&&(g[A>>2]=I-_,g[B>>2]=b-_,g[O>>2]=d-_)}function ic(A,d){A=A|0,d=d|0;var _=0,b=0,I=0,P=0,B=0,O=0;return B=(g[A>>2]|0)-(g[d>>2]|0)|0,O=(B|0)<0,b=(g[A+4>>2]|0)-(g[d+4>>2]|0)-(O?B:0)|0,P=(b|0)<0,I=(O?0-B|0:0)+(g[A+8>>2]|0)-(g[d+8>>2]|0)+(P?0-b|0:0)|0,A=(I|0)<0,d=A?0:I,_=(P?0:b)-(A?I:0)|0,I=(O?0:B)-(P?b:0)-(A?I:0)|0,A=(_|0)<(I|0)?_:I,A=(d|0)<(A|0)?d:A,b=(A|0)>0,d=d-(b?A:0)|0,_=_-(b?A:0)|0,A=I-(b?A:0)|0,A=(A|0)>-1?A:0-A|0,_=(_|0)>-1?_:0-_|0,d=(d|0)>-1?d:0-d|0,d=(_|0)>(d|0)?_:d,((A|0)>(d|0)?A:d)|0}function od(A,d){A=A|0,d=d|0;var _=0;_=g[A+8>>2]|0,g[d>>2]=(g[A>>2]|0)-_,g[d+4>>2]=(g[A+4>>2]|0)-_}function Qm(A,d){A=A|0,d=d|0;var _=0,b=0,I=0,P=0,B=0,O=0;b=g[A>>2]|0,g[d>>2]=b,I=g[A+4>>2]|0,B=d+4|0,g[B>>2]=I,O=d+8|0,g[O>>2]=0,_=(I|0)<(b|0),A=_?b:I,_=_?I:b;do if((_|0)<0){if((A|0)>0){if((A|-2147483648|0)<(_|0)&((_|0)!=-2147483648&(2147483647-A|0)>=(_|0)))break;return A=1,A|0}if((_|0)==-2147483648|(-2147483648-A|0)>(_|0))return d=1,d|0;if((A|0)>-1){if((A|-2147483648|0)<(_|0))break;return A=1,A|0}else{if((A^-2147483648|0)<(_|0))A=1;else break;return A|0}}while(!1);return A=I-b|0,(b|0)<0?(_=0-b|0,g[B>>2]=A,g[O>>2]=_,g[d>>2]=0,b=0):(A=I,_=0),(A|0)<0&&(b=b-A|0,g[d>>2]=b,_=_-A|0,g[O>>2]=_,g[B>>2]=0,A=0),P=b-_|0,I=A-_|0,(_|0)<0?(g[d>>2]=P,g[B>>2]=I,g[O>>2]=0,A=I,I=P,_=0):I=b,b=(A|0)<(I|0)?A:I,b=(_|0)<(b|0)?_:b,(b|0)<=0?(d=0,d|0):(g[d>>2]=I-b,g[B>>2]=A-b,g[O>>2]=_-b,d=0,d|0)}function If(A){A=A|0;var d=0,_=0,b=0,I=0;d=A+8|0,I=g[d>>2]|0,_=I-(g[A>>2]|0)|0,g[A>>2]=_,b=A+4|0,A=(g[b>>2]|0)-I|0,g[b>>2]=A,g[d>>2]=0-(A+_)}function Km(A){A=A|0;var d=0,_=0,b=0,I=0,P=0,B=0,O=0;_=g[A>>2]|0,d=0-_|0,g[A>>2]=d,B=A+8|0,g[B>>2]=0,O=A+4|0,b=g[O>>2]|0,I=b+_|0,(_|0)>0?(g[O>>2]=I,g[B>>2]=_,g[A>>2]=0,d=0,b=I):_=0,(b|0)<0?(P=d-b|0,g[A>>2]=P,_=_-b|0,g[B>>2]=_,g[O>>2]=0,I=P-_|0,d=0-_|0,(_|0)<0?(g[A>>2]=I,g[O>>2]=d,g[B>>2]=0,b=d,_=0):(b=0,I=P)):I=d,d=(b|0)<(I|0)?b:I,d=(_|0)<(d|0)?_:d,!((d|0)<=0)&&(g[A>>2]=I-d,g[O>>2]=b-d,g[B>>2]=_-d)}function W_(A,d,_,b,I){A=A|0,d=d|0,_=_|0,b=b|0,I=I|0;var P=0,B=0,O=0,W=0,Q=0,nt=0,mt=0;if(mt=pt,pt=pt+64|0,nt=mt,O=mt+56|0,!(!0&(d&2013265920|0)==134217728&(!0&(b&2013265920|0)==134217728)))return I=5,pt=mt,I|0;if((A|0)==(_|0)&(d|0)==(b|0))return g[I>>2]=0,I=0,pt=mt,I|0;if(B=De(A|0,d|0,52)|0,wt()|0,B=B&15,Q=De(_|0,b|0,52)|0,wt()|0,(B|0)!=(Q&15|0))return I=12,pt=mt,I|0;if(P=B+-1|0,B>>>0>1){qn(A,d,P,nt)|0,qn(_,b,P,O)|0,Q=nt,W=g[Q>>2]|0,Q=g[Q+4>>2]|0;t:do if((W|0)==(g[O>>2]|0)&&(Q|0)==(g[O+4>>2]|0)){B=(B^15)*3|0,P=De(A|0,d|0,B|0)|0,wt()|0,P=P&7,B=De(_|0,b|0,B|0)|0,wt()|0,B=B&7;do if((P|0)==0|(B|0)==0)g[I>>2]=1,P=0;else if((P|0)==7)P=5;else{if((P|0)==1|(B|0)==1&&wn(W,Q)|0){P=5;break}if((g[15536+(P<<2)>>2]|0)!=(B|0)&&(g[15568+(P<<2)>>2]|0)!=(B|0))break t;g[I>>2]=1,P=0}while(!1);return I=P,pt=mt,I|0}while(!1)}P=nt,B=P+56|0;do g[P>>2]=0,P=P+4|0;while((P|0)<(B|0));return id(A,d,1,nt)|0,d=nt,!((g[d>>2]|0)==(_|0)&&(g[d+4>>2]|0)==(b|0))&&(d=nt+8|0,!((g[d>>2]|0)==(_|0)&&(g[d+4>>2]|0)==(b|0)))&&(d=nt+16|0,!((g[d>>2]|0)==(_|0)&&(g[d+4>>2]|0)==(b|0)))&&(d=nt+24|0,!((g[d>>2]|0)==(_|0)&&(g[d+4>>2]|0)==(b|0)))&&(d=nt+32|0,!((g[d>>2]|0)==(_|0)&&(g[d+4>>2]|0)==(b|0)))&&(d=nt+40|0,!((g[d>>2]|0)==(_|0)&&(g[d+4>>2]|0)==(b|0)))?(P=nt+48|0,P=((g[P>>2]|0)==(_|0)?(g[P+4>>2]|0)==(b|0):0)&1):P=1,g[I>>2]=P,I=0,pt=mt,I|0}function Sa(A,d,_,b,I){return A=A|0,d=d|0,_=_|0,b=b|0,I=I|0,_=j0(A,d,_,b)|0,(_|0)==7?(I=11,I|0):(b=Ge(_|0,0,56)|0,d=d&-2130706433|(wt()|0)|268435456,g[I>>2]=A|b,g[I+4>>2]=d,I=0,I|0)}function Wn(A,d,_){return A=A|0,d=d|0,_=_|0,!0&(d&2013265920|0)==268435456?(g[_>>2]=A,g[_+4>>2]=d&-2130706433|134217728,_=0,_|0):(_=6,_|0)}function X0(A,d,_){A=A|0,d=d|0,_=_|0;var b=0,I=0,P=0;return I=pt,pt=pt+16|0,b=I,g[b>>2]=0,!0&(d&2013265920|0)==268435456?(P=De(A|0,d|0,56)|0,wt()|0,b=Ws(A,d&-2130706433|134217728,P&7,b,_)|0,pt=I,b|0):(b=6,pt=I,b|0)}function Jm(A,d){A=A|0,d=d|0;var _=0;switch(_=De(A|0,d|0,56)|0,wt()|0,_&7){case 0:case 7:return _=0,_|0;default:}return _=d&-2130706433|134217728,!(!0&(d&2013265920|0)==268435456)||!0&(d&117440512|0)==16777216&(wn(A,_)|0)!=0?(_=0,_|0):(_=Gn(A,_)|0,_|0)}function q_(A,d,_){A=A|0,d=d|0,_=_|0;var b=0,I=0,P=0,B=0;return I=pt,pt=pt+16|0,b=I,!0&(d&2013265920|0)==268435456?(P=d&-2130706433|134217728,B=_,g[B>>2]=A,g[B+4>>2]=P,g[b>>2]=0,d=De(A|0,d|0,56)|0,wt()|0,b=Ws(A,P,d&7,b,_+8|0)|0,pt=I,b|0):(b=6,pt=I,b|0)}function Y_(A,d,_){A=A|0,d=d|0,_=_|0;var b=0,I=0;return I=(wn(A,d)|0)==0,d=d&-2130706433,b=_,g[b>>2]=I?A:0,g[b+4>>2]=I?d|285212672:0,b=_+8|0,g[b>>2]=A,g[b+4>>2]=d|301989888,b=_+16|0,g[b>>2]=A,g[b+4>>2]=d|318767104,b=_+24|0,g[b>>2]=A,g[b+4>>2]=d|335544320,b=_+32|0,g[b>>2]=A,g[b+4>>2]=d|352321536,_=_+40|0,g[_>>2]=A,g[_+4>>2]=d|369098752,0}function ad(A,d,_){A=A|0,d=d|0,_=_|0;var b=0,I=0,P=0,B=0;return B=pt,pt=pt+16|0,I=B,P=d&-2130706433|134217728,!0&(d&2013265920|0)==268435456?(b=De(A|0,d|0,56)|0,wt()|0,b=jc(A,P,b&7)|0,(b|0)==-1?(g[_>>2]=0,P=6,pt=B,P|0):($(A,P,I)|0&&Lr(23313,22484,282,22499),d=De(A|0,d|0,52)|0,wt()|0,d=d&15,wn(A,P)|0?wh(I,d,b,2,_):ld(I,d,b,2,_),P=0,pt=B,P|0)):(P=6,pt=B,P|0)}function hb(A,d,_){A=A|0,d=d|0,_=_|0;var b=0,I=0;b=pt,pt=pt+16|0,I=b,$o(A,d,_,I),zc(I,_+4|0),pt=b}function $o(A,d,_,b){A=A|0,d=d|0,_=_|0,b=b|0;var I=0,P=0,B=0,O=0,W=0;if(O=pt,pt=pt+16|0,W=O,Z0(A,_,W),P=+z0(+(1-+ft[W>>3]*.5)),P<1e-16){g[b>>2]=0,g[b+4>>2]=0,g[b+8>>2]=0,g[b+12>>2]=0,pt=O;return}if(W=g[_>>2]|0,I=+ft[15920+(W*24|0)>>3],I=+Ot(I-+Ot(+Pe(15600+(W<<4)|0,A))),C(d)|0?B=+Ot(I+-.3334731722518321):B=I,I=+Au(+P)/.381966011250105,(d|0)>0){A=0;do I=I*2.6457513110645907,A=A+1|0;while((A|0)!=(d|0))}P=+ln(+B)*I,ft[b>>3]=P,B=+cn(+B)*I,ft[b+8>>3]=B,pt=O}function Z0(A,d,_){A=A|0,d=d|0,_=_|0;var b=0,I=0,P=0;if(P=pt,pt=pt+32|0,I=P,sg(A,I),g[d>>2]=0,ft[_>>3]=5,b=+In(16400,I),b<+ft[_>>3]&&(g[d>>2]=0,ft[_>>3]=b),b=+In(16424,I),b<+ft[_>>3]&&(g[d>>2]=1,ft[_>>3]=b),b=+In(16448,I),b<+ft[_>>3]&&(g[d>>2]=2,ft[_>>3]=b),b=+In(16472,I),b<+ft[_>>3]&&(g[d>>2]=3,ft[_>>3]=b),b=+In(16496,I),b<+ft[_>>3]&&(g[d>>2]=4,ft[_>>3]=b),b=+In(16520,I),b<+ft[_>>3]&&(g[d>>2]=5,ft[_>>3]=b),b=+In(16544,I),b<+ft[_>>3]&&(g[d>>2]=6,ft[_>>3]=b),b=+In(16568,I),b<+ft[_>>3]&&(g[d>>2]=7,ft[_>>3]=b),b=+In(16592,I),b<+ft[_>>3]&&(g[d>>2]=8,ft[_>>3]=b),b=+In(16616,I),b<+ft[_>>3]&&(g[d>>2]=9,ft[_>>3]=b),b=+In(16640,I),b<+ft[_>>3]&&(g[d>>2]=10,ft[_>>3]=b),b=+In(16664,I),b<+ft[_>>3]&&(g[d>>2]=11,ft[_>>3]=b),b=+In(16688,I),b<+ft[_>>3]&&(g[d>>2]=12,ft[_>>3]=b),b=+In(16712,I),b<+ft[_>>3]&&(g[d>>2]=13,ft[_>>3]=b),b=+In(16736,I),b<+ft[_>>3]&&(g[d>>2]=14,ft[_>>3]=b),b=+In(16760,I),b<+ft[_>>3]&&(g[d>>2]=15,ft[_>>3]=b),b=+In(16784,I),b<+ft[_>>3]&&(g[d>>2]=16,ft[_>>3]=b),b=+In(16808,I),b<+ft[_>>3]&&(g[d>>2]=17,ft[_>>3]=b),b=+In(16832,I),b<+ft[_>>3]&&(g[d>>2]=18,ft[_>>3]=b),b=+In(16856,I),!(b<+ft[_>>3])){pt=P;return}g[d>>2]=19,ft[_>>3]=b,pt=P}function cr(A,d,_,b,I){A=A|0,d=d|0,_=_|0,b=b|0,I=I|0;var P=0,B=0;if(P=+Ih(A),P<1e-16){d=15600+(d<<4)|0,g[I>>2]=g[d>>2],g[I+4>>2]=g[d+4>>2],g[I+8>>2]=g[d+8>>2],g[I+12>>2]=g[d+12>>2];return}if(B=+ra(+ +ft[A+8>>3],+ +ft[A>>3]),(_|0)>0){A=0;do P=P/2.6457513110645907,A=A+1|0;while((A|0)!=(_|0))}b?(P=P/3,_=(C(_)|0)==0,P=+bf(+((_?P:P/2.6457513110645907)*.381966011250105))):(P=+bf(+(P*.381966011250105)),C(_)|0&&(B=+Ot(B+.3334731722518321))),Te(15600+(d<<4)|0,+Ot(+ft[15920+(d*24|0)>>3]-B),P,I)}function Rr(A,d,_){A=A|0,d=d|0,_=_|0;var b=0,I=0;b=pt,pt=pt+16|0,I=b,ec(A+4|0,I),cr(I,g[A>>2]|0,d,0,_),pt=b}function wh(A,d,_,b,I){A=A|0,d=d|0,_=_|0,b=b|0,I=I|0;var P=0,B=0,O=0,W=0,Q=0,nt=0,mt=0,Vt=0,Yt=0,zt=0,re=0,ge=0,Ae=0,ue=0,fe=0,ie=0,tr=0,fr=0,Xe=0,er=0,_n=0,un=0,Yi=0,Ci=0,Ar=0,Ai=0,Rn=0,Kr=0;if(Ai=pt,pt=pt+272|0,P=Ai+256|0,ue=Ai+240|0,Yi=Ai,Ci=Ai+224|0,Ar=Ai+208|0,fe=Ai+176|0,ie=Ai+160|0,tr=Ai+192|0,fr=Ai+144|0,Xe=Ai+128|0,er=Ai+112|0,_n=Ai+96|0,un=Ai+80|0,g[P>>2]=d,g[ue>>2]=g[A>>2],g[ue+4>>2]=g[A+4>>2],g[ue+8>>2]=g[A+8>>2],g[ue+12>>2]=g[A+12>>2],G0(ue,P,Yi),g[I>>2]=0,ue=b+_+((b|0)==5&1)|0,(ue|0)<=(_|0)){pt=Ai;return}W=g[P>>2]|0,Q=Ci+4|0,nt=fe+4|0,mt=_+5|0,Vt=16880+(W<<2)|0,Yt=16960+(W<<2)|0,zt=Xe+8|0,re=er+8|0,ge=_n+8|0,Ae=Ar+4|0,O=_;t:for(;;){B=Yi+(((O|0)%5|0)<<4)|0,g[Ar>>2]=g[B>>2],g[Ar+4>>2]=g[B+4>>2],g[Ar+8>>2]=g[B+8>>2],g[Ar+12>>2]=g[B+12>>2];do;while((yu(Ar,W,0,1)|0)==2);if((O|0)>(_|0)&(C(d)|0)!=0){if(g[fe>>2]=g[Ar>>2],g[fe+4>>2]=g[Ar+4>>2],g[fe+8>>2]=g[Ar+8>>2],g[fe+12>>2]=g[Ar+12>>2],ec(Q,ie),b=g[fe>>2]|0,P=g[17040+(b*80|0)+(g[Ci>>2]<<2)>>2]|0,g[fe>>2]=g[18640+(b*80|0)+(P*20|0)>>2],B=g[18640+(b*80|0)+(P*20|0)+16>>2]|0,(B|0)>0){A=0;do H_(nt),A=A+1|0;while((A|0)<(B|0))}switch(B=18640+(b*80|0)+(P*20|0)+4|0,g[tr>>2]=g[B>>2],g[tr+4>>2]=g[B+4>>2],g[tr+8>>2]=g[B+8>>2],Ym(tr,(g[Vt>>2]|0)*3|0),xs(nt,tr,nt),Ve(nt),ec(nt,fr),Rn=+(g[Yt>>2]|0),ft[Xe>>3]=Rn*3,ft[zt>>3]=0,Kr=Rn*-1.5,ft[er>>3]=Kr,ft[re>>3]=Rn*2.598076211353316,ft[_n>>3]=Kr,ft[ge>>3]=Rn*-2.598076211353316,g[17040+((g[fe>>2]|0)*80|0)+(g[Ar>>2]<<2)>>2]|0){case 1:{A=er,b=Xe;break}case 3:{A=_n,b=er;break}case 2:{A=Xe,b=_n;break}default:{A=12;break t}}El(ie,fr,b,A,un),cr(un,g[fe>>2]|0,W,1,I+8+(g[I>>2]<<4)|0),g[I>>2]=(g[I>>2]|0)+1}if((O|0)<(mt|0)&&(ec(Ae,fe),cr(fe,g[Ar>>2]|0,W,1,I+8+(g[I>>2]<<4)|0),g[I>>2]=(g[I>>2]|0)+1),g[Ci>>2]=g[Ar>>2],g[Ci+4>>2]=g[Ar+4>>2],g[Ci+8>>2]=g[Ar+8>>2],g[Ci+12>>2]=g[Ar+12>>2],O=O+1|0,(O|0)>=(ue|0)){A=3;break}}if((A|0)==3){pt=Ai;return}else(A|0)==12&&Lr(22522,22569,571,22579)}function G0(A,d,_){A=A|0,d=d|0,_=_|0;var b=0,I=0,P=0,B=0,O=0,W=0;W=pt,pt=pt+128|0,b=W+64|0,I=W,P=b,B=20240,O=P+60|0;do g[P>>2]=g[B>>2],P=P+4|0,B=B+4|0;while((P|0)<(O|0));P=I,B=20304,O=P+60|0;do g[P>>2]=g[B>>2],P=P+4|0,B=B+4|0;while((P|0)<(O|0));O=(C(g[d>>2]|0)|0)==0,b=O?b:I,I=A+4|0,Y0(I),jo(I),C(g[d>>2]|0)|0&&(_u(I),g[d>>2]=(g[d>>2]|0)+1),g[_>>2]=g[A>>2],d=_+4|0,xs(I,b,d),Ve(d),g[_+16>>2]=g[A>>2],d=_+20|0,xs(I,b+12|0,d),Ve(d),g[_+32>>2]=g[A>>2],d=_+36|0,xs(I,b+24|0,d),Ve(d),g[_+48>>2]=g[A>>2],d=_+52|0,xs(I,b+36|0,d),Ve(d),g[_+64>>2]=g[A>>2],_=_+68|0,xs(I,b+48|0,_),Ve(_),pt=W}function yu(A,d,_,b){A=A|0,d=d|0,_=_|0,b=b|0;var I=0,P=0,B=0,O=0,W=0,Q=0,nt=0,mt=0,Vt=0,Yt=0,zt=0;if(zt=pt,pt=pt+32|0,Vt=zt+12|0,O=zt,Yt=A+4|0,mt=g[16960+(d<<2)>>2]|0,nt=(b|0)!=0,mt=nt?mt*3|0:mt,I=g[Yt>>2]|0,Q=A+8|0,B=g[Q>>2]|0,nt){if(P=A+12|0,b=g[P>>2]|0,I=B+I+b|0,(I|0)==(mt|0))return Yt=1,pt=zt,Yt|0;W=P}else W=A+12|0,b=g[W>>2]|0,I=B+I+b|0;if((I|0)<=(mt|0))return Yt=0,pt=zt,Yt|0;do if((b|0)>0){if(b=g[A>>2]|0,(B|0)>0){P=18640+(b*80|0)+60|0,b=A;break}b=18640+(b*80|0)+40|0,_?(Sf(Vt,mt,0,0),gu(Yt,Vt,O),Ef(O),xs(O,Vt,Yt),P=b,b=A):(P=b,b=A)}else P=18640+((g[A>>2]|0)*80|0)+20|0,b=A;while(!1);if(g[b>>2]=g[P>>2],I=P+16|0,(g[I>>2]|0)>0){b=0;do H_(Yt),b=b+1|0;while((b|0)<(g[I>>2]|0))}return A=P+4|0,g[Vt>>2]=g[A>>2],g[Vt+4>>2]=g[A+4>>2],g[Vt+8>>2]=g[A+8>>2],d=g[16880+(d<<2)>>2]|0,Ym(Vt,nt?d*3|0:d),xs(Yt,Vt,Yt),Ve(Yt),nt?b=((g[Q>>2]|0)+(g[Yt>>2]|0)+(g[W>>2]|0)|0)==(mt|0)?1:2:b=2,Yt=b,pt=zt,Yt|0}function Ps(A,d){A=A|0,d=d|0;var _=0;do _=yu(A,d,0,1)|0;while((_|0)==2);return _|0}function ld(A,d,_,b,I){A=A|0,d=d|0,_=_|0,b=b|0,I=I|0;var P=0,B=0,O=0,W=0,Q=0,nt=0,mt=0,Vt=0,Yt=0,zt=0,re=0,ge=0,Ae=0,ue=0,fe=0,ie=0,tr=0,fr=0,Xe=0,er=0,_n=0,un=0,Yi=0;if(_n=pt,pt=pt+240|0,P=_n+224|0,tr=_n+208|0,fr=_n,Xe=_n+192|0,er=_n+176|0,ge=_n+160|0,Ae=_n+144|0,ue=_n+128|0,fe=_n+112|0,ie=_n+96|0,g[P>>2]=d,g[tr>>2]=g[A>>2],g[tr+4>>2]=g[A+4>>2],g[tr+8>>2]=g[A+8>>2],g[tr+12>>2]=g[A+12>>2],Ea(tr,P,fr),g[I>>2]=0,re=b+_+((b|0)==6&1)|0,(re|0)<=(_|0)){pt=_n;return}W=g[P>>2]|0,Q=_+6|0,nt=16960+(W<<2)|0,mt=Ae+8|0,Vt=ue+8|0,Yt=fe+8|0,zt=Xe+4|0,B=0,O=_,b=-1;t:for(;;){if(P=(O|0)%6|0,A=fr+(P<<4)|0,g[Xe>>2]=g[A>>2],g[Xe+4>>2]=g[A+4>>2],g[Xe+8>>2]=g[A+8>>2],g[Xe+12>>2]=g[A+12>>2],A=B,B=yu(Xe,W,0,1)|0,(O|0)>(_|0)&(C(d)|0)!=0&&(A|0)!=1&&(g[Xe>>2]|0)!=(b|0)){switch(ec(fr+(((P+5|0)%6|0)<<4)+4|0,er),ec(fr+(P<<4)+4|0,ge),un=+(g[nt>>2]|0),ft[Ae>>3]=un*3,ft[mt>>3]=0,Yi=un*-1.5,ft[ue>>3]=Yi,ft[Vt>>3]=un*2.598076211353316,ft[fe>>3]=Yi,ft[Yt>>3]=un*-2.598076211353316,P=g[tr>>2]|0,g[17040+(P*80|0)+(((b|0)==(P|0)?g[Xe>>2]|0:b)<<2)>>2]|0){case 1:{A=ue,b=Ae;break}case 3:{A=fe,b=ue;break}case 2:{A=Ae,b=fe;break}default:{A=8;break t}}El(er,ge,b,A,ie),!(Ma(er,ie)|0)&&!(Ma(ge,ie)|0)&&(cr(ie,g[tr>>2]|0,W,1,I+8+(g[I>>2]<<4)|0),g[I>>2]=(g[I>>2]|0)+1)}if((O|0)<(Q|0)&&(ec(zt,er),cr(er,g[Xe>>2]|0,W,1,I+8+(g[I>>2]<<4)|0),g[I>>2]=(g[I>>2]|0)+1),O=O+1|0,(O|0)>=(re|0)){A=3;break}else b=g[Xe>>2]|0}if((A|0)==3){pt=_n;return}else(A|0)==8&&Lr(22606,22569,736,22651)}function Ea(A,d,_){A=A|0,d=d|0,_=_|0;var b=0,I=0,P=0,B=0,O=0,W=0;W=pt,pt=pt+160|0,b=W+80|0,I=W,P=b,B=20368,O=P+72|0;do g[P>>2]=g[B>>2],P=P+4|0,B=B+4|0;while((P|0)<(O|0));P=I,B=20448,O=P+72|0;do g[P>>2]=g[B>>2],P=P+4|0,B=B+4|0;while((P|0)<(O|0));O=(C(g[d>>2]|0)|0)==0,b=O?b:I,I=A+4|0,Y0(I),jo(I),C(g[d>>2]|0)|0&&(_u(I),g[d>>2]=(g[d>>2]|0)+1),g[_>>2]=g[A>>2],d=_+4|0,xs(I,b,d),Ve(d),g[_+16>>2]=g[A>>2],d=_+20|0,xs(I,b+12|0,d),Ve(d),g[_+32>>2]=g[A>>2],d=_+36|0,xs(I,b+24|0,d),Ve(d),g[_+48>>2]=g[A>>2],d=_+52|0,xs(I,b+36|0,d),Ve(d),g[_+64>>2]=g[A>>2],d=_+68|0,xs(I,b+48|0,d),Ve(d),g[_+80>>2]=g[A>>2],_=_+84|0,xs(I,b+60|0,_),Ve(_),pt=W}function X_(A,d){return A=A|0,d=d|0,d=De(A|0,d|0,52)|0,wt()|0,d&15|0}function xu(A,d){return A=A|0,d=d|0,d=De(A|0,d|0,45)|0,wt()|0,d&127|0}function Gn(A,d){A=A|0,d=d|0;var _=0,b=0,I=0,P=0,B=0,O=0;if(!(!0&(d&-16777216|0)==134217728)||(B=De(A|0,d|0,45)|0,wt()|0,B=B&127,B>>>0>121))return d=0,d|0;_=De(A|0,d|0,52)|0,wt()|0,_=_&15;do if(_|0){for(I=1,b=0;;){if(P=De(A|0,d|0,(15-I|0)*3|0)|0,wt()|0,P=P&7,(P|0)!=0&(b^1))if((P|0)==1&(vn(B)|0)!=0){O=0,b=13;break}else b=1;if((P|0)==7){O=0,b=13;break}if(I>>>0<_>>>0)I=I+1|0;else{b=9;break}}if((b|0)==9){if((_|0)==15)O=1;else break;return O|0}else if((b|0)==13)return O|0}while(!1);for(;;){if(O=De(A|0,d|0,(14-_|0)*3|0)|0,wt()|0,!((O&7|0)==7&!0)){O=0,b=13;break}if(_>>>0<14)_=_+1|0;else{O=1,b=13;break}}return(b|0)==13?O|0:0}function qn(A,d,_,b){A=A|0,d=d|0,_=_|0,b=b|0;var I=0,P=0;if(P=De(A|0,d|0,52)|0,wt()|0,P=P&15,_>>>0>15)return b=4,b|0;if((P|0)<(_|0))return b=12,b|0;if((P|0)==(_|0))return g[b>>2]=A,g[b+4>>2]=d,b=0,b|0;if(I=Ge(_|0,0,52)|0,I=I|A,A=wt()|0|d&-15728641,(P|0)>(_|0))do d=Ge(7,0,(14-_|0)*3|0)|0,_=_+1|0,I=d|I,A=wt()|0|A;while((_|0)<(P|0));return g[b>>2]=I,g[b+4>>2]=A,b=0,b|0}function Vc(A,d,_,b){A=A|0,d=d|0,_=_|0,b=b|0;var I=0,P=0,B=0;if(P=De(A|0,d|0,52)|0,wt()|0,P=P&15,!((_|0)<16&(P|0)<=(_|0)))return b=4,b|0;I=_-P|0,_=De(A|0,d|0,45)|0,wt()|0;t:do if(!(vn(_&127)|0))_=ws(7,0,I,((I|0)<0)<<31>>31)|0,I=wt()|0;else{e:do if(P|0){for(_=1;B=Ge(7,0,(15-_|0)*3|0)|0,!!((B&A|0)==0&((wt()|0)&d|0)==0);)if(_>>>0<P>>>0)_=_+1|0;else break e;_=ws(7,0,I,((I|0)<0)<<31>>31)|0,I=wt()|0;break t}while(!1);_=ws(7,0,I,((I|0)<0)<<31>>31)|0,_=Ho(_|0,wt()|0,5,0)|0,_=Ei(_|0,wt()|0,-5,-1)|0,_=wu(_|0,wt()|0,6,0)|0,_=Ei(_|0,wt()|0,1,0)|0,I=wt()|0}while(!1);return B=b,g[B>>2]=_,g[B+4>>2]=I,B=0,B|0}function wn(A,d){A=A|0,d=d|0;var _=0,b=0,I=0;if(I=De(A|0,d|0,45)|0,wt()|0,!(vn(I&127)|0))return I=0,I|0;I=De(A|0,d|0,52)|0,wt()|0,I=I&15;t:do if(!I)_=0;else for(b=1;;){if(_=De(A|0,d|0,(15-b|0)*3|0)|0,wt()|0,_=_&7,_|0)break t;if(b>>>0<I>>>0)b=b+1|0;else{_=0;break}}while(!1);return I=(_|0)==0&1,I|0}function cd(A,d,_,b){A=A|0,d=d|0,_=_|0,b=b|0;var I=0,P=0,B=0,O=0;if(B=pt,pt=pt+16|0,P=B,Zt(P,A,d,_),d=P,A=g[d>>2]|0,d=g[d+4>>2]|0,(A|0)==0&(d|0)==0)return pt=B,0;I=0,_=0;do O=b+(I<<3)|0,g[O>>2]=A,g[O+4>>2]=d,I=Ei(I|0,_|0,1,0)|0,_=wt()|0,ne(P),O=P,A=g[O>>2]|0,d=g[O+4>>2]|0;while(!((A|0)==0&(d|0)==0));return pt=B,0}function Th(A,d,_,b){return A=A|0,d=d|0,_=_|0,b=b|0,(b|0)<(_|0)?(_=d,b=A,Si(_|0),b|0):(_=Ge(-1,-1,((b-_|0)*3|0)+3|0)|0,b=Ge(~_|0,~(wt()|0)|0,(15-b|0)*3|0)|0,_=~(wt()|0)&d,b=~b&A,Si(_|0),b|0)}function tg(A,d,_,b){A=A|0,d=d|0,_=_|0,b=b|0;var I=0;return I=De(A|0,d|0,52)|0,wt()|0,I=I&15,(_|0)<16&(I|0)<=(_|0)?((I|0)<(_|0)&&(I=Ge(-1,-1,((_+-1-I|0)*3|0)+3|0)|0,I=Ge(~I|0,~(wt()|0)|0,(15-_|0)*3|0)|0,d=~(wt()|0)&d,A=~I&A),I=Ge(_|0,0,52)|0,_=d&-15728641|(wt()|0),g[b>>2]=A|I,g[b+4>>2]=_,b=0,b|0):(b=4,b|0)}function eg(A,d,_,b){A=A|0,d=d|0,_=_|0,b=b|0;var I=0,P=0,B=0,O=0,W=0,Q=0,nt=0,mt=0,Vt=0,Yt=0,zt=0,re=0,ge=0,Ae=0,ue=0,fe=0,ie=0,tr=0,fr=0,Xe=0,er=0;if((_|0)==0&(b|0)==0)return Xe=0,Xe|0;if(I=A,P=g[I>>2]|0,I=g[I+4>>2]|0,!0&(I&15728640|0)==0){if(!((b|0)>0|(b|0)==0&_>>>0>0)||(Xe=d,g[Xe>>2]=P,g[Xe+4>>2]=I,(_|0)==1&(b|0)==0))return Xe=0,Xe|0;I=1;do tr=A+(I<<3)|0,fr=g[tr+4>>2]|0,Xe=d+(I<<3)|0,g[Xe>>2]=g[tr>>2],g[Xe+4>>2]=fr,I=I+1|0;while(0<(b|0)|(b|0)==0&I>>>0<_>>>0);return I=0,I|0}if(ie=_<<3,fr=sc(ie)|0,!fr)return Xe=13,Xe|0;if(J_(fr|0,A|0,ie|0)|0,tr=$c(_,8)|0,!tr)return ni(fr),Xe=13,Xe|0;t:do if(_|0){e:for(;;){I=fr,Ae=g[I>>2]|0,I=g[I+4>>2]|0,ue=De(Ae|0,I|0,52)|0,wt()|0,ue=ue&15,fe=ue+-1|0,ge=(_|0)>0;r:do if((ue|0)!=0&ge){if(Yt=((_|0)<0)<<31>>31,zt=Ge(fe|0,0,52)|0,re=wt()|0,fe>>>0>15){if(!((Ae|0)==0&(I|0)==0)){Xe=17;break e}for(P=0;;){if(P=P+1|0,(P|0)>=(_|0))break r;if(b=fr+(P<<3)|0,re=g[b>>2]|0,b=g[b+4>>2]|0,!((re|0)==0&(b|0)==0)){I=b,Xe=17;break e}}}for(P=0,A=Ae,b=I;;){if(!((A|0)==0&(b|0)==0)){if(!(!0&(b&117440512|0)==0)){Xe=22;break e}if(O=De(A|0,b|0,52)|0,wt()|0,O=O&15,(O|0)<(fe|0)){I=12,Xe=28;break e}if((O|0)!=(fe|0)&&(A=A|zt,b=b&-15728641|re,O>>>0>=ue>>>0)){B=fe;do Vt=Ge(7,0,(14-B|0)*3|0)|0,B=B+1|0,A=Vt|A,b=wt()|0|b;while(B>>>0<O>>>0)}if(B=Xs(A|0,b|0,_|0,Yt|0)|0,wt()|0,Q=tr+(B<<3)|0,O=Q,W=g[O>>2]|0,O=g[O+4>>2]|0,(W|0)==0&(O|0)==0)B=Q;else for(Vt=0;;){if((Vt|0)>(_|0)){Xe=32;break e}if((W|0)==(A|0)&(O&-117440513|0)==(b|0)){nt=De(W|0,O|0,56)|0,wt()|0,nt=nt&7,mt=nt+1|0,er=De(W|0,O|0,45)|0,wt()|0;i:do if(!(vn(er&127)|0))O=7;else{if(W=De(W|0,O|0,52)|0,wt()|0,W=W&15,!W){O=6;break}for(O=1;;){if(er=Ge(7,0,(15-O|0)*3|0)|0,!((er&A|0)==0&((wt()|0)&b|0)==0)){O=7;break i}if(O>>>0<W>>>0)O=O+1|0;else{O=6;break}}}while(!1);if((nt+2|0)>>>0>O>>>0){Xe=42;break e}er=Ge(mt|0,0,56)|0,b=wt()|0|b&-117440513,mt=Q,g[mt>>2]=0,g[mt+4>>2]=0,A=er|A}else B=(B+1|0)%(_|0)|0;if(Q=tr+(B<<3)|0,O=Q,W=g[O>>2]|0,O=g[O+4>>2]|0,(W|0)==0&(O|0)==0){B=Q;break}else Vt=Vt+1|0}er=B,g[er>>2]=A,g[er+4>>2]=b}if(P=P+1|0,(P|0)>=(_|0))break r;b=fr+(P<<3)|0,A=g[b>>2]|0,b=g[b+4>>2]|0}}while(!1);if((_+5|0)>>>0<11){Xe=85;break}if(re=$c((_|0)/6|0,8)|0,!re){Xe=49;break}r:do if(ge){Vt=0,mt=0;do{if(O=tr+(Vt<<3)|0,b=O,P=g[b>>2]|0,b=g[b+4>>2]|0,!((P|0)==0&(b|0)==0)){W=De(P|0,b|0,56)|0,wt()|0,W=W&7,A=W+1|0,Q=b&-117440513,er=De(P|0,b|0,45)|0,wt()|0;i:do if(vn(er&127)|0){if(nt=De(P|0,b|0,52)|0,wt()|0,nt=nt&15,nt|0)for(B=1;;){if(er=Ge(7,0,(15-B|0)*3|0)|0,!((P&er|0)==0&(Q&(wt()|0)|0)==0))break i;if(B>>>0<nt>>>0)B=B+1|0;else break}b=Ge(A|0,0,56)|0,P=b|P,b=wt()|0|Q,A=O,g[A>>2]=P,g[A+4>>2]=b,A=W+2|0}while(!1);(A|0)==7&&(er=re+(mt<<3)|0,g[er>>2]=P,g[er+4>>2]=b&-117440513,mt=mt+1|0)}Vt=Vt+1|0}while((Vt|0)!=(_|0));if(ge){if(Vt=((_|0)<0)<<31>>31,Yt=Ge(fe|0,0,52)|0,zt=wt()|0,fe>>>0>15){if(!((Ae|0)==0&(I|0)==0)){I=4,Xe=84;break e}for(I=0;;){if(I=I+1|0,(I|0)>=(_|0)){P=0,I=mt;break r}if(er=fr+(I<<3)|0,!((g[er>>2]|0)==0&(g[er+4>>2]|0)==0)){I=4,Xe=84;break e}}}for(nt=0,P=0,Q=Ae;;){do if(!((Q|0)==0&(I|0)==0)){if(O=De(Q|0,I|0,52)|0,wt()|0,O=O&15,(O|0)<(fe|0)){I=12,Xe=84;break e}do if((O|0)==(fe|0))b=Q,O=I;else{if(b=Q|Yt,A=I&-15728641|zt,O>>>0<ue>>>0){O=A;break}B=fe;do er=Ge(7,0,(14-B|0)*3|0)|0,B=B+1|0,b=er|b,A=wt()|0|A;while(B>>>0<O>>>0);O=A}while(!1);for(B=Xs(b|0,O|0,_|0,Vt|0)|0,wt()|0,A=0;;){if((A|0)>(_|0)){Xe=77;break e}if(er=tr+(B<<3)|0,W=g[er+4>>2]|0,(W&-117440513|0)==(O|0)&&(g[er>>2]|0)==(b|0)){Xe=79;break}if(B=(B+1|0)%(_|0)|0,er=tr+(B<<3)|0,(g[er>>2]|0)==(b|0)&&(g[er+4>>2]|0)==(O|0))break;A=A+1|0}if((Xe|0)==79&&(Xe=0,!0&(W&117440512|0)==100663296))break;er=d+(P<<3)|0,g[er>>2]=Q,g[er+4>>2]=I,P=P+1|0}while(!1);if(I=nt+1|0,(I|0)>=(_|0)){I=mt;break r}er=fr+(I<<3)|0,nt=I,Q=g[er>>2]|0,I=g[er+4>>2]|0}}else P=0,I=mt}else P=0,I=0;while(!1);if(Df(tr|0,0,ie|0)|0,J_(fr|0,re|0,I<<3|0)|0,ni(re),I)d=d+(P<<3)|0,_=I;else break t}if((Xe|0)==17)!0&(I&117440512|0)==0?(I=4,Xe=28):Xe=22;else if((Xe|0)==32)Lr(23313,22674,362,22684);else{if((Xe|0)==42)return ni(fr),ni(tr),er=10,er|0;if((Xe|0)==49)return ni(fr),ni(tr),er=13,er|0;if((Xe|0)==77)Lr(23313,22674,462,22684);else{if((Xe|0)==84)return ni(re),ni(fr),ni(tr),er=I,er|0;if((Xe|0)==85){J_(d|0,fr|0,_<<3|0)|0;break}}}if((Xe|0)==22)return ni(fr),ni(tr),er=5,er|0;if((Xe|0)==28)return ni(fr),ni(tr),er=I,er|0}while(!1);return ni(fr),ni(tr),er=0,er|0}function Mf(A,d,_,b,I,P,B){A=A|0,d=d|0,_=_|0,b=b|0,I=I|0,P=P|0,B=B|0;var O=0,W=0,Q=0,nt=0,mt=0,Vt=0,Yt=0,zt=0,re=0;if(re=pt,pt=pt+16|0,zt=re,!((_|0)>0|(_|0)==0&d>>>0>0))return zt=0,pt=re,zt|0;if((B|0)>=16)return zt=12,pt=re,zt|0;Vt=0,Yt=0,mt=0,O=0;t:for(;;){if(Q=A+(Vt<<3)|0,W=g[Q>>2]|0,Q=g[Q+4>>2]|0,nt=De(W|0,Q|0,52)|0,wt()|0,(nt&15|0)>(B|0)){O=12,W=11;break}if(Zt(zt,W,Q,B),nt=zt,Q=g[nt>>2]|0,nt=g[nt+4>>2]|0,(Q|0)==0&(nt|0)==0)W=mt;else{W=mt;do{if(!((O|0)<(P|0)|(O|0)==(P|0)&W>>>0<I>>>0)){W=10;break t}mt=b+(W<<3)|0,g[mt>>2]=Q,g[mt+4>>2]=nt,W=Ei(W|0,O|0,1,0)|0,O=wt()|0,ne(zt),mt=zt,Q=g[mt>>2]|0,nt=g[mt+4>>2]|0}while(!((Q|0)==0&(nt|0)==0))}if(Vt=Ei(Vt|0,Yt|0,1,0)|0,Yt=wt()|0,(Yt|0)<(_|0)|(Yt|0)==(_|0)&Vt>>>0<d>>>0)mt=W;else{O=0,W=11;break}}return(W|0)==10?(zt=14,pt=re,zt|0):(W|0)==11?(pt=re,O|0):0}function rg(A,d,_,b,I){A=A|0,d=d|0,_=_|0,b=b|0,I=I|0;var P=0,B=0,O=0,W=0,Q=0,nt=0,mt=0,Vt=0;Vt=pt,pt=pt+16|0,mt=Vt;t:do if((_|0)>0|(_|0)==0&d>>>0>0){for(Q=0,B=0,P=0,nt=0;;){if(W=A+(Q<<3)|0,O=g[W>>2]|0,W=g[W+4>>2]|0,!((O|0)==0&(W|0)==0)&&(W=(Vc(O,W,b,mt)|0)==0,O=mt,B=Ei(g[O>>2]|0,g[O+4>>2]|0,B|0,P|0)|0,P=wt()|0,!W)){P=12;break}if(Q=Ei(Q|0,nt|0,1,0)|0,nt=wt()|0,!((nt|0)<(_|0)|(nt|0)==(_|0)&Q>>>0<d>>>0))break t}return pt=Vt,P|0}else B=0,P=0;while(!1);return g[I>>2]=B,g[I+4>>2]=P,I=0,pt=Vt,I|0}function ig(A,d){return A=A|0,d=d|0,d=De(A|0,d|0,52)|0,wt()|0,d&1|0}function ii(A,d){A=A|0,d=d|0;var _=0,b=0,I=0;if(I=De(A|0,d|0,52)|0,wt()|0,I=I&15,!I)return I=0,I|0;for(b=1;;){if(_=De(A|0,d|0,(15-b|0)*3|0)|0,wt()|0,_=_&7,_|0){b=5;break}if(b>>>0<I>>>0)b=b+1|0;else{_=0,b=5;break}}return(b|0)==5?_|0:0}function M(A,d){A=A|0,d=d|0;var _=0,b=0,I=0,P=0,B=0,O=0,W=0;if(W=De(A|0,d|0,52)|0,wt()|0,W=W&15,!W)return O=d,W=A,Si(O|0),W|0;for(O=1,_=0;;){P=(15-O|0)*3|0,b=Ge(7,0,P|0)|0,I=wt()|0,B=De(A|0,d|0,P|0)|0,wt()|0,P=Ge(Uc(B&7)|0,0,P|0)|0,B=wt()|0,A=P|A&~b,d=B|d&~I;t:do if(!_)if((P&b|0)==0&(B&I|0)==0)_=0;else if(b=De(A|0,d|0,52)|0,wt()|0,b=b&15,!b)_=1;else{_=1;e:for(;;){switch(B=De(A|0,d|0,(15-_|0)*3|0)|0,wt()|0,B&7){case 1:break e;case 0:break;default:{_=1;break t}}if(_>>>0<b>>>0)_=_+1|0;else{_=1;break t}}for(_=1;;)if(B=(15-_|0)*3|0,I=De(A|0,d|0,B|0)|0,wt()|0,P=Ge(7,0,B|0)|0,d=d&~(wt()|0),B=Ge(Uc(I&7)|0,0,B|0)|0,A=A&~P|B,d=d|(wt()|0),_>>>0<b>>>0)_=_+1|0;else{_=1;break}}while(!1);if(O>>>0<W>>>0)O=O+1|0;else break}return Si(d|0),A|0}function l(A,d){A=A|0,d=d|0;var _=0,b=0,I=0,P=0,B=0;if(b=De(A|0,d|0,52)|0,wt()|0,b=b&15,!b)return _=d,b=A,Si(_|0),b|0;for(_=1;P=(15-_|0)*3|0,B=De(A|0,d|0,P|0)|0,wt()|0,I=Ge(7,0,P|0)|0,d=d&~(wt()|0),P=Ge(Uc(B&7)|0,0,P|0)|0,A=P|A&~I,d=wt()|0|d,_>>>0<b>>>0;)_=_+1|0;return Si(d|0),A|0}function m(A,d){A=A|0,d=d|0;var _=0,b=0,I=0,P=0,B=0,O=0,W=0;if(W=De(A|0,d|0,52)|0,wt()|0,W=W&15,!W)return O=d,W=A,Si(O|0),W|0;for(O=1,_=0;;){P=(15-O|0)*3|0,b=Ge(7,0,P|0)|0,I=wt()|0,B=De(A|0,d|0,P|0)|0,wt()|0,P=Ge(rc(B&7)|0,0,P|0)|0,B=wt()|0,A=P|A&~b,d=B|d&~I;t:do if(!_)if((P&b|0)==0&(B&I|0)==0)_=0;else if(b=De(A|0,d|0,52)|0,wt()|0,b=b&15,!b)_=1;else{_=1;e:for(;;){switch(B=De(A|0,d|0,(15-_|0)*3|0)|0,wt()|0,B&7){case 1:break e;case 0:break;default:{_=1;break t}}if(_>>>0<b>>>0)_=_+1|0;else{_=1;break t}}for(_=1;;)if(I=(15-_|0)*3|0,P=Ge(7,0,I|0)|0,B=d&~(wt()|0),d=De(A|0,d|0,I|0)|0,wt()|0,d=Ge(rc(d&7)|0,0,I|0)|0,A=A&~P|d,d=B|(wt()|0),_>>>0<b>>>0)_=_+1|0;else{_=1;break}}while(!1);if(O>>>0<W>>>0)O=O+1|0;else break}return Si(d|0),A|0}function v(A,d){A=A|0,d=d|0;var _=0,b=0,I=0,P=0,B=0;if(b=De(A|0,d|0,52)|0,wt()|0,b=b&15,!b)return _=d,b=A,Si(_|0),b|0;for(_=1;B=(15-_|0)*3|0,P=Ge(7,0,B|0)|0,I=d&~(wt()|0),d=De(A|0,d|0,B|0)|0,wt()|0,d=Ge(rc(d&7)|0,0,B|0)|0,A=d|A&~P,d=wt()|0|I,_>>>0<b>>>0;)_=_+1|0;return Si(d|0),A|0}function S(A,d){A=A|0,d=d|0;var _=0,b=0,I=0,P=0,B=0,O=0,W=0,Q=0,nt=0;if(W=pt,pt=pt+64|0,O=W+40|0,b=W+24|0,I=W+12|0,P=W,Ge(d|0,0,52)|0,_=wt()|0|134225919,!d)return(g[A+4>>2]|0)>2||(g[A+8>>2]|0)>2||(g[A+12>>2]|0)>2?(B=0,O=0,Si(B|0),pt=W,O|0):(Ge(Wm(A)|0,0,45)|0,B=wt()|0|_,O=-1,Si(B|0),pt=W,O|0);if(g[O>>2]=g[A>>2],g[O+4>>2]=g[A+4>>2],g[O+8>>2]=g[A+8>>2],g[O+12>>2]=g[A+12>>2],B=O+4|0,(d|0)>0)for(A=-1;g[b>>2]=g[B>>2],g[b+4>>2]=g[B+4>>2],g[b+8>>2]=g[B+8>>2],d&1?(ub(B),g[I>>2]=g[B>>2],g[I+4>>2]=g[B+4>>2],g[I+8>>2]=g[B+8>>2],sd(I)):(q0(B),g[I>>2]=g[B>>2],g[I+4>>2]=g[B+4>>2],g[I+8>>2]=g[B+8>>2],_u(I)),gu(b,I,P),Ve(P),nt=(15-d|0)*3|0,Q=Ge(7,0,nt|0)|0,_=_&~(wt()|0),nt=Ge(qe(P)|0,0,nt|0)|0,A=nt|A&~Q,_=wt()|0|_,(d|0)>1;)d=d+-1|0;else A=-1;t:do if((g[B>>2]|0)<=2&&(g[O+8>>2]|0)<=2&&(g[O+12>>2]|0)<=2){if(b=Wm(O)|0,d=Ge(b|0,0,45)|0,d=d|A,A=wt()|0|_&-1040385,P=V_(O)|0,!(vn(b)|0)){if((P|0)<=0)break;for(I=0;;){if(b=De(d|0,A|0,52)|0,wt()|0,b=b&15,b)for(_=1;nt=(15-_|0)*3|0,O=De(d|0,A|0,nt|0)|0,wt()|0,Q=Ge(7,0,nt|0)|0,A=A&~(wt()|0),nt=Ge(Uc(O&7)|0,0,nt|0)|0,d=d&~Q|nt,A=A|(wt()|0),_>>>0<b>>>0;)_=_+1|0;if(I=I+1|0,(I|0)==(P|0))break t}}I=De(d|0,A|0,52)|0,wt()|0,I=I&15;e:do if(I){_=1;r:for(;;){switch(nt=De(d|0,A|0,(15-_|0)*3|0)|0,wt()|0,nt&7){case 1:break r;case 0:break;default:break e}if(_>>>0<I>>>0)_=_+1|0;else break e}if(Ta(b,g[O>>2]|0)|0)for(_=1;O=(15-_|0)*3|0,Q=Ge(7,0,O|0)|0,nt=A&~(wt()|0),A=De(d|0,A|0,O|0)|0,wt()|0,A=Ge(rc(A&7)|0,0,O|0)|0,d=d&~Q|A,A=nt|(wt()|0),_>>>0<I>>>0;)_=_+1|0;else for(_=1;nt=(15-_|0)*3|0,O=De(d|0,A|0,nt|0)|0,wt()|0,Q=Ge(7,0,nt|0)|0,A=A&~(wt()|0),nt=Ge(Uc(O&7)|0,0,nt|0)|0,d=d&~Q|nt,A=A|(wt()|0),_>>>0<I>>>0;)_=_+1|0}while(!1);if((P|0)>0){_=0;do d=M(d,A)|0,A=wt()|0,_=_+1|0;while((_|0)!=(P|0))}}else d=0,A=0;while(!1);return Q=A,nt=d,Si(Q|0),pt=W,nt|0}function C(A){return A=A|0,(A|0)%2|0|0}function L(A,d,_){A=A|0,d=d|0,_=_|0;var b=0,I=0;return I=pt,pt=pt+16|0,b=I,d>>>0>15?(b=4,pt=I,b|0):(g[A+4>>2]&2146435072|0)==2146435072||(g[A+8+4>>2]&2146435072|0)==2146435072?(b=3,pt=I,b|0):(hb(A,d,b),d=S(b,d)|0,b=wt()|0,g[_>>2]=d,g[_+4>>2]=b,(d|0)==0&(b|0)==0&&Lr(23313,22674,786,22697),b=0,pt=I,b|0)}function V(A,d,_){A=A|0,d=d|0,_=_|0;var b=0,I=0,P=0,B=0;if(I=_+4|0,P=De(A|0,d|0,52)|0,wt()|0,P=P&15,B=De(A|0,d|0,45)|0,wt()|0,b=(P|0)==0,vn(B&127)|0){if(b)return B=1,B|0;b=1}else{if(b)return B=0,B|0;!(g[I>>2]|0)&&!(g[_+8>>2]|0)?b=(g[_+12>>2]|0)!=0&1:b=1}for(_=1;_&1?sd(I):_u(I),B=De(A|0,d|0,(15-_|0)*3|0)|0,wt()|0,Gm(I,B&7),_>>>0<P>>>0;)_=_+1|0;return b|0}function $(A,d,_){A=A|0,d=d|0,_=_|0;var b=0,I=0,P=0,B=0,O=0,W=0,Q=0,nt=0;if(nt=pt,pt=pt+16|0,W=nt,Q=De(A|0,d|0,45)|0,wt()|0,Q=Q&127,Q>>>0>121)return g[_>>2]=0,g[_+4>>2]=0,g[_+8>>2]=0,g[_+12>>2]=0,Q=5,pt=nt,Q|0;t:do if(vn(Q)|0&&(P=De(A|0,d|0,52)|0,wt()|0,P=P&15,(P|0)!=0)){b=1;e:for(;;){switch(O=De(A|0,d|0,(15-b|0)*3|0)|0,wt()|0,O&7){case 5:break e;case 0:break;default:{b=d;break t}}if(b>>>0<P>>>0)b=b+1|0;else{b=d;break t}}for(I=1,b=d;d=(15-I|0)*3|0,B=Ge(7,0,d|0)|0,O=b&~(wt()|0),b=De(A|0,b|0,d|0)|0,wt()|0,b=Ge(rc(b&7)|0,0,d|0)|0,A=A&~B|b,b=O|(wt()|0),I>>>0<P>>>0;)I=I+1|0}else b=d;while(!1);if(O=7696+(Q*28|0)|0,g[_>>2]=g[O>>2],g[_+4>>2]=g[O+4>>2],g[_+8>>2]=g[O+8>>2],g[_+12>>2]=g[O+12>>2],!(V(A,b,_)|0))return Q=0,pt=nt,Q|0;if(B=_+4|0,g[W>>2]=g[B>>2],g[W+4>>2]=g[B+4>>2],g[W+8>>2]=g[B+8>>2],P=De(A|0,b|0,52)|0,wt()|0,O=P&15,P&1?(_u(B),P=O+1|0):P=O,!(vn(Q)|0))b=0;else{t:do if(!O)b=0;else for(d=1;;){if(I=De(A|0,b|0,(15-d|0)*3|0)|0,wt()|0,I=I&7,I|0){b=I;break t}if(d>>>0<O>>>0)d=d+1|0;else{b=0;break}}while(!1);b=(b|0)==4&1}if(!(yu(_,P,b,0)|0))(P|0)!=(O|0)&&(g[B>>2]=g[W>>2],g[B+4>>2]=g[W+4>>2],g[B+8>>2]=g[W+8>>2]);else{if(vn(Q)|0)do;while(yu(_,P,0,0)|0);(P|0)!=(O|0)&&q0(B)}return Q=0,pt=nt,Q|0}function X(A,d,_){A=A|0,d=d|0,_=_|0;var b=0,I=0,P=0;return P=pt,pt=pt+16|0,b=P,I=$(A,d,b)|0,I|0?(pt=P,I|0):(I=De(A|0,d|0,52)|0,wt()|0,Rr(b,I&15,_),I=0,pt=P,I|0)}function J(A,d,_){A=A|0,d=d|0,_=_|0;var b=0,I=0,P=0,B=0,O=0;if(B=pt,pt=pt+16|0,P=B,b=$(A,d,P)|0,b|0)return P=b,pt=B,P|0;b=De(A|0,d|0,45)|0,wt()|0,b=(vn(b&127)|0)==0,I=De(A|0,d|0,52)|0,wt()|0,I=I&15;t:do if(!b){if(I|0)for(b=1;;){if(O=Ge(7,0,(15-b|0)*3|0)|0,!((O&A|0)==0&((wt()|0)&d|0)==0))break t;if(b>>>0<I>>>0)b=b+1|0;else break}return wh(P,I,0,5,_),O=0,pt=B,O|0}while(!1);return ld(P,I,0,6,_),O=0,pt=B,O|0}function tt(A,d,_){A=A|0,d=d|0,_=_|0;var b=0,I=0,P=0;if(I=De(A|0,d|0,45)|0,wt()|0,!(vn(I&127)|0))return I=2,g[_>>2]=I,0;if(I=De(A|0,d|0,52)|0,wt()|0,I=I&15,!I)return I=5,g[_>>2]=I,0;for(b=1;;){if(P=Ge(7,0,(15-b|0)*3|0)|0,!((P&A|0)==0&((wt()|0)&d|0)==0)){b=2,A=6;break}if(b>>>0<I>>>0)b=b+1|0;else{b=5,A=6;break}}return(A|0)==6&&(g[_>>2]=b),0}function lt(A,d,_){A=A|0,d=d|0,_=_|0;var b=0,I=0,P=0,B=0,O=0,W=0,Q=0,nt=0,mt=0;mt=pt,pt=pt+128|0,Q=mt+112|0,P=mt+96|0,nt=mt,I=De(A|0,d|0,52)|0,wt()|0,O=I&15,g[Q>>2]=O,B=De(A|0,d|0,45)|0,wt()|0,B=B&127;t:do if(vn(B)|0){if(O|0)for(b=1;;){if(W=Ge(7,0,(15-b|0)*3|0)|0,!((W&A|0)==0&((wt()|0)&d|0)==0)){I=0;break t}if(b>>>0<O>>>0)b=b+1|0;else break}if(I&1)I=1;else return W=Ge(O+1|0,0,52)|0,nt=wt()|0|d&-15728641,Q=Ge(7,0,(14-O|0)*3|0)|0,nt=lt((W|A)&~Q,nt&~(wt()|0),_)|0,pt=mt,nt|0}else I=0;while(!1);if(b=$(A,d,P)|0,!b){I?(G0(P,Q,nt),W=5):(Ea(P,Q,nt),W=6);t:do if(vn(B)|0)if(!O)A=5;else for(b=1;;){if(B=Ge(7,0,(15-b|0)*3|0)|0,!((B&A|0)==0&((wt()|0)&d|0)==0)){A=2;break t}if(b>>>0<O>>>0)b=b+1|0;else{A=5;break}}else A=2;while(!1);Df(_|0,-1,A<<2|0)|0;t:do if(I)for(P=0;;){if(B=nt+(P<<4)|0,Ps(B,g[Q>>2]|0)|0,B=g[B>>2]|0,O=g[_>>2]|0,(O|0)==-1|(O|0)==(B|0))b=_;else{I=0;do{if(I=I+1|0,I>>>0>=A>>>0){b=1;break t}b=_+(I<<2)|0,O=g[b>>2]|0}while(!((O|0)==-1|(O|0)==(B|0)))}if(g[b>>2]=B,P=P+1|0,P>>>0>=W>>>0){b=0;break}}else for(P=0;;){if(B=nt+(P<<4)|0,yu(B,g[Q>>2]|0,0,1)|0,B=g[B>>2]|0,O=g[_>>2]|0,(O|0)==-1|(O|0)==(B|0))b=_;else{I=0;do{if(I=I+1|0,I>>>0>=A>>>0){b=1;break t}b=_+(I<<2)|0,O=g[b>>2]|0}while(!((O|0)==-1|(O|0)==(B|0)))}if(g[b>>2]=B,P=P+1|0,P>>>0>=W>>>0){b=0;break}}while(!1)}return nt=b,pt=mt,nt|0}function bt(){return 12}function yt(A,d){A=A|0,d=d|0;var _=0,b=0,I=0,P=0,B=0,O=0,W=0;if(A>>>0>15)return O=4,O|0;if(Ge(A|0,0,52)|0,O=wt()|0|134225919,!A){_=0,b=0;do vn(b)|0&&(Ge(b|0,0,45)|0,B=O|(wt()|0),A=d+(_<<3)|0,g[A>>2]=-1,g[A+4>>2]=B,_=_+1|0),b=b+1|0;while((b|0)!=122);return _=0,_|0}_=0,B=0;do{if(vn(B)|0){for(Ge(B|0,0,45)|0,b=1,I=-1,P=O|(wt()|0);W=Ge(7,0,(15-b|0)*3|0)|0,I=I&~W,P=P&~(wt()|0),(b|0)!=(A|0);)b=b+1|0;W=d+(_<<3)|0,g[W>>2]=I,g[W+4>>2]=P,_=_+1|0}B=B+1|0}while((B|0)!=122);return _=0,_|0}function Ct(A,d,_,b){A=A|0,d=d|0,_=_|0,b=b|0;var I=0,P=0,B=0,O=0,W=0,Q=0,nt=0,mt=0,Vt=0,Yt=0,zt=0,re=0,ge=0,Ae=0,ue=0;if(ue=pt,pt=pt+16|0,ge=ue,Ae=De(A|0,d|0,52)|0,wt()|0,Ae=Ae&15,_>>>0>15)return Ae=4,pt=ue,Ae|0;if((Ae|0)<(_|0))return Ae=12,pt=ue,Ae|0;if((Ae|0)!=(_|0))if(P=Ge(_|0,0,52)|0,P=P|A,O=wt()|0|d&-15728641,(Ae|0)>(_|0)){W=_;do re=Ge(7,0,(14-W|0)*3|0)|0,W=W+1|0,P=re|P,O=wt()|0|O;while((W|0)<(Ae|0));re=P}else re=P;else re=A,O=d;zt=De(re|0,O|0,45)|0,wt()|0;t:do if(vn(zt&127)|0){if(W=De(re|0,O|0,52)|0,wt()|0,W=W&15,W|0)for(P=1;;){if(zt=Ge(7,0,(15-P|0)*3|0)|0,!((zt&re|0)==0&((wt()|0)&O|0)==0)){Q=33;break t}if(P>>>0<W>>>0)P=P+1|0;else break}if(zt=b,g[zt>>2]=0,g[zt+4>>2]=0,(Ae|0)>(_|0)){for(zt=d&-15728641,Yt=Ae;;){if(Vt=Yt,Yt=Yt+-1|0,Yt>>>0>15|(Ae|0)<(Yt|0)){Q=19;break}if((Ae|0)!=(Yt|0))if(P=Ge(Yt|0,0,52)|0,P=P|A,W=wt()|0|zt,(Ae|0)<(Vt|0))mt=P;else{Q=Yt;do mt=Ge(7,0,(14-Q|0)*3|0)|0,Q=Q+1|0,P=mt|P,W=wt()|0|W;while((Q|0)<(Ae|0));mt=P}else mt=A,W=d;if(nt=De(mt|0,W|0,45)|0,wt()|0,!(vn(nt&127)|0))P=0;else{nt=De(mt|0,W|0,52)|0,wt()|0,nt=nt&15;e:do if(!nt)P=0;else for(Q=1;;){if(P=De(mt|0,W|0,(15-Q|0)*3|0)|0,wt()|0,P=P&7,P|0)break e;if(Q>>>0<nt>>>0)Q=Q+1|0;else{P=0;break}}while(!1);P=(P|0)==0&1}if(W=De(A|0,d|0,(15-Vt|0)*3|0)|0,wt()|0,W=W&7,(W|0)==7){I=5,Q=42;break}if(P=(P|0)!=0,(W|0)==1&P){I=5,Q=42;break}if(mt=W+(((W|0)!=0&P)<<31>>31)|0,mt|0&&(Q=Ae-Vt|0,Q=ws(7,0,Q,((Q|0)<0)<<31>>31)|0,nt=wt()|0,P?(P=Ho(Q|0,nt|0,5,0)|0,P=Ei(P|0,wt()|0,-5,-1)|0,P=wu(P|0,wt()|0,6,0)|0,P=Ei(P|0,wt()|0,1,0)|0,W=wt()|0):(P=Q,W=nt),Vt=mt+-1|0,Vt=Ho(Q|0,nt|0,Vt|0,((Vt|0)<0)<<31>>31|0)|0,Vt=Ei(P|0,W|0,Vt|0,wt()|0)|0,mt=wt()|0,nt=b,nt=Ei(Vt|0,mt|0,g[nt>>2]|0,g[nt+4>>2]|0)|0,mt=wt()|0,Vt=b,g[Vt>>2]=nt,g[Vt+4>>2]=mt),(Yt|0)<=(_|0)){Q=37;break}}if((Q|0)==19)Lr(23313,22674,1099,22710);else if((Q|0)==37){B=b,I=g[B+4>>2]|0,B=g[B>>2]|0;break}else if((Q|0)==42)return pt=ue,I|0}else I=0,B=0}else Q=33;while(!1);t:do if((Q|0)==33)if(zt=b,g[zt>>2]=0,g[zt+4>>2]=0,(Ae|0)>(_|0)){for(P=Ae;;){if(I=De(A|0,d|0,(15-P|0)*3|0)|0,wt()|0,I=I&7,(I|0)==7){I=5;break}if(B=Ae-P|0,B=ws(7,0,B,((B|0)<0)<<31>>31)|0,I=Ho(B|0,wt()|0,I|0,0)|0,B=wt()|0,zt=b,B=Ei(g[zt>>2]|0,g[zt+4>>2]|0,I|0,B|0)|0,I=wt()|0,zt=b,g[zt>>2]=B,g[zt+4>>2]=I,P=P+-1|0,(P|0)<=(_|0))break t}return pt=ue,I|0}else I=0,B=0;while(!1);return Vc(re,O,Ae,ge)|0&&Lr(23313,22674,1063,22725),Ae=ge,ge=g[Ae+4>>2]|0,((I|0)>-1|(I|0)==-1&B>>>0>4294967295)&((ge|0)>(I|0)|((ge|0)==(I|0)?(g[Ae>>2]|0)>>>0>B>>>0:0))?(Ae=0,pt=ue,Ae|0):(Lr(23313,22674,1139,22710),0)}function _t(A,d,_,b,I,P){A=A|0,d=d|0,_=_|0,b=b|0,I=I|0,P=P|0;var B=0,O=0,W=0,Q=0,nt=0,mt=0,Vt=0,Yt=0,zt=0,re=0;if(mt=pt,pt=pt+16|0,B=mt,I>>>0>15)return P=4,pt=mt,P|0;if(O=De(_|0,b|0,52)|0,wt()|0,O=O&15,(O|0)>(I|0))return P=12,pt=mt,P|0;if(Vc(_,b,I,B)|0&&Lr(23313,22674,1063,22725),nt=B,Q=g[nt+4>>2]|0,!(((d|0)>-1|(d|0)==-1&A>>>0>4294967295)&((Q|0)>(d|0)|((Q|0)==(d|0)?(g[nt>>2]|0)>>>0>A>>>0:0))))return P=2,pt=mt,P|0;nt=I-O|0,I=Ge(I|0,0,52)|0,W=wt()|0|b&-15728641,Q=P,g[Q>>2]=I|_,g[Q+4>>2]=W,Q=De(_|0,b|0,45)|0,wt()|0;t:do if(vn(Q&127)|0){if(O|0)for(B=1;;){if(Q=Ge(7,0,(15-B|0)*3|0)|0,!((Q&_|0)==0&((wt()|0)&b|0)==0))break t;if(B>>>0<O>>>0)B=B+1|0;else break}if((nt|0)<1)return P=0,pt=mt,P|0;for(Q=O^15,b=-1,W=1,B=1;;){O=nt-W|0,O=ws(7,0,O,((O|0)<0)<<31>>31)|0,_=wt()|0;do if(B)if(B=Ho(O|0,_|0,5,0)|0,B=Ei(B|0,wt()|0,-5,-1)|0,B=wu(B|0,wt()|0,6,0)|0,I=wt()|0,(d|0)>(I|0)|(d|0)==(I|0)&A>>>0>B>>>0){d=Ei(A|0,d|0,-1,-1)|0,d=aa(d|0,wt()|0,B|0,I|0)|0,B=wt()|0,Vt=P,zt=g[Vt>>2]|0,Vt=g[Vt+4>>2]|0,re=(Q+b|0)*3|0,Yt=Ge(7,0,re|0)|0,Vt=Vt&~(wt()|0),b=wu(d|0,B|0,O|0,_|0)|0,A=wt()|0,I=Ei(b|0,A|0,2,0)|0,re=Ge(I|0,wt()|0,re|0)|0,Vt=wt()|0|Vt,I=P,g[I>>2]=re|zt&~Yt,g[I+4>>2]=Vt,A=Ho(b|0,A|0,O|0,_|0)|0,A=aa(d|0,B|0,A|0,wt()|0)|0,B=0,d=wt()|0;break}else{re=P,Yt=g[re>>2]|0,re=g[re+4>>2]|0,zt=Ge(7,0,(Q+b|0)*3|0)|0,re=re&~(wt()|0),B=P,g[B>>2]=Yt&~zt,g[B+4>>2]=re,B=1;break}else Yt=P,I=g[Yt>>2]|0,Yt=g[Yt+4>>2]|0,b=(Q+b|0)*3|0,Vt=Ge(7,0,b|0)|0,Yt=Yt&~(wt()|0),re=wu(A|0,d|0,O|0,_|0)|0,B=wt()|0,b=Ge(re|0,B|0,b|0)|0,Yt=wt()|0|Yt,zt=P,g[zt>>2]=b|I&~Vt,g[zt+4>>2]=Yt,B=Ho(re|0,B|0,O|0,_|0)|0,A=aa(A|0,d|0,B|0,wt()|0)|0,B=0,d=wt()|0;while(!1);if((nt|0)>(W|0))b=~W,W=W+1|0;else{d=0;break}}return pt=mt,d|0}while(!1);if((nt|0)<1)return re=0,pt=mt,re|0;for(I=O^15,B=1;;)if(zt=nt-B|0,zt=ws(7,0,zt,((zt|0)<0)<<31>>31)|0,re=wt()|0,W=P,_=g[W>>2]|0,W=g[W+4>>2]|0,O=(I-B|0)*3|0,b=Ge(7,0,O|0)|0,W=W&~(wt()|0),Vt=wu(A|0,d|0,zt|0,re|0)|0,Yt=wt()|0,O=Ge(Vt|0,Yt|0,O|0)|0,W=wt()|0|W,Q=P,g[Q>>2]=O|_&~b,g[Q+4>>2]=W,re=Ho(Vt|0,Yt|0,zt|0,re|0)|0,A=aa(A|0,d|0,re|0,wt()|0)|0,d=wt()|0,(nt|0)<=(B|0)){d=0;break}else B=B+1|0;return pt=mt,d|0}function Zt(A,d,_,b){A=A|0,d=d|0,_=_|0,b=b|0;var I=0,P=0;I=De(d|0,_|0,52)|0,wt()|0,I=I&15,(d|0)==0&(_|0)==0|((b|0)>15|(I|0)>(b|0))?(b=-1,I=-1,d=0,_=0):(P=Th(d,_,I+1|0,b)|0,_=(wt()|0)&-15728641,d=Ge(b|0,0,52)|0,d=P|d,_=_|(wt()|0),P=(wn(d,_)|0)==0,b=P?-1:b),P=A,g[P>>2]=d,g[P+4>>2]=_,g[A+8>>2]=I,g[A+12>>2]=b}function ne(A){A=A|0;var d=0,_=0,b=0,I=0,P=0,B=0,O=0,W=0,Q=0;if(_=A,d=g[_>>2]|0,_=g[_+4>>2]|0,!((d|0)==0&(_|0)==0)&&(b=De(d|0,_|0,52)|0,wt()|0,b=b&15,O=Ge(1,0,(b^15)*3|0)|0,d=Ei(O|0,wt()|0,d|0,_|0)|0,_=wt()|0,O=A,g[O>>2]=d,g[O+4>>2]=_,O=A+8|0,B=g[O>>2]|0,!((b|0)<(B|0)))){for(W=A+12|0,P=b;;){if((P|0)==(B|0)){b=5;break}if(Q=(P|0)==(g[W>>2]|0),I=(15-P|0)*3|0,b=De(d|0,_|0,I|0)|0,wt()|0,b=b&7,Q&((b|0)==1&!0)){b=7;break}if(!((b|0)==7&!0)){b=10;break}if(Q=Ge(1,0,I|0)|0,d=Ei(d|0,_|0,Q|0,wt()|0)|0,_=wt()|0,Q=A,g[Q>>2]=d,g[Q+4>>2]=_,(P|0)>(B|0))P=P+-1|0;else{b=10;break}}if((b|0)==5){Q=A,g[Q>>2]=0,g[Q+4>>2]=0,g[O>>2]=-1,g[W>>2]=-1;return}else if((b|0)==7){B=Ge(1,0,I|0)|0,B=Ei(d|0,_|0,B|0,wt()|0)|0,O=wt()|0,Q=A,g[Q>>2]=B,g[Q+4>>2]=O,g[W>>2]=P+-1;return}else if((b|0)==10)return}}function Ot(A){A=+A;var d=0;return d=A<0?A+6.283185307179586:A,+(A>=6.283185307179586?d+-6.283185307179586:d)}function Gt(A,d){return A=A|0,d=d|0,+Nr(+(+ft[A>>3]-+ft[d>>3]))<17453292519943298e-27?(d=+Nr(+(+ft[A+8>>3]-+ft[d+8>>3]))<17453292519943298e-27,d|0):(d=0,d|0)}function he(A,d){A=A|0,d=d|0;var _=0,b=0,I=0,P=0;return I=+ft[d>>3],b=+ft[A>>3],P=+cn(+((I-b)*.5)),_=+cn(+((+ft[d+8>>3]-+ft[A+8>>3])*.5)),_=P*P+_*(+ln(+I)*+ln(+b)*_),+(+ra(+ +Qr(+_),+ +Qr(+(1-_)))*2)}function ce(A,d){A=A|0,d=d|0;var _=0,b=0,I=0,P=0;return I=+ft[d>>3],b=+ft[A>>3],P=+cn(+((I-b)*.5)),_=+cn(+((+ft[d+8>>3]-+ft[A+8>>3])*.5)),_=P*P+_*(+ln(+I)*+ln(+b)*_),+(+ra(+ +Qr(+_),+ +Qr(+(1-_)))*2*6371.007180918475)}function xe(A,d){A=A|0,d=d|0;var _=0,b=0,I=0,P=0;return I=+ft[d>>3],b=+ft[A>>3],P=+cn(+((I-b)*.5)),_=+cn(+((+ft[d+8>>3]-+ft[A+8>>3])*.5)),_=P*P+_*(+ln(+I)*+ln(+b)*_),+(+ra(+ +Qr(+_),+ +Qr(+(1-_)))*2*6371.007180918475*1e3)}function Pe(A,d){A=A|0,d=d|0;var _=0,b=0,I=0,P=0,B=0;return P=+ft[d>>3],b=+ln(+P),I=+ft[d+8>>3]-+ft[A+8>>3],B=b*+cn(+I),_=+ft[A>>3],+ +ra(+B,+(+cn(+P)*+ln(+_)-+ln(+I)*(b*+cn(+_))))}function Te(A,d,_,b){A=A|0,d=+d,_=+_,b=b|0;var I=0,P=0,B=0,O=0;if(_<1e-16){g[b>>2]=g[A>>2],g[b+4>>2]=g[A+4>>2],g[b+8>>2]=g[A+8>>2],g[b+12>>2]=g[A+12>>2];return}P=d<0?d+6.283185307179586:d,P=d>=6.283185307179586?P+-6.283185307179586:P;do if(P<1e-16)d=+ft[A>>3]+_,ft[b>>3]=d,I=b;else{if(I=+Nr(+(P+-3.141592653589793))<1e-16,d=+ft[A>>3],I){d=d-_,ft[b>>3]=d,I=b;break}if(B=+ln(+_),_=+cn(+_),d=B*+cn(+d)+ +ln(+P)*(_*+ln(+d)),d=d>1?1:d,d=+$m(+(d<-1?-1:d)),ft[b>>3]=d,+Nr(+(d+-1.5707963267948966))<1e-16){ft[b>>3]=1.5707963267948966,ft[b+8>>3]=0;return}if(+Nr(+(d+1.5707963267948966))<1e-16){ft[b>>3]=-1.5707963267948966,ft[b+8>>3]=0;return}if(O=+ln(+d),P=_*+cn(+P)/O,_=+ft[A>>3],d=(B-+cn(+d)*+cn(+_))/+ln(+_)/O,B=P>1?1:P,d=d>1?1:d,d=+ft[A+8>>3]+ +ra(+(B<-1?-1:B),+(d<-1?-1:d)),d>3.141592653589793)do d=d+-6.283185307179586;while(d>3.141592653589793);if(d<-3.141592653589793)do d=d+6.283185307179586;while(d<-3.141592653589793);ft[b+8>>3]=d;return}while(!1);if(+Nr(+(d+-1.5707963267948966))<1e-16){ft[I>>3]=1.5707963267948966,ft[b+8>>3]=0;return}if(+Nr(+(d+1.5707963267948966))<1e-16){ft[I>>3]=-1.5707963267948966,ft[b+8>>3]=0;return}if(d=+ft[A+8>>3],d>3.141592653589793)do d=d+-6.283185307179586;while(d>3.141592653589793);if(d<-3.141592653589793)do d=d+6.283185307179586;while(d<-3.141592653589793);ft[b+8>>3]=d}function Fe(A,d){return A=A|0,d=d|0,A>>>0>15?(d=4,d|0):(ft[d>>3]=+ft[20528+(A<<3)>>3],d=0,d|0)}function ur(A,d){return A=A|0,d=d|0,A>>>0>15?(d=4,d|0):(ft[d>>3]=+ft[20656+(A<<3)>>3],d=0,d|0)}function ki(A,d){return A=A|0,d=d|0,A>>>0>15?(d=4,d|0):(ft[d>>3]=+ft[20784+(A<<3)>>3],d=0,d|0)}function We(A,d){return A=A|0,d=d|0,A>>>0>15?(d=4,d|0):(ft[d>>3]=+ft[20912+(A<<3)>>3],d=0,d|0)}function Ir(A,d){A=A|0,d=d|0;var _=0;return A>>>0>15?(d=4,d|0):(_=ws(7,0,A,((A|0)<0)<<31>>31)|0,_=Ho(_|0,wt()|0,120,0)|0,A=wt()|0,g[d>>2]=_|2,g[d+4>>2]=A,d=0,d|0)}function hr(A,d,_){A=A|0,d=d|0,_=_|0;var b=0,I=0,P=0,B=0,O=0,W=0,Q=0,nt=0,mt=0,Vt=0;return Vt=+ft[d>>3],nt=+ft[A>>3],W=+cn(+((Vt-nt)*.5)),P=+ft[d+8>>3],Q=+ft[A+8>>3],B=+cn(+((P-Q)*.5)),O=+ln(+nt),mt=+ln(+Vt),B=W*W+B*(mt*O*B),B=+ra(+ +Qr(+B),+ +Qr(+(1-B)))*2,W=+ft[_>>3],Vt=+cn(+((W-Vt)*.5)),b=+ft[_+8>>3],P=+cn(+((b-P)*.5)),I=+ln(+W),P=Vt*Vt+P*(mt*I*P),P=+ra(+ +Qr(+P),+ +Qr(+(1-P)))*2,W=+cn(+((nt-W)*.5)),b=+cn(+((Q-b)*.5)),b=W*W+b*(O*I*b),b=+ra(+ +Qr(+b),+ +Qr(+(1-b)))*2,I=(B+P+b)*.5,+(+bf(+ +Qr(+(+Au(+(I*.5))*+Au(+((I-B)*.5))*+Au(+((I-P)*.5))*+Au(+((I-b)*.5)))))*4)}function pn(A,d,_){A=A|0,d=d|0,_=_|0;var b=0,I=0,P=0,B=0,O=0;if(O=pt,pt=pt+192|0,P=O+168|0,B=O,I=X(A,d,P)|0,I|0)return _=I,pt=O,_|0;if(J(A,d,B)|0&&Lr(23313,22742,386,22751),d=g[B>>2]|0,(d|0)>0){if(b=+hr(B+8|0,B+8+(((d|0)!=1&1)<<4)|0,P)+0,(d|0)!=1){A=1;do I=A,A=A+1|0,b=b+ +hr(B+8+(I<<4)|0,B+8+(((A|0)%(d|0)|0)<<4)|0,P);while((A|0)<(d|0))}}else b=0;return ft[_>>3]=b,_=0,pt=O,_|0}function Mi(A,d,_){return A=A|0,d=d|0,_=_|0,A=pn(A,d,_)|0,A|0||(ft[_>>3]=+ft[_>>3]*6371.007180918475*6371.007180918475),A|0}function ui(A,d,_){return A=A|0,d=d|0,_=_|0,A=pn(A,d,_)|0,A|0||(ft[_>>3]=+ft[_>>3]*6371.007180918475*6371.007180918475*1e3*1e3),A|0}function Di(A,d,_){A=A|0,d=d|0,_=_|0;var b=0,I=0,P=0,B=0,O=0,W=0,Q=0,nt=0;if(O=pt,pt=pt+176|0,B=O,A=ad(A,d,B)|0,A|0)return B=A,pt=O,B|0;if(ft[_>>3]=0,A=g[B>>2]|0,(A|0)<=1)return B=0,pt=O,B|0;d=A+-1|0,A=0,b=+ft[B+8>>3],I=+ft[B+16>>3],P=0;do A=A+1|0,Q=b,b=+ft[B+8+(A<<4)>>3],nt=+cn(+((b-Q)*.5)),W=I,I=+ft[B+8+(A<<4)+8>>3],W=+cn(+((I-W)*.5)),W=nt*nt+W*(+ln(+b)*+ln(+Q)*W),P=P+ +ra(+ +Qr(+W),+ +Qr(+(1-W)))*2;while((A|0)<(d|0));return ft[_>>3]=P,B=0,pt=O,B|0}function bs(A,d,_){A=A|0,d=d|0,_=_|0;var b=0,I=0,P=0,B=0,O=0,W=0,Q=0,nt=0;if(O=pt,pt=pt+176|0,B=O,A=ad(A,d,B)|0,A|0)return B=A,P=+ft[_>>3],P=P*6371.007180918475,ft[_>>3]=P,pt=O,B|0;if(ft[_>>3]=0,A=g[B>>2]|0,(A|0)<=1)return B=0,P=0,P=P*6371.007180918475,ft[_>>3]=P,pt=O,B|0;d=A+-1|0,A=0,b=+ft[B+8>>3],I=+ft[B+16>>3],P=0;do A=A+1|0,Q=b,b=+ft[B+8+(A<<4)>>3],nt=+cn(+((b-Q)*.5)),W=I,I=+ft[B+8+(A<<4)+8>>3],W=+cn(+((I-W)*.5)),W=nt*nt+W*(+ln(+Q)*+ln(+b)*W),P=P+ +ra(+ +Qr(+W),+ +Qr(+(1-W)))*2;while((A|0)!=(d|0));return ft[_>>3]=P,B=0,nt=P,nt=nt*6371.007180918475,ft[_>>3]=nt,pt=O,B|0}function Ln(A,d,_){A=A|0,d=d|0,_=_|0;var b=0,I=0,P=0,B=0,O=0,W=0,Q=0,nt=0;if(O=pt,pt=pt+176|0,B=O,A=ad(A,d,B)|0,A|0)return B=A,P=+ft[_>>3],P=P*6371.007180918475,P=P*1e3,ft[_>>3]=P,pt=O,B|0;if(ft[_>>3]=0,A=g[B>>2]|0,(A|0)<=1)return B=0,P=0,P=P*6371.007180918475,P=P*1e3,ft[_>>3]=P,pt=O,B|0;d=A+-1|0,A=0,b=+ft[B+8>>3],I=+ft[B+16>>3],P=0;do A=A+1|0,Q=b,b=+ft[B+8+(A<<4)>>3],nt=+cn(+((b-Q)*.5)),W=I,I=+ft[B+8+(A<<4)+8>>3],W=+cn(+((I-W)*.5)),W=nt*nt+W*(+ln(+Q)*+ln(+b)*W),P=P+ +ra(+ +Qr(+W),+ +Qr(+(1-W)))*2;while((A|0)!=(d|0));return ft[_>>3]=P,B=0,nt=P,nt=nt*6371.007180918475,nt=nt*1e3,ft[_>>3]=nt,pt=O,B|0}function go(A){A=A|0;var d=0,_=0,b=0;return d=$c(1,12)|0,d||Lr(22832,22787,49,22845),_=A+4|0,b=g[_>>2]|0,b|0?(b=b+8|0,g[b>>2]=d,g[_>>2]=d,d|0):(g[A>>2]|0&&Lr(22862,22787,61,22885),b=A,g[b>>2]=d,g[_>>2]=d,d|0)}function qs(A,d){A=A|0,d=d|0;var _=0,b=0;return b=sc(24)|0,b||Lr(22899,22787,78,22913),g[b>>2]=g[d>>2],g[b+4>>2]=g[d+4>>2],g[b+8>>2]=g[d+8>>2],g[b+12>>2]=g[d+12>>2],g[b+16>>2]=0,d=A+4|0,_=g[d>>2]|0,_|0?(g[_+16>>2]=b,g[d>>2]=b,b|0):(g[A>>2]|0&&Lr(22928,22787,82,22913),g[A>>2]=b,g[d>>2]=b,b|0)}function vs(A){A=A|0;var d=0,_=0,b=0,I=0;if(A)for(b=1;;){if(d=g[A>>2]|0,d|0)do{if(_=g[d>>2]|0,_|0)do I=_,_=g[_+16>>2]|0,ni(I);while(_|0);I=d,d=g[d+8>>2]|0,ni(I)}while(d|0);if(d=A,A=g[A+8>>2]|0,b||ni(d),A)b=0;else break}}function Ia(A){A=A|0;var d=0,_=0,b=0,I=0,P=0,B=0,O=0,W=0,Q=0,nt=0,mt=0,Vt=0,Yt=0,zt=0,re=0,ge=0,Ae=0,ue=0,fe=0,ie=0,tr=0,fr=0,Xe=0,er=0,_n=0,un=0,Yi=0,Ci=0,Ar=0,Ai=0,Rn=0,Kr=0;if(I=A+8|0,g[I>>2]|0)return Kr=1,Kr|0;if(b=g[A>>2]|0,!b)return Kr=0,Kr|0;d=b,_=0;do _=_+1|0,d=g[d+8>>2]|0;while(d|0);if(_>>>0<2)return Kr=0,Kr|0;Ai=sc(_<<2)|0,Ai||Lr(22948,22787,317,22967),Ar=sc(_<<5)|0,Ar||Lr(22989,22787,321,22967),g[A>>2]=0,fr=A+4|0,g[fr>>2]=0,g[I>>2]=0,_=0,Ci=0,tr=0,mt=0;t:for(;;){if(nt=g[b>>2]|0,nt){P=0,B=nt;do{if(W=+ft[B+8>>3],d=B,B=g[B+16>>2]|0,Q=(B|0)==0,I=Q?nt:B,O=+ft[I+8>>3],+Nr(+(W-O))>3.141592653589793){Kr=14;break}P=P+(O-W)*(+ft[d>>3]+ +ft[I>>3])}while(!Q);if((Kr|0)==14){Kr=0,P=0,d=nt;do ie=+ft[d+8>>3],Yi=d+16|0,un=g[Yi>>2]|0,un=un|0?un:nt,fe=+ft[un+8>>3],P=P+(+ft[d>>3]+ +ft[un>>3])*((fe<0?fe+6.283185307179586:fe)-(ie<0?ie+6.283185307179586:ie)),d=g[(d|0?Yi:b)>>2]|0;while(d|0)}P>0?(g[Ai+(Ci<<2)>>2]=b,Ci=Ci+1|0,I=tr,d=mt):Kr=19}else Kr=19;if((Kr|0)==19){Kr=0;do if(_){if(d=_+8|0,g[d>>2]|0){Kr=21;break t}if(_=$c(1,12)|0,!_){Kr=23;break t}g[d>>2]=_,I=_+4|0,B=_,d=mt}else if(mt){I=fr,B=mt+8|0,d=b,_=A;break}else if(g[A>>2]|0){Kr=27;break t}else{I=fr,B=A,d=b,_=A;break}while(!1);if(g[B>>2]=b,g[I>>2]=b,B=Ar+(tr<<5)|0,Q=g[b>>2]|0,Q){for(nt=Ar+(tr<<5)+8|0,ft[nt>>3]=17976931348623157e292,mt=Ar+(tr<<5)+24|0,ft[mt>>3]=17976931348623157e292,ft[B>>3]=-17976931348623157e292,Vt=Ar+(tr<<5)+16|0,ft[Vt>>3]=-17976931348623157e292,Ae=17976931348623157e292,ue=-17976931348623157e292,I=0,Yt=Q,W=17976931348623157e292,re=17976931348623157e292,ge=-17976931348623157e292,O=-17976931348623157e292;P=+ft[Yt>>3],ie=+ft[Yt+8>>3],Yt=g[Yt+16>>2]|0,zt=(Yt|0)==0,fe=+ft[(zt?Q:Yt)+8>>3],P<W&&(ft[nt>>3]=P,W=P),ie<re&&(ft[mt>>3]=ie,re=ie),P>ge?ft[B>>3]=P:P=ge,ie>O&&(ft[Vt>>3]=ie,O=ie),Ae=ie>0&ie<Ae?ie:Ae,ue=ie<0&ie>ue?ie:ue,I=I|+Nr(+(ie-fe))>3.141592653589793,!zt;)ge=P;I&&(ft[Vt>>3]=ue,ft[mt>>3]=Ae)}else g[B>>2]=0,g[B+4>>2]=0,g[B+8>>2]=0,g[B+12>>2]=0,g[B+16>>2]=0,g[B+20>>2]=0,g[B+24>>2]=0,g[B+28>>2]=0;I=tr+1|0}if(Yi=b+8|0,b=g[Yi>>2]|0,g[Yi>>2]=0,b)tr=I,mt=d;else{Kr=45;break}}if((Kr|0)==21)Lr(22765,22787,35,22799);else if((Kr|0)==23)Lr(22819,22787,37,22799);else if((Kr|0)==27)Lr(22862,22787,61,22885);else if((Kr|0)==45){t:do if((Ci|0)>0){for(Yi=(I|0)==0,_n=I<<2,un=(A|0)==0,er=0,d=0;;){if(Xe=g[Ai+(er<<2)>>2]|0,Yi)Kr=73;else{if(tr=sc(_n)|0,!tr){Kr=50;break}if(fr=sc(_n)|0,!fr){Kr=52;break}e:do if(un)_=0;else{for(I=0,_=0,B=A;b=Ar+(I<<5)|0,zn(g[B>>2]|0,b,g[Xe>>2]|0)|0?(g[tr+(_<<2)>>2]=B,g[fr+(_<<2)>>2]=b,zt=_+1|0):zt=_,B=g[B+8>>2]|0,B;)I=I+1|0,_=zt;if((zt|0)>0)if(b=g[tr>>2]|0,(zt|0)==1)_=b;else for(Vt=0,Yt=-1,_=b,mt=b;;){for(Q=g[mt>>2]|0,b=0,B=0;I=g[g[tr+(B<<2)>>2]>>2]|0,(I|0)==(Q|0)?nt=b:nt=b+((zn(I,g[fr+(B<<2)>>2]|0,g[Q>>2]|0)|0)&1)|0,B=B+1|0,(B|0)!=(zt|0);)b=nt;if(I=(nt|0)>(Yt|0),_=I?mt:_,b=Vt+1|0,(b|0)==(zt|0))break e;Vt=b,Yt=I?nt:Yt,mt=g[tr+(b<<2)>>2]|0}else _=0}while(!1);if(ni(tr),ni(fr),_){if(I=_+4|0,b=g[I>>2]|0,b)_=b+8|0;else if(g[_>>2]|0){Kr=70;break}g[_>>2]=Xe,g[I>>2]=Xe}else Kr=73}if((Kr|0)==73){if(Kr=0,d=g[Xe>>2]|0,d|0)do fr=d,d=g[d+16>>2]|0,ni(fr);while(d|0);ni(Xe),d=1}if(er=er+1|0,(er|0)>=(Ci|0)){Rn=d;break t}}(Kr|0)==50?Lr(23004,22787,249,23023):(Kr|0)==52?Lr(23042,22787,252,23023):(Kr|0)==70&&Lr(22862,22787,61,22885)}else Rn=0;while(!1);return ni(Ai),ni(Ar),Kr=Rn,Kr|0}return 0}function zn(A,d,_){A=A|0,d=d|0,_=_|0;var b=0,I=0,P=0,B=0,O=0,W=0,Q=0,nt=0;if(!(H0(d,_)|0)||(d=$_(d)|0,b=+ft[_>>3],I=+ft[_+8>>3],I=d&I<0?I+6.283185307179586:I,A=g[A>>2]|0,!A))return A=0,A|0;if(d){d=0,Q=I,_=A;t:for(;;){for(;B=+ft[_>>3],I=+ft[_+8>>3],_=_+16|0,nt=g[_>>2]|0,nt=nt|0?nt:A,P=+ft[nt>>3],O=+ft[nt+8>>3],B>P?(W=B,B=O):(W=P,P=B,B=I,I=O),b=b==P|b==W?b+2220446049250313e-31:b,!!(b<P|b>W);)if(_=g[_>>2]|0,!_){_=22;break t}if(O=B<0?B+6.283185307179586:B,B=I<0?I+6.283185307179586:I,Q=O==Q|B==Q?Q+-2220446049250313e-31:Q,W=O+(B-O)*((b-P)/(W-P)),(W<0?W+6.283185307179586:W)>Q&&(d=d^1),_=g[_>>2]|0,!_){_=22;break}}if((_|0)==22)return d|0}else{d=0,Q=I,_=A;t:for(;;){for(;B=+ft[_>>3],I=+ft[_+8>>3],_=_+16|0,nt=g[_>>2]|0,nt=nt|0?nt:A,P=+ft[nt>>3],O=+ft[nt+8>>3],B>P?(W=B,B=O):(W=P,P=B,B=I,I=O),b=b==P|b==W?b+2220446049250313e-31:b,!!(b<P|b>W);)if(_=g[_>>2]|0,!_){_=22;break t}if(Q=B==Q|I==Q?Q+-2220446049250313e-31:Q,B+(I-B)*((b-P)/(W-P))>Q&&(d=d^1),_=g[_>>2]|0,!_){_=22;break}}if((_|0)==22)return d|0}return 0}function io(A,d,_,b,I){A=A|0,d=d|0,_=_|0,b=b|0,I=I|0;var P=0,B=0,O=0,W=0,Q=0,nt=0,mt=0,Vt=0,Yt=0,zt=0,re=0,ge=0,Ae=0,ue=0;if(ue=pt,pt=pt+32|0,Ae=ue+16|0,ge=ue,P=De(A|0,d|0,52)|0,wt()|0,P=P&15,Yt=De(_|0,b|0,52)|0,wt()|0,(P|0)!=(Yt&15|0))return Ae=12,pt=ue,Ae|0;if(Q=De(A|0,d|0,45)|0,wt()|0,Q=Q&127,nt=De(_|0,b|0,45)|0,wt()|0,nt=nt&127,Q>>>0>121|nt>>>0>121)return Ae=5,pt=ue,Ae|0;if(Yt=(Q|0)!=(nt|0),Yt){if(O=Tf(Q,nt)|0,(O|0)==7)return Ae=1,pt=ue,Ae|0;W=Tf(nt,Q)|0,(W|0)==7?Lr(23066,23090,161,23100):(zt=O,B=W)}else zt=0,B=0;mt=vn(Q)|0,Vt=vn(nt)|0,g[Ae>>2]=0,g[Ae+4>>2]=0,g[Ae+8>>2]=0,g[Ae+12>>2]=0;do if(zt){if(nt=g[4272+(Q*28|0)+(zt<<2)>>2]|0,O=(nt|0)>0,Vt)if(O){Q=0,W=_,O=b;do W=m(W,O)|0,O=wt()|0,B=rc(B)|0,(B|0)==1&&(B=rc(1)|0),Q=Q+1|0;while((Q|0)!=(nt|0));nt=B,Q=W,W=O}else nt=B,Q=_,W=b;else if(O){Q=0,W=_,O=b;do W=v(W,O)|0,O=wt()|0,B=rc(B)|0,Q=Q+1|0;while((Q|0)!=(nt|0));nt=B,Q=W,W=O}else nt=B,Q=_,W=b;if(V(Q,W,Ae)|0,Yt||Lr(23115,23090,191,23100),O=(mt|0)!=0,B=(Vt|0)!=0,O&B&&Lr(23142,23090,192,23100),O){if(B=ii(A,d)|0,(B|0)==7){P=5;break}if(Pr[21872+(B*7|0)+zt>>0]|0){P=1;break}W=g[21040+(B*28|0)+(zt<<2)>>2]|0,Q=W}else if(B){if(B=ii(Q,W)|0,(B|0)==7){P=5;break}if(Pr[21872+(B*7|0)+nt>>0]|0){P=1;break}Q=0,W=g[21040+(nt*28|0)+(B<<2)>>2]|0}else Q=0,W=0;if((Q|W|0)<0)P=5;else{if((W|0)>0){O=Ae+4|0,B=0;do Ef(O),B=B+1|0;while((B|0)!=(W|0))}if(g[ge>>2]=0,g[ge+4>>2]=0,g[ge+8>>2]=0,Gm(ge,zt),P|0)for(;C(P)|0?sd(ge):_u(ge),(P|0)>1;)P=P+-1|0;if((Q|0)>0){P=0;do Ef(ge),P=P+1|0;while((P|0)!=(Q|0))}re=Ae+4|0,xs(re,ge,re),Ve(re),re=51}}else if(V(_,b,Ae)|0,(mt|0)!=0&(Vt|0)!=0)if((nt|0)!=(Q|0)&&Lr(23173,23090,261,23100),B=ii(A,d)|0,P=ii(_,b)|0,(B|0)==7|(P|0)==7)P=5;else if(Pr[21872+(B*7|0)+P>>0]|0)P=1;else if(B=g[21040+(B*28|0)+(P<<2)>>2]|0,(B|0)>0){O=Ae+4|0,P=0;do Ef(O),P=P+1|0;while((P|0)!=(B|0));re=51}else re=51;else re=51;while(!1);return(re|0)==51&&(P=Ae+4|0,g[I>>2]=g[P>>2],g[I+4>>2]=g[P+4>>2],g[I+8>>2]=g[P+8>>2],P=0),Ae=P,pt=ue,Ae|0}function Sl(A,d,_,b){A=A|0,d=d|0,_=_|0,b=b|0;var I=0,P=0,B=0,O=0,W=0,Q=0,nt=0,mt=0,Vt=0,Yt=0,zt=0,re=0,ge=0,Ae=0,ue=0,fe=0;if(re=pt,pt=pt+48|0,Q=re+36|0,B=re+24|0,O=re+12|0,W=re,I=De(A|0,d|0,52)|0,wt()|0,I=I&15,Vt=De(A|0,d|0,45)|0,wt()|0,Vt=Vt&127,Vt>>>0>121)return b=5,pt=re,b|0;if(nt=vn(Vt)|0,Ge(I|0,0,52)|0,ge=wt()|0|134225919,P=b,g[P>>2]=-1,g[P+4>>2]=ge,!I)return I=qe(_)|0,(I|0)==7||(I=Tl(Vt,I)|0,(I|0)==127)?(ge=1,pt=re,ge|0):(Yt=Ge(I|0,0,45)|0,zt=wt()|0,Vt=b,zt=g[Vt+4>>2]&-1040385|zt,ge=b,g[ge>>2]=g[Vt>>2]|Yt,g[ge+4>>2]=zt,ge=0,pt=re,ge|0);for(g[Q>>2]=g[_>>2],g[Q+4>>2]=g[_+4>>2],g[Q+8>>2]=g[_+8>>2],_=I;;){if(P=_,_=_+-1|0,g[B>>2]=g[Q>>2],g[B+4>>2]=g[Q+4>>2],g[B+8>>2]=g[Q+8>>2],C(P)|0){if(I=Xm(Q)|0,I|0){_=13;break}g[O>>2]=g[Q>>2],g[O+4>>2]=g[Q+4>>2],g[O+8>>2]=g[Q+8>>2],sd(O)}else{if(I=Zm(Q)|0,I|0){_=13;break}g[O>>2]=g[Q>>2],g[O+4>>2]=g[Q+4>>2],g[O+8>>2]=g[Q+8>>2],_u(O)}if(gu(B,O,W),Ve(W),I=b,ue=g[I>>2]|0,I=g[I+4>>2]|0,fe=(15-P|0)*3|0,Ae=Ge(7,0,fe|0)|0,I=I&~(wt()|0),fe=Ge(qe(W)|0,0,fe|0)|0,I=wt()|0|I,ge=b,g[ge>>2]=fe|ue&~Ae,g[ge+4>>2]=I,(P|0)<=1){_=14;break}}t:do if((_|0)!=13&&(_|0)==14)if((g[Q>>2]|0)<=1&&(g[Q+4>>2]|0)<=1&&(g[Q+8>>2]|0)<=1){_=qe(Q)|0,I=Tl(Vt,_)|0,(I|0)==127?W=0:W=vn(I)|0;e:do if(_){if(nt){if(I=ii(A,d)|0,(I|0)==7){I=5;break t}if(P=g[21248+(I*28|0)+(_<<2)>>2]|0,(P|0)>0){I=_,_=0;do I=Uc(I)|0,_=_+1|0;while((_|0)!=(P|0))}else I=_;if((I|0)==1){I=9;break t}_=Tl(Vt,I)|0,(_|0)==127&&Lr(23200,23090,411,23230),vn(_)|0?Lr(23245,23090,412,23230):(zt=_,Yt=P,mt=I)}else zt=I,Yt=0,mt=_;if(O=g[4272+(Vt*28|0)+(mt<<2)>>2]|0,(O|0)<=-1&&Lr(23276,23090,419,23230),!W){if((Yt|0)<0){I=5;break t}if(Yt|0){P=b,I=0,_=g[P>>2]|0,P=g[P+4>>2]|0;do _=l(_,P)|0,P=wt()|0,fe=b,g[fe>>2]=_,g[fe+4>>2]=P,I=I+1|0;while((I|0)<(Yt|0))}if((O|0)<=0){I=zt,_=58;break}for(P=b,I=0,_=g[P>>2]|0,P=g[P+4>>2]|0;;)if(_=l(_,P)|0,P=wt()|0,fe=b,g[fe>>2]=_,g[fe+4>>2]=P,I=I+1|0,(I|0)==(O|0)){I=zt,_=58;break e}}if(B=Tf(zt,Vt)|0,(B|0)==7&&Lr(23066,23090,428,23230),I=b,_=g[I>>2]|0,I=g[I+4>>2]|0,(O|0)>0){P=0;do _=l(_,I)|0,I=wt()|0,fe=b,g[fe>>2]=_,g[fe+4>>2]=I,P=P+1|0;while((P|0)!=(O|0))}if(I=ii(_,I)|0,(I|0)==7&&Lr(23313,23090,440,23230),_=$0(zt)|0,_=g[(_?21664:21456)+(B*28|0)+(I<<2)>>2]|0,(_|0)<0&&Lr(23313,23090,454,23230),!_)I=zt,_=58;else{B=b,I=0,P=g[B>>2]|0,B=g[B+4>>2]|0;do P=M(P,B)|0,B=wt()|0,fe=b,g[fe>>2]=P,g[fe+4>>2]=B,I=I+1|0;while((I|0)<(_|0));I=zt,_=58}}else if((nt|0)!=0&(W|0)!=0){if(_=ii(A,d)|0,P=b,P=ii(g[P>>2]|0,g[P+4>>2]|0)|0,(_|0)==7|(P|0)==7){I=5;break t}if(P=g[21248+(_*28|0)+(P<<2)>>2]|0,(P|0)<0){I=5;break t}if(!P)_=59;else{O=b,_=0,B=g[O>>2]|0,O=g[O+4>>2]|0;do B=l(B,O)|0,O=wt()|0,fe=b,g[fe>>2]=B,g[fe+4>>2]=O,_=_+1|0;while((_|0)<(P|0));_=58}}else _=58;while(!1);if((_|0)==58&&W&&(_=59),(_|0)==59&&(fe=b,(ii(g[fe>>2]|0,g[fe+4>>2]|0)|0)==1)){I=9;break}fe=b,Ae=g[fe>>2]|0,fe=g[fe+4>>2]&-1040385,ue=Ge(I|0,0,45)|0,fe=fe|(wt()|0),I=b,g[I>>2]=Ae|ue,g[I+4>>2]=fe,I=0}else I=1;while(!1);return fe=I,pt=re,fe|0}function bu(A,d,_,b,I,P){A=A|0,d=d|0,_=_|0,b=b|0,I=I|0,P=P|0;var B=0,O=0;return O=pt,pt=pt+16|0,B=O,I?A=15:(A=io(A,d,_,b,B)|0,A||(od(B,P),A=0)),pt=O,A|0}function Sh(A,d,_,b,I){A=A|0,d=d|0,_=_|0,b=b|0,I=I|0;var P=0,B=0;return B=pt,pt=pt+16|0,P=B,b?_=15:(_=Qm(_,P)|0,_||(_=Sl(A,d,P,I)|0)),pt=B,_|0}function Cf(A,d,_,b,I){A=A|0,d=d|0,_=_|0,b=b|0,I=I|0;var P=0,B=0,O=0,W=0;return W=pt,pt=pt+32|0,B=W+12|0,O=W,P=io(A,d,A,d,B)|0,P|0?(O=P,pt=W,O|0):(A=io(A,d,_,b,O)|0,A|0?(O=A,pt=W,O|0):(B=ic(B,O)|0,O=I,g[O>>2]=B,g[O+4>>2]=((B|0)<0)<<31>>31,O=0,pt=W,O|0))}function Do(A,d,_,b,I){A=A|0,d=d|0,_=_|0,b=b|0,I=I|0;var P=0,B=0,O=0,W=0;return W=pt,pt=pt+32|0,B=W+12|0,O=W,P=io(A,d,A,d,B)|0,!P&&(P=io(A,d,_,b,O)|0,!P)?(b=ic(B,O)|0,b=Ei(b|0,((b|0)<0)<<31>>31|0,1,0)|0,B=wt()|0,O=I,g[O>>2]=b,g[O+4>>2]=B,O=0,pt=W,O|0):(O=P,pt=W,O|0)}function _o(A,d,_,b,I){A=A|0,d=d|0,_=_|0,b=b|0,I=I|0;var P=0,B=0,O=0,W=0,Q=0,nt=0,mt=0,Vt=0,Yt=0,zt=0,re=0,ge=0,Ae=0,ue=0,fe=0,ie=0,tr=0,fr=0,Xe=0,er=0;if(Xe=pt,pt=pt+48|0,B=Xe+24|0,O=Xe+12|0,fr=Xe,P=io(A,d,A,d,B)|0,!P&&(P=io(A,d,_,b,O)|0,!P)){ie=ic(B,O)|0,tr=((ie|0)<0)<<31>>31,g[B>>2]=0,g[B+4>>2]=0,g[B+8>>2]=0,g[O>>2]=0,g[O+4>>2]=0,g[O+8>>2]=0,io(A,d,A,d,B)|0&&Lr(23313,23090,691,23299),io(A,d,_,b,O)|0&&Lr(23313,23090,696,23299),If(B),If(O),ie?(mt=g[B>>2]|0,zt=+(ie|0),Ae=B+4|0,Vt=g[Ae>>2]|0,ue=B+8|0,Yt=g[ue>>2]|0,fe=B,b=mt,P=Vt,_=Yt,re=+((g[O>>2]|0)-mt|0)/zt,ge=+((g[O+4>>2]|0)-Vt|0)/zt,zt=+((g[O+8>>2]|0)-Yt|0)/zt):(P=B+4|0,_=B+8|0,Ae=P,ue=_,fe=B,b=g[B>>2]|0,P=g[P>>2]|0,_=g[_>>2]|0,re=0,ge=0,zt=0),g[fr>>2]=b,Yt=fr+4|0,g[Yt>>2]=P,Vt=fr+8|0,g[Vt>>2]=_;t:do if((ie|0)<0)P=0;else for(nt=0,mt=0,P=b;;){Q=+(mt>>>0)+4294967296*+(nt|0),er=re*Q+ +(P|0),W=ge*Q+ +(g[Ae>>2]|0),Q=zt*Q+ +(g[ue>>2]|0),_=~~+hd(+er),B=~~+hd(+W),P=~~+hd(+Q),er=+Nr(+(+(_|0)-er)),W=+Nr(+(+(B|0)-W)),Q=+Nr(+(+(P|0)-Q));do if(er>W&er>Q)_=0-(B+P)|0,b=B;else if(O=0-_|0,W>Q){b=O-P|0;break}else{b=B,P=O-B|0;break}while(!1);if(g[fr>>2]=_,g[Yt>>2]=b,g[Vt>>2]=P,Km(fr),P=Sl(A,d,fr,I+(mt<<3)|0)|0,P|0)break t;if(!((nt|0)<(tr|0)|(nt|0)==(tr|0)&mt>>>0<ie>>>0)){P=0;break t}P=Ei(mt|0,nt|0,1,0)|0,O=wt()|0,nt=O,mt=P,P=g[fe>>2]|0}while(!1);return fr=P,pt=Xe,fr|0}return fr=P,pt=Xe,fr|0}function ws(A,d,_,b){A=A|0,d=d|0,_=_|0,b=b|0;var I=0,P=0,B=0;if((_|0)==0&(b|0)==0)return I=0,P=1,Si(I|0),P|0;P=A,I=d,A=1,d=0;do B=(_&1|0)==0&!0,A=Ho((B?1:P)|0,(B?0:I)|0,A|0,d|0)|0,d=wt()|0,_=ud(_|0,b|0,1)|0,b=wt()|0,P=Ho(P|0,I|0,P|0,I|0)|0,I=wt()|0;while(!((_|0)==0&(b|0)==0));return Si(d|0),A|0}function vu(A,d,_){A=A|0,d=d|0,_=_|0;var b=0,I=0,P=0,B=0,O=0,W=0,Q=0,nt=0,mt=0,Vt=0;if(!(H0(d,_)|0)||(d=$_(d)|0,b=+ft[_>>3],I=+ft[_+8>>3],I=d&I<0?I+6.283185307179586:I,Vt=g[A>>2]|0,(Vt|0)<=0))return Vt=0,Vt|0;if(mt=g[A+4>>2]|0,d){d=0,nt=I,_=-1,A=0;t:for(;;){for(Q=A;B=+ft[mt+(Q<<4)>>3],I=+ft[mt+(Q<<4)+8>>3],A=(_+2|0)%(Vt|0)|0,P=+ft[mt+(A<<4)>>3],O=+ft[mt+(A<<4)+8>>3],B>P?(W=B,B=O):(W=P,P=B,B=I,I=O),b=b==P|b==W?b+2220446049250313e-31:b,!!(b<P|b>W);)if(_=Q+1|0,(_|0)>=(Vt|0)){_=22;break t}else A=Q,Q=_,_=A;if(O=B<0?B+6.283185307179586:B,B=I<0?I+6.283185307179586:I,nt=O==nt|B==nt?nt+-2220446049250313e-31:nt,W=O+(B-O)*((b-P)/(W-P)),(W<0?W+6.283185307179586:W)>nt&&(d=d^1),A=Q+1|0,(A|0)>=(Vt|0)){_=22;break}else _=Q}if((_|0)==22)return d|0}else{d=0,nt=I,_=-1,A=0;t:for(;;){for(Q=A;B=+ft[mt+(Q<<4)>>3],I=+ft[mt+(Q<<4)+8>>3],A=(_+2|0)%(Vt|0)|0,P=+ft[mt+(A<<4)>>3],O=+ft[mt+(A<<4)+8>>3],B>P?(W=B,B=O):(W=P,P=B,B=I,I=O),b=b==P|b==W?b+2220446049250313e-31:b,!!(b<P|b>W);)if(_=Q+1|0,(_|0)>=(Vt|0)){_=22;break t}else A=Q,Q=_,_=A;if(nt=B==nt|I==nt?nt+-2220446049250313e-31:nt,B+(I-B)*((b-P)/(W-P))>nt&&(d=d^1),A=Q+1|0,(A|0)>=(Vt|0)){_=22;break}else _=Q}if((_|0)==22)return d|0}return 0}function us(A,d){A=A|0,d=d|0;var _=0,b=0,I=0,P=0,B=0,O=0,W=0,Q=0,nt=0,mt=0,Vt=0,Yt=0,zt=0,re=0,ge=0,Ae=0,ue=0;if(zt=g[A>>2]|0,!zt){g[d>>2]=0,g[d+4>>2]=0,g[d+8>>2]=0,g[d+12>>2]=0,g[d+16>>2]=0,g[d+20>>2]=0,g[d+24>>2]=0,g[d+28>>2]=0;return}if(re=d+8|0,ft[re>>3]=17976931348623157e292,ge=d+24|0,ft[ge>>3]=17976931348623157e292,ft[d>>3]=-17976931348623157e292,Ae=d+16|0,ft[Ae>>3]=-17976931348623157e292,!((zt|0)<=0)){for(Vt=g[A+4>>2]|0,Q=17976931348623157e292,nt=-17976931348623157e292,mt=0,A=-1,P=17976931348623157e292,B=17976931348623157e292,W=-17976931348623157e292,b=-17976931348623157e292,Yt=0;_=+ft[Vt+(Yt<<4)>>3],O=+ft[Vt+(Yt<<4)+8>>3],A=A+2|0,I=+ft[Vt+(((A|0)==(zt|0)?0:A)<<4)+8>>3],_<P&&(ft[re>>3]=_,P=_),O<B&&(ft[ge>>3]=O,B=O),_>W?ft[d>>3]=_:_=W,O>b&&(ft[Ae>>3]=O,b=O),Q=O>0&O<Q?O:Q,nt=O<0&O>nt?O:nt,mt=mt|+Nr(+(O-I))>3.141592653589793,A=Yt+1|0,(A|0)!=(zt|0);)ue=Yt,W=_,Yt=A,A=ue;mt&&(ft[Ae>>3]=nt,ft[ge>>3]=Q)}}function Ys(A,d){A=A|0,d=d|0;var _=0,b=0,I=0,P=0,B=0,O=0,W=0,Q=0,nt=0,mt=0,Vt=0,Yt=0,zt=0,re=0,ge=0,Ae=0,ue=0,fe=0,ie=0,tr=0,fr=0,Xe=0;if(zt=g[A>>2]|0,zt){if(re=d+8|0,ft[re>>3]=17976931348623157e292,ge=d+24|0,ft[ge>>3]=17976931348623157e292,ft[d>>3]=-17976931348623157e292,Ae=d+16|0,ft[Ae>>3]=-17976931348623157e292,(zt|0)>0){for(I=g[A+4>>2]|0,Vt=17976931348623157e292,Yt=-17976931348623157e292,b=0,_=-1,W=17976931348623157e292,Q=17976931348623157e292,mt=-17976931348623157e292,B=-17976931348623157e292,ue=0;P=+ft[I+(ue<<4)>>3],nt=+ft[I+(ue<<4)+8>>3],fr=_+2|0,O=+ft[I+(((fr|0)==(zt|0)?0:fr)<<4)+8>>3],P<W&&(ft[re>>3]=P,W=P),nt<Q&&(ft[ge>>3]=nt,Q=nt),P>mt?ft[d>>3]=P:P=mt,nt>B&&(ft[Ae>>3]=nt,B=nt),Vt=nt>0&nt<Vt?nt:Vt,Yt=nt<0&nt>Yt?nt:Yt,b=b|+Nr(+(nt-O))>3.141592653589793,_=ue+1|0,(_|0)!=(zt|0);)fr=ue,mt=P,ue=_,_=fr;b&&(ft[Ae>>3]=Yt,ft[ge>>3]=Vt)}}else g[d>>2]=0,g[d+4>>2]=0,g[d+8>>2]=0,g[d+12>>2]=0,g[d+16>>2]=0,g[d+20>>2]=0,g[d+24>>2]=0,g[d+28>>2]=0;if(fr=A+8|0,_=g[fr>>2]|0,!((_|0)<=0)){tr=A+12|0,ie=0;do if(I=g[tr>>2]|0,b=ie,ie=ie+1|0,ge=d+(ie<<5)|0,Ae=g[I+(b<<3)>>2]|0,Ae){if(ue=d+(ie<<5)+8|0,ft[ue>>3]=17976931348623157e292,A=d+(ie<<5)+24|0,ft[A>>3]=17976931348623157e292,ft[ge>>3]=-17976931348623157e292,fe=d+(ie<<5)+16|0,ft[fe>>3]=-17976931348623157e292,(Ae|0)>0){for(zt=g[I+(b<<3)+4>>2]|0,Vt=17976931348623157e292,Yt=-17976931348623157e292,I=0,b=-1,re=0,W=17976931348623157e292,Q=17976931348623157e292,nt=-17976931348623157e292,B=-17976931348623157e292;P=+ft[zt+(re<<4)>>3],mt=+ft[zt+(re<<4)+8>>3],b=b+2|0,O=+ft[zt+(((b|0)==(Ae|0)?0:b)<<4)+8>>3],P<W&&(ft[ue>>3]=P,W=P),mt<Q&&(ft[A>>3]=mt,Q=mt),P>nt?ft[ge>>3]=P:P=nt,mt>B&&(ft[fe>>3]=mt,B=mt),Vt=mt>0&mt<Vt?mt:Vt,Yt=mt<0&mt>Yt?mt:Yt,I=I|+Nr(+(mt-O))>3.141592653589793,b=re+1|0,(b|0)!=(Ae|0);)Xe=re,re=b,nt=P,b=Xe;I&&(ft[fe>>3]=Yt,ft[A>>3]=Vt)}}else g[ge>>2]=0,g[ge+4>>2]=0,g[ge+8>>2]=0,g[ge+12>>2]=0,g[ge+16>>2]=0,g[ge+20>>2]=0,g[ge+24>>2]=0,g[ge+28>>2]=0,_=g[fr>>2]|0;while((ie|0)<(_|0))}}function oa(A,d,_){A=A|0,d=d|0,_=_|0;var b=0,I=0,P=0;if(!(vu(A,d,_)|0))return I=0,I|0;if(I=A+8|0,(g[I>>2]|0)<=0)return I=1,I|0;for(b=A+12|0,A=0;;){if(P=A,A=A+1|0,vu((g[b>>2]|0)+(P<<3)|0,d+(A<<5)|0,_)|0){A=0,b=6;break}if((A|0)>=(g[I>>2]|0)){A=1,b=6;break}}return(b|0)==6?A|0:0}function Ts(){return 8}function Eh(){return 16}function Q0(){return 168}function Z_(){return 8}function G_(){return 16}function fb(){return 12}function ng(){return 8}function nc(A){return A=A|0,+(+((g[A>>2]|0)>>>0)+4294967296*+(g[A+4>>2]|0))}function Ih(A){A=A|0;var d=0,_=0;return _=+ft[A>>3],d=+ft[A+8>>3],+ +Qr(+(_*_+d*d))}function El(A,d,_,b,I){A=A|0,d=d|0,_=_|0,b=b|0,I=I|0;var P=0,B=0,O=0,W=0,Q=0,nt=0,mt=0,Vt=0;Q=+ft[A>>3],W=+ft[d>>3]-Q,O=+ft[A+8>>3],B=+ft[d+8>>3]-O,mt=+ft[_>>3],P=+ft[b>>3]-mt,Vt=+ft[_+8>>3],nt=+ft[b+8>>3]-Vt,P=(P*(O-Vt)-(Q-mt)*nt)/(W*nt-B*P),ft[I>>3]=Q+W*P,ft[I+8>>3]=O+B*P}function Ma(A,d){return A=A|0,d=d|0,+Nr(+(+ft[A>>3]-+ft[d>>3]))<11920928955078125e-23?(d=+Nr(+(+ft[A+8>>3]-+ft[d+8>>3]))<11920928955078125e-23,d|0):(d=0,d|0)}function In(A,d){A=A|0,d=d|0;var _=0,b=0,I=0;return I=+ft[A>>3]-+ft[d>>3],b=+ft[A+8>>3]-+ft[d+8>>3],_=+ft[A+16>>3]-+ft[d+16>>3],+(I*I+b*b+_*_)}function sg(A,d){A=A|0,d=d|0;var _=0,b=0,I=0;_=+ft[A>>3],b=+ln(+_),_=+cn(+_),ft[d+16>>3]=_,_=+ft[A+8>>3],I=b*+ln(+_),ft[d>>3]=I,_=b*+cn(+_),ft[d+8>>3]=_}function jc(A,d,_){A=A|0,d=d|0,_=_|0;var b=0,I=0,P=0;if(P=pt,pt=pt+16|0,I=P,b=wn(A,d)|0,(_+-1|0)>>>0>5||(b=(b|0)!=0,(_|0)==1&b))return I=-1,pt=P,I|0;do if(og(A,d,I)|0)b=-1;else if(b){b=((g[21936+(_<<2)>>2]|0)+5-(g[I>>2]|0)|0)%5|0;break}else{b=((g[21968+(_<<2)>>2]|0)+6-(g[I>>2]|0)|0)%6|0;break}while(!1);return I=b,pt=P,I|0}function og(A,d,_){A=A|0,d=d|0,_=_|0;var b=0,I=0,P=0,B=0,O=0,W=0,Q=0;if(Q=pt,pt=pt+32|0,B=Q+16|0,O=Q,b=$(A,d,B)|0,b|0)return _=b,pt=Q,_|0;P=xu(A,d)|0,W=ii(A,d)|0,Nc(P,O),b=j_(P,g[B>>2]|0)|0;t:do if(vn(P)|0){do switch(P|0){case 4:{A=0;break}case 14:{A=1;break}case 24:{A=2;break}case 38:{A=3;break}case 49:{A=4;break}case 58:{A=5;break}case 63:{A=6;break}case 72:{A=7;break}case 83:{A=8;break}case 97:{A=9;break}case 107:{A=10;break}case 117:{A=11;break}default:{b=1;break t}}while(!1);if(I=g[22e3+(A*24|0)+8>>2]|0,d=g[22e3+(A*24|0)+16>>2]|0,A=g[B>>2]|0,(A|0)!=(g[O>>2]|0)&&(O=$0(P)|0,A=g[B>>2]|0,O|(A|0)==(d|0)&&(b=(b+1|0)%6|0)),(W|0)==3&(A|0)==(d|0)){b=(b+5|0)%6|0,I=22;break}(W|0)==5&(A|0)==(I|0)&&(b=(b+1|0)%6|0),I=22}else I=22;while(!1);return(I|0)==22&&(g[_>>2]=b,b=0),_=b,pt=Q,_|0}function Il(A,d,_,b){A=A|0,d=d|0,_=_|0,b=b|0;var I=0,P=0,B=0,O=0,W=0,Q=0,nt=0,mt=0,Vt=0,Yt=0,zt=0,re=0,ge=0,Ae=0,ue=0,fe=0;if(fe=pt,pt=pt+32|0,ue=fe+24|0,ge=fe+20|0,zt=fe+8|0,Yt=fe+16|0,Vt=fe,W=(wn(A,d)|0)==0,W=W?6:5,nt=De(A|0,d|0,52)|0,wt()|0,nt=nt&15,W>>>0<=_>>>0)return b=2,pt=fe,b|0;mt=(nt|0)==0,!mt&&(re=Ge(7,0,(nt^15)*3|0)|0,(re&A|0)==0&((wt()|0)&d|0)==0)?I=_:P=4;t:do if((P|0)==4){if(I=(wn(A,d)|0)!=0,((I?4:5)|0)<(_|0)||og(A,d,ue)|0||(P=(g[ue>>2]|0)+_|0,I?I=22288+(((P|0)%5|0)<<2)|0:I=22320+(((P|0)%6|0)<<2)|0,re=g[I>>2]|0,(re|0)==7))return b=1,pt=fe,b|0;g[ge>>2]=0,I=Ws(A,d,re,ge,zt)|0;do if(!I){if(O=zt,Q=g[O>>2]|0,O=g[O+4>>2]|0,B=O>>>0<d>>>0|(O|0)==(d|0)&Q>>>0<A>>>0,P=B?Q:A,B=B?O:d,!mt&&(mt=Ge(7,0,(nt^15)*3|0)|0,(Q&mt|0)==0&(O&(wt()|0)|0)==0))I=_;else{if(O=(_+-1+W|0)%(W|0)|0,I=wn(A,d)|0,(O|0)<0&&Lr(23313,23315,245,23324),W=(I|0)!=0,((W?4:5)|0)<(O|0)&&Lr(23313,23315,245,23324),og(A,d,ue)|0&&Lr(23313,23315,245,23324),I=(g[ue>>2]|0)+O|0,W?I=22288+(((I|0)%5|0)<<2)|0:I=22320+(((I|0)%6|0)<<2)|0,O=g[I>>2]|0,(O|0)==7&&Lr(23313,23315,245,23324),g[Yt>>2]=0,I=Ws(A,d,O,Yt,Vt)|0,I|0)break;Q=Vt,W=g[Q>>2]|0,Q=g[Q+4>>2]|0;do if(Q>>>0<B>>>0|(Q|0)==(B|0)&W>>>0<P>>>0){if(wn(W,Q)|0?P=j0(W,Q,A,d)|0:P=g[22384+((((g[Yt>>2]|0)+(g[22352+(O<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,I=wn(W,Q)|0,(P+-1|0)>>>0>5){I=-1,P=W,B=Q;break}if(I=(I|0)!=0,(P|0)==1&I){I=-1,P=W,B=Q;break}do if(og(W,Q,ue)|0)I=-1;else if(I){I=((g[21936+(P<<2)>>2]|0)+5-(g[ue>>2]|0)|0)%5|0;break}else{I=((g[21968+(P<<2)>>2]|0)+6-(g[ue>>2]|0)|0)%6|0;break}while(!1);P=W,B=Q}else I=_;while(!1);O=zt,Q=g[O>>2]|0,O=g[O+4>>2]|0}if((P|0)==(Q|0)&(B|0)==(O|0)){if(W=(wn(Q,O)|0)!=0,W?A=j0(Q,O,A,d)|0:A=g[22384+((((g[ge>>2]|0)+(g[22352+(re<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,I=wn(Q,O)|0,(A+-1|0)>>>0<=5&&(Ae=(I|0)!=0,!((A|0)==1&Ae)))do if(og(Q,O,ue)|0)I=-1;else if(Ae){I=((g[21936+(A<<2)>>2]|0)+5-(g[ue>>2]|0)|0)%5|0;break}else{I=((g[21968+(A<<2)>>2]|0)+6-(g[ue>>2]|0)|0)%6|0;break}while(!1);else I=-1;I=I+1|0,I=(I|0)==6|W&(I|0)==5?0:I}d=B,A=P;break t}while(!1);return b=I,pt=fe,b|0}while(!1);return Ae=Ge(I|0,0,56)|0,ue=wt()|0|d&-2130706433|536870912,g[b>>2]=Ae|A,g[b+4>>2]=ue,b=0,pt=fe,b|0}function Fs(A,d,_){A=A|0,d=d|0,_=_|0;var b=0,I=0,P=0;return P=(wn(A,d)|0)==0,b=Il(A,d,0,_)|0,I=(b|0)==0,P?!I||(b=Il(A,d,1,_+8|0)|0,b|0)||(b=Il(A,d,2,_+16|0)|0,b|0)||(b=Il(A,d,3,_+24|0)|0,b|0)||(b=Il(A,d,4,_+32|0)|0,b)?(P=b,P|0):Il(A,d,5,_+40|0)|0:!I||(b=Il(A,d,1,_+8|0)|0,b|0)||(b=Il(A,d,2,_+16|0)|0,b|0)||(b=Il(A,d,3,_+24|0)|0,b|0)||(b=Il(A,d,4,_+32|0)|0,b|0)?(P=b,P|0):(P=_+40|0,g[P>>2]=0,g[P+4>>2]=0,P=0,P|0)}function pb(A,d,_){A=A|0,d=d|0,_=_|0;var b=0,I=0,P=0,B=0,O=0,W=0;return W=pt,pt=pt+192|0,I=W,P=W+168|0,B=De(A|0,d|0,56)|0,wt()|0,B=B&7,O=d&-2130706433|134217728,b=$(A,O,P)|0,b|0?(O=b,pt=W,O|0):(d=De(A|0,d|0,52)|0,wt()|0,d=d&15,wn(A,O)|0?wh(P,d,B,1,I):ld(P,d,B,1,I),O=I+8|0,g[_>>2]=g[O>>2],g[_+4>>2]=g[O+4>>2],g[_+8>>2]=g[O+8>>2],g[_+12>>2]=g[O+12>>2],O=0,pt=W,O|0)}function DT(A,d){A=A|0,d=d|0;var _=0,b=0,I=0,P=0;return I=pt,pt=pt+16|0,_=I,!(!0&(d&2013265920|0)==536870912)||(b=d&-2130706433|134217728,!(Gn(A,b)|0))?(b=0,pt=I,b|0):(P=De(A|0,d|0,56)|0,wt()|0,P=(Il(A,b,P&7,_)|0)==0,b=_,b=P&((g[b>>2]|0)==(A|0)?(g[b+4>>2]|0)==(d|0):0)&1,pt=I,b|0)}function Pf(A,d,_){A=A|0,d=d|0,_=_|0;var b=0;(d|0)>0?(b=$c(d,4)|0,g[A>>2]=b,b||Lr(23337,23360,40,23374)):g[A>>2]=0,g[A+4>>2]=d,g[A+8>>2]=0,g[A+12>>2]=_}function Rf(A){A=A|0;var d=0,_=0,b=0,I=0,P=0,B=0,O=0;I=A+4|0,P=A+12|0,B=A+8|0;t:for(;;){for(_=g[I>>2]|0,d=0;;){if((d|0)>=(_|0))break t;if(b=g[A>>2]|0,O=g[b+(d<<2)>>2]|0,!O)d=d+1|0;else break}d=b+(~~(+Nr(+(+ys(10,+ +(15-(g[P>>2]|0)|0))*(+ft[O>>3]+ +ft[O+8>>3])))%+(_|0))>>>0<<2)|0,_=g[d>>2]|0;e:do if(_|0){if(b=O+32|0,(_|0)==(O|0))g[d>>2]=g[b>>2];else{if(_=_+32|0,d=g[_>>2]|0,!d)break;for(;(d|0)!=(O|0);)if(_=d+32|0,d=g[_>>2]|0,!d)break e;g[_>>2]=g[b>>2]}ni(O),g[B>>2]=(g[B>>2]|0)+-1}while(!1)}ni(g[A>>2]|0)}function ag(A){A=A|0;var d=0,_=0,b=0;for(b=g[A+4>>2]|0,_=0;;){if((_|0)>=(b|0)){d=0,_=4;break}if(d=g[(g[A>>2]|0)+(_<<2)>>2]|0,!d)_=_+1|0;else{_=4;break}}return(_|0)==4?d|0:0}function Q_(A,d){A=A|0,d=d|0;var _=0,b=0,I=0,P=0;if(_=~~(+Nr(+(+ys(10,+ +(15-(g[A+12>>2]|0)|0))*(+ft[d>>3]+ +ft[d+8>>3])))%+(g[A+4>>2]|0))>>>0,_=(g[A>>2]|0)+(_<<2)|0,b=g[_>>2]|0,!b)return P=1,P|0;P=d+32|0;do if((b|0)!=(d|0)){if(_=g[b+32>>2]|0,!_)return P=1,P|0;for(I=_;;){if((I|0)==(d|0)){I=8;break}if(_=g[I+32>>2]|0,_)b=I,I=_;else{_=1,I=10;break}}if((I|0)==8){g[b+32>>2]=g[P>>2];break}else if((I|0)==10)return _|0}else g[_>>2]=g[P>>2];while(!1);return ni(d),P=A+8|0,g[P>>2]=(g[P>>2]|0)+-1,P=0,P|0}function BT(A,d,_){A=A|0,d=d|0,_=_|0;var b=0,I=0,P=0,B=0;P=sc(40)|0,P||Lr(23390,23360,98,23403),g[P>>2]=g[d>>2],g[P+4>>2]=g[d+4>>2],g[P+8>>2]=g[d+8>>2],g[P+12>>2]=g[d+12>>2],I=P+16|0,g[I>>2]=g[_>>2],g[I+4>>2]=g[_+4>>2],g[I+8>>2]=g[_+8>>2],g[I+12>>2]=g[_+12>>2],g[P+32>>2]=0,I=~~(+Nr(+(+ys(10,+ +(15-(g[A+12>>2]|0)|0))*(+ft[d>>3]+ +ft[d+8>>3])))%+(g[A+4>>2]|0))>>>0,I=(g[A>>2]|0)+(I<<2)|0,b=g[I>>2]|0;do if(!b)g[I>>2]=P;else{for(;!(Gt(b,d)|0&&Gt(b+16|0,_)|0);)if(I=g[b+32>>2]|0,b=I|0?I:b,!(g[b+32>>2]|0)){B=10;break}if((B|0)==10){g[b+32>>2]=P;break}return ni(P),B=b,B|0}while(!1);return B=A+8|0,g[B>>2]=(g[B>>2]|0)+1,B=P,B|0}function kC(A,d,_){A=A|0,d=d|0,_=_|0;var b=0,I=0;if(I=~~(+Nr(+(+ys(10,+ +(15-(g[A+12>>2]|0)|0))*(+ft[d>>3]+ +ft[d+8>>3])))%+(g[A+4>>2]|0))>>>0,I=g[(g[A>>2]|0)+(I<<2)>>2]|0,!I)return _=0,_|0;if(!_){for(A=I;;){if(Gt(A,d)|0){b=10;break}if(A=g[A+32>>2]|0,!A){A=0,b=10;break}}if((b|0)==10)return A|0}for(A=I;;){if(Gt(A,d)|0&&Gt(A+16|0,_)|0){b=10;break}if(A=g[A+32>>2]|0,!A){A=0,b=10;break}}return(b|0)==10?A|0:0}function OT(A,d){A=A|0,d=d|0;var _=0;if(_=~~(+Nr(+(+ys(10,+ +(15-(g[A+12>>2]|0)|0))*(+ft[d>>3]+ +ft[d+8>>3])))%+(g[A+4>>2]|0))>>>0,A=g[(g[A>>2]|0)+(_<<2)>>2]|0,!A)return _=0,_|0;for(;;){if(Gt(A,d)|0){d=5;break}if(A=g[A+32>>2]|0,!A){A=0,d=5;break}}return(d|0)==5?A|0:0}function DC(){return 23424}function db(A){return A=+A,+ +mb(+A)}function kf(A){return A=+A,~~+db(A)|0}function sc(A){A=A|0;var d=0,_=0,b=0,I=0,P=0,B=0,O=0,W=0,Q=0,nt=0,mt=0,Vt=0,Yt=0,zt=0,re=0,ge=0,Ae=0,ue=0,fe=0,ie=0,tr=0;tr=pt,pt=pt+16|0,Vt=tr;do if(A>>>0<245){if(Q=A>>>0<11?16:A+11&-8,A=Q>>>3,mt=g[5857]|0,_=mt>>>A,_&3|0)return d=(_&1^1)+A|0,A=23468+(d<<1<<2)|0,_=A+8|0,b=g[_>>2]|0,I=b+8|0,P=g[I>>2]|0,(P|0)==(A|0)?g[5857]=mt&~(1<<d):(g[P+12>>2]=A,g[_>>2]=P),ie=d<<3,g[b+4>>2]=ie|3,ie=b+ie+4|0,g[ie>>2]=g[ie>>2]|1,ie=I,pt=tr,ie|0;if(nt=g[5859]|0,Q>>>0>nt>>>0){if(_|0)return d=2<<A,d=_<<A&(d|0-d),d=(d&0-d)+-1|0,O=d>>>12&16,d=d>>>O,_=d>>>5&8,d=d>>>_,P=d>>>2&4,d=d>>>P,A=d>>>1&2,d=d>>>A,b=d>>>1&1,b=(_|O|P|A|b)+(d>>>b)|0,d=23468+(b<<1<<2)|0,A=d+8|0,P=g[A>>2]|0,O=P+8|0,_=g[O>>2]|0,(_|0)==(d|0)?(A=mt&~(1<<b),g[5857]=A):(g[_+12>>2]=d,g[A>>2]=_,A=mt),ie=b<<3,B=ie-Q|0,g[P+4>>2]=Q|3,I=P+Q|0,g[I+4>>2]=B|1,g[P+ie>>2]=B,nt|0&&(b=g[5862]|0,d=nt>>>3,_=23468+(d<<1<<2)|0,d=1<<d,A&d?(A=_+8|0,d=g[A>>2]|0):(g[5857]=A|d,d=_,A=_+8|0),g[A>>2]=b,g[d+12>>2]=b,g[b+8>>2]=d,g[b+12>>2]=_),g[5859]=B,g[5862]=I,ie=O,pt=tr,ie|0;if(P=g[5858]|0,P){for(_=(P&0-P)+-1|0,I=_>>>12&16,_=_>>>I,b=_>>>5&8,_=_>>>b,B=_>>>2&4,_=_>>>B,O=_>>>1&2,_=_>>>O,W=_>>>1&1,W=g[23732+((b|I|B|O|W)+(_>>>W)<<2)>>2]|0,_=W,O=W,W=(g[W+4>>2]&-8)-Q|0;A=g[_+16>>2]|0,!(!A&&(A=g[_+20>>2]|0,!A));)B=(g[A+4>>2]&-8)-Q|0,I=B>>>0<W>>>0,_=A,O=I?A:O,W=I?B:W;if(B=O+Q|0,B>>>0>O>>>0){I=g[O+24>>2]|0,d=g[O+12>>2]|0;do if((d|0)==(O|0)){if(A=O+20|0,d=g[A>>2]|0,!d&&(A=O+16|0,d=g[A>>2]|0,!d)){_=0;break}for(;;)if(b=d+20|0,_=g[b>>2]|0,_)d=_,A=b;else if(b=d+16|0,_=g[b>>2]|0,_)d=_,A=b;else break;g[A>>2]=0,_=d}else _=g[O+8>>2]|0,g[_+12>>2]=d,g[d+8>>2]=_,_=d;while(!1);do if(I|0){if(d=g[O+28>>2]|0,A=23732+(d<<2)|0,(O|0)==(g[A>>2]|0)){if(g[A>>2]=_,!_){g[5858]=P&~(1<<d);break}}else if(ie=I+16|0,g[((g[ie>>2]|0)==(O|0)?ie:I+20|0)>>2]=_,!_)break;g[_+24>>2]=I,d=g[O+16>>2]|0,d|0&&(g[_+16>>2]=d,g[d+24>>2]=_),d=g[O+20>>2]|0,d|0&&(g[_+20>>2]=d,g[d+24>>2]=_)}while(!1);return W>>>0<16?(ie=W+Q|0,g[O+4>>2]=ie|3,ie=O+ie+4|0,g[ie>>2]=g[ie>>2]|1):(g[O+4>>2]=Q|3,g[B+4>>2]=W|1,g[B+W>>2]=W,nt|0&&(b=g[5862]|0,d=nt>>>3,_=23468+(d<<1<<2)|0,d=1<<d,d&mt?(A=_+8|0,d=g[A>>2]|0):(g[5857]=d|mt,d=_,A=_+8|0),g[A>>2]=b,g[d+12>>2]=b,g[b+8>>2]=d,g[b+12>>2]=_),g[5859]=W,g[5862]=B),ie=O+8|0,pt=tr,ie|0}else mt=Q}else mt=Q}else mt=Q}else if(A>>>0<=4294967231)if(A=A+11|0,Q=A&-8,b=g[5858]|0,b){I=0-Q|0,A=A>>>8,A?Q>>>0>16777215?W=31:(mt=(A+1048320|0)>>>16&8,re=A<<mt,O=(re+520192|0)>>>16&4,re=re<<O,W=(re+245760|0)>>>16&2,W=14-(O|mt|W)+(re<<W>>>15)|0,W=Q>>>(W+7|0)&1|W<<1):W=0,_=g[23732+(W<<2)>>2]|0;t:do if(!_)_=0,A=0,re=61;else for(A=0,O=Q<<((W|0)==31?0:25-(W>>>1)|0),P=0;;){if(B=(g[_+4>>2]&-8)-Q|0,B>>>0<I>>>0)if(B)A=_,I=B;else{A=_,I=0,re=65;break t}if(re=g[_+20>>2]|0,_=g[_+16+(O>>>31<<2)>>2]|0,P=(re|0)==0|(re|0)==(_|0)?P:re,_)O=O<<1;else{_=P,re=61;break}}while(!1);if((re|0)==61){if((_|0)==0&(A|0)==0){if(A=2<<W,A=(A|0-A)&b,!A){mt=Q;break}mt=(A&0-A)+-1|0,B=mt>>>12&16,mt=mt>>>B,P=mt>>>5&8,mt=mt>>>P,O=mt>>>2&4,mt=mt>>>O,W=mt>>>1&2,mt=mt>>>W,_=mt>>>1&1,A=0,_=g[23732+((P|B|O|W|_)+(mt>>>_)<<2)>>2]|0}_?re=65:(O=A,B=I)}if((re|0)==65)for(P=_;;)if(mt=(g[P+4>>2]&-8)-Q|0,_=mt>>>0<I>>>0,I=_?mt:I,A=_?P:A,_=g[P+16>>2]|0,_||(_=g[P+20>>2]|0),_)P=_;else{O=A,B=I;break}if(O|0&&B>>>0<((g[5859]|0)-Q|0)>>>0&&(nt=O+Q|0,nt>>>0>O>>>0)){P=g[O+24>>2]|0,d=g[O+12>>2]|0;do if((d|0)==(O|0)){if(A=O+20|0,d=g[A>>2]|0,!d&&(A=O+16|0,d=g[A>>2]|0,!d)){d=0;break}for(;;)if(I=d+20|0,_=g[I>>2]|0,_)d=_,A=I;else if(I=d+16|0,_=g[I>>2]|0,_)d=_,A=I;else break;g[A>>2]=0}else ie=g[O+8>>2]|0,g[ie+12>>2]=d,g[d+8>>2]=ie;while(!1);do if(P){if(A=g[O+28>>2]|0,_=23732+(A<<2)|0,(O|0)==(g[_>>2]|0)){if(g[_>>2]=d,!d){b=b&~(1<<A),g[5858]=b;break}}else if(ie=P+16|0,g[((g[ie>>2]|0)==(O|0)?ie:P+20|0)>>2]=d,!d)break;g[d+24>>2]=P,A=g[O+16>>2]|0,A|0&&(g[d+16>>2]=A,g[A+24>>2]=d),A=g[O+20>>2]|0,A&&(g[d+20>>2]=A,g[A+24>>2]=d)}while(!1);t:do if(B>>>0<16)ie=B+Q|0,g[O+4>>2]=ie|3,ie=O+ie+4|0,g[ie>>2]=g[ie>>2]|1;else{if(g[O+4>>2]=Q|3,g[nt+4>>2]=B|1,g[nt+B>>2]=B,d=B>>>3,B>>>0<256){_=23468+(d<<1<<2)|0,A=g[5857]|0,d=1<<d,A&d?(A=_+8|0,d=g[A>>2]|0):(g[5857]=A|d,d=_,A=_+8|0),g[A>>2]=nt,g[d+12>>2]=nt,g[nt+8>>2]=d,g[nt+12>>2]=_;break}if(d=B>>>8,d?B>>>0>16777215?_=31:(fe=(d+1048320|0)>>>16&8,ie=d<<fe,ue=(ie+520192|0)>>>16&4,ie=ie<<ue,_=(ie+245760|0)>>>16&2,_=14-(ue|fe|_)+(ie<<_>>>15)|0,_=B>>>(_+7|0)&1|_<<1):_=0,d=23732+(_<<2)|0,g[nt+28>>2]=_,A=nt+16|0,g[A+4>>2]=0,g[A>>2]=0,A=1<<_,!(b&A)){g[5858]=b|A,g[d>>2]=nt,g[nt+24>>2]=d,g[nt+12>>2]=nt,g[nt+8>>2]=nt;break}d=g[d>>2]|0;e:do if((g[d+4>>2]&-8|0)!=(B|0)){for(b=B<<((_|0)==31?0:25-(_>>>1)|0);_=d+16+(b>>>31<<2)|0,A=g[_>>2]|0,!!A;)if((g[A+4>>2]&-8|0)==(B|0)){d=A;break e}else b=b<<1,d=A;g[_>>2]=nt,g[nt+24>>2]=d,g[nt+12>>2]=nt,g[nt+8>>2]=nt;break t}while(!1);fe=d+8|0,ie=g[fe>>2]|0,g[ie+12>>2]=nt,g[fe>>2]=nt,g[nt+8>>2]=ie,g[nt+12>>2]=d,g[nt+24>>2]=0}while(!1);return ie=O+8|0,pt=tr,ie|0}else mt=Q}else mt=Q;else mt=-1;while(!1);if(_=g[5859]|0,_>>>0>=mt>>>0)return d=_-mt|0,A=g[5862]|0,d>>>0>15?(ie=A+mt|0,g[5862]=ie,g[5859]=d,g[ie+4>>2]=d|1,g[A+_>>2]=d,g[A+4>>2]=mt|3):(g[5859]=0,g[5862]=0,g[A+4>>2]=_|3,ie=A+_+4|0,g[ie>>2]=g[ie>>2]|1),ie=A+8|0,pt=tr,ie|0;if(B=g[5860]|0,B>>>0>mt>>>0)return ue=B-mt|0,g[5860]=ue,ie=g[5863]|0,fe=ie+mt|0,g[5863]=fe,g[fe+4>>2]=ue|1,g[ie+4>>2]=mt|3,ie=ie+8|0,pt=tr,ie|0;if(g[5975]|0?A=g[5977]|0:(g[5977]=4096,g[5976]=4096,g[5978]=-1,g[5979]=-1,g[5980]=0,g[5968]=0,g[5975]=Vt&-16^1431655768,A=4096),O=mt+48|0,W=mt+47|0,P=A+W|0,I=0-A|0,Q=P&I,Q>>>0<=mt>>>0||(A=g[5967]|0,A|0&&(nt=g[5965]|0,Vt=nt+Q|0,Vt>>>0<=nt>>>0|Vt>>>0>A>>>0)))return ie=0,pt=tr,ie|0;t:do if(g[5968]&4)d=0,re=143;else{_=g[5863]|0;e:do if(_){for(b=23876;Vt=g[b>>2]|0,!(Vt>>>0<=_>>>0&&(Vt+(g[b+4>>2]|0)|0)>>>0>_>>>0);)if(A=g[b+8>>2]|0,A)b=A;else{re=128;break e}if(d=P-B&I,d>>>0<2147483647)if(A=Mh(d|0)|0,(A|0)==((g[b>>2]|0)+(g[b+4>>2]|0)|0)){if((A|0)!=-1){B=d,P=A,re=145;break t}}else b=A,re=136;else d=0}else re=128;while(!1);do if((re|0)==128)if(_=Mh(0)|0,(_|0)!=-1&&(d=_,Yt=g[5976]|0,zt=Yt+-1|0,d=(zt&d|0?(zt+d&0-Yt)-d|0:0)+Q|0,Yt=g[5965]|0,zt=d+Yt|0,d>>>0>mt>>>0&d>>>0<2147483647)){if(Vt=g[5967]|0,Vt|0&&zt>>>0<=Yt>>>0|zt>>>0>Vt>>>0){d=0;break}if(A=Mh(d|0)|0,(A|0)==(_|0)){B=d,P=_,re=145;break t}else b=A,re=136}else d=0;while(!1);do if((re|0)==136){if(_=0-d|0,!(O>>>0>d>>>0&(d>>>0<2147483647&(b|0)!=-1)))if((b|0)==-1){d=0;break}else{B=d,P=b,re=145;break t}if(A=g[5977]|0,A=W-d+A&0-A,A>>>0>=2147483647){B=d,P=b,re=145;break t}if((Mh(A|0)|0)==-1){Mh(_|0)|0,d=0;break}else{B=A+d|0,P=b,re=145;break t}}while(!1);g[5968]=g[5968]|4,re=143}while(!1);if((re|0)==143&&Q>>>0<2147483647&&(ue=Mh(Q|0)|0,zt=Mh(0)|0,ge=zt-ue|0,Ae=ge>>>0>(mt+40|0)>>>0,!((ue|0)==-1|Ae^1|ue>>>0<zt>>>0&((ue|0)!=-1&(zt|0)!=-1)^1))&&(B=Ae?ge:d,P=ue,re=145),(re|0)==145){d=(g[5965]|0)+B|0,g[5965]=d,d>>>0>(g[5966]|0)>>>0&&(g[5966]=d),W=g[5863]|0;t:do if(W){for(d=23876;;){if(A=g[d>>2]|0,_=g[d+4>>2]|0,(P|0)==(A+_|0)){re=154;break}if(b=g[d+8>>2]|0,b)d=b;else break}if((re|0)==154&&(fe=d+4|0,(g[d+12>>2]&8|0)==0)&&P>>>0>W>>>0&A>>>0<=W>>>0){g[fe>>2]=_+B,ie=(g[5860]|0)+B|0,ue=W+8|0,ue=ue&7|0?0-ue&7:0,fe=W+ue|0,ue=ie-ue|0,g[5863]=fe,g[5860]=ue,g[fe+4>>2]=ue|1,g[W+ie+4>>2]=40,g[5864]=g[5979];break}for(P>>>0<(g[5861]|0)>>>0&&(g[5861]=P),_=P+B|0,d=23876;;){if((g[d>>2]|0)==(_|0)){re=162;break}if(A=g[d+8>>2]|0,A)d=A;else break}if((re|0)==162&&!(g[d+12>>2]&8|0)){g[d>>2]=P,nt=d+4|0,g[nt>>2]=(g[nt>>2]|0)+B,nt=P+8|0,nt=P+(nt&7|0?0-nt&7:0)|0,d=_+8|0,d=_+(d&7|0?0-d&7:0)|0,Q=nt+mt|0,O=d-nt-mt|0,g[nt+4>>2]=mt|3;e:do if((W|0)==(d|0))ie=(g[5860]|0)+O|0,g[5860]=ie,g[5863]=Q,g[Q+4>>2]=ie|1;else{if((g[5862]|0)==(d|0)){ie=(g[5859]|0)+O|0,g[5859]=ie,g[5862]=Q,g[Q+4>>2]=ie|1,g[Q+ie>>2]=ie;break}if(A=g[d+4>>2]|0,(A&3|0)==1){B=A&-8,b=A>>>3;r:do if(A>>>0<256)if(A=g[d+8>>2]|0,_=g[d+12>>2]|0,(_|0)==(A|0)){g[5857]=g[5857]&~(1<<b);break}else{g[A+12>>2]=_,g[_+8>>2]=A;break}else{P=g[d+24>>2]|0,A=g[d+12>>2]|0;do if((A|0)==(d|0)){if(_=d+16|0,b=_+4|0,A=g[b>>2]|0,A)_=b;else if(A=g[_>>2]|0,!A){A=0;break}for(;;)if(I=A+20|0,b=g[I>>2]|0,b)A=b,_=I;else if(I=A+16|0,b=g[I>>2]|0,b)A=b,_=I;else break;g[_>>2]=0}else ie=g[d+8>>2]|0,g[ie+12>>2]=A,g[A+8>>2]=ie;while(!1);if(!P)break;_=g[d+28>>2]|0,b=23732+(_<<2)|0;do if((g[b>>2]|0)!=(d|0)){if(ie=P+16|0,g[((g[ie>>2]|0)==(d|0)?ie:P+20|0)>>2]=A,!A)break r}else{if(g[b>>2]=A,A|0)break;g[5858]=g[5858]&~(1<<_);break r}while(!1);if(g[A+24>>2]=P,_=d+16|0,b=g[_>>2]|0,b|0&&(g[A+16>>2]=b,g[b+24>>2]=A),_=g[_+4>>2]|0,!_)break;g[A+20>>2]=_,g[_+24>>2]=A}while(!1);d=d+B|0,I=B+O|0}else I=O;if(d=d+4|0,g[d>>2]=g[d>>2]&-2,g[Q+4>>2]=I|1,g[Q+I>>2]=I,d=I>>>3,I>>>0<256){_=23468+(d<<1<<2)|0,A=g[5857]|0,d=1<<d,A&d?(A=_+8|0,d=g[A>>2]|0):(g[5857]=A|d,d=_,A=_+8|0),g[A>>2]=Q,g[d+12>>2]=Q,g[Q+8>>2]=d,g[Q+12>>2]=_;break}d=I>>>8;do if(!d)b=0;else{if(I>>>0>16777215){b=31;break}fe=(d+1048320|0)>>>16&8,ie=d<<fe,ue=(ie+520192|0)>>>16&4,ie=ie<<ue,b=(ie+245760|0)>>>16&2,b=14-(ue|fe|b)+(ie<<b>>>15)|0,b=I>>>(b+7|0)&1|b<<1}while(!1);if(d=23732+(b<<2)|0,g[Q+28>>2]=b,A=Q+16|0,g[A+4>>2]=0,g[A>>2]=0,A=g[5858]|0,_=1<<b,!(A&_)){g[5858]=A|_,g[d>>2]=Q,g[Q+24>>2]=d,g[Q+12>>2]=Q,g[Q+8>>2]=Q;break}d=g[d>>2]|0;r:do if((g[d+4>>2]&-8|0)!=(I|0)){for(b=I<<((b|0)==31?0:25-(b>>>1)|0);_=d+16+(b>>>31<<2)|0,A=g[_>>2]|0,!!A;)if((g[A+4>>2]&-8|0)==(I|0)){d=A;break r}else b=b<<1,d=A;g[_>>2]=Q,g[Q+24>>2]=d,g[Q+12>>2]=Q,g[Q+8>>2]=Q;break e}while(!1);fe=d+8|0,ie=g[fe>>2]|0,g[ie+12>>2]=Q,g[fe>>2]=Q,g[Q+8>>2]=ie,g[Q+12>>2]=d,g[Q+24>>2]=0}while(!1);return ie=nt+8|0,pt=tr,ie|0}for(d=23876;A=g[d>>2]|0,!(A>>>0<=W>>>0&&(ie=A+(g[d+4>>2]|0)|0,ie>>>0>W>>>0));)d=g[d+8>>2]|0;I=ie+-47|0,A=I+8|0,A=I+(A&7|0?0-A&7:0)|0,I=W+16|0,A=A>>>0<I>>>0?W:A,d=A+8|0,_=B+-40|0,ue=P+8|0,ue=ue&7|0?0-ue&7:0,fe=P+ue|0,ue=_-ue|0,g[5863]=fe,g[5860]=ue,g[fe+4>>2]=ue|1,g[P+_+4>>2]=40,g[5864]=g[5979],_=A+4|0,g[_>>2]=27,g[d>>2]=g[5969],g[d+4>>2]=g[5970],g[d+8>>2]=g[5971],g[d+12>>2]=g[5972],g[5969]=P,g[5970]=B,g[5972]=0,g[5971]=d,d=A+24|0;do fe=d,d=d+4|0,g[d>>2]=7;while((fe+8|0)>>>0<ie>>>0);if((A|0)!=(W|0)){if(P=A-W|0,g[_>>2]=g[_>>2]&-2,g[W+4>>2]=P|1,g[A>>2]=P,d=P>>>3,P>>>0<256){_=23468+(d<<1<<2)|0,A=g[5857]|0,d=1<<d,A&d?(A=_+8|0,d=g[A>>2]|0):(g[5857]=A|d,d=_,A=_+8|0),g[A>>2]=W,g[d+12>>2]=W,g[W+8>>2]=d,g[W+12>>2]=_;break}if(d=P>>>8,d?P>>>0>16777215?b=31:(fe=(d+1048320|0)>>>16&8,ie=d<<fe,ue=(ie+520192|0)>>>16&4,ie=ie<<ue,b=(ie+245760|0)>>>16&2,b=14-(ue|fe|b)+(ie<<b>>>15)|0,b=P>>>(b+7|0)&1|b<<1):b=0,_=23732+(b<<2)|0,g[W+28>>2]=b,g[W+20>>2]=0,g[I>>2]=0,d=g[5858]|0,A=1<<b,!(d&A)){g[5858]=d|A,g[_>>2]=W,g[W+24>>2]=_,g[W+12>>2]=W,g[W+8>>2]=W;break}d=g[_>>2]|0;e:do if((g[d+4>>2]&-8|0)!=(P|0)){for(b=P<<((b|0)==31?0:25-(b>>>1)|0);_=d+16+(b>>>31<<2)|0,A=g[_>>2]|0,!!A;)if((g[A+4>>2]&-8|0)==(P|0)){d=A;break e}else b=b<<1,d=A;g[_>>2]=W,g[W+24>>2]=d,g[W+12>>2]=W,g[W+8>>2]=W;break t}while(!1);fe=d+8|0,ie=g[fe>>2]|0,g[ie+12>>2]=W,g[fe>>2]=W,g[W+8>>2]=ie,g[W+12>>2]=d,g[W+24>>2]=0}}else ie=g[5861]|0,(ie|0)==0|P>>>0<ie>>>0&&(g[5861]=P),g[5969]=P,g[5970]=B,g[5972]=0,g[5866]=g[5975],g[5865]=-1,g[5870]=23468,g[5869]=23468,g[5872]=23476,g[5871]=23476,g[5874]=23484,g[5873]=23484,g[5876]=23492,g[5875]=23492,g[5878]=23500,g[5877]=23500,g[5880]=23508,g[5879]=23508,g[5882]=23516,g[5881]=23516,g[5884]=23524,g[5883]=23524,g[5886]=23532,g[5885]=23532,g[5888]=23540,g[5887]=23540,g[5890]=23548,g[5889]=23548,g[5892]=23556,g[5891]=23556,g[5894]=23564,g[5893]=23564,g[5896]=23572,g[5895]=23572,g[5898]=23580,g[5897]=23580,g[5900]=23588,g[5899]=23588,g[5902]=23596,g[5901]=23596,g[5904]=23604,g[5903]=23604,g[5906]=23612,g[5905]=23612,g[5908]=23620,g[5907]=23620,g[5910]=23628,g[5909]=23628,g[5912]=23636,g[5911]=23636,g[5914]=23644,g[5913]=23644,g[5916]=23652,g[5915]=23652,g[5918]=23660,g[5917]=23660,g[5920]=23668,g[5919]=23668,g[5922]=23676,g[5921]=23676,g[5924]=23684,g[5923]=23684,g[5926]=23692,g[5925]=23692,g[5928]=23700,g[5927]=23700,g[5930]=23708,g[5929]=23708,g[5932]=23716,g[5931]=23716,ie=B+-40|0,ue=P+8|0,ue=ue&7|0?0-ue&7:0,fe=P+ue|0,ue=ie-ue|0,g[5863]=fe,g[5860]=ue,g[fe+4>>2]=ue|1,g[P+ie+4>>2]=40,g[5864]=g[5979];while(!1);if(d=g[5860]|0,d>>>0>mt>>>0)return ue=d-mt|0,g[5860]=ue,ie=g[5863]|0,fe=ie+mt|0,g[5863]=fe,g[fe+4>>2]=ue|1,g[ie+4>>2]=mt|3,ie=ie+8|0,pt=tr,ie|0}return ie=DC()|0,g[ie>>2]=12,ie=0,pt=tr,ie|0}function ni(A){A=A|0;var d=0,_=0,b=0,I=0,P=0,B=0,O=0,W=0;if(A){_=A+-8|0,I=g[5861]|0,A=g[A+-4>>2]|0,d=A&-8,W=_+d|0;do if(A&1)O=_,B=_;else{if(b=g[_>>2]|0,!(A&3)||(B=_+(0-b)|0,P=b+d|0,B>>>0<I>>>0))return;if((g[5862]|0)==(B|0)){if(A=W+4|0,d=g[A>>2]|0,(d&3|0)!=3){O=B,d=P;break}g[5859]=P,g[A>>2]=d&-2,g[B+4>>2]=P|1,g[B+P>>2]=P;return}if(_=b>>>3,b>>>0<256)if(A=g[B+8>>2]|0,d=g[B+12>>2]|0,(d|0)==(A|0)){g[5857]=g[5857]&~(1<<_),O=B,d=P;break}else{g[A+12>>2]=d,g[d+8>>2]=A,O=B,d=P;break}I=g[B+24>>2]|0,A=g[B+12>>2]|0;do if((A|0)==(B|0)){if(d=B+16|0,_=d+4|0,A=g[_>>2]|0,A)d=_;else if(A=g[d>>2]|0,!A){A=0;break}for(;;)if(b=A+20|0,_=g[b>>2]|0,_)A=_,d=b;else if(b=A+16|0,_=g[b>>2]|0,_)A=_,d=b;else break;g[d>>2]=0}else O=g[B+8>>2]|0,g[O+12>>2]=A,g[A+8>>2]=O;while(!1);if(I){if(d=g[B+28>>2]|0,_=23732+(d<<2)|0,(g[_>>2]|0)==(B|0)){if(g[_>>2]=A,!A){g[5858]=g[5858]&~(1<<d),O=B,d=P;break}}else if(O=I+16|0,g[((g[O>>2]|0)==(B|0)?O:I+20|0)>>2]=A,!A){O=B,d=P;break}g[A+24>>2]=I,d=B+16|0,_=g[d>>2]|0,_|0&&(g[A+16>>2]=_,g[_+24>>2]=A),d=g[d+4>>2]|0,d?(g[A+20>>2]=d,g[d+24>>2]=A,O=B,d=P):(O=B,d=P)}else O=B,d=P}while(!1);if(!(B>>>0>=W>>>0)&&(A=W+4|0,b=g[A>>2]|0,!!(b&1))){if(b&2)g[A>>2]=b&-2,g[O+4>>2]=d|1,g[B+d>>2]=d,I=d;else{if((g[5863]|0)==(W|0)){if(W=(g[5860]|0)+d|0,g[5860]=W,g[5863]=O,g[O+4>>2]=W|1,(O|0)!=(g[5862]|0))return;g[5862]=0,g[5859]=0;return}if((g[5862]|0)==(W|0)){W=(g[5859]|0)+d|0,g[5859]=W,g[5862]=B,g[O+4>>2]=W|1,g[B+W>>2]=W;return}I=(b&-8)+d|0,_=b>>>3;do if(b>>>0<256)if(d=g[W+8>>2]|0,A=g[W+12>>2]|0,(A|0)==(d|0)){g[5857]=g[5857]&~(1<<_);break}else{g[d+12>>2]=A,g[A+8>>2]=d;break}else{P=g[W+24>>2]|0,A=g[W+12>>2]|0;do if((A|0)==(W|0)){if(d=W+16|0,_=d+4|0,A=g[_>>2]|0,A)d=_;else if(A=g[d>>2]|0,!A){_=0;break}for(;;)if(b=A+20|0,_=g[b>>2]|0,_)A=_,d=b;else if(b=A+16|0,_=g[b>>2]|0,_)A=_,d=b;else break;g[d>>2]=0,_=A}else _=g[W+8>>2]|0,g[_+12>>2]=A,g[A+8>>2]=_,_=A;while(!1);if(P|0){if(A=g[W+28>>2]|0,d=23732+(A<<2)|0,(g[d>>2]|0)==(W|0)){if(g[d>>2]=_,!_){g[5858]=g[5858]&~(1<<A);break}}else if(b=P+16|0,g[((g[b>>2]|0)==(W|0)?b:P+20|0)>>2]=_,!_)break;g[_+24>>2]=P,A=W+16|0,d=g[A>>2]|0,d|0&&(g[_+16>>2]=d,g[d+24>>2]=_),A=g[A+4>>2]|0,A|0&&(g[_+20>>2]=A,g[A+24>>2]=_)}}while(!1);if(g[O+4>>2]=I|1,g[B+I>>2]=I,(O|0)==(g[5862]|0)){g[5859]=I;return}}if(A=I>>>3,I>>>0<256){_=23468+(A<<1<<2)|0,d=g[5857]|0,A=1<<A,d&A?(d=_+8|0,A=g[d>>2]|0):(g[5857]=d|A,A=_,d=_+8|0),g[d>>2]=O,g[A+12>>2]=O,g[O+8>>2]=A,g[O+12>>2]=_;return}A=I>>>8,A?I>>>0>16777215?b=31:(B=(A+1048320|0)>>>16&8,W=A<<B,P=(W+520192|0)>>>16&4,W=W<<P,b=(W+245760|0)>>>16&2,b=14-(P|B|b)+(W<<b>>>15)|0,b=I>>>(b+7|0)&1|b<<1):b=0,A=23732+(b<<2)|0,g[O+28>>2]=b,g[O+20>>2]=0,g[O+16>>2]=0,d=g[5858]|0,_=1<<b;t:do if(!(d&_))g[5858]=d|_,g[A>>2]=O,g[O+24>>2]=A,g[O+12>>2]=O,g[O+8>>2]=O;else{A=g[A>>2]|0;e:do if((g[A+4>>2]&-8|0)!=(I|0)){for(b=I<<((b|0)==31?0:25-(b>>>1)|0);_=A+16+(b>>>31<<2)|0,d=g[_>>2]|0,!!d;)if((g[d+4>>2]&-8|0)==(I|0)){A=d;break e}else b=b<<1,A=d;g[_>>2]=O,g[O+24>>2]=A,g[O+12>>2]=O,g[O+8>>2]=O;break t}while(!1);B=A+8|0,W=g[B>>2]|0,g[W+12>>2]=O,g[B>>2]=O,g[O+8>>2]=W,g[O+12>>2]=A,g[O+24>>2]=0}while(!1);if(W=(g[5865]|0)+-1|0,g[5865]=W,!(W|0)){for(A=23884;A=g[A>>2]|0,A;)A=A+8|0;g[5865]=-1}}}}function $c(A,d){A=A|0,d=d|0;var _=0;return A?(_=ia(d,A)|0,(d|A)>>>0>65535&&(_=((_>>>0)/(A>>>0)|0|0)==(d|0)?_:-1)):_=0,A=sc(_)|0,!A||!(g[A+-4>>2]&3)||Df(A|0,0,_|0)|0,A|0}function Ei(A,d,_,b){return A=A|0,d=d|0,_=_|0,b=b|0,_=A+_>>>0,Si(d+b+(_>>>0<A>>>0|0)>>>0|0),_|0|0}function aa(A,d,_,b){return A=A|0,d=d|0,_=_|0,b=b|0,b=d-b-(_>>>0>A>>>0|0)>>>0,Si(b|0),A-_>>>0|0|0}function K0(A){return A=A|0,(A?31-(Oc(A^A-1)|0)|0:32)|0}function J0(A,d,_,b,I){A=A|0,d=d|0,_=_|0,b=b|0,I=I|0;var P=0,B=0,O=0,W=0,Q=0,nt=0,mt=0,Vt=0,Yt=0,zt=0;if(nt=A,W=d,Q=W,B=_,Vt=b,O=Vt,!Q)return P=(I|0)!=0,O?P?(g[I>>2]=A|0,g[I+4>>2]=d&0,Vt=0,I=0,Si(Vt|0),I|0):(Vt=0,I=0,Si(Vt|0),I|0):(P&&(g[I>>2]=(nt>>>0)%(B>>>0),g[I+4>>2]=0),Vt=0,I=(nt>>>0)/(B>>>0)>>>0,Si(Vt|0),I|0);P=(O|0)==0;do if(B){if(!P){if(P=(Oc(O|0)|0)-(Oc(Q|0)|0)|0,P>>>0<=31){mt=P+1|0,O=31-P|0,d=P-31>>31,B=mt,A=nt>>>(mt>>>0)&d|Q<<O,d=Q>>>(mt>>>0)&d,P=0,O=nt<<O;break}return I?(g[I>>2]=A|0,g[I+4>>2]=W|d&0,Vt=0,I=0,Si(Vt|0),I|0):(Vt=0,I=0,Si(Vt|0),I|0)}if(P=B-1|0,P&B|0){O=(Oc(B|0)|0)+33-(Oc(Q|0)|0)|0,zt=64-O|0,mt=32-O|0,W=mt>>31,Yt=O-32|0,d=Yt>>31,B=O,A=mt-1>>31&Q>>>(Yt>>>0)|(Q<<mt|nt>>>(O>>>0))&d,d=d&Q>>>(O>>>0),P=nt<<zt&W,O=(Q<<zt|nt>>>(Yt>>>0))&W|nt<<mt&O-33>>31;break}return I|0&&(g[I>>2]=P&nt,g[I+4>>2]=0),(B|0)==1?(Yt=W|d&0,zt=A|0|0,Si(Yt|0),zt|0):(zt=K0(B|0)|0,Yt=Q>>>(zt>>>0)|0,zt=Q<<32-zt|nt>>>(zt>>>0)|0,Si(Yt|0),zt|0)}else{if(P)return I|0&&(g[I>>2]=(Q>>>0)%(B>>>0),g[I+4>>2]=0),Yt=0,zt=(Q>>>0)/(B>>>0)>>>0,Si(Yt|0),zt|0;if(!nt)return I|0&&(g[I>>2]=0,g[I+4>>2]=(Q>>>0)%(O>>>0)),Yt=0,zt=(Q>>>0)/(O>>>0)>>>0,Si(Yt|0),zt|0;if(P=O-1|0,!(P&O))return I|0&&(g[I>>2]=A|0,g[I+4>>2]=P&Q|d&0),Yt=0,zt=Q>>>((K0(O|0)|0)>>>0),Si(Yt|0),zt|0;if(P=(Oc(O|0)|0)-(Oc(Q|0)|0)|0,P>>>0<=30){d=P+1|0,O=31-P|0,B=d,A=Q<<O|nt>>>(d>>>0),d=Q>>>(d>>>0),P=0,O=nt<<O;break}return I?(g[I>>2]=A|0,g[I+4>>2]=W|d&0,Yt=0,zt=0,Si(Yt|0),zt|0):(Yt=0,zt=0,Si(Yt|0),zt|0)}while(!1);if(!B)Q=O,W=0,O=0;else{mt=_|0|0,nt=Vt|b&0,Q=Ei(mt|0,nt|0,-1,-1)|0,_=wt()|0,W=O,O=0;do b=W,W=P>>>31|W<<1,P=O|P<<1,b=A<<1|b>>>31|0,Vt=A>>>31|d<<1|0,aa(Q|0,_|0,b|0,Vt|0)|0,zt=wt()|0,Yt=zt>>31|((zt|0)<0?-1:0)<<1,O=Yt&1,A=aa(b|0,Vt|0,Yt&mt|0,(((zt|0)<0?-1:0)>>31|((zt|0)<0?-1:0)<<1)&nt|0)|0,d=wt()|0,B=B-1|0;while(B|0);Q=W,W=0}return B=0,I|0&&(g[I>>2]=A,g[I+4>>2]=d),Yt=(P|0)>>>31|(Q|B)<<1|(B<<1|P>>>31)&0|W,zt=(P<<1|0)&-2|O,Si(Yt|0),zt|0}function wu(A,d,_,b){A=A|0,d=d|0,_=_|0,b=b|0;var I=0,P=0,B=0,O=0,W=0,Q=0;return Q=d>>31|((d|0)<0?-1:0)<<1,W=((d|0)<0?-1:0)>>31|((d|0)<0?-1:0)<<1,P=b>>31|((b|0)<0?-1:0)<<1,I=((b|0)<0?-1:0)>>31|((b|0)<0?-1:0)<<1,O=aa(Q^A|0,W^d|0,Q|0,W|0)|0,B=wt()|0,A=P^Q,d=I^W,aa((J0(O,B,aa(P^_|0,I^b|0,P|0,I|0)|0,wt()|0,0)|0)^A|0,(wt()|0)^d|0,A|0,d|0)|0}function NT(A,d){A=A|0,d=d|0;var _=0,b=0,I=0,P=0;return P=A&65535,I=d&65535,_=ia(I,P)|0,b=A>>>16,A=(_>>>16)+(ia(I,b)|0)|0,I=d>>>16,d=ia(I,P)|0,Si((A>>>16)+(ia(I,b)|0)+(((A&65535)+d|0)>>>16)|0),A+d<<16|_&65535|0|0}function Ho(A,d,_,b){A=A|0,d=d|0,_=_|0,b=b|0;var I=0,P=0;return I=A,P=_,_=NT(I,P)|0,A=wt()|0,Si((ia(d,P)|0)+(ia(b,I)|0)+A|A&0|0),_|0|0|0}function K_(A,d,_,b){A=A|0,d=d|0,_=_|0,b=b|0;var I=0,P=0,B=0,O=0,W=0,Q=0;return I=pt,pt=pt+16|0,O=I|0,B=d>>31|((d|0)<0?-1:0)<<1,P=((d|0)<0?-1:0)>>31|((d|0)<0?-1:0)<<1,Q=b>>31|((b|0)<0?-1:0)<<1,W=((b|0)<0?-1:0)>>31|((b|0)<0?-1:0)<<1,A=aa(B^A|0,P^d|0,B|0,P|0)|0,d=wt()|0,J0(A,d,aa(Q^_|0,W^b|0,Q|0,W|0)|0,wt()|0,O)|0,b=aa(g[O>>2]^B|0,g[O+4>>2]^P|0,B|0,P|0)|0,_=wt()|0,pt=I,Si(_|0),b|0}function Xs(A,d,_,b){A=A|0,d=d|0,_=_|0,b=b|0;var I=0,P=0;return P=pt,pt=pt+16|0,I=P|0,J0(A,d,_,b,I)|0,pt=P,Si(g[I+4>>2]|0),g[I>>2]|0|0}function ud(A,d,_){return A=A|0,d=d|0,_=_|0,(_|0)<32?(Si(d>>_|0),A>>>_|(d&(1<<_)-1)<<32-_):(Si(((d|0)<0?-1:0)|0),d>>_-32|0)}function De(A,d,_){return A=A|0,d=d|0,_=_|0,(_|0)<32?(Si(d>>>_|0),A>>>_|(d&(1<<_)-1)<<32-_):(Si(0),d>>>_-32|0)}function Ge(A,d,_){return A=A|0,d=d|0,_=_|0,(_|0)<32?(Si(d<<_|(A&(1<<_)-1<<32-_)>>>32-_|0),A<<_):(Si(A<<_-32|0),0)}function tA(A,d){return A=+A,d=+d,A!=A?+d:d!=d?+A:+cb(+A,+d)}function Ab(A,d){return A=+A,d=+d,A!=A?+d:d!=d?+A:+bh(+A,+d)}function hd(A){return A=+A,A>=0?+is(A+.5):+Jl(A-.5)}function J_(A,d,_){A=A|0,d=d|0,_=_|0;var b=0,I=0,P=0;if((_|0)>=8192)return F_(A|0,d|0,_|0)|0,A|0;if(P=A|0,I=A+_|0,(A&3)==(d&3)){for(;A&3;){if(!_)return P|0;Pr[A>>0]=Pr[d>>0]|0,A=A+1|0,d=d+1|0,_=_-1|0}for(_=I&-4|0,b=_-64|0;(A|0)<=(b|0);)g[A>>2]=g[d>>2],g[A+4>>2]=g[d+4>>2],g[A+8>>2]=g[d+8>>2],g[A+12>>2]=g[d+12>>2],g[A+16>>2]=g[d+16>>2],g[A+20>>2]=g[d+20>>2],g[A+24>>2]=g[d+24>>2],g[A+28>>2]=g[d+28>>2],g[A+32>>2]=g[d+32>>2],g[A+36>>2]=g[d+36>>2],g[A+40>>2]=g[d+40>>2],g[A+44>>2]=g[d+44>>2],g[A+48>>2]=g[d+48>>2],g[A+52>>2]=g[d+52>>2],g[A+56>>2]=g[d+56>>2],g[A+60>>2]=g[d+60>>2],A=A+64|0,d=d+64|0;for(;(A|0)<(_|0);)g[A>>2]=g[d>>2],A=A+4|0,d=d+4|0}else for(_=I-4|0;(A|0)<(_|0);)Pr[A>>0]=Pr[d>>0]|0,Pr[A+1>>0]=Pr[d+1>>0]|0,Pr[A+2>>0]=Pr[d+2>>0]|0,Pr[A+3>>0]=Pr[d+3>>0]|0,A=A+4|0,d=d+4|0;for(;(A|0)<(I|0);)Pr[A>>0]=Pr[d>>0]|0,A=A+1|0,d=d+1|0;return P|0}function Df(A,d,_){A=A|0,d=d|0,_=_|0;var b=0,I=0,P=0,B=0;if(P=A+_|0,d=d&255,(_|0)>=67){for(;A&3;)Pr[A>>0]=d,A=A+1|0;for(b=P&-4|0,B=d|d<<8|d<<16|d<<24,I=b-64|0;(A|0)<=(I|0);)g[A>>2]=B,g[A+4>>2]=B,g[A+8>>2]=B,g[A+12>>2]=B,g[A+16>>2]=B,g[A+20>>2]=B,g[A+24>>2]=B,g[A+28>>2]=B,g[A+32>>2]=B,g[A+36>>2]=B,g[A+40>>2]=B,g[A+44>>2]=B,g[A+48>>2]=B,g[A+52>>2]=B,g[A+56>>2]=B,g[A+60>>2]=B,A=A+64|0;for(;(A|0)<(b|0);)g[A>>2]=B,A=A+4|0}for(;(A|0)<(P|0);)Pr[A>>0]=d,A=A+1|0;return P-_|0}function mb(A){return A=+A,A>=0?+is(A+.5):+Jl(A-.5)}function Mh(A){A=A|0;var d=0,_=0,b=0;return b=N_()|0,_=g[Vr>>2]|0,d=_+A|0,(A|0)>0&(d|0)<(_|0)|(d|0)<0?(V0(d|0)|0,U0(12),-1):(d|0)>(b|0)&&!(ed(d|0)|0)?(U0(12),-1):(g[Vr>>2]=d,_|0)}return{___divdi3:wu,___muldi3:Ho,___remdi3:K_,___uremdi3:Xs,_areNeighborCells:W_,_bitshift64Ashr:ud,_bitshift64Lshr:De,_bitshift64Shl:Ge,_calloc:$c,_cellAreaKm2:Mi,_cellAreaM2:ui,_cellAreaRads2:pn,_cellToBoundary:J,_cellToCenterChild:tg,_cellToChildPos:Ct,_cellToChildren:cd,_cellToChildrenSize:Vc,_cellToLatLng:X,_cellToLocalIj:bu,_cellToParent:qn,_cellToVertex:Il,_cellToVertexes:Fs,_cellsToDirectedEdge:Sa,_cellsToLinkedMultiPolygon:wa,_childPosToCell:_t,_compactCells:eg,_destroyLinkedMultiPolygon:vs,_directedEdgeToBoundary:ad,_directedEdgeToCells:q_,_edgeLengthKm:bs,_edgeLengthM:Ln,_edgeLengthRads:Di,_emscripten_replace_memory:L_,_free:ni,_getBaseCellNumber:xu,_getDirectedEdgeDestination:X0,_getDirectedEdgeOrigin:Wn,_getHexagonAreaAvgKm2:Fe,_getHexagonAreaAvgM2:ur,_getHexagonEdgeLengthAvgKm:ki,_getHexagonEdgeLengthAvgM:We,_getIcosahedronFaces:lt,_getNumCells:Ir,_getPentagons:yt,_getRes0Cells:Lc,_getResolution:X_,_greatCircleDistanceKm:ce,_greatCircleDistanceM:xe,_greatCircleDistanceRads:he,_gridDisk:id,_gridDiskDistances:mu,_gridDistance:Cf,_gridPathCells:_o,_gridPathCellsSize:Do,_gridRingUnsafe:z_,_i64Add:Ei,_i64Subtract:aa,_isPentagon:wn,_isResClassIII:ig,_isValidCell:Gn,_isValidDirectedEdge:Jm,_isValidVertex:DT,_latLngToCell:L,_llvm_maxnum_f64:tA,_llvm_minnum_f64:Ab,_llvm_round_f64:hd,_localIjToCell:Sh,_malloc:sc,_maxFaceCount:tt,_maxGridDiskSize:rd,_maxPolygonToCellsSize:U_,_memcpy:J_,_memset:Df,_originToDirectedEdges:Y_,_pentagonCount:bt,_polygonToCells:tc,_readInt64AsDoubleFromPointer:nc,_res0CellCount:Fc,_round:mb,_sbrk:Mh,_sizeOfCellBoundary:Q0,_sizeOfCoordIJ:ng,_sizeOfGeoLoop:Z_,_sizeOfGeoPolygon:G_,_sizeOfH3Index:Ts,_sizeOfLatLng:Eh,_sizeOfLinkedGeoPolygon:fb,_uncompactCells:Mf,_uncompactCellsSize:rg,_vertexToLatLng:pb,establishStackSpace:vf,stackAlloc:cs,stackRestore:na,stackSave:vh}}(Rt,Bt,Xt),qt=t.___divdi3=St.___divdi3,Lt=t.___muldi3=St.___muldi3,Qt=t.___remdi3=St.___remdi3,_e=t.___uremdi3=St.___uremdi3,ye=t._areNeighborCells=St._areNeighborCells,be=t._bitshift64Ashr=St._bitshift64Ashr,xr=t._bitshift64Lshr=St._bitshift64Lshr,Or=t._bitshift64Shl=St._bitshift64Shl,lr=t._calloc=St._calloc,br=t._cellAreaKm2=St._cellAreaKm2,Ur=t._cellAreaM2=St._cellAreaM2,an=t._cellAreaRads2=St._cellAreaRads2,gn=t._cellToBoundary=St._cellToBoundary,Ui=t._cellToCenterChild=St._cellToCenterChild,di=t._cellToChildPos=St._cellToChildPos,Is=t._cellToChildren=St._cellToChildren,fn=t._cellToChildrenSize=St._cellToChildrenSize,rs=t._cellToLatLng=St._cellToLatLng,Os=t._cellToLocalIj=St._cellToLocalIj,va=t._cellToParent=St._cellToParent,Pm=t._cellToVertex=St._cellToVertex,Zl=t._cellToVertexes=St._cellToVertexes,to=t._cellsToDirectedEdge=St._cellsToDirectedEdge,_h=t._cellsToLinkedMultiPolygon=St._cellsToLinkedMultiPolygon,Hi=t._childPosToCell=St._childPosToCell,Qa=t._compactCells=St._compactCells,Dc=t._destroyLinkedMultiPolygon=St._destroyLinkedMultiPolygon,$n=t._directedEdgeToBoundary=St._directedEdgeToBoundary,_s=t._directedEdgeToCells=St._directedEdgeToCells,Rm=t._edgeLengthKm=St._edgeLengthKm,ea=t._edgeLengthM=St._edgeLengthM,Ms=t._edgeLengthRads=St._edgeLengthRads,ko=t._emscripten_replace_memory=St._emscripten_replace_memory,Gl=t._free=St._free,Fn=t._getBaseCellNumber=St._getBaseCellNumber,Ki=t._getDirectedEdgeDestination=St._getDirectedEdgeDestination,Ql=t._getDirectedEdgeOrigin=St._getDirectedEdgeOrigin,Hn=t._getHexagonAreaAvgKm2=St._getHexagonAreaAvgKm2,du=t._getHexagonAreaAvgM2=St._getHexagonAreaAvgM2,Cs=t._getHexagonEdgeLengthAvgKm=St._getHexagonEdgeLengthAvgKm,B0=t._getHexagonEdgeLengthAvgM=St._getHexagonEdgeLengthAvgM,Kl=t._getIcosahedronFaces=St._getIcosahedronFaces,Xp=t._getNumCells=St._getNumCells,Zp=t._getPentagons=St._getPentagons,Gp=t._getRes0Cells=St._getRes0Cells,Qp=t._getResolution=St._getResolution,ut=t._greatCircleDistanceKm=St._greatCircleDistanceKm,gt=t._greatCircleDistanceM=St._greatCircleDistanceM,$t=t._greatCircleDistanceRads=St._greatCircleDistanceRads,pe=t._gridDisk=St._gridDisk,Oe=t._gridDiskDistances=St._gridDiskDistances,ar=t._gridDistance=St._gridDistance,Ri=t._gridPathCells=St._gridPathCells,Ns=t._gridPathCellsSize=St._gridPathCellsSize,eo=t._gridRingUnsafe=St._gridRingUnsafe,mo=t._i64Add=St._i64Add,Ka=t._i64Subtract=St._i64Subtract,km=t._isPentagon=St._isPentagon,nb=t._isResClassIII=St._isResClassIII,sb=t._isValidCell=St._isValidCell,M_=t._isValidDirectedEdge=St._isValidDirectedEdge,C_=t._isValidVertex=St._isValidVertex,yf=t._latLngToCell=St._latLngToCell,Dm=t._llvm_maxnum_f64=St._llvm_maxnum_f64,wl=t._llvm_minnum_f64=St._llvm_minnum_f64,Bm=t._llvm_round_f64=St._llvm_round_f64,Om=t._localIjToCell=St._localIjToCell,O0=t._malloc=St._malloc,Nm=t._maxFaceCount=St._maxFaceCount,Kp=t._maxGridDiskSize=St._maxGridDiskSize,yh=t._maxPolygonToCellsSize=St._maxPolygonToCellsSize,qi=t._memcpy=St._memcpy,Fm=t._memset=St._memset,Ja=t._originToDirectedEdges=St._originToDirectedEdges,tl=t._pentagonCount=St._pentagonCount,P_=t._polygonToCells=St._polygonToCells,Lm=t._readInt64AsDoubleFromPointer=St._readInt64AsDoubleFromPointer,zm=t._res0CellCount=St._res0CellCount,R_=t._round=St._round,k_=t._sbrk=St._sbrk,Um=t._sizeOfCellBoundary=St._sizeOfCellBoundary,D_=t._sizeOfCoordIJ=St._sizeOfCoordIJ,B_=t._sizeOfGeoLoop=St._sizeOfGeoLoop,Vm=t._sizeOfGeoPolygon=St._sizeOfGeoPolygon,ob=t._sizeOfH3Index=St._sizeOfH3Index,ab=t._sizeOfLatLng=St._sizeOfLatLng,Jp=t._sizeOfLinkedGeoPolygon=St._sizeOfLinkedGeoPolygon,CT=t._uncompactCells=St._uncompactCells,PT=t._uncompactCellsSize=St._uncompactCellsSize,RT=t._vertexToLatLng=St._vertexToLatLng,kT=t.establishStackSpace=St.establishStackSpace,O_=t.stackAlloc=St.stackAlloc,lb=t.stackRestore=St.stackRestore,jm=t.stackSave=St.stackSave;if(t.asm=St,t.cwrap=Y,t.setValue=N,t.getValue=z,Uo){Xa(Uo)||(Uo=o(Uo));{pu("memory initializer");var xf=function(se){se.byteLength&&(se=new Uint8Array(se)),jt.set(se,D),t.memoryInitializerRequest&&delete t.memoryInitializerRequest.response,bl("memory initializer")},N0=function(){c(Uo,xf,function(){throw"could not load memory initializer "+Uo})},F0=At(Uo);if(F0)xf(F0.buffer);else if(t.memoryInitializerRequest){var xh=function(){var se=t.memoryInitializerRequest,we=se.response;if(se.status!==200&&se.status!==0){var $e=At(t.memoryInitializerRequestURL);if($e)we=$e.buffer;else{console.warn("a problem seems to have happened with Module.memoryInitializerRequest, status: "+se.status+", retrying "+Uo),N0();return}}xf(we)};t.memoryInitializerRequest.response?setTimeout(xh,0):t.memoryInitializerRequest.addEventListener("load",xh)}else N0()}}var td;Ro=function se(){td||L0(),td||(Ro=se)};function L0(se){if(se=se||s,Qi>0||(jr(),Qi>0))return;function we(){td||(td=!0,!U&&(Ie(),Ji(),t.onRuntimeInitialized&&t.onRuntimeInitialized(),yi()))}t.setStatus?(t.setStatus("Running..."),setTimeout(function(){setTimeout(function(){t.setStatus("")},1),we()},1)):we()}t.run=L0;function Bc(se){throw t.onAbort&&t.onAbort(se),se+="",f(se),p(se),U=!0,"abort("+se+"). Build with -s ASSERTIONS=1 for more info."}if(t.abort=Bc,t.preInit)for(typeof t.preInit=="function"&&(t.preInit=[t.preInit]);t.preInit.length>0;)t.preInit.pop()();return L0(),e}(typeof me=="object"?me:{}),Vi="number",hi=Vi,bw=Vi,xi=Vi,bi=Vi,ul=Vi,Er=Vi,C1t=[["sizeOfH3Index",Vi],["sizeOfLatLng",Vi],["sizeOfCellBoundary",Vi],["sizeOfGeoLoop",Vi],["sizeOfGeoPolygon",Vi],["sizeOfLinkedGeoPolygon",Vi],["sizeOfCoordIJ",Vi],["readInt64AsDoubleFromPointer",Vi],["isValidCell",bw,[xi,bi]],["latLngToCell",hi,[Vi,Vi,ul,Er]],["cellToLatLng",hi,[xi,bi,Er]],["cellToBoundary",hi,[xi,bi,Er]],["maxGridDiskSize",hi,[Vi,Er]],["gridDisk",hi,[xi,bi,Vi,Er]],["gridDiskDistances",hi,[xi,bi,Vi,Er,Er]],["gridRingUnsafe",hi,[xi,bi,Vi,Er]],["maxPolygonToCellsSize",hi,[Er,ul,Vi,Er]],["polygonToCells",hi,[Er,ul,Vi,Er]],["cellsToLinkedMultiPolygon",hi,[Er,Vi,Er]],["destroyLinkedMultiPolygon",null,[Er]],["compactCells",hi,[Er,Er,Vi,Vi]],["uncompactCells",hi,[Er,Vi,Vi,Er,Vi,ul]],["uncompactCellsSize",hi,[Er,Vi,Vi,ul,Er]],["isPentagon",bw,[xi,bi]],["isResClassIII",bw,[xi,bi]],["getBaseCellNumber",Vi,[xi,bi]],["getResolution",Vi,[xi,bi]],["maxFaceCount",hi,[xi,bi,Er]],["getIcosahedronFaces",hi,[xi,bi,Er]],["cellToParent",hi,[xi,bi,ul,Er]],["cellToChildren",hi,[xi,bi,ul,Er]],["cellToCenterChild",hi,[xi,bi,ul,Er]],["cellToChildrenSize",hi,[xi,bi,ul,Er]],["cellToChildPos",hi,[xi,bi,ul,Er]],["childPosToCell",hi,[Vi,Vi,xi,bi,ul,Er]],["areNeighborCells",hi,[xi,bi,xi,bi,Er]],["cellsToDirectedEdge",hi,[xi,bi,xi,bi,Er]],["getDirectedEdgeOrigin",hi,[xi,bi,Er]],["getDirectedEdgeDestination",hi,[xi,bi,Er]],["isValidDirectedEdge",bw,[xi,bi]],["directedEdgeToCells",hi,[xi,bi,Er]],["originToDirectedEdges",hi,[xi,bi,Er]],["directedEdgeToBoundary",hi,[xi,bi,Er]],["gridDistance",hi,[xi,bi,xi,bi,Er]],["gridPathCells",hi,[xi,bi,xi,bi,Er]],["gridPathCellsSize",hi,[xi,bi,xi,bi,Er]],["cellToLocalIj",hi,[xi,bi,xi,bi,Vi,Er]],["localIjToCell",hi,[xi,bi,Er,Vi,Er]],["getHexagonAreaAvgM2",hi,[ul,Er]],["getHexagonAreaAvgKm2",hi,[ul,Er]],["getHexagonEdgeLengthAvgM",hi,[ul,Er]],["getHexagonEdgeLengthAvgKm",hi,[ul,Er]],["greatCircleDistanceM",Vi,[Er,Er]],["greatCircleDistanceKm",Vi,[Er,Er]],["greatCircleDistanceRads",Vi,[Er,Er]],["cellAreaM2",hi,[xi,bi,Er]],["cellAreaKm2",hi,[xi,bi,Er]],["cellAreaRads2",hi,[xi,bi,Er]],["edgeLengthM",hi,[xi,bi,Er]],["edgeLengthKm",hi,[xi,bi,Er]],["edgeLengthRads",hi,[xi,bi,Er]],["getNumCells",hi,[ul,Er]],["getRes0Cells",hi,[Er]],["res0CellCount",Vi],["getPentagons",hi,[Vi,Er]],["pentagonCount",Vi],["cellToVertex",hi,[xi,bi,Vi,Er]],["cellToVertexes",hi,[xi,bi,Er]],["vertexToLatLng",hi,[xi,bi,Er]],["isValidVertex",bw,[xi,bi]]],P1t=0,R1t=1,k1t=2,D1t=3,pW=4,dW=5,B1t=6,O1t=7,N1t=8,F1t=9,L1t=10,z1t=11,U1t=12,V1t=13,j1t=14,$1t=15,Oa={};Oa[P1t]="Success";Oa[R1t]="The operation failed but a more specific error is not available";Oa[k1t]="Argument was outside of acceptable range";Oa[D1t]="Latitude or longitude arguments were outside of acceptable range";Oa[pW]="Resolution argument was outside of acceptable range";Oa[dW]="Cell argument was not valid";Oa[B1t]="Directed edge argument was not valid";Oa[O1t]="Undirected edge argument was not valid";Oa[N1t]="Vertex argument was not valid";Oa[F1t]="Pentagon distortion was encountered";Oa[L1t]="Duplicate input";Oa[z1t]="Cell arguments were not neighbors";Oa[U1t]="Cell arguments had incompatible resolutions";Oa[V1t]="Memory allocation failed";Oa[j1t]="Bounds of provided memory were insufficient";Oa[$1t]="Mode or flags argument was not valid";var Wy=1e3,AW=1001,mW=1002,rE={};rE[Wy]="Unknown unit";rE[AW]="Array length out of bounds";rE[mW]="Got unexpected null value for H3 index";var H1t="Unknown error";function gW(e,t,r){var i=r&&"value"in r,s=new Error((e[t]||H1t)+" (code: "+t+(i?", value: "+r.value:"")+")");return s.code=t,s}function j7(e,t){var r=arguments.length===2?{value:t}:{};return gW(Oa,e,r)}function qg(e,t){var r=arguments.length===2?{value:t}:{};return gW(rE,e,r)}function fi(e){if(e!==0)throw j7(e)}var or={};C1t.forEach(function(t){or[t[0]]=me.cwrap.apply(me,t)});var Hy=16,tE=0,Nl=4,cW=4,Zc=8,Rd=8,fs=or.sizeOfH3Index(),ww=or.sizeOfLatLng(),_W=or.sizeOfCellBoundary(),W1t=or.sizeOfGeoPolygon(),vw=or.sizeOfGeoLoop(),q1t=or.sizeOfLinkedGeoPolygon(),yW=or.sizeOfCoordIJ(),fc={m:"m",m2:"m2",km:"km",km2:"km2",rads:"rads",rads2:"rads2"};function qy(e){if(typeof e!="number"||e<0||e>15||Math.floor(e)!==e)throw j7(pW,e);return e}function kd(e){if(!e)throw qg(mW);return e}var Y1t=Math.pow(2,32)-1;function Yy(e){if(e>Y1t)throw qg(AW,e);return e}var X1t=/[^0-9a-fA-F]/;function Wi(e){if(Array.isArray(e)&&e.length===2&&Number.isInteger(e[0])&&Number.isInteger(e[1]))return e;if(typeof e!="string"||X1t.test(e))return[0,0];var t=parseInt(e.substring(0,e.length-8),Hy),r=parseInt(e.substring(e.length-8),Hy);return[r,t]}function uW(e){if(e>=0)return e.toString(Hy);e=e&2147483647;var t=bW(8,e.toString(Hy)),r=(parseInt(t[0],Hy)+8).toString(Hy);return t=r+t.substring(1),t}function xW(e,t){return uW(t)+bW(8,uW(e))}function bW(e,t){for(var r=e-t.length,i="",s=0;s<r;s++)i+="0";return i=i+t,i}var Z1t=Math.pow(2,32);function G1t(e){return typeof e!="number"?[0,0]:[e|0,e/Z1t|0]}function hW(e,t,r){for(var i=e.length,s=me._calloc(i,ww),n=r?1:0,o=r?0:1,c=0;c<i*2;c+=2)me.HEAPF64.set([e[c/2][n],e[c/2][o]].map(sE),s/Zc+c);return me.HEAPU32.set([i,s],t/Nl),t}function Q1t(e,t){var r=e.length-1,i=me._calloc(W1t),s=0,n=s+vw,o=n+Nl;hW(e[0],i+s,t);var c;if(r>0){c=me._calloc(r,vw);for(var f=0;f<r;f++)hW(e[f+1],c+vw*f,t)}return me.setValue(i+n,r,"i32"),me.setValue(i+o,c,"i32"),i}function K1t(e){var t=0,r=t+vw,i=r+Nl,s=Nl;me._free(me.getValue(e+t+s,"i8*"));var n=me.getValue(e+r,"i32");if(n>0){for(var o=me.getValue(e+i,"i32"),c=0;c<n;c++)me._free(me.getValue(o+vw*c+s,"i8*"));me._free(o)}me._free(e)}function $h(e,t){t===void 0&&(t=0);var r=me.getValue(e+fs*t,"i32"),i=me.getValue(e+fs*t+Nl,"i32");return i?xW(r,i):null}function J1t(e,t){t===void 0&&(t=0);var r=me.getValue(e+Nl*t,"i32");return!!r}function iE(e,t){return t===void 0&&(t=0),me.getValue(e+Zc*t,"double")}function Dd(e){return or.readInt64AsDoubleFromPointer(e)}function t_t(e,t,r){me.HEAPU32.set(Wi(e),t/Nl+2*r)}function Uu(e,t){for(var r=[],i=0;i<t;i++){var s=$h(e,i);s!==null&&r.push(s)}return r}function $7(e,t){for(var r=t.length,i=0;i<r;i++)t_t(t[i],e,i)}function fW(e,t){var r=me._calloc(1,ww);return me.HEAPF64.set([e,t].map(sE),r/Zc),r}function eE(e){return EW(me.getValue(e,"double"))}function nE(e){return[eE(e),eE(e+Zc)]}function vW(e){return[eE(e+Zc),eE(e)]}function wW(e,t,r){for(var i=me.getValue(e,"i32"),s=e+Zc,n=[],o=t?vW:nE,c=0;c<i*2;c+=2)n.push(o(s+Zc*c));return r&&n.push(n[0]),n}function e_t(e,t){for(var r=[],i=t?vW:nE,s,n,o,c;e;){for(r.push(s=[]),n=me.getValue(e,"i8*");n;){for(s.push(o=[]),c=me.getValue(n,"i8*");c;)o.push(i(c)),c=me.getValue(c+Zc*2,"i8*");t&&o.push(o[0]),n=me.getValue(n+cW*2,"i8*")}e=me.getValue(e+cW*2,"i8*")}return r}function r_t(e){return{i:me.getValue(e,"i32"),j:me.getValue(e+Nl,"i32")}}function i_t(e,t){var r=t.i,i=t.j;me.setValue(e,r,"i32"),me.setValue(e+Nl,i,"i32")}function n_t(e,t){for(var r=[],i=0;i<t;i++){var s=me.getValue(e+Nl*i,"i32");s>=0&&r.push(s)}return r}function H7(e){var t=Wi(e),r=t[0],i=t[1];return!!or.isValidCell(r,i)}function W7(e){var t=Wi(e),r=t[0],i=t[1];return!!or.isPentagon(r,i)}function s_t(e){var t=Wi(e),r=t[0],i=t[1];return!!or.isResClassIII(r,i)}function o_t(e){var t=Wi(e),r=t[0],i=t[1];return or.getBaseCellNumber(r,i)}function a_t(e){var t=Wi(e),r=t[0],i=t[1],s=me._malloc(Nl);try{fi(or.maxFaceCount(r,i,s));var n=me.getValue(s,"i32"),o=me._malloc(Nl*n);try{return fi(or.getIcosahedronFaces(r,i,o)),n_t(o,n)}finally{me._free(o)}}finally{me._free(s)}}function Yg(e){var t=Wi(e),r=t[0],i=t[1];return or.isValidCell(r,i)?or.getResolution(r,i):-1}function Tw(e,t,r){var i=me._malloc(ww);me.HEAPF64.set([e,t].map(sE),i/Zc);var s=me._malloc(fs);try{return fi(or.latLngToCell(i,r,s)),kd($h(s))}finally{me._free(s),me._free(i)}}function Xy(e){var t=me._malloc(ww),r=Wi(e),i=r[0],s=r[1];try{return fi(or.cellToLatLng(i,s,t)),nE(t)}finally{me._free(t)}}function q7(e,t){var r=me._malloc(_W),i=Wi(e),s=i[0],n=i[1];try{return fi(or.cellToBoundary(s,n,r)),wW(r,t,t)}finally{me._free(r)}}function Y7(e,t){var r=Wi(e),i=r[0],s=r[1],n=me._malloc(fs);try{return fi(or.cellToParent(i,s,t,n)),kd($h(n))}finally{me._free(n)}}function l_t(e,t){if(!H7(e))return[];var r=Wi(e),i=r[0],s=r[1],n=Yy(TW(e,t)),o=me._calloc(n,fs);try{return fi(or.cellToChildren(i,s,t,o)),Uu(o,n)}finally{me._free(o)}}function TW(e,t){if(!H7(e))throw j7(dW);var r=Wi(e),i=r[0],s=r[1],n=me._malloc(Rd);try{return fi(or.cellToChildrenSize(i,s,t,n)),Dd(n)}finally{me._free(n)}}function c_t(e,t){var r=Wi(e),i=r[0],s=r[1],n=me._malloc(fs);try{return fi(or.cellToCenterChild(i,s,t,n)),kd($h(n))}finally{me._free(n)}}function u_t(e,t){var r=Wi(e),i=r[0],s=r[1],n=me._malloc(Rd);try{return fi(or.cellToChildPos(i,s,t,n)),Dd(n)}finally{me._free(n)}}function h_t(e,t,r){var i=G1t(e),s=i[0],n=i[1],o=Wi(t),c=o[0],f=o[1],p=me._malloc(fs);try{return fi(or.childPosToCell(s,n,c,f,r,p)),kd($h(p))}finally{me._free(p)}}function Sw(e,t){var r=Wi(e),i=r[0],s=r[1],n=me._malloc(Rd);try{fi(or.maxGridDiskSize(t,n));var o=Yy(Dd(n)),c=me._calloc(o,fs);try{return fi(or.gridDisk(i,s,t,c)),Uu(c,o)}finally{me._free(c)}}finally{me._free(n)}}function f_t(e,t){var r=Wi(e),i=r[0],s=r[1],n=me._malloc(Rd);try{fi(or.maxGridDiskSize(t,n));var o=Yy(Dd(n)),c=me._calloc(o,fs),f=me._calloc(o,Nl);try{fi(or.gridDiskDistances(i,s,t,c,f));for(var p=[],x=0;x<t+1;x++)p.push([]);for(var E=0;E<o;E++){var T=$h(c,E),D=me.getValue(f+Nl*E,"i32");T!==null&&p[D].push(T)}return p}finally{me._free(c),me._free(f)}}finally{me._free(n)}}function p_t(e,t){var r=t===0?1:6*t,i=me._calloc(r,fs);try{return fi(or.gridRingUnsafe.apply(or,Wi(e).concat([t],[i]))),Uu(i,r)}finally{me._free(i)}}function d_t(e,t,r){if(qy(t),r=!!r,e.length===0||e[0].length===0)return[];var i=typeof e[0][0]=="number"?[e]:e,s=Q1t(i,r),n=me._malloc(Rd);try{fi(or.maxPolygonToCellsSize(s,t,0,n));var o=Yy(Dd(n)),c=me._calloc(o,fs);try{return fi(or.polygonToCells(s,t,0,c)),Uu(c,o)}finally{me._free(c)}}finally{me._free(n),K1t(s)}}function A_t(e,t){if(!e||!e.length)return[];var r=e.length,i=me._calloc(r,fs);$7(i,e);var s=me._calloc(q1t);try{return fi(or.cellsToLinkedMultiPolygon(i,r,s)),e_t(s,t)}finally{or.destroyLinkedMultiPolygon(s),me._free(s),me._free(i)}}function m_t(e){if(!e||!e.length)return[];var t=e.length,r=me._calloc(t,fs);$7(r,e);var i=me._calloc(t,fs);try{return fi(or.compactCells(r,i,t,tE)),Uu(i,t)}finally{me._free(r),me._free(i)}}function g_t(e,t){if(qy(t),!e||!e.length)return[];var r=e.length,i=me._calloc(r,fs);$7(i,e);var s=me._malloc(Rd);try{fi(or.uncompactCellsSize(i,r,tE,t,s));var n=Yy(Dd(s)),o=me._calloc(n,fs);try{return fi(or.uncompactCells(i,r,tE,o,n,tE,t)),Uu(o,n)}finally{me._free(i),me._free(o)}}finally{me._free(s)}}function __t(e,t){var r=Wi(e),i=r[0],s=r[1],n=Wi(t),o=n[0],c=n[1],f=me._malloc(Nl);try{return fi(or.areNeighborCells(i,s,o,c,f)),J1t(f)}finally{me._free(f)}}function y_t(e,t){var r=Wi(e),i=r[0],s=r[1],n=Wi(t),o=n[0],c=n[1],f=me._malloc(fs);try{return fi(or.cellsToDirectedEdge(i,s,o,c,f)),kd($h(f))}finally{me._free(f)}}function x_t(e){var t=Wi(e),r=t[0],i=t[1],s=me._malloc(fs);try{return fi(or.getDirectedEdgeOrigin(r,i,s)),kd($h(s))}finally{me._free(s)}}function b_t(e){var t=Wi(e),r=t[0],i=t[1],s=me._malloc(fs);try{return fi(or.getDirectedEdgeDestination(r,i,s)),kd($h(s))}finally{me._free(s)}}function v_t(e){var t=Wi(e),r=t[0],i=t[1];return!!or.isValidDirectedEdge(r,i)}function w_t(e){var t=Wi(e),r=t[0],i=t[1],s=2,n=me._calloc(s,fs);try{return fi(or.directedEdgeToCells(r,i,n)),Uu(n,s)}finally{me._free(n)}}function T_t(e){var t=Wi(e),r=t[0],i=t[1],s=6,n=me._calloc(s,fs);try{return fi(or.originToDirectedEdges(r,i,n)),Uu(n,s)}finally{me._free(n)}}function S_t(e,t){var r=me._malloc(_W),i=Wi(e),s=i[0],n=i[1];try{return fi(or.directedEdgeToBoundary(s,n,r)),wW(r,t)}finally{me._free(r)}}function Zy(e,t){var r=Wi(e),i=r[0],s=r[1],n=Wi(t),o=n[0],c=n[1],f=me._malloc(Rd);try{return fi(or.gridDistance(i,s,o,c,f)),Dd(f)}finally{me._free(f)}}function E_t(e,t){var r=Wi(e),i=r[0],s=r[1],n=Wi(t),o=n[0],c=n[1],f=me._malloc(Rd);try{fi(or.gridPathCellsSize(i,s,o,c,f));var p=Yy(Dd(f)),x=me._calloc(p,fs);try{return or.gridPathCells(i,s,o,c,x),Uu(x,p)}finally{me._free(x)}}finally{me._free(f)}}var SW=0;function I_t(e,t){var r=me._malloc(yW);try{return fi(or.cellToLocalIj.apply(or,Wi(e).concat(Wi(t),[SW],[r]))),r_t(r)}finally{me._free(r)}}function M_t(e,t){if(!t||typeof t.i!="number"||typeof t.j!="number")throw new Error("Coordinates must be provided as an {i, j} object");var r=me._malloc(yW),i=me._malloc(fs);i_t(r,t);try{return fi(or.localIjToCell.apply(or,Wi(e).concat([r],[SW],[i]))),kd($h(i))}finally{me._free(r),me._free(i)}}function C_t(e,t,r){var i=fW(e[0],e[1]),s=fW(t[0],t[1]),n;switch(r){case fc.m:n=or.greatCircleDistanceM(i,s);break;case fc.km:n=or.greatCircleDistanceKm(i,s);break;case fc.rads:n=or.greatCircleDistanceRads(i,s);break;default:n=null}if(me._free(i),me._free(s),n===null)throw qg(Wy,r);return n}function P_t(e,t){var r=Wi(e),i=r[0],s=r[1],n=me._malloc(Zc);try{switch(t){case fc.m2:fi(or.cellAreaM2(i,s,n));break;case fc.km2:fi(or.cellAreaKm2(i,s,n));break;case fc.rads2:fi(or.cellAreaRads2(i,s,n));break;default:throw qg(Wy,t)}return iE(n)}finally{me._free(n)}}function R_t(e,t){var r=Wi(e),i=r[0],s=r[1],n=me._malloc(Zc);try{switch(t){case fc.m:fi(or.edgeLengthM(i,s,n));break;case fc.km:fi(or.edgeLengthKm(i,s,n));break;case fc.rads:fi(or.edgeLengthRads(i,s,n));break;default:throw qg(Wy,t)}return iE(n)}finally{me._free(n)}}function X7(e,t){qy(e);var r=me._malloc(Zc);try{switch(t){case fc.m2:fi(or.getHexagonAreaAvgM2(e,r));break;case fc.km2:fi(or.getHexagonAreaAvgKm2(e,r));break;default:throw qg(Wy,t)}return iE(r)}finally{me._free(r)}}function Ew(e,t){qy(e);var r=me._malloc(Zc);try{switch(t){case fc.m:fi(or.getHexagonEdgeLengthAvgM(e,r));break;case fc.km:fi(or.getHexagonEdgeLengthAvgKm(e,r));break;default:throw qg(Wy,t)}return iE(r)}finally{me._free(r)}}function k_t(e,t){var r=Wi(e),i=r[0],s=r[1],n=me._malloc(fs);try{return fi(or.cellToVertex(i,s,t,n)),kd($h(n))}finally{me._free(n)}}function D_t(e){var t=Wi(e),r=t[0],i=t[1],s=6,n=me._calloc(s,fs);try{return fi(or.cellToVertexes(r,i,n)),Uu(n,s)}finally{me._free(n)}}function B_t(e){var t=me._malloc(ww),r=Wi(e),i=r[0],s=r[1];try{return fi(or.vertexToLatLng(i,s,t)),nE(t)}finally{me._free(t)}}function O_t(e){var t=Wi(e),r=t[0],i=t[1];return!!or.isValidVertex(r,i)}function N_t(e){qy(e);var t=me._malloc(Rd);try{return fi(or.getNumCells(e,t)),Dd(t)}finally{me._free(t)}}function F_t(){var e=or.res0CellCount(),t=me._malloc(fs*e);try{return fi(or.getRes0Cells(t)),Uu(t,e)}finally{me._free(t)}}function L_t(e){qy(e);var t=or.pentagonCount(),r=me._malloc(fs*t);try{return fi(or.getPentagons(e,r)),Uu(r,t)}finally{me._free(r)}}function sE(e){return e*Math.PI/180}function EW(e){return e*180/Math.PI}function IW(e,t){t=t===void 0?e[0][0]:t;for(let r of e){let i=r[0]-t;i>180?r[0]-=360:i<-180&&(r[0]+=360)}}function z_t(e,t,r){let[i,s]=Xy(e),n=t.length;IW(t,s);let o=t[0]===t[n-1]?n-1:n;for(let c=0;c<o;c++)t[c][0]=Vf(s,t[c][0],r),t[c][1]=Vf(i,t[c][1],r)}function MW(e,t,r){let i=e(t,r),[s,n]=Xy(i);return[n,s]}function G7(e,t=1){let r=q7(e,!0);return t!==1?z_t(e,r,t):IW(r),r}function CW(e){let t=new Float64Array(e.length*2),r=0;for(let i of e)t[r++]=i[0],t[r++]=i[1];return t}var U_t=10;function V_t(e,t){let r;return e==null?r=t:typeof e=="object"?r={...e,coverage:t}:r={getHexagon:e,coverage:t},r}var j_t={...Wg.defaultProps,highPrecision:"auto",coverage:{type:"number",min:0,max:1,value:1},centerHexagon:null,getHexagon:{type:"accessor",value:e=>e.hexagon},extruded:!0},Xg=class e extends EA{static{this.defaultProps=j_t}static{this.layerName="H3HexagonLayer"}static{this._checkH3Lib=()=>{}}initializeState(){e._checkH3Lib(),this.state={edgeLengthKM:0,resolution:-1}}shouldUpdateState({changeFlags:t}){return this._shouldUseHighPrecision()?t.propsOrDataChanged:t.somethingChanged}updateState({props:t,changeFlags:r}){if(t.highPrecision!==!0&&(r.dataChanged||r.updateTriggersChanged&&r.updateTriggersChanged.getHexagon)){let i=this._calculateH3DataProps();this.setState(i)}this._updateVertices(this.context.viewport)}_calculateH3DataProps(){let t=-1,r=!1,i=!1,{iterable:s,objectInfo:n}=Pd(this.props.data);for(let o of s){n.index++;let c=this.props.getHexagon(o,n),f=Yg(c);if(t<0){if(t=f,!this.props.highPrecision)break}else if(t!==f){i=!0;break}if(W7(c)){r=!0;break}}return{resolution:t,edgeLengthKM:t>=0?Ew(t,"km"):0,hasMultipleRes:i,hasPentagon:r}}_shouldUseHighPrecision(){if(this.props.highPrecision==="auto"){let{resolution:t,hasPentagon:r,hasMultipleRes:i}=this.state,{viewport:s}=this.context;return!!s?.resolution||i||r||t>=0&&t<=5}return this.props.highPrecision}_updateVertices(t){if(this._shouldUseHighPrecision())return;let{resolution:r,edgeLengthKM:i,centerHex:s}=this.state;if(r<0)return;let n=this.props.centerHexagon||Tw(t.latitude,t.longitude,r);if(s===n)return;if(s)try{if(Zy(s,n)*i<U_t)return}catch{}let{unitsPerMeter:o}=t.distanceScales,c=G7(n),[f,p]=Xy(n),[x,E]=t.projectFlat([p,f]);c=c.map(T=>{let D=t.projectFlat(T);return[(D[0]-x)/o[0],(D[1]-E)/o[1]]}),this.setState({centerHex:n,vertices:c})}renderLayers(){return this._shouldUseHighPrecision()?this._renderPolygonLayer():this._renderColumnLayer()}_getForwardProps(){let{elevationScale:t,material:r,coverage:i,extruded:s,wireframe:n,stroked:o,filled:c,lineWidthUnits:f,lineWidthScale:p,lineWidthMinPixels:x,lineWidthMaxPixels:E,getFillColor:T,getElevation:D,getLineColor:N,getLineWidth:z,transitions:U,updateTriggers:H}=this.props;return{elevationScale:t,extruded:s,coverage:i,wireframe:n,stroked:o,filled:c,lineWidthUnits:f,lineWidthScale:p,lineWidthMinPixels:x,lineWidthMaxPixels:E,material:r,getElevation:D,getFillColor:T,getLineColor:N,getLineWidth:z,transitions:U,updateTriggers:{getFillColor:H.getFillColor,getElevation:H.getElevation,getLineColor:H.getLineColor,getLineWidth:H.getLineWidth}}}_renderPolygonLayer(){let{data:t,getHexagon:r,updateTriggers:i,coverage:s}=this.props,n=this.getSubLayerClass("hexagon-cell-hifi",Wg),o=this._getForwardProps();return o.updateTriggers.getPolygon=V_t(i.getHexagon,s),new n(o,this.getSubLayerProps({id:"hexagon-cell-hifi",updateTriggers:o.updateTriggers}),{data:t,_normalize:!1,_windingOrder:"CCW",positionFormat:"XY",getPolygon:(c,f)=>{let p=r(c,f);return CW(G7(p,s))}})}_renderColumnLayer(){let{data:t,getHexagon:r,updateTriggers:i}=this.props,s=this.getSubLayerClass("hexagon-cell",Vy),n=this._getForwardProps();return n.updateTriggers.getPosition=i.getHexagon,new s(n,this.getSubLayerProps({id:"hexagon-cell",flatShading:!0,updateTriggers:n.updateTriggers}),{data:t,diskResolution:6,radius:1,vertices:this.state.vertices,getPosition:MW.bind(null,r)})}};var PW={},Q7={},K7=34,Iw=10,J7=13;function kW(e){return new Function("d","return {"+e.map(function(t,r){return JSON.stringify(t)+": d["+r+'] || ""'}).join(",")+"}")}function $_t(e,t){var r=kW(e);return function(i,s){return t(r(i),s,e)}}function RW(e){var t=Object.create(null),r=[];return e.forEach(function(i){for(var s in i)s in t||r.push(t[s]=s)}),r}function pc(e,t){var r=e+"",i=r.length;return i<t?new Array(t-i+1).join(0)+r:r}function H_t(e){return e<0?"-"+pc(-e,6):e>9999?"+"+pc(e,6):pc(e,4)}function W_t(e){var t=e.getUTCHours(),r=e.getUTCMinutes(),i=e.getUTCSeconds(),s=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":H_t(e.getUTCFullYear(),4)+"-"+pc(e.getUTCMonth()+1,2)+"-"+pc(e.getUTCDate(),2)+(s?"T"+pc(t,2)+":"+pc(r,2)+":"+pc(i,2)+"."+pc(s,3)+"Z":i?"T"+pc(t,2)+":"+pc(r,2)+":"+pc(i,2)+"Z":r||t?"T"+pc(t,2)+":"+pc(r,2)+"Z":"")}function PA(e){var t=new RegExp('["'+e+`
\r]`),r=e.charCodeAt(0);function i(E,T){var D,N,z=s(E,function(U,H){if(D)return D(U,H-1);N=U,D=T?$_t(U,T):kW(U)});return z.columns=N||[],z}function s(E,T){var D=[],N=E.length,z=0,U=0,H,G=N<=0,Z=!1;E.charCodeAt(N-1)===Iw&&--N,E.charCodeAt(N-1)===J7&&--N;function Y(){if(G)return Q7;if(Z)return Z=!1,PW;var at,Dt=z,Tt;if(E.charCodeAt(Dt)===K7){for(;z++<N&&E.charCodeAt(z)!==K7||E.charCodeAt(++z)===K7;);return(at=z)>=N?G=!0:(Tt=E.charCodeAt(z++))===Iw?Z=!0:Tt===J7&&(Z=!0,E.charCodeAt(z)===Iw&&++z),E.slice(Dt+1,at-1).replace(/""/g,'"')}for(;z<N;){if((Tt=E.charCodeAt(at=z++))===Iw)Z=!0;else if(Tt===J7)Z=!0,E.charCodeAt(z)===Iw&&++z;else if(Tt!==r)continue;return E.slice(Dt,at)}return G=!0,E.slice(Dt,N)}for(;(H=Y())!==Q7;){for(var st=[];H!==PW&&H!==Q7;)st.push(H),H=Y();T&&(st=T(st,U++))==null||D.push(st)}return D}function n(E,T){return E.map(function(D){return T.map(function(N){return x(D[N])}).join(e)})}function o(E,T){return T==null&&(T=RW(E)),[T.map(x).join(e)].concat(n(E,T)).join(`
`)}function c(E,T){return T==null&&(T=RW(E)),n(E,T).join(`
`)}function f(E){return E.map(p).join(`
`)}function p(E){return E.map(x).join(e)}function x(E){return E==null?"":E instanceof Date?W_t(E):t.test(E+="")?'"'+E.replace(/"/g,'""')+'"':E}return{parse:i,parseRows:s,format:o,formatBody:c,formatRows:f,formatRow:p,formatValue:x}}var Zg=PA(","),oE=Zg.parse,DW=Zg.parseRows,BW=Zg.format,OW=Zg.formatBody,NW=Zg.formatRows,FW=Zg.formatRow,LW=Zg.formatValue;var Gg=PA("	"),aE=Gg.parse,zW=Gg.parseRows,UW=Gg.format,VW=Gg.formatBody,jW=Gg.formatRows,$W=Gg.formatRow,HW=Gg.formatValue;function tD(e){for(var t in e){var r=e[t].trim(),i,s;if(!r)r=null;else if(r==="true")r=!0;else if(r==="false")r=!1;else if(r==="NaN")r=NaN;else if(!isNaN(i=+r))r=i;else if(s=r.match(/^([-+]\d{2})?\d{4}(-\d{2}(-\d{2})?)?(T\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/))q_t&&s[4]&&!s[7]&&(r=r.replace(/-/g,"/").replace(/T/," ")),r=new Date(r);else continue;e[t]=r}return e}var q_t=new Date("2019-01-01T00:00").getHours()||new Date("2019-07-01T00:00").getHours();var oL=mP(qW());var L9={};sl(L9,{Adder:()=>Kn,Delaunay:()=>f3,FormatSpecifier:()=>p3,InternMap:()=>Hh,InternSet:()=>Ac,Node:()=>fp,Path:()=>Hd,Voronoi:()=>x1,ZoomTransform:()=>Qu,active:()=>rZ,arc:()=>Wtt,area:()=>zI,areaRadial:()=>C9,ascending:()=>dn,autoType:()=>tD,axisBottom:()=>xq,axisLeft:()=>bq,axisRight:()=>yq,axisTop:()=>_q,bin:()=>hE,bisect:()=>dc,bisectCenter:()=>GW,bisectLeft:()=>ZW,bisectRight:()=>iD,bisector:()=>RA,blob:()=>OZ,blur:()=>QW,blur2:()=>lE,blurImage:()=>KW,brush:()=>fZ,brushSelection:()=>cZ,brushX:()=>uZ,brushY:()=>hZ,buffer:()=>NZ,chord:()=>dZ,chordDirected:()=>mZ,chordTranspose:()=>AZ,cluster:()=>XQ,color:()=>gc,contourDensity:()=>CZ,contours:()=>l3,count:()=>Bd,create:()=>hY,creator:()=>DA,cross:()=>sD,csv:()=>LZ,csvFormat:()=>BW,csvFormatBody:()=>OW,csvFormatRow:()=>FW,csvFormatRows:()=>NW,csvFormatValue:()=>LW,csvParse:()=>oE,csvParseRows:()=>DW,cubehelix:()=>hl,cumsum:()=>oD,curveBasis:()=>set,curveBasisClosed:()=>aet,curveBasisOpen:()=>uet,curveBumpX:()=>jI,curveBumpY:()=>$I,curveBundle:()=>fet,curveCardinal:()=>pet,curveCardinalClosed:()=>det,curveCardinalOpen:()=>Aet,curveCatmullRom:()=>get,curveCatmullRomClosed:()=>yet,curveCatmullRomOpen:()=>bet,curveLinear:()=>nm,curveLinearClosed:()=>wet,curveMonotoneX:()=>Pet,curveMonotoneY:()=>Ret,curveNatural:()=>Bet,curveStep:()=>Oet,curveStepAfter:()=>Fet,curveStepBefore:()=>Net,descending:()=>Mw,deviation:()=>Pw,difference:()=>PD,disjoint:()=>RD,dispatch:()=>ju,drag:()=>AY,dragDisable:()=>NA,dragEnable:()=>FA,dsv:()=>SB,dsvFormat:()=>PA,easeBack:()=>aB,easeBackIn:()=>QX,easeBackInOut:()=>aB,easeBackOut:()=>KX,easeBounce:()=>f2,easeBounceIn:()=>ZX,easeBounceInOut:()=>GX,easeBounceOut:()=>f2,easeCircle:()=>nB,easeCircleIn:()=>YX,easeCircleInOut:()=>nB,easeCircleOut:()=>XX,easeCubic:()=>n3,easeCubicIn:()=>FX,easeCubicInOut:()=>n3,easeCubicOut:()=>LX,easeElastic:()=>uB,easeElasticIn:()=>JX,easeElasticInOut:()=>tZ,easeElasticOut:()=>uB,easeExp:()=>iB,easeExpIn:()=>WX,easeExpInOut:()=>iB,easeExpOut:()=>qX,easeLinear:()=>BX,easePoly:()=>eB,easePolyIn:()=>zX,easePolyInOut:()=>eB,easePolyOut:()=>UX,easeQuad:()=>JD,easeQuadIn:()=>OX,easeQuadInOut:()=>JD,easeQuadOut:()=>NX,easeSin:()=>rB,easeSinIn:()=>$X,easeSinInOut:()=>rB,easeSinOut:()=>HX,every:()=>TD,extent:()=>Od,fcumsum:()=>eq,filter:()=>ED,flatGroup:()=>oq,flatRollup:()=>aq,forceCenter:()=>WZ,forceCollide:()=>uG,forceLink:()=>fG,forceManyBody:()=>gG,forceRadial:()=>_G,forceSimulation:()=>mG,forceX:()=>yG,forceY:()=>xG,format:()=>w1,formatDefaultLocale:()=>l6,formatLocale:()=>o6,formatPrefix:()=>A3,formatSpecifier:()=>Gh,fsum:()=>tq,geoAlbers:()=>q6,geoAlbersUsa:()=>BQ,geoArea:()=>BG,geoAzimuthalEqualArea:()=>OQ,geoAzimuthalEqualAreaRaw:()=>X6,geoAzimuthalEquidistant:()=>NQ,geoAzimuthalEquidistantRaw:()=>Z6,geoBounds:()=>jG,geoCentroid:()=>XG,geoCircle:()=>JG,geoClipAntimeridian:()=>S3,geoClipCircle:()=>k6,geoClipExtent:()=>rQ,geoClipRectangle:()=>Gd,geoConicConformal:()=>LQ,geoConicConformalRaw:()=>fO,geoConicEqualArea:()=>R1,geoConicEqualAreaRaw:()=>uO,geoConicEquidistant:()=>UQ,geoConicEquidistantRaw:()=>pO,geoContains:()=>cQ,geoDistance:()=>E2,geoEqualEarth:()=>VQ,geoEqualEarthRaw:()=>K6,geoEquirectangular:()=>zQ,geoEquirectangularRaw:()=>D1,geoGnomonic:()=>jQ,geoGnomonicRaw:()=>J6,geoGraticule:()=>L6,geoGraticule10:()=>fQ,geoIdentity:()=>$Q,geoInterpolate:()=>pQ,geoLength:()=>N6,geoMercator:()=>FQ,geoMercatorRaw:()=>k1,geoNaturalEarth1:()=>HQ,geoNaturalEarth1Raw:()=>tI,geoOrthographic:()=>WQ,geoOrthographicRaw:()=>eI,geoPath:()=>CQ,geoProjection:()=>Io,geoProjectionMutator:()=>k3,geoRotation:()=>E6,geoStereographic:()=>qQ,geoStereographicRaw:()=>rI,geoStream:()=>ma,geoTransform:()=>PQ,geoTransverseMercator:()=>YQ,geoTransverseMercatorRaw:()=>iI,gray:()=>RY,greatest:()=>Nw,greatestIndex:()=>yD,group:()=>Rw,groupSort:()=>uD,groups:()=>lD,hcl:()=>o2,hierarchy:()=>F3,histogram:()=>hE,hsl:()=>n2,html:()=>$Z,image:()=>UZ,index:()=>lq,indexes:()=>cq,interpolate:()=>fl,interpolateArray:()=>$Y,interpolateBasis:()=>RE,interpolateBasisClosed:()=>kE,interpolateBlues:()=>Ett,interpolateBrBG:()=>ott,interpolateBuGn:()=>dtt,interpolateBuPu:()=>Att,interpolateCividis:()=>ktt,interpolateCool:()=>Ott,interpolateCubehelix:()=>nX,interpolateCubehelixDefault:()=>Dtt,interpolateCubehelixLong:()=>h1,interpolateDate:()=>OE,interpolateDiscrete:()=>HY,interpolateGnBu:()=>mtt,interpolateGreens:()=>Itt,interpolateGreys:()=>Mtt,interpolateHcl:()=>eX,interpolateHclLong:()=>rX,interpolateHsl:()=>KY,interpolateHslLong:()=>JY,interpolateHue:()=>WY,interpolateInferno:()=>Vtt,interpolateLab:()=>GD,interpolateMagma:()=>Utt,interpolateNumber:()=>da,interpolateNumberArray:()=>l2,interpolateObject:()=>NE,interpolateOrRd:()=>gtt,interpolateOranges:()=>Rtt,interpolatePRGn:()=>att,interpolatePiYG:()=>ltt,interpolatePlasma:()=>jtt,interpolatePuBu:()=>ytt,interpolatePuBuGn:()=>_tt,interpolatePuOr:()=>ctt,interpolatePuRd:()=>xtt,interpolatePurples:()=>Ctt,interpolateRainbow:()=>Ntt,interpolateRdBu:()=>utt,interpolateRdGy:()=>htt,interpolateRdPu:()=>btt,interpolateRdYlBu:()=>ftt,interpolateRdYlGn:()=>ptt,interpolateReds:()=>Ptt,interpolateRgb:()=>VA,interpolateRgbBasis:()=>DE,interpolateRgbBasisClosed:()=>jY,interpolateRound:()=>jA,interpolateSinebow:()=>Ftt,interpolateSpectral:()=>BI,interpolateString:()=>c2,interpolateTransformCss:()=>zE,interpolateTransformSvg:()=>UE,interpolateTurbo:()=>Ltt,interpolateViridis:()=>ztt,interpolateWarm:()=>Btt,interpolateYlGn:()=>wtt,interpolateYlGnBu:()=>vtt,interpolateYlOrBr:()=>Ttt,interpolateYlOrRd:()=>Stt,interpolateZoom:()=>VE,interrupt:()=>Xh,intersection:()=>kD,interval:()=>cX,isoFormat:()=>WJ,isoParse:()=>qJ,json:()=>VZ,lab:()=>c1,lch:()=>DY,least:()=>_D,leastIndex:()=>Fw,line:()=>H2,lineRadial:()=>M9,link:()=>e4,linkHorizontal:()=>Jtt,linkRadial:()=>eet,linkVertical:()=>tet,local:()=>bE,map:()=>ID,matcher:()=>e2,max:()=>Ld,maxIndex:()=>e1,mean:()=>pD,median:()=>dD,medianIndex:()=>pq,merge:()=>n1,min:()=>kA,minIndex:()=>r1,mode:()=>AD,namespace:()=>tp,namespaces:()=>Vw,nice:()=>Jg,now:()=>$A,pack:()=>yK,packEnclose:()=>uK,packSiblings:()=>mK,pairs:()=>mD,partition:()=>xK,path:()=>a3,pathRound:()=>_Z,permute:()=>kw,pie:()=>Gtt,piecewise:()=>Gw,pointRadial:()=>Z1,pointer:()=>pa,pointers:()=>fY,polygonArea:()=>CK,polygonCentroid:()=>PK,polygonContains:()=>BK,polygonHull:()=>DK,polygonLength:()=>OK,precisionFixed:()=>c6,precisionPrefix:()=>u6,precisionRound:()=>h6,quadtree:()=>YA,quantile:()=>Jf,quantileIndex:()=>pE,quantileSorted:()=>fE,quantize:()=>sX,quickselect:()=>i1,radialArea:()=>C9,radialLine:()=>M9,randomBates:()=>zK,randomBernoulli:()=>jK,randomBeta:()=>hI,randomBinomial:()=>fI,randomCauchy:()=>HK,randomExponential:()=>UK,randomGamma:()=>L2,randomGeometric:()=>uI,randomInt:()=>FK,randomIrwinHall:()=>cI,randomLcg:()=>EO,randomLogNormal:()=>LK,randomLogistic:()=>WK,randomNormal:()=>F2,randomPareto:()=>VK,randomPoisson:()=>qK,randomUniform:()=>NK,randomWeibull:()=>$K,range:()=>Vu,rank:()=>gD,reduce:()=>MD,reverse:()=>CD,rgb:()=>Vd,ribbon:()=>vZ,ribbonArrow:()=>wZ,rollup:()=>cE,rollups:()=>cD,scaleBand:()=>z3,scaleDiverging:()=>kI,scaleDivergingLog:()=>QO,scaleDivergingPow:()=>DI,scaleDivergingSqrt:()=>XJ,scaleDivergingSymlog:()=>KO,scaleIdentity:()=>AI,scaleImplicit:()=>pI,scaleLinear:()=>dI,scaleLog:()=>mI,scaleOrdinal:()=>z2,scalePoint:()=>ZK,scalePow:()=>W3,scaleQuantile:()=>yI,scaleQuantize:()=>xI,scaleRadial:()=>_I,scaleSequential:()=>V2,scaleSequentialLog:()=>ZO,scaleSequentialPow:()=>CI,scaleSequentialQuantile:()=>PI,scaleSequentialSqrt:()=>YJ,scaleSequentialSymlog:()=>GO,scaleSqrt:()=>iJ,scaleSymlog:()=>gI,scaleThreshold:()=>bI,scaleTime:()=>YO,scaleUtc:()=>XO,scan:()=>xD,schemeAccent:()=>GJ,schemeBlues:()=>x9,schemeBrBG:()=>JO,schemeBuGn:()=>l9,schemeBuPu:()=>c9,schemeCategory10:()=>ZJ,schemeDark2:()=>QJ,schemeGnBu:()=>u9,schemeGreens:()=>b9,schemeGreys:()=>v9,schemeObservable10:()=>KJ,schemeOrRd:()=>h9,schemeOranges:()=>S9,schemePRGn:()=>t9,schemePaired:()=>JJ,schemePastel1:()=>ttt,schemePastel2:()=>ett,schemePiYG:()=>e9,schemePuBu:()=>p9,schemePuBuGn:()=>f9,schemePuOr:()=>r9,schemePuRd:()=>d9,schemePurples:()=>w9,schemeRdBu:()=>i9,schemeRdGy:()=>n9,schemeRdPu:()=>A9,schemeRdYlBu:()=>s9,schemeRdYlGn:()=>o9,schemeReds:()=>T9,schemeSet1:()=>rtt,schemeSet2:()=>itt,schemeSet3:()=>ntt,schemeSpectral:()=>a9,schemeTableau10:()=>stt,schemeYlGn:()=>g9,schemeYlGnBu:()=>m9,schemeYlOrBr:()=>_9,schemeYlOrRd:()=>y9,select:()=>lo,selectAll:()=>pY,selection:()=>ep,selector:()=>BA,selectorAll:()=>t2,shuffle:()=>dq,shuffler:()=>bD,some:()=>SD,sort:()=>Jy,stack:()=>Let,stackOffsetDiverging:()=>Uet,stackOffsetExpand:()=>zet,stackOffsetNone:()=>rf,stackOffsetSilhouette:()=>Vet,stackOffsetWiggle:()=>jet,stackOrderAppearance:()=>oM,stackOrderAscending:()=>aM,stackOrderDescending:()=>$et,stackOrderInsideOut:()=>Het,stackOrderNone:()=>nf,stackOrderReverse:()=>Wet,stratify:()=>wK,style:()=>zd,subset:()=>DD,sum:()=>vD,superset:()=>zw,svg:()=>HZ,symbol:()=>B9,symbolAsterisk:()=>HI,symbolCircle:()=>Y2,symbolCross:()=>WI,symbolDiamond:()=>qI,symbolDiamond2:()=>YI,symbolPlus:()=>XI,symbolSquare:()=>ZI,symbolSquare2:()=>GI,symbolStar:()=>QI,symbolTimes:()=>r4,symbolTriangle:()=>KI,symbolTriangle2:()=>JI,symbolWye:()=>tM,symbolX:()=>r4,symbols:()=>D9,symbolsFill:()=>D9,symbolsStroke:()=>net,text:()=>b1,thresholdFreedmanDiaconis:()=>hD,thresholdScott:()=>fD,thresholdSturges:()=>t1,tickFormat:()=>U3,tickIncrement:()=>Wh,tickStep:()=>Kg,ticks:()=>mc,timeDay:()=>mp,timeDays:()=>cJ,timeFormat:()=>K3,timeFormatDefaultLocale:()=>EI,timeFormatLocale:()=>Q3,timeFriday:()=>OO,timeFridays:()=>gJ,timeHour:()=>U1,timeHours:()=>aJ,timeInterval:()=>Jn,timeMillisecond:()=>em,timeMilliseconds:()=>RO,timeMinute:()=>F1,timeMinutes:()=>sJ,timeMonday:()=>$1,timeMondays:()=>pJ,timeMonth:()=>q1,timeMonths:()=>SJ,timeParse:()=>WO,timeSaturday:()=>NO,timeSaturdays:()=>_J,timeSecond:()=>Kc,timeSeconds:()=>kO,timeSunday:()=>gp,timeSundays:()=>FO,timeThursday:()=>Kd,timeThursdays:()=>mJ,timeTickInterval:()=>SI,timeTicks:()=>TI,timeTuesday:()=>DO,timeTuesdays:()=>dJ,timeWednesday:()=>BO,timeWednesdays:()=>AJ,timeWeek:()=>gp,timeWeeks:()=>FO,timeYear:()=>yc,timeYears:()=>IJ,timeout:()=>e3,timer:()=>d1,timerFlush:()=>KD,transition:()=>QE,transpose:()=>Lw,tree:()=>TK,treemap:()=>SK,treemapBinary:()=>EK,treemapDice:()=>pp,treemapResquarify:()=>MK,treemapSlice:()=>JA,treemapSliceDice:()=>IK,treemapSquarify:()=>lI,tsv:()=>zZ,tsvFormat:()=>UW,tsvFormatBody:()=>VW,tsvFormatRow:()=>$W,tsvFormatRows:()=>jW,tsvFormatValue:()=>HW,tsvParse:()=>aE,tsvParseRows:()=>zW,union:()=>BD,unixDay:()=>Y3,unixDays:()=>hJ,utcDay:()=>rm,utcDays:()=>uJ,utcFormat:()=>X1,utcFriday:()=>UO,utcFridays:()=>wJ,utcHour:()=>V1,utcHours:()=>lJ,utcMillisecond:()=>em,utcMilliseconds:()=>RO,utcMinute:()=>L1,utcMinutes:()=>oJ,utcMonday:()=>W1,utcMondays:()=>yJ,utcMonth:()=>Y1,utcMonths:()=>EJ,utcParse:()=>J3,utcSaturday:()=>VO,utcSaturdays:()=>TJ,utcSecond:()=>Kc,utcSeconds:()=>kO,utcSunday:()=>_p,utcSundays:()=>jO,utcThursday:()=>Jd,utcThursdays:()=>vJ,utcTickInterval:()=>wI,utcTicks:()=>vI,utcTuesday:()=>LO,utcTuesdays:()=>xJ,utcWednesday:()=>zO,utcWednesdays:()=>bJ,utcWeek:()=>_p,utcWeeks:()=>jO,utcYear:()=>xc,utcYears:()=>MJ,variance:()=>Cw,window:()=>r2,xml:()=>jZ,zip:()=>wD,zoom:()=>Yet,zoomIdentity:()=>G2,zoomTransform:()=>lM});function dn(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Mw(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function RA(e){let t,r,i;e.length!==2?(t=dn,r=(c,f)=>dn(e(c),f),i=(c,f)=>e(c)-f):(t=e===dn||e===Mw?e:Y_t,r=e,i=e);function s(c,f,p=0,x=c.length){if(p<x){if(t(f,f)!==0)return x;do{let E=p+x>>>1;r(c[E],f)<0?p=E+1:x=E}while(p<x)}return p}function n(c,f,p=0,x=c.length){if(p<x){if(t(f,f)!==0)return x;do{let E=p+x>>>1;r(c[E],f)<=0?p=E+1:x=E}while(p<x)}return p}function o(c,f,p=0,x=c.length){let E=s(c,f,p,x-1);return E>p&&i(c[E-1],f)>-i(c[E],f)?E-1:E}return{left:s,center:o,right:n}}function Y_t(){return 0}function Qg(e){return e===null?NaN:+e}function*YW(e,t){if(t===void 0)for(let r of e)r!=null&&(r=+r)>=r&&(yield r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(i=+i)>=i&&(yield i)}}var XW=RA(dn),iD=XW.right,ZW=XW.left,GW=RA(Qg).center,dc=iD;function QW(e,t){if(!((t=+t)>=0))throw new RangeError("invalid r");let r=e.length;if(!((r=Math.floor(r))>=0))throw new RangeError("invalid length");if(!r||!t)return e;let i=nD(t),s=e.slice();return i(e,s,0,r,1),i(s,e,0,r,1),i(e,s,0,r,1),e}var lE=JW(nD),KW=JW(X_t);function JW(e){return function(t,r,i=r){if(!((r=+r)>=0))throw new RangeError("invalid rx");if(!((i=+i)>=0))throw new RangeError("invalid ry");let{data:s,width:n,height:o}=t;if(!((n=Math.floor(n))>=0))throw new RangeError("invalid width");if(!((o=Math.floor(o!==void 0?o:s.length/n))>=0))throw new RangeError("invalid height");if(!n||!o||!r&&!i)return t;let c=r&&e(r),f=i&&e(i),p=s.slice();return c&&f?(Gy(c,p,s,n,o),Gy(c,s,p,n,o),Gy(c,p,s,n,o),Qy(f,s,p,n,o),Qy(f,p,s,n,o),Qy(f,s,p,n,o)):c?(Gy(c,s,p,n,o),Gy(c,p,s,n,o),Gy(c,s,p,n,o)):f&&(Qy(f,s,p,n,o),Qy(f,p,s,n,o),Qy(f,s,p,n,o)),t}}function Gy(e,t,r,i,s){for(let n=0,o=i*s;n<o;)e(t,r,n,n+=i,1)}function Qy(e,t,r,i,s){for(let n=0,o=i*s;n<i;++n)e(t,r,n,n+o,i)}function X_t(e){let t=nD(e);return(r,i,s,n,o)=>{s<<=2,n<<=2,o<<=2,t(r,i,s+0,n+0,o),t(r,i,s+1,n+1,o),t(r,i,s+2,n+2,o),t(r,i,s+3,n+3,o)}}function nD(e){let t=Math.floor(e);if(t===e)return Z_t(e);let r=e-t,i=2*e+1;return(s,n,o,c,f)=>{if(!((c-=f)>=o))return;let p=t*n[o],x=f*t,E=x+f;for(let T=o,D=o+x;T<D;T+=f)p+=n[Math.min(c,T)];for(let T=o,D=c;T<=D;T+=f)p+=n[Math.min(c,T+x)],s[T]=(p+r*(n[Math.max(o,T-E)]+n[Math.min(c,T+E)]))/i,p-=n[Math.max(o,T-x)]}}function Z_t(e){let t=2*e+1;return(r,i,s,n,o)=>{if(!((n-=o)>=s))return;let c=e*i[s],f=o*e;for(let p=s,x=s+f;p<x;p+=o)c+=i[Math.min(n,p)];for(let p=s,x=n;p<=x;p+=o)c+=i[Math.min(n,p+f)],r[p]=c/t,c-=i[Math.max(s,p-f)]}}function Bd(e,t){let r=0;if(t===void 0)for(let i of e)i!=null&&(i=+i)>=i&&++r;else{let i=-1;for(let s of e)(s=t(s,++i,e))!=null&&(s=+s)>=s&&++r}return r}function G_t(e){return e.length|0}function Q_t(e){return!(e>0)}function K_t(e){return typeof e!="object"||"length"in e?e:Array.from(e)}function J_t(e){return t=>e(...t)}function sD(...e){let t=typeof e[e.length-1]=="function"&&J_t(e.pop());e=e.map(K_t);let r=e.map(G_t),i=e.length-1,s=new Array(i+1).fill(0),n=[];if(i<0||r.some(Q_t))return n;for(;;){n.push(s.map((c,f)=>e[f][c]));let o=i;for(;++s[o]===r[o];){if(o===0)return t?n.map(t):n;s[o--]=0}}}function oD(e,t){var r=0,i=0;return Float64Array.from(e,t===void 0?s=>r+=+s||0:s=>r+=+t(s,i++,e)||0)}function Cw(e,t){let r=0,i,s=0,n=0;if(t===void 0)for(let o of e)o!=null&&(o=+o)>=o&&(i=o-s,s+=i/++r,n+=i*(o-s));else{let o=-1;for(let c of e)(c=t(c,++o,e))!=null&&(c=+c)>=c&&(i=c-s,s+=i/++r,n+=i*(c-s))}if(r>1)return n/(r-1)}function Pw(e,t){let r=Cw(e,t);return r&&Math.sqrt(r)}function Od(e,t){let r,i;if(t===void 0)for(let s of e)s!=null&&(r===void 0?s>=s&&(r=i=s):(r>s&&(r=s),i<s&&(i=s)));else{let s=-1;for(let n of e)(n=t(n,++s,e))!=null&&(r===void 0?n>=n&&(r=i=n):(r>n&&(r=n),i<n&&(i=n)))}return[r,i]}var Kn=class{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){let r=this._partials,i=0;for(let s=0;s<this._n&&s<32;s++){let n=r[s],o=t+n,c=Math.abs(t)<Math.abs(n)?t-(o-n):n-(o-t);c&&(r[i++]=c),t=o}return r[i]=t,this._n=i+1,this}valueOf(){let t=this._partials,r=this._n,i,s,n,o=0;if(r>0){for(o=t[--r];r>0&&(i=o,s=t[--r],o=i+s,n=s-(o-i),!n););r>0&&(n<0&&t[r-1]<0||n>0&&t[r-1]>0)&&(s=n*2,i=o+s,s==i-o&&(o=i))}return o}};function tq(e,t){let r=new Kn;if(t===void 0)for(let i of e)(i=+i)&&r.add(i);else{let i=-1;for(let s of e)(s=+t(s,++i,e))&&r.add(s)}return+r}function eq(e,t){let r=new Kn,i=-1;return Float64Array.from(e,t===void 0?s=>r.add(+s||0):s=>r.add(+t(s,++i,e)||0))}var Hh=class extends Map{constructor(t,r=nq){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(let[i,s]of t)this.set(i,s)}get(t){return super.get(aD(this,t))}has(t){return super.has(aD(this,t))}set(t,r){return super.set(rq(this,t),r)}delete(t){return super.delete(iq(this,t))}},Ac=class extends Set{constructor(t,r=nq){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(let i of t)this.add(i)}has(t){return super.has(aD(this,t))}add(t){return super.add(rq(this,t))}delete(t){return super.delete(iq(this,t))}};function aD({_intern:e,_key:t},r){let i=t(r);return e.has(i)?e.get(i):r}function rq({_intern:e,_key:t},r){let i=t(r);return e.has(i)?e.get(i):(e.set(i,r),r)}function iq({_intern:e,_key:t},r){let i=t(r);return e.has(i)&&(r=e.get(i),e.delete(i)),r}function nq(e){return e!==null&&typeof e=="object"?e.valueOf():e}function Nd(e){return e}function Rw(e,...t){return Ky(e,Nd,Nd,t)}function lD(e,...t){return Ky(e,Array.from,Nd,t)}function sq(e,t){for(let r=1,i=t.length;r<i;++r)e=e.flatMap(s=>s.pop().map(([n,o])=>[...s,n,o]));return e}function oq(e,...t){return sq(lD(e,...t),t)}function aq(e,t,...r){return sq(cD(e,t,...r),r)}function cE(e,t,...r){return Ky(e,Nd,t,r)}function cD(e,t,...r){return Ky(e,Array.from,t,r)}function lq(e,...t){return Ky(e,Nd,uq,t)}function cq(e,...t){return Ky(e,Array.from,uq,t)}function uq(e){if(e.length!==1)throw new Error("duplicate key");return e[0]}function Ky(e,t,r,i){return function s(n,o){if(o>=i.length)return r(n);let c=new Hh,f=i[o++],p=-1;for(let x of n){let E=f(x,++p,n),T=c.get(E);T?T.push(x):c.set(E,[x])}for(let[x,E]of c)c.set(x,s(E,o));return t(c)}(e,0)}function kw(e,t){return Array.from(t,r=>e[r])}function Jy(e,...t){if(typeof e[Symbol.iterator]!="function")throw new TypeError("values is not iterable");e=Array.from(e);let[r]=t;if(r&&r.length!==2||t.length>1){let i=Uint32Array.from(e,(s,n)=>n);return t.length>1?(t=t.map(s=>e.map(s)),i.sort((s,n)=>{for(let o of t){let c=Fd(o[s],o[n]);if(c)return c}})):(r=e.map(r),i.sort((s,n)=>Fd(r[s],r[n]))),kw(e,i)}return e.sort(Dw(r))}function Dw(e=dn){if(e===dn)return Fd;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{let i=e(t,r);return i||i===0?i:(e(r,r)===0)-(e(t,t)===0)}}function Fd(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}function uD(e,t,r){return(t.length!==2?Jy(cE(e,t,r),([i,s],[n,o])=>dn(s,o)||dn(i,n)):Jy(Rw(e,r),([i,s],[n,o])=>t(s,o)||dn(i,n))).map(([i])=>i)}var hq=Array.prototype,fq=hq.slice,OWt=hq.map;function Bw(e){return()=>e}var tyt=Math.sqrt(50),eyt=Math.sqrt(10),ryt=Math.sqrt(2);function uE(e,t,r){let i=(t-e)/Math.max(0,r),s=Math.floor(Math.log10(i)),n=i/Math.pow(10,s),o=n>=tyt?10:n>=eyt?5:n>=ryt?2:1,c,f,p;return s<0?(p=Math.pow(10,-s)/o,c=Math.round(e*p),f=Math.round(t*p),c/p<e&&++c,f/p>t&&--f,p=-p):(p=Math.pow(10,s)*o,c=Math.round(e/p),f=Math.round(t/p),c*p<e&&++c,f*p>t&&--f),f<c&&.5<=r&&r<2?uE(e,t,r*2):[c,f,p]}function mc(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];let i=t<e,[s,n,o]=i?uE(t,e,r):uE(e,t,r);if(!(n>=s))return[];let c=n-s+1,f=new Array(c);if(i)if(o<0)for(let p=0;p<c;++p)f[p]=(n-p)/-o;else for(let p=0;p<c;++p)f[p]=(n-p)*o;else if(o<0)for(let p=0;p<c;++p)f[p]=(s+p)/-o;else for(let p=0;p<c;++p)f[p]=(s+p)*o;return f}function Wh(e,t,r){return t=+t,e=+e,r=+r,uE(e,t,r)[2]}function Kg(e,t,r){t=+t,e=+e,r=+r;let i=t<e,s=i?Wh(t,e,r):Wh(e,t,r);return(i?-1:1)*(s<0?1/-s:s)}function Jg(e,t,r){let i;for(;;){let s=Wh(e,t,r);if(s===i||s===0||!isFinite(s))return[e,t];s>0?(e=Math.floor(e/s)*s,t=Math.ceil(t/s)*s):s<0&&(e=Math.ceil(e*s)/s,t=Math.floor(t*s)/s),i=s}}function t1(e){return Math.max(1,Math.ceil(Math.log(Bd(e))/Math.LN2)+1)}function hE(){var e=Nd,t=Od,r=t1;function i(s){Array.isArray(s)||(s=Array.from(s));var n,o=s.length,c,f,p=new Array(o);for(n=0;n<o;++n)p[n]=e(s[n],n,s);var x=t(p),E=x[0],T=x[1],D=r(p,E,T);if(!Array.isArray(D)){let Z=T,Y=+D;if(t===Od&&([E,T]=Jg(E,T,Y)),D=mc(E,T,Y),D[0]<=E&&(f=Wh(E,T,Y)),D[D.length-1]>=T)if(Z>=T&&t===Od){let st=Wh(E,T,Y);isFinite(st)&&(st>0?T=(Math.floor(T/st)+1)*st:st<0&&(T=(Math.ceil(T*-st)+1)/-st))}else D.pop()}for(var N=D.length,z=0,U=N;D[z]<=E;)++z;for(;D[U-1]>T;)--U;(z||U<N)&&(D=D.slice(z,U),N=U-z);var H=new Array(N+1),G;for(n=0;n<=N;++n)G=H[n]=[],G.x0=n>0?D[n-1]:E,G.x1=n<N?D[n]:T;if(isFinite(f)){if(f>0)for(n=0;n<o;++n)(c=p[n])!=null&&E<=c&&c<=T&&H[Math.min(N,Math.floor((c-E)/f))].push(s[n]);else if(f<0){for(n=0;n<o;++n)if((c=p[n])!=null&&E<=c&&c<=T){let Z=Math.floor((E-c)*f);H[Math.min(N,Z+(D[Z]<=c))].push(s[n])}}}else for(n=0;n<o;++n)(c=p[n])!=null&&E<=c&&c<=T&&H[dc(D,c,0,N)].push(s[n]);return H}return i.value=function(s){return arguments.length?(e=typeof s=="function"?s:Bw(s),i):e},i.domain=function(s){return arguments.length?(t=typeof s=="function"?s:Bw([s[0],s[1]]),i):t},i.thresholds=function(s){return arguments.length?(r=typeof s=="function"?s:Bw(Array.isArray(s)?fq.call(s):s),i):r},i}function Ld(e,t){let r;if(t===void 0)for(let i of e)i!=null&&(r<i||r===void 0&&i>=i)&&(r=i);else{let i=-1;for(let s of e)(s=t(s,++i,e))!=null&&(r<s||r===void 0&&s>=s)&&(r=s)}return r}function e1(e,t){let r,i=-1,s=-1;if(t===void 0)for(let n of e)++s,n!=null&&(r<n||r===void 0&&n>=n)&&(r=n,i=s);else for(let n of e)(n=t(n,++s,e))!=null&&(r<n||r===void 0&&n>=n)&&(r=n,i=s);return i}function kA(e,t){let r;if(t===void 0)for(let i of e)i!=null&&(r>i||r===void 0&&i>=i)&&(r=i);else{let i=-1;for(let s of e)(s=t(s,++i,e))!=null&&(r>s||r===void 0&&s>=s)&&(r=s)}return r}function r1(e,t){let r,i=-1,s=-1;if(t===void 0)for(let n of e)++s,n!=null&&(r>n||r===void 0&&n>=n)&&(r=n,i=s);else for(let n of e)(n=t(n,++s,e))!=null&&(r>n||r===void 0&&n>=n)&&(r=n,i=s);return i}function i1(e,t,r=0,i=1/0,s){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),i=Math.floor(Math.min(e.length-1,i)),!(r<=t&&t<=i))return e;for(s=s===void 0?Fd:Dw(s);i>r;){if(i-r>600){let f=i-r+1,p=t-r+1,x=Math.log(f),E=.5*Math.exp(2*x/3),T=.5*Math.sqrt(x*E*(f-E)/f)*(p-f/2<0?-1:1),D=Math.max(r,Math.floor(t-p*E/f+T)),N=Math.min(i,Math.floor(t+(f-p)*E/f+T));i1(e,t,D,N,s)}let n=e[t],o=r,c=i;for(Ow(e,r,t),s(e[i],n)>0&&Ow(e,r,i);o<c;){for(Ow(e,o,c),++o,--c;s(e[o],n)<0;)++o;for(;s(e[c],n)>0;)--c}s(e[r],n)===0?Ow(e,r,c):(++c,Ow(e,c,i)),c<=t&&(r=c+1),t<=c&&(i=c-1)}return e}function Ow(e,t,r){let i=e[t];e[t]=e[r],e[r]=i}function Nw(e,t=dn){let r,i=!1;if(t.length===1){let s;for(let n of e){let o=t(n);(i?dn(o,s)>0:dn(o,o)===0)&&(r=n,s=o,i=!0)}}else for(let s of e)(i?t(s,r)>0:t(s,s)===0)&&(r=s,i=!0);return r}function Jf(e,t,r){if(e=Float64Array.from(YW(e,r)),!(!(i=e.length)||isNaN(t=+t))){if(t<=0||i<2)return kA(e);if(t>=1)return Ld(e);var i,s=(i-1)*t,n=Math.floor(s),o=Ld(i1(e,n).subarray(0,n+1)),c=kA(e.subarray(n+1));return o+(c-o)*(s-n)}}function fE(e,t,r=Qg){if(!(!(i=e.length)||isNaN(t=+t))){if(t<=0||i<2)return+r(e[0],0,e);if(t>=1)return+r(e[i-1],i-1,e);var i,s=(i-1)*t,n=Math.floor(s),o=+r(e[n],n,e),c=+r(e[n+1],n+1,e);return o+(c-o)*(s-n)}}function pE(e,t,r=Qg){if(!isNaN(t=+t)){if(i=Float64Array.from(e,(c,f)=>Qg(r(e[f],f,e))),t<=0)return r1(i);if(t>=1)return e1(i);var i,s=Uint32Array.from(e,(c,f)=>f),n=i.length-1,o=Math.floor(n*t);return i1(s,o,0,n,(c,f)=>Fd(i[c],i[f])),o=Nw(s.subarray(0,o+1),c=>i[c]),o>=0?o:-1}}function hD(e,t,r){let i=Bd(e),s=Jf(e,.75)-Jf(e,.25);return i&&s?Math.ceil((r-t)/(2*s*Math.pow(i,-1/3))):1}function fD(e,t,r){let i=Bd(e),s=Pw(e);return i&&s?Math.ceil((r-t)*Math.cbrt(i)/(3.49*s)):1}function pD(e,t){let r=0,i=0;if(t===void 0)for(let s of e)s!=null&&(s=+s)>=s&&(++r,i+=s);else{let s=-1;for(let n of e)(n=t(n,++s,e))!=null&&(n=+n)>=n&&(++r,i+=n)}if(r)return i/r}function dD(e,t){return Jf(e,.5,t)}function pq(e,t){return pE(e,.5,t)}function*iyt(e){for(let t of e)yield*t}function n1(e){return Array.from(iyt(e))}function AD(e,t){let r=new Hh;if(t===void 0)for(let n of e)n!=null&&n>=n&&r.set(n,(r.get(n)||0)+1);else{let n=-1;for(let o of e)(o=t(o,++n,e))!=null&&o>=o&&r.set(o,(r.get(o)||0)+1)}let i,s=0;for(let[n,o]of r)o>s&&(s=o,i=n);return i}function mD(e,t=nyt){let r=[],i,s=!1;for(let n of e)s&&r.push(t(i,n)),i=n,s=!0;return r}function nyt(e,t){return[e,t]}function Vu(e,t,r){e=+e,t=+t,r=(s=arguments.length)<2?(t=e,e=0,1):s<3?1:+r;for(var i=-1,s=Math.max(0,Math.ceil((t-e)/r))|0,n=new Array(s);++i<s;)n[i]=e+i*r;return n}function gD(e,t=dn){if(typeof e[Symbol.iterator]!="function")throw new TypeError("values is not iterable");let r=Array.from(e),i=new Float64Array(r.length);t.length!==2&&(r=r.map(t),t=dn);let s=(c,f)=>t(r[c],r[f]),n,o;return e=Uint32Array.from(r,(c,f)=>f),e.sort(t===dn?(c,f)=>Fd(r[c],r[f]):Dw(s)),e.forEach((c,f)=>{let p=s(c,n===void 0?c:n);p>=0?((n===void 0||p>0)&&(n=c,o=f),i[c]=o):i[c]=NaN}),i}function _D(e,t=dn){let r,i=!1;if(t.length===1){let s;for(let n of e){let o=t(n);(i?dn(o,s)<0:dn(o,o)===0)&&(r=n,s=o,i=!0)}}else for(let s of e)(i?t(s,r)<0:t(s,s)===0)&&(r=s,i=!0);return r}function Fw(e,t=dn){if(t.length===1)return r1(e,t);let r,i=-1,s=-1;for(let n of e)++s,(i<0?t(n,n)===0:t(n,r)<0)&&(r=n,i=s);return i}function yD(e,t=dn){if(t.length===1)return e1(e,t);let r,i=-1,s=-1;for(let n of e)++s,(i<0?t(n,n)===0:t(n,r)>0)&&(r=n,i=s);return i}function xD(e,t){let r=Fw(e,t);return r<0?void 0:r}var dq=bD(Math.random);function bD(e){return function(r,i=0,s=r.length){let n=s-(i=+i);for(;n;){let o=e()*n--|0,c=r[n+i];r[n+i]=r[o+i],r[o+i]=c}return r}}function vD(e,t){let r=0;if(t===void 0)for(let i of e)(i=+i)&&(r+=i);else{let i=-1;for(let s of e)(s=+t(s,++i,e))&&(r+=s)}return r}function Lw(e){if(!(n=e.length))return[];for(var t=-1,r=kA(e,syt),i=new Array(r);++t<r;)for(var s=-1,n,o=i[t]=new Array(n);++s<n;)o[s]=e[s][t];return i}function syt(e){return e.length}function wD(){return Lw(arguments)}function TD(e,t){if(typeof t!="function")throw new TypeError("test is not a function");let r=-1;for(let i of e)if(!t(i,++r,e))return!1;return!0}function SD(e,t){if(typeof t!="function")throw new TypeError("test is not a function");let r=-1;for(let i of e)if(t(i,++r,e))return!0;return!1}function ED(e,t){if(typeof t!="function")throw new TypeError("test is not a function");let r=[],i=-1;for(let s of e)t(s,++i,e)&&r.push(s);return r}function ID(e,t){if(typeof e[Symbol.iterator]!="function")throw new TypeError("values is not iterable");if(typeof t!="function")throw new TypeError("mapper is not a function");return Array.from(e,(r,i)=>t(r,i,e))}function MD(e,t,r){if(typeof t!="function")throw new TypeError("reducer is not a function");let i=e[Symbol.iterator](),s,n,o=-1;if(arguments.length<3){if({done:s,value:r}=i.next(),s)return;++o}for(;{done:s,value:n}=i.next(),!s;)r=t(r,n,++o,e);return r}function CD(e){if(typeof e[Symbol.iterator]!="function")throw new TypeError("values is not iterable");return Array.from(e).reverse()}function PD(e,...t){e=new Ac(e);for(let r of t)for(let i of r)e.delete(i);return e}function RD(e,t){let r=t[Symbol.iterator](),i=new Ac;for(let s of e){if(i.has(s))return!1;let n,o;for(;({value:n,done:o}=r.next())&&!o;){if(Object.is(s,n))return!1;i.add(n)}}return!0}function kD(e,...t){e=new Ac(e),t=t.map(oyt);t:for(let r of e)for(let i of t)if(!i.has(r)){e.delete(r);continue t}return e}function oyt(e){return e instanceof Ac?e:new Ac(e)}function zw(e,t){let r=e[Symbol.iterator](),i=new Set;for(let s of t){let n=Aq(s);if(i.has(n))continue;let o,c;for(;{value:o,done:c}=r.next();){if(c)return!1;let f=Aq(o);if(i.add(f),Object.is(n,f))break}}return!0}function Aq(e){return e!==null&&typeof e=="object"?e.valueOf():e}function DD(e,t){return zw(t,e)}function BD(...e){let t=new Ac;for(let r of e)for(let i of r)t.add(i);return t}function mq(e){return e}var dE=1,AE=2,OD=3,Uw=4,gq=1e-6;function ayt(e){return"translate("+e+",0)"}function lyt(e){return"translate(0,"+e+")"}function cyt(e){return t=>+e(t)}function uyt(e,t){return t=Math.max(0,e.bandwidth()-t*2)/2,e.round()&&(t=Math.round(t)),r=>+e(r)+t}function hyt(){return!this.__axis}function mE(e,t){var r=[],i=null,s=null,n=6,o=6,c=3,f=typeof window<"u"&&window.devicePixelRatio>1?0:.5,p=e===dE||e===Uw?-1:1,x=e===Uw||e===AE?"x":"y",E=e===dE||e===OD?ayt:lyt;function T(D){var N=i??(t.ticks?t.ticks.apply(t,r):t.domain()),z=s??(t.tickFormat?t.tickFormat.apply(t,r):mq),U=Math.max(n,0)+c,H=t.range(),G=+H[0]+f,Z=+H[H.length-1]+f,Y=(t.bandwidth?uyt:cyt)(t.copy(),f),st=D.selection?D.selection():D,at=st.selectAll(".domain").data([null]),Dt=st.selectAll(".tick").data(N,t).order(),Tt=Dt.exit(),kt=Dt.enter().append("g").attr("class","tick"),Et=Dt.select("line"),Mt=Dt.select("text");at=at.merge(at.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),Dt=Dt.merge(kt),Et=Et.merge(kt.append("line").attr("stroke","currentColor").attr(x+"2",p*n)),Mt=Mt.merge(kt.append("text").attr("fill","currentColor").attr(x,p*U).attr("dy",e===dE?"0em":e===OD?"0.71em":"0.32em")),D!==st&&(at=at.transition(D),Dt=Dt.transition(D),Et=Et.transition(D),Mt=Mt.transition(D),Tt=Tt.transition(D).attr("opacity",gq).attr("transform",function(oe){return isFinite(oe=Y(oe))?E(oe+f):this.getAttribute("transform")}),kt.attr("opacity",gq).attr("transform",function(oe){var Xt=this.parentNode.__axis;return E((Xt&&isFinite(Xt=Xt(oe))?Xt:Y(oe))+f)})),Tt.remove(),at.attr("d",e===Uw||e===AE?o?"M"+p*o+","+G+"H"+f+"V"+Z+"H"+p*o:"M"+f+","+G+"V"+Z:o?"M"+G+","+p*o+"V"+f+"H"+Z+"V"+p*o:"M"+G+","+f+"H"+Z),Dt.attr("opacity",1).attr("transform",function(oe){return E(Y(oe)+f)}),Et.attr(x+"2",p*n),Mt.attr(x,p*U).text(z),st.filter(hyt).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",e===AE?"start":e===Uw?"end":"middle"),st.each(function(){this.__axis=Y})}return T.scale=function(D){return arguments.length?(t=D,T):t},T.ticks=function(){return r=Array.from(arguments),T},T.tickArguments=function(D){return arguments.length?(r=D==null?[]:Array.from(D),T):r.slice()},T.tickValues=function(D){return arguments.length?(i=D==null?null:Array.from(D),T):i&&i.slice()},T.tickFormat=function(D){return arguments.length?(s=D,T):s},T.tickSize=function(D){return arguments.length?(n=o=+D,T):n},T.tickSizeInner=function(D){return arguments.length?(n=+D,T):n},T.tickSizeOuter=function(D){return arguments.length?(o=+D,T):o},T.tickPadding=function(D){return arguments.length?(c=+D,T):c},T.offset=function(D){return arguments.length?(f=+D,T):f},T}function _q(e){return mE(dE,e)}function yq(e){return mE(AE,e)}function xq(e){return mE(OD,e)}function bq(e){return mE(Uw,e)}var fyt={value:()=>{}};function wq(){for(var e=0,t=arguments.length,r={},i;e<t;++e){if(!(i=arguments[e]+"")||i in r||/[\s.]/.test(i))throw new Error("illegal type: "+i);r[i]=[]}return new gE(r)}function gE(e){this._=e}function pyt(e,t){return e.trim().split(/^|\s+/).map(function(r){var i="",s=r.indexOf(".");if(s>=0&&(i=r.slice(s+1),r=r.slice(0,s)),r&&!t.hasOwnProperty(r))throw new Error("unknown type: "+r);return{type:r,name:i}})}gE.prototype=wq.prototype={constructor:gE,on:function(e,t){var r=this._,i=pyt(e+"",r),s,n=-1,o=i.length;if(arguments.length<2){for(;++n<o;)if((s=(e=i[n]).type)&&(s=dyt(r[s],e.name)))return s;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++n<o;)if(s=(e=i[n]).type)r[s]=vq(r[s],e.name,t);else if(t==null)for(s in r)r[s]=vq(r[s],e.name,null);return this},copy:function(){var e={},t=this._;for(var r in t)e[r]=t[r].slice();return new gE(e)},call:function(e,t){if((s=arguments.length-2)>0)for(var r=new Array(s),i=0,s,n;i<s;++i)r[i]=arguments[i+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(n=this._[e],i=0,s=n.length;i<s;++i)n[i].value.apply(t,r)},apply:function(e,t,r){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var i=this._[e],s=0,n=i.length;s<n;++s)i[s].value.apply(t,r)}};function dyt(e,t){for(var r=0,i=e.length,s;r<i;++r)if((s=e[r]).name===t)return s.value}function vq(e,t,r){for(var i=0,s=e.length;i<s;++i)if(e[i].name===t){e[i]=fyt,e=e.slice(0,i).concat(e.slice(i+1));break}return r!=null&&e.push({name:t,value:r}),e}var ju=wq;var _E="http://www.w3.org/1999/xhtml",Vw={svg:"http://www.w3.org/2000/svg",xhtml:_E,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function tp(e){var t=e+="",r=t.indexOf(":");return r>=0&&(t=e.slice(0,r))!=="xmlns"&&(e=e.slice(r+1)),Vw.hasOwnProperty(t)?{space:Vw[t],local:e}:e}function Ayt(e){return function(){var t=this.ownerDocument,r=this.namespaceURI;return r===_E&&t.documentElement.namespaceURI===_E?t.createElement(e):t.createElementNS(r,e)}}function myt(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function DA(e){var t=tp(e);return(t.local?myt:Ayt)(t)}function gyt(){}function BA(e){return e==null?gyt:function(){return this.querySelector(e)}}function Tq(e){typeof e!="function"&&(e=BA(e));for(var t=this._groups,r=t.length,i=new Array(r),s=0;s<r;++s)for(var n=t[s],o=n.length,c=i[s]=new Array(o),f,p,x=0;x<o;++x)(f=n[x])&&(p=e.call(f,f.__data__,x,n))&&("__data__"in f&&(p.__data__=f.__data__),c[x]=p);return new Rs(i,this._parents)}function jw(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function _yt(){return[]}function t2(e){return e==null?_yt:function(){return this.querySelectorAll(e)}}function yyt(e){return function(){return jw(e.apply(this,arguments))}}function Sq(e){typeof e=="function"?e=yyt(e):e=t2(e);for(var t=this._groups,r=t.length,i=[],s=[],n=0;n<r;++n)for(var o=t[n],c=o.length,f,p=0;p<c;++p)(f=o[p])&&(i.push(e.call(f,f.__data__,p,o)),s.push(f));return new Rs(i,s)}function e2(e){return function(){return this.matches(e)}}function yE(e){return function(t){return t.matches(e)}}var xyt=Array.prototype.find;function byt(e){return function(){return xyt.call(this.children,e)}}function vyt(){return this.firstElementChild}function Eq(e){return this.select(e==null?vyt:byt(typeof e=="function"?e:yE(e)))}var wyt=Array.prototype.filter;function Tyt(){return Array.from(this.children)}function Syt(e){return function(){return wyt.call(this.children,e)}}function Iq(e){return this.selectAll(e==null?Tyt:Syt(typeof e=="function"?e:yE(e)))}function Mq(e){typeof e!="function"&&(e=e2(e));for(var t=this._groups,r=t.length,i=new Array(r),s=0;s<r;++s)for(var n=t[s],o=n.length,c=i[s]=[],f,p=0;p<o;++p)(f=n[p])&&e.call(f,f.__data__,p,n)&&c.push(f);return new Rs(i,this._parents)}function xE(e){return new Array(e.length)}function Cq(){return new Rs(this._enter||this._groups.map(xE),this._parents)}function $w(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}$w.prototype={constructor:$w,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function Pq(e){return function(){return e}}function Eyt(e,t,r,i,s,n){for(var o=0,c,f=t.length,p=n.length;o<p;++o)(c=t[o])?(c.__data__=n[o],i[o]=c):r[o]=new $w(e,n[o]);for(;o<f;++o)(c=t[o])&&(s[o]=c)}function Iyt(e,t,r,i,s,n,o){var c,f,p=new Map,x=t.length,E=n.length,T=new Array(x),D;for(c=0;c<x;++c)(f=t[c])&&(T[c]=D=o.call(f,f.__data__,c,t)+"",p.has(D)?s[c]=f:p.set(D,f));for(c=0;c<E;++c)D=o.call(e,n[c],c,n)+"",(f=p.get(D))?(i[c]=f,f.__data__=n[c],p.delete(D)):r[c]=new $w(e,n[c]);for(c=0;c<x;++c)(f=t[c])&&p.get(T[c])===f&&(s[c]=f)}function Myt(e){return e.__data__}function Rq(e,t){if(!arguments.length)return Array.from(this,Myt);var r=t?Iyt:Eyt,i=this._parents,s=this._groups;typeof e!="function"&&(e=Pq(e));for(var n=s.length,o=new Array(n),c=new Array(n),f=new Array(n),p=0;p<n;++p){var x=i[p],E=s[p],T=E.length,D=Cyt(e.call(x,x&&x.__data__,p,i)),N=D.length,z=c[p]=new Array(N),U=o[p]=new Array(N),H=f[p]=new Array(T);r(x,E,z,U,H,D,t);for(var G=0,Z=0,Y,st;G<N;++G)if(Y=z[G]){for(G>=Z&&(Z=G+1);!(st=U[Z])&&++Z<N;);Y._next=st||null}}return o=new Rs(o,i),o._enter=c,o._exit=f,o}function Cyt(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function kq(){return new Rs(this._exit||this._groups.map(xE),this._parents)}function Dq(e,t,r){var i=this.enter(),s=this,n=this.exit();return typeof e=="function"?(i=e(i),i&&(i=i.selection())):i=i.append(e+""),t!=null&&(s=t(s),s&&(s=s.selection())),r==null?n.remove():r(n),i&&s?i.merge(s).order():s}function Bq(e){for(var t=e.selection?e.selection():e,r=this._groups,i=t._groups,s=r.length,n=i.length,o=Math.min(s,n),c=new Array(s),f=0;f<o;++f)for(var p=r[f],x=i[f],E=p.length,T=c[f]=new Array(E),D,N=0;N<E;++N)(D=p[N]||x[N])&&(T[N]=D);for(;f<s;++f)c[f]=r[f];return new Rs(c,this._parents)}function Oq(){for(var e=this._groups,t=-1,r=e.length;++t<r;)for(var i=e[t],s=i.length-1,n=i[s],o;--s>=0;)(o=i[s])&&(n&&o.compareDocumentPosition(n)^4&&n.parentNode.insertBefore(o,n),n=o);return this}function Nq(e){e||(e=Pyt);function t(E,T){return E&&T?e(E.__data__,T.__data__):!E-!T}for(var r=this._groups,i=r.length,s=new Array(i),n=0;n<i;++n){for(var o=r[n],c=o.length,f=s[n]=new Array(c),p,x=0;x<c;++x)(p=o[x])&&(f[x]=p);f.sort(t)}return new Rs(s,this._parents).order()}function Pyt(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Fq(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function Lq(){return Array.from(this)}function zq(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var i=e[t],s=0,n=i.length;s<n;++s){var o=i[s];if(o)return o}return null}function Uq(){let e=0;for(let t of this)++e;return e}function Vq(){return!this.node()}function jq(e){for(var t=this._groups,r=0,i=t.length;r<i;++r)for(var s=t[r],n=0,o=s.length,c;n<o;++n)(c=s[n])&&e.call(c,c.__data__,n,s);return this}function Ryt(e){return function(){this.removeAttribute(e)}}function kyt(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Dyt(e,t){return function(){this.setAttribute(e,t)}}function Byt(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function Oyt(e,t){return function(){var r=t.apply(this,arguments);r==null?this.removeAttribute(e):this.setAttribute(e,r)}}function Nyt(e,t){return function(){var r=t.apply(this,arguments);r==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,r)}}function $q(e,t){var r=tp(e);if(arguments.length<2){var i=this.node();return r.local?i.getAttributeNS(r.space,r.local):i.getAttribute(r)}return this.each((t==null?r.local?kyt:Ryt:typeof t=="function"?r.local?Nyt:Oyt:r.local?Byt:Dyt)(r,t))}function r2(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function Fyt(e){return function(){this.style.removeProperty(e)}}function Lyt(e,t,r){return function(){this.style.setProperty(e,t,r)}}function zyt(e,t,r){return function(){var i=t.apply(this,arguments);i==null?this.style.removeProperty(e):this.style.setProperty(e,i,r)}}function Hq(e,t,r){return arguments.length>1?this.each((t==null?Fyt:typeof t=="function"?zyt:Lyt)(e,t,r??"")):zd(this.node(),e)}function zd(e,t){return e.style.getPropertyValue(t)||r2(e).getComputedStyle(e,null).getPropertyValue(t)}function Uyt(e){return function(){delete this[e]}}function Vyt(e,t){return function(){this[e]=t}}function jyt(e,t){return function(){var r=t.apply(this,arguments);r==null?delete this[e]:this[e]=r}}function Wq(e,t){return arguments.length>1?this.each((t==null?Uyt:typeof t=="function"?jyt:Vyt)(e,t)):this.node()[e]}function qq(e){return e.trim().split(/^|\s+/)}function ND(e){return e.classList||new Yq(e)}function Yq(e){this._node=e,this._names=qq(e.getAttribute("class")||"")}Yq.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function Xq(e,t){for(var r=ND(e),i=-1,s=t.length;++i<s;)r.add(t[i])}function Zq(e,t){for(var r=ND(e),i=-1,s=t.length;++i<s;)r.remove(t[i])}function $yt(e){return function(){Xq(this,e)}}function Hyt(e){return function(){Zq(this,e)}}function Wyt(e,t){return function(){(t.apply(this,arguments)?Xq:Zq)(this,e)}}function Gq(e,t){var r=qq(e+"");if(arguments.length<2){for(var i=ND(this.node()),s=-1,n=r.length;++s<n;)if(!i.contains(r[s]))return!1;return!0}return this.each((typeof t=="function"?Wyt:t?$yt:Hyt)(r,t))}function qyt(){this.textContent=""}function Yyt(e){return function(){this.textContent=e}}function Xyt(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function Qq(e){return arguments.length?this.each(e==null?qyt:(typeof e=="function"?Xyt:Yyt)(e)):this.node().textContent}function Zyt(){this.innerHTML=""}function Gyt(e){return function(){this.innerHTML=e}}function Qyt(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function Kq(e){return arguments.length?this.each(e==null?Zyt:(typeof e=="function"?Qyt:Gyt)(e)):this.node().innerHTML}function Kyt(){this.nextSibling&&this.parentNode.appendChild(this)}function Jq(){return this.each(Kyt)}function Jyt(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function tY(){return this.each(Jyt)}function eY(e){var t=typeof e=="function"?e:DA(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function t2t(){return null}function rY(e,t){var r=typeof e=="function"?e:DA(e),i=t==null?t2t:typeof t=="function"?t:BA(t);return this.select(function(){return this.insertBefore(r.apply(this,arguments),i.apply(this,arguments)||null)})}function e2t(){var e=this.parentNode;e&&e.removeChild(this)}function iY(){return this.each(e2t)}function r2t(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function i2t(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function nY(e){return this.select(e?i2t:r2t)}function sY(e){return arguments.length?this.property("__data__",e):this.node().__data__}function n2t(e){return function(t){e.call(this,t,this.__data__)}}function s2t(e){return e.trim().split(/^|\s+/).map(function(t){var r="",i=t.indexOf(".");return i>=0&&(r=t.slice(i+1),t=t.slice(0,i)),{type:t,name:r}})}function o2t(e){return function(){var t=this.__on;if(t){for(var r=0,i=-1,s=t.length,n;r<s;++r)n=t[r],(!e.type||n.type===e.type)&&n.name===e.name?this.removeEventListener(n.type,n.listener,n.options):t[++i]=n;++i?t.length=i:delete this.__on}}}function a2t(e,t,r){return function(){var i=this.__on,s,n=n2t(t);if(i){for(var o=0,c=i.length;o<c;++o)if((s=i[o]).type===e.type&&s.name===e.name){this.removeEventListener(s.type,s.listener,s.options),this.addEventListener(s.type,s.listener=n,s.options=r),s.value=t;return}}this.addEventListener(e.type,n,r),s={type:e.type,name:e.name,value:t,listener:n,options:r},i?i.push(s):this.__on=[s]}}function oY(e,t,r){var i=s2t(e+""),s,n=i.length,o;if(arguments.length<2){var c=this.node().__on;if(c){for(var f=0,p=c.length,x;f<p;++f)for(s=0,x=c[f];s<n;++s)if((o=i[s]).type===x.type&&o.name===x.name)return x.value}return}for(c=t?a2t:o2t,s=0;s<n;++s)this.each(c(i[s],t,r));return this}function aY(e,t,r){var i=r2(e),s=i.CustomEvent;typeof s=="function"?s=new s(t,r):(s=i.document.createEvent("Event"),r?(s.initEvent(t,r.bubbles,r.cancelable),s.detail=r.detail):s.initEvent(t,!1,!1)),e.dispatchEvent(s)}function l2t(e,t){return function(){return aY(this,e,t)}}function c2t(e,t){return function(){return aY(this,e,t.apply(this,arguments))}}function lY(e,t){return this.each((typeof t=="function"?c2t:l2t)(e,t))}function*cY(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var i=e[t],s=0,n=i.length,o;s<n;++s)(o=i[s])&&(yield o)}var Hw=[null];function Rs(e,t){this._groups=e,this._parents=t}function uY(){return new Rs([[document.documentElement]],Hw)}function u2t(){return this}Rs.prototype=uY.prototype={constructor:Rs,select:Tq,selectAll:Sq,selectChild:Eq,selectChildren:Iq,filter:Mq,data:Rq,enter:Cq,exit:kq,join:Dq,merge:Bq,selection:u2t,order:Oq,sort:Nq,call:Fq,nodes:Lq,node:zq,size:Uq,empty:Vq,each:jq,attr:$q,style:Hq,property:Wq,classed:Gq,text:Qq,html:Kq,raise:Jq,lower:tY,append:eY,insert:rY,remove:iY,clone:nY,datum:sY,on:oY,dispatch:lY,[Symbol.iterator]:cY};var ep=uY;function lo(e){return typeof e=="string"?new Rs([[document.querySelector(e)]],[document.documentElement]):new Rs([[e]],Hw)}function hY(e){return lo(DA(e).call(document.documentElement))}var h2t=0;function bE(){return new FD}function FD(){this._="@"+(++h2t).toString(36)}FD.prototype=bE.prototype={constructor:FD,get:function(e){for(var t=this._;!(t in e);)if(!(e=e.parentNode))return;return e[t]},set:function(e,t){return e[this._]=t},remove:function(e){return this._ in e&&delete e[this._]},toString:function(){return this._}};function vE(e){let t;for(;t=e.sourceEvent;)e=t;return e}function pa(e,t){if(e=vE(e),t===void 0&&(t=e.currentTarget),t){var r=t.ownerSVGElement||t;if(r.createSVGPoint){var i=r.createSVGPoint();return i.x=e.clientX,i.y=e.clientY,i=i.matrixTransform(t.getScreenCTM().inverse()),[i.x,i.y]}if(t.getBoundingClientRect){var s=t.getBoundingClientRect();return[e.clientX-s.left-t.clientLeft,e.clientY-s.top-t.clientTop]}}return[e.pageX,e.pageY]}function fY(e,t){return e.target&&(e=vE(e),t===void 0&&(t=e.currentTarget),e=e.touches||[e]),Array.from(e,r=>pa(r,t))}function pY(e){return typeof e=="string"?new Rs([document.querySelectorAll(e)],[document.documentElement]):new Rs([jw(e)],Hw)}var dY={passive:!1},s1={capture:!0,passive:!1};function wE(e){e.stopImmediatePropagation()}function OA(e){e.preventDefault(),e.stopImmediatePropagation()}function NA(e){var t=e.document.documentElement,r=lo(e).on("dragstart.drag",OA,s1);"onselectstart"in t?r.on("selectstart.drag",OA,s1):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function FA(e,t){var r=e.document.documentElement,i=lo(e).on("dragstart.drag",null);t&&(i.on("click.drag",OA,s1),setTimeout(function(){i.on("click.drag",null)},0)),"onselectstart"in r?i.on("selectstart.drag",null):(r.style.MozUserSelect=r.__noselect,delete r.__noselect)}var Ww=e=>()=>e;function qw(e,{sourceEvent:t,subject:r,target:i,identifier:s,active:n,x:o,y:c,dx:f,dy:p,dispatch:x}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:r,enumerable:!0,configurable:!0},target:{value:i,enumerable:!0,configurable:!0},identifier:{value:s,enumerable:!0,configurable:!0},active:{value:n,enumerable:!0,configurable:!0},x:{value:o,enumerable:!0,configurable:!0},y:{value:c,enumerable:!0,configurable:!0},dx:{value:f,enumerable:!0,configurable:!0},dy:{value:p,enumerable:!0,configurable:!0},_:{value:x}})}qw.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function f2t(e){return!e.ctrlKey&&!e.button}function p2t(){return this.parentNode}function d2t(e,t){return t??{x:e.x,y:e.y}}function A2t(){return navigator.maxTouchPoints||"ontouchstart"in this}function AY(){var e=f2t,t=p2t,r=d2t,i=A2t,s={},n=ju("start","drag","end"),o=0,c,f,p,x,E=0;function T(Y){Y.on("mousedown.drag",D).filter(i).on("touchstart.drag",U).on("touchmove.drag",H,dY).on("touchend.drag touchcancel.drag",G).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function D(Y,st){if(!(x||!e.call(this,Y,st))){var at=Z(this,t.call(this,Y,st),Y,st,"mouse");at&&(lo(Y.view).on("mousemove.drag",N,s1).on("mouseup.drag",z,s1),NA(Y.view),wE(Y),p=!1,c=Y.clientX,f=Y.clientY,at("start",Y))}}function N(Y){if(OA(Y),!p){var st=Y.clientX-c,at=Y.clientY-f;p=st*st+at*at>E}s.mouse("drag",Y)}function z(Y){lo(Y.view).on("mousemove.drag mouseup.drag",null),FA(Y.view,p),OA(Y),s.mouse("end",Y)}function U(Y,st){if(e.call(this,Y,st)){var at=Y.changedTouches,Dt=t.call(this,Y,st),Tt=at.length,kt,Et;for(kt=0;kt<Tt;++kt)(Et=Z(this,Dt,Y,st,at[kt].identifier,at[kt]))&&(wE(Y),Et("start",Y,at[kt]))}}function H(Y){var st=Y.changedTouches,at=st.length,Dt,Tt;for(Dt=0;Dt<at;++Dt)(Tt=s[st[Dt].identifier])&&(OA(Y),Tt("drag",Y,st[Dt]))}function G(Y){var st=Y.changedTouches,at=st.length,Dt,Tt;for(x&&clearTimeout(x),x=setTimeout(function(){x=null},500),Dt=0;Dt<at;++Dt)(Tt=s[st[Dt].identifier])&&(wE(Y),Tt("end",Y,st[Dt]))}function Z(Y,st,at,Dt,Tt,kt){var Et=n.copy(),Mt=pa(kt||at,st),oe,Xt,xt;if((xt=r.call(Y,new qw("beforestart",{sourceEvent:at,target:T,identifier:Tt,active:o,x:Mt[0],y:Mt[1],dx:0,dy:0,dispatch:Et}),Dt))!=null)return oe=xt.x-Mt[0]||0,Xt=xt.y-Mt[1]||0,function jt(Wt,de,Ee){var Se=Mt,ze;switch(Wt){case"start":s[Tt]=jt,ze=o++;break;case"end":delete s[Tt],--o;case"drag":Mt=pa(Ee||de,st),ze=o;break}Et.call(Wt,Y,new qw(Wt,{sourceEvent:de,subject:xt,target:T,identifier:Tt,active:ze,x:Mt[0]+oe,y:Mt[1]+Xt,dx:Mt[0]-Se[0],dy:Mt[1]-Se[1],dispatch:Et}),Dt)}}return T.filter=function(Y){return arguments.length?(e=typeof Y=="function"?Y:Ww(!!Y),T):e},T.container=function(Y){return arguments.length?(t=typeof Y=="function"?Y:Ww(Y),T):t},T.subject=function(Y){return arguments.length?(r=typeof Y=="function"?Y:Ww(Y),T):r},T.touchable=function(Y){return arguments.length?(i=typeof Y=="function"?Y:Ww(!!Y),T):i},T.on=function(){var Y=n.on.apply(n,arguments);return Y===n?T:Y},T.clickDistance=function(Y){return arguments.length?(E=(Y=+Y)*Y,T):Math.sqrt(E)},T}function Ud(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function LA(e,t){var r=Object.create(e.prototype);for(var i in t)r[i]=t[i];return r}function ip(){}var zA=.7,l1=1/zA,i2="\\s*([+-]?\\d+)\\s*",Yw="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",rp="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",m2t=/^#([0-9a-f]{3,8})$/,g2t=new RegExp(`^rgb\\(${i2},${i2},${i2}\\)$`),_2t=new RegExp(`^rgb\\(${rp},${rp},${rp}\\)$`),y2t=new RegExp(`^rgba\\(${i2},${i2},${i2},${Yw}\\)$`),x2t=new RegExp(`^rgba\\(${rp},${rp},${rp},${Yw}\\)$`),b2t=new RegExp(`^hsl\\(${Yw},${rp},${rp}\\)$`),v2t=new RegExp(`^hsla\\(${Yw},${rp},${rp},${Yw}\\)$`),mY={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Ud(ip,gc,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:gY,formatHex:gY,formatHex8:w2t,formatHsl:T2t,formatRgb:_Y,toString:_Y});function gY(){return this.rgb().formatHex()}function w2t(){return this.rgb().formatHex8()}function T2t(){return TY(this).formatHsl()}function _Y(){return this.rgb().formatRgb()}function gc(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=m2t.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?yY(t):r===3?new No(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?TE(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?TE(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=g2t.exec(e))?new No(t[1],t[2],t[3],1):(t=_2t.exec(e))?new No(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=y2t.exec(e))?TE(t[1],t[2],t[3],t[4]):(t=x2t.exec(e))?TE(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=b2t.exec(e))?vY(t[1],t[2]/100,t[3]/100,1):(t=v2t.exec(e))?vY(t[1],t[2]/100,t[3]/100,t[4]):mY.hasOwnProperty(e)?yY(mY[e]):e==="transparent"?new No(NaN,NaN,NaN,0):null}function yY(e){return new No(e>>16&255,e>>8&255,e&255,1)}function TE(e,t,r,i){return i<=0&&(e=t=r=NaN),new No(e,t,r,i)}function Xw(e){return e instanceof ip||(e=gc(e)),e?(e=e.rgb(),new No(e.r,e.g,e.b,e.opacity)):new No}function Vd(e,t,r,i){return arguments.length===1?Xw(e):new No(e,t,r,i??1)}function No(e,t,r,i){this.r=+e,this.g=+t,this.b=+r,this.opacity=+i}Ud(No,Vd,LA(ip,{brighter(e){return e=e==null?l1:Math.pow(l1,e),new No(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?zA:Math.pow(zA,e),new No(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new No(a1(this.r),a1(this.g),a1(this.b),EE(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:xY,formatHex:xY,formatHex8:S2t,formatRgb:bY,toString:bY}));function xY(){return`#${o1(this.r)}${o1(this.g)}${o1(this.b)}`}function S2t(){return`#${o1(this.r)}${o1(this.g)}${o1(this.b)}${o1((isNaN(this.opacity)?1:this.opacity)*255)}`}function bY(){let e=EE(this.opacity);return`${e===1?"rgb(":"rgba("}${a1(this.r)}, ${a1(this.g)}, ${a1(this.b)}${e===1?")":`, ${e})`}`}function EE(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function a1(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function o1(e){return e=a1(e),(e<16?"0":"")+e.toString(16)}function vY(e,t,r,i){return i<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new qh(e,t,r,i)}function TY(e){if(e instanceof qh)return new qh(e.h,e.s,e.l,e.opacity);if(e instanceof ip||(e=gc(e)),!e)return new qh;if(e instanceof qh)return e;e=e.rgb();var t=e.r/255,r=e.g/255,i=e.b/255,s=Math.min(t,r,i),n=Math.max(t,r,i),o=NaN,c=n-s,f=(n+s)/2;return c?(t===n?o=(r-i)/c+(r<i)*6:r===n?o=(i-t)/c+2:o=(t-r)/c+4,c/=f<.5?n+s:2-n-s,o*=60):c=f>0&&f<1?0:o,new qh(o,c,f,e.opacity)}function n2(e,t,r,i){return arguments.length===1?TY(e):new qh(e,t,r,i??1)}function qh(e,t,r,i){this.h=+e,this.s=+t,this.l=+r,this.opacity=+i}Ud(qh,n2,LA(ip,{brighter(e){return e=e==null?l1:Math.pow(l1,e),new qh(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?zA:Math.pow(zA,e),new qh(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,i=r+(r<.5?r:1-r)*t,s=2*r-i;return new No(LD(e>=240?e-240:e+120,s,i),LD(e,s,i),LD(e<120?e+240:e-120,s,i),this.opacity)},clamp(){return new qh(wY(this.h),SE(this.s),SE(this.l),EE(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){let e=EE(this.opacity);return`${e===1?"hsl(":"hsla("}${wY(this.h)}, ${SE(this.s)*100}%, ${SE(this.l)*100}%${e===1?")":`, ${e})`}`}}));function wY(e){return e=(e||0)%360,e<0?e+360:e}function SE(e){return Math.max(0,Math.min(1,e||0))}function LD(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}var IE=Math.PI/180,ME=180/Math.PI;var CE=18,SY=.96422,EY=1,IY=.82521,MY=4/29,s2=6/29,CY=3*s2*s2,E2t=s2*s2*s2;function PY(e){if(e instanceof Yh)return new Yh(e.l,e.a,e.b,e.opacity);if(e instanceof np)return BY(e);e instanceof No||(e=Xw(e));var t=jD(e.r),r=jD(e.g),i=jD(e.b),s=zD((.2225045*t+.7168786*r+.0606169*i)/EY),n,o;return t===r&&r===i?n=o=s:(n=zD((.4360747*t+.3850649*r+.1430804*i)/SY),o=zD((.0139322*t+.0971045*r+.7141733*i)/IY)),new Yh(116*s-16,500*(n-s),200*(s-o),e.opacity)}function RY(e,t){return new Yh(e,0,0,t??1)}function c1(e,t,r,i){return arguments.length===1?PY(e):new Yh(e,t,r,i??1)}function Yh(e,t,r,i){this.l=+e,this.a=+t,this.b=+r,this.opacity=+i}Ud(Yh,c1,LA(ip,{brighter(e){return new Yh(this.l+CE*(e??1),this.a,this.b,this.opacity)},darker(e){return new Yh(this.l-CE*(e??1),this.a,this.b,this.opacity)},rgb(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,r=isNaN(this.b)?e:e-this.b/200;return t=SY*UD(t),e=EY*UD(e),r=IY*UD(r),new No(VD(3.1338561*t-1.6168667*e-.4906146*r),VD(-.9787684*t+1.9161415*e+.033454*r),VD(.0719453*t-.2289914*e+1.4052427*r),this.opacity)}}));function zD(e){return e>E2t?Math.pow(e,1/3):e/CY+MY}function UD(e){return e>s2?e*e*e:CY*(e-MY)}function VD(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function jD(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function kY(e){if(e instanceof np)return new np(e.h,e.c,e.l,e.opacity);if(e instanceof Yh||(e=PY(e)),e.a===0&&e.b===0)return new np(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*ME;return new np(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function DY(e,t,r,i){return arguments.length===1?kY(e):new np(r,t,e,i??1)}function o2(e,t,r,i){return arguments.length===1?kY(e):new np(e,t,r,i??1)}function np(e,t,r,i){this.h=+e,this.c=+t,this.l=+r,this.opacity=+i}function BY(e){if(isNaN(e.h))return new Yh(e.l,0,0,e.opacity);var t=e.h*IE;return new Yh(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}Ud(np,o2,LA(ip,{brighter(e){return new np(this.h,this.c,this.l+CE*(e??1),this.opacity)},darker(e){return new np(this.h,this.c,this.l-CE*(e??1),this.opacity)},rgb(){return BY(this).rgb()}}));var LY=-.14861,$D=1.78277,HD=-.29227,PE=-.90649,Zw=1.97294,OY=Zw*PE,NY=Zw*$D,FY=$D*HD-PE*LY;function I2t(e){if(e instanceof u1)return new u1(e.h,e.s,e.l,e.opacity);e instanceof No||(e=Xw(e));var t=e.r/255,r=e.g/255,i=e.b/255,s=(FY*i+OY*t-NY*r)/(FY+OY-NY),n=i-s,o=(Zw*(r-s)-HD*n)/PE,c=Math.sqrt(o*o+n*n)/(Zw*s*(1-s)),f=c?Math.atan2(o,n)*ME-120:NaN;return new u1(f<0?f+360:f,c,s,e.opacity)}function hl(e,t,r,i){return arguments.length===1?I2t(e):new u1(e,t,r,i??1)}function u1(e,t,r,i){this.h=+e,this.s=+t,this.l=+r,this.opacity=+i}Ud(u1,hl,LA(ip,{brighter(e){return e=e==null?l1:Math.pow(l1,e),new u1(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?zA:Math.pow(zA,e),new u1(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=isNaN(this.h)?0:(this.h+120)*IE,t=+this.l,r=isNaN(this.s)?0:this.s*t*(1-t),i=Math.cos(e),s=Math.sin(e);return new No(255*(t+r*(LY*i+$D*s)),255*(t+r*(HD*i+PE*s)),255*(t+r*(Zw*i)),this.opacity)}}));function WD(e,t,r,i,s){var n=e*e,o=n*e;return((1-3*e+3*n-o)*t+(4-6*n+3*o)*r+(1+3*e+3*n-3*o)*i+o*s)/6}function RE(e){var t=e.length-1;return function(r){var i=r<=0?r=0:r>=1?(r=1,t-1):Math.floor(r*t),s=e[i],n=e[i+1],o=i>0?e[i-1]:2*s-n,c=i<t-1?e[i+2]:2*n-s;return WD((r-i/t)*t,o,s,n,c)}}function kE(e){var t=e.length;return function(r){var i=Math.floor(((r%=1)<0?++r:r)*t),s=e[(i+t-1)%t],n=e[i%t],o=e[(i+1)%t],c=e[(i+2)%t];return WD((r-i/t)*t,s,n,o,c)}}var a2=e=>()=>e;function zY(e,t){return function(r){return e+r*t}}function M2t(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(i){return Math.pow(e+i*t,r)}}function UA(e,t){var r=t-e;return r?zY(e,r>180||r<-180?r-360*Math.round(r/360):r):a2(isNaN(e)?t:e)}function UY(e){return(e=+e)==1?zs:function(t,r){return r-t?M2t(t,r,e):a2(isNaN(t)?r:t)}}function zs(e,t){var r=t-e;return r?zY(e,r):a2(isNaN(e)?t:e)}var VA=function e(t){var r=UY(t);function i(s,n){var o=r((s=Vd(s)).r,(n=Vd(n)).r),c=r(s.g,n.g),f=r(s.b,n.b),p=zs(s.opacity,n.opacity);return function(x){return s.r=o(x),s.g=c(x),s.b=f(x),s.opacity=p(x),s+""}}return i.gamma=e,i}(1);function VY(e){return function(t){var r=t.length,i=new Array(r),s=new Array(r),n=new Array(r),o,c;for(o=0;o<r;++o)c=Vd(t[o]),i[o]=c.r||0,s[o]=c.g||0,n[o]=c.b||0;return i=e(i),s=e(s),n=e(n),c.opacity=1,function(f){return c.r=i(f),c.g=s(f),c.b=n(f),c+""}}}var DE=VY(RE),jY=VY(kE);function l2(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,i=t.slice(),s;return function(n){for(s=0;s<r;++s)i[s]=e[s]*(1-n)+t[s]*n;return i}}function BE(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function $Y(e,t){return(BE(t)?l2:qD)(e,t)}function qD(e,t){var r=t?t.length:0,i=e?Math.min(r,e.length):0,s=new Array(i),n=new Array(r),o;for(o=0;o<i;++o)s[o]=fl(e[o],t[o]);for(;o<r;++o)n[o]=t[o];return function(c){for(o=0;o<i;++o)n[o]=s[o](c);return n}}function OE(e,t){var r=new Date;return e=+e,t=+t,function(i){return r.setTime(e*(1-i)+t*i),r}}function da(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function NE(e,t){var r={},i={},s;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(s in t)s in e?r[s]=fl(e[s],t[s]):i[s]=t[s];return function(n){for(s in r)i[s]=r[s](n);return i}}var XD=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,YD=new RegExp(XD.source,"g");function C2t(e){return function(){return e}}function P2t(e){return function(t){return e(t)+""}}function c2(e,t){var r=XD.lastIndex=YD.lastIndex=0,i,s,n,o=-1,c=[],f=[];for(e=e+"",t=t+"";(i=XD.exec(e))&&(s=YD.exec(t));)(n=s.index)>r&&(n=t.slice(r,n),c[o]?c[o]+=n:c[++o]=n),(i=i[0])===(s=s[0])?c[o]?c[o]+=s:c[++o]=s:(c[++o]=null,f.push({i:o,x:da(i,s)})),r=YD.lastIndex;return r<t.length&&(n=t.slice(r),c[o]?c[o]+=n:c[++o]=n),c.length<2?f[0]?P2t(f[0].x):C2t(t):(t=f.length,function(p){for(var x=0,E;x<t;++x)c[(E=f[x]).i]=E.x(p);return c.join("")})}function fl(e,t){var r=typeof t,i;return t==null||r==="boolean"?a2(t):(r==="number"?da:r==="string"?(i=gc(t))?(t=i,VA):c2:t instanceof gc?VA:t instanceof Date?OE:BE(t)?l2:Array.isArray(t)?qD:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?NE:da)(e,t)}function HY(e){var t=e.length;return function(r){return e[Math.max(0,Math.min(t-1,Math.floor(r*t)))]}}function WY(e,t){var r=UA(+e,+t);return function(i){var s=r(i);return s-360*Math.floor(s/360)}}function jA(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}var qY=180/Math.PI,FE={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function ZD(e,t,r,i,s,n){var o,c,f;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(f=e*r+t*i)&&(r-=e*f,i-=t*f),(c=Math.sqrt(r*r+i*i))&&(r/=c,i/=c,f/=c),e*i<t*r&&(e=-e,t=-t,f=-f,o=-o),{translateX:s,translateY:n,rotate:Math.atan2(t,e)*qY,skewX:Math.atan(f)*qY,scaleX:o,scaleY:c}}var LE;function YY(e){let t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?FE:ZD(t.a,t.b,t.c,t.d,t.e,t.f)}function XY(e){return e==null?FE:(LE||(LE=document.createElementNS("http://www.w3.org/2000/svg","g")),LE.setAttribute("transform",e),(e=LE.transform.baseVal.consolidate())?(e=e.matrix,ZD(e.a,e.b,e.c,e.d,e.e,e.f)):FE)}function ZY(e,t,r,i){function s(p){return p.length?p.pop()+" ":""}function n(p,x,E,T,D,N){if(p!==E||x!==T){var z=D.push("translate(",null,t,null,r);N.push({i:z-4,x:da(p,E)},{i:z-2,x:da(x,T)})}else(E||T)&&D.push("translate("+E+t+T+r)}function o(p,x,E,T){p!==x?(p-x>180?x+=360:x-p>180&&(p+=360),T.push({i:E.push(s(E)+"rotate(",null,i)-2,x:da(p,x)})):x&&E.push(s(E)+"rotate("+x+i)}function c(p,x,E,T){p!==x?T.push({i:E.push(s(E)+"skewX(",null,i)-2,x:da(p,x)}):x&&E.push(s(E)+"skewX("+x+i)}function f(p,x,E,T,D,N){if(p!==E||x!==T){var z=D.push(s(D)+"scale(",null,",",null,")");N.push({i:z-4,x:da(p,E)},{i:z-2,x:da(x,T)})}else(E!==1||T!==1)&&D.push(s(D)+"scale("+E+","+T+")")}return function(p,x){var E=[],T=[];return p=e(p),x=e(x),n(p.translateX,p.translateY,x.translateX,x.translateY,E,T),o(p.rotate,x.rotate,E,T),c(p.skewX,x.skewX,E,T),f(p.scaleX,p.scaleY,x.scaleX,x.scaleY,E,T),p=x=null,function(D){for(var N=-1,z=T.length,U;++N<z;)E[(U=T[N]).i]=U.x(D);return E.join("")}}}var zE=ZY(YY,"px, ","px)","deg)"),UE=ZY(XY,", ",")",")");var R2t=1e-12;function GY(e){return((e=Math.exp(e))+1/e)/2}function k2t(e){return((e=Math.exp(e))-1/e)/2}function D2t(e){return((e=Math.exp(2*e))-1)/(e+1)}var VE=function e(t,r,i){function s(n,o){var c=n[0],f=n[1],p=n[2],x=o[0],E=o[1],T=o[2],D=x-c,N=E-f,z=D*D+N*N,U,H;if(z<R2t)H=Math.log(T/p)/t,U=function(Dt){return[c+Dt*D,f+Dt*N,p*Math.exp(t*Dt*H)]};else{var G=Math.sqrt(z),Z=(T*T-p*p+i*z)/(2*p*r*G),Y=(T*T-p*p-i*z)/(2*T*r*G),st=Math.log(Math.sqrt(Z*Z+1)-Z),at=Math.log(Math.sqrt(Y*Y+1)-Y);H=(at-st)/t,U=function(Dt){var Tt=Dt*H,kt=GY(st),Et=p/(r*G)*(kt*D2t(t*Tt+st)-k2t(st));return[c+Et*D,f+Et*N,p*kt/GY(t*Tt+st)]}}return U.duration=H*1e3*t/Math.SQRT2,U}return s.rho=function(n){var o=Math.max(.001,+n),c=o*o,f=c*c;return e(o,c,f)},s}(Math.SQRT2,2,4);function QY(e){return function(t,r){var i=e((t=n2(t)).h,(r=n2(r)).h),s=zs(t.s,r.s),n=zs(t.l,r.l),o=zs(t.opacity,r.opacity);return function(c){return t.h=i(c),t.s=s(c),t.l=n(c),t.opacity=o(c),t+""}}}var KY=QY(UA),JY=QY(zs);function GD(e,t){var r=zs((e=c1(e)).l,(t=c1(t)).l),i=zs(e.a,t.a),s=zs(e.b,t.b),n=zs(e.opacity,t.opacity);return function(o){return e.l=r(o),e.a=i(o),e.b=s(o),e.opacity=n(o),e+""}}function tX(e){return function(t,r){var i=e((t=o2(t)).h,(r=o2(r)).h),s=zs(t.c,r.c),n=zs(t.l,r.l),o=zs(t.opacity,r.opacity);return function(c){return t.h=i(c),t.c=s(c),t.l=n(c),t.opacity=o(c),t+""}}}var eX=tX(UA),rX=tX(zs);function iX(e){return function t(r){r=+r;function i(s,n){var o=e((s=hl(s)).h,(n=hl(n)).h),c=zs(s.s,n.s),f=zs(s.l,n.l),p=zs(s.opacity,n.opacity);return function(x){return s.h=o(x),s.s=c(x),s.l=f(Math.pow(x,r)),s.opacity=p(x),s+""}}return i.gamma=t,i}(1)}var nX=iX(UA),h1=iX(zs);function Gw(e,t){t===void 0&&(t=e,e=fl);for(var r=0,i=t.length-1,s=t[0],n=new Array(i<0?0:i);r<i;)n[r]=e(s,s=t[++r]);return function(o){var c=Math.max(0,Math.min(i-1,Math.floor(o*=i)));return n[c](o-c)}}function sX(e,t){for(var r=new Array(t),i=0;i<t;++i)r[i]=e(i/(t-1));return r}var u2=0,Kw=0,Qw=0,aX=1e3,jE,Jw,$E=0,f1=0,HE=0,t3=typeof performance=="object"&&performance.now?performance:Date,lX=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function $A(){return f1||(lX(B2t),f1=t3.now()+HE)}function B2t(){f1=0}function p1(){this._call=this._time=this._next=null}p1.prototype=d1.prototype={constructor:p1,restart:function(e,t,r){if(typeof e!="function")throw new TypeError("callback is not a function");r=(r==null?$A():+r)+(t==null?0:+t),!this._next&&Jw!==this&&(Jw?Jw._next=this:jE=this,Jw=this),this._call=e,this._time=r,QD()},stop:function(){this._call&&(this._call=null,this._time=1/0,QD())}};function d1(e,t,r){var i=new p1;return i.restart(e,t,r),i}function KD(){$A(),++u2;for(var e=jE,t;e;)(t=f1-e._time)>=0&&e._call.call(void 0,t),e=e._next;--u2}function oX(){f1=($E=t3.now())+HE,u2=Kw=0;try{KD()}finally{u2=0,N2t(),f1=0}}function O2t(){var e=t3.now(),t=e-$E;t>aX&&(HE-=t,$E=e)}function N2t(){for(var e,t=jE,r,i=1/0;t;)t._call?(i>t._time&&(i=t._time),e=t,t=t._next):(r=t._next,t._next=null,t=e?e._next=r:jE=r);Jw=e,QD(i)}function QD(e){if(!u2){Kw&&(Kw=clearTimeout(Kw));var t=e-f1;t>24?(e<1/0&&(Kw=setTimeout(oX,e-t3.now()-HE)),Qw&&(Qw=clearInterval(Qw))):(Qw||($E=t3.now(),Qw=setInterval(O2t,aX)),u2=1,lX(oX))}}function e3(e,t,r){var i=new p1;return t=t==null?0:+t,i.restart(s=>{i.stop(),e(s+t)},t,r),i}function cX(e,t,r){var i=new p1,s=t;return t==null?(i.restart(e,t,r),i):(i._restart=i.restart,i.restart=function(n,o,c){o=+o,c=c==null?$A():+c,i._restart(function f(p){p+=s,i._restart(f,s+=o,c),n(p)},o,c)},i.restart(e,t,r),i)}var F2t=ju("start","end","cancel","interrupt"),L2t=[],hX=0,qE=1,YE=2,WE=3,uX=4,XE=5,r3=6;function HA(e,t,r,i,s,n){var o=e.__transition;if(!o)e.__transition={};else if(r in o)return;z2t(e,r,{name:t,index:i,group:s,on:F2t,tween:L2t,time:n.time,delay:n.delay,duration:n.duration,ease:n.ease,timer:null,state:hX})}function i3(e,t){var r=Yo(e,t);if(r.state>hX)throw new Error("too late; already scheduled");return r}function Na(e,t){var r=Yo(e,t);if(r.state>WE)throw new Error("too late; already running");return r}function Yo(e,t){var r=e.__transition;if(!r||!(r=r[t]))throw new Error("transition not found");return r}function z2t(e,t,r){var i=e.__transition,s;i[t]=r,r.timer=d1(n,0,r.time);function n(p){r.state=qE,r.timer.restart(o,r.delay,r.time),r.delay<=p&&o(p-r.delay)}function o(p){var x,E,T,D;if(r.state!==qE)return f();for(x in i)if(D=i[x],D.name===r.name){if(D.state===WE)return e3(o);D.state===uX?(D.state=r3,D.timer.stop(),D.on.call("interrupt",e,e.__data__,D.index,D.group),delete i[x]):+x<t&&(D.state=r3,D.timer.stop(),D.on.call("cancel",e,e.__data__,D.index,D.group),delete i[x])}if(e3(function(){r.state===WE&&(r.state=uX,r.timer.restart(c,r.delay,r.time),c(p))}),r.state=YE,r.on.call("start",e,e.__data__,r.index,r.group),r.state===YE){for(r.state=WE,s=new Array(T=r.tween.length),x=0,E=-1;x<T;++x)(D=r.tween[x].value.call(e,e.__data__,r.index,r.group))&&(s[++E]=D);s.length=E+1}}function c(p){for(var x=p<r.duration?r.ease.call(null,p/r.duration):(r.timer.restart(f),r.state=XE,1),E=-1,T=s.length;++E<T;)s[E].call(e,x);r.state===XE&&(r.on.call("end",e,e.__data__,r.index,r.group),f())}function f(){r.state=r3,r.timer.stop(),delete i[t];for(var p in i)return;delete e.__transition}}function Xh(e,t){var r=e.__transition,i,s,n=!0,o;if(r){t=t==null?null:t+"";for(o in r){if((i=r[o]).name!==t){n=!1;continue}s=i.state>YE&&i.state<XE,i.state=r3,i.timer.stop(),i.on.call(s?"interrupt":"cancel",e,e.__data__,i.index,i.group),delete r[o]}n&&delete e.__transition}}function fX(e){return this.each(function(){Xh(this,e)})}function U2t(e,t){var r,i;return function(){var s=Na(this,e),n=s.tween;if(n!==r){i=r=n;for(var o=0,c=i.length;o<c;++o)if(i[o].name===t){i=i.slice(),i.splice(o,1);break}}s.tween=i}}function V2t(e,t,r){var i,s;if(typeof r!="function")throw new Error;return function(){var n=Na(this,e),o=n.tween;if(o!==i){s=(i=o).slice();for(var c={name:t,value:r},f=0,p=s.length;f<p;++f)if(s[f].name===t){s[f]=c;break}f===p&&s.push(c)}n.tween=s}}function pX(e,t){var r=this._id;if(e+="",arguments.length<2){for(var i=Yo(this.node(),r).tween,s=0,n=i.length,o;s<n;++s)if((o=i[s]).name===e)return o.value;return null}return this.each((t==null?U2t:V2t)(r,e,t))}function h2(e,t,r){var i=e._id;return e.each(function(){var s=Na(this,i);(s.value||(s.value={}))[t]=r.apply(this,arguments)}),function(s){return Yo(s,i).value[t]}}function ZE(e,t){var r;return(typeof t=="number"?da:t instanceof gc?VA:(r=gc(t))?(t=r,VA):c2)(e,t)}function j2t(e){return function(){this.removeAttribute(e)}}function $2t(e){return function(){this.removeAttributeNS(e.space,e.local)}}function H2t(e,t,r){var i,s=r+"",n;return function(){var o=this.getAttribute(e);return o===s?null:o===i?n:n=t(i=o,r)}}function W2t(e,t,r){var i,s=r+"",n;return function(){var o=this.getAttributeNS(e.space,e.local);return o===s?null:o===i?n:n=t(i=o,r)}}function q2t(e,t,r){var i,s,n;return function(){var o,c=r(this),f;return c==null?void this.removeAttribute(e):(o=this.getAttribute(e),f=c+"",o===f?null:o===i&&f===s?n:(s=f,n=t(i=o,c)))}}function Y2t(e,t,r){var i,s,n;return function(){var o,c=r(this),f;return c==null?void this.removeAttributeNS(e.space,e.local):(o=this.getAttributeNS(e.space,e.local),f=c+"",o===f?null:o===i&&f===s?n:(s=f,n=t(i=o,c)))}}function dX(e,t){var r=tp(e),i=r==="transform"?UE:ZE;return this.attrTween(e,typeof t=="function"?(r.local?Y2t:q2t)(r,i,h2(this,"attr."+e,t)):t==null?(r.local?$2t:j2t)(r):(r.local?W2t:H2t)(r,i,t))}function X2t(e,t){return function(r){this.setAttribute(e,t.call(this,r))}}function Z2t(e,t){return function(r){this.setAttributeNS(e.space,e.local,t.call(this,r))}}function G2t(e,t){var r,i;function s(){var n=t.apply(this,arguments);return n!==i&&(r=(i=n)&&Z2t(e,n)),r}return s._value=t,s}function Q2t(e,t){var r,i;function s(){var n=t.apply(this,arguments);return n!==i&&(r=(i=n)&&X2t(e,n)),r}return s._value=t,s}function AX(e,t){var r="attr."+e;if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;var i=tp(e);return this.tween(r,(i.local?G2t:Q2t)(i,t))}function K2t(e,t){return function(){i3(this,e).delay=+t.apply(this,arguments)}}function J2t(e,t){return t=+t,function(){i3(this,e).delay=t}}function mX(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?K2t:J2t)(t,e)):Yo(this.node(),t).delay}function txt(e,t){return function(){Na(this,e).duration=+t.apply(this,arguments)}}function ext(e,t){return t=+t,function(){Na(this,e).duration=t}}function gX(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?txt:ext)(t,e)):Yo(this.node(),t).duration}function rxt(e,t){if(typeof t!="function")throw new Error;return function(){Na(this,e).ease=t}}function _X(e){var t=this._id;return arguments.length?this.each(rxt(t,e)):Yo(this.node(),t).ease}function ixt(e,t){return function(){var r=t.apply(this,arguments);if(typeof r!="function")throw new Error;Na(this,e).ease=r}}function yX(e){if(typeof e!="function")throw new Error;return this.each(ixt(this._id,e))}function xX(e){typeof e!="function"&&(e=e2(e));for(var t=this._groups,r=t.length,i=new Array(r),s=0;s<r;++s)for(var n=t[s],o=n.length,c=i[s]=[],f,p=0;p<o;++p)(f=n[p])&&e.call(f,f.__data__,p,n)&&c.push(f);return new Fa(i,this._parents,this._name,this._id)}function bX(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,r=e._groups,i=t.length,s=r.length,n=Math.min(i,s),o=new Array(i),c=0;c<n;++c)for(var f=t[c],p=r[c],x=f.length,E=o[c]=new Array(x),T,D=0;D<x;++D)(T=f[D]||p[D])&&(E[D]=T);for(;c<i;++c)o[c]=t[c];return new Fa(o,this._parents,this._name,this._id)}function nxt(e){return(e+"").trim().split(/^|\s+/).every(function(t){var r=t.indexOf(".");return r>=0&&(t=t.slice(0,r)),!t||t==="start"})}function sxt(e,t,r){var i,s,n=nxt(t)?i3:Na;return function(){var o=n(this,e),c=o.on;c!==i&&(s=(i=c).copy()).on(t,r),o.on=s}}function vX(e,t){var r=this._id;return arguments.length<2?Yo(this.node(),r).on.on(e):this.each(sxt(r,e,t))}function oxt(e){return function(){var t=this.parentNode;for(var r in this.__transition)if(+r!==e)return;t&&t.removeChild(this)}}function wX(){return this.on("end.remove",oxt(this._id))}function TX(e){var t=this._name,r=this._id;typeof e!="function"&&(e=BA(e));for(var i=this._groups,s=i.length,n=new Array(s),o=0;o<s;++o)for(var c=i[o],f=c.length,p=n[o]=new Array(f),x,E,T=0;T<f;++T)(x=c[T])&&(E=e.call(x,x.__data__,T,c))&&("__data__"in x&&(E.__data__=x.__data__),p[T]=E,HA(p[T],t,r,T,p,Yo(x,r)));return new Fa(n,this._parents,t,r)}function SX(e){var t=this._name,r=this._id;typeof e!="function"&&(e=t2(e));for(var i=this._groups,s=i.length,n=[],o=[],c=0;c<s;++c)for(var f=i[c],p=f.length,x,E=0;E<p;++E)if(x=f[E]){for(var T=e.call(x,x.__data__,E,f),D,N=Yo(x,r),z=0,U=T.length;z<U;++z)(D=T[z])&&HA(D,t,r,z,T,N);n.push(T),o.push(x)}return new Fa(n,o,t,r)}var axt=ep.prototype.constructor;function EX(){return new axt(this._groups,this._parents)}function lxt(e,t){var r,i,s;return function(){var n=zd(this,e),o=(this.style.removeProperty(e),zd(this,e));return n===o?null:n===r&&o===i?s:s=t(r=n,i=o)}}function IX(e){return function(){this.style.removeProperty(e)}}function cxt(e,t,r){var i,s=r+"",n;return function(){var o=zd(this,e);return o===s?null:o===i?n:n=t(i=o,r)}}function uxt(e,t,r){var i,s,n;return function(){var o=zd(this,e),c=r(this),f=c+"";return c==null&&(f=c=(this.style.removeProperty(e),zd(this,e))),o===f?null:o===i&&f===s?n:(s=f,n=t(i=o,c))}}function hxt(e,t){var r,i,s,n="style."+t,o="end."+n,c;return function(){var f=Na(this,e),p=f.on,x=f.value[n]==null?c||(c=IX(t)):void 0;(p!==r||s!==x)&&(i=(r=p).copy()).on(o,s=x),f.on=i}}function MX(e,t,r){var i=(e+="")=="transform"?zE:ZE;return t==null?this.styleTween(e,lxt(e,i)).on("end.style."+e,IX(e)):typeof t=="function"?this.styleTween(e,uxt(e,i,h2(this,"style."+e,t))).each(hxt(this._id,e)):this.styleTween(e,cxt(e,i,t),r).on("end.style."+e,null)}function fxt(e,t,r){return function(i){this.style.setProperty(e,t.call(this,i),r)}}function pxt(e,t,r){var i,s;function n(){var o=t.apply(this,arguments);return o!==s&&(i=(s=o)&&fxt(e,o,r)),i}return n._value=t,n}function CX(e,t,r){var i="style."+(e+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(t==null)return this.tween(i,null);if(typeof t!="function")throw new Error;return this.tween(i,pxt(e,t,r??""))}function dxt(e){return function(){this.textContent=e}}function Axt(e){return function(){var t=e(this);this.textContent=t??""}}function PX(e){return this.tween("text",typeof e=="function"?Axt(h2(this,"text",e)):dxt(e==null?"":e+""))}function mxt(e){return function(t){this.textContent=e.call(this,t)}}function gxt(e){var t,r;function i(){var s=e.apply(this,arguments);return s!==r&&(t=(r=s)&&mxt(s)),t}return i._value=e,i}function RX(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,gxt(e))}function kX(){for(var e=this._name,t=this._id,r=GE(),i=this._groups,s=i.length,n=0;n<s;++n)for(var o=i[n],c=o.length,f,p=0;p<c;++p)if(f=o[p]){var x=Yo(f,t);HA(f,e,r,p,o,{time:x.time+x.delay+x.duration,delay:0,duration:x.duration,ease:x.ease})}return new Fa(i,this._parents,e,r)}function DX(){var e,t,r=this,i=r._id,s=r.size();return new Promise(function(n,o){var c={value:o},f={value:function(){--s===0&&n()}};r.each(function(){var p=Na(this,i),x=p.on;x!==e&&(t=(e=x).copy(),t._.cancel.push(c),t._.interrupt.push(c),t._.end.push(f)),p.on=t}),s===0&&n()})}var _xt=0;function Fa(e,t,r,i){this._groups=e,this._parents=t,this._name=r,this._id=i}function QE(e){return ep().transition(e)}function GE(){return++_xt}var jd=ep.prototype;Fa.prototype=QE.prototype={constructor:Fa,select:TX,selectAll:SX,selectChild:jd.selectChild,selectChildren:jd.selectChildren,filter:xX,merge:bX,selection:EX,transition:kX,call:jd.call,nodes:jd.nodes,node:jd.node,size:jd.size,empty:jd.empty,each:jd.each,on:vX,attr:dX,attrTween:AX,style:MX,styleTween:CX,text:PX,textTween:RX,remove:wX,tween:pX,delay:mX,duration:gX,ease:_X,easeVarying:yX,end:DX,[Symbol.iterator]:jd[Symbol.iterator]};var BX=e=>+e;function OX(e){return e*e}function NX(e){return e*(2-e)}function JD(e){return((e*=2)<=1?e*e:--e*(2-e)+1)/2}function FX(e){return e*e*e}function LX(e){return--e*e*e+1}function n3(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var tB=3,zX=function e(t){t=+t;function r(i){return Math.pow(i,t)}return r.exponent=e,r}(tB),UX=function e(t){t=+t;function r(i){return 1-Math.pow(1-i,t)}return r.exponent=e,r}(tB),eB=function e(t){t=+t;function r(i){return((i*=2)<=1?Math.pow(i,t):2-Math.pow(2-i,t))/2}return r.exponent=e,r}(tB);var VX=Math.PI,jX=VX/2;function $X(e){return+e==1?1:1-Math.cos(e*jX)}function HX(e){return Math.sin(e*jX)}function rB(e){return(1-Math.cos(VX*e))/2}function sp(e){return(Math.pow(2,-10*e)-.0009765625)*1.0009775171065494}function WX(e){return sp(1-+e)}function qX(e){return 1-sp(e)}function iB(e){return((e*=2)<=1?sp(1-e):2-sp(e-1))/2}function YX(e){return 1-Math.sqrt(1-e*e)}function XX(e){return Math.sqrt(1- --e*e)}function nB(e){return((e*=2)<=1?1-Math.sqrt(1-e*e):Math.sqrt(1-(e-=2)*e)+1)/2}var sB=.36363636363636365,yxt=6/11,xxt=8/11,bxt=3/4,vxt=9/11,wxt=10/11,Txt=15/16,Sxt=21/22,Ext=63/64,KE=1/sB/sB;function ZX(e){return 1-f2(1-e)}function f2(e){return(e=+e)<sB?KE*e*e:e<xxt?KE*(e-=yxt)*e+bxt:e<wxt?KE*(e-=vxt)*e+Txt:KE*(e-=Sxt)*e+Ext}function GX(e){return((e*=2)<=1?1-f2(1-e):f2(e-1)+1)/2}var oB=1.70158,QX=function e(t){t=+t;function r(i){return(i=+i)*i*(t*(i-1)+i)}return r.overshoot=e,r}(oB),KX=function e(t){t=+t;function r(i){return--i*i*((i+1)*t+i)+1}return r.overshoot=e,r}(oB),aB=function e(t){t=+t;function r(i){return((i*=2)<1?i*i*((t+1)*i-t):(i-=2)*i*((t+1)*i+t)+2)/2}return r.overshoot=e,r}(oB);var p2=2*Math.PI,lB=1,cB=.3,JX=function e(t,r){var i=Math.asin(1/(t=Math.max(1,t)))*(r/=p2);function s(n){return t*sp(- --n)*Math.sin((i-n)/r)}return s.amplitude=function(n){return e(n,r*p2)},s.period=function(n){return e(t,n)},s}(lB,cB),uB=function e(t,r){var i=Math.asin(1/(t=Math.max(1,t)))*(r/=p2);function s(n){return 1-t*sp(n=+n)*Math.sin((n+i)/r)}return s.amplitude=function(n){return e(n,r*p2)},s.period=function(n){return e(t,n)},s}(lB,cB),tZ=function e(t,r){var i=Math.asin(1/(t=Math.max(1,t)))*(r/=p2);function s(n){return((n=n*2-1)<0?t*sp(-n)*Math.sin((i-n)/r):2-t*sp(n)*Math.sin((i+n)/r))/2}return s.amplitude=function(n){return e(n,r*p2)},s.period=function(n){return e(t,n)},s}(lB,cB);var Ixt={time:null,delay:0,duration:250,ease:n3};function Mxt(e,t){for(var r;!(r=e.__transition)||!(r=r[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return r}function eZ(e){var t,r;e instanceof Fa?(t=e._id,e=e._name):(t=GE(),(r=Ixt).time=$A(),e=e==null?null:e+"");for(var i=this._groups,s=i.length,n=0;n<s;++n)for(var o=i[n],c=o.length,f,p=0;p<c;++p)(f=o[p])&&HA(f,e,t,p,o,r||Mxt(f,t));return new Fa(i,this._parents,e,t)}ep.prototype.interrupt=fX;ep.prototype.transition=eZ;var Cxt=[null];function rZ(e,t){var r=e.__transition,i,s;if(r){t=t==null?null:t+"";for(s in r)if((i=r[s]).state>qE&&i.name===t)return new Fa([[e]],Cxt,t,+s)}return null}var JE=e=>()=>e;function hB(e,{sourceEvent:t,target:r,selection:i,mode:s,dispatch:n}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},selection:{value:i,enumerable:!0,configurable:!0},mode:{value:s,enumerable:!0,configurable:!0},_:{value:n}})}function iZ(e){e.stopImmediatePropagation()}function t6(e){e.preventDefault(),e.stopImmediatePropagation()}var nZ={name:"drag"},fB={name:"space"},d2={name:"handle"},A2={name:"center"},{abs:sZ,max:pl,min:dl}=Math;function oZ(e){return[+e[0],+e[1]]}function dB(e){return[oZ(e[0]),oZ(e[1])]}var e6={name:"x",handles:["w","e"].map(s3),input:function(e,t){return e==null?null:[[+e[0],t[0][1]],[+e[1],t[1][1]]]},output:function(e){return e&&[e[0][0],e[1][0]]}},r6={name:"y",handles:["n","s"].map(s3),input:function(e,t){return e==null?null:[[t[0][0],+e[0]],[t[1][0],+e[1]]]},output:function(e){return e&&[e[0][1],e[1][1]]}},Pxt={name:"xy",handles:["n","w","e","s","nw","ne","sw","se"].map(s3),input:function(e){return e==null?null:dB(e)},output:function(e){return e}},$d={overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},aZ={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},lZ={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},Rxt={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},kxt={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};function s3(e){return{type:e}}function Dxt(e){return!e.ctrlKey&&!e.button}function Bxt(){var e=this.ownerSVGElement||this;return e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]}function Oxt(){return navigator.maxTouchPoints||"ontouchstart"in this}function pB(e){for(;!e.__brush;)if(!(e=e.parentNode))return;return e.__brush}function Nxt(e){return e[0][0]===e[1][0]||e[0][1]===e[1][1]}function cZ(e){var t=e.__brush;return t?t.dim.output(t.selection):null}function uZ(){return AB(e6)}function hZ(){return AB(r6)}function fZ(){return AB(Pxt)}function AB(e){var t=Bxt,r=Dxt,i=Oxt,s=!0,n=ju("start","brush","end"),o=6,c;function f(U){var H=U.property("__brush",z).selectAll(".overlay").data([s3("overlay")]);H.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",$d.overlay).merge(H).each(function(){var Z=pB(this).extent;lo(this).attr("x",Z[0][0]).attr("y",Z[0][1]).attr("width",Z[1][0]-Z[0][0]).attr("height",Z[1][1]-Z[0][1])}),U.selectAll(".selection").data([s3("selection")]).enter().append("rect").attr("class","selection").attr("cursor",$d.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var G=U.selectAll(".handle").data(e.handles,function(Z){return Z.type});G.exit().remove(),G.enter().append("rect").attr("class",function(Z){return"handle handle--"+Z.type}).attr("cursor",function(Z){return $d[Z.type]}),U.each(p).attr("fill","none").attr("pointer-events","all").on("mousedown.brush",T).filter(i).on("touchstart.brush",T).on("touchmove.brush",D).on("touchend.brush touchcancel.brush",N).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}f.move=function(U,H,G){U.tween?U.on("start.brush",function(Z){x(this,arguments).beforestart().start(Z)}).on("interrupt.brush end.brush",function(Z){x(this,arguments).end(Z)}).tween("brush",function(){var Z=this,Y=Z.__brush,st=x(Z,arguments),at=Y.selection,Dt=e.input(typeof H=="function"?H.apply(this,arguments):H,Y.extent),Tt=fl(at,Dt);function kt(Et){Y.selection=Et===1&&Dt===null?null:Tt(Et),p.call(Z),st.brush()}return at!==null&&Dt!==null?kt:kt(1)}):U.each(function(){var Z=this,Y=arguments,st=Z.__brush,at=e.input(typeof H=="function"?H.apply(Z,Y):H,st.extent),Dt=x(Z,Y).beforestart();Xh(Z),st.selection=at===null?null:at,p.call(Z),Dt.start(G).brush(G).end(G)})},f.clear=function(U,H){f.move(U,null,H)};function p(){var U=lo(this),H=pB(this).selection;H?(U.selectAll(".selection").style("display",null).attr("x",H[0][0]).attr("y",H[0][1]).attr("width",H[1][0]-H[0][0]).attr("height",H[1][1]-H[0][1]),U.selectAll(".handle").style("display",null).attr("x",function(G){return G.type[G.type.length-1]==="e"?H[1][0]-o/2:H[0][0]-o/2}).attr("y",function(G){return G.type[0]==="s"?H[1][1]-o/2:H[0][1]-o/2}).attr("width",function(G){return G.type==="n"||G.type==="s"?H[1][0]-H[0][0]+o:o}).attr("height",function(G){return G.type==="e"||G.type==="w"?H[1][1]-H[0][1]+o:o})):U.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function x(U,H,G){var Z=U.__brush.emitter;return Z&&(!G||!Z.clean)?Z:new E(U,H,G)}function E(U,H,G){this.that=U,this.args=H,this.state=U.__brush,this.active=0,this.clean=G}E.prototype={beforestart:function(){return++this.active===1&&(this.state.emitter=this,this.starting=!0),this},start:function(U,H){return this.starting?(this.starting=!1,this.emit("start",U,H)):this.emit("brush",U),this},brush:function(U,H){return this.emit("brush",U,H),this},end:function(U,H){return--this.active===0&&(delete this.state.emitter,this.emit("end",U,H)),this},emit:function(U,H,G){var Z=lo(this.that).datum();n.call(U,this.that,new hB(U,{sourceEvent:H,target:f,selection:e.output(this.state.selection),mode:G,dispatch:n}),Z)}};function T(U){if(c&&!U.touches||!r.apply(this,arguments))return;var H=this,G=U.target.__data__.type,Z=(s&&U.metaKey?G="overlay":G)==="selection"?nZ:s&&U.altKey?A2:d2,Y=e===r6?null:Rxt[G],st=e===e6?null:kxt[G],at=pB(H),Dt=at.extent,Tt=at.selection,kt=Dt[0][0],Et,Mt,oe=Dt[0][1],Xt,xt,jt=Dt[1][0],Wt,de,Ee=Dt[1][1],Se,ze,ke=0,ir=0,Ti,_i=Y&&st&&s&&U.shiftKey,ci,Gr,Fr=Array.from(U.touches||[U],Sr=>{let ae=Sr.identifier;return Sr=pa(Sr,H),Sr.point0=Sr.slice(),Sr.identifier=ae,Sr});Xh(H);var Dr=x(H,arguments,!0).beforestart();if(G==="overlay"){Tt&&(Ti=!0);let Sr=[Fr[0],Fr[1]||Fr[0]];at.selection=Tt=[[Et=e===r6?kt:dl(Sr[0][0],Sr[1][0]),Xt=e===e6?oe:dl(Sr[0][1],Sr[1][1])],[Wt=e===r6?jt:pl(Sr[0][0],Sr[1][0]),Se=e===e6?Ee:pl(Sr[0][1],Sr[1][1])]],Fr.length>1&&Ji(U)}else Et=Tt[0][0],Xt=Tt[0][1],Wt=Tt[1][0],Se=Tt[1][1];Mt=Et,xt=Xt,de=Wt,ze=Se;var Le=lo(H).attr("pointer-events","none"),Tr=Le.selectAll(".overlay").attr("cursor",$d[G]);if(U.touches)Dr.moved=Ie,Dr.ended=yi;else{var jr=lo(U.view).on("mousemove.brush",Ie,!0).on("mouseup.brush",yi,!0);s&&jr.on("keydown.brush",tn,!0).on("keyup.brush",hn,!0),NA(U.view)}p.call(H),Dr.start(U,Z.name);function Ie(Sr){for(let ae of Sr.changedTouches||[Sr])for(let Xn of Fr)Xn.identifier===ae.identifier&&(Xn.cur=pa(ae,H));if(_i&&!ci&&!Gr&&Fr.length===1){let ae=Fr[0];sZ(ae.cur[0]-ae[0])>sZ(ae.cur[1]-ae[1])?Gr=!0:ci=!0}for(let ae of Fr)ae.cur&&(ae[0]=ae.cur[0],ae[1]=ae.cur[1]);Ti=!0,t6(Sr),Ji(Sr)}function Ji(Sr){let ae=Fr[0],Xn=ae.point0;var on;switch(ke=ae[0]-Xn[0],ir=ae[1]-Xn[1],Z){case fB:case nZ:{Y&&(ke=pl(kt-Et,dl(jt-Wt,ke)),Mt=Et+ke,de=Wt+ke),st&&(ir=pl(oe-Xt,dl(Ee-Se,ir)),xt=Xt+ir,ze=Se+ir);break}case d2:{Fr[1]?(Y&&(Mt=pl(kt,dl(jt,Fr[0][0])),de=pl(kt,dl(jt,Fr[1][0])),Y=1),st&&(xt=pl(oe,dl(Ee,Fr[0][1])),ze=pl(oe,dl(Ee,Fr[1][1])),st=1)):(Y<0?(ke=pl(kt-Et,dl(jt-Et,ke)),Mt=Et+ke,de=Wt):Y>0&&(ke=pl(kt-Wt,dl(jt-Wt,ke)),Mt=Et,de=Wt+ke),st<0?(ir=pl(oe-Xt,dl(Ee-Xt,ir)),xt=Xt+ir,ze=Se):st>0&&(ir=pl(oe-Se,dl(Ee-Se,ir)),xt=Xt,ze=Se+ir));break}case A2:{Y&&(Mt=pl(kt,dl(jt,Et-ke*Y)),de=pl(kt,dl(jt,Wt+ke*Y))),st&&(xt=pl(oe,dl(Ee,Xt-ir*st)),ze=pl(oe,dl(Ee,Se+ir*st)));break}}de<Mt&&(Y*=-1,on=Et,Et=Wt,Wt=on,on=Mt,Mt=de,de=on,G in aZ&&Tr.attr("cursor",$d[G=aZ[G]])),ze<xt&&(st*=-1,on=Xt,Xt=Se,Se=on,on=xt,xt=ze,ze=on,G in lZ&&Tr.attr("cursor",$d[G=lZ[G]])),at.selection&&(Tt=at.selection),ci&&(Mt=Tt[0][0],de=Tt[1][0]),Gr&&(xt=Tt[0][1],ze=Tt[1][1]),(Tt[0][0]!==Mt||Tt[0][1]!==xt||Tt[1][0]!==de||Tt[1][1]!==ze)&&(at.selection=[[Mt,xt],[de,ze]],p.call(H),Dr.brush(Sr,Z.name))}function yi(Sr){if(iZ(Sr),Sr.touches){if(Sr.touches.length)return;c&&clearTimeout(c),c=setTimeout(function(){c=null},500)}else FA(Sr.view,Ti),jr.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);Le.attr("pointer-events","all"),Tr.attr("cursor",$d.overlay),at.selection&&(Tt=at.selection),Nxt(Tt)&&(at.selection=null,p.call(H)),Dr.end(Sr,Z.name)}function tn(Sr){switch(Sr.keyCode){case 16:{_i=Y&&st;break}case 18:{Z===d2&&(Y&&(Wt=de-ke*Y,Et=Mt+ke*Y),st&&(Se=ze-ir*st,Xt=xt+ir*st),Z=A2,Ji(Sr));break}case 32:{(Z===d2||Z===A2)&&(Y<0?Wt=de-ke:Y>0&&(Et=Mt-ke),st<0?Se=ze-ir:st>0&&(Xt=xt-ir),Z=fB,Tr.attr("cursor",$d.selection),Ji(Sr));break}default:return}t6(Sr)}function hn(Sr){switch(Sr.keyCode){case 16:{_i&&(ci=Gr=_i=!1,Ji(Sr));break}case 18:{Z===A2&&(Y<0?Wt=de:Y>0&&(Et=Mt),st<0?Se=ze:st>0&&(Xt=xt),Z=d2,Ji(Sr));break}case 32:{Z===fB&&(Sr.altKey?(Y&&(Wt=de-ke*Y,Et=Mt+ke*Y),st&&(Se=ze-ir*st,Xt=xt+ir*st),Z=A2):(Y<0?Wt=de:Y>0&&(Et=Mt),st<0?Se=ze:st>0&&(Xt=xt),Z=d2),Tr.attr("cursor",$d[G]),Ji(Sr));break}default:return}t6(Sr)}}function D(U){x(this,arguments).moved(U)}function N(U){x(this,arguments).ended(U)}function z(){var U=this.__brush||{selection:null};return U.extent=dB(t.apply(this,arguments)),U.dim=e,U}return f.extent=function(U){return arguments.length?(t=typeof U=="function"?U:JE(dB(U)),f):t},f.filter=function(U){return arguments.length?(r=typeof U=="function"?U:JE(!!U),f):r},f.touchable=function(U){return arguments.length?(i=typeof U=="function"?U:JE(!!U),f):i},f.handleSize=function(U){return arguments.length?(o=+U,f):o},f.keyModifiers=function(U){return arguments.length?(s=!!U,f):s},f.on=function(){var U=n.on.apply(n,arguments);return U===n?f:U},f}var mB=Math.abs,A1=Math.cos,m1=Math.sin,pZ=Math.PI,o3=pZ/2,gB=pZ*2,_B=Math.max,i6=1e-12;function yB(e,t){return Array.from({length:t-e},(r,i)=>e+i)}function Fxt(e){return function(t,r){return e(t.source.value+t.target.value,r.source.value+r.target.value)}}function dZ(){return xB(!1,!1)}function AZ(){return xB(!1,!0)}function mZ(){return xB(!0,!1)}function xB(e,t){var r=0,i=null,s=null,n=null;function o(c){var f=c.length,p=new Array(f),x=yB(0,f),E=new Array(f*f),T=new Array(f),D=0,N;c=Float64Array.from({length:f*f},t?(z,U)=>c[U%f][U/f|0]:(z,U)=>c[U/f|0][U%f]);for(let z=0;z<f;++z){let U=0;for(let H=0;H<f;++H)U+=c[z*f+H]+e*c[H*f+z];D+=p[z]=U}D=_B(0,gB-r*f)/D,N=D?r:gB/f;{let z=0;i&&x.sort((U,H)=>i(p[U],p[H]));for(let U of x){let H=z;if(e){let G=yB(~f+1,f).filter(Z=>Z<0?c[~Z*f+U]:c[U*f+Z]);s&&G.sort((Z,Y)=>s(Z<0?-c[~Z*f+U]:c[U*f+Z],Y<0?-c[~Y*f+U]:c[U*f+Y]));for(let Z of G)if(Z<0){let Y=E[~Z*f+U]||(E[~Z*f+U]={source:null,target:null});Y.target={index:U,startAngle:z,endAngle:z+=c[~Z*f+U]*D,value:c[~Z*f+U]}}else{let Y=E[U*f+Z]||(E[U*f+Z]={source:null,target:null});Y.source={index:U,startAngle:z,endAngle:z+=c[U*f+Z]*D,value:c[U*f+Z]}}T[U]={index:U,startAngle:H,endAngle:z,value:p[U]}}else{let G=yB(0,f).filter(Z=>c[U*f+Z]||c[Z*f+U]);s&&G.sort((Z,Y)=>s(c[U*f+Z],c[U*f+Y]));for(let Z of G){let Y;if(U<Z?(Y=E[U*f+Z]||(E[U*f+Z]={source:null,target:null}),Y.source={index:U,startAngle:z,endAngle:z+=c[U*f+Z]*D,value:c[U*f+Z]}):(Y=E[Z*f+U]||(E[Z*f+U]={source:null,target:null}),Y.target={index:U,startAngle:z,endAngle:z+=c[U*f+Z]*D,value:c[U*f+Z]},U===Z&&(Y.source=Y.target)),Y.source&&Y.target&&Y.source.value<Y.target.value){let st=Y.source;Y.source=Y.target,Y.target=st}}T[U]={index:U,startAngle:H,endAngle:z,value:p[U]}}z+=N}}return E=Object.values(E),E.groups=T,n?E.sort(n):E}return o.padAngle=function(c){return arguments.length?(r=_B(0,c),o):r},o.sortGroups=function(c){return arguments.length?(i=c,o):i},o.sortSubgroups=function(c){return arguments.length?(s=c,o):s},o.sortChords=function(c){return arguments.length?(c==null?n=null:(n=Fxt(c))._=c,o):n&&n._},o}var bB=Math.PI,vB=2*bB,g1=1e-6,Lxt=vB-g1;function gZ(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function zxt(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return gZ;let r=10**t;return function(i){this._+=i[0];for(let s=1,n=i.length;s<n;++s)this._+=Math.round(arguments[s]*r)/r+i[s]}}var Hd=class{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?gZ:zxt(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,i,s){this._append`Q${+t},${+r},${this._x1=+i},${this._y1=+s}`}bezierCurveTo(t,r,i,s,n,o){this._append`C${+t},${+r},${+i},${+s},${this._x1=+n},${this._y1=+o}`}arcTo(t,r,i,s,n){if(t=+t,r=+r,i=+i,s=+s,n=+n,n<0)throw new Error(`negative radius: ${n}`);let o=this._x1,c=this._y1,f=i-t,p=s-r,x=o-t,E=c-r,T=x*x+E*E;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(T>g1)if(!(Math.abs(E*f-p*x)>g1)||!n)this._append`L${this._x1=t},${this._y1=r}`;else{let D=i-o,N=s-c,z=f*f+p*p,U=D*D+N*N,H=Math.sqrt(z),G=Math.sqrt(T),Z=n*Math.tan((bB-Math.acos((z+T-U)/(2*H*G)))/2),Y=Z/G,st=Z/H;Math.abs(Y-1)>g1&&this._append`L${t+Y*x},${r+Y*E}`,this._append`A${n},${n},0,0,${+(E*D>x*N)},${this._x1=t+st*f},${this._y1=r+st*p}`}}arc(t,r,i,s,n,o){if(t=+t,r=+r,i=+i,o=!!o,i<0)throw new Error(`negative radius: ${i}`);let c=i*Math.cos(s),f=i*Math.sin(s),p=t+c,x=r+f,E=1^o,T=o?s-n:n-s;this._x1===null?this._append`M${p},${x}`:(Math.abs(this._x1-p)>g1||Math.abs(this._y1-x)>g1)&&this._append`L${p},${x}`,i&&(T<0&&(T=T%vB+vB),T>Lxt?this._append`A${i},${i},0,1,${E},${t-c},${r-f}A${i},${i},0,1,${E},${this._x1=p},${this._y1=x}`:T>g1&&this._append`A${i},${i},0,${+(T>=bB)},${E},${this._x1=t+i*Math.cos(n)},${this._y1=r+i*Math.sin(n)}`)}rect(t,r,i,s){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${i=+i}v${+s}h${-i}Z`}toString(){return this._}};function a3(){return new Hd}a3.prototype=Hd.prototype;function _Z(e=3){return new Hd(+e)}var yZ=Array.prototype.slice;function WA(e){return function(){return e}}function Uxt(e){return e.source}function Vxt(e){return e.target}function xZ(e){return e.radius}function jxt(e){return e.startAngle}function $xt(e){return e.endAngle}function Hxt(){return 0}function Wxt(){return 10}function bZ(e){var t=Uxt,r=Vxt,i=xZ,s=xZ,n=jxt,o=$xt,c=Hxt,f=null;function p(){var x,E=t.apply(this,arguments),T=r.apply(this,arguments),D=c.apply(this,arguments)/2,N=yZ.call(arguments),z=+i.apply(this,(N[0]=E,N)),U=n.apply(this,N)-o3,H=o.apply(this,N)-o3,G=+s.apply(this,(N[0]=T,N)),Z=n.apply(this,N)-o3,Y=o.apply(this,N)-o3;if(f||(f=x=a3()),D>i6&&(mB(H-U)>D*2+i6?H>U?(U+=D,H-=D):(U-=D,H+=D):U=H=(U+H)/2,mB(Y-Z)>D*2+i6?Y>Z?(Z+=D,Y-=D):(Z-=D,Y+=D):Z=Y=(Z+Y)/2),f.moveTo(z*A1(U),z*m1(U)),f.arc(0,0,z,U,H),U!==Z||H!==Y)if(e){var st=+e.apply(this,arguments),at=G-st,Dt=(Z+Y)/2;f.quadraticCurveTo(0,0,at*A1(Z),at*m1(Z)),f.lineTo(G*A1(Dt),G*m1(Dt)),f.lineTo(at*A1(Y),at*m1(Y))}else f.quadraticCurveTo(0,0,G*A1(Z),G*m1(Z)),f.arc(0,0,G,Z,Y);if(f.quadraticCurveTo(0,0,z*A1(U),z*m1(U)),f.closePath(),x)return f=null,x+""||null}return e&&(p.headRadius=function(x){return arguments.length?(e=typeof x=="function"?x:WA(+x),p):e}),p.radius=function(x){return arguments.length?(i=s=typeof x=="function"?x:WA(+x),p):i},p.sourceRadius=function(x){return arguments.length?(i=typeof x=="function"?x:WA(+x),p):i},p.targetRadius=function(x){return arguments.length?(s=typeof x=="function"?x:WA(+x),p):s},p.startAngle=function(x){return arguments.length?(n=typeof x=="function"?x:WA(+x),p):n},p.endAngle=function(x){return arguments.length?(o=typeof x=="function"?x:WA(+x),p):o},p.padAngle=function(x){return arguments.length?(c=typeof x=="function"?x:WA(+x),p):c},p.source=function(x){return arguments.length?(t=x,p):t},p.target=function(x){return arguments.length?(r=x,p):r},p.context=function(x){return arguments.length?(f=x??null,p):f},p}function vZ(){return bZ()}function wZ(){return bZ(Wxt)}var qxt=Array.prototype,n6=qxt.slice;function TZ(e,t){return e-t}function SZ(e){for(var t=0,r=e.length,i=e[r-1][1]*e[0][0]-e[r-1][0]*e[0][1];++t<r;)i+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return i}var ap=e=>()=>e;function EZ(e,t){for(var r=-1,i=t.length,s;++r<i;)if(s=Yxt(e,t[r]))return s;return 0}function Yxt(e,t){for(var r=t[0],i=t[1],s=-1,n=0,o=e.length,c=o-1;n<o;c=n++){var f=e[n],p=f[0],x=f[1],E=e[c],T=E[0],D=E[1];if(Xxt(f,E,t))return 0;x>i!=D>i&&r<(T-p)*(i-x)/(D-x)+p&&(s=-s)}return s}function Xxt(e,t,r){var i;return Zxt(e,t,r)&&Gxt(e[i=+(e[0]===t[0])],r[i],t[i])}function Zxt(e,t,r){return(t[0]-e[0])*(r[1]-e[1])===(r[0]-e[0])*(t[1]-e[1])}function Gxt(e,t,r){return e<=t&&t<=r||r<=t&&t<=e}function IZ(){}var Wd=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function l3(){var e=1,t=1,r=t1,i=f;function s(p){var x=r(p);if(Array.isArray(x))x=x.slice().sort(TZ);else{let E=Od(p,Qxt);for(x=mc(...Jg(E[0],E[1],x),x);x[x.length-1]>=E[1];)x.pop();for(;x[1]<E[0];)x.shift()}return x.map(E=>n(p,E))}function n(p,x){let E=x==null?NaN:+x;if(isNaN(E))throw new Error(`invalid value: ${x}`);var T=[],D=[];return o(p,E,function(N){i(N,p,E),SZ(N)>0?T.push([N]):D.push(N)}),D.forEach(function(N){for(var z=0,U=T.length,H;z<U;++z)if(EZ((H=T[z])[0],N)!==-1){H.push(N);return}}),{type:"MultiPolygon",value:x,coordinates:T}}function o(p,x,E){var T=new Array,D=new Array,N,z,U,H,G,Z;for(N=z=-1,H=_1(p[0],x),Wd[H<<1].forEach(Y);++N<e-1;)U=H,H=_1(p[N+1],x),Wd[U|H<<1].forEach(Y);for(Wd[H<<0].forEach(Y);++z<t-1;){for(N=-1,H=_1(p[z*e+e],x),G=_1(p[z*e],x),Wd[H<<1|G<<2].forEach(Y);++N<e-1;)U=H,H=_1(p[z*e+e+N+1],x),Z=G,G=_1(p[z*e+N+1],x),Wd[U|H<<1|G<<2|Z<<3].forEach(Y);Wd[H|G<<3].forEach(Y)}for(N=-1,G=p[z*e]>=x,Wd[G<<2].forEach(Y);++N<e-1;)Z=G,G=_1(p[z*e+N+1],x),Wd[G<<2|Z<<3].forEach(Y);Wd[G<<3].forEach(Y);function Y(st){var at=[st[0][0]+N,st[0][1]+z],Dt=[st[1][0]+N,st[1][1]+z],Tt=c(at),kt=c(Dt),Et,Mt;(Et=D[Tt])?(Mt=T[kt])?(delete D[Et.end],delete T[Mt.start],Et===Mt?(Et.ring.push(Dt),E(Et.ring)):T[Et.start]=D[Mt.end]={start:Et.start,end:Mt.end,ring:Et.ring.concat(Mt.ring)}):(delete D[Et.end],Et.ring.push(Dt),D[Et.end=kt]=Et):(Et=T[kt])?(Mt=D[Tt])?(delete T[Et.start],delete D[Mt.end],Et===Mt?(Et.ring.push(Dt),E(Et.ring)):T[Mt.start]=D[Et.end]={start:Mt.start,end:Et.end,ring:Mt.ring.concat(Et.ring)}):(delete T[Et.start],Et.ring.unshift(at),T[Et.start=Tt]=Et):T[Tt]=D[kt]={start:Tt,end:kt,ring:[at,Dt]}}}function c(p){return p[0]*2+p[1]*(e+1)*4}function f(p,x,E){p.forEach(function(T){var D=T[0],N=T[1],z=D|0,U=N|0,H=wB(x[U*e+z]);D>0&&D<e&&z===D&&(T[0]=MZ(D,wB(x[U*e+z-1]),H,E)),N>0&&N<t&&U===N&&(T[1]=MZ(N,wB(x[(U-1)*e+z]),H,E))})}return s.contour=n,s.size=function(p){if(!arguments.length)return[e,t];var x=Math.floor(p[0]),E=Math.floor(p[1]);if(!(x>=0&&E>=0))throw new Error("invalid size");return e=x,t=E,s},s.thresholds=function(p){return arguments.length?(r=typeof p=="function"?p:Array.isArray(p)?ap(n6.call(p)):ap(p),s):r},s.smooth=function(p){return arguments.length?(i=p?f:IZ,s):i===f},s}function Qxt(e){return isFinite(e)?e:NaN}function _1(e,t){return e==null?!1:+e>=t}function wB(e){return e==null||isNaN(e=+e)?-1/0:e}function MZ(e,t,r,i){let s=i-t,n=r-t,o=isFinite(s)||isFinite(n)?s/n:Math.sign(s)/Math.sign(n);return isNaN(o)?e:e+o-.5}function Kxt(e){return e[0]}function Jxt(e){return e[1]}function tbt(){return 1}function CZ(){var e=Kxt,t=Jxt,r=tbt,i=960,s=500,n=20,o=2,c=n*3,f=i+c*2>>o,p=s+c*2>>o,x=ap(20);function E(G){var Z=new Float32Array(f*p),Y=Math.pow(2,-o),st=-1;for(let Xt of G){var at=(e(Xt,++st,G)+c)*Y,Dt=(t(Xt,st,G)+c)*Y,Tt=+r(Xt,st,G);if(Tt&&at>=0&&at<f&&Dt>=0&&Dt<p){var kt=Math.floor(at),Et=Math.floor(Dt),Mt=at-kt-.5,oe=Dt-Et-.5;Z[kt+Et*f]+=(1-Mt)*(1-oe)*Tt,Z[kt+1+Et*f]+=Mt*(1-oe)*Tt,Z[kt+1+(Et+1)*f]+=Mt*oe*Tt,Z[kt+(Et+1)*f]+=(1-Mt)*oe*Tt}}return lE({data:Z,width:f,height:p},n*Y),Z}function T(G){var Z=E(G),Y=x(Z),st=Math.pow(2,2*o);return Array.isArray(Y)||(Y=mc(Number.MIN_VALUE,Ld(Z)/st,Y)),l3().size([f,p]).thresholds(Y.map(at=>at*st))(Z).map((at,Dt)=>(at.value=+Y[Dt],D(at)))}T.contours=function(G){var Z=E(G),Y=l3().size([f,p]),st=Math.pow(2,2*o),at=Dt=>{Dt=+Dt;var Tt=D(Y.contour(Z,Dt*st));return Tt.value=Dt,Tt};return Object.defineProperty(at,"max",{get:()=>Ld(Z)/st}),at};function D(G){return G.coordinates.forEach(N),G}function N(G){G.forEach(z)}function z(G){G.forEach(U)}function U(G){G[0]=G[0]*Math.pow(2,o)-c,G[1]=G[1]*Math.pow(2,o)-c}function H(){return c=n*3,f=i+c*2>>o,p=s+c*2>>o,T}return T.x=function(G){return arguments.length?(e=typeof G=="function"?G:ap(+G),T):e},T.y=function(G){return arguments.length?(t=typeof G=="function"?G:ap(+G),T):t},T.weight=function(G){return arguments.length?(r=typeof G=="function"?G:ap(+G),T):r},T.size=function(G){if(!arguments.length)return[i,s];var Z=+G[0],Y=+G[1];if(!(Z>=0&&Y>=0))throw new Error("invalid size");return i=Z,s=Y,H()},T.cellSize=function(G){if(!arguments.length)return 1<<o;if(!((G=+G)>=1))throw new Error("invalid cell size");return o=Math.floor(Math.log(G)/Math.LN2),H()},T.thresholds=function(G){return arguments.length?(x=typeof G=="function"?G:Array.isArray(G)?ap(n6.call(G)):ap(G),T):x},T.bandwidth=function(G){if(!arguments.length)return Math.sqrt(n*(n+1));if(!((G=+G)>=0))throw new Error("invalid bandwidth");return n=(Math.sqrt(4*G*G+1)-1)/2,H()},T}var Sn=11102230246251565e-32,Fo=134217729,c3=(3+8*Sn)*Sn;function y1(e,t,r,i,s){let n,o,c,f,p=t[0],x=i[0],E=0,T=0;x>p==x>-p?(n=p,p=t[++E]):(n=x,x=i[++T]);let D=0;if(E<e&&T<r)for(x>p==x>-p?(o=p+n,c=n-(o-p),p=t[++E]):(o=x+n,c=n-(o-x),x=i[++T]),n=o,c!==0&&(s[D++]=c);E<e&&T<r;)x>p==x>-p?(o=n+p,f=o-n,c=n-(o-f)+(p-f),p=t[++E]):(o=n+x,f=o-n,c=n-(o-f)+(x-f),x=i[++T]),n=o,c!==0&&(s[D++]=c);for(;E<e;)o=n+p,f=o-n,c=n-(o-f)+(p-f),p=t[++E],n=o,c!==0&&(s[D++]=c);for(;T<r;)o=n+x,f=o-n,c=n-(o-f)+(x-f),x=i[++T],n=o,c!==0&&(s[D++]=c);return(n!==0||D===0)&&(s[D++]=n),D}function u3(e,t){let r=t[0];for(let i=1;i<e;i++)r+=t[i];return r}function Be(e){return new Float64Array(e)}var ebt=(3+16*Sn)*Sn,rbt=(2+12*Sn)*Sn,ibt=(9+64*Sn)*Sn*Sn,m2=Be(4),PZ=Be(8),RZ=Be(12),kZ=Be(16),Fl=Be(4);function nbt(e,t,r,i,s,n,o){let c,f,p,x,E,T,D,N,z,U,H,G,Z,Y,st,at,Dt,Tt,kt=e-s,Et=r-s,Mt=t-n,oe=i-n;Y=kt*oe,T=Fo*kt,D=T-(T-kt),N=kt-D,T=Fo*oe,z=T-(T-oe),U=oe-z,st=N*U-(Y-D*z-N*z-D*U),at=Mt*Et,T=Fo*Mt,D=T-(T-Mt),N=Mt-D,T=Fo*Et,z=T-(T-Et),U=Et-z,Dt=N*U-(at-D*z-N*z-D*U),H=st-Dt,E=st-H,m2[0]=st-(H+E)+(E-Dt),G=Y+H,E=G-Y,Z=Y-(G-E)+(H-E),H=Z-at,E=Z-H,m2[1]=Z-(H+E)+(E-at),Tt=G+H,E=Tt-G,m2[2]=G-(Tt-E)+(H-E),m2[3]=Tt;let Xt=u3(4,m2),xt=rbt*o;if(Xt>=xt||-Xt>=xt||(E=e-kt,c=e-(kt+E)+(E-s),E=r-Et,p=r-(Et+E)+(E-s),E=t-Mt,f=t-(Mt+E)+(E-n),E=i-oe,x=i-(oe+E)+(E-n),c===0&&f===0&&p===0&&x===0)||(xt=ibt*o+c3*Math.abs(Xt),Xt+=kt*x+oe*c-(Mt*p+Et*f),Xt>=xt||-Xt>=xt))return Xt;Y=c*oe,T=Fo*c,D=T-(T-c),N=c-D,T=Fo*oe,z=T-(T-oe),U=oe-z,st=N*U-(Y-D*z-N*z-D*U),at=f*Et,T=Fo*f,D=T-(T-f),N=f-D,T=Fo*Et,z=T-(T-Et),U=Et-z,Dt=N*U-(at-D*z-N*z-D*U),H=st-Dt,E=st-H,Fl[0]=st-(H+E)+(E-Dt),G=Y+H,E=G-Y,Z=Y-(G-E)+(H-E),H=Z-at,E=Z-H,Fl[1]=Z-(H+E)+(E-at),Tt=G+H,E=Tt-G,Fl[2]=G-(Tt-E)+(H-E),Fl[3]=Tt;let jt=y1(4,m2,4,Fl,PZ);Y=kt*x,T=Fo*kt,D=T-(T-kt),N=kt-D,T=Fo*x,z=T-(T-x),U=x-z,st=N*U-(Y-D*z-N*z-D*U),at=Mt*p,T=Fo*Mt,D=T-(T-Mt),N=Mt-D,T=Fo*p,z=T-(T-p),U=p-z,Dt=N*U-(at-D*z-N*z-D*U),H=st-Dt,E=st-H,Fl[0]=st-(H+E)+(E-Dt),G=Y+H,E=G-Y,Z=Y-(G-E)+(H-E),H=Z-at,E=Z-H,Fl[1]=Z-(H+E)+(E-at),Tt=G+H,E=Tt-G,Fl[2]=G-(Tt-E)+(H-E),Fl[3]=Tt;let Wt=y1(jt,PZ,4,Fl,RZ);Y=c*x,T=Fo*c,D=T-(T-c),N=c-D,T=Fo*x,z=T-(T-x),U=x-z,st=N*U-(Y-D*z-N*z-D*U),at=f*p,T=Fo*f,D=T-(T-f),N=f-D,T=Fo*p,z=T-(T-p),U=p-z,Dt=N*U-(at-D*z-N*z-D*U),H=st-Dt,E=st-H,Fl[0]=st-(H+E)+(E-Dt),G=Y+H,E=G-Y,Z=Y-(G-E)+(H-E),H=Z-at,E=Z-H,Fl[1]=Z-(H+E)+(E-at),Tt=G+H,E=Tt-G,Fl[2]=G-(Tt-E)+(H-E),Fl[3]=Tt;let de=y1(Wt,RZ,4,Fl,kZ);return kZ[de-1]}function g2(e,t,r,i,s,n){let o=(t-n)*(r-s),c=(e-s)*(i-n),f=o-c,p=Math.abs(o+c);return Math.abs(f)>=ebt*p?f:-nbt(e,t,r,i,s,n,p)}var Ere=(7+56*Sn)*Sn,Ire=(3+28*Sn)*Sn,Mre=(26+288*Sn)*Sn*Sn,Cre=Be(4),Pre=Be(4),Rre=Be(4),kre=Be(4),Dre=Be(4),Bre=Be(4),Ore=Be(4),Nre=Be(4),Fre=Be(4),Lre=Be(8),zre=Be(8),Ure=Be(8),Vre=Be(4),jre=Be(8),$re=Be(8),Hre=Be(8),Wre=Be(12),qre=Be(192),Yre=Be(192);var Gre=(10+96*Sn)*Sn,Qre=(4+48*Sn)*Sn,Kre=(44+576*Sn)*Sn*Sn,Jre=Be(4),tie=Be(4),eie=Be(4),rie=Be(4),iie=Be(4),nie=Be(4),sie=Be(4),oie=Be(4),aie=Be(8),lie=Be(8),cie=Be(8),uie=Be(8),hie=Be(8),fie=Be(8),pie=Be(8),die=Be(8),Aie=Be(8),mie=Be(4),gie=Be(4),_ie=Be(4),yie=Be(8),xie=Be(16),bie=Be(16),vie=Be(16),wie=Be(32),Tie=Be(32),Sie=Be(48),Eie=Be(64),Iie=Be(1152),Mie=Be(1152);var kie=(16+224*Sn)*Sn,Die=(5+72*Sn)*Sn,Bie=(71+1408*Sn)*Sn*Sn,Oie=Be(4),Nie=Be(4),Fie=Be(4),Lie=Be(4),zie=Be(4),Uie=Be(4),Vie=Be(4),jie=Be(4),$ie=Be(4),Hie=Be(4),Wie=Be(24),qie=Be(24),Yie=Be(24),Xie=Be(24),Zie=Be(24),Gie=Be(24),Qie=Be(24),Kie=Be(24),Jie=Be(24),tne=Be(24),ene=Be(1152),rne=Be(1152),ine=Be(1152),nne=Be(1152),sne=Be(1152),one=Be(2304),ane=Be(2304),lne=Be(3456),cne=Be(5760),une=Be(8),hne=Be(8),fne=Be(8),pne=Be(16),dne=Be(24),Ane=Be(48),mne=Be(48),gne=Be(96),_ne=Be(192),yne=Be(384),xne=Be(384),bne=Be(384),vne=Be(768);var wne=Be(96),Tne=Be(96),Sne=Be(96),Ene=Be(1152);var BZ=Math.pow(2,-52),s6=new Uint32Array(512),y2=class e{static from(t,r=ubt,i=hbt){let s=t.length,n=new Float64Array(s*2);for(let o=0;o<s;o++){let c=t[o];n[2*o]=r(c),n[2*o+1]=i(c)}return new e(n)}constructor(t){let r=t.length>>1;if(r>0&&typeof t[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=t;let i=Math.max(2*r-5,0);this._triangles=new Uint32Array(i*3),this._halfedges=new Int32Array(i*3),this._hashSize=Math.ceil(Math.sqrt(r)),this._hullPrev=new Uint32Array(r),this._hullNext=new Uint32Array(r),this._hullTri=new Uint32Array(r),this._hullHash=new Int32Array(this._hashSize),this._ids=new Uint32Array(r),this._dists=new Float64Array(r),this.update()}update(){let{coords:t,_hullPrev:r,_hullNext:i,_hullTri:s,_hullHash:n}=this,o=t.length>>1,c=1/0,f=1/0,p=-1/0,x=-1/0;for(let kt=0;kt<o;kt++){let Et=t[2*kt],Mt=t[2*kt+1];Et<c&&(c=Et),Mt<f&&(f=Mt),Et>p&&(p=Et),Mt>x&&(x=Mt),this._ids[kt]=kt}let E=(c+p)/2,T=(f+x)/2,D,N,z;for(let kt=0,Et=1/0;kt<o;kt++){let Mt=TB(E,T,t[2*kt],t[2*kt+1]);Mt<Et&&(D=kt,Et=Mt)}let U=t[2*D],H=t[2*D+1];for(let kt=0,Et=1/0;kt<o;kt++){if(kt===D)continue;let Mt=TB(U,H,t[2*kt],t[2*kt+1]);Mt<Et&&Mt>0&&(N=kt,Et=Mt)}let G=t[2*N],Z=t[2*N+1],Y=1/0;for(let kt=0;kt<o;kt++){if(kt===D||kt===N)continue;let Et=lbt(U,H,G,Z,t[2*kt],t[2*kt+1]);Et<Y&&(z=kt,Y=Et)}let st=t[2*z],at=t[2*z+1];if(Y===1/0){for(let Mt=0;Mt<o;Mt++)this._dists[Mt]=t[2*Mt]-t[0]||t[2*Mt+1]-t[1];_2(this._ids,this._dists,0,o-1);let kt=new Uint32Array(o),Et=0;for(let Mt=0,oe=-1/0;Mt<o;Mt++){let Xt=this._ids[Mt],xt=this._dists[Xt];xt>oe&&(kt[Et++]=Xt,oe=xt)}this.hull=kt.subarray(0,Et),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(g2(U,H,G,Z,st,at)<0){let kt=N,Et=G,Mt=Z;N=z,G=st,Z=at,z=kt,st=Et,at=Mt}let Dt=cbt(U,H,G,Z,st,at);this._cx=Dt.x,this._cy=Dt.y;for(let kt=0;kt<o;kt++)this._dists[kt]=TB(t[2*kt],t[2*kt+1],Dt.x,Dt.y);_2(this._ids,this._dists,0,o-1),this._hullStart=D;let Tt=3;i[D]=r[z]=N,i[N]=r[D]=z,i[z]=r[N]=D,s[D]=0,s[N]=1,s[z]=2,n.fill(-1),n[this._hashKey(U,H)]=D,n[this._hashKey(G,Z)]=N,n[this._hashKey(st,at)]=z,this.trianglesLen=0,this._addTriangle(D,N,z,-1,-1,-1);for(let kt=0,Et,Mt;kt<this._ids.length;kt++){let oe=this._ids[kt],Xt=t[2*oe],xt=t[2*oe+1];if(kt>0&&Math.abs(Xt-Et)<=BZ&&Math.abs(xt-Mt)<=BZ||(Et=Xt,Mt=xt,oe===D||oe===N||oe===z))continue;let jt=0;for(let ze=0,ke=this._hashKey(Xt,xt);ze<this._hashSize&&(jt=n[(ke+ze)%this._hashSize],!(jt!==-1&&jt!==i[jt]));ze++);jt=r[jt];let Wt=jt,de;for(;de=i[Wt],g2(Xt,xt,t[2*Wt],t[2*Wt+1],t[2*de],t[2*de+1])>=0;)if(Wt=de,Wt===jt){Wt=-1;break}if(Wt===-1)continue;let Ee=this._addTriangle(Wt,oe,i[Wt],-1,-1,s[Wt]);s[oe]=this._legalize(Ee+2),s[Wt]=Ee,Tt++;let Se=i[Wt];for(;de=i[Se],g2(Xt,xt,t[2*Se],t[2*Se+1],t[2*de],t[2*de+1])<0;)Ee=this._addTriangle(Se,oe,de,s[oe],-1,s[Se]),s[oe]=this._legalize(Ee+2),i[Se]=Se,Tt--,Se=de;if(Wt===jt)for(;de=r[Wt],g2(Xt,xt,t[2*de],t[2*de+1],t[2*Wt],t[2*Wt+1])<0;)Ee=this._addTriangle(de,oe,Wt,-1,s[Wt],s[de]),this._legalize(Ee+2),s[de]=Ee,i[Wt]=Wt,Tt--,Wt=de;this._hullStart=r[oe]=Wt,i[Wt]=r[Se]=oe,i[oe]=Se,n[this._hashKey(Xt,xt)]=oe,n[this._hashKey(t[2*Wt],t[2*Wt+1])]=Wt}this.hull=new Uint32Array(Tt);for(let kt=0,Et=this._hullStart;kt<Tt;kt++)this.hull[kt]=Et,Et=i[Et];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,r){return Math.floor(obt(t-this._cx,r-this._cy)*this._hashSize)%this._hashSize}_legalize(t){let{_triangles:r,_halfedges:i,coords:s}=this,n=0,o=0;for(;;){let c=i[t],f=t-t%3;if(o=f+(t+2)%3,c===-1){if(n===0)break;t=s6[--n];continue}let p=c-c%3,x=f+(t+1)%3,E=p+(c+2)%3,T=r[o],D=r[t],N=r[x],z=r[E];if(abt(s[2*T],s[2*T+1],s[2*D],s[2*D+1],s[2*N],s[2*N+1],s[2*z],s[2*z+1])){r[t]=z,r[c]=T;let H=i[E];if(H===-1){let Z=this._hullStart;do{if(this._hullTri[Z]===E){this._hullTri[Z]=t;break}Z=this._hullPrev[Z]}while(Z!==this._hullStart)}this._link(t,H),this._link(c,i[o]),this._link(o,E);let G=p+(c+1)%3;n<s6.length&&(s6[n++]=G)}else{if(n===0)break;t=s6[--n]}}return o}_link(t,r){this._halfedges[t]=r,r!==-1&&(this._halfedges[r]=t)}_addTriangle(t,r,i,s,n,o){let c=this.trianglesLen;return this._triangles[c]=t,this._triangles[c+1]=r,this._triangles[c+2]=i,this._link(c,s),this._link(c+1,n),this._link(c+2,o),this.trianglesLen+=3,c}};function obt(e,t){let r=e/(Math.abs(e)+Math.abs(t));return(t>0?3-r:1+r)/4}function TB(e,t,r,i){let s=e-r,n=t-i;return s*s+n*n}function abt(e,t,r,i,s,n,o,c){let f=e-o,p=t-c,x=r-o,E=i-c,T=s-o,D=n-c,N=f*f+p*p,z=x*x+E*E,U=T*T+D*D;return f*(E*U-z*D)-p*(x*U-z*T)+N*(x*D-E*T)<0}function lbt(e,t,r,i,s,n){let o=r-e,c=i-t,f=s-e,p=n-t,x=o*o+c*c,E=f*f+p*p,T=.5/(o*p-c*f),D=(p*x-c*E)*T,N=(o*E-f*x)*T;return D*D+N*N}function cbt(e,t,r,i,s,n){let o=r-e,c=i-t,f=s-e,p=n-t,x=o*o+c*c,E=f*f+p*p,T=.5/(o*p-c*f),D=e+(p*x-c*E)*T,N=t+(o*E-f*x)*T;return{x:D,y:N}}function _2(e,t,r,i){if(i-r<=20)for(let s=r+1;s<=i;s++){let n=e[s],o=t[n],c=s-1;for(;c>=r&&t[e[c]]>o;)e[c+1]=e[c--];e[c+1]=n}else{let s=r+i>>1,n=r+1,o=i;h3(e,s,n),t[e[r]]>t[e[i]]&&h3(e,r,i),t[e[n]]>t[e[i]]&&h3(e,n,i),t[e[r]]>t[e[n]]&&h3(e,r,n);let c=e[n],f=t[c];for(;;){do n++;while(t[e[n]]<f);do o--;while(t[e[o]]>f);if(o<n)break;h3(e,n,o)}e[r+1]=e[o],e[o]=c,i-n+1>=o-r?(_2(e,t,n,i),_2(e,t,r,o-1)):(_2(e,t,r,o-1),_2(e,t,n,i))}}function h3(e,t,r){let i=e[t];e[t]=e[r],e[r]=i}function ubt(e){return e[0]}function hbt(e){return e[1]}var $u=class{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(t,r){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(t,r){this._+=`L${this._x1=+t},${this._y1=+r}`}arc(t,r,i){t=+t,r=+r,i=+i;let s=t+i,n=r;if(i<0)throw new Error("negative radius");this._x1===null?this._+=`M${s},${n}`:(Math.abs(this._x1-s)>1e-6||Math.abs(this._y1-n)>1e-6)&&(this._+="L"+s+","+n),i&&(this._+=`A${i},${i},0,1,1,${t-i},${r}A${i},${i},0,1,1,${this._x1=s},${this._y1=n}`)}rect(t,r,i,s){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${+i}v${+s}h${-i}Z`}value(){return this._||null}};var qA=class{constructor(){this._=[]}moveTo(t,r){this._.push([t,r])}closePath(){this._.push(this._[0].slice())}lineTo(t,r){this._.push([t,r])}value(){return this._.length?this._:null}};var x1=class{constructor(t,[r,i,s,n]=[0,0,960,500]){if(!((s=+s)>=(r=+r))||!((n=+n)>=(i=+i)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(t.points.length*2),this.vectors=new Float64Array(t.points.length*2),this.xmax=s,this.xmin=r,this.ymax=n,this.ymin=i,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){let{delaunay:{points:t,hull:r,triangles:i},vectors:s}=this,n,o,c=this.circumcenters=this._circumcenters.subarray(0,i.length/3*2);for(let z=0,U=0,H=i.length,G,Z;z<H;z+=3,U+=2){let Y=i[z]*2,st=i[z+1]*2,at=i[z+2]*2,Dt=t[Y],Tt=t[Y+1],kt=t[st],Et=t[st+1],Mt=t[at],oe=t[at+1],Xt=kt-Dt,xt=Et-Tt,jt=Mt-Dt,Wt=oe-Tt,de=(Xt*Wt-xt*jt)*2;if(Math.abs(de)<1e-9){if(n===void 0){n=o=0;for(let Se of r)n+=t[Se*2],o+=t[Se*2+1];n/=r.length,o/=r.length}let Ee=1e9*Math.sign((n-Dt)*Wt-(o-Tt)*jt);G=(Dt+Mt)/2-Ee*Wt,Z=(Tt+oe)/2+Ee*jt}else{let Ee=1/de,Se=Xt*Xt+xt*xt,ze=jt*jt+Wt*Wt;G=Dt+(Wt*Se-xt*ze)*Ee,Z=Tt+(Xt*ze-jt*Se)*Ee}c[U]=G,c[U+1]=Z}let f=r[r.length-1],p,x=f*4,E,T=t[2*f],D,N=t[2*f+1];s.fill(0);for(let z=0;z<r.length;++z)f=r[z],p=x,E=T,D=N,x=f*4,T=t[2*f],N=t[2*f+1],s[p+2]=s[x]=D-N,s[p+3]=s[x+1]=T-E}render(t){let r=t==null?t=new $u:void 0,{delaunay:{halfedges:i,inedges:s,hull:n},circumcenters:o,vectors:c}=this;if(n.length<=1)return null;for(let x=0,E=i.length;x<E;++x){let T=i[x];if(T<x)continue;let D=Math.floor(x/3)*2,N=Math.floor(T/3)*2,z=o[D],U=o[D+1],H=o[N],G=o[N+1];this._renderSegment(z,U,H,G,t)}let f,p=n[n.length-1];for(let x=0;x<n.length;++x){f=p,p=n[x];let E=Math.floor(s[p]/3)*2,T=o[E],D=o[E+1],N=f*4,z=this._project(T,D,c[N+2],c[N+3]);z&&this._renderSegment(T,D,z[0],z[1],t)}return r&&r.value()}renderBounds(t){let r=t==null?t=new $u:void 0;return t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),r&&r.value()}renderCell(t,r){let i=r==null?r=new $u:void 0,s=this._clip(t);if(s===null||!s.length)return;r.moveTo(s[0],s[1]);let n=s.length;for(;s[0]===s[n-2]&&s[1]===s[n-1]&&n>1;)n-=2;for(let o=2;o<n;o+=2)(s[o]!==s[o-2]||s[o+1]!==s[o-1])&&r.lineTo(s[o],s[o+1]);return r.closePath(),i&&i.value()}*cellPolygons(){let{delaunay:{points:t}}=this;for(let r=0,i=t.length/2;r<i;++r){let s=this.cellPolygon(r);s&&(s.index=r,yield s)}}cellPolygon(t){let r=new qA;return this.renderCell(t,r),r.value()}_renderSegment(t,r,i,s,n){let o,c=this._regioncode(t,r),f=this._regioncode(i,s);c===0&&f===0?(n.moveTo(t,r),n.lineTo(i,s)):(o=this._clipSegment(t,r,i,s,c,f))&&(n.moveTo(o[0],o[1]),n.lineTo(o[2],o[3]))}contains(t,r,i){return r=+r,r!==r||(i=+i,i!==i)?!1:this.delaunay._step(t,r,i)===t}*neighbors(t){let r=this._clip(t);if(r)for(let i of this.delaunay.neighbors(t)){let s=this._clip(i);if(s){t:for(let n=0,o=r.length;n<o;n+=2)for(let c=0,f=s.length;c<f;c+=2)if(r[n]===s[c]&&r[n+1]===s[c+1]&&r[(n+2)%o]===s[(c+f-2)%f]&&r[(n+3)%o]===s[(c+f-1)%f]){yield i;break t}}}}_cell(t){let{circumcenters:r,delaunay:{inedges:i,halfedges:s,triangles:n}}=this,o=i[t];if(o===-1)return null;let c=[],f=o;do{let p=Math.floor(f/3);if(c.push(r[p*2],r[p*2+1]),f=f%3===2?f-2:f+1,n[f]!==t)break;f=s[f]}while(f!==o&&f!==-1);return c}_clip(t){if(t===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];let r=this._cell(t);if(r===null)return null;let{vectors:i}=this,s=t*4;return this._simplify(i[s]||i[s+1]?this._clipInfinite(t,r,i[s],i[s+1],i[s+2],i[s+3]):this._clipFinite(t,r))}_clipFinite(t,r){let i=r.length,s=null,n,o,c=r[i-2],f=r[i-1],p,x=this._regioncode(c,f),E,T=0;for(let D=0;D<i;D+=2)if(n=c,o=f,c=r[D],f=r[D+1],p=x,x=this._regioncode(c,f),p===0&&x===0)E=T,T=0,s?s.push(c,f):s=[c,f];else{let N,z,U,H,G;if(p===0){if((N=this._clipSegment(n,o,c,f,p,x))===null)continue;[z,U,H,G]=N}else{if((N=this._clipSegment(c,f,n,o,x,p))===null)continue;[H,G,z,U]=N,E=T,T=this._edgecode(z,U),E&&T&&this._edge(t,E,T,s,s.length),s?s.push(z,U):s=[z,U]}E=T,T=this._edgecode(H,G),E&&T&&this._edge(t,E,T,s,s.length),s?s.push(H,G):s=[H,G]}if(s)E=T,T=this._edgecode(s[0],s[1]),E&&T&&this._edge(t,E,T,s,s.length);else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return s}_clipSegment(t,r,i,s,n,o){let c=n<o;for(c&&([t,r,i,s,n,o]=[i,s,t,r,o,n]);;){if(n===0&&o===0)return c?[i,s,t,r]:[t,r,i,s];if(n&o)return null;let f,p,x=n||o;x&8?(f=t+(i-t)*(this.ymax-r)/(s-r),p=this.ymax):x&4?(f=t+(i-t)*(this.ymin-r)/(s-r),p=this.ymin):x&2?(p=r+(s-r)*(this.xmax-t)/(i-t),f=this.xmax):(p=r+(s-r)*(this.xmin-t)/(i-t),f=this.xmin),n?(t=f,r=p,n=this._regioncode(t,r)):(i=f,s=p,o=this._regioncode(i,s))}}_clipInfinite(t,r,i,s,n,o){let c=Array.from(r),f;if((f=this._project(c[0],c[1],i,s))&&c.unshift(f[0],f[1]),(f=this._project(c[c.length-2],c[c.length-1],n,o))&&c.push(f[0],f[1]),c=this._clipFinite(t,c))for(let p=0,x=c.length,E,T=this._edgecode(c[x-2],c[x-1]);p<x;p+=2)E=T,T=this._edgecode(c[p],c[p+1]),E&&T&&(p=this._edge(t,E,T,c,p),x=c.length);else this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(c=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return c}_edge(t,r,i,s,n){for(;r!==i;){let o,c;switch(r){case 5:r=4;continue;case 4:r=6,o=this.xmax,c=this.ymin;break;case 6:r=2;continue;case 2:r=10,o=this.xmax,c=this.ymax;break;case 10:r=8;continue;case 8:r=9,o=this.xmin,c=this.ymax;break;case 9:r=1;continue;case 1:r=5,o=this.xmin,c=this.ymin;break}(s[n]!==o||s[n+1]!==c)&&this.contains(t,o,c)&&(s.splice(n,0,o,c),n+=2)}return n}_project(t,r,i,s){let n=1/0,o,c,f;if(s<0){if(r<=this.ymin)return null;(o=(this.ymin-r)/s)<n&&(f=this.ymin,c=t+(n=o)*i)}else if(s>0){if(r>=this.ymax)return null;(o=(this.ymax-r)/s)<n&&(f=this.ymax,c=t+(n=o)*i)}if(i>0){if(t>=this.xmax)return null;(o=(this.xmax-t)/i)<n&&(c=this.xmax,f=r+(n=o)*s)}else if(i<0){if(t<=this.xmin)return null;(o=(this.xmin-t)/i)<n&&(c=this.xmin,f=r+(n=o)*s)}return[c,f]}_edgecode(t,r){return(t===this.xmin?1:t===this.xmax?2:0)|(r===this.ymin?4:r===this.ymax?8:0)}_regioncode(t,r){return(t<this.xmin?1:t>this.xmax?2:0)|(r<this.ymin?4:r>this.ymax?8:0)}_simplify(t){if(t&&t.length>4){for(let r=0;r<t.length;r+=2){let i=(r+2)%t.length,s=(r+4)%t.length;(t[r]===t[i]&&t[i]===t[s]||t[r+1]===t[i+1]&&t[i+1]===t[s+1])&&(t.splice(i,2),r-=2)}t.length||(t=null)}return t}};var fbt=2*Math.PI,x2=Math.pow;function pbt(e){return e[0]}function dbt(e){return e[1]}function Abt(e){let{triangles:t,coords:r}=e;for(let i=0;i<t.length;i+=3){let s=2*t[i],n=2*t[i+1],o=2*t[i+2];if((r[o]-r[s])*(r[n+1]-r[s+1])-(r[n]-r[s])*(r[o+1]-r[s+1])>1e-10)return!1}return!0}function mbt(e,t,r){return[e+Math.sin(e+t)*r,t+Math.cos(e-t)*r]}var f3=class e{static from(t,r=pbt,i=dbt,s){return new e("length"in t?gbt(t,r,i,s):Float64Array.from(_bt(t,r,i,s)))}constructor(t){this._delaunator=new y2(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){let t=this._delaunator,r=this.points;if(t.hull&&t.hull.length>2&&Abt(t)){this.collinear=Int32Array.from({length:r.length/2},(T,D)=>D).sort((T,D)=>r[2*T]-r[2*D]||r[2*T+1]-r[2*D+1]);let f=this.collinear[0],p=this.collinear[this.collinear.length-1],x=[r[2*f],r[2*f+1],r[2*p],r[2*p+1]],E=1e-8*Math.hypot(x[3]-x[1],x[2]-x[0]);for(let T=0,D=r.length/2;T<D;++T){let N=mbt(r[2*T],r[2*T+1],E);r[2*T]=N[0],r[2*T+1]=N[1]}this._delaunator=new y2(r)}else delete this.collinear;let i=this.halfedges=this._delaunator.halfedges,s=this.hull=this._delaunator.hull,n=this.triangles=this._delaunator.triangles,o=this.inedges.fill(-1),c=this._hullIndex.fill(-1);for(let f=0,p=i.length;f<p;++f){let x=n[f%3===2?f-2:f+1];(i[f]===-1||o[x]===-1)&&(o[x]=f)}for(let f=0,p=s.length;f<p;++f)c[s[f]]=f;s.length<=2&&s.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=s[0],o[s[0]]=1,s.length===2&&(o[s[1]]=0,this.triangles[1]=s[1],this.triangles[2]=s[1]))}voronoi(t){return new x1(this,t)}*neighbors(t){let{inedges:r,hull:i,_hullIndex:s,halfedges:n,triangles:o,collinear:c}=this;if(c){let E=c.indexOf(t);E>0&&(yield c[E-1]),E<c.length-1&&(yield c[E+1]);return}let f=r[t];if(f===-1)return;let p=f,x=-1;do{if(yield x=o[p],p=p%3===2?p-2:p+1,o[p]!==t)return;if(p=n[p],p===-1){let E=i[(s[t]+1)%i.length];E!==x&&(yield E);return}}while(p!==f)}find(t,r,i=0){if(t=+t,t!==t||(r=+r,r!==r))return-1;let s=i,n;for(;(n=this._step(i,t,r))>=0&&n!==i&&n!==s;)i=n;return n}_step(t,r,i){let{inedges:s,hull:n,_hullIndex:o,halfedges:c,triangles:f,points:p}=this;if(s[t]===-1||!p.length)return(t+1)%(p.length>>1);let x=t,E=x2(r-p[t*2],2)+x2(i-p[t*2+1],2),T=s[t],D=T;do{let N=f[D],z=x2(r-p[N*2],2)+x2(i-p[N*2+1],2);if(z<E&&(E=z,x=N),D=D%3===2?D-2:D+1,f[D]!==t)break;if(D=c[D],D===-1){if(D=n[(o[t]+1)%n.length],D!==N&&x2(r-p[D*2],2)+x2(i-p[D*2+1],2)<E)return D;break}}while(D!==T);return x}render(t){let r=t==null?t=new $u:void 0,{points:i,halfedges:s,triangles:n}=this;for(let o=0,c=s.length;o<c;++o){let f=s[o];if(f<o)continue;let p=n[o]*2,x=n[f]*2;t.moveTo(i[p],i[p+1]),t.lineTo(i[x],i[x+1])}return this.renderHull(t),r&&r.value()}renderPoints(t,r){r===void 0&&(!t||typeof t.moveTo!="function")&&(r=t,t=null),r=r==null?2:+r;let i=t==null?t=new $u:void 0,{points:s}=this;for(let n=0,o=s.length;n<o;n+=2){let c=s[n],f=s[n+1];t.moveTo(c+r,f),t.arc(c,f,r,0,fbt)}return i&&i.value()}renderHull(t){let r=t==null?t=new $u:void 0,{hull:i,points:s}=this,n=i[0]*2,o=i.length;t.moveTo(s[n],s[n+1]);for(let c=1;c<o;++c){let f=2*i[c];t.lineTo(s[f],s[f+1])}return t.closePath(),r&&r.value()}hullPolygon(){let t=new qA;return this.renderHull(t),t.value()}renderTriangle(t,r){let i=r==null?r=new $u:void 0,{points:s,triangles:n}=this,o=n[t*=3]*2,c=n[t+1]*2,f=n[t+2]*2;return r.moveTo(s[o],s[o+1]),r.lineTo(s[c],s[c+1]),r.lineTo(s[f],s[f+1]),r.closePath(),i&&i.value()}*trianglePolygons(){let{triangles:t}=this;for(let r=0,i=t.length/3;r<i;++r)yield this.trianglePolygon(r)}trianglePolygon(t){let r=new qA;return this.renderTriangle(t,r),r.value()}};function gbt(e,t,r,i){let s=e.length,n=new Float64Array(s*2);for(let o=0;o<s;++o){let c=e[o];n[o*2]=t.call(i,c,o,e),n[o*2+1]=r.call(i,c,o,e)}return n}function*_bt(e,t,r,i){let s=0;for(let n of e)yield t.call(i,n,s,e),yield r.call(i,n,s,e),++s}function ybt(e){if(!e.ok)throw new Error(e.status+" "+e.statusText);return e.blob()}function OZ(e,t){return fetch(e,t).then(ybt)}function xbt(e){if(!e.ok)throw new Error(e.status+" "+e.statusText);return e.arrayBuffer()}function NZ(e,t){return fetch(e,t).then(xbt)}function bbt(e){if(!e.ok)throw new Error(e.status+" "+e.statusText);return e.text()}function b1(e,t){return fetch(e,t).then(bbt)}function FZ(e){return function(t,r,i){return arguments.length===2&&typeof r=="function"&&(i=r,r=void 0),b1(t,r).then(function(s){return e(s,i)})}}function SB(e,t,r,i){arguments.length===3&&typeof r=="function"&&(i=r,r=void 0);var s=PA(e);return b1(t,r).then(function(n){return s.parse(n,i)})}var LZ=FZ(oE),zZ=FZ(aE);function UZ(e,t){return new Promise(function(r,i){var s=new Image;for(var n in t)s[n]=t[n];s.onerror=i,s.onload=function(){r(s)},s.src=e})}function vbt(e){if(!e.ok)throw new Error(e.status+" "+e.statusText);if(!(e.status===204||e.status===205))return e.json()}function VZ(e,t){return fetch(e,t).then(vbt)}function EB(e){return(t,r)=>b1(t,r).then(i=>new DOMParser().parseFromString(i,e))}var jZ=EB("application/xml"),$Z=EB("text/html"),HZ=EB("image/svg+xml");function WZ(e,t){var r,i=1;e==null&&(e=0),t==null&&(t=0);function s(){var n,o=r.length,c,f=0,p=0;for(n=0;n<o;++n)c=r[n],f+=c.x,p+=c.y;for(f=(f/o-e)*i,p=(p/o-t)*i,n=0;n<o;++n)c=r[n],c.x-=f,c.y-=p}return s.initialize=function(n){r=n},s.x=function(n){return arguments.length?(e=+n,s):e},s.y=function(n){return arguments.length?(t=+n,s):t},s.strength=function(n){return arguments.length?(i=+n,s):i},s}function qZ(e){let t=+this._x.call(null,e),r=+this._y.call(null,e);return YZ(this.cover(t,r),t,r,e)}function YZ(e,t,r,i){if(isNaN(t)||isNaN(r))return e;var s,n=e._root,o={data:i},c=e._x0,f=e._y0,p=e._x1,x=e._y1,E,T,D,N,z,U,H,G;if(!n)return e._root=o,e;for(;n.length;)if((z=t>=(E=(c+p)/2))?c=E:p=E,(U=r>=(T=(f+x)/2))?f=T:x=T,s=n,!(n=n[H=U<<1|z]))return s[H]=o,e;if(D=+e._x.call(null,n.data),N=+e._y.call(null,n.data),t===D&&r===N)return o.next=n,s?s[H]=o:e._root=o,e;do s=s?s[H]=new Array(4):e._root=new Array(4),(z=t>=(E=(c+p)/2))?c=E:p=E,(U=r>=(T=(f+x)/2))?f=T:x=T;while((H=U<<1|z)===(G=(N>=T)<<1|D>=E));return s[G]=n,s[H]=o,e}function XZ(e){var t,r,i=e.length,s,n,o=new Array(i),c=new Array(i),f=1/0,p=1/0,x=-1/0,E=-1/0;for(r=0;r<i;++r)isNaN(s=+this._x.call(null,t=e[r]))||isNaN(n=+this._y.call(null,t))||(o[r]=s,c[r]=n,s<f&&(f=s),s>x&&(x=s),n<p&&(p=n),n>E&&(E=n));if(f>x||p>E)return this;for(this.cover(f,p).cover(x,E),r=0;r<i;++r)YZ(this,o[r],c[r],e[r]);return this}function ZZ(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var r=this._x0,i=this._y0,s=this._x1,n=this._y1;if(isNaN(r))s=(r=Math.floor(e))+1,n=(i=Math.floor(t))+1;else{for(var o=s-r||1,c=this._root,f,p;r>e||e>=s||i>t||t>=n;)switch(p=(t<i)<<1|e<r,f=new Array(4),f[p]=c,c=f,o*=2,p){case 0:s=r+o,n=i+o;break;case 1:r=s-o,n=i+o;break;case 2:s=r+o,i=n-o;break;case 3:r=s-o,i=n-o;break}this._root&&this._root.length&&(this._root=c)}return this._x0=r,this._y0=i,this._x1=s,this._y1=n,this}function GZ(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function QZ(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function Aa(e,t,r,i,s){this.node=e,this.x0=t,this.y0=r,this.x1=i,this.y1=s}function KZ(e,t,r){var i,s=this._x0,n=this._y0,o,c,f,p,x=this._x1,E=this._y1,T=[],D=this._root,N,z;for(D&&T.push(new Aa(D,s,n,x,E)),r==null?r=1/0:(s=e-r,n=t-r,x=e+r,E=t+r,r*=r);N=T.pop();)if(!(!(D=N.node)||(o=N.x0)>x||(c=N.y0)>E||(f=N.x1)<s||(p=N.y1)<n))if(D.length){var U=(o+f)/2,H=(c+p)/2;T.push(new Aa(D[3],U,H,f,p),new Aa(D[2],o,H,U,p),new Aa(D[1],U,c,f,H),new Aa(D[0],o,c,U,H)),(z=(t>=H)<<1|e>=U)&&(N=T[T.length-1],T[T.length-1]=T[T.length-1-z],T[T.length-1-z]=N)}else{var G=e-+this._x.call(null,D.data),Z=t-+this._y.call(null,D.data),Y=G*G+Z*Z;if(Y<r){var st=Math.sqrt(r=Y);s=e-st,n=t-st,x=e+st,E=t+st,i=D.data}}return i}function JZ(e){if(isNaN(x=+this._x.call(null,e))||isNaN(E=+this._y.call(null,e)))return this;var t,r=this._root,i,s,n,o=this._x0,c=this._y0,f=this._x1,p=this._y1,x,E,T,D,N,z,U,H;if(!r)return this;if(r.length)for(;;){if((N=x>=(T=(o+f)/2))?o=T:f=T,(z=E>=(D=(c+p)/2))?c=D:p=D,t=r,!(r=r[U=z<<1|N]))return this;if(!r.length)break;(t[U+1&3]||t[U+2&3]||t[U+3&3])&&(i=t,H=U)}for(;r.data!==e;)if(s=r,!(r=r.next))return this;return(n=r.next)&&delete r.next,s?(n?s.next=n:delete s.next,this):t?(n?t[U]=n:delete t[U],(r=t[0]||t[1]||t[2]||t[3])&&r===(t[3]||t[2]||t[1]||t[0])&&!r.length&&(i?i[H]=r:this._root=r),this):(this._root=n,this)}function tG(e){for(var t=0,r=e.length;t<r;++t)this.remove(e[t]);return this}function eG(){return this._root}function rG(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function iG(e){var t=[],r,i=this._root,s,n,o,c,f;for(i&&t.push(new Aa(i,this._x0,this._y0,this._x1,this._y1));r=t.pop();)if(!e(i=r.node,n=r.x0,o=r.y0,c=r.x1,f=r.y1)&&i.length){var p=(n+c)/2,x=(o+f)/2;(s=i[3])&&t.push(new Aa(s,p,x,c,f)),(s=i[2])&&t.push(new Aa(s,n,x,p,f)),(s=i[1])&&t.push(new Aa(s,p,o,c,x)),(s=i[0])&&t.push(new Aa(s,n,o,p,x))}return this}function nG(e){var t=[],r=[],i;for(this._root&&t.push(new Aa(this._root,this._x0,this._y0,this._x1,this._y1));i=t.pop();){var s=i.node;if(s.length){var n,o=i.x0,c=i.y0,f=i.x1,p=i.y1,x=(o+f)/2,E=(c+p)/2;(n=s[0])&&t.push(new Aa(n,o,c,x,E)),(n=s[1])&&t.push(new Aa(n,x,c,f,E)),(n=s[2])&&t.push(new Aa(n,o,E,x,p)),(n=s[3])&&t.push(new Aa(n,x,E,f,p))}r.push(i)}for(;i=r.pop();)e(i.node,i.x0,i.y0,i.x1,i.y1);return this}function sG(e){return e[0]}function oG(e){return arguments.length?(this._x=e,this):this._x}function aG(e){return e[1]}function lG(e){return arguments.length?(this._y=e,this):this._y}function YA(e,t,r){var i=new IB(t??sG,r??aG,NaN,NaN,NaN,NaN);return e==null?i:i.addAll(e)}function IB(e,t,r,i,s,n){this._x=e,this._y=t,this._x0=r,this._y0=i,this._x1=s,this._y1=n,this._root=void 0}function cG(e){for(var t={data:e.data},r=t;e=e.next;)r=r.next={data:e.data};return t}var Ll=YA.prototype=IB.prototype;Ll.copy=function(){var e=new IB(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,r,i;if(!t)return e;if(!t.length)return e._root=cG(t),e;for(r=[{source:t,target:e._root=new Array(4)}];t=r.pop();)for(var s=0;s<4;++s)(i=t.source[s])&&(i.length?r.push({source:i,target:t.target[s]=new Array(4)}):t.target[s]=cG(i));return e};Ll.add=qZ;Ll.addAll=XZ;Ll.cover=ZZ;Ll.data=GZ;Ll.extent=QZ;Ll.find=KZ;Ll.remove=JZ;Ll.removeAll=tG;Ll.root=eG;Ll.size=rG;Ll.visit=iG;Ll.visitAfter=nG;Ll.x=oG;Ll.y=lG;function ks(e){return function(){return e}}function Zh(e){return(e()-.5)*1e-6}function wbt(e){return e.x+e.vx}function Tbt(e){return e.y+e.vy}function uG(e){var t,r,i,s=1,n=1;typeof e!="function"&&(e=ks(e==null?1:+e));function o(){for(var p,x=t.length,E,T,D,N,z,U,H=0;H<n;++H)for(E=YA(t,wbt,Tbt).visitAfter(c),p=0;p<x;++p)T=t[p],z=r[T.index],U=z*z,D=T.x+T.vx,N=T.y+T.vy,E.visit(G);function G(Z,Y,st,at,Dt){var Tt=Z.data,kt=Z.r,Et=z+kt;if(Tt){if(Tt.index>T.index){var Mt=D-Tt.x-Tt.vx,oe=N-Tt.y-Tt.vy,Xt=Mt*Mt+oe*oe;Xt<Et*Et&&(Mt===0&&(Mt=Zh(i),Xt+=Mt*Mt),oe===0&&(oe=Zh(i),Xt+=oe*oe),Xt=(Et-(Xt=Math.sqrt(Xt)))/Xt*s,T.vx+=(Mt*=Xt)*(Et=(kt*=kt)/(U+kt)),T.vy+=(oe*=Xt)*Et,Tt.vx-=Mt*(Et=1-Et),Tt.vy-=oe*Et)}return}return Y>D+Et||at<D-Et||st>N+Et||Dt<N-Et}}function c(p){if(p.data)return p.r=r[p.data.index];for(var x=p.r=0;x<4;++x)p[x]&&p[x].r>p.r&&(p.r=p[x].r)}function f(){if(t){var p,x=t.length,E;for(r=new Array(x),p=0;p<x;++p)E=t[p],r[E.index]=+e(E,p,t)}}return o.initialize=function(p,x){t=p,i=x,f()},o.iterations=function(p){return arguments.length?(n=+p,o):n},o.strength=function(p){return arguments.length?(s=+p,o):s},o.radius=function(p){return arguments.length?(e=typeof p=="function"?p:ks(+p),f(),o):e},o}function Sbt(e){return e.index}function hG(e,t){var r=e.get(t);if(!r)throw new Error("node not found: "+t);return r}function fG(e){var t=Sbt,r=E,i,s=ks(30),n,o,c,f,p,x=1;e==null&&(e=[]);function E(U){return 1/Math.min(c[U.source.index],c[U.target.index])}function T(U){for(var H=0,G=e.length;H<x;++H)for(var Z=0,Y,st,at,Dt,Tt,kt,Et;Z<G;++Z)Y=e[Z],st=Y.source,at=Y.target,Dt=at.x+at.vx-st.x-st.vx||Zh(p),Tt=at.y+at.vy-st.y-st.vy||Zh(p),kt=Math.sqrt(Dt*Dt+Tt*Tt),kt=(kt-n[Z])/kt*U*i[Z],Dt*=kt,Tt*=kt,at.vx-=Dt*(Et=f[Z]),at.vy-=Tt*Et,st.vx+=Dt*(Et=1-Et),st.vy+=Tt*Et}function D(){if(o){var U,H=o.length,G=e.length,Z=new Map(o.map((st,at)=>[t(st,at,o),st])),Y;for(U=0,c=new Array(H);U<G;++U)Y=e[U],Y.index=U,typeof Y.source!="object"&&(Y.source=hG(Z,Y.source)),typeof Y.target!="object"&&(Y.target=hG(Z,Y.target)),c[Y.source.index]=(c[Y.source.index]||0)+1,c[Y.target.index]=(c[Y.target.index]||0)+1;for(U=0,f=new Array(G);U<G;++U)Y=e[U],f[U]=c[Y.source.index]/(c[Y.source.index]+c[Y.target.index]);i=new Array(G),N(),n=new Array(G),z()}}function N(){if(o)for(var U=0,H=e.length;U<H;++U)i[U]=+r(e[U],U,e)}function z(){if(o)for(var U=0,H=e.length;U<H;++U)n[U]=+s(e[U],U,e)}return T.initialize=function(U,H){o=U,p=H,D()},T.links=function(U){return arguments.length?(e=U,D(),T):e},T.id=function(U){return arguments.length?(t=U,T):t},T.iterations=function(U){return arguments.length?(x=+U,T):x},T.strength=function(U){return arguments.length?(r=typeof U=="function"?U:ks(+U),N(),T):r},T.distance=function(U){return arguments.length?(s=typeof U=="function"?U:ks(+U),z(),T):s},T}function pG(){let e=1;return()=>(e=(1664525*e+1013904223)%4294967296)/4294967296}function dG(e){return e.x}function AG(e){return e.y}var Ebt=10,Ibt=Math.PI*(3-Math.sqrt(5));function mG(e){var t,r=1,i=.001,s=1-Math.pow(i,1/300),n=0,o=.6,c=new Map,f=d1(E),p=ju("tick","end"),x=pG();e==null&&(e=[]);function E(){T(),p.call("tick",t),r<i&&(f.stop(),p.call("end",t))}function T(z){var U,H=e.length,G;z===void 0&&(z=1);for(var Z=0;Z<z;++Z)for(r+=(n-r)*s,c.forEach(function(Y){Y(r)}),U=0;U<H;++U)G=e[U],G.fx==null?G.x+=G.vx*=o:(G.x=G.fx,G.vx=0),G.fy==null?G.y+=G.vy*=o:(G.y=G.fy,G.vy=0);return t}function D(){for(var z=0,U=e.length,H;z<U;++z){if(H=e[z],H.index=z,H.fx!=null&&(H.x=H.fx),H.fy!=null&&(H.y=H.fy),isNaN(H.x)||isNaN(H.y)){var G=Ebt*Math.sqrt(.5+z),Z=z*Ibt;H.x=G*Math.cos(Z),H.y=G*Math.sin(Z)}(isNaN(H.vx)||isNaN(H.vy))&&(H.vx=H.vy=0)}}function N(z){return z.initialize&&z.initialize(e,x),z}return D(),t={tick:T,restart:function(){return f.restart(E),t},stop:function(){return f.stop(),t},nodes:function(z){return arguments.length?(e=z,D(),c.forEach(N),t):e},alpha:function(z){return arguments.length?(r=+z,t):r},alphaMin:function(z){return arguments.length?(i=+z,t):i},alphaDecay:function(z){return arguments.length?(s=+z,t):+s},alphaTarget:function(z){return arguments.length?(n=+z,t):n},velocityDecay:function(z){return arguments.length?(o=1-z,t):1-o},randomSource:function(z){return arguments.length?(x=z,c.forEach(N),t):x},force:function(z,U){return arguments.length>1?(U==null?c.delete(z):c.set(z,N(U)),t):c.get(z)},find:function(z,U,H){var G=0,Z=e.length,Y,st,at,Dt,Tt;for(H==null?H=1/0:H*=H,G=0;G<Z;++G)Dt=e[G],Y=z-Dt.x,st=U-Dt.y,at=Y*Y+st*st,at<H&&(Tt=Dt,H=at);return Tt},on:function(z,U){return arguments.length>1?(p.on(z,U),t):p.on(z)}}}function gG(){var e,t,r,i,s=ks(-30),n,o=1,c=1/0,f=.81;function p(D){var N,z=e.length,U=YA(e,dG,AG).visitAfter(E);for(i=D,N=0;N<z;++N)t=e[N],U.visit(T)}function x(){if(e){var D,N=e.length,z;for(n=new Array(N),D=0;D<N;++D)z=e[D],n[z.index]=+s(z,D,e)}}function E(D){var N=0,z,U,H=0,G,Z,Y;if(D.length){for(G=Z=Y=0;Y<4;++Y)(z=D[Y])&&(U=Math.abs(z.value))&&(N+=z.value,H+=U,G+=U*z.x,Z+=U*z.y);D.x=G/H,D.y=Z/H}else{z=D,z.x=z.data.x,z.y=z.data.y;do N+=n[z.data.index];while(z=z.next)}D.value=N}function T(D,N,z,U){if(!D.value)return!0;var H=D.x-t.x,G=D.y-t.y,Z=U-N,Y=H*H+G*G;if(Z*Z/f<Y)return Y<c&&(H===0&&(H=Zh(r),Y+=H*H),G===0&&(G=Zh(r),Y+=G*G),Y<o&&(Y=Math.sqrt(o*Y)),t.vx+=H*D.value*i/Y,t.vy+=G*D.value*i/Y),!0;if(D.length||Y>=c)return;(D.data!==t||D.next)&&(H===0&&(H=Zh(r),Y+=H*H),G===0&&(G=Zh(r),Y+=G*G),Y<o&&(Y=Math.sqrt(o*Y)));do D.data!==t&&(Z=n[D.data.index]*i/Y,t.vx+=H*Z,t.vy+=G*Z);while(D=D.next)}return p.initialize=function(D,N){e=D,r=N,x()},p.strength=function(D){return arguments.length?(s=typeof D=="function"?D:ks(+D),x(),p):s},p.distanceMin=function(D){return arguments.length?(o=D*D,p):Math.sqrt(o)},p.distanceMax=function(D){return arguments.length?(c=D*D,p):Math.sqrt(c)},p.theta=function(D){return arguments.length?(f=D*D,p):Math.sqrt(f)},p}function _G(e,t,r){var i,s=ks(.1),n,o;typeof e!="function"&&(e=ks(+e)),t==null&&(t=0),r==null&&(r=0);function c(p){for(var x=0,E=i.length;x<E;++x){var T=i[x],D=T.x-t||1e-6,N=T.y-r||1e-6,z=Math.sqrt(D*D+N*N),U=(o[x]-z)*n[x]*p/z;T.vx+=D*U,T.vy+=N*U}}function f(){if(i){var p,x=i.length;for(n=new Array(x),o=new Array(x),p=0;p<x;++p)o[p]=+e(i[p],p,i),n[p]=isNaN(o[p])?0:+s(i[p],p,i)}}return c.initialize=function(p){i=p,f()},c.strength=function(p){return arguments.length?(s=typeof p=="function"?p:ks(+p),f(),c):s},c.radius=function(p){return arguments.length?(e=typeof p=="function"?p:ks(+p),f(),c):e},c.x=function(p){return arguments.length?(t=+p,c):t},c.y=function(p){return arguments.length?(r=+p,c):r},c}function yG(e){var t=ks(.1),r,i,s;typeof e!="function"&&(e=ks(e==null?0:+e));function n(c){for(var f=0,p=r.length,x;f<p;++f)x=r[f],x.vx+=(s[f]-x.x)*i[f]*c}function o(){if(r){var c,f=r.length;for(i=new Array(f),s=new Array(f),c=0;c<f;++c)i[c]=isNaN(s[c]=+e(r[c],c,r))?0:+t(r[c],c,r)}}return n.initialize=function(c){r=c,o()},n.strength=function(c){return arguments.length?(t=typeof c=="function"?c:ks(+c),o(),n):t},n.x=function(c){return arguments.length?(e=typeof c=="function"?c:ks(+c),o(),n):e},n}function xG(e){var t=ks(.1),r,i,s;typeof e!="function"&&(e=ks(e==null?0:+e));function n(c){for(var f=0,p=r.length,x;f<p;++f)x=r[f],x.vy+=(s[f]-x.y)*i[f]*c}function o(){if(r){var c,f=r.length;for(i=new Array(f),s=new Array(f),c=0;c<f;++c)i[c]=isNaN(s[c]=+e(r[c],c,r))?0:+t(r[c],c,r)}}return n.initialize=function(c){r=c,o()},n.strength=function(c){return arguments.length?(t=typeof c=="function"?c:ks(+c),o(),n):t},n.y=function(c){return arguments.length?(e=typeof c=="function"?c:ks(+c),o(),n):e},n}function bG(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function v1(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,i=e.slice(0,r);return[i.length>1?i[0]+i.slice(2):i,+e.slice(r+1)]}function lp(e){return e=v1(Math.abs(e)),e?e[1]:NaN}function vG(e,t){return function(r,i){for(var s=r.length,n=[],o=0,c=e[0],f=0;s>0&&c>0&&(f+c+1>i&&(c=Math.max(1,i-f)),n.push(r.substring(s-=c,s+c)),!((f+=c+1)>i));)c=e[o=(o+1)%e.length];return n.reverse().join(t)}}function wG(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var Mbt=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Gh(e){if(!(t=Mbt.exec(e)))throw new Error("invalid format: "+e);var t;return new p3({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Gh.prototype=p3.prototype;function p3(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}p3.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function TG(e){t:for(var t=e.length,r=1,i=-1,s;r<t;++r)switch(e[r]){case".":i=s=r;break;case"0":i===0&&(i=r),s=r;break;default:if(!+e[r])break t;i>0&&(i=0);break}return i>0?e.slice(0,i)+e.slice(s+1):e}var MB;function SG(e,t){var r=v1(e,t);if(!r)return e+"";var i=r[0],s=r[1],n=s-(MB=Math.max(-8,Math.min(8,Math.floor(s/3)))*3)+1,o=i.length;return n===o?i:n>o?i+new Array(n-o+1).join("0"):n>0?i.slice(0,n)+"."+i.slice(n):"0."+new Array(1-n).join("0")+v1(e,Math.max(0,t+n-1))[0]}function CB(e,t){var r=v1(e,t);if(!r)return e+"";var i=r[0],s=r[1];return s<0?"0."+new Array(-s).join("0")+i:i.length>s+1?i.slice(0,s+1)+"."+i.slice(s+1):i+new Array(s-i.length+2).join("0")}var PB={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:bG,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>CB(e*100,t),r:CB,s:SG,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function RB(e){return e}var EG=Array.prototype.map,IG=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function o6(e){var t=e.grouping===void 0||e.thousands===void 0?RB:vG(EG.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",i=e.currency===void 0?"":e.currency[1]+"",s=e.decimal===void 0?".":e.decimal+"",n=e.numerals===void 0?RB:wG(EG.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",c=e.minus===void 0?"\u2212":e.minus+"",f=e.nan===void 0?"NaN":e.nan+"";function p(E){E=Gh(E);var T=E.fill,D=E.align,N=E.sign,z=E.symbol,U=E.zero,H=E.width,G=E.comma,Z=E.precision,Y=E.trim,st=E.type;st==="n"?(G=!0,st="g"):PB[st]||(Z===void 0&&(Z=12),Y=!0,st="g"),(U||T==="0"&&D==="=")&&(U=!0,T="0",D="=");var at=z==="$"?r:z==="#"&&/[boxX]/.test(st)?"0"+st.toLowerCase():"",Dt=z==="$"?i:/[%p]/.test(st)?o:"",Tt=PB[st],kt=/[defgprs%]/.test(st);Z=Z===void 0?6:/[gprs]/.test(st)?Math.max(1,Math.min(21,Z)):Math.max(0,Math.min(20,Z));function Et(Mt){var oe=at,Xt=Dt,xt,jt,Wt;if(st==="c")Xt=Tt(Mt)+Xt,Mt="";else{Mt=+Mt;var de=Mt<0||1/Mt<0;if(Mt=isNaN(Mt)?f:Tt(Math.abs(Mt),Z),Y&&(Mt=TG(Mt)),de&&+Mt==0&&N!=="+"&&(de=!1),oe=(de?N==="("?N:c:N==="-"||N==="("?"":N)+oe,Xt=(st==="s"?IG[8+MB/3]:"")+Xt+(de&&N==="("?")":""),kt){for(xt=-1,jt=Mt.length;++xt<jt;)if(Wt=Mt.charCodeAt(xt),48>Wt||Wt>57){Xt=(Wt===46?s+Mt.slice(xt+1):Mt.slice(xt))+Xt,Mt=Mt.slice(0,xt);break}}}G&&!U&&(Mt=t(Mt,1/0));var Ee=oe.length+Mt.length+Xt.length,Se=Ee<H?new Array(H-Ee+1).join(T):"";switch(G&&U&&(Mt=t(Se+Mt,Se.length?H-Xt.length:1/0),Se=""),D){case"<":Mt=oe+Mt+Xt+Se;break;case"=":Mt=oe+Se+Mt+Xt;break;case"^":Mt=Se.slice(0,Ee=Se.length>>1)+oe+Mt+Xt+Se.slice(Ee);break;default:Mt=Se+oe+Mt+Xt;break}return n(Mt)}return Et.toString=function(){return E+""},Et}function x(E,T){var D=p((E=Gh(E),E.type="f",E)),N=Math.max(-8,Math.min(8,Math.floor(lp(T)/3)))*3,z=Math.pow(10,-N),U=IG[8+N/3];return function(H){return D(z*H)+U}}return{format:p,formatPrefix:x}}var a6,w1,A3;l6({thousands:",",grouping:[3],currency:["$",""]});function l6(e){return a6=o6(e),w1=a6.format,A3=a6.formatPrefix,a6}function c6(e){return Math.max(0,-lp(Math.abs(e)))}function u6(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(lp(t)/3)))*3-lp(Math.abs(e)))}function h6(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,lp(t)-lp(e))+1}var pr=1e-6,qd=1e-12,vi=Math.PI,os=vi/2,b2=vi/4,Eo=vi*2,yn=180/vi,vr=vi/180,Jr=Math.abs,Hu=Math.atan,ps=Math.atan2,Je=Math.cos,m3=Math.ceil,f6=Math.exp;var p6=Math.hypot,T1=Math.log,d6=Math.pow,Ze=Math.sin,Al=Math.sign||function(e){return e>0?1:e<0?-1:0},Cn=Math.sqrt,v2=Math.tan;function A6(e){return e>1?0:e<-1?vi:Math.acos(e)}function ds(e){return e>1?os:e<-1?-os:Math.asin(e)}function kB(e){return(e=Ze(e/2))*e}function Dn(){}function m6(e,t){e&&CG.hasOwnProperty(e.type)&&CG[e.type](e,t)}var MG={Feature:function(e,t){m6(e.geometry,t)},FeatureCollection:function(e,t){for(var r=e.features,i=-1,s=r.length;++i<s;)m6(r[i].geometry,t)}},CG={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var r=e.coordinates,i=-1,s=r.length;++i<s;)e=r[i],t.point(e[0],e[1],e[2])},LineString:function(e,t){DB(e.coordinates,t,0)},MultiLineString:function(e,t){for(var r=e.coordinates,i=-1,s=r.length;++i<s;)DB(r[i],t,0)},Polygon:function(e,t){PG(e.coordinates,t)},MultiPolygon:function(e,t){for(var r=e.coordinates,i=-1,s=r.length;++i<s;)PG(r[i],t)},GeometryCollection:function(e,t){for(var r=e.geometries,i=-1,s=r.length;++i<s;)m6(r[i],t)}};function DB(e,t,r){var i=-1,s=e.length-r,n;for(t.lineStart();++i<s;)n=e[i],t.point(n[0],n[1],n[2]);t.lineEnd()}function PG(e,t){var r=-1,i=e.length;for(t.polygonStart();++r<i;)DB(e[r],t,1);t.polygonEnd()}function ma(e,t){e&&MG.hasOwnProperty(e.type)?MG[e.type](e,t):m6(e,t)}var g3=new Kn,g6=new Kn,RG,kG,BB,OB,NB,Qh={point:Dn,lineStart:Dn,lineEnd:Dn,polygonStart:function(){g3=new Kn,Qh.lineStart=Cbt,Qh.lineEnd=Pbt},polygonEnd:function(){var e=+g3;g6.add(e<0?Eo+e:e),this.lineStart=this.lineEnd=this.point=Dn},sphere:function(){g6.add(Eo)}};function Cbt(){Qh.point=Rbt}function Pbt(){DG(RG,kG)}function Rbt(e,t){Qh.point=DG,RG=e,kG=t,e*=vr,t*=vr,BB=e,OB=Je(t=t/2+b2),NB=Ze(t)}function DG(e,t){e*=vr,t*=vr,t=t/2+b2;var r=e-BB,i=r>=0?1:-1,s=i*r,n=Je(t),o=Ze(t),c=NB*o,f=OB*n+c*Je(s),p=c*i*Ze(s);g3.add(ps(p,f)),BB=e,OB=n,NB=o}function BG(e){return g6=new Kn,ma(e,Qh),g6*2}function S1(e){return[ps(e[1],e[0]),ds(e[2])]}function Wu(e){var t=e[0],r=e[1],i=Je(r);return[i*Je(t),i*Ze(t),Ze(r)]}function _3(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Yd(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function _6(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function y3(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function E1(e){var t=Cn(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var Gs,_c,co,Qc,I1,LG,zG,w2,x3,XA,Zd,Xd={point:FB,lineStart:OG,lineEnd:NG,polygonStart:function(){Xd.point=VG,Xd.lineStart=kbt,Xd.lineEnd=Dbt,x3=new Kn,Qh.polygonStart()},polygonEnd:function(){Qh.polygonEnd(),Xd.point=FB,Xd.lineStart=OG,Xd.lineEnd=NG,g3<0?(Gs=-(co=180),_c=-(Qc=90)):x3>pr?Qc=90:x3<-pr&&(_c=-90),Zd[0]=Gs,Zd[1]=co},sphere:function(){Gs=-(co=180),_c=-(Qc=90)}};function FB(e,t){XA.push(Zd=[Gs=e,co=e]),t<_c&&(_c=t),t>Qc&&(Qc=t)}function UG(e,t){var r=Wu([e*vr,t*vr]);if(w2){var i=Yd(w2,r),s=[i[1],-i[0],0],n=Yd(s,i);E1(n),n=S1(n);var o=e-I1,c=o>0?1:-1,f=n[0]*yn*c,p,x=Jr(o)>180;x^(c*I1<f&&f<c*e)?(p=n[1]*yn,p>Qc&&(Qc=p)):(f=(f+360)%360-180,x^(c*I1<f&&f<c*e)?(p=-n[1]*yn,p<_c&&(_c=p)):(t<_c&&(_c=t),t>Qc&&(Qc=t))),x?e<I1?Gc(Gs,e)>Gc(Gs,co)&&(co=e):Gc(e,co)>Gc(Gs,co)&&(Gs=e):co>=Gs?(e<Gs&&(Gs=e),e>co&&(co=e)):e>I1?Gc(Gs,e)>Gc(Gs,co)&&(co=e):Gc(e,co)>Gc(Gs,co)&&(Gs=e)}else XA.push(Zd=[Gs=e,co=e]);t<_c&&(_c=t),t>Qc&&(Qc=t),w2=r,I1=e}function OG(){Xd.point=UG}function NG(){Zd[0]=Gs,Zd[1]=co,Xd.point=FB,w2=null}function VG(e,t){if(w2){var r=e-I1;x3.add(Jr(r)>180?r+(r>0?360:-360):r)}else LG=e,zG=t;Qh.point(e,t),UG(e,t)}function kbt(){Qh.lineStart()}function Dbt(){VG(LG,zG),Qh.lineEnd(),Jr(x3)>pr&&(Gs=-(co=180)),Zd[0]=Gs,Zd[1]=co,w2=null}function Gc(e,t){return(t-=e)<0?t+360:t}function Bbt(e,t){return e[0]-t[0]}function FG(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}function jG(e){var t,r,i,s,n,o,c;if(Qc=co=-(Gs=_c=1/0),XA=[],ma(e,Xd),r=XA.length){for(XA.sort(Bbt),t=1,i=XA[0],n=[i];t<r;++t)s=XA[t],FG(i,s[0])||FG(i,s[1])?(Gc(i[0],s[1])>Gc(i[0],i[1])&&(i[1]=s[1]),Gc(s[0],i[1])>Gc(i[0],i[1])&&(i[0]=s[0])):n.push(i=s);for(o=-1/0,r=n.length-1,t=0,i=n[r];t<=r;i=s,++t)s=n[t],(c=Gc(i[1],s[0]))>o&&(o=c,Gs=s[0],co=i[1])}return XA=Zd=null,Gs===1/0||_c===1/0?[[NaN,NaN],[NaN,NaN]]:[[Gs,_c],[co,Qc]]}var b3,y6,x6,b6,v6,w6,T6,S6,LB,zB,UB,WG,qG,zl,Ul,Vl,Kh={sphere:Dn,point:VB,lineStart:$G,lineEnd:HG,polygonStart:function(){Kh.lineStart=Fbt,Kh.lineEnd=Lbt},polygonEnd:function(){Kh.lineStart=$G,Kh.lineEnd=HG}};function VB(e,t){e*=vr,t*=vr;var r=Je(t);v3(r*Je(e),r*Ze(e),Ze(t))}function v3(e,t,r){++b3,x6+=(e-x6)/b3,b6+=(t-b6)/b3,v6+=(r-v6)/b3}function $G(){Kh.point=Obt}function Obt(e,t){e*=vr,t*=vr;var r=Je(t);zl=r*Je(e),Ul=r*Ze(e),Vl=Ze(t),Kh.point=Nbt,v3(zl,Ul,Vl)}function Nbt(e,t){e*=vr,t*=vr;var r=Je(t),i=r*Je(e),s=r*Ze(e),n=Ze(t),o=ps(Cn((o=Ul*n-Vl*s)*o+(o=Vl*i-zl*n)*o+(o=zl*s-Ul*i)*o),zl*i+Ul*s+Vl*n);y6+=o,w6+=o*(zl+(zl=i)),T6+=o*(Ul+(Ul=s)),S6+=o*(Vl+(Vl=n)),v3(zl,Ul,Vl)}function HG(){Kh.point=VB}function Fbt(){Kh.point=zbt}function Lbt(){YG(WG,qG),Kh.point=VB}function zbt(e,t){WG=e,qG=t,e*=vr,t*=vr,Kh.point=YG;var r=Je(t);zl=r*Je(e),Ul=r*Ze(e),Vl=Ze(t),v3(zl,Ul,Vl)}function YG(e,t){e*=vr,t*=vr;var r=Je(t),i=r*Je(e),s=r*Ze(e),n=Ze(t),o=Ul*n-Vl*s,c=Vl*i-zl*n,f=zl*s-Ul*i,p=p6(o,c,f),x=ds(p),E=p&&-x/p;LB.add(E*o),zB.add(E*c),UB.add(E*f),y6+=x,w6+=x*(zl+(zl=i)),T6+=x*(Ul+(Ul=s)),S6+=x*(Vl+(Vl=n)),v3(zl,Ul,Vl)}function XG(e){b3=y6=x6=b6=v6=w6=T6=S6=0,LB=new Kn,zB=new Kn,UB=new Kn,ma(e,Kh);var t=+LB,r=+zB,i=+UB,s=p6(t,r,i);return s<qd&&(t=w6,r=T6,i=S6,y6<pr&&(t=x6,r=b6,i=v6),s=p6(t,r,i),s<qd)?[NaN,NaN]:[ps(r,t)*yn,ds(i/s)*yn]}function M1(e){return function(){return e}}function w3(e,t){function r(i,s){return i=e(i,s),t(i[0],i[1])}return e.invert&&t.invert&&(r.invert=function(i,s){return i=t.invert(i,s),i&&e.invert(i[0],i[1])}),r}function jB(e,t){return Jr(e)>vi&&(e-=Math.round(e/Eo)*Eo),[e,t]}jB.invert=jB;function T3(e,t,r){return(e%=Eo)?t||r?w3(GG(e),QG(t,r)):GG(e):t||r?QG(t,r):jB}function ZG(e){return function(t,r){return t+=e,Jr(t)>vi&&(t-=Math.round(t/Eo)*Eo),[t,r]}}function GG(e){var t=ZG(e);return t.invert=ZG(-e),t}function QG(e,t){var r=Je(e),i=Ze(e),s=Je(t),n=Ze(t);function o(c,f){var p=Je(f),x=Je(c)*p,E=Ze(c)*p,T=Ze(f),D=T*r+x*i;return[ps(E*s-D*n,x*r-T*i),ds(D*s+E*n)]}return o.invert=function(c,f){var p=Je(f),x=Je(c)*p,E=Ze(c)*p,T=Ze(f),D=T*s-E*n;return[ps(E*s+T*n,x*r+D*i),ds(D*r-x*i)]},o}function E6(e){e=T3(e[0]*vr,e[1]*vr,e.length>2?e[2]*vr:0);function t(r){return r=e(r[0]*vr,r[1]*vr),r[0]*=yn,r[1]*=yn,r}return t.invert=function(r){return r=e.invert(r[0]*vr,r[1]*vr),r[0]*=yn,r[1]*=yn,r},t}function $B(e,t,r,i,s,n){if(r){var o=Je(t),c=Ze(t),f=i*r;s==null?(s=t+i*Eo,n=t-f/2):(s=KG(o,s),n=KG(o,n),(i>0?s<n:s>n)&&(s+=i*Eo));for(var p,x=s;i>0?x>n:x<n;x-=f)p=S1([o,-c*Je(x),-c*Ze(x)]),e.point(p[0],p[1])}}function KG(e,t){t=Wu(t),t[0]-=e,E1(t);var r=A6(-t[1]);return((-t[2]<0?-r:r)+Eo-pr)%Eo}function JG(){var e=M1([0,0]),t=M1(90),r=M1(2),i,s,n={point:o};function o(f,p){i.push(f=s(f,p)),f[0]*=yn,f[1]*=yn}function c(){var f=e.apply(this,arguments),p=t.apply(this,arguments)*vr,x=r.apply(this,arguments)*vr;return i=[],s=T3(-f[0]*vr,-f[1]*vr,0).invert,$B(n,p,x,1),f={type:"Polygon",coordinates:[i]},i=s=null,f}return c.center=function(f){return arguments.length?(e=typeof f=="function"?f:M1([+f[0],+f[1]]),c):e},c.radius=function(f){return arguments.length?(t=typeof f=="function"?f:M1(+f),c):t},c.precision=function(f){return arguments.length?(r=typeof f=="function"?f:M1(+f),c):r},c}function I6(){var e=[],t;return{point:function(r,i,s){t.push([r,i,s])},lineStart:function(){e.push(t=[])},lineEnd:Dn,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var r=e;return e=[],t=null,r}}}function T2(e,t){return Jr(e[0]-t[0])<pr&&Jr(e[1]-t[1])<pr}function M6(e,t,r,i){this.x=e,this.z=t,this.o=r,this.e=i,this.v=!1,this.n=this.p=null}function C6(e,t,r,i,s){var n=[],o=[],c,f;if(e.forEach(function(N){if(!((z=N.length-1)<=0)){var z,U=N[0],H=N[z],G;if(T2(U,H)){if(!U[2]&&!H[2]){for(s.lineStart(),c=0;c<z;++c)s.point((U=N[c])[0],U[1]);s.lineEnd();return}H[0]+=2*pr}n.push(G=new M6(U,N,null,!0)),o.push(G.o=new M6(U,null,G,!1)),n.push(G=new M6(H,N,null,!1)),o.push(G.o=new M6(H,null,G,!0))}}),!!n.length){for(o.sort(t),tQ(n),tQ(o),c=0,f=o.length;c<f;++c)o[c].e=r=!r;for(var p=n[0],x,E;;){for(var T=p,D=!0;T.v;)if((T=T.n)===p)return;x=T.z,s.lineStart();do{if(T.v=T.o.v=!0,T.e){if(D)for(c=0,f=x.length;c<f;++c)s.point((E=x[c])[0],E[1]);else i(T.x,T.n.x,1,s);T=T.n}else{if(D)for(x=T.p.z,c=x.length-1;c>=0;--c)s.point((E=x[c])[0],E[1]);else i(T.x,T.p.x,-1,s);T=T.p}T=T.o,x=T.z,D=!D}while(!T.v);s.lineEnd()}}}function tQ(e){if(t=e.length){for(var t,r=0,i=e[0],s;++r<t;)i.n=s=e[r],s.p=i,i=s;i.n=s=e[0],s.p=i}}function HB(e){return Jr(e[0])<=vi?e[0]:Al(e[0])*((Jr(e[0])+vi)%Eo-vi)}function P6(e,t){var r=HB(t),i=t[1],s=Ze(i),n=[Ze(r),-Je(r),0],o=0,c=0,f=new Kn;s===1?i=os+pr:s===-1&&(i=-os-pr);for(var p=0,x=e.length;p<x;++p)if(T=(E=e[p]).length)for(var E,T,D=E[T-1],N=HB(D),z=D[1]/2+b2,U=Ze(z),H=Je(z),G=0;G<T;++G,N=Y,U=at,H=Dt,D=Z){var Z=E[G],Y=HB(Z),st=Z[1]/2+b2,at=Ze(st),Dt=Je(st),Tt=Y-N,kt=Tt>=0?1:-1,Et=kt*Tt,Mt=Et>vi,oe=U*at;if(f.add(ps(oe*kt*Ze(Et),H*Dt+oe*Je(Et))),o+=Mt?Tt+kt*Eo:Tt,Mt^N>=r^Y>=r){var Xt=Yd(Wu(D),Wu(Z));E1(Xt);var xt=Yd(n,Xt);E1(xt);var jt=(Mt^Tt>=0?-1:1)*ds(xt[2]);(i>jt||i===jt&&(Xt[0]||Xt[1]))&&(c+=Mt^Tt>=0?1:-1)}}return(o<-pr||o<pr&&f<-qd)^c&1}function R6(e,t,r,i){return function(s){var n=t(s),o=I6(),c=t(o),f=!1,p,x,E,T={point:D,lineStart:z,lineEnd:U,polygonStart:function(){T.point=H,T.lineStart=G,T.lineEnd=Z,x=[],p=[]},polygonEnd:function(){T.point=D,T.lineStart=z,T.lineEnd=U,x=n1(x);var Y=P6(p,i);x.length?(f||(s.polygonStart(),f=!0),C6(x,Vbt,Y,r,s)):Y&&(f||(s.polygonStart(),f=!0),s.lineStart(),r(null,null,1,s),s.lineEnd()),f&&(s.polygonEnd(),f=!1),x=p=null},sphere:function(){s.polygonStart(),s.lineStart(),r(null,null,1,s),s.lineEnd(),s.polygonEnd()}};function D(Y,st){e(Y,st)&&s.point(Y,st)}function N(Y,st){n.point(Y,st)}function z(){T.point=N,n.lineStart()}function U(){T.point=D,n.lineEnd()}function H(Y,st){E.push([Y,st]),c.point(Y,st)}function G(){c.lineStart(),E=[]}function Z(){H(E[0][0],E[0][1]),c.lineEnd();var Y=c.clean(),st=o.result(),at,Dt=st.length,Tt,kt,Et;if(E.pop(),p.push(E),E=null,!!Dt){if(Y&1){if(kt=st[0],(Tt=kt.length-1)>0){for(f||(s.polygonStart(),f=!0),s.lineStart(),at=0;at<Tt;++at)s.point((Et=kt[at])[0],Et[1]);s.lineEnd()}return}Dt>1&&Y&2&&st.push(st.pop().concat(st.shift())),x.push(st.filter(Ubt))}}return T}}function Ubt(e){return e.length>1}function Vbt(e,t){return((e=e.x)[0]<0?e[1]-os-pr:os-e[1])-((t=t.x)[0]<0?t[1]-os-pr:os-t[1])}var S3=R6(function(){return!0},jbt,Hbt,[-vi,-os]);function jbt(e){var t=NaN,r=NaN,i=NaN,s;return{lineStart:function(){e.lineStart(),s=1},point:function(n,o){var c=n>0?vi:-vi,f=Jr(n-t);Jr(f-vi)<pr?(e.point(t,r=(r+o)/2>0?os:-os),e.point(i,r),e.lineEnd(),e.lineStart(),e.point(c,r),e.point(n,r),s=0):i!==c&&f>=vi&&(Jr(t-i)<pr&&(t-=i*pr),Jr(n-c)<pr&&(n-=c*pr),r=$bt(t,r,n,o),e.point(i,r),e.lineEnd(),e.lineStart(),e.point(c,r),s=0),e.point(t=n,r=o),i=c},lineEnd:function(){e.lineEnd(),t=r=NaN},clean:function(){return 2-s}}}function $bt(e,t,r,i){var s,n,o=Ze(e-r);return Jr(o)>pr?Hu((Ze(t)*(n=Je(i))*Ze(r)-Ze(i)*(s=Je(t))*Ze(e))/(s*n*o)):(t+i)/2}function Hbt(e,t,r,i){var s;if(e==null)s=r*os,i.point(-vi,s),i.point(0,s),i.point(vi,s),i.point(vi,0),i.point(vi,-s),i.point(0,-s),i.point(-vi,-s),i.point(-vi,0),i.point(-vi,s);else if(Jr(e[0]-t[0])>pr){var n=e[0]<t[0]?vi:-vi;s=r*n/2,i.point(-n,s),i.point(0,s),i.point(n,s)}else i.point(t[0],t[1])}function k6(e){var t=Je(e),r=2*vr,i=t>0,s=Jr(t)>pr;function n(x,E,T,D){$B(D,e,r,T,x,E)}function o(x,E){return Je(x)*Je(E)>t}function c(x){var E,T,D,N,z;return{lineStart:function(){N=D=!1,z=1},point:function(U,H){var G=[U,H],Z,Y=o(U,H),st=i?Y?0:p(U,H):Y?p(U+(U<0?vi:-vi),H):0;if(!E&&(N=D=Y)&&x.lineStart(),Y!==D&&(Z=f(E,G),(!Z||T2(E,Z)||T2(G,Z))&&(G[2]=1)),Y!==D)z=0,Y?(x.lineStart(),Z=f(G,E),x.point(Z[0],Z[1])):(Z=f(E,G),x.point(Z[0],Z[1],2),x.lineEnd()),E=Z;else if(s&&E&&i^Y){var at;!(st&T)&&(at=f(G,E,!0))&&(z=0,i?(x.lineStart(),x.point(at[0][0],at[0][1]),x.point(at[1][0],at[1][1]),x.lineEnd()):(x.point(at[1][0],at[1][1]),x.lineEnd(),x.lineStart(),x.point(at[0][0],at[0][1],3)))}Y&&(!E||!T2(E,G))&&x.point(G[0],G[1]),E=G,D=Y,T=st},lineEnd:function(){D&&x.lineEnd(),E=null},clean:function(){return z|(N&&D)<<1}}}function f(x,E,T){var D=Wu(x),N=Wu(E),z=[1,0,0],U=Yd(D,N),H=_3(U,U),G=U[0],Z=H-G*G;if(!Z)return!T&&x;var Y=t*H/Z,st=-t*G/Z,at=Yd(z,U),Dt=y3(z,Y),Tt=y3(U,st);_6(Dt,Tt);var kt=at,Et=_3(Dt,kt),Mt=_3(kt,kt),oe=Et*Et-Mt*(_3(Dt,Dt)-1);if(!(oe<0)){var Xt=Cn(oe),xt=y3(kt,(-Et-Xt)/Mt);if(_6(xt,Dt),xt=S1(xt),!T)return xt;var jt=x[0],Wt=E[0],de=x[1],Ee=E[1],Se;Wt<jt&&(Se=jt,jt=Wt,Wt=Se);var ze=Wt-jt,ke=Jr(ze-vi)<pr,ir=ke||ze<pr;if(!ke&&Ee<de&&(Se=de,de=Ee,Ee=Se),ir?ke?de+Ee>0^xt[1]<(Jr(xt[0]-jt)<pr?de:Ee):de<=xt[1]&&xt[1]<=Ee:ze>vi^(jt<=xt[0]&&xt[0]<=Wt)){var Ti=y3(kt,(-Et+Xt)/Mt);return _6(Ti,Dt),[xt,S1(Ti)]}}}function p(x,E){var T=i?e:vi-e,D=0;return x<-T?D|=1:x>T&&(D|=2),E<-T?D|=4:E>T&&(D|=8),D}return R6(o,c,n,i?[0,-e]:[-vi,e-vi])}function eQ(e,t,r,i,s,n){var o=e[0],c=e[1],f=t[0],p=t[1],x=0,E=1,T=f-o,D=p-c,N;if(N=r-o,!(!T&&N>0)){if(N/=T,T<0){if(N<x)return;N<E&&(E=N)}else if(T>0){if(N>E)return;N>x&&(x=N)}if(N=s-o,!(!T&&N<0)){if(N/=T,T<0){if(N>E)return;N>x&&(x=N)}else if(T>0){if(N<x)return;N<E&&(E=N)}if(N=i-c,!(!D&&N>0)){if(N/=D,D<0){if(N<x)return;N<E&&(E=N)}else if(D>0){if(N>E)return;N>x&&(x=N)}if(N=n-c,!(!D&&N<0)){if(N/=D,D<0){if(N>E)return;N>x&&(x=N)}else if(D>0){if(N<x)return;N<E&&(E=N)}return x>0&&(e[0]=o+x*T,e[1]=c+x*D),E<1&&(t[0]=o+E*T,t[1]=c+E*D),!0}}}}}var E3=1e9,D6=-E3;function Gd(e,t,r,i){function s(p,x){return e<=p&&p<=r&&t<=x&&x<=i}function n(p,x,E,T){var D=0,N=0;if(p==null||(D=o(p,E))!==(N=o(x,E))||f(p,x)<0^E>0)do T.point(D===0||D===3?e:r,D>1?i:t);while((D=(D+E+4)%4)!==N);else T.point(x[0],x[1])}function o(p,x){return Jr(p[0]-e)<pr?x>0?0:3:Jr(p[0]-r)<pr?x>0?2:1:Jr(p[1]-t)<pr?x>0?1:0:x>0?3:2}function c(p,x){return f(p.x,x.x)}function f(p,x){var E=o(p,1),T=o(x,1);return E!==T?E-T:E===0?x[1]-p[1]:E===1?p[0]-x[0]:E===2?p[1]-x[1]:x[0]-p[0]}return function(p){var x=p,E=I6(),T,D,N,z,U,H,G,Z,Y,st,at,Dt={point:Tt,lineStart:oe,lineEnd:Xt,polygonStart:Et,polygonEnd:Mt};function Tt(jt,Wt){s(jt,Wt)&&x.point(jt,Wt)}function kt(){for(var jt=0,Wt=0,de=D.length;Wt<de;++Wt)for(var Ee=D[Wt],Se=1,ze=Ee.length,ke=Ee[0],ir,Ti,_i=ke[0],ci=ke[1];Se<ze;++Se)ir=_i,Ti=ci,ke=Ee[Se],_i=ke[0],ci=ke[1],Ti<=i?ci>i&&(_i-ir)*(i-Ti)>(ci-Ti)*(e-ir)&&++jt:ci<=i&&(_i-ir)*(i-Ti)<(ci-Ti)*(e-ir)&&--jt;return jt}function Et(){x=E,T=[],D=[],at=!0}function Mt(){var jt=kt(),Wt=at&&jt,de=(T=n1(T)).length;(Wt||de)&&(p.polygonStart(),Wt&&(p.lineStart(),n(null,null,1,p),p.lineEnd()),de&&C6(T,c,jt,n,p),p.polygonEnd()),x=p,T=D=N=null}function oe(){Dt.point=xt,D&&D.push(N=[]),st=!0,Y=!1,G=Z=NaN}function Xt(){T&&(xt(z,U),H&&Y&&E.rejoin(),T.push(E.result())),Dt.point=Tt,Y&&x.lineEnd()}function xt(jt,Wt){var de=s(jt,Wt);if(D&&N.push([jt,Wt]),st)z=jt,U=Wt,H=de,st=!1,de&&(x.lineStart(),x.point(jt,Wt));else if(de&&Y)x.point(jt,Wt);else{var Ee=[G=Math.max(D6,Math.min(E3,G)),Z=Math.max(D6,Math.min(E3,Z))],Se=[jt=Math.max(D6,Math.min(E3,jt)),Wt=Math.max(D6,Math.min(E3,Wt))];eQ(Ee,Se,e,t,r,i)?(Y||(x.lineStart(),x.point(Ee[0],Ee[1])),x.point(Se[0],Se[1]),de||x.lineEnd(),at=!1):de&&(x.lineStart(),x.point(jt,Wt),at=!1)}G=jt,Z=Wt,Y=de}return Dt}}function rQ(){var e=0,t=0,r=960,i=500,s,n,o;return o={stream:function(c){return s&&n===c?s:s=Gd(e,t,r,i)(n=c)},extent:function(c){return arguments.length?(e=+c[0][0],t=+c[0][1],r=+c[1][0],i=+c[1][1],s=n=null,o):[[e,t],[r,i]]}}}var WB,qB,B6,O6,S2={sphere:Dn,point:Dn,lineStart:Wbt,lineEnd:Dn,polygonStart:Dn,polygonEnd:Dn};function Wbt(){S2.point=Ybt,S2.lineEnd=qbt}function qbt(){S2.point=S2.lineEnd=Dn}function Ybt(e,t){e*=vr,t*=vr,qB=e,B6=Ze(t),O6=Je(t),S2.point=Xbt}function Xbt(e,t){e*=vr,t*=vr;var r=Ze(t),i=Je(t),s=Jr(e-qB),n=Je(s),o=Ze(s),c=i*o,f=O6*r-B6*i*n,p=B6*r+O6*i*n;WB.add(ps(Cn(c*c+f*f),p)),qB=e,B6=r,O6=i}function N6(e){return WB=new Kn,ma(e,S2),+WB}var YB=[null,null],Zbt={type:"LineString",coordinates:YB};function E2(e,t){return YB[0]=e,YB[1]=t,N6(Zbt)}var iQ={Feature:function(e,t){return F6(e.geometry,t)},FeatureCollection:function(e,t){for(var r=e.features,i=-1,s=r.length;++i<s;)if(F6(r[i].geometry,t))return!0;return!1}},nQ={Sphere:function(){return!0},Point:function(e,t){return sQ(e.coordinates,t)},MultiPoint:function(e,t){for(var r=e.coordinates,i=-1,s=r.length;++i<s;)if(sQ(r[i],t))return!0;return!1},LineString:function(e,t){return oQ(e.coordinates,t)},MultiLineString:function(e,t){for(var r=e.coordinates,i=-1,s=r.length;++i<s;)if(oQ(r[i],t))return!0;return!1},Polygon:function(e,t){return aQ(e.coordinates,t)},MultiPolygon:function(e,t){for(var r=e.coordinates,i=-1,s=r.length;++i<s;)if(aQ(r[i],t))return!0;return!1},GeometryCollection:function(e,t){for(var r=e.geometries,i=-1,s=r.length;++i<s;)if(F6(r[i],t))return!0;return!1}};function F6(e,t){return e&&nQ.hasOwnProperty(e.type)?nQ[e.type](e,t):!1}function sQ(e,t){return E2(e,t)===0}function oQ(e,t){for(var r,i,s,n=0,o=e.length;n<o;n++){if(i=E2(e[n],t),i===0||n>0&&(s=E2(e[n],e[n-1]),s>0&&r<=s&&i<=s&&(r+i-s)*(1-Math.pow((r-i)/s,2))<qd*s))return!0;r=i}return!1}function aQ(e,t){return!!P6(e.map(Gbt),lQ(t))}function Gbt(e){return e=e.map(lQ),e.pop(),e}function lQ(e){return[e[0]*vr,e[1]*vr]}function cQ(e,t){return(e&&iQ.hasOwnProperty(e.type)?iQ[e.type]:F6)(e,t)}function uQ(e,t,r){var i=Vu(e,t-pr,r).concat(t);return function(s){return i.map(function(n){return[s,n]})}}function hQ(e,t,r){var i=Vu(e,t-pr,r).concat(t);return function(s){return i.map(function(n){return[n,s]})}}function L6(){var e,t,r,i,s,n,o,c,f=10,p=f,x=90,E=360,T,D,N,z,U=2.5;function H(){return{type:"MultiLineString",coordinates:G()}}function G(){return Vu(m3(i/x)*x,r,x).map(N).concat(Vu(m3(c/E)*E,o,E).map(z)).concat(Vu(m3(t/f)*f,e,f).filter(function(Z){return Jr(Z%x)>pr}).map(T)).concat(Vu(m3(n/p)*p,s,p).filter(function(Z){return Jr(Z%E)>pr}).map(D))}return H.lines=function(){return G().map(function(Z){return{type:"LineString",coordinates:Z}})},H.outline=function(){return{type:"Polygon",coordinates:[N(i).concat(z(o).slice(1),N(r).reverse().slice(1),z(c).reverse().slice(1))]}},H.extent=function(Z){return arguments.length?H.extentMajor(Z).extentMinor(Z):H.extentMinor()},H.extentMajor=function(Z){return arguments.length?(i=+Z[0][0],r=+Z[1][0],c=+Z[0][1],o=+Z[1][1],i>r&&(Z=i,i=r,r=Z),c>o&&(Z=c,c=o,o=Z),H.precision(U)):[[i,c],[r,o]]},H.extentMinor=function(Z){return arguments.length?(t=+Z[0][0],e=+Z[1][0],n=+Z[0][1],s=+Z[1][1],t>e&&(Z=t,t=e,e=Z),n>s&&(Z=n,n=s,s=Z),H.precision(U)):[[t,n],[e,s]]},H.step=function(Z){return arguments.length?H.stepMajor(Z).stepMinor(Z):H.stepMinor()},H.stepMajor=function(Z){return arguments.length?(x=+Z[0],E=+Z[1],H):[x,E]},H.stepMinor=function(Z){return arguments.length?(f=+Z[0],p=+Z[1],H):[f,p]},H.precision=function(Z){return arguments.length?(U=+Z,T=uQ(n,s,90),D=hQ(t,e,U),N=uQ(c,o,90),z=hQ(i,r,U),H):U},H.extentMajor([[-180,-90+pr],[180,90-pr]]).extentMinor([[-180,-80-pr],[180,80+pr]])}function fQ(){return L6()()}function pQ(e,t){var r=e[0]*vr,i=e[1]*vr,s=t[0]*vr,n=t[1]*vr,o=Je(i),c=Ze(i),f=Je(n),p=Ze(n),x=o*Je(r),E=o*Ze(r),T=f*Je(s),D=f*Ze(s),N=2*ds(Cn(kB(n-i)+o*f*kB(s-r))),z=Ze(N),U=N?function(H){var G=Ze(H*=N)/z,Z=Ze(N-H)/z,Y=Z*x+G*T,st=Z*E+G*D,at=Z*c+G*p;return[ps(st,Y)*yn,ps(at,Cn(Y*Y+st*st))*yn]}:function(){return[r*yn,i*yn]};return U.distance=N,U}var ZA=e=>e;var XB=new Kn,ZB=new Kn,dQ,AQ,GB,QB,GA={point:Dn,lineStart:Dn,lineEnd:Dn,polygonStart:function(){GA.lineStart=Qbt,GA.lineEnd=Jbt},polygonEnd:function(){GA.lineStart=GA.lineEnd=GA.point=Dn,XB.add(Jr(ZB)),ZB=new Kn},result:function(){var e=XB/2;return XB=new Kn,e}};function Qbt(){GA.point=Kbt}function Kbt(e,t){GA.point=mQ,dQ=GB=e,AQ=QB=t}function mQ(e,t){ZB.add(QB*e-GB*t),GB=e,QB=t}function Jbt(){mQ(dQ,AQ)}var KB=GA;var I2=1/0,z6=I2,I3=-I2,U6=I3,tvt={point:evt,lineStart:Dn,lineEnd:Dn,polygonStart:Dn,polygonEnd:Dn,result:function(){var e=[[I2,z6],[I3,U6]];return I3=U6=-(z6=I2=1/0),e}};function evt(e,t){e<I2&&(I2=e),e>I3&&(I3=e),t<z6&&(z6=t),t>U6&&(U6=t)}var M2=tvt;var JB=0,tO=0,M3=0,V6=0,j6=0,C2=0,eO=0,rO=0,C3=0,yQ,xQ,cp,up,Jh={point:C1,lineStart:gQ,lineEnd:_Q,polygonStart:function(){Jh.lineStart=nvt,Jh.lineEnd=svt},polygonEnd:function(){Jh.point=C1,Jh.lineStart=gQ,Jh.lineEnd=_Q},result:function(){var e=C3?[eO/C3,rO/C3]:C2?[V6/C2,j6/C2]:M3?[JB/M3,tO/M3]:[NaN,NaN];return JB=tO=M3=V6=j6=C2=eO=rO=C3=0,e}};function C1(e,t){JB+=e,tO+=t,++M3}function gQ(){Jh.point=rvt}function rvt(e,t){Jh.point=ivt,C1(cp=e,up=t)}function ivt(e,t){var r=e-cp,i=t-up,s=Cn(r*r+i*i);V6+=s*(cp+e)/2,j6+=s*(up+t)/2,C2+=s,C1(cp=e,up=t)}function _Q(){Jh.point=C1}function nvt(){Jh.point=ovt}function svt(){bQ(yQ,xQ)}function ovt(e,t){Jh.point=bQ,C1(yQ=cp=e,xQ=up=t)}function bQ(e,t){var r=e-cp,i=t-up,s=Cn(r*r+i*i);V6+=s*(cp+e)/2,j6+=s*(up+t)/2,C2+=s,s=up*e-cp*t,eO+=s*(cp+e),rO+=s*(up+t),C3+=s*3,C1(cp=e,up=t)}var iO=Jh;function $6(e){this._context=e}$6.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t),this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,Eo);break}}},result:Dn};var sO=new Kn,nO,vQ,wQ,P3,R3,H6={point:Dn,lineStart:function(){H6.point=avt},lineEnd:function(){nO&&TQ(vQ,wQ),H6.point=Dn},polygonStart:function(){nO=!0},polygonEnd:function(){nO=null},result:function(){var e=+sO;return sO=new Kn,e}};function avt(e,t){H6.point=TQ,vQ=P3=e,wQ=R3=t}function TQ(e,t){P3-=e,R3-=t,sO.add(Cn(P3*P3+R3*R3)),P3=e,R3=t}var oO=H6;var SQ,W6,EQ,IQ,P2=class{constructor(t){this._append=t==null?MQ:lvt(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(t,r){switch(this._point){case 0:{this._append`M${t},${r}`,this._point=1;break}case 1:{this._append`L${t},${r}`;break}default:{if(this._append`M${t},${r}`,this._radius!==EQ||this._append!==W6){let i=this._radius,s=this._;this._="",this._append`m0,${i}a${i},${i} 0 1,1 0,${-2*i}a${i},${i} 0 1,1 0,${2*i}z`,EQ=i,W6=this._append,IQ=this._,this._=s}this._+=IQ;break}}}result(){let t=this._;return this._="",t.length?t:null}};function MQ(e){let t=1;this._+=e[0];for(let r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function lvt(e){let t=Math.floor(e);if(!(t>=0))throw new RangeError(`invalid digits: ${e}`);if(t>15)return MQ;if(t!==SQ){let r=10**t;SQ=t,W6=function(s){let n=1;this._+=s[0];for(let o=s.length;n<o;++n)this._+=Math.round(arguments[n]*r)/r+s[n]}}return W6}function CQ(e,t){let r=3,i=4.5,s,n;function o(c){return c&&(typeof i=="function"&&n.pointRadius(+i.apply(this,arguments)),ma(c,s(n))),n.result()}return o.area=function(c){return ma(c,s(KB)),KB.result()},o.measure=function(c){return ma(c,s(oO)),oO.result()},o.bounds=function(c){return ma(c,s(M2)),M2.result()},o.centroid=function(c){return ma(c,s(iO)),iO.result()},o.projection=function(c){return arguments.length?(s=c==null?(e=null,ZA):(e=c).stream,o):e},o.context=function(c){return arguments.length?(n=c==null?(t=null,new P2(r)):new $6(t=c),typeof i!="function"&&n.pointRadius(i),o):t},o.pointRadius=function(c){return arguments.length?(i=typeof c=="function"?c:(n.pointRadius(+c),+c),o):i},o.digits=function(c){if(!arguments.length)return r;if(c==null)r=null;else{let f=Math.floor(c);if(!(f>=0))throw new RangeError(`invalid digits: ${c}`);r=f}return t===null&&(n=new P2(r)),o},o.projection(e).digits(r).context(t)}function PQ(e){return{stream:QA(e)}}function QA(e){return function(t){var r=new aO;for(var i in e)r[i]=e[i];return r.stream=t,r}}function aO(){}aO.prototype={constructor:aO,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function lO(e,t,r){var i=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),i!=null&&e.clipExtent(null),ma(r,e.stream(M2)),t(M2.result()),i!=null&&e.clipExtent(i),e}function P1(e,t,r){return lO(e,function(i){var s=t[1][0]-t[0][0],n=t[1][1]-t[0][1],o=Math.min(s/(i[1][0]-i[0][0]),n/(i[1][1]-i[0][1])),c=+t[0][0]+(s-o*(i[1][0]+i[0][0]))/2,f=+t[0][1]+(n-o*(i[1][1]+i[0][1]))/2;e.scale(150*o).translate([c,f])},r)}function R2(e,t,r){return P1(e,[[0,0],t],r)}function k2(e,t,r){return lO(e,function(i){var s=+t,n=s/(i[1][0]-i[0][0]),o=(s-n*(i[1][0]+i[0][0]))/2,c=-n*i[0][1];e.scale(150*n).translate([o,c])},r)}function D2(e,t,r){return lO(e,function(i){var s=+t,n=s/(i[1][1]-i[0][1]),o=-n*i[0][0],c=(s-n*(i[1][1]+i[0][1]))/2;e.scale(150*n).translate([o,c])},r)}var RQ=16,cvt=Je(30*vr);function cO(e,t){return+t?hvt(e,t):uvt(e)}function uvt(e){return QA({point:function(t,r){t=e(t,r),this.stream.point(t[0],t[1])}})}function hvt(e,t){function r(i,s,n,o,c,f,p,x,E,T,D,N,z,U){var H=p-i,G=x-s,Z=H*H+G*G;if(Z>4*t&&z--){var Y=o+T,st=c+D,at=f+N,Dt=Cn(Y*Y+st*st+at*at),Tt=ds(at/=Dt),kt=Jr(Jr(at)-1)<pr||Jr(n-E)<pr?(n+E)/2:ps(st,Y),Et=e(kt,Tt),Mt=Et[0],oe=Et[1],Xt=Mt-i,xt=oe-s,jt=G*Xt-H*xt;(jt*jt/Z>t||Jr((H*Xt+G*xt)/Z-.5)>.3||o*T+c*D+f*N<cvt)&&(r(i,s,n,o,c,f,Mt,oe,kt,Y/=Dt,st/=Dt,at,z,U),U.point(Mt,oe),r(Mt,oe,kt,Y,st,at,p,x,E,T,D,N,z,U))}}return function(i){var s,n,o,c,f,p,x,E,T,D,N,z,U={point:H,lineStart:G,lineEnd:Y,polygonStart:function(){i.polygonStart(),U.lineStart=st},polygonEnd:function(){i.polygonEnd(),U.lineStart=G}};function H(Tt,kt){Tt=e(Tt,kt),i.point(Tt[0],Tt[1])}function G(){E=NaN,U.point=Z,i.lineStart()}function Z(Tt,kt){var Et=Wu([Tt,kt]),Mt=e(Tt,kt);r(E,T,x,D,N,z,E=Mt[0],T=Mt[1],x=Tt,D=Et[0],N=Et[1],z=Et[2],RQ,i),i.point(E,T)}function Y(){U.point=H,i.lineEnd()}function st(){G(),U.point=at,U.lineEnd=Dt}function at(Tt,kt){Z(s=Tt,kt),n=E,o=T,c=D,f=N,p=z,U.point=Z}function Dt(){r(E,T,x,D,N,z,n,o,s,c,f,p,RQ,i),U.lineEnd=Y,Y()}return U}}var fvt=QA({point:function(e,t){this.stream.point(e*vr,t*vr)}});function pvt(e){return QA({point:function(t,r){var i=e(t,r);return this.stream.point(i[0],i[1])}})}function dvt(e,t,r,i,s){function n(o,c){return o*=i,c*=s,[t+e*o,r-e*c]}return n.invert=function(o,c){return[(o-t)/e*i,(r-c)/e*s]},n}function kQ(e,t,r,i,s,n){if(!n)return dvt(e,t,r,i,s);var o=Je(n),c=Ze(n),f=o*e,p=c*e,x=o/e,E=c/e,T=(c*r-o*t)/e,D=(c*t+o*r)/e;function N(z,U){return z*=i,U*=s,[f*z-p*U+t,r-p*z-f*U]}return N.invert=function(z,U){return[i*(x*z-E*U+T),s*(D-E*z-x*U)]},N}function Io(e){return k3(function(){return e})()}function k3(e){var t,r=150,i=480,s=250,n=0,o=0,c=0,f=0,p=0,x,E=0,T=1,D=1,N=null,z=S3,U=null,H,G,Z,Y=ZA,st=.5,at,Dt,Tt,kt,Et;function Mt(jt){return Tt(jt[0]*vr,jt[1]*vr)}function oe(jt){return jt=Tt.invert(jt[0],jt[1]),jt&&[jt[0]*yn,jt[1]*yn]}Mt.stream=function(jt){return kt&&Et===jt?kt:kt=fvt(pvt(x)(z(at(Y(Et=jt)))))},Mt.preclip=function(jt){return arguments.length?(z=jt,N=void 0,xt()):z},Mt.postclip=function(jt){return arguments.length?(Y=jt,U=H=G=Z=null,xt()):Y},Mt.clipAngle=function(jt){return arguments.length?(z=+jt?k6(N=jt*vr):(N=null,S3),xt()):N*yn},Mt.clipExtent=function(jt){return arguments.length?(Y=jt==null?(U=H=G=Z=null,ZA):Gd(U=+jt[0][0],H=+jt[0][1],G=+jt[1][0],Z=+jt[1][1]),xt()):U==null?null:[[U,H],[G,Z]]},Mt.scale=function(jt){return arguments.length?(r=+jt,Xt()):r},Mt.translate=function(jt){return arguments.length?(i=+jt[0],s=+jt[1],Xt()):[i,s]},Mt.center=function(jt){return arguments.length?(n=jt[0]%360*vr,o=jt[1]%360*vr,Xt()):[n*yn,o*yn]},Mt.rotate=function(jt){return arguments.length?(c=jt[0]%360*vr,f=jt[1]%360*vr,p=jt.length>2?jt[2]%360*vr:0,Xt()):[c*yn,f*yn,p*yn]},Mt.angle=function(jt){return arguments.length?(E=jt%360*vr,Xt()):E*yn},Mt.reflectX=function(jt){return arguments.length?(T=jt?-1:1,Xt()):T<0},Mt.reflectY=function(jt){return arguments.length?(D=jt?-1:1,Xt()):D<0},Mt.precision=function(jt){return arguments.length?(at=cO(Dt,st=jt*jt),xt()):Cn(st)},Mt.fitExtent=function(jt,Wt){return P1(Mt,jt,Wt)},Mt.fitSize=function(jt,Wt){return R2(Mt,jt,Wt)},Mt.fitWidth=function(jt,Wt){return k2(Mt,jt,Wt)},Mt.fitHeight=function(jt,Wt){return D2(Mt,jt,Wt)};function Xt(){var jt=kQ(r,0,0,T,D,E).apply(null,t(n,o)),Wt=kQ(r,i-jt[0],s-jt[1],T,D,E);return x=T3(c,f,p),Dt=w3(t,Wt),Tt=w3(x,Dt),at=cO(Dt,st),xt()}function xt(){return kt=Et=null,Mt}return function(){return t=e.apply(this,arguments),Mt.invert=t.invert&&oe,Xt()}}function B2(e){var t=0,r=vi/3,i=k3(e),s=i(t,r);return s.parallels=function(n){return arguments.length?i(t=n[0]*vr,r=n[1]*vr):[t*yn,r*yn]},s}function DQ(e){var t=Je(e);function r(i,s){return[i*t,Ze(s)/t]}return r.invert=function(i,s){return[i/t,ds(s*t)]},r}function uO(e,t){var r=Ze(e),i=(r+Ze(t))/2;if(Jr(i)<pr)return DQ(e);var s=1+r*(2*i-r),n=Cn(s)/i;function o(c,f){var p=Cn(s-2*i*Ze(f))/i;return[p*Ze(c*=i),n-p*Je(c)]}return o.invert=function(c,f){var p=n-f,x=ps(c,Jr(p))*Al(p);return p*i<0&&(x-=vi*Al(c)*Al(p)),[x/i,ds((s-(c*c+p*p)*i*i)/(2*i))]},o}function R1(){return B2(uO).scale(155.424).center([0,33.6442])}function q6(){return R1().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function Avt(e){var t=e.length;return{point:function(r,i){for(var s=-1;++s<t;)e[s].point(r,i)},sphere:function(){for(var r=-1;++r<t;)e[r].sphere()},lineStart:function(){for(var r=-1;++r<t;)e[r].lineStart()},lineEnd:function(){for(var r=-1;++r<t;)e[r].lineEnd()},polygonStart:function(){for(var r=-1;++r<t;)e[r].polygonStart()},polygonEnd:function(){for(var r=-1;++r<t;)e[r].polygonEnd()}}}function BQ(){var e,t,r=q6(),i,s=R1().rotate([154,0]).center([-2,58.5]).parallels([55,65]),n,o=R1().rotate([157,0]).center([-3,19.9]).parallels([8,18]),c,f,p={point:function(T,D){f=[T,D]}};function x(T){var D=T[0],N=T[1];return f=null,i.point(D,N),f||(n.point(D,N),f)||(c.point(D,N),f)}x.invert=function(T){var D=r.scale(),N=r.translate(),z=(T[0]-N[0])/D,U=(T[1]-N[1])/D;return(U>=.12&&U<.234&&z>=-.425&&z<-.214?s:U>=.166&&U<.234&&z>=-.214&&z<-.115?o:r).invert(T)},x.stream=function(T){return e&&t===T?e:e=Avt([r.stream(t=T),s.stream(T),o.stream(T)])},x.precision=function(T){return arguments.length?(r.precision(T),s.precision(T),o.precision(T),E()):r.precision()},x.scale=function(T){return arguments.length?(r.scale(T),s.scale(T*.35),o.scale(T),x.translate(r.translate())):r.scale()},x.translate=function(T){if(!arguments.length)return r.translate();var D=r.scale(),N=+T[0],z=+T[1];return i=r.translate(T).clipExtent([[N-.455*D,z-.238*D],[N+.455*D,z+.238*D]]).stream(p),n=s.translate([N-.307*D,z+.201*D]).clipExtent([[N-.425*D+pr,z+.12*D+pr],[N-.214*D-pr,z+.234*D-pr]]).stream(p),c=o.translate([N-.205*D,z+.212*D]).clipExtent([[N-.214*D+pr,z+.166*D+pr],[N-.115*D-pr,z+.234*D-pr]]).stream(p),E()},x.fitExtent=function(T,D){return P1(x,T,D)},x.fitSize=function(T,D){return R2(x,T,D)},x.fitWidth=function(T,D){return k2(x,T,D)},x.fitHeight=function(T,D){return D2(x,T,D)};function E(){return e=t=null,x}return x.scale(1070)}function Y6(e){return function(t,r){var i=Je(t),s=Je(r),n=e(i*s);return n===1/0?[2,0]:[n*s*Ze(t),n*Ze(r)]}}function hp(e){return function(t,r){var i=Cn(t*t+r*r),s=e(i),n=Ze(s),o=Je(s);return[ps(t*n,i*o),ds(i&&r*n/i)]}}var X6=Y6(function(e){return Cn(2/(1+e))});X6.invert=hp(function(e){return 2*ds(e/2)});function OQ(){return Io(X6).scale(124.75).clipAngle(180-.001)}var Z6=Y6(function(e){return(e=A6(e))&&e/Ze(e)});Z6.invert=hp(function(e){return e});function NQ(){return Io(Z6).scale(79.4188).clipAngle(180-.001)}function k1(e,t){return[e,T1(v2((os+t)/2))]}k1.invert=function(e,t){return[e,2*Hu(f6(t))-os]};function FQ(){return hO(k1).scale(961/Eo)}function hO(e){var t=Io(e),r=t.center,i=t.scale,s=t.translate,n=t.clipExtent,o=null,c,f,p;t.scale=function(E){return arguments.length?(i(E),x()):i()},t.translate=function(E){return arguments.length?(s(E),x()):s()},t.center=function(E){return arguments.length?(r(E),x()):r()},t.clipExtent=function(E){return arguments.length?(E==null?o=c=f=p=null:(o=+E[0][0],c=+E[0][1],f=+E[1][0],p=+E[1][1]),x()):o==null?null:[[o,c],[f,p]]};function x(){var E=vi*i(),T=t(E6(t.rotate()).invert([0,0]));return n(o==null?[[T[0]-E,T[1]-E],[T[0]+E,T[1]+E]]:e===k1?[[Math.max(T[0]-E,o),c],[Math.min(T[0]+E,f),p]]:[[o,Math.max(T[1]-E,c)],[f,Math.min(T[1]+E,p)]])}return x()}function G6(e){return v2((os+e)/2)}function fO(e,t){var r=Je(e),i=e===t?Ze(e):T1(r/Je(t))/T1(G6(t)/G6(e)),s=r*d6(G6(e),i)/i;if(!i)return k1;function n(o,c){s>0?c<-os+pr&&(c=-os+pr):c>os-pr&&(c=os-pr);var f=s/d6(G6(c),i);return[f*Ze(i*o),s-f*Je(i*o)]}return n.invert=function(o,c){var f=s-c,p=Al(i)*Cn(o*o+f*f),x=ps(o,Jr(f))*Al(f);return f*i<0&&(x-=vi*Al(o)*Al(f)),[x/i,2*Hu(d6(s/p,1/i))-os]},n}function LQ(){return B2(fO).scale(109.5).parallels([30,30])}function D1(e,t){return[e,t]}D1.invert=D1;function zQ(){return Io(D1).scale(152.63)}function pO(e,t){var r=Je(e),i=e===t?Ze(e):(r-Je(t))/(t-e),s=r/i+e;if(Jr(i)<pr)return D1;function n(o,c){var f=s-c,p=i*o;return[f*Ze(p),s-f*Je(p)]}return n.invert=function(o,c){var f=s-c,p=ps(o,Jr(f))*Al(f);return f*i<0&&(p-=vi*Al(o)*Al(f)),[p/i,s-Al(i)*Cn(o*o+f*f)]},n}function UQ(){return B2(pO).scale(131.154).center([0,13.9389])}var D3=1.340264,B3=-.081106,O3=893e-6,N3=.003796,Q6=Cn(3)/2,mvt=12;function K6(e,t){var r=ds(Q6*Ze(t)),i=r*r,s=i*i*i;return[e*Je(r)/(Q6*(D3+3*B3*i+s*(7*O3+9*N3*i))),r*(D3+B3*i+s*(O3+N3*i))]}K6.invert=function(e,t){for(var r=t,i=r*r,s=i*i*i,n=0,o,c,f;n<mvt&&(c=r*(D3+B3*i+s*(O3+N3*i))-t,f=D3+3*B3*i+s*(7*O3+9*N3*i),r-=o=c/f,i=r*r,s=i*i*i,!(Jr(o)<qd));++n);return[Q6*e*(D3+3*B3*i+s*(7*O3+9*N3*i))/Je(r),ds(Ze(r)/Q6)]};function VQ(){return Io(K6).scale(177.158)}function J6(e,t){var r=Je(t),i=Je(e)*r;return[r*Ze(e)/i,Ze(t)/i]}J6.invert=hp(Hu);function jQ(){return Io(J6).scale(144.049).clipAngle(60)}function $Q(){var e=1,t=0,r=0,i=1,s=1,n=0,o,c,f=null,p,x,E,T=1,D=1,N=QA({point:function(Y,st){var at=Z([Y,st]);this.stream.point(at[0],at[1])}}),z=ZA,U,H;function G(){return T=e*i,D=e*s,U=H=null,Z}function Z(Y){var st=Y[0]*T,at=Y[1]*D;if(n){var Dt=at*o-st*c;st=st*o+at*c,at=Dt}return[st+t,at+r]}return Z.invert=function(Y){var st=Y[0]-t,at=Y[1]-r;if(n){var Dt=at*o+st*c;st=st*o-at*c,at=Dt}return[st/T,at/D]},Z.stream=function(Y){return U&&H===Y?U:U=N(z(H=Y))},Z.postclip=function(Y){return arguments.length?(z=Y,f=p=x=E=null,G()):z},Z.clipExtent=function(Y){return arguments.length?(z=Y==null?(f=p=x=E=null,ZA):Gd(f=+Y[0][0],p=+Y[0][1],x=+Y[1][0],E=+Y[1][1]),G()):f==null?null:[[f,p],[x,E]]},Z.scale=function(Y){return arguments.length?(e=+Y,G()):e},Z.translate=function(Y){return arguments.length?(t=+Y[0],r=+Y[1],G()):[t,r]},Z.angle=function(Y){return arguments.length?(n=Y%360*vr,c=Ze(n),o=Je(n),G()):n*yn},Z.reflectX=function(Y){return arguments.length?(i=Y?-1:1,G()):i<0},Z.reflectY=function(Y){return arguments.length?(s=Y?-1:1,G()):s<0},Z.fitExtent=function(Y,st){return P1(Z,Y,st)},Z.fitSize=function(Y,st){return R2(Z,Y,st)},Z.fitWidth=function(Y,st){return k2(Z,Y,st)},Z.fitHeight=function(Y,st){return D2(Z,Y,st)},Z}function tI(e,t){var r=t*t,i=r*r;return[e*(.8707-.131979*r+i*(-.013791+i*(.003971*r-.001529*i))),t*(1.007226+r*(.015085+i*(-.044475+.028874*r-.005916*i)))]}tI.invert=function(e,t){var r=t,i=25,s;do{var n=r*r,o=n*n;r-=s=(r*(1.007226+n*(.015085+o*(-.044475+.028874*n-.005916*o)))-t)/(1.007226+n*(.015085*3+o*(-.044475*7+.028874*9*n-.005916*11*o)))}while(Jr(s)>pr&&--i>0);return[e/(.8707+(n=r*r)*(-.131979+n*(-.013791+n*n*n*(.003971-.001529*n)))),r]};function HQ(){return Io(tI).scale(175.295)}function eI(e,t){return[Je(t)*Ze(e),Ze(t)]}eI.invert=hp(ds);function WQ(){return Io(eI).scale(249.5).clipAngle(90+pr)}function rI(e,t){var r=Je(t),i=1+Je(e)*r;return[r*Ze(e)/i,Ze(t)/i]}rI.invert=hp(function(e){return 2*Hu(e)});function qQ(){return Io(rI).scale(250).clipAngle(142)}function iI(e,t){return[T1(v2((os+t)/2)),-e]}iI.invert=function(e,t){return[-t,2*Hu(f6(e))-os]};function YQ(){var e=hO(iI),t=e.center,r=e.rotate;return e.center=function(i){return arguments.length?t([-i[1],i[0]]):(i=t(),[i[1],-i[0]])},e.rotate=function(i){return arguments.length?r([i[0],i[1],i.length>2?i[2]+90:90]):(i=r(),[i[0],i[1],i[2]-90])},r([0,0,90]).scale(159.155)}function gvt(e,t){return e.parent===t.parent?1:2}function _vt(e){return e.reduce(yvt,0)/e.length}function yvt(e,t){return e+t.x}function xvt(e){return 1+e.reduce(bvt,0)}function bvt(e,t){return Math.max(e,t.y)}function vvt(e){for(var t;t=e.children;)e=t[0];return e}function wvt(e){for(var t;t=e.children;)e=t[t.length-1];return e}function XQ(){var e=gvt,t=1,r=1,i=!1;function s(n){var o,c=0;n.eachAfter(function(T){var D=T.children;D?(T.x=_vt(D),T.y=xvt(D)):(T.x=o?c+=e(T,o):0,T.y=0,o=T)});var f=vvt(n),p=wvt(n),x=f.x-e(f,p)/2,E=p.x+e(p,f)/2;return n.eachAfter(i?function(T){T.x=(T.x-n.x)*t,T.y=(n.y-T.y)*r}:function(T){T.x=(T.x-x)/(E-x)*t,T.y=(1-(n.y?T.y/n.y:1))*r})}return s.separation=function(n){return arguments.length?(e=n,s):e},s.size=function(n){return arguments.length?(i=!1,t=+n[0],r=+n[1],s):i?null:[t,r]},s.nodeSize=function(n){return arguments.length?(i=!0,t=+n[0],r=+n[1],s):i?[t,r]:null},s}function Tvt(e){var t=0,r=e.children,i=r&&r.length;if(!i)t=1;else for(;--i>=0;)t+=r[i].value;e.value=t}function ZQ(){return this.eachAfter(Tvt)}function GQ(e,t){let r=-1;for(let i of this)e.call(t,i,++r,this);return this}function QQ(e,t){for(var r=this,i=[r],s,n,o=-1;r=i.pop();)if(e.call(t,r,++o,this),s=r.children)for(n=s.length-1;n>=0;--n)i.push(s[n]);return this}function KQ(e,t){for(var r=this,i=[r],s=[],n,o,c,f=-1;r=i.pop();)if(s.push(r),n=r.children)for(o=0,c=n.length;o<c;++o)i.push(n[o]);for(;r=s.pop();)e.call(t,r,++f,this);return this}function JQ(e,t){let r=-1;for(let i of this)if(e.call(t,i,++r,this))return i}function tK(e){return this.eachAfter(function(t){for(var r=+e(t.data)||0,i=t.children,s=i&&i.length;--s>=0;)r+=i[s].value;t.value=r})}function eK(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})}function rK(e){for(var t=this,r=Svt(t,e),i=[t];t!==r;)t=t.parent,i.push(t);for(var s=i.length;e!==r;)i.splice(s,0,e),e=e.parent;return i}function Svt(e,t){if(e===t)return e;var r=e.ancestors(),i=t.ancestors(),s=null;for(e=r.pop(),t=i.pop();e===t;)s=e,e=r.pop(),t=i.pop();return s}function iK(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t}function nK(){return Array.from(this)}function sK(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e}function oK(){var e=this,t=[];return e.each(function(r){r!==e&&t.push({source:r.parent,target:r})}),t}function*aK(){var e=this,t,r=[e],i,s,n;do for(t=r.reverse(),r=[];e=t.pop();)if(yield e,i=e.children)for(s=0,n=i.length;s<n;++s)r.push(i[s]);while(r.length)}function F3(e,t){e instanceof Map?(e=[void 0,e],t===void 0&&(t=Mvt)):t===void 0&&(t=Ivt);for(var r=new fp(e),i,s=[r],n,o,c,f;i=s.pop();)if((o=t(i.data))&&(f=(o=Array.from(o)).length))for(i.children=o,c=f-1;c>=0;--c)s.push(n=o[c]=new fp(o[c])),n.parent=i,n.depth=i.depth+1;return r.eachBefore(dO)}function Evt(){return F3(this).eachBefore(Cvt)}function Ivt(e){return e.children}function Mvt(e){return Array.isArray(e)?e[1]:null}function Cvt(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function dO(e){var t=0;do e.height=t;while((e=e.parent)&&e.height<++t)}function fp(e){this.data=e,this.depth=this.height=0,this.parent=null}fp.prototype=F3.prototype={constructor:fp,count:ZQ,each:GQ,eachAfter:KQ,eachBefore:QQ,find:JQ,sum:tK,sort:eK,path:rK,ancestors:iK,descendants:nK,leaves:sK,links:oK,copy:Evt,[Symbol.iterator]:aK};function O2(e){return e==null?null:AO(e)}function AO(e){if(typeof e!="function")throw new Error;return e}function Qd(){return 0}function KA(e){return function(){return e}}function N2(){let e=1;return()=>(e=(1664525*e+1013904223)%4294967296)/4294967296}function lK(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function cK(e,t){let r=e.length,i,s;for(;r;)s=t()*r--|0,i=e[r],e[r]=e[s],e[s]=i;return e}function uK(e){return gO(e,N2())}function gO(e,t){for(var r=0,i=(e=cK(Array.from(e),t)).length,s=[],n,o;r<i;)n=e[r],o&&hK(o,n)?++r:(o=Rvt(s=Pvt(s,n)),r=0);return o}function Pvt(e,t){var r,i;if(mO(t,e))return[t];for(r=0;r<e.length;++r)if(nI(t,e[r])&&mO(L3(e[r],t),e))return[e[r],t];for(r=0;r<e.length-1;++r)for(i=r+1;i<e.length;++i)if(nI(L3(e[r],e[i]),t)&&nI(L3(e[r],t),e[i])&&nI(L3(e[i],t),e[r])&&mO(fK(e[r],e[i],t),e))return[e[r],e[i],t];throw new Error}function nI(e,t){var r=e.r-t.r,i=t.x-e.x,s=t.y-e.y;return r<0||r*r<i*i+s*s}function hK(e,t){var r=e.r-t.r+Math.max(e.r,t.r,1)*1e-9,i=t.x-e.x,s=t.y-e.y;return r>0&&r*r>i*i+s*s}function mO(e,t){for(var r=0;r<t.length;++r)if(!hK(e,t[r]))return!1;return!0}function Rvt(e){switch(e.length){case 1:return kvt(e[0]);case 2:return L3(e[0],e[1]);case 3:return fK(e[0],e[1],e[2])}}function kvt(e){return{x:e.x,y:e.y,r:e.r}}function L3(e,t){var r=e.x,i=e.y,s=e.r,n=t.x,o=t.y,c=t.r,f=n-r,p=o-i,x=c-s,E=Math.sqrt(f*f+p*p);return{x:(r+n+f/E*x)/2,y:(i+o+p/E*x)/2,r:(E+s+c)/2}}function fK(e,t,r){var i=e.x,s=e.y,n=e.r,o=t.x,c=t.y,f=t.r,p=r.x,x=r.y,E=r.r,T=i-o,D=i-p,N=s-c,z=s-x,U=f-n,H=E-n,G=i*i+s*s-n*n,Z=G-o*o-c*c+f*f,Y=G-p*p-x*x+E*E,st=D*N-T*z,at=(N*Y-z*Z)/(st*2)-i,Dt=(z*U-N*H)/st,Tt=(D*Z-T*Y)/(st*2)-s,kt=(T*H-D*U)/st,Et=Dt*Dt+kt*kt-1,Mt=2*(n+at*Dt+Tt*kt),oe=at*at+Tt*Tt-n*n,Xt=-(Math.abs(Et)>1e-6?(Mt+Math.sqrt(Mt*Mt-4*Et*oe))/(2*Et):oe/Mt);return{x:i+at+Dt*Xt,y:s+Tt+kt*Xt,r:Xt}}function pK(e,t,r){var i=e.x-t.x,s,n,o=e.y-t.y,c,f,p=i*i+o*o;p?(n=t.r+r.r,n*=n,f=e.r+r.r,f*=f,n>f?(s=(p+f-n)/(2*p),c=Math.sqrt(Math.max(0,f/p-s*s)),r.x=e.x-s*i-c*o,r.y=e.y-s*o+c*i):(s=(p+n-f)/(2*p),c=Math.sqrt(Math.max(0,n/p-s*s)),r.x=t.x+s*i-c*o,r.y=t.y+s*o+c*i)):(r.x=t.x+r.r,r.y=t.y)}function dK(e,t){var r=e.r+t.r-1e-6,i=t.x-e.x,s=t.y-e.y;return r>0&&r*r>i*i+s*s}function AK(e){var t=e._,r=e.next._,i=t.r+r.r,s=(t.x*r.r+r.x*t.r)/i,n=(t.y*r.r+r.y*t.r)/i;return s*s+n*n}function sI(e){this._=e,this.next=null,this.previous=null}function _O(e,t){if(!(n=(e=lK(e)).length))return 0;var r,i,s,n,o,c,f,p,x,E,T;if(r=e[0],r.x=0,r.y=0,!(n>1))return r.r;if(i=e[1],r.x=-i.r,i.x=r.r,i.y=0,!(n>2))return r.r+i.r;pK(i,r,s=e[2]),r=new sI(r),i=new sI(i),s=new sI(s),r.next=s.previous=i,i.next=r.previous=s,s.next=i.previous=r;t:for(f=3;f<n;++f){pK(r._,i._,s=e[f]),s=new sI(s),p=i.next,x=r.previous,E=i._.r,T=r._.r;do if(E<=T){if(dK(p._,s._)){i=p,r.next=i,i.previous=r,--f;continue t}E+=p._.r,p=p.next}else{if(dK(x._,s._)){r=x,r.next=i,i.previous=r,--f;continue t}T+=x._.r,x=x.previous}while(p!==x.next);for(s.previous=r,s.next=i,r.next=i.previous=i=s,o=AK(r);(s=s.next)!==i;)(c=AK(s))<o&&(r=s,o=c);i=r.next}for(r=[i._],s=i;(s=s.next)!==i;)r.push(s._);for(s=gO(r,t),f=0;f<n;++f)r=e[f],r.x-=s.x,r.y-=s.y;return s.r}function mK(e){return _O(e,N2()),e}function Dvt(e){return Math.sqrt(e.value)}function yK(){var e=null,t=1,r=1,i=Qd;function s(n){let o=N2();return n.x=t/2,n.y=r/2,e?n.eachBefore(gK(e)).eachAfter(yO(i,.5,o)).eachBefore(_K(1)):n.eachBefore(gK(Dvt)).eachAfter(yO(Qd,1,o)).eachAfter(yO(i,n.r/Math.min(t,r),o)).eachBefore(_K(Math.min(t,r)/(2*n.r))),n}return s.radius=function(n){return arguments.length?(e=O2(n),s):e},s.size=function(n){return arguments.length?(t=+n[0],r=+n[1],s):[t,r]},s.padding=function(n){return arguments.length?(i=typeof n=="function"?n:KA(+n),s):i},s}function gK(e){return function(t){t.children||(t.r=Math.max(0,+e(t)||0))}}function yO(e,t,r){return function(i){if(s=i.children){var s,n,o=s.length,c=e(i)*t||0,f;if(c)for(n=0;n<o;++n)s[n].r+=c;if(f=_O(s,r),c)for(n=0;n<o;++n)s[n].r-=c;i.r=f+c}}}function _K(e){return function(t){var r=t.parent;t.r*=e,r&&(t.x=r.x+e*t.x,t.y=r.y+e*t.y)}}function oI(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)}function pp(e,t,r,i,s){for(var n=e.children,o,c=-1,f=n.length,p=e.value&&(i-t)/e.value;++c<f;)o=n[c],o.y0=r,o.y1=s,o.x0=t,o.x1=t+=o.value*p}function xK(){var e=1,t=1,r=0,i=!1;function s(o){var c=o.height+1;return o.x0=o.y0=r,o.x1=e,o.y1=t/c,o.eachBefore(n(t,c)),i&&o.eachBefore(oI),o}function n(o,c){return function(f){f.children&&pp(f,f.x0,o*(f.depth+1)/c,f.x1,o*(f.depth+2)/c);var p=f.x0,x=f.y0,E=f.x1-r,T=f.y1-r;E<p&&(p=E=(p+E)/2),T<x&&(x=T=(x+T)/2),f.x0=p,f.y0=x,f.x1=E,f.y1=T}}return s.round=function(o){return arguments.length?(i=!!o,s):i},s.size=function(o){return arguments.length?(e=+o[0],t=+o[1],s):[e,t]},s.padding=function(o){return arguments.length?(r=+o,s):r},s}var Bvt={depth:-1},bK={},xO={};function Ovt(e){return e.id}function Nvt(e){return e.parentId}function wK(){var e=Ovt,t=Nvt,r;function i(s){var n=Array.from(s),o=e,c=t,f,p,x,E,T,D,N,z,U=new Map;if(r!=null){let H=n.map((Y,st)=>Fvt(r(Y,st,s))),G=H.map(vK),Z=new Set(H).add("");for(let Y of G)Z.has(Y)||(Z.add(Y),H.push(Y),G.push(vK(Y)),n.push(xO));o=(Y,st)=>H[st],c=(Y,st)=>G[st]}for(x=0,f=n.length;x<f;++x)p=n[x],D=n[x]=new fp(p),(N=o(p,x,s))!=null&&(N+="")&&(z=D.id=N,U.set(z,U.has(z)?bK:D)),(N=c(p,x,s))!=null&&(N+="")&&(D.parent=N);for(x=0;x<f;++x)if(D=n[x],N=D.parent){if(T=U.get(N),!T)throw new Error("missing: "+N);if(T===bK)throw new Error("ambiguous: "+N);T.children?T.children.push(D):T.children=[D],D.parent=T}else{if(E)throw new Error("multiple roots");E=D}if(!E)throw new Error("no root");if(r!=null){for(;E.data===xO&&E.children.length===1;)E=E.children[0],--f;for(let H=n.length-1;H>=0&&(D=n[H],D.data===xO);--H)D.data=null}if(E.parent=Bvt,E.eachBefore(function(H){H.depth=H.parent.depth+1,--f}).eachBefore(dO),E.parent=null,f>0)throw new Error("cycle");return E}return i.id=function(s){return arguments.length?(e=O2(s),i):e},i.parentId=function(s){return arguments.length?(t=O2(s),i):t},i.path=function(s){return arguments.length?(r=O2(s),i):r},i}function Fvt(e){e=`${e}`;let t=e.length;return bO(e,t-1)&&!bO(e,t-2)&&(e=e.slice(0,-1)),e[0]==="/"?e:`/${e}`}function vK(e){let t=e.length;if(t<2)return"";for(;--t>1&&!bO(e,t););return e.slice(0,t)}function bO(e,t){if(e[t]==="/"){let r=0;for(;t>0&&e[--t]==="\\";)++r;if(!(r&1))return!0}return!1}function Lvt(e,t){return e.parent===t.parent?1:2}function vO(e){var t=e.children;return t?t[0]:e.t}function wO(e){var t=e.children;return t?t[t.length-1]:e.t}function zvt(e,t,r){var i=r/(t.i-e.i);t.c-=i,t.s+=r,e.c+=i,t.z+=r,t.m+=r}function Uvt(e){for(var t=0,r=0,i=e.children,s=i.length,n;--s>=0;)n=i[s],n.z+=t,n.m+=t,t+=n.s+(r+=n.c)}function Vvt(e,t,r){return e.a.parent===t.parent?e.a:r}function aI(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}aI.prototype=Object.create(fp.prototype);function jvt(e){for(var t=new aI(e,0),r,i=[t],s,n,o,c;r=i.pop();)if(n=r._.children)for(r.children=new Array(c=n.length),o=c-1;o>=0;--o)i.push(s=r.children[o]=new aI(n[o],o)),s.parent=r;return(t.parent=new aI(null,0)).children=[t],t}function TK(){var e=Lvt,t=1,r=1,i=null;function s(p){var x=jvt(p);if(x.eachAfter(n),x.parent.m=-x.z,x.eachBefore(o),i)p.eachBefore(f);else{var E=p,T=p,D=p;p.eachBefore(function(G){G.x<E.x&&(E=G),G.x>T.x&&(T=G),G.depth>D.depth&&(D=G)});var N=E===T?1:e(E,T)/2,z=N-E.x,U=t/(T.x+N+z),H=r/(D.depth||1);p.eachBefore(function(G){G.x=(G.x+z)*U,G.y=G.depth*H})}return p}function n(p){var x=p.children,E=p.parent.children,T=p.i?E[p.i-1]:null;if(x){Uvt(p);var D=(x[0].z+x[x.length-1].z)/2;T?(p.z=T.z+e(p._,T._),p.m=p.z-D):p.z=D}else T&&(p.z=T.z+e(p._,T._));p.parent.A=c(p,T,p.parent.A||E[0])}function o(p){p._.x=p.z+p.parent.m,p.m+=p.parent.m}function c(p,x,E){if(x){for(var T=p,D=p,N=x,z=T.parent.children[0],U=T.m,H=D.m,G=N.m,Z=z.m,Y;N=wO(N),T=vO(T),N&&T;)z=vO(z),D=wO(D),D.a=p,Y=N.z+G-T.z-U+e(N._,T._),Y>0&&(zvt(Vvt(N,p,E),p,Y),U+=Y,H+=Y),G+=N.m,U+=T.m,Z+=z.m,H+=D.m;N&&!wO(D)&&(D.t=N,D.m+=G-H),T&&!vO(z)&&(z.t=T,z.m+=U-Z,E=p)}return E}function f(p){p.x*=t,p.y=p.depth*r}return s.separation=function(p){return arguments.length?(e=p,s):e},s.size=function(p){return arguments.length?(i=!1,t=+p[0],r=+p[1],s):i?null:[t,r]},s.nodeSize=function(p){return arguments.length?(i=!0,t=+p[0],r=+p[1],s):i?[t,r]:null},s}function JA(e,t,r,i,s){for(var n=e.children,o,c=-1,f=n.length,p=e.value&&(s-r)/e.value;++c<f;)o=n[c],o.x0=t,o.x1=i,o.y0=r,o.y1=r+=o.value*p}var TO=(1+Math.sqrt(5))/2;function SO(e,t,r,i,s,n){for(var o=[],c=t.children,f,p,x=0,E=0,T=c.length,D,N,z=t.value,U,H,G,Z,Y,st,at;x<T;){D=s-r,N=n-i;do U=c[E++].value;while(!U&&E<T);for(H=G=U,st=Math.max(N/D,D/N)/(z*e),at=U*U*st,Y=Math.max(G/at,at/H);E<T;++E){if(U+=p=c[E].value,p<H&&(H=p),p>G&&(G=p),at=U*U*st,Z=Math.max(G/at,at/H),Z>Y){U-=p;break}Y=Z}o.push(f={value:U,dice:D<N,children:c.slice(x,E)}),f.dice?pp(f,r,i,s,z?i+=N*U/z:n):JA(f,r,i,z?r+=D*U/z:s,n),z-=U,x=E}return o}var lI=function e(t){function r(i,s,n,o,c){SO(t,i,s,n,o,c)}return r.ratio=function(i){return e((i=+i)>1?i:1)},r}(TO);function SK(){var e=lI,t=!1,r=1,i=1,s=[0],n=Qd,o=Qd,c=Qd,f=Qd,p=Qd;function x(T){return T.x0=T.y0=0,T.x1=r,T.y1=i,T.eachBefore(E),s=[0],t&&T.eachBefore(oI),T}function E(T){var D=s[T.depth],N=T.x0+D,z=T.y0+D,U=T.x1-D,H=T.y1-D;U<N&&(N=U=(N+U)/2),H<z&&(z=H=(z+H)/2),T.x0=N,T.y0=z,T.x1=U,T.y1=H,T.children&&(D=s[T.depth+1]=n(T)/2,N+=p(T)-D,z+=o(T)-D,U-=c(T)-D,H-=f(T)-D,U<N&&(N=U=(N+U)/2),H<z&&(z=H=(z+H)/2),e(T,N,z,U,H))}return x.round=function(T){return arguments.length?(t=!!T,x):t},x.size=function(T){return arguments.length?(r=+T[0],i=+T[1],x):[r,i]},x.tile=function(T){return arguments.length?(e=AO(T),x):e},x.padding=function(T){return arguments.length?x.paddingInner(T).paddingOuter(T):x.paddingInner()},x.paddingInner=function(T){return arguments.length?(n=typeof T=="function"?T:KA(+T),x):n},x.paddingOuter=function(T){return arguments.length?x.paddingTop(T).paddingRight(T).paddingBottom(T).paddingLeft(T):x.paddingTop()},x.paddingTop=function(T){return arguments.length?(o=typeof T=="function"?T:KA(+T),x):o},x.paddingRight=function(T){return arguments.length?(c=typeof T=="function"?T:KA(+T),x):c},x.paddingBottom=function(T){return arguments.length?(f=typeof T=="function"?T:KA(+T),x):f},x.paddingLeft=function(T){return arguments.length?(p=typeof T=="function"?T:KA(+T),x):p},x}function EK(e,t,r,i,s){var n=e.children,o,c=n.length,f,p=new Array(c+1);for(p[0]=f=o=0;o<c;++o)p[o+1]=f+=n[o].value;x(0,c,e.value,t,r,i,s);function x(E,T,D,N,z,U,H){if(E>=T-1){var G=n[E];G.x0=N,G.y0=z,G.x1=U,G.y1=H;return}for(var Z=p[E],Y=D/2+Z,st=E+1,at=T-1;st<at;){var Dt=st+at>>>1;p[Dt]<Y?st=Dt+1:at=Dt}Y-p[st-1]<p[st]-Y&&E+1<st&&--st;var Tt=p[st]-Z,kt=D-Tt;if(U-N>H-z){var Et=D?(N*kt+U*Tt)/D:U;x(E,st,Tt,N,z,Et,H),x(st,T,kt,Et,z,U,H)}else{var Mt=D?(z*kt+H*Tt)/D:H;x(E,st,Tt,N,z,U,Mt),x(st,T,kt,N,Mt,U,H)}}}function IK(e,t,r,i,s){(e.depth&1?JA:pp)(e,t,r,i,s)}var MK=function e(t){function r(i,s,n,o,c){if((f=i._squarify)&&f.ratio===t)for(var f,p,x,E,T=-1,D,N=f.length,z=i.value;++T<N;){for(p=f[T],x=p.children,E=p.value=0,D=x.length;E<D;++E)p.value+=x[E].value;p.dice?pp(p,s,n,o,z?n+=(c-n)*p.value/z:c):JA(p,s,n,z?s+=(o-s)*p.value/z:o,c),z-=p.value}else i._squarify=f=SO(t,i,s,n,o,c),f.ratio=t}return r.ratio=function(i){return e((i=+i)>1?i:1)},r}(TO);function CK(e){for(var t=-1,r=e.length,i,s=e[r-1],n=0;++t<r;)i=s,s=e[t],n+=i[1]*s[0]-i[0]*s[1];return n/2}function PK(e){for(var t=-1,r=e.length,i=0,s=0,n,o=e[r-1],c,f=0;++t<r;)n=o,o=e[t],f+=c=n[0]*o[1]-o[0]*n[1],i+=(n[0]+o[0])*c,s+=(n[1]+o[1])*c;return f*=3,[i/f,s/f]}function RK(e,t,r){return(t[0]-e[0])*(r[1]-e[1])-(t[1]-e[1])*(r[0]-e[0])}function $vt(e,t){return e[0]-t[0]||e[1]-t[1]}function kK(e){let t=e.length,r=[0,1],i=2,s;for(s=2;s<t;++s){for(;i>1&&RK(e[r[i-2]],e[r[i-1]],e[s])<=0;)--i;r[i++]=s}return r.slice(0,i)}function DK(e){if((r=e.length)<3)return null;var t,r,i=new Array(r),s=new Array(r);for(t=0;t<r;++t)i[t]=[+e[t][0],+e[t][1],t];for(i.sort($vt),t=0;t<r;++t)s[t]=[i[t][0],-i[t][1]];var n=kK(i),o=kK(s),c=o[0]===n[0],f=o[o.length-1]===n[n.length-1],p=[];for(t=n.length-1;t>=0;--t)p.push(e[i[n[t]][2]]);for(t=+c;t<o.length-f;++t)p.push(e[i[o[t]][2]]);return p}function BK(e,t){for(var r=e.length,i=e[r-1],s=t[0],n=t[1],o=i[0],c=i[1],f,p,x=!1,E=0;E<r;++E)i=e[E],f=i[0],p=i[1],p>n!=c>n&&s<(o-f)*(n-p)/(c-p)+f&&(x=!x),o=f,c=p;return x}function OK(e){for(var t=-1,r=e.length,i=e[r-1],s,n,o=i[0],c=i[1],f=0;++t<r;)s=o,n=c,i=e[t],o=i[0],c=i[1],s-=o,n-=c,f+=Math.hypot(s,n);return f}var En=Math.random;var NK=function e(t){function r(i,s){return i=i==null?0:+i,s=s==null?1:+s,arguments.length===1?(s=i,i=0):s-=i,function(){return t()*s+i}}return r.source=e,r}(En);var FK=function e(t){function r(i,s){return arguments.length<2&&(s=i,i=0),i=Math.floor(i),s=Math.floor(s)-i,function(){return Math.floor(t()*s+i)}}return r.source=e,r}(En);var F2=function e(t){function r(i,s){var n,o;return i=i==null?0:+i,s=s==null?1:+s,function(){var c;if(n!=null)c=n,n=null;else do n=t()*2-1,c=t()*2-1,o=n*n+c*c;while(!o||o>1);return i+s*c*Math.sqrt(-2*Math.log(o)/o)}}return r.source=e,r}(En);var LK=function e(t){var r=F2.source(t);function i(){var s=r.apply(this,arguments);return function(){return Math.exp(s())}}return i.source=e,i}(En);var cI=function e(t){function r(i){return(i=+i)<=0?()=>0:function(){for(var s=0,n=i;n>1;--n)s+=t();return s+n*t()}}return r.source=e,r}(En);var zK=function e(t){var r=cI.source(t);function i(s){if((s=+s)==0)return t;var n=r(s);return function(){return n()/s}}return i.source=e,i}(En);var UK=function e(t){function r(i){return function(){return-Math.log1p(-t())/i}}return r.source=e,r}(En);var VK=function e(t){function r(i){if((i=+i)<0)throw new RangeError("invalid alpha");return i=1/-i,function(){return Math.pow(1-t(),i)}}return r.source=e,r}(En);var jK=function e(t){function r(i){if((i=+i)<0||i>1)throw new RangeError("invalid p");return function(){return Math.floor(t()+i)}}return r.source=e,r}(En);var uI=function e(t){function r(i){if((i=+i)<0||i>1)throw new RangeError("invalid p");return i===0?()=>1/0:i===1?()=>1:(i=Math.log1p(-i),function(){return 1+Math.floor(Math.log1p(-t())/i)})}return r.source=e,r}(En);var L2=function e(t){var r=F2.source(t)();function i(s,n){if((s=+s)<0)throw new RangeError("invalid k");if(s===0)return()=>0;if(n=n==null?1:+n,s===1)return()=>-Math.log1p(-t())*n;var o=(s<1?s+1:s)-1/3,c=1/(3*Math.sqrt(o)),f=s<1?()=>Math.pow(t(),1/s):()=>1;return function(){do{do var p=r(),x=1+c*p;while(x<=0);x*=x*x;var E=1-t()}while(E>=1-.0331*p*p*p*p&&Math.log(E)>=.5*p*p+o*(1-x+Math.log(x)));return o*x*f()*n}}return i.source=e,i}(En);var hI=function e(t){var r=L2.source(t);function i(s,n){var o=r(s),c=r(n);return function(){var f=o();return f===0?0:f/(f+c())}}return i.source=e,i}(En);var fI=function e(t){var r=uI.source(t),i=hI.source(t);function s(n,o){return n=+n,(o=+o)>=1?()=>n:o<=0?()=>0:function(){for(var c=0,f=n,p=o;f*p>16&&f*(1-p)>16;){var x=Math.floor((f+1)*p),E=i(x,f-x+1)();E<=p?(c+=x,f-=x,p=(p-E)/(1-E)):(f=x-1,p/=E)}for(var T=p<.5,D=T?p:1-p,N=r(D),z=N(),U=0;z<=f;++U)z+=N();return c+(T?U:f-U)}}return s.source=e,s}(En);var $K=function e(t){function r(i,s,n){var o;return(i=+i)==0?o=c=>-Math.log(c):(i=1/i,o=c=>Math.pow(c,i)),s=s==null?0:+s,n=n==null?1:+n,function(){return s+n*o(-Math.log1p(-t()))}}return r.source=e,r}(En);var HK=function e(t){function r(i,s){return i=i==null?0:+i,s=s==null?1:+s,function(){return i+s*Math.tan(Math.PI*t())}}return r.source=e,r}(En);var WK=function e(t){function r(i,s){return i=i==null?0:+i,s=s==null?1:+s,function(){var n=t();return i+s*Math.log(n/(1-n))}}return r.source=e,r}(En);var qK=function e(t){var r=L2.source(t),i=fI.source(t);function s(n){return function(){for(var o=0,c=n;c>16;){var f=Math.floor(.875*c),p=r(f)();if(p>c)return o+i(f-1,c/p)();o+=f,c-=p}for(var x=-Math.log1p(-t()),E=0;x<=c;++E)x-=Math.log1p(-t());return o+E}}return s.source=e,s}(En);var YK=23283064365386963e-26;function EO(e=Math.random()){let t=(0<=e&&e<1?e/YK:Math.abs(e))|0;return()=>(t=1664525*t+1013904223|0,YK*(t>>>0))}function Us(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function qu(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}var pI=Symbol("implicit");function z2(){var e=new Hh,t=[],r=[],i=pI;function s(n){let o=e.get(n);if(o===void 0){if(i!==pI)return i;e.set(n,o=t.push(n)-1)}return r[o%r.length]}return s.domain=function(n){if(!arguments.length)return t.slice();t=[],e=new Hh;for(let o of n)e.has(o)||e.set(o,t.push(o)-1);return s},s.range=function(n){return arguments.length?(r=Array.from(n),s):r.slice()},s.unknown=function(n){return arguments.length?(i=n,s):i},s.copy=function(){return z2(t,r).unknown(i)},Us.apply(s,arguments),s}function z3(){var e=z2().unknown(void 0),t=e.domain,r=e.range,i=0,s=1,n,o,c=!1,f=0,p=0,x=.5;delete e.unknown;function E(){var T=t().length,D=s<i,N=D?s:i,z=D?i:s;n=(z-N)/Math.max(1,T-f+p*2),c&&(n=Math.floor(n)),N+=(z-N-n*(T-f))*x,o=n*(1-f),c&&(N=Math.round(N),o=Math.round(o));var U=Vu(T).map(function(H){return N+n*H});return r(D?U.reverse():U)}return e.domain=function(T){return arguments.length?(t(T),E()):t()},e.range=function(T){return arguments.length?([i,s]=T,i=+i,s=+s,E()):[i,s]},e.rangeRound=function(T){return[i,s]=T,i=+i,s=+s,c=!0,E()},e.bandwidth=function(){return o},e.step=function(){return n},e.round=function(T){return arguments.length?(c=!!T,E()):c},e.padding=function(T){return arguments.length?(f=Math.min(1,p=+T),E()):f},e.paddingInner=function(T){return arguments.length?(f=Math.min(1,T),E()):f},e.paddingOuter=function(T){return arguments.length?(p=+T,E()):p},e.align=function(T){return arguments.length?(x=Math.max(0,Math.min(1,T)),E()):x},e.copy=function(){return z3(t(),[i,s]).round(c).paddingInner(f).paddingOuter(p).align(x)},Us.apply(E(),arguments)}function XK(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return XK(t())},e}function ZK(){return XK(z3.apply(null,arguments).paddingInner(1))}function IO(e){return function(){return e}}function tm(e){return+e}var GK=[0,1];function Xo(e){return e}function MO(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:IO(isNaN(t)?NaN:.5)}function Hvt(e,t){var r;return e>t&&(r=e,e=t,t=r),function(i){return Math.max(e,Math.min(t,i))}}function Wvt(e,t,r){var i=e[0],s=e[1],n=t[0],o=t[1];return s<i?(i=MO(s,i),n=r(o,n)):(i=MO(i,s),n=r(n,o)),function(c){return n(i(c))}}function qvt(e,t,r){var i=Math.min(e.length,t.length)-1,s=new Array(i),n=new Array(i),o=-1;for(e[i]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<i;)s[o]=MO(e[o],e[o+1]),n[o]=r(t[o],t[o+1]);return function(c){var f=dc(e,c,1,i)-1;return n[f](s[f](c))}}function dp(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function B1(){var e=GK,t=GK,r=fl,i,s,n,o=Xo,c,f,p;function x(){var T=Math.min(e.length,t.length);return o!==Xo&&(o=Hvt(e[0],e[T-1])),c=T>2?qvt:Wvt,f=p=null,E}function E(T){return T==null||isNaN(T=+T)?n:(f||(f=c(e.map(i),t,r)))(i(o(T)))}return E.invert=function(T){return o(s((p||(p=c(t,e.map(i),da)))(T)))},E.domain=function(T){return arguments.length?(e=Array.from(T,tm),x()):e.slice()},E.range=function(T){return arguments.length?(t=Array.from(T),x()):t.slice()},E.rangeRound=function(T){return t=Array.from(T),r=jA,x()},E.clamp=function(T){return arguments.length?(o=T?!0:Xo,x()):o!==Xo},E.interpolate=function(T){return arguments.length?(r=T,x()):r},E.unknown=function(T){return arguments.length?(n=T,E):n},function(T,D){return i=T,s=D,x()}}function O1(){return B1()(Xo,Xo)}function U3(e,t,r,i){var s=Kg(e,t,r),n;switch(i=Gh(i??",f"),i.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return i.precision==null&&!isNaN(n=u6(s,o))&&(i.precision=n),A3(i,o)}case"":case"e":case"g":case"p":case"r":{i.precision==null&&!isNaN(n=h6(s,Math.max(Math.abs(e),Math.abs(t))))&&(i.precision=n-(i.type==="e"));break}case"f":case"%":{i.precision==null&&!isNaN(n=c6(s))&&(i.precision=n-(i.type==="%")*2);break}}return w1(i)}function jl(e){var t=e.domain;return e.ticks=function(r){var i=t();return mc(i[0],i[i.length-1],r??10)},e.tickFormat=function(r,i){var s=t();return U3(s[0],s[s.length-1],r??10,i)},e.nice=function(r){r==null&&(r=10);var i=t(),s=0,n=i.length-1,o=i[s],c=i[n],f,p,x=10;for(c<o&&(p=o,o=c,c=p,p=s,s=n,n=p);x-- >0;){if(p=Wh(o,c,r),p===f)return i[s]=o,i[n]=c,t(i);if(p>0)o=Math.floor(o/p)*p,c=Math.ceil(c/p)*p;else if(p<0)o=Math.ceil(o*p)/p,c=Math.floor(c*p)/p;else break;f=p}return e},e}function dI(){var e=O1();return e.copy=function(){return dp(e,dI())},Us.apply(e,arguments),jl(e)}function AI(e){var t;function r(i){return i==null||isNaN(i=+i)?t:i}return r.invert=r,r.domain=r.range=function(i){return arguments.length?(e=Array.from(i,tm),r):e.slice()},r.unknown=function(i){return arguments.length?(t=i,r):t},r.copy=function(){return AI(e).unknown(t)},e=arguments.length?Array.from(e,tm):[0,1],jl(r)}function V3(e,t){e=e.slice();var r=0,i=e.length-1,s=e[r],n=e[i],o;return n<s&&(o=r,r=i,i=o,o=s,s=n,n=o),e[r]=t.floor(s),e[i]=t.ceil(n),e}function QK(e){return Math.log(e)}function KK(e){return Math.exp(e)}function Yvt(e){return-Math.log(-e)}function Xvt(e){return-Math.exp(-e)}function Zvt(e){return isFinite(e)?+("1e"+e):e<0?0:e}function Gvt(e){return e===10?Zvt:e===Math.E?Math.exp:t=>Math.pow(e,t)}function Qvt(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function JK(e){return(t,r)=>-e(-t,r)}function j3(e){let t=e(QK,KK),r=t.domain,i=10,s,n;function o(){return s=Qvt(i),n=Gvt(i),r()[0]<0?(s=JK(s),n=JK(n),e(Yvt,Xvt)):e(QK,KK),t}return t.base=function(c){return arguments.length?(i=+c,o()):i},t.domain=function(c){return arguments.length?(r(c),o()):r()},t.ticks=c=>{let f=r(),p=f[0],x=f[f.length-1],E=x<p;E&&([p,x]=[x,p]);let T=s(p),D=s(x),N,z,U=c==null?10:+c,H=[];if(!(i%1)&&D-T<U){if(T=Math.floor(T),D=Math.ceil(D),p>0){for(;T<=D;++T)for(N=1;N<i;++N)if(z=T<0?N/n(-T):N*n(T),!(z<p)){if(z>x)break;H.push(z)}}else for(;T<=D;++T)for(N=i-1;N>=1;--N)if(z=T>0?N/n(-T):N*n(T),!(z<p)){if(z>x)break;H.push(z)}H.length*2<U&&(H=mc(p,x,U))}else H=mc(T,D,Math.min(D-T,U)).map(n);return E?H.reverse():H},t.tickFormat=(c,f)=>{if(c==null&&(c=10),f==null&&(f=i===10?"s":","),typeof f!="function"&&(!(i%1)&&(f=Gh(f)).precision==null&&(f.trim=!0),f=w1(f)),c===1/0)return f;let p=Math.max(1,i*c/t.ticks().length);return x=>{let E=x/n(Math.round(s(x)));return E*i<i-.5&&(E*=i),E<=p?f(x):""}},t.nice=()=>r(V3(r(),{floor:c=>n(Math.floor(s(c))),ceil:c=>n(Math.ceil(s(c)))})),t}function mI(){let e=j3(B1()).domain([1,10]);return e.copy=()=>dp(e,mI()).base(e.base()),Us.apply(e,arguments),e}function tJ(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function eJ(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function $3(e){var t=1,r=e(tJ(t),eJ(t));return r.constant=function(i){return arguments.length?e(tJ(t=+i),eJ(t)):t},jl(r)}function gI(){var e=$3(B1());return e.copy=function(){return dp(e,gI()).constant(e.constant())},Us.apply(e,arguments)}function rJ(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function Kvt(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function Jvt(e){return e<0?-e*e:e*e}function H3(e){var t=e(Xo,Xo),r=1;function i(){return r===1?e(Xo,Xo):r===.5?e(Kvt,Jvt):e(rJ(r),rJ(1/r))}return t.exponent=function(s){return arguments.length?(r=+s,i()):r},jl(t)}function W3(){var e=H3(B1());return e.copy=function(){return dp(e,W3()).exponent(e.exponent())},Us.apply(e,arguments),e}function iJ(){return W3.apply(null,arguments).exponent(.5)}function nJ(e){return Math.sign(e)*e*e}function twt(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function _I(){var e=O1(),t=[0,1],r=!1,i;function s(n){var o=twt(e(n));return isNaN(o)?i:r?Math.round(o):o}return s.invert=function(n){return e.invert(nJ(n))},s.domain=function(n){return arguments.length?(e.domain(n),s):e.domain()},s.range=function(n){return arguments.length?(e.range((t=Array.from(n,tm)).map(nJ)),s):t.slice()},s.rangeRound=function(n){return s.range(n).round(!0)},s.round=function(n){return arguments.length?(r=!!n,s):r},s.clamp=function(n){return arguments.length?(e.clamp(n),s):e.clamp()},s.unknown=function(n){return arguments.length?(i=n,s):i},s.copy=function(){return _I(e.domain(),t).round(r).clamp(e.clamp()).unknown(i)},Us.apply(s,arguments),jl(s)}function yI(){var e=[],t=[],r=[],i;function s(){var o=0,c=Math.max(1,t.length);for(r=new Array(c-1);++o<c;)r[o-1]=fE(e,o/c);return n}function n(o){return o==null||isNaN(o=+o)?i:t[dc(r,o)]}return n.invertExtent=function(o){var c=t.indexOf(o);return c<0?[NaN,NaN]:[c>0?r[c-1]:e[0],c<r.length?r[c]:e[e.length-1]]},n.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let c of o)c!=null&&!isNaN(c=+c)&&e.push(c);return e.sort(dn),s()},n.range=function(o){return arguments.length?(t=Array.from(o),s()):t.slice()},n.unknown=function(o){return arguments.length?(i=o,n):i},n.quantiles=function(){return r.slice()},n.copy=function(){return yI().domain(e).range(t).unknown(i)},Us.apply(n,arguments)}function xI(){var e=0,t=1,r=1,i=[.5],s=[0,1],n;function o(f){return f!=null&&f<=f?s[dc(i,f,0,r)]:n}function c(){var f=-1;for(i=new Array(r);++f<r;)i[f]=((f+1)*t-(f-r)*e)/(r+1);return o}return o.domain=function(f){return arguments.length?([e,t]=f,e=+e,t=+t,c()):[e,t]},o.range=function(f){return arguments.length?(r=(s=Array.from(f)).length-1,c()):s.slice()},o.invertExtent=function(f){var p=s.indexOf(f);return p<0?[NaN,NaN]:p<1?[e,i[0]]:p>=r?[i[r-1],t]:[i[p-1],i[p]]},o.unknown=function(f){return arguments.length&&(n=f),o},o.thresholds=function(){return i.slice()},o.copy=function(){return xI().domain([e,t]).range(s).unknown(n)},Us.apply(jl(o),arguments)}function bI(){var e=[.5],t=[0,1],r,i=1;function s(n){return n!=null&&n<=n?t[dc(e,n,0,i)]:r}return s.domain=function(n){return arguments.length?(e=Array.from(n),i=Math.min(e.length,t.length-1),s):e.slice()},s.range=function(n){return arguments.length?(t=Array.from(n),i=Math.min(e.length,t.length-1),s):t.slice()},s.invertExtent=function(n){var o=t.indexOf(n);return[e[o-1],e[o]]},s.unknown=function(n){return arguments.length?(r=n,s):r},s.copy=function(){return bI().domain(e).range(t).unknown(r)},Us.apply(s,arguments)}var CO=new Date,PO=new Date;function Jn(e,t,r,i){function s(n){return e(n=arguments.length===0?new Date:new Date(+n)),n}return s.floor=n=>(e(n=new Date(+n)),n),s.ceil=n=>(e(n=new Date(n-1)),t(n,1),e(n),n),s.round=n=>{let o=s(n),c=s.ceil(n);return n-o<c-n?o:c},s.offset=(n,o)=>(t(n=new Date(+n),o==null?1:Math.floor(o)),n),s.range=(n,o,c)=>{let f=[];if(n=s.ceil(n),c=c==null?1:Math.floor(c),!(n<o)||!(c>0))return f;let p;do f.push(p=new Date(+n)),t(n,c),e(n);while(p<n&&n<o);return f},s.filter=n=>Jn(o=>{if(o>=o)for(;e(o),!n(o);)o.setTime(o-1)},(o,c)=>{if(o>=o)if(c<0)for(;++c<=0;)for(;t(o,-1),!n(o););else for(;--c>=0;)for(;t(o,1),!n(o););}),r&&(s.count=(n,o)=>(CO.setTime(+n),PO.setTime(+o),e(CO),e(PO),Math.floor(r(CO,PO))),s.every=n=>(n=Math.floor(n),!isFinite(n)||!(n>0)?null:n>1?s.filter(i?o=>i(o)%n===0:o=>s.count(0,o)%n===0):s)),s}var em=Jn(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);em.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Jn(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):em);var RO=em.range;var Kc=Jn(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*1e3)},(e,t)=>(t-e)/1e3,e=>e.getUTCSeconds()),kO=Kc.range;var F1=Jn(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*1e3)},(e,t)=>{e.setTime(+e+t*6e4)},(e,t)=>(t-e)/6e4,e=>e.getMinutes()),sJ=F1.range,L1=Jn(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*6e4)},(e,t)=>(t-e)/6e4,e=>e.getUTCMinutes()),oJ=L1.range;var U1=Jn(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*1e3-e.getMinutes()*6e4)},(e,t)=>{e.setTime(+e+t*36e5)},(e,t)=>(t-e)/36e5,e=>e.getHours()),aJ=U1.range,V1=Jn(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*36e5)},(e,t)=>(t-e)/36e5,e=>e.getUTCHours()),lJ=V1.range;var mp=Jn(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*6e4)/864e5,e=>e.getDate()-1),cJ=mp.range,rm=Jn(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/864e5,e=>e.getUTCDate()-1),uJ=rm.range,Y3=Jn(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/864e5,e=>Math.floor(e/864e5)),hJ=Y3.range;function j1(e){return Jn(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*6e4)/6048e5)}var gp=j1(0),$1=j1(1),DO=j1(2),BO=j1(3),Kd=j1(4),OO=j1(5),NO=j1(6),FO=gp.range,pJ=$1.range,dJ=DO.range,AJ=BO.range,mJ=Kd.range,gJ=OO.range,_J=NO.range;function H1(e){return Jn(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/6048e5)}var _p=H1(0),W1=H1(1),LO=H1(2),zO=H1(3),Jd=H1(4),UO=H1(5),VO=H1(6),jO=_p.range,yJ=W1.range,xJ=LO.range,bJ=zO.range,vJ=Jd.range,wJ=UO.range,TJ=VO.range;var q1=Jn(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth()),SJ=q1.range,Y1=Jn(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth()),EJ=Y1.range;var yc=Jn(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());yc.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Jn(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});var IJ=yc.range,xc=Jn(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());xc.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Jn(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});var MJ=xc.range;function PJ(e,t,r,i,s,n){let o=[[Kc,1,1e3],[Kc,5,5*1e3],[Kc,15,15*1e3],[Kc,30,30*1e3],[n,1,6e4],[n,5,5*6e4],[n,15,15*6e4],[n,30,30*6e4],[s,1,36e5],[s,3,3*36e5],[s,6,6*36e5],[s,12,12*36e5],[i,1,864e5],[i,2,2*864e5],[r,1,6048e5],[t,1,2592e6],[t,3,3*2592e6],[e,1,31536e6]];function c(p,x,E){let T=x<p;T&&([p,x]=[x,p]);let D=E&&typeof E.range=="function"?E:f(p,x,E),N=D?D.range(p,+x+1):[];return T?N.reverse():N}function f(p,x,E){let T=Math.abs(x-p)/E,D=RA(([,,U])=>U).right(o,T);if(D===o.length)return e.every(Kg(p/31536e6,x/31536e6,E));if(D===0)return em.every(Math.max(Kg(p,x,E),1));let[N,z]=o[T/o[D-1][2]<o[D][2]/T?D-1:D];return N.every(z)}return[c,f]}var[vI,wI]=PJ(xc,Y1,_p,Y3,V1,L1),[TI,SI]=PJ(yc,q1,gp,mp,U1,F1);function $O(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function HO(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function X3(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function Q3(e){var t=e.dateTime,r=e.date,i=e.time,s=e.periods,n=e.days,o=e.shortDays,c=e.months,f=e.shortMonths,p=Z3(s),x=G3(s),E=Z3(n),T=G3(n),D=Z3(o),N=G3(o),z=Z3(c),U=G3(c),H=Z3(f),G=G3(f),Z={a:de,A:Ee,b:Se,B:ze,c:null,d:NJ,e:NJ,f:Twt,g:Bwt,G:Nwt,H:bwt,I:vwt,j:wwt,L:VJ,m:Swt,M:Ewt,p:ke,q:ir,Q:zJ,s:UJ,S:Iwt,u:Mwt,U:Cwt,V:Pwt,w:Rwt,W:kwt,x:null,X:null,y:Dwt,Y:Owt,Z:Fwt,"%":LJ},Y={a:Ti,A:_i,b:ci,B:Gr,c:null,d:FJ,e:FJ,f:Vwt,g:Qwt,G:Jwt,H:Lwt,I:zwt,j:Uwt,L:$J,m:jwt,M:$wt,p:Fr,q:Dr,Q:zJ,s:UJ,S:Hwt,u:Wwt,U:qwt,V:Ywt,w:Xwt,W:Zwt,x:null,X:null,y:Gwt,Y:Kwt,Z:t3t,"%":LJ},st={a:Et,A:Mt,b:oe,B:Xt,c:xt,d:BJ,e:BJ,f:gwt,g:DJ,G:kJ,H:OJ,I:OJ,j:pwt,L:mwt,m:fwt,M:dwt,p:kt,q:hwt,Q:ywt,s:xwt,S:Awt,u:owt,U:awt,V:lwt,w:swt,W:cwt,x:jt,X:Wt,y:DJ,Y:kJ,Z:uwt,"%":_wt};Z.x=at(r,Z),Z.X=at(i,Z),Z.c=at(t,Z),Y.x=at(r,Y),Y.X=at(i,Y),Y.c=at(t,Y);function at(Le,Tr){return function(jr){var Ie=[],Ji=-1,yi=0,tn=Le.length,hn,Sr,ae;for(jr instanceof Date||(jr=new Date(+jr));++Ji<tn;)Le.charCodeAt(Ji)===37&&(Ie.push(Le.slice(yi,Ji)),(Sr=RJ[hn=Le.charAt(++Ji)])!=null?hn=Le.charAt(++Ji):Sr=hn==="e"?" ":"0",(ae=Tr[hn])&&(hn=ae(jr,Sr)),Ie.push(hn),yi=Ji+1);return Ie.push(Le.slice(yi,Ji)),Ie.join("")}}function Dt(Le,Tr){return function(jr){var Ie=X3(1900,void 0,1),Ji=Tt(Ie,Le,jr+="",0),yi,tn;if(Ji!=jr.length)return null;if("Q"in Ie)return new Date(Ie.Q);if("s"in Ie)return new Date(Ie.s*1e3+("L"in Ie?Ie.L:0));if(Tr&&!("Z"in Ie)&&(Ie.Z=0),"p"in Ie&&(Ie.H=Ie.H%12+Ie.p*12),Ie.m===void 0&&(Ie.m="q"in Ie?Ie.q:0),"V"in Ie){if(Ie.V<1||Ie.V>53)return null;"w"in Ie||(Ie.w=1),"Z"in Ie?(yi=HO(X3(Ie.y,0,1)),tn=yi.getUTCDay(),yi=tn>4||tn===0?W1.ceil(yi):W1(yi),yi=rm.offset(yi,(Ie.V-1)*7),Ie.y=yi.getUTCFullYear(),Ie.m=yi.getUTCMonth(),Ie.d=yi.getUTCDate()+(Ie.w+6)%7):(yi=$O(X3(Ie.y,0,1)),tn=yi.getDay(),yi=tn>4||tn===0?$1.ceil(yi):$1(yi),yi=mp.offset(yi,(Ie.V-1)*7),Ie.y=yi.getFullYear(),Ie.m=yi.getMonth(),Ie.d=yi.getDate()+(Ie.w+6)%7)}else("W"in Ie||"U"in Ie)&&("w"in Ie||(Ie.w="u"in Ie?Ie.u%7:"W"in Ie?1:0),tn="Z"in Ie?HO(X3(Ie.y,0,1)).getUTCDay():$O(X3(Ie.y,0,1)).getDay(),Ie.m=0,Ie.d="W"in Ie?(Ie.w+6)%7+Ie.W*7-(tn+5)%7:Ie.w+Ie.U*7-(tn+6)%7);return"Z"in Ie?(Ie.H+=Ie.Z/100|0,Ie.M+=Ie.Z%100,HO(Ie)):$O(Ie)}}function Tt(Le,Tr,jr,Ie){for(var Ji=0,yi=Tr.length,tn=jr.length,hn,Sr;Ji<yi;){if(Ie>=tn)return-1;if(hn=Tr.charCodeAt(Ji++),hn===37){if(hn=Tr.charAt(Ji++),Sr=st[hn in RJ?Tr.charAt(Ji++):hn],!Sr||(Ie=Sr(Le,jr,Ie))<0)return-1}else if(hn!=jr.charCodeAt(Ie++))return-1}return Ie}function kt(Le,Tr,jr){var Ie=p.exec(Tr.slice(jr));return Ie?(Le.p=x.get(Ie[0].toLowerCase()),jr+Ie[0].length):-1}function Et(Le,Tr,jr){var Ie=D.exec(Tr.slice(jr));return Ie?(Le.w=N.get(Ie[0].toLowerCase()),jr+Ie[0].length):-1}function Mt(Le,Tr,jr){var Ie=E.exec(Tr.slice(jr));return Ie?(Le.w=T.get(Ie[0].toLowerCase()),jr+Ie[0].length):-1}function oe(Le,Tr,jr){var Ie=H.exec(Tr.slice(jr));return Ie?(Le.m=G.get(Ie[0].toLowerCase()),jr+Ie[0].length):-1}function Xt(Le,Tr,jr){var Ie=z.exec(Tr.slice(jr));return Ie?(Le.m=U.get(Ie[0].toLowerCase()),jr+Ie[0].length):-1}function xt(Le,Tr,jr){return Tt(Le,t,Tr,jr)}function jt(Le,Tr,jr){return Tt(Le,r,Tr,jr)}function Wt(Le,Tr,jr){return Tt(Le,i,Tr,jr)}function de(Le){return o[Le.getDay()]}function Ee(Le){return n[Le.getDay()]}function Se(Le){return f[Le.getMonth()]}function ze(Le){return c[Le.getMonth()]}function ke(Le){return s[+(Le.getHours()>=12)]}function ir(Le){return 1+~~(Le.getMonth()/3)}function Ti(Le){return o[Le.getUTCDay()]}function _i(Le){return n[Le.getUTCDay()]}function ci(Le){return f[Le.getUTCMonth()]}function Gr(Le){return c[Le.getUTCMonth()]}function Fr(Le){return s[+(Le.getUTCHours()>=12)]}function Dr(Le){return 1+~~(Le.getUTCMonth()/3)}return{format:function(Le){var Tr=at(Le+="",Z);return Tr.toString=function(){return Le},Tr},parse:function(Le){var Tr=Dt(Le+="",!1);return Tr.toString=function(){return Le},Tr},utcFormat:function(Le){var Tr=at(Le+="",Y);return Tr.toString=function(){return Le},Tr},utcParse:function(Le){var Tr=Dt(Le+="",!0);return Tr.toString=function(){return Le},Tr}}}var RJ={"-":"",_:" ",0:"0"},ga=/^\s*\d+/,rwt=/^%/,iwt=/[\\^$*+?|[\]().{}]/g;function Bn(e,t,r){var i=e<0?"-":"",s=(i?-e:e)+"",n=s.length;return i+(n<r?new Array(r-n+1).join(t)+s:s)}function nwt(e){return e.replace(iwt,"\\$&")}function Z3(e){return new RegExp("^(?:"+e.map(nwt).join("|")+")","i")}function G3(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function swt(e,t,r){var i=ga.exec(t.slice(r,r+1));return i?(e.w=+i[0],r+i[0].length):-1}function owt(e,t,r){var i=ga.exec(t.slice(r,r+1));return i?(e.u=+i[0],r+i[0].length):-1}function awt(e,t,r){var i=ga.exec(t.slice(r,r+2));return i?(e.U=+i[0],r+i[0].length):-1}function lwt(e,t,r){var i=ga.exec(t.slice(r,r+2));return i?(e.V=+i[0],r+i[0].length):-1}function cwt(e,t,r){var i=ga.exec(t.slice(r,r+2));return i?(e.W=+i[0],r+i[0].length):-1}function kJ(e,t,r){var i=ga.exec(t.slice(r,r+4));return i?(e.y=+i[0],r+i[0].length):-1}function DJ(e,t,r){var i=ga.exec(t.slice(r,r+2));return i?(e.y=+i[0]+(+i[0]>68?1900:2e3),r+i[0].length):-1}function uwt(e,t,r){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return i?(e.Z=i[1]?0:-(i[2]+(i[3]||"00")),r+i[0].length):-1}function hwt(e,t,r){var i=ga.exec(t.slice(r,r+1));return i?(e.q=i[0]*3-3,r+i[0].length):-1}function fwt(e,t,r){var i=ga.exec(t.slice(r,r+2));return i?(e.m=i[0]-1,r+i[0].length):-1}function BJ(e,t,r){var i=ga.exec(t.slice(r,r+2));return i?(e.d=+i[0],r+i[0].length):-1}function pwt(e,t,r){var i=ga.exec(t.slice(r,r+3));return i?(e.m=0,e.d=+i[0],r+i[0].length):-1}function OJ(e,t,r){var i=ga.exec(t.slice(r,r+2));return i?(e.H=+i[0],r+i[0].length):-1}function dwt(e,t,r){var i=ga.exec(t.slice(r,r+2));return i?(e.M=+i[0],r+i[0].length):-1}function Awt(e,t,r){var i=ga.exec(t.slice(r,r+2));return i?(e.S=+i[0],r+i[0].length):-1}function mwt(e,t,r){var i=ga.exec(t.slice(r,r+3));return i?(e.L=+i[0],r+i[0].length):-1}function gwt(e,t,r){var i=ga.exec(t.slice(r,r+6));return i?(e.L=Math.floor(i[0]/1e3),r+i[0].length):-1}function _wt(e,t,r){var i=rwt.exec(t.slice(r,r+1));return i?r+i[0].length:-1}function ywt(e,t,r){var i=ga.exec(t.slice(r));return i?(e.Q=+i[0],r+i[0].length):-1}function xwt(e,t,r){var i=ga.exec(t.slice(r));return i?(e.s=+i[0],r+i[0].length):-1}function NJ(e,t){return Bn(e.getDate(),t,2)}function bwt(e,t){return Bn(e.getHours(),t,2)}function vwt(e,t){return Bn(e.getHours()%12||12,t,2)}function wwt(e,t){return Bn(1+mp.count(yc(e),e),t,3)}function VJ(e,t){return Bn(e.getMilliseconds(),t,3)}function Twt(e,t){return VJ(e,t)+"000"}function Swt(e,t){return Bn(e.getMonth()+1,t,2)}function Ewt(e,t){return Bn(e.getMinutes(),t,2)}function Iwt(e,t){return Bn(e.getSeconds(),t,2)}function Mwt(e){var t=e.getDay();return t===0?7:t}function Cwt(e,t){return Bn(gp.count(yc(e)-1,e),t,2)}function jJ(e){var t=e.getDay();return t>=4||t===0?Kd(e):Kd.ceil(e)}function Pwt(e,t){return e=jJ(e),Bn(Kd.count(yc(e),e)+(yc(e).getDay()===4),t,2)}function Rwt(e){return e.getDay()}function kwt(e,t){return Bn($1.count(yc(e)-1,e),t,2)}function Dwt(e,t){return Bn(e.getFullYear()%100,t,2)}function Bwt(e,t){return e=jJ(e),Bn(e.getFullYear()%100,t,2)}function Owt(e,t){return Bn(e.getFullYear()%1e4,t,4)}function Nwt(e,t){var r=e.getDay();return e=r>=4||r===0?Kd(e):Kd.ceil(e),Bn(e.getFullYear()%1e4,t,4)}function Fwt(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Bn(t/60|0,"0",2)+Bn(t%60,"0",2)}function FJ(e,t){return Bn(e.getUTCDate(),t,2)}function Lwt(e,t){return Bn(e.getUTCHours(),t,2)}function zwt(e,t){return Bn(e.getUTCHours()%12||12,t,2)}function Uwt(e,t){return Bn(1+rm.count(xc(e),e),t,3)}function $J(e,t){return Bn(e.getUTCMilliseconds(),t,3)}function Vwt(e,t){return $J(e,t)+"000"}function jwt(e,t){return Bn(e.getUTCMonth()+1,t,2)}function $wt(e,t){return Bn(e.getUTCMinutes(),t,2)}function Hwt(e,t){return Bn(e.getUTCSeconds(),t,2)}function Wwt(e){var t=e.getUTCDay();return t===0?7:t}function qwt(e,t){return Bn(_p.count(xc(e)-1,e),t,2)}function HJ(e){var t=e.getUTCDay();return t>=4||t===0?Jd(e):Jd.ceil(e)}function Ywt(e,t){return e=HJ(e),Bn(Jd.count(xc(e),e)+(xc(e).getUTCDay()===4),t,2)}function Xwt(e){return e.getUTCDay()}function Zwt(e,t){return Bn(W1.count(xc(e)-1,e),t,2)}function Gwt(e,t){return Bn(e.getUTCFullYear()%100,t,2)}function Qwt(e,t){return e=HJ(e),Bn(e.getUTCFullYear()%100,t,2)}function Kwt(e,t){return Bn(e.getUTCFullYear()%1e4,t,4)}function Jwt(e,t){var r=e.getUTCDay();return e=r>=4||r===0?Jd(e):Jd.ceil(e),Bn(e.getUTCFullYear()%1e4,t,4)}function t3t(){return"+0000"}function LJ(){return"%"}function zJ(e){return+e}function UJ(e){return Math.floor(+e/1e3)}var U2,K3,WO,X1,J3;EI({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function EI(e){return U2=Q3(e),K3=U2.format,WO=U2.parse,X1=U2.utcFormat,J3=U2.utcParse,U2}var qO="%Y-%m-%dT%H:%M:%S.%LZ";function e3t(e){return e.toISOString()}var r3t=Date.prototype.toISOString?e3t:X1(qO),WJ=r3t;function i3t(e){var t=new Date(e);return isNaN(t)?null:t}var n3t=+new Date("2000-01-01T00:00:00.000Z")?i3t:J3(qO),qJ=n3t;function s3t(e){return new Date(e)}function o3t(e){return e instanceof Date?+e:+new Date(+e)}function II(e,t,r,i,s,n,o,c,f,p){var x=O1(),E=x.invert,T=x.domain,D=p(".%L"),N=p(":%S"),z=p("%I:%M"),U=p("%I %p"),H=p("%a %d"),G=p("%b %d"),Z=p("%B"),Y=p("%Y");function st(at){return(f(at)<at?D:c(at)<at?N:o(at)<at?z:n(at)<at?U:i(at)<at?s(at)<at?H:G:r(at)<at?Z:Y)(at)}return x.invert=function(at){return new Date(E(at))},x.domain=function(at){return arguments.length?T(Array.from(at,o3t)):T().map(s3t)},x.ticks=function(at){var Dt=T();return e(Dt[0],Dt[Dt.length-1],at??10)},x.tickFormat=function(at,Dt){return Dt==null?st:p(Dt)},x.nice=function(at){var Dt=T();return(!at||typeof at.range!="function")&&(at=t(Dt[0],Dt[Dt.length-1],at??10)),at?T(V3(Dt,at)):x},x.copy=function(){return dp(x,II(e,t,r,i,s,n,o,c,f,p))},x}function YO(){return Us.apply(II(TI,SI,yc,q1,gp,mp,U1,F1,Kc,K3).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function XO(){return Us.apply(II(vI,wI,xc,Y1,_p,rm,V1,L1,Kc,X1).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function MI(){var e=0,t=1,r,i,s,n,o=Xo,c=!1,f;function p(E){return E==null||isNaN(E=+E)?f:o(s===0?.5:(E=(n(E)-r)*s,c?Math.max(0,Math.min(1,E)):E))}p.domain=function(E){return arguments.length?([e,t]=E,r=n(e=+e),i=n(t=+t),s=r===i?0:1/(i-r),p):[e,t]},p.clamp=function(E){return arguments.length?(c=!!E,p):c},p.interpolator=function(E){return arguments.length?(o=E,p):o};function x(E){return function(T){var D,N;return arguments.length?([D,N]=T,o=E(D,N),p):[o(0),o(1)]}}return p.range=x(fl),p.rangeRound=x(jA),p.unknown=function(E){return arguments.length?(f=E,p):f},function(E){return n=E,r=E(e),i=E(t),s=r===i?0:1/(i-r),p}}function t0(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function V2(){var e=jl(MI()(Xo));return e.copy=function(){return t0(e,V2())},qu.apply(e,arguments)}function ZO(){var e=j3(MI()).domain([1,10]);return e.copy=function(){return t0(e,ZO()).base(e.base())},qu.apply(e,arguments)}function GO(){var e=$3(MI());return e.copy=function(){return t0(e,GO()).constant(e.constant())},qu.apply(e,arguments)}function CI(){var e=H3(MI());return e.copy=function(){return t0(e,CI()).exponent(e.exponent())},qu.apply(e,arguments)}function YJ(){return CI.apply(null,arguments).exponent(.5)}function PI(){var e=[],t=Xo;function r(i){if(i!=null&&!isNaN(i=+i))return t((dc(e,i,1)-1)/(e.length-1))}return r.domain=function(i){if(!arguments.length)return e.slice();e=[];for(let s of i)s!=null&&!isNaN(s=+s)&&e.push(s);return e.sort(dn),r},r.interpolator=function(i){return arguments.length?(t=i,r):t},r.range=function(){return e.map((i,s)=>t(s/(e.length-1)))},r.quantiles=function(i){return Array.from({length:i+1},(s,n)=>Jf(e,n/i))},r.copy=function(){return PI(t).domain(e)},qu.apply(r,arguments)}function RI(){var e=0,t=.5,r=1,i=1,s,n,o,c,f,p=Xo,x,E=!1,T;function D(z){return isNaN(z=+z)?T:(z=.5+((z=+x(z))-n)*(i*z<i*n?c:f),p(E?Math.max(0,Math.min(1,z)):z))}D.domain=function(z){return arguments.length?([e,t,r]=z,s=x(e=+e),n=x(t=+t),o=x(r=+r),c=s===n?0:.5/(n-s),f=n===o?0:.5/(o-n),i=n<s?-1:1,D):[e,t,r]},D.clamp=function(z){return arguments.length?(E=!!z,D):E},D.interpolator=function(z){return arguments.length?(p=z,D):p};function N(z){return function(U){var H,G,Z;return arguments.length?([H,G,Z]=U,p=Gw(z,[H,G,Z]),D):[p(0),p(.5),p(1)]}}return D.range=N(fl),D.rangeRound=N(jA),D.unknown=function(z){return arguments.length?(T=z,D):T},function(z){return x=z,s=z(e),n=z(t),o=z(r),c=s===n?0:.5/(n-s),f=n===o?0:.5/(o-n),i=n<s?-1:1,D}}function kI(){var e=jl(RI()(Xo));return e.copy=function(){return t0(e,kI())},qu.apply(e,arguments)}function QO(){var e=j3(RI()).domain([.1,1,10]);return e.copy=function(){return t0(e,QO()).base(e.base())},qu.apply(e,arguments)}function KO(){var e=$3(RI());return e.copy=function(){return t0(e,KO()).constant(e.constant())},qu.apply(e,arguments)}function DI(){var e=H3(RI());return e.copy=function(){return t0(e,DI()).exponent(e.exponent())},qu.apply(e,arguments)}function XJ(){return DI.apply(null,arguments).exponent(.5)}function rr(e){for(var t=e.length/6|0,r=new Array(t),i=0;i<t;)r[i]="#"+e.slice(i*6,++i*6);return r}var ZJ=rr("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf");var GJ=rr("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666");var QJ=rr("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666");var KJ=rr("4269d0efb118ff725c6cc5b03ca951ff8ab7a463f297bbf59c6b4e9498a0");var JJ=rr("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928");var ttt=rr("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2");var ett=rr("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc");var rtt=rr("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999");var itt=rr("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3");var ntt=rr("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f");var stt=rr("4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab");var $r=e=>DE(e[e.length-1]);var JO=new Array(3).concat("d8b365f5f5f55ab4ac","a6611adfc27d80cdc1018571","a6611adfc27df5f5f580cdc1018571","8c510ad8b365f6e8c3c7eae55ab4ac01665e","8c510ad8b365f6e8c3f5f5f5c7eae55ab4ac01665e","8c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e","8c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e","5430058c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e003c30","5430058c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e003c30").map(rr),ott=$r(JO);var t9=new Array(3).concat("af8dc3f7f7f77fbf7b","7b3294c2a5cfa6dba0008837","7b3294c2a5cff7f7f7a6dba0008837","762a83af8dc3e7d4e8d9f0d37fbf7b1b7837","762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837","762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837","762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837","40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b","40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b").map(rr),att=$r(t9);var e9=new Array(3).concat("e9a3c9f7f7f7a1d76a","d01c8bf1b6dab8e1864dac26","d01c8bf1b6daf7f7f7b8e1864dac26","c51b7de9a3c9fde0efe6f5d0a1d76a4d9221","c51b7de9a3c9fde0eff7f7f7e6f5d0a1d76a4d9221","c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221","c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221","8e0152c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221276419","8e0152c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221276419").map(rr),ltt=$r(e9);var r9=new Array(3).concat("998ec3f7f7f7f1a340","5e3c99b2abd2fdb863e66101","5e3c99b2abd2f7f7f7fdb863e66101","542788998ec3d8daebfee0b6f1a340b35806","542788998ec3d8daebf7f7f7fee0b6f1a340b35806","5427888073acb2abd2d8daebfee0b6fdb863e08214b35806","5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b35806","2d004b5427888073acb2abd2d8daebfee0b6fdb863e08214b358067f3b08","2d004b5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b358067f3b08").map(rr),ctt=$r(r9);var i9=new Array(3).concat("ef8a62f7f7f767a9cf","ca0020f4a58292c5de0571b0","ca0020f4a582f7f7f792c5de0571b0","b2182bef8a62fddbc7d1e5f067a9cf2166ac","b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac","b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac","b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac","67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061","67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061").map(rr),utt=$r(i9);var n9=new Array(3).concat("ef8a62ffffff999999","ca0020f4a582bababa404040","ca0020f4a582ffffffbababa404040","b2182bef8a62fddbc7e0e0e09999994d4d4d","b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d","b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d","b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d","67001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a","67001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a").map(rr),htt=$r(n9);var s9=new Array(3).concat("fc8d59ffffbf91bfdb","d7191cfdae61abd9e92c7bb6","d7191cfdae61ffffbfabd9e92c7bb6","d73027fc8d59fee090e0f3f891bfdb4575b4","d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4","d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4","d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4","a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695","a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695").map(rr),ftt=$r(s9);var o9=new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(rr),ptt=$r(o9);var a9=new Array(3).concat("fc8d59ffffbf99d594","d7191cfdae61abdda42b83ba","d7191cfdae61ffffbfabdda42b83ba","d53e4ffc8d59fee08be6f59899d5943288bd","d53e4ffc8d59fee08bffffbfe6f59899d5943288bd","d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd","d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd","9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2","9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2").map(rr),BI=$r(a9);var l9=new Array(3).concat("e5f5f999d8c92ca25f","edf8fbb2e2e266c2a4238b45","edf8fbb2e2e266c2a42ca25f006d2c","edf8fbccece699d8c966c2a42ca25f006d2c","edf8fbccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b").map(rr),dtt=$r(l9);var c9=new Array(3).concat("e0ecf49ebcda8856a7","edf8fbb3cde38c96c688419d","edf8fbb3cde38c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b").map(rr),Att=$r(c9);var u9=new Array(3).concat("e0f3dba8ddb543a2ca","f0f9e8bae4bc7bccc42b8cbe","f0f9e8bae4bc7bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081").map(rr),mtt=$r(u9);var h9=new Array(3).concat("fee8c8fdbb84e34a33","fef0d9fdcc8afc8d59d7301f","fef0d9fdcc8afc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000").map(rr),gtt=$r(h9);var f9=new Array(3).concat("ece2f0a6bddb1c9099","f6eff7bdc9e167a9cf02818a","f6eff7bdc9e167a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636").map(rr),_tt=$r(f9);var p9=new Array(3).concat("ece7f2a6bddb2b8cbe","f1eef6bdc9e174a9cf0570b0","f1eef6bdc9e174a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858").map(rr),ytt=$r(p9);var d9=new Array(3).concat("e7e1efc994c7dd1c77","f1eef6d7b5d8df65b0ce1256","f1eef6d7b5d8df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f").map(rr),xtt=$r(d9);var A9=new Array(3).concat("fde0ddfa9fb5c51b8a","feebe2fbb4b9f768a1ae017e","feebe2fbb4b9f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a").map(rr),btt=$r(A9);var m9=new Array(3).concat("edf8b17fcdbb2c7fb8","ffffcca1dab441b6c4225ea8","ffffcca1dab441b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58").map(rr),vtt=$r(m9);var g9=new Array(3).concat("f7fcb9addd8e31a354","ffffccc2e69978c679238443","ffffccc2e69978c67931a354006837","ffffccd9f0a3addd8e78c67931a354006837","ffffccd9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529").map(rr),wtt=$r(g9);var _9=new Array(3).concat("fff7bcfec44fd95f0e","ffffd4fed98efe9929cc4c02","ffffd4fed98efe9929d95f0e993404","ffffd4fee391fec44ffe9929d95f0e993404","ffffd4fee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506").map(rr),Ttt=$r(_9);var y9=new Array(3).concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map(rr),Stt=$r(y9);var x9=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(rr),Ett=$r(x9);var b9=new Array(3).concat("e5f5e0a1d99b31a354","edf8e9bae4b374c476238b45","edf8e9bae4b374c47631a354006d2c","edf8e9c7e9c0a1d99b74c47631a354006d2c","edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b").map(rr),Itt=$r(b9);var v9=new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(rr),Mtt=$r(v9);var w9=new Array(3).concat("efedf5bcbddc756bb1","f2f0f7cbc9e29e9ac86a51a3","f2f0f7cbc9e29e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d").map(rr),Ctt=$r(w9);var T9=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(rr),Ptt=$r(T9);var S9=new Array(3).concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(rr),Rtt=$r(S9);function ktt(e){return e=Math.max(0,Math.min(1,e)),"rgb("+Math.max(0,Math.min(255,Math.round(-4.54-e*(35.34-e*(2381.73-e*(6402.7-e*(7024.72-e*2710.57)))))))+", "+Math.max(0,Math.min(255,Math.round(32.49+e*(170.73+e*(52.82-e*(131.46-e*(176.58-e*67.37)))))))+", "+Math.max(0,Math.min(255,Math.round(81.24+e*(442.36-e*(2482.43-e*(6167.24-e*(6614.94-e*2475.67)))))))+")"}var Dtt=h1(hl(300,.5,0),hl(-240,.5,1));var Btt=h1(hl(-100,.75,.35),hl(80,1.5,.8)),Ott=h1(hl(260,.75,.35),hl(80,1.5,.8)),OI=hl();function Ntt(e){(e<0||e>1)&&(e-=Math.floor(e));var t=Math.abs(e-.5);return OI.h=360*e-100,OI.s=1.5-1.5*t,OI.l=.8-.9*t,OI+""}var NI=Vd(),a3t=Math.PI/3,l3t=Math.PI*2/3;function Ftt(e){var t;return e=(.5-e)*Math.PI,NI.r=255*(t=Math.sin(e))*t,NI.g=255*(t=Math.sin(e+a3t))*t,NI.b=255*(t=Math.sin(e+l3t))*t,NI+""}function Ltt(e){return e=Math.max(0,Math.min(1,e)),"rgb("+Math.max(0,Math.min(255,Math.round(34.61+e*(1172.33-e*(10793.56-e*(33300.12-e*(38394.49-e*14825.05)))))))+", "+Math.max(0,Math.min(255,Math.round(23.31+e*(557.33+e*(1225.33-e*(3574.96-e*(1073.77+e*707.56)))))))+", "+Math.max(0,Math.min(255,Math.round(27.2+e*(3211.1-e*(15327.97-e*(27814-e*(22569.18-e*6838.66)))))))+")"}function FI(e){var t=e.length;return function(r){return e[Math.max(0,Math.min(t-1,Math.floor(r*t)))]}}var ztt=FI(rr("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725")),Utt=FI(rr("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),Vtt=FI(rr("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),jtt=FI(rr("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));function si(e){return function(){return e}}var E9=Math.abs,La=Math.atan2,tf=Math.cos,$tt=Math.max,yp=Math.min,ml=Math.sin,rn=Math.sqrt,_a=1e-12,ef=Math.PI,t4=ef/2,Yu=2*ef;function Htt(e){return e>1?0:e<-1?ef:Math.acos(e)}function I9(e){return e>=1?t4:e<=-1?-t4:Math.asin(e)}function xp(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{let i=Math.floor(r);if(!(i>=0))throw new RangeError(`invalid digits: ${r}`);t=i}return e},()=>new Hd(t)}function c3t(e){return e.innerRadius}function u3t(e){return e.outerRadius}function h3t(e){return e.startAngle}function f3t(e){return e.endAngle}function p3t(e){return e&&e.padAngle}function d3t(e,t,r,i,s,n,o,c){var f=r-e,p=i-t,x=o-s,E=c-n,T=E*f-x*p;if(!(T*T<_a))return T=(x*(t-n)-E*(e-s))/T,[e+T*f,t+T*p]}function LI(e,t,r,i,s,n,o){var c=e-r,f=t-i,p=(o?n:-n)/rn(c*c+f*f),x=p*f,E=-p*c,T=e+x,D=t+E,N=r+x,z=i+E,U=(T+N)/2,H=(D+z)/2,G=N-T,Z=z-D,Y=G*G+Z*Z,st=s-n,at=T*z-N*D,Dt=(Z<0?-1:1)*rn($tt(0,st*st*Y-at*at)),Tt=(at*Z-G*Dt)/Y,kt=(-at*G-Z*Dt)/Y,Et=(at*Z+G*Dt)/Y,Mt=(-at*G+Z*Dt)/Y,oe=Tt-U,Xt=kt-H,xt=Et-U,jt=Mt-H;return oe*oe+Xt*Xt>xt*xt+jt*jt&&(Tt=Et,kt=Mt),{cx:Tt,cy:kt,x01:-x,y01:-E,x11:Tt*(s/st-1),y11:kt*(s/st-1)}}function Wtt(){var e=c3t,t=u3t,r=si(0),i=null,s=h3t,n=f3t,o=p3t,c=null,f=xp(p);function p(){var x,E,T=+e.apply(this,arguments),D=+t.apply(this,arguments),N=s.apply(this,arguments)-t4,z=n.apply(this,arguments)-t4,U=E9(z-N),H=z>N;if(c||(c=x=f()),D<T&&(E=D,D=T,T=E),!(D>_a))c.moveTo(0,0);else if(U>Yu-_a)c.moveTo(D*tf(N),D*ml(N)),c.arc(0,0,D,N,z,!H),T>_a&&(c.moveTo(T*tf(z),T*ml(z)),c.arc(0,0,T,z,N,H));else{var G=N,Z=z,Y=N,st=z,at=U,Dt=U,Tt=o.apply(this,arguments)/2,kt=Tt>_a&&(i?+i.apply(this,arguments):rn(T*T+D*D)),Et=yp(E9(D-T)/2,+r.apply(this,arguments)),Mt=Et,oe=Et,Xt,xt;if(kt>_a){var jt=I9(kt/T*ml(Tt)),Wt=I9(kt/D*ml(Tt));(at-=jt*2)>_a?(jt*=H?1:-1,Y+=jt,st-=jt):(at=0,Y=st=(N+z)/2),(Dt-=Wt*2)>_a?(Wt*=H?1:-1,G+=Wt,Z-=Wt):(Dt=0,G=Z=(N+z)/2)}var de=D*tf(G),Ee=D*ml(G),Se=T*tf(st),ze=T*ml(st);if(Et>_a){var ke=D*tf(Z),ir=D*ml(Z),Ti=T*tf(Y),_i=T*ml(Y),ci;if(U<ef)if(ci=d3t(de,Ee,Ti,_i,ke,ir,Se,ze)){var Gr=de-ci[0],Fr=Ee-ci[1],Dr=ke-ci[0],Le=ir-ci[1],Tr=1/ml(Htt((Gr*Dr+Fr*Le)/(rn(Gr*Gr+Fr*Fr)*rn(Dr*Dr+Le*Le)))/2),jr=rn(ci[0]*ci[0]+ci[1]*ci[1]);Mt=yp(Et,(T-jr)/(Tr-1)),oe=yp(Et,(D-jr)/(Tr+1))}else Mt=oe=0}Dt>_a?oe>_a?(Xt=LI(Ti,_i,de,Ee,D,oe,H),xt=LI(ke,ir,Se,ze,D,oe,H),c.moveTo(Xt.cx+Xt.x01,Xt.cy+Xt.y01),oe<Et?c.arc(Xt.cx,Xt.cy,oe,La(Xt.y01,Xt.x01),La(xt.y01,xt.x01),!H):(c.arc(Xt.cx,Xt.cy,oe,La(Xt.y01,Xt.x01),La(Xt.y11,Xt.x11),!H),c.arc(0,0,D,La(Xt.cy+Xt.y11,Xt.cx+Xt.x11),La(xt.cy+xt.y11,xt.cx+xt.x11),!H),c.arc(xt.cx,xt.cy,oe,La(xt.y11,xt.x11),La(xt.y01,xt.x01),!H))):(c.moveTo(de,Ee),c.arc(0,0,D,G,Z,!H)):c.moveTo(de,Ee),!(T>_a)||!(at>_a)?c.lineTo(Se,ze):Mt>_a?(Xt=LI(Se,ze,ke,ir,T,-Mt,H),xt=LI(de,Ee,Ti,_i,T,-Mt,H),c.lineTo(Xt.cx+Xt.x01,Xt.cy+Xt.y01),Mt<Et?c.arc(Xt.cx,Xt.cy,Mt,La(Xt.y01,Xt.x01),La(xt.y01,xt.x01),!H):(c.arc(Xt.cx,Xt.cy,Mt,La(Xt.y01,Xt.x01),La(Xt.y11,Xt.x11),!H),c.arc(0,0,T,La(Xt.cy+Xt.y11,Xt.cx+Xt.x11),La(xt.cy+xt.y11,xt.cx+xt.x11),H),c.arc(xt.cx,xt.cy,Mt,La(xt.y11,xt.x11),La(xt.y01,xt.x01),!H))):c.arc(0,0,T,st,Y,H)}if(c.closePath(),x)return c=null,x+""||null}return p.centroid=function(){var x=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,E=(+s.apply(this,arguments)+ +n.apply(this,arguments))/2-ef/2;return[tf(E)*x,ml(E)*x]},p.innerRadius=function(x){return arguments.length?(e=typeof x=="function"?x:si(+x),p):e},p.outerRadius=function(x){return arguments.length?(t=typeof x=="function"?x:si(+x),p):t},p.cornerRadius=function(x){return arguments.length?(r=typeof x=="function"?x:si(+x),p):r},p.padRadius=function(x){return arguments.length?(i=x==null?null:typeof x=="function"?x:si(+x),p):i},p.startAngle=function(x){return arguments.length?(s=typeof x=="function"?x:si(+x),p):s},p.endAngle=function(x){return arguments.length?(n=typeof x=="function"?x:si(+x),p):n},p.padAngle=function(x){return arguments.length?(o=typeof x=="function"?x:si(+x),p):o},p.context=function(x){return arguments.length?(c=x??null,p):c},p}var qtt=Array.prototype.slice;function im(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Ytt(e){this._context=e}Ytt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function nm(e){return new Ytt(e)}function j2(e){return e[0]}function $2(e){return e[1]}function H2(e,t){var r=si(!0),i=null,s=nm,n=null,o=xp(c);e=typeof e=="function"?e:e===void 0?j2:si(e),t=typeof t=="function"?t:t===void 0?$2:si(t);function c(f){var p,x=(f=im(f)).length,E,T=!1,D;for(i==null&&(n=s(D=o())),p=0;p<=x;++p)!(p<x&&r(E=f[p],p,f))===T&&((T=!T)?n.lineStart():n.lineEnd()),T&&n.point(+e(E,p,f),+t(E,p,f));if(D)return n=null,D+""||null}return c.x=function(f){return arguments.length?(e=typeof f=="function"?f:si(+f),c):e},c.y=function(f){return arguments.length?(t=typeof f=="function"?f:si(+f),c):t},c.defined=function(f){return arguments.length?(r=typeof f=="function"?f:si(!!f),c):r},c.curve=function(f){return arguments.length?(s=f,i!=null&&(n=s(i)),c):s},c.context=function(f){return arguments.length?(f==null?i=n=null:n=s(i=f),c):i},c}function zI(e,t,r){var i=null,s=si(!0),n=null,o=nm,c=null,f=xp(p);e=typeof e=="function"?e:e===void 0?j2:si(+e),t=typeof t=="function"?t:t===void 0?si(0):si(+t),r=typeof r=="function"?r:r===void 0?$2:si(+r);function p(E){var T,D,N,z=(E=im(E)).length,U,H=!1,G,Z=new Array(z),Y=new Array(z);for(n==null&&(c=o(G=f())),T=0;T<=z;++T){if(!(T<z&&s(U=E[T],T,E))===H)if(H=!H)D=T,c.areaStart(),c.lineStart();else{for(c.lineEnd(),c.lineStart(),N=T-1;N>=D;--N)c.point(Z[N],Y[N]);c.lineEnd(),c.areaEnd()}H&&(Z[T]=+e(U,T,E),Y[T]=+t(U,T,E),c.point(i?+i(U,T,E):Z[T],r?+r(U,T,E):Y[T]))}if(G)return c=null,G+""||null}function x(){return H2().defined(s).curve(o).context(n)}return p.x=function(E){return arguments.length?(e=typeof E=="function"?E:si(+E),i=null,p):e},p.x0=function(E){return arguments.length?(e=typeof E=="function"?E:si(+E),p):e},p.x1=function(E){return arguments.length?(i=E==null?null:typeof E=="function"?E:si(+E),p):i},p.y=function(E){return arguments.length?(t=typeof E=="function"?E:si(+E),r=null,p):t},p.y0=function(E){return arguments.length?(t=typeof E=="function"?E:si(+E),p):t},p.y1=function(E){return arguments.length?(r=E==null?null:typeof E=="function"?E:si(+E),p):r},p.lineX0=p.lineY0=function(){return x().x(e).y(t)},p.lineY1=function(){return x().x(e).y(r)},p.lineX1=function(){return x().x(i).y(t)},p.defined=function(E){return arguments.length?(s=typeof E=="function"?E:si(!!E),p):s},p.curve=function(E){return arguments.length?(o=E,n!=null&&(c=o(n)),p):o},p.context=function(E){return arguments.length?(E==null?n=c=null:c=o(n=E),p):n},p}function Xtt(e,t){return t<e?-1:t>e?1:t>=e?0:NaN}function Ztt(e){return e}function Gtt(){var e=Ztt,t=Xtt,r=null,i=si(0),s=si(Yu),n=si(0);function o(c){var f,p=(c=im(c)).length,x,E,T=0,D=new Array(p),N=new Array(p),z=+i.apply(this,arguments),U=Math.min(Yu,Math.max(-Yu,s.apply(this,arguments)-z)),H,G=Math.min(Math.abs(U)/p,n.apply(this,arguments)),Z=G*(U<0?-1:1),Y;for(f=0;f<p;++f)(Y=N[D[f]=f]=+e(c[f],f,c))>0&&(T+=Y);for(t!=null?D.sort(function(st,at){return t(N[st],N[at])}):r!=null&&D.sort(function(st,at){return r(c[st],c[at])}),f=0,E=T?(U-p*Z)/T:0;f<p;++f,z=H)x=D[f],Y=N[x],H=z+(Y>0?Y*E:0)+Z,N[x]={data:c[x],index:f,value:Y,startAngle:z,endAngle:H,padAngle:G};return N}return o.value=function(c){return arguments.length?(e=typeof c=="function"?c:si(+c),o):e},o.sortValues=function(c){return arguments.length?(t=c,r=null,o):t},o.sort=function(c){return arguments.length?(r=c,t=null,o):r},o.startAngle=function(c){return arguments.length?(i=typeof c=="function"?c:si(+c),o):i},o.endAngle=function(c){return arguments.length?(s=typeof c=="function"?c:si(+c),o):s},o.padAngle=function(c){return arguments.length?(n=typeof c=="function"?c:si(+c),o):n},o}var UI=W2(nm);function Qtt(e){this._curve=e}Qtt.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(e,t){this._curve.point(t*Math.sin(e),t*-Math.cos(e))}};function W2(e){function t(r){return new Qtt(e(r))}return t._curve=e,t}function q2(e){var t=e.curve;return e.angle=e.x,delete e.x,e.radius=e.y,delete e.y,e.curve=function(r){return arguments.length?t(W2(r)):t()._curve},e}function M9(){return q2(H2().curve(UI))}function C9(){var e=zI().curve(UI),t=e.curve,r=e.lineX0,i=e.lineX1,s=e.lineY0,n=e.lineY1;return e.angle=e.x,delete e.x,e.startAngle=e.x0,delete e.x0,e.endAngle=e.x1,delete e.x1,e.radius=e.y,delete e.y,e.innerRadius=e.y0,delete e.y0,e.outerRadius=e.y1,delete e.y1,e.lineStartAngle=function(){return q2(r())},delete e.lineX0,e.lineEndAngle=function(){return q2(i())},delete e.lineX1,e.lineInnerRadius=function(){return q2(s())},delete e.lineY0,e.lineOuterRadius=function(){return q2(n())},delete e.lineY1,e.curve=function(o){return arguments.length?t(W2(o)):t()._curve},e}function Z1(e,t){return[(t=+t)*Math.cos(e-=Math.PI/2),t*Math.sin(e)]}var VI=class{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}},P9=class{constructor(t){this._context=t}lineStart(){this._point=0}lineEnd(){}point(t,r){if(t=+t,r=+r,this._point===0)this._point=1;else{let i=Z1(this._x0,this._y0),s=Z1(this._x0,this._y0=(this._y0+r)/2),n=Z1(t,this._y0),o=Z1(t,r);this._context.moveTo(...i),this._context.bezierCurveTo(...s,...n,...o)}this._x0=t,this._y0=r}};function jI(e){return new VI(e,!0)}function $I(e){return new VI(e,!1)}function Ktt(e){return new P9(e)}function A3t(e){return e.source}function m3t(e){return e.target}function e4(e){let t=A3t,r=m3t,i=j2,s=$2,n=null,o=null,c=xp(f);function f(){let p,x=qtt.call(arguments),E=t.apply(this,x),T=r.apply(this,x);if(n==null&&(o=e(p=c())),o.lineStart(),x[0]=E,o.point(+i.apply(this,x),+s.apply(this,x)),x[0]=T,o.point(+i.apply(this,x),+s.apply(this,x)),o.lineEnd(),p)return o=null,p+""||null}return f.source=function(p){return arguments.length?(t=p,f):t},f.target=function(p){return arguments.length?(r=p,f):r},f.x=function(p){return arguments.length?(i=typeof p=="function"?p:si(+p),f):i},f.y=function(p){return arguments.length?(s=typeof p=="function"?p:si(+p),f):s},f.context=function(p){return arguments.length?(p==null?n=o=null:o=e(n=p),f):n},f}function Jtt(){return e4(jI)}function tet(){return e4($I)}function eet(){let e=e4(Ktt);return e.angle=e.x,delete e.x,e.radius=e.y,delete e.y,e}var g3t=rn(3),HI={draw(e,t){let r=rn(t+yp(t/28,.75))*.59436,i=r/2,s=i*g3t;e.moveTo(0,r),e.lineTo(0,-r),e.moveTo(-s,-i),e.lineTo(s,i),e.moveTo(-s,i),e.lineTo(s,-i)}};var Y2={draw(e,t){let r=rn(t/ef);e.moveTo(r,0),e.arc(0,0,r,0,Yu)}};var WI={draw(e,t){let r=rn(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}};var ret=rn(1/3),_3t=ret*2,qI={draw(e,t){let r=rn(t/_3t),i=r*ret;e.moveTo(0,-r),e.lineTo(i,0),e.lineTo(0,r),e.lineTo(-i,0),e.closePath()}};var YI={draw(e,t){let r=rn(t)*.62625;e.moveTo(0,-r),e.lineTo(r,0),e.lineTo(0,r),e.lineTo(-r,0),e.closePath()}};var XI={draw(e,t){let r=rn(t-yp(t/7,2))*.87559;e.moveTo(-r,0),e.lineTo(r,0),e.moveTo(0,r),e.lineTo(0,-r)}};var ZI={draw(e,t){let r=rn(t),i=-r/2;e.rect(i,i,r,r)}};var GI={draw(e,t){let r=rn(t)*.4431;e.moveTo(r,r),e.lineTo(r,-r),e.lineTo(-r,-r),e.lineTo(-r,r),e.closePath()}};var y3t=.8908130915292852,iet=ml(ef/10)/ml(7*ef/10),x3t=ml(Yu/10)*iet,b3t=-tf(Yu/10)*iet,QI={draw(e,t){let r=rn(t*y3t),i=x3t*r,s=b3t*r;e.moveTo(0,-r),e.lineTo(i,s);for(let n=1;n<5;++n){let o=Yu*n/5,c=tf(o),f=ml(o);e.lineTo(f*r,-c*r),e.lineTo(c*i-f*s,f*i+c*s)}e.closePath()}};var R9=rn(3),KI={draw(e,t){let r=-rn(t/(R9*3));e.moveTo(0,r*2),e.lineTo(-R9*r,-r),e.lineTo(R9*r,-r),e.closePath()}};var v3t=rn(3),JI={draw(e,t){let r=rn(t)*.6824,i=r/2,s=r*v3t/2;e.moveTo(0,-r),e.lineTo(s,i),e.lineTo(-s,i),e.closePath()}};var Xu=-.5,Zu=rn(3)/2,k9=1/rn(12),w3t=(k9/2+1)*3,tM={draw(e,t){let r=rn(t/w3t),i=r/2,s=r*k9,n=i,o=r*k9+r,c=-n,f=o;e.moveTo(i,s),e.lineTo(n,o),e.lineTo(c,f),e.lineTo(Xu*i-Zu*s,Zu*i+Xu*s),e.lineTo(Xu*n-Zu*o,Zu*n+Xu*o),e.lineTo(Xu*c-Zu*f,Zu*c+Xu*f),e.lineTo(Xu*i+Zu*s,Xu*s-Zu*i),e.lineTo(Xu*n+Zu*o,Xu*o-Zu*n),e.lineTo(Xu*c+Zu*f,Xu*f-Zu*c),e.closePath()}};var r4={draw(e,t){let r=rn(t-yp(t/6,1.7))*.6189;e.moveTo(-r,-r),e.lineTo(r,r),e.moveTo(-r,r),e.lineTo(r,-r)}};var D9=[Y2,WI,qI,ZI,QI,KI,tM],net=[Y2,XI,r4,JI,HI,GI,YI];function B9(e,t){let r=null,i=xp(s);e=typeof e=="function"?e:si(e||Y2),t=typeof t=="function"?t:si(t===void 0?64:+t);function s(){let n;if(r||(r=n=i()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),n)return r=null,n+""||null}return s.type=function(n){return arguments.length?(e=typeof n=="function"?n:si(n),s):e},s.size=function(n){return arguments.length?(t=typeof n=="function"?n:si(+n),s):t},s.context=function(n){return arguments.length?(r=n??null,s):r},s}function Gu(){}function X2(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function i4(e){this._context=e}i4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:X2(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:X2(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function set(e){return new i4(e)}function oet(e){this._context=e}oet.prototype={areaStart:Gu,areaEnd:Gu,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:X2(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function aet(e){return new oet(e)}function cet(e){this._context=e}cet.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,i=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,i):this._context.moveTo(r,i);break;case 3:this._point=4;default:X2(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function uet(e){return new cet(e)}function het(e,t){this._basis=new i4(e),this._beta=t}het.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,r=e.length-1;if(r>0)for(var i=e[0],s=t[0],n=e[r]-i,o=t[r]-s,c=-1,f;++c<=r;)f=c/r,this._basis.point(this._beta*e[c]+(1-this._beta)*(i+f*n),this._beta*t[c]+(1-this._beta)*(s+f*o));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};var fet=function e(t){function r(i){return t===1?new i4(i):new het(i,t)}return r.beta=function(i){return e(+i)},r}(.85);function Z2(e,t,r){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-r),e._x2,e._y2)}function eM(e,t){this._context=e,this._k=(1-t)/6}eM.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Z2(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:Z2(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var pet=function e(t){function r(i){return new eM(i,t)}return r.tension=function(i){return e(+i)},r}(0);function rM(e,t){this._context=e,this._k=(1-t)/6}rM.prototype={areaStart:Gu,areaEnd:Gu,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:Z2(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var det=function e(t){function r(i){return new rM(i,t)}return r.tension=function(i){return e(+i)},r}(0);function iM(e,t){this._context=e,this._k=(1-t)/6}iM.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Z2(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Aet=function e(t){function r(i){return new iM(i,t)}return r.tension=function(i){return e(+i)},r}(0);function n4(e,t,r){var i=e._x1,s=e._y1,n=e._x2,o=e._y2;if(e._l01_a>_a){var c=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,f=3*e._l01_a*(e._l01_a+e._l12_a);i=(i*c-e._x0*e._l12_2a+e._x2*e._l01_2a)/f,s=(s*c-e._y0*e._l12_2a+e._y2*e._l01_2a)/f}if(e._l23_a>_a){var p=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,x=3*e._l23_a*(e._l23_a+e._l12_a);n=(n*p+e._x1*e._l23_2a-t*e._l12_2a)/x,o=(o*p+e._y1*e._l23_2a-r*e._l12_2a)/x}e._context.bezierCurveTo(i,s,n,o,e._x2,e._y2)}function met(e,t){this._context=e,this._alpha=t}met.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var r=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(r*r+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:n4(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var get=function e(t){function r(i){return t?new met(i,t):new eM(i,0)}return r.alpha=function(i){return e(+i)},r}(.5);function _et(e,t){this._context=e,this._alpha=t}_et.prototype={areaStart:Gu,areaEnd:Gu,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){if(e=+e,t=+t,this._point){var r=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(r*r+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:n4(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var yet=function e(t){function r(i){return t?new _et(i,t):new rM(i,0)}return r.alpha=function(i){return e(+i)},r}(.5);function xet(e,t){this._context=e,this._alpha=t}xet.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var r=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(r*r+i*i,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:n4(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var bet=function e(t){function r(i){return t?new xet(i,t):new iM(i,0)}return r.alpha=function(i){return e(+i)},r}(.5);function vet(e){this._context=e}vet.prototype={areaStart:Gu,areaEnd:Gu,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function wet(e){return new vet(e)}function Tet(e){return e<0?-1:1}function Eet(e,t,r){var i=e._x1-e._x0,s=t-e._x1,n=(e._y1-e._y0)/(i||s<0&&-0),o=(r-e._y1)/(s||i<0&&-0),c=(n*s+o*i)/(i+s);return(Tet(n)+Tet(o))*Math.min(Math.abs(n),Math.abs(o),.5*Math.abs(c))||0}function Iet(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function O9(e,t,r){var i=e._x0,s=e._y0,n=e._x1,o=e._y1,c=(n-i)/3;e._context.bezierCurveTo(i+c,s+c*t,n-c,o-c*r,n,o)}function nM(e){this._context=e}nM.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:O9(this,this._t0,Iet(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,O9(this,Iet(this,r=Eet(this,e,t)),r);break;default:O9(this,this._t0,r=Eet(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function Met(e){this._context=new Cet(e)}(Met.prototype=Object.create(nM.prototype)).point=function(e,t){nM.prototype.point.call(this,t,e)};function Cet(e){this._context=e}Cet.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,i,s,n){this._context.bezierCurveTo(t,e,i,r,n,s)}};function Pet(e){return new nM(e)}function Ret(e){return new Met(e)}function Det(e){this._context=e}Det.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var i=ket(e),s=ket(t),n=0,o=1;o<r;++n,++o)this._context.bezierCurveTo(i[0][n],s[0][n],i[1][n],s[1][n],e[o],t[o]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function ket(e){var t,r=e.length-1,i,s=new Array(r),n=new Array(r),o=new Array(r);for(s[0]=0,n[0]=2,o[0]=e[0]+2*e[1],t=1;t<r-1;++t)s[t]=1,n[t]=4,o[t]=4*e[t]+2*e[t+1];for(s[r-1]=2,n[r-1]=7,o[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)i=s[t]/n[t-1],n[t]-=i,o[t]-=i*o[t-1];for(s[r-1]=o[r-1]/n[r-1],t=r-2;t>=0;--t)s[t]=(o[t]-s[t+1])/n[t];for(n[r-1]=(e[r]+s[r-1])/2,t=0;t<r-1;++t)n[t]=2*e[t+1]-s[t+1];return[s,n]}function Bet(e){return new Det(e)}function sM(e,t){this._context=e,this._t=t}sM.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function Oet(e){return new sM(e,.5)}function Net(e){return new sM(e,0)}function Fet(e){return new sM(e,1)}function rf(e,t){if((o=e.length)>1)for(var r=1,i,s,n=e[t[0]],o,c=n.length;r<o;++r)for(s=n,n=e[t[r]],i=0;i<c;++i)n[i][1]+=n[i][0]=isNaN(s[i][1])?s[i][0]:s[i][1]}function nf(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function T3t(e,t){return e[t]}function S3t(e){let t=[];return t.key=e,t}function Let(){var e=si([]),t=nf,r=rf,i=T3t;function s(n){var o=Array.from(e.apply(this,arguments),S3t),c,f=o.length,p=-1,x;for(let E of n)for(c=0,++p;c<f;++c)(o[c][p]=[0,+i(E,o[c].key,p,n)]).data=E;for(c=0,x=im(t(o));c<f;++c)o[x[c]].index=c;return r(o,x),o}return s.keys=function(n){return arguments.length?(e=typeof n=="function"?n:si(Array.from(n)),s):e},s.value=function(n){return arguments.length?(i=typeof n=="function"?n:si(+n),s):i},s.order=function(n){return arguments.length?(t=n==null?nf:typeof n=="function"?n:si(Array.from(n)),s):t},s.offset=function(n){return arguments.length?(r=n??rf,s):r},s}function zet(e,t){if((i=e.length)>0){for(var r,i,s=0,n=e[0].length,o;s<n;++s){for(o=r=0;r<i;++r)o+=e[r][s][1]||0;if(o)for(r=0;r<i;++r)e[r][s][1]/=o}rf(e,t)}}function Uet(e,t){if((f=e.length)>0)for(var r,i=0,s,n,o,c,f,p=e[t[0]].length;i<p;++i)for(o=c=0,r=0;r<f;++r)(n=(s=e[t[r]][i])[1]-s[0])>0?(s[0]=o,s[1]=o+=n):n<0?(s[1]=c,s[0]=c+=n):(s[0]=0,s[1]=n)}function Vet(e,t){if((s=e.length)>0){for(var r=0,i=e[t[0]],s,n=i.length;r<n;++r){for(var o=0,c=0;o<s;++o)c+=e[o][r][1]||0;i[r][1]+=i[r][0]=-c/2}rf(e,t)}}function jet(e,t){if(!(!((o=e.length)>0)||!((n=(s=e[t[0]]).length)>0))){for(var r=0,i=1,s,n,o;i<n;++i){for(var c=0,f=0,p=0;c<o;++c){for(var x=e[t[c]],E=x[i][1]||0,T=x[i-1][1]||0,D=(E-T)/2,N=0;N<c;++N){var z=e[t[N]],U=z[i][1]||0,H=z[i-1][1]||0;D+=U-H}f+=E,p+=D*E}s[i-1][1]+=s[i-1][0]=r,f&&(r-=p/f)}s[i-1][1]+=s[i-1][0]=r,rf(e,t)}}function oM(e){var t=e.map(E3t);return nf(e).sort(function(r,i){return t[r]-t[i]})}function E3t(e){for(var t=-1,r=0,i=e.length,s,n=-1/0;++t<i;)(s=+e[t][1])>n&&(n=s,r=t);return r}function aM(e){var t=e.map(N9);return nf(e).sort(function(r,i){return t[r]-t[i]})}function N9(e){for(var t=0,r=-1,i=e.length,s;++r<i;)(s=+e[r][1])&&(t+=s);return t}function $et(e){return aM(e).reverse()}function Het(e){var t=e.length,r,i,s=e.map(N9),n=oM(e),o=0,c=0,f=[],p=[];for(r=0;r<t;++r)i=n[r],o<c?(o+=s[i],f.push(i)):(c+=s[i],p.push(i));return p.reverse().concat(f)}function Wet(e){return nf(e).reverse()}var s4=e=>()=>e;function F9(e,{sourceEvent:t,target:r,transform:i,dispatch:s}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},transform:{value:i,enumerable:!0,configurable:!0},_:{value:s}})}function Qu(e,t,r){this.k=e,this.x=t,this.y=r}Qu.prototype={constructor:Qu,scale:function(e){return e===1?this:new Qu(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Qu(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var G2=new Qu(1,0,0);lM.prototype=Qu.prototype;function lM(e){for(;!e.__zoom;)if(!(e=e.parentNode))return G2;return e.__zoom}function cM(e){e.stopImmediatePropagation()}function Q2(e){e.preventDefault(),e.stopImmediatePropagation()}function I3t(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function M3t(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function qet(){return this.__zoom||G2}function C3t(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function P3t(){return navigator.maxTouchPoints||"ontouchstart"in this}function R3t(e,t,r){var i=e.invertX(t[0][0])-r[0][0],s=e.invertX(t[1][0])-r[1][0],n=e.invertY(t[0][1])-r[0][1],o=e.invertY(t[1][1])-r[1][1];return e.translate(s>i?(i+s)/2:Math.min(0,i)||Math.max(0,s),o>n?(n+o)/2:Math.min(0,n)||Math.max(0,o))}function Yet(){var e=I3t,t=M3t,r=R3t,i=C3t,s=P3t,n=[0,1/0],o=[[-1/0,-1/0],[1/0,1/0]],c=250,f=VE,p=ju("start","zoom","end"),x,E,T,D=500,N=150,z=0,U=10;function H(xt){xt.property("__zoom",qet).on("wheel.zoom",Tt,{passive:!1}).on("mousedown.zoom",kt).on("dblclick.zoom",Et).filter(s).on("touchstart.zoom",Mt).on("touchmove.zoom",oe).on("touchend.zoom touchcancel.zoom",Xt).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}H.transform=function(xt,jt,Wt,de){var Ee=xt.selection?xt.selection():xt;Ee.property("__zoom",qet),xt!==Ee?st(xt,jt,Wt,de):Ee.interrupt().each(function(){at(this,arguments).event(de).start().zoom(null,typeof jt=="function"?jt.apply(this,arguments):jt).end()})},H.scaleBy=function(xt,jt,Wt,de){H.scaleTo(xt,function(){var Ee=this.__zoom.k,Se=typeof jt=="function"?jt.apply(this,arguments):jt;return Ee*Se},Wt,de)},H.scaleTo=function(xt,jt,Wt,de){H.transform(xt,function(){var Ee=t.apply(this,arguments),Se=this.__zoom,ze=Wt==null?Y(Ee):typeof Wt=="function"?Wt.apply(this,arguments):Wt,ke=Se.invert(ze),ir=typeof jt=="function"?jt.apply(this,arguments):jt;return r(Z(G(Se,ir),ze,ke),Ee,o)},Wt,de)},H.translateBy=function(xt,jt,Wt,de){H.transform(xt,function(){return r(this.__zoom.translate(typeof jt=="function"?jt.apply(this,arguments):jt,typeof Wt=="function"?Wt.apply(this,arguments):Wt),t.apply(this,arguments),o)},null,de)},H.translateTo=function(xt,jt,Wt,de,Ee){H.transform(xt,function(){var Se=t.apply(this,arguments),ze=this.__zoom,ke=de==null?Y(Se):typeof de=="function"?de.apply(this,arguments):de;return r(G2.translate(ke[0],ke[1]).scale(ze.k).translate(typeof jt=="function"?-jt.apply(this,arguments):-jt,typeof Wt=="function"?-Wt.apply(this,arguments):-Wt),Se,o)},de,Ee)};function G(xt,jt){return jt=Math.max(n[0],Math.min(n[1],jt)),jt===xt.k?xt:new Qu(jt,xt.x,xt.y)}function Z(xt,jt,Wt){var de=jt[0]-Wt[0]*xt.k,Ee=jt[1]-Wt[1]*xt.k;return de===xt.x&&Ee===xt.y?xt:new Qu(xt.k,de,Ee)}function Y(xt){return[(+xt[0][0]+ +xt[1][0])/2,(+xt[0][1]+ +xt[1][1])/2]}function st(xt,jt,Wt,de){xt.on("start.zoom",function(){at(this,arguments).event(de).start()}).on("interrupt.zoom end.zoom",function(){at(this,arguments).event(de).end()}).tween("zoom",function(){var Ee=this,Se=arguments,ze=at(Ee,Se).event(de),ke=t.apply(Ee,Se),ir=Wt==null?Y(ke):typeof Wt=="function"?Wt.apply(Ee,Se):Wt,Ti=Math.max(ke[1][0]-ke[0][0],ke[1][1]-ke[0][1]),_i=Ee.__zoom,ci=typeof jt=="function"?jt.apply(Ee,Se):jt,Gr=f(_i.invert(ir).concat(Ti/_i.k),ci.invert(ir).concat(Ti/ci.k));return function(Fr){if(Fr===1)Fr=ci;else{var Dr=Gr(Fr),Le=Ti/Dr[2];Fr=new Qu(Le,ir[0]-Dr[0]*Le,ir[1]-Dr[1]*Le)}ze.zoom(null,Fr)}})}function at(xt,jt,Wt){return!Wt&&xt.__zooming||new Dt(xt,jt)}function Dt(xt,jt){this.that=xt,this.args=jt,this.active=0,this.sourceEvent=null,this.extent=t.apply(xt,jt),this.taps=0}Dt.prototype={event:function(xt){return xt&&(this.sourceEvent=xt),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(xt,jt){return this.mouse&&xt!=="mouse"&&(this.mouse[1]=jt.invert(this.mouse[0])),this.touch0&&xt!=="touch"&&(this.touch0[1]=jt.invert(this.touch0[0])),this.touch1&&xt!=="touch"&&(this.touch1[1]=jt.invert(this.touch1[0])),this.that.__zoom=jt,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(xt){var jt=lo(this.that).datum();p.call(xt,this.that,new F9(xt,{sourceEvent:this.sourceEvent,target:H,type:xt,transform:this.that.__zoom,dispatch:p}),jt)}};function Tt(xt,...jt){if(!e.apply(this,arguments))return;var Wt=at(this,jt).event(xt),de=this.__zoom,Ee=Math.max(n[0],Math.min(n[1],de.k*Math.pow(2,i.apply(this,arguments)))),Se=pa(xt);if(Wt.wheel)(Wt.mouse[0][0]!==Se[0]||Wt.mouse[0][1]!==Se[1])&&(Wt.mouse[1]=de.invert(Wt.mouse[0]=Se)),clearTimeout(Wt.wheel);else{if(de.k===Ee)return;Wt.mouse=[Se,de.invert(Se)],Xh(this),Wt.start()}Q2(xt),Wt.wheel=setTimeout(ze,N),Wt.zoom("mouse",r(Z(G(de,Ee),Wt.mouse[0],Wt.mouse[1]),Wt.extent,o));function ze(){Wt.wheel=null,Wt.end()}}function kt(xt,...jt){if(T||!e.apply(this,arguments))return;var Wt=xt.currentTarget,de=at(this,jt,!0).event(xt),Ee=lo(xt.view).on("mousemove.zoom",ir,!0).on("mouseup.zoom",Ti,!0),Se=pa(xt,Wt),ze=xt.clientX,ke=xt.clientY;NA(xt.view),cM(xt),de.mouse=[Se,this.__zoom.invert(Se)],Xh(this),de.start();function ir(_i){if(Q2(_i),!de.moved){var ci=_i.clientX-ze,Gr=_i.clientY-ke;de.moved=ci*ci+Gr*Gr>z}de.event(_i).zoom("mouse",r(Z(de.that.__zoom,de.mouse[0]=pa(_i,Wt),de.mouse[1]),de.extent,o))}function Ti(_i){Ee.on("mousemove.zoom mouseup.zoom",null),FA(_i.view,de.moved),Q2(_i),de.event(_i).end()}}function Et(xt,...jt){if(e.apply(this,arguments)){var Wt=this.__zoom,de=pa(xt.changedTouches?xt.changedTouches[0]:xt,this),Ee=Wt.invert(de),Se=Wt.k*(xt.shiftKey?.5:2),ze=r(Z(G(Wt,Se),de,Ee),t.apply(this,jt),o);Q2(xt),c>0?lo(this).transition().duration(c).call(st,ze,de,xt):lo(this).call(H.transform,ze,de,xt)}}function Mt(xt,...jt){if(e.apply(this,arguments)){var Wt=xt.touches,de=Wt.length,Ee=at(this,jt,xt.changedTouches.length===de).event(xt),Se,ze,ke,ir;for(cM(xt),ze=0;ze<de;++ze)ke=Wt[ze],ir=pa(ke,this),ir=[ir,this.__zoom.invert(ir),ke.identifier],Ee.touch0?!Ee.touch1&&Ee.touch0[2]!==ir[2]&&(Ee.touch1=ir,Ee.taps=0):(Ee.touch0=ir,Se=!0,Ee.taps=1+!!x);x&&(x=clearTimeout(x)),Se&&(Ee.taps<2&&(E=ir[0],x=setTimeout(function(){x=null},D)),Xh(this),Ee.start())}}function oe(xt,...jt){if(this.__zooming){var Wt=at(this,jt).event(xt),de=xt.changedTouches,Ee=de.length,Se,ze,ke,ir;for(Q2(xt),Se=0;Se<Ee;++Se)ze=de[Se],ke=pa(ze,this),Wt.touch0&&Wt.touch0[2]===ze.identifier?Wt.touch0[0]=ke:Wt.touch1&&Wt.touch1[2]===ze.identifier&&(Wt.touch1[0]=ke);if(ze=Wt.that.__zoom,Wt.touch1){var Ti=Wt.touch0[0],_i=Wt.touch0[1],ci=Wt.touch1[0],Gr=Wt.touch1[1],Fr=(Fr=ci[0]-Ti[0])*Fr+(Fr=ci[1]-Ti[1])*Fr,Dr=(Dr=Gr[0]-_i[0])*Dr+(Dr=Gr[1]-_i[1])*Dr;ze=G(ze,Math.sqrt(Fr/Dr)),ke=[(Ti[0]+ci[0])/2,(Ti[1]+ci[1])/2],ir=[(_i[0]+Gr[0])/2,(_i[1]+Gr[1])/2]}else if(Wt.touch0)ke=Wt.touch0[0],ir=Wt.touch0[1];else return;Wt.zoom("touch",r(Z(ze,ke,ir),Wt.extent,o))}}function Xt(xt,...jt){if(this.__zooming){var Wt=at(this,jt).event(xt),de=xt.changedTouches,Ee=de.length,Se,ze;for(cM(xt),T&&clearTimeout(T),T=setTimeout(function(){T=null},D),Se=0;Se<Ee;++Se)ze=de[Se],Wt.touch0&&Wt.touch0[2]===ze.identifier?delete Wt.touch0:Wt.touch1&&Wt.touch1[2]===ze.identifier&&delete Wt.touch1;if(Wt.touch1&&!Wt.touch0&&(Wt.touch0=Wt.touch1,delete Wt.touch1),Wt.touch0)Wt.touch0[1]=this.__zoom.invert(Wt.touch0[0]);else if(Wt.end(),Wt.taps===2&&(ze=pa(ze,this),Math.hypot(E[0]-ze[0],E[1]-ze[1])<U)){var ke=lo(this).on("dblclick.zoom");ke&&ke.apply(this,arguments)}}}return H.wheelDelta=function(xt){return arguments.length?(i=typeof xt=="function"?xt:s4(+xt),H):i},H.filter=function(xt){return arguments.length?(e=typeof xt=="function"?xt:s4(!!xt),H):e},H.touchable=function(xt){return arguments.length?(s=typeof xt=="function"?xt:s4(!!xt),H):s},H.extent=function(xt){return arguments.length?(t=typeof xt=="function"?xt:s4([[+xt[0][0],+xt[0][1]],[+xt[1][0],+xt[1][1]]]),H):t},H.scaleExtent=function(xt){return arguments.length?(n[0]=+xt[0],n[1]=+xt[1],H):[n[0],n[1]]},H.translateExtent=function(xt){return arguments.length?(o[0][0]=+xt[0][0],o[1][0]=+xt[1][0],o[0][1]=+xt[0][1],o[1][1]=+xt[1][1],H):[[o[0][0],o[0][1]],[o[1][0],o[1][1]]]},H.constrain=function(xt){return arguments.length?(r=xt,H):r},H.duration=function(xt){return arguments.length?(c=+xt,H):c},H.interpolate=function(xt){return arguments.length?(f=xt,H):f},H.on=function(){var xt=p.on.apply(p,arguments);return xt===p?H:xt},H.clickDistance=function(xt){return arguments.length?(z=(xt=+xt)*xt,H):Math.sqrt(z)},H.tapDistance=function(xt){return arguments.length?(U=+xt,H):U},H}var U9={};sl(U9,{legend:()=>z9,swatches:()=>B3t});function k3t(e,{title:t,tickSize:r=6,width:i=320,height:s=44+r,marginTop:n=18,marginRight:o=0,marginBottom:c=16+r,marginLeft:f=0,ticks:p=i/64,tickFormat:x,tickValues:E}={}){function T(U,H=256){let G=document.createElement("canvas");G.width=H,G.height=1;let Z=G.getContext("2d");for(let Y=0;Y<H;++Y)Z.fillStyle=U(Y/(H-1)),Z.fillRect(Y,0,1,1);return G}let D=d3.create("svg").attr("width",i).attr("height",s).attr("viewBox",[0,0,i,s]).style("overflow","visible").style("display","block"),N=U=>U.selectAll(".tick line").attr("y1",n+c-s),z;if(e.interpolate){let U=Math.min(e.domain().length,e.range().length);z=e.copy().rangeRound(d3.quantize(d3.interpolate(f,i-o),U)),D.append("image").attr("x",f).attr("y",n).attr("width",i-f-o).attr("height",s-n-c).attr("preserveAspectRatio","none").attr("xlink:href",T(e.copy().domain(d3.quantize(d3.interpolate(0,1),U))).toDataURL())}else if(e.interpolator){if(z=Object.assign(e.copy().interpolator(d3.interpolateRound(f,i-o)),{range(){return[f,i-o]}}),D.append("image").attr("x",f).attr("y",n).attr("width",i-f-o).attr("height",s-n-c).attr("preserveAspectRatio","none").attr("xlink:href",T(e.interpolator()).toDataURL()),!z.ticks){if(E===void 0){let U=Math.round(p+1);E=d3.range(U).map(H=>d3.quantile(e.domain(),H/(U-1)))}typeof x!="function"&&(x=d3.format(x===void 0?",f":x))}}else if(e.invertExtent){let U=e.thresholds?e.thresholds():e.quantiles?e.quantiles():e.domain(),H=x===void 0?G=>G:typeof x=="string"?d3.format(x):x;z=d3.scaleLinear().domain([-1,e.range().length-1]).rangeRound([f,i-o]),D.append("g").selectAll("rect").data(e.range()).join("rect").attr("x",(G,Z)=>z(Z-1)).attr("y",n).attr("width",(G,Z)=>z(Z)-z(Z-1)).attr("height",s-n-c).attr("fill",G=>G),E=d3.range(U.length),x=G=>H(U[G],G)}else z=d3.scaleBand().domain(e.domain()).rangeRound([f,i-o]),D.append("g").selectAll("rect").data(e.domain()).join("rect").attr("x",z).attr("y",n).attr("width",Math.max(0,z.bandwidth()-1)).attr("height",s-n-c).attr("fill",e),N=()=>{};return D.append("g").attr("transform",`translate(0,${s-c})`).call(d3.axisBottom(z).ticks(p,typeof x=="string"?x:void 0).tickFormat(typeof x=="function"?x:void 0).tickSize(r).tickValues(E)).call(N).call(U=>U.select(".domain").remove()).call(U=>U.append("text").attr("x",f).attr("y",n+c-s-6).attr("fill","currentColor").attr("text-anchor","start").attr("font-weight","bold").attr("class","title").text(t)),D.node()}function z9({color:e,...t}){return k3t(e,t)}function D3t(e,{columns:t=null,format:r,unknown:i,swatchSize:s=15,swatchWidth:n=s,swatchHeight:o=s,marginLeft:c=0}={}){let f=`-swatches-${Math.random().toString(16).slice(2)}`,p=i==null?void 0:e.unknown(),x=p==null||p===d3.scaleImplicit?[]:[p],E=e.domain().concat(x);r===void 0&&(r=D=>D===p?i:D);function T(D){return`&#${D.charCodeAt(0).toString()};`}return t!==null?htl.html`<div style="display: flex; align-items: center; margin-left: ${+c}px; min-height: 33px; font: 10px sans-serif;">
  <style>

.${f}-item {
  break-inside: avoid;
  display: flex;
  align-items: center;
  padding-bottom: 1px;
}

.${f}-label {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  max-width: calc(100% - ${+n}px - 0.5em);
}

.${f}-swatch {
  width: ${+n}px;
  height: ${+o}px;
  margin: 0 0.5em 0 0;
}

  </style>
  <div style=${{width:"100%",columns:t}}>${E.map(D=>{let N=`${r(D)}`;return htl.html`<div class=${f}-item>
      <div class=${f}-swatch style=${{background:e(D)}}></div>
      <div class=${f}-label title=${N}>${N}</div>
    </div>`})}
  </div>
</div>`:htl.html`<div style="display: flex; align-items: center; min-height: 33px; margin-left: ${+c}px; font: 10px sans-serif;">
  <style>

.${f} {
  display: inline-flex;
  align-items: center;
  margin-right: 1em;
}

.${f}::before {
  content: "";
  width: ${+n}px;
  height: ${+o}px;
  margin-right: 0.5em;
  background: var(--color);
}

  </style>
  <div>${E.map(D=>htl.html`<span class="${f}" style="--color: ${e(D)}">${r(D)}</span>`)}</div>`}function B3t({color:e,...t}){return D3t(e,t)}var JF={};sl(JF,{addAggregateFunction:()=>elt,addFunction:()=>ilt,addPackage:()=>m6t,addTableMethod:()=>KF,addVerb:()=>nlt,addWindowFunction:()=>rlt,agg:()=>GF,all:()=>uu,bin:()=>qat,desc:()=>fC,endswith:()=>ast,escape:()=>Yat,field:()=>fu,frac:()=>Xat,from:()=>IT,fromArrow:()=>AC,fromCSV:()=>wT,fromFixed:()=>yC,fromJSON:()=>xC,internal:()=>g6t,load:()=>rb,loadArrow:()=>MC,loadCSV:()=>$at,loadFixed:()=>Hat,loadJSON:()=>Wat,matches:()=>Vx,names:()=>Zat,not:()=>Ux,op:()=>wp,query:()=>Dot,queryFrom:()=>Bot,range:()=>Q8,rolling:()=>Yx,seed:()=>urt,startswith:()=>ost,table:()=>ZF,toArrow:()=>fT,version:()=>_6t});var oi=Array.isArray;function Vs(e){return e!=null?oi(e)?e:[e]:[]}function Zet(e=0,t=1/0){return`${Xet(e)} < row_number() && row_number() <= ${Xet(t)}`}function Xet(e){return e<0?`count() + ${e}`:e}var e0=class{constructor(t){t&&(this._params=t)}params(t){return arguments.length?(t&&(this._params={...this._params,...t}),this):this._params}reify(t){return this.__reify(this,t)}count(t){return this.__count(this,t)}derive(t,r){return this.__derive(this,t,r)}filter(t){return this.__filter(this,t)}slice(t,r){return this.filter(Zet(t,r)).reify()}groupby(...t){return this.__groupby(this,t.flat())}orderby(...t){return this.__orderby(this,t.flat())}relocate(t,r){return this.__relocate(this,Vs(t),r)}rename(...t){return this.__rename(this,t.flat())}rollup(t){return this.__rollup(this,t)}sample(t,r){return this.__sample(this,t,r)}select(...t){return this.__select(this,t.flat())}ungroup(){return this.__ungroup(this)}unorder(){return this.__unorder(this)}dedupe(...t){return this.__dedupe(this,t.flat())}impute(t,r){return this.__impute(this,t,r)}fold(t,r){return this.__fold(this,t,r)}pivot(t,r,i){return this.__pivot(this,t,r,i)}spread(t,r){return this.__spread(this,t,r)}unroll(t,r){return this.__unroll(this,t,r)}lookup(t,r,...i){return this.__lookup(this,t,r,i.flat())}join(t,r,i,s){return this.__join(this,t,r,i,s)}join_left(t,r,i,s){let n={...s,left:!0,right:!1};return this.__join(this,t,r,i,n)}join_right(t,r,i,s){let n={...s,left:!1,right:!0};return this.__join(this,t,r,i,n)}join_full(t,r,i,s){let n={...s,left:!0,right:!0};return this.__join(this,t,r,i,n)}cross(t,r,i){return this.__cross(this,t,r,i)}semijoin(t,r){return this.__semijoin(this,t,r)}antijoin(t,r){return this.__antijoin(this,t,r)}concat(...t){return this.__concat(this,t.flat())}union(...t){return this.__union(this,t.flat())}intersect(...t){return this.__intersect(this,t.flat())}except(...t){return this.__except(this,t.flat())}};function nr(e){throw Error(e)}function js(e){return typeof e=="number"}function Ni(e){return typeof e=="function"}function Ku(e,t){let r=Array(e);if(Ni(t))for(let i=0;i<e;++i)r[i]=t(i);else r.fill(t);return r}var G1=class extends e0{constructor(t,r,i,s,n,o,c){super(c),this._names=Object.freeze(t),this._data=i,this._total=r,this._nrows=s?s.count():r,this._mask=r!==this._nrows&&s||null,this._group=n||null,this._order=o||null}create(t){nr("Not implemented")}get[Symbol.toStringTag](){if(!this._names)return"Object";let t=this.numRows()+" row"+(this.numRows()!==1?"s":"");return`Table: ${this.numCols()+" col"+(this.numCols()!==1?"s":"")} x ${t}`+(this.isFiltered()?` (${this.totalRows()} backing)`:"")+(this.isGrouped()?`, ${this._group.size} groups`:"")+(this.isOrdered()?", ordered":"")}isFiltered(){return!!this._mask}isGrouped(){return!!this._group}isOrdered(){return!!this._order}data(){return this._data}mask(){return this._mask}groups(){return this._group}comparator(){return this._order}totalRows(){return this._total}numRows(){return this._nrows}get size(){return this._nrows}numCols(){return this._names.length}columnNames(t){return t?this._names.filter(t):this._names.slice()}columnName(t){return this._names[t]}columnIndex(t){return this._names.indexOf(t)}columnArray(t,r){return this.array(t,r)}array(t,r){nr("Not implemented")}*values(t){let r=this.getter(t),i=this.numRows();for(let s=0;s<i;++s)yield r(s)}get(t,r=0){nr("Not implemented")}getter(t){nr("Not implemented")}objects(t){nr("Not implemented")}object(t){nr("Not implemented")}[Symbol.iterator](){nr("Not implemented")}print(t={}){js(t)?t={limit:t}:t.limit==null&&(t.limit=10);let r=this.objects({...t,grouped:!1}),i=`${this[Symbol.toStringTag]}. Showing ${r.length} rows.`;return console.log(i),console.table(r),this}indices(t=!0){if(this._index)return this._index;let r=this.numRows(),i=new Uint32Array(r),s=this.isOrdered(),n=this.mask(),o=-1;if(n)for(let c=n.next(0);c>=0;c=n.next(c+1))i[++o]=c;else for(let c=0;c<r;++c)i[++o]=c;if(t&&s){let c=this._order,f=this._data;i.sort((p,x)=>c(p,x,f))}return(t||!s)&&(this._index=i),i}partitions(t=!0){if(this._partitions)return this._partitions;if(!this.isGrouped())return[this.indices(t)];let{keys:r,size:i}=this._group,s=Ku(i,()=>[]),n=this._index,o=this.mask(),c=this.numRows();if(n&&this.isOrdered())for(let f=0,p;f<c;++f)p=n[f],s[r[p]].push(p);else if(o)for(let f=o.next(0);f>=0;f=o.next(f+1))s[r[f]].push(f);else for(let f=0;f<c;++f)s[r[f]].push(f);if(t&&!n&&this.isOrdered()){let f=this._order,p=this._data;for(let x=0;x<i;++x)s[x].sort((E,T)=>f(E,T,p))}return(t||!this.isOrdered())&&(this._partitions=s),s}scan(t,r,i=1/0,s=0){let n=this._mask,o=this._nrows,c=this._data,f=s||0;if(f>o)return;let p=Math.min(o,f+i),x=()=>f=this._total;if(r&&this.isOrdered()||n&&this._index){let E=this.indices(),T=this._data;for(;f<p;++f)t(E[f],T,x)}else if(n){let E=p-f+1;for(f=n.nth(f);--E&&f>-1;f=n.next(f+1))t(f,c,x)}else for(;f<p;++f)t(f,c,x)}slice(t=0,r=1/0){if(this.isGrouped())return super.slice(t,r);let i=[],s=this.numRows();return t=Math.max(0,t+(t<0?s:0)),r=Math.min(s,Math.max(0,r+(r<0?s:0))),this.scan(n=>i.push(n),!0,r-t,t),this.reify(i)}reduce(t){return this.__reduce(this,t)}};var uM=class{constructor(t){this.data=t}get length(){return this.data.length}get(t){return this.data[t]}[Symbol.iterator](){return this.data[Symbol.iterator]()}},hM=function(e){return e&&Ni(e.get)?e:new uM(e)};function Get(e){return arguments.length?hM=e:hM}function za(e){return e instanceof Date}function As(e){return e===Object(e)}function Q1(e){return e instanceof RegExp}function On(e){return typeof e=="string"}function Ket(e,t){let r=i=>nr(`Illegal argument type: ${i||typeof e}`);return e instanceof Map?Qet(e.entries(),t):za(e)?r("Date"):Q1(e)?r("RegExp"):On(e)?r():oi(e)?O3t(e,t):Ni(e[Symbol.iterator])?N3t(e,t):As(e)?Qet(Object.entries(e),t):r()}function Qet(e,t=["key","value"]){let r=[],i=[];for(let[n,o]of e)r.push(n),i.push(o);let s={};return t[0]&&(s[t[0]]=r),t[1]&&(s[t[1]]=i),s}function O3t(e,t){let r=e.length,i={},s=n=>i[n]=Array(r);if(r){t=t||Object.keys(e[0]);let n=t.map(s),o=n.length;for(let c=0;c<r;++c){let f=e[c];for(let p=0;p<o;++p)n[p][c]=f[t[p]]}}else t&&t.forEach(s);return i}function N3t(e,t){let r={},i=o=>r[o]=[],s,n;for(let o of e){s||(t=t||Object.keys(o),s=t.map(i),n=s.length);for(let c=0;c<n;++c)s[c].push(o[t[c]])}return!s&&t&&t.forEach(i),r}var{hasOwnProperty:F3t}=Object.prototype;function ya(e,t){return F3t.call(e,t)}function ms(e){return e?new fM({...e.data()},e.columnNames()):new fM}var fM=class{constructor(t,r){this.data=t||{},this.names=r||[]}add(t,r){return this.has(t)||this.names.push(t+""),this.data[t]=r}has(t){return ya(this.data,t)}new(){return this.filter=null,this.groups=this.groups||null,this.order=null,this}groupby(t){return this.groups=t,this}};var ji=void 0;var L3t=Object.getPrototypeOf(Int8Array);function bp(e){return e instanceof L3t}function Jc(e){return oi(e)||bp(e)}function Ua(e){return e!=null&&e===e}var o4=e=>Jc(e)||On(e),Jet={compact:e=>Jc(e)?e.filter(t=>Ua(t)):e,concat:(...e)=>[].concat(...e),includes:(e,t,r)=>o4(e)?e.includes(t,r):!1,indexof:(e,t)=>o4(e)?e.indexOf(t):-1,join:(e,t)=>Jc(e)?e.join(t):ji,lastindexof:(e,t)=>o4(e)?e.lastIndexOf(t):-1,length:e=>o4(e)?e.length:0,pluck:(e,t)=>Jc(e)?e.map(r=>Ua(r)?r[t]:ji):ji,reverse:e=>Jc(e)?e.slice().reverse():On(e)?e.split("").reverse().join(""):ji,slice:(e,t,r)=>o4(e)?e.slice(t,r):ji};function trt(e,t,r,i,s){return e==null?null:e<t?-1/0:e>r?1/0:(e=Math.max(t,Math.min(e,r)),t+i*Math.floor(1e-14+(e-t)/i+(s||0)))}function a4(e,t,r="0"){let i=e+"",s=i.length;return s<t?Array(t-s+1).join(r)+i:i}var vp=e=>(e<10?"0":"")+e,z3t=e=>e<0?"-"+a4(-e,6):e>9999?"+"+a4(e,6):a4(e,4);function ert(e,t,r,i,s,n,o,c,f){let p=c?"Z":"";return z3t(e)+"-"+vp(t+1)+"-"+vp(r)+(!f||o?"T"+vp(i)+":"+vp(s)+":"+vp(n)+"."+a4(o,3)+p:n?"T"+vp(i)+":"+vp(s)+":"+vp(n)+p:s||i||!c?"T"+vp(i)+":"+vp(s)+p:"")}function pM(e,t){return isNaN(e)?"Invalid Date":ert(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds(),!1,t)}function sm(e,t){return isNaN(e)?"Invalid Date":ert(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds(),!0,t)}var U3t=/^([-+]\d{2})?\d{4}(-\d{2}(-\d{2})?)?(T\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/;function K2(e){return e.match(U3t)&&!isNaN(Date.parse(e))}function rrt(e,t=Date.parse){return K2(e)?t(e):e}var irt=6e4,nrt=864e5,srt=6048e5,uo=new Date,ho=new Date,Mo=e=>(uo.setTime(typeof e=="string"?rrt(e):e),uo);function V3t(e,t,r,i,s,n,o){return arguments.length?new Date(e,t||0,r??1,i||0,s||0,n||0,o||0):new Date(Date.now())}function j3t(e,t,r,i,s,n,o){return arguments.length?new Date(Date.UTC(e,t||0,r??1,i||0,s||0,n||0,o||0)):new Date(Date.now())}function $3t(e){ho.setTime(+e),ho.setHours(0,0,0,0),uo.setTime(+ho),uo.setMonth(0),uo.setDate(1);let t=(ho.getTimezoneOffset()-uo.getTimezoneOffset())*irt;return Math.floor(1+(ho-uo-t)/nrt)}function H3t(e){ho.setTime(+e),ho.setUTCHours(0,0,0,0);let t=Date.UTC(ho.getUTCFullYear(),0,1);return Math.floor(1+(ho-t)/nrt)}function W3t(e,t){let r=t||0;ho.setTime(+e),ho.setDate(ho.getDate()-(ho.getDay()+7-r)%7),ho.setHours(0,0,0,0),uo.setTime(+e),uo.setMonth(0),uo.setDate(1),uo.setDate(1-(uo.getDay()+7-r)%7),uo.setHours(0,0,0,0);let i=(ho.getTimezoneOffset()-uo.getTimezoneOffset())*irt;return Math.floor((1+(ho-uo)-i)/srt)}function q3t(e,t){let r=t||0;return ho.setTime(+e),ho.setUTCDate(ho.getUTCDate()-(ho.getUTCDay()+7-r)%7),ho.setUTCHours(0,0,0,0),uo.setTime(+e),uo.setUTCMonth(0),uo.setUTCDate(1),uo.setUTCDate(1-(uo.getUTCDay()+7-r)%7),uo.setUTCHours(0,0,0,0),Math.floor((1+(ho-uo))/srt)}var ort={format_date:(e,t)=>pM(Mo(e),!t),format_utcdate:(e,t)=>sm(Mo(e),!t),timestamp:e=>+Mo(e),year:e=>Mo(e).getFullYear(),quarter:e=>Math.floor(Mo(e).getMonth()/3),month:e=>Mo(e).getMonth(),date:e=>Mo(e).getDate(),dayofweek:e=>Mo(e).getDay(),hours:e=>Mo(e).getHours(),minutes:e=>Mo(e).getMinutes(),seconds:e=>Mo(e).getSeconds(),milliseconds:e=>Mo(e).getMilliseconds(),utcyear:e=>Mo(e).getUTCFullYear(),utcquarter:e=>Math.floor(Mo(e).getUTCMonth()/3),utcmonth:e=>Mo(e).getUTCMonth(),utcdate:e=>Mo(e).getUTCDate(),utcdayofweek:e=>Mo(e).getUTCDay(),utchours:e=>Mo(e).getUTCHours(),utcminutes:e=>Mo(e).getUTCMinutes(),utcseconds:e=>Mo(e).getUTCSeconds(),utcmilliseconds:e=>Mo(e).getUTCMilliseconds(),datetime:V3t,dayofyear:$3t,week:W3t,utcdatetime:j3t,utcdayofyear:H3t,utcweek:q3t,now:Date.now};function l4(e,t){return e==null||t==null||e!==e||t!==t?!1:e===t?!0:za(e)||za(t)?+e==+t:Q1(e)&&Q1(t)?e+""==t+"":As(e)&&As(t)?Y3t(e,t):!1}function Y3t(e,t){if(Object.getPrototypeOf(e)!==Object.getPrototypeOf(t))return!1;if(e.length||t.length)return art(e,t);let r=Object.keys(e),i=Object.keys(t);if(r.length!==i.length||(r.sort(),i.sort(),!art(r,i,(n,o)=>n===o)))return!1;let s=r.length;for(let n=0;n<s;++n){let o=r[n];if(!l4(e[o],t[o]))return!1}return!0}function art(e,t,r=l4){let i=e.length;if(i!==t.length)return!1;for(let s=0;s<i;++s)if(!r(e[s],t[s]))return!1;return!0}var lrt={parse_json:e=>JSON.parse(e),to_json:e=>JSON.stringify(e)};var crt=Math.random;function r0(){return crt()}function urt(e){crt=Ua(e)&&isFinite(e=+e)?X3t(e):Math.random}function X3t(e){let i=23283064365386963e-26;return e=(0<=e&&e<1?e/i:Math.abs(e))|0,()=>(e=1664525*e+1013904223|0,i*(e>>>0))}var hrt={random:r0,is_nan:Number.isNaN,is_finite:Number.isFinite,abs:Math.abs,cbrt:Math.cbrt,ceil:Math.ceil,clz32:Math.clz32,exp:Math.exp,expm1:Math.expm1,floor:Math.floor,fround:Math.fround,greatest:Math.max,least:Math.min,log:Math.log,log10:Math.log10,log1p:Math.log1p,log2:Math.log2,pow:Math.pow,round:Math.round,sign:Math.sign,sqrt:Math.sqrt,trunc:Math.trunc,degrees:e=>180*e/Math.PI,radians:e=>Math.PI*e/180,acos:Math.acos,acosh:Math.acosh,asin:Math.asin,asinh:Math.asinh,atan:Math.atan,atan2:Math.atan2,atanh:Math.atanh,cos:Math.cos,cosh:Math.cosh,sin:Math.sin,sinh:Math.sinh,tan:Math.tan,tanh:Math.tanh};function J2(e){return e instanceof Map}function frt(e){return e instanceof Set}function tx(e){return J2(e)||frt(e)}function V9(e){return Array.from(e)}var prt={has:(e,t)=>tx(e)?e.has(t):e!=null?ya(e,t):!1,keys:e=>J2(e)?V9(e.keys()):e!=null?Object.keys(e):[],values:e=>tx(e)?V9(e.values()):e!=null?Object.values(e):[],entries:e=>tx(e)?V9(e.entries()):e!=null?Object.entries(e):[],object:e=>e?Object.fromEntries(e):ji};function drt(e,t,r){if(t instanceof Map){if(t.has(e))return t.get(e)}else if(ya(t,e))return t[e];return r!==void 0?r:e}function dM(e,t,r){let i=arguments.length;e=+e,t=+t,r=i<2?(t=e,e=0,1):i<3?1:+r,i=Math.max(0,Math.ceil((t-e)/r))|0;let s=new Array(i);for(let n=0;n<i;++n)s[n]=e+n*r;return s}var Art={parse_date:e=>e==null?e:new Date(e),parse_float:e=>e==null?e:Number.parseFloat(e),parse_int:(e,t)=>e==null?e:Number.parseInt(e,t),endswith:(e,t,r)=>e==null?!1:String(e).endsWith(t,r),match:(e,t,r)=>{let i=e==null?e:String(e).match(t);return r==null||i==null?i:typeof r=="number"?i[r]:i.groups?i.groups[r]:null},normalize:(e,t)=>e==null?e:String(e).normalize(t),padend:(e,t,r)=>e==null?e:String(e).padEnd(t,r),padstart:(e,t,r)=>e==null?e:String(e).padStart(t,r),upper:e=>e==null?e:String(e).toUpperCase(),lower:e=>e==null?e:String(e).toLowerCase(),repeat:(e,t)=>e==null?e:String(e).repeat(t),replace:(e,t,r)=>e==null?e:String(e).replace(t,String(r)),substring:(e,t,r)=>e==null?e:String(e).substring(t,r),split:(e,t,r)=>e==null?[]:String(e).split(t,r),startswith:(e,t,r)=>e==null?!1:String(e).startsWith(t,r),trim:e=>e==null?e:String(e).trim()};var tu={bin:trt,equal:l4,recode:drt,sequence:dM,...Jet,...ort,...lrt,...hrt,...prt,...Art};function i0(e){return typeof e=="bigint"}function Ds(e){return e===void 0?e+"":i0(e)?e+"n":JSON.stringify(e)}function Pi(e,t=[],r=[]){return new j9(e,Vs(t),Vs(r))}var j9=class{constructor(t,r,i){this.name=t,this.fields=r,this.params=i}toString(){let t=[...this.fields.map(r=>`d[${Ds(r)}]`),...this.params.map(Ds)];return`d => op.${this.name}(${t})`}toObject(){return{expr:this.toString(),func:!0}}};var $9=e=>Pi("any",e),H9=()=>Pi("count"),W9=e=>Pi("array_agg",e),q9=e=>Pi("array_agg_distinct",e),Y9=(e,t)=>Pi("map_agg",[e,t]),X9=(e,t)=>Pi("object_agg",[e,t]),Z9=(e,t)=>Pi("entries_agg",[e,t]),wp={...tu,row_object:(...e)=>Pi("row_object",null,e.flat()),count:H9,any:$9,array_agg:W9,array_agg_distinct:q9,object_agg:X9,map_agg:Y9,entries_agg:Z9,valid:e=>Pi("valid",e),invalid:e=>Pi("invalid",e),distinct:e=>Pi("distinct",e),mode:e=>Pi("mode",e),sum:e=>Pi("sum",e),product:e=>Pi("product",e),mean:e=>Pi("mean",e),average:e=>Pi("average",e),variance:e=>Pi("variance",e),variancep:e=>Pi("variancep",e),stdev:e=>Pi("stdev",e),stdevp:e=>Pi("stdevp",e),min:e=>Pi("min",e),max:e=>Pi("max",e),quantile:(e,t)=>Pi("quantile",e,t),median:e=>Pi("median",e),covariance:(e,t)=>Pi("covariance",[e,t]),covariancep:(e,t)=>Pi("covariancep",[e,t]),corr:(e,t)=>Pi("corr",[e,t]),bins:(e,t,r,i)=>Pi("bins",e,[t,r,i]),row_number:()=>Pi("row_number"),rank:()=>Pi("rank"),avg_rank:()=>Pi("avg_rank"),dense_rank:()=>Pi("dense_rank"),percent_rank:()=>Pi("percent_rank"),cume_dist:()=>Pi("cume_dist"),ntile:e=>Pi("ntile",null,e),lag:(e,t,r)=>Pi("lag",e,[t,r]),lead:(e,t,r)=>Pi("lead",e,[t,r]),first_value:e=>Pi("first_value",e),last_value:e=>Pi("last_value",e),nth_value:(e,t)=>Pi("nth_value",e,t),fill_down:(e,t)=>Pi("fill_down",e,t),fill_up:(e,t)=>Pi("fill_up",e,t)};function mrt(e,t){e=tx(e)?e:new Set(e);let r=t,i=0;for(;e.has(r);)r=t+ ++i;return r}function grt(e,t){if(!e||!t)return e;let{keys:r,rows:i,size:s}=e,n=new Int32Array(s);t.scan(x=>n[r[x]]=1);let o=n.reduce((x,E)=>x+E,0);if(o===s)return e;let c=Array(o),f=0;for(let x=0;x<s;++x)n[x]&&(c[n[x]=f++]=i[x]);let p=new Uint32Array(r.length);return t.scan(x=>p[x]=n[r[x]]),{...e,keys:p,rows:c,size:f}}function _rt(e,t,r,i){let{keys:s,rows:n,size:o}=e,c=n,f=o,p=null;if(r){p=new Int32Array(o),t(N=>p[s[N]]=1);let D=p.reduce((N,z)=>N+z,0);if(D!==o){c=Array(D),f=0;for(let N=0;N<o;++N)p[N]&&(c[p[N]=f++]=n[N])}}let x=-1,E=new Uint32Array(i);return t(f!==o?D=>E[++x]=p[s[D]]:D=>E[++x]=s[D]),{...e,keys:E,rows:c,size:f}}function yrt(e,t,r,i){let s=i==="map"||i===!0?Y9:i==="entries"?Z9:i==="object"?X9:nr('groups option must be "map", "entries", or "object".'),{names:n}=e.groups(),o=mrt(e.columnNames(),"_"),c=e.select().reify(t).create({data:{[o]:r}}).rollup({[o]:W9(o)});for(let f=n.length;--f>=0;)c=c.groupby(n.slice(0,f)).rollup({[o]:s(n[f],o)});return c.get(o)}var xrt="ArrayPattern",brt="ArrowFunctionExpression",vrt="FunctionExpression",n0="Identifier",Tp="Literal",G9="MemberExpression",wrt="ObjectExpression",Q9="ObjectPattern",AM="Property",om="Column",Trt="Constant",Srt="Dictionary",Ert="Function",Irt="Parameter",mM="Op";var Ss=(e,t)=>{let r=Z3t[e.type];return r?r(e,t):nr(`Unsupported expression construct: ${e.type}`)},K9=(e,t)=>"("+Ss(e.left,t)+" "+e.operator+" "+Ss(e.right,t)+")",J9=(e,t)=>"("+Sp(e.params,t)+")=>"+Ss(e.body,t),Mrt=(e,t)=>Ss(e.callee,t)+"("+Sp(e.arguments,t)+")",Sp=(e,t,r=",")=>e.map(i=>Ss(i,t)).join(r),Prt=e=>e.computed?`[${Ds(e.name)}]`:`.${e.name}`,Crt=(e,t,r)=>{let i=e.table||"";return`data${i}${Prt(e)}.${r}(${t.index}${i})`},Z3t={Constant:e=>e.raw,Column:(e,t)=>Crt(e,t,"get"),Dictionary:(e,t)=>Crt(e,t,"key"),Function:e=>`fn.${e.name}`,Parameter:e=>`$${Prt(e)}`,Op:(e,t)=>`op(${Ds(e.name)},${t.op||t.index})`,Literal:e=>e.raw,Identifier:e=>e.name,TemplateLiteral:(e,t)=>{let{quasis:r,expressions:i}=e,s=i.length,n=r[0].value.raw;for(let o=0;o<s;)n+="${"+Ss(i[o],t)+"}"+r[++o].value.raw;return"`"+n+"`"},MemberExpression:(e,t)=>{let r=!e.computed,i=Ss(e.object,t),s=Ss(e.property,t);return i+(r?"."+s:"["+s+"]")},CallExpression:Mrt,NewExpression:(e,t)=>"new "+Mrt(e,t),ArrayExpression:(e,t)=>"["+Sp(e.elements,t)+"]",AssignmentExpression:K9,BinaryExpression:K9,LogicalExpression:K9,UnaryExpression:(e,t)=>"("+e.operator+Ss(e.argument,t)+")",ConditionalExpression:(e,t)=>"("+Ss(e.test,t)+"?"+Ss(e.consequent,t)+":"+Ss(e.alternate,t)+")",ObjectExpression:(e,t)=>"({"+Sp(e.properties,t)+"})",Property:(e,t)=>{let r=Ss(e.key,t);return(e.computed?`[${r}]`:r)+":"+Ss(e.value,t)},ArrowFunctionExpression:J9,FunctionExpression:J9,FunctionDeclaration:J9,ArrayPattern:(e,t)=>"["+Sp(e.elements,t)+"]",ObjectPattern:(e,t)=>"{"+Sp(e.properties,t)+"}",VariableDeclaration:(e,t)=>e.kind+" "+Sp(e.declarations,t,","),VariableDeclarator:(e,t)=>Ss(e.id,t)+"="+Ss(e.init,t),SpreadElement:(e,t)=>"..."+Ss(e.argument,t),BlockStatement:(e,t)=>"{"+Sp(e.body,t,";")+";}",BreakStatement:()=>"break",ExpressionStatement:(e,t)=>Ss(e.expression,t),IfStatement:(e,t)=>"if ("+Ss(e.test,t)+")"+Ss(e.consequent,t)+(e.alternate?" else "+Ss(e.alternate,t):""),SwitchStatement:(e,t)=>"switch ("+Ss(e.discriminant,t)+") {"+Sp(e.cases,t,"")+"}",SwitchCase:(e,t)=>(e.test?"case "+Ss(e.test,t):"default")+": "+Sp(e.consequent,t,";")+";",ReturnStatement:(e,t)=>"return "+Ss(e.argument,t),Program:(e,t)=>Ss(e.body[0],t)};function K1(e,t={index:"row"}){return Ss(e,t)}function Rrt(e,t,r=15,i=!0,s=0,n){let c=Math.LN10;if(n==null){let f=Math.ceil(Math.log(r)/c),p=t-e||Math.abs(e)||1,x=[5,2];for(n=Math.max(s,Math.pow(10,Math.round(Math.log(p)/c)-f));Math.ceil(p/n)>r;)n*=10;let E=x.length;for(let T=0;T<E;++T){let D=n/x[T];D>=s&&p/D<=r&&(n=D)}}if(i){let f=Math.log(n),p=f>=0?0:~~(-f/c)+1,x=Math.pow(10,-p-1);f=Math.floor(e/n+x)*n,e=e<f?f-n:f,t=Math.ceil(t/n)*n}return[e,t===e?e+n:t,n]}function J1(e){let t=typeof e;return t==="string"?`"${e}"`:t!=="object"||!e?e:za(e)?+e:oi(e)||bp(e)?`[${e.map(J1)}]`:Q1(e)?e+"":G3t(e)}function G3t(e){let t="{",r=-1;for(let i in e)++r>0&&(t+=","),t+=`"${i}":${J1(e[i])}`;return t+="}",t}function t_(e,t){let r=e.length;return r===1?(i,s)=>J1(e[0](i,s)):(i,s)=>{let n="";for(let o=0;o<r;++o){o>0&&(n+="|");let c=e[o](i,s);if(t&&(c==null||c!==c))return null;n+=J1(c)}return n}}function krt(){let e=new Map;return{count(){return e.size},values(){return Array.from(e.values(),t=>t.v)},increment(t){let r=J1(t),i=e.get(r);i?++i.n:e.set(r,{v:t,n:1})},decrement(t){let r=J1(t),i=e.get(r);i.n===1?e.delete(r):--i.n},forEach(t){e.forEach(({v:r,n:i})=>t(r,i))}}}function sf(){}function Drt(e,t=0,r=e.length){let i=e[t++];for(let s=t;s<r;++s)i*=e[s];return i}function Zo(e){return e.init=e.init||sf,e.add=e.add||sf,e.rem=e.rem||sf,e}function Brt(e,t){return e.product_v=!1,e.product=t}var ex={count:{create:()=>Zo({value:e=>e.count}),param:[]},array_agg:{create:()=>Zo({init:e=>e.values=!0,value:e=>e.list.values(e.stream)}),param:[1]},object_agg:{create:()=>Zo({init:e=>e.values=!0,value:e=>Object.fromEntries(e.list.values())}),param:[2]},map_agg:{create:()=>Zo({init:e=>e.values=!0,value:e=>new Map(e.list.values())}),param:[2]},entries_agg:{create:()=>Zo({init:e=>e.values=!0,value:e=>e.list.values(e.stream)}),param:[2]},any:{create:()=>Zo({add:(e,t)=>{e.any==null&&(e.any=t)},value:e=>e.valid?e.any:ji}),param:[1]},valid:{create:()=>Zo({value:e=>e.valid}),param:[1]},invalid:{create:()=>Zo({value:e=>e.count-e.valid}),param:[1]},distinct:{create:()=>({init:e=>e.distinct=krt(),value:e=>e.distinct.count()+(e.valid===e.count?0:1),add:(e,t)=>e.distinct.increment(t),rem:(e,t)=>e.distinct.decrement(t)}),param:[1]},array_agg_distinct:{create:()=>Zo({value:e=>e.distinct.values()}),param:[1],req:["distinct"]},mode:{create:()=>Zo({value:e=>{let t=ji,r=0;return e.distinct.forEach((i,s)=>{s>r&&(r=s,t=i)}),t}}),param:[1],req:["distinct"]},sum:{create:()=>({init:e=>e.sum=0,value:e=>e.valid?e.sum:ji,add:(e,t)=>i0(t)?e.sum===0?e.sum=t:e.sum+=t:e.sum+=+t,rem:(e,t)=>e.sum-=t}),param:[1]},product:{create:()=>({init:e=>Brt(e,1),value:e=>e.valid?e.product_v?Brt(e,Drt(e.list.values())):e.product:void 0,add:(e,t)=>i0(t)&&e.product===1?e.product=t:e.product*=t,rem:(e,t)=>t==0||t===1/0||t===-1/0?e.product_v=!0:e.product/=t}),param:[1],stream:["array_agg"]},mean:{create:()=>({init:e=>e.mean=0,value:e=>e.valid?e.mean:ji,add:(e,t)=>{e.mean_d=t-e.mean,e.mean+=e.mean_d/e.valid},rem:(e,t)=>{e.mean_d=t-e.mean,e.mean-=e.valid?e.mean_d/e.valid:e.mean}}),param:[1]},average:{create:()=>Zo({value:e=>e.valid?e.mean:ji}),param:[1],req:["mean"]},variance:{create:()=>({init:e=>e.dev=0,value:e=>e.valid>1?e.dev/(e.valid-1):ji,add:(e,t)=>e.dev+=e.mean_d*(t-e.mean),rem:(e,t)=>e.dev-=e.mean_d*(t-e.mean)}),param:[1],req:["mean"]},variancep:{create:()=>Zo({value:e=>e.valid>1?e.dev/e.valid:ji}),param:[1],req:["variance"]},stdev:{create:()=>Zo({value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid-1)):ji}),param:[1],req:["variance"]},stdevp:{create:()=>Zo({value:e=>e.valid>1?Math.sqrt(e.dev/e.valid):ji}),param:[1],req:["variance"]},min:{create:()=>({init:e=>e.min=ji,value:e=>e.min=Number.isNaN(e.min)?e.list.min():e.min,add:(e,t)=>{(t<e.min||e.min===ji)&&(e.min=t)},rem:(e,t)=>{t<=e.min&&(e.min=NaN)}}),param:[1],stream:["array_agg"]},max:{create:()=>({init:e=>e.max=ji,value:e=>e.max=Number.isNaN(e.max)?e.list.max():e.max,add:(e,t)=>{(t>e.max||e.max===ji)&&(e.max=t)},rem:(e,t)=>{t>=e.max&&(e.max=NaN)}}),param:[1],stream:["array_agg"]},quantile:{create:e=>Zo({value:t=>t.list.quantile(e)}),param:[1,1],req:["array_agg"]},median:{create:()=>Zo({value:e=>e.list.quantile(.5)}),param:[1],req:["array_agg"]},covariance:{create:()=>({init:e=>{e.cov=e.mean_x=e.mean_y=e.dev_x=e.dev_y=0},value:e=>e.valid>1?e.cov/(e.valid-1):ji,add:(e,t,r)=>{let i=t-e.mean_x,s=r-e.mean_y;e.mean_x+=i/e.valid,e.mean_y+=s/e.valid;let n=r-e.mean_y;e.dev_x+=i*(t-e.mean_x),e.dev_y+=s*n,e.cov+=i*n},rem:(e,t,r)=>{let i=t-e.mean_x,s=r-e.mean_y;e.mean_x-=e.valid?i/e.valid:e.mean_x,e.mean_y-=e.valid?s/e.valid:e.mean_y;let n=r-e.mean_y;e.dev_x-=i*(t-e.mean_x),e.dev_y-=s*n,e.cov-=i*n}}),param:[2]},covariancep:{create:()=>Zo({value:e=>e.valid>1?e.cov/e.valid:ji}),param:[2],req:["covariance"]},corr:{create:()=>Zo({value:e=>e.valid>1?e.cov/(Math.sqrt(e.dev_x)*Math.sqrt(e.dev_y)):ji}),param:[2],req:["covariance"]},bins:{create:(e,t,r,i)=>Zo({value:s=>Rrt(s.min,s.max,e,t,r,i)}),param:[1,4],req:["min","max"]}};var Ort={create(){let e;return{init:()=>e=1,value:t=>{let r=t.index;return r&&!t.peer(r)?e=r+1:e}}},param:[]},Nrt={create(){let e;return{init:()=>e=0,value:t=>{let{index:r,peer:i,size:s}=t,n=r;if(e<n){for(;n+1<s&&i(n+1);)++n;e=n}return(1+e)/s}}},param:[]},rx={row_number:{create(){return{init:sf,value:e=>e.index+1}},param:[]},rank:Ort,avg_rank:{create(){let e,t;return{init:()=>(e=-1,t=1),value:r=>{let i=r.index;if(i>=e){for(t=e=i+1;r.peer(e);t+=++e);t/=e-i}return t}}},param:[]},dense_rank:{create(){let e;return{init:()=>e=1,value:t=>{let r=t.index;return r&&!t.peer(r)?++e:e}}},param:[]},percent_rank:{create(){let{init:e,value:t}=Ort.create();return{init:e,value:r=>(t(r)-1)/(r.size-1)}},param:[]},cume_dist:Nrt,ntile:{create(e){e=+e,e>0||nr("ntile num must be greater than zero.");let{init:t,value:r}=Nrt.create();return{init:t,value:i=>Math.ceil(e*r(i))}},param:[0,1]},lag:{create(e,t=ji){return e=+e||1,{init:sf,value:(r,i)=>{let s=r.index-e;return s>=0?r.value(s,i):t}}},param:[1,2]},lead:{create(e,t=ji){return e=+e||1,{init:sf,value:(r,i)=>{let s=r.index+e;return s<r.size?r.value(s,i):t}}},param:[1,2]},first_value:{create(){return{init:sf,value:(e,t)=>e.value(e.i0,t)}},param:[1]},last_value:{create(){return{init:sf,value:(e,t)=>e.value(e.i1-1,t)}},param:[1]},nth_value:{create(e){return e=+e,e>0||nr("nth_value nth must be greater than zero."),{init:sf,value:(t,r)=>{let i=t.i0+(e-1);return i<t.i1?t.value(i,r):ji}}},param:[1,1]},fill_down:{create(e=ji){let t;return{init:()=>t=e,value:(r,i)=>{let s=r.value(r.index,i);return Ua(s)?t=s:t}}},param:[1,1]},fill_up:{create(e=ji){let t,r;return{init:()=>(t=e,r=-1),value:(i,s)=>i.index<=r?t:(r=Q3t(i,s,i.index))>=0?t=i.value(r,s):(r=i.size,t=e)}},param:[1,1]}};function Q3t(e,t,r){for(let i=e.size;r<i;++r)if(Ua(e.value(r,t)))return r;return-1}function c4(e){return ya(ex,e)}function u4(e){return ya(rx,e)}function tN(e){return ya(tu,e)||e==="row_object"}function gM(e){return c4(e)&&ex[e]}function _M(e){return u4(e)&&rx[e]}function h4(e,t,r){return e=`"use strict"; return ${e};`,Function("fn","$",e)(t,r)}var ix={escape:(e,t,r)=>h4(e,t,r),expr:(e,t)=>h4(`(row,data,op)=>${e}`,tu,t),expr2:(e,t)=>h4(`(row0,data0,row,data)=>${e}`,tu,t),join:(e,t)=>h4(`(row1,data1,row2,data2)=>${e}`,tu,t),param:(e,t)=>h4(e,tu,t)};var K3t={"==":1,"!=":1,"===":1,"!==":1};function yM(e,t,r=0,i,s){if(e.type=om,e.name=t,e.table=r,s&&i&&Ni(i.keyFor)){let n=K3t[s.operator]?s.left===e?s.right:s.left:s.callee&&s.callee.name==="equal"?s.arguments[s.arguments[0]===e?1:0]:null;n&&n.type===Tp&&J3t(s,e,n,i.keyFor(n.value))}return e}function J3t(e,t,r,i){return i<0?(e.type=Tp,e.value=!1,e.raw="false"):(t.type=Srt,r.value=i,r.raw=i+""),!0}function am(e){return oi(e)?e:J2(e)?e.entries():e?Object.entries(e):[]}var nx="row_object";function eN(e,t){e.type=wrt;let r=e.properties=[];for(let i of am(t)){let[s,n]=oi(i)?i:[i,i];r.push({type:AM,key:{type:Tp,raw:Ds(n)},value:yM({computed:!0},s)})}return e}function rN(e){return K1(eN({},e))}function iN(e){return ix.expr(rN(e))}function Lrt(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(r[i[s]]=e[i[s]]);return r}function gr(e,t,r,i){function s(n){return n instanceof r?n:new r(function(o){o(n)})}return new(r||(r=Promise))(function(n,o){function c(x){try{p(i.next(x))}catch(E){o(E)}}function f(x){try{p(i.throw(x))}catch(E){o(E)}}function p(x){x.done?n(x.value):s(x.value).then(c,f)}p((i=i.apply(e,t||[])).next())})}function Frt(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Fi(e){return this instanceof Fi?(this.v=e,this):new Fi(e)}function eu(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(e,t||[]),s,n=[];return s={},c("next"),c("throw"),c("return",o),s[Symbol.asyncIterator]=function(){return this},s;function o(D){return function(N){return Promise.resolve(N).then(D,E)}}function c(D,N){i[D]&&(s[D]=function(z){return new Promise(function(U,H){n.push([D,z,U,H])>1||f(D,z)})},N&&(s[D]=N(s[D])))}function f(D,N){try{p(i[D](N))}catch(z){T(n[0][3],z)}}function p(D){D.value instanceof Fi?Promise.resolve(D.value.v).then(x,E):T(n[0][2],D)}function x(D){f("next",D)}function E(D){f("throw",D)}function T(D,N){D(N),n.shift(),n.length&&f(n[0][0],n[0][1])}}function sx(e){var t,r;return t={},i("next"),i("throw",function(s){throw s}),i("return"),t[Symbol.iterator]=function(){return this},t;function i(s,n){t[s]=e[s]?function(o){return(r=!r)?{value:Fi(e[s](o)),done:!1}:n?n(o):o}:n}}function of(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof Frt=="function"?Frt(e):e[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(n){r[n]=e[n]&&function(o){return new Promise(function(c,f){o=e[n](o),s(c,f,o.done,o.value)})}}function s(n,o,c,f){Promise.resolve(f).then(function(p){n({value:p,done:c})},o)}}var cN={};sl(cN,{compareArrayLike:()=>lN,joinUint8Arrays:()=>iu,memcpy:()=>d4,rebaseValueOffsets:()=>IM,toArrayBufferView:()=>Gi,toArrayBufferViewAsyncIterator:()=>lf,toArrayBufferViewIterator:()=>Ip,toBigInt64Array:()=>EM,toBigUint64Array:()=>l4t,toFloat32Array:()=>c4t,toFloat32ArrayAsyncIterator:()=>S4t,toFloat32ArrayIterator:()=>g4t,toFloat64Array:()=>u4t,toFloat64ArrayAsyncIterator:()=>E4t,toFloat64ArrayIterator:()=>_4t,toInt16Array:()=>s4t,toInt16ArrayAsyncIterator:()=>b4t,toInt16ArrayIterator:()=>p4t,toInt32Array:()=>e_,toInt32ArrayAsyncIterator:()=>v4t,toInt32ArrayIterator:()=>d4t,toInt8Array:()=>n4t,toInt8ArrayAsyncIterator:()=>x4t,toInt8ArrayIterator:()=>f4t,toUint16Array:()=>o4t,toUint16ArrayAsyncIterator:()=>w4t,toUint16ArrayIterator:()=>A4t,toUint32Array:()=>a4t,toUint32ArrayAsyncIterator:()=>T4t,toUint32ArrayIterator:()=>m4t,toUint8Array:()=>ei,toUint8ArrayAsyncIterator:()=>aN,toUint8ArrayIterator:()=>oN,toUint8ClampedArray:()=>h4t,toUint8ClampedArrayAsyncIterator:()=>I4t,toUint8ClampedArrayIterator:()=>y4t});var t4t=new TextDecoder("utf-8"),f4=e=>t4t.decode(e),e4t=new TextEncoder,Ep=e=>e4t.encode(e);var r4t=e=>typeof e=="number",zrt=e=>typeof e=="boolean",Go=e=>typeof e=="function",$l=e=>e!=null&&Object(e)===e,ru=e=>$l(e)&&Go(e.then);var af=e=>$l(e)&&Go(e[Symbol.iterator]),Ju=e=>$l(e)&&Go(e[Symbol.asyncIterator]),xM=e=>$l(e)&&$l(e.schema);var bM=e=>$l(e)&&"done"in e&&"value"in e;var vM=e=>$l(e)&&Go(e.stat)&&r4t(e.fd);var wM=e=>$l(e)&&p4(e.body),TM=e=>"_getDOMStream"in e&&"_getNodeStream"in e,Urt=e=>$l(e)&&Go(e.abort)&&Go(e.getWriter)&&!TM(e),p4=e=>$l(e)&&Go(e.cancel)&&Go(e.getReader)&&!TM(e),Vrt=e=>$l(e)&&Go(e.end)&&Go(e.write)&&zrt(e.writable)&&!TM(e),SM=e=>$l(e)&&Go(e.read)&&Go(e.pipe)&&zrt(e.readable)&&!TM(e),jrt=e=>$l(e)&&Go(e.clear)&&Go(e.bytes)&&Go(e.position)&&Go(e.setPosition)&&Go(e.capacity)&&Go(e.getBufferIdentifier)&&Go(e.createLong);var sN=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:ArrayBuffer;function i4t(e){let t=e[0]?[e[0]]:[],r,i,s,n;for(let o,c,f=0,p=0,x=e.length;++f<x;){if(o=t[p],c=e[f],!o||!c||o.buffer!==c.buffer||c.byteOffset<o.byteOffset){c&&(t[++p]=c);continue}if({byteOffset:r,byteLength:s}=o,{byteOffset:i,byteLength:n}=c,r+s<i||i+n<r){c&&(t[++p]=c);continue}t[p]=new Uint8Array(o.buffer,r,i-r+n)}return t}function d4(e,t,r=0,i=t.byteLength){let s=e.byteLength,n=new Uint8Array(e.buffer,e.byteOffset,s),o=new Uint8Array(t.buffer,t.byteOffset,Math.min(i,s));return n.set(o,r),e}function iu(e,t){let r=i4t(e),i=r.reduce((x,E)=>x+E.byteLength,0),s,n,o,c=0,f=-1,p=Math.min(t||Number.POSITIVE_INFINITY,i);for(let x=r.length;++f<x;){if(s=r[f],n=s.subarray(0,Math.min(s.length,p-c)),p<=c+n.length){n.length<s.length?r[f]=s.subarray(n.length):n.length===s.length&&f++,o?d4(o,n,c):o=n;break}d4(o||(o=new Uint8Array(p)),n,c),c+=n.length}return[o||new Uint8Array(0),r.slice(f),i-(o?o.byteLength:0)]}function Gi(e,t){let r=bM(t)?t.value:t;return r instanceof e?e===Uint8Array?new e(r.buffer,r.byteOffset,r.byteLength):r:r?(typeof r=="string"&&(r=Ep(r)),r instanceof ArrayBuffer?new e(r):r instanceof sN?new e(r):jrt(r)?Gi(e,r.bytes()):ArrayBuffer.isView(r)?r.byteLength<=0?new e(0):new e(r.buffer,r.byteOffset,r.byteLength/e.BYTES_PER_ELEMENT):e.from(r)):new e(0)}var n4t=e=>Gi(Int8Array,e),s4t=e=>Gi(Int16Array,e),e_=e=>Gi(Int32Array,e),EM=e=>Gi(BigInt64Array,e),ei=e=>Gi(Uint8Array,e),o4t=e=>Gi(Uint16Array,e),a4t=e=>Gi(Uint32Array,e),l4t=e=>Gi(BigUint64Array,e),c4t=e=>Gi(Float32Array,e),u4t=e=>Gi(Float64Array,e),h4t=e=>Gi(Uint8ClampedArray,e),nN=e=>(e.next(),e);function*Ip(e,t){let r=function*(s){yield s},i=typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer||t instanceof sN?r(t):af(t)?t:r(t);return yield*nN(function*(s){let n=null;do n=s.next(yield Gi(e,n));while(!n.done)}(i[Symbol.iterator]())),new e}var f4t=e=>Ip(Int8Array,e),p4t=e=>Ip(Int16Array,e),d4t=e=>Ip(Int32Array,e),oN=e=>Ip(Uint8Array,e),A4t=e=>Ip(Uint16Array,e),m4t=e=>Ip(Uint32Array,e),g4t=e=>Ip(Float32Array,e),_4t=e=>Ip(Float64Array,e),y4t=e=>Ip(Uint8ClampedArray,e);function lf(e,t){return eu(this,arguments,function*(){if(ru(t))return yield Fi(yield Fi(yield*sx(of(lf(e,yield Fi(t))))));let i=function(o){return eu(this,arguments,function*(){yield yield Fi(yield Fi(o))})},s=function(o){return eu(this,arguments,function*(){yield Fi(yield*sx(of(nN(function*(c){let f=null;do f=c.next(yield f?.value);while(!f.done)}(o[Symbol.iterator]())))))})},n=typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer||t instanceof sN?i(t):af(t)?s(t):Ju(t)?t:i(t);return yield Fi(yield*sx(of(nN(function(o){return eu(this,arguments,function*(){let c=null;do c=yield Fi(o.next(yield yield Fi(Gi(e,c))));while(!c.done)})}(n[Symbol.asyncIterator]()))))),yield Fi(new e)})}var x4t=e=>lf(Int8Array,e),b4t=e=>lf(Int16Array,e),v4t=e=>lf(Int32Array,e),aN=e=>lf(Uint8Array,e),w4t=e=>lf(Uint16Array,e),T4t=e=>lf(Uint32Array,e),S4t=e=>lf(Float32Array,e),E4t=e=>lf(Float64Array,e),I4t=e=>lf(Uint8ClampedArray,e);function IM(e,t,r){if(e!==0){r=r.slice(0,t);for(let i=-1,s=r.length;++i<s;)r[i]+=e}return r.subarray(0,t)}function lN(e,t){let r=0,i=e.length;if(i!==t.length)return!1;if(i>0)do if(e[r]!==t[r])return!1;while(++r<i);return!0}var Va={fromIterable(e){return MM(M4t(e))},fromAsyncIterable(e){return MM(C4t(e))},fromDOMStream(e){return MM(P4t(e))},fromNodeStream(e){return MM(R4t(e))},toDOMStream(e,t){throw new Error('"toDOMStream" not available in this environment')},toNodeStream(e,t){throw new Error('"toNodeStream" not available in this environment')}},MM=e=>(e.next(),e);function*M4t(e){let t,r=!1,i=[],s,n,o,c=0;function f(){return n==="peek"?iu(i,o)[0]:([s,i,c]=iu(i,o),s)}({cmd:n,size:o}=(yield null)||{cmd:"read",size:0});let p=oN(e)[Symbol.iterator]();try{do if({done:t,value:s}=Number.isNaN(o-c)?p.next():p.next(o-c),!t&&s.byteLength>0&&(i.push(s),c+=s.byteLength),t||o<=c)do({cmd:n,size:o}=yield f());while(o<c);while(!t)}catch(x){(r=!0)&&typeof p.throw=="function"&&p.throw(x)}finally{r===!1&&typeof p.return=="function"&&p.return(null)}return null}function C4t(e){return eu(this,arguments,function*(){let r,i=!1,s=[],n,o,c,f=0;function p(){return o==="peek"?iu(s,c)[0]:([n,s,f]=iu(s,c),n)}({cmd:o,size:c}=(yield yield Fi(null))||{cmd:"read",size:0});let x=aN(e)[Symbol.asyncIterator]();try{do if({done:r,value:n}=Number.isNaN(c-f)?yield Fi(x.next()):yield Fi(x.next(c-f)),!r&&n.byteLength>0&&(s.push(n),f+=n.byteLength),r||c<=f)do({cmd:o,size:c}=yield yield Fi(p()));while(c<f);while(!r)}catch(E){(i=!0)&&typeof x.throw=="function"&&(yield Fi(x.throw(E)))}finally{i===!1&&typeof x.return=="function"&&(yield Fi(x.return(new Uint8Array(0))))}return yield Fi(null)})}function P4t(e){return eu(this,arguments,function*(){let r=!1,i=!1,s=[],n,o,c,f=0;function p(){return o==="peek"?iu(s,c)[0]:([n,s,f]=iu(s,c),n)}({cmd:o,size:c}=(yield yield Fi(null))||{cmd:"read",size:0});let x=new hN(e);try{do if({done:r,value:n}=Number.isNaN(c-f)?yield Fi(x.read()):yield Fi(x.read(c-f)),!r&&n.byteLength>0&&(s.push(ei(n)),f+=n.byteLength),r||c<=f)do({cmd:o,size:c}=yield yield Fi(p()));while(c<f);while(!r)}catch(E){(i=!0)&&(yield Fi(x.cancel(E)))}finally{i===!1?yield Fi(x.cancel()):e.locked&&x.releaseLock()}return yield Fi(null)})}var hN=class{constructor(t){this.source=t,this.reader=null,this.reader=this.source.getReader(),this.reader.closed.catch(()=>{})}get closed(){return this.reader?this.reader.closed.catch(()=>{}):Promise.resolve()}releaseLock(){this.reader&&this.reader.releaseLock(),this.reader=null}cancel(t){return gr(this,void 0,void 0,function*(){let{reader:r,source:i}=this;r&&(yield r.cancel(t).catch(()=>{})),i&&i.locked&&this.releaseLock()})}read(t){return gr(this,void 0,void 0,function*(){if(t===0)return{done:this.reader==null,value:new Uint8Array(0)};let r=yield this.reader.read();return!r.done&&(r.value=ei(r)),r})}},uN=(e,t)=>{let r=s=>i([t,s]),i;return[t,r,new Promise(s=>(i=s)&&e.once(t,r))]};function R4t(e){return eu(this,arguments,function*(){let r=[],i="error",s=!1,n=null,o,c,f=0,p=[],x;function E(){return o==="peek"?iu(p,c)[0]:([x,p,f]=iu(p,c),x)}if({cmd:o,size:c}=(yield yield Fi(null))||{cmd:"read",size:0},e.isTTY)return yield yield Fi(new Uint8Array(0)),yield Fi(null);try{r[0]=uN(e,"end"),r[1]=uN(e,"error");do{if(r[2]=uN(e,"readable"),[i,n]=yield Fi(Promise.race(r.map(D=>D[2]))),i==="error")break;if((s=i==="end")||(Number.isFinite(c-f)?(x=ei(e.read(c-f)),x.byteLength<c-f&&(x=ei(e.read()))):x=ei(e.read()),x.byteLength>0&&(p.push(x),f+=x.byteLength)),s||c<=f)do({cmd:o,size:c}=yield yield Fi(E()));while(c<f)}while(!s)}finally{yield Fi(T(r,i==="error"?n:null))}return yield Fi(null);function T(D,N){return x=p=null,new Promise((z,U)=>{for(let[H,G]of D)e.off(H,G);try{let H=e.destroy;H&&H.call(e,N),N=void 0}catch(H){N=H||N}finally{N!=null?U(N):z()}})}})}var Vn;(function(e){e[e.V1=0]="V1",e[e.V2=1]="V2",e[e.V3=2]="V3",e[e.V4=3]="V4",e[e.V5=4]="V5"})(Vn||(Vn={}));var as;(function(e){e[e.Sparse=0]="Sparse",e[e.Dense=1]="Dense"})(as||(as={}));var ts;(function(e){e[e.HALF=0]="HALF",e[e.SINGLE=1]="SINGLE",e[e.DOUBLE=2]="DOUBLE"})(ts||(ts={}));var Qs;(function(e){e[e.DAY=0]="DAY",e[e.MILLISECOND=1]="MILLISECOND"})(Qs||(Qs={}));var wr;(function(e){e[e.SECOND=0]="SECOND",e[e.MILLISECOND=1]="MILLISECOND",e[e.MICROSECOND=2]="MICROSECOND",e[e.NANOSECOND=3]="NANOSECOND"})(wr||(wr={}));var Co;(function(e){e[e.YEAR_MONTH=0]="YEAR_MONTH",e[e.DAY_TIME=1]="DAY_TIME",e[e.MONTH_DAY_NANO=2]="MONTH_DAY_NANO"})(Co||(Co={}));var Mp=new Int32Array(2),CM=new Float32Array(Mp.buffer),PM=new Float64Array(Mp.buffer),ox=new Uint16Array(new Uint8Array([1,0]).buffer)[0]===1;var A4;(function(e){e[e.UTF8_BYTES=1]="UTF8_BYTES",e[e.UTF16_STRING=2]="UTF16_STRING"})(A4||(A4={}));var nu=class e{constructor(t){this.bytes_=t,this.position_=0,this.text_decoder_=new TextDecoder}static allocate(t){return new e(new Uint8Array(t))}clear(){this.position_=0}bytes(){return this.bytes_}position(){return this.position_}setPosition(t){this.position_=t}capacity(){return this.bytes_.length}readInt8(t){return this.readUint8(t)<<24>>24}readUint8(t){return this.bytes_[t]}readInt16(t){return this.readUint16(t)<<16>>16}readUint16(t){return this.bytes_[t]|this.bytes_[t+1]<<8}readInt32(t){return this.bytes_[t]|this.bytes_[t+1]<<8|this.bytes_[t+2]<<16|this.bytes_[t+3]<<24}readUint32(t){return this.readInt32(t)>>>0}readInt64(t){return BigInt.asIntN(64,BigInt(this.readUint32(t))+(BigInt(this.readUint32(t+4))<<BigInt(32)))}readUint64(t){return BigInt.asUintN(64,BigInt(this.readUint32(t))+(BigInt(this.readUint32(t+4))<<BigInt(32)))}readFloat32(t){return Mp[0]=this.readInt32(t),CM[0]}readFloat64(t){return Mp[ox?0:1]=this.readInt32(t),Mp[ox?1:0]=this.readInt32(t+4),PM[0]}writeInt8(t,r){this.bytes_[t]=r}writeUint8(t,r){this.bytes_[t]=r}writeInt16(t,r){this.bytes_[t]=r,this.bytes_[t+1]=r>>8}writeUint16(t,r){this.bytes_[t]=r,this.bytes_[t+1]=r>>8}writeInt32(t,r){this.bytes_[t]=r,this.bytes_[t+1]=r>>8,this.bytes_[t+2]=r>>16,this.bytes_[t+3]=r>>24}writeUint32(t,r){this.bytes_[t]=r,this.bytes_[t+1]=r>>8,this.bytes_[t+2]=r>>16,this.bytes_[t+3]=r>>24}writeInt64(t,r){this.writeInt32(t,Number(BigInt.asIntN(32,r))),this.writeInt32(t+4,Number(BigInt.asIntN(32,r>>BigInt(32))))}writeUint64(t,r){this.writeUint32(t,Number(BigInt.asUintN(32,r))),this.writeUint32(t+4,Number(BigInt.asUintN(32,r>>BigInt(32))))}writeFloat32(t,r){CM[0]=r,this.writeInt32(t,Mp[0])}writeFloat64(t,r){PM[0]=r,this.writeInt32(t,Mp[ox?0:1]),this.writeInt32(t+4,Mp[ox?1:0])}getBufferIdentifier(){if(this.bytes_.length<this.position_+4+4)throw new Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");let t="";for(let r=0;r<4;r++)t+=String.fromCharCode(this.readInt8(this.position_+4+r));return t}__offset(t,r){let i=t-this.readInt32(t);return r<this.readInt16(i)?this.readInt16(i+r):0}__union(t,r){return t.bb_pos=r+this.readInt32(r),t.bb=this,t}__string(t,r){t+=this.readInt32(t);let i=this.readInt32(t);t+=4;let s=this.bytes_.subarray(t,t+i);return r===A4.UTF8_BYTES?s:this.text_decoder_.decode(s)}__union_with_string(t,r){return typeof t=="string"?this.__string(r):this.__union(t,r)}__indirect(t){return t+this.readInt32(t)}__vector(t){return t+this.readInt32(t)+4}__vector_len(t){return this.readInt32(t+this.readInt32(t))}__has_identifier(t){if(t.length!=4)throw new Error("FlatBuffers: file identifier must be length "+4);for(let r=0;r<4;r++)if(t.charCodeAt(r)!=this.readInt8(this.position()+4+r))return!1;return!0}createScalarList(t,r){let i=[];for(let s=0;s<r;++s){let n=t(s);n!==null&&i.push(n)}return i}createObjList(t,r){let i=[];for(let s=0;s<r;++s){let n=t(s);n!==null&&i.push(n.unpack())}return i}};var r_=class e{constructor(t){this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null,this.text_encoder=new TextEncoder;let r;t?r=t:r=1024,this.bb=nu.allocate(r),this.space=r}clear(){this.bb.clear(),this.space=this.bb.capacity(),this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null}forceDefaults(t){this.force_defaults=t}dataBuffer(){return this.bb}asUint8Array(){return this.bb.bytes().subarray(this.bb.position(),this.bb.position()+this.offset())}prep(t,r){t>this.minalign&&(this.minalign=t);let i=~(this.bb.capacity()-this.space+r)+1&t-1;for(;this.space<i+t+r;){let s=this.bb.capacity();this.bb=e.growByteBuffer(this.bb),this.space+=this.bb.capacity()-s}this.pad(i)}pad(t){for(let r=0;r<t;r++)this.bb.writeInt8(--this.space,0)}writeInt8(t){this.bb.writeInt8(this.space-=1,t)}writeInt16(t){this.bb.writeInt16(this.space-=2,t)}writeInt32(t){this.bb.writeInt32(this.space-=4,t)}writeInt64(t){this.bb.writeInt64(this.space-=8,t)}writeFloat32(t){this.bb.writeFloat32(this.space-=4,t)}writeFloat64(t){this.bb.writeFloat64(this.space-=8,t)}addInt8(t){this.prep(1,0),this.writeInt8(t)}addInt16(t){this.prep(2,0),this.writeInt16(t)}addInt32(t){this.prep(4,0),this.writeInt32(t)}addInt64(t){this.prep(8,0),this.writeInt64(t)}addFloat32(t){this.prep(4,0),this.writeFloat32(t)}addFloat64(t){this.prep(8,0),this.writeFloat64(t)}addFieldInt8(t,r,i){(this.force_defaults||r!=i)&&(this.addInt8(r),this.slot(t))}addFieldInt16(t,r,i){(this.force_defaults||r!=i)&&(this.addInt16(r),this.slot(t))}addFieldInt32(t,r,i){(this.force_defaults||r!=i)&&(this.addInt32(r),this.slot(t))}addFieldInt64(t,r,i){(this.force_defaults||r!==i)&&(this.addInt64(r),this.slot(t))}addFieldFloat32(t,r,i){(this.force_defaults||r!=i)&&(this.addFloat32(r),this.slot(t))}addFieldFloat64(t,r,i){(this.force_defaults||r!=i)&&(this.addFloat64(r),this.slot(t))}addFieldOffset(t,r,i){(this.force_defaults||r!=i)&&(this.addOffset(r),this.slot(t))}addFieldStruct(t,r,i){r!=i&&(this.nested(r),this.slot(t))}nested(t){if(t!=this.offset())throw new TypeError("FlatBuffers: struct must be serialized inline.")}notNested(){if(this.isNested)throw new TypeError("FlatBuffers: object serialization must not be nested.")}slot(t){this.vtable!==null&&(this.vtable[t]=this.offset())}offset(){return this.bb.capacity()-this.space}static growByteBuffer(t){let r=t.capacity();if(r&3221225472)throw new Error("FlatBuffers: cannot grow buffer beyond 2 gigabytes.");let i=r<<1,s=nu.allocate(i);return s.setPosition(i-r),s.bytes().set(t.bytes(),i-r),s}addOffset(t){this.prep(4,0),this.writeInt32(this.offset()-t+4)}startObject(t){this.notNested(),this.vtable==null&&(this.vtable=[]),this.vtable_in_use=t;for(let r=0;r<t;r++)this.vtable[r]=0;this.isNested=!0,this.object_start=this.offset()}endObject(){if(this.vtable==null||!this.isNested)throw new Error("FlatBuffers: endObject called without startObject");this.addInt32(0);let t=this.offset(),r=this.vtable_in_use-1;for(;r>=0&&this.vtable[r]==0;r--);let i=r+1;for(;r>=0;r--)this.addInt16(this.vtable[r]!=0?t-this.vtable[r]:0);let s=2;this.addInt16(t-this.object_start);let n=(i+s)*2;this.addInt16(n);let o=0,c=this.space;t:for(r=0;r<this.vtables.length;r++){let f=this.bb.capacity()-this.vtables[r];if(n==this.bb.readInt16(f)){for(let p=2;p<n;p+=2)if(this.bb.readInt16(c+p)!=this.bb.readInt16(f+p))continue t;o=this.vtables[r];break}}return o?(this.space=this.bb.capacity()-t,this.bb.writeInt32(this.space,o-t)):(this.vtables.push(this.offset()),this.bb.writeInt32(this.bb.capacity()-t,this.offset()-t)),this.isNested=!1,t}finish(t,r,i){let s=i?4:0;if(r){let n=r;if(this.prep(this.minalign,8+s),n.length!=4)throw new TypeError("FlatBuffers: file identifier must be length "+4);for(let o=3;o>=0;o--)this.writeInt8(n.charCodeAt(o))}this.prep(this.minalign,4+s),this.addOffset(t),s&&this.addInt32(this.bb.capacity()-this.space),this.bb.setPosition(this.space)}finishSizePrefixed(t,r){this.finish(t,r,!0)}requiredField(t,r){let i=this.bb.capacity()-t,s=i-this.bb.readInt32(i);if(!(r<this.bb.readInt16(s)&&this.bb.readInt16(s+r)!=0))throw new TypeError("FlatBuffers: field "+r+" must be set")}startVector(t,r,i){this.notNested(),this.vector_num_elems=r,this.prep(4,t*r),this.prep(i,t*r)}endVector(){return this.writeInt32(this.vector_num_elems),this.offset()}createSharedString(t){if(!t)return 0;if(this.string_maps||(this.string_maps=new Map),this.string_maps.has(t))return this.string_maps.get(t);let r=this.createString(t);return this.string_maps.set(t,r),r}createString(t){if(t==null)return 0;let r;t instanceof Uint8Array?r=t:r=this.text_encoder.encode(t),this.addInt8(0),this.startVector(1,r.length,1),this.bb.setPosition(this.space-=r.length);for(let i=0,s=this.space,n=this.bb.bytes();i<r.length;i++)n[s++]=r[i];return this.endVector()}createObjectOffset(t){return t===null?0:typeof t=="string"?this.createString(t):t.pack(this)}createObjectOffsetList(t){let r=[];for(let i=0;i<t.length;++i){let s=t[i];if(s!==null)r.push(this.createObjectOffset(s));else throw new TypeError("FlatBuffers: Argument for createObjectOffsetList cannot contain null.")}return r}createStructOffsetList(t,r){return r(this,t.length),this.createObjectOffsetList(t.slice().reverse()),this.endVector()}};var m4;(function(e){e[e.BUFFER=0]="BUFFER"})(m4||(m4={}));var g4;(function(e){e[e.LZ4_FRAME=0]="LZ4_FRAME",e[e.ZSTD=1]="ZSTD"})(g4||(g4={}));var kM=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsBodyCompression(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsBodyCompression(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}codec(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt8(this.bb_pos+t):g4.LZ4_FRAME}method(){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt8(this.bb_pos+t):m4.BUFFER}static startBodyCompression(t){t.startObject(2)}static addCodec(t,r){t.addFieldInt8(0,r,g4.LZ4_FRAME)}static addMethod(t,r){t.addFieldInt8(1,r,m4.BUFFER)}static endBodyCompression(t){return t.endObject()}static createBodyCompression(t,r,i){return e.startBodyCompression(t),e.addCodec(t,r),e.addMethod(t,i),e.endBodyCompression(t)}};var ax=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}offset(){return this.bb.readInt64(this.bb_pos)}length(){return this.bb.readInt64(this.bb_pos+8)}static sizeOf(){return 16}static createBuffer(t,r,i){return t.prep(8,16),t.writeInt64(BigInt(i??0)),t.writeInt64(BigInt(r??0)),t.offset()}};var lx=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}length(){return this.bb.readInt64(this.bb_pos)}nullCount(){return this.bb.readInt64(this.bb_pos+8)}static sizeOf(){return 16}static createFieldNode(t,r,i){return t.prep(8,16),t.writeInt64(BigInt(i??0)),t.writeInt64(BigInt(r??0)),t.offset()}};var su=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsRecordBatch(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsRecordBatch(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}length(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt64(this.bb_pos+t):BigInt("0")}nodes(t,r){let i=this.bb.__offset(this.bb_pos,6);return i?(r||new lx).__init(this.bb.__vector(this.bb_pos+i)+t*16,this.bb):null}nodesLength(){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}buffers(t,r){let i=this.bb.__offset(this.bb_pos,8);return i?(r||new ax).__init(this.bb.__vector(this.bb_pos+i)+t*16,this.bb):null}buffersLength(){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}compression(t){let r=this.bb.__offset(this.bb_pos,10);return r?(t||new kM).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}static startRecordBatch(t){t.startObject(4)}static addLength(t,r){t.addFieldInt64(0,r,BigInt("0"))}static addNodes(t,r){t.addFieldOffset(1,r,0)}static startNodesVector(t,r){t.startVector(16,r,8)}static addBuffers(t,r){t.addFieldOffset(2,r,0)}static startBuffersVector(t,r){t.startVector(16,r,8)}static addCompression(t,r){t.addFieldOffset(3,r,0)}static endRecordBatch(t){return t.endObject()}};var s0=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsDictionaryBatch(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDictionaryBatch(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}id(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt64(this.bb_pos+t):BigInt("0")}data(t){let r=this.bb.__offset(this.bb_pos,6);return r?(t||new su).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}isDelta(){let t=this.bb.__offset(this.bb_pos,8);return t?!!this.bb.readInt8(this.bb_pos+t):!1}static startDictionaryBatch(t){t.startObject(3)}static addId(t,r){t.addFieldInt64(0,r,BigInt("0"))}static addData(t,r){t.addFieldOffset(1,r,0)}static addIsDelta(t,r){t.addFieldInt8(2,+r,0)}static endDictionaryBatch(t){return t.endObject()}};var lm;(function(e){e[e.Little=0]="Little",e[e.Big=1]="Big"})(lm||(lm={}));var _4;(function(e){e[e.DenseArray=0]="DenseArray"})(_4||(_4={}));var uf=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsInt(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsInt(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}bitWidth(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}isSigned(){let t=this.bb.__offset(this.bb_pos,6);return t?!!this.bb.readInt8(this.bb_pos+t):!1}static startInt(t){t.startObject(2)}static addBitWidth(t,r){t.addFieldInt32(0,r,0)}static addIsSigned(t,r){t.addFieldInt8(1,+r,0)}static endInt(t){return t.endObject()}static createInt(t,r,i){return e.startInt(t),e.addBitWidth(t,r),e.addIsSigned(t,i),e.endInt(t)}};var Cp=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsDictionaryEncoding(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDictionaryEncoding(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}id(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt64(this.bb_pos+t):BigInt("0")}indexType(t){let r=this.bb.__offset(this.bb_pos,6);return r?(t||new uf).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}isOrdered(){let t=this.bb.__offset(this.bb_pos,8);return t?!!this.bb.readInt8(this.bb_pos+t):!1}dictionaryKind(){let t=this.bb.__offset(this.bb_pos,10);return t?this.bb.readInt16(this.bb_pos+t):_4.DenseArray}static startDictionaryEncoding(t){t.startObject(4)}static addId(t,r){t.addFieldInt64(0,r,BigInt("0"))}static addIndexType(t,r){t.addFieldOffset(1,r,0)}static addIsOrdered(t,r){t.addFieldInt8(2,+r,0)}static addDictionaryKind(t,r){t.addFieldInt16(3,r,_4.DenseArray)}static endDictionaryEncoding(t){return t.endObject()}};var Qo=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsKeyValue(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsKeyValue(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}key(t){let r=this.bb.__offset(this.bb_pos,4);return r?this.bb.__string(this.bb_pos+r,t):null}value(t){let r=this.bb.__offset(this.bb_pos,6);return r?this.bb.__string(this.bb_pos+r,t):null}static startKeyValue(t){t.startObject(2)}static addKey(t,r){t.addFieldOffset(0,r,0)}static addValue(t,r){t.addFieldOffset(1,r,0)}static endKeyValue(t){return t.endObject()}static createKeyValue(t,r,i){return e.startKeyValue(t),e.addKey(t,r),e.addValue(t,i),e.endKeyValue(t)}};var y4=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsBinary(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsBinary(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static startBinary(t){t.startObject(0)}static endBinary(t){return t.endObject()}static createBinary(t){return e.startBinary(t),e.endBinary(t)}};var x4=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsBool(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsBool(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static startBool(t){t.startObject(0)}static endBool(t){return t.endObject()}static createBool(t){return e.startBool(t),e.endBool(t)}};var cm=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsDate(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDate(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}unit(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Qs.MILLISECOND}static startDate(t){t.startObject(1)}static addUnit(t,r){t.addFieldInt16(0,r,Qs.MILLISECOND)}static endDate(t){return t.endObject()}static createDate(t,r){return e.startDate(t),e.addUnit(t,r),e.endDate(t)}};var Pp=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsDecimal(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDecimal(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}precision(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}scale(){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt32(this.bb_pos+t):0}bitWidth(){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readInt32(this.bb_pos+t):128}static startDecimal(t){t.startObject(3)}static addPrecision(t,r){t.addFieldInt32(0,r,0)}static addScale(t,r){t.addFieldInt32(1,r,0)}static addBitWidth(t,r){t.addFieldInt32(2,r,128)}static endDecimal(t){return t.endObject()}static createDecimal(t,r,i,s){return e.startDecimal(t),e.addPrecision(t,r),e.addScale(t,i),e.addBitWidth(t,s),e.endDecimal(t)}};var um=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsDuration(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDuration(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}unit(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):wr.MILLISECOND}static startDuration(t){t.startObject(1)}static addUnit(t,r){t.addFieldInt16(0,r,wr.MILLISECOND)}static endDuration(t){return t.endObject()}static createDuration(t,r){return e.startDuration(t),e.addUnit(t,r),e.endDuration(t)}};var hm=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsFixedSizeBinary(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFixedSizeBinary(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}byteWidth(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}static startFixedSizeBinary(t){t.startObject(1)}static addByteWidth(t,r){t.addFieldInt32(0,r,0)}static endFixedSizeBinary(t){return t.endObject()}static createFixedSizeBinary(t,r){return e.startFixedSizeBinary(t),e.addByteWidth(t,r),e.endFixedSizeBinary(t)}};var fm=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsFixedSizeList(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFixedSizeList(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}listSize(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}static startFixedSizeList(t){t.startObject(1)}static addListSize(t,r){t.addFieldInt32(0,r,0)}static endFixedSizeList(t){return t.endObject()}static createFixedSizeList(t,r){return e.startFixedSizeList(t),e.addListSize(t,r),e.endFixedSizeList(t)}};var pm=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsFloatingPoint(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFloatingPoint(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}precision(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):ts.HALF}static startFloatingPoint(t){t.startObject(1)}static addPrecision(t,r){t.addFieldInt16(0,r,ts.HALF)}static endFloatingPoint(t){return t.endObject()}static createFloatingPoint(t,r){return e.startFloatingPoint(t),e.addPrecision(t,r),e.endFloatingPoint(t)}};var dm=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsInterval(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsInterval(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}unit(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Co.YEAR_MONTH}static startInterval(t){t.startObject(1)}static addUnit(t,r){t.addFieldInt16(0,r,Co.YEAR_MONTH)}static endInterval(t){return t.endObject()}static createInterval(t,r){return e.startInterval(t),e.addUnit(t,r),e.endInterval(t)}};var b4=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsLargeBinary(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsLargeBinary(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static startLargeBinary(t){t.startObject(0)}static endLargeBinary(t){return t.endObject()}static createLargeBinary(t){return e.startLargeBinary(t),e.endLargeBinary(t)}};var v4=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsLargeUtf8(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsLargeUtf8(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static startLargeUtf8(t){t.startObject(0)}static endLargeUtf8(t){return t.endObject()}static createLargeUtf8(t){return e.startLargeUtf8(t),e.endLargeUtf8(t)}};var w4=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsList(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsList(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static startList(t){t.startObject(0)}static endList(t){return t.endObject()}static createList(t){return e.startList(t),e.endList(t)}};var Am=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsMap(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsMap(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}keysSorted(){let t=this.bb.__offset(this.bb_pos,4);return t?!!this.bb.readInt8(this.bb_pos+t):!1}static startMap(t){t.startObject(1)}static addKeysSorted(t,r){t.addFieldInt8(0,+r,0)}static endMap(t){return t.endObject()}static createMap(t,r){return e.startMap(t),e.addKeysSorted(t,r),e.endMap(t)}};var T4=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsNull(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsNull(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static startNull(t){t.startObject(0)}static endNull(t){return t.endObject()}static createNull(t){return e.startNull(t),e.endNull(t)}};var S4=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsStruct_(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsStruct_(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static startStruct_(t){t.startObject(0)}static endStruct_(t){return t.endObject()}static createStruct_(t){return e.startStruct_(t),e.endStruct_(t)}};var o0=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsTime(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsTime(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}unit(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):wr.MILLISECOND}bitWidth(){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt32(this.bb_pos+t):32}static startTime(t){t.startObject(2)}static addUnit(t,r){t.addFieldInt16(0,r,wr.MILLISECOND)}static addBitWidth(t,r){t.addFieldInt32(1,r,32)}static endTime(t){return t.endObject()}static createTime(t,r,i){return e.startTime(t),e.addUnit(t,r),e.addBitWidth(t,i),e.endTime(t)}};var a0=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsTimestamp(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsTimestamp(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}unit(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):wr.SECOND}timezone(t){let r=this.bb.__offset(this.bb_pos,6);return r?this.bb.__string(this.bb_pos+r,t):null}static startTimestamp(t){t.startObject(2)}static addUnit(t,r){t.addFieldInt16(0,r,wr.SECOND)}static addTimezone(t,r){t.addFieldOffset(1,r,0)}static endTimestamp(t){return t.endObject()}static createTimestamp(t,r,i){return e.startTimestamp(t),e.addUnit(t,r),e.addTimezone(t,i),e.endTimestamp(t)}};var hf=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsUnion(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsUnion(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}mode(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):as.Sparse}typeIds(t){let r=this.bb.__offset(this.bb_pos,6);return r?this.bb.readInt32(this.bb.__vector(this.bb_pos+r)+t*4):0}typeIdsLength(){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}typeIdsArray(){let t=this.bb.__offset(this.bb_pos,6);return t?new Int32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}static startUnion(t){t.startObject(2)}static addMode(t,r){t.addFieldInt16(0,r,as.Sparse)}static addTypeIds(t,r){t.addFieldOffset(1,r,0)}static createTypeIdsVector(t,r){t.startVector(4,r.length,4);for(let i=r.length-1;i>=0;i--)t.addInt32(r[i]);return t.endVector()}static startTypeIdsVector(t,r){t.startVector(4,r,4)}static endUnion(t){return t.endObject()}static createUnion(t,r,i){return e.startUnion(t),e.addMode(t,r),e.addTypeIds(t,i),e.endUnion(t)}};var E4=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsUtf8(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsUtf8(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static startUtf8(t){t.startObject(0)}static endUtf8(t){return t.endObject()}static createUtf8(t){return e.startUtf8(t),e.endUtf8(t)}};var ls;(function(e){e[e.NONE=0]="NONE",e[e.Null=1]="Null",e[e.Int=2]="Int",e[e.FloatingPoint=3]="FloatingPoint",e[e.Binary=4]="Binary",e[e.Utf8=5]="Utf8",e[e.Bool=6]="Bool",e[e.Decimal=7]="Decimal",e[e.Date=8]="Date",e[e.Time=9]="Time",e[e.Timestamp=10]="Timestamp",e[e.Interval=11]="Interval",e[e.List=12]="List",e[e.Struct_=13]="Struct_",e[e.Union=14]="Union",e[e.FixedSizeBinary=15]="FixedSizeBinary",e[e.FixedSizeList=16]="FixedSizeList",e[e.Map=17]="Map",e[e.Duration=18]="Duration",e[e.LargeBinary=19]="LargeBinary",e[e.LargeUtf8=20]="LargeUtf8",e[e.LargeList=21]="LargeList",e[e.RunEndEncoded=22]="RunEndEncoded"})(ls||(ls={}));var gl=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsField(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsField(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}name(t){let r=this.bb.__offset(this.bb_pos,4);return r?this.bb.__string(this.bb_pos+r,t):null}nullable(){let t=this.bb.__offset(this.bb_pos,6);return t?!!this.bb.readInt8(this.bb_pos+t):!1}typeType(){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readUint8(this.bb_pos+t):ls.NONE}type(t){let r=this.bb.__offset(this.bb_pos,10);return r?this.bb.__union(t,this.bb_pos+r):null}dictionary(t){let r=this.bb.__offset(this.bb_pos,12);return r?(t||new Cp).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}children(t,r){let i=this.bb.__offset(this.bb_pos,14);return i?(r||new e).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+t*4),this.bb):null}childrenLength(){let t=this.bb.__offset(this.bb_pos,14);return t?this.bb.__vector_len(this.bb_pos+t):0}customMetadata(t,r){let i=this.bb.__offset(this.bb_pos,16);return i?(r||new Qo).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+t*4),this.bb):null}customMetadataLength(){let t=this.bb.__offset(this.bb_pos,16);return t?this.bb.__vector_len(this.bb_pos+t):0}static startField(t){t.startObject(7)}static addName(t,r){t.addFieldOffset(0,r,0)}static addNullable(t,r){t.addFieldInt8(1,+r,0)}static addTypeType(t,r){t.addFieldInt8(2,r,ls.NONE)}static addType(t,r){t.addFieldOffset(3,r,0)}static addDictionary(t,r){t.addFieldOffset(4,r,0)}static addChildren(t,r){t.addFieldOffset(5,r,0)}static createChildrenVector(t,r){t.startVector(4,r.length,4);for(let i=r.length-1;i>=0;i--)t.addOffset(r[i]);return t.endVector()}static startChildrenVector(t,r){t.startVector(4,r,4)}static addCustomMetadata(t,r){t.addFieldOffset(6,r,0)}static createCustomMetadataVector(t,r){t.startVector(4,r.length,4);for(let i=r.length-1;i>=0;i--)t.addOffset(r[i]);return t.endVector()}static startCustomMetadataVector(t,r){t.startVector(4,r,4)}static endField(t){return t.endObject()}};var bc=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsSchema(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsSchema(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}endianness(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):lm.Little}fields(t,r){let i=this.bb.__offset(this.bb_pos,6);return i?(r||new gl).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+t*4),this.bb):null}fieldsLength(){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}customMetadata(t,r){let i=this.bb.__offset(this.bb_pos,8);return i?(r||new Qo).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+t*4),this.bb):null}customMetadataLength(){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}features(t){let r=this.bb.__offset(this.bb_pos,10);return r?this.bb.readInt64(this.bb.__vector(this.bb_pos+r)+t*8):BigInt(0)}featuresLength(){let t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__vector_len(this.bb_pos+t):0}static startSchema(t){t.startObject(4)}static addEndianness(t,r){t.addFieldInt16(0,r,lm.Little)}static addFields(t,r){t.addFieldOffset(1,r,0)}static createFieldsVector(t,r){t.startVector(4,r.length,4);for(let i=r.length-1;i>=0;i--)t.addOffset(r[i]);return t.endVector()}static startFieldsVector(t,r){t.startVector(4,r,4)}static addCustomMetadata(t,r){t.addFieldOffset(2,r,0)}static createCustomMetadataVector(t,r){t.startVector(4,r.length,4);for(let i=r.length-1;i>=0;i--)t.addOffset(r[i]);return t.endVector()}static startCustomMetadataVector(t,r){t.startVector(4,r,4)}static addFeatures(t,r){t.addFieldOffset(3,r,0)}static createFeaturesVector(t,r){t.startVector(8,r.length,8);for(let i=r.length-1;i>=0;i--)t.addInt64(r[i]);return t.endVector()}static startFeaturesVector(t,r){t.startVector(8,r,8)}static endSchema(t){return t.endObject()}static finishSchemaBuffer(t,r){t.finish(r)}static finishSizePrefixedSchemaBuffer(t,r){t.finish(r,void 0,!0)}static createSchema(t,r,i,s,n){return e.startSchema(t),e.addEndianness(t,r),e.addFields(t,i),e.addCustomMetadata(t,s),e.addFeatures(t,n),e.endSchema(t)}};var nn;(function(e){e[e.NONE=0]="NONE",e[e.Schema=1]="Schema",e[e.DictionaryBatch=2]="DictionaryBatch",e[e.RecordBatch=3]="RecordBatch",e[e.Tensor=4]="Tensor",e[e.SparseTensor=5]="SparseTensor"})(nn||(nn={}));var Ft;(function(e){e[e.NONE=0]="NONE",e[e.Null=1]="Null",e[e.Int=2]="Int",e[e.Float=3]="Float",e[e.Binary=4]="Binary",e[e.Utf8=5]="Utf8",e[e.Bool=6]="Bool",e[e.Decimal=7]="Decimal",e[e.Date=8]="Date",e[e.Time=9]="Time",e[e.Timestamp=10]="Timestamp",e[e.Interval=11]="Interval",e[e.List=12]="List",e[e.Struct=13]="Struct",e[e.Union=14]="Union",e[e.FixedSizeBinary=15]="FixedSizeBinary",e[e.FixedSizeList=16]="FixedSizeList",e[e.Map=17]="Map",e[e.Duration=18]="Duration",e[e.LargeBinary=19]="LargeBinary",e[e.LargeUtf8=20]="LargeUtf8",e[e.Dictionary=-1]="Dictionary",e[e.Int8=-2]="Int8",e[e.Int16=-3]="Int16",e[e.Int32=-4]="Int32",e[e.Int64=-5]="Int64",e[e.Uint8=-6]="Uint8",e[e.Uint16=-7]="Uint16",e[e.Uint32=-8]="Uint32",e[e.Uint64=-9]="Uint64",e[e.Float16=-10]="Float16",e[e.Float32=-11]="Float32",e[e.Float64=-12]="Float64",e[e.DateDay=-13]="DateDay",e[e.DateMillisecond=-14]="DateMillisecond",e[e.TimestampSecond=-15]="TimestampSecond",e[e.TimestampMillisecond=-16]="TimestampMillisecond",e[e.TimestampMicrosecond=-17]="TimestampMicrosecond",e[e.TimestampNanosecond=-18]="TimestampNanosecond",e[e.TimeSecond=-19]="TimeSecond",e[e.TimeMillisecond=-20]="TimeMillisecond",e[e.TimeMicrosecond=-21]="TimeMicrosecond",e[e.TimeNanosecond=-22]="TimeNanosecond",e[e.DenseUnion=-23]="DenseUnion",e[e.SparseUnion=-24]="SparseUnion",e[e.IntervalDayTime=-25]="IntervalDayTime",e[e.IntervalYearMonth=-26]="IntervalYearMonth",e[e.DurationSecond=-27]="DurationSecond",e[e.DurationMillisecond=-28]="DurationMillisecond",e[e.DurationMicrosecond=-29]="DurationMicrosecond",e[e.DurationNanosecond=-30]="DurationNanosecond"})(Ft||(Ft={}));var eh;(function(e){e[e.OFFSET=0]="OFFSET",e[e.DATA=1]="DATA",e[e.VALIDITY=2]="VALIDITY",e[e.TYPE=3]="TYPE"})(eh||(eh={}));var PN={};sl(PN,{clampIndex:()=>_Tt,clampRange:()=>P4,createElementComparator:()=>_m});var fN={};sl(fN,{valueToString:()=>ff});function ff(e){if(e===null)return"null";if(e===void 0)return"undefined";switch(typeof e){case"number":return`${e}`;case"bigint":return`${e}`;case"string":return`"${e}"`}return typeof e[Symbol.toPrimitive]=="function"?e[Symbol.toPrimitive]("string"):ArrayBuffer.isView(e)?e instanceof BigInt64Array||e instanceof BigUint64Array?`[${[...e].map(t=>ff(t))}]`:`[${e}]`:ArrayBuffer.isView(e)?`[${e}]`:JSON.stringify(e,(t,r)=>typeof r=="bigint"?`${r}`:r)}var dN={};sl(dN,{BN:()=>M4,bigNumToBigInt:()=>Wrt,bigNumToString:()=>hx,isArrowBigNumSymbol:()=>$rt});var $rt=Symbol.for("isArrowBigNum");function pf(e,...t){return t.length===0?Object.setPrototypeOf(Gi(this.TypedArray,e),this.constructor.prototype):Object.setPrototypeOf(new this.TypedArray(e,...t),this.constructor.prototype)}pf.prototype[$rt]=!0;pf.prototype.toJSON=function(){return`"${hx(this)}"`};pf.prototype.valueOf=function(){return Hrt(this)};pf.prototype.toString=function(){return hx(this)};pf.prototype[Symbol.toPrimitive]=function(e="default"){switch(e){case"number":return Hrt(this);case"string":return hx(this);case"default":return Wrt(this)}return hx(this)};function cx(...e){return pf.apply(this,e)}function ux(...e){return pf.apply(this,e)}function I4(...e){return pf.apply(this,e)}Object.setPrototypeOf(cx.prototype,Object.create(Int32Array.prototype));Object.setPrototypeOf(ux.prototype,Object.create(Uint32Array.prototype));Object.setPrototypeOf(I4.prototype,Object.create(Uint32Array.prototype));Object.assign(cx.prototype,pf.prototype,{constructor:cx,signed:!0,TypedArray:Int32Array,BigIntArray:BigInt64Array});Object.assign(ux.prototype,pf.prototype,{constructor:ux,signed:!1,TypedArray:Uint32Array,BigIntArray:BigUint64Array});Object.assign(I4.prototype,pf.prototype,{constructor:I4,signed:!0,TypedArray:Uint32Array,BigIntArray:BigUint64Array});function Hrt(e){let{buffer:t,byteOffset:r,length:i,signed:s}=e,n=new BigUint64Array(t,r,i),o=s&&n.at(-1)&BigInt(1)<<BigInt(63),c=BigInt(o?1:0),f=BigInt(0);if(o){for(let p of n)c+=~p*(BigInt(1)<<BigInt(32)*f++);c*=BigInt(-1)}else for(let p of n)c+=p*(BigInt(1)<<BigInt(32)*f++);return c}var hx=e=>{if(e.byteLength===8)return`${new e.BigIntArray(e.buffer,e.byteOffset,1)[0]}`;if(!e.signed)return pN(e);let t=new Uint16Array(e.buffer,e.byteOffset,e.byteLength/2);if(new Int16Array([t.at(-1)])[0]>=0)return pN(e);t=t.slice();let i=1;for(let n=0;n<t.length;n++){let o=t[n],c=~o+i;t[n]=c,i&=o===0?1:0}return`-${pN(t)}`},Wrt=e=>e.byteLength===8?new e.BigIntArray(e.buffer,e.byteOffset,1)[0]:hx(e);function pN(e){let t="",r=new Uint32Array(2),i=new Uint16Array(e.buffer,e.byteOffset,e.byteLength/2),s=new Uint32Array((i=new Uint16Array(i).reverse()).buffer),n=-1,o=i.length-1;do{for(r[0]=i[n=0];n<o;)i[n++]=r[1]=r[0]/10,r[0]=(r[0]-r[1]*10<<16)+i[n];i[n]=r[1]=r[0]/10,r[0]=r[0]-r[1]*10,t=`${r[0]}${t}`}while(s[0]||s[1]||s[2]||s[3]);return t??"0"}var M4=class e{static new(t,r){switch(r){case!0:return new cx(t);case!1:return new ux(t)}switch(t.constructor){case Int8Array:case Int16Array:case Int32Array:case BigInt64Array:return new cx(t)}return t.byteLength===16?new I4(t):new ux(t)}static signed(t){return new cx(t)}static unsigned(t){return new ux(t)}static decimal(t){return new I4(t)}constructor(t,r){return e.new(t,r)}};function Ks(e){if(typeof e=="bigint"&&(e<Number.MIN_SAFE_INTEGER||e>Number.MAX_SAFE_INTEGER))throw new TypeError(`${e} is not safe to convert to a number.`);return Number(e)}var qrt,Yrt,Xrt,Zrt,Grt,Qrt,Krt,Jrt,tit,eit,rit,iit,nit,sit,oit,ait,lit,cit,uit,hit,fit,pit,yr=class e{static isNull(t){return t?.typeId===Ft.Null}static isInt(t){return t?.typeId===Ft.Int}static isFloat(t){return t?.typeId===Ft.Float}static isBinary(t){return t?.typeId===Ft.Binary}static isLargeBinary(t){return t?.typeId===Ft.LargeBinary}static isUtf8(t){return t?.typeId===Ft.Utf8}static isLargeUtf8(t){return t?.typeId===Ft.LargeUtf8}static isBool(t){return t?.typeId===Ft.Bool}static isDecimal(t){return t?.typeId===Ft.Decimal}static isDate(t){return t?.typeId===Ft.Date}static isTime(t){return t?.typeId===Ft.Time}static isTimestamp(t){return t?.typeId===Ft.Timestamp}static isInterval(t){return t?.typeId===Ft.Interval}static isDuration(t){return t?.typeId===Ft.Duration}static isList(t){return t?.typeId===Ft.List}static isStruct(t){return t?.typeId===Ft.Struct}static isUnion(t){return t?.typeId===Ft.Union}static isFixedSizeBinary(t){return t?.typeId===Ft.FixedSizeBinary}static isFixedSizeList(t){return t?.typeId===Ft.FixedSizeList}static isMap(t){return t?.typeId===Ft.Map}static isDictionary(t){return t?.typeId===Ft.Dictionary}static isDenseUnion(t){return e.isUnion(t)&&t.mode===as.Dense}static isSparseUnion(t){return e.isUnion(t)&&t.mode===as.Sparse}constructor(t){this.typeId=t}};qrt=Symbol.toStringTag;yr[qrt]=(e=>(e.children=null,e.ArrayType=Array,e.OffsetArrayType=Int32Array,e[Symbol.toStringTag]="DataType"))(yr.prototype);var xa=class extends yr{constructor(){super(Ft.Null)}toString(){return"Null"}};Yrt=Symbol.toStringTag;xa[Yrt]=(e=>e[Symbol.toStringTag]="Null")(xa.prototype);var fo=class extends yr{constructor(t,r){super(Ft.Int),this.isSigned=t,this.bitWidth=r}get ArrayType(){switch(this.bitWidth){case 8:return this.isSigned?Int8Array:Uint8Array;case 16:return this.isSigned?Int16Array:Uint16Array;case 32:return this.isSigned?Int32Array:Uint32Array;case 64:return this.isSigned?BigInt64Array:BigUint64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`${this.isSigned?"I":"Ui"}nt${this.bitWidth}`}};Xrt=Symbol.toStringTag;fo[Xrt]=(e=>(e.isSigned=null,e.bitWidth=null,e[Symbol.toStringTag]="Int"))(fo.prototype);var l0=class extends fo{constructor(){super(!0,8)}get ArrayType(){return Int8Array}},c0=class extends fo{constructor(){super(!0,16)}get ArrayType(){return Int16Array}},_l=class extends fo{constructor(){super(!0,32)}get ArrayType(){return Int32Array}},u0=class extends fo{constructor(){super(!0,64)}get ArrayType(){return BigInt64Array}},h0=class extends fo{constructor(){super(!1,8)}get ArrayType(){return Uint8Array}},f0=class extends fo{constructor(){super(!1,16)}get ArrayType(){return Uint16Array}},p0=class extends fo{constructor(){super(!1,32)}get ArrayType(){return Uint32Array}},d0=class extends fo{constructor(){super(!1,64)}get ArrayType(){return BigUint64Array}};Object.defineProperty(l0.prototype,"ArrayType",{value:Int8Array});Object.defineProperty(c0.prototype,"ArrayType",{value:Int16Array});Object.defineProperty(_l.prototype,"ArrayType",{value:Int32Array});Object.defineProperty(u0.prototype,"ArrayType",{value:BigInt64Array});Object.defineProperty(h0.prototype,"ArrayType",{value:Uint8Array});Object.defineProperty(f0.prototype,"ArrayType",{value:Uint16Array});Object.defineProperty(p0.prototype,"ArrayType",{value:Uint32Array});Object.defineProperty(d0.prototype,"ArrayType",{value:BigUint64Array});var Hl=class extends yr{constructor(t){super(Ft.Float),this.precision=t}get ArrayType(){switch(this.precision){case ts.HALF:return Uint16Array;case ts.SINGLE:return Float32Array;case ts.DOUBLE:return Float64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`Float${this.precision<<5||16}`}};Zrt=Symbol.toStringTag;Hl[Zrt]=(e=>(e.precision=null,e[Symbol.toStringTag]="Float"))(Hl.prototype);var i_=class extends Hl{constructor(){super(ts.HALF)}},A0=class extends Hl{constructor(){super(ts.SINGLE)}},m0=class extends Hl{constructor(){super(ts.DOUBLE)}};Object.defineProperty(i_.prototype,"ArrayType",{value:Uint16Array});Object.defineProperty(A0.prototype,"ArrayType",{value:Float32Array});Object.defineProperty(m0.prototype,"ArrayType",{value:Float64Array});var rh=class extends yr{constructor(){super(Ft.Binary)}toString(){return"Binary"}};Grt=Symbol.toStringTag;rh[Grt]=(e=>(e.ArrayType=Uint8Array,e[Symbol.toStringTag]="Binary"))(rh.prototype);var Rp=class extends yr{constructor(){super(Ft.LargeBinary)}toString(){return"LargeBinary"}};Qrt=Symbol.toStringTag;Rp[Qrt]=(e=>(e.ArrayType=Uint8Array,e.OffsetArrayType=BigInt64Array,e[Symbol.toStringTag]="LargeBinary"))(Rp.prototype);var ou=class extends yr{constructor(){super(Ft.Utf8)}toString(){return"Utf8"}};Krt=Symbol.toStringTag;ou[Krt]=(e=>(e.ArrayType=Uint8Array,e[Symbol.toStringTag]="Utf8"))(ou.prototype);var kp=class extends yr{constructor(){super(Ft.LargeUtf8)}toString(){return"LargeUtf8"}};Jrt=Symbol.toStringTag;kp[Jrt]=(e=>(e.ArrayType=Uint8Array,e.OffsetArrayType=BigInt64Array,e[Symbol.toStringTag]="LargeUtf8"))(kp.prototype);var ih=class extends yr{constructor(){super(Ft.Bool)}toString(){return"Bool"}};tit=Symbol.toStringTag;ih[tit]=(e=>(e.ArrayType=Uint8Array,e[Symbol.toStringTag]="Bool"))(ih.prototype);var Dp=class extends yr{constructor(t,r,i=128){super(Ft.Decimal),this.scale=t,this.precision=r,this.bitWidth=i}toString(){return`Decimal[${this.precision}e${this.scale>0?"+":""}${this.scale}]`}};eit=Symbol.toStringTag;Dp[eit]=(e=>(e.scale=null,e.precision=null,e.ArrayType=Uint32Array,e[Symbol.toStringTag]="Decimal"))(Dp.prototype);var nh=class extends yr{constructor(t){super(Ft.Date),this.unit=t}toString(){return`Date${(this.unit+1)*32}<${Qs[this.unit]}>`}};rit=Symbol.toStringTag;nh[rit]=(e=>(e.unit=null,e.ArrayType=Int32Array,e[Symbol.toStringTag]="Date"))(nh.prototype);var fx=class extends nh{constructor(){super(Qs.DAY)}},px=class extends nh{constructor(){super(Qs.MILLISECOND)}},yl=class extends yr{constructor(t,r){super(Ft.Time),this.unit=t,this.bitWidth=r}toString(){return`Time${this.bitWidth}<${wr[this.unit]}>`}get ArrayType(){switch(this.bitWidth){case 32:return Int32Array;case 64:return BigInt64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}};iit=Symbol.toStringTag;yl[iit]=(e=>(e.unit=null,e.bitWidth=null,e[Symbol.toStringTag]="Time"))(yl.prototype);var dx=class extends yl{constructor(){super(wr.SECOND,32)}},Ax=class extends yl{constructor(){super(wr.MILLISECOND,32)}},mx=class extends yl{constructor(){super(wr.MICROSECOND,64)}},gx=class extends yl{constructor(){super(wr.NANOSECOND,64)}},Bp=class extends yr{constructor(t,r){super(Ft.Timestamp),this.unit=t,this.timezone=r}toString(){return`Timestamp<${wr[this.unit]}${this.timezone?`, ${this.timezone}`:""}>`}};nit=Symbol.toStringTag;Bp[nit]=(e=>(e.unit=null,e.timezone=null,e.ArrayType=Int32Array,e[Symbol.toStringTag]="Timestamp"))(Bp.prototype);var sh=class extends yr{constructor(t){super(Ft.Interval),this.unit=t}toString(){return`Interval<${Co[this.unit]}>`}};sit=Symbol.toStringTag;sh[sit]=(e=>(e.unit=null,e.ArrayType=Int32Array,e[Symbol.toStringTag]="Interval"))(sh.prototype);var _x=class extends sh{constructor(){super(Co.DAY_TIME)}},yx=class extends sh{constructor(){super(Co.YEAR_MONTH)}},Op=class extends yr{constructor(t){super(Ft.Duration),this.unit=t}toString(){return`Duration<${wr[this.unit]}>`}};oit=Symbol.toStringTag;Op[oit]=(e=>(e.unit=null,e.ArrayType=BigInt64Array,e[Symbol.toStringTag]="Duration"))(Op.prototype);var vc=class extends yr{constructor(t){super(Ft.List),this.children=[t]}toString(){return`List<${this.valueType}>`}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}};ait=Symbol.toStringTag;vc[ait]=(e=>(e.children=null,e[Symbol.toStringTag]="List"))(vc.prototype);var es=class extends yr{constructor(t){super(Ft.Struct),this.children=t}toString(){return`Struct<{${this.children.map(t=>`${t.name}:${t.type}`).join(", ")}}>`}};lit=Symbol.toStringTag;es[lit]=(e=>(e.children=null,e[Symbol.toStringTag]="Struct"))(es.prototype);var oh=class extends yr{constructor(t,r,i){super(Ft.Union),this.mode=t,this.children=i,this.typeIds=r=Int32Array.from(r),this.typeIdToChildIndex=r.reduce((s,n,o)=>(s[n]=o)&&s||s,Object.create(null))}toString(){return`${this[Symbol.toStringTag]}<${this.children.map(t=>`${t.type}`).join(" | ")}>`}};cit=Symbol.toStringTag;oh[cit]=(e=>(e.mode=null,e.typeIds=null,e.children=null,e.typeIdToChildIndex=null,e.ArrayType=Int8Array,e[Symbol.toStringTag]="Union"))(oh.prototype);var Np=class extends yr{constructor(t){super(Ft.FixedSizeBinary),this.byteWidth=t}toString(){return`FixedSizeBinary[${this.byteWidth}]`}};uit=Symbol.toStringTag;Np[uit]=(e=>(e.byteWidth=null,e.ArrayType=Uint8Array,e[Symbol.toStringTag]="FixedSizeBinary"))(Np.prototype);var wc=class extends yr{constructor(t,r){super(Ft.FixedSizeList),this.listSize=t,this.children=[r]}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}toString(){return`FixedSizeList[${this.listSize}]<${this.valueType}>`}};hit=Symbol.toStringTag;wc[hit]=(e=>(e.children=null,e.listSize=null,e[Symbol.toStringTag]="FixedSizeList"))(wc.prototype);var ah=class extends yr{constructor(t,r=!1){var i,s,n;if(super(Ft.Map),this.children=[t],this.keysSorted=r,t&&(t.name="entries",!((i=t?.type)===null||i===void 0)&&i.children)){let o=(s=t?.type)===null||s===void 0?void 0:s.children[0];o&&(o.name="key");let c=(n=t?.type)===null||n===void 0?void 0:n.children[1];c&&(c.name="value")}}get keyType(){return this.children[0].type.children[0].type}get valueType(){return this.children[0].type.children[1].type}get childType(){return this.children[0].type}toString(){return`Map<{${this.children[0].type.children.map(t=>`${t.name}:${t.type}`).join(", ")}}>`}};fit=Symbol.toStringTag;ah[fit]=(e=>(e.children=null,e.keysSorted=null,e[Symbol.toStringTag]="Map_"))(ah.prototype);var k4t=(e=>()=>++e)(-1),xl=class extends yr{constructor(t,r,i,s){super(Ft.Dictionary),this.indices=r,this.dictionary=t,this.isOrdered=s||!1,this.id=i==null?k4t():Ks(i)}get children(){return this.dictionary.children}get valueType(){return this.dictionary}get ArrayType(){return this.dictionary.ArrayType}toString(){return`Dictionary<${this.indices}, ${this.dictionary}>`}};pit=Symbol.toStringTag;xl[pit]=(e=>(e.id=null,e.indices=null,e.isOrdered=null,e.dictionary=null,e[Symbol.toStringTag]="Dictionary"))(xl.prototype);function au(e){let t=e;switch(e.typeId){case Ft.Decimal:return e.bitWidth/32;case Ft.Timestamp:return 2;case Ft.Date:return 1+t.unit;case Ft.Interval:return 1+t.unit;case Ft.FixedSizeList:return t.listSize;case Ft.FixedSizeBinary:return t.byteWidth;default:return 1}}var Wr=class{visitMany(t,...r){return t.map((i,s)=>this.visit(i,...r.map(n=>n[s])))}visit(...t){return this.getVisitFn(t[0],!1).apply(this,t)}getVisitFn(t,r=!0){return D4t(this,t,r)}getVisitFnByTypeId(t,r=!0){return xx(this,t,r)}visitNull(t,...r){return null}visitBool(t,...r){return null}visitInt(t,...r){return null}visitFloat(t,...r){return null}visitUtf8(t,...r){return null}visitLargeUtf8(t,...r){return null}visitBinary(t,...r){return null}visitLargeBinary(t,...r){return null}visitFixedSizeBinary(t,...r){return null}visitDate(t,...r){return null}visitTimestamp(t,...r){return null}visitTime(t,...r){return null}visitDecimal(t,...r){return null}visitList(t,...r){return null}visitStruct(t,...r){return null}visitUnion(t,...r){return null}visitDictionary(t,...r){return null}visitInterval(t,...r){return null}visitDuration(t,...r){return null}visitFixedSizeList(t,...r){return null}visitMap(t,...r){return null}};function D4t(e,t,r=!0){return typeof t=="number"?xx(e,t,r):typeof t=="string"&&t in Ft?xx(e,Ft[t],r):t&&t instanceof yr?xx(e,dit(t),r):t?.type&&t.type instanceof yr?xx(e,dit(t.type),r):xx(e,Ft.NONE,r)}function xx(e,t,r=!0){let i=null;switch(t){case Ft.Null:i=e.visitNull;break;case Ft.Bool:i=e.visitBool;break;case Ft.Int:i=e.visitInt;break;case Ft.Int8:i=e.visitInt8||e.visitInt;break;case Ft.Int16:i=e.visitInt16||e.visitInt;break;case Ft.Int32:i=e.visitInt32||e.visitInt;break;case Ft.Int64:i=e.visitInt64||e.visitInt;break;case Ft.Uint8:i=e.visitUint8||e.visitInt;break;case Ft.Uint16:i=e.visitUint16||e.visitInt;break;case Ft.Uint32:i=e.visitUint32||e.visitInt;break;case Ft.Uint64:i=e.visitUint64||e.visitInt;break;case Ft.Float:i=e.visitFloat;break;case Ft.Float16:i=e.visitFloat16||e.visitFloat;break;case Ft.Float32:i=e.visitFloat32||e.visitFloat;break;case Ft.Float64:i=e.visitFloat64||e.visitFloat;break;case Ft.Utf8:i=e.visitUtf8;break;case Ft.LargeUtf8:i=e.visitLargeUtf8;break;case Ft.Binary:i=e.visitBinary;break;case Ft.LargeBinary:i=e.visitLargeBinary;break;case Ft.FixedSizeBinary:i=e.visitFixedSizeBinary;break;case Ft.Date:i=e.visitDate;break;case Ft.DateDay:i=e.visitDateDay||e.visitDate;break;case Ft.DateMillisecond:i=e.visitDateMillisecond||e.visitDate;break;case Ft.Timestamp:i=e.visitTimestamp;break;case Ft.TimestampSecond:i=e.visitTimestampSecond||e.visitTimestamp;break;case Ft.TimestampMillisecond:i=e.visitTimestampMillisecond||e.visitTimestamp;break;case Ft.TimestampMicrosecond:i=e.visitTimestampMicrosecond||e.visitTimestamp;break;case Ft.TimestampNanosecond:i=e.visitTimestampNanosecond||e.visitTimestamp;break;case Ft.Time:i=e.visitTime;break;case Ft.TimeSecond:i=e.visitTimeSecond||e.visitTime;break;case Ft.TimeMillisecond:i=e.visitTimeMillisecond||e.visitTime;break;case Ft.TimeMicrosecond:i=e.visitTimeMicrosecond||e.visitTime;break;case Ft.TimeNanosecond:i=e.visitTimeNanosecond||e.visitTime;break;case Ft.Decimal:i=e.visitDecimal;break;case Ft.List:i=e.visitList;break;case Ft.Struct:i=e.visitStruct;break;case Ft.Union:i=e.visitUnion;break;case Ft.DenseUnion:i=e.visitDenseUnion||e.visitUnion;break;case Ft.SparseUnion:i=e.visitSparseUnion||e.visitUnion;break;case Ft.Dictionary:i=e.visitDictionary;break;case Ft.Interval:i=e.visitInterval;break;case Ft.IntervalDayTime:i=e.visitIntervalDayTime||e.visitInterval;break;case Ft.IntervalYearMonth:i=e.visitIntervalYearMonth||e.visitInterval;break;case Ft.Duration:i=e.visitDuration;break;case Ft.DurationSecond:i=e.visitDurationSecond||e.visitDuration;break;case Ft.DurationMillisecond:i=e.visitDurationMillisecond||e.visitDuration;break;case Ft.DurationMicrosecond:i=e.visitDurationMicrosecond||e.visitDuration;break;case Ft.DurationNanosecond:i=e.visitDurationNanosecond||e.visitDuration;break;case Ft.FixedSizeList:i=e.visitFixedSizeList;break;case Ft.Map:i=e.visitMap;break}if(typeof i=="function")return i;if(!r)return()=>null;throw new Error(`Unrecognized type '${Ft[t]}'`)}function dit(e){switch(e.typeId){case Ft.Null:return Ft.Null;case Ft.Int:{let{bitWidth:t,isSigned:r}=e;switch(t){case 8:return r?Ft.Int8:Ft.Uint8;case 16:return r?Ft.Int16:Ft.Uint16;case 32:return r?Ft.Int32:Ft.Uint32;case 64:return r?Ft.Int64:Ft.Uint64}return Ft.Int}case Ft.Float:switch(e.precision){case ts.HALF:return Ft.Float16;case ts.SINGLE:return Ft.Float32;case ts.DOUBLE:return Ft.Float64}return Ft.Float;case Ft.Binary:return Ft.Binary;case Ft.LargeBinary:return Ft.LargeBinary;case Ft.Utf8:return Ft.Utf8;case Ft.LargeUtf8:return Ft.LargeUtf8;case Ft.Bool:return Ft.Bool;case Ft.Decimal:return Ft.Decimal;case Ft.Time:switch(e.unit){case wr.SECOND:return Ft.TimeSecond;case wr.MILLISECOND:return Ft.TimeMillisecond;case wr.MICROSECOND:return Ft.TimeMicrosecond;case wr.NANOSECOND:return Ft.TimeNanosecond}return Ft.Time;case Ft.Timestamp:switch(e.unit){case wr.SECOND:return Ft.TimestampSecond;case wr.MILLISECOND:return Ft.TimestampMillisecond;case wr.MICROSECOND:return Ft.TimestampMicrosecond;case wr.NANOSECOND:return Ft.TimestampNanosecond}return Ft.Timestamp;case Ft.Date:switch(e.unit){case Qs.DAY:return Ft.DateDay;case Qs.MILLISECOND:return Ft.DateMillisecond}return Ft.Date;case Ft.Interval:switch(e.unit){case Co.DAY_TIME:return Ft.IntervalDayTime;case Co.YEAR_MONTH:return Ft.IntervalYearMonth}return Ft.Interval;case Ft.Duration:switch(e.unit){case wr.SECOND:return Ft.DurationSecond;case wr.MILLISECOND:return Ft.DurationMillisecond;case wr.MICROSECOND:return Ft.DurationMicrosecond;case wr.NANOSECOND:return Ft.DurationNanosecond}return Ft.Duration;case Ft.Map:return Ft.Map;case Ft.List:return Ft.List;case Ft.Struct:return Ft.Struct;case Ft.Union:switch(e.mode){case as.Dense:return Ft.DenseUnion;case as.Sparse:return Ft.SparseUnion}return Ft.Union;case Ft.FixedSizeBinary:return Ft.FixedSizeBinary;case Ft.FixedSizeList:return Ft.FixedSizeList;case Ft.Dictionary:return Ft.Dictionary}throw new Error(`Unrecognized type '${Ft[e.typeId]}'`)}Wr.prototype.visitInt8=null;Wr.prototype.visitInt16=null;Wr.prototype.visitInt32=null;Wr.prototype.visitInt64=null;Wr.prototype.visitUint8=null;Wr.prototype.visitUint16=null;Wr.prototype.visitUint32=null;Wr.prototype.visitUint64=null;Wr.prototype.visitFloat16=null;Wr.prototype.visitFloat32=null;Wr.prototype.visitFloat64=null;Wr.prototype.visitDateDay=null;Wr.prototype.visitDateMillisecond=null;Wr.prototype.visitTimestampSecond=null;Wr.prototype.visitTimestampMillisecond=null;Wr.prototype.visitTimestampMicrosecond=null;Wr.prototype.visitTimestampNanosecond=null;Wr.prototype.visitTimeSecond=null;Wr.prototype.visitTimeMillisecond=null;Wr.prototype.visitTimeMicrosecond=null;Wr.prototype.visitTimeNanosecond=null;Wr.prototype.visitDenseUnion=null;Wr.prototype.visitSparseUnion=null;Wr.prototype.visitIntervalDayTime=null;Wr.prototype.visitIntervalYearMonth=null;Wr.prototype.visitDuration=null;Wr.prototype.visitDurationSecond=null;Wr.prototype.visitDurationMillisecond=null;Wr.prototype.visitDurationMicrosecond=null;Wr.prototype.visitDurationNanosecond=null;var AN={};sl(AN,{float64ToUint16:()=>C4,uint16ToFloat64:()=>DM});var Ait=new Float64Array(1),bx=new Uint32Array(Ait.buffer);function DM(e){let t=(e&31744)>>10,r=(e&1023)/1024,i=Math.pow(-1,(e&32768)>>15);switch(t){case 31:return i*(r?Number.NaN:1/0);case 0:return i*(r?6103515625e-14*r:0)}return i*Math.pow(2,t-15)*(1+r)}function C4(e){if(e!==e)return 32256;Ait[0]=e;let t=(bx[1]&2147483648)>>16&65535,r=bx[1]&2146435072,i=0;return r>=1089470464?bx[0]>0?r=31744:(r=(r&2080374784)>>16,i=(bx[1]&1048575)>>10):r<=1056964608?(i=1048576+(bx[1]&1048575),i=1048576+(i<<(r>>20)-998)>>21,r=0):(r=r-1056964608>>10,i=(bx[1]&1048575)+512>>10),t|r|i&65535}var ti=class extends Wr{};function pi(e){return(t,r,i)=>{if(t.setValid(r,i!=null))return e(t,r,i)}}var B4t=(e,t,r)=>{e[t]=Math.trunc(r/864e5)},mN=(e,t,r)=>{e[t]=Math.trunc(r%4294967296),e[t+1]=Math.trunc(r/4294967296)},O4t=(e,t,r)=>{e[t]=Math.trunc(r*1e3%4294967296),e[t+1]=Math.trunc(r*1e3/4294967296)},N4t=(e,t,r)=>{e[t]=Math.trunc(r*1e6%4294967296),e[t+1]=Math.trunc(r*1e6/4294967296)},mit=(e,t,r,i)=>{if(r+1<t.length){let s=Ks(t[r]),n=Ks(t[r+1]);e.set(i.subarray(0,n-s),s)}},F4t=({offset:e,values:t},r,i)=>{let s=e+r;i?t[s>>3]|=1<<s%8:t[s>>3]&=~(1<<s%8)},g0=({values:e},t,r)=>{e[t]=r},gN=({values:e},t,r)=>{e[t]=r},git=({values:e},t,r)=>{e[t]=C4(r)},L4t=(e,t,r)=>{switch(e.type.precision){case ts.HALF:return git(e,t,r);case ts.SINGLE:case ts.DOUBLE:return gN(e,t,r)}},BM=({values:e},t,r)=>{B4t(e,t,r.valueOf())},OM=({values:e},t,r)=>{mN(e,t*2,r.valueOf())},_N=({stride:e,values:t},r,i)=>{t.set(i.subarray(0,e),e*r)},_it=({values:e,valueOffsets:t},r,i)=>mit(e,t,r,i),yit=({values:e,valueOffsets:t},r,i)=>mit(e,t,r,Ep(i)),yN=(e,t,r)=>{e.type.unit===Qs.DAY?BM(e,t,r):OM(e,t,r)},NM=({values:e},t,r)=>mN(e,t*2,r/1e3),FM=({values:e},t,r)=>mN(e,t*2,r),LM=({values:e},t,r)=>O4t(e,t*2,r),zM=({values:e},t,r)=>N4t(e,t*2,r),xN=(e,t,r)=>{switch(e.type.unit){case wr.SECOND:return NM(e,t,r);case wr.MILLISECOND:return FM(e,t,r);case wr.MICROSECOND:return LM(e,t,r);case wr.NANOSECOND:return zM(e,t,r)}},UM=({values:e},t,r)=>{e[t]=r},VM=({values:e},t,r)=>{e[t]=r},jM=({values:e},t,r)=>{e[t]=r},$M=({values:e},t,r)=>{e[t]=r},bN=(e,t,r)=>{switch(e.type.unit){case wr.SECOND:return UM(e,t,r);case wr.MILLISECOND:return VM(e,t,r);case wr.MICROSECOND:return jM(e,t,r);case wr.NANOSECOND:return $M(e,t,r)}},vN=({values:e,stride:t},r,i)=>{e.set(i.subarray(0,t),t*r)},z4t=(e,t,r)=>{let i=e.children[0],s=e.valueOffsets,n=ja.getVisitFn(i);if(Array.isArray(r))for(let o=-1,c=s[t],f=s[t+1];c<f;)n(i,c++,r[++o]);else for(let o=-1,c=s[t],f=s[t+1];c<f;)n(i,c++,r.get(++o))},U4t=(e,t,r)=>{let i=e.children[0],{valueOffsets:s}=e,n=ja.getVisitFn(i),{[t]:o,[t+1]:c}=s,f=r instanceof Map?r.entries():Object.entries(r);for(let p of f)if(n(i,o,p),++o>=c)break},V4t=(e,t)=>(r,i,s,n)=>i&&r(i,e,t[n]),j4t=(e,t)=>(r,i,s,n)=>i&&r(i,e,t.get(n)),$4t=(e,t)=>(r,i,s,n)=>i&&r(i,e,t.get(s.name)),H4t=(e,t)=>(r,i,s,n)=>i&&r(i,e,t[s.name]),W4t=(e,t,r)=>{let i=e.type.children.map(n=>ja.getVisitFn(n.type)),s=r instanceof Map?$4t(t,r):r instanceof Li?j4t(t,r):Array.isArray(r)?V4t(t,r):H4t(t,r);e.type.children.forEach((n,o)=>s(i[o],e.children[o],n,o))},q4t=(e,t,r)=>{e.type.mode===as.Dense?xit(e,t,r):bit(e,t,r)},xit=(e,t,r)=>{let i=e.type.typeIdToChildIndex[e.typeIds[t]],s=e.children[i];ja.visit(s,e.valueOffsets[t],r)},bit=(e,t,r)=>{let i=e.type.typeIdToChildIndex[e.typeIds[t]],s=e.children[i];ja.visit(s,t,r)},Y4t=(e,t,r)=>{var i;(i=e.dictionary)===null||i===void 0||i.set(e.values[t],r)},wN=(e,t,r)=>{e.type.unit===Co.DAY_TIME?HM(e,t,r):WM(e,t,r)},HM=({values:e},t,r)=>{e.set(r.subarray(0,2),2*t)},WM=({values:e},t,r)=>{e[t]=r[0]*12+r[1]%12},qM=({values:e},t,r)=>{e[t]=r},YM=({values:e},t,r)=>{e[t]=r},XM=({values:e},t,r)=>{e[t]=r},ZM=({values:e},t,r)=>{e[t]=r},TN=(e,t,r)=>{switch(e.type.unit){case wr.SECOND:return qM(e,t,r);case wr.MILLISECOND:return YM(e,t,r);case wr.MICROSECOND:return XM(e,t,r);case wr.NANOSECOND:return ZM(e,t,r)}},X4t=(e,t,r)=>{let{stride:i}=e,s=e.children[0],n=ja.getVisitFn(s);if(Array.isArray(r))for(let o=-1,c=t*i;++o<i;)n(s,c+o,r[o]);else for(let o=-1,c=t*i;++o<i;)n(s,c+o,r.get(o))};ti.prototype.visitBool=pi(F4t);ti.prototype.visitInt=pi(g0);ti.prototype.visitInt8=pi(g0);ti.prototype.visitInt16=pi(g0);ti.prototype.visitInt32=pi(g0);ti.prototype.visitInt64=pi(g0);ti.prototype.visitUint8=pi(g0);ti.prototype.visitUint16=pi(g0);ti.prototype.visitUint32=pi(g0);ti.prototype.visitUint64=pi(g0);ti.prototype.visitFloat=pi(L4t);ti.prototype.visitFloat16=pi(git);ti.prototype.visitFloat32=pi(gN);ti.prototype.visitFloat64=pi(gN);ti.prototype.visitUtf8=pi(yit);ti.prototype.visitLargeUtf8=pi(yit);ti.prototype.visitBinary=pi(_it);ti.prototype.visitLargeBinary=pi(_it);ti.prototype.visitFixedSizeBinary=pi(_N);ti.prototype.visitDate=pi(yN);ti.prototype.visitDateDay=pi(BM);ti.prototype.visitDateMillisecond=pi(OM);ti.prototype.visitTimestamp=pi(xN);ti.prototype.visitTimestampSecond=pi(NM);ti.prototype.visitTimestampMillisecond=pi(FM);ti.prototype.visitTimestampMicrosecond=pi(LM);ti.prototype.visitTimestampNanosecond=pi(zM);ti.prototype.visitTime=pi(bN);ti.prototype.visitTimeSecond=pi(UM);ti.prototype.visitTimeMillisecond=pi(VM);ti.prototype.visitTimeMicrosecond=pi(jM);ti.prototype.visitTimeNanosecond=pi($M);ti.prototype.visitDecimal=pi(vN);ti.prototype.visitList=pi(z4t);ti.prototype.visitStruct=pi(W4t);ti.prototype.visitUnion=pi(q4t);ti.prototype.visitDenseUnion=pi(xit);ti.prototype.visitSparseUnion=pi(bit);ti.prototype.visitDictionary=pi(Y4t);ti.prototype.visitInterval=pi(wN);ti.prototype.visitIntervalDayTime=pi(HM);ti.prototype.visitIntervalYearMonth=pi(WM);ti.prototype.visitDuration=pi(TN);ti.prototype.visitDurationSecond=pi(qM);ti.prototype.visitDurationMillisecond=pi(YM);ti.prototype.visitDurationMicrosecond=pi(XM);ti.prototype.visitDurationNanosecond=pi(ZM);ti.prototype.visitFixedSizeList=pi(X4t);ti.prototype.visitMap=pi(U4t);var ja=new ti;var df=Symbol.for("parent"),vx=Symbol.for("rowIndex"),mm=class{constructor(t,r){return this[df]=t,this[vx]=r,new Proxy(this,new EN)}toArray(){return Object.values(this.toJSON())}toJSON(){let t=this[vx],r=this[df],i=r.type.children,s={};for(let n=-1,o=i.length;++n<o;)s[i[n].name]=Lo.visit(r.children[n],t);return s}toString(){return`{${[...this].map(([t,r])=>`${ff(t)}: ${ff(r)}`).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}[Symbol.iterator](){return new SN(this[df],this[vx])}},SN=class{constructor(t,r){this.childIndex=0,this.children=t.children,this.rowIndex=r,this.childFields=t.type.children,this.numChildren=this.childFields.length}[Symbol.iterator](){return this}next(){let t=this.childIndex;return t<this.numChildren?(this.childIndex=t+1,{done:!1,value:[this.childFields[t].name,Lo.visit(this.children[t],this.rowIndex)]}):{done:!0,value:null}}};Object.defineProperties(mm.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[df]:{writable:!0,enumerable:!1,configurable:!1,value:null},[vx]:{writable:!0,enumerable:!1,configurable:!1,value:-1}});var EN=class{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(t){return t[df].type.children.map(r=>r.name)}has(t,r){return t[df].type.children.findIndex(i=>i.name===r)!==-1}getOwnPropertyDescriptor(t,r){if(t[df].type.children.findIndex(i=>i.name===r)!==-1)return{writable:!0,enumerable:!0,configurable:!0}}get(t,r){if(Reflect.has(t,r))return t[r];let i=t[df].type.children.findIndex(s=>s.name===r);if(i!==-1){let s=Lo.visit(t[df].children[i],t[vx]);return Reflect.set(t,r,s),s}}set(t,r,i){let s=t[df].type.children.findIndex(n=>n.name===r);return s!==-1?(ja.visit(t[df].children[s],t[vx],i),Reflect.set(t,r,i)):Reflect.has(t,r)||typeof r=="symbol"?Reflect.set(t,r,i):!1}};var qr=class extends Wr{};function ai(e){return(t,r)=>t.getValid(r)?e(t,r):null}var Z4t=(e,t)=>864e5*e[t],IN=(e,t)=>4294967296*e[t+1]+(e[t]>>>0),G4t=(e,t)=>4294967296*(e[t+1]/1e3)+(e[t]>>>0)/1e3,Q4t=(e,t)=>4294967296*(e[t+1]/1e6)+(e[t]>>>0)/1e6,vit=e=>new Date(e),K4t=(e,t)=>vit(Z4t(e,t)),J4t=(e,t)=>vit(IN(e,t)),tTt=(e,t)=>null,wit=(e,t,r)=>{if(r+1>=t.length)return null;let i=Ks(t[r]),s=Ks(t[r+1]);return e.subarray(i,s)},eTt=({offset:e,values:t},r)=>{let i=e+r;return(t[i>>3]&1<<i%8)!==0},Tit=({values:e},t)=>K4t(e,t),Sit=({values:e},t)=>J4t(e,t*2),gm=({stride:e,values:t},r)=>t[e*r],rTt=({stride:e,values:t},r)=>DM(t[e*r]),Eit=({values:e},t)=>e[t],iTt=({stride:e,values:t},r)=>t.subarray(e*r,e*(r+1)),Iit=({values:e,valueOffsets:t},r)=>wit(e,t,r),Mit=({values:e,valueOffsets:t},r)=>{let i=wit(e,t,r);return i!==null?f4(i):null},nTt=({values:e},t)=>e[t],sTt=({type:e,values:t},r)=>e.precision!==ts.HALF?t[r]:DM(t[r]),oTt=(e,t)=>e.type.unit===Qs.DAY?Tit(e,t):Sit(e,t),Cit=({values:e},t)=>1e3*IN(e,t*2),Pit=({values:e},t)=>IN(e,t*2),Rit=({values:e},t)=>G4t(e,t*2),kit=({values:e},t)=>Q4t(e,t*2),aTt=(e,t)=>{switch(e.type.unit){case wr.SECOND:return Cit(e,t);case wr.MILLISECOND:return Pit(e,t);case wr.MICROSECOND:return Rit(e,t);case wr.NANOSECOND:return kit(e,t)}},Dit=({values:e},t)=>e[t],Bit=({values:e},t)=>e[t],Oit=({values:e},t)=>e[t],Nit=({values:e},t)=>e[t],lTt=(e,t)=>{switch(e.type.unit){case wr.SECOND:return Dit(e,t);case wr.MILLISECOND:return Bit(e,t);case wr.MICROSECOND:return Oit(e,t);case wr.NANOSECOND:return Nit(e,t)}},cTt=({values:e,stride:t},r)=>M4.decimal(e.subarray(t*r,t*(r+1))),uTt=(e,t)=>{let{valueOffsets:r,stride:i,children:s}=e,{[t*i]:n,[t*i+1]:o}=r,f=s[0].slice(n,o-n);return new Li([f])},hTt=(e,t)=>{let{valueOffsets:r,children:i}=e,{[t]:s,[t+1]:n}=r,o=i[0];return new Fp(o.slice(s,n-s))},fTt=(e,t)=>new mm(e,t),pTt=(e,t)=>e.type.mode===as.Dense?Fit(e,t):Lit(e,t),Fit=(e,t)=>{let r=e.type.typeIdToChildIndex[e.typeIds[t]],i=e.children[r];return Lo.visit(i,e.valueOffsets[t])},Lit=(e,t)=>{let r=e.type.typeIdToChildIndex[e.typeIds[t]],i=e.children[r];return Lo.visit(i,t)},dTt=(e,t)=>{var r;return(r=e.dictionary)===null||r===void 0?void 0:r.get(e.values[t])},ATt=(e,t)=>e.type.unit===Co.DAY_TIME?zit(e,t):Uit(e,t),zit=({values:e},t)=>e.subarray(2*t,2*(t+1)),Uit=({values:e},t)=>{let r=e[t],i=new Int32Array(2);return i[0]=Math.trunc(r/12),i[1]=Math.trunc(r%12),i},Vit=({values:e},t)=>e[t],jit=({values:e},t)=>e[t],$it=({values:e},t)=>e[t],Hit=({values:e},t)=>e[t],mTt=(e,t)=>{switch(e.type.unit){case wr.SECOND:return Vit(e,t);case wr.MILLISECOND:return jit(e,t);case wr.MICROSECOND:return $it(e,t);case wr.NANOSECOND:return Hit(e,t)}},gTt=(e,t)=>{let{stride:r,children:i}=e,n=i[0].slice(t*r,r);return new Li([n])};qr.prototype.visitNull=ai(tTt);qr.prototype.visitBool=ai(eTt);qr.prototype.visitInt=ai(nTt);qr.prototype.visitInt8=ai(gm);qr.prototype.visitInt16=ai(gm);qr.prototype.visitInt32=ai(gm);qr.prototype.visitInt64=ai(Eit);qr.prototype.visitUint8=ai(gm);qr.prototype.visitUint16=ai(gm);qr.prototype.visitUint32=ai(gm);qr.prototype.visitUint64=ai(Eit);qr.prototype.visitFloat=ai(sTt);qr.prototype.visitFloat16=ai(rTt);qr.prototype.visitFloat32=ai(gm);qr.prototype.visitFloat64=ai(gm);qr.prototype.visitUtf8=ai(Mit);qr.prototype.visitLargeUtf8=ai(Mit);qr.prototype.visitBinary=ai(Iit);qr.prototype.visitLargeBinary=ai(Iit);qr.prototype.visitFixedSizeBinary=ai(iTt);qr.prototype.visitDate=ai(oTt);qr.prototype.visitDateDay=ai(Tit);qr.prototype.visitDateMillisecond=ai(Sit);qr.prototype.visitTimestamp=ai(aTt);qr.prototype.visitTimestampSecond=ai(Cit);qr.prototype.visitTimestampMillisecond=ai(Pit);qr.prototype.visitTimestampMicrosecond=ai(Rit);qr.prototype.visitTimestampNanosecond=ai(kit);qr.prototype.visitTime=ai(lTt);qr.prototype.visitTimeSecond=ai(Dit);qr.prototype.visitTimeMillisecond=ai(Bit);qr.prototype.visitTimeMicrosecond=ai(Oit);qr.prototype.visitTimeNanosecond=ai(Nit);qr.prototype.visitDecimal=ai(cTt);qr.prototype.visitList=ai(uTt);qr.prototype.visitStruct=ai(fTt);qr.prototype.visitUnion=ai(pTt);qr.prototype.visitDenseUnion=ai(Fit);qr.prototype.visitSparseUnion=ai(Lit);qr.prototype.visitDictionary=ai(dTt);qr.prototype.visitInterval=ai(ATt);qr.prototype.visitIntervalDayTime=ai(zit);qr.prototype.visitIntervalYearMonth=ai(Uit);qr.prototype.visitDuration=ai(mTt);qr.prototype.visitDurationSecond=ai(Vit);qr.prototype.visitDurationMillisecond=ai(jit);qr.prototype.visitDurationMicrosecond=ai($it);qr.prototype.visitDurationNanosecond=ai(Hit);qr.prototype.visitFixedSizeList=ai(gTt);qr.prototype.visitMap=ai(hTt);var Lo=new qr;var lh=Symbol.for("keys"),wx=Symbol.for("vals"),Fp=class{constructor(t){return this[lh]=new Li([t.children[0]]).memoize(),this[wx]=t.children[1],new Proxy(this,new CN)}[Symbol.iterator](){return new MN(this[lh],this[wx])}get size(){return this[lh].length}toArray(){return Object.values(this.toJSON())}toJSON(){let t=this[lh],r=this[wx],i={};for(let s=-1,n=t.length;++s<n;)i[t.get(s)]=Lo.visit(r,s);return i}toString(){return`{${[...this].map(([t,r])=>`${ff(t)}: ${ff(r)}`).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}},MN=class{constructor(t,r){this.keys=t,this.vals=r,this.keyIndex=0,this.numKeys=t.length}[Symbol.iterator](){return this}next(){let t=this.keyIndex;return t===this.numKeys?{done:!0,value:null}:(this.keyIndex++,{done:!1,value:[this.keys.get(t),Lo.visit(this.vals,t)]})}},CN=class{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(t){return t[lh].toArray().map(String)}has(t,r){return t[lh].includes(r)}getOwnPropertyDescriptor(t,r){if(t[lh].indexOf(r)!==-1)return{writable:!0,enumerable:!0,configurable:!0}}get(t,r){if(Reflect.has(t,r))return t[r];let i=t[lh].indexOf(r);if(i!==-1){let s=Lo.visit(Reflect.get(t,wx),i);return Reflect.set(t,r,s),s}}set(t,r,i){let s=t[lh].indexOf(r);return s!==-1?(ja.visit(Reflect.get(t,wx),s,i),Reflect.set(t,r,i)):Reflect.has(t,r)?Reflect.set(t,r,i):!1}};Object.defineProperties(Fp.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[lh]:{writable:!0,enumerable:!1,configurable:!1,value:null},[wx]:{writable:!0,enumerable:!1,configurable:!1,value:null}});function _Tt(e,t,r){let i=e.length,s=t>-1?t:i+t%i;return r?r(e,s):s}var Wit;function P4(e,t,r,i){let{length:s=0}=e,n=typeof t!="number"?0:t,o=typeof r!="number"?s:r;return n<0&&(n=(n%s+s)%s),o<0&&(o=(o%s+s)%s),o<n&&(Wit=n,n=o,o=Wit),o>s&&(o=s),i?i(e,n,o):[n,o]}var qit=e=>e!==e;function _m(e){if(typeof e!=="object"||e===null)return qit(e)?qit:r=>r===e;if(e instanceof Date){let r=e.valueOf();return i=>i instanceof Date?i.valueOf()===r:!1}return ArrayBuffer.isView(e)?r=>r?lN(e,r):!1:e instanceof Map?xTt(e):Array.isArray(e)?yTt(e):e instanceof Li?bTt(e):vTt(e,!0)}function yTt(e){let t=[];for(let r=-1,i=e.length;++r<i;)t[r]=_m(e[r]);return GM(t)}function xTt(e){let t=-1,r=[];for(let i of e.values())r[++t]=_m(i);return GM(r)}function bTt(e){let t=[];for(let r=-1,i=e.length;++r<i;)t[r]=_m(e.get(r));return GM(t)}function vTt(e,t=!1){let r=Object.keys(e);if(!t&&r.length===0)return()=>!1;let i=[];for(let s=-1,n=r.length;++s<n;)i[s]=_m(e[r[s]]);return GM(i,r)}function GM(e,t){return r=>{if(!r||typeof r!="object")return!1;switch(r.constructor){case Array:return wTt(e,r);case Map:return Yit(e,r,r.keys());case Fp:case mm:case Object:case void 0:return Yit(e,r,t||Object.keys(r))}return r instanceof Li?TTt(e,r):!1}}function wTt(e,t){let r=e.length;if(t.length!==r)return!1;for(let i=-1;++i<r;)if(!e[i](t[i]))return!1;return!0}function TTt(e,t){let r=e.length;if(t.length!==r)return!1;for(let i=-1;++i<r;)if(!e[i](t.get(i)))return!1;return!0}function Yit(e,t,r){let i=r[Symbol.iterator](),s=t instanceof Map?t.keys():Object.keys(t)[Symbol.iterator](),n=t instanceof Map?t.values():Object.values(t)[Symbol.iterator](),o=0,c=e.length,f=n.next(),p=i.next(),x=s.next();for(;o<c&&!p.done&&!x.done&&!f.done&&!(p.value!==x.value||!e[o](f.value));++o,p=i.next(),x=s.next(),f=n.next());return o===c&&p.done&&x.done&&f.done?!0:(i.return&&i.return(),s.return&&s.return(),n.return&&n.return(),!1)}var RN={};sl(RN,{BitIterator:()=>n_,getBit:()=>Xit,getBool:()=>KM,packBools:()=>o_,popcnt_array:()=>Zit,popcnt_bit_range:()=>R4,popcnt_uint32:()=>QM,setBool:()=>STt,truncateBitmap:()=>s_});function KM(e,t,r,i){return(r&1<<i)!==0}function Xit(e,t,r,i){return(r&1<<i)>>i}function STt(e,t,r){return r?!!(e[t>>3]|=1<<t%8)||!0:!(e[t>>3]&=~(1<<t%8))&&!1}function s_(e,t,r){let i=r.byteLength+7&-8;if(e>0||r.byteLength<i){let s=new Uint8Array(i);return s.set(e%8===0?r.subarray(e>>3):o_(new n_(r,e,t,null,KM)).subarray(0,i)),s}return r}function o_(e){let t=[],r=0,i=0,s=0;for(let o of e)o&&(s|=1<<i),++i===8&&(t[r++]=s,s=i=0);(r===0||i>0)&&(t[r++]=s);let n=new Uint8Array(t.length+7&-8);return n.set(t),n}var n_=class{constructor(t,r,i,s,n){this.bytes=t,this.length=i,this.context=s,this.get=n,this.bit=r%8,this.byteIndex=r>>3,this.byte=t[this.byteIndex++],this.index=0}next(){return this.index<this.length?(this.bit===8&&(this.bit=0,this.byte=this.bytes[this.byteIndex++]),{value:this.get(this.context,this.index++,this.byte,this.bit++)}):{done:!0,value:null}}[Symbol.iterator](){return this}};function R4(e,t,r){if(r-t<=0)return 0;if(r-t<8){let n=0;for(let o of new n_(e,t,r-t,e,Xit))n+=o;return n}let i=r>>3<<3,s=t+(t%8===0?0:8-t%8);return R4(e,t,s)+R4(e,i,r)+Zit(e,s>>3,i-s>>3)}function Zit(e,t,r){let i=0,s=Math.trunc(t),n=new DataView(e.buffer,e.byteOffset,e.byteLength),o=r===void 0?e.byteLength:s+r;for(;o-s>=4;)i+=QM(n.getUint32(s)),s+=4;for(;o-s>=2;)i+=QM(n.getUint16(s)),s+=2;for(;o-s>=1;)i+=QM(n.getUint8(s)),s+=1;return i}function QM(e){let t=Math.trunc(e);return t=t-(t>>>1&1431655765),t=(t&858993459)+(t>>>2&858993459),(t+(t>>>4)&252645135)*16843009>>>24}var ETt=-1,An=class e{get typeId(){return this.type.typeId}get ArrayType(){return this.type.ArrayType}get buffers(){return[this.valueOffsets,this.values,this.nullBitmap,this.typeIds]}get nullable(){if(this._nullCount!==0){let{type:t}=this;return yr.isSparseUnion(t)?this.children.some(r=>r.nullable):yr.isDenseUnion(t)?this.children.some(r=>r.nullable):this.nullBitmap&&this.nullBitmap.byteLength>0}return!0}get byteLength(){let t=0,{valueOffsets:r,values:i,nullBitmap:s,typeIds:n}=this;return r&&(t+=r.byteLength),i&&(t+=i.byteLength),s&&(t+=s.byteLength),n&&(t+=n.byteLength),this.children.reduce((o,c)=>o+c.byteLength,t)}get nullCount(){if(yr.isUnion(this.type))return this.children.reduce((i,s)=>i+s.nullCount,0);let t=this._nullCount,r;return t<=ETt&&(r=this.nullBitmap)&&(this._nullCount=t=this.length-R4(r,this.offset,this.offset+this.length)),t}constructor(t,r,i,s,n,o=[],c){this.type=t,this.children=o,this.dictionary=c,this.offset=Math.floor(Math.max(r||0,0)),this.length=Math.floor(Math.max(i||0,0)),this._nullCount=Math.floor(Math.max(s||0,-1));let f;n instanceof e?(this.stride=n.stride,this.values=n.values,this.typeIds=n.typeIds,this.nullBitmap=n.nullBitmap,this.valueOffsets=n.valueOffsets):(this.stride=au(t),n&&((f=n[0])&&(this.valueOffsets=f),(f=n[1])&&(this.values=f),(f=n[2])&&(this.nullBitmap=f),(f=n[3])&&(this.typeIds=f)))}getValid(t){let{type:r}=this;if(yr.isUnion(r)){let i=r,s=this.children[i.typeIdToChildIndex[this.typeIds[t]]],n=i.mode===as.Dense?this.valueOffsets[t]:t;return s.getValid(n)}if(this.nullable&&this.nullCount>0){let i=this.offset+t;return(this.nullBitmap[i>>3]&1<<i%8)!==0}return!0}setValid(t,r){let i,{type:s}=this;if(yr.isUnion(s)){let n=s,o=this.children[n.typeIdToChildIndex[this.typeIds[t]]],c=n.mode===as.Dense?this.valueOffsets[t]:t;i=o.getValid(c),o.setValid(c,r)}else{let{nullBitmap:n}=this,{offset:o,length:c}=this,f=o+t,p=1<<f%8,x=f>>3;(!n||n.byteLength<=x)&&(n=new Uint8Array((o+c+63&-64)>>3).fill(255),this.nullCount>0&&n.set(s_(o,c,this.nullBitmap),0),Object.assign(this,{nullBitmap:n,_nullCount:-1}));let E=n[x];i=(E&p)!==0,r?n[x]=E|p:n[x]=E&~p}return i!==!!r&&(this._nullCount=this.nullCount+(r?-1:1)),r}clone(t=this.type,r=this.offset,i=this.length,s=this._nullCount,n=this,o=this.children){return new e(t,r,i,s,n,o,this.dictionary)}slice(t,r){let{stride:i,typeId:s,children:n}=this,o=+(this._nullCount===0)-1,c=s===16?i:1,f=this._sliceBuffers(t,r,i,s);return this.clone(this.type,this.offset+t,r,o,f,n.length===0||this.valueOffsets?n:this._sliceChildren(n,c*t,c*r))}_changeLengthAndBackfillNullBitmap(t){if(this.typeId===Ft.Null)return this.clone(this.type,0,t,0);let{length:r,nullCount:i}=this,s=new Uint8Array((t+63&-64)>>3).fill(255,0,r>>3);s[r>>3]=(1<<r-(r&-8))-1,i>0&&s.set(s_(this.offset,r,this.nullBitmap),0);let n=this.buffers;return n[eh.VALIDITY]=s,this.clone(this.type,0,t,i+(t-r),n)}_sliceBuffers(t,r,i,s){let n,{buffers:o}=this;return(n=o[eh.TYPE])&&(o[eh.TYPE]=n.subarray(t,t+r)),(n=o[eh.OFFSET])&&(o[eh.OFFSET]=n.subarray(t,t+r+1))||(n=o[eh.DATA])&&(o[eh.DATA]=s===6?n:n.subarray(i*t,i*(t+r))),o}_sliceChildren(t,r,i){return t.map(s=>s.slice(r,i))}};An.prototype.children=Object.freeze([]);var kN=class e extends Wr{visit(t){return this.getVisitFn(t.type).call(this,t)}visitNull(t){let{["type"]:r,["offset"]:i=0,["length"]:s=0}=t;return new An(r,i,s,s)}visitBool(t){let{["type"]:r,["offset"]:i=0}=t,s=ei(t.nullBitmap),n=Gi(r.ArrayType,t.data),{["length"]:o=n.length>>3,["nullCount"]:c=t.nullBitmap?-1:0}=t;return new An(r,i,o,c,[void 0,n,s])}visitInt(t){let{["type"]:r,["offset"]:i=0}=t,s=ei(t.nullBitmap),n=Gi(r.ArrayType,t.data),{["length"]:o=n.length,["nullCount"]:c=t.nullBitmap?-1:0}=t;return new An(r,i,o,c,[void 0,n,s])}visitFloat(t){let{["type"]:r,["offset"]:i=0}=t,s=ei(t.nullBitmap),n=Gi(r.ArrayType,t.data),{["length"]:o=n.length,["nullCount"]:c=t.nullBitmap?-1:0}=t;return new An(r,i,o,c,[void 0,n,s])}visitUtf8(t){let{["type"]:r,["offset"]:i=0}=t,s=ei(t.data),n=ei(t.nullBitmap),o=e_(t.valueOffsets),{["length"]:c=o.length-1,["nullCount"]:f=t.nullBitmap?-1:0}=t;return new An(r,i,c,f,[o,s,n])}visitLargeUtf8(t){let{["type"]:r,["offset"]:i=0}=t,s=ei(t.data),n=ei(t.nullBitmap),o=EM(t.valueOffsets),{["length"]:c=o.length-1,["nullCount"]:f=t.nullBitmap?-1:0}=t;return new An(r,i,c,f,[o,s,n])}visitBinary(t){let{["type"]:r,["offset"]:i=0}=t,s=ei(t.data),n=ei(t.nullBitmap),o=e_(t.valueOffsets),{["length"]:c=o.length-1,["nullCount"]:f=t.nullBitmap?-1:0}=t;return new An(r,i,c,f,[o,s,n])}visitLargeBinary(t){let{["type"]:r,["offset"]:i=0}=t,s=ei(t.data),n=ei(t.nullBitmap),o=EM(t.valueOffsets),{["length"]:c=o.length-1,["nullCount"]:f=t.nullBitmap?-1:0}=t;return new An(r,i,c,f,[o,s,n])}visitFixedSizeBinary(t){let{["type"]:r,["offset"]:i=0}=t,s=ei(t.nullBitmap),n=Gi(r.ArrayType,t.data),{["length"]:o=n.length/au(r),["nullCount"]:c=t.nullBitmap?-1:0}=t;return new An(r,i,o,c,[void 0,n,s])}visitDate(t){let{["type"]:r,["offset"]:i=0}=t,s=ei(t.nullBitmap),n=Gi(r.ArrayType,t.data),{["length"]:o=n.length/au(r),["nullCount"]:c=t.nullBitmap?-1:0}=t;return new An(r,i,o,c,[void 0,n,s])}visitTimestamp(t){let{["type"]:r,["offset"]:i=0}=t,s=ei(t.nullBitmap),n=Gi(r.ArrayType,t.data),{["length"]:o=n.length/au(r),["nullCount"]:c=t.nullBitmap?-1:0}=t;return new An(r,i,o,c,[void 0,n,s])}visitTime(t){let{["type"]:r,["offset"]:i=0}=t,s=ei(t.nullBitmap),n=Gi(r.ArrayType,t.data),{["length"]:o=n.length/au(r),["nullCount"]:c=t.nullBitmap?-1:0}=t;return new An(r,i,o,c,[void 0,n,s])}visitDecimal(t){let{["type"]:r,["offset"]:i=0}=t,s=ei(t.nullBitmap),n=Gi(r.ArrayType,t.data),{["length"]:o=n.length/au(r),["nullCount"]:c=t.nullBitmap?-1:0}=t;return new An(r,i,o,c,[void 0,n,s])}visitList(t){let{["type"]:r,["offset"]:i=0,["child"]:s}=t,n=ei(t.nullBitmap),o=e_(t.valueOffsets),{["length"]:c=o.length-1,["nullCount"]:f=t.nullBitmap?-1:0}=t;return new An(r,i,c,f,[o,void 0,n],[s])}visitStruct(t){let{["type"]:r,["offset"]:i=0,["children"]:s=[]}=t,n=ei(t.nullBitmap),{length:o=s.reduce((f,{length:p})=>Math.max(f,p),0),nullCount:c=t.nullBitmap?-1:0}=t;return new An(r,i,o,c,[void 0,void 0,n],s)}visitUnion(t){let{["type"]:r,["offset"]:i=0,["children"]:s=[]}=t,n=Gi(r.ArrayType,t.typeIds),{["length"]:o=n.length,["nullCount"]:c=-1}=t;if(yr.isSparseUnion(r))return new An(r,i,o,c,[void 0,void 0,void 0,n],s);let f=e_(t.valueOffsets);return new An(r,i,o,c,[f,void 0,void 0,n],s)}visitDictionary(t){let{["type"]:r,["offset"]:i=0}=t,s=ei(t.nullBitmap),n=Gi(r.indices.ArrayType,t.data),{["dictionary"]:o=new Li([new e().visit({type:r.dictionary})])}=t,{["length"]:c=n.length,["nullCount"]:f=t.nullBitmap?-1:0}=t;return new An(r,i,c,f,[void 0,n,s],[],o)}visitInterval(t){let{["type"]:r,["offset"]:i=0}=t,s=ei(t.nullBitmap),n=Gi(r.ArrayType,t.data),{["length"]:o=n.length/au(r),["nullCount"]:c=t.nullBitmap?-1:0}=t;return new An(r,i,o,c,[void 0,n,s])}visitDuration(t){let{["type"]:r,["offset"]:i=0}=t,s=ei(t.nullBitmap),n=Gi(r.ArrayType,t.data),{["length"]:o=n.length,["nullCount"]:c=t.nullBitmap?-1:0}=t;return new An(r,i,o,c,[void 0,n,s])}visitFixedSizeList(t){let{["type"]:r,["offset"]:i=0,["child"]:s=new e().visit({type:r.valueType})}=t,n=ei(t.nullBitmap),{["length"]:o=s.length/au(r),["nullCount"]:c=t.nullBitmap?-1:0}=t;return new An(r,i,o,c,[void 0,void 0,n],[s])}visitMap(t){let{["type"]:r,["offset"]:i=0,["child"]:s=new e().visit({type:r.childType})}=t,n=ei(t.nullBitmap),o=e_(t.valueOffsets),{["length"]:c=o.length-1,["nullCount"]:f=t.nullBitmap?-1:0}=t;return new An(r,i,c,f,[o,void 0,n],[s])}},ITt=new kN;function gi(e){return ITt.visit(e)}var k4=class{constructor(t=0,r){this.numChunks=t,this.getChunkIterator=r,this.chunkIndex=0,this.chunkIterator=this.getChunkIterator(0)}next(){for(;this.chunkIndex<this.numChunks;){let t=this.chunkIterator.next();if(!t.done)return t;++this.chunkIndex<this.numChunks&&(this.chunkIterator=this.getChunkIterator(this.chunkIndex))}return{done:!0,value:null}}[Symbol.iterator](){return this}};function Git(e){return e.some(t=>t.nullable)}function JM(e){return e.reduce((t,r)=>t+r.nullCount,0)}function t8(e){return e.reduce((t,r,i)=>(t[i+1]=t[i]+r.length,t),new Uint32Array(e.length+1))}function e8(e,t,r,i){let s=[];for(let n=-1,o=e.length;++n<o;){let c=e[n],f=t[n],{length:p}=c;if(f>=i)break;if(r>=f+p)continue;if(f>=r&&f+p<=i){s.push(c);continue}let x=Math.max(0,r-f),E=Math.min(i-f,p);s.push(c.slice(x,E-x))}return s.length===0&&s.push(e[0].slice(0,0)),s}function DN(e,t,r,i){let s=0,n=0,o=t.length-1;do{if(s>=o-1)return r<t[o]?i(e,s,r-t[s]):null;n=s+Math.trunc((o-s)*.5),r<t[n]?o=n:s=n}while(s<o)}function D4(e,t){return e.getValid(t)}function Tx(e){function t(r,i,s){return e(r[i],s)}return function(r){let i=this.data;return DN(i,this._offsets,r,t)}}function r8(e){let t;function r(i,s,n){return e(i[s],n,t)}return function(i,s){let n=this.data;t=s;let o=DN(n,this._offsets,i,r);return t=void 0,o}}function i8(e){let t;function r(i,s,n){let o=n,c=0,f=0;for(let p=s-1,x=i.length;++p<x;){let E=i[p];if(~(c=e(E,t,o)))return f+c;o=0,f+=E.length}return-1}return function(i,s){t=i;let n=this.data,o=typeof s!="number"?r(n,0,0):DN(n,this._offsets,s,r);return t=void 0,o}}var Yr=class extends Wr{};function MTt(e,t){return t===null&&e.length>0?0:-1}function CTt(e,t){let{nullBitmap:r}=e;if(!r||e.nullCount<=0)return-1;let i=0;for(let s of new n_(r,e.offset+(t||0),e.length,r,KM)){if(!s)return i;++i}return-1}function wi(e,t,r){if(t===void 0)return-1;if(t===null)switch(e.typeId){case Ft.Union:break;case Ft.Dictionary:break;default:return CTt(e,r)}let i=Lo.getVisitFn(e),s=_m(t);for(let n=(r||0)-1,o=e.length;++n<o;)if(s(i(e,n)))return n;return-1}function Qit(e,t,r){let i=Lo.getVisitFn(e),s=_m(t);for(let n=(r||0)-1,o=e.length;++n<o;)if(s(i(e,n)))return n;return-1}Yr.prototype.visitNull=MTt;Yr.prototype.visitBool=wi;Yr.prototype.visitInt=wi;Yr.prototype.visitInt8=wi;Yr.prototype.visitInt16=wi;Yr.prototype.visitInt32=wi;Yr.prototype.visitInt64=wi;Yr.prototype.visitUint8=wi;Yr.prototype.visitUint16=wi;Yr.prototype.visitUint32=wi;Yr.prototype.visitUint64=wi;Yr.prototype.visitFloat=wi;Yr.prototype.visitFloat16=wi;Yr.prototype.visitFloat32=wi;Yr.prototype.visitFloat64=wi;Yr.prototype.visitUtf8=wi;Yr.prototype.visitLargeUtf8=wi;Yr.prototype.visitBinary=wi;Yr.prototype.visitLargeBinary=wi;Yr.prototype.visitFixedSizeBinary=wi;Yr.prototype.visitDate=wi;Yr.prototype.visitDateDay=wi;Yr.prototype.visitDateMillisecond=wi;Yr.prototype.visitTimestamp=wi;Yr.prototype.visitTimestampSecond=wi;Yr.prototype.visitTimestampMillisecond=wi;Yr.prototype.visitTimestampMicrosecond=wi;Yr.prototype.visitTimestampNanosecond=wi;Yr.prototype.visitTime=wi;Yr.prototype.visitTimeSecond=wi;Yr.prototype.visitTimeMillisecond=wi;Yr.prototype.visitTimeMicrosecond=wi;Yr.prototype.visitTimeNanosecond=wi;Yr.prototype.visitDecimal=wi;Yr.prototype.visitList=wi;Yr.prototype.visitStruct=wi;Yr.prototype.visitUnion=wi;Yr.prototype.visitDenseUnion=Qit;Yr.prototype.visitSparseUnion=Qit;Yr.prototype.visitDictionary=wi;Yr.prototype.visitInterval=wi;Yr.prototype.visitIntervalDayTime=wi;Yr.prototype.visitIntervalYearMonth=wi;Yr.prototype.visitDuration=wi;Yr.prototype.visitDurationSecond=wi;Yr.prototype.visitDurationMillisecond=wi;Yr.prototype.visitDurationMicrosecond=wi;Yr.prototype.visitDurationNanosecond=wi;Yr.prototype.visitFixedSizeList=wi;Yr.prototype.visitMap=wi;var a_=new Yr;var Xr=class extends Wr{};function li(e){let{type:t}=e;if(e.nullCount===0&&e.stride===1&&(t.typeId===Ft.Timestamp||t instanceof fo&&t.bitWidth!==64||t instanceof yl&&t.bitWidth!==64||t instanceof Hl&&t.precision!==ts.HALF))return new k4(e.data.length,i=>{let s=e.data[i];return s.values.subarray(0,s.length)[Symbol.iterator]()});let r=0;return new k4(e.data.length,i=>{let n=e.data[i].length,o=e.slice(r,r+n);return r+=n,new BN(o)})}var BN=class{constructor(t){this.vector=t,this.index=0}next(){return this.index<this.vector.length?{value:this.vector.get(this.index++)}:{done:!0,value:null}}[Symbol.iterator](){return this}};Xr.prototype.visitNull=li;Xr.prototype.visitBool=li;Xr.prototype.visitInt=li;Xr.prototype.visitInt8=li;Xr.prototype.visitInt16=li;Xr.prototype.visitInt32=li;Xr.prototype.visitInt64=li;Xr.prototype.visitUint8=li;Xr.prototype.visitUint16=li;Xr.prototype.visitUint32=li;Xr.prototype.visitUint64=li;Xr.prototype.visitFloat=li;Xr.prototype.visitFloat16=li;Xr.prototype.visitFloat32=li;Xr.prototype.visitFloat64=li;Xr.prototype.visitUtf8=li;Xr.prototype.visitLargeUtf8=li;Xr.prototype.visitBinary=li;Xr.prototype.visitLargeBinary=li;Xr.prototype.visitFixedSizeBinary=li;Xr.prototype.visitDate=li;Xr.prototype.visitDateDay=li;Xr.prototype.visitDateMillisecond=li;Xr.prototype.visitTimestamp=li;Xr.prototype.visitTimestampSecond=li;Xr.prototype.visitTimestampMillisecond=li;Xr.prototype.visitTimestampMicrosecond=li;Xr.prototype.visitTimestampNanosecond=li;Xr.prototype.visitTime=li;Xr.prototype.visitTimeSecond=li;Xr.prototype.visitTimeMillisecond=li;Xr.prototype.visitTimeMicrosecond=li;Xr.prototype.visitTimeNanosecond=li;Xr.prototype.visitDecimal=li;Xr.prototype.visitList=li;Xr.prototype.visitStruct=li;Xr.prototype.visitUnion=li;Xr.prototype.visitDenseUnion=li;Xr.prototype.visitSparseUnion=li;Xr.prototype.visitDictionary=li;Xr.prototype.visitInterval=li;Xr.prototype.visitIntervalDayTime=li;Xr.prototype.visitIntervalYearMonth=li;Xr.prototype.visitDuration=li;Xr.prototype.visitDurationSecond=li;Xr.prototype.visitDurationMillisecond=li;Xr.prototype.visitDurationMicrosecond=li;Xr.prototype.visitDurationNanosecond=li;Xr.prototype.visitFixedSizeList=li;Xr.prototype.visitMap=li;var Sx=new Xr;var Kit,Jit={},tnt={},Li=class e{constructor(t){var r,i,s;let n=t[0]instanceof e?t.flatMap(c=>c.data):t;if(n.length===0||n.some(c=>!(c instanceof An)))throw new TypeError("Vector constructor expects an Array of Data instances.");let o=(r=n[0])===null||r===void 0?void 0:r.type;switch(n.length){case 0:this._offsets=[0];break;case 1:{let{get:c,set:f,indexOf:p}=Jit[o.typeId],x=n[0];this.isValid=E=>D4(x,E),this.get=E=>c(x,E),this.set=(E,T)=>f(x,E,T),this.indexOf=E=>p(x,E),this._offsets=[0,x.length];break}default:Object.setPrototypeOf(this,tnt[o.typeId]),this._offsets=t8(n);break}this.data=n,this.type=o,this.stride=au(o),this.numChildren=(s=(i=o.children)===null||i===void 0?void 0:i.length)!==null&&s!==void 0?s:0,this.length=this._offsets.at(-1)}get byteLength(){return this.data.reduce((t,r)=>t+r.byteLength,0)}get nullable(){return Git(this.data)}get nullCount(){return JM(this.data)}get ArrayType(){return this.type.ArrayType}get[Symbol.toStringTag](){return`${this.VectorName}<${this.type[Symbol.toStringTag]}>`}get VectorName(){return`${Ft[this.type.typeId]}Vector`}isValid(t){return!1}get(t){return null}set(t,r){}indexOf(t,r){return-1}includes(t,r){return this.indexOf(t,r)>-1}[Symbol.iterator](){return Sx.visit(this)}concat(...t){return new e(this.data.concat(t.flatMap(r=>r.data).flat(Number.POSITIVE_INFINITY)))}slice(t,r){return new e(P4(this,t,r,({data:i,_offsets:s},n,o)=>e8(i,s,n,o)))}toJSON(){return[...this]}toArray(){let{type:t,data:r,length:i,stride:s,ArrayType:n}=this;switch(t.typeId){case Ft.Int:case Ft.Float:case Ft.Decimal:case Ft.Time:case Ft.Timestamp:switch(r.length){case 0:return new n;case 1:return r[0].values.subarray(0,i*s);default:return r.reduce((o,{values:c,length:f})=>(o.array.set(c.subarray(0,f*s),o.offset),o.offset+=f*s,o),{array:new n(i*s),offset:0}).array}}return[...this]}toString(){return`[${[...this].join(",")}]`}getChild(t){var r;return this.getChildAt((r=this.type.children)===null||r===void 0?void 0:r.findIndex(i=>i.name===t))}getChildAt(t){return t>-1&&t<this.numChildren?new e(this.data.map(({children:r})=>r[t])):null}get isMemoized(){return yr.isDictionary(this.type)?this.data[0].dictionary.isMemoized:!1}memoize(){if(yr.isDictionary(this.type)){let t=new n8(this.data[0].dictionary),r=this.data.map(i=>{let s=i.clone();return s.dictionary=t,s});return new e(r)}return new n8(this)}unmemoize(){if(yr.isDictionary(this.type)&&this.isMemoized){let t=this.data[0].dictionary.unmemoize(),r=this.data.map(i=>{let s=i.clone();return s.dictionary=t,s});return new e(r)}return this}};Kit=Symbol.toStringTag;Li[Kit]=(e=>{e.type=yr.prototype,e.data=[],e.length=0,e.stride=1,e.numChildren=0,e._offsets=new Uint32Array([0]),e[Symbol.isConcatSpreadable]=!0;let t=Object.keys(Ft).map(r=>Ft[r]).filter(r=>typeof r=="number"&&r!==Ft.NONE);for(let r of t){let i=Lo.getVisitFnByTypeId(r),s=ja.getVisitFnByTypeId(r),n=a_.getVisitFnByTypeId(r);Jit[r]={get:i,set:s,indexOf:n},tnt[r]=Object.create(e,{isValid:{value:Tx(D4)},get:{value:Tx(Lo.getVisitFnByTypeId(r))},set:{value:r8(ja.getVisitFnByTypeId(r))},indexOf:{value:i8(a_.getVisitFnByTypeId(r))}})}return"Vector"})(Li.prototype);var n8=class e extends Li{constructor(t){super(t.data);let r=this.get,i=this.set,s=this.slice,n=new Array(this.length);Object.defineProperty(this,"get",{value(o){let c=n[o];if(c!==void 0)return c;let f=r.call(this,o);return n[o]=f,f}}),Object.defineProperty(this,"set",{value(o,c){i.call(this,o,c),n[o]=c}}),Object.defineProperty(this,"slice",{value:(o,c)=>new e(s.call(this,o,c))}),Object.defineProperty(this,"isMemoized",{value:!0}),Object.defineProperty(this,"unmemoize",{value:()=>new Li(this.data)}),Object.defineProperty(this,"memoize",{value:()=>this})}};function ent(e){if(!e||e.length<=0)return function(s){return!0};let t="",r=e.filter(i=>i===i);return r.length>0&&(t=`
    switch (x) {${r.map(i=>`
        case ${PTt(i)}:`).join("")}
            return false;
    }`),e.length!==r.length&&(t=`if (x !== x) return false;
${t}`),new Function("x",`${t}
return true;`)}function PTt(e){return typeof e!="bigint"?ff(e):`${ff(e)}n`}function ON(e,t){let r=Math.ceil(e)*t-1;return(r-r%64+64||64)/t}function rnt(e,t=0){return e.length>=t?e.subarray(0,t):d4(new e.constructor(t),e,0)}var Af=class{constructor(t,r=0,i=1){this.length=Math.ceil(r/i),this.buffer=new t(this.length),this.stride=i,this.BYTES_PER_ELEMENT=t.BYTES_PER_ELEMENT,this.ArrayType=t}get byteLength(){return Math.ceil(this.length*this.stride)*this.BYTES_PER_ELEMENT}get reservedLength(){return this.buffer.length/this.stride}get reservedByteLength(){return this.buffer.byteLength}set(t,r){return this}append(t){return this.set(this.length,t)}reserve(t){if(t>0){this.length+=t;let r=this.stride,i=this.length*r,s=this.buffer.length;i>=s&&this._resize(s===0?ON(i*1,this.BYTES_PER_ELEMENT):ON(i*2,this.BYTES_PER_ELEMENT))}return this}flush(t=this.length){t=ON(t*this.stride,this.BYTES_PER_ELEMENT);let r=rnt(this.buffer,t);return this.clear(),r}clear(){return this.length=0,this.buffer=new this.ArrayType,this}_resize(t){return this.buffer=rnt(this.buffer,t)}},_0=class extends Af{last(){return this.get(this.length-1)}get(t){return this.buffer[t]}set(t,r){return this.reserve(t-this.length+1),this.buffer[t*this.stride]=r,this}},Ex=class extends _0{constructor(){super(Uint8Array,0,1/8),this.numValid=0}get numInvalid(){return this.length-this.numValid}get(t){return this.buffer[t>>3]>>t%8&1}set(t,r){let{buffer:i}=this.reserve(t-this.length+1),s=t>>3,n=t%8,o=i[s]>>n&1;return r?o===0&&(i[s]|=1<<n,++this.numValid):o===1&&(i[s]&=~(1<<n),--this.numValid),this}clear(){return this.numValid=0,super.clear()}},Ix=class extends _0{constructor(t){super(t.OffsetArrayType,1,1)}append(t){return this.set(this.length-1,t)}set(t,r){let i=this.length-1,s=this.reserve(t-i+1).buffer;return i<t++&&i>=0&&s.fill(s[i],i,t),s[t]=s[t-1]+r,this}flush(t=this.length-1){return t>this.length&&this.set(t-1,this.BYTES_PER_ELEMENT>4?BigInt(0):0),super.flush(t+1)}};var Bs=class{static throughNode(t){throw new Error('"throughNode" not available in this environment')}static throughDOM(t){throw new Error('"throughDOM" not available in this environment')}constructor({type:t,nullValues:r}){this.length=0,this.finished=!1,this.type=t,this.children=[],this.nullValues=r,this.stride=au(t),this._nulls=new Ex,r&&r.length>0&&(this._isValid=ent(r))}toVector(){return new Li([this.flush()])}get ArrayType(){return this.type.ArrayType}get nullCount(){return this._nulls.numInvalid}get numChildren(){return this.children.length}get byteLength(){let t=0,{_offsets:r,_values:i,_nulls:s,_typeIds:n,children:o}=this;return r&&(t+=r.byteLength),i&&(t+=i.byteLength),s&&(t+=s.byteLength),n&&(t+=n.byteLength),o.reduce((c,f)=>c+f.byteLength,t)}get reservedLength(){return this._nulls.reservedLength}get reservedByteLength(){let t=0;return this._offsets&&(t+=this._offsets.reservedByteLength),this._values&&(t+=this._values.reservedByteLength),this._nulls&&(t+=this._nulls.reservedByteLength),this._typeIds&&(t+=this._typeIds.reservedByteLength),this.children.reduce((r,i)=>r+i.reservedByteLength,t)}get valueOffsets(){return this._offsets?this._offsets.buffer:null}get values(){return this._values?this._values.buffer:null}get nullBitmap(){return this._nulls?this._nulls.buffer:null}get typeIds(){return this._typeIds?this._typeIds.buffer:null}append(t){return this.set(this.length,t)}isValid(t){return this._isValid(t)}set(t,r){return this.setValid(t,this.isValid(r))&&this.setValue(t,r),this}setValue(t,r){this._setValue(this,t,r)}setValid(t,r){return this.length=this._nulls.set(t,+r).length,r}addChild(t,r=`${this.numChildren}`){throw new Error(`Cannot append children to non-nested type "${this.type}"`)}getChildAt(t){return this.children[t]||null}flush(){let t,r,i,s,{type:n,length:o,nullCount:c,_typeIds:f,_offsets:p,_values:x,_nulls:E}=this;(r=f?.flush(o))?s=p?.flush(o):(s=p?.flush(o))?t=x?.flush(p.last()):t=x?.flush(o),c>0&&(i=E?.flush(o));let T=this.children.map(D=>D.flush());return this.clear(),gi({type:n,length:o,nullCount:c,children:T,child:T[0],data:t,typeIds:r,nullBitmap:i,valueOffsets:s})}finish(){this.finished=!0;for(let t of this.children)t.finish();return this}clear(){var t,r,i,s;this.length=0,(t=this._nulls)===null||t===void 0||t.clear(),(r=this._values)===null||r===void 0||r.clear(),(i=this._offsets)===null||i===void 0||i.clear(),(s=this._typeIds)===null||s===void 0||s.clear();for(let n of this.children)n.clear();return this}};Bs.prototype.length=1;Bs.prototype.stride=1;Bs.prototype.children=null;Bs.prototype.finished=!1;Bs.prototype.nullValues=null;Bs.prototype._isValid=()=>!0;var zo=class extends Bs{constructor(t){super(t),this._values=new _0(this.ArrayType,0,this.stride)}setValue(t,r){let i=this._values;return i.reserve(t-i.length+1),super.setValue(t,r)}},Tc=class extends Bs{constructor(t){super(t),this._pendingLength=0,this._offsets=new Ix(t.type)}setValue(t,r){let i=this._pending||(this._pending=new Map),s=i.get(t);s&&(this._pendingLength-=s.length),this._pendingLength+=r instanceof Fp?r[lh].length:r.length,i.set(t,r)}setValid(t,r){return super.setValid(t,r)?!0:((this._pending||(this._pending=new Map)).set(t,void 0),!1)}clear(){return this._pendingLength=0,this._pending=void 0,super.clear()}flush(){return this._flush(),super.flush()}finish(){return this._flush(),super.finish()}_flush(){let t=this._pending,r=this._pendingLength;return this._pendingLength=0,this._pending=void 0,t&&t.size>0&&this._flushPending(t,r),this}};var l_=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}offset(){return this.bb.readInt64(this.bb_pos)}metaDataLength(){return this.bb.readInt32(this.bb_pos+8)}bodyLength(){return this.bb.readInt64(this.bb_pos+16)}static sizeOf(){return 24}static createBlock(t,r,i,s){return t.prep(8,24),t.writeInt64(BigInt(s??0)),t.pad(4),t.writeInt32(i),t.writeInt64(BigInt(r??0)),t.offset()}};var lu=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsFooter(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFooter(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}version(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Vn.V1}schema(t){let r=this.bb.__offset(this.bb_pos,6);return r?(t||new bc).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}dictionaries(t,r){let i=this.bb.__offset(this.bb_pos,8);return i?(r||new l_).__init(this.bb.__vector(this.bb_pos+i)+t*24,this.bb):null}dictionariesLength(){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}recordBatches(t,r){let i=this.bb.__offset(this.bb_pos,10);return i?(r||new l_).__init(this.bb.__vector(this.bb_pos+i)+t*24,this.bb):null}recordBatchesLength(){let t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__vector_len(this.bb_pos+t):0}customMetadata(t,r){let i=this.bb.__offset(this.bb_pos,12);return i?(r||new Qo).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+t*4),this.bb):null}customMetadataLength(){let t=this.bb.__offset(this.bb_pos,12);return t?this.bb.__vector_len(this.bb_pos+t):0}static startFooter(t){t.startObject(5)}static addVersion(t,r){t.addFieldInt16(0,r,Vn.V1)}static addSchema(t,r){t.addFieldOffset(1,r,0)}static addDictionaries(t,r){t.addFieldOffset(2,r,0)}static startDictionariesVector(t,r){t.startVector(24,r,8)}static addRecordBatches(t,r){t.addFieldOffset(3,r,0)}static startRecordBatchesVector(t,r){t.startVector(24,r,8)}static addCustomMetadata(t,r){t.addFieldOffset(4,r,0)}static createCustomMetadataVector(t,r){t.startVector(4,r.length,4);for(let i=r.length-1;i>=0;i--)t.addOffset(r[i]);return t.endVector()}static startCustomMetadataVector(t,r){t.startVector(4,r,4)}static endFooter(t){return t.endObject()}static finishFooterBuffer(t,r){t.finish(r)}static finishSizePrefixedFooterBuffer(t,r){t.finish(r,void 0,!0)}};var Nn=class e{constructor(t=[],r,i,s=Vn.V5){this.fields=t||[],this.metadata=r||new Map,i||(i=NN(t)),this.dictionaries=i,this.metadataVersion=s}get[Symbol.toStringTag](){return"Schema"}get names(){return this.fields.map(t=>t.name)}toString(){return`Schema<{ ${this.fields.map((t,r)=>`${r}: ${t}`).join(", ")} }>`}select(t){let r=new Set(t),i=this.fields.filter(s=>r.has(s.name));return new e(i,this.metadata)}selectAt(t){let r=t.map(i=>this.fields[i]).filter(Boolean);return new e(r,this.metadata)}assign(...t){let r=t[0]instanceof e?t[0]:Array.isArray(t[0])?new e(t[0]):new e(t),i=[...this.fields],s=s8(s8(new Map,this.metadata),r.metadata),n=r.fields.filter(c=>{let f=i.findIndex(p=>p.name===c.name);return~f?(i[f]=c.clone({metadata:s8(s8(new Map,i[f].metadata),c.metadata)}))&&!1:!0}),o=NN(n,new Map);return new e([...i,...n],s,new Map([...this.dictionaries,...o]))}};Nn.prototype.fields=null;Nn.prototype.metadata=null;Nn.prototype.dictionaries=null;var zi=class e{static new(...t){let[r,i,s,n]=t;return t[0]&&typeof t[0]=="object"&&({name:r}=t[0],i===void 0&&(i=t[0].type),s===void 0&&(s=t[0].nullable),n===void 0&&(n=t[0].metadata)),new e(`${r}`,i,s,n)}constructor(t,r,i=!1,s){this.name=t,this.type=r,this.nullable=i,this.metadata=s||new Map}get typeId(){return this.type.typeId}get[Symbol.toStringTag](){return"Field"}toString(){return`${this.name}: ${this.type}`}clone(...t){let[r,i,s,n]=t;return!t[0]||typeof t[0]!="object"?[r=this.name,i=this.type,s=this.nullable,n=this.metadata]=t:{name:r=this.name,type:i=this.type,nullable:s=this.nullable,metadata:n=this.metadata}=t[0],e.new(r,i,s,n)}};zi.prototype.type=null;zi.prototype.name=null;zi.prototype.nullable=null;zi.prototype.metadata=null;function s8(e,t){return new Map([...e||new Map,...t||new Map])}function NN(e,t=new Map){for(let r=-1,i=e.length;++r<i;){let n=e[r].type;if(yr.isDictionary(n)){if(!t.has(n.id))t.set(n.id,n.dictionary);else if(t.get(n.id)!==n.dictionary)throw new Error("Cannot create Schema containing two different dictionaries with the same Id")}n.children&&n.children.length>0&&NN(n.children,t)}return t}var RTt=r_,kTt=nu,y0=class{static decode(t){t=new kTt(ei(t));let r=lu.getRootAsFooter(t),i=Nn.decode(r.schema(),new Map,r.version());return new FN(i,r)}static encode(t){let r=new RTt,i=Nn.encode(r,t.schema);lu.startRecordBatchesVector(r,t.numRecordBatches);for(let o of[...t.recordBatches()].slice().reverse())x0.encode(r,o);let s=r.endVector();lu.startDictionariesVector(r,t.numDictionaries);for(let o of[...t.dictionaryBatches()].slice().reverse())x0.encode(r,o);let n=r.endVector();return lu.startFooter(r),lu.addSchema(r,i),lu.addVersion(r,Vn.V5),lu.addRecordBatches(r,s),lu.addDictionaries(r,n),lu.finishFooterBuffer(r,lu.endFooter(r)),r.asUint8Array()}get numRecordBatches(){return this._recordBatches.length}get numDictionaries(){return this._dictionaryBatches.length}constructor(t,r=Vn.V5,i,s){this.schema=t,this.version=r,i&&(this._recordBatches=i),s&&(this._dictionaryBatches=s)}*recordBatches(){for(let t,r=-1,i=this.numRecordBatches;++r<i;)(t=this.getRecordBatch(r))&&(yield t)}*dictionaryBatches(){for(let t,r=-1,i=this.numDictionaries;++r<i;)(t=this.getDictionaryBatch(r))&&(yield t)}getRecordBatch(t){return t>=0&&t<this.numRecordBatches&&this._recordBatches[t]||null}getDictionaryBatch(t){return t>=0&&t<this.numDictionaries&&this._dictionaryBatches[t]||null}};var FN=class extends y0{get numRecordBatches(){return this._footer.recordBatchesLength()}get numDictionaries(){return this._footer.dictionariesLength()}constructor(t,r){super(t,r.version()),this._footer=r}getRecordBatch(t){if(t>=0&&t<this.numRecordBatches){let r=this._footer.recordBatches(t);if(r)return x0.decode(r)}return null}getDictionaryBatch(t){if(t>=0&&t<this.numDictionaries){let r=this._footer.dictionaries(t);if(r)return x0.decode(r)}return null}},x0=class e{static decode(t){return new e(t.metaDataLength(),t.bodyLength(),t.offset())}static encode(t,r){let{metaDataLength:i}=r,s=BigInt(r.offset),n=BigInt(r.bodyLength);return l_.createBlock(t,s,i,n)}constructor(t,r,i){this.metaDataLength=t,this.offset=Ks(i),this.bodyLength=Ks(r)}};var Es=Object.freeze({done:!0,value:void 0}),B4=class{constructor(t){this._json=t}get schema(){return this._json.schema}get batches(){return this._json.batches||[]}get dictionaries(){return this._json.dictionaries||[]}},c_=class{tee(){return this._getDOMStream().tee()}pipe(t,r){return this._getNodeStream().pipe(t,r)}pipeTo(t,r){return this._getDOMStream().pipeTo(t,r)}pipeThrough(t,r){return this._getDOMStream().pipeThrough(t,r)}_getDOMStream(){return this._DOMStream||(this._DOMStream=this.toDOMStream())}_getNodeStream(){return this._nodeStream||(this._nodeStream=this.toNodeStream())}},o8=class extends c_{constructor(){super(),this._values=[],this.resolvers=[],this._closedPromise=new Promise(t=>this._closedPromiseResolve=t)}get closed(){return this._closedPromise}cancel(t){return gr(this,void 0,void 0,function*(){yield this.return(t)})}write(t){this._ensureOpen()&&(this.resolvers.length<=0?this._values.push(t):this.resolvers.shift().resolve({done:!1,value:t}))}abort(t){this._closedPromiseResolve&&(this.resolvers.length<=0?this._error={error:t}:this.resolvers.shift().reject({done:!0,value:t}))}close(){if(this._closedPromiseResolve){let{resolvers:t}=this;for(;t.length>0;)t.shift().resolve(Es);this._closedPromiseResolve(),this._closedPromiseResolve=void 0}}[Symbol.asyncIterator](){return this}toDOMStream(t){return Va.toDOMStream(this._closedPromiseResolve||this._error?this:this._values,t)}toNodeStream(t){return Va.toNodeStream(this._closedPromiseResolve||this._error?this:this._values,t)}throw(t){return gr(this,void 0,void 0,function*(){return yield this.abort(t),Es})}return(t){return gr(this,void 0,void 0,function*(){return yield this.close(),Es})}read(t){return gr(this,void 0,void 0,function*(){return(yield this.next(t,"read")).value})}peek(t){return gr(this,void 0,void 0,function*(){return(yield this.next(t,"peek")).value})}next(...t){return this._values.length>0?Promise.resolve({done:!1,value:this._values.shift()}):this._error?Promise.reject({done:!0,value:this._error.error}):this._closedPromiseResolve?new Promise((r,i)=>{this.resolvers.push({resolve:r,reject:i})}):Promise.resolve(Es)}_ensureOpen(){if(this._closedPromiseResolve)return!0;throw new Error("AsyncQueue is closed")}};var Lp=class extends o8{write(t){if((t=ei(t)).byteLength>0)return super.write(t)}toString(t=!1){return t?f4(this.toUint8Array(!0)):this.toUint8Array(!1).then(f4)}toUint8Array(t=!1){return t?iu(this._values)[0]:gr(this,void 0,void 0,function*(){var r,i,s,n;let o=[],c=0;try{for(var f=!0,p=of(this),x;x=yield p.next(),r=x.done,!r;f=!0){n=x.value,f=!1;let E=n;o.push(E),c+=E.byteLength}}catch(E){i={error:E}}finally{try{!f&&!r&&(s=p.return)&&(yield s.call(p))}finally{if(i)throw i.error}}return iu(o,c)[0]})}},zp=class{constructor(t){t&&(this.source=new LN(Va.fromIterable(t)))}[Symbol.iterator](){return this}next(t){return this.source.next(t)}throw(t){return this.source.throw(t)}return(t){return this.source.return(t)}peek(t){return this.source.peek(t)}read(t){return this.source.read(t)}},ch=class e{constructor(t){t instanceof e?this.source=t.source:t instanceof Lp?this.source=new b0(Va.fromAsyncIterable(t)):SM(t)?this.source=new b0(Va.fromNodeStream(t)):p4(t)?this.source=new b0(Va.fromDOMStream(t)):wM(t)?this.source=new b0(Va.fromDOMStream(t.body)):af(t)?this.source=new b0(Va.fromIterable(t)):ru(t)?this.source=new b0(Va.fromAsyncIterable(t)):Ju(t)&&(this.source=new b0(Va.fromAsyncIterable(t)))}[Symbol.asyncIterator](){return this}next(t){return this.source.next(t)}throw(t){return this.source.throw(t)}return(t){return this.source.return(t)}get closed(){return this.source.closed}cancel(t){return this.source.cancel(t)}peek(t){return this.source.peek(t)}read(t){return this.source.read(t)}},LN=class{constructor(t){this.source=t}cancel(t){this.return(t)}peek(t){return this.next(t,"peek").value}read(t){return this.next(t,"read").value}next(t,r="read"){return this.source.next({cmd:r,size:t})}throw(t){return Object.create(this.source.throw&&this.source.throw(t)||Es)}return(t){return Object.create(this.source.return&&this.source.return(t)||Es)}},b0=class{constructor(t){this.source=t,this._closedPromise=new Promise(r=>this._closedPromiseResolve=r)}cancel(t){return gr(this,void 0,void 0,function*(){yield this.return(t)})}get closed(){return this._closedPromise}read(t){return gr(this,void 0,void 0,function*(){return(yield this.next(t,"read")).value})}peek(t){return gr(this,void 0,void 0,function*(){return(yield this.next(t,"peek")).value})}next(t,r="read"){return gr(this,void 0,void 0,function*(){return yield this.source.next({cmd:r,size:t})})}throw(t){return gr(this,void 0,void 0,function*(){let r=this.source.throw&&(yield this.source.throw(t))||Es;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(r)})}return(t){return gr(this,void 0,void 0,function*(){let r=this.source.return&&(yield this.source.return(t))||Es;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(r)})}};var O4=class extends zp{constructor(t,r){super(),this.position=0,this.buffer=ei(t),this.size=r===void 0?this.buffer.byteLength:r}readInt32(t){let{buffer:r,byteOffset:i}=this.readAt(t,4);return new DataView(r,i).getInt32(0,!0)}seek(t){return this.position=Math.min(t,this.size),t<this.size}read(t){let{buffer:r,size:i,position:s}=this;return r&&s<i?(typeof t!="number"&&(t=Number.POSITIVE_INFINITY),this.position=Math.min(i,s+Math.min(i-s,t)),r.subarray(s,this.position)):null}readAt(t,r){let i=this.buffer,s=Math.min(this.size,t+r);return i?i.subarray(t,s):new Uint8Array(r)}close(){this.buffer&&(this.buffer=null)}throw(t){return this.close(),{done:!0,value:t}}return(t){return this.close(),{done:!0,value:t}}},ym=class extends ch{constructor(t,r){super(),this.position=0,this._handle=t,typeof r=="number"?this.size=r:this._pending=gr(this,void 0,void 0,function*(){this.size=(yield t.stat()).size,delete this._pending})}readInt32(t){return gr(this,void 0,void 0,function*(){let{buffer:r,byteOffset:i}=yield this.readAt(t,4);return new DataView(r,i).getInt32(0,!0)})}seek(t){return gr(this,void 0,void 0,function*(){return this._pending&&(yield this._pending),this.position=Math.min(t,this.size),t<this.size})}read(t){return gr(this,void 0,void 0,function*(){this._pending&&(yield this._pending);let{_handle:r,size:i,position:s}=this;if(r&&s<i){typeof t!="number"&&(t=Number.POSITIVE_INFINITY);let n=s,o=0,c=0,f=Math.min(i,n+Math.min(i-n,t)),p=new Uint8Array(Math.max(0,(this.position=f)-n));for(;(n+=c)<f&&(o+=c)<p.byteLength;)({bytesRead:c}=yield r.read(p,o,p.byteLength-o,n));return p}return null})}readAt(t,r){return gr(this,void 0,void 0,function*(){this._pending&&(yield this._pending);let{_handle:i,size:s}=this;if(i&&t+r<s){let n=Math.min(s,t+r),o=new Uint8Array(n-t);return(yield i.read(o,0,r,t)).buffer}return new Uint8Array(r)})}close(){return gr(this,void 0,void 0,function*(){let t=this._handle;this._handle=null,t&&(yield t.close())})}throw(t){return gr(this,void 0,void 0,function*(){return yield this.close(),{done:!0,value:t}})}return(t){return gr(this,void 0,void 0,function*(){return yield this.close(),{done:!0,value:t}})}};var UN={};sl(UN,{BaseInt64:()=>N4,Int128:()=>F4,Int64:()=>v0,Uint64:()=>Js});function Mx(e){return e<0&&(e=4294967295+e+1),`0x${e.toString(16)}`}var Cx=8,zN=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8],N4=class{constructor(t){this.buffer=t}high(){return this.buffer[1]}low(){return this.buffer[0]}_times(t){let r=new Uint32Array([this.buffer[1]>>>16,this.buffer[1]&65535,this.buffer[0]>>>16,this.buffer[0]&65535]),i=new Uint32Array([t.buffer[1]>>>16,t.buffer[1]&65535,t.buffer[0]>>>16,t.buffer[0]&65535]),s=r[3]*i[3];this.buffer[0]=s&65535;let n=s>>>16;return s=r[2]*i[3],n+=s,s=r[3]*i[2]>>>0,n+=s,this.buffer[0]+=n<<16,this.buffer[1]=n>>>0<s?65536:0,this.buffer[1]+=n>>>16,this.buffer[1]+=r[1]*i[3]+r[2]*i[2]+r[3]*i[1],this.buffer[1]+=r[0]*i[3]+r[1]*i[2]+r[2]*i[1]+r[3]*i[0]<<16,this}_plus(t){let r=this.buffer[0]+t.buffer[0]>>>0;this.buffer[1]+=t.buffer[1],r<this.buffer[0]>>>0&&++this.buffer[1],this.buffer[0]=r}lessThan(t){return this.buffer[1]<t.buffer[1]||this.buffer[1]===t.buffer[1]&&this.buffer[0]<t.buffer[0]}equals(t){return this.buffer[1]===t.buffer[1]&&this.buffer[0]==t.buffer[0]}greaterThan(t){return t.lessThan(this)}hex(){return`${Mx(this.buffer[1])} ${Mx(this.buffer[0])}`}},Js=class e extends N4{times(t){return this._times(t),this}plus(t){return this._plus(t),this}static from(t,r=new Uint32Array(2)){return e.fromString(typeof t=="string"?t:t.toString(),r)}static fromNumber(t,r=new Uint32Array(2)){return e.fromString(t.toString(),r)}static fromString(t,r=new Uint32Array(2)){let i=t.length,s=new e(r);for(let n=0;n<i;){let o=Cx<i-n?Cx:i-n,c=new e(new Uint32Array([Number.parseInt(t.slice(n,n+o),10),0])),f=new e(new Uint32Array([zN[o],0]));s.times(f),s.plus(c),n+=o}return s}static convertArray(t){let r=new Uint32Array(t.length*2);for(let i=-1,s=t.length;++i<s;)e.from(t[i],new Uint32Array(r.buffer,r.byteOffset+2*i*4,2));return r}static multiply(t,r){return new e(new Uint32Array(t.buffer)).times(r)}static add(t,r){return new e(new Uint32Array(t.buffer)).plus(r)}},v0=class e extends N4{negate(){return this.buffer[0]=~this.buffer[0]+1,this.buffer[1]=~this.buffer[1],this.buffer[0]==0&&++this.buffer[1],this}times(t){return this._times(t),this}plus(t){return this._plus(t),this}lessThan(t){let r=this.buffer[1]<<0,i=t.buffer[1]<<0;return r<i||r===i&&this.buffer[0]<t.buffer[0]}static from(t,r=new Uint32Array(2)){return e.fromString(typeof t=="string"?t:t.toString(),r)}static fromNumber(t,r=new Uint32Array(2)){return e.fromString(t.toString(),r)}static fromString(t,r=new Uint32Array(2)){let i=t.startsWith("-"),s=t.length,n=new e(r);for(let o=i?1:0;o<s;){let c=Cx<s-o?Cx:s-o,f=new e(new Uint32Array([Number.parseInt(t.slice(o,o+c),10),0])),p=new e(new Uint32Array([zN[c],0]));n.times(p),n.plus(f),o+=c}return i?n.negate():n}static convertArray(t){let r=new Uint32Array(t.length*2);for(let i=-1,s=t.length;++i<s;)e.from(t[i],new Uint32Array(r.buffer,r.byteOffset+2*i*4,2));return r}static multiply(t,r){return new e(new Uint32Array(t.buffer)).times(r)}static add(t,r){return new e(new Uint32Array(t.buffer)).plus(r)}},F4=class e{constructor(t){this.buffer=t}high(){return new v0(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2))}low(){return new v0(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset,2))}negate(){return this.buffer[0]=~this.buffer[0]+1,this.buffer[1]=~this.buffer[1],this.buffer[2]=~this.buffer[2],this.buffer[3]=~this.buffer[3],this.buffer[0]==0&&++this.buffer[1],this.buffer[1]==0&&++this.buffer[2],this.buffer[2]==0&&++this.buffer[3],this}times(t){let r=new Js(new Uint32Array([this.buffer[3],0])),i=new Js(new Uint32Array([this.buffer[2],0])),s=new Js(new Uint32Array([this.buffer[1],0])),n=new Js(new Uint32Array([this.buffer[0],0])),o=new Js(new Uint32Array([t.buffer[3],0])),c=new Js(new Uint32Array([t.buffer[2],0])),f=new Js(new Uint32Array([t.buffer[1],0])),p=new Js(new Uint32Array([t.buffer[0],0])),x=Js.multiply(n,p);this.buffer[0]=x.low();let E=new Js(new Uint32Array([x.high(),0]));return x=Js.multiply(s,p),E.plus(x),x=Js.multiply(n,f),E.plus(x),this.buffer[1]=E.low(),this.buffer[3]=E.lessThan(x)?1:0,this.buffer[2]=E.high(),new Js(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2)).plus(Js.multiply(i,p)).plus(Js.multiply(s,f)).plus(Js.multiply(n,c)),this.buffer[3]+=Js.multiply(r,p).plus(Js.multiply(i,f)).plus(Js.multiply(s,c)).plus(Js.multiply(n,o)).low(),this}plus(t){let r=new Uint32Array(4);return r[3]=this.buffer[3]+t.buffer[3]>>>0,r[2]=this.buffer[2]+t.buffer[2]>>>0,r[1]=this.buffer[1]+t.buffer[1]>>>0,r[0]=this.buffer[0]+t.buffer[0]>>>0,r[0]<this.buffer[0]>>>0&&++r[1],r[1]<this.buffer[1]>>>0&&++r[2],r[2]<this.buffer[2]>>>0&&++r[3],this.buffer[3]=r[3],this.buffer[2]=r[2],this.buffer[1]=r[1],this.buffer[0]=r[0],this}hex(){return`${Mx(this.buffer[3])} ${Mx(this.buffer[2])} ${Mx(this.buffer[1])} ${Mx(this.buffer[0])}`}static multiply(t,r){return new e(new Uint32Array(t.buffer)).times(r)}static add(t,r){return new e(new Uint32Array(t.buffer)).plus(r)}static from(t,r=new Uint32Array(4)){return e.fromString(typeof t=="string"?t:t.toString(),r)}static fromNumber(t,r=new Uint32Array(4)){return e.fromString(t.toString(),r)}static fromString(t,r=new Uint32Array(4)){let i=t.startsWith("-"),s=t.length,n=new e(r);for(let o=i?1:0;o<s;){let c=Cx<s-o?Cx:s-o,f=new e(new Uint32Array([Number.parseInt(t.slice(o,o+c),10),0,0,0])),p=new e(new Uint32Array([zN[c],0,0,0]));n.times(p),n.plus(f),o+=c}return i?n.negate():n}static convertArray(t){let r=new Uint32Array(t.length*4);for(let i=-1,s=t.length;++i<s;)e.from(t[i],new Uint32Array(r.buffer,r.byteOffset+4*4*i,4));return r}};var L4=class extends Wr{constructor(t,r,i,s,n=Vn.V5){super(),this.nodesIndex=-1,this.buffersIndex=-1,this.bytes=t,this.nodes=r,this.buffers=i,this.dictionaries=s,this.metadataVersion=n}visit(t){return super.visit(t instanceof zi?t.type:t)}visitNull(t,{length:r}=this.nextFieldNode()){return gi({type:t,length:r})}visitBool(t,{length:r,nullCount:i}=this.nextFieldNode()){return gi({type:t,length:r,nullCount:i,nullBitmap:this.readNullBitmap(t,i),data:this.readData(t)})}visitInt(t,{length:r,nullCount:i}=this.nextFieldNode()){return gi({type:t,length:r,nullCount:i,nullBitmap:this.readNullBitmap(t,i),data:this.readData(t)})}visitFloat(t,{length:r,nullCount:i}=this.nextFieldNode()){return gi({type:t,length:r,nullCount:i,nullBitmap:this.readNullBitmap(t,i),data:this.readData(t)})}visitUtf8(t,{length:r,nullCount:i}=this.nextFieldNode()){return gi({type:t,length:r,nullCount:i,nullBitmap:this.readNullBitmap(t,i),valueOffsets:this.readOffsets(t),data:this.readData(t)})}visitLargeUtf8(t,{length:r,nullCount:i}=this.nextFieldNode()){return gi({type:t,length:r,nullCount:i,nullBitmap:this.readNullBitmap(t,i),valueOffsets:this.readOffsets(t),data:this.readData(t)})}visitBinary(t,{length:r,nullCount:i}=this.nextFieldNode()){return gi({type:t,length:r,nullCount:i,nullBitmap:this.readNullBitmap(t,i),valueOffsets:this.readOffsets(t),data:this.readData(t)})}visitLargeBinary(t,{length:r,nullCount:i}=this.nextFieldNode()){return gi({type:t,length:r,nullCount:i,nullBitmap:this.readNullBitmap(t,i),valueOffsets:this.readOffsets(t),data:this.readData(t)})}visitFixedSizeBinary(t,{length:r,nullCount:i}=this.nextFieldNode()){return gi({type:t,length:r,nullCount:i,nullBitmap:this.readNullBitmap(t,i),data:this.readData(t)})}visitDate(t,{length:r,nullCount:i}=this.nextFieldNode()){return gi({type:t,length:r,nullCount:i,nullBitmap:this.readNullBitmap(t,i),data:this.readData(t)})}visitTimestamp(t,{length:r,nullCount:i}=this.nextFieldNode()){return gi({type:t,length:r,nullCount:i,nullBitmap:this.readNullBitmap(t,i),data:this.readData(t)})}visitTime(t,{length:r,nullCount:i}=this.nextFieldNode()){return gi({type:t,length:r,nullCount:i,nullBitmap:this.readNullBitmap(t,i),data:this.readData(t)})}visitDecimal(t,{length:r,nullCount:i}=this.nextFieldNode()){return gi({type:t,length:r,nullCount:i,nullBitmap:this.readNullBitmap(t,i),data:this.readData(t)})}visitList(t,{length:r,nullCount:i}=this.nextFieldNode()){return gi({type:t,length:r,nullCount:i,nullBitmap:this.readNullBitmap(t,i),valueOffsets:this.readOffsets(t),child:this.visit(t.children[0])})}visitStruct(t,{length:r,nullCount:i}=this.nextFieldNode()){return gi({type:t,length:r,nullCount:i,nullBitmap:this.readNullBitmap(t,i),children:this.visitMany(t.children)})}visitUnion(t,{length:r,nullCount:i}=this.nextFieldNode()){return this.metadataVersion<Vn.V5&&this.readNullBitmap(t,i),t.mode===as.Sparse?this.visitSparseUnion(t,{length:r,nullCount:i}):this.visitDenseUnion(t,{length:r,nullCount:i})}visitDenseUnion(t,{length:r,nullCount:i}=this.nextFieldNode()){return gi({type:t,length:r,nullCount:i,typeIds:this.readTypeIds(t),valueOffsets:this.readOffsets(t),children:this.visitMany(t.children)})}visitSparseUnion(t,{length:r,nullCount:i}=this.nextFieldNode()){return gi({type:t,length:r,nullCount:i,typeIds:this.readTypeIds(t),children:this.visitMany(t.children)})}visitDictionary(t,{length:r,nullCount:i}=this.nextFieldNode()){return gi({type:t,length:r,nullCount:i,nullBitmap:this.readNullBitmap(t,i),data:this.readData(t.indices),dictionary:this.readDictionary(t)})}visitInterval(t,{length:r,nullCount:i}=this.nextFieldNode()){return gi({type:t,length:r,nullCount:i,nullBitmap:this.readNullBitmap(t,i),data:this.readData(t)})}visitDuration(t,{length:r,nullCount:i}=this.nextFieldNode()){return gi({type:t,length:r,nullCount:i,nullBitmap:this.readNullBitmap(t,i),data:this.readData(t)})}visitFixedSizeList(t,{length:r,nullCount:i}=this.nextFieldNode()){return gi({type:t,length:r,nullCount:i,nullBitmap:this.readNullBitmap(t,i),child:this.visit(t.children[0])})}visitMap(t,{length:r,nullCount:i}=this.nextFieldNode()){return gi({type:t,length:r,nullCount:i,nullBitmap:this.readNullBitmap(t,i),valueOffsets:this.readOffsets(t),child:this.visit(t.children[0])})}nextFieldNode(){return this.nodes[++this.nodesIndex]}nextBufferRange(){return this.buffers[++this.buffersIndex]}readNullBitmap(t,r,i=this.nextBufferRange()){return r>0&&this.readData(t,i)||new Uint8Array(0)}readOffsets(t,r){return this.readData(t,r)}readTypeIds(t,r){return this.readData(t,r)}readData(t,{length:r,offset:i}=this.nextBufferRange()){return this.bytes.subarray(i,i+r)}readDictionary(t){return this.dictionaries.get(t.id)}},a8=class extends L4{constructor(t,r,i,s,n){super(new Uint8Array(0),r,i,s,n),this.sources=t}readNullBitmap(t,r,{offset:i}=this.nextBufferRange()){return r<=0?new Uint8Array(0):o_(this.sources[i])}readOffsets(t,{offset:r}=this.nextBufferRange()){return Gi(Uint8Array,Gi(t.OffsetArrayType,this.sources[r]))}readTypeIds(t,{offset:r}=this.nextBufferRange()){return Gi(Uint8Array,Gi(t.ArrayType,this.sources[r]))}readData(t,{offset:r}=this.nextBufferRange()){let{sources:i}=this;return yr.isTimestamp(t)?Gi(Uint8Array,v0.convertArray(i[r])):(yr.isInt(t)||yr.isTime(t))&&t.bitWidth===64||yr.isDuration(t)?Gi(Uint8Array,v0.convertArray(i[r])):yr.isDate(t)&&t.unit===Qs.MILLISECOND?Gi(Uint8Array,v0.convertArray(i[r])):yr.isDecimal(t)?Gi(Uint8Array,F4.convertArray(i[r])):yr.isBinary(t)||yr.isLargeBinary(t)||yr.isFixedSizeBinary(t)?DTt(i[r]):yr.isBool(t)?o_(i[r]):yr.isUtf8(t)||yr.isLargeUtf8(t)?Ep(i[r].join("")):Gi(Uint8Array,Gi(t.ArrayType,i[r].map(s=>+s)))}};function DTt(e){let t=e.join(""),r=new Uint8Array(t.length/2);for(let i=0;i<t.length;i+=2)r[i>>1]=Number.parseInt(t.slice(i,i+2),16);return r}var Px=class extends Tc{constructor(t){super(t),this._values=new Af(Uint8Array)}get byteLength(){let t=this._pendingLength+this.length*4;return this._offsets&&(t+=this._offsets.byteLength),this._values&&(t+=this._values.byteLength),this._nulls&&(t+=this._nulls.byteLength),t}setValue(t,r){return super.setValue(t,ei(r))}_flushPending(t,r){let i=this._offsets,s=this._values.reserve(r).buffer,n=0;for(let[o,c]of t)if(c===void 0)i.set(o,0);else{let f=c.length;s.set(c,n),i.set(o,f),n+=f}}};var Rx=class extends Tc{constructor(t){super(t),this._values=new Af(Uint8Array)}get byteLength(){let t=this._pendingLength+this.length*4;return this._offsets&&(t+=this._offsets.byteLength),this._values&&(t+=this._values.byteLength),this._nulls&&(t+=this._nulls.byteLength),t}setValue(t,r){return super.setValue(t,ei(r))}_flushPending(t,r){let i=this._offsets,s=this._values.reserve(r).buffer,n=0;for(let[o,c]of t)if(c===void 0)i.set(o,BigInt(0));else{let f=c.length;s.set(c,n),i.set(o,BigInt(f)),n+=f}}};var l8=class extends Bs{constructor(t){super(t),this._values=new Ex}setValue(t,r){this._values.set(t,+r)}};var u_=class extends zo{};u_.prototype._setValue=yN;var z4=class extends u_{};z4.prototype._setValue=BM;var U4=class extends u_{};U4.prototype._setValue=OM;var V4=class extends zo{};V4.prototype._setValue=vN;var c8=class extends Bs{constructor({type:t,nullValues:r,dictionaryHashFunction:i}){super({type:new xl(t.dictionary,t.indices,t.id,t.isOrdered)}),this._nulls=null,this._dictionaryOffset=0,this._keysToIndices=Object.create(null),this.indices=Up({type:this.type.indices,nullValues:r}),this.dictionary=Up({type:this.type.dictionary,nullValues:null}),typeof i=="function"&&(this.valueToKey=i)}get values(){return this.indices.values}get nullCount(){return this.indices.nullCount}get nullBitmap(){return this.indices.nullBitmap}get byteLength(){return this.indices.byteLength+this.dictionary.byteLength}get reservedLength(){return this.indices.reservedLength+this.dictionary.reservedLength}get reservedByteLength(){return this.indices.reservedByteLength+this.dictionary.reservedByteLength}isValid(t){return this.indices.isValid(t)}setValid(t,r){let i=this.indices;return r=i.setValid(t,r),this.length=i.length,r}setValue(t,r){let i=this._keysToIndices,s=this.valueToKey(r),n=i[s];return n===void 0&&(i[s]=n=this._dictionaryOffset+this.dictionary.append(r).length-1),this.indices.setValue(t,n)}flush(){let t=this.type,r=this._dictionary,i=this.dictionary.toVector(),s=this.indices.flush().clone(t);return s.dictionary=r?r.concat(i):i,this.finished||(this._dictionaryOffset+=i.length),this._dictionary=s.dictionary,this.clear(),s}finish(){return this.indices.finish(),this.dictionary.finish(),this._dictionaryOffset=0,this._keysToIndices=Object.create(null),super.finish()}clear(){return this.indices.clear(),this.dictionary.clear(),super.clear()}valueToKey(t){return typeof t=="string"?t:`${t}`}};var j4=class extends zo{};j4.prototype._setValue=_N;var u8=class extends Bs{setValue(t,r){let[i]=this.children,s=t*this.stride;for(let n=-1,o=r.length;++n<o;)i.set(s+n,r[n])}addChild(t,r="0"){if(this.numChildren>0)throw new Error("FixedSizeListBuilder can only have one child.");let i=this.children.push(t);return this.type=new wc(this.type.listSize,new zi(r,t.type,!0)),i}};var h_=class extends zo{setValue(t,r){this._values.set(t,r)}},h8=class extends h_{setValue(t,r){super.setValue(t,C4(r))}},f8=class extends h_{},p8=class extends h_{};var f_=class extends zo{};f_.prototype._setValue=wN;var $4=class extends f_{};$4.prototype._setValue=HM;var H4=class extends f_{};H4.prototype._setValue=WM;var w0=class extends zo{};w0.prototype._setValue=TN;var W4=class extends w0{};W4.prototype._setValue=qM;var q4=class extends w0{};q4.prototype._setValue=YM;var Y4=class extends w0{};Y4.prototype._setValue=XM;var X4=class extends w0{};X4.prototype._setValue=ZM;var uh=class extends zo{setValue(t,r){this._values.set(t,r)}},d8=class extends uh{},A8=class extends uh{},m8=class extends uh{},g8=class extends uh{},_8=class extends uh{},y8=class extends uh{},x8=class extends uh{},b8=class extends uh{};var v8=class extends Tc{constructor(t){super(t),this._offsets=new Ix(t.type)}addChild(t,r="0"){if(this.numChildren>0)throw new Error("ListBuilder can only have one child.");return this.children[this.numChildren]=t,this.type=new vc(new zi(r,t.type,!0)),this.numChildren-1}_flushPending(t){let r=this._offsets,[i]=this.children;for(let[s,n]of t)if(typeof n>"u")r.set(s,0);else{let o=n,c=o.length,f=r.set(s,c).buffer[s];for(let p=-1;++p<c;)i.set(f+p,o[p])}}};var w8=class extends Tc{set(t,r){return super.set(t,r)}setValue(t,r){let i=r instanceof Map?r:new Map(Object.entries(r)),s=this._pending||(this._pending=new Map),n=s.get(t);n&&(this._pendingLength-=n.size),this._pendingLength+=i.size,s.set(t,i)}addChild(t,r=`${this.numChildren}`){if(this.numChildren>0)throw new Error("ListBuilder can only have one child.");return this.children[this.numChildren]=t,this.type=new ah(new zi(r,t.type,!0),this.type.keysSorted),this.numChildren-1}_flushPending(t){let r=this._offsets,[i]=this.children;for(let[s,n]of t)if(n===void 0)r.set(s,0);else{let{[s]:o,[s+1]:c}=r.set(s,n.size).buffer;for(let f of n.entries())if(i.set(o,f),++o>=c)break}}};var T8=class extends Bs{setValue(t,r){}setValid(t,r){return this.length=Math.max(t+1,this.length),r}};var S8=class extends Bs{setValue(t,r){let{children:i,type:s}=this;switch(Array.isArray(r)||r.constructor){case!0:return s.children.forEach((n,o)=>i[o].set(t,r[o]));case Map:return s.children.forEach((n,o)=>i[o].set(t,r.get(n.name)));default:return s.children.forEach((n,o)=>i[o].set(t,r[n.name]))}}setValid(t,r){return super.setValid(t,r)||this.children.forEach(i=>i.setValid(t,r)),r}addChild(t,r=`${this.numChildren}`){let i=this.children.push(t);return this.type=new es([...this.type.children,new zi(r,t.type,!0)]),i}};var T0=class extends zo{};T0.prototype._setValue=xN;var Z4=class extends T0{};Z4.prototype._setValue=NM;var G4=class extends T0{};G4.prototype._setValue=FM;var Q4=class extends T0{};Q4.prototype._setValue=LM;var K4=class extends T0{};K4.prototype._setValue=zM;var S0=class extends zo{};S0.prototype._setValue=bN;var J4=class extends S0{};J4.prototype._setValue=UM;var tT=class extends S0{};tT.prototype._setValue=VM;var eT=class extends S0{};eT.prototype._setValue=jM;var rT=class extends S0{};rT.prototype._setValue=$M;var kx=class extends Bs{constructor(t){super(t),this._typeIds=new _0(Int8Array,0,1),typeof t.valueToChildTypeId=="function"&&(this._valueToChildTypeId=t.valueToChildTypeId)}get typeIdToChildIndex(){return this.type.typeIdToChildIndex}append(t,r){return this.set(this.length,t,r)}set(t,r,i){return i===void 0&&(i=this._valueToChildTypeId(this,r,t)),this.setValue(t,r,i),this}setValue(t,r,i){this._typeIds.set(t,i);let s=this.type.typeIdToChildIndex[i],n=this.children[s];n?.set(t,r)}addChild(t,r=`${this.children.length}`){let i=this.children.push(t),{type:{children:s,mode:n,typeIds:o}}=this,c=[...s,new zi(r,t.type)];return this.type=new oh(n,[...o,i],c),i}_valueToChildTypeId(t,r,i){throw new Error("Cannot map UnionBuilder value to child typeId. Pass the `childTypeId` as the second argument to unionBuilder.append(), or supply a `valueToChildTypeId` function as part of the UnionBuilder constructor options.")}},E8=class extends kx{},I8=class extends kx{constructor(t){super(t),this._offsets=new _0(Int32Array)}setValue(t,r,i){let s=this._typeIds.set(t,i).buffer[t],n=this.getChildAt(this.type.typeIdToChildIndex[s]),o=this._offsets.set(t,n.length).buffer[t];n?.set(o,r)}};var iT=class extends Tc{constructor(t){super(t),this._values=new Af(Uint8Array)}get byteLength(){let t=this._pendingLength+this.length*4;return this._offsets&&(t+=this._offsets.byteLength),this._values&&(t+=this._values.byteLength),this._nulls&&(t+=this._nulls.byteLength),t}setValue(t,r){return super.setValue(t,Ep(r))}_flushPending(t,r){}};iT.prototype._flushPending=Px.prototype._flushPending;var nT=class extends Tc{constructor(t){super(t),this._values=new Af(Uint8Array)}get byteLength(){let t=this._pendingLength+this.length*4;return this._offsets&&(t+=this._offsets.byteLength),this._values&&(t+=this._values.byteLength),this._nulls&&(t+=this._nulls.byteLength),t}setValue(t,r){return super.setValue(t,Ep(r))}_flushPending(t,r){}};nT.prototype._flushPending=Rx.prototype._flushPending;var VN=class extends Wr{visitNull(){return T8}visitBool(){return l8}visitInt(){return uh}visitInt8(){return d8}visitInt16(){return A8}visitInt32(){return m8}visitInt64(){return g8}visitUint8(){return _8}visitUint16(){return y8}visitUint32(){return x8}visitUint64(){return b8}visitFloat(){return h_}visitFloat16(){return h8}visitFloat32(){return f8}visitFloat64(){return p8}visitUtf8(){return iT}visitLargeUtf8(){return nT}visitBinary(){return Px}visitLargeBinary(){return Rx}visitFixedSizeBinary(){return j4}visitDate(){return u_}visitDateDay(){return z4}visitDateMillisecond(){return U4}visitTimestamp(){return T0}visitTimestampSecond(){return Z4}visitTimestampMillisecond(){return G4}visitTimestampMicrosecond(){return Q4}visitTimestampNanosecond(){return K4}visitTime(){return S0}visitTimeSecond(){return J4}visitTimeMillisecond(){return tT}visitTimeMicrosecond(){return eT}visitTimeNanosecond(){return rT}visitDecimal(){return V4}visitList(){return v8}visitStruct(){return S8}visitUnion(){return kx}visitDenseUnion(){return I8}visitSparseUnion(){return E8}visitDictionary(){return c8}visitInterval(){return f_}visitIntervalDayTime(){return $4}visitIntervalYearMonth(){return H4}visitDuration(){return w0}visitDurationSecond(){return W4}visitDurationMillisecond(){return q4}visitDurationMicrosecond(){return Y4}visitDurationNanosecond(){return X4}visitFixedSizeList(){return u8}visitMap(){return w8}},int=new VN;var Zr=class extends Wr{compareSchemas(t,r){return t===r||r instanceof t.constructor&&this.compareManyFields(t.fields,r.fields)}compareManyFields(t,r){return t===r||Array.isArray(t)&&Array.isArray(r)&&t.length===r.length&&t.every((i,s)=>this.compareFields(i,r[s]))}compareFields(t,r){return t===r||r instanceof t.constructor&&t.name===r.name&&t.nullable===r.nullable&&this.visit(t.type,r.type)}};function Wl(e,t){return t instanceof e.constructor}function p_(e,t){return e===t||Wl(e,t)}function E0(e,t){return e===t||Wl(e,t)&&e.bitWidth===t.bitWidth&&e.isSigned===t.isSigned}function M8(e,t){return e===t||Wl(e,t)&&e.precision===t.precision}function BTt(e,t){return e===t||Wl(e,t)&&e.byteWidth===t.byteWidth}function jN(e,t){return e===t||Wl(e,t)&&e.unit===t.unit}function sT(e,t){return e===t||Wl(e,t)&&e.unit===t.unit&&e.timezone===t.timezone}function oT(e,t){return e===t||Wl(e,t)&&e.unit===t.unit&&e.bitWidth===t.bitWidth}function OTt(e,t){return e===t||Wl(e,t)&&e.children.length===t.children.length&&Vp.compareManyFields(e.children,t.children)}function NTt(e,t){return e===t||Wl(e,t)&&e.children.length===t.children.length&&Vp.compareManyFields(e.children,t.children)}function $N(e,t){return e===t||Wl(e,t)&&e.mode===t.mode&&e.typeIds.every((r,i)=>r===t.typeIds[i])&&Vp.compareManyFields(e.children,t.children)}function FTt(e,t){return e===t||Wl(e,t)&&e.id===t.id&&e.isOrdered===t.isOrdered&&Vp.visit(e.indices,t.indices)&&Vp.visit(e.dictionary,t.dictionary)}function HN(e,t){return e===t||Wl(e,t)&&e.unit===t.unit}function aT(e,t){return e===t||Wl(e,t)&&e.unit===t.unit}function LTt(e,t){return e===t||Wl(e,t)&&e.listSize===t.listSize&&e.children.length===t.children.length&&Vp.compareManyFields(e.children,t.children)}function zTt(e,t){return e===t||Wl(e,t)&&e.keysSorted===t.keysSorted&&e.children.length===t.children.length&&Vp.compareManyFields(e.children,t.children)}Zr.prototype.visitNull=p_;Zr.prototype.visitBool=p_;Zr.prototype.visitInt=E0;Zr.prototype.visitInt8=E0;Zr.prototype.visitInt16=E0;Zr.prototype.visitInt32=E0;Zr.prototype.visitInt64=E0;Zr.prototype.visitUint8=E0;Zr.prototype.visitUint16=E0;Zr.prototype.visitUint32=E0;Zr.prototype.visitUint64=E0;Zr.prototype.visitFloat=M8;Zr.prototype.visitFloat16=M8;Zr.prototype.visitFloat32=M8;Zr.prototype.visitFloat64=M8;Zr.prototype.visitUtf8=p_;Zr.prototype.visitLargeUtf8=p_;Zr.prototype.visitBinary=p_;Zr.prototype.visitLargeBinary=p_;Zr.prototype.visitFixedSizeBinary=BTt;Zr.prototype.visitDate=jN;Zr.prototype.visitDateDay=jN;Zr.prototype.visitDateMillisecond=jN;Zr.prototype.visitTimestamp=sT;Zr.prototype.visitTimestampSecond=sT;Zr.prototype.visitTimestampMillisecond=sT;Zr.prototype.visitTimestampMicrosecond=sT;Zr.prototype.visitTimestampNanosecond=sT;Zr.prototype.visitTime=oT;Zr.prototype.visitTimeSecond=oT;Zr.prototype.visitTimeMillisecond=oT;Zr.prototype.visitTimeMicrosecond=oT;Zr.prototype.visitTimeNanosecond=oT;Zr.prototype.visitDecimal=p_;Zr.prototype.visitList=OTt;Zr.prototype.visitStruct=NTt;Zr.prototype.visitUnion=$N;Zr.prototype.visitDenseUnion=$N;Zr.prototype.visitSparseUnion=$N;Zr.prototype.visitDictionary=FTt;Zr.prototype.visitInterval=HN;Zr.prototype.visitIntervalDayTime=HN;Zr.prototype.visitIntervalYearMonth=HN;Zr.prototype.visitDuration=aT;Zr.prototype.visitDurationSecond=aT;Zr.prototype.visitDurationMillisecond=aT;Zr.prototype.visitDurationMicrosecond=aT;Zr.prototype.visitDurationNanosecond=aT;Zr.prototype.visitFixedSizeList=LTt;Zr.prototype.visitMap=zTt;var Vp=new Zr;function d_(e,t){return Vp.compareSchemas(e,t)}function nnt(e,t){return Vp.compareFields(e,t)}function snt(e,t){return Vp.visit(e,t)}function Up(e){let t=e.type,r=new(int.getVisitFn(t)())(e);if(t.children&&t.children.length>0){let i=e.children||[],s={nullValues:e.nullValues},n=Array.isArray(i)?(o,c)=>i[c]||s:({name:o})=>i[o]||s;for(let[o,c]of t.children.entries()){let{type:f}=c,p=n(c,o);r.children.push(Up(Object.assign(Object.assign({},p),{type:f})))}}return r}function C8(e,t){return UTt(e,t.map(r=>r.data.concat()))}function UTt(e,t){let r=[...e.fields],i=[],s={numBatches:t.reduce((E,T)=>Math.max(E,T.length),0)},n=0,o=0,c=-1,f=t.length,p,x=[];for(;s.numBatches-- >0;){for(o=Number.POSITIVE_INFINITY,c=-1;++c<f;)x[c]=p=t[c].shift(),o=Math.min(o,p?p.length:o);Number.isFinite(o)&&(x=VTt(r,o,x,t,s),o>0&&(i[n++]=gi({type:new es(r),length:o,nullCount:0,children:x.slice()})))}return[e=e.assign(r),i.map(E=>new po(e,E))]}function VTt(e,t,r,i,s){var n;let o=(t+63&-64)>>3;for(let c=-1,f=i.length;++c<f;){let p=r[c],x=p?.length;if(x>=t)x===t?r[c]=p:(r[c]=p.slice(0,t),s.numBatches=Math.max(s.numBatches,i[c].unshift(p.slice(t,x-t))));else{let E=e[c];e[c]=E.clone({nullable:!0}),r[c]=(n=p?._changeLengthAndBackfillNullBitmap(t))!==null&&n!==void 0?n:gi({type:E.type,length:t,nullCount:t,nullBitmap:new Uint8Array(o)})}}return r}var ant,$a=class e{constructor(...t){var r,i;if(t.length===0)return this.batches=[],this.schema=new Nn([]),this._offsets=[0],this;let s,n;t[0]instanceof Nn&&(s=t.shift()),t.at(-1)instanceof Uint32Array&&(n=t.pop());let o=f=>{if(f){if(f instanceof po)return[f];if(f instanceof e)return f.batches;if(f instanceof An){if(f.type instanceof es)return[new po(new Nn(f.type.children),f)]}else{if(Array.isArray(f))return f.flatMap(p=>o(p));if(typeof f[Symbol.iterator]=="function")return[...f].flatMap(p=>o(p));if(typeof f=="object"){let p=Object.keys(f),x=p.map(D=>new Li([f[D]])),E=s??new Nn(p.map((D,N)=>new zi(String(D),x[N].type,x[N].nullable))),[,T]=C8(E,x);return T.length===0?[new po(f)]:T}}}return[]},c=t.flatMap(f=>o(f));if(s=(i=s??((r=c[0])===null||r===void 0?void 0:r.schema))!==null&&i!==void 0?i:new Nn([]),!(s instanceof Nn))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");for(let f of c){if(!(f instanceof po))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");if(!d_(s,f.schema))throw new TypeError("Table and inner RecordBatch schemas must be equivalent.")}this.schema=s,this.batches=c,this._offsets=n??t8(this.data)}get data(){return this.batches.map(({data:t})=>t)}get numCols(){return this.schema.fields.length}get numRows(){return this.data.reduce((t,r)=>t+r.length,0)}get nullCount(){return this._nullCount===-1&&(this._nullCount=JM(this.data)),this._nullCount}isValid(t){return!1}get(t){return null}set(t,r){}indexOf(t,r){return-1}[Symbol.iterator](){return this.batches.length>0?Sx.visit(new Li(this.data)):new Array(0)[Symbol.iterator]()}toArray(){return[...this]}toString(){return`[
  ${this.toArray().join(`,
  `)}
]`}concat(...t){let r=this.schema,i=this.data.concat(t.flatMap(({data:s})=>s));return new e(r,i.map(s=>new po(r,s)))}slice(t,r){let i=this.schema;[t,r]=P4({length:this.numRows},t,r);let s=e8(this.data,this._offsets,t,r);return new e(i,s.map(n=>new po(i,n)))}getChild(t){return this.getChildAt(this.schema.fields.findIndex(r=>r.name===t))}getChildAt(t){if(t>-1&&t<this.schema.fields.length){let r=this.data.map(i=>i.children[t]);if(r.length===0){let{type:i}=this.schema.fields[t],s=gi({type:i,length:0,nullCount:0});r.push(s._changeLengthAndBackfillNullBitmap(this.numRows))}return new Li(r)}return null}setChild(t,r){var i;return this.setChildAt((i=this.schema.fields)===null||i===void 0?void 0:i.findIndex(s=>s.name===t),r)}setChildAt(t,r){let i=this.schema,s=[...this.batches];if(t>-1&&t<this.numCols){r||(r=new Li([gi({type:new xa,length:this.numRows})]));let n=i.fields.slice(),o=n[t].clone({type:r.type}),c=this.schema.fields.map((f,p)=>this.getChildAt(p));[n[t],c[t]]=[o,r],[i,s]=C8(i,c)}return new e(i,s)}select(t){let r=this.schema.fields.reduce((i,s,n)=>i.set(s.name,n),new Map);return this.selectAt(t.map(i=>r.get(i)).filter(i=>i>-1))}selectAt(t){let r=this.schema.selectAt(t),i=this.batches.map(s=>s.selectAt(t));return new e(r,i)}assign(t){let r=this.schema.fields,[i,s]=t.schema.fields.reduce((c,f,p)=>{let[x,E]=c,T=r.findIndex(D=>D.name===f.name);return~T?E[T]=p:x.push(p),c},[[],[]]),n=this.schema.assign(t.schema),o=[...r.map((c,f)=>[f,s[f]]).map(([c,f])=>f===void 0?this.getChildAt(c):t.getChildAt(f)),...i.map(c=>t.getChildAt(c))].filter(Boolean);return new e(...C8(n,o))}};ant=Symbol.toStringTag;$a[ant]=(e=>(e.schema=null,e.batches=[],e._offsets=new Uint32Array([0]),e._nullCount=-1,e[Symbol.isConcatSpreadable]=!0,e.isValid=Tx(D4),e.get=Tx(Lo.getVisitFn(Ft.Struct)),e.set=r8(ja.getVisitFn(Ft.Struct)),e.indexOf=i8(a_.getVisitFn(Ft.Struct)),"Table"))($a.prototype);var cnt,po=class e{constructor(...t){switch(t.length){case 2:{if([this.schema]=t,!(this.schema instanceof Nn))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");if([,this.data=gi({nullCount:0,type:new es(this.schema.fields),children:this.schema.fields.map(r=>gi({type:r.type,nullCount:0}))})]=t,!(this.data instanceof An))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");[this.schema,this.data]=lnt(this.schema,this.data.children);break}case 1:{let[r]=t,{fields:i,children:s,length:n}=Object.keys(r).reduce((f,p,x)=>(f.children[x]=r[p],f.length=Math.max(f.length,r[p].length),f.fields[x]=zi.new({name:p,type:r[p].type,nullable:!0}),f),{length:0,fields:new Array,children:new Array}),o=new Nn(i),c=gi({type:new es(i),length:n,children:s,nullCount:0});[this.schema,this.data]=lnt(o,c.children,n);break}default:throw new TypeError("RecordBatch constructor expects an Object mapping names to child Data, or a [Schema, Data] pair.")}}get dictionaries(){return this._dictionaries||(this._dictionaries=unt(this.schema.fields,this.data.children))}get numCols(){return this.schema.fields.length}get numRows(){return this.data.length}get nullCount(){return this.data.nullCount}isValid(t){return this.data.getValid(t)}get(t){return Lo.visit(this.data,t)}set(t,r){return ja.visit(this.data,t,r)}indexOf(t,r){return a_.visit(this.data,t,r)}[Symbol.iterator](){return Sx.visit(new Li([this.data]))}toArray(){return[...this]}concat(...t){return new $a(this.schema,[this,...t])}slice(t,r){let[i]=new Li([this.data]).slice(t,r).data;return new e(this.schema,i)}getChild(t){var r;return this.getChildAt((r=this.schema.fields)===null||r===void 0?void 0:r.findIndex(i=>i.name===t))}getChildAt(t){return t>-1&&t<this.schema.fields.length?new Li([this.data.children[t]]):null}setChild(t,r){var i;return this.setChildAt((i=this.schema.fields)===null||i===void 0?void 0:i.findIndex(s=>s.name===t),r)}setChildAt(t,r){let i=this.schema,s=this.data;if(t>-1&&t<this.numCols){r||(r=new Li([gi({type:new xa,length:this.numRows})]));let n=i.fields.slice(),o=s.children.slice(),c=n[t].clone({type:r.type});[n[t],o[t]]=[c,r.data[0]],i=new Nn(n,new Map(this.schema.metadata)),s=gi({type:new es(n),children:o})}return new e(i,s)}select(t){let r=this.schema.select(t),i=new es(r.fields),s=[];for(let n of t){let o=this.schema.fields.findIndex(c=>c.name===n);~o&&(s[o]=this.data.children[o])}return new e(r,gi({type:i,length:this.numRows,children:s}))}selectAt(t){let r=this.schema.selectAt(t),i=t.map(n=>this.data.children[n]).filter(Boolean),s=gi({type:new es(r.fields),length:this.numRows,children:i});return new e(r,s)}};cnt=Symbol.toStringTag;po[cnt]=(e=>(e._nullCount=-1,e[Symbol.isConcatSpreadable]=!0,"RecordBatch"))(po.prototype);function lnt(e,t,r=t.reduce((i,s)=>Math.max(i,s.length),0)){var i;let s=[...e.fields],n=[...t],o=(r+63&-64)>>3;for(let[c,f]of e.fields.entries()){let p=t[c];(!p||p.length!==r)&&(s[c]=f.clone({nullable:!0}),n[c]=(i=p?._changeLengthAndBackfillNullBitmap(r))!==null&&i!==void 0?i:gi({type:f.type,length:r,nullCount:r,nullBitmap:new Uint8Array(o)}))}return[e.assign(s),gi({type:new es(s),length:r,children:n})]}function unt(e,t,r=new Map){var i,s;if(((i=e?.length)!==null&&i!==void 0?i:0)>0&&e?.length===t?.length)for(let n=-1,o=e.length;++n<o;){let{type:c}=e[n],f=t[n];for(let p of[f,...((s=f?.dictionary)===null||s===void 0?void 0:s.data)||[]])unt(c.children,p?.children,r);if(yr.isDictionary(c)){let{id:p}=c;if(!r.has(p))f?.dictionary&&r.set(p,f.dictionary);else if(r.get(p)!==f.dictionary)throw new Error("Cannot create Schema containing two different dictionaries with the same Id")}}return r}var A_=class extends po{constructor(t){let r=t.fields.map(s=>gi({type:s.type})),i=gi({type:new es(t.fields),nullCount:0,children:r});super(t,i)}};var mf=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsMessage(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsMessage(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}version(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Vn.V1}headerType(){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readUint8(this.bb_pos+t):nn.NONE}header(t){let r=this.bb.__offset(this.bb_pos,8);return r?this.bb.__union(t,this.bb_pos+r):null}bodyLength(){let t=this.bb.__offset(this.bb_pos,10);return t?this.bb.readInt64(this.bb_pos+t):BigInt("0")}customMetadata(t,r){let i=this.bb.__offset(this.bb_pos,12);return i?(r||new Qo).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+t*4),this.bb):null}customMetadataLength(){let t=this.bb.__offset(this.bb_pos,12);return t?this.bb.__vector_len(this.bb_pos+t):0}static startMessage(t){t.startObject(5)}static addVersion(t,r){t.addFieldInt16(0,r,Vn.V1)}static addHeaderType(t,r){t.addFieldInt8(1,r,nn.NONE)}static addHeader(t,r){t.addFieldOffset(2,r,0)}static addBodyLength(t,r){t.addFieldInt64(3,r,BigInt("0"))}static addCustomMetadata(t,r){t.addFieldOffset(4,r,0)}static createCustomMetadataVector(t,r){t.startVector(4,r.length,4);for(let i=r.length-1;i>=0;i--)t.addOffset(r[i]);return t.endVector()}static startCustomMetadataVector(t,r){t.startVector(4,r,4)}static endMessage(t){return t.endObject()}static finishMessageBuffer(t,r){t.finish(r)}static finishSizePrefixedMessageBuffer(t,r){t.finish(r,void 0,!0)}static createMessage(t,r,i,s,n,o){return e.startMessage(t),e.addVersion(t,r),e.addHeaderType(t,i),e.addHeader(t,s),e.addBodyLength(t,n),e.addCustomMetadata(t,o),e.endMessage(t)}};var WN=class extends Wr{visit(t,r){return t==null||r==null?void 0:super.visit(t,r)}visitNull(t,r){return T4.startNull(r),T4.endNull(r)}visitInt(t,r){return uf.startInt(r),uf.addBitWidth(r,t.bitWidth),uf.addIsSigned(r,t.isSigned),uf.endInt(r)}visitFloat(t,r){return pm.startFloatingPoint(r),pm.addPrecision(r,t.precision),pm.endFloatingPoint(r)}visitBinary(t,r){return y4.startBinary(r),y4.endBinary(r)}visitLargeBinary(t,r){return b4.startLargeBinary(r),b4.endLargeBinary(r)}visitBool(t,r){return x4.startBool(r),x4.endBool(r)}visitUtf8(t,r){return E4.startUtf8(r),E4.endUtf8(r)}visitLargeUtf8(t,r){return v4.startLargeUtf8(r),v4.endLargeUtf8(r)}visitDecimal(t,r){return Pp.startDecimal(r),Pp.addScale(r,t.scale),Pp.addPrecision(r,t.precision),Pp.addBitWidth(r,t.bitWidth),Pp.endDecimal(r)}visitDate(t,r){return cm.startDate(r),cm.addUnit(r,t.unit),cm.endDate(r)}visitTime(t,r){return o0.startTime(r),o0.addUnit(r,t.unit),o0.addBitWidth(r,t.bitWidth),o0.endTime(r)}visitTimestamp(t,r){let i=t.timezone&&r.createString(t.timezone)||void 0;return a0.startTimestamp(r),a0.addUnit(r,t.unit),i!==void 0&&a0.addTimezone(r,i),a0.endTimestamp(r)}visitInterval(t,r){return dm.startInterval(r),dm.addUnit(r,t.unit),dm.endInterval(r)}visitDuration(t,r){return um.startDuration(r),um.addUnit(r,t.unit),um.endDuration(r)}visitList(t,r){return w4.startList(r),w4.endList(r)}visitStruct(t,r){return S4.startStruct_(r),S4.endStruct_(r)}visitUnion(t,r){hf.startTypeIdsVector(r,t.typeIds.length);let i=hf.createTypeIdsVector(r,t.typeIds);return hf.startUnion(r),hf.addMode(r,t.mode),hf.addTypeIds(r,i),hf.endUnion(r)}visitDictionary(t,r){let i=this.visit(t.indices,r);return Cp.startDictionaryEncoding(r),Cp.addId(r,BigInt(t.id)),Cp.addIsOrdered(r,t.isOrdered),i!==void 0&&Cp.addIndexType(r,i),Cp.endDictionaryEncoding(r)}visitFixedSizeBinary(t,r){return hm.startFixedSizeBinary(r),hm.addByteWidth(r,t.byteWidth),hm.endFixedSizeBinary(r)}visitFixedSizeList(t,r){return fm.startFixedSizeList(r),fm.addListSize(r,t.listSize),fm.endFixedSizeList(r)}visitMap(t,r){return Am.startMap(r),Am.addKeysSorted(r,t.keysSorted),Am.endMap(r)}},P8=new WN;function dnt(e,t=new Map){return new Nn(jTt(e,t),R8(e.metadata),t)}function qN(e){return new Ha(e.count,mnt(e.columns),gnt(e.columns))}function Ant(e){return new Ec(qN(e.data),e.id,e.isDelta)}function jTt(e,t){return(e.fields||[]).filter(Boolean).map(r=>zi.fromJSON(r,t))}function hnt(e,t){return(e.children||[]).filter(Boolean).map(r=>zi.fromJSON(r,t))}function mnt(e){return(e||[]).reduce((t,r)=>[...t,new hh(r.count,$Tt(r.VALIDITY)),...mnt(r.children)],[])}function gnt(e,t=[]){for(let r=-1,i=(e||[]).length;++r<i;){let s=e[r];s.VALIDITY&&t.push(new Sc(t.length,s.VALIDITY.length)),s.TYPE_ID&&t.push(new Sc(t.length,s.TYPE_ID.length)),s.OFFSET&&t.push(new Sc(t.length,s.OFFSET.length)),s.DATA&&t.push(new Sc(t.length,s.DATA.length)),t=gnt(s.children,t)}return t}function $Tt(e){return(e||[]).reduce((t,r)=>t+ +(r===0),0)}function _nt(e,t){let r,i,s,n,o,c;return!t||!(n=e.dictionary)?(o=pnt(e,hnt(e,t)),s=new zi(e.name,o,e.nullable,R8(e.metadata))):t.has(r=n.id)?(i=(i=n.indexType)?fnt(i):new _l,c=new xl(t.get(r),i,r,n.isOrdered),s=new zi(e.name,c,e.nullable,R8(e.metadata))):(i=(i=n.indexType)?fnt(i):new _l,t.set(r,o=pnt(e,hnt(e,t))),c=new xl(o,i,r,n.isOrdered),s=new zi(e.name,c,e.nullable,R8(e.metadata))),s||null}function R8(e=[]){return new Map(e.map(({key:t,value:r})=>[t,r]))}function fnt(e){return new fo(e.isSigned,e.bitWidth)}function pnt(e,t){let r=e.type.name;switch(r){case"NONE":return new xa;case"null":return new xa;case"binary":return new rh;case"largebinary":return new Rp;case"utf8":return new ou;case"largeutf8":return new kp;case"bool":return new ih;case"list":return new vc((t||[])[0]);case"struct":return new es(t||[]);case"struct_":return new es(t||[])}switch(r){case"int":{let i=e.type;return new fo(i.isSigned,i.bitWidth)}case"floatingpoint":{let i=e.type;return new Hl(ts[i.precision])}case"decimal":{let i=e.type;return new Dp(i.scale,i.precision,i.bitWidth)}case"date":{let i=e.type;return new nh(Qs[i.unit])}case"time":{let i=e.type;return new yl(wr[i.unit],i.bitWidth)}case"timestamp":{let i=e.type;return new Bp(wr[i.unit],i.timezone)}case"interval":{let i=e.type;return new sh(Co[i.unit])}case"duration":{let i=e.type;return new Op(wr[i.unit])}case"union":{let i=e.type,[s,...n]=(i.mode+"").toLowerCase(),o=s.toUpperCase()+n.join("");return new oh(as[o],i.typeIds||[],t||[])}case"fixedsizebinary":{let i=e.type;return new Np(i.byteWidth)}case"fixedsizelist":{let i=e.type;return new wc(i.listSize,(t||[])[0])}case"map":{let i=e.type;return new ah((t||[])[0],i.keysSorted)}}throw new Error(`Unrecognized type: "${r}"`)}var HTt=r_,WTt=nu,Ic=class e{static fromJSON(t,r){let i=new e(0,Vn.V5,r);return i._createHeader=qTt(t,r),i}static decode(t){t=new WTt(ei(t));let r=mf.getRootAsMessage(t),i=r.bodyLength(),s=r.version(),n=r.headerType(),o=new e(i,s,n);return o._createHeader=YTt(r,n),o}static encode(t){let r=new HTt,i=-1;return t.isSchema()?i=Nn.encode(r,t.header()):t.isRecordBatch()?i=Ha.encode(r,t.header()):t.isDictionaryBatch()&&(i=Ec.encode(r,t.header())),mf.startMessage(r),mf.addVersion(r,Vn.V5),mf.addHeader(r,i),mf.addHeaderType(r,t.headerType),mf.addBodyLength(r,BigInt(t.bodyLength)),mf.finishMessageBuffer(r,mf.endMessage(r)),r.asUint8Array()}static from(t,r=0){if(t instanceof Nn)return new e(0,Vn.V5,nn.Schema,t);if(t instanceof Ha)return new e(r,Vn.V5,nn.RecordBatch,t);if(t instanceof Ec)return new e(r,Vn.V5,nn.DictionaryBatch,t);throw new Error(`Unrecognized Message header: ${t}`)}get type(){return this.headerType}get version(){return this._version}get headerType(){return this._headerType}get bodyLength(){return this._bodyLength}header(){return this._createHeader()}isSchema(){return this.headerType===nn.Schema}isRecordBatch(){return this.headerType===nn.RecordBatch}isDictionaryBatch(){return this.headerType===nn.DictionaryBatch}constructor(t,r,i,s){this._version=r,this._headerType=i,this.body=new Uint8Array(0),s&&(this._createHeader=()=>s),this._bodyLength=Ks(t)}},Ha=class{get nodes(){return this._nodes}get length(){return this._length}get buffers(){return this._buffers}constructor(t,r,i){this._nodes=r,this._buffers=i,this._length=Ks(t)}},Ec=class{get id(){return this._id}get data(){return this._data}get isDelta(){return this._isDelta}get length(){return this.data.length}get nodes(){return this.data.nodes}get buffers(){return this.data.buffers}constructor(t,r,i=!1){this._data=t,this._isDelta=i,this._id=Ks(r)}},Sc=class{constructor(t,r){this.offset=Ks(t),this.length=Ks(r)}},hh=class{constructor(t,r){this.length=Ks(t),this.nullCount=Ks(r)}};function qTt(e,t){return()=>{switch(t){case nn.Schema:return Nn.fromJSON(e);case nn.RecordBatch:return Ha.fromJSON(e);case nn.DictionaryBatch:return Ec.fromJSON(e)}throw new Error(`Unrecognized Message type: { name: ${nn[t]}, type: ${t} }`)}}function YTt(e,t){return()=>{switch(t){case nn.Schema:return Nn.decode(e.header(new bc),new Map,e.version());case nn.RecordBatch:return Ha.decode(e.header(new su),e.version());case nn.DictionaryBatch:return Ec.decode(e.header(new s0),e.version())}throw new Error(`Unrecognized Message type: { name: ${nn[t]}, type: ${t} }`)}}zi.encode=n5t;zi.decode=r5t;zi.fromJSON=_nt;Nn.encode=i5t;Nn.decode=XTt;Nn.fromJSON=dnt;Ha.encode=s5t;Ha.decode=ZTt;Ha.fromJSON=qN;Ec.encode=o5t;Ec.decode=GTt;Ec.fromJSON=Ant;hh.encode=a5t;hh.decode=KTt;Sc.encode=l5t;Sc.decode=QTt;function XTt(e,t=new Map,r=Vn.V5){let i=e5t(e,t);return new Nn(i,k8(e),t,r)}function ZTt(e,t=Vn.V5){if(e.compression()!==null)throw new Error("Record batch compression not implemented");return new Ha(e.length(),JTt(e),t5t(e,t))}function GTt(e,t=Vn.V5){return new Ec(Ha.decode(e.data(),t),e.id(),e.isDelta())}function QTt(e){return new Sc(e.offset(),e.length())}function KTt(e){return new hh(e.length(),e.nullCount())}function JTt(e){let t=[];for(let r,i=-1,s=-1,n=e.nodesLength();++i<n;)(r=e.nodes(i))&&(t[++s]=hh.decode(r));return t}function t5t(e,t){let r=[];for(let i,s=-1,n=-1,o=e.buffersLength();++s<o;)(i=e.buffers(s))&&(t<Vn.V4&&(i.bb_pos+=8*(s+1)),r[++n]=Sc.decode(i));return r}function e5t(e,t){let r=[];for(let i,s=-1,n=-1,o=e.fieldsLength();++s<o;)(i=e.fields(s))&&(r[++n]=zi.decode(i,t));return r}function ynt(e,t){let r=[];for(let i,s=-1,n=-1,o=e.childrenLength();++s<o;)(i=e.children(s))&&(r[++n]=zi.decode(i,t));return r}function r5t(e,t){let r,i,s,n,o,c;return!t||!(c=e.dictionary())?(s=bnt(e,ynt(e,t)),i=new zi(e.name(),s,e.nullable(),k8(e))):t.has(r=Ks(c.id()))?(n=(n=c.indexType())?xnt(n):new _l,o=new xl(t.get(r),n,r,c.isOrdered()),i=new zi(e.name(),o,e.nullable(),k8(e))):(n=(n=c.indexType())?xnt(n):new _l,t.set(r,s=bnt(e,ynt(e,t))),o=new xl(s,n,r,c.isOrdered()),i=new zi(e.name(),o,e.nullable(),k8(e))),i||null}function k8(e){let t=new Map;if(e)for(let r,i,s=-1,n=Math.trunc(e.customMetadataLength());++s<n;)(r=e.customMetadata(s))&&(i=r.key())!=null&&t.set(i,r.value());return t}function xnt(e){return new fo(e.isSigned(),e.bitWidth())}function bnt(e,t){let r=e.typeType();switch(r){case ls.NONE:return new xa;case ls.Null:return new xa;case ls.Binary:return new rh;case ls.LargeBinary:return new Rp;case ls.Utf8:return new ou;case ls.LargeUtf8:return new kp;case ls.Bool:return new ih;case ls.List:return new vc((t||[])[0]);case ls.Struct_:return new es(t||[])}switch(r){case ls.Int:{let i=e.type(new uf);return new fo(i.isSigned(),i.bitWidth())}case ls.FloatingPoint:{let i=e.type(new pm);return new Hl(i.precision())}case ls.Decimal:{let i=e.type(new Pp);return new Dp(i.scale(),i.precision(),i.bitWidth())}case ls.Date:{let i=e.type(new cm);return new nh(i.unit())}case ls.Time:{let i=e.type(new o0);return new yl(i.unit(),i.bitWidth())}case ls.Timestamp:{let i=e.type(new a0);return new Bp(i.unit(),i.timezone())}case ls.Interval:{let i=e.type(new dm);return new sh(i.unit())}case ls.Duration:{let i=e.type(new um);return new Op(i.unit())}case ls.Union:{let i=e.type(new hf);return new oh(i.mode(),i.typeIdsArray()||[],t||[])}case ls.FixedSizeBinary:{let i=e.type(new hm);return new Np(i.byteWidth())}case ls.FixedSizeList:{let i=e.type(new fm);return new wc(i.listSize(),(t||[])[0])}case ls.Map:{let i=e.type(new Am);return new ah((t||[])[0],i.keysSorted())}}throw new Error(`Unrecognized type: "${ls[r]}" (${r})`)}function i5t(e,t){let r=t.fields.map(n=>zi.encode(e,n));bc.startFieldsVector(e,r.length);let i=bc.createFieldsVector(e,r),s=t.metadata&&t.metadata.size>0?bc.createCustomMetadataVector(e,[...t.metadata].map(([n,o])=>{let c=e.createString(`${n}`),f=e.createString(`${o}`);return Qo.startKeyValue(e),Qo.addKey(e,c),Qo.addValue(e,f),Qo.endKeyValue(e)})):-1;return bc.startSchema(e),bc.addFields(e,i),bc.addEndianness(e,c5t?lm.Little:lm.Big),s!==-1&&bc.addCustomMetadata(e,s),bc.endSchema(e)}function n5t(e,t){let r=-1,i=-1,s=-1,n=t.type,o=t.typeId;yr.isDictionary(n)?(o=n.dictionary.typeId,s=P8.visit(n,e),i=P8.visit(n.dictionary,e)):i=P8.visit(n,e);let c=(n.children||[]).map(x=>zi.encode(e,x)),f=gl.createChildrenVector(e,c),p=t.metadata&&t.metadata.size>0?gl.createCustomMetadataVector(e,[...t.metadata].map(([x,E])=>{let T=e.createString(`${x}`),D=e.createString(`${E}`);return Qo.startKeyValue(e),Qo.addKey(e,T),Qo.addValue(e,D),Qo.endKeyValue(e)})):-1;return t.name&&(r=e.createString(t.name)),gl.startField(e),gl.addType(e,i),gl.addTypeType(e,o),gl.addChildren(e,f),gl.addNullable(e,!!t.nullable),r!==-1&&gl.addName(e,r),s!==-1&&gl.addDictionary(e,s),p!==-1&&gl.addCustomMetadata(e,p),gl.endField(e)}function s5t(e,t){let r=t.nodes||[],i=t.buffers||[];su.startNodesVector(e,r.length);for(let o of r.slice().reverse())hh.encode(e,o);let s=e.endVector();su.startBuffersVector(e,i.length);for(let o of i.slice().reverse())Sc.encode(e,o);let n=e.endVector();return su.startRecordBatch(e),su.addLength(e,BigInt(t.length)),su.addNodes(e,s),su.addBuffers(e,n),su.endRecordBatch(e)}function o5t(e,t){let r=Ha.encode(e,t.data);return s0.startDictionaryBatch(e),s0.addId(e,BigInt(t.id)),s0.addIsDelta(e,t.isDelta),s0.addData(e,r),s0.endDictionaryBatch(e)}function a5t(e,t){return lx.createFieldNode(e,BigInt(t.length),BigInt(t.nullCount))}function l5t(e,t){return ax.createBuffer(e,BigInt(t.offset),BigInt(t.length))}var c5t=(()=>{let e=new ArrayBuffer(2);return new DataView(e).setInt16(0,256,!0),new Int16Array(e)[0]===256})();var XN=e=>`Expected ${nn[e]} Message in stream, but was null or length 0.`,ZN=e=>`Header pointer of flatbuffer-encoded ${nn[e]} Message is null or length 0.`,vnt=(e,t)=>`Expected to read ${e} metadata bytes, but only read ${t}.`,wnt=(e,t)=>`Expected to read ${e} bytes for message body, but only read ${t}.`,Dx=class{constructor(t){this.source=t instanceof zp?t:new zp(t)}[Symbol.iterator](){return this}next(){let t;return(t=this.readMetadataLength()).done?Es:t.value===-1&&(t=this.readMetadataLength()).done?Es:(t=this.readMetadata(t.value)).done?Es:t}throw(t){return this.source.throw(t)}return(t){return this.source.return(t)}readMessage(t){let r;if((r=this.next()).done)return null;if(t!=null&&r.value.headerType!==t)throw new Error(XN(t));return r.value}readMessageBody(t){if(t<=0)return new Uint8Array(0);let r=ei(this.source.read(t));if(r.byteLength<t)throw new Error(wnt(t,r.byteLength));return r.byteOffset%8===0&&r.byteOffset+r.byteLength<=r.buffer.byteLength?r:r.slice()}readSchema(t=!1){let r=nn.Schema,i=this.readMessage(r),s=i?.header();if(t&&!s)throw new Error(ZN(r));return s}readMetadataLength(){let t=this.source.read(D8),r=t&&new nu(t),i=r?.readInt32(0)||0;return{done:i===0,value:i}}readMetadata(t){let r=this.source.read(t);if(!r)return Es;if(r.byteLength<t)throw new Error(vnt(t,r.byteLength));return{done:!1,value:Ic.decode(r)}}},lT=class{constructor(t,r){this.source=t instanceof ch?t:vM(t)?new ym(t,r):new ch(t)}[Symbol.asyncIterator](){return this}next(){return gr(this,void 0,void 0,function*(){let t;return(t=yield this.readMetadataLength()).done?Es:t.value===-1&&(t=yield this.readMetadataLength()).done?Es:(t=yield this.readMetadata(t.value)).done?Es:t})}throw(t){return gr(this,void 0,void 0,function*(){return yield this.source.throw(t)})}return(t){return gr(this,void 0,void 0,function*(){return yield this.source.return(t)})}readMessage(t){return gr(this,void 0,void 0,function*(){let r;if((r=yield this.next()).done)return null;if(t!=null&&r.value.headerType!==t)throw new Error(XN(t));return r.value})}readMessageBody(t){return gr(this,void 0,void 0,function*(){if(t<=0)return new Uint8Array(0);let r=ei(yield this.source.read(t));if(r.byteLength<t)throw new Error(wnt(t,r.byteLength));return r.byteOffset%8===0&&r.byteOffset+r.byteLength<=r.buffer.byteLength?r:r.slice()})}readSchema(t=!1){return gr(this,void 0,void 0,function*(){let r=nn.Schema,i=yield this.readMessage(r),s=i?.header();if(t&&!s)throw new Error(ZN(r));return s})}readMetadataLength(){return gr(this,void 0,void 0,function*(){let t=yield this.source.read(D8),r=t&&new nu(t),i=r?.readInt32(0)||0;return{done:i===0,value:i}})}readMetadata(t){return gr(this,void 0,void 0,function*(){let r=yield this.source.read(t);if(!r)return Es;if(r.byteLength<t)throw new Error(vnt(t,r.byteLength));return{done:!1,value:Ic.decode(r)}})}},cT=class extends Dx{constructor(t){super(new Uint8Array(0)),this._schema=!1,this._body=[],this._batchIndex=0,this._dictionaryIndex=0,this._json=t instanceof B4?t:new B4(t)}next(){let{_json:t}=this;if(!this._schema)return this._schema=!0,{done:!1,value:Ic.fromJSON(t.schema,nn.Schema)};if(this._dictionaryIndex<t.dictionaries.length){let r=t.dictionaries[this._dictionaryIndex++];return this._body=r.data.columns,{done:!1,value:Ic.fromJSON(r,nn.DictionaryBatch)}}if(this._batchIndex<t.batches.length){let r=t.batches[this._batchIndex++];return this._body=r.columns,{done:!1,value:Ic.fromJSON(r,nn.RecordBatch)}}return this._body=[],Es}readMessageBody(t){return r(this._body);function r(i){return(i||[]).reduce((s,n)=>[...s,...n.VALIDITY&&[n.VALIDITY]||[],...n.TYPE_ID&&[n.TYPE_ID]||[],...n.OFFSET&&[n.OFFSET]||[],...n.DATA&&[n.DATA]||[],...r(n.children)],[])}}readMessage(t){let r;if((r=this.next()).done)return null;if(t!=null&&r.value.headerType!==t)throw new Error(XN(t));return r.value}readSchema(){let t=nn.Schema,r=this.readMessage(t),i=r?.header();if(!r||!i)throw new Error(ZN(t));return i}},D8=4,YN="ARROW1",Bx=new Uint8Array(YN.length);for(let e=0;e<YN.length;e+=1)Bx[e]=YN.codePointAt(e);function B8(e,t=0){for(let r=-1,i=Bx.length;++r<i;)if(Bx[r]!==e[t+r])return!1;return!0}var Ox=Bx.length,GN=Ox+D8,Tnt=Ox*2+D8;var cu=class e extends c_{constructor(t){super(),this._impl=t}get closed(){return this._impl.closed}get schema(){return this._impl.schema}get autoDestroy(){return this._impl.autoDestroy}get dictionaries(){return this._impl.dictionaries}get numDictionaries(){return this._impl.numDictionaries}get numRecordBatches(){return this._impl.numRecordBatches}get footer(){return this._impl.isFile()?this._impl.footer:null}isSync(){return this._impl.isSync()}isAsync(){return this._impl.isAsync()}isFile(){return this._impl.isFile()}isStream(){return this._impl.isStream()}next(){return this._impl.next()}throw(t){return this._impl.throw(t)}return(t){return this._impl.return(t)}cancel(){return this._impl.cancel()}reset(t){return this._impl.reset(t),this._DOMStream=void 0,this._nodeStream=void 0,this}open(t){let r=this._impl.open(t);return ru(r)?r.then(()=>this):this}readRecordBatch(t){return this._impl.isFile()?this._impl.readRecordBatch(t):null}[Symbol.iterator](){return this._impl[Symbol.iterator]()}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}toDOMStream(){return Va.toDOMStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this})}toNodeStream(){return Va.toNodeStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this},{objectMode:!0})}static throughNode(t){throw new Error('"throughNode" not available in this environment')}static throughDOM(t,r){throw new Error('"throughDOM" not available in this environment')}static from(t){return t instanceof e?t:xM(t)?h5t(t):vM(t)?d5t(t):ru(t)?gr(this,void 0,void 0,function*(){return yield e.from(yield t)}):wM(t)||p4(t)||SM(t)||Ju(t)?p5t(new ch(t)):f5t(new zp(t))}static readAll(t){return t instanceof e?t.isSync()?Snt(t):Ent(t):xM(t)||ArrayBuffer.isView(t)||af(t)||bM(t)?Snt(t):Ent(t)}},I0=class extends cu{constructor(t){super(t),this._impl=t}readAll(){return[...this]}[Symbol.iterator](){return this._impl[Symbol.iterator]()}[Symbol.asyncIterator](){return eu(this,arguments,function*(){yield Fi(yield*sx(of(this[Symbol.iterator]())))})}},m_=class extends cu{constructor(t){super(t),this._impl=t}readAll(){var t,r,i,s;return gr(this,void 0,void 0,function*(){let n=new Array;try{for(var o=!0,c=of(this),f;f=yield c.next(),t=f.done,!t;o=!0){s=f.value,o=!1;let p=s;n.push(p)}}catch(p){r={error:p}}finally{try{!o&&!t&&(i=c.return)&&(yield i.call(c))}finally{if(r)throw r.error}}return n})}[Symbol.iterator](){throw new Error("AsyncRecordBatchStreamReader is not Iterable")}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}},g_=class extends I0{constructor(t){super(t),this._impl=t}},O8=class extends m_{constructor(t){super(t),this._impl=t}},N8=class{get numDictionaries(){return this._dictionaryIndex}get numRecordBatches(){return this._recordBatchIndex}constructor(t=new Map){this.closed=!1,this.autoDestroy=!0,this._dictionaryIndex=0,this._recordBatchIndex=0,this.dictionaries=t}isSync(){return!1}isAsync(){return!1}isFile(){return!1}isStream(){return!1}reset(t){return this._dictionaryIndex=0,this._recordBatchIndex=0,this.schema=t,this.dictionaries=new Map,this}_loadRecordBatch(t,r){let i=this._loadVectors(t,r,this.schema.fields),s=gi({type:new es(this.schema.fields),length:t.length,children:i});return new po(this.schema,s)}_loadDictionaryBatch(t,r){let{id:i,isDelta:s}=t,{dictionaries:n,schema:o}=this,c=n.get(i);if(s||!c){let f=o.dictionaries.get(i),p=this._loadVectors(t.data,r,[f]);return(c&&s?c.concat(new Li(p)):new Li(p)).memoize()}return c.memoize()}_loadVectors(t,r,i){return new L4(r,t.nodes,t.buffers,this.dictionaries,this.schema.metadataVersion).visitMany(i)}},Nx=class extends N8{constructor(t,r){super(r),this._reader=xM(t)?new cT(this._handle=t):new Dx(this._handle=t)}isSync(){return!0}isStream(){return!0}[Symbol.iterator](){return this}cancel(){!this.closed&&(this.closed=!0)&&(this.reset()._reader.return(),this._reader=null,this.dictionaries=null)}open(t){return this.closed||(this.autoDestroy=Int(this,t),this.schema||(this.schema=this._reader.readSchema())||this.cancel()),this}throw(t){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.throw(t):Es}return(t){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.return(t):Es}next(){if(this.closed)return Es;let t,{_reader:r}=this;for(;t=this._readNextMessageAndValidate();)if(t.isSchema())this.reset(t.header());else if(t.isRecordBatch()){this._recordBatchIndex++;let i=t.header(),s=r.readMessageBody(t.bodyLength);return{done:!1,value:this._loadRecordBatch(i,s)}}else if(t.isDictionaryBatch()){this._dictionaryIndex++;let i=t.header(),s=r.readMessageBody(t.bodyLength),n=this._loadDictionaryBatch(i,s);this.dictionaries.set(i.id,n)}return this.schema&&this._recordBatchIndex===0?(this._recordBatchIndex++,{done:!1,value:new A_(this.schema)}):this.return()}_readNextMessageAndValidate(t){return this._reader.readMessage(t)}},Fx=class extends N8{constructor(t,r){super(r),this._reader=new lT(this._handle=t)}isAsync(){return!0}isStream(){return!0}[Symbol.asyncIterator](){return this}cancel(){return gr(this,void 0,void 0,function*(){!this.closed&&(this.closed=!0)&&(yield this.reset()._reader.return(),this._reader=null,this.dictionaries=null)})}open(t){return gr(this,void 0,void 0,function*(){return this.closed||(this.autoDestroy=Int(this,t),this.schema||(this.schema=yield this._reader.readSchema())||(yield this.cancel())),this})}throw(t){return gr(this,void 0,void 0,function*(){return!this.closed&&this.autoDestroy&&(this.closed=!0)?yield this.reset()._reader.throw(t):Es})}return(t){return gr(this,void 0,void 0,function*(){return!this.closed&&this.autoDestroy&&(this.closed=!0)?yield this.reset()._reader.return(t):Es})}next(){return gr(this,void 0,void 0,function*(){if(this.closed)return Es;let t,{_reader:r}=this;for(;t=yield this._readNextMessageAndValidate();)if(t.isSchema())yield this.reset(t.header());else if(t.isRecordBatch()){this._recordBatchIndex++;let i=t.header(),s=yield r.readMessageBody(t.bodyLength);return{done:!1,value:this._loadRecordBatch(i,s)}}else if(t.isDictionaryBatch()){this._dictionaryIndex++;let i=t.header(),s=yield r.readMessageBody(t.bodyLength),n=this._loadDictionaryBatch(i,s);this.dictionaries.set(i.id,n)}return this.schema&&this._recordBatchIndex===0?(this._recordBatchIndex++,{done:!1,value:new A_(this.schema)}):yield this.return()})}_readNextMessageAndValidate(t){return gr(this,void 0,void 0,function*(){return yield this._reader.readMessage(t)})}},F8=class extends Nx{get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}constructor(t,r){super(t instanceof O4?t:new O4(t),r)}isSync(){return!0}isFile(){return!0}open(t){if(!this.closed&&!this._footer){this.schema=(this._footer=this._readFooter()).schema;for(let r of this._footer.dictionaryBatches())r&&this._readDictionaryBatch(this._dictionaryIndex++)}return super.open(t)}readRecordBatch(t){var r;if(this.closed)return null;this._footer||this.open();let i=(r=this._footer)===null||r===void 0?void 0:r.getRecordBatch(t);if(i&&this._handle.seek(i.offset)){let s=this._reader.readMessage(nn.RecordBatch);if(s?.isRecordBatch()){let n=s.header(),o=this._reader.readMessageBody(s.bodyLength);return this._loadRecordBatch(n,o)}}return null}_readDictionaryBatch(t){var r;let i=(r=this._footer)===null||r===void 0?void 0:r.getDictionaryBatch(t);if(i&&this._handle.seek(i.offset)){let s=this._reader.readMessage(nn.DictionaryBatch);if(s?.isDictionaryBatch()){let n=s.header(),o=this._reader.readMessageBody(s.bodyLength),c=this._loadDictionaryBatch(n,o);this.dictionaries.set(n.id,c)}}}_readFooter(){let{_handle:t}=this,r=t.size-GN,i=t.readInt32(r),s=t.readAt(r-i,i);return y0.decode(s)}_readNextMessageAndValidate(t){var r;if(this._footer||this.open(),this._footer&&this._recordBatchIndex<this.numRecordBatches){let i=(r=this._footer)===null||r===void 0?void 0:r.getRecordBatch(this._recordBatchIndex);if(i&&this._handle.seek(i.offset))return this._reader.readMessage(t)}return null}},QN=class extends Fx{get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}constructor(t,...r){let i=typeof r[0]!="number"?r.shift():void 0,s=r[0]instanceof Map?r.shift():void 0;super(t instanceof ym?t:new ym(t,i),s)}isFile(){return!0}isAsync(){return!0}open(t){let r=Object.create(null,{open:{get:()=>super.open}});return gr(this,void 0,void 0,function*(){if(!this.closed&&!this._footer){this.schema=(this._footer=yield this._readFooter()).schema;for(let i of this._footer.dictionaryBatches())i&&(yield this._readDictionaryBatch(this._dictionaryIndex++))}return yield r.open.call(this,t)})}readRecordBatch(t){var r;return gr(this,void 0,void 0,function*(){if(this.closed)return null;this._footer||(yield this.open());let i=(r=this._footer)===null||r===void 0?void 0:r.getRecordBatch(t);if(i&&(yield this._handle.seek(i.offset))){let s=yield this._reader.readMessage(nn.RecordBatch);if(s?.isRecordBatch()){let n=s.header(),o=yield this._reader.readMessageBody(s.bodyLength);return this._loadRecordBatch(n,o)}}return null})}_readDictionaryBatch(t){var r;return gr(this,void 0,void 0,function*(){let i=(r=this._footer)===null||r===void 0?void 0:r.getDictionaryBatch(t);if(i&&(yield this._handle.seek(i.offset))){let s=yield this._reader.readMessage(nn.DictionaryBatch);if(s?.isDictionaryBatch()){let n=s.header(),o=yield this._reader.readMessageBody(s.bodyLength),c=this._loadDictionaryBatch(n,o);this.dictionaries.set(n.id,c)}}})}_readFooter(){return gr(this,void 0,void 0,function*(){let{_handle:t}=this;t._pending&&(yield t._pending);let r=t.size-GN,i=yield t.readInt32(r),s=yield t.readAt(r-i,i);return y0.decode(s)})}_readNextMessageAndValidate(t){return gr(this,void 0,void 0,function*(){if(this._footer||(yield this.open()),this._footer&&this._recordBatchIndex<this.numRecordBatches){let r=this._footer.getRecordBatch(this._recordBatchIndex);if(r&&(yield this._handle.seek(r.offset)))return yield this._reader.readMessage(t)}return null})}},KN=class extends Nx{constructor(t,r){super(t,r)}_loadVectors(t,r,i){return new a8(r,t.nodes,t.buffers,this.dictionaries,this.schema.metadataVersion).visitMany(i)}};function Int(e,t){return t&&typeof t.autoDestroy=="boolean"?t.autoDestroy:e.autoDestroy}function*Snt(e){let t=cu.from(e);try{if(!t.open({autoDestroy:!1}).closed)do yield t;while(!t.reset().open().closed)}finally{t.cancel()}}function Ent(e){return eu(this,arguments,function*(){let r=yield Fi(cu.from(e));try{if(!(yield Fi(r.open({autoDestroy:!1}))).closed)do yield yield Fi(r);while(!(yield Fi(r.reset().open())).closed)}finally{yield Fi(r.cancel())}})}function h5t(e){return new I0(new KN(e))}function f5t(e){let t=e.peek(Ox+7&-8);return t&&t.byteLength>=4?B8(t)?new g_(new F8(e.read())):new I0(new Nx(e)):new I0(new Nx(function*(){}()))}function p5t(e){return gr(this,void 0,void 0,function*(){let t=yield e.peek(Ox+7&-8);return t&&t.byteLength>=4?B8(t)?new g_(new F8(yield e.read())):new m_(new Fx(e)):new m_(new Fx(function(){return eu(this,arguments,function*(){})}()))})}function d5t(e){return gr(this,void 0,void 0,function*(){let{size:t}=yield e.stat(),r=new ym(e,t);return t>=Tnt&&B8(yield r.readAt(0,Ox+7&-8))?new O8(new QN(r)):new m_(new Fx(r))})}var $s=class e extends Wr{static assemble(...t){let r=s=>s.flatMap(n=>Array.isArray(n)?r(n):n instanceof po?n.data.children:n.data),i=new e;return i.visitMany(r(t)),i}constructor(){super(),this._byteLength=0,this._nodes=[],this._buffers=[],this._bufferRegions=[]}visit(t){if(t instanceof Li)return this.visitMany(t.data),this;let{type:r}=t;if(!yr.isDictionary(r)){let{length:i}=t;if(i>2147483647)throw new RangeError("Cannot write arrays larger than 2^31 - 1 in length");if(yr.isUnion(r))this.nodes.push(new hh(i,0));else{let{nullCount:s}=t;yr.isNull(r)||gf.call(this,s<=0?new Uint8Array(0):s_(t.offset,i,t.nullBitmap)),this.nodes.push(new hh(i,s))}}return super.visit(t)}visitNull(t){return this}visitDictionary(t){return this.visit(t.clone(t.type.indices))}get nodes(){return this._nodes}get buffers(){return this._buffers}get byteLength(){return this._byteLength}get bufferRegions(){return this._bufferRegions}};function gf(e){let t=e.byteLength+7&-8;return this.buffers.push(e),this.bufferRegions.push(new Sc(this._byteLength,t)),this._byteLength+=t,this}function A5t(e){var t;let{type:r,length:i,typeIds:s,valueOffsets:n}=e;if(gf.call(this,s),r.mode===as.Sparse)return JN.call(this,e);if(r.mode===as.Dense){if(e.offset<=0)return gf.call(this,n),JN.call(this,e);{let o=new Int32Array(i),c=Object.create(null),f=Object.create(null);for(let p,x,E=-1;++E<i;)(p=s[E])!==void 0&&((x=c[p])===void 0&&(x=c[p]=n[E]),o[E]=n[E]-x,f[p]=((t=f[p])!==null&&t!==void 0?t:0)+1);gf.call(this,o),this.visitMany(e.children.map((p,x)=>{let E=r.typeIds[x],T=c[E],D=f[E];return p.slice(T,Math.min(i,D))}))}}return this}function m5t(e){let t;return e.nullCount>=e.length?gf.call(this,new Uint8Array(0)):(t=e.values)instanceof Uint8Array?gf.call(this,s_(e.offset,e.length,t)):gf.call(this,o_(e.values))}function M0(e){return gf.call(this,e.values.subarray(0,e.length*e.stride))}function L8(e){let{length:t,values:r,valueOffsets:i}=e,s=Ks(i[0]),n=Ks(i[t]),o=Math.min(n-s,r.byteLength-s);return gf.call(this,IM(-s,t+1,i)),gf.call(this,r.subarray(s,s+o)),this}function tF(e){let{length:t,valueOffsets:r}=e;if(r){let{[0]:i,[t]:s}=r;return gf.call(this,IM(-i,t+1,r)),this.visit(e.children[0].slice(i,s-i))}return this.visit(e.children[0])}function JN(e){return this.visitMany(e.type.children.map((t,r)=>e.children[r]).filter(Boolean))[0]}$s.prototype.visitBool=m5t;$s.prototype.visitInt=M0;$s.prototype.visitFloat=M0;$s.prototype.visitUtf8=L8;$s.prototype.visitLargeUtf8=L8;$s.prototype.visitBinary=L8;$s.prototype.visitLargeBinary=L8;$s.prototype.visitFixedSizeBinary=M0;$s.prototype.visitDate=M0;$s.prototype.visitTimestamp=M0;$s.prototype.visitTime=M0;$s.prototype.visitDecimal=M0;$s.prototype.visitList=tF;$s.prototype.visitStruct=JN;$s.prototype.visitUnion=A5t;$s.prototype.visitInterval=M0;$s.prototype.visitDuration=M0;$s.prototype.visitFixedSizeList=tF;$s.prototype.visitMap=tF;var __=class extends c_{static throughNode(t){throw new Error('"throughNode" not available in this environment')}static throughDOM(t,r){throw new Error('"throughDOM" not available in this environment')}constructor(t){super(),this._position=0,this._started=!1,this._sink=new Lp,this._schema=null,this._dictionaryBlocks=[],this._recordBatchBlocks=[],this._dictionaryDeltaOffsets=new Map,$l(t)||(t={autoDestroy:!0,writeLegacyIpcFormat:!1}),this._autoDestroy=typeof t.autoDestroy=="boolean"?t.autoDestroy:!0,this._writeLegacyIpcFormat=typeof t.writeLegacyIpcFormat=="boolean"?t.writeLegacyIpcFormat:!1}toString(t=!1){return this._sink.toString(t)}toUint8Array(t=!1){return this._sink.toUint8Array(t)}writeAll(t){return ru(t)?t.then(r=>this.writeAll(r)):Ju(t)?rF(this,t):eF(this,t)}get closed(){return this._sink.closed}[Symbol.asyncIterator](){return this._sink[Symbol.asyncIterator]()}toDOMStream(t){return this._sink.toDOMStream(t)}toNodeStream(t){return this._sink.toNodeStream(t)}close(){return this.reset()._sink.close()}abort(t){return this.reset()._sink.abort(t)}finish(){return this._autoDestroy?this.close():this.reset(this._sink,this._schema),this}reset(t=this._sink,r=null){return t===this._sink||t instanceof Lp?this._sink=t:(this._sink=new Lp,t&&Urt(t)?this.toDOMStream({type:"bytes"}).pipeTo(t):t&&Vrt(t)&&this.toNodeStream({objectMode:!1}).pipe(t)),this._started&&this._schema&&this._writeFooter(this._schema),this._started=!1,this._dictionaryBlocks=[],this._recordBatchBlocks=[],this._dictionaryDeltaOffsets=new Map,(!r||!d_(r,this._schema))&&(r==null?(this._position=0,this._schema=null):(this._started=!0,this._schema=r,this._writeSchema(r))),this}write(t){let r=null;if(this._sink){if(t==null)return this.finish()&&void 0;if(t instanceof $a&&!(r=t.schema))return this.finish()&&void 0;if(t instanceof po&&!(r=t.schema))return this.finish()&&void 0}else throw new Error("RecordBatchWriter is closed");if(r&&!d_(r,this._schema)){if(this._started&&this._autoDestroy)return this.close();this.reset(this._sink,r)}t instanceof po?t instanceof A_||this._writeRecordBatch(t):t instanceof $a?this.writeAll(t.batches):af(t)&&this.writeAll(t)}_writeMessage(t,r=8){let i=r-1,s=Ic.encode(t),n=s.byteLength,o=this._writeLegacyIpcFormat?4:8,c=n+o+i&~i,f=c-n-o;return t.headerType===nn.RecordBatch?this._recordBatchBlocks.push(new x0(c,t.bodyLength,this._position)):t.headerType===nn.DictionaryBatch&&this._dictionaryBlocks.push(new x0(c,t.bodyLength,this._position)),this._writeLegacyIpcFormat||this._write(Int32Array.of(-1)),this._write(Int32Array.of(c-o)),n>0&&this._write(s),this._writePadding(f)}_write(t){if(this._started){let r=ei(t);r&&r.byteLength>0&&(this._sink.write(r),this._position+=r.byteLength)}return this}_writeSchema(t){return this._writeMessage(Ic.from(t))}_writeFooter(t){return this._writeLegacyIpcFormat?this._write(Int32Array.of(0)):this._write(Int32Array.of(-1,0))}_writeMagic(){return this._write(Bx)}_writePadding(t){return t>0?this._write(new Uint8Array(t)):this}_writeRecordBatch(t){let{byteLength:r,nodes:i,bufferRegions:s,buffers:n}=$s.assemble(t),o=new Ha(t.numRows,i,s),c=Ic.from(o,r);return this._writeDictionaries(t)._writeMessage(c)._writeBodyBuffers(n)}_writeDictionaryBatch(t,r,i=!1){this._dictionaryDeltaOffsets.set(r,t.length+(this._dictionaryDeltaOffsets.get(r)||0));let{byteLength:s,nodes:n,bufferRegions:o,buffers:c}=$s.assemble(new Li([t])),f=new Ha(t.length,n,o),p=new Ec(f,r,i),x=Ic.from(p,s);return this._writeMessage(x)._writeBodyBuffers(c)}_writeBodyBuffers(t){let r,i,s;for(let n=-1,o=t.length;++n<o;)(r=t[n])&&(i=r.byteLength)>0&&(this._write(r),(s=(i+7&-8)-i)>0&&this._writePadding(s));return this}_writeDictionaries(t){for(let[r,i]of t.dictionaries){let s=this._dictionaryDeltaOffsets.get(r)||0;if(s===0||(i=i?.slice(s)).length>0)for(let n of i.data)this._writeDictionaryBatch(n,r,s>0),s+=n.length}return this}},y_=class e extends __{static writeAll(t,r){let i=new e(r);return ru(t)?t.then(s=>i.writeAll(s)):Ju(t)?rF(i,t):eF(i,t)}},x_=class e extends __{static writeAll(t){let r=new e;return ru(t)?t.then(i=>r.writeAll(i)):Ju(t)?rF(r,t):eF(r,t)}constructor(){super(),this._autoDestroy=!0}_writeSchema(t){return this._writeMagic()._writePadding(2)}_writeFooter(t){let r=y0.encode(new y0(t,Vn.V5,this._recordBatchBlocks,this._dictionaryBlocks));return super._writeFooter(t)._write(r)._write(Int32Array.of(r.byteLength))._writeMagic()}};function eF(e,t){let r=t;t instanceof $a&&(r=t.batches,e.reset(void 0,t.schema));for(let i of r)e.write(i);return e.finish()}function rF(e,t){var r,i,s,n,o,c,f;return gr(this,void 0,void 0,function*(){try{for(r=!0,i=of(t);s=yield i.next(),n=s.done,!n;r=!0){f=s.value,r=!1;let p=f;e.write(p)}}catch(p){o={error:p}}finally{try{!r&&!n&&(c=i.return)&&(yield c.call(i))}finally{if(o)throw o.error}}return e.finish()})}function Mnt(e,t){if(Ju(e))return _5t(e,t);if(af(e))return g5t(e,t);throw new Error("toDOMStream() must be called with an Iterable or AsyncIterable")}function g5t(e,t){let r=null,i=t?.type==="bytes"||!1,s=t?.highWaterMark||Math.pow(2,24);return new ReadableStream(Object.assign(Object.assign({},t),{start(o){n(o,r||(r=e[Symbol.iterator]()))},pull(o){r?n(o,r):o.close()},cancel(){(r?.return&&r.return()||!0)&&(r=null)}}),Object.assign({highWaterMark:i?s:void 0},t));function n(o,c){let f,p=null,x=o.desiredSize||null;for(;!(p=c.next(i?x:null)).done;)if(ArrayBuffer.isView(p.value)&&(f=ei(p.value))&&(x!=null&&i&&(x=x-f.byteLength+1),p.value=f),o.enqueue(p.value),x!=null&&--x<=0)return;o.close()}}function _5t(e,t){let r=null,i=t?.type==="bytes"||!1,s=t?.highWaterMark||Math.pow(2,24);return new ReadableStream(Object.assign(Object.assign({},t),{start(o){return gr(this,void 0,void 0,function*(){yield n(o,r||(r=e[Symbol.asyncIterator]()))})},pull(o){return gr(this,void 0,void 0,function*(){r?yield n(o,r):o.close()})},cancel(){return gr(this,void 0,void 0,function*(){(r?.return&&(yield r.return())||!0)&&(r=null)})}}),Object.assign({highWaterMark:i?s:void 0},t));function n(o,c){return gr(this,void 0,void 0,function*(){let f,p=null,x=o.desiredSize||null;for(;!(p=yield c.next(i?x:null)).done;)if(ArrayBuffer.isView(p.value)&&(f=ei(p.value))&&(x!=null&&i&&(x=x-f.byteLength+1),p.value=f),o.enqueue(p.value),x!=null&&--x<=0)return;o.close()})}}function Rnt(e){return new iF(e)}var iF=class{constructor(t){this._numChunks=0,this._finished=!1,this._bufferedSize=0;let{["readableStrategy"]:r,["writableStrategy"]:i,["queueingStrategy"]:s="count"}=t,n=Lrt(t,["readableStrategy","writableStrategy","queueingStrategy"]);this._controller=null,this._builder=Up(n),this._getSize=s!=="bytes"?Cnt:Pnt;let{["highWaterMark"]:o=s==="bytes"?Math.pow(2,14):1e3}=Object.assign({},r),{["highWaterMark"]:c=s==="bytes"?Math.pow(2,14):1e3}=Object.assign({},i);this.readable=new ReadableStream({cancel:()=>{this._builder.clear()},pull:f=>{this._maybeFlush(this._builder,this._controller=f)},start:f=>{this._maybeFlush(this._builder,this._controller=f)}},{highWaterMark:o,size:s!=="bytes"?Cnt:Pnt}),this.writable=new WritableStream({abort:()=>{this._builder.clear()},write:()=>{this._maybeFlush(this._builder,this._controller)},close:()=>{this._maybeFlush(this._builder.finish(),this._controller)}},{highWaterMark:c,size:f=>this._writeValueAndReturnChunkSize(f)})}_writeValueAndReturnChunkSize(t){let r=this._bufferedSize;return this._bufferedSize=this._getSize(this._builder.append(t)),this._bufferedSize-r}_maybeFlush(t,r){r!=null&&(this._bufferedSize>=r.desiredSize&&++this._numChunks&&this._enqueue(r,t.toVector()),t.finished&&((t.length>0||this._numChunks===0)&&++this._numChunks&&this._enqueue(r,t.toVector()),!this._finished&&(this._finished=!0)&&this._enqueue(r,null)))}_enqueue(t,r){this._bufferedSize=0,this._controller=null,r==null?t.close():t.enqueue(r)}},Cnt=e=>{var t;return(t=e?.length)!==null&&t!==void 0?t:0},Pnt=e=>{var t;return(t=e?.byteLength)!==null&&t!==void 0?t:0};function z8(e,t){let r=new Lp,i=null,s=new ReadableStream({cancel(){return gr(this,void 0,void 0,function*(){yield r.close()})},start(c){return gr(this,void 0,void 0,function*(){yield o(c,i||(i=yield n()))})},pull(c){return gr(this,void 0,void 0,function*(){i?yield o(c,i):c.close()})}});return{writable:new WritableStream(r,Object.assign({highWaterMark:Math.pow(2,14)},e)),readable:s};function n(){return gr(this,void 0,void 0,function*(){return yield(yield cu.from(r)).open(t)})}function o(c,f){return gr(this,void 0,void 0,function*(){let p=c.desiredSize,x=null;for(;!(x=yield f.next()).done;)if(c.enqueue(x.value),p!=null&&--p<=0)return;c.close()})}}function U8(e,t){let r=new this(e),i=new ch(r),s=new ReadableStream({cancel(){return gr(this,void 0,void 0,function*(){yield i.cancel()})},pull(o){return gr(this,void 0,void 0,function*(){yield n(o)})},start(o){return gr(this,void 0,void 0,function*(){yield n(o)})}},Object.assign({highWaterMark:Math.pow(2,14)},t));return{writable:new WritableStream(r,e),readable:s};function n(o){return gr(this,void 0,void 0,function*(){let c=null,f=o.desiredSize;for(;c=yield i.read(f||null);)if(o.enqueue(c),f!=null&&(f-=c.byteLength)<=0)return;o.close()})}}function uT(e){let t=cu.from(e);return ru(t)?t.then(r=>uT(r)):t.isAsync()?t.readAll().then(r=>new $a(r)):new $a(t.readAll())}function V8(e,t="stream"){return(t==="stream"?y_:x_).writeAll(e).toUint8Array(!0)}var O5t=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},dN),UN),RN),AN),cN),PN),fN),{compareSchemas:d_,compareFields:nnt,compareTypes:snt});Va.toDOMStream=Mnt;Bs.throughDOM=Rnt;cu.throughDOM=z8;g_.throughDOM=z8;I0.throughDOM=z8;__.throughDOM=U8;x_.throughDOM=U8;y_.throughDOM=U8;function hT(e,t=1){return(e*t+63&-64||64)/t}function ql(e,t,r=e.BYTES_PER_ELEMENT){return new e(hT(t,r))}function j8(e){return e instanceof An?e:new An(e.type,0,e.length,e.nulls,e.buffers,null,e.dict)}function knt(e){return new Li([j8(e)])}var nF=new TextEncoder;function N5t(e,t,r){let i=nF.encode(r);return e.set(i,t),i.length}function F5t(e,t,r){return nF.encodeInto(r,e.subarray(t)).written}var Dnt=nF.encodeInto?F5t:N5t;function sF(e,t){let r=ql(e.ArrayType,t);return{set(i,s){r[s]=i},data:()=>({type:e,length:t,buffers:[null,r]})}}function Bnt(e,t){let r=ql(e.ArrayType,t/8);return{set(i,s){i&&(r[s>>3]|=1<<s%8)},data:()=>({type:e,length:t,buffers:[null,r]})}}function Ont(e,t){let r=ql(e.ArrayType,t);return{set(i,s){r[s]=i/864e5|0},data:()=>({type:e,length:t,buffers:[null,r]})}}function Nnt(e,t){let r=ql(e.ArrayType,t<<1);return{set(i,s){let n=s<<1;r[n]=i%4294967296|0,r[n+1]=i/4294967296|0},data:()=>({type:e,length:t,buffers:[null,r]})}}function Fnt(e){let t=Up({type:e,nullValues:[null,void 0]});return{set(r,i){t.set(i,r)},data:()=>t.finish().flush()}}function Lnt(e,t,r){let i=ql(Int32Array,t+1),s=ql(Uint8Array,3*r),n=0;return{set(o,c){n+=Dnt(s,n,o),i[c+1]=n},data:()=>{let o=hT(n),c=s.length>o?s.subarray(0,o):s;return{type:e,length:t,buffers:[i,c]}}}}function znt(e,t){let r=[],i=ql(e.indices.ArrayType,t),s=Object.create(null),n=-1,o=0;return{set(c,f){let p=String(c),x=s[p];x===void 0&&(o+=p.length,s[p]=x=++n,r.push(p)),i[f]=x},data:()=>({type:e,length:t,buffers:[null,i],dict:L5t(e.dictionary,r,o)})}}function L5t(e,t,r){let i=Lnt(e,t.length,r);return t.forEach(i.set),knt(i.data())}function Unt(e,t){let r=ql(Uint8Array,t/8),i=0;return{set(s,n){s==null?++i:(e.set(s,n),r[n>>3]|=1<<n%8)},data:()=>{let s=e.data();return i&&(s.nulls=i,s.buffers[2]=r),s}}}function Vnt(e,t,r=!0){let i;switch(e.typeId){case Ft.Int:i=e.bitWidth<64?sF:null;break;case Ft.Float:i=e.precision>0?sF:null;break;case Ft.Dictionary:i=e.dictionary.typeId===Ft.Utf8&&e.indices.typeId===Ft.Int&&e.indices.bitWidth<64?znt:null;break;case Ft.Bool:i=Bnt;break;case Ft.Date:i=e.unit?Nnt:Ont;break}return i==null?Fnt(e):r?Unt(i(e,t),t):i(e,t)}function jnt(e,t){let r=e.length,i=hT(r,e.BYTES_PER_ELEMENT),s=e;return r!==i&&(s=new e.constructor(i),s.set(e)),j8({type:t,length:r,buffers:[null,s]})}function $8(e,t,r,i,s=!0){let n=Vnt(i,e,s);return t(r,n.set),j8(n.data())}function Lx(e){if(e instanceof yr||e==null)return e;switch(e){case Ft.Binary:return new rh;case Ft.Bool:return new ih;case Ft.DateDay:return new fx;case Ft.DateMillisecond:case Ft.Date:return new px;case Ft.Dictionary:return new xl(new ou,new _l);case Ft.Float16:return new i_;case Ft.Float32:return new A0;case Ft.Float64:case Ft.Float:return new m0;case Ft.Int8:return new l0;case Ft.Int16:return new c0;case Ft.Int32:case Ft.Int:return new _l;case Ft.Int64:return new u0;case Ft.IntervalDayTime:return new _x;case Ft.Interval:case Ft.IntervalYearMonth:return new yx;case Ft.Null:return new xa;case Ft.TimeMicrosecond:return new mx;case Ft.TimeMillisecond:case Ft.Time:return new Ax;case Ft.TimeNanosecond:return new gx;case Ft.TimeSecond:return new dx;case Ft.Uint8:return new h0;case Ft.Uint16:return new f0;case Ft.Uint32:return new p0;case Ft.Uint64:return new d0;case Ft.Utf8:return new ou;default:nr(`Unsupported type code: ${Ds(e)}. Use a data type constructor instead?`)}}function $nt(e){return e.getUTCHours()===0&&e.getUTCMinutes()===0&&e.getUTCSeconds()===0&&e.getUTCMilliseconds()===0}function H8(e,t){let r=oF();return e(t,r.add),r}function oF(){let e={count:0,nulls:0,bools:0,nums:0,ints:0,bigints:0,min:1/0,max:-1/0,digits:0,dates:0,utcdays:0,strings:0,strlen:0,arrays:0,minlen:1/0,maxlen:0,structs:0,add(t){if(++e.count,t==null){++e.nulls;return}let r=typeof t;if(r==="string")++e.strings;else if(r==="number")++e.nums,t<e.min&&(e.min=t),t>e.max&&(e.max=t),Number.isInteger(t)&&++e.ints;else if(r==="boolean")++e.bools;else if(r==="object")if(za(t))++e.dates,$nt(t)&&++e.utcdays;else if(Jc(t)){++e.arrays,t.length<e.minlen&&(e.minlen=t.length),t.length>e.maxlen&&(e.maxlen=t.length);let i=e.array_prof||(e.array_prof=oF());t.forEach(i.add)}else{++e.structs;let i=e.struct_prof||(e.struct_prof={});for(let s in t)(i[s]||(i[s]=oF())).add(t[s])}else r==="bigint"&&(++e.bigints,t<e.min&&(e.min=t),t>e.max&&(e.max=t))},type(){return Lx(z5t(e))}};return e}function z5t(e){let t=e.count-e.nulls;if(t===0)return Ft.Null;if(e.ints===t){let r=Math.max(Math.abs(e.min)-1,e.max);return e.min<0?r>=2**31?Ft.Float64:r<128?Ft.Int8:r<32768?Ft.Int16:Ft.Int32:r>=2**32?Ft.Float64:r<256?Ft.Uint8:r<65536?Ft.Uint16:Ft.Uint32}else{if(e.nums===t)return Ft.Float64;if(e.bigints===t){let r=-e.min>e.max?-e.min-1n:e.max;return e.min<0?r<2**63?Ft.Int64:nr(`BigInt exceeds 64 bits: ${r}`):e.max<2**64?Ft.Uint64:nr(`BigInt exceeds 64 bits: ${e.max}`)}else{if(e.bools===t)return Ft.Bool;if(e.utcdays===t)return Ft.DateDay;if(e.dates===t)return Ft.DateMillisecond;if(e.arrays===t){let r=zi.new("value",e.array_prof.type(),!0);return e.minlen===e.maxlen?new wc(e.minlen,r):new vc(r)}else if(e.structs===t){let r=e.struct_prof;return new es(Object.keys(r).map(i=>zi.new(i,r[i].type(),!0)))}else{if(e.strings>0)return Ft.Dictionary;nr("Type inference failure")}}}}function Hnt(e,t,r,i,s,n=!0){if(s=Lx(s),!s){let o=H8(i,t);n=o.nulls>0,s=o.type()}return $8(r,i,t,s,n)}function qnt(e,t,r,i,s,n=!0){s=Lx(s);let o=e.column(t),c=!(e.isFiltered()||e.isOrdered()),f=U5t(o);if(f&&c&&Wnt(f.type,s))return f;let p=o.data;if(bp(p)){let x=V5t(p);if(c&&x&&Wnt(x,s))return jnt(p,x);s=s||x,n=!1}if(!s){let x=H8(i,o);n=x.nulls>0,s=x.type()}return $8(r,i,o,s,n)}function U5t(e){return e instanceof Li?e:e.vector instanceof Li?e.vector:null}function V5t(e){let r={Float32Array:A0,Float64Array:m0,Int8Array:l0,Int16Array:c0,Int32Array:_l,Uint8Array:h0,Uint16Array:f0,Uint32Array:p0,BigInt64Array:u0,BigUint64Array:d0}[e.constructor.name];return r?new r:null}function Wnt(e,t){return!e||!t?!0:e.compareTo(t)}function Ynt(e,t,r){let i=Math.min(e.length,r+t);return(s,n)=>{for(let o=r;o<i;++o)n(e[o][s],o)}}function Xnt(e,t,r){let i=r===0&&e.numRows()<=t&&!e.isFiltered()&&!e.isOrdered();return(s,n)=>{let o=-1;i&&Jc(s.data)?s.data.forEach(n):e.scan(c=>n(s.get(c),++o),!0,t,r)}}var Znt=()=>nr("Apache Arrow not imported, see https://github.com/uwdata/arquero#usage");function Gnt(){try{return $a}catch{Znt()}}function Qnt(){try{return uT}catch{Znt()}}function fT(e,t={}){let{types:r={}}=t,{dataFrom:i,names:s,nrows:n,scan:o}=j5t(e,t),c={};s.forEach(p=>{let x=i(e,p,n,o,r[p]);x.length!==n&&nr("Column length mismatch"),c[p]=x});let f=Gnt();return new f(c)}function j5t(e,t){let{columns:r,limit:i=1/0,offset:s=0}=t,n=Ni(r)?r(e):oi(r)?r:null;if(oi(e))return{dataFrom:Hnt,names:n||Object.keys(e[0]),nrows:Math.min(i,e.length-s),scan:Ynt(e,i,s)};if($5t(e))return{dataFrom:qnt,names:n||e.columnNames(),nrows:Math.min(i,e.numRows()-s),scan:Xnt(e,i,s)};nr("Unsupported input data type")}function $5t(e){return e&&Ni(e.reify)}var Knt=fT;function Jnt(e,t={}){let{format:r,...i}=t,s=r||"stream";if(!["stream","file"].includes(s))throw Error("Unrecognised output format");return V8(fT(e,i),r)}function H5t(e){return e.getUTCHours()===0&&e.getUTCMinutes()===0&&e.getUTCSeconds()===0&&e.getUTCMilliseconds()===0}function tst(e,t={}){let r=0,i=0,s=0,n=0,o=0,c=0;return e(f=>{if(++r,f==null){++i;return}let p=typeof f;if(p==="object"&&za(f))++s,H5t(f)&&++n;else if(p==="number"&&(++o,f===f&&(f|0)!==f)){let x=f+"",E=x.indexOf(".");if(E>=0){let T=x.indexOf("e"),D=T>0?T:x.length;c=Math.max(c,D-E-1)}}}),{align:(i+o+s)/r>.5?"r":"l",format:{utc:s===n,digits:Math.min(c,t.maxdigits||6)}}}function xm(e,t){return Ni(t)?t(e):t||e.columnNames()}function W8(e,t,r){let i=r.format||{},s=r.align||{},n={},o={};return t.forEach(c=>{let f=tst(W5t(e,c),r);o[c]=s[c]||f.align,n[c]=i[c]||f.format}),{align:o,format:n}}function W5t(e,t){let r=e.column(t);return i=>e.scan(s=>i(r.get(s)))}function zx(e,t,r=100,i,s){let n=e.data(),o=t.length;e.scan(c=>{s.row(c);for(let f=0;f<o;++f){let p=t[f];s.cell(n[t[f]].get(c),p,f)}},!0,r,i)}function est(e,t={}){let r=xm(e,t.columns),i=t.format||{},s=t.delimiter||",",n=new RegExp(`["${s}
\r]`),o=p=>p==null?"":za(p)?sm(p,!0):n.test(p+="")?'"'+p.replace(/"/g,'""')+'"':p,c=r.map(o),f="";return zx(e,r,t.limit||1/0,t.offset,{row(){f+=c.join(s)+`
`},cell(p,x,E){c[E]=o(i[x]?i[x](p):p)}}),f+c.join(s)}function q8(e,t={}){if(Ni(t))return t(e)+"";let r=typeof e;if(r==="object"){if(za(e))return t.utc?sm(e):pM(e);{let i=JSON.stringify(e,(n,o)=>bp(o)?Array.from(o):o),s=t.maxlen||30;return i.length>s?i.slice(0,28)+"\u2026"+(i[0]==="["?"]":"}"):i}}else if(r==="number"){let i=t.digits||0,s;return e!==0&&((s=Math.abs(e))>=1e18||s<Math.pow(10,-i))?e.toExponential(i):e.toFixed(i)}else return e+""}function b_(e,t,r={}){for(let i in e)r[i]=t(e[i],i);return r}function rst(e,t={}){let r=xm(e,t.columns),{align:i,format:s}=W8(e,r,t),n=q5t(t),o=t.null,c=z=>z==="c"?"center":z==="r"?"right":"left",f=z=>z.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),p=(z,U)=>f(q8(z,U)),x=o?(z,U)=>z==null?o(z):p(z,U):p,E=-1,T=-1,D=(z,U,H)=>{let G=H?c(i[U]):"",Z=n[z]&&n[z](U,T,E)||"",Y=(G?`text-align: ${G};`+(Z?" ":""):"")+Z;return`<${z}${Y?` style="${Y}"`:""}>`},N=D("table")+D("thead")+D("tr",E)+r.map(z=>`${D("th",z,1)}${z}</th>`).join("")+"</tr></thead>"+D("tbody");return zx(e,r,t.limit,t.offset,{row(z){E=z,N+=(++T?"</tr>":"")+D("tr")},cell(z,U){N+=D("td",U,1)+x(z,s[U])+"</td>"}}),N+"</tr></tbody></table>"}function q5t(e){return b_(e.style,t=>Ni(t)?t:()=>t)}function Y8(e,t=!0,r=!1){return e===void 0||e?t:r}var Y5t=e=>za(e)?sm(e,!0):e;function ist(e,t={}){let r=Y8(t.schema),i=t.format||{},s=xm(e,t.columns),n="{";return r&&(n+='"schema":{"fields":'+JSON.stringify(s.map(o=>({name:o})))+'},"data":{'),s.forEach((o,c)=>{n+=(c?",":"")+JSON.stringify(o)+":[";let f=e.column(o),p=i[o]||Y5t,x=-1;e.scan(E=>{let T=f.get(E);n+=(++x?",":"")+JSON.stringify(p(T))},!0,t.limit,t.offset),n+="]"}),n+"}"+(r?"}":"")}function nst(e,t={}){let r=xm(e,t.columns),{align:i,format:s}=W8(e,r,t),n=f=>f==="c"?":-:":f==="r"?"-:":":-",o=f=>f.replace(/\|/g,"\\|"),c="|"+r.map(o).join("|")+`|
|`+r.map(f=>n(i[f])).join("|")+"|";return zx(e,r,t.limit,t.offset,{row(){c+=`
|`},cell(f,p){c+=o(q8(f,s[p]))+"|"}}),c+`
`}function X8(e,t){for(let[r,i]of am(t))e.set(r,i);return e}function Z8(e){return e.replace(/[.*+\-?^${}()|[\]\\]/g,"\\$&")}function Wa(e,t,r=new Map){return t=js(t)?e.columnName(t):t,On(t)?r.set(t,t):oi(t)?t.forEach(i=>Wa(e,i,r)):Ni(t)?Wa(e,t(e),r):As(t)?X8(r,t):nr(`Invalid column selection: ${Ds(t)}`),r}function G8(e,t){return e.toObject=t,e}function sst(e){return oi(e)?e.map(sst):e&&e.toObject?e.toObject():e}function uu(){return G8(e=>e.columnNames(),()=>({all:[]}))}function Ux(...e){return e=e.flat(),G8(t=>{let r=Wa(t,e);return t.columnNames(i=>!r.has(i))},()=>({not:sst(e)}))}function Q8(e,t){return G8(r=>{let i=js(e)?e:r.columnIndex(e),s=js(t)?t:r.columnIndex(t);if(s<i){let n=s;s=i,i=n}return r.columnNames().slice(i,s+1)},()=>({range:[e,t]}))}function Vx(e){return On(e)&&(e=RegExp(Z8(e))),G8(t=>t.columnNames(r=>e.test(r)),()=>({matches:[e.source,e.flags]}))}function ost(e){return Vx(RegExp("^"+Z8(e)))}function ast(e){return Vx(RegExp(Z8(e)+"$"))}function lst(e){return bp(e.data)?e.data.constructor:Array}var qa=class e extends G1{static from(t,r){return new e(Ket(t,r),r)}static new(t,r){if(t instanceof e)return t;let i={},s=[];for(let[n,o]of am(t))i[n]=o,s.push(n);return new e(i,r||s)}constructor(t,r,i,s,n,o){b_(t,hM,t),r=r||Object.keys(t);let c=r.length?t[r[0]].length:0;super(r,c,t,i,s,n,o)}create({data:t,names:r,filter:i,groups:s,order:n}){let o=i!==void 0?i:this.mask();return new e(t||this._data,r||(t?null:this._names),o,s!==void 0?s:grt(this._group,i&&o),n!==void 0?n:this._order,this._params)}assign(...t){let r=this.numRows(),i=this.reify(),s=ms(i).groupby(i.groups());return t.forEach(n=>{n=e.new(n),n.numRows()!==r&&nr("Assign row counts do not match"),n=n.reify(),n.columnNames(o=>s.add(o,n.column(o)))}),this.create(s.new())}columns(){return this._data}column(t){return this._data[t]}columnAt(t){return this._data[this._names[t]]}array(t,r=Array){let i=this.column(t),s=new r(this.numRows()),n=-1;return this.scan(o=>s[++n]=i.get(o),!0),s}get(t,r=0){let i=this.column(t);return this.isFiltered()||this.isOrdered()?i.get(this.indices()[r]):i.get(r)}getter(t){let r=this.column(t),i=this.isFiltered()||this.isOrdered()?this.indices():null;return i?s=>r.get(i[s]):r?s=>r.get(s):nr(`Unrecognized column: ${t}`)}object(t=0){return cst(this)(t)}objects(t={}){let{grouped:r,limit:i,offset:s}=t,n=Wa(this,t.columns||uu()),o=iN(n),c=[];if(this.scan((f,p)=>c.push(o(f,p)),!0,i,s),r&&this.isGrouped()){let f=[];return this.scan(p=>f.push(p),!0,i,s),yrt(this,f,c,r)}return c}*[Symbol.iterator](){let t=cst(this),r=this.numRows();for(let i=0;i<r;++i)yield t(i)}reify(t){let r=t?t.length:this.numRows(),i=this._names,s,n;if(!t&&!this.isOrdered())if(this.isFiltered())r===this.totalRows()&&(s=this.data());else return this;if(!s){let o=t?f=>t.forEach(f):f=>this.scan(f,!0),c=i.length;s={};for(let f=0;f<c;++f){let p=i[f],x=this.column(p),E=s[p]=new(lst(x))(r),T=-1;o(D=>E[++T]=x.get(D))}this.isGrouped()&&(n=_rt(this.groups(),o,!!t,r))}return this.create({data:s,names:i,groups:n,filter:null,order:null})}transform(...t){return t.flat().reduce((r,i)=>i(r),this)}toArrow(t){return Knt(this,t)}toArrowBuffer(t){return Jnt(this,t)}toCSV(t){return est(this,t)}toHTML(t){return rst(this,t)}toJSON(t){return ist(this,t)}toMarkdown(t){return nst(this,t)}};function cst(e){let t=e._builder;if(!t){let r=iN(e.columnNames()),i=e.data();if(e.isOrdered()||e.isFiltered()){let s=e.indices();t=n=>r(s[n],i)}else t=s=>r(s,i);e._builder=t}return t}var v_=class{constructor(t){this._outputs=t}size(){return this._outputs.length}outputs(){return this._outputs}init(){return{}}add(){}rem(){}write(){}};function sn(e,t,r,i){let s=r[e.type]||r.Default;if(s&&s(e,t,i)===!1)return;let n=X5t[e.type];n&&n(e,t,r)}var K8=(e,t,r)=>{sn(e.argument,t,r,e)},aF=(e,t,r)=>{sn(e.left,t,r,e),sn(e.right,t,r,e)},ust=(e,t,r)=>{sn(e.test,t,r,e),sn(e.consequent,t,r,e),e.alternate&&sn(e.alternate,t,r,e)},lF=(e,t,r)=>{jp(e.params,t,r,e),sn(e.body,t,r,e)},hst=(e,t,r)=>{sn(e.callee,t,r,e),jp(e.arguments,t,r,e)},jp=(e,t,r,i)=>{e.forEach(s=>sn(s,t,r,i))},X5t={TemplateLiteral:(e,t,r)=>{jp(e.expressions,t,r,e),jp(e.quasis,t,r,e)},MemberExpression:(e,t,r)=>{sn(e.object,t,r,e),sn(e.property,t,r,e)},CallExpression:hst,NewExpression:hst,ArrayExpression:(e,t,r)=>{jp(e.elements,t,r,e)},AssignmentExpression:aF,AwaitExpression:K8,BinaryExpression:aF,LogicalExpression:aF,UnaryExpression:K8,UpdateExpression:K8,ConditionalExpression:ust,ObjectExpression:(e,t,r)=>{jp(e.properties,t,r,e)},Property:(e,t,r)=>{sn(e.key,t,r,e),sn(e.value,t,r,e)},ArrowFunctionExpression:lF,FunctionExpression:lF,FunctionDeclaration:lF,VariableDeclaration:(e,t,r)=>{jp(e.declarations,t,r,e)},VariableDeclarator:(e,t,r)=>{sn(e.id,t,r,e),sn(e.init,t,r,e)},SpreadElement:(e,t,r)=>{sn(e.argument,t,r,e)},BlockStatement:(e,t,r)=>{jp(e.body,t,r,e)},ExpressionStatement:(e,t,r)=>{sn(e.expression,t,r,e)},IfStatement:ust,ForStatement:(e,t,r)=>{sn(e.init,t,r,e),sn(e.test,t,r,e),sn(e.update,t,r,e),sn(e.body,t,r,e)},WhileStatement:(e,t,r)=>{sn(e.test,t,r,e),sn(e.body,t,r,e)},DoWhileStatement:(e,t,r)=>{sn(e.body,t,r,e),sn(e.test,t,r,e)},SwitchStatement:(e,t,r)=>{sn(e.discriminant,t,r,e),jp(e.cases,t,r,e)},SwitchCase:(e,t,r)=>{e.test&&sn(e.test,t,r,e),jp(e.consequent,t,r,e)},ReturnStatement:K8,Program:(e,t,r)=>{sn(e.body[0],t,r,e)}};function pst(e){delete e.start,delete e.end,delete e.optional}function fst(e){pst(e),delete e.object,delete e.property,delete e.computed,e.table||delete e.table}function dst(e){return sn(e,null,{Column:fst,Constant:fst,Default:pst}),e}function Po(e,t){return t&&t.type===e}function Ast(e){return Po(vrt,e)||Po(brt,e)}function mst(e){return Ni(e)?e:()=>e}var Z5t="Escaped functions are not valid as rollup or pivot values.";function gst(e,t,r){e.aggronly&&nr(Z5t);let i="(row,data)=>fn("+rN(e.table.columnNames())+",$)";return{escape:ix.escape(i,mst(t.expr),r)}}var G5t=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,370,1,81,2,71,10,50,3,123,2,54,14,32,10,3,1,11,3,46,10,8,0,46,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,2,11,83,11,7,0,3,0,158,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,193,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,84,14,5,9,243,14,166,9,71,5,2,1,3,3,2,0,2,1,13,9,120,6,3,6,4,0,29,9,41,6,2,3,9,0,10,10,47,15,406,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,330,3,10,1,2,0,49,6,4,4,14,9,5351,0,7,14,13835,9,87,9,39,4,60,6,26,9,1014,0,2,54,8,3,82,0,12,1,19628,1,4706,45,3,22,543,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,101,0,161,6,10,9,357,0,62,13,499,13,983,6,110,6,6,9,4759,9,787719,239],wst=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,13,10,2,14,2,6,2,1,2,10,2,14,2,6,2,1,68,310,10,21,11,7,25,5,2,41,2,8,70,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,349,41,7,1,79,28,11,0,9,21,43,17,47,20,28,22,13,52,58,1,3,0,14,44,33,24,27,35,30,0,3,0,9,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,20,1,64,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,159,52,19,3,21,2,31,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,14,0,72,26,38,6,186,43,117,63,32,7,3,0,3,7,2,1,2,23,16,0,2,0,95,7,3,38,17,0,2,0,29,0,11,39,8,0,22,0,12,45,20,0,19,72,264,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,328,18,16,0,2,12,2,33,125,0,80,921,103,110,18,195,2637,96,16,1071,18,5,4026,582,8634,568,8,30,18,78,18,29,19,47,17,3,32,20,6,18,689,63,129,74,6,0,67,12,65,1,2,0,29,6135,9,1237,43,8,8936,3,2,6,2,1,2,290,16,0,30,2,3,0,15,3,9,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,1845,30,7,5,262,61,147,44,11,6,17,0,322,29,19,43,485,27,757,6,2,3,2,1,2,14,2,196,60,67,8,0,1205,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42719,33,4153,7,221,3,5761,15,7472,16,621,2467,541,1507,4938,6,4191],Q5t="\u200C\u200D\xB7\u0300-\u036F\u0387\u0483-\u0487\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u0669\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u06F0-\u06F9\u0711\u0730-\u074A\u07A6-\u07B0\u07C0-\u07C9\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u0898-\u089F\u08CA-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0966-\u096F\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u09E6-\u09EF\u09FE\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A66-\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0AE6-\u0AEF\u0AFA-\u0AFF\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B55-\u0B57\u0B62\u0B63\u0B66-\u0B6F\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0BE6-\u0BEF\u0C00-\u0C04\u0C3C\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C66-\u0C6F\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0CE6-\u0CEF\u0CF3\u0D00-\u0D03\u0D3B\u0D3C\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D66-\u0D6F\u0D81-\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0E50-\u0E59\u0EB1\u0EB4-\u0EBC\u0EC8-\u0ECE\u0ED0-\u0ED9\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1040-\u1049\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F-\u109D\u135D-\u135F\u1369-\u1371\u1712-\u1715\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u17E0-\u17E9\u180B-\u180D\u180F-\u1819\u18A9\u1920-\u192B\u1930-\u193B\u1946-\u194F\u19D0-\u19DA\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AB0-\u1ABD\u1ABF-\u1ACE\u1B00-\u1B04\u1B34-\u1B44\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BB0-\u1BB9\u1BE6-\u1BF3\u1C24-\u1C37\u1C40-\u1C49\u1C50-\u1C59\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF4\u1CF7-\u1CF9\u1DC0-\u1DFF\u200C\u200D\u203F\u2040\u2054\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\u30FB\uA620-\uA629\uA66F\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA82C\uA880\uA881\uA8B4-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F1\uA8FF-\uA909\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9D0-\uA9D9\uA9E5\uA9F0-\uA9F9\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA50-\uAA59\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uABF0-\uABF9\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFF10-\uFF19\uFF3F\uFF65",Tst="\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309B-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC",cF={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"},uF="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",K5t={5:uF,"5module":uF+" export import",6:uF+" const class extends export import super"},J5t=/^in(stanceof)?$/,tSt=new RegExp("["+Tst+"]"),eSt=new RegExp("["+Tst+Q5t+"]");function fF(e,t){for(var r=65536,i=0;i<t.length;i+=2){if(r+=t[i],r>e)return!1;if(r+=t[i+1],r>=e)return!0}return!1}function C0(e,t){return e<65?e===36:e<91?!0:e<97?e===95:e<123?!0:e<=65535?e>=170&&tSt.test(String.fromCharCode(e)):t===!1?!1:fF(e,wst)}function jx(e,t){return e<48?e===36:e<58?!0:e<65?!1:e<91?!0:e<97?e===95:e<123?!0:e<=65535?e>=170&&eSt.test(String.fromCharCode(e)):t===!1?!1:fF(e,wst)||fF(e,G5t)}var Pn=function(t,r){r===void 0&&(r={}),this.label=t,this.keyword=r.keyword,this.beforeExpr=!!r.beforeExpr,this.startsExpr=!!r.startsExpr,this.isLoop=!!r.isLoop,this.isAssign=!!r.isAssign,this.prefix=!!r.prefix,this.postfix=!!r.postfix,this.binop=r.binop||null,this.updateContext=null};function fh(e,t){return new Pn(e,{beforeExpr:!0,binop:t})}var ph={beforeExpr:!0},Mc={startsExpr:!0},mF={};function xn(e,t){return t===void 0&&(t={}),t.keyword=e,mF[e]=new Pn(e,t)}var dt={num:new Pn("num",Mc),regexp:new Pn("regexp",Mc),string:new Pn("string",Mc),name:new Pn("name",Mc),privateId:new Pn("privateId",Mc),eof:new Pn("eof"),bracketL:new Pn("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new Pn("]"),braceL:new Pn("{",{beforeExpr:!0,startsExpr:!0}),braceR:new Pn("}"),parenL:new Pn("(",{beforeExpr:!0,startsExpr:!0}),parenR:new Pn(")"),comma:new Pn(",",ph),semi:new Pn(";",ph),colon:new Pn(":",ph),dot:new Pn("."),question:new Pn("?",ph),questionDot:new Pn("?."),arrow:new Pn("=>",ph),template:new Pn("template"),invalidTemplate:new Pn("invalidTemplate"),ellipsis:new Pn("...",ph),backQuote:new Pn("`",Mc),dollarBraceL:new Pn("${",{beforeExpr:!0,startsExpr:!0}),eq:new Pn("=",{beforeExpr:!0,isAssign:!0}),assign:new Pn("_=",{beforeExpr:!0,isAssign:!0}),incDec:new Pn("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new Pn("!/~",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:fh("||",1),logicalAND:fh("&&",2),bitwiseOR:fh("|",3),bitwiseXOR:fh("^",4),bitwiseAND:fh("&",5),equality:fh("==/!=/===/!==",6),relational:fh("</>/<=/>=",7),bitShift:fh("<</>>/>>>",8),plusMin:new Pn("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:fh("%",10),star:fh("*",10),slash:fh("/",10),starstar:new Pn("**",{beforeExpr:!0}),coalesce:fh("??",1),_break:xn("break"),_case:xn("case",ph),_catch:xn("catch"),_continue:xn("continue"),_debugger:xn("debugger"),_default:xn("default",ph),_do:xn("do",{isLoop:!0,beforeExpr:!0}),_else:xn("else",ph),_finally:xn("finally"),_for:xn("for",{isLoop:!0}),_function:xn("function",Mc),_if:xn("if"),_return:xn("return",ph),_switch:xn("switch"),_throw:xn("throw",ph),_try:xn("try"),_var:xn("var"),_const:xn("const"),_while:xn("while",{isLoop:!0}),_with:xn("with"),_new:xn("new",{beforeExpr:!0,startsExpr:!0}),_this:xn("this",Mc),_super:xn("super",Mc),_class:xn("class",Mc),_extends:xn("extends",ph),_export:xn("export"),_import:xn("import",Mc),_null:xn("null",Mc),_true:xn("true",Mc),_false:xn("false",Mc),_in:xn("in",{beforeExpr:!0,binop:7}),_instanceof:xn("instanceof",{beforeExpr:!0,binop:7}),_typeof:xn("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_void:xn("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_delete:xn("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},mh=/\r\n?|\n|\u2028|\u2029/,rSt=new RegExp(mh.source,"g");function $x(e){return e===10||e===13||e===8232||e===8233}function Sst(e,t,r){r===void 0&&(r=e.length);for(var i=t;i<r;i++){var s=e.charCodeAt(i);if($x(s))return i<r-1&&s===13&&e.charCodeAt(i+1)===10?i+2:i+1}return-1}var Est=/[\u1680\u2000-\u200a\u202f\u205f\u3000\ufeff]/,dh=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,Ist=Object.prototype,iSt=Ist.hasOwnProperty,nSt=Ist.toString,mT=Object.hasOwn||function(e,t){return iSt.call(e,t)},_st=Array.isArray||function(e){return nSt.call(e)==="[object Array]"},yst=Object.create(null);function bm(e){return yst[e]||(yst[e]=new RegExp("^(?:"+e.replace(/ /g,"|")+")$"))}function vm(e){return e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode((e>>10)+55296,(e&1023)+56320))}var sSt=/(?:[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])/,dT=function(t,r){this.line=t,this.column=r};dT.prototype.offset=function(t){return new dT(this.line,this.column+t)};var nC=function(t,r,i){this.start=r,this.end=i,t.sourceFile!==null&&(this.source=t.sourceFile)};function Mst(e,t){for(var r=1,i=0;;){var s=Sst(e,i,t);if(s<0)return new dT(r,t-i);++r,i=s}}var pF={ecmaVersion:null,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowAwaitOutsideFunction:null,allowSuperOutsideMethod:null,allowHashBang:!1,checkPrivateFields:!0,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1},xst=!1;function oSt(e){var t={};for(var r in pF)t[r]=e&&mT(e,r)?e[r]:pF[r];if(t.ecmaVersion==="latest"?t.ecmaVersion=1e8:t.ecmaVersion==null?(!xst&&typeof console=="object"&&console.warn&&(xst=!0,console.warn(`Since Acorn 8.0.0, options.ecmaVersion is required.
Defaulting to 2020, but this will stop working in the future.`)),t.ecmaVersion=11):t.ecmaVersion>=2015&&(t.ecmaVersion-=2009),t.allowReserved==null&&(t.allowReserved=t.ecmaVersion<5),(!e||e.allowHashBang==null)&&(t.allowHashBang=t.ecmaVersion>=14),_st(t.onToken)){var i=t.onToken;t.onToken=function(s){return i.push(s)}}return _st(t.onComment)&&(t.onComment=aSt(t,t.onComment)),t}function aSt(e,t){return function(r,i,s,n,o,c){var f={type:r?"Block":"Line",value:i,start:s,end:n};e.locations&&(f.loc=new nC(this,o,c)),e.ranges&&(f.range=[s,n]),t.push(f)}}var AT=1,Hx=2,gF=4,Cst=8,Pst=16,Rst=32,_F=64,kst=128,gT=256,yF=AT|Hx|gT;function xF(e,t){return Hx|(e?gF:0)|(t?Cst:0)}var tC=0,bF=1,R0=2,Dst=3,Bst=4,Ost=5,Ko=function(t,r,i){this.options=t=oSt(t),this.sourceFile=t.sourceFile,this.keywords=bm(K5t[t.ecmaVersion>=6?6:t.sourceType==="module"?"5module":5]);var s="";t.allowReserved!==!0&&(s=cF[t.ecmaVersion>=6?6:t.ecmaVersion===5?5:3],t.sourceType==="module"&&(s+=" await")),this.reservedWords=bm(s);var n=(s?s+" ":"")+cF.strict;this.reservedWordsStrict=bm(n),this.reservedWordsStrictBind=bm(n+" "+cF.strictBind),this.input=String(r),this.containsEsc=!1,i?(this.pos=i,this.lineStart=this.input.lastIndexOf(`
`,i-1)+1,this.curLine=this.input.slice(0,this.lineStart).split(mh).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=dt.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.inModule=t.sourceType==="module",this.strict=this.inModule||this.strictDirective(this.pos),this.potentialArrowAt=-1,this.potentialArrowInForAwait=!1,this.yieldPos=this.awaitPos=this.awaitIdentPos=0,this.labels=[],this.undefinedExports=Object.create(null),this.pos===0&&t.allowHashBang&&this.input.slice(0,2)==="#!"&&this.skipLineComment(2),this.scopeStack=[],this.enterScope(AT),this.regexpState=null,this.privateNameStack=[]},$p={inFunction:{configurable:!0},inGenerator:{configurable:!0},inAsync:{configurable:!0},canAwait:{configurable:!0},allowSuper:{configurable:!0},allowDirectSuper:{configurable:!0},treatFunctionsAsVar:{configurable:!0},allowNewDotTarget:{configurable:!0},inClassStaticBlock:{configurable:!0}};Ko.prototype.parse=function(){var t=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel(t)};$p.inFunction.get=function(){return(this.currentVarScope().flags&Hx)>0};$p.inGenerator.get=function(){return(this.currentVarScope().flags&Cst)>0&&!this.currentVarScope().inClassFieldInit};$p.inAsync.get=function(){return(this.currentVarScope().flags&gF)>0&&!this.currentVarScope().inClassFieldInit};$p.canAwait.get=function(){for(var e=this.scopeStack.length-1;e>=0;e--){var t=this.scopeStack[e];if(t.inClassFieldInit||t.flags&gT)return!1;if(t.flags&Hx)return(t.flags&gF)>0}return this.inModule&&this.options.ecmaVersion>=13||this.options.allowAwaitOutsideFunction};$p.allowSuper.get=function(){var e=this.currentThisScope(),t=e.flags,r=e.inClassFieldInit;return(t&_F)>0||r||this.options.allowSuperOutsideMethod};$p.allowDirectSuper.get=function(){return(this.currentThisScope().flags&kst)>0};$p.treatFunctionsAsVar.get=function(){return this.treatFunctionsAsVarInScope(this.currentScope())};$p.allowNewDotTarget.get=function(){var e=this.currentThisScope(),t=e.flags,r=e.inClassFieldInit;return(t&(Hx|gT))>0||r};$p.inClassStaticBlock.get=function(){return(this.currentVarScope().flags&gT)>0};Ko.extend=function(){for(var t=[],r=arguments.length;r--;)t[r]=arguments[r];for(var i=this,s=0;s<t.length;s++)i=t[s](i);return i};Ko.parse=function(t,r){return new this(r,t).parse()};Ko.parseExpressionAt=function(t,r,i){var s=new this(i,t,r);return s.nextToken(),s.parseExpression()};Ko.tokenizer=function(t,r){return new this(r,t)};Object.defineProperties(Ko.prototype,$p);var Yl=Ko.prototype,lSt=/^(?:'((?:\\[^]|[^'\\])*?)'|"((?:\\[^]|[^"\\])*?)")/;Yl.strictDirective=function(e){if(this.options.ecmaVersion<5)return!1;for(;;){dh.lastIndex=e,e+=dh.exec(this.input)[0].length;var t=lSt.exec(this.input.slice(e));if(!t)return!1;if((t[1]||t[2])==="use strict"){dh.lastIndex=e+t[0].length;var r=dh.exec(this.input),i=r.index+r[0].length,s=this.input.charAt(i);return s===";"||s==="}"||mh.test(r[0])&&!(/[(`.[+\-/*%<>=,?^&]/.test(s)||s==="!"&&this.input.charAt(i+1)==="=")}e+=t[0].length,dh.lastIndex=e,e+=dh.exec(this.input)[0].length,this.input[e]===";"&&e++}};Yl.eat=function(e){return this.type===e?(this.next(),!0):!1};Yl.isContextual=function(e){return this.type===dt.name&&this.value===e&&!this.containsEsc};Yl.eatContextual=function(e){return this.isContextual(e)?(this.next(),!0):!1};Yl.expectContextual=function(e){this.eatContextual(e)||this.unexpected()};Yl.canInsertSemicolon=function(){return this.type===dt.eof||this.type===dt.braceR||mh.test(this.input.slice(this.lastTokEnd,this.start))};Yl.insertSemicolon=function(){if(this.canInsertSemicolon())return this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0};Yl.semicolon=function(){!this.eat(dt.semi)&&!this.insertSemicolon()&&this.unexpected()};Yl.afterTrailingComma=function(e,t){if(this.type===e)return this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),t||this.next(),!0};Yl.expect=function(e){this.eat(e)||this.unexpected()};Yl.unexpected=function(e){this.raise(e??this.start,"Unexpected token")};var sC=function(){this.shorthandAssign=this.trailingComma=this.parenthesizedAssign=this.parenthesizedBind=this.doubleProto=-1};Yl.checkPatternErrors=function(e,t){if(e){e.trailingComma>-1&&this.raiseRecoverable(e.trailingComma,"Comma is not permitted after the rest element");var r=t?e.parenthesizedAssign:e.parenthesizedBind;r>-1&&this.raiseRecoverable(r,t?"Assigning to rvalue":"Parenthesized pattern")}};Yl.checkExpressionErrors=function(e,t){if(!e)return!1;var r=e.shorthandAssign,i=e.doubleProto;if(!t)return r>=0||i>=0;r>=0&&this.raise(r,"Shorthand property assignments are valid only in destructuring patterns"),i>=0&&this.raiseRecoverable(i,"Redefinition of __proto__ property")};Yl.checkYieldAwaitInDefaultParams=function(){this.yieldPos&&(!this.awaitPos||this.yieldPos<this.awaitPos)&&this.raise(this.yieldPos,"Yield expression cannot be a default value"),this.awaitPos&&this.raise(this.awaitPos,"Await expression cannot be a default value")};Yl.isSimpleAssignTarget=function(e){return e.type==="ParenthesizedExpression"?this.isSimpleAssignTarget(e.expression):e.type==="Identifier"||e.type==="MemberExpression"};var zr=Ko.prototype;zr.parseTopLevel=function(e){var t=Object.create(null);for(e.body||(e.body=[]);this.type!==dt.eof;){var r=this.parseStatement(null,!0,t);e.body.push(r)}if(this.inModule)for(var i=0,s=Object.keys(this.undefinedExports);i<s.length;i+=1){var n=s[i];this.raiseRecoverable(this.undefinedExports[n].start,"Export '"+n+"' is not defined")}return this.adaptDirectivePrologue(e.body),this.next(),e.sourceType=this.options.sourceType,this.finishNode(e,"Program")};var vF={kind:"loop"},cSt={kind:"switch"};zr.isLet=function(e){if(this.options.ecmaVersion<6||!this.isContextual("let"))return!1;dh.lastIndex=this.pos;var t=dh.exec(this.input),r=this.pos+t[0].length,i=this.input.charCodeAt(r);if(i===91||i===92)return!0;if(e)return!1;if(i===123||i>55295&&i<56320)return!0;if(C0(i,!0)){for(var s=r+1;jx(i=this.input.charCodeAt(s),!0);)++s;if(i===92||i>55295&&i<56320)return!0;var n=this.input.slice(r,s);if(!J5t.test(n))return!0}return!1};zr.isAsyncFunction=function(){if(this.options.ecmaVersion<8||!this.isContextual("async"))return!1;dh.lastIndex=this.pos;var e=dh.exec(this.input),t=this.pos+e[0].length,r;return!mh.test(this.input.slice(this.pos,t))&&this.input.slice(t,t+8)==="function"&&(t+8===this.input.length||!(jx(r=this.input.charCodeAt(t+8))||r>55295&&r<56320))};zr.parseStatement=function(e,t,r){var i=this.type,s=this.startNode(),n;switch(this.isLet(e)&&(i=dt._var,n="let"),i){case dt._break:case dt._continue:return this.parseBreakContinueStatement(s,i.keyword);case dt._debugger:return this.parseDebuggerStatement(s);case dt._do:return this.parseDoStatement(s);case dt._for:return this.parseForStatement(s);case dt._function:return e&&(this.strict||e!=="if"&&e!=="label")&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement(s,!1,!e);case dt._class:return e&&this.unexpected(),this.parseClass(s,!0);case dt._if:return this.parseIfStatement(s);case dt._return:return this.parseReturnStatement(s);case dt._switch:return this.parseSwitchStatement(s);case dt._throw:return this.parseThrowStatement(s);case dt._try:return this.parseTryStatement(s);case dt._const:case dt._var:return n=n||this.value,e&&n!=="var"&&this.unexpected(),this.parseVarStatement(s,n);case dt._while:return this.parseWhileStatement(s);case dt._with:return this.parseWithStatement(s);case dt.braceL:return this.parseBlock(!0,s);case dt.semi:return this.parseEmptyStatement(s);case dt._export:case dt._import:if(this.options.ecmaVersion>10&&i===dt._import){dh.lastIndex=this.pos;var o=dh.exec(this.input),c=this.pos+o[0].length,f=this.input.charCodeAt(c);if(f===40||f===46)return this.parseExpressionStatement(s,this.parseExpression())}return this.options.allowImportExportEverywhere||(t||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),i===dt._import?this.parseImport(s):this.parseExport(s,r);default:if(this.isAsyncFunction())return e&&this.unexpected(),this.next(),this.parseFunctionStatement(s,!0,!e);var p=this.value,x=this.parseExpression();return i===dt.name&&x.type==="Identifier"&&this.eat(dt.colon)?this.parseLabeledStatement(s,p,x,e):this.parseExpressionStatement(s,x)}};zr.parseBreakContinueStatement=function(e,t){var r=t==="break";this.next(),this.eat(dt.semi)||this.insertSemicolon()?e.label=null:this.type!==dt.name?this.unexpected():(e.label=this.parseIdent(),this.semicolon());for(var i=0;i<this.labels.length;++i){var s=this.labels[i];if((e.label==null||s.name===e.label.name)&&(s.kind!=null&&(r||s.kind==="loop")||e.label&&r))break}return i===this.labels.length&&this.raise(e.start,"Unsyntactic "+t),this.finishNode(e,r?"BreakStatement":"ContinueStatement")};zr.parseDebuggerStatement=function(e){return this.next(),this.semicolon(),this.finishNode(e,"DebuggerStatement")};zr.parseDoStatement=function(e){return this.next(),this.labels.push(vF),e.body=this.parseStatement("do"),this.labels.pop(),this.expect(dt._while),e.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat(dt.semi):this.semicolon(),this.finishNode(e,"DoWhileStatement")};zr.parseForStatement=function(e){this.next();var t=this.options.ecmaVersion>=9&&this.canAwait&&this.eatContextual("await")?this.lastTokStart:-1;if(this.labels.push(vF),this.enterScope(0),this.expect(dt.parenL),this.type===dt.semi)return t>-1&&this.unexpected(t),this.parseFor(e,null);var r=this.isLet();if(this.type===dt._var||this.type===dt._const||r){var i=this.startNode(),s=r?"let":this.value;return this.next(),this.parseVar(i,!0,s),this.finishNode(i,"VariableDeclaration"),(this.type===dt._in||this.options.ecmaVersion>=6&&this.isContextual("of"))&&i.declarations.length===1?(this.options.ecmaVersion>=9&&(this.type===dt._in?t>-1&&this.unexpected(t):e.await=t>-1),this.parseForIn(e,i)):(t>-1&&this.unexpected(t),this.parseFor(e,i))}var n=this.isContextual("let"),o=!1,c=this.containsEsc,f=new sC,p=this.start,x=t>-1?this.parseExprSubscripts(f,"await"):this.parseExpression(!0,f);return this.type===dt._in||(o=this.options.ecmaVersion>=6&&this.isContextual("of"))?(t>-1?(this.type===dt._in&&this.unexpected(t),e.await=!0):o&&this.options.ecmaVersion>=8&&(x.start===p&&!c&&x.type==="Identifier"&&x.name==="async"?this.unexpected():this.options.ecmaVersion>=9&&(e.await=!1)),n&&o&&this.raise(x.start,"The left-hand side of a for-of loop may not start with 'let'."),this.toAssignable(x,!1,f),this.checkLValPattern(x),this.parseForIn(e,x)):(this.checkExpressionErrors(f,!0),t>-1&&this.unexpected(t),this.parseFor(e,x))};zr.parseFunctionStatement=function(e,t,r){return this.next(),this.parseFunction(e,pT|(r?0:dF),!1,t)};zr.parseIfStatement=function(e){return this.next(),e.test=this.parseParenExpression(),e.consequent=this.parseStatement("if"),e.alternate=this.eat(dt._else)?this.parseStatement("if"):null,this.finishNode(e,"IfStatement")};zr.parseReturnStatement=function(e){return!this.inFunction&&!this.options.allowReturnOutsideFunction&&this.raise(this.start,"'return' outside of function"),this.next(),this.eat(dt.semi)||this.insertSemicolon()?e.argument=null:(e.argument=this.parseExpression(),this.semicolon()),this.finishNode(e,"ReturnStatement")};zr.parseSwitchStatement=function(e){this.next(),e.discriminant=this.parseParenExpression(),e.cases=[],this.expect(dt.braceL),this.labels.push(cSt),this.enterScope(0);for(var t,r=!1;this.type!==dt.braceR;)if(this.type===dt._case||this.type===dt._default){var i=this.type===dt._case;t&&this.finishNode(t,"SwitchCase"),e.cases.push(t=this.startNode()),t.consequent=[],this.next(),i?t.test=this.parseExpression():(r&&this.raiseRecoverable(this.lastTokStart,"Multiple default clauses"),r=!0,t.test=null),this.expect(dt.colon)}else t||this.unexpected(),t.consequent.push(this.parseStatement(null));return this.exitScope(),t&&this.finishNode(t,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(e,"SwitchStatement")};zr.parseThrowStatement=function(e){return this.next(),mh.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),e.argument=this.parseExpression(),this.semicolon(),this.finishNode(e,"ThrowStatement")};var uSt=[];zr.parseCatchClauseParam=function(){var e=this.parseBindingAtom(),t=e.type==="Identifier";return this.enterScope(t?Rst:0),this.checkLValPattern(e,t?Bst:R0),this.expect(dt.parenR),e};zr.parseTryStatement=function(e){if(this.next(),e.block=this.parseBlock(),e.handler=null,this.type===dt._catch){var t=this.startNode();this.next(),this.eat(dt.parenL)?t.param=this.parseCatchClauseParam():(this.options.ecmaVersion<10&&this.unexpected(),t.param=null,this.enterScope(0)),t.body=this.parseBlock(!1),this.exitScope(),e.handler=this.finishNode(t,"CatchClause")}return e.finalizer=this.eat(dt._finally)?this.parseBlock():null,!e.handler&&!e.finalizer&&this.raise(e.start,"Missing catch or finally clause"),this.finishNode(e,"TryStatement")};zr.parseVarStatement=function(e,t,r){return this.next(),this.parseVar(e,!1,t,r),this.semicolon(),this.finishNode(e,"VariableDeclaration")};zr.parseWhileStatement=function(e){return this.next(),e.test=this.parseParenExpression(),this.labels.push(vF),e.body=this.parseStatement("while"),this.labels.pop(),this.finishNode(e,"WhileStatement")};zr.parseWithStatement=function(e){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),e.object=this.parseParenExpression(),e.body=this.parseStatement("with"),this.finishNode(e,"WithStatement")};zr.parseEmptyStatement=function(e){return this.next(),this.finishNode(e,"EmptyStatement")};zr.parseLabeledStatement=function(e,t,r,i){for(var s=0,n=this.labels;s<n.length;s+=1){var o=n[s];o.name===t&&this.raise(r.start,"Label '"+t+"' is already declared")}for(var c=this.type.isLoop?"loop":this.type===dt._switch?"switch":null,f=this.labels.length-1;f>=0;f--){var p=this.labels[f];if(p.statementStart===e.start)p.statementStart=this.start,p.kind=c;else break}return this.labels.push({name:t,kind:c,statementStart:this.start}),e.body=this.parseStatement(i?i.indexOf("label")===-1?i+"label":i:"label"),this.labels.pop(),e.label=r,this.finishNode(e,"LabeledStatement")};zr.parseExpressionStatement=function(e,t){return e.expression=t,this.semicolon(),this.finishNode(e,"ExpressionStatement")};zr.parseBlock=function(e,t,r){for(e===void 0&&(e=!0),t===void 0&&(t=this.startNode()),t.body=[],this.expect(dt.braceL),e&&this.enterScope(0);this.type!==dt.braceR;){var i=this.parseStatement(null);t.body.push(i)}return r&&(this.strict=!1),this.next(),e&&this.exitScope(),this.finishNode(t,"BlockStatement")};zr.parseFor=function(e,t){return e.init=t,this.expect(dt.semi),e.test=this.type===dt.semi?null:this.parseExpression(),this.expect(dt.semi),e.update=this.type===dt.parenR?null:this.parseExpression(),this.expect(dt.parenR),e.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(e,"ForStatement")};zr.parseForIn=function(e,t){var r=this.type===dt._in;return this.next(),t.type==="VariableDeclaration"&&t.declarations[0].init!=null&&(!r||this.options.ecmaVersion<8||this.strict||t.kind!=="var"||t.declarations[0].id.type!=="Identifier")&&this.raise(t.start,(r?"for-in":"for-of")+" loop variable declaration may not have an initializer"),e.left=t,e.right=r?this.parseExpression():this.parseMaybeAssign(),this.expect(dt.parenR),e.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(e,r?"ForInStatement":"ForOfStatement")};zr.parseVar=function(e,t,r,i){for(e.declarations=[],e.kind=r;;){var s=this.startNode();if(this.parseVarId(s,r),this.eat(dt.eq)?s.init=this.parseMaybeAssign(t):!i&&r==="const"&&!(this.type===dt._in||this.options.ecmaVersion>=6&&this.isContextual("of"))?this.unexpected():!i&&s.id.type!=="Identifier"&&!(t&&(this.type===dt._in||this.isContextual("of")))?this.raise(this.lastTokEnd,"Complex binding patterns require an initialization value"):s.init=null,e.declarations.push(this.finishNode(s,"VariableDeclarator")),!this.eat(dt.comma))break}return e};zr.parseVarId=function(e,t){e.id=this.parseBindingAtom(),this.checkLValPattern(e.id,t==="var"?bF:R0,!1)};var pT=1,dF=2,Nst=4;zr.parseFunction=function(e,t,r,i,s){this.initFunction(e),(this.options.ecmaVersion>=9||this.options.ecmaVersion>=6&&!i)&&(this.type===dt.star&&t&dF&&this.unexpected(),e.generator=this.eat(dt.star)),this.options.ecmaVersion>=8&&(e.async=!!i),t&pT&&(e.id=t&Nst&&this.type!==dt.name?null:this.parseIdent(),e.id&&!(t&dF)&&this.checkLValSimple(e.id,this.strict||e.generator||e.async?this.treatFunctionsAsVar?bF:R0:Dst));var n=this.yieldPos,o=this.awaitPos,c=this.awaitIdentPos;return this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(xF(e.async,e.generator)),t&pT||(e.id=this.type===dt.name?this.parseIdent():null),this.parseFunctionParams(e),this.parseFunctionBody(e,r,!1,s),this.yieldPos=n,this.awaitPos=o,this.awaitIdentPos=c,this.finishNode(e,t&pT?"FunctionDeclaration":"FunctionExpression")};zr.parseFunctionParams=function(e){this.expect(dt.parenL),e.params=this.parseBindingList(dt.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams()};zr.parseClass=function(e,t){this.next();var r=this.strict;this.strict=!0,this.parseClassId(e,t),this.parseClassSuper(e);var i=this.enterClassBody(),s=this.startNode(),n=!1;for(s.body=[],this.expect(dt.braceL);this.type!==dt.braceR;){var o=this.parseClassElement(e.superClass!==null);o&&(s.body.push(o),o.type==="MethodDefinition"&&o.kind==="constructor"?(n&&this.raiseRecoverable(o.start,"Duplicate constructor in the same class"),n=!0):o.key&&o.key.type==="PrivateIdentifier"&&hSt(i,o)&&this.raiseRecoverable(o.key.start,"Identifier '#"+o.key.name+"' has already been declared"))}return this.strict=r,this.next(),e.body=this.finishNode(s,"ClassBody"),this.exitClassBody(),this.finishNode(e,t?"ClassDeclaration":"ClassExpression")};zr.parseClassElement=function(e){if(this.eat(dt.semi))return null;var t=this.options.ecmaVersion,r=this.startNode(),i="",s=!1,n=!1,o="method",c=!1;if(this.eatContextual("static")){if(t>=13&&this.eat(dt.braceL))return this.parseClassStaticBlock(r),r;this.isClassElementNameStart()||this.type===dt.star?c=!0:i="static"}if(r.static=c,!i&&t>=8&&this.eatContextual("async")&&((this.isClassElementNameStart()||this.type===dt.star)&&!this.canInsertSemicolon()?n=!0:i="async"),!i&&(t>=9||!n)&&this.eat(dt.star)&&(s=!0),!i&&!n&&!s){var f=this.value;(this.eatContextual("get")||this.eatContextual("set"))&&(this.isClassElementNameStart()?o=f:i=f)}if(i?(r.computed=!1,r.key=this.startNodeAt(this.lastTokStart,this.lastTokStartLoc),r.key.name=i,this.finishNode(r.key,"Identifier")):this.parseClassElementName(r),t<13||this.type===dt.parenL||o!=="method"||s||n){var p=!r.static&&eC(r,"constructor"),x=p&&e;p&&o!=="method"&&this.raise(r.key.start,"Constructor can't have get/set modifier"),r.kind=p?"constructor":o,this.parseClassMethod(r,s,n,x)}else this.parseClassField(r);return r};zr.isClassElementNameStart=function(){return this.type===dt.name||this.type===dt.privateId||this.type===dt.num||this.type===dt.string||this.type===dt.bracketL||this.type.keyword};zr.parseClassElementName=function(e){this.type===dt.privateId?(this.value==="constructor"&&this.raise(this.start,"Classes can't have an element named '#constructor'"),e.computed=!1,e.key=this.parsePrivateIdent()):this.parsePropertyName(e)};zr.parseClassMethod=function(e,t,r,i){var s=e.key;e.kind==="constructor"?(t&&this.raise(s.start,"Constructor can't be a generator"),r&&this.raise(s.start,"Constructor can't be an async method")):e.static&&eC(e,"prototype")&&this.raise(s.start,"Classes may not have a static property named prototype");var n=e.value=this.parseMethod(t,r,i);return e.kind==="get"&&n.params.length!==0&&this.raiseRecoverable(n.start,"getter should have no params"),e.kind==="set"&&n.params.length!==1&&this.raiseRecoverable(n.start,"setter should have exactly one param"),e.kind==="set"&&n.params[0].type==="RestElement"&&this.raiseRecoverable(n.params[0].start,"Setter cannot use rest params"),this.finishNode(e,"MethodDefinition")};zr.parseClassField=function(e){if(eC(e,"constructor")?this.raise(e.key.start,"Classes can't have a field named 'constructor'"):e.static&&eC(e,"prototype")&&this.raise(e.key.start,"Classes can't have a static field named 'prototype'"),this.eat(dt.eq)){var t=this.currentThisScope(),r=t.inClassFieldInit;t.inClassFieldInit=!0,e.value=this.parseMaybeAssign(),t.inClassFieldInit=r}else e.value=null;return this.semicolon(),this.finishNode(e,"PropertyDefinition")};zr.parseClassStaticBlock=function(e){e.body=[];var t=this.labels;for(this.labels=[],this.enterScope(gT|_F);this.type!==dt.braceR;){var r=this.parseStatement(null);e.body.push(r)}return this.next(),this.exitScope(),this.labels=t,this.finishNode(e,"StaticBlock")};zr.parseClassId=function(e,t){this.type===dt.name?(e.id=this.parseIdent(),t&&this.checkLValSimple(e.id,R0,!1)):(t===!0&&this.unexpected(),e.id=null)};zr.parseClassSuper=function(e){e.superClass=this.eat(dt._extends)?this.parseExprSubscripts(null,!1):null};zr.enterClassBody=function(){var e={declared:Object.create(null),used:[]};return this.privateNameStack.push(e),e.declared};zr.exitClassBody=function(){var e=this.privateNameStack.pop(),t=e.declared,r=e.used;if(this.options.checkPrivateFields)for(var i=this.privateNameStack.length,s=i===0?null:this.privateNameStack[i-1],n=0;n<r.length;++n){var o=r[n];mT(t,o.name)||(s?s.used.push(o):this.raiseRecoverable(o.start,"Private field '#"+o.name+"' must be declared in an enclosing class"))}};function hSt(e,t){var r=t.key.name,i=e[r],s="true";return t.type==="MethodDefinition"&&(t.kind==="get"||t.kind==="set")&&(s=(t.static?"s":"i")+t.kind),i==="iget"&&s==="iset"||i==="iset"&&s==="iget"||i==="sget"&&s==="sset"||i==="sset"&&s==="sget"?(e[r]="true",!1):i?!0:(e[r]=s,!1)}function eC(e,t){var r=e.computed,i=e.key;return!r&&(i.type==="Identifier"&&i.name===t||i.type==="Literal"&&i.value===t)}zr.parseExportAllDeclaration=function(e,t){return this.options.ecmaVersion>=11&&(this.eatContextual("as")?(e.exported=this.parseModuleExportName(),this.checkExport(t,e.exported,this.lastTokStart)):e.exported=null),this.expectContextual("from"),this.type!==dt.string&&this.unexpected(),e.source=this.parseExprAtom(),this.semicolon(),this.finishNode(e,"ExportAllDeclaration")};zr.parseExport=function(e,t){if(this.next(),this.eat(dt.star))return this.parseExportAllDeclaration(e,t);if(this.eat(dt._default))return this.checkExport(t,"default",this.lastTokStart),e.declaration=this.parseExportDefaultDeclaration(),this.finishNode(e,"ExportDefaultDeclaration");if(this.shouldParseExportStatement())e.declaration=this.parseExportDeclaration(e),e.declaration.type==="VariableDeclaration"?this.checkVariableExport(t,e.declaration.declarations):this.checkExport(t,e.declaration.id,e.declaration.id.start),e.specifiers=[],e.source=null;else{if(e.declaration=null,e.specifiers=this.parseExportSpecifiers(t),this.eatContextual("from"))this.type!==dt.string&&this.unexpected(),e.source=this.parseExprAtom();else{for(var r=0,i=e.specifiers;r<i.length;r+=1){var s=i[r];this.checkUnreserved(s.local),this.checkLocalExport(s.local),s.local.type==="Literal"&&this.raise(s.local.start,"A string literal cannot be used as an exported binding without `from`.")}e.source=null}this.semicolon()}return this.finishNode(e,"ExportNamedDeclaration")};zr.parseExportDeclaration=function(e){return this.parseStatement(null)};zr.parseExportDefaultDeclaration=function(){var e;if(this.type===dt._function||(e=this.isAsyncFunction())){var t=this.startNode();return this.next(),e&&this.next(),this.parseFunction(t,pT|Nst,!1,e)}else if(this.type===dt._class){var r=this.startNode();return this.parseClass(r,"nullableID")}else{var i=this.parseMaybeAssign();return this.semicolon(),i}};zr.checkExport=function(e,t,r){e&&(typeof t!="string"&&(t=t.type==="Identifier"?t.name:t.value),mT(e,t)&&this.raiseRecoverable(r,"Duplicate export '"+t+"'"),e[t]=!0)};zr.checkPatternExport=function(e,t){var r=t.type;if(r==="Identifier")this.checkExport(e,t,t.start);else if(r==="ObjectPattern")for(var i=0,s=t.properties;i<s.length;i+=1){var n=s[i];this.checkPatternExport(e,n)}else if(r==="ArrayPattern")for(var o=0,c=t.elements;o<c.length;o+=1){var f=c[o];f&&this.checkPatternExport(e,f)}else r==="Property"?this.checkPatternExport(e,t.value):r==="AssignmentPattern"?this.checkPatternExport(e,t.left):r==="RestElement"&&this.checkPatternExport(e,t.argument)};zr.checkVariableExport=function(e,t){if(e)for(var r=0,i=t;r<i.length;r+=1){var s=i[r];this.checkPatternExport(e,s.id)}};zr.shouldParseExportStatement=function(){return this.type.keyword==="var"||this.type.keyword==="const"||this.type.keyword==="class"||this.type.keyword==="function"||this.isLet()||this.isAsyncFunction()};zr.parseExportSpecifier=function(e){var t=this.startNode();return t.local=this.parseModuleExportName(),t.exported=this.eatContextual("as")?this.parseModuleExportName():t.local,this.checkExport(e,t.exported,t.exported.start),this.finishNode(t,"ExportSpecifier")};zr.parseExportSpecifiers=function(e){var t=[],r=!0;for(this.expect(dt.braceL);!this.eat(dt.braceR);){if(r)r=!1;else if(this.expect(dt.comma),this.afterTrailingComma(dt.braceR))break;t.push(this.parseExportSpecifier(e))}return t};zr.parseImport=function(e){return this.next(),this.type===dt.string?(e.specifiers=uSt,e.source=this.parseExprAtom()):(e.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),e.source=this.type===dt.string?this.parseExprAtom():this.unexpected()),this.semicolon(),this.finishNode(e,"ImportDeclaration")};zr.parseImportSpecifier=function(){var e=this.startNode();return e.imported=this.parseModuleExportName(),this.eatContextual("as")?e.local=this.parseIdent():(this.checkUnreserved(e.imported),e.local=e.imported),this.checkLValSimple(e.local,R0),this.finishNode(e,"ImportSpecifier")};zr.parseImportDefaultSpecifier=function(){var e=this.startNode();return e.local=this.parseIdent(),this.checkLValSimple(e.local,R0),this.finishNode(e,"ImportDefaultSpecifier")};zr.parseImportNamespaceSpecifier=function(){var e=this.startNode();return this.next(),this.expectContextual("as"),e.local=this.parseIdent(),this.checkLValSimple(e.local,R0),this.finishNode(e,"ImportNamespaceSpecifier")};zr.parseImportSpecifiers=function(){var e=[],t=!0;if(this.type===dt.name&&(e.push(this.parseImportDefaultSpecifier()),!this.eat(dt.comma)))return e;if(this.type===dt.star)return e.push(this.parseImportNamespaceSpecifier()),e;for(this.expect(dt.braceL);!this.eat(dt.braceR);){if(t)t=!1;else if(this.expect(dt.comma),this.afterTrailingComma(dt.braceR))break;e.push(this.parseImportSpecifier())}return e};zr.parseModuleExportName=function(){if(this.options.ecmaVersion>=13&&this.type===dt.string){var e=this.parseLiteral(this.value);return sSt.test(e.value)&&this.raise(e.start,"An export name cannot include a lone surrogate."),e}return this.parseIdent(!0)};zr.adaptDirectivePrologue=function(e){for(var t=0;t<e.length&&this.isDirectiveCandidate(e[t]);++t)e[t].directive=e[t].expression.raw.slice(1,-1)};zr.isDirectiveCandidate=function(e){return this.options.ecmaVersion>=5&&e.type==="ExpressionStatement"&&e.expression.type==="Literal"&&typeof e.expression.value=="string"&&(this.input[e.start]==='"'||this.input[e.start]==="'")};var gh=Ko.prototype;gh.toAssignable=function(e,t,r){if(this.options.ecmaVersion>=6&&e)switch(e.type){case"Identifier":this.inAsync&&e.name==="await"&&this.raise(e.start,"Cannot use 'await' as identifier inside an async function");break;case"ObjectPattern":case"ArrayPattern":case"AssignmentPattern":case"RestElement":break;case"ObjectExpression":e.type="ObjectPattern",r&&this.checkPatternErrors(r,!0);for(var i=0,s=e.properties;i<s.length;i+=1){var n=s[i];this.toAssignable(n,t),n.type==="RestElement"&&(n.argument.type==="ArrayPattern"||n.argument.type==="ObjectPattern")&&this.raise(n.argument.start,"Unexpected token")}break;case"Property":e.kind!=="init"&&this.raise(e.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(e.value,t);break;case"ArrayExpression":e.type="ArrayPattern",r&&this.checkPatternErrors(r,!0),this.toAssignableList(e.elements,t);break;case"SpreadElement":e.type="RestElement",this.toAssignable(e.argument,t),e.argument.type==="AssignmentPattern"&&this.raise(e.argument.start,"Rest elements cannot have a default value");break;case"AssignmentExpression":e.operator!=="="&&this.raise(e.left.end,"Only '=' operator can be used for specifying default value."),e.type="AssignmentPattern",delete e.operator,this.toAssignable(e.left,t);break;case"ParenthesizedExpression":this.toAssignable(e.expression,t,r);break;case"ChainExpression":this.raiseRecoverable(e.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":if(!t)break;default:this.raise(e.start,"Assigning to rvalue")}else r&&this.checkPatternErrors(r,!0);return e};gh.toAssignableList=function(e,t){for(var r=e.length,i=0;i<r;i++){var s=e[i];s&&this.toAssignable(s,t)}if(r){var n=e[r-1];this.options.ecmaVersion===6&&t&&n&&n.type==="RestElement"&&n.argument.type!=="Identifier"&&this.unexpected(n.argument.start)}return e};gh.parseSpread=function(e){var t=this.startNode();return this.next(),t.argument=this.parseMaybeAssign(!1,e),this.finishNode(t,"SpreadElement")};gh.parseRestBinding=function(){var e=this.startNode();return this.next(),this.options.ecmaVersion===6&&this.type!==dt.name&&this.unexpected(),e.argument=this.parseBindingAtom(),this.finishNode(e,"RestElement")};gh.parseBindingAtom=function(){if(this.options.ecmaVersion>=6)switch(this.type){case dt.bracketL:var e=this.startNode();return this.next(),e.elements=this.parseBindingList(dt.bracketR,!0,!0),this.finishNode(e,"ArrayPattern");case dt.braceL:return this.parseObj(!0)}return this.parseIdent()};gh.parseBindingList=function(e,t,r,i){for(var s=[],n=!0;!this.eat(e);)if(n?n=!1:this.expect(dt.comma),t&&this.type===dt.comma)s.push(null);else{if(r&&this.afterTrailingComma(e))break;if(this.type===dt.ellipsis){var o=this.parseRestBinding();this.parseBindingListItem(o),s.push(o),this.type===dt.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.expect(e);break}else s.push(this.parseAssignableListItem(i))}return s};gh.parseAssignableListItem=function(e){var t=this.parseMaybeDefault(this.start,this.startLoc);return this.parseBindingListItem(t),t};gh.parseBindingListItem=function(e){return e};gh.parseMaybeDefault=function(e,t,r){if(r=r||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat(dt.eq))return r;var i=this.startNodeAt(e,t);return i.left=r,i.right=this.parseMaybeAssign(),this.finishNode(i,"AssignmentPattern")};gh.checkLValSimple=function(e,t,r){t===void 0&&(t=tC);var i=t!==tC;switch(e.type){case"Identifier":this.strict&&this.reservedWordsStrictBind.test(e.name)&&this.raiseRecoverable(e.start,(i?"Binding ":"Assigning to ")+e.name+" in strict mode"),i&&(t===R0&&e.name==="let"&&this.raiseRecoverable(e.start,"let is disallowed as a lexically bound name"),r&&(mT(r,e.name)&&this.raiseRecoverable(e.start,"Argument name clash"),r[e.name]=!0),t!==Ost&&this.declareName(e.name,t,e.start));break;case"ChainExpression":this.raiseRecoverable(e.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":i&&this.raiseRecoverable(e.start,"Binding member expression");break;case"ParenthesizedExpression":return i&&this.raiseRecoverable(e.start,"Binding parenthesized expression"),this.checkLValSimple(e.expression,t,r);default:this.raise(e.start,(i?"Binding":"Assigning to")+" rvalue")}};gh.checkLValPattern=function(e,t,r){switch(t===void 0&&(t=tC),e.type){case"ObjectPattern":for(var i=0,s=e.properties;i<s.length;i+=1){var n=s[i];this.checkLValInnerPattern(n,t,r)}break;case"ArrayPattern":for(var o=0,c=e.elements;o<c.length;o+=1){var f=c[o];f&&this.checkLValInnerPattern(f,t,r)}break;default:this.checkLValSimple(e,t,r)}};gh.checkLValInnerPattern=function(e,t,r){switch(t===void 0&&(t=tC),e.type){case"Property":this.checkLValInnerPattern(e.value,t,r);break;case"AssignmentPattern":this.checkLValPattern(e.left,t,r);break;case"RestElement":this.checkLValPattern(e.argument,t,r);break;default:this.checkLValPattern(e,t,r)}};var _f=function(t,r,i,s,n){this.token=t,this.isExpr=!!r,this.preserveSpace=!!i,this.override=s,this.generator=!!n},Hs={b_stat:new _f("{",!1),b_expr:new _f("{",!0),b_tmpl:new _f("${",!1),p_stat:new _f("(",!1),p_expr:new _f("(",!0),q_tmpl:new _f("`",!0,!0,function(e){return e.tryReadTemplateToken()}),f_stat:new _f("function",!1),f_expr:new _f("function",!0),f_expr_gen:new _f("function",!0,!1,null,!0),f_gen:new _f("function",!1,!1,null,!0)},Wx=Ko.prototype;Wx.initialContext=function(){return[Hs.b_stat]};Wx.curContext=function(){return this.context[this.context.length-1]};Wx.braceIsBlock=function(e){var t=this.curContext();return t===Hs.f_expr||t===Hs.f_stat?!0:e===dt.colon&&(t===Hs.b_stat||t===Hs.b_expr)?!t.isExpr:e===dt._return||e===dt.name&&this.exprAllowed?mh.test(this.input.slice(this.lastTokEnd,this.start)):e===dt._else||e===dt.semi||e===dt.eof||e===dt.parenR||e===dt.arrow?!0:e===dt.braceL?t===Hs.b_stat:e===dt._var||e===dt._const||e===dt.name?!1:!this.exprAllowed};Wx.inGeneratorContext=function(){for(var e=this.context.length-1;e>=1;e--){var t=this.context[e];if(t.token==="function")return t.generator}return!1};Wx.updateContext=function(e){var t,r=this.type;r.keyword&&e===dt.dot?this.exprAllowed=!1:(t=r.updateContext)?t.call(this,e):this.exprAllowed=r.beforeExpr};Wx.overrideContext=function(e){this.curContext()!==e&&(this.context[this.context.length-1]=e)};dt.parenR.updateContext=dt.braceR.updateContext=function(){if(this.context.length===1){this.exprAllowed=!0;return}var e=this.context.pop();e===Hs.b_stat&&this.curContext().token==="function"&&(e=this.context.pop()),this.exprAllowed=!e.isExpr};dt.braceL.updateContext=function(e){this.context.push(this.braceIsBlock(e)?Hs.b_stat:Hs.b_expr),this.exprAllowed=!0};dt.dollarBraceL.updateContext=function(){this.context.push(Hs.b_tmpl),this.exprAllowed=!0};dt.parenL.updateContext=function(e){var t=e===dt._if||e===dt._for||e===dt._with||e===dt._while;this.context.push(t?Hs.p_stat:Hs.p_expr),this.exprAllowed=!0};dt.incDec.updateContext=function(){};dt._function.updateContext=dt._class.updateContext=function(e){e.beforeExpr&&e!==dt._else&&!(e===dt.semi&&this.curContext()!==Hs.p_stat)&&!(e===dt._return&&mh.test(this.input.slice(this.lastTokEnd,this.start)))&&!((e===dt.colon||e===dt.braceL)&&this.curContext()===Hs.b_stat)?this.context.push(Hs.f_expr):this.context.push(Hs.f_stat),this.exprAllowed=!1};dt.colon.updateContext=function(){this.curContext().token==="function"&&this.context.pop(),this.exprAllowed=!0};dt.backQuote.updateContext=function(){this.curContext()===Hs.q_tmpl?this.context.pop():this.context.push(Hs.q_tmpl),this.exprAllowed=!1};dt.star.updateContext=function(e){if(e===dt._function){var t=this.context.length-1;this.context[t]===Hs.f_expr?this.context[t]=Hs.f_expr_gen:this.context[t]=Hs.f_gen}this.exprAllowed=!0};dt.name.updateContext=function(e){var t=!1;this.options.ecmaVersion>=6&&e!==dt.dot&&(this.value==="of"&&!this.exprAllowed||this.value==="yield"&&this.inGeneratorContext())&&(t=!0),this.exprAllowed=t};var Ii=Ko.prototype;Ii.checkPropClash=function(e,t,r){if(!(this.options.ecmaVersion>=9&&e.type==="SpreadElement")&&!(this.options.ecmaVersion>=6&&(e.computed||e.method||e.shorthand))){var i=e.key,s;switch(i.type){case"Identifier":s=i.name;break;case"Literal":s=String(i.value);break;default:return}var n=e.kind;if(this.options.ecmaVersion>=6){s==="__proto__"&&n==="init"&&(t.proto&&(r?r.doubleProto<0&&(r.doubleProto=i.start):this.raiseRecoverable(i.start,"Redefinition of __proto__ property")),t.proto=!0);return}s="$"+s;var o=t[s];if(o){var c;n==="init"?c=this.strict&&o.init||o.get||o.set:c=o.init||o[n],c&&this.raiseRecoverable(i.start,"Redefinition of property")}else o=t[s]={init:!1,get:!1,set:!1};o[n]=!0}};Ii.parseExpression=function(e,t){var r=this.start,i=this.startLoc,s=this.parseMaybeAssign(e,t);if(this.type===dt.comma){var n=this.startNodeAt(r,i);for(n.expressions=[s];this.eat(dt.comma);)n.expressions.push(this.parseMaybeAssign(e,t));return this.finishNode(n,"SequenceExpression")}return s};Ii.parseMaybeAssign=function(e,t,r){if(this.isContextual("yield")){if(this.inGenerator)return this.parseYield(e);this.exprAllowed=!1}var i=!1,s=-1,n=-1,o=-1;t?(s=t.parenthesizedAssign,n=t.trailingComma,o=t.doubleProto,t.parenthesizedAssign=t.trailingComma=-1):(t=new sC,i=!0);var c=this.start,f=this.startLoc;(this.type===dt.parenL||this.type===dt.name)&&(this.potentialArrowAt=this.start,this.potentialArrowInForAwait=e==="await");var p=this.parseMaybeConditional(e,t);if(r&&(p=r.call(this,p,c,f)),this.type.isAssign){var x=this.startNodeAt(c,f);return x.operator=this.value,this.type===dt.eq&&(p=this.toAssignable(p,!1,t)),i||(t.parenthesizedAssign=t.trailingComma=t.doubleProto=-1),t.shorthandAssign>=p.start&&(t.shorthandAssign=-1),this.type===dt.eq?this.checkLValPattern(p):this.checkLValSimple(p),x.left=p,this.next(),x.right=this.parseMaybeAssign(e),o>-1&&(t.doubleProto=o),this.finishNode(x,"AssignmentExpression")}else i&&this.checkExpressionErrors(t,!0);return s>-1&&(t.parenthesizedAssign=s),n>-1&&(t.trailingComma=n),p};Ii.parseMaybeConditional=function(e,t){var r=this.start,i=this.startLoc,s=this.parseExprOps(e,t);if(this.checkExpressionErrors(t))return s;if(this.eat(dt.question)){var n=this.startNodeAt(r,i);return n.test=s,n.consequent=this.parseMaybeAssign(),this.expect(dt.colon),n.alternate=this.parseMaybeAssign(e),this.finishNode(n,"ConditionalExpression")}return s};Ii.parseExprOps=function(e,t){var r=this.start,i=this.startLoc,s=this.parseMaybeUnary(t,!1,!1,e);return this.checkExpressionErrors(t)||s.start===r&&s.type==="ArrowFunctionExpression"?s:this.parseExprOp(s,r,i,-1,e)};Ii.parseExprOp=function(e,t,r,i,s){var n=this.type.binop;if(n!=null&&(!s||this.type!==dt._in)&&n>i){var o=this.type===dt.logicalOR||this.type===dt.logicalAND,c=this.type===dt.coalesce;c&&(n=dt.logicalAND.binop);var f=this.value;this.next();var p=this.start,x=this.startLoc,E=this.parseExprOp(this.parseMaybeUnary(null,!1,!1,s),p,x,n,s),T=this.buildBinary(t,r,e,E,f,o||c);return(o&&this.type===dt.coalesce||c&&(this.type===dt.logicalOR||this.type===dt.logicalAND))&&this.raiseRecoverable(this.start,"Logical expressions and coalesce expressions cannot be mixed. Wrap either by parentheses"),this.parseExprOp(T,t,r,i,s)}return e};Ii.buildBinary=function(e,t,r,i,s,n){i.type==="PrivateIdentifier"&&this.raise(i.start,"Private identifier can only be left side of binary expression");var o=this.startNodeAt(e,t);return o.left=r,o.operator=s,o.right=i,this.finishNode(o,n?"LogicalExpression":"BinaryExpression")};Ii.parseMaybeUnary=function(e,t,r,i){var s=this.start,n=this.startLoc,o;if(this.isContextual("await")&&this.canAwait)o=this.parseAwait(i),t=!0;else if(this.type.prefix){var c=this.startNode(),f=this.type===dt.incDec;c.operator=this.value,c.prefix=!0,this.next(),c.argument=this.parseMaybeUnary(null,!0,f,i),this.checkExpressionErrors(e,!0),f?this.checkLValSimple(c.argument):this.strict&&c.operator==="delete"&&Fst(c.argument)?this.raiseRecoverable(c.start,"Deleting local variable in strict mode"):c.operator==="delete"&&AF(c.argument)?this.raiseRecoverable(c.start,"Private fields can not be deleted"):t=!0,o=this.finishNode(c,f?"UpdateExpression":"UnaryExpression")}else if(!t&&this.type===dt.privateId)(i||this.privateNameStack.length===0)&&this.options.checkPrivateFields&&this.unexpected(),o=this.parsePrivateIdent(),this.type!==dt._in&&this.unexpected();else{if(o=this.parseExprSubscripts(e,i),this.checkExpressionErrors(e))return o;for(;this.type.postfix&&!this.canInsertSemicolon();){var p=this.startNodeAt(s,n);p.operator=this.value,p.prefix=!1,p.argument=o,this.checkLValSimple(o),this.next(),o=this.finishNode(p,"UpdateExpression")}}if(!r&&this.eat(dt.starstar))if(t)this.unexpected(this.lastTokStart);else return this.buildBinary(s,n,o,this.parseMaybeUnary(null,!1,!1,i),"**",!1);else return o};function Fst(e){return e.type==="Identifier"||e.type==="ParenthesizedExpression"&&Fst(e.expression)}function AF(e){return e.type==="MemberExpression"&&e.property.type==="PrivateIdentifier"||e.type==="ChainExpression"&&AF(e.expression)||e.type==="ParenthesizedExpression"&&AF(e.expression)}Ii.parseExprSubscripts=function(e,t){var r=this.start,i=this.startLoc,s=this.parseExprAtom(e,t);if(s.type==="ArrowFunctionExpression"&&this.input.slice(this.lastTokStart,this.lastTokEnd)!==")")return s;var n=this.parseSubscripts(s,r,i,!1,t);return e&&n.type==="MemberExpression"&&(e.parenthesizedAssign>=n.start&&(e.parenthesizedAssign=-1),e.parenthesizedBind>=n.start&&(e.parenthesizedBind=-1),e.trailingComma>=n.start&&(e.trailingComma=-1)),n};Ii.parseSubscripts=function(e,t,r,i,s){for(var n=this.options.ecmaVersion>=8&&e.type==="Identifier"&&e.name==="async"&&this.lastTokEnd===e.end&&!this.canInsertSemicolon()&&e.end-e.start===5&&this.potentialArrowAt===e.start,o=!1;;){var c=this.parseSubscript(e,t,r,i,n,o,s);if(c.optional&&(o=!0),c===e||c.type==="ArrowFunctionExpression"){if(o){var f=this.startNodeAt(t,r);f.expression=c,c=this.finishNode(f,"ChainExpression")}return c}e=c}};Ii.shouldParseAsyncArrow=function(){return!this.canInsertSemicolon()&&this.eat(dt.arrow)};Ii.parseSubscriptAsyncArrow=function(e,t,r,i){return this.parseArrowExpression(this.startNodeAt(e,t),r,!0,i)};Ii.parseSubscript=function(e,t,r,i,s,n,o){var c=this.options.ecmaVersion>=11,f=c&&this.eat(dt.questionDot);i&&f&&this.raise(this.lastTokStart,"Optional chaining cannot appear in the callee of new expressions");var p=this.eat(dt.bracketL);if(p||f&&this.type!==dt.parenL&&this.type!==dt.backQuote||this.eat(dt.dot)){var x=this.startNodeAt(t,r);x.object=e,p?(x.property=this.parseExpression(),this.expect(dt.bracketR)):this.type===dt.privateId&&e.type!=="Super"?x.property=this.parsePrivateIdent():x.property=this.parseIdent(this.options.allowReserved!=="never"),x.computed=!!p,c&&(x.optional=f),e=this.finishNode(x,"MemberExpression")}else if(!i&&this.eat(dt.parenL)){var E=new sC,T=this.yieldPos,D=this.awaitPos,N=this.awaitIdentPos;this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0;var z=this.parseExprList(dt.parenR,this.options.ecmaVersion>=8,!1,E);if(s&&!f&&this.shouldParseAsyncArrow())return this.checkPatternErrors(E,!1),this.checkYieldAwaitInDefaultParams(),this.awaitIdentPos>0&&this.raise(this.awaitIdentPos,"Cannot use 'await' as identifier inside an async function"),this.yieldPos=T,this.awaitPos=D,this.awaitIdentPos=N,this.parseSubscriptAsyncArrow(t,r,z,o);this.checkExpressionErrors(E,!0),this.yieldPos=T||this.yieldPos,this.awaitPos=D||this.awaitPos,this.awaitIdentPos=N||this.awaitIdentPos;var U=this.startNodeAt(t,r);U.callee=e,U.arguments=z,c&&(U.optional=f),e=this.finishNode(U,"CallExpression")}else if(this.type===dt.backQuote){(f||n)&&this.raise(this.start,"Optional chaining cannot appear in the tag of tagged template expressions");var H=this.startNodeAt(t,r);H.tag=e,H.quasi=this.parseTemplate({isTagged:!0}),e=this.finishNode(H,"TaggedTemplateExpression")}return e};Ii.parseExprAtom=function(e,t,r){this.type===dt.slash&&this.readRegexp();var i,s=this.potentialArrowAt===this.start;switch(this.type){case dt._super:return this.allowSuper||this.raise(this.start,"'super' keyword outside a method"),i=this.startNode(),this.next(),this.type===dt.parenL&&!this.allowDirectSuper&&this.raise(i.start,"super() call outside constructor of a subclass"),this.type!==dt.dot&&this.type!==dt.bracketL&&this.type!==dt.parenL&&this.unexpected(),this.finishNode(i,"Super");case dt._this:return i=this.startNode(),this.next(),this.finishNode(i,"ThisExpression");case dt.name:var n=this.start,o=this.startLoc,c=this.containsEsc,f=this.parseIdent(!1);if(this.options.ecmaVersion>=8&&!c&&f.name==="async"&&!this.canInsertSemicolon()&&this.eat(dt._function))return this.overrideContext(Hs.f_expr),this.parseFunction(this.startNodeAt(n,o),0,!1,!0,t);if(s&&!this.canInsertSemicolon()){if(this.eat(dt.arrow))return this.parseArrowExpression(this.startNodeAt(n,o),[f],!1,t);if(this.options.ecmaVersion>=8&&f.name==="async"&&this.type===dt.name&&!c&&(!this.potentialArrowInForAwait||this.value!=="of"||this.containsEsc))return f=this.parseIdent(!1),(this.canInsertSemicolon()||!this.eat(dt.arrow))&&this.unexpected(),this.parseArrowExpression(this.startNodeAt(n,o),[f],!0,t)}return f;case dt.regexp:var p=this.value;return i=this.parseLiteral(p.value),i.regex={pattern:p.pattern,flags:p.flags},i;case dt.num:case dt.string:return this.parseLiteral(this.value);case dt._null:case dt._true:case dt._false:return i=this.startNode(),i.value=this.type===dt._null?null:this.type===dt._true,i.raw=this.type.keyword,this.next(),this.finishNode(i,"Literal");case dt.parenL:var x=this.start,E=this.parseParenAndDistinguishExpression(s,t);return e&&(e.parenthesizedAssign<0&&!this.isSimpleAssignTarget(E)&&(e.parenthesizedAssign=x),e.parenthesizedBind<0&&(e.parenthesizedBind=x)),E;case dt.bracketL:return i=this.startNode(),this.next(),i.elements=this.parseExprList(dt.bracketR,!0,!0,e),this.finishNode(i,"ArrayExpression");case dt.braceL:return this.overrideContext(Hs.b_expr),this.parseObj(!1,e);case dt._function:return i=this.startNode(),this.next(),this.parseFunction(i,0);case dt._class:return this.parseClass(this.startNode(),!1);case dt._new:return this.parseNew();case dt.backQuote:return this.parseTemplate();case dt._import:return this.options.ecmaVersion>=11?this.parseExprImport(r):this.unexpected();default:return this.parseExprAtomDefault()}};Ii.parseExprAtomDefault=function(){this.unexpected()};Ii.parseExprImport=function(e){var t=this.startNode();if(this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword import"),this.next(),this.type===dt.parenL&&!e)return this.parseDynamicImport(t);if(this.type===dt.dot){var r=this.startNodeAt(t.start,t.loc&&t.loc.start);return r.name="import",t.meta=this.finishNode(r,"Identifier"),this.parseImportMeta(t)}else this.unexpected()};Ii.parseDynamicImport=function(e){if(this.next(),e.source=this.parseMaybeAssign(),!this.eat(dt.parenR)){var t=this.start;this.eat(dt.comma)&&this.eat(dt.parenR)?this.raiseRecoverable(t,"Trailing comma is not allowed in import()"):this.unexpected(t)}return this.finishNode(e,"ImportExpression")};Ii.parseImportMeta=function(e){this.next();var t=this.containsEsc;return e.property=this.parseIdent(!0),e.property.name!=="meta"&&this.raiseRecoverable(e.property.start,"The only valid meta property for import is 'import.meta'"),t&&this.raiseRecoverable(e.start,"'import.meta' must not contain escaped characters"),this.options.sourceType!=="module"&&!this.options.allowImportExportEverywhere&&this.raiseRecoverable(e.start,"Cannot use 'import.meta' outside a module"),this.finishNode(e,"MetaProperty")};Ii.parseLiteral=function(e){var t=this.startNode();return t.value=e,t.raw=this.input.slice(this.start,this.end),t.raw.charCodeAt(t.raw.length-1)===110&&(t.bigint=t.raw.slice(0,-1).replace(/_/g,"")),this.next(),this.finishNode(t,"Literal")};Ii.parseParenExpression=function(){this.expect(dt.parenL);var e=this.parseExpression();return this.expect(dt.parenR),e};Ii.shouldParseArrow=function(e){return!this.canInsertSemicolon()};Ii.parseParenAndDistinguishExpression=function(e,t){var r=this.start,i=this.startLoc,s,n=this.options.ecmaVersion>=8;if(this.options.ecmaVersion>=6){this.next();var o=this.start,c=this.startLoc,f=[],p=!0,x=!1,E=new sC,T=this.yieldPos,D=this.awaitPos,N;for(this.yieldPos=0,this.awaitPos=0;this.type!==dt.parenR;)if(p?p=!1:this.expect(dt.comma),n&&this.afterTrailingComma(dt.parenR,!0)){x=!0;break}else if(this.type===dt.ellipsis){N=this.start,f.push(this.parseParenItem(this.parseRestBinding())),this.type===dt.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element");break}else f.push(this.parseMaybeAssign(!1,E,this.parseParenItem));var z=this.lastTokEnd,U=this.lastTokEndLoc;if(this.expect(dt.parenR),e&&this.shouldParseArrow(f)&&this.eat(dt.arrow))return this.checkPatternErrors(E,!1),this.checkYieldAwaitInDefaultParams(),this.yieldPos=T,this.awaitPos=D,this.parseParenArrowList(r,i,f,t);(!f.length||x)&&this.unexpected(this.lastTokStart),N&&this.unexpected(N),this.checkExpressionErrors(E,!0),this.yieldPos=T||this.yieldPos,this.awaitPos=D||this.awaitPos,f.length>1?(s=this.startNodeAt(o,c),s.expressions=f,this.finishNodeAt(s,"SequenceExpression",z,U)):s=f[0]}else s=this.parseParenExpression();if(this.options.preserveParens){var H=this.startNodeAt(r,i);return H.expression=s,this.finishNode(H,"ParenthesizedExpression")}else return s};Ii.parseParenItem=function(e){return e};Ii.parseParenArrowList=function(e,t,r,i){return this.parseArrowExpression(this.startNodeAt(e,t),r,!1,i)};var fSt=[];Ii.parseNew=function(){this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword new");var e=this.startNode();if(this.next(),this.options.ecmaVersion>=6&&this.type===dt.dot){var t=this.startNodeAt(e.start,e.loc&&e.loc.start);t.name="new",e.meta=this.finishNode(t,"Identifier"),this.next();var r=this.containsEsc;return e.property=this.parseIdent(!0),e.property.name!=="target"&&this.raiseRecoverable(e.property.start,"The only valid meta property for new is 'new.target'"),r&&this.raiseRecoverable(e.start,"'new.target' must not contain escaped characters"),this.allowNewDotTarget||this.raiseRecoverable(e.start,"'new.target' can only be used in functions and class static block"),this.finishNode(e,"MetaProperty")}var i=this.start,s=this.startLoc;return e.callee=this.parseSubscripts(this.parseExprAtom(null,!1,!0),i,s,!0,!1),this.eat(dt.parenL)?e.arguments=this.parseExprList(dt.parenR,this.options.ecmaVersion>=8,!1):e.arguments=fSt,this.finishNode(e,"NewExpression")};Ii.parseTemplateElement=function(e){var t=e.isTagged,r=this.startNode();return this.type===dt.invalidTemplate?(t||this.raiseRecoverable(this.start,"Bad escape sequence in untagged template literal"),r.value={raw:this.value.replace(/\r\n?/g,`
`),cooked:null}):r.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,`
`),cooked:this.value},this.next(),r.tail=this.type===dt.backQuote,this.finishNode(r,"TemplateElement")};Ii.parseTemplate=function(e){e===void 0&&(e={});var t=e.isTagged;t===void 0&&(t=!1);var r=this.startNode();this.next(),r.expressions=[];var i=this.parseTemplateElement({isTagged:t});for(r.quasis=[i];!i.tail;)this.type===dt.eof&&this.raise(this.pos,"Unterminated template literal"),this.expect(dt.dollarBraceL),r.expressions.push(this.parseExpression()),this.expect(dt.braceR),r.quasis.push(i=this.parseTemplateElement({isTagged:t}));return this.next(),this.finishNode(r,"TemplateLiteral")};Ii.isAsyncProp=function(e){return!e.computed&&e.key.type==="Identifier"&&e.key.name==="async"&&(this.type===dt.name||this.type===dt.num||this.type===dt.string||this.type===dt.bracketL||this.type.keyword||this.options.ecmaVersion>=9&&this.type===dt.star)&&!mh.test(this.input.slice(this.lastTokEnd,this.start))};Ii.parseObj=function(e,t){var r=this.startNode(),i=!0,s={};for(r.properties=[],this.next();!this.eat(dt.braceR);){if(i)i=!1;else if(this.expect(dt.comma),this.options.ecmaVersion>=5&&this.afterTrailingComma(dt.braceR))break;var n=this.parseProperty(e,t);e||this.checkPropClash(n,s,t),r.properties.push(n)}return this.finishNode(r,e?"ObjectPattern":"ObjectExpression")};Ii.parseProperty=function(e,t){var r=this.startNode(),i,s,n,o;if(this.options.ecmaVersion>=9&&this.eat(dt.ellipsis))return e?(r.argument=this.parseIdent(!1),this.type===dt.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.finishNode(r,"RestElement")):(r.argument=this.parseMaybeAssign(!1,t),this.type===dt.comma&&t&&t.trailingComma<0&&(t.trailingComma=this.start),this.finishNode(r,"SpreadElement"));this.options.ecmaVersion>=6&&(r.method=!1,r.shorthand=!1,(e||t)&&(n=this.start,o=this.startLoc),e||(i=this.eat(dt.star)));var c=this.containsEsc;return this.parsePropertyName(r),!e&&!c&&this.options.ecmaVersion>=8&&!i&&this.isAsyncProp(r)?(s=!0,i=this.options.ecmaVersion>=9&&this.eat(dt.star),this.parsePropertyName(r)):s=!1,this.parsePropertyValue(r,e,i,s,n,o,t,c),this.finishNode(r,"Property")};Ii.parseGetterSetter=function(e){e.kind=e.key.name,this.parsePropertyName(e),e.value=this.parseMethod(!1);var t=e.kind==="get"?0:1;if(e.value.params.length!==t){var r=e.value.start;e.kind==="get"?this.raiseRecoverable(r,"getter should have no params"):this.raiseRecoverable(r,"setter should have exactly one param")}else e.kind==="set"&&e.value.params[0].type==="RestElement"&&this.raiseRecoverable(e.value.params[0].start,"Setter cannot use rest params")};Ii.parsePropertyValue=function(e,t,r,i,s,n,o,c){(r||i)&&this.type===dt.colon&&this.unexpected(),this.eat(dt.colon)?(e.value=t?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,o),e.kind="init"):this.options.ecmaVersion>=6&&this.type===dt.parenL?(t&&this.unexpected(),e.kind="init",e.method=!0,e.value=this.parseMethod(r,i)):!t&&!c&&this.options.ecmaVersion>=5&&!e.computed&&e.key.type==="Identifier"&&(e.key.name==="get"||e.key.name==="set")&&this.type!==dt.comma&&this.type!==dt.braceR&&this.type!==dt.eq?((r||i)&&this.unexpected(),this.parseGetterSetter(e)):this.options.ecmaVersion>=6&&!e.computed&&e.key.type==="Identifier"?((r||i)&&this.unexpected(),this.checkUnreserved(e.key),e.key.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=s),e.kind="init",t?e.value=this.parseMaybeDefault(s,n,this.copyNode(e.key)):this.type===dt.eq&&o?(o.shorthandAssign<0&&(o.shorthandAssign=this.start),e.value=this.parseMaybeDefault(s,n,this.copyNode(e.key))):e.value=this.copyNode(e.key),e.shorthand=!0):this.unexpected()};Ii.parsePropertyName=function(e){if(this.options.ecmaVersion>=6){if(this.eat(dt.bracketL))return e.computed=!0,e.key=this.parseMaybeAssign(),this.expect(dt.bracketR),e.key;e.computed=!1}return e.key=this.type===dt.num||this.type===dt.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never")};Ii.initFunction=function(e){e.id=null,this.options.ecmaVersion>=6&&(e.generator=e.expression=!1),this.options.ecmaVersion>=8&&(e.async=!1)};Ii.parseMethod=function(e,t,r){var i=this.startNode(),s=this.yieldPos,n=this.awaitPos,o=this.awaitIdentPos;return this.initFunction(i),this.options.ecmaVersion>=6&&(i.generator=e),this.options.ecmaVersion>=8&&(i.async=!!t),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(xF(t,i.generator)|_F|(r?kst:0)),this.expect(dt.parenL),i.params=this.parseBindingList(dt.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams(),this.parseFunctionBody(i,!1,!0,!1),this.yieldPos=s,this.awaitPos=n,this.awaitIdentPos=o,this.finishNode(i,"FunctionExpression")};Ii.parseArrowExpression=function(e,t,r,i){var s=this.yieldPos,n=this.awaitPos,o=this.awaitIdentPos;return this.enterScope(xF(r,!1)|Pst),this.initFunction(e),this.options.ecmaVersion>=8&&(e.async=!!r),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,e.params=this.toAssignableList(t,!0),this.parseFunctionBody(e,!0,!1,i),this.yieldPos=s,this.awaitPos=n,this.awaitIdentPos=o,this.finishNode(e,"ArrowFunctionExpression")};Ii.parseFunctionBody=function(e,t,r,i){var s=t&&this.type!==dt.braceL,n=this.strict,o=!1;if(s)e.body=this.parseMaybeAssign(i),e.expression=!0,this.checkParams(e,!1);else{var c=this.options.ecmaVersion>=7&&!this.isSimpleParamList(e.params);(!n||c)&&(o=this.strictDirective(this.end),o&&c&&this.raiseRecoverable(e.start,"Illegal 'use strict' directive in function with non-simple parameter list"));var f=this.labels;this.labels=[],o&&(this.strict=!0),this.checkParams(e,!n&&!o&&!t&&!r&&this.isSimpleParamList(e.params)),this.strict&&e.id&&this.checkLValSimple(e.id,Ost),e.body=this.parseBlock(!1,void 0,o&&!n),e.expression=!1,this.adaptDirectivePrologue(e.body.body),this.labels=f}this.exitScope()};Ii.isSimpleParamList=function(e){for(var t=0,r=e;t<r.length;t+=1){var i=r[t];if(i.type!=="Identifier")return!1}return!0};Ii.checkParams=function(e,t){for(var r=Object.create(null),i=0,s=e.params;i<s.length;i+=1){var n=s[i];this.checkLValInnerPattern(n,bF,t?null:r)}};Ii.parseExprList=function(e,t,r,i){for(var s=[],n=!0;!this.eat(e);){if(n)n=!1;else if(this.expect(dt.comma),t&&this.afterTrailingComma(e))break;var o=void 0;r&&this.type===dt.comma?o=null:this.type===dt.ellipsis?(o=this.parseSpread(i),i&&this.type===dt.comma&&i.trailingComma<0&&(i.trailingComma=this.start)):o=this.parseMaybeAssign(!1,i),s.push(o)}return s};Ii.checkUnreserved=function(e){var t=e.start,r=e.end,i=e.name;if(this.inGenerator&&i==="yield"&&this.raiseRecoverable(t,"Cannot use 'yield' as identifier inside a generator"),this.inAsync&&i==="await"&&this.raiseRecoverable(t,"Cannot use 'await' as identifier inside an async function"),this.currentThisScope().inClassFieldInit&&i==="arguments"&&this.raiseRecoverable(t,"Cannot use 'arguments' in class field initializer"),this.inClassStaticBlock&&(i==="arguments"||i==="await")&&this.raise(t,"Cannot use "+i+" in class static initialization block"),this.keywords.test(i)&&this.raise(t,"Unexpected keyword '"+i+"'"),!(this.options.ecmaVersion<6&&this.input.slice(t,r).indexOf("\\")!==-1)){var s=this.strict?this.reservedWordsStrict:this.reservedWords;s.test(i)&&(!this.inAsync&&i==="await"&&this.raiseRecoverable(t,"Cannot use keyword 'await' outside an async function"),this.raiseRecoverable(t,"The keyword '"+i+"' is reserved"))}};Ii.parseIdent=function(e){var t=this.parseIdentNode();return this.next(!!e),this.finishNode(t,"Identifier"),e||(this.checkUnreserved(t),t.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=t.start)),t};Ii.parseIdentNode=function(){var e=this.startNode();return this.type===dt.name?e.name=this.value:this.type.keyword?(e.name=this.type.keyword,(e.name==="class"||e.name==="function")&&(this.lastTokEnd!==this.lastTokStart+1||this.input.charCodeAt(this.lastTokStart)!==46)&&this.context.pop(),this.type=dt.name):this.unexpected(),e};Ii.parsePrivateIdent=function(){var e=this.startNode();return this.type===dt.privateId?e.name=this.value:this.unexpected(),this.next(),this.finishNode(e,"PrivateIdentifier"),this.options.checkPrivateFields&&(this.privateNameStack.length===0?this.raise(e.start,"Private field '#"+e.name+"' must be declared in an enclosing class"):this.privateNameStack[this.privateNameStack.length-1].used.push(e)),e};Ii.parseYield=function(e){this.yieldPos||(this.yieldPos=this.start);var t=this.startNode();return this.next(),this.type===dt.semi||this.canInsertSemicolon()||this.type!==dt.star&&!this.type.startsExpr?(t.delegate=!1,t.argument=null):(t.delegate=this.eat(dt.star),t.argument=this.parseMaybeAssign(e)),this.finishNode(t,"YieldExpression")};Ii.parseAwait=function(e){this.awaitPos||(this.awaitPos=this.start);var t=this.startNode();return this.next(),t.argument=this.parseMaybeUnary(null,!0,!1,e),this.finishNode(t,"AwaitExpression")};var rC=Ko.prototype;rC.raise=function(e,t){var r=Mst(this.input,e);t+=" ("+r.line+":"+r.column+")";var i=new SyntaxError(t);throw i.pos=e,i.loc=r,i.raisedAt=this.pos,i};rC.raiseRecoverable=rC.raise;rC.curPosition=function(){if(this.options.locations)return new dT(this.curLine,this.pos-this.lineStart)};var wm=Ko.prototype,pSt=function(t){this.flags=t,this.var=[],this.lexical=[],this.functions=[],this.inClassFieldInit=!1};wm.enterScope=function(e){this.scopeStack.push(new pSt(e))};wm.exitScope=function(){this.scopeStack.pop()};wm.treatFunctionsAsVarInScope=function(e){return e.flags&Hx||!this.inModule&&e.flags&AT};wm.declareName=function(e,t,r){var i=!1;if(t===R0){var s=this.currentScope();i=s.lexical.indexOf(e)>-1||s.functions.indexOf(e)>-1||s.var.indexOf(e)>-1,s.lexical.push(e),this.inModule&&s.flags&AT&&delete this.undefinedExports[e]}else if(t===Bst){var n=this.currentScope();n.lexical.push(e)}else if(t===Dst){var o=this.currentScope();this.treatFunctionsAsVar?i=o.lexical.indexOf(e)>-1:i=o.lexical.indexOf(e)>-1||o.var.indexOf(e)>-1,o.functions.push(e)}else for(var c=this.scopeStack.length-1;c>=0;--c){var f=this.scopeStack[c];if(f.lexical.indexOf(e)>-1&&!(f.flags&Rst&&f.lexical[0]===e)||!this.treatFunctionsAsVarInScope(f)&&f.functions.indexOf(e)>-1){i=!0;break}if(f.var.push(e),this.inModule&&f.flags&AT&&delete this.undefinedExports[e],f.flags&yF)break}i&&this.raiseRecoverable(r,"Identifier '"+e+"' has already been declared")};wm.checkLocalExport=function(e){this.scopeStack[0].lexical.indexOf(e.name)===-1&&this.scopeStack[0].var.indexOf(e.name)===-1&&(this.undefinedExports[e.name]=e)};wm.currentScope=function(){return this.scopeStack[this.scopeStack.length-1]};wm.currentVarScope=function(){for(var e=this.scopeStack.length-1;;e--){var t=this.scopeStack[e];if(t.flags&yF)return t}};wm.currentThisScope=function(){for(var e=this.scopeStack.length-1;;e--){var t=this.scopeStack[e];if(t.flags&yF&&!(t.flags&Pst))return t}};var oC=function(t,r,i){this.type="",this.start=r,this.end=0,t.options.locations&&(this.loc=new nC(t,i)),t.options.directSourceFile&&(this.sourceFile=t.options.directSourceFile),t.options.ranges&&(this.range=[r,0])},_T=Ko.prototype;_T.startNode=function(){return new oC(this,this.start,this.startLoc)};_T.startNodeAt=function(e,t){return new oC(this,e,t)};function Lst(e,t,r,i){return e.type=t,e.end=r,this.options.locations&&(e.loc.end=i),this.options.ranges&&(e.range[1]=r),e}_T.finishNode=function(e,t){return Lst.call(this,e,t,this.lastTokEnd,this.lastTokEndLoc)};_T.finishNodeAt=function(e,t,r,i){return Lst.call(this,e,t,r,i)};_T.copyNode=function(e){var t=new oC(this,e.start,this.startLoc);for(var r in e)t[r]=e[r];return t};var zst="ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS",Ust=zst+" Extended_Pictographic",Vst=Ust,jst=Vst+" EBase EComp EMod EPres ExtPict",$st=jst,dSt=$st,ASt={9:zst,10:Ust,11:Vst,12:jst,13:$st,14:dSt},mSt="Basic_Emoji Emoji_Keycap_Sequence RGI_Emoji_Modifier_Sequence RGI_Emoji_Flag_Sequence RGI_Emoji_Tag_Sequence RGI_Emoji_ZWJ_Sequence RGI_Emoji",gSt={9:"",10:"",11:"",12:"",13:"",14:mSt},bst="Cased_Letter LC Close_Punctuation Pe Connector_Punctuation Pc Control Cc cntrl Currency_Symbol Sc Dash_Punctuation Pd Decimal_Number Nd digit Enclosing_Mark Me Final_Punctuation Pf Format Cf Initial_Punctuation Pi Letter L Letter_Number Nl Line_Separator Zl Lowercase_Letter Ll Mark M Combining_Mark Math_Symbol Sm Modifier_Letter Lm Modifier_Symbol Sk Nonspacing_Mark Mn Number N Open_Punctuation Ps Other C Other_Letter Lo Other_Number No Other_Punctuation Po Other_Symbol So Paragraph_Separator Zp Private_Use Co Punctuation P punct Separator Z Space_Separator Zs Spacing_Mark Mc Surrogate Cs Symbol S Titlecase_Letter Lt Unassigned Cn Uppercase_Letter Lu",Hst="Adlam Adlm Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb",Wst=Hst+" Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd",qst=Wst+" Elymaic Elym Nandinagari Nand Nyiakeng_Puachue_Hmong Hmnp Wancho Wcho",Yst=qst+" Chorasmian Chrs Diak Dives_Akuru Khitan_Small_Script Kits Yezi Yezidi",Xst=Yst+" Cypro_Minoan Cpmn Old_Uyghur Ougr Tangsa Tnsa Toto Vithkuqi Vith",_St=Xst+" Hrkt Katakana_Or_Hiragana Kawi Nag_Mundari Nagm Unknown Zzzz",ySt={9:Hst,10:Wst,11:qst,12:Yst,13:Xst,14:_St},Zst={};function xSt(e){var t=Zst[e]={binary:bm(ASt[e]+" "+bst),binaryOfStrings:bm(gSt[e]),nonBinary:{General_Category:bm(bst),Script:bm(ySt[e])}};t.nonBinary.Script_Extensions=t.nonBinary.Script,t.nonBinary.gc=t.nonBinary.General_Category,t.nonBinary.sc=t.nonBinary.Script,t.nonBinary.scx=t.nonBinary.Script_Extensions}for(J8=0,hF=[9,10,11,12,13,14];J8<hF.length;J8+=1)vst=hF[J8],xSt(vst);var vst,J8,hF,Cr=Ko.prototype,iC=function(t,r){this.parent=t,this.base=r||this};iC.prototype.separatedFrom=function(t){for(var r=this;r;r=r.parent)for(var i=t;i;i=i.parent)if(r.base===i.base&&r!==i)return!0;return!1};iC.prototype.sibling=function(){return new iC(this.parent,this.base)};var Hp=function(t){this.parser=t,this.validFlags="gim"+(t.options.ecmaVersion>=6?"uy":"")+(t.options.ecmaVersion>=9?"s":"")+(t.options.ecmaVersion>=13?"d":"")+(t.options.ecmaVersion>=15?"v":""),this.unicodeProperties=Zst[t.options.ecmaVersion>=14?14:t.options.ecmaVersion],this.source="",this.flags="",this.start=0,this.switchU=!1,this.switchV=!1,this.switchN=!1,this.pos=0,this.lastIntValue=0,this.lastStringValue="",this.lastAssertionIsQuantifiable=!1,this.numCapturingParens=0,this.maxBackReference=0,this.groupNames=Object.create(null),this.backReferenceNames=[],this.branchID=null};Hp.prototype.reset=function(t,r,i){var s=i.indexOf("v")!==-1,n=i.indexOf("u")!==-1;this.start=t|0,this.source=r+"",this.flags=i,s&&this.parser.options.ecmaVersion>=15?(this.switchU=!0,this.switchV=!0,this.switchN=!0):(this.switchU=n&&this.parser.options.ecmaVersion>=6,this.switchV=!1,this.switchN=n&&this.parser.options.ecmaVersion>=9)};Hp.prototype.raise=function(t){this.parser.raiseRecoverable(this.start,"Invalid regular expression: /"+this.source+"/: "+t)};Hp.prototype.at=function(t,r){r===void 0&&(r=!1);var i=this.source,s=i.length;if(t>=s)return-1;var n=i.charCodeAt(t);if(!(r||this.switchU)||n<=55295||n>=57344||t+1>=s)return n;var o=i.charCodeAt(t+1);return o>=56320&&o<=57343?(n<<10)+o-56613888:n};Hp.prototype.nextIndex=function(t,r){r===void 0&&(r=!1);var i=this.source,s=i.length;if(t>=s)return s;var n=i.charCodeAt(t),o;return!(r||this.switchU)||n<=55295||n>=57344||t+1>=s||(o=i.charCodeAt(t+1))<56320||o>57343?t+1:t+2};Hp.prototype.current=function(t){return t===void 0&&(t=!1),this.at(this.pos,t)};Hp.prototype.lookahead=function(t){return t===void 0&&(t=!1),this.at(this.nextIndex(this.pos,t),t)};Hp.prototype.advance=function(t){t===void 0&&(t=!1),this.pos=this.nextIndex(this.pos,t)};Hp.prototype.eat=function(t,r){return r===void 0&&(r=!1),this.current(r)===t?(this.advance(r),!0):!1};Hp.prototype.eatChars=function(t,r){r===void 0&&(r=!1);for(var i=this.pos,s=0,n=t;s<n.length;s+=1){var o=n[s],c=this.at(i,r);if(c===-1||c!==o)return!1;i=this.nextIndex(i,r)}return this.pos=i,!0};Cr.validateRegExpFlags=function(e){for(var t=e.validFlags,r=e.flags,i=!1,s=!1,n=0;n<r.length;n++){var o=r.charAt(n);t.indexOf(o)===-1&&this.raise(e.start,"Invalid regular expression flag"),r.indexOf(o,n+1)>-1&&this.raise(e.start,"Duplicate regular expression flag"),o==="u"&&(i=!0),o==="v"&&(s=!0)}this.options.ecmaVersion>=15&&i&&s&&this.raise(e.start,"Invalid regular expression flag")};function bSt(e){for(var t in e)return!0;return!1}Cr.validateRegExpPattern=function(e){this.regexp_pattern(e),!e.switchN&&this.options.ecmaVersion>=9&&bSt(e.groupNames)&&(e.switchN=!0,this.regexp_pattern(e))};Cr.regexp_pattern=function(e){e.pos=0,e.lastIntValue=0,e.lastStringValue="",e.lastAssertionIsQuantifiable=!1,e.numCapturingParens=0,e.maxBackReference=0,e.groupNames=Object.create(null),e.backReferenceNames.length=0,e.branchID=null,this.regexp_disjunction(e),e.pos!==e.source.length&&(e.eat(41)&&e.raise("Unmatched ')'"),(e.eat(93)||e.eat(125))&&e.raise("Lone quantifier brackets")),e.maxBackReference>e.numCapturingParens&&e.raise("Invalid escape");for(var t=0,r=e.backReferenceNames;t<r.length;t+=1){var i=r[t];e.groupNames[i]||e.raise("Invalid named capture referenced")}};Cr.regexp_disjunction=function(e){var t=this.options.ecmaVersion>=16;for(t&&(e.branchID=new iC(e.branchID,null)),this.regexp_alternative(e);e.eat(124);)t&&(e.branchID=e.branchID.sibling()),this.regexp_alternative(e);t&&(e.branchID=e.branchID.parent),this.regexp_eatQuantifier(e,!0)&&e.raise("Nothing to repeat"),e.eat(123)&&e.raise("Lone quantifier brackets")};Cr.regexp_alternative=function(e){for(;e.pos<e.source.length&&this.regexp_eatTerm(e););};Cr.regexp_eatTerm=function(e){return this.regexp_eatAssertion(e)?(e.lastAssertionIsQuantifiable&&this.regexp_eatQuantifier(e)&&e.switchU&&e.raise("Invalid quantifier"),!0):(e.switchU?this.regexp_eatAtom(e):this.regexp_eatExtendedAtom(e))?(this.regexp_eatQuantifier(e),!0):!1};Cr.regexp_eatAssertion=function(e){var t=e.pos;if(e.lastAssertionIsQuantifiable=!1,e.eat(94)||e.eat(36))return!0;if(e.eat(92)){if(e.eat(66)||e.eat(98))return!0;e.pos=t}if(e.eat(40)&&e.eat(63)){var r=!1;if(this.options.ecmaVersion>=9&&(r=e.eat(60)),e.eat(61)||e.eat(33))return this.regexp_disjunction(e),e.eat(41)||e.raise("Unterminated group"),e.lastAssertionIsQuantifiable=!r,!0}return e.pos=t,!1};Cr.regexp_eatQuantifier=function(e,t){return t===void 0&&(t=!1),this.regexp_eatQuantifierPrefix(e,t)?(e.eat(63),!0):!1};Cr.regexp_eatQuantifierPrefix=function(e,t){return e.eat(42)||e.eat(43)||e.eat(63)||this.regexp_eatBracedQuantifier(e,t)};Cr.regexp_eatBracedQuantifier=function(e,t){var r=e.pos;if(e.eat(123)){var i=0,s=-1;if(this.regexp_eatDecimalDigits(e)&&(i=e.lastIntValue,e.eat(44)&&this.regexp_eatDecimalDigits(e)&&(s=e.lastIntValue),e.eat(125)))return s!==-1&&s<i&&!t&&e.raise("numbers out of order in {} quantifier"),!0;e.switchU&&!t&&e.raise("Incomplete quantifier"),e.pos=r}return!1};Cr.regexp_eatAtom=function(e){return this.regexp_eatPatternCharacters(e)||e.eat(46)||this.regexp_eatReverseSolidusAtomEscape(e)||this.regexp_eatCharacterClass(e)||this.regexp_eatUncapturingGroup(e)||this.regexp_eatCapturingGroup(e)};Cr.regexp_eatReverseSolidusAtomEscape=function(e){var t=e.pos;if(e.eat(92)){if(this.regexp_eatAtomEscape(e))return!0;e.pos=t}return!1};Cr.regexp_eatUncapturingGroup=function(e){var t=e.pos;if(e.eat(40)){if(e.eat(63)&&e.eat(58)){if(this.regexp_disjunction(e),e.eat(41))return!0;e.raise("Unterminated group")}e.pos=t}return!1};Cr.regexp_eatCapturingGroup=function(e){if(e.eat(40)){if(this.options.ecmaVersion>=9?this.regexp_groupSpecifier(e):e.current()===63&&e.raise("Invalid group"),this.regexp_disjunction(e),e.eat(41))return e.numCapturingParens+=1,!0;e.raise("Unterminated group")}return!1};Cr.regexp_eatExtendedAtom=function(e){return e.eat(46)||this.regexp_eatReverseSolidusAtomEscape(e)||this.regexp_eatCharacterClass(e)||this.regexp_eatUncapturingGroup(e)||this.regexp_eatCapturingGroup(e)||this.regexp_eatInvalidBracedQuantifier(e)||this.regexp_eatExtendedPatternCharacter(e)};Cr.regexp_eatInvalidBracedQuantifier=function(e){return this.regexp_eatBracedQuantifier(e,!0)&&e.raise("Nothing to repeat"),!1};Cr.regexp_eatSyntaxCharacter=function(e){var t=e.current();return Gst(t)?(e.lastIntValue=t,e.advance(),!0):!1};function Gst(e){return e===36||e>=40&&e<=43||e===46||e===63||e>=91&&e<=94||e>=123&&e<=125}Cr.regexp_eatPatternCharacters=function(e){for(var t=e.pos,r=0;(r=e.current())!==-1&&!Gst(r);)e.advance();return e.pos!==t};Cr.regexp_eatExtendedPatternCharacter=function(e){var t=e.current();return t!==-1&&t!==36&&!(t>=40&&t<=43)&&t!==46&&t!==63&&t!==91&&t!==94&&t!==124?(e.advance(),!0):!1};Cr.regexp_groupSpecifier=function(e){if(e.eat(63)){this.regexp_eatGroupName(e)||e.raise("Invalid group");var t=this.options.ecmaVersion>=16,r=e.groupNames[e.lastStringValue];if(r)if(t)for(var i=0,s=r;i<s.length;i+=1){var n=s[i];n.separatedFrom(e.branchID)||e.raise("Duplicate capture group name")}else e.raise("Duplicate capture group name");t?(r||(e.groupNames[e.lastStringValue]=[])).push(e.branchID):e.groupNames[e.lastStringValue]=!0}};Cr.regexp_eatGroupName=function(e){if(e.lastStringValue="",e.eat(60)){if(this.regexp_eatRegExpIdentifierName(e)&&e.eat(62))return!0;e.raise("Invalid capture group name")}return!1};Cr.regexp_eatRegExpIdentifierName=function(e){if(e.lastStringValue="",this.regexp_eatRegExpIdentifierStart(e)){for(e.lastStringValue+=vm(e.lastIntValue);this.regexp_eatRegExpIdentifierPart(e);)e.lastStringValue+=vm(e.lastIntValue);return!0}return!1};Cr.regexp_eatRegExpIdentifierStart=function(e){var t=e.pos,r=this.options.ecmaVersion>=11,i=e.current(r);return e.advance(r),i===92&&this.regexp_eatRegExpUnicodeEscapeSequence(e,r)&&(i=e.lastIntValue),vSt(i)?(e.lastIntValue=i,!0):(e.pos=t,!1)};function vSt(e){return C0(e,!0)||e===36||e===95}Cr.regexp_eatRegExpIdentifierPart=function(e){var t=e.pos,r=this.options.ecmaVersion>=11,i=e.current(r);return e.advance(r),i===92&&this.regexp_eatRegExpUnicodeEscapeSequence(e,r)&&(i=e.lastIntValue),wSt(i)?(e.lastIntValue=i,!0):(e.pos=t,!1)};function wSt(e){return jx(e,!0)||e===36||e===95||e===8204||e===8205}Cr.regexp_eatAtomEscape=function(e){return this.regexp_eatBackReference(e)||this.regexp_eatCharacterClassEscape(e)||this.regexp_eatCharacterEscape(e)||e.switchN&&this.regexp_eatKGroupName(e)?!0:(e.switchU&&(e.current()===99&&e.raise("Invalid unicode escape"),e.raise("Invalid escape")),!1)};Cr.regexp_eatBackReference=function(e){var t=e.pos;if(this.regexp_eatDecimalEscape(e)){var r=e.lastIntValue;if(e.switchU)return r>e.maxBackReference&&(e.maxBackReference=r),!0;if(r<=e.numCapturingParens)return!0;e.pos=t}return!1};Cr.regexp_eatKGroupName=function(e){if(e.eat(107)){if(this.regexp_eatGroupName(e))return e.backReferenceNames.push(e.lastStringValue),!0;e.raise("Invalid named reference")}return!1};Cr.regexp_eatCharacterEscape=function(e){return this.regexp_eatControlEscape(e)||this.regexp_eatCControlLetter(e)||this.regexp_eatZero(e)||this.regexp_eatHexEscapeSequence(e)||this.regexp_eatRegExpUnicodeEscapeSequence(e,!1)||!e.switchU&&this.regexp_eatLegacyOctalEscapeSequence(e)||this.regexp_eatIdentityEscape(e)};Cr.regexp_eatCControlLetter=function(e){var t=e.pos;if(e.eat(99)){if(this.regexp_eatControlLetter(e))return!0;e.pos=t}return!1};Cr.regexp_eatZero=function(e){return e.current()===48&&!aC(e.lookahead())?(e.lastIntValue=0,e.advance(),!0):!1};Cr.regexp_eatControlEscape=function(e){var t=e.current();return t===116?(e.lastIntValue=9,e.advance(),!0):t===110?(e.lastIntValue=10,e.advance(),!0):t===118?(e.lastIntValue=11,e.advance(),!0):t===102?(e.lastIntValue=12,e.advance(),!0):t===114?(e.lastIntValue=13,e.advance(),!0):!1};Cr.regexp_eatControlLetter=function(e){var t=e.current();return Qst(t)?(e.lastIntValue=t%32,e.advance(),!0):!1};function Qst(e){return e>=65&&e<=90||e>=97&&e<=122}Cr.regexp_eatRegExpUnicodeEscapeSequence=function(e,t){t===void 0&&(t=!1);var r=e.pos,i=t||e.switchU;if(e.eat(117)){if(this.regexp_eatFixedHexDigits(e,4)){var s=e.lastIntValue;if(i&&s>=55296&&s<=56319){var n=e.pos;if(e.eat(92)&&e.eat(117)&&this.regexp_eatFixedHexDigits(e,4)){var o=e.lastIntValue;if(o>=56320&&o<=57343)return e.lastIntValue=(s-55296)*1024+(o-56320)+65536,!0}e.pos=n,e.lastIntValue=s}return!0}if(i&&e.eat(123)&&this.regexp_eatHexDigits(e)&&e.eat(125)&&TSt(e.lastIntValue))return!0;i&&e.raise("Invalid unicode escape"),e.pos=r}return!1};function TSt(e){return e>=0&&e<=1114111}Cr.regexp_eatIdentityEscape=function(e){if(e.switchU)return this.regexp_eatSyntaxCharacter(e)?!0:e.eat(47)?(e.lastIntValue=47,!0):!1;var t=e.current();return t!==99&&(!e.switchN||t!==107)?(e.lastIntValue=t,e.advance(),!0):!1};Cr.regexp_eatDecimalEscape=function(e){e.lastIntValue=0;var t=e.current();if(t>=49&&t<=57){do e.lastIntValue=10*e.lastIntValue+(t-48),e.advance();while((t=e.current())>=48&&t<=57);return!0}return!1};var Kst=0,P0=1,Ah=2;Cr.regexp_eatCharacterClassEscape=function(e){var t=e.current();if(SSt(t))return e.lastIntValue=-1,e.advance(),P0;var r=!1;if(e.switchU&&this.options.ecmaVersion>=9&&((r=t===80)||t===112)){e.lastIntValue=-1,e.advance();var i;if(e.eat(123)&&(i=this.regexp_eatUnicodePropertyValueExpression(e))&&e.eat(125))return r&&i===Ah&&e.raise("Invalid property name"),i;e.raise("Invalid property name")}return Kst};function SSt(e){return e===100||e===68||e===115||e===83||e===119||e===87}Cr.regexp_eatUnicodePropertyValueExpression=function(e){var t=e.pos;if(this.regexp_eatUnicodePropertyName(e)&&e.eat(61)){var r=e.lastStringValue;if(this.regexp_eatUnicodePropertyValue(e)){var i=e.lastStringValue;return this.regexp_validateUnicodePropertyNameAndValue(e,r,i),P0}}if(e.pos=t,this.regexp_eatLoneUnicodePropertyNameOrValue(e)){var s=e.lastStringValue;return this.regexp_validateUnicodePropertyNameOrValue(e,s)}return Kst};Cr.regexp_validateUnicodePropertyNameAndValue=function(e,t,r){mT(e.unicodeProperties.nonBinary,t)||e.raise("Invalid property name"),e.unicodeProperties.nonBinary[t].test(r)||e.raise("Invalid property value")};Cr.regexp_validateUnicodePropertyNameOrValue=function(e,t){if(e.unicodeProperties.binary.test(t))return P0;if(e.switchV&&e.unicodeProperties.binaryOfStrings.test(t))return Ah;e.raise("Invalid property name")};Cr.regexp_eatUnicodePropertyName=function(e){var t=0;for(e.lastStringValue="";Jst(t=e.current());)e.lastStringValue+=vm(t),e.advance();return e.lastStringValue!==""};function Jst(e){return Qst(e)||e===95}Cr.regexp_eatUnicodePropertyValue=function(e){var t=0;for(e.lastStringValue="";ESt(t=e.current());)e.lastStringValue+=vm(t),e.advance();return e.lastStringValue!==""};function ESt(e){return Jst(e)||aC(e)}Cr.regexp_eatLoneUnicodePropertyNameOrValue=function(e){return this.regexp_eatUnicodePropertyValue(e)};Cr.regexp_eatCharacterClass=function(e){if(e.eat(91)){var t=e.eat(94),r=this.regexp_classContents(e);return e.eat(93)||e.raise("Unterminated character class"),t&&r===Ah&&e.raise("Negated character class may contain strings"),!0}return!1};Cr.regexp_classContents=function(e){return e.current()===93?P0:e.switchV?this.regexp_classSetExpression(e):(this.regexp_nonEmptyClassRanges(e),P0)};Cr.regexp_nonEmptyClassRanges=function(e){for(;this.regexp_eatClassAtom(e);){var t=e.lastIntValue;if(e.eat(45)&&this.regexp_eatClassAtom(e)){var r=e.lastIntValue;e.switchU&&(t===-1||r===-1)&&e.raise("Invalid character class"),t!==-1&&r!==-1&&t>r&&e.raise("Range out of order in character class")}}};Cr.regexp_eatClassAtom=function(e){var t=e.pos;if(e.eat(92)){if(this.regexp_eatClassEscape(e))return!0;if(e.switchU){var r=e.current();(r===99||rot(r))&&e.raise("Invalid class escape"),e.raise("Invalid escape")}e.pos=t}var i=e.current();return i!==93?(e.lastIntValue=i,e.advance(),!0):!1};Cr.regexp_eatClassEscape=function(e){var t=e.pos;if(e.eat(98))return e.lastIntValue=8,!0;if(e.switchU&&e.eat(45))return e.lastIntValue=45,!0;if(!e.switchU&&e.eat(99)){if(this.regexp_eatClassControlLetter(e))return!0;e.pos=t}return this.regexp_eatCharacterClassEscape(e)||this.regexp_eatCharacterEscape(e)};Cr.regexp_classSetExpression=function(e){var t=P0,r;if(!this.regexp_eatClassSetRange(e))if(r=this.regexp_eatClassSetOperand(e)){r===Ah&&(t=Ah);for(var i=e.pos;e.eatChars([38,38]);){if(e.current()!==38&&(r=this.regexp_eatClassSetOperand(e))){r!==Ah&&(t=P0);continue}e.raise("Invalid character in character class")}if(i!==e.pos)return t;for(;e.eatChars([45,45]);)this.regexp_eatClassSetOperand(e)||e.raise("Invalid character in character class");if(i!==e.pos)return t}else e.raise("Invalid character in character class");for(;;)if(!this.regexp_eatClassSetRange(e)){if(r=this.regexp_eatClassSetOperand(e),!r)return t;r===Ah&&(t=Ah)}};Cr.regexp_eatClassSetRange=function(e){var t=e.pos;if(this.regexp_eatClassSetCharacter(e)){var r=e.lastIntValue;if(e.eat(45)&&this.regexp_eatClassSetCharacter(e)){var i=e.lastIntValue;return r!==-1&&i!==-1&&r>i&&e.raise("Range out of order in character class"),!0}e.pos=t}return!1};Cr.regexp_eatClassSetOperand=function(e){return this.regexp_eatClassSetCharacter(e)?P0:this.regexp_eatClassStringDisjunction(e)||this.regexp_eatNestedClass(e)};Cr.regexp_eatNestedClass=function(e){var t=e.pos;if(e.eat(91)){var r=e.eat(94),i=this.regexp_classContents(e);if(e.eat(93))return r&&i===Ah&&e.raise("Negated character class may contain strings"),i;e.pos=t}if(e.eat(92)){var s=this.regexp_eatCharacterClassEscape(e);if(s)return s;e.pos=t}return null};Cr.regexp_eatClassStringDisjunction=function(e){var t=e.pos;if(e.eatChars([92,113])){if(e.eat(123)){var r=this.regexp_classStringDisjunctionContents(e);if(e.eat(125))return r}else e.raise("Invalid escape");e.pos=t}return null};Cr.regexp_classStringDisjunctionContents=function(e){for(var t=this.regexp_classString(e);e.eat(124);)this.regexp_classString(e)===Ah&&(t=Ah);return t};Cr.regexp_classString=function(e){for(var t=0;this.regexp_eatClassSetCharacter(e);)t++;return t===1?P0:Ah};Cr.regexp_eatClassSetCharacter=function(e){var t=e.pos;if(e.eat(92))return this.regexp_eatCharacterEscape(e)||this.regexp_eatClassSetReservedPunctuator(e)?!0:e.eat(98)?(e.lastIntValue=8,!0):(e.pos=t,!1);var r=e.current();return r<0||r===e.lookahead()&&ISt(r)||MSt(r)?!1:(e.advance(),e.lastIntValue=r,!0)};function ISt(e){return e===33||e>=35&&e<=38||e>=42&&e<=44||e===46||e>=58&&e<=64||e===94||e===96||e===126}function MSt(e){return e===40||e===41||e===45||e===47||e>=91&&e<=93||e>=123&&e<=125}Cr.regexp_eatClassSetReservedPunctuator=function(e){var t=e.current();return CSt(t)?(e.lastIntValue=t,e.advance(),!0):!1};function CSt(e){return e===33||e===35||e===37||e===38||e===44||e===45||e>=58&&e<=62||e===64||e===96||e===126}Cr.regexp_eatClassControlLetter=function(e){var t=e.current();return aC(t)||t===95?(e.lastIntValue=t%32,e.advance(),!0):!1};Cr.regexp_eatHexEscapeSequence=function(e){var t=e.pos;if(e.eat(120)){if(this.regexp_eatFixedHexDigits(e,2))return!0;e.switchU&&e.raise("Invalid escape"),e.pos=t}return!1};Cr.regexp_eatDecimalDigits=function(e){var t=e.pos,r=0;for(e.lastIntValue=0;aC(r=e.current());)e.lastIntValue=10*e.lastIntValue+(r-48),e.advance();return e.pos!==t};function aC(e){return e>=48&&e<=57}Cr.regexp_eatHexDigits=function(e){var t=e.pos,r=0;for(e.lastIntValue=0;tot(r=e.current());)e.lastIntValue=16*e.lastIntValue+eot(r),e.advance();return e.pos!==t};function tot(e){return e>=48&&e<=57||e>=65&&e<=70||e>=97&&e<=102}function eot(e){return e>=65&&e<=70?10+(e-65):e>=97&&e<=102?10+(e-97):e-48}Cr.regexp_eatLegacyOctalEscapeSequence=function(e){if(this.regexp_eatOctalDigit(e)){var t=e.lastIntValue;if(this.regexp_eatOctalDigit(e)){var r=e.lastIntValue;t<=3&&this.regexp_eatOctalDigit(e)?e.lastIntValue=t*64+r*8+e.lastIntValue:e.lastIntValue=t*8+r}else e.lastIntValue=t;return!0}return!1};Cr.regexp_eatOctalDigit=function(e){var t=e.current();return rot(t)?(e.lastIntValue=t-48,e.advance(),!0):(e.lastIntValue=0,!1)};function rot(e){return e>=48&&e<=55}Cr.regexp_eatFixedHexDigits=function(e,t){var r=e.pos;e.lastIntValue=0;for(var i=0;i<t;++i){var s=e.current();if(!tot(s))return e.pos=r,!1;e.lastIntValue=16*e.lastIntValue+eot(s),e.advance()}return!0};var wF=function(t){this.type=t.type,this.value=t.value,this.start=t.start,this.end=t.end,t.options.locations&&(this.loc=new nC(t,t.startLoc,t.endLoc)),t.options.ranges&&(this.range=[t.start,t.end])},mn=Ko.prototype;mn.next=function(e){!e&&this.type.keyword&&this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword "+this.type.keyword),this.options.onToken&&this.options.onToken(new wF(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()};mn.getToken=function(){return this.next(),new wF(this)};typeof Symbol<"u"&&(mn[Symbol.iterator]=function(){var e=this;return{next:function(){var t=e.getToken();return{done:t.type===dt.eof,value:t}}}});mn.nextToken=function(){var e=this.curContext();if((!e||!e.preserveSpace)&&this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length)return this.finishToken(dt.eof);if(e.override)return e.override(this);this.readToken(this.fullCharCodeAtPos())};mn.readToken=function(e){return C0(e,this.options.ecmaVersion>=6)||e===92?this.readWord():this.getTokenFromCode(e)};mn.fullCharCodeAtPos=function(){var e=this.input.charCodeAt(this.pos);if(e<=55295||e>=56320)return e;var t=this.input.charCodeAt(this.pos+1);return t<=56319||t>=57344?e:(e<<10)+t-56613888};mn.skipBlockComment=function(){var e=this.options.onComment&&this.curPosition(),t=this.pos,r=this.input.indexOf("*/",this.pos+=2);if(r===-1&&this.raise(this.pos-2,"Unterminated comment"),this.pos=r+2,this.options.locations)for(var i=void 0,s=t;(i=Sst(this.input,s,this.pos))>-1;)++this.curLine,s=this.lineStart=i;this.options.onComment&&this.options.onComment(!0,this.input.slice(t+2,r),t,this.pos,e,this.curPosition())};mn.skipLineComment=function(e){for(var t=this.pos,r=this.options.onComment&&this.curPosition(),i=this.input.charCodeAt(this.pos+=e);this.pos<this.input.length&&!$x(i);)i=this.input.charCodeAt(++this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(t+e,this.pos),t,this.pos,r,this.curPosition())};mn.skipSpace=function(){t:for(;this.pos<this.input.length;){var e=this.input.charCodeAt(this.pos);switch(e){case 32:case 160:++this.pos;break;case 13:this.input.charCodeAt(this.pos+1)===10&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break t}break;default:if(e>8&&e<14||e>=5760&&Est.test(String.fromCharCode(e)))++this.pos;else break t}}};mn.finishToken=function(e,t){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var r=this.type;this.type=e,this.value=t,this.updateContext(r)};mn.readToken_dot=function(){var e=this.input.charCodeAt(this.pos+1);if(e>=48&&e<=57)return this.readNumber(!0);var t=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&e===46&&t===46?(this.pos+=3,this.finishToken(dt.ellipsis)):(++this.pos,this.finishToken(dt.dot))};mn.readToken_slash=function(){var e=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):e===61?this.finishOp(dt.assign,2):this.finishOp(dt.slash,1)};mn.readToken_mult_modulo_exp=function(e){var t=this.input.charCodeAt(this.pos+1),r=1,i=e===42?dt.star:dt.modulo;return this.options.ecmaVersion>=7&&e===42&&t===42&&(++r,i=dt.starstar,t=this.input.charCodeAt(this.pos+2)),t===61?this.finishOp(dt.assign,r+1):this.finishOp(i,r)};mn.readToken_pipe_amp=function(e){var t=this.input.charCodeAt(this.pos+1);if(t===e){if(this.options.ecmaVersion>=12){var r=this.input.charCodeAt(this.pos+2);if(r===61)return this.finishOp(dt.assign,3)}return this.finishOp(e===124?dt.logicalOR:dt.logicalAND,2)}return t===61?this.finishOp(dt.assign,2):this.finishOp(e===124?dt.bitwiseOR:dt.bitwiseAND,1)};mn.readToken_caret=function(){var e=this.input.charCodeAt(this.pos+1);return e===61?this.finishOp(dt.assign,2):this.finishOp(dt.bitwiseXOR,1)};mn.readToken_plus_min=function(e){var t=this.input.charCodeAt(this.pos+1);return t===e?t===45&&!this.inModule&&this.input.charCodeAt(this.pos+2)===62&&(this.lastTokEnd===0||mh.test(this.input.slice(this.lastTokEnd,this.pos)))?(this.skipLineComment(3),this.skipSpace(),this.nextToken()):this.finishOp(dt.incDec,2):t===61?this.finishOp(dt.assign,2):this.finishOp(dt.plusMin,1)};mn.readToken_lt_gt=function(e){var t=this.input.charCodeAt(this.pos+1),r=1;return t===e?(r=e===62&&this.input.charCodeAt(this.pos+2)===62?3:2,this.input.charCodeAt(this.pos+r)===61?this.finishOp(dt.assign,r+1):this.finishOp(dt.bitShift,r)):t===33&&e===60&&!this.inModule&&this.input.charCodeAt(this.pos+2)===45&&this.input.charCodeAt(this.pos+3)===45?(this.skipLineComment(4),this.skipSpace(),this.nextToken()):(t===61&&(r=2),this.finishOp(dt.relational,r))};mn.readToken_eq_excl=function(e){var t=this.input.charCodeAt(this.pos+1);return t===61?this.finishOp(dt.equality,this.input.charCodeAt(this.pos+2)===61?3:2):e===61&&t===62&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(dt.arrow)):this.finishOp(e===61?dt.eq:dt.prefix,1)};mn.readToken_question=function(){var e=this.options.ecmaVersion;if(e>=11){var t=this.input.charCodeAt(this.pos+1);if(t===46){var r=this.input.charCodeAt(this.pos+2);if(r<48||r>57)return this.finishOp(dt.questionDot,2)}if(t===63){if(e>=12){var i=this.input.charCodeAt(this.pos+2);if(i===61)return this.finishOp(dt.assign,3)}return this.finishOp(dt.coalesce,2)}}return this.finishOp(dt.question,1)};mn.readToken_numberSign=function(){var e=this.options.ecmaVersion,t=35;if(e>=13&&(++this.pos,t=this.fullCharCodeAtPos(),C0(t,!0)||t===92))return this.finishToken(dt.privateId,this.readWord1());this.raise(this.pos,"Unexpected character '"+vm(t)+"'")};mn.getTokenFromCode=function(e){switch(e){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(dt.parenL);case 41:return++this.pos,this.finishToken(dt.parenR);case 59:return++this.pos,this.finishToken(dt.semi);case 44:return++this.pos,this.finishToken(dt.comma);case 91:return++this.pos,this.finishToken(dt.bracketL);case 93:return++this.pos,this.finishToken(dt.bracketR);case 123:return++this.pos,this.finishToken(dt.braceL);case 125:return++this.pos,this.finishToken(dt.braceR);case 58:return++this.pos,this.finishToken(dt.colon);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(dt.backQuote);case 48:var t=this.input.charCodeAt(this.pos+1);if(t===120||t===88)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(t===111||t===79)return this.readRadixNumber(8);if(t===98||t===66)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(e);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(e);case 124:case 38:return this.readToken_pipe_amp(e);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(e);case 60:case 62:return this.readToken_lt_gt(e);case 61:case 33:return this.readToken_eq_excl(e);case 63:return this.readToken_question();case 126:return this.finishOp(dt.prefix,1);case 35:return this.readToken_numberSign()}this.raise(this.pos,"Unexpected character '"+vm(e)+"'")};mn.finishOp=function(e,t){var r=this.input.slice(this.pos,this.pos+t);return this.pos+=t,this.finishToken(e,r)};mn.readRegexp=function(){for(var e,t,r=this.pos;;){this.pos>=this.input.length&&this.raise(r,"Unterminated regular expression");var i=this.input.charAt(this.pos);if(mh.test(i)&&this.raise(r,"Unterminated regular expression"),e)e=!1;else{if(i==="[")t=!0;else if(i==="]"&&t)t=!1;else if(i==="/"&&!t)break;e=i==="\\"}++this.pos}var s=this.input.slice(r,this.pos);++this.pos;var n=this.pos,o=this.readWord1();this.containsEsc&&this.unexpected(n);var c=this.regexpState||(this.regexpState=new Hp(this));c.reset(r,s,o),this.validateRegExpFlags(c),this.validateRegExpPattern(c);var f=null;try{f=new RegExp(s,o)}catch{}return this.finishToken(dt.regexp,{pattern:s,flags:o,value:f})};mn.readInt=function(e,t,r){for(var i=this.options.ecmaVersion>=12&&t===void 0,s=r&&this.input.charCodeAt(this.pos)===48,n=this.pos,o=0,c=0,f=0,p=t??1/0;f<p;++f,++this.pos){var x=this.input.charCodeAt(this.pos),E=void 0;if(i&&x===95){s&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed in legacy octal numeric literals"),c===95&&this.raiseRecoverable(this.pos,"Numeric separator must be exactly one underscore"),f===0&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed at the first of digits"),c=x;continue}if(x>=97?E=x-97+10:x>=65?E=x-65+10:x>=48&&x<=57?E=x-48:E=1/0,E>=e)break;c=x,o=o*e+E}return i&&c===95&&this.raiseRecoverable(this.pos-1,"Numeric separator is not allowed at the last of digits"),this.pos===n||t!=null&&this.pos-n!==t?null:o};function PSt(e,t){return t?parseInt(e,8):parseFloat(e.replace(/_/g,""))}function iot(e){return typeof BigInt!="function"?null:BigInt(e.replace(/_/g,""))}mn.readRadixNumber=function(e){var t=this.pos;this.pos+=2;var r=this.readInt(e);return r==null&&this.raise(this.start+2,"Expected number in radix "+e),this.options.ecmaVersion>=11&&this.input.charCodeAt(this.pos)===110?(r=iot(this.input.slice(t,this.pos)),++this.pos):C0(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(dt.num,r)};mn.readNumber=function(e){var t=this.pos;!e&&this.readInt(10,void 0,!0)===null&&this.raise(t,"Invalid number");var r=this.pos-t>=2&&this.input.charCodeAt(t)===48;r&&this.strict&&this.raise(t,"Invalid number");var i=this.input.charCodeAt(this.pos);if(!r&&!e&&this.options.ecmaVersion>=11&&i===110){var s=iot(this.input.slice(t,this.pos));return++this.pos,C0(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(dt.num,s)}r&&/[89]/.test(this.input.slice(t,this.pos))&&(r=!1),i===46&&!r&&(++this.pos,this.readInt(10),i=this.input.charCodeAt(this.pos)),(i===69||i===101)&&!r&&(i=this.input.charCodeAt(++this.pos),(i===43||i===45)&&++this.pos,this.readInt(10)===null&&this.raise(t,"Invalid number")),C0(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var n=PSt(this.input.slice(t,this.pos),r);return this.finishToken(dt.num,n)};mn.readCodePoint=function(){var e=this.input.charCodeAt(this.pos),t;if(e===123){this.options.ecmaVersion<6&&this.unexpected();var r=++this.pos;t=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,t>1114111&&this.invalidStringToken(r,"Code point out of bounds")}else t=this.readHexChar(4);return t};mn.readString=function(e){for(var t="",r=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var i=this.input.charCodeAt(this.pos);if(i===e)break;i===92?(t+=this.input.slice(r,this.pos),t+=this.readEscapedChar(!1),r=this.pos):i===8232||i===8233?(this.options.ecmaVersion<10&&this.raise(this.start,"Unterminated string constant"),++this.pos,this.options.locations&&(this.curLine++,this.lineStart=this.pos)):($x(i)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return t+=this.input.slice(r,this.pos++),this.finishToken(dt.string,t)};var not={};mn.tryReadTemplateToken=function(){this.inTemplateElement=!0;try{this.readTmplToken()}catch(e){if(e===not)this.readInvalidTemplateToken();else throw e}this.inTemplateElement=!1};mn.invalidStringToken=function(e,t){if(this.inTemplateElement&&this.options.ecmaVersion>=9)throw not;this.raise(e,t)};mn.readTmplToken=function(){for(var e="",t=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");var r=this.input.charCodeAt(this.pos);if(r===96||r===36&&this.input.charCodeAt(this.pos+1)===123)return this.pos===this.start&&(this.type===dt.template||this.type===dt.invalidTemplate)?r===36?(this.pos+=2,this.finishToken(dt.dollarBraceL)):(++this.pos,this.finishToken(dt.backQuote)):(e+=this.input.slice(t,this.pos),this.finishToken(dt.template,e));if(r===92)e+=this.input.slice(t,this.pos),e+=this.readEscapedChar(!0),t=this.pos;else if($x(r)){switch(e+=this.input.slice(t,this.pos),++this.pos,r){case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:e+=`
`;break;default:e+=String.fromCharCode(r);break}this.options.locations&&(++this.curLine,this.lineStart=this.pos),t=this.pos}else++this.pos}};mn.readInvalidTemplateToken=function(){for(;this.pos<this.input.length;this.pos++)switch(this.input[this.pos]){case"\\":++this.pos;break;case"$":if(this.input[this.pos+1]!=="{")break;case"`":return this.finishToken(dt.invalidTemplate,this.input.slice(this.start,this.pos));case"\r":this.input[this.pos+1]===`
`&&++this.pos;case`
`:case"\u2028":case"\u2029":++this.curLine,this.lineStart=this.pos+1;break}this.raise(this.start,"Unterminated template")};mn.readEscapedChar=function(e){var t=this.input.charCodeAt(++this.pos);switch(++this.pos,t){case 110:return`
`;case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return vm(this.readCodePoint());case 116:return"	";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";case 56:case 57:if(this.strict&&this.invalidStringToken(this.pos-1,"Invalid escape sequence"),e){var r=this.pos-1;this.invalidStringToken(r,"Invalid escape sequence in template string")}default:if(t>=48&&t<=55){var i=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],s=parseInt(i,8);return s>255&&(i=i.slice(0,-1),s=parseInt(i,8)),this.pos+=i.length-1,t=this.input.charCodeAt(this.pos),(i!=="0"||t===56||t===57)&&(this.strict||e)&&this.invalidStringToken(this.pos-1-i.length,e?"Octal literal in template string":"Octal literal in strict mode"),String.fromCharCode(s)}return $x(t)?(this.options.locations&&(this.lineStart=this.pos,++this.curLine),""):String.fromCharCode(t)}};mn.readHexChar=function(e){var t=this.pos,r=this.readInt(16,e);return r===null&&this.invalidStringToken(t,"Bad character escape sequence"),r};mn.readWord1=function(){this.containsEsc=!1;for(var e="",t=!0,r=this.pos,i=this.options.ecmaVersion>=6;this.pos<this.input.length;){var s=this.fullCharCodeAtPos();if(jx(s,i))this.pos+=s<=65535?1:2;else if(s===92){this.containsEsc=!0,e+=this.input.slice(r,this.pos);var n=this.pos;this.input.charCodeAt(++this.pos)!==117&&this.invalidStringToken(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;var o=this.readCodePoint();(t?C0:jx)(o,i)||this.invalidStringToken(n,"Invalid Unicode escape"),e+=vm(o),r=this.pos}else break;t=!1}return e+this.input.slice(r,this.pos)};mn.readWord=function(){var e=this.readWord1(),t=dt.name;return this.keywords.test(e)&&(t=mF[e]),this.finishToken(t,e)};var RSt="8.12.1";Ko.acorn={Parser:Ko,version:RSt,defaultOptions:pF,Position:dT,SourceLocation:nC,getLineInfo:Mst,Node:oC,TokenType:Pn,tokTypes:dt,keywordTypes:mF,TokContext:_f,tokContexts:Hs,isIdentifierChar:jx,isIdentifierStart:C0,Token:wF,isNewLine:$x,lineBreak:mh,lineBreakG:rSt,nonASCIIwhitespace:Est};function sot(e,t){return Ko.parse(e,t)}var lC={undefined:"void(0)",Infinity:"Number.POSITIVE_INFINITY",NaN:"Number.NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2"};var kSt={ecmaVersion:11},oot="$",DSt="d",BSt="d1",OSt="d2",Ya=e=>(t,r)=>r.error(t,e+" not allowed"),NSt=Ya("Aggregate function"),FSt=Ya("Window function"),LSt="Invalid argument",IF="Invalid column reference",zSt=IF+" (must be input to an aggregate function)",lot="Invalid function call",USt="Invalid member expression",VSt="Invalid operator parameter",jSt="Invalid param reference",$St="Invalid variable reference",HSt="Variable not accessible in operator call",WSt="Unsupported variable declaration",qSt="Unsupported destructuring pattern",cot="Table expressions do not support closures",uot="Use aq.escape(fn) to use a function as-is (including closures)",YSt="use table.params({ name: value }) to define dynamic parameters",XSt="use aq.addFunction(name, fn) to add new op functions",ZSt=`
Note: ${cot}. ${uot}, or ${YSt}.`,hot=`
Note: ${cot}. ${uot}, or ${XSt}.`,GSt=`The ${nx} method is not valid in multi-table expressions.`;function MF(e,t){let r=QSt(t),i=e.root=r;return e.spec=t,e.tuple=null,e.tuple1=null,e.tuple2=null,e.$param=null,e.$op=0,e.scope=new Set,e.paramsRef=new Map,e.columnRef=new Map,Ast(i)?(JSt(i,e),i=i.body):e.join?(e.scope.add(e.tuple1=BSt),e.scope.add(e.tuple2=OSt),e.scope.add(e.$param=oot)):(e.scope.add(e.tuple=DSt),e.scope.add(e.$param=oot)),sn(i,e,CF),e.root}function QSt(e){try{let t=e.field?KSt(e):oi(e)?Ds(e):e;return sot(`expr=(${t})`,kSt).body[0].expression.right}catch(t){nr(`Expression parse error: ${e+""}`,t)}}function KSt(e){let t=JSON.stringify(e+"");return e.table?`(a,b)=>b[${t}]`:`d=>d[${t}]`}var CF={FunctionDeclaration:Ya("Function definitions"),ForStatement:Ya("For loops"),ForOfStatement:Ya("For-of loops"),ForInStatement:Ya("For-in loops"),WhileStatement:Ya("While loops"),DoWhileStatement:Ya("Do-while loops"),AwaitExpression:Ya("Await expressions"),ArrowFunctionExpression:Ya("Function definitions"),AssignmentExpression:Ya("Assignments"),FunctionExpression:Ya("Function definitions"),NewExpression:Ya('Use of "new"'),UpdateExpression:Ya("Update expressions"),VariableDeclarator(e,t){EF(e.id,t)},Identifier(e,t,r){dot(e,t,r)&&!t.scope.has(e.name)&&t.error(e,$St,ZSt)},CallExpression(e,t){let r=fot(e.callee),i=gM(r)||_M(r);if(i){if((t.join||t.aggregate===!1)&&c4(r)&&NSt(e,t),(t.join||t.window===!1)&&u4(r)&&FSt(e,t),t.$op=1,t.ast)SF(e,r,t),e.arguments.forEach(s=>sn(s,t,TF));else{let s=t.op(tEt(t,i,r,e.arguments));Object.assign(e,{type:mM,name:s.id})}return t.$op=0,!1}else tN(r)?SF(e,r,t):t.error(e,lot,hot)},MemberExpression(e,t,r){let{object:i,property:s}=e;if(!Po(n0,i))return;let{name:n}=i;if(pot(e)&&Po(n0,s)&&ya(lC,s.name)){got(e,s.name);return}let o=n===t.tuple?0:n===t.tuple1?1:n===t.tuple2?2:-1;if(o>=0)return aot(e,o,t,Aot,r);if(n===t.$param)return aot(e,o,t,rEt);t.paramsRef.has(n)?xT(e,t.paramsRef.get(n)):t.columnRef.has(n)?mot(i,n,t,e):ya(t.params,n)&&xT(i,n)}};function aot(e,t,r,i,s){let{property:n,computed:o}=e,c;if(!o)c=n.name;else if(Po(Tp,n))c=n.value;else try{sn(n,r,CF,e),c=r.param(n)}catch{r.error(e,USt)}return i(e,c,t,r,s),!1}var TF={...CF,VariableDeclarator:Ya("Variable declaration in operator call"),Identifier(e,t,r){dot(e,t,r)&&t.error(e,HSt)},CallExpression(e,t){let r=fot(e.callee);tN(r)?SF(e,r,t):t.error(e,lot,hot)}};function JSt(e,t){e.generator&&Ya("Generator functions")(e,t),e.async&&Ya("Async functions")(e,t);let{params:r}=e,i=r.length,s=o=>(c,f)=>t.columnRef.set(c,[f,o]),n=(o,c)=>t.paramsRef.set(o,c);i&&(t.join?(yT(t,r[0],"tuple1",s(1)),i>1&&yT(t,r[1],"tuple2",s(2)),i>2&&yT(t,r[2],"$param",n)):(yT(t,r[0],"tuple",s(0)),i>1&&yT(t,r[1],"$param",n))),t.root=e.body}function yT(e,t,r,i){Po(n0,t)?(e.scope.add(t.name),e[r]=t.name):Po(Q9,t)&&t.properties.forEach(s=>{let n=Po(n0,s.key)?s.key.name:Po(Tp,s.key)?s.key.value:e.error(s,LSt);Po(n0,s.value)||e.error(s.value,qSt),i(s.value.name,n)})}function tEt(e,t,r,i){let s=[],n=[],o=t.param[0]||0,c=o+(t.param[1]||0);return i.forEach((f,p)=>{p<o?(sn(f,e,TF),s.push(e.field(f))):p<c?(sn(f,e,TF),n.push(e.param(f))):e.error(f,VSt)}),{name:r,fields:s,params:n,...e.spec.window||{}}}function fot(e){return Po(n0,e)?e.name:Po(G9,e)?pot(e)?eEt(e.property.name):e.property.name:null}function pot(e){return Po(n0,e.object)&&e.object.name==="Math"}function eEt(e){return e==="max"?"greatest":e==="min"?"least":e}function dot(e,t,r){let{name:i}=e;if(!(Po(G9,r)&&r.property===e)){if(!(Po(AM,r)&&r.key===e))if(t.paramsRef.has(i))xT(e,t.paramsRef.get(i));else if(t.columnRef.has(i))mot(e,i,t,r);else if(ya(t.params,i))xT(e,i);else if(ya(lC,i))got(e,i);else return!0}}function Aot(e,t,r,i,s){let n=r===0?i.table:r>0?i.join[r-1]:null,o=n&&n.column(t);n&&!o&&i.error(e,IF),i.aggronly&&!i.$op&&i.error(e,zSt),yM(e,t,r,o,s)}function mot(e,t,r,i){let[s,n]=r.columnRef.get(t);Aot(e,s,n,r,i)}function rEt(e,t,r,i){i.params&&!ya(i.params,t)&&i.error(e,jSt),xT(e,t)}function xT(e,t){e.type=Irt,e.name=t}function got(e,t){e.type=Trt,e.name=t,e.raw=lC[t]}function SF(e,t,r){if(t===nx){let i=r.table;i||r.error(e,GSt),eN(e,e.arguments.length?e.arguments.map(s=>{let n=r.param(s),o=js(n)?i.columnName(n):n;return i.column(o)||r.error(s,IF),o}):i.columnNames())}else e.callee={type:Ert,name:t}}function EF(e,t){Po(n0,e)?t.scope.add(e.name):Po(xrt,e)?e.elements.forEach(r=>EF(r,t)):Po(Q9,e)?e.properties.forEach(r=>EF(r.value,t)):t.error(e.id,WSt)}var iEt={[om]:1,[mM]:1};function gs(e,t={}){let r=t.generate||K1,i=t.compiler||ix,s=sEt(t),n={},o={},c=[],f=[],p=0,x=-1,E=t.join?i.join:t.index==1?i.expr2:i.expr,T={op(z){let U=nEt(z);return o[U]||(z.id=++x,o[U]=z)},field(z){let U=r(z);return n[U]||(n[U]=++p)},param(z){return Po(Tp,z)?z.value:i.param(r(z),s)},value(z,U){c.push(z);let H=U.escape||(t.ast?dst(U):E(r(U),s));f.push(H),iEt[U.type]&&H!==U&&As(H)&&(H.field=U.name)},error(z,U,H=""){let G=z.start-6,Z=z.end-6,Y=String(T.spec).slice(G,Z);nr(`${U}: "${Y}"${H}`)}};Object.assign(T,t,{params:s});for(let[z,U]of am(e))T.value(z+"",U.escape?gst(T,U,s):MF(T,U));if(t.ast)return{names:c,exprs:f};let D=[];for(let z in n)D[n[z]]=i.expr(z,s);let N=Object.values(o);return N.forEach(z=>z.fields=z.fields.map(U=>D[U])),{names:c,exprs:f,ops:N}}function nEt(e){let t=`${e.name}(${e.fields.concat(e.params).join(",")})`;if(e.frame){let r=e.frame.map(i=>Number.isFinite(i)?Math.abs(i):-1);t+=`[${r},${!!e.peers}]`}return t}function sEt(e){return(e.table?PF(e.table):e.join?{...PF(e.join[1]),...PF(e.join[0])}:{})||{}}function PF(e){return e&&Ni(e.params)?e.params():{}}var cC="Expr",hu="ExprList",uC="ExprNumber",w_="ExprObject",Tm="JoinKeys",qx="JoinValues",Cc="Options",bT="OrderKeys",Wp="SelectionList",k0="TableRef",Sm="TableRefList",_ot="Descending",yot="Query",xot="Selection",bot="Verb",vot="Window";function Em(e,t){return e&&e.expr?new hC({...e,...t}):new hC(t,e)}var hC=class{constructor(t,r){this.expr=r,Object.assign(this,t)}toString(){return String(this.expr)}toObject(){return{...this,expr:this.toString(),...Ni(this.expr)?{func:!0}:{}}}};function fC(e){return Em(e,{desc:!0})}function fu(e,t,r=0){let i=r?{field:!0,table:r}:{field:!0};return Em(e,t?{expr:t,...i}:i)}function Yx(e,t,r){return Em(e,{window:{frame:t||[-1/0,0],peers:!!r}})}function oEt(e){let t=r=>r;return t.toString=()=>e,t}function RF(e,t){return t=t&&Ni(t.query)?t.query():t,t&&Ni(t.evaluate)?t.evaluate(null,e):e(t)}function kF(e){return As(e)&&(oi(e.all)||oi(e.matches)||oi(e.not)||oi(e.range))}function T_(e){return e&&Ni(e.toObject)?e.toObject():Ni(e)?{expr:String(e),func:!0}:oi(e)?e.map(T_):As(e)?b_(e,t=>T_(t)):e}function pC(e){return oi(e)?e.map(pC):As(e)?oi(e.verbs)?Pc.from(e):oi(e.all)?uu():oi(e.range)?Q8(...e.range):oi(e.match)?Vx(RegExp(...e.match)):oi(e.not)?Ux(e.not.map(T_)):aEt(e):e}function aEt(e){let t=e,r=e.expr;if(r!=null){if(e.field===!0?t=r=fu(r):e.func===!0&&(t=r=oEt(r)),As(e.window)){let{frame:i,peers:s}=e.window;t=r=Yx(r,i,s)}e.desc===!0&&(t=fC(r))}return e===t?b_(e,i=>pC(i)):t}function wot(e){return oi(e)?e.map(lEt):e}function lEt(e){let t=[];return Vs(e).forEach(r=>{js(r)?t.push(r):On(r)?t.push(fu(r,null)):As(r)&&r.expr||Ni(r)?t.push(r):nr(`Invalid key value: ${r+""}`)}),t}function Tot(e){return oi(e)?e.map(cEt):e}function cEt(e,t){return t<2?Vs(e):e}function Sot(e){let t=[];return e.forEach(r=>{let i=r.expr!=null?r.expr:r;if(As(i)&&!Ni(i))for(let s in i)t.push(i[s]);else r=js(i)?i:On(i)?fu(r):Ni(i)?r:nr(`Invalid orderby field: ${r+""}`),t.push(r)}),t}var uEt={[cC]:Rot,[hu]:Xx,[uC]:AEt,[w_]:Im,[Tm]:mEt,[qx]:gEt,[bT]:Xx,[Wp]:pEt};function Iot(e,t,r){return t===k0?Eot(e):t===Sm?e.map(Eot):Mot(T_(e),t,r)}function Mot(e,t,r){return t===Cc?e&&hEt(e,r):uEt[t](e)}function hEt(e,t={}){let r={};for(let i in e){let s=e[i];r[i]=t[i]?Mot(s,t[i]):s}return r}function fEt(e,t){return gs({expr:e},{...t,ast:!0}).exprs[0]}function DF(e){return{type:om,name:e}}function Cot(e){return{type:om,index:e}}function Im(e,t){if(On(e))return fEt(e,t);if(e.expr){let r;if(e.field===!0?r=DF(e.expr):e.func===!0&&(r=Im(e.expr,t)),r)return e.desc&&(r={type:_ot,expr:r}),e.window&&(r={type:vot,expr:r,...e.window}),r}return Object.keys(e).map(r=>({...Im(e[r],t),as:r}))}function Pot(e){let t=xot;return e.all?{type:t,operator:"all"}:e.not?{type:t,operator:"not",arguments:Xx(e.not)}:e.range?{type:t,operator:"range",arguments:Xx(e.range)}:e.matches?{type:t,operator:"matches",arguments:e.matches}:nr("Invalid input")}function pEt(e){return Vs(e).map(dEt).flat()}function dEt(e){return kF(e)?Pot(e):js(e)?Cot(e):On(e)?DF(e):As(e)?Object.keys(e).map(t=>({type:om,name:t,as:e[t]})):nr("Invalid input")}function Rot(e){return kF(e)?Pot(e):js(e)?Cot(e):On(e)?DF(e):As(e)?Im(e):nr("Invalid input")}function Xx(e){return Vs(e).map(Rot).flat()}function AEt(e){return js(e)?e:Im(e)}function mEt(e){return oi(e)?e.map(Xx):Im(e,{join:!0})}function gEt(e){return oi(e)?e.map((t,r)=>r<2?Xx(t):Im(t,{join:!0})):Im(e,{join:!0})}function Eot(e){return e&&Ni(e.toAST)?e.toAST():e}var S_=class{constructor(t,r=[],i=[]){this.verb=t,this.schema=r,r.forEach((s,n)=>{let o=s.type,c=i[n],f=o===Tm?wot(c):o===qx?Tot(c):o===bT?Sot(c):c;this[s.name]=f!==void 0?f:s.default})}static from(t){let r=Mm[t.verb],i=(r.schema||[]).map(({name:s})=>pC(t[s]));return r(...i)}evaluate(t,r){let i=this.schema.map(({name:s,type:n})=>{let o=this[s];return n===k0?RF(r,o):n===Sm?o.map(c=>RF(r,c)):o});return t[this.verb](...i)}toObject(){let t={verb:this.verb};return this.schema.forEach(({name:r})=>{t[r]=T_(this[r])}),t}toAST(){let t={type:bot,verb:this.verb};return this.schema.forEach(({name:r,type:i,props:s})=>{t[r]=Iot(this[r],i,s)}),t}};function Yn(e,t){return Object.assign((...r)=>new S_(e,t,r),{schema:t})}var Mm={count:Yn("count",[{name:"options",type:Cc}]),derive:Yn("derive",[{name:"values",type:w_},{name:"options",type:Cc,props:{before:Wp,after:Wp}}]),filter:Yn("filter",[{name:"criteria",type:w_}]),groupby:Yn("groupby",[{name:"keys",type:hu}]),orderby:Yn("orderby",[{name:"keys",type:bT}]),relocate:Yn("relocate",[{name:"columns",type:Wp},{name:"options",type:Cc,props:{before:Wp,after:Wp}}]),rename:Yn("rename",[{name:"columns",type:Wp}]),rollup:Yn("rollup",[{name:"values",type:w_}]),sample:Yn("sample",[{name:"size",type:uC},{name:"options",type:Cc,props:{weight:cC}}]),select:Yn("select",[{name:"columns",type:Wp}]),ungroup:Yn("ungroup"),unorder:Yn("unorder"),reify:Yn("reify"),dedupe:Yn("dedupe",[{name:"keys",type:hu,default:[]}]),impute:Yn("impute",[{name:"values",type:w_},{name:"options",type:Cc,props:{expand:hu}}]),fold:Yn("fold",[{name:"values",type:hu},{name:"options",type:Cc}]),pivot:Yn("pivot",[{name:"keys",type:hu},{name:"values",type:hu},{name:"options",type:Cc}]),spread:Yn("spread",[{name:"values",type:hu},{name:"options",type:Cc}]),unroll:Yn("unroll",[{name:"values",type:hu},{name:"options",type:Cc,props:{drop:hu}}]),lookup:Yn("lookup",[{name:"table",type:k0},{name:"on",type:Tm},{name:"values",type:hu}]),join:Yn("join",[{name:"table",type:k0},{name:"on",type:Tm},{name:"values",type:qx},{name:"options",type:Cc}]),cross:Yn("cross",[{name:"table",type:k0},{name:"values",type:qx},{name:"options",type:Cc}]),semijoin:Yn("semijoin",[{name:"table",type:k0},{name:"on",type:Tm}]),antijoin:Yn("antijoin",[{name:"table",type:k0},{name:"on",type:Tm}]),concat:Yn("concat",[{name:"tables",type:Sm}]),union:Yn("union",[{name:"tables",type:Sm}]),intersect:Yn("intersect",[{name:"tables",type:Sm}]),except:Yn("except",[{name:"tables",type:Sm}])};function Dot(e){return new Pc(null,null,e)}function Bot(e){return Pc.from(e)}var Pc=class e extends e0{constructor(t,r,i){super(r),this._verbs=t||[],this._table=i}static from({verbs:t,table:r,params:i}){return new e(t.map(S_.from),i,r)}get[Symbol.toStringTag](){return this._verbs?`Query: ${this._verbs.length} verbs`+(this._table?` on '${this._table}'`:""):"Object"}get length(){return this._verbs.length}get tableName(){return this._table}params(t){return arguments.length?(this._params={...this._params,...t},this):this._params}evaluate(t,r){t=t||r(this._table);for(let i of this._verbs)t=i.evaluate(t.params(this._params),r);return t}toObject(){return kot(this,"toObject")}toJSON(){return this.toObject()}toAST(){return kot(this,"toAST",{type:yot})}};function kot(e,t,r){return{...r,verbs:e._verbs.map(i=>i[t]()),...e._params?{params:e._params}:null,...e._table?{table:e._table}:null}}function Oot(e,t){return new Pc(e._verbs.concat(t),e._params,e._table)}function Not(e,t){Pc.prototype[e]=function(...r){return Oot(this,t(...r))}}for(let e in Mm){let t=Mm[e];Pc.prototype["__"+e]=function(r,...i){return Oot(r,t(...i))}}var Fot={name:"arquero",version:"5.4.1",description:"Query processing and transformation of array-backed data tables.",keywords:["data","query","database","table","dataframe","transform","arrays"],license:"BSD-3-Clause",author:"Jeffrey Heer (http://idl.cs.washington.edu)",main:"dist/arquero.node.js",module:"src/index-node.js",unpkg:"dist/arquero.min.js",jsdelivr:"dist/arquero.min.js",types:"dist/types/index.d.ts",browser:{"./dist/arquero.node.js":"./dist/arquero.min.js","./src/index-node.js":"./src/index.js"},repository:{type:"git",url:"https://github.com/uwdata/arquero.git"},scripts:{prebuild:"rimraf dist && mkdir dist",build:"rollup -c rollup.config.mjs",postbuild:"tsc",preperf:"npm run build",perf:"TZ=America/Los_Angeles tape 'perf/**/*-perf.js'",lint:"eslint src test",test:"TZ=America/Los_Angeles tape 'test/**/*-test.js' --require esm",prepublishOnly:"npm test && npm run lint && npm run build"},dependencies:{acorn:"^8.12.0","apache-arrow":"^15.0.2","node-fetch":"^2.7.0"},devDependencies:{"@rollup/plugin-json":"^6.1.0","@rollup/plugin-node-resolve":"^15.2.3","@rollup/plugin-terser":"^0.4.4",eslint:"^9.5.0",esm:"^3.2.25",rimraf:"^5.0.7",rollup:"^4.18.0","rollup-plugin-bundle-size":"^1.0.3",tape:"^5.8.1",typescript:"^5.5.2"},esm:{force:!0,mainFields:["module","main"]}};function Lot(e){let{data:t,length:r,nullCount:i}=e,s=t[t.length-1].dictionary,n=s.length,o=yEt(t||[e],r,i,n),c=Array(n),f=p=>p==null||p<0||p>=n?null:c[p]!==void 0?c[p]:c[p]=s.get(p);return{vector:e,length:r,get:p=>f(o[p]),key:p=>o[p],keyFor(p){if(p===null)return i?n:-1;for(let x=0;x<n;++x)if(c[x]===void 0&&(c[x]=s.get(x)),c[x]===p)return x;return-1},groups(p){let x=n+(i?1:0);return{keys:o,get:[f],names:p,rows:dM(0,x),size:x}},[Symbol.iterator](){return e[Symbol.iterator]()}}}function yEt(e,t,r,i){let s=e.length>1||r?xEt(e,t,e[0].type.indices):e[0].values;return r?bEt(e,s,i):s}function xEt(e,t,r){let i=new r.ArrayType(t),s=e.length;for(let n=0,o=0,c;n<s;++n)c=e[n].length,i.set(e[n].values.subarray(0,c),o),o+=c;return i}function bEt(e,t,r){let i=e.length;for(let s=0,n=0,o,c,f,p;s<i;++s){if(f=e[s].nullBitmap,o=e[s].length>>3,f&&f.length)for(let x=0;x<=o;++x)(p=f[x])!==255&&(c=n+(x<<3),p&1||(t[c+0]=r),p&2||(t[c+1]=r),p&4||(t[c+2]=r),p&8||(t[c+3]=r),p&16||(t[c+4]=r),p&32||(t[c+5]=r),p&64||(t[c+6]=r),p&128||(t[c+7]=r));n+=e[s].length}return t}function Rc(e,t,...r){let i=["_","$"],s=i.slice(0,r.length);return s.push('"use strict"; const '+r.map((n,o)=>n.map((c,f)=>`${i[o]}${f} = ${i[o]}[${f}]`).join(", ")).join(", ")+`; return (${e}) => ${t};`),Function(...s)(...r)}var zot=({typeId:e})=>e===-1,Uot=({typeId:e})=>e===5,Vot=({typeId:e})=>e===12,jot=({typeId:e})=>e===13,$ot=({typeId:e})=>e===16;var vEt=e=>Vot(e)||$ot(e);function dC(e,t){let{type:r,length:i,numChildren:s}=e;if(zot(r))return Lot(e);let n=s&&t?BF(e):s?Hot(BF(e)):Uot(r)?Hot(o=>e.get(o)):null;return n?{vector:e,length:i,get:n,[Symbol.iterator]:()=>wEt(i,n)}:e}function Hot(e){let t=[];return r=>{let i=t[r];return i!==void 0?i:t[r]=e(r)}}function*wEt(e,t){for(let r=0;r<e;++r)yield t(r)}var Wot=e=>e.numChildren?Ku(e.length,BF(e)):e.nullCount?[...e]:e.toArray(),BF=e=>vEt(e.type)?TEt(e):jot(e.type)?SEt(e):nr(`Unsupported Arrow type: ${Ds(e.VectorName)}`),TEt=e=>e.nullCount?t=>e.isValid(t)?Wot(e.get(t)):null:t=>Wot(e.get(t));function SEt(e){let t=[],r=[];e.type.children.forEach((s,n)=>{t.push(dC(e.getChildAt(n),!0)),r.push(`${Ds(s.name)}:_${n}.get(row)`)});let i=Rc("row","({"+r+"})",t);return e.nullCount?s=>e.isValid(s)?i(s):null:i}function AC(e,t={}){e&&!e.batches&&(e=Qnt()(e));let r=e.schema.fields.map(n=>n.name),i=Wa({columnNames:n=>n?r.filter(n):r.slice(),columnIndex:n=>r.indexOf(n)},t.columns||uu()),s=ms();return i.forEach((n,o)=>{s.add(n,dC(e.getChild(o)))}),new qa(s.data,s.names)}var vT=e=>e;var EEt=[e=>e==="true"||e==="false",e=>e!=="false"],qot=[e=>e==="NaN"||(e=+e)===e,e=>+e],IEt=[K2,e=>new Date(Date.parse(e))];function MEt(e){let{decimal:t}=e;return t&&t!=="."?qot.map(r=>i=>r(i&&i.replace(t,"."))):qot}function Yot(e,t){let r=[EEt,MEt(t),IEt],i=r.length;for(let s=0;s<i;++s){let[n,o]=r[s];if(CEt(e,n))return o}return vT}function CEt(e,t){let r=e.length;for(let i=0;i<r;++i){let s=e[i];if(s!=null&&!t(s))return!1}return!0}function Xot(e,t=0){return Ku(e-t,r=>`col${r+t+1}`)}function mC(e,t,r){let i=e(),s=i.length,n=+r.autoMax||1e3,o=Ku(s,()=>[]);t=t?t.length<s?[...t,Xot(s,t.length)]:t:Xot(s);let c=0;for(;c<n&&i;++c,i=e())for(let x=0;x<s;++x)o[x].push(i[x]===""?null:i[x]);let f=PEt(t,o,r);for(f.forEach((x,E)=>{if(x===vT)return;let T=o[E];for(let D=0;D<c;++D)T[D]!=null&&(T[D]=x(T[D]))});i;i=e())for(let x=0;x<s;++x)o[x].push(i[x]?f[x](i[x]):null);let p={};return t.forEach((x,E)=>p[x]=o[E]),new qa(p,t)}function PEt(e,t,r){let{parse:i={}}=r,s=r.autoType===!1;return e.map((n,o)=>Ni(i[n])?i[n]:s?vT:Yot(t[o],r))}var OF={},gC={};function _C(e,t,r){let i=+t||0;for(;--i>=0;)e();return r?()=>{let s;for(;!s;)if(r(s=e()))s=null;else return s}:e}function Zot(e,{delimiter:t=",",skip:r,comment:i}){t.length!==1&&nr(`Text "delimiter" should be a single character, found "${t}"`);let s=t.charCodeAt(0),n=e.length,o=0,c,f=n<=0,p=!1;e.charCodeAt(n-1)===10&&--n,e.charCodeAt(n-1)===13&&--n;function x(){if(f)return gC;if(p)return p=!1,OF;let T=o,D,N;if(e.charCodeAt(T)===34){for(;o++<n&&e.charCodeAt(o)!==34||e.charCodeAt(++o)===34;);return(D=o)>=n?f=!0:(N=e.charCodeAt(o++))===10?p=!0:N===13&&(p=!0,e.charCodeAt(o)===10&&++o),e.slice(T+1,D-1).replace(/""/g,'"')}for(;o<n;){if((N=e.charCodeAt(D=o++))===10)p=!0;else if(N===13)p=!0,e.charCodeAt(o)===10&&++o;else if(N!==s)continue;return e.slice(T,D)}return f=!0,e.slice(T,n)}function E(){if((c=x())!==gC){let T=[];for(;c!==OF&&c!==gC;)T.push(c),c=x();return T}}return _C(E,r,i&&(T=>(T&&T[0]||"").startsWith(i)))}function wT(e,t={}){let r=Zot(e,t);return mC(r,t.header!==!1?r():t.names,t)}function Got(e,{skip:t,comment:r}){let i=e.length,s=0;e.charCodeAt(i-1)===10&&--i,e.charCodeAt(i-1)===13&&--i;function n(){if(s>=i)return;let o=s,c=!1,f,p;for(;s<i;)if((p=e.charCodeAt(f=s++))===10?c=!0:p===13&&(c=!0,e.charCodeAt(s)===10&&++s),c)return e.slice(o,f);return e.slice(o,i)}return _C(n,t,r&&(o=>(o||"").startsWith(r)))}function yC(e,t={}){let r=Got(e,t),i=REt(t);return mC(()=>{let s=r();if(s)return i.map(([n,o])=>s.slice(n,o).trim())},t.names,t)}function REt({positions:e,widths:t}){!e&&!t&&nr('Fixed width files require a "positions" or "widths" option');let r=0;return e||t.map(i=>[r,r+=i])}function Qot(e){let t=e.length;for(let r=0;r<t;++r){let i=e.charCodeAt(r);if(i<48||i>57)return!1}return!0}function xC(e,t={}){let r=Y8(t.autoType);On(e)&&(e=JSON.parse(e));let i=e.data,s;if(As(i)&&!Jc(i)?e.schema&&e.schema.fields&&(s=e.schema.fields.map(n=>n.name)):i=e,r||t.parse){let n=t.parse||{};for(let o in i){let c=i[o],f=c.length;if(n[o])for(let p=0;p<f;++p)c[p]=n[o](c[p]);else if(r)for(let p=0;p<f;++p){let x=c[p];On(x)&&K2(x)&&!Qot(x)&&(c[p]=new Date(x))}}}return new qa(i,s)}function Kot(e,t=[]){return e.groupby(t.length?t:e.columnNames()).filter("row_number() === 1").ungroup().reify()}function Gx(e,t){let r=ms();return t.forEach((i,s)=>{let n=On(i)?i:s;if(n){let o=e.column(s)||nr(`Unrecognized column: ${s}`);r.add(n,o)}}),e.create(r)}function bC(e,t,{before:r,after:i}={}){let s=r!=null,n=i!=null;s||n||nr("relocate requires a before or after option."),s&&n&&nr("relocate accepts only one of the before or after options."),t=Wa(e,t);let o=[...Wa(e,s?r:i).keys()],c=s?o[0]:o.pop(),f=new Map;return e.columnNames().forEach(p=>{let x=!t.has(p);if(p===c){n&&x&&f.set(p,p);for(let[E,T]of t)f.set(E,T);if(n)return}x&&f.set(p,p)}),Gx(e,f)}function qp(e,t=i=>i,r=""){let i=e.length;if(!i)return"";let s=t(e[0],0);for(let n=1;n<i;++n)s+=r+t(e[n],n);return s}function Qx(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Jot(e,t=0,r=e.length){let i=r?e[t++]:ji;for(let s=t;s<r;++s)i>e[s]&&(i=e[s]);return i}function tat(e,t=0,r=e.length){let i=r?e[t++]:ji;for(let s=t;s<r;++s)i<e[s]&&(i=e[s]);return i}function TT(e){return i0(e)?e:+e}function FF(e,t){let r=e.length;if(!r)return ji;if((t=+t)<=0||r<2)return TT(e[0]);if(t>=1)return TT(e[r-1]);let i=(r-1)*t,s=Math.floor(i),n=TT(e[s]);return i0(n)?n:n+(TT(e[s+1])-n)*(i-s)}var ST=class{constructor(t){this._values=t||[],this._sorted=null,this._start=0}values(t){return this._start&&(this._values=this._values.slice(this._start),this._start=0),t?this._values.slice():this._values}add(t){this._values.push(t),this._sorted=null}rem(){this._start+=1,this._sorted=null}min(){return this._sorted&&this._sorted.length?this._sorted[0]:Jot(this._values,this._start)}max(){return this._sorted&&this._sorted.length?this._sorted[this._sorted.length-1]:tat(this._values,this._start)}quantile(t){return this._sorted||(this._sorted=this.values(!0),this._sorted.sort(Qx)),FF(this._sorted,t)}};var vC=(e,t,r)=>Rc(t,"{"+qp(e,(i,s)=>`_${s}.${r}(${t});`)+"}",e);function eat(e,t){let{ops:r,output:i}=kEt(e,t),s=e[0].fields,n=s.length,o=n===0?ET:n===1?LF:n===2?zF:nr("Unsupported field count: "+n);return new o(s,r,i,t)}function kEt(e,t){let r={},i=[];function s(o,c=[]){let f=o+":"+c;if(r[f])return r[f];let p=gM(o),x=p.create(...c);return t<0&&p.stream&&p.stream.forEach(E=>s(E,[])),p.req&&p.req.forEach(E=>s(E,[])),r[f]=x,i.push(x),x}let n=e.map(o=>{let c=s(o.name,o.params);return c.output=o.id,c});return{ops:i,output:n}}var ET=class extends v_{constructor(t,r,i,s){super(i),this._op=r,this._fields=t,this._stream=!!s}init(){let t={count:0,valid:0,stream:this._stream};return this._op.forEach(r=>r.init(t)),t.values&&(t.list=new ST),t}write(t,r,i){let s=this._outputs,n=s.length;for(let o=0;o<n;++o)r[s[o].output][i]=s[o].value(t);return 1}_add(){}_rem(){}add(t){++t.count}rem(t){--t.count}},LF=class extends ET{constructor(t,r,i,s){super(t,r,i,s);let n=["state","v1","v2"];this._add=vC(r,n,"add"),this._rem=vC(r,n,"rem")}add(t,r,i){let s=this._fields[0](r,i);++t.count,Ua(s)&&(++t.valid,t.list&&t.list.add(s),this._add(t,s))}rem(t,r,i){let s=this._fields[0](r,i);--t.count,Ua(s)&&(--t.valid,t.list&&t.list.rem(),this._rem(t,s))}},zF=class extends ET{constructor(t,r,i,s){super(t,r,i,s);let n=["state","v1","v2"];this._add=vC(r,n,"add"),this._rem=vC(r,n,"rem")}add(t,r,i){let s=this._fields[0](r,i),n=this._fields[1](r,i);++t.count,Ua(s)&&Ua(n)&&(++t.valid,t.list&&t.list.add([s,n]),this._add(t,s,n))}rem(t,r,i){let s=this._fields[0](r,i),n=this._fields[1](r,i);--t.count,Ua(s)&&Ua(n)&&(--t.valid,t.list&&t.list.rem(),this._rem(t,s,n))}};function kc(e,t,r){if(t.length){let i=e.data(),{keys:s}=e.groups()||{},n=Yp(e,t),o=s?(c,f)=>n[c][s[f]]:c=>n[c][0];r=r.map(c=>f=>c(f,i,o))}return r}function Yp(e,t,r){if(!t.length)return r;let i=UF(t),s=e.groups(),n=s?s.size:1;return r=r||Ku(t.length,()=>Array(n)),n>1?i.forEach(o=>{let c=jF(e,o,s);for(let f=0;f<n;++f)o.write(c[f],r,f)}):i.forEach(o=>{let c=VF(e,o);o.write(c,r,0)}),r}function UF(e,t){let r=[],i={};for(let s of e){let n=s.fields.map(o=>o+"").join(",");(i[n]||(i[n]=[])).push(s)}for(let s in i)r.push(eat(i[s],t));return r}function VF(e,t){let r=t.init(),i=e.totalRows(),s=e.data(),n=e.mask();if(e.isOrdered()){let o=e.indices();for(let c=0;c<i;++c)t.add(r,o[c],s)}else if(n)for(let o=n.next(0);o>=0;o=n.next(o+1))t.add(r,o,s);else for(let o=0;o<i;++o)t.add(r,o,s);return r}function jF(e,t,r){let{keys:i,size:s}=r,n=Ku(s,()=>t.init()),o=e.data();if(e.isOrdered()){let c=e.indices(),f=c.length;for(let p=0;p<f;++p){let x=c[p];t.add(n[i[x]],x,o)}}else if(e.isFiltered()){let c=e.mask();for(let f=c.next(0);f>=0;f=c.next(f+1))t.add(n[i[f]],f,o)}else{let c=e.totalRows();for(let f=0;f<c;++f)t.add(n[i[f]],f,o)}return n}function wC(e,t){let{get:r,names:i,rows:s,size:n}=t,o=i.length;for(let c=0;c<o;++c){let f=e.add(i[c],Array(n)),p=r[c];for(let x=0;x<n;++x)f[x]=p(s[x])}}function TC(e){return{left(t,r,i,s){for(i==null&&(i=0),s==null&&(s=t.length);i<s;){let n=i+s>>>1;e(t[n],r)<0?i=n+1:s=n}return i},right(t,r,i,s){for(i==null&&(i=0),s==null&&(s=t.length);i<s;){let n=i+s>>>1;e(t[n],r)>0?s=n:i=n+1}return i}}}var rat=TC(Qx);function iat(e,t,r,i,s){let n,o,c,f,p,x=z=>o[z-1]===o[z],E=i.length,T=s.length,D=i.length?Rc(["w","r","k"],"{"+qp(i,(z,U)=>`r[_${U}.id][k]=_${U}.value(w,_${U}.get);`)+"}",i):()=>{},N={i0:0,i1:0,index:0,size:0,peer:x,init(z,U,H,G){N.index=N.i0=N.i1=0,N.size=U.length,n=z,o=U,f=H,p=G,c=s?s.map(Z=>Z.init()):null;for(let Z=0;Z<E;++Z)i[Z].init();return N},value(z,U){return U(n[z],e)},step(z){let[U,H]=t,G=N.size,Z=N.i0,Y=N.i1;N.i0=U!=null?Math.max(0,z-Math.abs(U)):0,N.i1=H!=null?Math.min(G,z+Math.abs(H)+1):G,N.index=z,r&&(N.i0>0&&x(N.i0)&&(N.i0=rat.left(o,o[N.i0])),N.i1<G&&x(N.i1)&&(N.i1=rat.right(o,o[N.i1-1])));for(let st=0;st<T;++st){let at=s[st],Dt=c[st];for(let Tt=Z;Tt<N.i0;++Tt)at.rem(Dt,n[Tt],e);for(let Tt=Y;Tt<N.i1;++Tt)at.add(Dt,n[Tt],e);at.write(Dt,f,p)}return D(N,f,p),f}};return N}var DEt=e=>(e.frame||[null,null]).map(t=>Number.isFinite(t)?Math.abs(t):null),BEt=e=>!!e.peers;function OEt(e){let{id:t,name:r,fields:i=[],params:s=[]}=e,n=_M(r).create(...s);return i.length&&(n.get=i[0]),n.id=t,n}function nat(e,t,r,i={},s){let n=e.data(),o=NEt(s,n),c=o.length,f=Rc(["r","d","op"],"{"+qp(t,(p,x)=>`_${x}[r] = $${x}(r, d, op);`)+"}",t,r);e.partitions().forEach((p,x)=>{let E=p.length,T=FEt(e,p);for(let N=0;N<c;++N)o[N].init(p,T,i,x);let D=N=>i[N][x];for(let N=0;N<E;++N){for(let z=0;z<c;++z)o[z].step(N);f(p[N],n,D)}})}function NEt(e,t){let r={};return e.forEach(i=>{let s=DEt(i),n=BEt(i),o=`${s},${n}`,{aggOps:c,winOps:f}=r[o]||(r[o]={frame:s,peers:n,aggOps:[],winOps:[]});c4(i.name)?c.push(i):f.push(OEt(i))}),Object.values(r).map(i=>iat(t,i.frame,i.peers,i.winOps,UF(i.aggOps,i.frame[0]!=null?-1:1)))}function FEt(e,t){if(e.isOrdered()){let r=e.comparator(),i=e.data(),s=t.length,n=new Uint32Array(s);for(let o=1,c=0;o<s;++o)n[o]=r(t[o-1],t[o],i)?++c:c;return n}else return t}function LEt(e){return u4(e.name)||e.frame&&(Number.isFinite(e.frame[0])||Number.isFinite(e.frame[1]))}function Kx(e,{names:t,exprs:r,ops:i},s={}){let n=e.totalRows(),o=ms(s.drop?null:e),c=t.map(T=>o.add(T,Array(n))),[f,p]=zEt(i),x=e.isGrouped()?e.groups().size:1,E=Yp(e,f,Ku(i.length,()=>Array(x)));return p.length?nat(e,c,r,E,p):UEt(e,c,r,E),e.create(o)}function zEt(e){let t=[],r=[],i=e.length;for(let s=0;s<i;++s){let n=e[s];n.id=s,(LEt(n)?r:t).push(n)}return[t,r]}function UEt(e,t,r,i){let s=e.mask(),n=e.data(),{keys:o}=e.groups()||{},c=o?(p,x)=>i[p][o[x]]:p=>i[p][0],f=t.length;for(let p=0;p<f;++p){let x=r[p],E=t[p];if(s)for(let T=s.next(0);T>=0;T=s.next(T+1))E[T]=x(T,n,c);else{let T=e.totalRows();for(let D=0;D<T;++D)E[D]=x(D,n,c)}}}function sat(e,t,r={}){let i=Kx(e,gs(t,{table:e}),r);return r.drop||r.before==null&&r.after==null?i:bC(i,Object.keys(t).filter(s=>!e.column(s)),r)}function oat(e,t){if(t.length===0)return e;let r=e.columnNames();return t.reduce((i,s)=>i.antijoin(s.select(r)),e).dedupe()}var E_=class{constructor(t){this._size=t,this._bits=new Uint32Array(Math.ceil(t/32))}get length(){return this._size}count(){let t=this._bits.length,r=0;for(let i=0;i<t;++i)for(let s=this._bits[i];s;++r)s&=s-1;return r}get(t){return this._bits[t>>5]&2147483648>>>t}set(t){this._bits[t>>5]|=2147483648>>>t}clear(t){this._bits[t>>5]&=~(2147483648>>>t)}scan(t){for(let r=this.next(0);r>=0;r=this.next(r+1))t(r)}next(t){let r=this._bits,i=r.length,s=t>>5,n=r[s]&4294967295>>>t;for(;s<i;n=r[++s])if(n!==0)return(s<<5)+Math.clz32(n);return-1}nth(t){let r=this.next(0);for(;t--&&r>=0;)r=this.next(r+1);return r}not(){let t=this._bits,r=t.length;for(let s=0;s<r;++s)t[s]=~t[s];let i=this._size%32;return i&&(t[r-1]&=2147483648>>i-1),this}and(t){if(t){let r=this._bits,i=t._bits,s=r.length;for(let n=0;n<s;++n)r[n]&=i[n]}return this}or(t){if(t){let r=this._bits,i=t._bits,s=r.length;for(let n=0;n<s;++n)r[n]|=i[n]}return this}};function aat(e,t){let r=e.totalRows(),i=e.mask(),s=e.data(),n=new E_(r);if(i)for(let o=i.next(0);o>=0;o=i.next(o+1))t(o,s)&&n.set(o);else for(let o=0;o<r;++o)t(o,s)&&n.set(o);return e.create({filter:n})}function lat(e,t){let r=gs({p:t},{table:e}),i=r.exprs[0];if(r.ops.length){let{data:s}=Kx(e,r,{drop:!0}).column("p");i=n=>s[n]}return aat(e,i)}function SC(e,{names:t=[],exprs:r=[],ops:i=[]},s={}){if(!t.length)return e;let n=s.limit>0?+s.limit:1/0,o=s.index?s.index===!0?"index":s.index+"":null,c=new Set(s.drop),f=kc(e,i,r),p=ms(),x=new Set(t),E=[],T=[],D=[];e.columnNames().forEach(Y=>{if(!c.has(Y)){let st=p.add(Y,[]);x.has(Y)||(E.push(e.column(Y)),T.push(st))}}),t.forEach(Y=>{c.has(Y)||(p.has(Y)||p.add(Y,[]),D.push(p.data[Y]))});let N=o?p.add(o,[]):null,z=0,U=E.length,H=D.length,G=(Y,st)=>{for(let at=0;at<U;++at)T[at].length=z+st,T[at].fill(E[at].get(Y),z,z+st)},Z=N?(Y,st)=>{for(let at=0;at<st;++at)N[Y+at]=at}:()=>{};if(H===1){let Y=f[0],st=D[0];e.scan((at,Dt)=>{let Tt=Vs(Y(at,Dt)),kt=Math.min(Tt.length,n);G(at,kt);for(let Et=0;Et<kt;++Et)st[z+Et]=Tt[Et];Z(z,kt),z+=kt})}else e.scan((Y,st)=>{let at=0,Dt=f.map(Tt=>{let kt=Vs(Tt(Y,st));return at=Math.min(Math.max(at,kt.length),n),kt});G(Y,at);for(let Tt=0;Tt<H;++Tt){let kt=D[Tt],Et=Dt[Tt];for(let Mt=0;Mt<at;++Mt)kt[z+Mt]=Et[Mt]}Z(z,at),z+=at});return e.create(p.new())}function cat(e,{names:t=[],exprs:r=[],ops:i=[]},s={}){if(t.length===0)return e;let[n="key",o="value"]=s.as||[],c=kc(e,i,r);return SC(e,{names:[n,o],exprs:[()=>t,(f,p)=>c.map(x=>x(f,p))]},{...s,drop:t})}function Jo(e,t,r,i={window:!1}){let s=new Map,n=o=>{o=js(o)?t.columnName(o):o,On(o)?s.set(o,fu(o)):Ni(o)?Wa(t,o).forEach(n):As(o)?X8(s,o):nr(`Invalid ${e} value: ${o+""}`)};return Vs(r).forEach(n),i.preparse&&i.preparse(s),gs(s,{table:t,...i})}function uat(e,t,r){return cat(e,Jo("fold",e,t),r)}function $F(e,t,r,i){let s=r&&r.length;return VEt(s?jEt(e,r,i):e,t,s)}function VEt(e,{names:t,exprs:r,ops:i},s){let n=kc(e,i,r),o=s?null:ms(e),c=e.totalRows();return t.forEach((f,p)=>{let x=e.column(f),E=s?x.data:o.add(f,Array(c)),T=n[p];e.scan(D=>{let N=x.get(D);E[D]=Ua(N)?N:T(D)})}),s?e:e.create(o)}function jEt(e,t,r){let i=e.groups(),s=e.data(),n=(i?i.names:[]).concat(t),o=(i?i.get:[]).concat(t.map(N=>e.getter(N))),c=new Set,f=t_(o);e.scan((N,z)=>c.add(f(N,z)));let p=e.columnNames(),x=ms(),E=p.map(N=>x.add(N,[]));p.forEach((N,z)=>{let U=s[N],H=E[z];e.scan(G=>H.push(U.get(G)))});let T=t_(o.map((N,z)=>U=>U[z])),D=Rc("v","{"+E.map((N,z)=>`_${z}.push(v[$${z}]);`).join("")+"}",E,p.map(N=>n.indexOf(N)));if(i){let N=i.keys.length,z=r.reduce((H,G)=>H*G.length,i.size),U=new Uint32Array(z+(N-c.size));U.set(i.keys),hat(i,r,(H,G)=>{c.has(T(H))||(D(H),U[N++]=G[0])}),x.groupby({...i,keys:U})}else hat(i,r,N=>{c.has(T(N))||D(N)});return e.create(x.new())}function hat(e,t,r){let i=e?e.get.length:0,s=e?1:0,n=s+t.length,o=new Int32Array(n),c=new Int32Array(n),f=[];if(e){let{get:x,rows:E,size:T}=e;o[0]=T,f.push((D,N)=>{let z=E[N];for(let U=0;U<i;++U)D[U]=x[U](z)})}t.forEach((x,E)=>{let T=E+i;o[E+s]=x.length,f.push((D,N)=>D[T]=x[N])});let p=Array(i+t.length);for(let x=0;x<n;++x)f[x](p,0);r(p,c);for(let x=n-1;x>=0;){let E=++c[x];E<o[x]?(f[x](p,E),r(p,c),x=n-1):(c[x]=0,f[x](p,0),--x)}}function Jx(e,{names:t,exprs:r,ops:i}){let s=ms(),n=e.groups();return n&&wC(s,n),$Et(t,r,n,Yp(e,i),s),e.create(s.new())}function $Et(e,t,r,i=[],s){if(!t.length)return;let n=r?r.size:1,o=(f,p)=>i[f][p],c=e.length;for(let f=0;f<c;++f){let p=t[f];if(p.field!=null)s.add(e[f],i[p.field]);else if(n>1){let x=s.add(e[f],Array(n));for(let E=0;E<n;++E)x[E]=p(E,null,o)}else s.add(e[f],[p(0,null,o)])}}function fat(e,t,r={}){if(t=gs(t,{table:e}),t.names.forEach(i=>e.column(i)?0:nr(`Invalid impute column ${Ds(i)}`)),r.expand){let i={preparse:HEt,aggronly:!0},s=Jo("impute",e,r.expand,i),n=Jx(e.ungroup(),s);return $F(e,t,s.names,s.names.map(o=>n.get(o,0)))}else return $F(e,t)}function HEt(e){e.forEach((t,r)=>t.field?e.set(r,q9(t+"")):0)}function pat(e,t){let r=e.columnNames();return t.length?t.reduce((i,s)=>i.semijoin(s.select(r)),e).dedupe():e.reify([])}function EC(e,t){let r=new Map;return e.scan((i,s)=>{let n=t(i,s);n!=null&&n===n&&r.set(n,i)}),r}function dat(e,t,r){let i=new Map,s=e.length;for(let n=0;n<s;++n){let o=e[n],c=r(o,t);c!=null&&c===c&&(i.has(c)?i.get(c).push(n):i.set(c,[n]))}return i}function WEt(e,t){let r=["i","a","j","b"];return Rc(r,"{"+qp(e,(i,s)=>`_${s}.push($${s}(${r}));`)+"}",e,t)}function Aat(e,t,r,{names:i,exprs:s},n={}){let o=e.data(),c=e.indices(!1),f=c.length,p=new Int32Array(f),x=t.data(),E=t.indices(!1),T=E.length,D=new Int32Array(T),N=i.length,z=ms(),U=Array(N),H=Array(N);for(let Y=0;Y<i.length;++Y)U[Y]=z.add(i[Y],[]),H[Y]=s[Y];let G=WEt(U,H);if((oi(r)?YEt:qEt)(G,r,o,x,c,E,p,D,f,T),n.left)for(let Y=0;Y<f;++Y)p[Y]||G(c[Y],o,-1,x);if(n.right)for(let Y=0;Y<T;++Y)D[Y]||G(-1,o,E[Y],x);return e.create(z.new())}function qEt(e,t,r,i,s,n,o,c,f,p){for(let x=0;x<f;++x){let E=s[x];for(let T=0;T<p;++T){let D=n[T];t(E,r,D,i)&&(e(E,r,D,i),o[x]=1,c[T]=1)}}}function YEt(e,[t,r],i,s,n,o,c,f,p,x){let E,T,D,N,z,U,H,G,Z=e;p>=x?(E=i,T=t,D=c,N=n,z=s,U=r,H=f,G=o):(E=s,T=r,D=f,N=o,z=i,U=t,H=c,G=n,Z=(at,Dt,Tt,kt)=>e(Tt,kt,at,Dt));let Y=dat(G,z,U),st=N.length;for(let at=0;at<st;++at){let Dt=N[at],Tt=Y.get(T(Dt,E));if(Tt){let kt=Tt.length;for(let Et=0;Et<kt;++Et){let Mt=Tt[Et];Z(Dt,E,G[Mt],z),H[Mt]=1}D[at]=1}}}function tb(e,t,r){let i=new Map;Vs(r).forEach((n,o)=>{n=js(n)?t.columnName(n):n,On(n)?i.set(o,fu(n)):Ni(n)||As(n)&&n.expr?i.set(o,n):nr(`Invalid ${e} key value: ${n+""}`)});let s=gs(i,{table:t,aggregate:!1,window:!1});return t_(s.exprs,!0)}function HF(e,t){let r=new Set(t);return e.filter(i=>r.has(i))}function eb(e,t,r){if(r)On(r)?r=[r,r]:oi(r)&&r.length===1&&(r=[r[0],r[0]]);else{let i=HF(e.columnNames(),t.columnNames());i.length||nr("Natural join requires shared column names."),r=[i,i]}return r}function IC(e,t,r,i){return r.length!==i.length&&nr("Mismatched number of join keys"),[tb("join",e,r),tb("join",t,i)]}var XEt={aggregate:!1,window:!1},ZEt={...XEt,index:1};function WF(e,t,r,i,s={}){r=eb(e,t,r);let n={join:[e,t]},o;if(oi(r)){let[c,f]=r.map(Vs);o=IC(e,t,c,f),i||(i=GEt(e,c,f,s))}else o=gs({on:r},n).exprs[0],i||(i=[uu(),uu()]);return Aat(e,t,o,QEt(e,t,i,n,s&&s.suffix),s)}function GEt(e,t,r,i){let s=[];t.forEach((o,c)=>On(o)&&o===r[c]?s.push(o):0);let n=Ux(s);if(i.left&&i.right){let o=new Set(s);return[e.columnNames().map(c=>{let f=`[${Ds(c)}]`;return o.has(c)?{[c]:`(a, b) => a${f} == null ? b${f} : a${f}`}:c}),n]}return i.right?[n,uu()]:[uu(),n]}function QEt(e,t,r,i,s=[]){if(oi(r)){let n,o,c,f=r.length;n=o=c={names:[],exprs:[]},f--&&(n=Jo("join",e,r[0],i)),f--&&(o=Jo("join",t,r[1],ZEt)),f--&&(c=gs(r[2],i));let p=new Set,x=new Set(n.names);return o.names.forEach(E=>{x.has(E)&&p.add(E)}),p.size&&(s[0]!==""&&mat(n.names,p,s[0]||"_1"),s[1]!==""&&mat(o.names,p,s[1]||"_2")),{names:n.names.concat(o.names,c.names),exprs:n.exprs.concat(o.exprs,c.exprs)}}else return gs(r,i)}function mat(e,t,r){e.forEach((i,s)=>t.has(i)?e[s]=i+r:0)}function gat(e,t,r,i={}){let s=new E_(e.totalRows());return(oi(r)?KEt:JEt)(s,e,t,r),i.anti&&s.not().and(e.mask()),e.create({filter:s})}function KEt(e,t,r,[i,s]){let n=EC(r,s);t.scan((o,c)=>{n.get(i(o,c))>=0&&e.set(o)})}function JEt(e,t,r,i){let s=t.numRows(),n=r.numRows(),o=t.data(),c=r.data();if(t.isFiltered()||r.isFiltered()){let f=t.indices(!1),p=r.indices(!1);for(let x=0;x<s;++x){let E=f[x];for(let T=0;T<n;++T)if(i(E,o,p[T],c)){e.set(E);break}}}else for(let f=0;f<s;++f)for(let p=0;p<n;++p)if(i(f,o,p,c)){e.set(f);break}}function qF(e,t,r,i){r=eb(e,t,r);let s=oi(r)?IC(e,t,...r.map(Vs)):gs({on:r},{join:[e,t]}).exprs[0];return gat(e,t,s,i)}function _at(e,t,[r,i],{names:s,exprs:n,ops:o}){let c=ms(e),f=e.totalRows();s.forEach(T=>c.add(T,Array(f).fill(ji)));let p=EC(t,i),x=Rc(["lr","rr","data"],"{"+qp(s,(T,D)=>`_[${D}][lr] = $[${D}](rr, data);`)+"}",s.map(T=>c.data[T]),kc(t,o,n)),E=t.data();return e.scan((T,D)=>{let N=p.get(r(T,D));N>=0&&x(T,N,E)}),e.create(c)}function yat(e,t,r,i){return r=eb(e,t,r),_at(e,t,[tb("lookup",e,r[0]),tb("lookup",t,r[1])],Jo("lookup",t,i))}var YF=(e,t)=>e??t;function xat(e,t,r,i={}){let{keys:s,keyColumn:n}=t6t(e,t,i),o=YF(i.valueSeparator,"_"),c=r.names.length>1?(p,x)=>x+o+s[p]:p=>s[p],f=s.map(p=>Yp(e,r.ops.map(x=>{if(x.name==="count"){let T=D=>p===n[D]?1:NaN;return T.toString=()=>p+":1",{...x,name:"sum",fields:[T]}}let E=x.fields.map(T=>{let D=(N,z)=>p===n[N]?T(N,z):NaN;return D.toString=()=>p+":"+T,D});return{...x,fields:E}})));return e.create(e6t(r,c,e.groups(),f))}function t6t(e,t,r){let i=r.limit>0?+r.limit:1/0,s=YF(r.sort,!0),n=YF(r.keySeparator,"_"),o=kc(e,t.ops,t.exprs),c=o.length===1?o[0]:(E,T)=>o.map(D=>D(E,T)).join(n),f=Array(e.totalRows());e.scan((E,T)=>f[E]=c(E,T));let p=Yp(e.ungroup(),[{id:0,name:"array_agg_distinct",fields:[E=>f[E]],params:[]}])[0][0],x=s?p.sort():p;return{keys:Number.isFinite(i)?x.slice(0,i):x,keyColumn:f}}function e6t({names:e,exprs:t},r,i,s){let n=i?i.size:1,o=ms(),c=s.length,f=e.length,p,x=(E,T)=>p[E][T];i&&wC(o,i);for(let E=0;E<f;++E){let T=t[E];if(T.field!=null)for(let D=0;D<c;++D)o.add(r(D,e[E]),s[D][T.field]);else if(n>1)for(let D=0;D<c;++D){p=s[D];let N=o.add(r(D,e[E]),Array(n));for(let z=0;z<n;++z)N[z]=T(z,null,x)}else for(let D=0;D<c;++D)p=s[D],o.add(r(D,e[E]),[T(0,null,x)])}return o.new()}function bat(e,t,r,i){return xat(e,Jo("fold",e,t),Jo("fold",e,r,{preparse:r6t,aggronly:!0}),i)}function r6t(e){e.forEach((t,r)=>t.field?e.set(r,$9(t+"")):0)}function vat(e,t){let r=new Map;return e.columnNames(i=>(r.set(i,i),0)),Gx(e,Wa(e,t,r))}function XF(e,t){return Jx(e,gs(t,{table:e,aggronly:!0,window:!1}))}function wat(e,t,r,i){return(t?i?n6t:i6t:i?o6t:s6t)(e.length,e,r,i)}function i6t(e,t,r){let i=r.length;for(let s=0;s<e;++s)t[s]=r[i*r0()|0];return t}function n6t(e,t,r,i){let s=r.length,n=new Float64Array(s),o=0;for(let f=0;f<s;++f)n[f]=o+=i(r[f]);let c=TC(Qx).right;for(let f=0;f<e;++f)t[f]=r[c(n,o*r0())];return t}function s6t(e,t,r){let i=r.length;if(e>=i)return r;for(let s=0;s<e;++s)t[s]=r[s];for(let s=e;s<i;++s){let n=s*r0();n<e&&(t[n|0]=r[s])}return t}function o6t(e,t,r,i){let s=r.length;if(e>=s)return r;let n=new Float32Array(s),o=new Uint32Array(s);for(let c=0;c<s;++c)o[c]=c,n[c]=-Math.log(r0())/i(r[c]);o.sort((c,f)=>n[c]-n[f]);for(let c=0;c<e;++c)t[c]=r[o[c]];return t}function Tat(e,t=0,r=e.length){let i=r-(t=+t);for(;i;){let s=r0()*i--|0,n=e[i+t];e[i+t]=e[s+t],e[s+t]=n}return e}function Sat(e,t,r,i={}){let{replace:s,shuffle:n}=i,o=e.partitions(!1),c=0;t=o.map((x,E)=>{let T=t(E);return c+=T=s?T:Math.min(x.length,T),T});let f=new Uint32Array(c),p=0;return o.forEach((x,E)=>{let T=t[E],D=f.subarray(p,p+=T);!s&&T===x.length?D.set(x):wat(D,s,x,r)}),n!==!1&&(o.length>1||!s)&&Tat(f),e.reify(f)}function Eat(e,t,r={}){return Sat(e,a6t(e,t),l6t(e,r.weight),r)}var Iat=e=>t=>e.get(t)||0;function a6t(e,t){return js(t)?()=>t:Iat(Jx(e,gs({size:t},{table:e,window:!1})).column("size"))}function l6t(e,t){return t==null?null:(t=js(t)?e.columnName(t):t,Iat(On(t)?e.column(t):Kx(e,gs({w:t},{table:e}),{drop:!0}).column("w")))}function Mat(e,t){return Gx(e,Wa(e,t))}function Cat(e,{names:t,exprs:r,ops:i=[]},s={}){if(t.length===0)return e;let n=t.length===1&&s.as||[],o=s.drop==null?!0:!!s.drop,c=s.limit==null?n.length||1/0:Math.max(1,+s.limit||1),f=kc(e,i,r),p=ms(),x=t.reduce((T,D,N)=>T.set(D,N),new Map),E=(T,D)=>{let N=c6t(e,f[T],c),z=N.length;for(let U=0;U<z;++U)p.add(n[U]||`${D}_${U+1}`,N[U])};return e.columnNames().forEach(T=>{x.has(T)?(o||p.add(T,e.column(T)),E(x.get(T),T),x.delete(T)):p.add(T,e.column(T))}),x.forEach(E),e.create(p)}function c6t(e,t,r){let i=e.totalRows(),s=[];return e.scan((n,o)=>{let c=Vs(t(n,o)),f=Math.min(c.length,r);for(;s.length<f;)s.push(Array(i).fill(ji));for(let p=0;p<f;++p)s[p][n]=c[p]}),s}function Pat(e,t,r){return Cat(e,Jo("spread",e,t),r)}function Rat(e,t){return e.concat(t).dedupe()}function kat(e,t,r){return SC(e,Jo("unroll",e,t),r&&r.drop?{...r,drop:Jo("unroll",e,r.drop).names}:r)}function Dat(e,t){return e.create({groups:u6t(e,t)})}function u6t(e,{names:t=[],exprs:r=[],ops:i=[]}){let s=t.length;if(s===0)return null;if(s===1&&!e.isFiltered()&&r[0].field){let D=e.column(r[0].field);if(D.groups)return D.groups(t)}let n=kc(e,i,r),o=t_(n),c=e.totalRows(),f=new Uint32Array(c),p={},x=[],E=e.data(),T=e.mask();if(T)for(let D=T.next(0);D>=0;D=T.next(D+1)){let N=o(D,E)+"",z=p[N];f[D]=z??(p[N]=x.push(D)-1)}else for(let D=0;D<c;++D){let N=o(D,E)+"",z=p[N];f[D]=z??(p[N]=x.push(D)-1)}return i.length||(n=n.map(D=>N=>D(N,E))),{keys:f,get:n,names:t,rows:x,size:x.length}}function Bat(e,t){return Dat(e,Jo("groupby",e,t))}function Oat(e,t){return e.create({order:t})}var h6t=(e,t,r,i)=>`((u = ${e}) < (v = ${t}) || u == null) && v != null ? ${r}
    : (u > v || v == null) && u != null ? ${i}
    : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? ${r}
    : v !== v && u === u ? ${i} : `;function Nat(e,t){let r=[],i=[],s=[],n=null,o="0",c="0";e.isGrouped()&&(n=e.groups().keys,o="ka",c="kb");let{ops:f}=gs(t,{table:e,value:(D,N)=>{if(r.push(D),N.escape){let z=U=>`fn[${s.length}](${U}, data)`;i.push([z("a"),z("b")]),s.push(N.escape)}else i.push([K1(N,{index:"a",op:o}),K1(N,{index:"b",op:c})])},window:!1}),p=Yp(e,f),x=(D,N)=>p[D][N],E=r.length,T="return (a, b) => {"+(x&&e.isGrouped()?"const ka = keys[a], kb = keys[b];":"")+"let u, v; return ";for(let D=0;D<E;++D){let N=t.get(r[D]).desc?-1:1,[z,U]=i[D];T+=h6t(z,U,-N,N)}return T+="0;};",Function("op","keys","fn","data",T)(x,n,s,e.data())}function Fat(e,t){return Oat(e,f6t(e,t))}function f6t(e,t){let r=-1,i=new Map,s=n=>i.set(++r+"",n);return t.forEach(n=>{let o=n.expr!=null?n.expr:n;if(As(o)&&!Ni(o))for(let c in o)s(o[c]);else s(js(o)?fu(n,e.columnName(o)):On(o)?fu(n):Ni(o)?n:nr(`Invalid orderby field: ${n+""}`))}),Nat(e,i)}function Lat(e,t){let r=e.numRows(),i=r+t.reduce((o,c)=>o+c.numRows(),0);if(r===i)return e;let s=[e,...t],n=ms();return e.columnNames().forEach(o=>{let c=Array(i),f=0;s.forEach(p=>{let x=p.column(o)||{get:()=>ji};p.scan(E=>c[f++]=x.get(E))}),n.add(o,c)}),e.create(n.new())}function zat(e,t){let r=ms(),i=e.groups(),{get:s,names:n=[],rows:o,size:c=1}=i||{},f=new Uint32Array(c+1);n.forEach(T=>r.add(T,null));let p=i?jF(e,t,i):[VF(e,t)];t.outputs().map(T=>r.add(T,[]));let x=f.length-1,E=0;for(let T=0;T<x;++T)E+=f[T+1]=t.write(p[T],r.data,f[T]);if(i){let T=e.data();n.forEach((D,N)=>{let z=r.data[D]=Array(E),U=s[N];for(let H=0,G=0;H<c;++H)z.fill(U(o[H],T),G,G+=f[H+1])})}return e.create(r.new())}function Uat(e){return e.isGrouped()?e.create({groups:null}):e}function Vat(e){return e.isOrdered()?e.create({order:null}):e}var jat={__antijoin:(e,t,r)=>qF(e,t,r,{anti:!0}),__count:(e,t={})=>XF(e,{[t.as||"count"]:H9()}),__cross:(e,t,r,i)=>WF(e,t,()=>!0,r,{...i,left:!0,right:!0}),__concat:Lat,__dedupe:Kot,__derive:sat,__except:oat,__filter:lat,__fold:uat,__impute:fat,__intersect:pat,__join:WF,__lookup:yat,__pivot:bat,__relocate:bC,__rename:vat,__rollup:XF,__sample:Eat,__select:Mat,__semijoin:qF,__spread:Pat,__union:Rat,__unroll:kat,__groupby:Bat,__orderby:Fat,__ungroup:Uat,__unorder:Vat,__reduce:zat};Object.assign(qa.prototype,jat);function ZF(e,t){return qa.new(e,t)}function IT(e,t){return qa.from(e,t)}function rb(e,t={}){let r=t.using||wT;return fetch(e,t.fetch).then(i=>i[t.as||"text"]()).then(i=>r(i,t))}function MC(e,t){return rb(e,{...t,as:"arrayBuffer",using:AC})}function $at(e,t){return rb(e,{...t,as:"text",using:wT})}function Hat(e,t){return rb(e,{...t,as:"text",using:yC})}function Wat(e,t){return rb(e,{...t,as:"json",using:p6t})}function p6t(e,t){return oi(e)?IT(e):xC(e,t)}function qat(e,t={}){let r=`d[${JSON.stringify(e)}]`,{maxbins:i,nice:s,minstep:n,step:o,offset:c}=t,f=[i,s,n,o],p=f.length;for(;p&&f[--p]==null;)f.pop();let x=f.length?", "+f.map(E=>E+"").join(", "):"";return`d => op.bin(${r}, ...op.bins(${r}${x}), ${c||0})`}function Yat(e){return Em(e,{escape:!0,toString(){nr("Escaped values can not be serialized.")}})}function Xat(e){return`() => op.round(${+e} * op.count())`}function Zat(...e){return e=e.flat(),t=>{let r=new Map,i=Math.min(e.length,t.numCols());for(let s=0;s<i;++s)r.set(t.columnName(s),e[s]);return r}}function GF(e,t){return e.ungroup().rollup({_:t}).get("_")}var Qat=(e,t)=>nr(`Illegal ${t} name: ${Ds(e)}`),d6t=(e,t)=>nr(`The ${t} ${Ds(e)} is already defined. Use override option?`),Kat=(e,t)=>nr(`The ${t} name ${Ds(e)} is reserved and can not be overridden.`);function Jat(e,t,r=wp,i="function"){e||Qat(e,i),!t.override&&ya(r,e)&&d6t(e,i)}function MT(e,t,r,i){return r[e]===t||Jat(e,i)}function tlt(e,t,r,i={}){if(MT(e,t,r,i))return;let[s=0,n=0]=t.param;r[e]=t,wp[e]=(...o)=>Pi(e,o.slice(0,s),o.slice(s,s+n))}function elt(e,t,r){tlt(e,t,ex,r)}function rlt(e,t,r){tlt(e,t,rx,r)}function ilt(e,t,r={}){arguments.length===1&&(t=e,e=t.name,e===""||e==="anonymous"?nr("Anonymous function provided, please include a name argument."):e===nx&&Kat(nx,"function")),!MT(e,t,tu,r)&&(tu[e]=t,wp[e]=t)}var ib=qa.prototype,CC;function Gat(e){for(;e;e=Object.getPrototypeOf(e))Object.getOwnPropertyNames(e).forEach(t=>CC[t]=1)}function QF(e,t,r){let i="method";if(ib[e]&&ib[e].fn===t)return!0;CC||(CC={},Gat(ib),Gat(Pc.prototype)),CC[e]&&Kat(e,i),(e+"")[0]==="_"&&Qat(e,i),Jat(e,r,ib,i)}function KF(e,t,r={}){QF(e,t,r)||(ib[e]=function(...i){return t(this,...i)},ib[e].fn=t)}function nlt(e,t,r,i={}){KF(e,t,i),Not(e,Mm[e]=Yn(e,r))}var A6t="arquero_package";function m6t(e,t={}){let r=e&&e[A6t]||e,i={functions:[(n,o,c)=>MT(n,o,tu,c),ilt],aggregateFunctions:[(n,o,c)=>MT(n,o,ex,c),elt],windowFunctions:[(n,o,c)=>MT(n,o,rx,c),rlt],tableMethods:[QF,KF],verbs:[(n,o,c)=>QF(n,o.method,c),(n,o,c)=>nlt(n,o.method,o.params,c)]};function s(n){for(let o in i){let c=i[o],f=r[o];for(let p in f)c[n](p,f[p],t)}}s(0),s(1)}var g6t={Table:G1,ColumnTable:qa,Transformable:e0,Query:Pc,Reducer:v_,Verb:S_,Verbs:Mm,columnFactory:Get,parse:gs,walk_ast:sn},_6t=Fot.version;var tL={x:.45,y:51.47,z:4,...Object.fromEntries(new URLSearchParams(window.location.hash.slice(1)))},Cm=new oL.default.Map({container:"map",style:`https://api.maptiler.com/maps/toner-v2/style.json?key=${window.location.hostname=="localhost"?"Y4leWPnhJFGnTFFk1cru":"L7Sd3jHa1AR1dtyLCTgq"}`,center:[tL.x,tL.y],zoom:tL.z,bearing:0,pitch:0}),eL;async function y6t(){return eL||(eL=await(await fetch("/data/JRC_POPULATION_2018_H3_by_rnd/meta.json")).json()),eL}var alt=V2(BI).domain([0,1]),x6t=e=>[...Object.values(gc(alt(e))).slice(0,-1),Math.sqrt(e)*255];var b6t=e=>new Xg({id:"selectedHex",ish3:!0,data:e.objects(),extruded:!1,stroked:!1,getHexagon:t=>t.index,getFillColor:t=>[0,255,0,100],pickable:!0});function v6t({object:e}){let t=r=>`<div>${r[0]}: ${typeof r[1]=="number"?parseFloat(r[1].toPrecision(3)):r[1]}</div>`;return e&&{html:`<div>density: ${rL} population: ${iL} </div> ${Object.entries(e).map(t).join(" ")}`,style:{backgroundColor:"#fff",fontFamily:"sans-serif",fontSize:"0.8em",padding:"0.5em"}}}function PC(e){return parseFloat(e.toPrecision(3)).toLocaleString()}var rL,slt,iL,RC=new zy({interleaved:!1,onClick:(e,t)=>{if(e.layer!=null&&(e.layer.id==="selectedHex"&&RC.setProps({layers:[nL.filter(r=>r.id!="selectedHex")]}),e.layer.props.ish3)){let r=document.getElementById("desired_radius").value,i=new Set(Sw(e.object.index,r).map(o=>Y7(o,3))),s=ZF({index:Sw(e.object.index,r)}),n=IT(Array.from(i).map(o=>I_.get(`${Yg(e.object.index)},${o}`)).flat().filter(o=>o!==void 0)).semijoin(s,"index");n=n.orderby("real_value").derive({cumsum:Yx(o=>op.sum(o.real_value))}).derive({quantile:o=>o.cumsum/op.sum(o.real_value)}).derive({median_dist:o=>wp.abs(o.quantile-.5)}).orderby("median_dist"),window.dt=n,rL=n.get("real_value",0),slt=n.rollup({median:o=>wp.median(o.real_value)}).get("median"),iL=n.rollup({total:o=>wp.mean(o.real_value)}).get("total")*n.size*X7(Yg(n.get("index",0)),"km2"),document.getElementById("results_text").innerHTML=`
            <p>Approx radius: ${PC(Ew(Yg(n.get("index",0)),"km")*2*r+1)} km </p>
            <p>Population density experienced by median person: <b>${PC(rL)}</b> / km^2                                </p>
            <p>Population density experienced by median piece of populated land: <b>${PC(slt)}</b> / km^2                     </p>
            <p>Total population: <b>${PC(iL)}</b>                                                                          </p>
            `,document.getElementById("settings").show(),RC.setProps({layers:[nL,b6t(n)]})}},getTooltip:v6t});Cm.addControl(RC);Cm.addControl(new oL.default.NavigationControl);var w6t=()=>{let e,t,r=Math.floor(Cm.getZoom());return r<6?(e=5,t=15):r<8?(e=7,t=10):r<100&&(e=9,t=1),{res:e,disk:t}},olt=[],I_=new Map,nL=[],aL=async()=>{let e=Cm.getCenter(),t=Tw(e.lat,e.lng,3),r=w6t(),i=Sw(t,r.disk),s=await y6t(),n=[];for(let E of i)s.valid_parents[r.res].includes(E)&&n.push(E);if(olt.sort().join()==n.sort().join())return;function o(E){try{return E.sort((T,D)=>Zy(T,t)-Zy(D,t)).slice(0,250)}catch(T){return console.warn(T),E}}let c=250,f=o(n).slice(0,250);olt=f;let p=[];for(let E of n){let T=`${r.res},${E}`;try{if(!I_.has(T)){let D=`/data/JRC_POPULATION_2018_H3_by_rnd/res=${r.res}/h3_3=${E}/part0.arrow`;if((await fetch(D)).status==404)continue;I_.set(T,(await MC(D)).objects())}}catch(D){console.log(D)}finally{continue}}for(let E of f){let T=`${r.res},${E}`;I_.has(T)&&p.push(new Xg({id:T,ish3:!0,data:I_.get(T),extruded:!1,stroked:!1,getHexagon:D=>D.index,getFillColor:D=>x6t(D.value),getElevation:D=>(1-D.value)*1e3,elevationScale:20,pickable:!0}))}RC.setProps({layers:p}),nL=p;let x=n.map(E=>`${r.res},${E}`);for(let E of I_.keys())x.includes(E)||I_.delete(E)};aL();window.d3=L9;window.observablehq=U9;window.aq=JF;window.h3=Z7;window.update=aL;var llt=new URLSearchParams(window.location.search),sL=document.getElementById("attribution");sL.innerText="\xA9 "+[llt.get("c"),"MapTiler","OpenStreetMap contributors"].filter(e=>e!==null).join(" \xA9 ");sL.insertBefore(z9({color:alt,title:llt.get("t")}),sL.firstChild);Cm.on("moveend",()=>{let e=Cm.getCenter(),t=Cm.getZoom();window.location.hash=`x=${e.lng}&y=${e.lat}&z=${t}`,setTimeout(r=>{let i=Cm.getCenter();e.lng==i.lng&&e.lat==i.lat&&(console.log("updating"),aL())},1e3)});})();
/*! Bundled license information:

hammerjs/hammer.js:
  (*! Hammer.JS - v2.0.7 - 2016-04-22
   * http://hammerjs.github.io/
   *
   * Copyright (c) 2016 Jorik Tangelder;
   * Licensed under the MIT license *)
*/
