(()=>{var tpt=Object.create;var CR=Object.defineProperty;var ept=Object.getOwnPropertyDescriptor;var rpt=Object.getOwnPropertyNames;var ipt=Object.getPrototypeOf,npt=Object.prototype.hasOwnProperty;var PR=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Ua=(e,t)=>{for(var r in t)CR(e,r,{get:t[r],enumerable:!0})},spt=(e,t,r,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of rpt(t))!npt.call(e,s)&&s!==r&&CR(e,s,{get:()=>t[s],enumerable:!(i=ept(t,s))||i.enumerable});return e};var RR=(e,t,r)=>(r=e!=null?tpt(ipt(e)):{},spt(t||!e||!e.__esModule?CR(r,"default",{value:e,enumerable:!0}):r,e));var XH=PR((V$t,ME)=>{(function(e,t,r,i){"use strict";var s=["","webkit","Moz","MS","ms","o"],n=t.createElement("div"),o="function",a=Math.round,h=Math.abs,p=Date.now;function g(ut,gt,Wt){return setTimeout(Z(ut,Wt),gt)}function v(ut,gt,Wt){return Array.isArray(ut)?(T(ut,Wt[gt],Wt),!0):!1}function T(ut,gt,Wt){var pe;if(ut)if(ut.forEach)ut.forEach(gt,Wt);else if(ut.length!==i)for(pe=0;pe<ut.length;)gt.call(Wt,ut[pe],pe,ut),pe++;else for(pe in ut)ut.hasOwnProperty(pe)&&gt.call(Wt,ut[pe],pe,ut)}function C(ut,gt,Wt){var pe="DEPRECATED METHOD: "+gt+`
`+Wt+` AT 
`;return function(){var Be=new Error("get-stack-trace"),lr=Be&&Be.stack?Be.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",ki=e.console&&(e.console.warn||e.console.log);return ki&&ki.call(e.console,pe,lr),ut.apply(this,arguments)}}var B;typeof Object.assign!="function"?B=function(gt){if(gt===i||gt===null)throw new TypeError("Cannot convert undefined or null to object");for(var Wt=Object(gt),pe=1;pe<arguments.length;pe++){var Be=arguments[pe];if(Be!==i&&Be!==null)for(var lr in Be)Be.hasOwnProperty(lr)&&(Wt[lr]=Be[lr])}return Wt}:B=Object.assign;var L=C(function(gt,Wt,pe){for(var Be=Object.keys(Wt),lr=0;lr<Be.length;)(!pe||pe&&gt[Be[lr]]===i)&&(gt[Be[lr]]=Wt[Be[lr]]),lr++;return gt},"extend","Use `assign`."),z=C(function(gt,Wt){return L(gt,Wt,!0)},"merge","Use `assign`.");function W(ut,gt,Wt){var pe=gt.prototype,Be;Be=ut.prototype=Object.create(pe),Be.constructor=ut,Be._super=pe,Wt&&B(Be,Wt)}function Z(ut,gt){return function(){return ut.apply(gt,arguments)}}function X(ut,gt){return typeof ut==o?ut.apply(gt&&gt[0]||i,gt):ut}function q(ut,gt){return ut===i?gt:ut}function it(ut,gt,Wt){T(Et(gt),function(pe){ut.addEventListener(pe,Wt,!1)})}function nt(ut,gt,Wt){T(Et(gt),function(pe){ut.removeEventListener(pe,Wt,!1)})}function Mt(ut,gt){for(;ut;){if(ut==gt)return!0;ut=ut.parentNode}return!1}function _t(ut,gt){return ut.indexOf(gt)>-1}function Et(ut){return ut.trim().split(/\s+/g)}function vt(ut,gt,Wt){if(ut.indexOf&&!Wt)return ut.indexOf(gt);for(var pe=0;pe<ut.length;){if(Wt&&ut[pe][Wt]==gt||!Wt&&ut[pe]===gt)return pe;pe++}return-1}function Pt(ut){return Array.prototype.slice.call(ut,0)}function re(ut,gt,Wt){for(var pe=[],Be=[],lr=0;lr<ut.length;){var ki=gt?ut[lr][gt]:ut[lr];vt(Be,ki)<0&&pe.push(ut[lr]),Be[lr]=ki,lr++}return Wt&&(gt?pe=pe.sort(function(ao,bo){return ao[gt]>bo[gt]}):pe=pe.sort()),pe}function $t(ut,gt){for(var Wt,pe,Be=gt[0].toUpperCase()+gt.slice(1),lr=0;lr<s.length;){if(Wt=s[lr],pe=Wt?Wt+Be:gt,pe in ut)return pe;lr++}return i}var xt=1;function Vt(){return xt++}function qt(ut){var gt=ut.ownerDocument||ut;return gt.defaultView||gt.parentWindow||e}var de=/mobile|tablet|ip(ad|hone|od)|android/i,Ee="ontouchstart"in e,Se=$t(e,"PointerEvent")!==i,ze=Ee&&de.test(navigator.userAgent),ke="touch",nr="pen",Si="mouse",yi="kinect",hi=25,Kr=1,zr=2,Br=4,Fe=8,Sr=1,$r=2,Ie=4,en=8,xi=16,rn=$r|Ie,fn=en|xi,Er=rn|fn,ae=["x","y"],Gn=["clientX","clientY"];function an(ut,gt){var Wt=this;this.manager=ut,this.callback=gt,this.element=ut.element,this.target=ut.options.inputTarget,this.domHandler=function(pe){X(ut.options.enable,[ut])&&Wt.handler(pe)},this.init()}an.prototype={handler:function(){},init:function(){this.evEl&&it(this.element,this.evEl,this.domHandler),this.evTarget&&it(this.target,this.evTarget,this.domHandler),this.evWin&&it(qt(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&nt(this.element,this.evEl,this.domHandler),this.evTarget&&nt(this.target,this.evTarget,this.domHandler),this.evWin&&nt(qt(this.element),this.evWin,this.domHandler)}};function Ji(ut){var gt,Wt=ut.options.inputClass;return Wt?gt=Wt:Se?gt=Ct:ze?gt=Ft:Ee?gt=be:gt=Nr,new gt(ut,$i)}function $i(ut,gt,Wt){var pe=Wt.pointers.length,Be=Wt.changedPointers.length,lr=gt&Kr&&pe-Be===0,ki=gt&(Br|Fe)&&pe-Be===0;Wt.isFirst=!!lr,Wt.isFinal=!!ki,lr&&(ut.session={}),Wt.eventType=gt,zo(ut,Wt),ut.emit("hammer.input",Wt),ut.recognize(Wt),ut.session.prevInput=Wt}function zo(ut,gt){var Wt=ut.session,pe=gt.pointers,Be=pe.length;Wt.firstInput||(Wt.firstInput=Zo(gt)),Be>1&&!Wt.firstMultiple?Wt.firstMultiple=Zo(gt):Be===1&&(Wt.firstMultiple=!1);var lr=Wt.firstInput,ki=Wt.firstMultiple,Us=ki?ki.center:lr.center,ao=gt.center=kl(pe);gt.timeStamp=p(),gt.deltaTime=gt.timeStamp-lr.timeStamp,gt.angle=la(Us,ao),gt.distance=Ne(Us,ao),Pu(Wt,gt),gt.offsetDirection=Go(gt.deltaX,gt.deltaY);var bo=rl(gt.deltaTime,gt.deltaX,gt.deltaY);gt.overallVelocityX=bo.x,gt.overallVelocityY=bo.y,gt.overallVelocity=h(bo.x)>h(bo.y)?bo.x:bo.y,gt.scale=ki?nc(ki.pointers,pe):1,gt.rotation=ki?Qn(ki.pointers,pe):0,gt.maxPointers=Wt.prevInput?gt.pointers.length>Wt.prevInput.maxPointers?gt.pointers.length:Wt.prevInput.maxPointers:gt.pointers.length,Rl(Wt,gt);var ol=ut.element;Mt(gt.srcEvent.target,ol)&&(ol=gt.srcEvent.target),gt.target=ol}function Pu(ut,gt){var Wt=gt.center,pe=ut.offsetDelta||{},Be=ut.prevDelta||{},lr=ut.prevInput||{};(gt.eventType===Kr||lr.eventType===Br)&&(Be=ut.prevDelta={x:lr.deltaX||0,y:lr.deltaY||0},pe=ut.offsetDelta={x:Wt.x,y:Wt.y}),gt.deltaX=Be.x+(Wt.x-pe.x),gt.deltaY=Be.y+(Wt.y-pe.y)}function Rl(ut,gt){var Wt=ut.lastInterval||gt,pe=gt.timeStamp-Wt.timeStamp,Be,lr,ki,Us;if(gt.eventType!=Fe&&(pe>hi||Wt.velocity===i)){var ao=gt.deltaX-Wt.deltaX,bo=gt.deltaY-Wt.deltaY,ol=rl(pe,ao,bo);lr=ol.x,ki=ol.y,Be=h(ol.x)>h(ol.y)?ol.x:ol.y,Us=Go(ao,bo),ut.lastInterval=gt}else Be=Wt.velocity,lr=Wt.velocityX,ki=Wt.velocityY,Us=Wt.direction;gt.velocity=Be,gt.velocityX=lr,gt.velocityY=ki,gt.direction=Us}function Zo(ut){for(var gt=[],Wt=0;Wt<ut.pointers.length;)gt[Wt]={clientX:a(ut.pointers[Wt].clientX),clientY:a(ut.pointers[Wt].clientY)},Wt++;return{timeStamp:p(),pointers:gt,center:kl(gt),deltaX:ut.deltaX,deltaY:ut.deltaY}}function kl(ut){var gt=ut.length;if(gt===1)return{x:a(ut[0].clientX),y:a(ut[0].clientY)};for(var Wt=0,pe=0,Be=0;Be<gt;)Wt+=ut[Be].clientX,pe+=ut[Be].clientY,Be++;return{x:a(Wt/gt),y:a(pe/gt)}}function rl(ut,gt,Wt){return{x:gt/ut||0,y:Wt/ut||0}}function Go(ut,gt){return ut===gt?Sr:h(ut)>=h(gt)?ut<0?$r:Ie:gt<0?en:xi}function Ne(ut,gt,Wt){Wt||(Wt=ae);var pe=gt[Wt[0]]-ut[Wt[0]],Be=gt[Wt[1]]-ut[Wt[1]];return Math.sqrt(pe*pe+Be*Be)}function la(ut,gt,Wt){Wt||(Wt=ae);var pe=gt[Wt[0]]-ut[Wt[0]],Be=gt[Wt[1]]-ut[Wt[1]];return Math.atan2(Be,pe)*180/Math.PI}function Qn(ut,gt){return la(gt[1],gt[0],Gn)+la(ut[1],ut[0],Gn)}function nc(ut,gt){return Ne(gt[0],gt[1],Gn)/Ne(ut[0],ut[1],Gn)}var il={mousedown:Kr,mousemove:zr,mouseup:Br},Ue="mousedown",ni="mousemove mouseup";function Nr(){this.evEl=Ue,this.evWin=ni,this.pressed=!1,an.apply(this,arguments)}W(Nr,an,{handler:function(gt){var Wt=il[gt.type];Wt&Kr&&gt.button===0&&(this.pressed=!0),Wt&zr&&gt.which!==1&&(Wt=Br),this.pressed&&(Wt&Br&&(this.pressed=!1),this.callback(this.manager,Wt,{pointers:[gt],changedPointers:[gt],pointerType:Si,srcEvent:gt}))}});var xo={pointerdown:Kr,pointermove:zr,pointerup:Br,pointercancel:Fe,pointerout:Fe},nl={2:ke,3:nr,4:Si,5:yi},qr="pointerdown",Ma="pointermove pointerup pointercancel";e.MSPointerEvent&&!e.PointerEvent&&(qr="MSPointerDown",Ma="MSPointerMove MSPointerUp MSPointerCancel");function Ct(){this.evEl=qr,this.evWin=Ma,an.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}W(Ct,an,{handler:function(gt){var Wt=this.store,pe=!1,Be=gt.type.toLowerCase().replace("ms",""),lr=xo[Be],ki=nl[gt.pointerType]||gt.pointerType,Us=ki==ke,ao=vt(Wt,gt.pointerId,"pointerId");lr&Kr&&(gt.button===0||Us)?ao<0&&(Wt.push(gt),ao=Wt.length-1):lr&(Br|Fe)&&(pe=!0),!(ao<0)&&(Wt[ao]=gt,this.callback(this.manager,lr,{pointers:Wt,changedPointers:[gt],pointerType:ki,srcEvent:gt}),pe&&Wt.splice(ao,1))}});var rt={touchstart:Kr,touchmove:zr,touchend:Br,touchcancel:Fe},at="touchstart",mt="touchstart touchmove touchend touchcancel";function Dt(){this.evTarget=at,this.evWin=mt,this.started=!1,an.apply(this,arguments)}W(Dt,an,{handler:function(gt){var Wt=rt[gt.type];if(Wt===Kr&&(this.started=!0),!!this.started){var pe=Ot.call(this,gt,Wt);Wt&(Br|Fe)&&pe[0].length-pe[1].length===0&&(this.started=!1),this.callback(this.manager,Wt,{pointers:pe[0],changedPointers:pe[1],pointerType:ke,srcEvent:gt})}}});function Ot(ut,gt){var Wt=Pt(ut.touches),pe=Pt(ut.changedTouches);return gt&(Br|Fe)&&(Wt=re(Wt.concat(pe),"identifier",!0)),[Wt,pe]}var It={touchstart:Kr,touchmove:zr,touchend:Br,touchcancel:Fe},Yt="touchstart touchmove touchend touchcancel";function Ft(){this.evTarget=Yt,this.targetIds={},an.apply(this,arguments)}W(Ft,an,{handler:function(gt){var Wt=It[gt.type],pe=Qt.call(this,gt,Wt);pe&&this.callback(this.manager,Wt,{pointers:pe[0],changedPointers:pe[1],pointerType:ke,srcEvent:gt})}});function Qt(ut,gt){var Wt=Pt(ut.touches),pe=this.targetIds;if(gt&(Kr|zr)&&Wt.length===1)return pe[Wt[0].identifier]=!0,[Wt,Wt];var Be,lr,ki=Pt(ut.changedTouches),Us=[],ao=this.target;if(lr=Wt.filter(function(bo){return Mt(bo.target,ao)}),gt===Kr)for(Be=0;Be<lr.length;)pe[lr[Be].identifier]=!0,Be++;for(Be=0;Be<ki.length;)pe[ki[Be].identifier]&&Us.push(ki[Be]),gt&(Br|Fe)&&delete pe[ki[Be].identifier],Be++;if(Us.length)return[re(lr.concat(Us),"identifier",!0),Us]}var _e=2500,ye=25;function be(){an.apply(this,arguments);var ut=Z(this.handler,this);this.touch=new Ft(this.manager,ut),this.mouse=new Nr(this.manager,ut),this.primaryTouch=null,this.lastTouches=[]}W(be,an,{handler:function(gt,Wt,pe){var Be=pe.pointerType==ke,lr=pe.pointerType==Si;if(!(lr&&pe.sourceCapabilities&&pe.sourceCapabilities.firesTouchEvents)){if(Be)br.call(this,Wt,pe);else if(lr&&cr.call(this,pe))return;this.callback(gt,Wt,pe)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function br(ut,gt){ut&Kr?(this.primaryTouch=gt.changedPointers[0].identifier,Lr.call(this,gt)):ut&(Br|Fe)&&Lr.call(this,gt)}function Lr(ut){var gt=ut.changedPointers[0];if(gt.identifier===this.primaryTouch){var Wt={x:gt.clientX,y:gt.clientY};this.lastTouches.push(Wt);var pe=this.lastTouches,Be=function(){var lr=pe.indexOf(Wt);lr>-1&&pe.splice(lr,1)};setTimeout(Be,_e)}}function cr(ut){for(var gt=ut.srcEvent.clientX,Wt=ut.srcEvent.clientY,pe=0;pe<this.lastTouches.length;pe++){var Be=this.lastTouches[pe],lr=Math.abs(gt-Be.x),ki=Math.abs(Wt-Be.y);if(lr<=ye&&ki<=ye)return!0}return!1}var vr=$t(n.style,"touchAction"),jr=vr!==i,ln="compute",yn="auto",Vi="manipulation",Ai="none",Ps="pan-x",pn="pan-y",ns=HA();function zs(ut,gt){this.manager=ut,this.set(gt)}zs.prototype={set:function(ut){ut==ln&&(ut=this.compute()),jr&&this.manager.element.style&&ns[ut]&&(this.manager.element.style[vr]=ut),this.actions=ut.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var ut=[];return T(this.manager.recognizers,function(gt){X(gt.options.enable,[gt])&&(ut=ut.concat(gt.getTouchAction()))}),Ca(ut.join(" "))},preventDefaults:function(ut){var gt=ut.srcEvent,Wt=ut.offsetDirection;if(this.manager.session.prevented){gt.preventDefault();return}var pe=this.actions,Be=_t(pe,Ai)&&!ns[Ai],lr=_t(pe,pn)&&!ns[pn],ki=_t(pe,Ps)&&!ns[Ps];if(Be){var Us=ut.pointers.length===1,ao=ut.distance<2,bo=ut.deltaTime<250;if(Us&&ao&&bo)return}if(!(ki&&lr)&&(Be||lr&&Wt&rn||ki&&Wt&fn))return this.preventSrc(gt)},preventSrc:function(ut){this.manager.session.prevented=!0,ut.preventDefault()}};function Ca(ut){if(_t(ut,Ai))return Ai;var gt=_t(ut,Ps),Wt=_t(ut,pn);return gt&&Wt?Ai:gt||Wt?gt?Ps:pn:_t(ut,Vi)?Vi:yn}function HA(){if(!jr)return!1;var ut={},gt=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(Wt){ut[Wt]=gt?e.CSS.supports("touch-action",Wt):!0}),ut}var sc=1,oo=2,kh=4,Hi=8,sl=Hi,Xc=16,Hn=32;function bs(ut){this.options=B({},this.defaults,ut||{}),this.id=Vt(),this.manager=null,this.options.enable=q(this.options.enable,!0),this.state=sc,this.simultaneous={},this.requireFail=[]}bs.prototype={defaults:{},set:function(ut){return B(this.options,ut),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(ut){if(v(ut,"recognizeWith",this))return this;var gt=this.simultaneous;return ut=Rs(ut,this),gt[ut.id]||(gt[ut.id]=ut,ut.recognizeWith(this)),this},dropRecognizeWith:function(ut){return v(ut,"dropRecognizeWith",this)?this:(ut=Rs(ut,this),delete this.simultaneous[ut.id],this)},requireFailure:function(ut){if(v(ut,"requireFailure",this))return this;var gt=this.requireFail;return ut=Rs(ut,this),vt(gt,ut)===-1&&(gt.push(ut),ut.requireFailure(this)),this},dropRequireFailure:function(ut){if(v(ut,"dropRequireFailure",this))return this;ut=Rs(ut,this);var gt=vt(this.requireFail,ut);return gt>-1&&this.requireFail.splice(gt,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(ut){return!!this.simultaneous[ut.id]},emit:function(ut){var gt=this,Wt=this.state;function pe(Be){gt.manager.emit(Be,ut)}Wt<Hi&&pe(gt.options.event+qA(Wt)),pe(gt.options.event),ut.additionalEvent&&pe(ut.additionalEvent),Wt>=Hi&&pe(gt.options.event+qA(Wt))},tryEmit:function(ut){if(this.canEmit())return this.emit(ut);this.state=Hn},canEmit:function(){for(var ut=0;ut<this.requireFail.length;){if(!(this.requireFail[ut].state&(Hn|sc)))return!1;ut++}return!0},recognize:function(ut){var gt=B({},ut);if(!X(this.options.enable,[this,gt])){this.reset(),this.state=Hn;return}this.state&(sl|Xc|Hn)&&(this.state=sc),this.state=this.process(gt),this.state&(oo|kh|Hi|Xc)&&this.tryEmit(gt)},process:function(ut){},getTouchAction:function(){},reset:function(){}};function qA(ut){return ut&Xc?"cancel":ut&Hi?"end":ut&kh?"move":ut&oo?"start":""}function ca(ut){return ut==xi?"down":ut==en?"up":ut==$r?"left":ut==Ie?"right":""}function Rs(ut,gt){var Wt=gt.manager;return Wt?Wt.get(ut):ut}function Uo(){bs.apply(this,arguments)}W(Uo,bs,{defaults:{pointers:1},attrTest:function(ut){var gt=this.options.pointers;return gt===0||ut.pointers.length===gt},process:function(ut){var gt=this.state,Wt=ut.eventType,pe=gt&(oo|kh),Be=this.attrTest(ut);return pe&&(Wt&Fe||!Be)?gt|Xc:pe||Be?Wt&Br?gt|Hi:gt&oo?gt|kh:oo:Hn}});function oc(){Uo.apply(this,arguments),this.pX=null,this.pY=null}W(oc,Uo,{defaults:{event:"pan",threshold:10,pointers:1,direction:Er},getTouchAction:function(){var ut=this.options.direction,gt=[];return ut&rn&&gt.push(pn),ut&fn&&gt.push(Ps),gt},directionTest:function(ut){var gt=this.options,Wt=!0,pe=ut.distance,Be=ut.direction,lr=ut.deltaX,ki=ut.deltaY;return Be&gt.direction||(gt.direction&rn?(Be=lr===0?Sr:lr<0?$r:Ie,Wt=lr!=this.pX,pe=Math.abs(ut.deltaX)):(Be=ki===0?Sr:ki<0?en:xi,Wt=ki!=this.pY,pe=Math.abs(ut.deltaY))),ut.direction=Be,Wt&&pe>gt.threshold&&Be&gt.direction},attrTest:function(ut){return Uo.prototype.attrTest.call(this,ut)&&(this.state&oo||!(this.state&oo)&&this.directionTest(ut))},emit:function(ut){this.pX=ut.deltaX,this.pY=ut.deltaY;var gt=ca(ut.direction);gt&&(ut.additionalEvent=this.options.event+gt),this._super.emit.call(this,ut)}});function zn(){Uo.apply(this,arguments)}W(zn,Uo,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Ai]},attrTest:function(ut){return this._super.attrTest.call(this,ut)&&(Math.abs(ut.scale-1)>this.options.threshold||this.state&oo)},emit:function(ut){if(ut.scale!==1){var gt=ut.scale<1?"in":"out";ut.additionalEvent=this.options.event+gt}this._super.emit.call(this,ut)}});function tn(){bs.apply(this,arguments),this._timer=null,this._input=null}W(tn,bs,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[yn]},process:function(ut){var gt=this.options,Wt=ut.pointers.length===gt.pointers,pe=ut.distance<gt.threshold,Be=ut.deltaTime>gt.time;if(this._input=ut,!pe||!Wt||ut.eventType&(Br|Fe)&&!Be)this.reset();else if(ut.eventType&Kr)this.reset(),this._timer=g(function(){this.state=sl,this.tryEmit()},gt.time,this);else if(ut.eventType&Br)return sl;return Hn},reset:function(){clearTimeout(this._timer)},emit:function(ut){this.state===sl&&(ut&&ut.eventType&Br?this.manager.emit(this.options.event+"up",ut):(this._input.timeStamp=p(),this.manager.emit(this.options.event,this._input)))}});function ac(){Uo.apply(this,arguments)}W(ac,Uo,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Ai]},attrTest:function(ut){return this._super.attrTest.call(this,ut)&&(Math.abs(ut.rotation)>this.options.threshold||this.state&oo)}});function qn(){Uo.apply(this,arguments)}W(qn,Uo,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:rn|fn,pointers:1},getTouchAction:function(){return oc.prototype.getTouchAction.call(this)},attrTest:function(ut){var gt=this.options.direction,Wt;return gt&(rn|fn)?Wt=ut.overallVelocity:gt&rn?Wt=ut.overallVelocityX:gt&fn&&(Wt=ut.overallVelocityY),this._super.attrTest.call(this,ut)&&gt&ut.offsetDirection&&ut.distance>this.options.threshold&&ut.maxPointers==this.options.pointers&&h(Wt)>this.options.velocity&&ut.eventType&Br},emit:function(ut){var gt=ca(ut.offsetDirection);gt&&this.manager.emit(this.options.event+gt,ut),this.manager.emit(this.options.event,ut)}});function Ru(){bs.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}W(Ru,bs,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Vi]},process:function(ut){var gt=this.options,Wt=ut.pointers.length===gt.pointers,pe=ut.distance<gt.threshold,Be=ut.deltaTime<gt.time;if(this.reset(),ut.eventType&Kr&&this.count===0)return this.failTimeout();if(pe&&Be&&Wt){if(ut.eventType!=Br)return this.failTimeout();var lr=this.pTime?ut.timeStamp-this.pTime<gt.interval:!0,ki=!this.pCenter||Ne(this.pCenter,ut.center)<gt.posThreshold;this.pTime=ut.timeStamp,this.pCenter=ut.center,!ki||!lr?this.count=1:this.count+=1,this._input=ut;var Us=this.count%gt.taps;if(Us===0)return this.hasRequireFailures()?(this._timer=g(function(){this.state=sl,this.tryEmit()},gt.interval,this),oo):sl}return Hn},failTimeout:function(){return this._timer=g(function(){this.state=Hn},this.options.interval,this),Hn},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==sl&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function ks(ut,gt){return gt=gt||{},gt.recognizers=q(gt.recognizers,ks.defaults.preset),new ad(ut,gt)}ks.VERSION="2.0.7",ks.defaults={domEvents:!1,touchAction:ln,enable:!0,inputTarget:null,inputClass:null,preset:[[ac,{enable:!1}],[zn,{enable:!1},["rotate"]],[qn,{direction:rn}],[oc,{direction:rn},["swipe"]],[Ru],[Ru,{event:"doubletap",taps:2},["tap"]],[tn]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var Z0=1,lc=2;function ad(ut,gt){this.options=B({},ks.defaults,gt||{}),this.options.inputTarget=this.options.inputTarget||ut,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=ut,this.input=Ji(this),this.touchAction=new zs(this,this.options.touchAction),ld(this,!0),T(this.options.recognizers,function(Wt){var pe=this.add(new Wt[0](Wt[1]));Wt[2]&&pe.recognizeWith(Wt[2]),Wt[3]&&pe.requireFailure(Wt[3])},this)}ad.prototype={set:function(ut){return B(this.options,ut),ut.touchAction&&this.touchAction.update(),ut.inputTarget&&(this.input.destroy(),this.input.target=ut.inputTarget,this.input.init()),this},stop:function(ut){this.session.stopped=ut?lc:Z0},recognize:function(ut){var gt=this.session;if(!gt.stopped){this.touchAction.preventDefaults(ut);var Wt,pe=this.recognizers,Be=gt.curRecognizer;(!Be||Be&&Be.state&sl)&&(Be=gt.curRecognizer=null);for(var lr=0;lr<pe.length;)Wt=pe[lr],gt.stopped!==lc&&(!Be||Wt==Be||Wt.canRecognizeWith(Be))?Wt.recognize(ut):Wt.reset(),!Be&&Wt.state&(oo|kh|Hi)&&(Be=gt.curRecognizer=Wt),lr++}},get:function(ut){if(ut instanceof bs)return ut;for(var gt=this.recognizers,Wt=0;Wt<gt.length;Wt++)if(gt[Wt].options.event==ut)return gt[Wt];return null},add:function(ut){if(v(ut,"add",this))return this;var gt=this.get(ut.options.event);return gt&&this.remove(gt),this.recognizers.push(ut),ut.manager=this,this.touchAction.update(),ut},remove:function(ut){if(v(ut,"remove",this))return this;if(ut=this.get(ut),ut){var gt=this.recognizers,Wt=vt(gt,ut);Wt!==-1&&(gt.splice(Wt,1),this.touchAction.update())}return this},on:function(ut,gt){if(ut!==i&&gt!==i){var Wt=this.handlers;return T(Et(ut),function(pe){Wt[pe]=Wt[pe]||[],Wt[pe].push(gt)}),this}},off:function(ut,gt){if(ut!==i){var Wt=this.handlers;return T(Et(ut),function(pe){gt?Wt[pe]&&Wt[pe].splice(vt(Wt[pe],gt),1):delete Wt[pe]}),this}},emit:function(ut,gt){this.options.domEvents&&cd(ut,gt);var Wt=this.handlers[ut]&&this.handlers[ut].slice();if(!(!Wt||!Wt.length)){gt.type=ut,gt.preventDefault=function(){gt.srcEvent.preventDefault()};for(var pe=0;pe<Wt.length;)Wt[pe](gt),pe++}},destroy:function(){this.element&&ld(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function ld(ut,gt){var Wt=ut.element;if(Wt.style){var pe;T(ut.options.cssProps,function(Be,lr){pe=$t(Wt.style,lr),gt?(ut.oldCssProps[pe]=Wt.style[pe],Wt.style[pe]=Be):Wt.style[pe]=ut.oldCssProps[pe]||""}),gt||(ut.oldCssProps={})}}function cd(ut,gt){var Wt=t.createEvent("Event");Wt.initEvent(ut,!0,!0),Wt.gesture=gt,gt.target.dispatchEvent(Wt)}B(ks,{INPUT_START:Kr,INPUT_MOVE:zr,INPUT_END:Br,INPUT_CANCEL:Fe,STATE_POSSIBLE:sc,STATE_BEGAN:oo,STATE_CHANGED:kh,STATE_ENDED:Hi,STATE_RECOGNIZED:sl,STATE_CANCELLED:Xc,STATE_FAILED:Hn,DIRECTION_NONE:Sr,DIRECTION_LEFT:$r,DIRECTION_RIGHT:Ie,DIRECTION_UP:en,DIRECTION_DOWN:xi,DIRECTION_HORIZONTAL:rn,DIRECTION_VERTICAL:fn,DIRECTION_ALL:Er,Manager:ad,Input:an,TouchAction:zs,TouchInput:Ft,MouseInput:Nr,PointerEventInput:Ct,TouchMouseInput:be,SingleTouchInput:Dt,Recognizer:bs,AttrRecognizer:Uo,Tap:Ru,Pan:oc,Swipe:qn,Pinch:zn,Rotate:ac,Press:tn,on:it,off:nt,each:T,merge:z,extend:L,assign:B,inherit:W,bindFn:Z,prefixed:$t});var ud=typeof e<"u"?e:typeof self<"u"?self:{};ud.Hammer=ks,typeof define=="function"&&define.amd?define(function(){return ks}):typeof ME<"u"&&ME.exports?ME.exports=ks:e[r]=ks})(window,document,"Hammer")});var TY=PR((QZt,pO)=>{"use strict";pO.exports=XE;pO.exports.default=XE;function XE(e,t,r){r=r||2;var i=t&&t.length,s=i?t[0]*r:e.length,n=bY(e,0,s,r,!0),o=[];if(!n||n.next===n.prev)return o;var a,h,p,g,v,T,C;if(i&&(n=dxt(e,t,n,r)),e.length>80*r){a=p=e[0],h=g=e[1];for(var B=r;B<s;B+=r)v=e[B],T=e[B+1],v<a&&(a=v),T<h&&(h=T),v>p&&(p=v),T>g&&(g=T);C=Math.max(p-a,g-h),C=C!==0?32767/C:0}return Kw(n,o,r,a,h,C,0),o}function bY(e,t,r,i,s){var n,o;if(s===fO(e,t,r,i)>0)for(n=t;n<r;n+=i)o=xY(n,e[n],e[n+1],o);else for(n=r-i;n>=t;n-=i)o=xY(n,e[n],e[n+1],o);return o&&ZE(o,o.next)&&(t3(o),o=o.next),o}function l1(e,t){if(!e)return e;t||(t=e);var r=e,i;do if(i=!1,!r.steiner&&(ZE(r,r.next)||eo(r.prev,r,r.next)===0)){if(t3(r),r=t=r.prev,r===r.next)break;i=!0}else r=r.next;while(i||r!==t);return t}function Kw(e,t,r,i,s,n,o){if(e){!o&&n&&yxt(e,i,s,n);for(var a=e,h,p;e.prev!==e.next;){if(h=e.prev,p=e.next,n?hxt(e,i,s,n):uxt(e)){t.push(h.i/r|0),t.push(e.i/r|0),t.push(p.i/r|0),t3(e),e=p.next,a=p.next;continue}if(e=p,e===a){o?o===1?(e=fxt(l1(e),t,r),Kw(e,t,r,i,s,n,2)):o===2&&pxt(e,t,r,i,s,n):Kw(l1(e),t,r,i,s,n,1);break}}}}function uxt(e){var t=e.prev,r=e,i=e.next;if(eo(t,r,i)>=0)return!1;for(var s=t.x,n=r.x,o=i.x,a=t.y,h=r.y,p=i.y,g=s<n?s<o?s:o:n<o?n:o,v=a<h?a<p?a:p:h<p?h:p,T=s>n?s>o?s:o:n>o?n:o,C=a>h?a>p?a:p:h>p?h:p,B=i.next;B!==t;){if(B.x>=g&&B.x<=T&&B.y>=v&&B.y<=C&&h2(s,a,n,h,o,p,B.x,B.y)&&eo(B.prev,B,B.next)>=0)return!1;B=B.next}return!0}function hxt(e,t,r,i){var s=e.prev,n=e,o=e.next;if(eo(s,n,o)>=0)return!1;for(var a=s.x,h=n.x,p=o.x,g=s.y,v=n.y,T=o.y,C=a<h?a<p?a:p:h<p?h:p,B=g<v?g<T?g:T:v<T?v:T,L=a>h?a>p?a:p:h>p?h:p,z=g>v?g>T?g:T:v>T?v:T,W=uO(C,B,t,r,i),Z=uO(L,z,t,r,i),X=e.prevZ,q=e.nextZ;X&&X.z>=W&&q&&q.z<=Z;){if(X.x>=C&&X.x<=L&&X.y>=B&&X.y<=z&&X!==s&&X!==o&&h2(a,g,h,v,p,T,X.x,X.y)&&eo(X.prev,X,X.next)>=0||(X=X.prevZ,q.x>=C&&q.x<=L&&q.y>=B&&q.y<=z&&q!==s&&q!==o&&h2(a,g,h,v,p,T,q.x,q.y)&&eo(q.prev,q,q.next)>=0))return!1;q=q.nextZ}for(;X&&X.z>=W;){if(X.x>=C&&X.x<=L&&X.y>=B&&X.y<=z&&X!==s&&X!==o&&h2(a,g,h,v,p,T,X.x,X.y)&&eo(X.prev,X,X.next)>=0)return!1;X=X.prevZ}for(;q&&q.z<=Z;){if(q.x>=C&&q.x<=L&&q.y>=B&&q.y<=z&&q!==s&&q!==o&&h2(a,g,h,v,p,T,q.x,q.y)&&eo(q.prev,q,q.next)>=0)return!1;q=q.nextZ}return!0}function fxt(e,t,r){var i=e;do{var s=i.prev,n=i.next.next;!ZE(s,n)&&vY(s,i,i.next,n)&&Jw(s,n)&&Jw(n,s)&&(t.push(s.i/r|0),t.push(i.i/r|0),t.push(n.i/r|0),t3(i),t3(i.next),i=e=n),i=i.next}while(i!==e);return l1(i)}function pxt(e,t,r,i,s,n){var o=e;do{for(var a=o.next.next;a!==o.prev;){if(o.i!==a.i&&vxt(o,a)){var h=wY(o,a);o=l1(o,o.next),h=l1(h,h.next),Kw(o,t,r,i,s,n,0),Kw(h,t,r,i,s,n,0);return}a=a.next}o=o.next}while(o!==e)}function dxt(e,t,r,i){var s=[],n,o,a,h,p;for(n=0,o=t.length;n<o;n++)a=t[n]*i,h=n<o-1?t[n+1]*i:e.length,p=bY(e,a,h,i,!1),p===p.next&&(p.steiner=!0),s.push(bxt(p));for(s.sort(mxt),n=0;n<s.length;n++)r=Axt(s[n],r);return r}function mxt(e,t){return e.x-t.x}function Axt(e,t){var r=gxt(e,t);if(!r)return t;var i=wY(r,e);return l1(i,i.next),l1(r,r.next)}function gxt(e,t){var r=t,i=e.x,s=e.y,n=-1/0,o;do{if(s<=r.y&&s>=r.next.y&&r.next.y!==r.y){var a=r.x+(s-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(a<=i&&a>n&&(n=a,o=r.x<r.next.x?r:r.next,a===i))return o}r=r.next}while(r!==t);if(!o)return null;var h=o,p=o.x,g=o.y,v=1/0,T;r=o;do i>=r.x&&r.x>=p&&i!==r.x&&h2(s<g?i:n,s,p,g,s<g?n:i,s,r.x,r.y)&&(T=Math.abs(s-r.y)/(i-r.x),Jw(r,e)&&(T<v||T===v&&(r.x>o.x||r.x===o.x&&_xt(o,r)))&&(o=r,v=T)),r=r.next;while(r!==h);return o}function _xt(e,t){return eo(e.prev,e,t.prev)<0&&eo(t.next,e,e.next)<0}function yxt(e,t,r,i){var s=e;do s.z===0&&(s.z=uO(s.x,s.y,t,r,i)),s.prevZ=s.prev,s.nextZ=s.next,s=s.next;while(s!==e);s.prevZ.nextZ=null,s.prevZ=null,xxt(s)}function xxt(e){var t,r,i,s,n,o,a,h,p=1;do{for(r=e,e=null,n=null,o=0;r;){for(o++,i=r,a=0,t=0;t<p&&(a++,i=i.nextZ,!!i);t++);for(h=p;a>0||h>0&&i;)a!==0&&(h===0||!i||r.z<=i.z)?(s=r,r=r.nextZ,a--):(s=i,i=i.nextZ,h--),n?n.nextZ=s:e=s,s.prevZ=n,n=s;r=i}n.nextZ=null,p*=2}while(o>1);return e}function uO(e,t,r,i,s){return e=(e-r)*s|0,t=(t-i)*s|0,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e|t<<1}function bxt(e){var t=e,r=e;do(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next;while(t!==e);return r}function h2(e,t,r,i,s,n,o,a){return(s-o)*(t-a)>=(e-o)*(n-a)&&(e-o)*(i-a)>=(r-o)*(t-a)&&(r-o)*(n-a)>=(s-o)*(i-a)}function vxt(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!wxt(e,t)&&(Jw(e,t)&&Jw(t,e)&&Txt(e,t)&&(eo(e.prev,e,t.prev)||eo(e,t.prev,t))||ZE(e,t)&&eo(e.prev,e,e.next)>0&&eo(t.prev,t,t.next)>0)}function eo(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function ZE(e,t){return e.x===t.x&&e.y===t.y}function vY(e,t,r,i){var s=YE(eo(e,t,r)),n=YE(eo(e,t,i)),o=YE(eo(r,i,e)),a=YE(eo(r,i,t));return!!(s!==n&&o!==a||s===0&&qE(e,r,t)||n===0&&qE(e,i,t)||o===0&&qE(r,e,i)||a===0&&qE(r,t,i))}function qE(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function YE(e){return e>0?1:e<0?-1:0}function wxt(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&vY(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}function Jw(e,t){return eo(e.prev,e,e.next)<0?eo(e,t,e.next)>=0&&eo(e,e.prev,t)>=0:eo(e,t,e.prev)<0||eo(e,e.next,t)<0}function Txt(e,t){var r=e,i=!1,s=(e.x+t.x)/2,n=(e.y+t.y)/2;do r.y>n!=r.next.y>n&&r.next.y!==r.y&&s<(r.next.x-r.x)*(n-r.y)/(r.next.y-r.y)+r.x&&(i=!i),r=r.next;while(r!==e);return i}function wY(e,t){var r=new hO(e.i,e.x,e.y),i=new hO(t.i,t.x,t.y),s=e.next,n=t.prev;return e.next=t,t.prev=e,r.next=s,s.prev=r,i.next=r,r.prev=i,n.next=i,i.prev=n,i}function xY(e,t,r,i){var s=new hO(e,t,r);return i?(s.next=i.next,s.prev=i,i.next.prev=s,i.next=s):(s.prev=s,s.next=s),s}function t3(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function hO(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}XE.deviation=function(e,t,r,i){var s=t&&t.length,n=s?t[0]*r:e.length,o=Math.abs(fO(e,0,n,r));if(s)for(var a=0,h=t.length;a<h;a++){var p=t[a]*r,g=a<h-1?t[a+1]*r:e.length;o-=Math.abs(fO(e,p,g,r))}var v=0;for(a=0;a<i.length;a+=3){var T=i[a]*r,C=i[a+1]*r,B=i[a+2]*r;v+=Math.abs((e[T]-e[B])*(e[C+1]-e[T+1])-(e[T]-e[C])*(e[B+1]-e[T+1]))}return o===0&&v===0?0:Math.abs((v-o)/o)};function fO(e,t,r,i){for(var s=0,n=t,o=r-i;n<r;n+=i)s+=(e[o]-e[n])*(e[n+1]+e[o+1]),o=n;return s}XE.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},i=0,s=0;s<e.length;s++){for(var n=0;n<e[s].length;n++)for(var o=0;o<t;o++)r.vertices.push(e[s][n][o]);s>0&&(i+=e[s-1].length,r.holes.push(i))}return r}});var XX=PR((zO,UO)=>{(function(e,t){typeof zO=="object"&&typeof UO<"u"?UO.exports=t():typeof define=="function"&&define.amd?define(t):(e=typeof globalThis<"u"?globalThis:e||self,e.maplibregl=t())})(zO,function(){"use strict";var e,t,r;function i(n,o){if(!e)e=o;else if(!t)t=o;else{var a="var sharedChunk = {}; ("+e+")(sharedChunk); ("+t+")(sharedChunk);",h={};e(h),r=o(h),typeof window<"u"&&(r.workerUrl=window.URL.createObjectURL(new Blob([a],{type:"text/javascript"})))}}i(["exports"],function(n){"use strict";function o(u,l,f,x){return new(f||(f=Promise))(function(S,k){function D(Y){try{j(x.next(Y))}catch(K){k(K)}}function F(Y){try{j(x.throw(Y))}catch(K){k(K)}}function j(Y){var K;Y.done?S(Y.value):(K=Y.value,K instanceof f?K:new f(function(et){et(K)})).then(D,F)}j((x=x.apply(u,l||[])).next())})}function a(u){return u&&u.__esModule&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u}typeof SuppressedError=="function"&&SuppressedError;var h=p;function p(u,l){this.x=u,this.y=l}p.prototype={clone:function(){return new p(this.x,this.y)},add:function(u){return this.clone()._add(u)},sub:function(u){return this.clone()._sub(u)},multByPoint:function(u){return this.clone()._multByPoint(u)},divByPoint:function(u){return this.clone()._divByPoint(u)},mult:function(u){return this.clone()._mult(u)},div:function(u){return this.clone()._div(u)},rotate:function(u){return this.clone()._rotate(u)},rotateAround:function(u,l){return this.clone()._rotateAround(u,l)},matMult:function(u){return this.clone()._matMult(u)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(u){return this.x===u.x&&this.y===u.y},dist:function(u){return Math.sqrt(this.distSqr(u))},distSqr:function(u){var l=u.x-this.x,f=u.y-this.y;return l*l+f*f},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(u){return Math.atan2(this.y-u.y,this.x-u.x)},angleWith:function(u){return this.angleWithSep(u.x,u.y)},angleWithSep:function(u,l){return Math.atan2(this.x*l-this.y*u,this.x*u+this.y*l)},_matMult:function(u){var l=u[2]*this.x+u[3]*this.y;return this.x=u[0]*this.x+u[1]*this.y,this.y=l,this},_add:function(u){return this.x+=u.x,this.y+=u.y,this},_sub:function(u){return this.x-=u.x,this.y-=u.y,this},_mult:function(u){return this.x*=u,this.y*=u,this},_div:function(u){return this.x/=u,this.y/=u,this},_multByPoint:function(u){return this.x*=u.x,this.y*=u.y,this},_divByPoint:function(u){return this.x/=u.x,this.y/=u.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var u=this.y;return this.y=this.x,this.x=-u,this},_rotate:function(u){var l=Math.cos(u),f=Math.sin(u),x=f*this.x+l*this.y;return this.x=l*this.x-f*this.y,this.y=x,this},_rotateAround:function(u,l){var f=Math.cos(u),x=Math.sin(u),S=l.y+x*(this.x-l.x)+f*(this.y-l.y);return this.x=l.x+f*(this.x-l.x)-x*(this.y-l.y),this.y=S,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},p.convert=function(u){return u instanceof p?u:Array.isArray(u)?new p(u[0],u[1]):u};var g=a(h),v=T;function T(u,l,f,x){this.cx=3*u,this.bx=3*(f-u)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*l,this.by=3*(x-l)-this.cy,this.ay=1-this.cy-this.by,this.p1x=u,this.p1y=l,this.p2x=f,this.p2y=x}T.prototype={sampleCurveX:function(u){return((this.ax*u+this.bx)*u+this.cx)*u},sampleCurveY:function(u){return((this.ay*u+this.by)*u+this.cy)*u},sampleCurveDerivativeX:function(u){return(3*this.ax*u+2*this.bx)*u+this.cx},solveCurveX:function(u,l){if(l===void 0&&(l=1e-6),u<0)return 0;if(u>1)return 1;for(var f=u,x=0;x<8;x++){var S=this.sampleCurveX(f)-u;if(Math.abs(S)<l)return f;var k=this.sampleCurveDerivativeX(f);if(Math.abs(k)<1e-6)break;f-=S/k}var D=0,F=1;for(f=u,x=0;x<20&&(S=this.sampleCurveX(f),!(Math.abs(S-u)<l));x++)u>S?D=f:F=f,f=.5*(F-D)+D;return f},solve:function(u,l){return this.sampleCurveY(this.solveCurveX(u,l))}};var C=a(v);let B,L;function z(){return B==null&&(B=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),B}function W(){if(L==null&&(L=!1,z())){let l=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(l){for(let x=0;x<5*5;x++){let S=4*x;l.fillStyle=`rgb(${S},${S+1},${S+2})`,l.fillRect(x%5,Math.floor(x/5),1,1)}let f=l.getImageData(0,0,5,5).data;for(let x=0;x<5*5*4;x++)if(x%4!=3&&f[x]!==x){L=!0;break}}}return L||!1}function Z(u,l,f,x){let S=new C(u,l,f,x);return function(k){return S.solve(k)}}let X=Z(.25,.1,.25,1);function q(u,l,f){return Math.min(f,Math.max(l,u))}function it(u,l,f){let x=f-l,S=((u-l)%x+x)%x+l;return S===l?f:S}function nt(u,...l){for(let f of l)for(let x in f)u[x]=f[x];return u}let Mt=1;function _t(u,l,f){let x={};for(let S in u)x[S]=l.call(f||this,u[S],S,u);return x}function Et(u,l,f){let x={};for(let S in u)l.call(f||this,u[S],S,u)&&(x[S]=u[S]);return x}function vt(u){return Array.isArray(u)?u.map(vt):typeof u=="object"&&u?_t(u,vt):u}let Pt={};function re(u){Pt[u]||(typeof console<"u"&&console.warn(u),Pt[u]=!0)}function $t(u,l,f){return(f.y-u.y)*(l.x-u.x)>(l.y-u.y)*(f.x-u.x)}function xt(u){let l=0;for(let f,x,S=0,k=u.length,D=k-1;S<k;D=S++)f=u[S],x=u[D],l+=(x.x-f.x)*(f.y+x.y);return l}function Vt(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}let qt=null;function de(u){return typeof ImageBitmap<"u"&&u instanceof ImageBitmap}let Ee="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Se(u,l,f,x,S){return o(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");let k=new VideoFrame(u,{timestamp:0});try{let D=k?.format;if(!D||!D.startsWith("BGR")&&!D.startsWith("RGB"))throw new Error(`Unrecognized format ${D}`);let F=D.startsWith("BGR"),j=new Uint8ClampedArray(x*S*4);if(yield k.copyTo(j,function(Y,K,et,st,ct){let ht=4*Math.max(-K,0),Tt=(Math.max(0,et)-et)*st*4+ht,Nt=4*st,Ut=Math.max(0,K),Kt=Math.max(0,et);return{rect:{x:Ut,y:Kt,width:Math.min(Y.width,K+st)-Ut,height:Math.min(Y.height,et+ct)-Kt},layout:[{offset:Tt,stride:Nt}]}}(u,l,f,x,S)),F)for(let Y=0;Y<j.length;Y+=4){let K=j[Y];j[Y]=j[Y+2],j[Y+2]=K}return j}finally{k.close()}})}let ze,ke,nr,Si,yi={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(u){let l=requestAnimationFrame(u);return{cancel:()=>cancelAnimationFrame(l)}},getImageData(u,l=0){return this.getImageCanvasContext(u).getImageData(-l,-l,u.width+2*l,u.height+2*l)},getImageCanvasContext(u){let l=window.document.createElement("canvas"),f=l.getContext("2d",{willReadFrequently:!0});if(!f)throw new Error("failed to create canvas 2d context");return l.width=u.width,l.height=u.height,f.drawImage(u,0,0,u.width,u.height),f},resolveURL:u=>(nr||(nr=document.createElement("a")),nr.href=u,nr.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(Si==null&&(Si=matchMedia("(prefers-reduced-motion: reduce)")),Si.matches)}},hi={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};class Kr extends Error{constructor(l,f,x,S){super(`AJAXError: ${f} (${l}): ${x}`),this.status=l,this.statusText=f,this.url=x,this.body=S}}let zr=Vt()?()=>self.worker&&self.worker.referrer:()=>(window.location.protocol==="blob:"?window.parent:window).location.href,Br=u=>hi.REGISTERED_PROTOCOLS[u.substring(0,u.indexOf("://"))];function Fe(u,l){let f=new AbortController,x=new Request(u.url,{method:u.method||"GET",body:u.body,credentials:u.credentials,headers:u.headers,cache:u.cache,referrer:zr(),signal:f.signal}),S=!1,k=!1;return u.type==="json"&&x.headers.set("Accept","application/json"),k||fetch(x).then(D=>D.ok?(F=>{(u.type==="arrayBuffer"||u.type==="image"?F.arrayBuffer():u.type==="json"?F.json():F.text()).then(j=>{k||(S=!0,l(null,j,F.headers.get("Cache-Control"),F.headers.get("Expires")))}).catch(j=>{k||l(new Error(j.message))})})(D):D.blob().then(F=>l(new Kr(D.status,D.statusText,u.url,F)))).catch(D=>{D.code!==20&&l(new Error(D.message))}),{cancel:()=>{k=!0,S||f.abort()}}}let Sr=function(u,l){if(/:\/\//.test(u.url)&&!/^https?:|^file:/.test(u.url)){if(Vt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",u,l);if(!Vt())return(Br(u.url)||Fe)(u,l)}if(!(/^file:/.test(f=u.url)||/^file:/.test(zr())&&!/^\w+:/.test(f))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return Fe(u,l);if(Vt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",u,l,void 0,!0)}var f;return function(x,S){let k=new XMLHttpRequest;k.open(x.method||"GET",x.url,!0),x.type!=="arrayBuffer"&&x.type!=="image"||(k.responseType="arraybuffer");for(let D in x.headers)k.setRequestHeader(D,x.headers[D]);return x.type==="json"&&(k.responseType="text",k.setRequestHeader("Accept","application/json")),k.withCredentials=x.credentials==="include",k.onerror=()=>{S(new Error(k.statusText))},k.onload=()=>{if((k.status>=200&&k.status<300||k.status===0)&&k.response!==null){let D=k.response;if(x.type==="json")try{D=JSON.parse(k.response)}catch(F){return S(F)}S(null,D,k.getResponseHeader("Cache-Control"),k.getResponseHeader("Expires"))}else{let D=new Blob([k.response],{type:k.getResponseHeader("Content-Type")});S(new Kr(k.status,k.statusText,x.url,D))}},k.send(x.body),{cancel:()=>k.abort()}}(u,l)},$r=function(u,l){return Sr(nt(u,{type:"arrayBuffer"}),l)};function Ie(u){if(!u||u.indexOf("://")<=0||u.indexOf("data:image/")===0||u.indexOf("blob:")===0)return!0;let l=new URL(u),f=window.location;return l.protocol===f.protocol&&l.host===f.host}function en(u,l,f){f[u]&&f[u].indexOf(l)!==-1||(f[u]=f[u]||[],f[u].push(l))}function xi(u,l,f){if(f&&f[u]){let x=f[u].indexOf(l);x!==-1&&f[u].splice(x,1)}}class rn{constructor(l,f={}){nt(this,f),this.type=l}}class fn extends rn{constructor(l,f={}){super("error",nt({error:l},f))}}class Er{on(l,f){return this._listeners=this._listeners||{},en(l,f,this._listeners),this}off(l,f){return xi(l,f,this._listeners),xi(l,f,this._oneTimeListeners),this}once(l,f){return f?(this._oneTimeListeners=this._oneTimeListeners||{},en(l,f,this._oneTimeListeners),this):new Promise(x=>this.once(l,x))}fire(l,f){typeof l=="string"&&(l=new rn(l,f||{}));let x=l.type;if(this.listens(x)){l.target=this;let S=this._listeners&&this._listeners[x]?this._listeners[x].slice():[];for(let F of S)F.call(this,l);let k=this._oneTimeListeners&&this._oneTimeListeners[x]?this._oneTimeListeners[x].slice():[];for(let F of k)xi(x,F,this._oneTimeListeners),F.call(this,l);let D=this._eventedParent;D&&(nt(l,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),D.fire(l))}else l instanceof fn&&console.error(l.error);return this}listens(l){return this._listeners&&this._listeners[l]&&this._listeners[l].length>0||this._oneTimeListeners&&this._oneTimeListeners[l]&&this._oneTimeListeners[l].length>0||this._eventedParent&&this._eventedParent.listens(l)}setEventedParent(l,f){return this._eventedParent=l,this._eventedParentData=f,this}}var ae={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};let Gn=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function an(u,l){let f={};for(let x in u)x!=="ref"&&(f[x]=u[x]);return Gn.forEach(x=>{x in l&&(f[x]=l[x])}),f}function Ji(u,l){if(Array.isArray(u)){if(!Array.isArray(l)||u.length!==l.length)return!1;for(let f=0;f<u.length;f++)if(!Ji(u[f],l[f]))return!1;return!0}if(typeof u=="object"&&u!==null&&l!==null){if(typeof l!="object"||Object.keys(u).length!==Object.keys(l).length)return!1;for(let f in u)if(!Ji(u[f],l[f]))return!1;return!0}return u===l}let $i={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function zo(u,l,f){f.push({command:$i.addSource,args:[u,l[u]]})}function Pu(u,l,f){l.push({command:$i.removeSource,args:[u]}),f[u]=!0}function Rl(u,l,f,x){Pu(u,f,x),zo(u,l,f)}function Zo(u,l,f){let x;for(x in u[f])if(Object.prototype.hasOwnProperty.call(u[f],x)&&x!=="data"&&!Ji(u[f][x],l[f][x]))return!1;for(x in l[f])if(Object.prototype.hasOwnProperty.call(l[f],x)&&x!=="data"&&!Ji(u[f][x],l[f][x]))return!1;return!0}function kl(u,l,f,x,S,k){let D;for(D in l=l||{},u=u||{})Object.prototype.hasOwnProperty.call(u,D)&&(Ji(u[D],l[D])||f.push({command:k,args:[x,D,l[D],S]}));for(D in l)Object.prototype.hasOwnProperty.call(l,D)&&!Object.prototype.hasOwnProperty.call(u,D)&&(Ji(u[D],l[D])||f.push({command:k,args:[x,D,l[D],S]}))}function rl(u){return u.id}function Go(u,l){return u[l.id]=l,u}class Ne{constructor(l,f,x,S){this.message=(l?`${l}: `:"")+x,S&&(this.identifier=S),f!=null&&f.__line__&&(this.line=f.__line__)}}function la(u,...l){for(let f of l)for(let x in f)u[x]=f[x];return u}class Qn extends Error{constructor(l,f){super(f),this.message=f,this.key=l}}class nc{constructor(l,f=[]){this.parent=l,this.bindings={};for(let[x,S]of f)this.bindings[x]=S}concat(l){return new nc(this,l)}get(l){if(this.bindings[l])return this.bindings[l];if(this.parent)return this.parent.get(l);throw new Error(`${l} not found in scope.`)}has(l){return!!this.bindings[l]||!!this.parent&&this.parent.has(l)}}let il={kind:"null"},Ue={kind:"number"},ni={kind:"string"},Nr={kind:"boolean"},xo={kind:"color"},nl={kind:"object"},qr={kind:"value"},Ma={kind:"collator"},Ct={kind:"formatted"},rt={kind:"padding"},at={kind:"resolvedImage"},mt={kind:"variableAnchorOffsetCollection"};function Dt(u,l){return{kind:"array",itemType:u,N:l}}function Ot(u){if(u.kind==="array"){let l=Ot(u.itemType);return typeof u.N=="number"?`array<${l}, ${u.N}>`:u.itemType.kind==="value"?"array":`array<${l}>`}return u.kind}let It=[il,Ue,ni,Nr,xo,Ct,nl,Dt(qr),rt,at,mt];function Yt(u,l){if(l.kind==="error")return null;if(u.kind==="array"){if(l.kind==="array"&&(l.N===0&&l.itemType.kind==="value"||!Yt(u.itemType,l.itemType))&&(typeof u.N!="number"||u.N===l.N))return null}else{if(u.kind===l.kind)return null;if(u.kind==="value"){for(let f of It)if(!Yt(f,l))return null}}return`Expected ${Ot(u)} but found ${Ot(l)} instead.`}function Ft(u,l){return l.some(f=>f.kind===u.kind)}function Qt(u,l){return l.some(f=>f==="null"?u===null:f==="array"?Array.isArray(u):f==="object"?u&&!Array.isArray(u)&&typeof u=="object":f===typeof u)}function _e(u,l){return u.kind==="array"&&l.kind==="array"?u.itemType.kind===l.itemType.kind&&typeof u.N=="number":u.kind===l.kind}let ye=.96422,be=.82521,br=4/29,Lr=6/29,cr=3*Lr*Lr,vr=Lr*Lr*Lr,jr=Math.PI/180,ln=180/Math.PI;function yn(u){return(u%=360)<0&&(u+=360),u}function Vi([u,l,f,x]){let S,k,D=Ps((.2225045*(u=Ai(u))+.7168786*(l=Ai(l))+.0606169*(f=Ai(f)))/1);u===l&&l===f?S=k=D:(S=Ps((.4360747*u+.3850649*l+.1430804*f)/ye),k=Ps((.0139322*u+.0971045*l+.7141733*f)/be));let F=116*D-16;return[F<0?0:F,500*(S-D),200*(D-k),x]}function Ai(u){return u<=.04045?u/12.92:Math.pow((u+.055)/1.055,2.4)}function Ps(u){return u>vr?Math.pow(u,1/3):u/cr+br}function pn([u,l,f,x]){let S=(u+16)/116,k=isNaN(l)?S:S+l/500,D=isNaN(f)?S:S-f/200;return S=1*zs(S),k=ye*zs(k),D=be*zs(D),[ns(3.1338561*k-1.6168667*S-.4906146*D),ns(-.9787684*k+1.9161415*S+.033454*D),ns(.0719453*k-.2289914*S+1.4052427*D),x]}function ns(u){return(u=u<=.00304?12.92*u:1.055*Math.pow(u,1/2.4)-.055)<0?0:u>1?1:u}function zs(u){return u>Lr?u*u*u:cr*(u-br)}function Ca(u){return parseInt(u.padEnd(2,u),16)/255}function HA(u,l){return sc(l?u/100:u,0,1)}function sc(u,l,f){return Math.min(Math.max(l,u),f)}function oo(u){return!u.some(Number.isNaN)}let kh={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class Hi{constructor(l,f,x,S=1,k=!0){this.r=l,this.g=f,this.b=x,this.a=S,k||(this.r*=S,this.g*=S,this.b*=S,S||this.overwriteGetter("rgb",[l,f,x,S]))}static parse(l){if(l instanceof Hi)return l;if(typeof l!="string")return;let f=function(x){if((x=x.toLowerCase().trim())==="transparent")return[0,0,0,0];let S=kh[x];if(S){let[D,F,j]=S;return[D/255,F/255,j/255,1]}if(x.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(x)){let D=x.length<6?1:2,F=1;return[Ca(x.slice(F,F+=D)),Ca(x.slice(F,F+=D)),Ca(x.slice(F,F+=D)),Ca(x.slice(F,F+D)||"ff")]}if(x.startsWith("rgb")){let D=x.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(D){let[F,j,Y,K,et,st,ct,ht,Tt,Nt,Ut,Kt]=D,Ht=[K||" ",ct||" ",Nt].join("");if(Ht==="  "||Ht==="  /"||Ht===",,"||Ht===",,,"){let Jt=[Y,st,Tt].join(""),le=Jt==="%%%"?100:Jt===""?255:0;if(le){let ve=[sc(+j/le,0,1),sc(+et/le,0,1),sc(+ht/le,0,1),Ut?HA(+Ut,Kt):1];if(oo(ve))return ve}}return}}let k=x.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(k){let[D,F,j,Y,K,et,st,ct,ht]=k,Tt=[j||" ",K||" ",st].join("");if(Tt==="  "||Tt==="  /"||Tt===",,"||Tt===",,,"){let Nt=[+F,sc(+Y,0,100),sc(+et,0,100),ct?HA(+ct,ht):1];if(oo(Nt))return function([Ut,Kt,Ht,Jt]){function le(ve){let Ke=(ve+Ut/30)%12,mr=Kt*Math.min(Ht,1-Ht);return Ht-mr*Math.max(-1,Math.min(Ke-3,9-Ke,1))}return Ut=yn(Ut),Kt/=100,Ht/=100,[le(0),le(8),le(4),Jt]}(Nt)}}}(l);return f?new Hi(...f,!1):void 0}get rgb(){let{r:l,g:f,b:x,a:S}=this,k=S||1/0;return this.overwriteGetter("rgb",[l/k,f/k,x/k,S])}get hcl(){return this.overwriteGetter("hcl",function(l){let[f,x,S,k]=Vi(l),D=Math.sqrt(x*x+S*S);return[Math.round(1e4*D)?yn(Math.atan2(S,x)*ln):NaN,D,f,k]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Vi(this.rgb))}overwriteGetter(l,f){return Object.defineProperty(this,l,{value:f}),f}toString(){let[l,f,x,S]=this.rgb;return`rgba(${[l,f,x].map(k=>Math.round(255*k)).join(",")},${S})`}}Hi.black=new Hi(0,0,0,1),Hi.white=new Hi(1,1,1,1),Hi.transparent=new Hi(0,0,0,0),Hi.red=new Hi(1,0,0,1);class sl{constructor(l,f,x){this.sensitivity=l?f?"variant":"case":f?"accent":"base",this.locale=x,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(l,f){return this.collator.compare(l,f)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Xc{constructor(l,f,x,S,k){this.text=l,this.image=f,this.scale=x,this.fontStack=S,this.textColor=k}}class Hn{constructor(l){this.sections=l}static fromString(l){return new Hn([new Xc(l,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(l=>l.text.length!==0||l.image&&l.image.name.length!==0)}static factory(l){return l instanceof Hn?l:Hn.fromString(l)}toString(){return this.sections.length===0?"":this.sections.map(l=>l.text).join("")}}class bs{constructor(l){this.values=l.slice()}static parse(l){if(l instanceof bs)return l;if(typeof l=="number")return new bs([l,l,l,l]);if(Array.isArray(l)&&!(l.length<1||l.length>4)){for(let f of l)if(typeof f!="number")return;switch(l.length){case 1:l=[l[0],l[0],l[0],l[0]];break;case 2:l=[l[0],l[1],l[0],l[1]];break;case 3:l=[l[0],l[1],l[2],l[1]]}return new bs(l)}}toString(){return JSON.stringify(this.values)}}let qA=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class ca{constructor(l){this.values=l.slice()}static parse(l){if(l instanceof ca)return l;if(Array.isArray(l)&&!(l.length<1)&&l.length%2==0){for(let f=0;f<l.length;f+=2){let x=l[f],S=l[f+1];if(typeof x!="string"||!qA.has(x)||!Array.isArray(S)||S.length!==2||typeof S[0]!="number"||typeof S[1]!="number")return}return new ca(l)}}toString(){return JSON.stringify(this.values)}}class Rs{constructor(l){this.name=l.name,this.available=l.available}toString(){return this.name}static fromString(l){return l?new Rs({name:l,available:!1}):null}}function Uo(u,l,f,x){return typeof u=="number"&&u>=0&&u<=255&&typeof l=="number"&&l>=0&&l<=255&&typeof f=="number"&&f>=0&&f<=255?x===void 0||typeof x=="number"&&x>=0&&x<=1?null:`Invalid rgba value [${[u,l,f,x].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof x=="number"?[u,l,f,x]:[u,l,f]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function oc(u){if(u===null||typeof u=="string"||typeof u=="boolean"||typeof u=="number"||u instanceof Hi||u instanceof sl||u instanceof Hn||u instanceof bs||u instanceof ca||u instanceof Rs)return!0;if(Array.isArray(u)){for(let l of u)if(!oc(l))return!1;return!0}if(typeof u=="object"){for(let l in u)if(!oc(u[l]))return!1;return!0}return!1}function zn(u){if(u===null)return il;if(typeof u=="string")return ni;if(typeof u=="boolean")return Nr;if(typeof u=="number")return Ue;if(u instanceof Hi)return xo;if(u instanceof sl)return Ma;if(u instanceof Hn)return Ct;if(u instanceof bs)return rt;if(u instanceof ca)return mt;if(u instanceof Rs)return at;if(Array.isArray(u)){let l=u.length,f;for(let x of u){let S=zn(x);if(f){if(f===S)continue;f=qr;break}f=S}return Dt(f||qr,l)}return nl}function tn(u){let l=typeof u;return u===null?"":l==="string"||l==="number"||l==="boolean"?String(u):u instanceof Hi||u instanceof Hn||u instanceof bs||u instanceof ca||u instanceof Rs?u.toString():JSON.stringify(u)}class ac{constructor(l,f){this.type=l,this.value=f}static parse(l,f){if(l.length!==2)return f.error(`'literal' expression requires exactly one argument, but found ${l.length-1} instead.`);if(!oc(l[1]))return f.error("invalid value");let x=l[1],S=zn(x),k=f.expectedType;return S.kind!=="array"||S.N!==0||!k||k.kind!=="array"||typeof k.N=="number"&&k.N!==0||(S=k),new ac(S,x)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class qn{constructor(l){this.name="ExpressionEvaluationError",this.message=l}toJSON(){return this.message}}let Ru={string:ni,number:Ue,boolean:Nr,object:nl};class ks{constructor(l,f){this.type=l,this.args=f}static parse(l,f){if(l.length<2)return f.error("Expected at least one argument.");let x,S=1,k=l[0];if(k==="array"){let F,j;if(l.length>2){let Y=l[1];if(typeof Y!="string"||!(Y in Ru)||Y==="object")return f.error('The item type argument of "array" must be one of string, number, boolean',1);F=Ru[Y],S++}else F=qr;if(l.length>3){if(l[2]!==null&&(typeof l[2]!="number"||l[2]<0||l[2]!==Math.floor(l[2])))return f.error('The length argument to "array" must be a positive integer literal',2);j=l[2],S++}x=Dt(F,j)}else{if(!Ru[k])throw new Error(`Types doesn't contain name = ${k}`);x=Ru[k]}let D=[];for(;S<l.length;S++){let F=f.parse(l[S],S,qr);if(!F)return null;D.push(F)}return new ks(x,D)}evaluate(l){for(let f=0;f<this.args.length;f++){let x=this.args[f].evaluate(l);if(!Yt(this.type,zn(x)))return x;if(f===this.args.length-1)throw new qn(`Expected value to be of type ${Ot(this.type)}, but found ${Ot(zn(x))} instead.`)}throw new Error}eachChild(l){this.args.forEach(l)}outputDefined(){return this.args.every(l=>l.outputDefined())}}let Z0={"to-boolean":Nr,"to-color":xo,"to-number":Ue,"to-string":ni};class lc{constructor(l,f){this.type=l,this.args=f}static parse(l,f){if(l.length<2)return f.error("Expected at least one argument.");let x=l[0];if(!Z0[x])throw new Error(`Can't parse ${x} as it is not part of the known types`);if((x==="to-boolean"||x==="to-string")&&l.length!==2)return f.error("Expected one argument.");let S=Z0[x],k=[];for(let D=1;D<l.length;D++){let F=f.parse(l[D],D,qr);if(!F)return null;k.push(F)}return new lc(S,k)}evaluate(l){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(l);case"color":{let f,x;for(let S of this.args){if(f=S.evaluate(l),x=null,f instanceof Hi)return f;if(typeof f=="string"){let k=l.parseColor(f);if(k)return k}else if(Array.isArray(f)&&(x=f.length<3||f.length>4?`Invalid rbga value ${JSON.stringify(f)}: expected an array containing either three or four numeric values.`:Uo(f[0],f[1],f[2],f[3]),!x))return new Hi(f[0]/255,f[1]/255,f[2]/255,f[3])}throw new qn(x||`Could not parse color from value '${typeof f=="string"?f:JSON.stringify(f)}'`)}case"padding":{let f;for(let x of this.args){f=x.evaluate(l);let S=bs.parse(f);if(S)return S}throw new qn(`Could not parse padding from value '${typeof f=="string"?f:JSON.stringify(f)}'`)}case"variableAnchorOffsetCollection":{let f;for(let x of this.args){f=x.evaluate(l);let S=ca.parse(f);if(S)return S}throw new qn(`Could not parse variableAnchorOffsetCollection from value '${typeof f=="string"?f:JSON.stringify(f)}'`)}case"number":{let f=null;for(let x of this.args){if(f=x.evaluate(l),f===null)return 0;let S=Number(f);if(!isNaN(S))return S}throw new qn(`Could not convert ${JSON.stringify(f)} to number.`)}case"formatted":return Hn.fromString(tn(this.args[0].evaluate(l)));case"resolvedImage":return Rs.fromString(tn(this.args[0].evaluate(l)));default:return tn(this.args[0].evaluate(l))}}eachChild(l){this.args.forEach(l)}outputDefined(){return this.args.every(l=>l.outputDefined())}}let ad=["Unknown","Point","LineString","Polygon"];class ld{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?ad[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(l){let f=this._parseColorCache[l];return f||(f=this._parseColorCache[l]=Hi.parse(l)),f}}class cd{constructor(l,f,x=[],S,k=new nc,D=[]){this.registry=l,this.path=x,this.key=x.map(F=>`[${F}]`).join(""),this.scope=k,this.errors=D,this.expectedType=S,this._isConstant=f}parse(l,f,x,S,k={}){return f?this.concat(f,x,S)._parse(l,k):this._parse(l,k)}_parse(l,f){function x(S,k,D){return D==="assert"?new ks(k,[S]):D==="coerce"?new lc(k,[S]):S}if(l!==null&&typeof l!="string"&&typeof l!="boolean"&&typeof l!="number"||(l=["literal",l]),Array.isArray(l)){if(l.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');let S=l[0];if(typeof S!="string")return this.error(`Expression name must be a string, but found ${typeof S} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;let k=this.registry[S];if(k){let D=k.parse(l,this);if(!D)return null;if(this.expectedType){let F=this.expectedType,j=D.type;if(F.kind!=="string"&&F.kind!=="number"&&F.kind!=="boolean"&&F.kind!=="object"&&F.kind!=="array"||j.kind!=="value")if(F.kind!=="color"&&F.kind!=="formatted"&&F.kind!=="resolvedImage"||j.kind!=="value"&&j.kind!=="string")if(F.kind!=="padding"||j.kind!=="value"&&j.kind!=="number"&&j.kind!=="array")if(F.kind!=="variableAnchorOffsetCollection"||j.kind!=="value"&&j.kind!=="array"){if(this.checkSubtype(F,j))return null}else D=x(D,F,f.typeAnnotation||"coerce");else D=x(D,F,f.typeAnnotation||"coerce");else D=x(D,F,f.typeAnnotation||"coerce");else D=x(D,F,f.typeAnnotation||"assert")}if(!(D instanceof ac)&&D.type.kind!=="resolvedImage"&&this._isConstant(D)){let F=new ld;try{D=new ac(D.type,D.evaluate(F))}catch(j){return this.error(j.message),null}}return D}return this.error(`Unknown expression "${S}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(l===void 0?"'undefined' value invalid. Use null instead.":typeof l=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof l} instead.`)}concat(l,f,x){let S=typeof l=="number"?this.path.concat(l):this.path,k=x?this.scope.concat(x):this.scope;return new cd(this.registry,this._isConstant,S,f||null,k,this.errors)}error(l,...f){let x=`${this.key}${f.map(S=>`[${S}]`).join("")}`;this.errors.push(new Qn(x,l))}checkSubtype(l,f){let x=Yt(l,f);return x&&this.error(x),x}}class ud{constructor(l,f,x){this.type=Ma,this.locale=x,this.caseSensitive=l,this.diacriticSensitive=f}static parse(l,f){if(l.length!==2)return f.error("Expected one argument.");let x=l[1];if(typeof x!="object"||Array.isArray(x))return f.error("Collator options argument must be an object.");let S=f.parse(x["case-sensitive"]!==void 0&&x["case-sensitive"],1,Nr);if(!S)return null;let k=f.parse(x["diacritic-sensitive"]!==void 0&&x["diacritic-sensitive"],1,Nr);if(!k)return null;let D=null;return x.locale&&(D=f.parse(x.locale,1,ni),!D)?null:new ud(S,k,D)}evaluate(l){return new sl(this.caseSensitive.evaluate(l),this.diacriticSensitive.evaluate(l),this.locale?this.locale.evaluate(l):null)}eachChild(l){l(this.caseSensitive),l(this.diacriticSensitive),this.locale&&l(this.locale)}outputDefined(){return!1}}let ut=8192;function gt(u,l){u[0]=Math.min(u[0],l[0]),u[1]=Math.min(u[1],l[1]),u[2]=Math.max(u[2],l[0]),u[3]=Math.max(u[3],l[1])}function Wt(u,l){return!(u[0]<=l[0]||u[2]>=l[2]||u[1]<=l[1]||u[3]>=l[3])}function pe(u,l){let f=(180+u[0])/360,x=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+u[1]*Math.PI/360)))/360,S=Math.pow(2,l.z);return[Math.round(f*S*ut),Math.round(x*S*ut)]}function Be(u,l,f){let x=u[0]-l[0],S=u[1]-l[1],k=u[0]-f[0],D=u[1]-f[1];return x*D-k*S==0&&x*k<=0&&S*D<=0}function lr(u,l){let f=!1;for(let D=0,F=l.length;D<F;D++){let j=l[D];for(let Y=0,K=j.length;Y<K-1;Y++){if(Be(u,j[Y],j[Y+1]))return!1;(S=j[Y])[1]>(x=u)[1]!=(k=j[Y+1])[1]>x[1]&&x[0]<(k[0]-S[0])*(x[1]-S[1])/(k[1]-S[1])+S[0]&&(f=!f)}}var x,S,k;return f}function ki(u,l){for(let f=0;f<l.length;f++)if(lr(u,l[f]))return!0;return!1}function Us(u,l,f,x){let S=x[0]-f[0],k=x[1]-f[1],D=(u[0]-f[0])*k-S*(u[1]-f[1]),F=(l[0]-f[0])*k-S*(l[1]-f[1]);return D>0&&F<0||D<0&&F>0}function ao(u,l,f){for(let Y of f)for(let K=0;K<Y.length-1;++K)if((F=[(D=Y[K+1])[0]-(k=Y[K])[0],D[1]-k[1]])[0]*(j=[(S=l)[0]-(x=u)[0],S[1]-x[1]])[1]-F[1]*j[0]!=0&&Us(x,S,k,D)&&Us(k,D,x,S))return!0;var x,S,k,D,F,j;return!1}function bo(u,l){for(let f=0;f<u.length;++f)if(!lr(u[f],l))return!1;for(let f=0;f<u.length-1;++f)if(ao(u[f],u[f+1],l))return!1;return!0}function ol(u,l){for(let f=0;f<l.length;f++)if(bo(u,l[f]))return!0;return!1}function YA(u,l,f){let x=[];for(let S=0;S<u.length;S++){let k=[];for(let D=0;D<u[S].length;D++){let F=pe(u[S][D],f);gt(l,F),k.push(F)}x.push(k)}return x}function Bb(u,l,f){let x=[];for(let S=0;S<u.length;S++){let k=YA(u[S],l,f);x.push(k)}return x}function Nb(u,l,f,x){if(u[0]<f[0]||u[0]>f[2]){let S=.5*x,k=u[0]-f[0]>S?-x:f[0]-u[0]>S?x:0;k===0&&(k=u[0]-f[2]>S?-x:f[2]-u[0]>S?x:0),u[0]+=k}gt(l,u)}function q_(u,l,f,x){let S=Math.pow(2,x.z)*ut,k=[x.x*ut,x.y*ut],D=[];for(let F of u)for(let j of F){let Y=[j.x+k[0],j.y+k[1]];Nb(Y,l,f,S),D.push(Y)}return D}function Y_(u,l,f,x){let S=Math.pow(2,x.z)*ut,k=[x.x*ut,x.y*ut],D=[];for(let j of u){let Y=[];for(let K of j){let et=[K.x+k[0],K.y+k[1]];gt(l,et),Y.push(et)}D.push(Y)}if(l[2]-l[0]<=S/2){(F=l)[0]=F[1]=1/0,F[2]=F[3]=-1/0;for(let j of D)for(let Y of j)Nb(Y,l,f,S)}var F;return D}class Df{constructor(l,f){this.type=Nr,this.geojson=l,this.geometries=f}static parse(l,f){if(l.length!==2)return f.error(`'within' expression requires exactly one argument, but found ${l.length-1} instead.`);if(oc(l[1])){let x=l[1];if(x.type==="FeatureCollection")for(let S=0;S<x.features.length;++S){let k=x.features[S].geometry.type;if(k==="Polygon"||k==="MultiPolygon")return new Df(x,x.features[S].geometry)}else if(x.type==="Feature"){let S=x.geometry.type;if(S==="Polygon"||S==="MultiPolygon")return new Df(x,x.geometry)}else if(x.type==="Polygon"||x.type==="MultiPolygon")return new Df(x,x)}return f.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(l){if(l.geometry()!=null&&l.canonicalID()!=null){if(l.geometryType()==="Point")return function(f,x){let S=[1/0,1/0,-1/0,-1/0],k=[1/0,1/0,-1/0,-1/0],D=f.canonicalID();if(x.type==="Polygon"){let F=YA(x.coordinates,k,D),j=q_(f.geometry(),S,k,D);if(!Wt(S,k))return!1;for(let Y of j)if(!lr(Y,F))return!1}if(x.type==="MultiPolygon"){let F=Bb(x.coordinates,k,D),j=q_(f.geometry(),S,k,D);if(!Wt(S,k))return!1;for(let Y of j)if(!ki(Y,F))return!1}return!0}(l,this.geometries);if(l.geometryType()==="LineString")return function(f,x){let S=[1/0,1/0,-1/0,-1/0],k=[1/0,1/0,-1/0,-1/0],D=f.canonicalID();if(x.type==="Polygon"){let F=YA(x.coordinates,k,D),j=Y_(f.geometry(),S,k,D);if(!Wt(S,k))return!1;for(let Y of j)if(!bo(Y,F))return!1}if(x.type==="MultiPolygon"){let F=Bb(x.coordinates,k,D),j=Y_(f.geometry(),S,k,D);if(!Wt(S,k))return!1;for(let Y of j)if(!ol(Y,F))return!1}return!0}(l,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class XA{constructor(l,f){this.type=f.type,this.name=l,this.boundExpression=f}static parse(l,f){if(l.length!==2||typeof l[1]!="string")return f.error("'var' expression requires exactly one string literal argument.");let x=l[1];return f.scope.has(x)?new XA(x,f.scope.get(x)):f.error(`Unknown variable "${x}". Make sure "${x}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(l){return this.boundExpression.evaluate(l)}eachChild(){}outputDefined(){return!1}}class Dl{constructor(l,f,x,S){this.name=l,this.type=f,this._evaluate=x,this.args=S}evaluate(l){return this._evaluate(l,this.args)}eachChild(l){this.args.forEach(l)}outputDefined(){return!1}static parse(l,f){let x=l[0],S=Dl.definitions[x];if(!S)return f.error(`Unknown expression "${x}". If you wanted a literal array, use ["literal", [...]].`,0);let k=Array.isArray(S)?S[0]:S.type,D=Array.isArray(S)?[[S[1],S[2]]]:S.overloads,F=D.filter(([Y])=>!Array.isArray(Y)||Y.length===l.length-1),j=null;for(let[Y,K]of F){j=new cd(f.registry,ZA,f.path,null,f.scope);let et=[],st=!1;for(let ct=1;ct<l.length;ct++){let ht=l[ct],Tt=Array.isArray(Y)?Y[ct-1]:Y.type,Nt=j.parse(ht,1+et.length,Tt);if(!Nt){st=!0;break}et.push(Nt)}if(!st)if(Array.isArray(Y)&&Y.length!==et.length)j.error(`Expected ${Y.length} arguments, but found ${et.length} instead.`);else{for(let ct=0;ct<et.length;ct++){let ht=Array.isArray(Y)?Y[ct]:Y.type,Tt=et[ct];j.concat(ct+1).checkSubtype(ht,Tt.type)}if(j.errors.length===0)return new Dl(x,k,K,et)}}if(F.length===1)f.errors.push(...j.errors);else{let Y=(F.length?F:D).map(([et])=>{return st=et,Array.isArray(st)?`(${st.map(Ot).join(", ")})`:`(${Ot(st.type)}...)`;var st}).join(" | "),K=[];for(let et=1;et<l.length;et++){let st=f.parse(l[et],1+K.length);if(!st)return null;K.push(Ot(st.type))}f.error(`Expected arguments of type ${Y}, but found (${K.join(", ")}) instead.`)}return null}static register(l,f){Dl.definitions=f;for(let x in f)l[x]=Dl}}function ZA(u){if(u instanceof XA)return ZA(u.boundExpression);if(u instanceof Dl&&u.name==="error"||u instanceof ud||u instanceof Df)return!1;let l=u instanceof lc||u instanceof ks,f=!0;return u.eachChild(x=>{f=l?f&&ZA(x):f&&x instanceof ac}),!!f&&GA(u)&&QA(u,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function GA(u){if(u instanceof Dl&&(u.name==="get"&&u.args.length===1||u.name==="feature-state"||u.name==="has"&&u.args.length===1||u.name==="properties"||u.name==="geometry-type"||u.name==="id"||/^filter-/.test(u.name))||u instanceof Df)return!1;let l=!0;return u.eachChild(f=>{l&&!GA(f)&&(l=!1)}),l}function G0(u){if(u instanceof Dl&&u.name==="feature-state")return!1;let l=!0;return u.eachChild(f=>{l&&!G0(f)&&(l=!1)}),l}function QA(u,l){if(u instanceof Dl&&l.indexOf(u.name)>=0)return!1;let f=!0;return u.eachChild(x=>{f&&!QA(x,l)&&(f=!1)}),f}function hd(u,l){let f=u.length-1,x,S,k=0,D=f,F=0;for(;k<=D;)if(F=Math.floor((k+D)/2),x=u[F],S=u[F+1],x<=l){if(F===f||l<S)return F;k=F+1}else{if(!(x>l))throw new qn("Input is not a number.");D=F-1}return 0}class Dh{constructor(l,f,x){this.type=l,this.input=f,this.labels=[],this.outputs=[];for(let[S,k]of x)this.labels.push(S),this.outputs.push(k)}static parse(l,f){if(l.length-1<4)return f.error(`Expected at least 4 arguments, but found only ${l.length-1}.`);if((l.length-1)%2!=0)return f.error("Expected an even number of arguments.");let x=f.parse(l[1],1,Ue);if(!x)return null;let S=[],k=null;f.expectedType&&f.expectedType.kind!=="value"&&(k=f.expectedType);for(let D=1;D<l.length;D+=2){let F=D===1?-1/0:l[D],j=l[D+1],Y=D,K=D+1;if(typeof F!="number")return f.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Y);if(S.length&&S[S.length-1][0]>=F)return f.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',Y);let et=f.parse(j,K,k);if(!et)return null;k=k||et.type,S.push([F,et])}return new Dh(k,x,S)}evaluate(l){let f=this.labels,x=this.outputs;if(f.length===1)return x[0].evaluate(l);let S=this.input.evaluate(l);if(S<=f[0])return x[0].evaluate(l);let k=f.length;return S>=f[k-1]?x[k-1].evaluate(l):x[hd(f,S)].evaluate(l)}eachChild(l){l(this.input);for(let f of this.outputs)l(f)}outputDefined(){return this.outputs.every(l=>l.outputDefined())}}function Xi(u,l,f){return u+f*(l-u)}function KA(u,l,f){return u.map((x,S)=>Xi(x,l[S],f))}let al={number:Xi,color:function(u,l,f,x="rgb"){switch(x){case"rgb":{let[S,k,D,F]=KA(u.rgb,l.rgb,f);return new Hi(S,k,D,F,!1)}case"hcl":{let[S,k,D,F]=u.hcl,[j,Y,K,et]=l.hcl,st,ct;if(isNaN(S)||isNaN(j))isNaN(S)?isNaN(j)?st=NaN:(st=j,D!==1&&D!==0||(ct=Y)):(st=S,K!==1&&K!==0||(ct=k));else{let Kt=j-S;j>S&&Kt>180?Kt-=360:j<S&&S-j>180&&(Kt+=360),st=S+f*Kt}let[ht,Tt,Nt,Ut]=function([Kt,Ht,Jt,le]){return Kt=isNaN(Kt)?0:Kt*jr,pn([Jt,Math.cos(Kt)*Ht,Math.sin(Kt)*Ht,le])}([st,ct??Xi(k,Y,f),Xi(D,K,f),Xi(F,et,f)]);return new Hi(ht,Tt,Nt,Ut,!1)}case"lab":{let[S,k,D,F]=pn(KA(u.lab,l.lab,f));return new Hi(S,k,D,F,!1)}}},array:KA,padding:function(u,l,f){return new bs(KA(u.values,l.values,f))},variableAnchorOffsetCollection:function(u,l,f){let x=u.values,S=l.values;if(x.length!==S.length)throw new qn(`Cannot interpolate values of different length. from: ${u.toString()}, to: ${l.toString()}`);let k=[];for(let D=0;D<x.length;D+=2){if(x[D]!==S[D])throw new qn(`Cannot interpolate values containing mismatched anchors. from[${D}]: ${x[D]}, to[${D}]: ${S[D]}`);k.push(x[D]);let[F,j]=x[D+1],[Y,K]=S[D+1];k.push([Xi(F,Y,f),Xi(j,K,f)])}return new ca(k)}};class ll{constructor(l,f,x,S,k){this.type=l,this.operator=f,this.interpolation=x,this.input=S,this.labels=[],this.outputs=[];for(let[D,F]of k)this.labels.push(D),this.outputs.push(F)}static interpolationFactor(l,f,x,S){let k=0;if(l.name==="exponential")k=X_(f,l.base,x,S);else if(l.name==="linear")k=X_(f,1,x,S);else if(l.name==="cubic-bezier"){let D=l.controlPoints;k=new C(D[0],D[1],D[2],D[3]).solve(X_(f,1,x,S))}return k}static parse(l,f){let[x,S,k,...D]=l;if(!Array.isArray(S)||S.length===0)return f.error("Expected an interpolation type expression.",1);if(S[0]==="linear")S={name:"linear"};else if(S[0]==="exponential"){let Y=S[1];if(typeof Y!="number")return f.error("Exponential interpolation requires a numeric base.",1,1);S={name:"exponential",base:Y}}else{if(S[0]!=="cubic-bezier")return f.error(`Unknown interpolation type ${String(S[0])}`,1,0);{let Y=S.slice(1);if(Y.length!==4||Y.some(K=>typeof K!="number"||K<0||K>1))return f.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);S={name:"cubic-bezier",controlPoints:Y}}}if(l.length-1<4)return f.error(`Expected at least 4 arguments, but found only ${l.length-1}.`);if((l.length-1)%2!=0)return f.error("Expected an even number of arguments.");if(k=f.parse(k,2,Ue),!k)return null;let F=[],j=null;x==="interpolate-hcl"||x==="interpolate-lab"?j=xo:f.expectedType&&f.expectedType.kind!=="value"&&(j=f.expectedType);for(let Y=0;Y<D.length;Y+=2){let K=D[Y],et=D[Y+1],st=Y+3,ct=Y+4;if(typeof K!="number")return f.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',st);if(F.length&&F[F.length-1][0]>=K)return f.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',st);let ht=f.parse(et,ct,j);if(!ht)return null;j=j||ht.type,F.push([K,ht])}return _e(j,Ue)||_e(j,xo)||_e(j,rt)||_e(j,mt)||_e(j,Dt(Ue))?new ll(j,x,S,k,F):f.error(`Type ${Ot(j)} is not interpolatable.`)}evaluate(l){let f=this.labels,x=this.outputs;if(f.length===1)return x[0].evaluate(l);let S=this.input.evaluate(l);if(S<=f[0])return x[0].evaluate(l);let k=f.length;if(S>=f[k-1])return x[k-1].evaluate(l);let D=hd(f,S),F=ll.interpolationFactor(this.interpolation,S,f[D],f[D+1]),j=x[D].evaluate(l),Y=x[D+1].evaluate(l);switch(this.operator){case"interpolate":return al[this.type.kind](j,Y,F);case"interpolate-hcl":return al.color(j,Y,F,"hcl");case"interpolate-lab":return al.color(j,Y,F,"lab")}}eachChild(l){l(this.input);for(let f of this.outputs)l(f)}outputDefined(){return this.outputs.every(l=>l.outputDefined())}}function X_(u,l,f,x){let S=x-f,k=u-f;return S===0?0:l===1?k/S:(Math.pow(l,k)-1)/(Math.pow(l,S)-1)}class JA{constructor(l,f){this.type=l,this.args=f}static parse(l,f){if(l.length<2)return f.error("Expectected at least one argument.");let x=null,S=f.expectedType;S&&S.kind!=="value"&&(x=S);let k=[];for(let F of l.slice(1)){let j=f.parse(F,1+k.length,x,void 0,{typeAnnotation:"omit"});if(!j)return null;x=x||j.type,k.push(j)}if(!x)throw new Error("No output type");let D=S&&k.some(F=>Yt(S,F.type));return new JA(D?qr:x,k)}evaluate(l){let f,x=null,S=0;for(let k of this.args)if(S++,x=k.evaluate(l),x&&x instanceof Rs&&!x.available&&(f||(f=x.name),x=null,S===this.args.length&&(x=f)),x!==null)break;return x}eachChild(l){this.args.forEach(l)}outputDefined(){return this.args.every(l=>l.outputDefined())}}class tg{constructor(l,f){this.type=f.type,this.bindings=[].concat(l),this.result=f}evaluate(l){return this.result.evaluate(l)}eachChild(l){for(let f of this.bindings)l(f[1]);l(this.result)}static parse(l,f){if(l.length<4)return f.error(`Expected at least 3 arguments, but found ${l.length-1} instead.`);let x=[];for(let k=1;k<l.length-1;k+=2){let D=l[k];if(typeof D!="string")return f.error(`Expected string, but found ${typeof D} instead.`,k);if(/[^a-zA-Z0-9_]/.test(D))return f.error("Variable names must contain only alphanumeric characters or '_'.",k);let F=f.parse(l[k+1],k+1);if(!F)return null;x.push([D,F])}let S=f.parse(l[l.length-1],l.length-1,f.expectedType,x);return S?new tg(x,S):null}outputDefined(){return this.result.outputDefined()}}class Z_{constructor(l,f,x){this.type=l,this.index=f,this.input=x}static parse(l,f){if(l.length!==3)return f.error(`Expected 2 arguments, but found ${l.length-1} instead.`);let x=f.parse(l[1],1,Ue),S=f.parse(l[2],2,Dt(f.expectedType||qr));return x&&S?new Z_(S.type.itemType,x,S):null}evaluate(l){let f=this.index.evaluate(l),x=this.input.evaluate(l);if(f<0)throw new qn(`Array index out of bounds: ${f} < 0.`);if(f>=x.length)throw new qn(`Array index out of bounds: ${f} > ${x.length-1}.`);if(f!==Math.floor(f))throw new qn(`Array index must be an integer, but found ${f} instead.`);return x[f]}eachChild(l){l(this.index),l(this.input)}outputDefined(){return!1}}class G_{constructor(l,f){this.type=Nr,this.needle=l,this.haystack=f}static parse(l,f){if(l.length!==3)return f.error(`Expected 2 arguments, but found ${l.length-1} instead.`);let x=f.parse(l[1],1,qr),S=f.parse(l[2],2,qr);return x&&S?Ft(x.type,[Nr,ni,Ue,il,qr])?new G_(x,S):f.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ot(x.type)} instead`):null}evaluate(l){let f=this.needle.evaluate(l),x=this.haystack.evaluate(l);if(!x)return!1;if(!Qt(f,["boolean","string","number","null"]))throw new qn(`Expected first argument to be of type boolean, string, number or null, but found ${Ot(zn(f))} instead.`);if(!Qt(x,["string","array"]))throw new qn(`Expected second argument to be of type array or string, but found ${Ot(zn(x))} instead.`);return x.indexOf(f)>=0}eachChild(l){l(this.needle),l(this.haystack)}outputDefined(){return!0}}class eg{constructor(l,f,x){this.type=Ue,this.needle=l,this.haystack=f,this.fromIndex=x}static parse(l,f){if(l.length<=2||l.length>=5)return f.error(`Expected 3 or 4 arguments, but found ${l.length-1} instead.`);let x=f.parse(l[1],1,qr),S=f.parse(l[2],2,qr);if(!x||!S)return null;if(!Ft(x.type,[Nr,ni,Ue,il,qr]))return f.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ot(x.type)} instead`);if(l.length===4){let k=f.parse(l[3],3,Ue);return k?new eg(x,S,k):null}return new eg(x,S)}evaluate(l){let f=this.needle.evaluate(l),x=this.haystack.evaluate(l);if(!Qt(f,["boolean","string","number","null"]))throw new qn(`Expected first argument to be of type boolean, string, number or null, but found ${Ot(zn(f))} instead.`);if(!Qt(x,["string","array"]))throw new qn(`Expected second argument to be of type array or string, but found ${Ot(zn(x))} instead.`);if(this.fromIndex){let S=this.fromIndex.evaluate(l);return x.indexOf(f,S)}return x.indexOf(f)}eachChild(l){l(this.needle),l(this.haystack),this.fromIndex&&l(this.fromIndex)}outputDefined(){return!1}}class Q_{constructor(l,f,x,S,k,D){this.inputType=l,this.type=f,this.input=x,this.cases=S,this.outputs=k,this.otherwise=D}static parse(l,f){if(l.length<5)return f.error(`Expected at least 4 arguments, but found only ${l.length-1}.`);if(l.length%2!=1)return f.error("Expected an even number of arguments.");let x,S;f.expectedType&&f.expectedType.kind!=="value"&&(S=f.expectedType);let k={},D=[];for(let Y=2;Y<l.length-1;Y+=2){let K=l[Y],et=l[Y+1];Array.isArray(K)||(K=[K]);let st=f.concat(Y);if(K.length===0)return st.error("Expected at least one branch label.");for(let ht of K){if(typeof ht!="number"&&typeof ht!="string")return st.error("Branch labels must be numbers or strings.");if(typeof ht=="number"&&Math.abs(ht)>Number.MAX_SAFE_INTEGER)return st.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof ht=="number"&&Math.floor(ht)!==ht)return st.error("Numeric branch labels must be integer values.");if(x){if(st.checkSubtype(x,zn(ht)))return null}else x=zn(ht);if(k[String(ht)]!==void 0)return st.error("Branch labels must be unique.");k[String(ht)]=D.length}let ct=f.parse(et,Y,S);if(!ct)return null;S=S||ct.type,D.push(ct)}let F=f.parse(l[1],1,qr);if(!F)return null;let j=f.parse(l[l.length-1],l.length-1,S);return j?F.type.kind!=="value"&&f.concat(1).checkSubtype(x,F.type)?null:new Q_(x,S,F,k,D,j):null}evaluate(l){let f=this.input.evaluate(l);return(zn(f)===this.inputType&&this.outputs[this.cases[f]]||this.otherwise).evaluate(l)}eachChild(l){l(this.input),this.outputs.forEach(l),l(this.otherwise)}outputDefined(){return this.outputs.every(l=>l.outputDefined())&&this.otherwise.outputDefined()}}class K_{constructor(l,f,x){this.type=l,this.branches=f,this.otherwise=x}static parse(l,f){if(l.length<4)return f.error(`Expected at least 3 arguments, but found only ${l.length-1}.`);if(l.length%2!=0)return f.error("Expected an odd number of arguments.");let x;f.expectedType&&f.expectedType.kind!=="value"&&(x=f.expectedType);let S=[];for(let D=1;D<l.length-1;D+=2){let F=f.parse(l[D],D,Nr);if(!F)return null;let j=f.parse(l[D+1],D+1,x);if(!j)return null;S.push([F,j]),x=x||j.type}let k=f.parse(l[l.length-1],l.length-1,x);if(!k)return null;if(!x)throw new Error("Can't infer output type");return new K_(x,S,k)}evaluate(l){for(let[f,x]of this.branches)if(f.evaluate(l))return x.evaluate(l);return this.otherwise.evaluate(l)}eachChild(l){for(let[f,x]of this.branches)l(f),l(x);l(this.otherwise)}outputDefined(){return this.branches.every(([l,f])=>f.outputDefined())&&this.otherwise.outputDefined()}}class rg{constructor(l,f,x,S){this.type=l,this.input=f,this.beginIndex=x,this.endIndex=S}static parse(l,f){if(l.length<=2||l.length>=5)return f.error(`Expected 3 or 4 arguments, but found ${l.length-1} instead.`);let x=f.parse(l[1],1,qr),S=f.parse(l[2],2,Ue);if(!x||!S)return null;if(!Ft(x.type,[Dt(qr),ni,qr]))return f.error(`Expected first argument to be of type array or string, but found ${Ot(x.type)} instead`);if(l.length===4){let k=f.parse(l[3],3,Ue);return k?new rg(x.type,x,S,k):null}return new rg(x.type,x,S)}evaluate(l){let f=this.input.evaluate(l),x=this.beginIndex.evaluate(l);if(!Qt(f,["string","array"]))throw new qn(`Expected first argument to be of type array or string, but found ${Ot(zn(f))} instead.`);if(this.endIndex){let S=this.endIndex.evaluate(l);return f.slice(x,S)}return f.slice(x)}eachChild(l){l(this.input),l(this.beginIndex),this.endIndex&&l(this.endIndex)}outputDefined(){return!1}}function Lb(u,l){return u==="=="||u==="!="?l.kind==="boolean"||l.kind==="string"||l.kind==="number"||l.kind==="null"||l.kind==="value":l.kind==="string"||l.kind==="number"||l.kind==="value"}function Fb(u,l,f,x){return x.compare(l,f)===0}function fd(u,l,f){let x=u!=="=="&&u!=="!=";return class YX{constructor(k,D,F){this.type=Nr,this.lhs=k,this.rhs=D,this.collator=F,this.hasUntypedArgument=k.type.kind==="value"||D.type.kind==="value"}static parse(k,D){if(k.length!==3&&k.length!==4)return D.error("Expected two or three arguments.");let F=k[0],j=D.parse(k[1],1,qr);if(!j)return null;if(!Lb(F,j.type))return D.concat(1).error(`"${F}" comparisons are not supported for type '${Ot(j.type)}'.`);let Y=D.parse(k[2],2,qr);if(!Y)return null;if(!Lb(F,Y.type))return D.concat(2).error(`"${F}" comparisons are not supported for type '${Ot(Y.type)}'.`);if(j.type.kind!==Y.type.kind&&j.type.kind!=="value"&&Y.type.kind!=="value")return D.error(`Cannot compare types '${Ot(j.type)}' and '${Ot(Y.type)}'.`);x&&(j.type.kind==="value"&&Y.type.kind!=="value"?j=new ks(Y.type,[j]):j.type.kind!=="value"&&Y.type.kind==="value"&&(Y=new ks(j.type,[Y])));let K=null;if(k.length===4){if(j.type.kind!=="string"&&Y.type.kind!=="string"&&j.type.kind!=="value"&&Y.type.kind!=="value")return D.error("Cannot use collator to compare non-string types.");if(K=D.parse(k[3],3,Ma),!K)return null}return new YX(j,Y,K)}evaluate(k){let D=this.lhs.evaluate(k),F=this.rhs.evaluate(k);if(x&&this.hasUntypedArgument){let j=zn(D),Y=zn(F);if(j.kind!==Y.kind||j.kind!=="string"&&j.kind!=="number")throw new qn(`Expected arguments for "${u}" to be (string, string) or (number, number), but found (${j.kind}, ${Y.kind}) instead.`)}if(this.collator&&!x&&this.hasUntypedArgument){let j=zn(D),Y=zn(F);if(j.kind!=="string"||Y.kind!=="string")return l(k,D,F)}return this.collator?f(k,D,F,this.collator.evaluate(k)):l(k,D,F)}eachChild(k){k(this.lhs),k(this.rhs),this.collator&&k(this.collator)}outputDefined(){return!0}}}let w4=fd("==",function(u,l,f){return l===f},Fb),T4=fd("!=",function(u,l,f){return l!==f},function(u,l,f,x){return!Fb(0,l,f,x)}),S4=fd("<",function(u,l,f){return l<f},function(u,l,f,x){return x.compare(l,f)<0}),E4=fd(">",function(u,l,f){return l>f},function(u,l,f,x){return x.compare(l,f)>0}),J_=fd("<=",function(u,l,f){return l<=f},function(u,l,f,x){return x.compare(l,f)<=0}),zb=fd(">=",function(u,l,f){return l>=f},function(u,l,f,x){return x.compare(l,f)>=0});class ig{constructor(l,f,x,S,k){this.type=ni,this.number=l,this.locale=f,this.currency=x,this.minFractionDigits=S,this.maxFractionDigits=k}static parse(l,f){if(l.length!==3)return f.error("Expected two arguments.");let x=f.parse(l[1],1,Ue);if(!x)return null;let S=l[2];if(typeof S!="object"||Array.isArray(S))return f.error("NumberFormat options argument must be an object.");let k=null;if(S.locale&&(k=f.parse(S.locale,1,ni),!k))return null;let D=null;if(S.currency&&(D=f.parse(S.currency,1,ni),!D))return null;let F=null;if(S["min-fraction-digits"]&&(F=f.parse(S["min-fraction-digits"],1,Ue),!F))return null;let j=null;return S["max-fraction-digits"]&&(j=f.parse(S["max-fraction-digits"],1,Ue),!j)?null:new ig(x,k,D,F,j)}evaluate(l){return new Intl.NumberFormat(this.locale?this.locale.evaluate(l):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(l):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(l):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(l):void 0}).format(this.number.evaluate(l))}eachChild(l){l(this.number),this.locale&&l(this.locale),this.currency&&l(this.currency),this.minFractionDigits&&l(this.minFractionDigits),this.maxFractionDigits&&l(this.maxFractionDigits)}outputDefined(){return!1}}class Of{constructor(l){this.type=Ct,this.sections=l}static parse(l,f){if(l.length<2)return f.error("Expected at least one argument.");let x=l[1];if(!Array.isArray(x)&&typeof x=="object")return f.error("First argument must be an image or text section.");let S=[],k=!1;for(let D=1;D<=l.length-1;++D){let F=l[D];if(k&&typeof F=="object"&&!Array.isArray(F)){k=!1;let j=null;if(F["font-scale"]&&(j=f.parse(F["font-scale"],1,Ue),!j))return null;let Y=null;if(F["text-font"]&&(Y=f.parse(F["text-font"],1,Dt(ni)),!Y))return null;let K=null;if(F["text-color"]&&(K=f.parse(F["text-color"],1,xo),!K))return null;let et=S[S.length-1];et.scale=j,et.font=Y,et.textColor=K}else{let j=f.parse(l[D],1,qr);if(!j)return null;let Y=j.type.kind;if(Y!=="string"&&Y!=="value"&&Y!=="null"&&Y!=="resolvedImage")return f.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");k=!0,S.push({content:j,scale:null,font:null,textColor:null})}}return new Of(S)}evaluate(l){return new Hn(this.sections.map(f=>{let x=f.content.evaluate(l);return zn(x)===at?new Xc("",x,null,null,null):new Xc(tn(x),null,f.scale?f.scale.evaluate(l):null,f.font?f.font.evaluate(l).join(","):null,f.textColor?f.textColor.evaluate(l):null)}))}eachChild(l){for(let f of this.sections)l(f.content),f.scale&&l(f.scale),f.font&&l(f.font),f.textColor&&l(f.textColor)}outputDefined(){return!1}}class Q0{constructor(l){this.type=at,this.input=l}static parse(l,f){if(l.length!==2)return f.error("Expected two arguments.");let x=f.parse(l[1],1,ni);return x?new Q0(x):f.error("No image name provided.")}evaluate(l){let f=this.input.evaluate(l),x=Rs.fromString(f);return x&&l.availableImages&&(x.available=l.availableImages.indexOf(f)>-1),x}eachChild(l){l(this.input)}outputDefined(){return!1}}class K0{constructor(l){this.type=Ue,this.input=l}static parse(l,f){if(l.length!==2)return f.error(`Expected 1 argument, but found ${l.length-1} instead.`);let x=f.parse(l[1],1);return x?x.type.kind!=="array"&&x.type.kind!=="string"&&x.type.kind!=="value"?f.error(`Expected argument of type string or array, but found ${Ot(x.type)} instead.`):new K0(x):null}evaluate(l){let f=this.input.evaluate(l);if(typeof f=="string"||Array.isArray(f))return f.length;throw new qn(`Expected value to be of type string or array, but found ${Ot(zn(f))} instead.`)}eachChild(l){l(this.input)}outputDefined(){return!1}}let Oh={"==":w4,"!=":T4,">":E4,"<":S4,">=":zb,"<=":J_,array:ks,at:Z_,boolean:ks,case:K_,coalesce:JA,collator:ud,format:Of,image:Q0,in:G_,"index-of":eg,interpolate:ll,"interpolate-hcl":ll,"interpolate-lab":ll,length:K0,let:tg,literal:ac,match:Q_,number:ks,"number-format":ig,object:ks,slice:rg,step:Dh,string:ks,"to-boolean":lc,"to-color":lc,"to-number":lc,"to-string":lc,var:XA,within:Df};function pd(u,[l,f,x,S]){l=l.evaluate(u),f=f.evaluate(u),x=x.evaluate(u);let k=S?S.evaluate(u):1,D=Uo(l,f,x,k);if(D)throw new qn(D);return new Hi(l/255,f/255,x/255,k,!1)}function J0(u,l){return u in l}function Zc(u,l){let f=l[u];return f===void 0?null:f}function oe(u){return{type:u}}function we(u){return{result:"success",value:u}}function We(u){return{result:"error",value:u}}function kr(u){return u["property-type"]==="data-driven"||u["property-type"]==="cross-faded-data-driven"}function _(u){return!!u.expression&&u.expression.parameters.indexOf("zoom")>-1}function wn(u){return!!u.expression&&u.expression.interpolated}function yr(u){return u instanceof Number?"number":u instanceof String?"string":u instanceof Boolean?"boolean":Array.isArray(u)?"array":u===null?"null":typeof u}function ft(u){return typeof u=="object"&&u!==null&&!Array.isArray(u)}function lo(u){return u}function Wr(u,l){let f=l.type==="color",x=u.stops&&typeof u.stops[0][0]=="object",S=x||!(x||u.property!==void 0),k=u.type||(wn(l)?"exponential":"interval");if(f||l.type==="padding"){let K=f?Hi.parse:bs.parse;(u=la({},u)).stops&&(u.stops=u.stops.map(et=>[et[0],K(et[1])])),u.default=K(u.default?u.default:l.default)}if(u.colorSpace&&(D=u.colorSpace)!=="rgb"&&D!=="hcl"&&D!=="lab")throw new Error(`Unknown color space: "${u.colorSpace}"`);var D;let F,j,Y;if(k==="exponential")F=vs;else if(k==="interval")F=Jr;else if(k==="categorical"){F=Fr,j=Object.create(null);for(let K of u.stops)j[K[0]]=K[1];Y=typeof u.stops[0][0]}else{if(k!=="identity")throw new Error(`Unknown function type "${k}"`);F=cn}if(x){let K={},et=[];for(let ht=0;ht<u.stops.length;ht++){let Tt=u.stops[ht],Nt=Tt[0].zoom;K[Nt]===void 0&&(K[Nt]={zoom:Nt,type:u.type,property:u.property,default:u.default,stops:[]},et.push(Nt)),K[Nt].stops.push([Tt[0].value,Tt[1]])}let st=[];for(let ht of et)st.push([K[ht].zoom,Wr(K[ht],l)]);let ct={name:"linear"};return{kind:"composite",interpolationType:ct,interpolationFactor:ll.interpolationFactor.bind(void 0,ct),zoomStops:st.map(ht=>ht[0]),evaluate:({zoom:ht},Tt)=>vs({stops:st,base:u.base},l,ht).evaluate(ht,Tt)}}if(S){let K=k==="exponential"?{name:"exponential",base:u.base!==void 0?u.base:1}:null;return{kind:"camera",interpolationType:K,interpolationFactor:ll.interpolationFactor.bind(void 0,K),zoomStops:u.stops.map(et=>et[0]),evaluate:({zoom:et})=>F(u,l,et,j,Y)}}return{kind:"source",evaluate(K,et){let st=et&&et.properties?et.properties[u.property]:void 0;return st===void 0?ss(u.default,l.default):F(u,l,st,j,Y)}}}function ss(u,l,f){return u!==void 0?u:l!==void 0?l:f!==void 0?f:void 0}function Fr(u,l,f,x,S){return ss(typeof f===S?x[f]:void 0,u.default,l.default)}function Jr(u,l,f){if(yr(f)!=="number")return ss(u.default,l.default);let x=u.stops.length;if(x===1||f<=u.stops[0][0])return u.stops[0][1];if(f>=u.stops[x-1][0])return u.stops[x-1][1];let S=hd(u.stops.map(k=>k[0]),f);return u.stops[S][1]}function vs(u,l,f){let x=u.base!==void 0?u.base:1;if(yr(f)!=="number")return ss(u.default,l.default);let S=u.stops.length;if(S===1||f<=u.stops[0][0])return u.stops[0][1];if(f>=u.stops[S-1][0])return u.stops[S-1][1];let k=hd(u.stops.map(K=>K[0]),f),D=function(K,et,st,ct){let ht=ct-st,Tt=K-st;return ht===0?0:et===1?Tt/ht:(Math.pow(et,Tt)-1)/(Math.pow(et,ht)-1)}(f,x,u.stops[k][0],u.stops[k+1][0]),F=u.stops[k][1],j=u.stops[k+1][1],Y=al[l.type]||lo;return typeof F.evaluate=="function"?{evaluate(...K){let et=F.evaluate.apply(void 0,K),st=j.evaluate.apply(void 0,K);if(et!==void 0&&st!==void 0)return Y(et,st,D,u.colorSpace)}}:Y(F,j,D,u.colorSpace)}function cn(u,l,f){switch(l.type){case"color":f=Hi.parse(f);break;case"formatted":f=Hn.fromString(f.toString());break;case"resolvedImage":f=Rs.fromString(f.toString());break;case"padding":f=bs.parse(f);break;default:yr(f)===l.type||l.type==="enum"&&l.values[f]||(f=void 0)}return ss(f,u.default,l.default)}Dl.register(Oh,{error:[{kind:"error"},[ni],(u,[l])=>{throw new qn(l.evaluate(u))}],typeof:[ni,[qr],(u,[l])=>Ot(zn(l.evaluate(u)))],"to-rgba":[Dt(Ue,4),[xo],(u,[l])=>{let[f,x,S,k]=l.evaluate(u).rgb;return[255*f,255*x,255*S,k]}],rgb:[xo,[Ue,Ue,Ue],pd],rgba:[xo,[Ue,Ue,Ue,Ue],pd],has:{type:Nr,overloads:[[[ni],(u,[l])=>J0(l.evaluate(u),u.properties())],[[ni,nl],(u,[l,f])=>J0(l.evaluate(u),f.evaluate(u))]]},get:{type:qr,overloads:[[[ni],(u,[l])=>Zc(l.evaluate(u),u.properties())],[[ni,nl],(u,[l,f])=>Zc(l.evaluate(u),f.evaluate(u))]]},"feature-state":[qr,[ni],(u,[l])=>Zc(l.evaluate(u),u.featureState||{})],properties:[nl,[],u=>u.properties()],"geometry-type":[ni,[],u=>u.geometryType()],id:[qr,[],u=>u.id()],zoom:[Ue,[],u=>u.globals.zoom],"heatmap-density":[Ue,[],u=>u.globals.heatmapDensity||0],"line-progress":[Ue,[],u=>u.globals.lineProgress||0],accumulated:[qr,[],u=>u.globals.accumulated===void 0?null:u.globals.accumulated],"+":[Ue,oe(Ue),(u,l)=>{let f=0;for(let x of l)f+=x.evaluate(u);return f}],"*":[Ue,oe(Ue),(u,l)=>{let f=1;for(let x of l)f*=x.evaluate(u);return f}],"-":{type:Ue,overloads:[[[Ue,Ue],(u,[l,f])=>l.evaluate(u)-f.evaluate(u)],[[Ue],(u,[l])=>-l.evaluate(u)]]},"/":[Ue,[Ue,Ue],(u,[l,f])=>l.evaluate(u)/f.evaluate(u)],"%":[Ue,[Ue,Ue],(u,[l,f])=>l.evaluate(u)%f.evaluate(u)],ln2:[Ue,[],()=>Math.LN2],pi:[Ue,[],()=>Math.PI],e:[Ue,[],()=>Math.E],"^":[Ue,[Ue,Ue],(u,[l,f])=>Math.pow(l.evaluate(u),f.evaluate(u))],sqrt:[Ue,[Ue],(u,[l])=>Math.sqrt(l.evaluate(u))],log10:[Ue,[Ue],(u,[l])=>Math.log(l.evaluate(u))/Math.LN10],ln:[Ue,[Ue],(u,[l])=>Math.log(l.evaluate(u))],log2:[Ue,[Ue],(u,[l])=>Math.log(l.evaluate(u))/Math.LN2],sin:[Ue,[Ue],(u,[l])=>Math.sin(l.evaluate(u))],cos:[Ue,[Ue],(u,[l])=>Math.cos(l.evaluate(u))],tan:[Ue,[Ue],(u,[l])=>Math.tan(l.evaluate(u))],asin:[Ue,[Ue],(u,[l])=>Math.asin(l.evaluate(u))],acos:[Ue,[Ue],(u,[l])=>Math.acos(l.evaluate(u))],atan:[Ue,[Ue],(u,[l])=>Math.atan(l.evaluate(u))],min:[Ue,oe(Ue),(u,l)=>Math.min(...l.map(f=>f.evaluate(u)))],max:[Ue,oe(Ue),(u,l)=>Math.max(...l.map(f=>f.evaluate(u)))],abs:[Ue,[Ue],(u,[l])=>Math.abs(l.evaluate(u))],round:[Ue,[Ue],(u,[l])=>{let f=l.evaluate(u);return f<0?-Math.round(-f):Math.round(f)}],floor:[Ue,[Ue],(u,[l])=>Math.floor(l.evaluate(u))],ceil:[Ue,[Ue],(u,[l])=>Math.ceil(l.evaluate(u))],"filter-==":[Nr,[ni,qr],(u,[l,f])=>u.properties()[l.value]===f.value],"filter-id-==":[Nr,[qr],(u,[l])=>u.id()===l.value],"filter-type-==":[Nr,[ni],(u,[l])=>u.geometryType()===l.value],"filter-<":[Nr,[ni,qr],(u,[l,f])=>{let x=u.properties()[l.value],S=f.value;return typeof x==typeof S&&x<S}],"filter-id-<":[Nr,[qr],(u,[l])=>{let f=u.id(),x=l.value;return typeof f==typeof x&&f<x}],"filter->":[Nr,[ni,qr],(u,[l,f])=>{let x=u.properties()[l.value],S=f.value;return typeof x==typeof S&&x>S}],"filter-id->":[Nr,[qr],(u,[l])=>{let f=u.id(),x=l.value;return typeof f==typeof x&&f>x}],"filter-<=":[Nr,[ni,qr],(u,[l,f])=>{let x=u.properties()[l.value],S=f.value;return typeof x==typeof S&&x<=S}],"filter-id-<=":[Nr,[qr],(u,[l])=>{let f=u.id(),x=l.value;return typeof f==typeof x&&f<=x}],"filter->=":[Nr,[ni,qr],(u,[l,f])=>{let x=u.properties()[l.value],S=f.value;return typeof x==typeof S&&x>=S}],"filter-id->=":[Nr,[qr],(u,[l])=>{let f=u.id(),x=l.value;return typeof f==typeof x&&f>=x}],"filter-has":[Nr,[qr],(u,[l])=>l.value in u.properties()],"filter-has-id":[Nr,[],u=>u.id()!==null&&u.id()!==void 0],"filter-type-in":[Nr,[Dt(ni)],(u,[l])=>l.value.indexOf(u.geometryType())>=0],"filter-id-in":[Nr,[Dt(qr)],(u,[l])=>l.value.indexOf(u.id())>=0],"filter-in-small":[Nr,[ni,Dt(qr)],(u,[l,f])=>f.value.indexOf(u.properties()[l.value])>=0],"filter-in-large":[Nr,[ni,Dt(qr)],(u,[l,f])=>function(x,S,k,D){for(;k<=D;){let F=k+D>>1;if(S[F]===x)return!0;S[F]>x?D=F-1:k=F+1}return!1}(u.properties()[l.value],f.value,0,f.value.length-1)],all:{type:Nr,overloads:[[[Nr,Nr],(u,[l,f])=>l.evaluate(u)&&f.evaluate(u)],[oe(Nr),(u,l)=>{for(let f of l)if(!f.evaluate(u))return!1;return!0}]]},any:{type:Nr,overloads:[[[Nr,Nr],(u,[l,f])=>l.evaluate(u)||f.evaluate(u)],[oe(Nr),(u,l)=>{for(let f of l)if(f.evaluate(u))return!0;return!1}]]},"!":[Nr,[Nr],(u,[l])=>!l.evaluate(u)],"is-supported-script":[Nr,[ni],(u,[l])=>{let f=u.globals&&u.globals.isSupportedScript;return!f||f(l.evaluate(u))}],upcase:[ni,[ni],(u,[l])=>l.evaluate(u).toUpperCase()],downcase:[ni,[ni],(u,[l])=>l.evaluate(u).toLowerCase()],concat:[ni,oe(qr),(u,l)=>l.map(f=>tn(f.evaluate(u))).join("")],"resolved-locale":[ni,[Ma],(u,[l])=>l.evaluate(u).resolvedLocale()]});class un{constructor(l,f){var x;this.expression=l,this._warningHistory={},this._evaluator=new ld,this._defaultValue=f?(x=f).type==="color"&&ft(x.default)?new Hi(0,0,0,0):x.type==="color"?Hi.parse(x.default)||null:x.type==="padding"?bs.parse(x.default)||null:x.type==="variableAnchorOffsetCollection"?ca.parse(x.default)||null:x.default===void 0?null:x.default:null,this._enumValues=f&&f.type==="enum"?f.values:null}evaluateWithoutErrorHandling(l,f,x,S,k,D){return this._evaluator.globals=l,this._evaluator.feature=f,this._evaluator.featureState=x,this._evaluator.canonical=S,this._evaluator.availableImages=k||null,this._evaluator.formattedSection=D,this.expression.evaluate(this._evaluator)}evaluate(l,f,x,S,k,D){this._evaluator.globals=l,this._evaluator.feature=f||null,this._evaluator.featureState=x||null,this._evaluator.canonical=S,this._evaluator.availableImages=k||null,this._evaluator.formattedSection=D||null;try{let F=this.expression.evaluate(this._evaluator);if(F==null||typeof F=="number"&&F!=F)return this._defaultValue;if(this._enumValues&&!(F in this._enumValues))throw new qn(`Expected value to be one of ${Object.keys(this._enumValues).map(j=>JSON.stringify(j)).join(", ")}, but found ${JSON.stringify(F)} instead.`);return F}catch(F){return this._warningHistory[F.message]||(this._warningHistory[F.message]=!0,typeof console<"u"&&console.warn(F.message)),this._defaultValue}}}function ku(u){return Array.isArray(u)&&u.length>0&&typeof u[0]=="string"&&u[0]in Oh}function tm(u,l){let f=new cd(Oh,ZA,[],l?function(S){let k={color:xo,string:ni,number:Ue,enum:ni,boolean:Nr,formatted:Ct,padding:rt,resolvedImage:at,variableAnchorOffsetCollection:mt};return S.type==="array"?Dt(k[S.value]||qr,S.length):k[S.type]}(l):void 0),x=f.parse(u,void 0,void 0,void 0,l&&l.type==="string"?{typeAnnotation:"coerce"}:void 0);return x?we(new un(x,l)):We(f.errors)}class ng{constructor(l,f){this.kind=l,this._styleExpression=f,this.isStateDependent=l!=="constant"&&!G0(f.expression)}evaluateWithoutErrorHandling(l,f,x,S,k,D){return this._styleExpression.evaluateWithoutErrorHandling(l,f,x,S,k,D)}evaluate(l,f,x,S,k,D){return this._styleExpression.evaluate(l,f,x,S,k,D)}}class Bf{constructor(l,f,x,S){this.kind=l,this.zoomStops=x,this._styleExpression=f,this.isStateDependent=l!=="camera"&&!G0(f.expression),this.interpolationType=S}evaluateWithoutErrorHandling(l,f,x,S,k,D){return this._styleExpression.evaluateWithoutErrorHandling(l,f,x,S,k,D)}evaluate(l,f,x,S,k,D){return this._styleExpression.evaluate(l,f,x,S,k,D)}interpolationFactor(l,f,x){return this.interpolationType?ll.interpolationFactor(this.interpolationType,l,f,x):0}}function ua(u,l){let f=tm(u,l);if(f.result==="error")return f;let x=f.value.expression,S=GA(x);if(!S&&!kr(l))return We([new Qn("","data expressions not supported")]);let k=QA(x,["zoom"]);if(!k&&!_(l))return We([new Qn("","zoom expressions not supported")]);let D=ha(x);return D||k?D instanceof Qn?We([D]):D instanceof ll&&!wn(l)?We([new Qn("",'"interpolate" expressions cannot be used with this property')]):we(D?new Bf(S?"camera":"composite",f.value,D.labels,D instanceof ll?D.interpolation:void 0):new ng(S?"constant":"source",f.value)):We([new Qn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class cc{constructor(l,f){this._parameters=l,this._specification=f,la(this,Wr(this._parameters,this._specification))}static deserialize(l){return new cc(l._parameters,l._specification)}static serialize(l){return{_parameters:l._parameters,_specification:l._specification}}}function ha(u){let l=null;if(u instanceof tg)l=ha(u.result);else if(u instanceof JA){for(let f of u.args)if(l=ha(f),l)break}else(u instanceof Dh||u instanceof ll)&&u.input instanceof Dl&&u.input.name==="zoom"&&(l=u);return l instanceof Qn||u.eachChild(f=>{let x=ha(f);x instanceof Qn?l=x:!l&&x?l=new Qn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):l&&x&&l!==x&&(l=new Qn("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),l}function Bh(u){if(u===!0||u===!1)return!0;if(!Array.isArray(u)||u.length===0)return!1;switch(u[0]){case"has":return u.length>=2&&u[1]!=="$id"&&u[1]!=="$type";case"in":return u.length>=3&&(typeof u[1]!="string"||Array.isArray(u[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return u.length!==3||Array.isArray(u[1])||Array.isArray(u[2]);case"any":case"all":for(let l of u.slice(1))if(!Bh(l)&&typeof l!="boolean")return!1;return!0;default:return!0}}let Ub={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Gc(u){if(u==null)return{filter:()=>!0,needGeometry:!1};Bh(u)||(u=Ur(u));let l=tm(u,Ub);if(l.result==="error")throw new Error(l.value.map(f=>`${f.key}: ${f.message}`).join(", "));return{filter:(f,x,S)=>l.value.evaluate(f,x,{},S),needGeometry:St(u)}}function Ei(u,l){return u<l?-1:u>l?1:0}function St(u){if(!Array.isArray(u))return!1;if(u[0]==="within")return!0;for(let l=1;l<u.length;l++)if(St(u[l]))return!0;return!1}function Ur(u){if(!u)return!0;let l=u[0];return u.length<=1?l!=="any":l==="=="?em(u[1],u[2],"=="):l==="!="?dd(em(u[1],u[2],"==")):l==="<"||l===">"||l==="<="||l===">="?em(u[1],u[2],l):l==="any"?(f=u.slice(1),["any"].concat(f.map(Ur))):l==="all"?["all"].concat(u.slice(1).map(Ur)):l==="none"?["all"].concat(u.slice(1).map(Ur).map(dd)):l==="in"?ty(u[1],u.slice(2)):l==="!in"?dd(ty(u[1],u.slice(2))):l==="has"?ey(u[1]):l==="!has"?dd(ey(u[1])):l!=="within"||u;var f}function em(u,l,f){switch(u){case"$type":return[`filter-type-${f}`,l];case"$id":return[`filter-id-${f}`,l];default:return[`filter-${f}`,u,l]}}function ty(u,l){if(l.length===0)return!1;switch(u){case"$type":return["filter-type-in",["literal",l]];case"$id":return["filter-id-in",["literal",l]];default:return l.length>200&&!l.some(f=>typeof f!=typeof l[0])?["filter-in-large",u,["literal",l.sort(Ei)]]:["filter-in-small",u,["literal",l]]}}function ey(u){switch(u){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",u]}}function dd(u){return["!",u]}function rm(u){let l=typeof u;if(l==="number"||l==="boolean"||l==="string"||u==null)return JSON.stringify(u);if(Array.isArray(u)){let S="[";for(let k of u)S+=`${rm(k)},`;return`${S}]`}let f=Object.keys(u).sort(),x="{";for(let S=0;S<f.length;S++)x+=`${JSON.stringify(f[S])}:${rm(u[f[S]])},`;return`${x}}`}function pt(u){let l="";for(let f of Gn)l+=`/${rm(u[f])}`;return l}function ry(u){let l=u.value;return l?[new Ne(u.key,l,"constants have been deprecated as of v8")]:[]}function fs(u){return u instanceof Number||u instanceof String||u instanceof Boolean?u.valueOf():u}function Nh(u){if(Array.isArray(u))return u.map(Nh);if(u instanceof Object&&!(u instanceof Number||u instanceof String||u instanceof Boolean)){let l={};for(let f in u)l[f]=Nh(u[f]);return l}return fs(u)}function fa(u){let l=u.key,f=u.value,x=u.valueSpec||{},S=u.objectElementValidators||{},k=u.style,D=u.styleSpec,F=u.validateSpec,j=[],Y=yr(f);if(Y!=="object")return[new Ne(l,f,`object expected, ${Y} found`)];for(let K in f){let et=K.split(".")[0],st=x[et]||x["*"],ct;if(S[et])ct=S[et];else if(x[et])ct=F;else if(S["*"])ct=S["*"];else{if(!x["*"]){j.push(new Ne(l,f[K],`unknown property "${K}"`));continue}ct=F}j=j.concat(ct({key:(l&&`${l}.`)+K,value:f[K],valueSpec:st,style:k,styleSpec:D,object:f,objectKey:K,validateSpec:F},f))}for(let K in x)S[K]||x[K].required&&x[K].default===void 0&&f[K]===void 0&&j.push(new Ne(l,f,`missing required property "${K}"`));return j}function Nf(u){let l=u.value,f=u.valueSpec,x=u.style,S=u.styleSpec,k=u.key,D=u.arrayElementValidator||u.validateSpec;if(yr(l)!=="array")return[new Ne(k,l,`array expected, ${yr(l)} found`)];if(f.length&&l.length!==f.length)return[new Ne(k,l,`array length ${f.length} expected, length ${l.length} found`)];if(f["min-length"]&&l.length<f["min-length"])return[new Ne(k,l,`array length at least ${f["min-length"]} expected, length ${l.length} found`)];let F={type:f.value,values:f.values};S.$version<7&&(F.function=f.function),yr(f.value)==="object"&&(F=f.value);let j=[];for(let Y=0;Y<l.length;Y++)j=j.concat(D({array:l,arrayIndex:Y,value:l[Y],valueSpec:F,validateSpec:u.validateSpec,style:x,styleSpec:S,key:`${k}[${Y}]`}));return j}function md(u){let l=u.key,f=u.value,x=u.valueSpec,S=yr(f);return S==="number"&&f!=f&&(S="NaN"),S!=="number"?[new Ne(l,f,`number expected, ${S} found`)]:"minimum"in x&&f<x.minimum?[new Ne(l,f,`${f} is less than the minimum value ${x.minimum}`)]:"maximum"in x&&f>x.maximum?[new Ne(l,f,`${f} is greater than the maximum value ${x.maximum}`)]:[]}function Ad(u){let l=u.valueSpec,f=fs(u.value.type),x,S,k,D={},F=f!=="categorical"&&u.value.property===void 0,j=!F,Y=yr(u.value.stops)==="array"&&yr(u.value.stops[0])==="array"&&yr(u.value.stops[0][0])==="object",K=fa({key:u.key,value:u.value,valueSpec:u.styleSpec.function,validateSpec:u.validateSpec,style:u.style,styleSpec:u.styleSpec,objectElementValidators:{stops:function(ct){if(f==="identity")return[new Ne(ct.key,ct.value,'identity function may not have a "stops" property')];let ht=[],Tt=ct.value;return ht=ht.concat(Nf({key:ct.key,value:Tt,valueSpec:ct.valueSpec,validateSpec:ct.validateSpec,style:ct.style,styleSpec:ct.styleSpec,arrayElementValidator:et})),yr(Tt)==="array"&&Tt.length===0&&ht.push(new Ne(ct.key,Tt,"array must have at least one stop")),ht},default:function(ct){return ct.validateSpec({key:ct.key,value:ct.value,valueSpec:l,validateSpec:ct.validateSpec,style:ct.style,styleSpec:ct.styleSpec})}}});return f==="identity"&&F&&K.push(new Ne(u.key,u.value,'missing required property "property"')),f==="identity"||u.value.stops||K.push(new Ne(u.key,u.value,'missing required property "stops"')),f==="exponential"&&u.valueSpec.expression&&!wn(u.valueSpec)&&K.push(new Ne(u.key,u.value,"exponential functions not supported")),u.styleSpec.$version>=8&&(j&&!kr(u.valueSpec)?K.push(new Ne(u.key,u.value,"property functions not supported")):F&&!_(u.valueSpec)&&K.push(new Ne(u.key,u.value,"zoom functions not supported"))),f!=="categorical"&&!Y||u.value.property!==void 0||K.push(new Ne(u.key,u.value,'"property" property is required')),K;function et(ct){let ht=[],Tt=ct.value,Nt=ct.key;if(yr(Tt)!=="array")return[new Ne(Nt,Tt,`array expected, ${yr(Tt)} found`)];if(Tt.length!==2)return[new Ne(Nt,Tt,`array length 2 expected, length ${Tt.length} found`)];if(Y){if(yr(Tt[0])!=="object")return[new Ne(Nt,Tt,`object expected, ${yr(Tt[0])} found`)];if(Tt[0].zoom===void 0)return[new Ne(Nt,Tt,"object stop key must have zoom")];if(Tt[0].value===void 0)return[new Ne(Nt,Tt,"object stop key must have value")];if(k&&k>fs(Tt[0].zoom))return[new Ne(Nt,Tt[0].zoom,"stop zoom values must appear in ascending order")];fs(Tt[0].zoom)!==k&&(k=fs(Tt[0].zoom),S=void 0,D={}),ht=ht.concat(fa({key:`${Nt}[0]`,value:Tt[0],valueSpec:{zoom:{}},validateSpec:ct.validateSpec,style:ct.style,styleSpec:ct.styleSpec,objectElementValidators:{zoom:md,value:st}}))}else ht=ht.concat(st({key:`${Nt}[0]`,value:Tt[0],valueSpec:{},validateSpec:ct.validateSpec,style:ct.style,styleSpec:ct.styleSpec},Tt));return ku(Nh(Tt[1]))?ht.concat([new Ne(`${Nt}[1]`,Tt[1],"expressions are not allowed in function stops.")]):ht.concat(ct.validateSpec({key:`${Nt}[1]`,value:Tt[1],valueSpec:l,validateSpec:ct.validateSpec,style:ct.style,styleSpec:ct.styleSpec}))}function st(ct,ht){let Tt=yr(ct.value),Nt=fs(ct.value),Ut=ct.value!==null?ct.value:ht;if(x){if(Tt!==x)return[new Ne(ct.key,Ut,`${Tt} stop domain type must match previous stop domain type ${x}`)]}else x=Tt;if(Tt!=="number"&&Tt!=="string"&&Tt!=="boolean")return[new Ne(ct.key,Ut,"stop domain value must be a number, string, or boolean")];if(Tt!=="number"&&f!=="categorical"){let Kt=`number expected, ${Tt} found`;return kr(l)&&f===void 0&&(Kt+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Ne(ct.key,Ut,Kt)]}return f!=="categorical"||Tt!=="number"||isFinite(Nt)&&Math.floor(Nt)===Nt?f!=="categorical"&&Tt==="number"&&S!==void 0&&Nt<S?[new Ne(ct.key,Ut,"stop domain values must appear in ascending order")]:(S=Nt,f==="categorical"&&Nt in D?[new Ne(ct.key,Ut,"stop domain values must be unique")]:(D[Nt]=!0,[])):[new Ne(ct.key,Ut,`integer expected, found ${Nt}`)]}}function Du(u){let l=(u.expressionContext==="property"?ua:tm)(Nh(u.value),u.valueSpec);if(l.result==="error")return l.value.map(x=>new Ne(`${u.key}${x.key}`,u.value,x.message));let f=l.value.expression||l.value._styleExpression.expression;if(u.expressionContext==="property"&&u.propertyKey==="text-font"&&!f.outputDefined())return[new Ne(u.key,u.value,`Invalid data expression for "${u.propertyKey}". Output values must be contained as literals within the expression.`)];if(u.expressionContext==="property"&&u.propertyType==="layout"&&!G0(f))return[new Ne(u.key,u.value,'"feature-state" data expressions are not supported with layout properties.')];if(u.expressionContext==="filter"&&!G0(f))return[new Ne(u.key,u.value,'"feature-state" data expressions are not supported with filters.')];if(u.expressionContext&&u.expressionContext.indexOf("cluster")===0){if(!QA(f,["zoom","feature-state"]))return[new Ne(u.key,u.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(u.expressionContext==="cluster-initial"&&!GA(f))return[new Ne(u.key,u.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Lf(u){let l=u.key,f=u.value,x=u.valueSpec,S=[];return Array.isArray(x.values)?x.values.indexOf(fs(f))===-1&&S.push(new Ne(l,f,`expected one of [${x.values.join(", ")}], ${JSON.stringify(f)} found`)):Object.keys(x.values).indexOf(fs(f))===-1&&S.push(new Ne(l,f,`expected one of [${Object.keys(x.values).join(", ")}], ${JSON.stringify(f)} found`)),S}function pa(u){return Bh(Nh(u.value))?Du(la({},u,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Zs(u)}function Zs(u){let l=u.value,f=u.key;if(yr(l)!=="array")return[new Ne(f,l,`array expected, ${yr(l)} found`)];let x=u.styleSpec,S,k=[];if(l.length<1)return[new Ne(f,l,"filter array must have at least 1 element")];switch(k=k.concat(Lf({key:`${f}[0]`,value:l[0],valueSpec:x.filter_operator,style:u.style,styleSpec:u.styleSpec})),fs(l[0])){case"<":case"<=":case">":case">=":l.length>=2&&fs(l[1])==="$type"&&k.push(new Ne(f,l,`"$type" cannot be use with operator "${l[0]}"`));case"==":case"!=":l.length!==3&&k.push(new Ne(f,l,`filter array for operator "${l[0]}" must have 3 elements`));case"in":case"!in":l.length>=2&&(S=yr(l[1]),S!=="string"&&k.push(new Ne(`${f}[1]`,l[1],`string expected, ${S} found`)));for(let D=2;D<l.length;D++)S=yr(l[D]),fs(l[1])==="$type"?k=k.concat(Lf({key:`${f}[${D}]`,value:l[D],valueSpec:x.geometry_type,style:u.style,styleSpec:u.styleSpec})):S!=="string"&&S!=="number"&&S!=="boolean"&&k.push(new Ne(`${f}[${D}]`,l[D],`string, number, or boolean expected, ${S} found`));break;case"any":case"all":case"none":for(let D=1;D<l.length;D++)k=k.concat(Zs({key:`${f}[${D}]`,value:l[D],style:u.style,styleSpec:u.styleSpec}));break;case"has":case"!has":S=yr(l[1]),l.length!==2?k.push(new Ne(f,l,`filter array for "${l[0]}" operator must have 2 elements`)):S!=="string"&&k.push(new Ne(`${f}[1]`,l[1],`string expected, ${S} found`));break;case"within":S=yr(l[1]),l.length!==2?k.push(new Ne(f,l,`filter array for "${l[0]}" operator must have 2 elements`)):S!=="object"&&k.push(new Ne(`${f}[1]`,l[1],`object expected, ${S} found`))}return k}function im(u,l){let f=u.key,x=u.validateSpec,S=u.style,k=u.styleSpec,D=u.value,F=u.objectKey,j=k[`${l}_${u.layerType}`];if(!j)return[];let Y=F.match(/^(.*)-transition$/);if(l==="paint"&&Y&&j[Y[1]]&&j[Y[1]].transition)return x({key:f,value:D,valueSpec:k.transition,style:S,styleSpec:k});let K=u.valueSpec||j[F];if(!K)return[new Ne(f,D,`unknown property "${F}"`)];let et;if(yr(D)==="string"&&kr(K)&&!K.tokens&&(et=/^{([^}]+)}$/.exec(D)))return[new Ne(f,D,`"${F}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(et[1])} }\`.`)];let st=[];return u.layerType==="symbol"&&(F==="text-field"&&S&&!S.glyphs&&st.push(new Ne(f,D,'use of "text-field" requires a style "glyphs" property')),F==="text-font"&&ft(Nh(D))&&fs(D.type)==="identity"&&st.push(new Ne(f,D,'"text-font" does not support identity functions'))),st.concat(x({key:u.key,value:D,valueSpec:K,style:S,styleSpec:k,expressionContext:"property",propertyType:l,propertyKey:F}))}function iy(u){return im(u,"paint")}function ny(u){return im(u,"layout")}function sg(u){let l=[],f=u.value,x=u.key,S=u.style,k=u.styleSpec;f.type||f.ref||l.push(new Ne(x,f,'either "type" or "ref" is required'));let D=fs(f.type),F=fs(f.ref);if(f.id){let j=fs(f.id);for(let Y=0;Y<u.arrayIndex;Y++){let K=S.layers[Y];fs(K.id)===j&&l.push(new Ne(x,f.id,`duplicate layer id "${f.id}", previously used at line ${K.id.__line__}`))}}if("ref"in f){let j;["type","source","source-layer","filter","layout"].forEach(Y=>{Y in f&&l.push(new Ne(x,f[Y],`"${Y}" is prohibited for ref layers`))}),S.layers.forEach(Y=>{fs(Y.id)===F&&(j=Y)}),j?j.ref?l.push(new Ne(x,f.ref,"ref cannot reference another ref layer")):D=fs(j.type):l.push(new Ne(x,f.ref,`ref layer "${F}" not found`))}else if(D!=="background")if(f.source){let j=S.sources&&S.sources[f.source],Y=j&&fs(j.type);j?Y==="vector"&&D==="raster"?l.push(new Ne(x,f.source,`layer "${f.id}" requires a raster source`)):Y!=="raster-dem"&&D==="hillshade"?l.push(new Ne(x,f.source,`layer "${f.id}" requires a raster-dem source`)):Y==="raster"&&D!=="raster"?l.push(new Ne(x,f.source,`layer "${f.id}" requires a vector source`)):Y!=="vector"||f["source-layer"]?Y==="raster-dem"&&D!=="hillshade"?l.push(new Ne(x,f.source,"raster-dem source can only be used with layer type 'hillshade'.")):D!=="line"||!f.paint||!f.paint["line-gradient"]||Y==="geojson"&&j.lineMetrics||l.push(new Ne(x,f,`layer "${f.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):l.push(new Ne(x,f,`layer "${f.id}" must specify a "source-layer"`)):l.push(new Ne(x,f.source,`source "${f.source}" not found`))}else l.push(new Ne(x,f,'missing required property "source"'));return l=l.concat(fa({key:x,value:f,valueSpec:k.layer,style:u.style,styleSpec:u.styleSpec,validateSpec:u.validateSpec,objectElementValidators:{"*":()=>[],type:()=>u.validateSpec({key:`${x}.type`,value:f.type,valueSpec:k.layer.type,style:u.style,styleSpec:u.styleSpec,validateSpec:u.validateSpec,object:f,objectKey:"type"}),filter:pa,layout:j=>fa({layer:f,key:j.key,value:j.value,style:j.style,styleSpec:j.styleSpec,validateSpec:j.validateSpec,objectElementValidators:{"*":Y=>ny(la({layerType:D},Y))}}),paint:j=>fa({layer:f,key:j.key,value:j.value,style:j.style,styleSpec:j.styleSpec,validateSpec:j.validateSpec,objectElementValidators:{"*":Y=>iy(la({layerType:D},Y))}})}})),l}function uc(u){let l=u.value,f=u.key,x=yr(l);return x!=="string"?[new Ne(f,l,`string expected, ${x} found`)]:[]}let gd={promoteId:function({key:u,value:l}){if(yr(l)==="string")return uc({key:u,value:l});{let f=[];for(let x in l)f.push(...uc({key:`${u}.${x}`,value:l[x]}));return f}}};function Pa(u){let l=u.value,f=u.key,x=u.styleSpec,S=u.style,k=u.validateSpec;if(!l.type)return[new Ne(f,l,'"type" is required')];let D=fs(l.type),F;switch(D){case"vector":case"raster":return F=fa({key:f,value:l,valueSpec:x[`source_${D.replace("-","_")}`],style:u.style,styleSpec:x,objectElementValidators:gd,validateSpec:k}),F;case"raster-dem":return F=function(j){var Y;let K=(Y=j.sourceName)!==null&&Y!==void 0?Y:"",et=j.value,st=j.styleSpec,ct=st.source_raster_dem,ht=j.style,Tt=[],Nt=yr(et);if(et===void 0)return Tt;if(Nt!=="object")return Tt.push(new Ne("source_raster_dem",et,`object expected, ${Nt} found`)),Tt;let Ut=fs(et.encoding)==="custom",Kt=["redFactor","greenFactor","blueFactor","baseShift"],Ht=j.value.encoding?`"${j.value.encoding}"`:"Default";for(let Jt in et)!Ut&&Kt.includes(Jt)?Tt.push(new Ne(Jt,et[Jt],`In "${K}": "${Jt}" is only valid when "encoding" is set to "custom". ${Ht} encoding found`)):ct[Jt]?Tt=Tt.concat(j.validateSpec({key:Jt,value:et[Jt],valueSpec:ct[Jt],validateSpec:j.validateSpec,style:ht,styleSpec:st})):Tt.push(new Ne(Jt,et[Jt],`unknown property "${Jt}"`));return Tt}({sourceName:f,value:l,style:u.style,styleSpec:x,validateSpec:k}),F;case"geojson":if(F=fa({key:f,value:l,valueSpec:x.source_geojson,style:S,styleSpec:x,validateSpec:k,objectElementValidators:gd}),l.cluster)for(let j in l.clusterProperties){let[Y,K]=l.clusterProperties[j],et=typeof Y=="string"?[Y,["accumulated"],["get",j]]:Y;F.push(...Du({key:`${f}.${j}.map`,value:K,validateSpec:k,expressionContext:"cluster-map"})),F.push(...Du({key:`${f}.${j}.reduce`,value:et,validateSpec:k,expressionContext:"cluster-reduce"}))}return F;case"video":return fa({key:f,value:l,valueSpec:x.source_video,style:S,validateSpec:k,styleSpec:x});case"image":return fa({key:f,value:l,valueSpec:x.source_image,style:S,validateSpec:k,styleSpec:x});case"canvas":return[new Ne(f,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Lf({key:`${f}.type`,value:l.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:S,validateSpec:k,styleSpec:x})}}function Tn(u){let l=u.value,f=u.styleSpec,x=f.light,S=u.style,k=[],D=yr(l);if(l===void 0)return k;if(D!=="object")return k=k.concat([new Ne("light",l,`object expected, ${D} found`)]),k;for(let F in l){let j=F.match(/^(.*)-transition$/);k=k.concat(j&&x[j[1]]&&x[j[1]].transition?u.validateSpec({key:F,value:l[F],valueSpec:f.transition,validateSpec:u.validateSpec,style:S,styleSpec:f}):x[F]?u.validateSpec({key:F,value:l[F],valueSpec:x[F],validateSpec:u.validateSpec,style:S,styleSpec:f}):[new Ne(F,l[F],`unknown property "${F}"`)])}return k}function nm(u){let l=u.value,f=u.styleSpec,x=f.terrain,S=u.style,k=[],D=yr(l);if(l===void 0)return k;if(D!=="object")return k=k.concat([new Ne("terrain",l,`object expected, ${D} found`)]),k;for(let F in l)k=k.concat(x[F]?u.validateSpec({key:F,value:l[F],valueSpec:x[F],validateSpec:u.validateSpec,style:S,styleSpec:f}):[new Ne(F,l[F],`unknown property "${F}"`)]);return k}function og(u){let l=[],f=u.value,x=u.key;if(Array.isArray(f)){let S=[],k=[];for(let D in f)f[D].id&&S.includes(f[D].id)&&l.push(new Ne(x,f,`all the sprites' ids must be unique, but ${f[D].id} is duplicated`)),S.push(f[D].id),f[D].url&&k.includes(f[D].url)&&l.push(new Ne(x,f,`all the sprites' URLs must be unique, but ${f[D].url} is duplicated`)),k.push(f[D].url),l=l.concat(fa({key:`${x}[${D}]`,value:f[D],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:u.validateSpec}));return l}return uc({key:x,value:f})}let sy={"*":()=>[],array:Nf,boolean:function(u){let l=u.value,f=u.key,x=yr(l);return x!=="boolean"?[new Ne(f,l,`boolean expected, ${x} found`)]:[]},number:md,color:function(u){let l=u.key,f=u.value,x=yr(f);return x!=="string"?[new Ne(l,f,`color expected, ${x} found`)]:Hi.parse(String(f))?[]:[new Ne(l,f,`color expected, "${f}" found`)]},constants:ry,enum:Lf,filter:pa,function:Ad,layer:sg,object:fa,source:Pa,light:Tn,terrain:nm,string:uc,formatted:function(u){return uc(u).length===0?[]:Du(u)},resolvedImage:function(u){return uc(u).length===0?[]:Du(u)},padding:function(u){let l=u.key,f=u.value;if(yr(f)==="array"){if(f.length<1||f.length>4)return[new Ne(l,f,`padding requires 1 to 4 values; ${f.length} values found`)];let x={type:"number"},S=[];for(let k=0;k<f.length;k++)S=S.concat(u.validateSpec({key:`${l}[${k}]`,value:f[k],validateSpec:u.validateSpec,valueSpec:x}));return S}return md({key:l,value:f,valueSpec:{}})},variableAnchorOffsetCollection:function(u){let l=u.key,f=u.value,x=yr(f),S=u.styleSpec;if(x!=="array"||f.length<1||f.length%2!=0)return[new Ne(l,f,"variableAnchorOffsetCollection requires a non-empty array of even length")];let k=[];for(let D=0;D<f.length;D+=2)k=k.concat(Lf({key:`${l}[${D}]`,value:f[D],valueSpec:S.layout_symbol["text-anchor"]})),k=k.concat(Nf({key:`${l}[${D+1}]`,value:f[D+1],valueSpec:{length:2,value:"number"},validateSpec:u.validateSpec,style:u.style,styleSpec:S}));return k},sprite:og};function Qc(u){let l=u.value,f=u.valueSpec,x=u.styleSpec;return u.validateSpec=Qc,f.expression&&ft(fs(l))?Ad(u):f.expression&&ku(Nh(l))?Du(u):f.type&&sy[f.type]?sy[f.type](u):fa(la({},u,{valueSpec:f.type?x[f.type]:f}))}function oy(u){let l=u.value,f=u.key,x=uc(u);return x.length||(l.indexOf("{fontstack}")===-1&&x.push(new Ne(f,l,'"glyphs" url must include a "{fontstack}" token')),l.indexOf("{range}")===-1&&x.push(new Ne(f,l,'"glyphs" url must include a "{range}" token'))),x}function Ra(u,l=ae){let f=[];return f=f.concat(Qc({key:"",value:u,valueSpec:l.$root,styleSpec:l,style:u,validateSpec:Qc,objectElementValidators:{glyphs:oy,"*":()=>[]}})),u.constants&&(f=f.concat(ry({key:"constants",value:u.constants,style:u,styleSpec:l,validateSpec:Qc}))),Ff(f)}function Ol(u){return function(l){return u({...l,validateSpec:Qc})}}function Ff(u){return[].concat(u).sort((l,f)=>l.line-f.line)}function Kc(u){return function(...l){return Ff(u.apply(this,l))}}Ra.source=Kc(Ol(Pa)),Ra.sprite=Kc(Ol(og)),Ra.glyphs=Kc(Ol(oy)),Ra.light=Kc(Ol(Tn)),Ra.terrain=Kc(Ol(nm)),Ra.layer=Kc(Ol(sg)),Ra.filter=Kc(Ol(pa)),Ra.paintProperty=Kc(Ol(iy)),Ra.layoutProperty=Kc(Ol(ny));let Jc=Ra,ay=Jc.light,sm=Jc.paintProperty,ag=Jc.layoutProperty;function om(u,l){let f=!1;if(l&&l.length)for(let x of l)u.fire(new fn(new Error(x.message))),f=!0;return f}class zf{constructor(l,f,x){let S=this.cells=[];if(l instanceof ArrayBuffer){this.arrayBuffer=l;let D=new Int32Array(this.arrayBuffer);l=D[0],this.d=(f=D[1])+2*(x=D[2]);for(let j=0;j<this.d*this.d;j++){let Y=D[3+j],K=D[3+j+1];S.push(Y===K?null:D.subarray(Y,K))}let F=D[3+S.length+1];this.keys=D.subarray(D[3+S.length],F),this.bboxes=D.subarray(F),this.insert=this._insertReadonly}else{this.d=f+2*x;for(let D=0;D<this.d*this.d;D++)S.push([]);this.keys=[],this.bboxes=[]}this.n=f,this.extent=l,this.padding=x,this.scale=f/l,this.uid=0;let k=x/f*l;this.min=-k,this.max=l+k}insert(l,f,x,S,k){this._forEachCell(f,x,S,k,this._insertCell,this.uid++,void 0,void 0),this.keys.push(l),this.bboxes.push(f),this.bboxes.push(x),this.bboxes.push(S),this.bboxes.push(k)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(l,f,x,S,k,D){this.cells[k].push(D)}query(l,f,x,S,k){let D=this.min,F=this.max;if(l<=D&&f<=D&&F<=x&&F<=S&&!k)return Array.prototype.slice.call(this.keys);{let j=[];return this._forEachCell(l,f,x,S,this._queryCell,j,{},k),j}}_queryCell(l,f,x,S,k,D,F,j){let Y=this.cells[k];if(Y!==null){let K=this.keys,et=this.bboxes;for(let st=0;st<Y.length;st++){let ct=Y[st];if(F[ct]===void 0){let ht=4*ct;(j?j(et[ht+0],et[ht+1],et[ht+2],et[ht+3]):l<=et[ht+2]&&f<=et[ht+3]&&x>=et[ht+0]&&S>=et[ht+1])?(F[ct]=!0,D.push(K[ct])):F[ct]=!1}}}}_forEachCell(l,f,x,S,k,D,F,j){let Y=this._convertToCellCoord(l),K=this._convertToCellCoord(f),et=this._convertToCellCoord(x),st=this._convertToCellCoord(S);for(let ct=Y;ct<=et;ct++)for(let ht=K;ht<=st;ht++){let Tt=this.d*ht+ct;if((!j||j(this._convertFromCellCoord(ct),this._convertFromCellCoord(ht),this._convertFromCellCoord(ct+1),this._convertFromCellCoord(ht+1)))&&k.call(this,l,f,x,S,Tt,D,F,j))return}}_convertFromCellCoord(l){return(l-this.padding)/this.scale}_convertToCellCoord(l){return Math.max(0,Math.min(this.d-1,Math.floor(l*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;let l=this.cells,f=3+this.cells.length+1+1,x=0;for(let D=0;D<this.cells.length;D++)x+=this.cells[D].length;let S=new Int32Array(f+x+this.keys.length+this.bboxes.length);S[0]=this.extent,S[1]=this.n,S[2]=this.padding;let k=f;for(let D=0;D<l.length;D++){let F=l[D];S[3+D]=k,S.set(F,k),k+=F.length}return S[3+l.length]=k,S.set(this.keys,k),k+=this.keys.length,S[3+l.length+1]=k,S.set(this.bboxes,k),k+=this.bboxes.length,S.buffer}static serialize(l,f){let x=l.toArrayBuffer();return f&&f.push(x),{buffer:x}}static deserialize(l){return new zf(l.buffer)}}let tu={};function Ve(u,l,f={}){if(tu[u])throw new Error(`${u} is already registered.`);Object.defineProperty(l,"_classRegistryKey",{value:u,writeable:!1}),tu[u]={klass:l,omit:f.omit||[],shallow:f.shallow||[]}}Ve("Object",Object),Ve("TransferableGridIndex",zf),Ve("Color",Hi),Ve("Error",Error),Ve("AJAXError",Kr),Ve("ResolvedImage",Rs),Ve("StylePropertyFunction",cc),Ve("StyleExpression",un,{omit:["_evaluator"]}),Ve("ZoomDependentExpression",Bf),Ve("ZoomConstantExpression",ng),Ve("CompoundExpression",Dl,{omit:["_evaluate"]});for(let u in Oh)Oh[u]._classRegistryKey||Ve(`Expression_${u}`,Oh[u]);function hc(u){return u&&typeof ArrayBuffer<"u"&&(u instanceof ArrayBuffer||u.constructor&&u.constructor.name==="ArrayBuffer")}function ws(u,l){if(u==null||typeof u=="boolean"||typeof u=="number"||typeof u=="string"||u instanceof Boolean||u instanceof Number||u instanceof String||u instanceof Date||u instanceof RegExp||u instanceof Blob)return u;if(hc(u)||de(u))return l&&l.push(u),u;if(ArrayBuffer.isView(u)){let f=u;return l&&l.push(f.buffer),f}if(u instanceof ImageData)return l&&l.push(u.data.buffer),u;if(Array.isArray(u)){let f=[];for(let x of u)f.push(ws(x,l));return f}if(typeof u=="object"){let f=u.constructor,x=f._classRegistryKey;if(!x)throw new Error("can't serialize object of unregistered class");if(!tu[x])throw new Error(`${x} is not registered.`);let S=f.serialize?f.serialize(u,l):{};if(f.serialize){if(l&&S===l[l.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(let k in u){if(!u.hasOwnProperty(k)||tu[x].omit.indexOf(k)>=0)continue;let D=u[k];S[k]=tu[x].shallow.indexOf(k)>=0?D:ws(D,l)}u instanceof Error&&(S.message=u.message)}if(S.$name)throw new Error("$name property is reserved for worker serialization logic.");return x!=="Object"&&(S.$name=x),S}throw new Error("can't serialize object of type "+typeof u)}function Ou(u){if(u==null||typeof u=="boolean"||typeof u=="number"||typeof u=="string"||u instanceof Boolean||u instanceof Number||u instanceof String||u instanceof Date||u instanceof RegExp||u instanceof Blob||hc(u)||de(u)||ArrayBuffer.isView(u)||u instanceof ImageData)return u;if(Array.isArray(u))return u.map(Ou);if(typeof u=="object"){let l=u.$name||"Object";if(!tu[l])throw new Error(`can't deserialize unregistered class ${l}`);let{klass:f}=tu[l];if(!f)throw new Error(`can't deserialize unregistered class ${l}`);if(f.deserialize)return f.deserialize(u);let x=Object.create(f.prototype);for(let S of Object.keys(u)){if(S==="$name")continue;let k=u[S];x[S]=tu[l].shallow.indexOf(S)>=0?k:Ou(k)}return x}throw new Error("can't deserialize object of type "+typeof u)}class lg{constructor(){this.first=!0}update(l,f){let x=Math.floor(l);return this.first?(this.first=!1,this.lastIntegerZoom=x,this.lastIntegerZoomTime=0,this.lastZoom=l,this.lastFloorZoom=x,!0):(this.lastFloorZoom>x?(this.lastIntegerZoom=x+1,this.lastIntegerZoomTime=f):this.lastFloorZoom<x&&(this.lastIntegerZoom=x,this.lastIntegerZoomTime=f),l!==this.lastZoom&&(this.lastZoom=l,this.lastFloorZoom=x,!0))}}let qe={"Latin-1 Supplement":u=>u>=128&&u<=255,Arabic:u=>u>=1536&&u<=1791,"Arabic Supplement":u=>u>=1872&&u<=1919,"Arabic Extended-A":u=>u>=2208&&u<=2303,"Hangul Jamo":u=>u>=4352&&u<=4607,"Unified Canadian Aboriginal Syllabics":u=>u>=5120&&u<=5759,Khmer:u=>u>=6016&&u<=6143,"Unified Canadian Aboriginal Syllabics Extended":u=>u>=6320&&u<=6399,"General Punctuation":u=>u>=8192&&u<=8303,"Letterlike Symbols":u=>u>=8448&&u<=8527,"Number Forms":u=>u>=8528&&u<=8591,"Miscellaneous Technical":u=>u>=8960&&u<=9215,"Control Pictures":u=>u>=9216&&u<=9279,"Optical Character Recognition":u=>u>=9280&&u<=9311,"Enclosed Alphanumerics":u=>u>=9312&&u<=9471,"Geometric Shapes":u=>u>=9632&&u<=9727,"Miscellaneous Symbols":u=>u>=9728&&u<=9983,"Miscellaneous Symbols and Arrows":u=>u>=11008&&u<=11263,"CJK Radicals Supplement":u=>u>=11904&&u<=12031,"Kangxi Radicals":u=>u>=12032&&u<=12255,"Ideographic Description Characters":u=>u>=12272&&u<=12287,"CJK Symbols and Punctuation":u=>u>=12288&&u<=12351,Hiragana:u=>u>=12352&&u<=12447,Katakana:u=>u>=12448&&u<=12543,Bopomofo:u=>u>=12544&&u<=12591,"Hangul Compatibility Jamo":u=>u>=12592&&u<=12687,Kanbun:u=>u>=12688&&u<=12703,"Bopomofo Extended":u=>u>=12704&&u<=12735,"CJK Strokes":u=>u>=12736&&u<=12783,"Katakana Phonetic Extensions":u=>u>=12784&&u<=12799,"Enclosed CJK Letters and Months":u=>u>=12800&&u<=13055,"CJK Compatibility":u=>u>=13056&&u<=13311,"CJK Unified Ideographs Extension A":u=>u>=13312&&u<=19903,"Yijing Hexagram Symbols":u=>u>=19904&&u<=19967,"CJK Unified Ideographs":u=>u>=19968&&u<=40959,"Yi Syllables":u=>u>=40960&&u<=42127,"Yi Radicals":u=>u>=42128&&u<=42191,"Hangul Jamo Extended-A":u=>u>=43360&&u<=43391,"Hangul Syllables":u=>u>=44032&&u<=55215,"Hangul Jamo Extended-B":u=>u>=55216&&u<=55295,"Private Use Area":u=>u>=57344&&u<=63743,"CJK Compatibility Ideographs":u=>u>=63744&&u<=64255,"Arabic Presentation Forms-A":u=>u>=64336&&u<=65023,"Vertical Forms":u=>u>=65040&&u<=65055,"CJK Compatibility Forms":u=>u>=65072&&u<=65103,"Small Form Variants":u=>u>=65104&&u<=65135,"Arabic Presentation Forms-B":u=>u>=65136&&u<=65279,"Halfwidth and Fullwidth Forms":u=>u>=65280&&u<=65519};function cg(u){for(let l of u)if(am(l.charCodeAt(0)))return!0;return!1}function ug(u){for(let l of u)if(!Vb(l.charCodeAt(0)))return!1;return!0}function Vb(u){return!(qe.Arabic(u)||qe["Arabic Supplement"](u)||qe["Arabic Extended-A"](u)||qe["Arabic Presentation Forms-A"](u)||qe["Arabic Presentation Forms-B"](u))}function am(u){return!(u!==746&&u!==747&&(u<4352||!(qe["Bopomofo Extended"](u)||qe.Bopomofo(u)||qe["CJK Compatibility Forms"](u)&&!(u>=65097&&u<=65103)||qe["CJK Compatibility Ideographs"](u)||qe["CJK Compatibility"](u)||qe["CJK Radicals Supplement"](u)||qe["CJK Strokes"](u)||!(!qe["CJK Symbols and Punctuation"](u)||u>=12296&&u<=12305||u>=12308&&u<=12319||u===12336)||qe["CJK Unified Ideographs Extension A"](u)||qe["CJK Unified Ideographs"](u)||qe["Enclosed CJK Letters and Months"](u)||qe["Hangul Compatibility Jamo"](u)||qe["Hangul Jamo Extended-A"](u)||qe["Hangul Jamo Extended-B"](u)||qe["Hangul Jamo"](u)||qe["Hangul Syllables"](u)||qe.Hiragana(u)||qe["Ideographic Description Characters"](u)||qe.Kanbun(u)||qe["Kangxi Radicals"](u)||qe["Katakana Phonetic Extensions"](u)||qe.Katakana(u)&&u!==12540||!(!qe["Halfwidth and Fullwidth Forms"](u)||u===65288||u===65289||u===65293||u>=65306&&u<=65310||u===65339||u===65341||u===65343||u>=65371&&u<=65503||u===65507||u>=65512&&u<=65519)||!(!qe["Small Form Variants"](u)||u>=65112&&u<=65118||u>=65123&&u<=65126)||qe["Unified Canadian Aboriginal Syllabics"](u)||qe["Unified Canadian Aboriginal Syllabics Extended"](u)||qe["Vertical Forms"](u)||qe["Yijing Hexagram Symbols"](u)||qe["Yi Syllables"](u)||qe["Yi Radicals"](u))))}function _d(u){return!(am(u)||function(l){return!!(qe["Latin-1 Supplement"](l)&&(l===167||l===169||l===174||l===177||l===188||l===189||l===190||l===215||l===247)||qe["General Punctuation"](l)&&(l===8214||l===8224||l===8225||l===8240||l===8241||l===8251||l===8252||l===8258||l===8263||l===8264||l===8265||l===8273)||qe["Letterlike Symbols"](l)||qe["Number Forms"](l)||qe["Miscellaneous Technical"](l)&&(l>=8960&&l<=8967||l>=8972&&l<=8991||l>=8996&&l<=9e3||l===9003||l>=9085&&l<=9114||l>=9150&&l<=9165||l===9167||l>=9169&&l<=9179||l>=9186&&l<=9215)||qe["Control Pictures"](l)&&l!==9251||qe["Optical Character Recognition"](l)||qe["Enclosed Alphanumerics"](l)||qe["Geometric Shapes"](l)||qe["Miscellaneous Symbols"](l)&&!(l>=9754&&l<=9759)||qe["Miscellaneous Symbols and Arrows"](l)&&(l>=11026&&l<=11055||l>=11088&&l<=11097||l>=11192&&l<=11243)||qe["CJK Symbols and Punctuation"](l)||qe.Katakana(l)||qe["Private Use Area"](l)||qe["CJK Compatibility Forms"](l)||qe["Small Form Variants"](l)||qe["Halfwidth and Fullwidth Forms"](l)||l===8734||l===8756||l===8757||l>=9984&&l<=10087||l>=10102&&l<=10131||l===65532||l===65533)}(u))}function Bu(u){return u>=1424&&u<=2303||qe["Arabic Presentation Forms-A"](u)||qe["Arabic Presentation Forms-B"](u)}function hg(u,l){return!(!l&&Bu(u)||u>=2304&&u<=3583||u>=3840&&u<=4255||qe.Khmer(u))}function ly(u){for(let l of u)if(Bu(l.charCodeAt(0)))return!0;return!1}let Uf="deferred",eu="loading",fc="loaded",lm=null,Qo="unavailable",pc=null,yd=function(u){u&&typeof u=="string"&&u.indexOf("NetworkError")>-1&&(Qo="error"),lm&&lm(u)};function fg(){Vf.fire(new rn("pluginStateChange",{pluginStatus:Qo,pluginURL:pc}))}let Vf=new Er,pg=function(){return Qo},cy=function(){if(Qo!==Uf||!pc)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Qo=eu,fg(),pc&&$r({url:pc},u=>{u?yd(u):(Qo=fc,fg())})},ka={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Qo===fc||ka.applyArabicShaping!=null,isLoading:()=>Qo===eu,setState(u){if(!Vt())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");Qo=u.pluginStatus,pc=u.pluginURL},isParsed(){if(!Vt())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return ka.applyArabicShaping!=null&&ka.processBidirectionalText!=null&&ka.processStyledBidirectionalText!=null},getPluginURL(){if(!Vt())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return pc}};class Yn{constructor(l,f){this.zoom=l,f?(this.now=f.now,this.fadeDuration=f.fadeDuration,this.zoomHistory=f.zoomHistory,this.transition=f.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new lg,this.transition={})}isSupportedScript(l){return function(f,x){for(let S of f)if(!hg(S.charCodeAt(0),x))return!1;return!0}(l,ka.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){let l=this.zoom,f=l-Math.floor(l),x=this.crossFadingFactor();return l>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:f+(1-f)*x}:{fromScale:.5,toScale:1,t:1-(1-x)*f}}}class cm{constructor(l,f){this.property=l,this.value=f,this.expression=function(x,S){if(ft(x))return new cc(x,S);if(ku(x)){let k=ua(x,S);if(k.result==="error")throw new Error(k.value.map(D=>`${D.key}: ${D.message}`).join(", "));return k.value}{let k=x;return S.type==="color"&&typeof x=="string"?k=Hi.parse(x):S.type!=="padding"||typeof x!="number"&&!Array.isArray(x)?S.type==="variableAnchorOffsetCollection"&&Array.isArray(x)&&(k=ca.parse(x)):k=bs.parse(x),{kind:"constant",evaluate:()=>k}}}(f===void 0?l.specification.default:f,l.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(l,f,x){return this.property.possiblyEvaluate(this,l,f,x)}}class dg{constructor(l){this.property=l,this.value=new cm(l,void 0)}transitioned(l,f){return new hy(this.property,this.value,f,nt({},l.transition,this.transition),l.now)}untransitioned(){return new hy(this.property,this.value,null,{},0)}}class uy{constructor(l){this._properties=l,this._values=Object.create(l.defaultTransitionablePropertyValues)}getValue(l){return vt(this._values[l].value.value)}setValue(l,f){Object.prototype.hasOwnProperty.call(this._values,l)||(this._values[l]=new dg(this._values[l].property)),this._values[l].value=new cm(this._values[l].property,f===null?void 0:vt(f))}getTransition(l){return vt(this._values[l].transition)}setTransition(l,f){Object.prototype.hasOwnProperty.call(this._values,l)||(this._values[l]=new dg(this._values[l].property)),this._values[l].transition=vt(f)||void 0}serialize(){let l={};for(let f of Object.keys(this._values)){let x=this.getValue(f);x!==void 0&&(l[f]=x);let S=this.getTransition(f);S!==void 0&&(l[`${f}-transition`]=S)}return l}transitioned(l,f){let x=new xd(this._properties);for(let S of Object.keys(this._values))x._values[S]=this._values[S].transitioned(l,f._values[S]);return x}untransitioned(){let l=new xd(this._properties);for(let f of Object.keys(this._values))l._values[f]=this._values[f].untransitioned();return l}}class hy{constructor(l,f,x,S,k){this.property=l,this.value=f,this.begin=k+S.delay||0,this.end=this.begin+S.duration||0,l.specification.transition&&(S.delay||S.duration)&&(this.prior=x)}possiblyEvaluate(l,f,x){let S=l.now||0,k=this.value.possiblyEvaluate(l,f,x),D=this.prior;if(D){if(S>this.end)return this.prior=null,k;if(this.value.isDataDriven())return this.prior=null,k;if(S<this.begin)return D.possiblyEvaluate(l,f,x);{let F=(S-this.begin)/(this.end-this.begin);return this.property.interpolate(D.possiblyEvaluate(l,f,x),k,function(j){if(j<=0)return 0;if(j>=1)return 1;let Y=j*j,K=Y*j;return 4*(j<.5?K:3*(j-Y)+K-.75)}(F))}}return k}}class xd{constructor(l){this._properties=l,this._values=Object.create(l.defaultTransitioningPropertyValues)}possiblyEvaluate(l,f,x){let S=new um(this._properties);for(let k of Object.keys(this._values))S._values[k]=this._values[k].possiblyEvaluate(l,f,x);return S}hasTransition(){for(let l of Object.keys(this._values))if(this._values[l].prior)return!0;return!1}}class jb{constructor(l){this._properties=l,this._values=Object.create(l.defaultPropertyValues)}hasValue(l){return this._values[l].value!==void 0}getValue(l){return vt(this._values[l].value)}setValue(l,f){this._values[l]=new cm(this._values[l].property,f===null?void 0:vt(f))}serialize(){let l={};for(let f of Object.keys(this._values)){let x=this.getValue(f);x!==void 0&&(l[f]=x)}return l}possiblyEvaluate(l,f,x){let S=new um(this._properties);for(let k of Object.keys(this._values))S._values[k]=this._values[k].possiblyEvaluate(l,f,x);return S}}class Ko{constructor(l,f,x){this.property=l,this.value=f,this.parameters=x}isConstant(){return this.value.kind==="constant"}constantOr(l){return this.value.kind==="constant"?this.value.value:l}evaluate(l,f,x,S){return this.property.evaluate(this.value,this.parameters,l,f,x,S)}}class um{constructor(l){this._properties=l,this._values=Object.create(l.defaultPossiblyEvaluatedValues)}get(l){return this._values[l]}}class ur{constructor(l){this.specification=l}possiblyEvaluate(l,f){if(l.isDataDriven())throw new Error("Value should not be data driven");return l.expression.evaluate(f)}interpolate(l,f,x){let S=al[this.specification.type];return S?S(l,f,x):l}}class Dr{constructor(l,f){this.specification=l,this.overrides=f}possiblyEvaluate(l,f,x,S){return new Ko(this,l.expression.kind==="constant"||l.expression.kind==="camera"?{kind:"constant",value:l.expression.evaluate(f,null,{},x,S)}:l.expression,f)}interpolate(l,f,x){if(l.value.kind!=="constant"||f.value.kind!=="constant")return l;if(l.value.value===void 0||f.value.value===void 0)return new Ko(this,{kind:"constant",value:void 0},l.parameters);let S=al[this.specification.type];if(S){let k=S(l.value.value,f.value.value,x);return new Ko(this,{kind:"constant",value:k},l.parameters)}return l}evaluate(l,f,x,S,k,D){return l.kind==="constant"?l.value:l.evaluate(f,x,S,k,D)}}class Lh extends Dr{possiblyEvaluate(l,f,x,S){if(l.value===void 0)return new Ko(this,{kind:"constant",value:void 0},f);if(l.expression.kind==="constant"){let k=l.expression.evaluate(f,null,{},x,S),D=l.property.specification.type==="resolvedImage"&&typeof k!="string"?k.name:k,F=this._calculate(D,D,D,f);return new Ko(this,{kind:"constant",value:F},f)}if(l.expression.kind==="camera"){let k=this._calculate(l.expression.evaluate({zoom:f.zoom-1}),l.expression.evaluate({zoom:f.zoom}),l.expression.evaluate({zoom:f.zoom+1}),f);return new Ko(this,{kind:"constant",value:k},f)}return new Ko(this,l.expression,f)}evaluate(l,f,x,S,k,D){if(l.kind==="source"){let F=l.evaluate(f,x,S,k,D);return this._calculate(F,F,F,f)}return l.kind==="composite"?this._calculate(l.evaluate({zoom:Math.floor(f.zoom)-1},x,S),l.evaluate({zoom:Math.floor(f.zoom)},x,S),l.evaluate({zoom:Math.floor(f.zoom)+1},x,S),f):l.value}_calculate(l,f,x,S){return S.zoom>S.zoomHistory.lastIntegerZoom?{from:l,to:f}:{from:x,to:f}}interpolate(l){return l}}class hm{constructor(l){this.specification=l}possiblyEvaluate(l,f,x,S){if(l.value!==void 0){if(l.expression.kind==="constant"){let k=l.expression.evaluate(f,null,{},x,S);return this._calculate(k,k,k,f)}return this._calculate(l.expression.evaluate(new Yn(Math.floor(f.zoom-1),f)),l.expression.evaluate(new Yn(Math.floor(f.zoom),f)),l.expression.evaluate(new Yn(Math.floor(f.zoom+1),f)),f)}}_calculate(l,f,x,S){return S.zoom>S.zoomHistory.lastIntegerZoom?{from:l,to:f}:{from:x,to:f}}interpolate(l){return l}}class Nu{constructor(l){this.specification=l}possiblyEvaluate(l,f,x,S){return!!l.expression.evaluate(f,null,{},x,S)}interpolate(){return!1}}class Ds{constructor(l){this.properties=l,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(let f in l){let x=l[f];x.specification.overridable&&this.overridableProperties.push(f);let S=this.defaultPropertyValues[f]=new cm(x,void 0),k=this.defaultTransitionablePropertyValues[f]=new dg(x);this.defaultTransitioningPropertyValues[f]=k.untransitioned(),this.defaultPossiblyEvaluatedValues[f]=S.possiblyEvaluate({})}}}Ve("DataDrivenProperty",Dr),Ve("DataConstantProperty",ur),Ve("CrossFadedDataDrivenProperty",Lh),Ve("CrossFadedProperty",hm),Ve("ColorRampProperty",Nu);let bd="-transition";class Da extends Er{constructor(l,f){if(super(),this.id=l.id,this.type=l.type,this._featureFilter={filter:()=>!0,needGeometry:!1},l.type!=="custom"&&(this.metadata=l.metadata,this.minzoom=l.minzoom,this.maxzoom=l.maxzoom,l.type!=="background"&&(this.source=l.source,this.sourceLayer=l["source-layer"],this.filter=l.filter),f.layout&&(this._unevaluatedLayout=new jb(f.layout)),f.paint)){this._transitionablePaint=new uy(f.paint);for(let x in l.paint)this.setPaintProperty(x,l.paint[x],{validate:!1});for(let x in l.layout)this.setLayoutProperty(x,l.layout[x],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new um(f.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(l){return l==="visibility"?this.visibility:this._unevaluatedLayout.getValue(l)}setLayoutProperty(l,f,x={}){f!=null&&this._validate(ag,`layers.${this.id}.layout.${l}`,l,f,x)||(l!=="visibility"?this._unevaluatedLayout.setValue(l,f):this.visibility=f)}getPaintProperty(l){return l.endsWith(bd)?this._transitionablePaint.getTransition(l.slice(0,-11)):this._transitionablePaint.getValue(l)}setPaintProperty(l,f,x={}){if(f!=null&&this._validate(sm,`layers.${this.id}.paint.${l}`,l,f,x))return!1;if(l.endsWith(bd))return this._transitionablePaint.setTransition(l.slice(0,-11),f||void 0),!1;{let S=this._transitionablePaint._values[l],k=S.property.specification["property-type"]==="cross-faded-data-driven",D=S.value.isDataDriven(),F=S.value;this._transitionablePaint.setValue(l,f),this._handleSpecialPaintPropertyUpdate(l);let j=this._transitionablePaint._values[l].value;return j.isDataDriven()||D||k||this._handleOverridablePaintPropertyUpdate(l,F,j)}}_handleSpecialPaintPropertyUpdate(l){}_handleOverridablePaintPropertyUpdate(l,f,x){return!1}isHidden(l){return!!(this.minzoom&&l<this.minzoom)||!!(this.maxzoom&&l>=this.maxzoom)||this.visibility==="none"}updateTransitions(l){this._transitioningPaint=this._transitionablePaint.transitioned(l,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(l,f){l.getCrossfadeParameters&&(this._crossfadeParameters=l.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(l,void 0,f)),this.paint=this._transitioningPaint.possiblyEvaluate(l,void 0,f)}serialize(){let l={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(l.layout=l.layout||{},l.layout.visibility=this.visibility),Et(l,(f,x)=>!(f===void 0||x==="layout"&&!Object.keys(f).length||x==="paint"&&!Object.keys(f).length))}_validate(l,f,x,S,k={}){return(!k||k.validate!==!1)&&om(this,l.call(Jc,{key:f,layerType:this.type,objectKey:x,value:S,styleSpec:ae,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(let l in this.paint._values){let f=this.paint.get(l);if(f instanceof Ko&&kr(f.property.specification)&&(f.value.kind==="source"||f.value.kind==="composite")&&f.value.isStateDependent)return!0}return!1}}let fy={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Lu{constructor(l,f){this._structArray=l,this._pos1=f*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Kn{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(l,f){return l._trim(),f&&(l.isTransferred=!0,f.push(l.arrayBuffer)),{length:l.length,arrayBuffer:l.arrayBuffer}}static deserialize(l){let f=Object.create(this.prototype);return f.arrayBuffer=l.arrayBuffer,f.length=l.length,f.capacity=l.arrayBuffer.byteLength/f.bytesPerElement,f._refreshViews(),f}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(l){this.reserve(l),this.length=l}reserve(l){if(l>this.capacity){this.capacity=Math.max(l,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);let f=this.uint8;this._refreshViews(),f&&this.uint8.set(f)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Xn(u,l=1){let f=0,x=0;return{members:u.map(S=>{let k=fy[S.type].BYTES_PER_ELEMENT,D=f=ru(f,Math.max(l,k)),F=S.components||1;return x=Math.max(x,k),f+=k*F,{name:S.name,type:S.type,components:F,offset:D}}),size:ru(f,Math.max(x,l)),alignment:l}}function ru(u,l){return Math.ceil(u/l)*l}class Sn extends Kn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,f){let x=this.length;return this.resize(x+1),this.emplace(x,l,f)}emplace(l,f,x){let S=2*l;return this.int16[S+0]=f,this.int16[S+1]=x,l}}Sn.prototype.bytesPerElement=4,Ve("StructArrayLayout2i4",Sn);class vd extends Kn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,f,x){let S=this.length;return this.resize(S+1),this.emplace(S,l,f,x)}emplace(l,f,x,S){let k=3*l;return this.int16[k+0]=f,this.int16[k+1]=x,this.int16[k+2]=S,l}}vd.prototype.bytesPerElement=6,Ve("StructArrayLayout3i6",vd);class Fh extends Kn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,f,x,S){let k=this.length;return this.resize(k+1),this.emplace(k,l,f,x,S)}emplace(l,f,x,S,k){let D=4*l;return this.int16[D+0]=f,this.int16[D+1]=x,this.int16[D+2]=S,this.int16[D+3]=k,l}}Fh.prototype.bytesPerElement=8,Ve("StructArrayLayout4i8",Fh);class mg extends Kn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,f,x,S,k,D){let F=this.length;return this.resize(F+1),this.emplace(F,l,f,x,S,k,D)}emplace(l,f,x,S,k,D,F){let j=6*l;return this.int16[j+0]=f,this.int16[j+1]=x,this.int16[j+2]=S,this.int16[j+3]=k,this.int16[j+4]=D,this.int16[j+5]=F,l}}mg.prototype.bytesPerElement=12,Ve("StructArrayLayout2i4i12",mg);class Ag extends Kn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,f,x,S,k,D){let F=this.length;return this.resize(F+1),this.emplace(F,l,f,x,S,k,D)}emplace(l,f,x,S,k,D,F){let j=4*l,Y=8*l;return this.int16[j+0]=f,this.int16[j+1]=x,this.uint8[Y+4]=S,this.uint8[Y+5]=k,this.uint8[Y+6]=D,this.uint8[Y+7]=F,l}}Ag.prototype.bytesPerElement=8,Ve("StructArrayLayout2i4ub8",Ag);class jf extends Kn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,f){let x=this.length;return this.resize(x+1),this.emplace(x,l,f)}emplace(l,f,x){let S=2*l;return this.float32[S+0]=f,this.float32[S+1]=x,l}}jf.prototype.bytesPerElement=8,Ve("StructArrayLayout2f8",jf);class gg extends Kn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,f,x,S,k,D,F,j,Y,K){let et=this.length;return this.resize(et+1),this.emplace(et,l,f,x,S,k,D,F,j,Y,K)}emplace(l,f,x,S,k,D,F,j,Y,K,et){let st=10*l;return this.uint16[st+0]=f,this.uint16[st+1]=x,this.uint16[st+2]=S,this.uint16[st+3]=k,this.uint16[st+4]=D,this.uint16[st+5]=F,this.uint16[st+6]=j,this.uint16[st+7]=Y,this.uint16[st+8]=K,this.uint16[st+9]=et,l}}gg.prototype.bytesPerElement=20,Ve("StructArrayLayout10ui20",gg);class _g extends Kn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,f,x,S,k,D,F,j,Y,K,et,st){let ct=this.length;return this.resize(ct+1),this.emplace(ct,l,f,x,S,k,D,F,j,Y,K,et,st)}emplace(l,f,x,S,k,D,F,j,Y,K,et,st,ct){let ht=12*l;return this.int16[ht+0]=f,this.int16[ht+1]=x,this.int16[ht+2]=S,this.int16[ht+3]=k,this.uint16[ht+4]=D,this.uint16[ht+5]=F,this.uint16[ht+6]=j,this.uint16[ht+7]=Y,this.int16[ht+8]=K,this.int16[ht+9]=et,this.int16[ht+10]=st,this.int16[ht+11]=ct,l}}_g.prototype.bytesPerElement=24,Ve("StructArrayLayout4i4ui4i24",_g);class si extends Kn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,f,x){let S=this.length;return this.resize(S+1),this.emplace(S,l,f,x)}emplace(l,f,x,S){let k=3*l;return this.float32[k+0]=f,this.float32[k+1]=x,this.float32[k+2]=S,l}}si.prototype.bytesPerElement=12,Ve("StructArrayLayout3f12",si);class M extends Kn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(l){let f=this.length;return this.resize(f+1),this.emplace(f,l)}emplace(l,f){return this.uint32[1*l+0]=f,l}}M.prototype.bytesPerElement=4,Ve("StructArrayLayout1ul4",M);class c extends Kn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,f,x,S,k,D,F,j,Y){let K=this.length;return this.resize(K+1),this.emplace(K,l,f,x,S,k,D,F,j,Y)}emplace(l,f,x,S,k,D,F,j,Y,K){let et=10*l,st=5*l;return this.int16[et+0]=f,this.int16[et+1]=x,this.int16[et+2]=S,this.int16[et+3]=k,this.int16[et+4]=D,this.int16[et+5]=F,this.uint32[st+3]=j,this.uint16[et+8]=Y,this.uint16[et+9]=K,l}}c.prototype.bytesPerElement=20,Ve("StructArrayLayout6i1ul2ui20",c);class A extends Kn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,f,x,S,k,D){let F=this.length;return this.resize(F+1),this.emplace(F,l,f,x,S,k,D)}emplace(l,f,x,S,k,D,F){let j=6*l;return this.int16[j+0]=f,this.int16[j+1]=x,this.int16[j+2]=S,this.int16[j+3]=k,this.int16[j+4]=D,this.int16[j+5]=F,l}}A.prototype.bytesPerElement=12,Ve("StructArrayLayout2i2i2i12",A);class w extends Kn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,f,x,S,k){let D=this.length;return this.resize(D+1),this.emplace(D,l,f,x,S,k)}emplace(l,f,x,S,k,D){let F=4*l,j=8*l;return this.float32[F+0]=f,this.float32[F+1]=x,this.float32[F+2]=S,this.int16[j+6]=k,this.int16[j+7]=D,l}}w.prototype.bytesPerElement=16,Ve("StructArrayLayout2f1f2i16",w);class E extends Kn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,f,x,S){let k=this.length;return this.resize(k+1),this.emplace(k,l,f,x,S)}emplace(l,f,x,S,k){let D=12*l,F=3*l;return this.uint8[D+0]=f,this.uint8[D+1]=x,this.float32[F+1]=S,this.float32[F+2]=k,l}}E.prototype.bytesPerElement=12,Ve("StructArrayLayout2ub2f12",E);class P extends Kn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,f,x){let S=this.length;return this.resize(S+1),this.emplace(S,l,f,x)}emplace(l,f,x,S){let k=3*l;return this.uint16[k+0]=f,this.uint16[k+1]=x,this.uint16[k+2]=S,l}}P.prototype.bytesPerElement=6,Ve("StructArrayLayout3ui6",P);class U extends Kn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,f,x,S,k,D,F,j,Y,K,et,st,ct,ht,Tt,Nt,Ut){let Kt=this.length;return this.resize(Kt+1),this.emplace(Kt,l,f,x,S,k,D,F,j,Y,K,et,st,ct,ht,Tt,Nt,Ut)}emplace(l,f,x,S,k,D,F,j,Y,K,et,st,ct,ht,Tt,Nt,Ut,Kt){let Ht=24*l,Jt=12*l,le=48*l;return this.int16[Ht+0]=f,this.int16[Ht+1]=x,this.uint16[Ht+2]=S,this.uint16[Ht+3]=k,this.uint32[Jt+2]=D,this.uint32[Jt+3]=F,this.uint32[Jt+4]=j,this.uint16[Ht+10]=Y,this.uint16[Ht+11]=K,this.uint16[Ht+12]=et,this.float32[Jt+7]=st,this.float32[Jt+8]=ct,this.uint8[le+36]=ht,this.uint8[le+37]=Tt,this.uint8[le+38]=Nt,this.uint32[Jt+10]=Ut,this.int16[Ht+22]=Kt,l}}U.prototype.bytesPerElement=48,Ve("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",U);class V extends Kn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,f,x,S,k,D,F,j,Y,K,et,st,ct,ht,Tt,Nt,Ut,Kt,Ht,Jt,le,ve,Ke,mr,Qe,Ye,je,or){let $e=this.length;return this.resize($e+1),this.emplace($e,l,f,x,S,k,D,F,j,Y,K,et,st,ct,ht,Tt,Nt,Ut,Kt,Ht,Jt,le,ve,Ke,mr,Qe,Ye,je,or)}emplace(l,f,x,S,k,D,F,j,Y,K,et,st,ct,ht,Tt,Nt,Ut,Kt,Ht,Jt,le,ve,Ke,mr,Qe,Ye,je,or,$e){let Re=32*l,Pr=16*l;return this.int16[Re+0]=f,this.int16[Re+1]=x,this.int16[Re+2]=S,this.int16[Re+3]=k,this.int16[Re+4]=D,this.int16[Re+5]=F,this.int16[Re+6]=j,this.int16[Re+7]=Y,this.uint16[Re+8]=K,this.uint16[Re+9]=et,this.uint16[Re+10]=st,this.uint16[Re+11]=ct,this.uint16[Re+12]=ht,this.uint16[Re+13]=Tt,this.uint16[Re+14]=Nt,this.uint16[Re+15]=Ut,this.uint16[Re+16]=Kt,this.uint16[Re+17]=Ht,this.uint16[Re+18]=Jt,this.uint16[Re+19]=le,this.uint16[Re+20]=ve,this.uint16[Re+21]=Ke,this.uint16[Re+22]=mr,this.uint32[Pr+12]=Qe,this.float32[Pr+13]=Ye,this.float32[Pr+14]=je,this.uint16[Re+30]=or,this.uint16[Re+31]=$e,l}}V.prototype.bytesPerElement=64,Ve("StructArrayLayout8i15ui1ul2f2ui64",V);class $ extends Kn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l){let f=this.length;return this.resize(f+1),this.emplace(f,l)}emplace(l,f){return this.float32[1*l+0]=f,l}}$.prototype.bytesPerElement=4,Ve("StructArrayLayout1f4",$);class G extends Kn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,f,x){let S=this.length;return this.resize(S+1),this.emplace(S,l,f,x)}emplace(l,f,x,S){let k=3*l;return this.uint16[6*l+0]=f,this.float32[k+1]=x,this.float32[k+2]=S,l}}G.prototype.bytesPerElement=12,Ve("StructArrayLayout1ui2f12",G);class J extends Kn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,f,x){let S=this.length;return this.resize(S+1),this.emplace(S,l,f,x)}emplace(l,f,x,S){let k=4*l;return this.uint32[2*l+0]=f,this.uint16[k+2]=x,this.uint16[k+3]=S,l}}J.prototype.bytesPerElement=8,Ve("StructArrayLayout1ul2ui8",J);class tt extends Kn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,f){let x=this.length;return this.resize(x+1),this.emplace(x,l,f)}emplace(l,f,x){let S=2*l;return this.uint16[S+0]=f,this.uint16[S+1]=x,l}}tt.prototype.bytesPerElement=4,Ve("StructArrayLayout2ui4",tt);class lt extends Kn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l){let f=this.length;return this.resize(f+1),this.emplace(f,l)}emplace(l,f){return this.uint16[1*l+0]=f,l}}lt.prototype.bytesPerElement=2,Ve("StructArrayLayout1ui2",lt);class wt extends Kn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,f,x,S){let k=this.length;return this.resize(k+1),this.emplace(k,l,f,x,S)}emplace(l,f,x,S,k){let D=4*l;return this.float32[D+0]=f,this.float32[D+1]=x,this.float32[D+2]=S,this.float32[D+3]=k,l}}wt.prototype.bytesPerElement=16,Ve("StructArrayLayout4f16",wt);class bt extends Lu{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new g(this.anchorPointX,this.anchorPointY)}}bt.prototype.size=20;class Rt extends c{get(l){return new bt(this,l)}}Ve("CollisionBoxArray",Rt);class yt extends Lu{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(l){this._structArray.uint8[this._pos1+37]=l}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(l){this._structArray.uint8[this._pos1+38]=l}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(l){this._structArray.uint32[this._pos4+10]=l}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}yt.prototype.size=48;class Zt extends U{get(l){return new yt(this,l)}}Ve("PlacedSymbolArray",Zt);class se extends Lu{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(l){this._structArray.uint32[this._pos4+12]=l}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}se.prototype.size=64;class Bt extends V{get(l){return new se(this,l)}}Ve("SymbolInstanceArray",Bt);class Gt extends ${getoffsetX(l){return this.float32[1*l+0]}}Ve("GlyphOffsetArray",Gt);class he extends vd{getx(l){return this.int16[3*l+0]}gety(l){return this.int16[3*l+1]}gettileUnitDistanceFromAnchor(l){return this.int16[3*l+2]}}Ve("SymbolLineVertexArray",he);class ce extends Lu{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}ce.prototype.size=12;class xe extends G{get(l){return new ce(this,l)}}Ve("TextAnchorOffsetArray",xe);class Pe extends Lu{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}Pe.prototype.size=8;class Te extends J{get(l){return new Pe(this,l)}}Ve("FeatureIndexArray",Te);class Le extends Sn{}class hr extends Sn{}class Di extends Sn{}class He extends mg{}class Cr extends Ag{}class fr extends jf{}class dn extends gg{}class Ci extends _g{}class fi extends si{}class Oi extends M{}class Ts extends A{}class Un extends E{}class vo extends P{}class Gs extends tt{}let Ss=Xn([{name:"a_pos",components:2,type:"Int16"}],4),{members:Oa}=Ss;class Vn{constructor(l=[]){this.segments=l}prepareSegment(l,f,x,S){let k=this.segments[this.segments.length-1];return l>Vn.MAX_VERTEX_ARRAY_LENGTH&&re(`Max vertices per segment is ${Vn.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${l}`),(!k||k.vertexLength+l>Vn.MAX_VERTEX_ARRAY_LENGTH||k.sortKey!==S)&&(k={vertexOffset:f.length,primitiveOffset:x.length,vertexLength:0,primitiveLength:0},S!==void 0&&(k.sortKey=S),this.segments.push(k)),k}get(){return this.segments}destroy(){for(let l of this.segments)for(let f in l.vaos)l.vaos[f].destroy()}static simpleSegment(l,f,x,S){return new Vn([{vertexOffset:l,primitiveOffset:f,vertexLength:x,primitiveLength:S,vaos:{},sortKey:0}])}}function co(u,l){return 256*(u=q(Math.floor(u),0,255))+q(Math.floor(l),0,255)}Vn.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Ve("SegmentVector",Vn);let Bl=Xn([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Fu={exports:{}},zh={exports:{}};zh.exports=function(u,l){var f,x,S,k,D,F,j,Y;for(x=u.length-(f=3&u.length),S=l,D=3432918353,F=461845907,Y=0;Y<x;)j=255&u.charCodeAt(Y)|(255&u.charCodeAt(++Y))<<8|(255&u.charCodeAt(++Y))<<16|(255&u.charCodeAt(++Y))<<24,++Y,S=27492+(65535&(k=5*(65535&(S=(S^=j=(65535&(j=(j=(65535&j)*D+(((j>>>16)*D&65535)<<16)&4294967295)<<15|j>>>17))*F+(((j>>>16)*F&65535)<<16)&4294967295)<<13|S>>>19))+((5*(S>>>16)&65535)<<16)&4294967295))+((58964+(k>>>16)&65535)<<16);switch(j=0,f){case 3:j^=(255&u.charCodeAt(Y+2))<<16;case 2:j^=(255&u.charCodeAt(Y+1))<<8;case 1:S^=j=(65535&(j=(j=(65535&(j^=255&u.charCodeAt(Y)))*D+(((j>>>16)*D&65535)<<16)&4294967295)<<15|j>>>17))*F+(((j>>>16)*F&65535)<<16)&4294967295}return S^=u.length,S=2246822507*(65535&(S^=S>>>16))+((2246822507*(S>>>16)&65535)<<16)&4294967295,S=3266489909*(65535&(S^=S>>>13))+((3266489909*(S>>>16)&65535)<<16)&4294967295,(S^=S>>>16)>>>0};var Wf=zh.exports,Vo={exports:{}};Vo.exports=function(u,l){for(var f,x=u.length,S=l^x,k=0;x>=4;)f=1540483477*(65535&(f=255&u.charCodeAt(k)|(255&u.charCodeAt(++k))<<8|(255&u.charCodeAt(++k))<<16|(255&u.charCodeAt(++k))<<24))+((1540483477*(f>>>16)&65535)<<16),S=1540483477*(65535&S)+((1540483477*(S>>>16)&65535)<<16)^(f=1540483477*(65535&(f^=f>>>24))+((1540483477*(f>>>16)&65535)<<16)),x-=4,++k;switch(x){case 3:S^=(255&u.charCodeAt(k+2))<<16;case 2:S^=(255&u.charCodeAt(k+1))<<8;case 1:S=1540483477*(65535&(S^=255&u.charCodeAt(k)))+((1540483477*(S>>>16)&65535)<<16)}return S=1540483477*(65535&(S^=S>>>13))+((1540483477*(S>>>16)&65535)<<16),(S^=S>>>15)>>>0};var wo=Wf,Es=Vo.exports;Fu.exports=wo,Fu.exports.murmur3=wo,Fu.exports.murmur2=Es;var zu=a(Fu.exports);class ps{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(l,f,x,S){this.ids.push(Qs(l)),this.positions.push(f,x,S)}getPositions(l){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");let f=Qs(l),x=0,S=this.ids.length-1;for(;x<S;){let D=x+S>>1;this.ids[D]>=f?S=D:x=D+1}let k=[];for(;this.ids[x]===f;)k.push({index:this.positions[3*x],start:this.positions[3*x+1],end:this.positions[3*x+2]}),x++;return k}static serialize(l,f){let x=new Float64Array(l.ids),S=new Uint32Array(l.positions);return da(x,S,0,x.length-1),f&&f.push(x.buffer,S.buffer),{ids:x,positions:S}}static deserialize(l){let f=new ps;return f.ids=l.ids,f.positions=l.positions,f.indexed=!0,f}}function Qs(u){let l=+u;return!isNaN(l)&&l<=Number.MAX_SAFE_INTEGER?l:zu(String(u))}function da(u,l,f,x){for(;f<x;){let S=u[f+x>>1],k=f-1,D=x+1;for(;;){do k++;while(u[k]<S);do D--;while(u[D]>S);if(k>=D)break;Is(u,k,D),Is(l,3*k,3*D),Is(l,3*k+1,3*D+1),Is(l,3*k+2,3*D+2)}D-f<x-D?(da(u,l,f,D),f=D+1):(da(u,l,D+1,x),x=D)}}function Is(u,l,f){let x=u[l];u[l]=u[f],u[f]=x}Ve("FeaturePositionMap",ps);class Uh{constructor(l,f){this.gl=l.gl,this.location=f}}class fm extends Uh{constructor(l,f){super(l,f),this.current=0}set(l){this.current!==l&&(this.current=l,this.gl.uniform1f(this.location,l))}}class py extends Uh{constructor(l,f){super(l,f),this.current=[0,0,0,0]}set(l){l[0]===this.current[0]&&l[1]===this.current[1]&&l[2]===this.current[2]&&l[3]===this.current[3]||(this.current=l,this.gl.uniform4f(this.location,l[0],l[1],l[2],l[3]))}}class dy extends Uh{constructor(l,f){super(l,f),this.current=Hi.transparent}set(l){l.r===this.current.r&&l.g===this.current.g&&l.b===this.current.b&&l.a===this.current.a||(this.current=l,this.gl.uniform4f(this.location,l.r,l.g,l.b,l.a))}}let Wb=new Float32Array(16);function yg(u){return[co(255*u.r,255*u.g),co(255*u.b,255*u.a)]}class dc{constructor(l,f,x){this.value=l,this.uniformNames=f.map(S=>`u_${S}`),this.type=x}setUniform(l,f,x){l.set(x.constantOr(this.value))}getBinding(l,f,x){return this.type==="color"?new dy(l,f):new fm(l,f)}}class Vh{constructor(l,f){this.uniformNames=f.map(x=>`u_${x}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(l,f){this.pixelRatioFrom=f.pixelRatio,this.pixelRatioTo=l.pixelRatio,this.patternFrom=f.tlbr,this.patternTo=l.tlbr}setUniform(l,f,x,S){let k=S==="u_pattern_to"?this.patternTo:S==="u_pattern_from"?this.patternFrom:S==="u_pixel_ratio_to"?this.pixelRatioTo:S==="u_pixel_ratio_from"?this.pixelRatioFrom:null;k&&l.set(k)}getBinding(l,f,x){return x.substr(0,9)==="u_pattern"?new py(l,f):new fm(l,f)}}class Nl{constructor(l,f,x,S){this.expression=l,this.type=x,this.maxValue=0,this.paintVertexAttributes=f.map(k=>({name:`a_${k}`,type:"Float32",components:x==="color"?2:1,offset:0})),this.paintVertexArray=new S}populatePaintArray(l,f,x,S,k){let D=this.paintVertexArray.length,F=this.expression.evaluate(new Yn(0),f,{},S,[],k);this.paintVertexArray.resize(l),this._setPaintValue(D,l,F)}updatePaintArray(l,f,x,S){let k=this.expression.evaluate({zoom:0},x,S);this._setPaintValue(l,f,k)}_setPaintValue(l,f,x){if(this.type==="color"){let S=yg(x);for(let k=l;k<f;k++)this.paintVertexArray.emplace(k,S[0],S[1])}else{for(let S=l;S<f;S++)this.paintVertexArray.emplace(S,x);this.maxValue=Math.max(this.maxValue,Math.abs(x))}}upload(l){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=l.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Ba{constructor(l,f,x,S,k,D){this.expression=l,this.uniformNames=f.map(F=>`u_${F}_t`),this.type=x,this.useIntegerZoom=S,this.zoom=k,this.maxValue=0,this.paintVertexAttributes=f.map(F=>({name:`a_${F}`,type:"Float32",components:x==="color"?4:2,offset:0})),this.paintVertexArray=new D}populatePaintArray(l,f,x,S,k){let D=this.expression.evaluate(new Yn(this.zoom),f,{},S,[],k),F=this.expression.evaluate(new Yn(this.zoom+1),f,{},S,[],k),j=this.paintVertexArray.length;this.paintVertexArray.resize(l),this._setPaintValue(j,l,D,F)}updatePaintArray(l,f,x,S){let k=this.expression.evaluate({zoom:this.zoom},x,S),D=this.expression.evaluate({zoom:this.zoom+1},x,S);this._setPaintValue(l,f,k,D)}_setPaintValue(l,f,x,S){if(this.type==="color"){let k=yg(x),D=yg(S);for(let F=l;F<f;F++)this.paintVertexArray.emplace(F,k[0],k[1],D[0],D[1])}else{for(let k=l;k<f;k++)this.paintVertexArray.emplace(k,x,S);this.maxValue=Math.max(this.maxValue,Math.abs(x),Math.abs(S))}}upload(l){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=l.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(l,f){let x=this.useIntegerZoom?Math.floor(f.zoom):f.zoom,S=q(this.expression.interpolationFactor(x,this.zoom,this.zoom+1),0,1);l.set(S)}getBinding(l,f,x){return new fm(l,f)}}class Cn{constructor(l,f,x,S,k,D){this.expression=l,this.type=f,this.useIntegerZoom=x,this.zoom=S,this.layerId=D,this.zoomInPaintVertexArray=new k,this.zoomOutPaintVertexArray=new k}populatePaintArray(l,f,x){let S=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(l),this.zoomOutPaintVertexArray.resize(l),this._setPaintValues(S,l,f.patterns&&f.patterns[this.layerId],x)}updatePaintArray(l,f,x,S,k){this._setPaintValues(l,f,x.patterns&&x.patterns[this.layerId],k)}_setPaintValues(l,f,x,S){if(!S||!x)return;let{min:k,mid:D,max:F}=x,j=S[k],Y=S[D],K=S[F];if(j&&Y&&K)for(let et=l;et<f;et++)this.zoomInPaintVertexArray.emplace(et,Y.tl[0],Y.tl[1],Y.br[0],Y.br[1],j.tl[0],j.tl[1],j.br[0],j.br[1],Y.pixelRatio,j.pixelRatio),this.zoomOutPaintVertexArray.emplace(et,Y.tl[0],Y.tl[1],Y.br[0],Y.br[1],K.tl[0],K.tl[1],K.br[0],K.br[1],Y.pixelRatio,K.pixelRatio)}upload(l){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=l.createVertexBuffer(this.zoomInPaintVertexArray,Bl.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=l.createVertexBuffer(this.zoomOutPaintVertexArray,Bl.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class xg{constructor(l,f,x){this.binders={},this._buffers=[];let S=[];for(let k in l.paint._values){if(!x(k))continue;let D=l.paint.get(k);if(!(D instanceof Ko&&kr(D.property.specification)))continue;let F=bg(k,l.type),j=D.value,Y=D.property.specification.type,K=D.property.useIntegerZoom,et=D.property.specification["property-type"],st=et==="cross-faded"||et==="cross-faded-data-driven";if(j.kind==="constant")this.binders[k]=st?new Vh(j.value,F):new dc(j.value,F,Y),S.push(`/u_${k}`);else if(j.kind==="source"||st){let ct=Ll(k,Y,"source");this.binders[k]=st?new Cn(j,Y,K,f,ct,l.id):new Nl(j,F,Y,ct),S.push(`/a_${k}`)}else{let ct=Ll(k,Y,"composite");this.binders[k]=new Ba(j,F,Y,K,f,ct),S.push(`/z_${k}`)}}this.cacheKey=S.sort().join("")}getMaxValue(l){let f=this.binders[l];return f instanceof Nl||f instanceof Ba?f.maxValue:0}populatePaintArrays(l,f,x,S,k){for(let D in this.binders){let F=this.binders[D];(F instanceof Nl||F instanceof Ba||F instanceof Cn)&&F.populatePaintArray(l,f,x,S,k)}}setConstantPatternPositions(l,f){for(let x in this.binders){let S=this.binders[x];S instanceof Vh&&S.setConstantPatternPositions(l,f)}}updatePaintArrays(l,f,x,S,k){let D=!1;for(let F in l){let j=f.getPositions(F);for(let Y of j){let K=x.feature(Y.index);for(let et in this.binders){let st=this.binders[et];if((st instanceof Nl||st instanceof Ba||st instanceof Cn)&&st.expression.isStateDependent===!0){let ct=S.paint.get(et);st.expression=ct.value,st.updatePaintArray(Y.start,Y.end,K,l[F],k),D=!0}}}}return D}defines(){let l=[];for(let f in this.binders){let x=this.binders[f];(x instanceof dc||x instanceof Vh)&&l.push(...x.uniformNames.map(S=>`#define HAS_UNIFORM_${S}`))}return l}getBinderAttributes(){let l=[];for(let f in this.binders){let x=this.binders[f];if(x instanceof Nl||x instanceof Ba)for(let S=0;S<x.paintVertexAttributes.length;S++)l.push(x.paintVertexAttributes[S].name);else if(x instanceof Cn)for(let S=0;S<Bl.members.length;S++)l.push(Bl.members[S].name)}return l}getBinderUniforms(){let l=[];for(let f in this.binders){let x=this.binders[f];if(x instanceof dc||x instanceof Vh||x instanceof Ba)for(let S of x.uniformNames)l.push(S)}return l}getPaintVertexBuffers(){return this._buffers}getUniforms(l,f){let x=[];for(let S in this.binders){let k=this.binders[S];if(k instanceof dc||k instanceof Vh||k instanceof Ba){for(let D of k.uniformNames)if(f[D]){let F=k.getBinding(l,f[D],D);x.push({name:D,property:S,binding:F})}}}return x}setUniforms(l,f,x,S){for(let{name:k,property:D,binding:F}of f)this.binders[D].setUniform(F,S,x.get(D),k)}updatePaintBuffers(l){this._buffers=[];for(let f in this.binders){let x=this.binders[f];if(l&&x instanceof Cn){let S=l.fromScale===2?x.zoomInPaintVertexBuffer:x.zoomOutPaintVertexBuffer;S&&this._buffers.push(S)}else(x instanceof Nl||x instanceof Ba)&&x.paintVertexBuffer&&this._buffers.push(x.paintVertexBuffer)}}upload(l){for(let f in this.binders){let x=this.binders[f];(x instanceof Nl||x instanceof Ba||x instanceof Cn)&&x.upload(l)}this.updatePaintBuffers()}destroy(){for(let l in this.binders){let f=this.binders[l];(f instanceof Nl||f instanceof Ba||f instanceof Cn)&&f.destroy()}}}class iu{constructor(l,f,x=()=>!0){this.programConfigurations={};for(let S of l)this.programConfigurations[S.id]=new xg(S,f,x);this.needsUpload=!1,this._featureMap=new ps,this._bufferOffset=0}populatePaintArrays(l,f,x,S,k,D){for(let F in this.programConfigurations)this.programConfigurations[F].populatePaintArrays(l,f,S,k,D);f.id!==void 0&&this._featureMap.add(f.id,x,this._bufferOffset,l),this._bufferOffset=l,this.needsUpload=!0}updatePaintArrays(l,f,x,S){for(let k of x)this.needsUpload=this.programConfigurations[k.id].updatePaintArrays(l,this._featureMap,f,k,S)||this.needsUpload}get(l){return this.programConfigurations[l]}upload(l){if(this.needsUpload){for(let f in this.programConfigurations)this.programConfigurations[f].upload(l);this.needsUpload=!1}}destroy(){for(let l in this.programConfigurations)this.programConfigurations[l].destroy()}}function bg(u,l){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[u]||[u.replace(`${l}-`,"").replace(/-/g,"_")]}function Ll(u,l,f){let x={color:{source:jf,composite:wt},number:{source:$,composite:jf}},S=function(k){return{"line-pattern":{source:dn,composite:dn},"fill-pattern":{source:dn,composite:dn},"fill-extrusion-pattern":{source:dn,composite:dn}}[k]}(u);return S&&S[f]||x[l][f]}Ve("ConstantBinder",dc),Ve("CrossFadedConstantBinder",Vh),Ve("SourceExpressionBinder",Nl),Ve("CrossFadedCompositeBinder",Cn),Ve("CompositeExpressionBinder",Ba),Ve("ProgramConfiguration",xg,{omit:["_buffers"]}),Ve("ProgramConfigurationSet",iu);let Vs=8192,$b=Math.pow(2,14)-1,I4=-$b-1;function $f(u){let l=Vs/u.extent,f=u.loadGeometry();for(let x=0;x<f.length;x++){let S=f[x];for(let k=0;k<S.length;k++){let D=S[k],F=Math.round(D.x*l),j=Math.round(D.y*l);D.x=q(F,I4,$b),D.y=q(j,I4,$b),(F<D.x||F>D.x+1||j<D.y||j>D.y+1)&&re("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return f}function Hf(u,l){return{type:u.type,id:u.id,properties:u.properties,geometry:l?$f(u):[]}}function vg(u,l,f,x,S){u.emplaceBack(2*l+(x+1)/2,2*f+(S+1)/2)}class my{constructor(l){this.zoom=l.zoom,this.overscaling=l.overscaling,this.layers=l.layers,this.layerIds=this.layers.map(f=>f.id),this.index=l.index,this.hasPattern=!1,this.layoutVertexArray=new hr,this.indexArray=new vo,this.segments=new Vn,this.programConfigurations=new iu(l.layers,l.zoom),this.stateDependentLayerIds=this.layers.filter(f=>f.isStateDependent()).map(f=>f.id)}populate(l,f,x){let S=this.layers[0],k=[],D=null,F=!1;S.type==="circle"&&(D=S.layout.get("circle-sort-key"),F=!D.isConstant());for(let{feature:j,id:Y,index:K,sourceLayerIndex:et}of l){let st=this.layers[0]._featureFilter.needGeometry,ct=Hf(j,st);if(!this.layers[0]._featureFilter.filter(new Yn(this.zoom),ct,x))continue;let ht=F?D.evaluate(ct,{},x):void 0,Tt={id:Y,properties:j.properties,type:j.type,sourceLayerIndex:et,index:K,geometry:st?ct.geometry:$f(j),patterns:{},sortKey:ht};k.push(Tt)}F&&k.sort((j,Y)=>j.sortKey-Y.sortKey);for(let j of k){let{geometry:Y,index:K,sourceLayerIndex:et}=j,st=l[K].feature;this.addFeature(j,Y,K,x),f.featureIndex.insert(st,Y,K,et,this.index)}}update(l,f,x){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(l,f,this.stateDependentLayers,x)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(l){this.uploaded||(this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,Oa),this.indexBuffer=l.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(l),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(l,f,x,S){for(let k of f)for(let D of k){let F=D.x,j=D.y;if(F<0||F>=Vs||j<0||j>=Vs)continue;let Y=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,l.sortKey),K=Y.vertexLength;vg(this.layoutVertexArray,F,j,-1,-1),vg(this.layoutVertexArray,F,j,1,-1),vg(this.layoutVertexArray,F,j,1,1),vg(this.layoutVertexArray,F,j,-1,1),this.indexArray.emplaceBack(K,K+1,K+2),this.indexArray.emplaceBack(K,K+3,K+2),Y.vertexLength+=4,Y.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,l,x,{},S)}}function M4(u,l){for(let f=0;f<u.length;f++)if(Ii(l,u[f]))return!0;for(let f=0;f<l.length;f++)if(Ii(u,l[f]))return!0;return!!Hb(u,l)}function YP(u,l,f){return!!Ii(u,l)||!!mc(l,u,f)}function C4(u,l){if(u.length===1)return nu(l,u[0]);for(let f=0;f<l.length;f++){let x=l[f];for(let S=0;S<x.length;S++)if(Ii(u,x[S]))return!0}for(let f=0;f<u.length;f++)if(nu(l,u[f]))return!0;for(let f=0;f<l.length;f++)if(Hb(u,l[f]))return!0;return!1}function XP(u,l,f){if(u.length>1){if(Hb(u,l))return!0;for(let x=0;x<l.length;x++)if(mc(l[x],u,f))return!0}for(let x=0;x<u.length;x++)if(mc(u[x],l,f))return!0;return!1}function Hb(u,l){if(u.length===0||l.length===0)return!1;for(let f=0;f<u.length-1;f++){let x=u[f],S=u[f+1];for(let k=0;k<l.length-1;k++)if(qf(x,S,l[k],l[k+1]))return!0}return!1}function qf(u,l,f,x){return $t(u,f,x)!==$t(l,f,x)&&$t(u,l,f)!==$t(u,l,x)}function mc(u,l,f){let x=f*f;if(l.length===1)return u.distSqr(l[0])<x;for(let S=1;S<l.length;S++)if(oi(u,l[S-1],l[S])<x)return!0;return!1}function oi(u,l,f){let x=l.distSqr(f);if(x===0)return u.distSqr(l);let S=((u.x-l.x)*(f.x-l.x)+(u.y-l.y)*(f.y-l.y))/x;return u.distSqr(S<0?l:S>1?f:f.sub(l)._mult(S)._add(l))}function nu(u,l){let f,x,S,k=!1;for(let D=0;D<u.length;D++){f=u[D];for(let F=0,j=f.length-1;F<f.length;j=F++)x=f[F],S=f[j],x.y>l.y!=S.y>l.y&&l.x<(S.x-x.x)*(l.y-x.y)/(S.y-x.y)+x.x&&(k=!k)}return k}function Ii(u,l){let f=!1;for(let x=0,S=u.length-1;x<u.length;S=x++){let k=u[x],D=u[S];k.y>l.y!=D.y>l.y&&l.x<(D.x-k.x)*(l.y-k.y)/(D.y-k.y)+k.x&&(f=!f)}return f}function ma(u,l,f){let x=f[0],S=f[2];if(u.x<x.x&&l.x<x.x||u.x>S.x&&l.x>S.x||u.y<x.y&&l.y<x.y||u.y>S.y&&l.y>S.y)return!1;let k=$t(u,l,f[0]);return k!==$t(u,l,f[1])||k!==$t(u,l,f[2])||k!==$t(u,l,f[3])}function pm(u,l,f){let x=l.paint.get(u).value;return x.kind==="constant"?x.value:f.programConfigurations.get(l.id).getMaxValue(u)}function dm(u){return Math.sqrt(u[0]*u[0]+u[1]*u[1])}function Uu(u,l,f,x,S){if(!l[0]&&!l[1])return u;let k=g.convert(l)._mult(S);f==="viewport"&&k._rotate(-x);let D=[];for(let F=0;F<u.length;F++)D.push(u[F].sub(k));return D}let P4,Jo;Ve("CircleBucket",my,{omit:["layers"]});var Ay={get paint(){return Jo=Jo||new Ds({"circle-radius":new Dr(ae.paint_circle["circle-radius"]),"circle-color":new Dr(ae.paint_circle["circle-color"]),"circle-blur":new Dr(ae.paint_circle["circle-blur"]),"circle-opacity":new Dr(ae.paint_circle["circle-opacity"]),"circle-translate":new ur(ae.paint_circle["circle-translate"]),"circle-translate-anchor":new ur(ae.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new ur(ae.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new ur(ae.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Dr(ae.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Dr(ae.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Dr(ae.paint_circle["circle-stroke-opacity"])})},get layout(){return P4=P4||new Ds({"circle-sort-key":new Dr(ae.layout_circle["circle-sort-key"])})}},Ks=1e-6,wd=typeof Float32Array<"u"?Float32Array:Array;function De(u){return u[0]=1,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=1,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=1,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u}function Ge(u,l,f){var x=l[0],S=l[1],k=l[2],D=l[3],F=l[4],j=l[5],Y=l[6],K=l[7],et=l[8],st=l[9],ct=l[10],ht=l[11],Tt=l[12],Nt=l[13],Ut=l[14],Kt=l[15],Ht=f[0],Jt=f[1],le=f[2],ve=f[3];return u[0]=Ht*x+Jt*F+le*et+ve*Tt,u[1]=Ht*S+Jt*j+le*st+ve*Nt,u[2]=Ht*k+Jt*Y+le*ct+ve*Ut,u[3]=Ht*D+Jt*K+le*ht+ve*Kt,u[4]=(Ht=f[4])*x+(Jt=f[5])*F+(le=f[6])*et+(ve=f[7])*Tt,u[5]=Ht*S+Jt*j+le*st+ve*Nt,u[6]=Ht*k+Jt*Y+le*ct+ve*Ut,u[7]=Ht*D+Jt*K+le*ht+ve*Kt,u[8]=(Ht=f[8])*x+(Jt=f[9])*F+(le=f[10])*et+(ve=f[11])*Tt,u[9]=Ht*S+Jt*j+le*st+ve*Nt,u[10]=Ht*k+Jt*Y+le*ct+ve*Ut,u[11]=Ht*D+Jt*K+le*ht+ve*Kt,u[12]=(Ht=f[12])*x+(Jt=f[13])*F+(le=f[14])*et+(ve=f[15])*Tt,u[13]=Ht*S+Jt*j+le*st+ve*Nt,u[14]=Ht*k+Jt*Y+le*ct+ve*Ut,u[15]=Ht*D+Jt*K+le*ht+ve*Kt,u}Math.hypot||(Math.hypot=function(){for(var u=0,l=arguments.length;l--;)u+=arguments[l]*arguments[l];return Math.sqrt(u)});var mm,qb=Ge;function Td(u,l,f){var x=l[0],S=l[1],k=l[2],D=l[3];return u[0]=f[0]*x+f[4]*S+f[8]*k+f[12]*D,u[1]=f[1]*x+f[5]*S+f[9]*k+f[13]*D,u[2]=f[2]*x+f[6]*S+f[10]*k+f[14]*D,u[3]=f[3]*x+f[7]*S+f[11]*k+f[15]*D,u}mm=new wd(4),wd!=Float32Array&&(mm[0]=0,mm[1]=0,mm[2]=0,mm[3]=0);class gy extends Da{constructor(l){super(l,Ay)}createBucket(l){return new my(l)}queryRadius(l){let f=l;return pm("circle-radius",this,f)+pm("circle-stroke-width",this,f)+dm(this.paint.get("circle-translate"))}queryIntersectsFeature(l,f,x,S,k,D,F,j){let Y=Uu(l,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),D.angle,F),K=this.paint.get("circle-radius").evaluate(f,x)+this.paint.get("circle-stroke-width").evaluate(f,x),et=this.paint.get("circle-pitch-alignment")==="map",st=et?Y:function(ht,Tt){return ht.map(Nt=>Yf(Nt,Tt))}(Y,j),ct=et?K*F:K;for(let ht of S)for(let Tt of ht){let Nt=et?Tt:Yf(Tt,j),Ut=ct,Kt=Td([],[Tt.x,Tt.y,0,1],j);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Ut*=Kt[3]/D.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Ut*=D.cameraToCenterDistance/Kt[3]),YP(st,Nt,Ut))return!0}return!1}}function Yf(u,l){let f=Td([],[u.x,u.y,0,1],l);return new g(f[0]/f[3],f[1]/f[3])}class Yb extends my{}let jh;Ve("HeatmapBucket",Yb,{omit:["layers"]});var m={get paint(){return jh=jh||new Ds({"heatmap-radius":new Dr(ae.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Dr(ae.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new ur(ae.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Nu(ae.paint_heatmap["heatmap-color"]),"heatmap-opacity":new ur(ae.paint_heatmap["heatmap-opacity"])})}};function d(u,{width:l,height:f},x,S){if(S){if(S instanceof Uint8ClampedArray)S=new Uint8Array(S.buffer);else if(S.length!==l*f*x)throw new RangeError(`mismatched image size. expected: ${S.length} but got: ${l*f*x}`)}else S=new Uint8Array(l*f*x);return u.width=l,u.height=f,u.data=S,u}function y(u,{width:l,height:f},x){if(l===u.width&&f===u.height)return;let S=d({},{width:l,height:f},x);b(u,S,{x:0,y:0},{x:0,y:0},{width:Math.min(u.width,l),height:Math.min(u.height,f)},x),u.width=l,u.height=f,u.data=S.data}function b(u,l,f,x,S,k){if(S.width===0||S.height===0)return l;if(S.width>u.width||S.height>u.height||f.x>u.width-S.width||f.y>u.height-S.height)throw new RangeError("out of range source coordinates for image copy");if(S.width>l.width||S.height>l.height||x.x>l.width-S.width||x.y>l.height-S.height)throw new RangeError("out of range destination coordinates for image copy");let D=u.data,F=l.data;if(D===F)throw new Error("srcData equals dstData, so image is already copied");for(let j=0;j<S.height;j++){let Y=((f.y+j)*u.width+f.x)*k,K=((x.y+j)*l.width+x.x)*k;for(let et=0;et<S.width*k;et++)F[K+et]=D[Y+et]}return l}class I{constructor(l,f){d(this,l,1,f)}resize(l){y(this,l,1)}clone(){return new I({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(l,f,x,S,k){b(l,f,x,S,k,1)}}class R{constructor(l,f){d(this,l,4,f)}resize(l){y(this,l,4)}replace(l,f){f?this.data.set(l):this.data=l instanceof Uint8ClampedArray?new Uint8Array(l.buffer):l}clone(){return new R({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(l,f,x,S,k){b(l,f,x,S,k,4)}}function O(u){let l={},f=u.resolution||256,x=u.clips?u.clips.length:1,S=u.image||new R({width:f,height:x});if(Math.log(f)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${f}`);let k=(D,F,j)=>{l[u.evaluationKey]=j;let Y=u.expression.evaluate(l);S.data[D+F+0]=Math.floor(255*Y.r/Y.a),S.data[D+F+1]=Math.floor(255*Y.g/Y.a),S.data[D+F+2]=Math.floor(255*Y.b/Y.a),S.data[D+F+3]=Math.floor(255*Y.a)};if(u.clips)for(let D=0,F=0;D<x;++D,F+=4*f)for(let j=0,Y=0;j<f;j++,Y+=4){let K=j/(f-1),{start:et,end:st}=u.clips[D];k(F,Y,et*(1-K)+st*K)}else for(let D=0,F=0;D<f;D++,F+=4)k(0,F,D/(f-1));return S}Ve("AlphaImage",I),Ve("RGBAImage",R);class N extends Da{createBucket(l){return new Yb(l)}constructor(l){super(l,m),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(l){l==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=O({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let H;var Q={get paint(){return H=H||new Ds({"hillshade-illumination-direction":new ur(ae.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new ur(ae.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new ur(ae.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new ur(ae.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new ur(ae.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new ur(ae.paint_hillshade["hillshade-accent-color"])})}};class ot extends Da{constructor(l){super(l,Q)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}let At=Xn([{name:"a_pos",components:2,type:"Int16"}],4),{members:jt}=At;var Xt={exports:{}};function zt(u,l,f){f=f||2;var x,S,k,D,F,j,Y,K=l&&l.length,et=K?l[0]*f:u.length,st=ie(u,0,et,f,!0),ct=[];if(!st||st.next===st.prev)return ct;if(K&&(st=function(Tt,Nt,Ut,Kt){var Ht,Jt,le,ve=[];for(Ht=0,Jt=Nt.length;Ht<Jt;Ht++)(le=ie(Tt,Nt[Ht]*Kt,Ht<Jt-1?Nt[Ht+1]*Kt:Tt.length,Kt,!1))===le.next&&(le.steiner=!0),ve.push(hn(le));for(ve.sort(pr),Ht=0;Ht<ve.length;Ht++)Ut=Xe(ve[Ht],Ut);return Ut}(u,l,st,f)),u.length>80*f){x=k=u[0],S=D=u[1];for(var ht=f;ht<et;ht+=f)(F=u[ht])<x&&(x=F),(j=u[ht+1])<S&&(S=j),F>k&&(k=F),j>D&&(D=j);Y=(Y=Math.max(k-x,D-S))!==0?32767/Y:0}return me(st,ct,f,x,S,Y,0),ct}function ie(u,l,f,x,S){var k,D;if(S===GP(u,l,f,x)>0)for(k=l;k<f;k+=x)D=Qz(k,u[k],u[k+1],D);else for(k=f-x;k>=l;k-=x)D=Qz(k,u[k],u[k+1],D);return D&&gi(D,D.next)&&(Zb(D),D=D.next),D}function ge(u,l){if(!u)return u;l||(l=u);var f,x=u;do if(f=!1,x.steiner||!gi(x,x.next)&&Ar(x.prev,x,x.next)!==0)x=x.next;else{if(Zb(x),(x=l=x.prev)===x.next)break;f=!0}while(f||x!==l);return l}function me(u,l,f,x,S,k,D){if(u){!D&&k&&function(K,et,st,ct){var ht=K;do ht.z===0&&(ht.z=xn(ht.x,ht.y,et,st,ct)),ht.prevZ=ht.prev,ht.nextZ=ht.next,ht=ht.next;while(ht!==K);ht.prevZ.nextZ=null,ht.prevZ=null,function(Tt){var Nt,Ut,Kt,Ht,Jt,le,ve,Ke,mr=1;do{for(Ut=Tt,Tt=null,Jt=null,le=0;Ut;){for(le++,Kt=Ut,ve=0,Nt=0;Nt<mr&&(ve++,Kt=Kt.nextZ);Nt++);for(Ke=mr;ve>0||Ke>0&&Kt;)ve!==0&&(Ke===0||!Kt||Ut.z<=Kt.z)?(Ht=Ut,Ut=Ut.nextZ,ve--):(Ht=Kt,Kt=Kt.nextZ,Ke--),Jt?Jt.nextZ=Ht:Tt=Ht,Ht.prevZ=Jt,Jt=Ht;Ut=Kt}Jt.nextZ=null,mr*=2}while(le>1)}(ht)}(u,x,S,k);for(var F,j,Y=u;u.prev!==u.next;)if(F=u.prev,j=u.next,k?fe(u,x,S,k):ue(u))l.push(F.i/f|0),l.push(u.i/f|0),l.push(j.i/f|0),Zb(u),u=j.next,Y=j.next;else if((u=j)===Y){D?D===1?me(u=ne(ge(u),l,f),l,f,x,S,k,2):D===2&&tr(u,l,f,x,S,k):me(ge(u),l,f,x,S,k,1);break}}}function ue(u){var l=u.prev,f=u,x=u.next;if(Ar(l,f,x)>=0)return!1;for(var S=l.x,k=f.x,D=x.x,F=l.y,j=f.y,Y=x.y,K=S<k?S<D?S:D:k<D?k:D,et=F<j?F<Y?F:Y:j<Y?j:Y,st=S>k?S>D?S:D:k>D?k:D,ct=F>j?F>Y?F:Y:j>Y?j:Y,ht=x.next;ht!==l;){if(ht.x>=K&&ht.x<=st&&ht.y>=et&&ht.y<=ct&&Zi(S,F,k,j,D,Y,ht.x,ht.y)&&Ar(ht.prev,ht,ht.next)>=0)return!1;ht=ht.next}return!0}function fe(u,l,f,x){var S=u.prev,k=u,D=u.next;if(Ar(S,k,D)>=0)return!1;for(var F=S.x,j=k.x,Y=D.x,K=S.y,et=k.y,st=D.y,ct=F<j?F<Y?F:Y:j<Y?j:Y,ht=K<et?K<st?K:st:et<st?et:st,Tt=F>j?F>Y?F:Y:j>Y?j:Y,Nt=K>et?K>st?K:st:et>st?et:st,Ut=xn(ct,ht,l,f,x),Kt=xn(Tt,Nt,l,f,x),Ht=u.prevZ,Jt=u.nextZ;Ht&&Ht.z>=Ut&&Jt&&Jt.z<=Kt;){if(Ht.x>=ct&&Ht.x<=Tt&&Ht.y>=ht&&Ht.y<=Nt&&Ht!==S&&Ht!==D&&Zi(F,K,j,et,Y,st,Ht.x,Ht.y)&&Ar(Ht.prev,Ht,Ht.next)>=0||(Ht=Ht.prevZ,Jt.x>=ct&&Jt.x<=Tt&&Jt.y>=ht&&Jt.y<=Nt&&Jt!==S&&Jt!==D&&Zi(F,K,j,et,Y,st,Jt.x,Jt.y)&&Ar(Jt.prev,Jt,Jt.next)>=0))return!1;Jt=Jt.nextZ}for(;Ht&&Ht.z>=Ut;){if(Ht.x>=ct&&Ht.x<=Tt&&Ht.y>=ht&&Ht.y<=Nt&&Ht!==S&&Ht!==D&&Zi(F,K,j,et,Y,st,Ht.x,Ht.y)&&Ar(Ht.prev,Ht,Ht.next)>=0)return!1;Ht=Ht.prevZ}for(;Jt&&Jt.z<=Kt;){if(Jt.x>=ct&&Jt.x<=Tt&&Jt.y>=ht&&Jt.y<=Nt&&Jt!==S&&Jt!==D&&Zi(F,K,j,et,Y,st,Jt.x,Jt.y)&&Ar(Jt.prev,Jt,Jt.next)>=0)return!1;Jt=Jt.nextZ}return!0}function ne(u,l,f){var x=u;do{var S=x.prev,k=x.next.next;!gi(S,k)&&kn(S,x,x.next,k)&&To(S,k)&&To(k,S)&&(l.push(S.i/f|0),l.push(x.i/f|0),l.push(k.i/f|0),Zb(x),Zb(x.next),x=u=k),x=x.next}while(x!==u);return ge(x)}function tr(u,l,f,x,S,k){var D=u;do{for(var F=D.next.next;F!==D.prev;){if(D.i!==F.i&&Pi(D,F)){var j=Xb(D,F);return D=ge(D,D.next),j=ge(j,j.next),me(D,l,f,x,S,k,0),void me(j,l,f,x,S,k,0)}F=F.next}D=D.next}while(D!==u)}function pr(u,l){return u.x-l.x}function Xe(u,l){var f=function(S,k){var D,F=k,j=S.x,Y=S.y,K=-1/0;do{if(Y<=F.y&&Y>=F.next.y&&F.next.y!==F.y){var et=F.x+(Y-F.y)*(F.next.x-F.x)/(F.next.y-F.y);if(et<=j&&et>K&&(K=et,D=F.x<F.next.x?F:F.next,et===j))return D}F=F.next}while(F!==k);if(!D)return null;var st,ct=D,ht=D.x,Tt=D.y,Nt=1/0;F=D;do j>=F.x&&F.x>=ht&&j!==F.x&&Zi(Y<Tt?j:K,Y,ht,Tt,Y<Tt?K:j,Y,F.x,F.y)&&(st=Math.abs(Y-F.y)/(j-F.x),To(F,S)&&(st<Nt||st===Nt&&(F.x>D.x||F.x===D.x&&er(D,F)))&&(D=F,Nt=st)),F=F.next;while(F!==ct);return D}(u,l);if(!f)return l;var x=Xb(f,u);return ge(x,x.next),ge(f,f.next)}function er(u,l){return Ar(u.prev,u,l.prev)<0&&Ar(l.next,u,u.next)<0}function xn(u,l,f,x,S){return(u=1431655765&((u=858993459&((u=252645135&((u=16711935&((u=(u-f)*S|0)|u<<8))|u<<4))|u<<2))|u<<1))|(l=1431655765&((l=858993459&((l=252645135&((l=16711935&((l=(l-x)*S|0)|l<<8))|l<<4))|l<<2))|l<<1))<<1}function hn(u){var l=u,f=u;do(l.x<f.x||l.x===f.x&&l.y<f.y)&&(f=l),l=l.next;while(l!==u);return f}function Zi(u,l,f,x,S,k,D,F){return(S-D)*(l-F)>=(u-D)*(k-F)&&(u-D)*(x-F)>=(f-D)*(l-F)&&(f-D)*(k-F)>=(S-D)*(x-F)}function Pi(u,l){return u.next.i!==l.i&&u.prev.i!==l.i&&!function(f,x){var S=f;do{if(S.i!==f.i&&S.next.i!==f.i&&S.i!==x.i&&S.next.i!==x.i&&kn(S,S.next,f,x))return!0;S=S.next}while(S!==f);return!1}(u,l)&&(To(u,l)&&To(l,u)&&function(f,x){var S=f,k=!1,D=(f.x+x.x)/2,F=(f.y+x.y)/2;do S.y>F!=S.next.y>F&&S.next.y!==S.y&&D<(S.next.x-S.x)*(F-S.y)/(S.next.y-S.y)+S.x&&(k=!k),S=S.next;while(S!==f);return k}(u,l)&&(Ar(u.prev,u,l.prev)||Ar(u,l.prev,l))||gi(u,l)&&Ar(u.prev,u,u.next)>0&&Ar(l.prev,l,l.next)>0)}function Ar(u,l,f){return(l.y-u.y)*(f.x-l.x)-(l.x-u.x)*(f.y-l.y)}function gi(u,l){return u.x===l.x&&u.y===l.y}function kn(u,l,f,x){var S=Dn(Ar(u,l,f)),k=Dn(Ar(u,l,x)),D=Dn(Ar(f,x,u)),F=Dn(Ar(f,x,l));return S!==k&&D!==F||!(S!==0||!ti(u,f,l))||!(k!==0||!ti(u,x,l))||!(D!==0||!ti(f,u,x))||!(F!==0||!ti(f,l,x))}function ti(u,l,f){return l.x<=Math.max(u.x,f.x)&&l.x>=Math.min(u.x,f.x)&&l.y<=Math.max(u.y,f.y)&&l.y>=Math.min(u.y,f.y)}function Dn(u){return u>0?1:u<0?-1:0}function To(u,l){return Ar(u.prev,u,u.next)<0?Ar(u,l,u.next)>=0&&Ar(u,u.prev,l)>=0:Ar(u,l,u.prev)<0||Ar(u,u.next,l)<0}function Xb(u,l){var f=new ZP(u.i,u.x,u.y),x=new ZP(l.i,l.x,l.y),S=u.next,k=l.prev;return u.next=l,l.prev=u,f.next=S,S.prev=f,x.next=f,f.prev=x,k.next=x,x.prev=k,x}function Qz(u,l,f,x){var S=new ZP(u,l,f);return x?(S.next=x.next,S.prev=x,x.next.prev=S,x.next=S):(S.prev=S,S.next=S),S}function Zb(u){u.next.prev=u.prev,u.prev.next=u.next,u.prevZ&&(u.prevZ.nextZ=u.nextZ),u.nextZ&&(u.nextZ.prevZ=u.prevZ)}function ZP(u,l,f){this.i=u,this.x=l,this.y=f,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function GP(u,l,f,x){for(var S=0,k=l,D=f-x;k<f;k+=x)S+=(u[D]-u[k])*(u[k+1]+u[D+1]),D=k;return S}Xt.exports=zt,Xt.exports.default=zt,zt.deviation=function(u,l,f,x){var S=l&&l.length,k=Math.abs(GP(u,0,S?l[0]*f:u.length,f));if(S)for(var D=0,F=l.length;D<F;D++)k-=Math.abs(GP(u,l[D]*f,D<F-1?l[D+1]*f:u.length,f));var j=0;for(D=0;D<x.length;D+=3){var Y=x[D]*f,K=x[D+1]*f,et=x[D+2]*f;j+=Math.abs((u[Y]-u[et])*(u[K+1]-u[Y+1])-(u[Y]-u[K])*(u[et+1]-u[Y+1]))}return k===0&&j===0?0:Math.abs((j-k)/k)},zt.flatten=function(u){for(var l=u[0][0].length,f={vertices:[],holes:[],dimensions:l},x=0,S=0;S<u.length;S++){for(var k=0;k<u[S].length;k++)for(var D=0;D<l;D++)f.vertices.push(u[S][k][D]);S>0&&f.holes.push(x+=u[S-1].length)}return f};var Kz=a(Xt.exports);function Cht(u,l,f,x,S){Jz(u,l,f||0,x||u.length-1,S||Pht)}function Jz(u,l,f,x,S){for(;x>f;){if(x-f>600){var k=x-f+1,D=l-f+1,F=Math.log(k),j=.5*Math.exp(2*F/3),Y=.5*Math.sqrt(F*j*(k-j)/k)*(D-k/2<0?-1:1);Jz(u,l,Math.max(f,Math.floor(l-D*j/k+Y)),Math.min(x,Math.floor(l+(k-D)*j/k+Y)),S)}var K=u[l],et=f,st=x;for(Gb(u,f,l),S(u[x],K)>0&&Gb(u,f,x);et<st;){for(Gb(u,et,st),et++,st--;S(u[et],K)<0;)et++;for(;S(u[st],K)>0;)st--}S(u[f],K)===0?Gb(u,f,st):Gb(u,++st,x),st<=l&&(f=st+1),l<=st&&(x=st-1)}}function Gb(u,l,f){var x=u[l];u[l]=u[f],u[f]=x}function Pht(u,l){return u<l?-1:u>l?1:0}function QP(u,l){let f=u.length;if(f<=1)return[u];let x=[],S,k;for(let D=0;D<f;D++){let F=xt(u[D]);F!==0&&(u[D].area=Math.abs(F),k===void 0&&(k=F<0),k===F<0?(S&&x.push(S),S=[u[D]]):S.push(u[D]))}if(S&&x.push(S),l>1)for(let D=0;D<x.length;D++)x[D].length<=l||(Cht(x[D],l,1,x[D].length-1,Rht),x[D]=x[D].slice(0,l));return x}function Rht(u,l){return l.area-u.area}function KP(u,l,f){let x=f.patternDependencies,S=!1;for(let k of l){let D=k.paint.get(`${u}-pattern`);D.isConstant()||(S=!0);let F=D.constantOr(null);F&&(S=!0,x[F.to]=!0,x[F.from]=!0)}return S}function JP(u,l,f,x,S){let k=S.patternDependencies;for(let D of l){let F=D.paint.get(`${u}-pattern`).value;if(F.kind!=="constant"){let j=F.evaluate({zoom:x-1},f,{},S.availableImages),Y=F.evaluate({zoom:x},f,{},S.availableImages),K=F.evaluate({zoom:x+1},f,{},S.availableImages);j=j&&j.name?j.name:j,Y=Y&&Y.name?Y.name:Y,K=K&&K.name?K.name:K,k[j]=!0,k[Y]=!0,k[K]=!0,f.patterns[D.id]={min:j,mid:Y,max:K}}}return f}class tR{constructor(l){this.zoom=l.zoom,this.overscaling=l.overscaling,this.layers=l.layers,this.layerIds=this.layers.map(f=>f.id),this.index=l.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Di,this.indexArray=new vo,this.indexArray2=new Gs,this.programConfigurations=new iu(l.layers,l.zoom),this.segments=new Vn,this.segments2=new Vn,this.stateDependentLayerIds=this.layers.filter(f=>f.isStateDependent()).map(f=>f.id)}populate(l,f,x){this.hasPattern=KP("fill",this.layers,f);let S=this.layers[0].layout.get("fill-sort-key"),k=!S.isConstant(),D=[];for(let{feature:F,id:j,index:Y,sourceLayerIndex:K}of l){let et=this.layers[0]._featureFilter.needGeometry,st=Hf(F,et);if(!this.layers[0]._featureFilter.filter(new Yn(this.zoom),st,x))continue;let ct=k?S.evaluate(st,{},x,f.availableImages):void 0,ht={id:j,properties:F.properties,type:F.type,sourceLayerIndex:K,index:Y,geometry:et?st.geometry:$f(F),patterns:{},sortKey:ct};D.push(ht)}k&&D.sort((F,j)=>F.sortKey-j.sortKey);for(let F of D){let{geometry:j,index:Y,sourceLayerIndex:K}=F;if(this.hasPattern){let et=JP("fill",this.layers,F,this.zoom,f);this.patternFeatures.push(et)}else this.addFeature(F,j,Y,x,{});f.featureIndex.insert(l[Y].feature,j,Y,K,this.index)}}update(l,f,x){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(l,f,this.stateDependentLayers,x)}addFeatures(l,f,x){for(let S of this.patternFeatures)this.addFeature(S,S.geometry,S.index,f,x)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(l){this.uploaded||(this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,jt),this.indexBuffer=l.createIndexBuffer(this.indexArray),this.indexBuffer2=l.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(l),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(l,f,x,S,k){for(let D of QP(f,500)){let F=0;for(let ct of D)F+=ct.length;let j=this.segments.prepareSegment(F,this.layoutVertexArray,this.indexArray),Y=j.vertexLength,K=[],et=[];for(let ct of D){if(ct.length===0)continue;ct!==D[0]&&et.push(K.length/2);let ht=this.segments2.prepareSegment(ct.length,this.layoutVertexArray,this.indexArray2),Tt=ht.vertexLength;this.layoutVertexArray.emplaceBack(ct[0].x,ct[0].y),this.indexArray2.emplaceBack(Tt+ct.length-1,Tt),K.push(ct[0].x),K.push(ct[0].y);for(let Nt=1;Nt<ct.length;Nt++)this.layoutVertexArray.emplaceBack(ct[Nt].x,ct[Nt].y),this.indexArray2.emplaceBack(Tt+Nt-1,Tt+Nt),K.push(ct[Nt].x),K.push(ct[Nt].y);ht.vertexLength+=ct.length,ht.primitiveLength+=ct.length}let st=Kz(K,et);for(let ct=0;ct<st.length;ct+=3)this.indexArray.emplaceBack(Y+st[ct],Y+st[ct+1],Y+st[ct+2]);j.vertexLength+=F,j.primitiveLength+=st.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,l,x,k,S)}}let tU,eU;Ve("FillBucket",tR,{omit:["layers","patternFeatures"]});var kht={get paint(){return eU=eU||new Ds({"fill-antialias":new ur(ae.paint_fill["fill-antialias"]),"fill-opacity":new Dr(ae.paint_fill["fill-opacity"]),"fill-color":new Dr(ae.paint_fill["fill-color"]),"fill-outline-color":new Dr(ae.paint_fill["fill-outline-color"]),"fill-translate":new ur(ae.paint_fill["fill-translate"]),"fill-translate-anchor":new ur(ae.paint_fill["fill-translate-anchor"]),"fill-pattern":new Lh(ae.paint_fill["fill-pattern"])})},get layout(){return tU=tU||new Ds({"fill-sort-key":new Dr(ae.layout_fill["fill-sort-key"])})}};class Dht extends Da{constructor(l){super(l,kht)}recalculate(l,f){super.recalculate(l,f);let x=this.paint._values["fill-outline-color"];x.value.kind==="constant"&&x.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(l){return new tR(l)}queryRadius(){return dm(this.paint.get("fill-translate"))}queryIntersectsFeature(l,f,x,S,k,D,F){return C4(Uu(l,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),D.angle,F),S)}isTileClipped(){return!0}}let Oht=Xn([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Bht=Xn([{name:"a_centroid",components:2,type:"Int16"}],4),{members:Nht}=Oht;var Am={},Lht=h,rU=_y;function _y(u,l,f,x,S){this.properties={},this.extent=f,this.type=0,this._pbf=u,this._geometry=-1,this._keys=x,this._values=S,u.readFields(Fht,this,l)}function Fht(u,l,f){u==1?l.id=f.readVarint():u==2?function(x,S){for(var k=x.readVarint()+x.pos;x.pos<k;){var D=S._keys[x.readVarint()],F=S._values[x.readVarint()];S.properties[D]=F}}(f,l):u==3?l.type=f.readVarint():u==4&&(l._geometry=f.pos)}function zht(u){for(var l,f,x=0,S=0,k=u.length,D=k-1;S<k;D=S++)x+=((f=u[D]).x-(l=u[S]).x)*(l.y+f.y);return x}_y.types=["Unknown","Point","LineString","Polygon"],_y.prototype.loadGeometry=function(){var u=this._pbf;u.pos=this._geometry;for(var l,f=u.readVarint()+u.pos,x=1,S=0,k=0,D=0,F=[];u.pos<f;){if(S<=0){var j=u.readVarint();x=7&j,S=j>>3}if(S--,x===1||x===2)k+=u.readSVarint(),D+=u.readSVarint(),x===1&&(l&&F.push(l),l=[]),l.push(new Lht(k,D));else{if(x!==7)throw new Error("unknown command "+x);l&&l.push(l[0].clone())}}return l&&F.push(l),F},_y.prototype.bbox=function(){var u=this._pbf;u.pos=this._geometry;for(var l=u.readVarint()+u.pos,f=1,x=0,S=0,k=0,D=1/0,F=-1/0,j=1/0,Y=-1/0;u.pos<l;){if(x<=0){var K=u.readVarint();f=7&K,x=K>>3}if(x--,f===1||f===2)(S+=u.readSVarint())<D&&(D=S),S>F&&(F=S),(k+=u.readSVarint())<j&&(j=k),k>Y&&(Y=k);else if(f!==7)throw new Error("unknown command "+f)}return[D,j,F,Y]},_y.prototype.toGeoJSON=function(u,l,f){var x,S,k=this.extent*Math.pow(2,f),D=this.extent*u,F=this.extent*l,j=this.loadGeometry(),Y=_y.types[this.type];function K(ct){for(var ht=0;ht<ct.length;ht++){var Tt=ct[ht];ct[ht]=[360*(Tt.x+D)/k-180,360/Math.PI*Math.atan(Math.exp((180-360*(Tt.y+F)/k)*Math.PI/180))-90]}}switch(this.type){case 1:var et=[];for(x=0;x<j.length;x++)et[x]=j[x][0];K(j=et);break;case 2:for(x=0;x<j.length;x++)K(j[x]);break;case 3:for(j=function(ct){var ht=ct.length;if(ht<=1)return[ct];for(var Tt,Nt,Ut=[],Kt=0;Kt<ht;Kt++){var Ht=zht(ct[Kt]);Ht!==0&&(Nt===void 0&&(Nt=Ht<0),Nt===Ht<0?(Tt&&Ut.push(Tt),Tt=[ct[Kt]]):Tt.push(ct[Kt]))}return Tt&&Ut.push(Tt),Ut}(j),x=0;x<j.length;x++)for(S=0;S<j[x].length;S++)K(j[x][S])}j.length===1?j=j[0]:Y="Multi"+Y;var st={type:"Feature",geometry:{type:Y,coordinates:j},properties:this.properties};return"id"in this&&(st.id=this.id),st};var Uht=rU,iU=nU;function nU(u,l){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=u,this._keys=[],this._values=[],this._features=[],u.readFields(Vht,this,l),this.length=this._features.length}function Vht(u,l,f){u===15?l.version=f.readVarint():u===1?l.name=f.readString():u===5?l.extent=f.readVarint():u===2?l._features.push(f.pos):u===3?l._keys.push(f.readString()):u===4&&l._values.push(function(x){for(var S=null,k=x.readVarint()+x.pos;x.pos<k;){var D=x.readVarint()>>3;S=D===1?x.readString():D===2?x.readFloat():D===3?x.readDouble():D===4?x.readVarint64():D===5?x.readVarint():D===6?x.readSVarint():D===7?x.readBoolean():null}return S}(f))}nU.prototype.feature=function(u){if(u<0||u>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[u];var l=this._pbf.readVarint()+this._pbf.pos;return new Uht(this._pbf,l,this.extent,this._keys,this._values)};var jht=iU;function Wht(u,l,f){if(u===3){var x=new jht(f,f.readVarint()+f.pos);x.length&&(l[x.name]=x)}}Am.VectorTile=function(u,l){this.layers=u.readFields(Wht,{},l)},Am.VectorTileFeature=rU,Am.VectorTileLayer=iU;let $ht=Am.VectorTileFeature.types,eR=Math.pow(2,13);function Qb(u,l,f,x,S,k,D,F){u.emplaceBack(l,f,2*Math.floor(x*eR)+D,S*eR*2,k*eR*2,Math.round(F))}class rR{constructor(l){this.zoom=l.zoom,this.overscaling=l.overscaling,this.layers=l.layers,this.layerIds=this.layers.map(f=>f.id),this.index=l.index,this.hasPattern=!1,this.layoutVertexArray=new He,this.centroidVertexArray=new Le,this.indexArray=new vo,this.programConfigurations=new iu(l.layers,l.zoom),this.segments=new Vn,this.stateDependentLayerIds=this.layers.filter(f=>f.isStateDependent()).map(f=>f.id)}populate(l,f,x){this.features=[],this.hasPattern=KP("fill-extrusion",this.layers,f);for(let{feature:S,id:k,index:D,sourceLayerIndex:F}of l){let j=this.layers[0]._featureFilter.needGeometry,Y=Hf(S,j);if(!this.layers[0]._featureFilter.filter(new Yn(this.zoom),Y,x))continue;let K={id:k,sourceLayerIndex:F,index:D,geometry:j?Y.geometry:$f(S),properties:S.properties,type:S.type,patterns:{}};this.hasPattern?this.features.push(JP("fill-extrusion",this.layers,K,this.zoom,f)):this.addFeature(K,K.geometry,D,x,{}),f.featureIndex.insert(S,K.geometry,D,F,this.index,!0)}}addFeatures(l,f,x){for(let S of this.features){let{geometry:k}=S;this.addFeature(S,k,S.index,f,x)}}update(l,f,x){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(l,f,this.stateDependentLayers,x)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(l){this.uploaded||(this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,Nht),this.centroidVertexBuffer=l.createVertexBuffer(this.centroidVertexArray,Bht.members,!0),this.indexBuffer=l.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(l),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(l,f,x,S,k){let D={x:0,y:0,vertexCount:0};for(let F of QP(f,500)){let j=0;for(let ht of F)j+=ht.length;let Y=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(let ht of F){if(ht.length===0||qht(ht))continue;let Tt=0;for(let Nt=0;Nt<ht.length;Nt++){let Ut=ht[Nt];if(Nt>=1){let Kt=ht[Nt-1];if(!Hht(Ut,Kt)){Y.vertexLength+4>Vn.MAX_VERTEX_ARRAY_LENGTH&&(Y=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));let Ht=Ut.sub(Kt)._perp()._unit(),Jt=Kt.dist(Ut);Tt+Jt>32768&&(Tt=0),Qb(this.layoutVertexArray,Ut.x,Ut.y,Ht.x,Ht.y,0,0,Tt),Qb(this.layoutVertexArray,Ut.x,Ut.y,Ht.x,Ht.y,0,1,Tt),D.x+=2*Ut.x,D.y+=2*Ut.y,D.vertexCount+=2,Tt+=Jt,Qb(this.layoutVertexArray,Kt.x,Kt.y,Ht.x,Ht.y,0,0,Tt),Qb(this.layoutVertexArray,Kt.x,Kt.y,Ht.x,Ht.y,0,1,Tt),D.x+=2*Kt.x,D.y+=2*Kt.y,D.vertexCount+=2;let le=Y.vertexLength;this.indexArray.emplaceBack(le,le+2,le+1),this.indexArray.emplaceBack(le+1,le+2,le+3),Y.vertexLength+=4,Y.primitiveLength+=2}}}}if(Y.vertexLength+j>Vn.MAX_VERTEX_ARRAY_LENGTH&&(Y=this.segments.prepareSegment(j,this.layoutVertexArray,this.indexArray)),$ht[l.type]!=="Polygon")continue;let K=[],et=[],st=Y.vertexLength;for(let ht of F)if(ht.length!==0){ht!==F[0]&&et.push(K.length/2);for(let Tt=0;Tt<ht.length;Tt++){let Nt=ht[Tt];Qb(this.layoutVertexArray,Nt.x,Nt.y,0,0,1,1,0),D.x+=Nt.x,D.y+=Nt.y,D.vertexCount+=1,K.push(Nt.x),K.push(Nt.y)}}let ct=Kz(K,et);for(let ht=0;ht<ct.length;ht+=3)this.indexArray.emplaceBack(st+ct[ht],st+ct[ht+2],st+ct[ht+1]);Y.primitiveLength+=ct.length/3,Y.vertexLength+=j}for(let F=0;F<D.vertexCount;F++)this.centroidVertexArray.emplaceBack(Math.floor(D.x/D.vertexCount),Math.floor(D.y/D.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,l,x,k,S)}}function Hht(u,l){return u.x===l.x&&(u.x<0||u.x>Vs)||u.y===l.y&&(u.y<0||u.y>Vs)}function qht(u){return u.every(l=>l.x<0)||u.every(l=>l.x>Vs)||u.every(l=>l.y<0)||u.every(l=>l.y>Vs)}let sU;Ve("FillExtrusionBucket",rR,{omit:["layers","features"]});var Yht={get paint(){return sU=sU||new Ds({"fill-extrusion-opacity":new ur(ae["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Dr(ae["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new ur(ae["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new ur(ae["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Lh(ae["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Dr(ae["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Dr(ae["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new ur(ae["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class Xht extends Da{constructor(l){super(l,Yht)}createBucket(l){return new rR(l)}queryRadius(){return dm(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(l,f,x,S,k,D,F,j){let Y=Uu(l,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),D.angle,F),K=this.paint.get("fill-extrusion-height").evaluate(f,x),et=this.paint.get("fill-extrusion-base").evaluate(f,x),st=function(ht,Tt,Nt,Ut){let Kt=[];for(let Ht of ht){let Jt=[Ht.x,Ht.y,0,1];Td(Jt,Jt,Tt),Kt.push(new g(Jt[0]/Jt[3],Jt[1]/Jt[3]))}return Kt}(Y,j),ct=function(ht,Tt,Nt,Ut){let Kt=[],Ht=[],Jt=Ut[8]*Tt,le=Ut[9]*Tt,ve=Ut[10]*Tt,Ke=Ut[11]*Tt,mr=Ut[8]*Nt,Qe=Ut[9]*Nt,Ye=Ut[10]*Nt,je=Ut[11]*Nt;for(let or of ht){let $e=[],Re=[];for(let Pr of or){let gr=Pr.x,Bi=Pr.y,os=Ut[0]*gr+Ut[4]*Bi+Ut[12],ds=Ut[1]*gr+Ut[5]*Bi+Ut[13],Eo=Ut[2]*gr+Ut[6]*Bi+Ut[14],Ac=Ut[3]*gr+Ut[7]*Bi+Ut[15],cl=Eo+ve,uo=Ac+Ke,ta=os+mr,ga=ds+Qe,ul=Eo+Ye,hl=Ac+je,Io=new g((os+Jt)/uo,(ds+le)/uo);Io.z=cl/uo,$e.push(Io);let Mo=new g(ta/hl,ga/hl);Mo.z=ul/hl,Re.push(Mo)}Kt.push($e),Ht.push(Re)}return[Kt,Ht]}(S,et,K,j);return function(ht,Tt,Nt){let Ut=1/0;C4(Nt,Tt)&&(Ut=oU(Nt,Tt[0]));for(let Kt=0;Kt<Tt.length;Kt++){let Ht=Tt[Kt],Jt=ht[Kt];for(let le=0;le<Ht.length-1;le++){let ve=Ht[le],Ke=[ve,Ht[le+1],Jt[le+1],Jt[le],ve];M4(Nt,Ke)&&(Ut=Math.min(Ut,oU(Nt,Ke)))}}return Ut!==1/0&&Ut}(ct[0],ct[1],st)}}function Kb(u,l){return u.x*l.x+u.y*l.y}function oU(u,l){if(u.length===1){let f=0,x=l[f++],S;for(;!S||x.equals(S);)if(S=l[f++],!S)return 1/0;for(;f<l.length;f++){let k=l[f],D=u[0],F=S.sub(x),j=k.sub(x),Y=D.sub(x),K=Kb(F,F),et=Kb(F,j),st=Kb(j,j),ct=Kb(Y,F),ht=Kb(Y,j),Tt=K*st-et*et,Nt=(st*ct-et*ht)/Tt,Ut=(K*ht-et*ct)/Tt,Kt=x.z*(1-Nt-Ut)+S.z*Nt+k.z*Ut;if(isFinite(Kt))return Kt}return 1/0}{let f=1/0;for(let x of l)f=Math.min(f,x.z);return f}}let Zht=Xn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Ght}=Zht,Qht=Xn([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Kht}=Qht,Jht=Am.VectorTileFeature.types,tft=Math.cos(Math.PI/180*37.5),aU=Math.pow(2,14)/.5;class iR{constructor(l){this.zoom=l.zoom,this.overscaling=l.overscaling,this.layers=l.layers,this.layerIds=this.layers.map(f=>f.id),this.index=l.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(f=>{this.gradients[f.id]={}}),this.layoutVertexArray=new Cr,this.layoutVertexArray2=new fr,this.indexArray=new vo,this.programConfigurations=new iu(l.layers,l.zoom),this.segments=new Vn,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(f=>f.isStateDependent()).map(f=>f.id)}populate(l,f,x){this.hasPattern=KP("line",this.layers,f);let S=this.layers[0].layout.get("line-sort-key"),k=!S.isConstant(),D=[];for(let{feature:F,id:j,index:Y,sourceLayerIndex:K}of l){let et=this.layers[0]._featureFilter.needGeometry,st=Hf(F,et);if(!this.layers[0]._featureFilter.filter(new Yn(this.zoom),st,x))continue;let ct=k?S.evaluate(st,{},x):void 0,ht={id:j,properties:F.properties,type:F.type,sourceLayerIndex:K,index:Y,geometry:et?st.geometry:$f(F),patterns:{},sortKey:ct};D.push(ht)}k&&D.sort((F,j)=>F.sortKey-j.sortKey);for(let F of D){let{geometry:j,index:Y,sourceLayerIndex:K}=F;if(this.hasPattern){let et=JP("line",this.layers,F,this.zoom,f);this.patternFeatures.push(et)}else this.addFeature(F,j,Y,x,{});f.featureIndex.insert(l[Y].feature,j,Y,K,this.index)}}update(l,f,x){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(l,f,this.stateDependentLayers,x)}addFeatures(l,f,x){for(let S of this.patternFeatures)this.addFeature(S,S.geometry,S.index,f,x)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(l){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=l.createVertexBuffer(this.layoutVertexArray2,Kht)),this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,Ght),this.indexBuffer=l.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(l),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(l){if(l.properties&&Object.prototype.hasOwnProperty.call(l.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(l.properties,"mapbox_clip_end"))return{start:+l.properties.mapbox_clip_start,end:+l.properties.mapbox_clip_end}}addFeature(l,f,x,S,k){let D=this.layers[0].layout,F=D.get("line-join").evaluate(l,{}),j=D.get("line-cap"),Y=D.get("line-miter-limit"),K=D.get("line-round-limit");this.lineClips=this.lineFeatureClips(l);for(let et of f)this.addLine(et,l,F,j,Y,K);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,l,x,k,S)}addLine(l,f,x,S,k,D){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Ut=0;Ut<l.length-1;Ut++)this.totalDistance+=l[Ut].dist(l[Ut+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}let F=Jht[f.type]==="Polygon",j=l.length;for(;j>=2&&l[j-1].equals(l[j-2]);)j--;let Y=0;for(;Y<j-1&&l[Y].equals(l[Y+1]);)Y++;if(j<(F?3:2))return;x==="bevel"&&(k=1.05);let K=this.overscaling<=16?15*Vs/(512*this.overscaling):0,et=this.segments.prepareSegment(10*j,this.layoutVertexArray,this.indexArray),st,ct,ht,Tt,Nt;this.e1=this.e2=-1,F&&(st=l[j-2],Nt=l[Y].sub(st)._unit()._perp());for(let Ut=Y;Ut<j;Ut++){if(ht=Ut===j-1?F?l[Y+1]:void 0:l[Ut+1],ht&&l[Ut].equals(ht))continue;Nt&&(Tt=Nt),st&&(ct=st),st=l[Ut],Nt=ht?ht.sub(st)._unit()._perp():Tt,Tt=Tt||Nt;let Kt=Tt.add(Nt);Kt.x===0&&Kt.y===0||Kt._unit();let Ht=Tt.x*Nt.x+Tt.y*Nt.y,Jt=Kt.x*Nt.x+Kt.y*Nt.y,le=Jt!==0?1/Jt:1/0,ve=2*Math.sqrt(2-2*Jt),Ke=Jt<tft&&ct&&ht,mr=Tt.x*Nt.y-Tt.y*Nt.x>0;if(Ke&&Ut>Y){let je=st.dist(ct);if(je>2*K){let or=st.sub(st.sub(ct)._mult(K/je)._round());this.updateDistance(ct,or),this.addCurrentVertex(or,Tt,0,0,et),ct=or}}let Qe=ct&&ht,Ye=Qe?x:F?"butt":S;if(Qe&&Ye==="round"&&(le<D?Ye="miter":le<=2&&(Ye="fakeround")),Ye==="miter"&&le>k&&(Ye="bevel"),Ye==="bevel"&&(le>2&&(Ye="flipbevel"),le<k&&(Ye="miter")),ct&&this.updateDistance(ct,st),Ye==="miter")Kt._mult(le),this.addCurrentVertex(st,Kt,0,0,et);else if(Ye==="flipbevel"){if(le>100)Kt=Nt.mult(-1);else{let je=le*Tt.add(Nt).mag()/Tt.sub(Nt).mag();Kt._perp()._mult(je*(mr?-1:1))}this.addCurrentVertex(st,Kt,0,0,et),this.addCurrentVertex(st,Kt.mult(-1),0,0,et)}else if(Ye==="bevel"||Ye==="fakeround"){let je=-Math.sqrt(le*le-1),or=mr?je:0,$e=mr?0:je;if(ct&&this.addCurrentVertex(st,Tt,or,$e,et),Ye==="fakeround"){let Re=Math.round(180*ve/Math.PI/20);for(let Pr=1;Pr<Re;Pr++){let gr=Pr/Re;if(gr!==.5){let os=gr-.5;gr+=gr*os*(gr-1)*((1.0904+Ht*(Ht*(3.55645-1.43519*Ht)-3.2452))*os*os+(.848013+Ht*(.215638*Ht-1.06021)))}let Bi=Nt.sub(Tt)._mult(gr)._add(Tt)._unit()._mult(mr?-1:1);this.addHalfVertex(st,Bi.x,Bi.y,!1,mr,0,et)}}ht&&this.addCurrentVertex(st,Nt,-or,-$e,et)}else if(Ye==="butt")this.addCurrentVertex(st,Kt,0,0,et);else if(Ye==="square"){let je=ct?1:-1;this.addCurrentVertex(st,Kt,je,je,et)}else Ye==="round"&&(ct&&(this.addCurrentVertex(st,Tt,0,0,et),this.addCurrentVertex(st,Tt,1,1,et,!0)),ht&&(this.addCurrentVertex(st,Nt,-1,-1,et,!0),this.addCurrentVertex(st,Nt,0,0,et)));if(Ke&&Ut<j-1){let je=st.dist(ht);if(je>2*K){let or=st.add(ht.sub(st)._mult(K/je)._round());this.updateDistance(st,or),this.addCurrentVertex(or,Nt,0,0,et),st=or}}}}addCurrentVertex(l,f,x,S,k,D=!1){let F=f.y*S-f.x,j=-f.y-f.x*S;this.addHalfVertex(l,f.x+f.y*x,f.y-f.x*x,D,!1,x,k),this.addHalfVertex(l,F,j,D,!0,-S,k),this.distance>aU/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(l,f,x,S,k,D))}addHalfVertex({x:l,y:f},x,S,k,D,F,j){let Y=.5*(this.lineClips?this.scaledDistance*(aU-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((l<<1)+(k?1:0),(f<<1)+(D?1:0),Math.round(63*x)+128,Math.round(63*S)+128,1+(F===0?0:F<0?-1:1)|(63&Y)<<2,Y>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);let K=j.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,K),j.primitiveLength++),D?this.e2=K:this.e1=K}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(l,f){this.distance+=l.dist(f),this.updateScaledDistance()}}let lU,cU;Ve("LineBucket",iR,{omit:["layers","patternFeatures"]});var uU={get paint(){return cU=cU||new Ds({"line-opacity":new Dr(ae.paint_line["line-opacity"]),"line-color":new Dr(ae.paint_line["line-color"]),"line-translate":new ur(ae.paint_line["line-translate"]),"line-translate-anchor":new ur(ae.paint_line["line-translate-anchor"]),"line-width":new Dr(ae.paint_line["line-width"]),"line-gap-width":new Dr(ae.paint_line["line-gap-width"]),"line-offset":new Dr(ae.paint_line["line-offset"]),"line-blur":new Dr(ae.paint_line["line-blur"]),"line-dasharray":new hm(ae.paint_line["line-dasharray"]),"line-pattern":new Lh(ae.paint_line["line-pattern"]),"line-gradient":new Nu(ae.paint_line["line-gradient"])})},get layout(){return lU=lU||new Ds({"line-cap":new ur(ae.layout_line["line-cap"]),"line-join":new Dr(ae.layout_line["line-join"]),"line-miter-limit":new ur(ae.layout_line["line-miter-limit"]),"line-round-limit":new ur(ae.layout_line["line-round-limit"]),"line-sort-key":new Dr(ae.layout_line["line-sort-key"])})}};class eft extends Dr{possiblyEvaluate(l,f){return f=new Yn(Math.floor(f.zoom),{now:f.now,fadeDuration:f.fadeDuration,zoomHistory:f.zoomHistory,transition:f.transition}),super.possiblyEvaluate(l,f)}evaluate(l,f,x,S){return f=nt({},f,{zoom:Math.floor(f.zoom)}),super.evaluate(l,f,x,S)}}let R4;class rft extends Da{constructor(l){super(l,uU),this.gradientVersion=0,R4||(R4=new eft(uU.paint.properties["line-width"].specification),R4.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(l){if(l==="line-gradient"){let f=this.gradientExpression();this.stepInterpolant=!!function(x){return x._styleExpression!==void 0}(f)&&f._styleExpression.expression instanceof Dh,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(l,f){super.recalculate(l,f),this.paint._values["line-floorwidth"]=R4.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,l)}createBucket(l){return new iR(l)}queryRadius(l){let f=l,x=hU(pm("line-width",this,f),pm("line-gap-width",this,f)),S=pm("line-offset",this,f);return x/2+Math.abs(S)+dm(this.paint.get("line-translate"))}queryIntersectsFeature(l,f,x,S,k,D,F){let j=Uu(l,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),D.angle,F),Y=F/2*hU(this.paint.get("line-width").evaluate(f,x),this.paint.get("line-gap-width").evaluate(f,x)),K=this.paint.get("line-offset").evaluate(f,x);return K&&(S=function(et,st){let ct=[];for(let ht=0;ht<et.length;ht++){let Tt=et[ht],Nt=[];for(let Ut=0;Ut<Tt.length;Ut++){let Kt=Tt[Ut-1],Ht=Tt[Ut],Jt=Tt[Ut+1],le=Ut===0?new g(0,0):Ht.sub(Kt)._unit()._perp(),ve=Ut===Tt.length-1?new g(0,0):Jt.sub(Ht)._unit()._perp(),Ke=le._add(ve)._unit(),mr=Ke.x*ve.x+Ke.y*ve.y;mr!==0&&Ke._mult(1/mr),Nt.push(Ke._mult(st)._add(Ht))}ct.push(Nt)}return ct}(S,K*F)),function(et,st,ct){for(let ht=0;ht<st.length;ht++){let Tt=st[ht];if(et.length>=3){for(let Nt=0;Nt<Tt.length;Nt++)if(Ii(et,Tt[Nt]))return!0}if(XP(et,Tt,ct))return!0}return!1}(j,S,Y)}isTileClipped(){return!0}}function hU(u,l){return l>0?l+2*u:u}let ift=Xn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),nft=Xn([{name:"a_projected_pos",components:3,type:"Float32"}],4);Xn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);let sft=Xn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);Xn([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);let fU=Xn([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),oft=Xn([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function aft(u,l,f){return u.sections.forEach(x=>{x.text=function(S,k,D){let F=k.layout.get("text-transform").evaluate(D,{});return F==="uppercase"?S=S.toLocaleUpperCase():F==="lowercase"&&(S=S.toLocaleLowerCase()),ka.applyArabicShaping&&(S=ka.applyArabicShaping(S)),S}(x.text,l,f)}),u}Xn([{name:"triangle",components:3,type:"Uint16"}]),Xn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Xn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),Xn([{type:"Float32",name:"offsetX"}]),Xn([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),Xn([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);let Jb={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"};var So=24,pU=jn,dU=function(u,l,f,x,S){var k,D,F=8*S-x-1,j=(1<<F)-1,Y=j>>1,K=-7,et=f?S-1:0,st=f?-1:1,ct=u[l+et];for(et+=st,k=ct&(1<<-K)-1,ct>>=-K,K+=F;K>0;k=256*k+u[l+et],et+=st,K-=8);for(D=k&(1<<-K)-1,k>>=-K,K+=x;K>0;D=256*D+u[l+et],et+=st,K-=8);if(k===0)k=1-Y;else{if(k===j)return D?NaN:1/0*(ct?-1:1);D+=Math.pow(2,x),k-=Y}return(ct?-1:1)*D*Math.pow(2,k-x)},mU=function(u,l,f,x,S,k){var D,F,j,Y=8*k-S-1,K=(1<<Y)-1,et=K>>1,st=S===23?Math.pow(2,-24)-Math.pow(2,-77):0,ct=x?0:k-1,ht=x?1:-1,Tt=l<0||l===0&&1/l<0?1:0;for(l=Math.abs(l),isNaN(l)||l===1/0?(F=isNaN(l)?1:0,D=K):(D=Math.floor(Math.log(l)/Math.LN2),l*(j=Math.pow(2,-D))<1&&(D--,j*=2),(l+=D+et>=1?st/j:st*Math.pow(2,1-et))*j>=2&&(D++,j/=2),D+et>=K?(F=0,D=K):D+et>=1?(F=(l*j-1)*Math.pow(2,S),D+=et):(F=l*Math.pow(2,et-1)*Math.pow(2,S),D=0));S>=8;u[f+ct]=255&F,ct+=ht,F/=256,S-=8);for(D=D<<S|F,Y+=S;Y>0;u[f+ct]=255&D,ct+=ht,D/=256,Y-=8);u[f+ct-ht]|=128*Tt};function jn(u){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(u)?u:new Uint8Array(u||0),this.pos=0,this.type=0,this.length=this.buf.length}jn.Varint=0,jn.Fixed64=1,jn.Bytes=2,jn.Fixed32=5;var nR=4294967296,AU=1/nR,gU=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Sd(u){return u.type===jn.Bytes?u.readVarint()+u.pos:u.pos+1}function yy(u,l,f){return f?4294967296*l+(u>>>0):4294967296*(l>>>0)+(u>>>0)}function _U(u,l,f){var x=l<=16383?1:l<=2097151?2:l<=268435455?3:Math.floor(Math.log(l)/(7*Math.LN2));f.realloc(x);for(var S=f.pos-1;S>=u;S--)f.buf[S+x]=f.buf[S]}function lft(u,l){for(var f=0;f<u.length;f++)l.writeVarint(u[f])}function cft(u,l){for(var f=0;f<u.length;f++)l.writeSVarint(u[f])}function uft(u,l){for(var f=0;f<u.length;f++)l.writeFloat(u[f])}function hft(u,l){for(var f=0;f<u.length;f++)l.writeDouble(u[f])}function fft(u,l){for(var f=0;f<u.length;f++)l.writeBoolean(u[f])}function pft(u,l){for(var f=0;f<u.length;f++)l.writeFixed32(u[f])}function dft(u,l){for(var f=0;f<u.length;f++)l.writeSFixed32(u[f])}function mft(u,l){for(var f=0;f<u.length;f++)l.writeFixed64(u[f])}function Aft(u,l){for(var f=0;f<u.length;f++)l.writeSFixed64(u[f])}function k4(u,l){return(u[l]|u[l+1]<<8|u[l+2]<<16)+16777216*u[l+3]}function xy(u,l,f){u[f]=l,u[f+1]=l>>>8,u[f+2]=l>>>16,u[f+3]=l>>>24}function yU(u,l){return(u[l]|u[l+1]<<8|u[l+2]<<16)+(u[l+3]<<24)}jn.prototype={destroy:function(){this.buf=null},readFields:function(u,l,f){for(f=f||this.length;this.pos<f;){var x=this.readVarint(),S=x>>3,k=this.pos;this.type=7&x,u(S,l,this),this.pos===k&&this.skip(x)}return l},readMessage:function(u,l){return this.readFields(u,l,this.readVarint()+this.pos)},readFixed32:function(){var u=k4(this.buf,this.pos);return this.pos+=4,u},readSFixed32:function(){var u=yU(this.buf,this.pos);return this.pos+=4,u},readFixed64:function(){var u=k4(this.buf,this.pos)+k4(this.buf,this.pos+4)*nR;return this.pos+=8,u},readSFixed64:function(){var u=k4(this.buf,this.pos)+yU(this.buf,this.pos+4)*nR;return this.pos+=8,u},readFloat:function(){var u=dU(this.buf,this.pos,!0,23,4);return this.pos+=4,u},readDouble:function(){var u=dU(this.buf,this.pos,!0,52,8);return this.pos+=8,u},readVarint:function(u){var l,f,x=this.buf;return l=127&(f=x[this.pos++]),f<128?l:(l|=(127&(f=x[this.pos++]))<<7,f<128?l:(l|=(127&(f=x[this.pos++]))<<14,f<128?l:(l|=(127&(f=x[this.pos++]))<<21,f<128?l:function(S,k,D){var F,j,Y=D.buf;if(F=(112&(j=Y[D.pos++]))>>4,j<128||(F|=(127&(j=Y[D.pos++]))<<3,j<128)||(F|=(127&(j=Y[D.pos++]))<<10,j<128)||(F|=(127&(j=Y[D.pos++]))<<17,j<128)||(F|=(127&(j=Y[D.pos++]))<<24,j<128)||(F|=(1&(j=Y[D.pos++]))<<31,j<128))return yy(S,F,k);throw new Error("Expected varint not more than 10 bytes")}(l|=(15&(f=x[this.pos]))<<28,u,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var u=this.readVarint();return u%2==1?(u+1)/-2:u/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var u=this.readVarint()+this.pos,l=this.pos;return this.pos=u,u-l>=12&&gU?function(f,x,S){return gU.decode(f.subarray(x,S))}(this.buf,l,u):function(f,x,S){for(var k="",D=x;D<S;){var F,j,Y,K=f[D],et=null,st=K>239?4:K>223?3:K>191?2:1;if(D+st>S)break;st===1?K<128&&(et=K):st===2?(192&(F=f[D+1]))==128&&(et=(31&K)<<6|63&F)<=127&&(et=null):st===3?(j=f[D+2],(192&(F=f[D+1]))==128&&(192&j)==128&&((et=(15&K)<<12|(63&F)<<6|63&j)<=2047||et>=55296&&et<=57343)&&(et=null)):st===4&&(j=f[D+2],Y=f[D+3],(192&(F=f[D+1]))==128&&(192&j)==128&&(192&Y)==128&&((et=(15&K)<<18|(63&F)<<12|(63&j)<<6|63&Y)<=65535||et>=1114112)&&(et=null)),et===null?(et=65533,st=1):et>65535&&(et-=65536,k+=String.fromCharCode(et>>>10&1023|55296),et=56320|1023&et),k+=String.fromCharCode(et),D+=st}return k}(this.buf,l,u)},readBytes:function(){var u=this.readVarint()+this.pos,l=this.buf.subarray(this.pos,u);return this.pos=u,l},readPackedVarint:function(u,l){if(this.type!==jn.Bytes)return u.push(this.readVarint(l));var f=Sd(this);for(u=u||[];this.pos<f;)u.push(this.readVarint(l));return u},readPackedSVarint:function(u){if(this.type!==jn.Bytes)return u.push(this.readSVarint());var l=Sd(this);for(u=u||[];this.pos<l;)u.push(this.readSVarint());return u},readPackedBoolean:function(u){if(this.type!==jn.Bytes)return u.push(this.readBoolean());var l=Sd(this);for(u=u||[];this.pos<l;)u.push(this.readBoolean());return u},readPackedFloat:function(u){if(this.type!==jn.Bytes)return u.push(this.readFloat());var l=Sd(this);for(u=u||[];this.pos<l;)u.push(this.readFloat());return u},readPackedDouble:function(u){if(this.type!==jn.Bytes)return u.push(this.readDouble());var l=Sd(this);for(u=u||[];this.pos<l;)u.push(this.readDouble());return u},readPackedFixed32:function(u){if(this.type!==jn.Bytes)return u.push(this.readFixed32());var l=Sd(this);for(u=u||[];this.pos<l;)u.push(this.readFixed32());return u},readPackedSFixed32:function(u){if(this.type!==jn.Bytes)return u.push(this.readSFixed32());var l=Sd(this);for(u=u||[];this.pos<l;)u.push(this.readSFixed32());return u},readPackedFixed64:function(u){if(this.type!==jn.Bytes)return u.push(this.readFixed64());var l=Sd(this);for(u=u||[];this.pos<l;)u.push(this.readFixed64());return u},readPackedSFixed64:function(u){if(this.type!==jn.Bytes)return u.push(this.readSFixed64());var l=Sd(this);for(u=u||[];this.pos<l;)u.push(this.readSFixed64());return u},skip:function(u){var l=7&u;if(l===jn.Varint)for(;this.buf[this.pos++]>127;);else if(l===jn.Bytes)this.pos=this.readVarint()+this.pos;else if(l===jn.Fixed32)this.pos+=4;else{if(l!==jn.Fixed64)throw new Error("Unimplemented type: "+l);this.pos+=8}},writeTag:function(u,l){this.writeVarint(u<<3|l)},realloc:function(u){for(var l=this.length||16;l<this.pos+u;)l*=2;if(l!==this.length){var f=new Uint8Array(l);f.set(this.buf),this.buf=f,this.length=l}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(u){this.realloc(4),xy(this.buf,u,this.pos),this.pos+=4},writeSFixed32:function(u){this.realloc(4),xy(this.buf,u,this.pos),this.pos+=4},writeFixed64:function(u){this.realloc(8),xy(this.buf,-1&u,this.pos),xy(this.buf,Math.floor(u*AU),this.pos+4),this.pos+=8},writeSFixed64:function(u){this.realloc(8),xy(this.buf,-1&u,this.pos),xy(this.buf,Math.floor(u*AU),this.pos+4),this.pos+=8},writeVarint:function(u){(u=+u||0)>268435455||u<0?function(l,f){var x,S;if(l>=0?(x=l%4294967296|0,S=l/4294967296|0):(S=~(-l/4294967296),4294967295^(x=~(-l%4294967296))?x=x+1|0:(x=0,S=S+1|0)),l>=18446744073709552e3||l<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");f.realloc(10),function(k,D,F){F.buf[F.pos++]=127&k|128,k>>>=7,F.buf[F.pos++]=127&k|128,k>>>=7,F.buf[F.pos++]=127&k|128,k>>>=7,F.buf[F.pos++]=127&k|128,F.buf[F.pos]=127&(k>>>=7)}(x,0,f),function(k,D){var F=(7&k)<<4;D.buf[D.pos++]|=F|((k>>>=3)?128:0),k&&(D.buf[D.pos++]=127&k|((k>>>=7)?128:0),k&&(D.buf[D.pos++]=127&k|((k>>>=7)?128:0),k&&(D.buf[D.pos++]=127&k|((k>>>=7)?128:0),k&&(D.buf[D.pos++]=127&k|((k>>>=7)?128:0),k&&(D.buf[D.pos++]=127&k)))))}(S,f)}(u,this):(this.realloc(4),this.buf[this.pos++]=127&u|(u>127?128:0),u<=127||(this.buf[this.pos++]=127&(u>>>=7)|(u>127?128:0),u<=127||(this.buf[this.pos++]=127&(u>>>=7)|(u>127?128:0),u<=127||(this.buf[this.pos++]=u>>>7&127))))},writeSVarint:function(u){this.writeVarint(u<0?2*-u-1:2*u)},writeBoolean:function(u){this.writeVarint(!!u)},writeString:function(u){u=String(u),this.realloc(4*u.length),this.pos++;var l=this.pos;this.pos=function(x,S,k){for(var D,F,j=0;j<S.length;j++){if((D=S.charCodeAt(j))>55295&&D<57344){if(!F){D>56319||j+1===S.length?(x[k++]=239,x[k++]=191,x[k++]=189):F=D;continue}if(D<56320){x[k++]=239,x[k++]=191,x[k++]=189,F=D;continue}D=F-55296<<10|D-56320|65536,F=null}else F&&(x[k++]=239,x[k++]=191,x[k++]=189,F=null);D<128?x[k++]=D:(D<2048?x[k++]=D>>6|192:(D<65536?x[k++]=D>>12|224:(x[k++]=D>>18|240,x[k++]=D>>12&63|128),x[k++]=D>>6&63|128),x[k++]=63&D|128)}return k}(this.buf,u,this.pos);var f=this.pos-l;f>=128&&_U(l,f,this),this.pos=l-1,this.writeVarint(f),this.pos+=f},writeFloat:function(u){this.realloc(4),mU(this.buf,u,this.pos,!0,23,4),this.pos+=4},writeDouble:function(u){this.realloc(8),mU(this.buf,u,this.pos,!0,52,8),this.pos+=8},writeBytes:function(u){var l=u.length;this.writeVarint(l),this.realloc(l);for(var f=0;f<l;f++)this.buf[this.pos++]=u[f]},writeRawMessage:function(u,l){this.pos++;var f=this.pos;u(l,this);var x=this.pos-f;x>=128&&_U(f,x,this),this.pos=f-1,this.writeVarint(x),this.pos+=x},writeMessage:function(u,l,f){this.writeTag(u,jn.Bytes),this.writeRawMessage(l,f)},writePackedVarint:function(u,l){l.length&&this.writeMessage(u,lft,l)},writePackedSVarint:function(u,l){l.length&&this.writeMessage(u,cft,l)},writePackedBoolean:function(u,l){l.length&&this.writeMessage(u,fft,l)},writePackedFloat:function(u,l){l.length&&this.writeMessage(u,uft,l)},writePackedDouble:function(u,l){l.length&&this.writeMessage(u,hft,l)},writePackedFixed32:function(u,l){l.length&&this.writeMessage(u,pft,l)},writePackedSFixed32:function(u,l){l.length&&this.writeMessage(u,dft,l)},writePackedFixed64:function(u,l){l.length&&this.writeMessage(u,mft,l)},writePackedSFixed64:function(u,l){l.length&&this.writeMessage(u,Aft,l)},writeBytesField:function(u,l){this.writeTag(u,jn.Bytes),this.writeBytes(l)},writeFixed32Field:function(u,l){this.writeTag(u,jn.Fixed32),this.writeFixed32(l)},writeSFixed32Field:function(u,l){this.writeTag(u,jn.Fixed32),this.writeSFixed32(l)},writeFixed64Field:function(u,l){this.writeTag(u,jn.Fixed64),this.writeFixed64(l)},writeSFixed64Field:function(u,l){this.writeTag(u,jn.Fixed64),this.writeSFixed64(l)},writeVarintField:function(u,l){this.writeTag(u,jn.Varint),this.writeVarint(l)},writeSVarintField:function(u,l){this.writeTag(u,jn.Varint),this.writeSVarint(l)},writeStringField:function(u,l){this.writeTag(u,jn.Bytes),this.writeString(l)},writeFloatField:function(u,l){this.writeTag(u,jn.Fixed32),this.writeFloat(l)},writeDoubleField:function(u,l){this.writeTag(u,jn.Fixed64),this.writeDouble(l)},writeBooleanField:function(u,l){this.writeVarintField(u,!!l)}};var sR=a(pU);let oR=3;function gft(u,l,f){u===1&&f.readMessage(_ft,l)}function _ft(u,l,f){if(u===3){let{id:x,bitmap:S,width:k,height:D,left:F,top:j,advance:Y}=f.readMessage(yft,{});l.push({id:x,bitmap:new I({width:k+2*oR,height:D+2*oR},S),metrics:{width:k,height:D,left:F,top:j,advance:Y}})}}function yft(u,l,f){u===1?l.id=f.readVarint():u===2?l.bitmap=f.readBytes():u===3?l.width=f.readVarint():u===4?l.height=f.readVarint():u===5?l.left=f.readSVarint():u===6?l.top=f.readSVarint():u===7&&(l.advance=f.readVarint())}let xU=oR;function bU(u){let l=0,f=0;for(let D of u)l+=D.w*D.h,f=Math.max(f,D.w);u.sort((D,F)=>F.h-D.h);let x=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(l/.95)),f),h:1/0}],S=0,k=0;for(let D of u)for(let F=x.length-1;F>=0;F--){let j=x[F];if(!(D.w>j.w||D.h>j.h)){if(D.x=j.x,D.y=j.y,k=Math.max(k,D.y+D.h),S=Math.max(S,D.x+D.w),D.w===j.w&&D.h===j.h){let Y=x.pop();F<x.length&&(x[F]=Y)}else D.h===j.h?(j.x+=D.w,j.w-=D.w):D.w===j.w?(j.y+=D.h,j.h-=D.h):(x.push({x:j.x+D.w,y:j.y,w:j.w-D.w,h:D.h}),j.y+=D.h,j.h-=D.h);break}}return{w:S,h:k,fill:l/(S*k)||0}}let Fl=1;class aR{constructor(l,{pixelRatio:f,version:x,stretchX:S,stretchY:k,content:D}){this.paddedRect=l,this.pixelRatio=f,this.stretchX=S,this.stretchY=k,this.content=D,this.version=x}get tl(){return[this.paddedRect.x+Fl,this.paddedRect.y+Fl]}get br(){return[this.paddedRect.x+this.paddedRect.w-Fl,this.paddedRect.y+this.paddedRect.h-Fl]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*Fl)/this.pixelRatio,(this.paddedRect.h-2*Fl)/this.pixelRatio]}}class vU{constructor(l,f){let x={},S={};this.haveRenderCallbacks=[];let k=[];this.addImages(l,x,k),this.addImages(f,S,k);let{w:D,h:F}=bU(k),j=new R({width:D||1,height:F||1});for(let Y in l){let K=l[Y],et=x[Y].paddedRect;R.copy(K.data,j,{x:0,y:0},{x:et.x+Fl,y:et.y+Fl},K.data)}for(let Y in f){let K=f[Y],et=S[Y].paddedRect,st=et.x+Fl,ct=et.y+Fl,ht=K.data.width,Tt=K.data.height;R.copy(K.data,j,{x:0,y:0},{x:st,y:ct},K.data),R.copy(K.data,j,{x:0,y:Tt-1},{x:st,y:ct-1},{width:ht,height:1}),R.copy(K.data,j,{x:0,y:0},{x:st,y:ct+Tt},{width:ht,height:1}),R.copy(K.data,j,{x:ht-1,y:0},{x:st-1,y:ct},{width:1,height:Tt}),R.copy(K.data,j,{x:0,y:0},{x:st+ht,y:ct},{width:1,height:Tt})}this.image=j,this.iconPositions=x,this.patternPositions=S}addImages(l,f,x){for(let S in l){let k=l[S],D={x:0,y:0,w:k.data.width+2*Fl,h:k.data.height+2*Fl};x.push(D),f[S]=new aR(D,k),k.hasRenderCallback&&this.haveRenderCallbacks.push(S)}}patchUpdatedImages(l,f){l.dispatchRenderCallbacks(this.haveRenderCallbacks);for(let x in l.updatedImages)this.patchUpdatedImage(this.iconPositions[x],l.getImage(x),f),this.patchUpdatedImage(this.patternPositions[x],l.getImage(x),f)}patchUpdatedImage(l,f,x){if(!l||!f||l.version===f.version)return;l.version=f.version;let[S,k]=l.tl;x.update(f.data,void 0,{x:S,y:k})}}var gm;Ve("ImagePosition",aR),Ve("ImageAtlas",vU),n.ai=void 0,(gm=n.ai||(n.ai={}))[gm.none=0]="none",gm[gm.horizontal=1]="horizontal",gm[gm.vertical=2]="vertical",gm[gm.horizontalOnly=3]="horizontalOnly";let tv=-17;class ev{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(l,f){let x=new ev;return x.scale=l||1,x.fontStack=f,x}static forImage(l){let f=new ev;return f.imageName=l,f}}class by{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(l,f){let x=new by;for(let S=0;S<l.sections.length;S++){let k=l.sections[S];k.image?x.addImageSection(k):x.addTextSection(k,f)}return x}length(){return this.text.length}getSection(l){return this.sections[this.sectionIndex[l]]}getSectionIndex(l){return this.sectionIndex[l]}getCharCode(l){return this.text.charCodeAt(l)}verticalizePunctuation(){this.text=function(l){let f="";for(let x=0;x<l.length;x++){let S=l.charCodeAt(x+1)||null,k=l.charCodeAt(x-1)||null;f+=S&&_d(S)&&!Jb[l[x+1]]||k&&_d(k)&&!Jb[l[x-1]]||!Jb[l[x]]?l[x]:Jb[l[x]]}return f}(this.text)}trim(){let l=0;for(let x=0;x<this.text.length&&O4[this.text.charCodeAt(x)];x++)l++;let f=this.text.length;for(let x=this.text.length-1;x>=0&&x>=l&&O4[this.text.charCodeAt(x)];x--)f--;this.text=this.text.substring(l,f),this.sectionIndex=this.sectionIndex.slice(l,f)}substring(l,f){let x=new by;return x.text=this.text.substring(l,f),x.sectionIndex=this.sectionIndex.slice(l,f),x.sections=this.sections,x}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((l,f)=>Math.max(l,this.sections[f].scale),0)}addTextSection(l,f){this.text+=l.text,this.sections.push(ev.forText(l.scale,l.fontStack||f));let x=this.sections.length-1;for(let S=0;S<l.text.length;++S)this.sectionIndex.push(x)}addImageSection(l){let f=l.image?l.image.name:"";if(f.length===0)return void re("Can't add FormattedSection with an empty image.");let x=this.getNextImageSectionCharCode();x?(this.text+=String.fromCharCode(x),this.sections.push(ev.forImage(f)),this.sectionIndex.push(this.sections.length-1)):re("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function D4(u,l,f,x,S,k,D,F,j,Y,K,et,st,ct,ht,Tt){let Nt=by.fromFeature(u,S),Ut;et===n.ai.vertical&&Nt.verticalizePunctuation();let{processBidirectionalText:Kt,processStyledBidirectionalText:Ht}=ka;if(Kt&&Nt.sections.length===1){Ut=[];let ve=Kt(Nt.toString(),lR(Nt,Y,k,l,x,ct,ht));for(let Ke of ve){let mr=new by;mr.text=Ke,mr.sections=Nt.sections;for(let Qe=0;Qe<Ke.length;Qe++)mr.sectionIndex.push(0);Ut.push(mr)}}else if(Ht){Ut=[];let ve=Ht(Nt.text,Nt.sectionIndex,lR(Nt,Y,k,l,x,ct,ht));for(let Ke of ve){let mr=new by;mr.text=Ke[0],mr.sectionIndex=Ke[1],mr.sections=Nt.sections,Ut.push(mr)}}else Ut=function(ve,Ke){let mr=[],Qe=ve.text,Ye=0;for(let je of Ke)mr.push(ve.substring(Ye,je)),Ye=je;return Ye<Qe.length&&mr.push(ve.substring(Ye,Qe.length)),mr}(Nt,lR(Nt,Y,k,l,x,ct,ht));let Jt=[],le={positionedLines:Jt,text:Nt.toString(),top:K[1],bottom:K[1],left:K[0],right:K[0],writingMode:et,iconsInText:!1,verticalizable:!1};return function(ve,Ke,mr,Qe,Ye,je,or,$e,Re,Pr,gr,Bi){let os=0,ds=tv,Eo=0,Ac=0,cl=$e==="right"?1:$e==="left"?0:.5,uo=0;for(let Io of Ye){Io.trim();let Mo=Io.getMaxScale(),Na=(Mo-1)*So,fl={positionedGlyphs:[],lineOffset:0};ve.positionedLines[uo]=fl;let La=fl.positionedGlyphs,zl=0;if(!Io.length()){ds+=je,++uo;continue}for(let Co=0;Co<Io.length();Co++){let Gi=Io.getSection(Co),Fa=Io.getSectionIndex(Co),_a=Io.getCharCode(Co),Po=0,Vu=null,Wh=null,$h=null,Ed=So,ju=!(Re===n.ai.horizontal||!gr&&!am(_a)||gr&&(O4[_a]||(ta=_a,qe.Arabic(ta)||qe["Arabic Supplement"](ta)||qe["Arabic Extended-A"](ta)||qe["Arabic Presentation Forms-A"](ta)||qe["Arabic Presentation Forms-B"](ta))));if(Gi.imageName){let ou=Qe[Gi.imageName];if(!ou)continue;$h=Gi.imageName,ve.iconsInText=ve.iconsInText||!0,Wh=ou.paddedRect;let Vl=ou.displaySize;Gi.scale=Gi.scale*So/Bi,Vu={width:Vl[0],height:Vl[1],left:Fl,top:-xU,advance:ju?Vl[1]:Vl[0]},Po=Na+(So-Vl[1]*Gi.scale),Ed=Vu.advance;let Id=ju?Vl[0]*Gi.scale-So*Mo:Vl[1]*Gi.scale-So*Mo;Id>0&&Id>zl&&(zl=Id)}else{let ou=mr[Gi.fontStack],Vl=ou&&ou[_a];if(Vl&&Vl.rect)Wh=Vl.rect,Vu=Vl.metrics;else{let Id=Ke[Gi.fontStack],ov=Id&&Id[_a];if(!ov)continue;Vu=ov.metrics}Po=(Mo-Gi.scale)*So}ju?(ve.verticalizable=!0,La.push({glyph:_a,imageName:$h,x:os,y:ds+Po,vertical:ju,scale:Gi.scale,fontStack:Gi.fontStack,sectionIndex:Fa,metrics:Vu,rect:Wh}),os+=Ed*Gi.scale+Pr):(La.push({glyph:_a,imageName:$h,x:os,y:ds+Po,vertical:ju,scale:Gi.scale,fontStack:Gi.fontStack,sectionIndex:Fa,metrics:Vu,rect:Wh}),os+=Vu.advance*Gi.scale+Pr)}La.length!==0&&(Eo=Math.max(os-Pr,Eo),vft(La,0,La.length-1,cl,zl)),os=0;let Ul=je*Mo+zl;fl.lineOffset=Math.max(zl,Na),ds+=Ul,Ac=Math.max(Ul,Ac),++uo}var ta;let ga=ds-tv,{horizontalAlign:ul,verticalAlign:hl}=cR(or);(function(Io,Mo,Na,fl,La,zl,Ul,Co,Gi){let Fa=(Mo-Na)*La,_a=0;_a=zl!==Ul?-Co*fl-tv:(-fl*Gi+.5)*Ul;for(let Po of Io)for(let Vu of Po.positionedGlyphs)Vu.x+=Fa,Vu.y+=_a})(ve.positionedLines,cl,ul,hl,Eo,Ac,je,ga,Ye.length),ve.top+=-hl*ga,ve.bottom=ve.top+ga,ve.left+=-ul*Eo,ve.right=ve.left+Eo}(le,l,f,x,Ut,D,F,j,et,Y,st,Tt),!function(ve){for(let Ke of ve)if(Ke.positionedGlyphs.length!==0)return!1;return!0}(Jt)&&le}let O4={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},xft={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function wU(u,l,f,x,S,k){if(l.imageName){let D=x[l.imageName];return D?D.displaySize[0]*l.scale*So/k+S:0}{let D=f[l.fontStack],F=D&&D[u];return F?F.metrics.advance*l.scale+S:0}}function TU(u,l,f,x){let S=Math.pow(u-l,2);return x?u<l?S/2:2*S:S+Math.abs(f)*f}function bft(u,l,f){let x=0;return u===10&&(x-=1e4),f&&(x+=150),u!==40&&u!==65288||(x+=50),l!==41&&l!==65289||(x+=50),x}function SU(u,l,f,x,S,k){let D=null,F=TU(l,f,S,k);for(let j of x){let Y=TU(l-j.x,f,S,k)+j.badness;Y<=F&&(D=j,F=Y)}return{index:u,x:l,priorBreak:D,badness:F}}function EU(u){return u?EU(u.priorBreak).concat(u.index):[]}function lR(u,l,f,x,S,k,D){if(k!=="point")return[];if(!u)return[];let F=[],j=function(st,ct,ht,Tt,Nt,Ut){let Kt=0;for(let Ht=0;Ht<st.length();Ht++){let Jt=st.getSection(Ht);Kt+=wU(st.getCharCode(Ht),Jt,Tt,Nt,ct,Ut)}return Kt/Math.max(1,Math.ceil(Kt/ht))}(u,l,f,x,S,D),Y=u.text.indexOf("\u200B")>=0,K=0;for(let st=0;st<u.length();st++){let ct=u.getSection(st),ht=u.getCharCode(st);if(O4[ht]||(K+=wU(ht,ct,x,S,l,D)),st<u.length()-1){let Tt=!((et=ht)<11904||!(qe["Bopomofo Extended"](et)||qe.Bopomofo(et)||qe["CJK Compatibility Forms"](et)||qe["CJK Compatibility Ideographs"](et)||qe["CJK Compatibility"](et)||qe["CJK Radicals Supplement"](et)||qe["CJK Strokes"](et)||qe["CJK Symbols and Punctuation"](et)||qe["CJK Unified Ideographs Extension A"](et)||qe["CJK Unified Ideographs"](et)||qe["Enclosed CJK Letters and Months"](et)||qe["Halfwidth and Fullwidth Forms"](et)||qe.Hiragana(et)||qe["Ideographic Description Characters"](et)||qe["Kangxi Radicals"](et)||qe["Katakana Phonetic Extensions"](et)||qe.Katakana(et)||qe["Vertical Forms"](et)||qe["Yi Radicals"](et)||qe["Yi Syllables"](et)));(xft[ht]||Tt||ct.imageName)&&F.push(SU(st+1,K,j,F,bft(ht,u.getCharCode(st+1),Tt&&Y),!1))}}var et;return EU(SU(u.length(),K,j,F,0,!0))}function cR(u){let l=.5,f=.5;switch(u){case"right":case"top-right":case"bottom-right":l=1;break;case"left":case"top-left":case"bottom-left":l=0}switch(u){case"bottom":case"bottom-right":case"bottom-left":f=1;break;case"top":case"top-right":case"top-left":f=0}return{horizontalAlign:l,verticalAlign:f}}function vft(u,l,f,x,S){if(!x&&!S)return;let k=u[f],D=(u[f].x+k.metrics.advance*k.scale)*x;for(let F=l;F<=f;F++)u[F].x-=D,u[F].y+=S}function wft(u,l,f){let{horizontalAlign:x,verticalAlign:S}=cR(f),k=l[0]-u.displaySize[0]*x,D=l[1]-u.displaySize[1]*S;return{image:u,top:D,bottom:D+u.displaySize[1],left:k,right:k+u.displaySize[0]}}function IU(u,l,f,x,S,k){let D=u.image,F;if(D.content){let Nt=D.content,Ut=D.pixelRatio||1;F=[Nt[0]/Ut,Nt[1]/Ut,D.displaySize[0]-Nt[2]/Ut,D.displaySize[1]-Nt[3]/Ut]}let j=l.left*k,Y=l.right*k,K,et,st,ct;f==="width"||f==="both"?(ct=S[0]+j-x[3],et=S[0]+Y+x[1]):(ct=S[0]+(j+Y-D.displaySize[0])/2,et=ct+D.displaySize[0]);let ht=l.top*k,Tt=l.bottom*k;return f==="height"||f==="both"?(K=S[1]+ht-x[0],st=S[1]+Tt+x[2]):(K=S[1]+(ht+Tt-D.displaySize[1])/2,st=K+D.displaySize[1]),{image:D,top:K,right:et,bottom:st,left:ct,collisionPadding:F}}let rv=255,Xf=128,_m=rv*Xf;function MU(u,l){let{expression:f}=l;if(f.kind==="constant")return{kind:"constant",layoutSize:f.evaluate(new Yn(u+1))};if(f.kind==="source")return{kind:"source"};{let{zoomStops:x,interpolationType:S}=f,k=0;for(;k<x.length&&x[k]<=u;)k++;k=Math.max(0,k-1);let D=k;for(;D<x.length&&x[D]<u+1;)D++;D=Math.min(x.length-1,D);let F=x[k],j=x[D];return f.kind==="composite"?{kind:"composite",minZoom:F,maxZoom:j,interpolationType:S}:{kind:"camera",minZoom:F,maxZoom:j,minSize:f.evaluate(new Yn(F)),maxSize:f.evaluate(new Yn(j)),interpolationType:S}}}function uR(u,l,f){let x="never",S=u.get(l);return S?x=S:u.get(f)&&(x="always"),x}let Tft=Am.VectorTileFeature.types,Sft=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function B4(u,l,f,x,S,k,D,F,j,Y,K,et,st){let ct=F?Math.min(_m,Math.round(F[0])):0,ht=F?Math.min(_m,Math.round(F[1])):0;u.emplaceBack(l,f,Math.round(32*x),Math.round(32*S),k,D,(ct<<1)+(j?1:0),ht,16*Y,16*K,256*et,256*st)}function hR(u,l,f){u.emplaceBack(l.x,l.y,f),u.emplaceBack(l.x,l.y,f),u.emplaceBack(l.x,l.y,f),u.emplaceBack(l.x,l.y,f)}function Eft(u){for(let l of u.sections)if(ly(l.text))return!0;return!1}class fR{constructor(l){this.layoutVertexArray=new Ci,this.indexArray=new vo,this.programConfigurations=l,this.segments=new Vn,this.dynamicLayoutVertexArray=new fi,this.opacityVertexArray=new Oi,this.hasVisibleVertices=!1,this.placedSymbolArray=new Zt}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(l,f,x,S){this.isEmpty()||(x&&(this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,ift.members),this.indexBuffer=l.createIndexBuffer(this.indexArray,f),this.dynamicLayoutVertexBuffer=l.createVertexBuffer(this.dynamicLayoutVertexArray,nft.members,!0),this.opacityVertexBuffer=l.createVertexBuffer(this.opacityVertexArray,Sft,!0),this.opacityVertexBuffer.itemSize=1),(x||S)&&this.programConfigurations.upload(l))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Ve("SymbolBuffers",fR);class pR{constructor(l,f,x){this.layoutVertexArray=new l,this.layoutAttributes=f,this.indexArray=new x,this.segments=new Vn,this.collisionVertexArray=new Un}upload(l){this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=l.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=l.createVertexBuffer(this.collisionVertexArray,sft.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Ve("CollisionBuffers",pR);class vy{constructor(l){this.collisionBoxArray=l.collisionBoxArray,this.zoom=l.zoom,this.overscaling=l.overscaling,this.layers=l.layers,this.layerIds=this.layers.map(D=>D.id),this.index=l.index,this.pixelRatio=l.pixelRatio,this.sourceLayerIndex=l.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=De([]),this.placementViewportMatrix=De([]);let f=this.layers[0]._unevaluatedLayout._values;this.textSizeData=MU(this.zoom,f["text-size"]),this.iconSizeData=MU(this.zoom,f["icon-size"]);let x=this.layers[0].layout,S=x.get("symbol-sort-key"),k=x.get("symbol-z-order");this.canOverlap=uR(x,"text-overlap","text-allow-overlap")!=="never"||uR(x,"icon-overlap","icon-allow-overlap")!=="never"||x.get("text-ignore-placement")||x.get("icon-ignore-placement"),this.sortFeaturesByKey=k!=="viewport-y"&&!S.isConstant(),this.sortFeaturesByY=(k==="viewport-y"||k==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,x.get("symbol-placement")==="point"&&(this.writingModes=x.get("text-writing-mode").map(D=>n.ai[D])),this.stateDependentLayerIds=this.layers.filter(D=>D.isStateDependent()).map(D=>D.id),this.sourceID=l.sourceID}createArrays(){this.text=new fR(new iu(this.layers,this.zoom,l=>/^text/.test(l))),this.icon=new fR(new iu(this.layers,this.zoom,l=>/^icon/.test(l))),this.glyphOffsetArray=new Gt,this.lineVertexArray=new he,this.symbolInstances=new Bt,this.textAnchorOffsets=new xe}calculateGlyphDependencies(l,f,x,S,k){for(let D=0;D<l.length;D++)if(f[l.charCodeAt(D)]=!0,(x||S)&&k){let F=Jb[l.charAt(D)];F&&(f[F.charCodeAt(0)]=!0)}}populate(l,f,x){let S=this.layers[0],k=S.layout,D=k.get("text-font"),F=k.get("text-field"),j=k.get("icon-image"),Y=(F.value.kind!=="constant"||F.value.value instanceof Hn&&!F.value.value.isEmpty()||F.value.value.toString().length>0)&&(D.value.kind!=="constant"||D.value.value.length>0),K=j.value.kind!=="constant"||!!j.value.value||Object.keys(j.parameters).length>0,et=k.get("symbol-sort-key");if(this.features=[],!Y&&!K)return;let st=f.iconDependencies,ct=f.glyphDependencies,ht=f.availableImages,Tt=new Yn(this.zoom);for(let{feature:Nt,id:Ut,index:Kt,sourceLayerIndex:Ht}of l){let Jt=S._featureFilter.needGeometry,le=Hf(Nt,Jt);if(!S._featureFilter.filter(Tt,le,x))continue;let ve,Ke;if(Jt||(le.geometry=$f(Nt)),Y){let Qe=S.getValueAndResolveTokens("text-field",le,x,ht),Ye=Hn.factory(Qe);Eft(Ye)&&(this.hasRTLText=!0),(!this.hasRTLText||pg()==="unavailable"||this.hasRTLText&&ka.isParsed())&&(ve=aft(Ye,S,le))}if(K){let Qe=S.getValueAndResolveTokens("icon-image",le,x,ht);Ke=Qe instanceof Rs?Qe:Rs.fromString(Qe)}if(!ve&&!Ke)continue;let mr=this.sortFeaturesByKey?et.evaluate(le,{},x):void 0;if(this.features.push({id:Ut,text:ve,icon:Ke,index:Kt,sourceLayerIndex:Ht,geometry:le.geometry,properties:Nt.properties,type:Tft[Nt.type],sortKey:mr}),Ke&&(st[Ke.name]=!0),ve){let Qe=D.evaluate(le,{},x).join(","),Ye=k.get("text-rotation-alignment")!=="viewport"&&k.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(n.ai.vertical)>=0;for(let je of ve.sections)if(je.image)st[je.image.name]=!0;else{let or=cg(ve.toString()),$e=je.fontStack||Qe,Re=ct[$e]=ct[$e]||{};this.calculateGlyphDependencies(je.text,Re,Ye,this.allowVerticalPlacement,or)}}}k.get("symbol-placement")==="line"&&(this.features=function(Nt){let Ut={},Kt={},Ht=[],Jt=0;function le(Qe){Ht.push(Nt[Qe]),Jt++}function ve(Qe,Ye,je){let or=Kt[Qe];return delete Kt[Qe],Kt[Ye]=or,Ht[or].geometry[0].pop(),Ht[or].geometry[0]=Ht[or].geometry[0].concat(je[0]),or}function Ke(Qe,Ye,je){let or=Ut[Ye];return delete Ut[Ye],Ut[Qe]=or,Ht[or].geometry[0].shift(),Ht[or].geometry[0]=je[0].concat(Ht[or].geometry[0]),or}function mr(Qe,Ye,je){let or=je?Ye[0][Ye[0].length-1]:Ye[0][0];return`${Qe}:${or.x}:${or.y}`}for(let Qe=0;Qe<Nt.length;Qe++){let Ye=Nt[Qe],je=Ye.geometry,or=Ye.text?Ye.text.toString():null;if(!or){le(Qe);continue}let $e=mr(or,je),Re=mr(or,je,!0);if($e in Kt&&Re in Ut&&Kt[$e]!==Ut[Re]){let Pr=Ke($e,Re,je),gr=ve($e,Re,Ht[Pr].geometry);delete Ut[$e],delete Kt[Re],Kt[mr(or,Ht[gr].geometry,!0)]=gr,Ht[Pr].geometry=null}else $e in Kt?ve($e,Re,je):Re in Ut?Ke($e,Re,je):(le(Qe),Ut[$e]=Jt-1,Kt[Re]=Jt-1)}return Ht.filter(Qe=>Qe.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Nt,Ut)=>Nt.sortKey-Ut.sortKey)}update(l,f,x){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(l,f,this.layers,x),this.icon.programConfigurations.updatePaintArrays(l,f,this.layers,x))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(l){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(l),this.iconCollisionBox.upload(l)),this.text.upload(l,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(l,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(l,f){let x=this.lineVertexArray.length;if(l.segment!==void 0){let S=l.dist(f[l.segment+1]),k=l.dist(f[l.segment]),D={};for(let F=l.segment+1;F<f.length;F++)D[F]={x:f[F].x,y:f[F].y,tileUnitDistanceFromAnchor:S},F<f.length-1&&(S+=f[F+1].dist(f[F]));for(let F=l.segment||0;F>=0;F--)D[F]={x:f[F].x,y:f[F].y,tileUnitDistanceFromAnchor:k},F>0&&(k+=f[F-1].dist(f[F]));for(let F=0;F<f.length;F++){let j=D[F];this.lineVertexArray.emplaceBack(j.x,j.y,j.tileUnitDistanceFromAnchor)}}return{lineStartIndex:x,lineLength:this.lineVertexArray.length-x}}addSymbols(l,f,x,S,k,D,F,j,Y,K,et,st){let ct=l.indexArray,ht=l.layoutVertexArray,Tt=l.segments.prepareSegment(4*f.length,ht,ct,this.canOverlap?D.sortKey:void 0),Nt=this.glyphOffsetArray.length,Ut=Tt.vertexLength,Kt=this.allowVerticalPlacement&&F===n.ai.vertical?Math.PI/2:0,Ht=D.text&&D.text.sections;for(let Jt=0;Jt<f.length;Jt++){let{tl:le,tr:ve,bl:Ke,br:mr,tex:Qe,pixelOffsetTL:Ye,pixelOffsetBR:je,minFontScaleX:or,minFontScaleY:$e,glyphOffset:Re,isSDF:Pr,sectionIndex:gr}=f[Jt],Bi=Tt.vertexLength,os=Re[1];B4(ht,j.x,j.y,le.x,os+le.y,Qe.x,Qe.y,x,Pr,Ye.x,Ye.y,or,$e),B4(ht,j.x,j.y,ve.x,os+ve.y,Qe.x+Qe.w,Qe.y,x,Pr,je.x,Ye.y,or,$e),B4(ht,j.x,j.y,Ke.x,os+Ke.y,Qe.x,Qe.y+Qe.h,x,Pr,Ye.x,je.y,or,$e),B4(ht,j.x,j.y,mr.x,os+mr.y,Qe.x+Qe.w,Qe.y+Qe.h,x,Pr,je.x,je.y,or,$e),hR(l.dynamicLayoutVertexArray,j,Kt),ct.emplaceBack(Bi,Bi+1,Bi+2),ct.emplaceBack(Bi+1,Bi+2,Bi+3),Tt.vertexLength+=4,Tt.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Re[0]),Jt!==f.length-1&&gr===f[Jt+1].sectionIndex||l.programConfigurations.populatePaintArrays(ht.length,D,D.index,{},st,Ht&&Ht[gr])}l.placedSymbolArray.emplaceBack(j.x,j.y,Nt,this.glyphOffsetArray.length-Nt,Ut,Y,K,j.segment,x?x[0]:0,x?x[1]:0,S[0],S[1],F,0,!1,0,et)}_addCollisionDebugVertex(l,f,x,S,k,D){return f.emplaceBack(0,0),l.emplaceBack(x.x,x.y,S,k,Math.round(D.x),Math.round(D.y))}addCollisionDebugVertices(l,f,x,S,k,D,F){let j=k.segments.prepareSegment(4,k.layoutVertexArray,k.indexArray),Y=j.vertexLength,K=k.layoutVertexArray,et=k.collisionVertexArray,st=F.anchorX,ct=F.anchorY;this._addCollisionDebugVertex(K,et,D,st,ct,new g(l,f)),this._addCollisionDebugVertex(K,et,D,st,ct,new g(x,f)),this._addCollisionDebugVertex(K,et,D,st,ct,new g(x,S)),this._addCollisionDebugVertex(K,et,D,st,ct,new g(l,S)),j.vertexLength+=4;let ht=k.indexArray;ht.emplaceBack(Y,Y+1),ht.emplaceBack(Y+1,Y+2),ht.emplaceBack(Y+2,Y+3),ht.emplaceBack(Y+3,Y),j.primitiveLength+=4}addDebugCollisionBoxes(l,f,x,S){for(let k=l;k<f;k++){let D=this.collisionBoxArray.get(k);this.addCollisionDebugVertices(D.x1,D.y1,D.x2,D.y2,S?this.textCollisionBox:this.iconCollisionBox,D.anchorPoint,x)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new pR(Ts,fU.members,Gs),this.iconCollisionBox=new pR(Ts,fU.members,Gs);for(let l=0;l<this.symbolInstances.length;l++){let f=this.symbolInstances.get(l);this.addDebugCollisionBoxes(f.textBoxStartIndex,f.textBoxEndIndex,f,!0),this.addDebugCollisionBoxes(f.verticalTextBoxStartIndex,f.verticalTextBoxEndIndex,f,!0),this.addDebugCollisionBoxes(f.iconBoxStartIndex,f.iconBoxEndIndex,f,!1),this.addDebugCollisionBoxes(f.verticalIconBoxStartIndex,f.verticalIconBoxEndIndex,f,!1)}}_deserializeCollisionBoxesForSymbol(l,f,x,S,k,D,F,j,Y){let K={};for(let et=f;et<x;et++){let st=l.get(et);K.textBox={x1:st.x1,y1:st.y1,x2:st.x2,y2:st.y2,anchorPointX:st.anchorPointX,anchorPointY:st.anchorPointY},K.textFeatureIndex=st.featureIndex;break}for(let et=S;et<k;et++){let st=l.get(et);K.verticalTextBox={x1:st.x1,y1:st.y1,x2:st.x2,y2:st.y2,anchorPointX:st.anchorPointX,anchorPointY:st.anchorPointY},K.verticalTextFeatureIndex=st.featureIndex;break}for(let et=D;et<F;et++){let st=l.get(et);K.iconBox={x1:st.x1,y1:st.y1,x2:st.x2,y2:st.y2,anchorPointX:st.anchorPointX,anchorPointY:st.anchorPointY},K.iconFeatureIndex=st.featureIndex;break}for(let et=j;et<Y;et++){let st=l.get(et);K.verticalIconBox={x1:st.x1,y1:st.y1,x2:st.x2,y2:st.y2,anchorPointX:st.anchorPointX,anchorPointY:st.anchorPointY},K.verticalIconFeatureIndex=st.featureIndex;break}return K}deserializeCollisionBoxes(l){this.collisionArrays=[];for(let f=0;f<this.symbolInstances.length;f++){let x=this.symbolInstances.get(f);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(l,x.textBoxStartIndex,x.textBoxEndIndex,x.verticalTextBoxStartIndex,x.verticalTextBoxEndIndex,x.iconBoxStartIndex,x.iconBoxEndIndex,x.verticalIconBoxStartIndex,x.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(l,f){let x=l.placedSymbolArray.get(f),S=x.vertexStartIndex+4*x.numGlyphs;for(let k=x.vertexStartIndex;k<S;k+=4)l.indexArray.emplaceBack(k,k+1,k+2),l.indexArray.emplaceBack(k+1,k+2,k+3)}getSortedSymbolIndexes(l){if(this.sortedAngle===l&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;let f=Math.sin(l),x=Math.cos(l),S=[],k=[],D=[];for(let F=0;F<this.symbolInstances.length;++F){D.push(F);let j=this.symbolInstances.get(F);S.push(0|Math.round(f*j.anchorX+x*j.anchorY)),k.push(j.featureIndex)}return D.sort((F,j)=>S[F]-S[j]||k[j]-k[F]),D}addToSortKeyRanges(l,f){let x=this.sortKeyRanges[this.sortKeyRanges.length-1];x&&x.sortKey===f?x.symbolInstanceEnd=l+1:this.sortKeyRanges.push({sortKey:f,symbolInstanceStart:l,symbolInstanceEnd:l+1})}sortFeatures(l){if(this.sortFeaturesByY&&this.sortedAngle!==l&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(l),this.sortedAngle=l,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(let f of this.symbolInstanceIndexes){let x=this.symbolInstances.get(f);this.featureSortOrder.push(x.featureIndex),[x.rightJustifiedTextSymbolIndex,x.centerJustifiedTextSymbolIndex,x.leftJustifiedTextSymbolIndex].forEach((S,k,D)=>{S>=0&&D.indexOf(S)===k&&this.addIndicesForPlacedSymbol(this.text,S)}),x.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,x.verticalPlacedTextSymbolIndex),x.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,x.placedIconSymbolIndex),x.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,x.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let CU,PU;Ve("SymbolBucket",vy,{omit:["layers","collisionBoxArray","features","compareText"]}),vy.MAX_GLYPHS=65535,vy.addDynamicAttributes=hR;var dR={get paint(){return PU=PU||new Ds({"icon-opacity":new Dr(ae.paint_symbol["icon-opacity"]),"icon-color":new Dr(ae.paint_symbol["icon-color"]),"icon-halo-color":new Dr(ae.paint_symbol["icon-halo-color"]),"icon-halo-width":new Dr(ae.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Dr(ae.paint_symbol["icon-halo-blur"]),"icon-translate":new ur(ae.paint_symbol["icon-translate"]),"icon-translate-anchor":new ur(ae.paint_symbol["icon-translate-anchor"]),"text-opacity":new Dr(ae.paint_symbol["text-opacity"]),"text-color":new Dr(ae.paint_symbol["text-color"],{runtimeType:xo,getOverride:u=>u.textColor,hasOverride:u=>!!u.textColor}),"text-halo-color":new Dr(ae.paint_symbol["text-halo-color"]),"text-halo-width":new Dr(ae.paint_symbol["text-halo-width"]),"text-halo-blur":new Dr(ae.paint_symbol["text-halo-blur"]),"text-translate":new ur(ae.paint_symbol["text-translate"]),"text-translate-anchor":new ur(ae.paint_symbol["text-translate-anchor"])})},get layout(){return CU=CU||new Ds({"symbol-placement":new ur(ae.layout_symbol["symbol-placement"]),"symbol-spacing":new ur(ae.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new ur(ae.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Dr(ae.layout_symbol["symbol-sort-key"]),"symbol-z-order":new ur(ae.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new ur(ae.layout_symbol["icon-allow-overlap"]),"icon-overlap":new ur(ae.layout_symbol["icon-overlap"]),"icon-ignore-placement":new ur(ae.layout_symbol["icon-ignore-placement"]),"icon-optional":new ur(ae.layout_symbol["icon-optional"]),"icon-rotation-alignment":new ur(ae.layout_symbol["icon-rotation-alignment"]),"icon-size":new Dr(ae.layout_symbol["icon-size"]),"icon-text-fit":new ur(ae.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new ur(ae.layout_symbol["icon-text-fit-padding"]),"icon-image":new Dr(ae.layout_symbol["icon-image"]),"icon-rotate":new Dr(ae.layout_symbol["icon-rotate"]),"icon-padding":new Dr(ae.layout_symbol["icon-padding"]),"icon-keep-upright":new ur(ae.layout_symbol["icon-keep-upright"]),"icon-offset":new Dr(ae.layout_symbol["icon-offset"]),"icon-anchor":new Dr(ae.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new ur(ae.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new ur(ae.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new ur(ae.layout_symbol["text-rotation-alignment"]),"text-field":new Dr(ae.layout_symbol["text-field"]),"text-font":new Dr(ae.layout_symbol["text-font"]),"text-size":new Dr(ae.layout_symbol["text-size"]),"text-max-width":new Dr(ae.layout_symbol["text-max-width"]),"text-line-height":new ur(ae.layout_symbol["text-line-height"]),"text-letter-spacing":new Dr(ae.layout_symbol["text-letter-spacing"]),"text-justify":new Dr(ae.layout_symbol["text-justify"]),"text-radial-offset":new Dr(ae.layout_symbol["text-radial-offset"]),"text-variable-anchor":new ur(ae.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new Dr(ae.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new Dr(ae.layout_symbol["text-anchor"]),"text-max-angle":new ur(ae.layout_symbol["text-max-angle"]),"text-writing-mode":new ur(ae.layout_symbol["text-writing-mode"]),"text-rotate":new Dr(ae.layout_symbol["text-rotate"]),"text-padding":new ur(ae.layout_symbol["text-padding"]),"text-keep-upright":new ur(ae.layout_symbol["text-keep-upright"]),"text-transform":new Dr(ae.layout_symbol["text-transform"]),"text-offset":new Dr(ae.layout_symbol["text-offset"]),"text-allow-overlap":new ur(ae.layout_symbol["text-allow-overlap"]),"text-overlap":new ur(ae.layout_symbol["text-overlap"]),"text-ignore-placement":new ur(ae.layout_symbol["text-ignore-placement"]),"text-optional":new ur(ae.layout_symbol["text-optional"])})}};class RU{constructor(l){if(l.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=l.property.overrides?l.property.overrides.runtimeType:il,this.defaultValue=l}evaluate(l){if(l.formattedSection){let f=this.defaultValue.property.overrides;if(f&&f.hasOverride(l.formattedSection))return f.getOverride(l.formattedSection)}return l.feature&&l.featureState?this.defaultValue.evaluate(l.feature,l.featureState):this.defaultValue.property.specification.default}eachChild(l){this.defaultValue.isConstant()||l(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Ve("FormatSectionOverride",RU,{omit:["defaultValue"]});class N4 extends Da{constructor(l){super(l,dR)}recalculate(l,f){if(super.recalculate(l,f),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){let x=this.layout.get("text-writing-mode");if(x){let S=[];for(let k of x)S.indexOf(k)<0&&S.push(k);this.layout._values["text-writing-mode"]=S}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(l,f,x,S){let k=this.layout.get(l).evaluate(f,{},x,S),D=this._unevaluatedLayout._values[l];return D.isDataDriven()||ku(D.value)||!k?k:function(F,j){return j.replace(/{([^{}]+)}/g,(Y,K)=>F&&K in F?String(F[K]):"")}(f.properties,k)}createBucket(l){return new vy(l)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(let l of dR.paint.overridableProperties){if(!N4.hasPaintOverride(this.layout,l))continue;let f=this.paint.get(l),x=new RU(f),S=new un(x,f.property.specification),k=null;k=f.value.kind==="constant"||f.value.kind==="source"?new ng("source",S):new Bf("composite",S,f.value.zoomStops),this.paint._values[l]=new Ko(f.property,k,f.parameters)}}_handleOverridablePaintPropertyUpdate(l,f,x){return!(!this.layout||f.isDataDriven()||x.isDataDriven())&&N4.hasPaintOverride(this.layout,l)}static hasPaintOverride(l,f){let x=l.get("text-field"),S=dR.paint.properties[f],k=!1,D=F=>{for(let j of F)if(S.overrides&&S.overrides.hasOverride(j))return void(k=!0)};if(x.value.kind==="constant"&&x.value.value instanceof Hn)D(x.value.value.sections);else if(x.value.kind==="source"){let F=Y=>{k||(Y instanceof ac&&zn(Y.value)===Ct?D(Y.value.sections):Y instanceof Of?D(Y.sections):Y.eachChild(F))},j=x.value;j._styleExpression&&F(j._styleExpression.expression)}return k}}let kU;var Ift={get paint(){return kU=kU||new Ds({"background-color":new ur(ae.paint_background["background-color"]),"background-pattern":new hm(ae.paint_background["background-pattern"]),"background-opacity":new ur(ae.paint_background["background-opacity"])})}};class Mft extends Da{constructor(l){super(l,Ift)}}let DU;var Cft={get paint(){return DU=DU||new Ds({"raster-opacity":new ur(ae.paint_raster["raster-opacity"]),"raster-hue-rotate":new ur(ae.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new ur(ae.paint_raster["raster-brightness-min"]),"raster-brightness-max":new ur(ae.paint_raster["raster-brightness-max"]),"raster-saturation":new ur(ae.paint_raster["raster-saturation"]),"raster-contrast":new ur(ae.paint_raster["raster-contrast"]),"raster-resampling":new ur(ae.paint_raster["raster-resampling"]),"raster-fade-duration":new ur(ae.paint_raster["raster-fade-duration"])})}};class Pft extends Da{constructor(l){super(l,Cft)}}class Rft extends Da{constructor(l){super(l,{}),this.onAdd=f=>{this.implementation.onAdd&&this.implementation.onAdd(f,f.painter.context.gl)},this.onRemove=f=>{this.implementation.onRemove&&this.implementation.onRemove(f,f.painter.context.gl)},this.implementation=l}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class kft{constructor(l){this._callback=l,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}let mR=63710088e-1;class ym{constructor(l,f){if(isNaN(l)||isNaN(f))throw new Error(`Invalid LngLat object: (${l}, ${f})`);if(this.lng=+l,this.lat=+f,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new ym(it(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(l){let f=Math.PI/180,x=this.lat*f,S=l.lat*f,k=Math.sin(x)*Math.sin(S)+Math.cos(x)*Math.cos(S)*Math.cos((l.lng-this.lng)*f);return mR*Math.acos(Math.min(k,1))}static convert(l){if(l instanceof ym)return l;if(Array.isArray(l)&&(l.length===2||l.length===3))return new ym(Number(l[0]),Number(l[1]));if(!Array.isArray(l)&&typeof l=="object"&&l!==null)return new ym(Number("lng"in l?l.lng:l.lon),Number(l.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}let OU=2*Math.PI*mR;function BU(u){return OU*Math.cos(u*Math.PI/180)}function NU(u){return(180+u)/360}function LU(u){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+u*Math.PI/360)))/360}function FU(u,l){return u/BU(l)}function zU(u){return 360*u-180}function AR(u){return 360/Math.PI*Math.atan(Math.exp((180-360*u)*Math.PI/180))-90}class L4{constructor(l,f,x=0){this.x=+l,this.y=+f,this.z=+x}static fromLngLat(l,f=0){let x=ym.convert(l);return new L4(NU(x.lng),LU(x.lat),FU(f,x.lat))}toLngLat(){return new ym(zU(this.x),AR(this.y))}toAltitude(){return this.z*BU(AR(this.y))}meterInMercatorCoordinateUnits(){return 1/OU*(l=AR(this.y),1/Math.cos(l*Math.PI/180));var l}}function UU(u,l,f){var x=2*Math.PI*6378137/256/Math.pow(2,f);return[u*x-2*Math.PI*6378137/2,l*x-2*Math.PI*6378137/2]}class gR{constructor(l,f,x){if(l<0||l>25||x<0||x>=Math.pow(2,l)||f<0||f>=Math.pow(2,l))throw new Error(`x=${f}, y=${x}, z=${l} outside of bounds. 0<=x<${Math.pow(2,l)}, 0<=y<${Math.pow(2,l)} 0<=z<=25 `);this.z=l,this.x=f,this.y=x,this.key=iv(0,l,l,f,x)}equals(l){return this.z===l.z&&this.x===l.x&&this.y===l.y}url(l,f,x){let S=(D=this.y,F=this.z,j=UU(256*(k=this.x),256*(D=Math.pow(2,F)-D-1),F),Y=UU(256*(k+1),256*(D+1),F),j[0]+","+j[1]+","+Y[0]+","+Y[1]);var k,D,F,j,Y;let K=function(et,st,ct){let ht,Tt="";for(let Nt=et;Nt>0;Nt--)ht=1<<Nt-1,Tt+=(st&ht?1:0)+(ct&ht?2:0);return Tt}(this.z,this.x,this.y);return l[(this.x+this.y)%l.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(x==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,f>1?"@2x":"").replace(/{quadkey}/g,K).replace(/{bbox-epsg-3857}/g,S)}isChildOf(l){let f=this.z-l.z;return f>0&&l.x===this.x>>f&&l.y===this.y>>f}getTilePoint(l){let f=Math.pow(2,this.z);return new g((l.x*f-this.x)*Vs,(l.y*f-this.y)*Vs)}toString(){return`${this.z}/${this.x}/${this.y}`}}class VU{constructor(l,f){this.wrap=l,this.canonical=f,this.key=iv(l,f.z,f.z,f.x,f.y)}}class su{constructor(l,f,x,S,k){if(l<x)throw new Error(`overscaledZ should be >= z; overscaledZ = ${l}; z = ${x}`);this.overscaledZ=l,this.wrap=f,this.canonical=new gR(x,+S,+k),this.key=iv(f,l,x,S,k)}clone(){return new su(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(l){return this.overscaledZ===l.overscaledZ&&this.wrap===l.wrap&&this.canonical.equals(l.canonical)}scaledTo(l){if(l>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${l}; overscaledZ = ${this.overscaledZ}`);let f=this.canonical.z-l;return l>this.canonical.z?new su(l,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new su(l,this.wrap,l,this.canonical.x>>f,this.canonical.y>>f)}calculateScaledKey(l,f){if(l>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${l}; overscaledZ = ${this.overscaledZ}`);let x=this.canonical.z-l;return l>this.canonical.z?iv(this.wrap*+f,l,this.canonical.z,this.canonical.x,this.canonical.y):iv(this.wrap*+f,l,l,this.canonical.x>>x,this.canonical.y>>x)}isChildOf(l){if(l.wrap!==this.wrap)return!1;let f=this.canonical.z-l.canonical.z;return l.overscaledZ===0||l.overscaledZ<this.overscaledZ&&l.canonical.x===this.canonical.x>>f&&l.canonical.y===this.canonical.y>>f}children(l){if(this.overscaledZ>=l)return[new su(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];let f=this.canonical.z+1,x=2*this.canonical.x,S=2*this.canonical.y;return[new su(f,this.wrap,f,x,S),new su(f,this.wrap,f,x+1,S),new su(f,this.wrap,f,x,S+1),new su(f,this.wrap,f,x+1,S+1)]}isLessThan(l){return this.wrap<l.wrap||!(this.wrap>l.wrap)&&(this.overscaledZ<l.overscaledZ||!(this.overscaledZ>l.overscaledZ)&&(this.canonical.x<l.canonical.x||!(this.canonical.x>l.canonical.x)&&this.canonical.y<l.canonical.y))}wrapped(){return new su(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(l){return new su(this.overscaledZ,l,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new VU(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(l){return this.canonical.getTilePoint(new L4(l.x-this.wrap,l.y))}}function iv(u,l,f,x,S){(u*=2)<0&&(u=-1*u-1);let k=1<<f;return(k*k*u+k*S+x).toString(36)+f.toString(36)+l.toString(36)}Ve("CanonicalTileID",gR),Ve("OverscaledTileID",su,{omit:["posMatrix"]});class jU{constructor(l,f,x,S=1,k=1,D=1,F=0){if(this.uid=l,f.height!==f.width)throw new RangeError("DEM tiles must be square");if(x&&!["mapbox","terrarium","custom"].includes(x))return void re(`"${x}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=f.height;let j=this.dim=f.height-2;switch(this.data=new Uint32Array(f.data.buffer),x){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=S,this.greenFactor=k,this.blueFactor=D,this.baseShift=F;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let Y=0;Y<j;Y++)this.data[this._idx(-1,Y)]=this.data[this._idx(0,Y)],this.data[this._idx(j,Y)]=this.data[this._idx(j-1,Y)],this.data[this._idx(Y,-1)]=this.data[this._idx(Y,0)],this.data[this._idx(Y,j)]=this.data[this._idx(Y,j-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(j,-1)]=this.data[this._idx(j-1,0)],this.data[this._idx(-1,j)]=this.data[this._idx(0,j-1)],this.data[this._idx(j,j)]=this.data[this._idx(j-1,j-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let Y=0;Y<j;Y++)for(let K=0;K<j;K++){let et=this.get(Y,K);et>this.max&&(this.max=et),et<this.min&&(this.min=et)}}get(l,f){let x=new Uint8Array(this.data.buffer),S=4*this._idx(l,f);return this.unpack(x[S],x[S+1],x[S+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(l,f){if(l<-1||l>=this.dim+1||f<-1||f>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(f+1)*this.stride+(l+1)}unpack(l,f,x){return l*this.redFactor+f*this.greenFactor+x*this.blueFactor-this.baseShift}getPixels(){return new R({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(l,f,x){if(this.dim!==l.dim)throw new Error("dem dimension mismatch");let S=f*this.dim,k=f*this.dim+this.dim,D=x*this.dim,F=x*this.dim+this.dim;switch(f){case-1:S=k-1;break;case 1:k=S+1}switch(x){case-1:D=F-1;break;case 1:F=D+1}let j=-f*this.dim,Y=-x*this.dim;for(let K=D;K<F;K++)for(let et=S;et<k;et++)this.data[this._idx(et,K)]=l.data[this._idx(et+j,K+Y)]}}Ve("DEMData",jU);class WU{constructor(l){this._stringToNumber={},this._numberToString=[];for(let f=0;f<l.length;f++){let x=l[f];this._stringToNumber[x]=f,this._numberToString[f]=x}}encode(l){return this._stringToNumber[l]}decode(l){if(l>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${l} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[l]}}class $U{constructor(l,f,x,S,k){this.type="Feature",this._vectorTileFeature=l,l._z=f,l._x=x,l._y=S,this.properties=l.properties,this.id=k}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(l){this._geometry=l}toJSON(){let l={geometry:this.geometry};for(let f in this)f!=="_geometry"&&f!=="_vectorTileFeature"&&(l[f]=this[f]);return l}}class HU{constructor(l,f){this.tileID=l,this.x=l.canonical.x,this.y=l.canonical.y,this.z=l.canonical.z,this.grid=new zf(Vs,16,0),this.grid3D=new zf(Vs,16,0),this.featureIndexArray=new Te,this.promoteId=f}insert(l,f,x,S,k,D){let F=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(x,S,k);let j=D?this.grid3D:this.grid;for(let Y=0;Y<f.length;Y++){let K=f[Y],et=[1/0,1/0,-1/0,-1/0];for(let st=0;st<K.length;st++){let ct=K[st];et[0]=Math.min(et[0],ct.x),et[1]=Math.min(et[1],ct.y),et[2]=Math.max(et[2],ct.x),et[3]=Math.max(et[3],ct.y)}et[0]<Vs&&et[1]<Vs&&et[2]>=0&&et[3]>=0&&j.insert(F,et[0],et[1],et[2],et[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Am.VectorTile(new sR(this.rawTileData)).layers,this.sourceLayerCoder=new WU(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(l,f,x,S){this.loadVTLayers();let k=l.params||{},D=Vs/l.tileSize/l.scale,F=Gc(k.filter),j=l.queryGeometry,Y=l.queryPadding*D,K=YU(j),et=this.grid.query(K.minX-Y,K.minY-Y,K.maxX+Y,K.maxY+Y),st=YU(l.cameraQueryGeometry),ct=this.grid3D.query(st.minX-Y,st.minY-Y,st.maxX+Y,st.maxY+Y,(Nt,Ut,Kt,Ht)=>function(Jt,le,ve,Ke,mr){for(let Ye of Jt)if(le<=Ye.x&&ve<=Ye.y&&Ke>=Ye.x&&mr>=Ye.y)return!0;let Qe=[new g(le,ve),new g(le,mr),new g(Ke,mr),new g(Ke,ve)];if(Jt.length>2){for(let Ye of Qe)if(Ii(Jt,Ye))return!0}for(let Ye=0;Ye<Jt.length-1;Ye++)if(ma(Jt[Ye],Jt[Ye+1],Qe))return!0;return!1}(l.cameraQueryGeometry,Nt-Y,Ut-Y,Kt+Y,Ht+Y));for(let Nt of ct)et.push(Nt);et.sort(Dft);let ht={},Tt;for(let Nt=0;Nt<et.length;Nt++){let Ut=et[Nt];if(Ut===Tt)continue;Tt=Ut;let Kt=this.featureIndexArray.get(Ut),Ht=null;this.loadMatchingFeature(ht,Kt.bucketIndex,Kt.sourceLayerIndex,Kt.featureIndex,F,k.layers,k.availableImages,f,x,S,(Jt,le,ve)=>(Ht||(Ht=$f(Jt)),le.queryIntersectsFeature(j,Jt,ve,Ht,this.z,l.transform,D,l.pixelPosMatrix)))}return ht}loadMatchingFeature(l,f,x,S,k,D,F,j,Y,K,et){let st=this.bucketLayerIDs[f];if(D&&!function(Nt,Ut){for(let Kt=0;Kt<Nt.length;Kt++)if(Ut.indexOf(Nt[Kt])>=0)return!0;return!1}(D,st))return;let ct=this.sourceLayerCoder.decode(x),ht=this.vtLayers[ct].feature(S);if(k.needGeometry){let Nt=Hf(ht,!0);if(!k.filter(new Yn(this.tileID.overscaledZ),Nt,this.tileID.canonical))return}else if(!k.filter(new Yn(this.tileID.overscaledZ),ht))return;let Tt=this.getId(ht,ct);for(let Nt=0;Nt<st.length;Nt++){let Ut=st[Nt];if(D&&D.indexOf(Ut)<0)continue;let Kt=j[Ut];if(!Kt)continue;let Ht={};Tt&&K&&(Ht=K.getState(Kt.sourceLayer||"_geojsonTileLayer",Tt));let Jt=nt({},Y[Ut]);Jt.paint=qU(Jt.paint,Kt.paint,ht,Ht,F),Jt.layout=qU(Jt.layout,Kt.layout,ht,Ht,F);let le=!et||et(ht,Kt,Ht);if(!le)continue;let ve=new $U(ht,this.z,this.x,this.y,Tt);ve.layer=Jt;let Ke=l[Ut];Ke===void 0&&(Ke=l[Ut]=[]),Ke.push({featureIndex:S,feature:ve,intersectionZ:le})}}lookupSymbolFeatures(l,f,x,S,k,D,F,j){let Y={};this.loadVTLayers();let K=Gc(k);for(let et of l)this.loadMatchingFeature(Y,x,S,et,K,D,F,j,f);return Y}hasLayer(l){for(let f of this.bucketLayerIDs)for(let x of f)if(l===x)return!0;return!1}getId(l,f){let x=l.id;return this.promoteId&&(x=l.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[f]],typeof x=="boolean"&&(x=Number(x))),x}}function qU(u,l,f,x,S){return _t(u,(k,D)=>{let F=l instanceof um?l.get(D):null;return F&&F.evaluate?F.evaluate(f,x,S):F})}function YU(u){let l=1/0,f=1/0,x=-1/0,S=-1/0;for(let k of u)l=Math.min(l,k.x),f=Math.min(f,k.y),x=Math.max(x,k.x),S=Math.max(S,k.y);return{minX:l,minY:f,maxX:x,maxY:S}}function Dft(u,l){return l-u}function XU(u,l,f,x,S){let k=[];for(let D=0;D<u.length;D++){let F=u[D],j;for(let Y=0;Y<F.length-1;Y++){let K=F[Y],et=F[Y+1];K.x<l&&et.x<l||(K.x<l?K=new g(l,K.y+(l-K.x)/(et.x-K.x)*(et.y-K.y))._round():et.x<l&&(et=new g(l,K.y+(l-K.x)/(et.x-K.x)*(et.y-K.y))._round()),K.y<f&&et.y<f||(K.y<f?K=new g(K.x+(f-K.y)/(et.y-K.y)*(et.x-K.x),f)._round():et.y<f&&(et=new g(K.x+(f-K.y)/(et.y-K.y)*(et.x-K.x),f)._round()),K.x>=x&&et.x>=x||(K.x>=x?K=new g(x,K.y+(x-K.x)/(et.x-K.x)*(et.y-K.y))._round():et.x>=x&&(et=new g(x,K.y+(x-K.x)/(et.x-K.x)*(et.y-K.y))._round()),K.y>=S&&et.y>=S||(K.y>=S?K=new g(K.x+(S-K.y)/(et.y-K.y)*(et.x-K.x),S)._round():et.y>=S&&(et=new g(K.x+(S-K.y)/(et.y-K.y)*(et.x-K.x),S)._round()),j&&K.equals(j[j.length-1])||(j=[K],k.push(j)),j.push(et)))))}}return k}Ve("FeatureIndex",HU,{omit:["rawTileData","sourceLayerCoder"]});class xm extends g{constructor(l,f,x,S){super(l,f),this.angle=x,S!==void 0&&(this.segment=S)}clone(){return new xm(this.x,this.y,this.angle,this.segment)}}function ZU(u,l,f,x,S){if(l.segment===void 0||f===0)return!0;let k=l,D=l.segment+1,F=0;for(;F>-f/2;){if(D--,D<0)return!1;F-=u[D].dist(k),k=u[D]}F+=u[D].dist(u[D+1]),D++;let j=[],Y=0;for(;F<f/2;){let K=u[D],et=u[D+1];if(!et)return!1;let st=u[D-1].angleTo(K)-K.angleTo(et);for(st=Math.abs((st+3*Math.PI)%(2*Math.PI)-Math.PI),j.push({distance:F,angleDelta:st}),Y+=st;F-j[0].distance>x;)Y-=j.shift().angleDelta;if(Y>S)return!1;D++,F+=K.dist(et)}return!0}function GU(u){let l=0;for(let f=0;f<u.length-1;f++)l+=u[f].dist(u[f+1]);return l}function QU(u,l,f){return u?.6*l*f:0}function KU(u,l){return Math.max(u?u.right-u.left:0,l?l.right-l.left:0)}function Oft(u,l,f,x,S,k){let D=QU(f,S,k),F=KU(f,x)*k,j=0,Y=GU(u)/2;for(let K=0;K<u.length-1;K++){let et=u[K],st=u[K+1],ct=et.dist(st);if(j+ct>Y){let ht=(Y-j)/ct,Tt=al.number(et.x,st.x,ht),Nt=al.number(et.y,st.y,ht),Ut=new xm(Tt,Nt,st.angleTo(et),K);return Ut._round(),!D||ZU(u,Ut,F,D,l)?Ut:void 0}j+=ct}}function Bft(u,l,f,x,S,k,D,F,j){let Y=QU(x,k,D),K=KU(x,S),et=K*D,st=u[0].x===0||u[0].x===j||u[0].y===0||u[0].y===j;return l-et<l/4&&(l=et+l/4),JU(u,st?l/2*F%l:(K/2+2*k)*D*F%l,l,Y,f,et,st,!1,j)}function JU(u,l,f,x,S,k,D,F,j){let Y=k/2,K=GU(u),et=0,st=l-f,ct=[];for(let ht=0;ht<u.length-1;ht++){let Tt=u[ht],Nt=u[ht+1],Ut=Tt.dist(Nt),Kt=Nt.angleTo(Tt);for(;st+f<et+Ut;){st+=f;let Ht=(st-et)/Ut,Jt=al.number(Tt.x,Nt.x,Ht),le=al.number(Tt.y,Nt.y,Ht);if(Jt>=0&&Jt<j&&le>=0&&le<j&&st-Y>=0&&st+Y<=K){let ve=new xm(Jt,le,Kt,ht);ve._round(),x&&!ZU(u,ve,k,x,S)||ct.push(ve)}}et+=Ut}return F||ct.length||D||(ct=JU(u,et/2,f,x,S,k,D,!0,j)),ct}Ve("Anchor",xm);let wy=Fl;function tV(u,l,f,x){let S=[],k=u.image,D=k.pixelRatio,F=k.paddedRect.w-2*wy,j=k.paddedRect.h-2*wy,Y=u.right-u.left,K=u.bottom-u.top,et=k.stretchX||[[0,F]],st=k.stretchY||[[0,j]],ct=(je,or)=>je+or[1]-or[0],ht=et.reduce(ct,0),Tt=st.reduce(ct,0),Nt=F-ht,Ut=j-Tt,Kt=0,Ht=ht,Jt=0,le=Tt,ve=0,Ke=Nt,mr=0,Qe=Ut;if(k.content&&x){let je=k.content;Kt=F4(et,0,je[0]),Jt=F4(st,0,je[1]),Ht=F4(et,je[0],je[2]),le=F4(st,je[1],je[3]),ve=je[0]-Kt,mr=je[1]-Jt,Ke=je[2]-je[0]-Ht,Qe=je[3]-je[1]-le}let Ye=(je,or,$e,Re)=>{let Pr=z4(je.stretch-Kt,Ht,Y,u.left),gr=U4(je.fixed-ve,Ke,je.stretch,ht),Bi=z4(or.stretch-Jt,le,K,u.top),os=U4(or.fixed-mr,Qe,or.stretch,Tt),ds=z4($e.stretch-Kt,Ht,Y,u.left),Eo=U4($e.fixed-ve,Ke,$e.stretch,ht),Ac=z4(Re.stretch-Jt,le,K,u.top),cl=U4(Re.fixed-mr,Qe,Re.stretch,Tt),uo=new g(Pr,Bi),ta=new g(ds,Bi),ga=new g(ds,Ac),ul=new g(Pr,Ac),hl=new g(gr/D,os/D),Io=new g(Eo/D,cl/D),Mo=l*Math.PI/180;if(Mo){let La=Math.sin(Mo),zl=Math.cos(Mo),Ul=[zl,-La,La,zl];uo._matMult(Ul),ta._matMult(Ul),ul._matMult(Ul),ga._matMult(Ul)}let Na=je.stretch+je.fixed,fl=or.stretch+or.fixed;return{tl:uo,tr:ta,bl:ul,br:ga,tex:{x:k.paddedRect.x+wy+Na,y:k.paddedRect.y+wy+fl,w:$e.stretch+$e.fixed-Na,h:Re.stretch+Re.fixed-fl},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:hl,pixelOffsetBR:Io,minFontScaleX:Ke/D/Y,minFontScaleY:Qe/D/K,isSDF:f}};if(x&&(k.stretchX||k.stretchY)){let je=eV(et,Nt,ht),or=eV(st,Ut,Tt);for(let $e=0;$e<je.length-1;$e++){let Re=je[$e],Pr=je[$e+1];for(let gr=0;gr<or.length-1;gr++)S.push(Ye(Re,or[gr],Pr,or[gr+1]))}}else S.push(Ye({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:F+1},{fixed:0,stretch:j+1}));return S}function F4(u,l,f){let x=0;for(let S of u)x+=Math.max(l,Math.min(f,S[1]))-Math.max(l,Math.min(f,S[0]));return x}function eV(u,l,f){let x=[{fixed:-wy,stretch:0}];for(let[S,k]of u){let D=x[x.length-1];x.push({fixed:S-D.stretch,stretch:D.stretch}),x.push({fixed:S-D.stretch,stretch:D.stretch+(k-S)})}return x.push({fixed:l+wy,stretch:f}),x}function z4(u,l,f,x){return u/l*f+x}function U4(u,l,f,x){return u-l*f/x}class V4{constructor(l,f,x,S,k,D,F,j,Y,K){if(this.boxStartIndex=l.length,Y){let et=D.top,st=D.bottom,ct=D.collisionPadding;ct&&(et-=ct[1],st+=ct[3]);let ht=st-et;ht>0&&(ht=Math.max(10,ht),this.circleDiameter=ht)}else{let et=D.top*F-j[0],st=D.bottom*F+j[2],ct=D.left*F-j[3],ht=D.right*F+j[1],Tt=D.collisionPadding;if(Tt&&(ct-=Tt[0]*F,et-=Tt[1]*F,ht+=Tt[2]*F,st+=Tt[3]*F),K){let Nt=new g(ct,et),Ut=new g(ht,et),Kt=new g(ct,st),Ht=new g(ht,st),Jt=K*Math.PI/180;Nt._rotate(Jt),Ut._rotate(Jt),Kt._rotate(Jt),Ht._rotate(Jt),ct=Math.min(Nt.x,Ut.x,Kt.x,Ht.x),ht=Math.max(Nt.x,Ut.x,Kt.x,Ht.x),et=Math.min(Nt.y,Ut.y,Kt.y,Ht.y),st=Math.max(Nt.y,Ut.y,Kt.y,Ht.y)}l.emplaceBack(f.x,f.y,ct,et,ht,st,x,S,k)}this.boxEndIndex=l.length}}class Nft{constructor(l=[],f=Lft){if(this.data=l,this.length=this.data.length,this.compare=f,this.length>0)for(let x=(this.length>>1)-1;x>=0;x--)this._down(x)}push(l){this.data.push(l),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;let l=this.data[0],f=this.data.pop();return this.length--,this.length>0&&(this.data[0]=f,this._down(0)),l}peek(){return this.data[0]}_up(l){let{data:f,compare:x}=this,S=f[l];for(;l>0;){let k=l-1>>1,D=f[k];if(x(S,D)>=0)break;f[l]=D,l=k}f[l]=S}_down(l){let{data:f,compare:x}=this,S=this.length>>1,k=f[l];for(;l<S;){let D=1+(l<<1),F=f[D],j=D+1;if(j<this.length&&x(f[j],F)<0&&(D=j,F=f[j]),x(F,k)>=0)break;f[l]=F,l=D}f[l]=k}}function Lft(u,l){return u<l?-1:u>l?1:0}function Fft(u,l=1,f=!1){let x=1/0,S=1/0,k=-1/0,D=-1/0,F=u[0];for(let ct=0;ct<F.length;ct++){let ht=F[ct];(!ct||ht.x<x)&&(x=ht.x),(!ct||ht.y<S)&&(S=ht.y),(!ct||ht.x>k)&&(k=ht.x),(!ct||ht.y>D)&&(D=ht.y)}let j=Math.min(k-x,D-S),Y=j/2,K=new Nft([],zft);if(j===0)return new g(x,S);for(let ct=x;ct<k;ct+=j)for(let ht=S;ht<D;ht+=j)K.push(new Ty(ct+Y,ht+Y,Y,u));let et=function(ct){let ht=0,Tt=0,Nt=0,Ut=ct[0];for(let Kt=0,Ht=Ut.length,Jt=Ht-1;Kt<Ht;Jt=Kt++){let le=Ut[Kt],ve=Ut[Jt],Ke=le.x*ve.y-ve.x*le.y;Tt+=(le.x+ve.x)*Ke,Nt+=(le.y+ve.y)*Ke,ht+=3*Ke}return new Ty(Tt/ht,Nt/ht,0,ct)}(u),st=K.length;for(;K.length;){let ct=K.pop();(ct.d>et.d||!et.d)&&(et=ct,f&&console.log("found best %d after %d probes",Math.round(1e4*ct.d)/1e4,st)),ct.max-et.d<=l||(Y=ct.h/2,K.push(new Ty(ct.p.x-Y,ct.p.y-Y,Y,u)),K.push(new Ty(ct.p.x+Y,ct.p.y-Y,Y,u)),K.push(new Ty(ct.p.x-Y,ct.p.y+Y,Y,u)),K.push(new Ty(ct.p.x+Y,ct.p.y+Y,Y,u)),st+=4)}return f&&(console.log(`num probes: ${st}`),console.log(`best distance: ${et.d}`)),et.p}function zft(u,l){return l.max-u.max}function Ty(u,l,f,x){this.p=new g(u,l),this.h=f,this.d=function(S,k){let D=!1,F=1/0;for(let j=0;j<k.length;j++){let Y=k[j];for(let K=0,et=Y.length,st=et-1;K<et;st=K++){let ct=Y[K],ht=Y[st];ct.y>S.y!=ht.y>S.y&&S.x<(ht.x-ct.x)*(S.y-ct.y)/(ht.y-ct.y)+ct.x&&(D=!D),F=Math.min(F,oi(S,ct,ht))}}return(D?1:-1)*Math.sqrt(F)}(this.p,x),this.max=this.d+this.h*Math.SQRT2}var Aa;n.aq=void 0,(Aa=n.aq||(n.aq={}))[Aa.center=1]="center",Aa[Aa.left=2]="left",Aa[Aa.right=3]="right",Aa[Aa.top=4]="top",Aa[Aa.bottom=5]="bottom",Aa[Aa["top-left"]=6]="top-left",Aa[Aa["top-right"]=7]="top-right",Aa[Aa["bottom-left"]=8]="bottom-left",Aa[Aa["bottom-right"]=9]="bottom-right";let bm=7,_R=Number.POSITIVE_INFINITY;function rV(u,l){return l[1]!==_R?function(f,x,S){let k=0,D=0;switch(x=Math.abs(x),S=Math.abs(S),f){case"top-right":case"top-left":case"top":D=S-bm;break;case"bottom-right":case"bottom-left":case"bottom":D=-S+bm}switch(f){case"top-right":case"bottom-right":case"right":k=-x;break;case"top-left":case"bottom-left":case"left":k=x}return[k,D]}(u,l[0],l[1]):function(f,x){let S=0,k=0;x<0&&(x=0);let D=x/Math.SQRT2;switch(f){case"top-right":case"top-left":k=D-bm;break;case"bottom-right":case"bottom-left":k=-D+bm;break;case"bottom":k=-x+bm;break;case"top":k=x-bm}switch(f){case"top-right":case"bottom-right":S=-D;break;case"top-left":case"bottom-left":S=D;break;case"left":S=x;break;case"right":S=-x}return[S,k]}(u,l[0])}function iV(u,l,f){var x;let S=u.layout,k=(x=S.get("text-variable-anchor-offset"))===null||x===void 0?void 0:x.evaluate(l,{},f);if(k){let F=k.values,j=[];for(let Y=0;Y<F.length;Y+=2){let K=j[Y]=F[Y],et=F[Y+1].map(st=>st*So);K.startsWith("top")?et[1]-=bm:K.startsWith("bottom")&&(et[1]+=bm),j[Y+1]=et}return new ca(j)}let D=S.get("text-variable-anchor");if(D){let F;F=u._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[S.get("text-radial-offset").evaluate(l,{},f)*So,_R]:S.get("text-offset").evaluate(l,{},f).map(Y=>Y*So);let j=[];for(let Y of D)j.push(Y,rV(Y,F));return new ca(j)}return null}function yR(u){switch(u){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Uft(u,l,f,x,S,k,D,F,j,Y,K){let et=k.textMaxSize.evaluate(l,{});et===void 0&&(et=D);let st=u.layers[0].layout,ct=st.get("icon-offset").evaluate(l,{},K),ht=sV(f.horizontal),Tt=D/24,Nt=u.tilePixelRatio*Tt,Ut=u.tilePixelRatio*et/24,Kt=u.tilePixelRatio*F,Ht=u.tilePixelRatio*st.get("symbol-spacing"),Jt=st.get("text-padding")*u.tilePixelRatio,le=function(Re,Pr,gr,Bi=1){let os=Re.get("icon-padding").evaluate(Pr,{},gr),ds=os&&os.values;return[ds[0]*Bi,ds[1]*Bi,ds[2]*Bi,ds[3]*Bi]}(st,l,K,u.tilePixelRatio),ve=st.get("text-max-angle")/180*Math.PI,Ke=st.get("text-rotation-alignment")!=="viewport"&&st.get("symbol-placement")!=="point",mr=st.get("icon-rotation-alignment")==="map"&&st.get("symbol-placement")!=="point",Qe=st.get("symbol-placement"),Ye=Ht/2,je=st.get("icon-text-fit"),or;x&&je!=="none"&&(u.allowVerticalPlacement&&f.vertical&&(or=IU(x,f.vertical,je,st.get("icon-text-fit-padding"),ct,Tt)),ht&&(x=IU(x,ht,je,st.get("icon-text-fit-padding"),ct,Tt)));let $e=(Re,Pr)=>{Pr.x<0||Pr.x>=Vs||Pr.y<0||Pr.y>=Vs||function(gr,Bi,os,ds,Eo,Ac,cl,uo,ta,ga,ul,hl,Io,Mo,Na,fl,La,zl,Ul,Co,Gi,Fa,_a,Po,Vu){let Wh=gr.addToLineVertexArray(Bi,os),$h,Ed,ju,ou,Vl=0,Id=0,ov=0,cV=0,IR=-1,MR=-1,Md={},uV=zu("");if(gr.allowVerticalPlacement&&ds.vertical){let za=uo.layout.get("text-rotate").evaluate(Gi,{},Po)+90;ju=new V4(ta,Bi,ga,ul,hl,ds.vertical,Io,Mo,Na,za),cl&&(ou=new V4(ta,Bi,ga,ul,hl,cl,La,zl,Na,za))}if(Eo){let za=uo.layout.get("icon-rotate").evaluate(Gi,{}),au=uo.layout.get("icon-text-fit")!=="none",wg=tV(Eo,za,_a,au),qh=cl?tV(cl,za,_a,au):void 0;Ed=new V4(ta,Bi,ga,ul,hl,Eo,La,zl,!1,za),Vl=4*wg.length;let Tg=gr.iconSizeData,Zf=null;Tg.kind==="source"?(Zf=[Xf*uo.layout.get("icon-size").evaluate(Gi,{})],Zf[0]>_m&&re(`${gr.layerIds[0]}: Value for "icon-size" is >= ${rv}. Reduce your "icon-size".`)):Tg.kind==="composite"&&(Zf=[Xf*Fa.compositeIconSizes[0].evaluate(Gi,{},Po),Xf*Fa.compositeIconSizes[1].evaluate(Gi,{},Po)],(Zf[0]>_m||Zf[1]>_m)&&re(`${gr.layerIds[0]}: Value for "icon-size" is >= ${rv}. Reduce your "icon-size".`)),gr.addSymbols(gr.icon,wg,Zf,Co,Ul,Gi,n.ai.none,Bi,Wh.lineStartIndex,Wh.lineLength,-1,Po),IR=gr.icon.placedSymbolArray.length-1,qh&&(Id=4*qh.length,gr.addSymbols(gr.icon,qh,Zf,Co,Ul,Gi,n.ai.vertical,Bi,Wh.lineStartIndex,Wh.lineLength,-1,Po),MR=gr.icon.placedSymbolArray.length-1)}let hV=Object.keys(ds.horizontal);for(let za of hV){let au=ds.horizontal[za];if(!$h){uV=zu(au.text);let qh=uo.layout.get("text-rotate").evaluate(Gi,{},Po);$h=new V4(ta,Bi,ga,ul,hl,au,Io,Mo,Na,qh)}let wg=au.positionedLines.length===1;if(ov+=nV(gr,Bi,au,Ac,uo,Na,Gi,fl,Wh,ds.vertical?n.ai.horizontal:n.ai.horizontalOnly,wg?hV:[za],Md,IR,Fa,Po),wg)break}ds.vertical&&(cV+=nV(gr,Bi,ds.vertical,Ac,uo,Na,Gi,fl,Wh,n.ai.vertical,["vertical"],Md,MR,Fa,Po));let Wft=$h?$h.boxStartIndex:gr.collisionBoxArray.length,$ft=$h?$h.boxEndIndex:gr.collisionBoxArray.length,Hft=ju?ju.boxStartIndex:gr.collisionBoxArray.length,qft=ju?ju.boxEndIndex:gr.collisionBoxArray.length,Yft=Ed?Ed.boxStartIndex:gr.collisionBoxArray.length,Xft=Ed?Ed.boxEndIndex:gr.collisionBoxArray.length,Zft=ou?ou.boxStartIndex:gr.collisionBoxArray.length,Gft=ou?ou.boxEndIndex:gr.collisionBoxArray.length,Hh=-1,W4=(za,au)=>za&&za.circleDiameter?Math.max(za.circleDiameter,au):au;Hh=W4($h,Hh),Hh=W4(ju,Hh),Hh=W4(Ed,Hh),Hh=W4(ou,Hh);let fV=Hh>-1?1:0;fV&&(Hh*=Vu/So),gr.glyphOffsetArray.length>=vy.MAX_GLYPHS&&re("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Gi.sortKey!==void 0&&gr.addToSortKeyRanges(gr.symbolInstances.length,Gi.sortKey);let Qft=iV(uo,Gi,Po),[Kft,Jft]=function(za,au){let wg=za.length,qh=au?.values;if(qh?.length>0)for(let Tg=0;Tg<qh.length;Tg+=2){let Zf=qh[Tg+1];za.emplaceBack(n.aq[qh[Tg]],Zf[0],Zf[1])}return[wg,za.length]}(gr.textAnchorOffsets,Qft);gr.symbolInstances.emplaceBack(Bi.x,Bi.y,Md.right>=0?Md.right:-1,Md.center>=0?Md.center:-1,Md.left>=0?Md.left:-1,Md.vertical||-1,IR,MR,uV,Wft,$ft,Hft,qft,Yft,Xft,Zft,Gft,ga,ov,cV,Vl,Id,fV,0,Io,Hh,Kft,Jft)}(u,Pr,Re,f,x,S,or,u.layers[0],u.collisionBoxArray,l.index,l.sourceLayerIndex,u.index,Nt,[Jt,Jt,Jt,Jt],Ke,j,Kt,le,mr,ct,l,k,Y,K,D)};if(Qe==="line")for(let Re of XU(l.geometry,0,0,Vs,Vs)){let Pr=Bft(Re,Ht,ve,f.vertical||ht,x,24,Ut,u.overscaling,Vs);for(let gr of Pr)ht&&Vft(u,ht.text,Ye,gr)||$e(Re,gr)}else if(Qe==="line-center"){for(let Re of l.geometry)if(Re.length>1){let Pr=Oft(Re,ve,f.vertical||ht,x,24,Ut);Pr&&$e(Re,Pr)}}else if(l.type==="Polygon")for(let Re of QP(l.geometry,0)){let Pr=Fft(Re,16);$e(Re[0],new xm(Pr.x,Pr.y,0))}else if(l.type==="LineString")for(let Re of l.geometry)$e(Re,new xm(Re[0].x,Re[0].y,0));else if(l.type==="Point")for(let Re of l.geometry)for(let Pr of Re)$e([Pr],new xm(Pr.x,Pr.y,0))}function nV(u,l,f,x,S,k,D,F,j,Y,K,et,st,ct,ht){let Tt=function(Kt,Ht,Jt,le,ve,Ke,mr,Qe){let Ye=le.layout.get("text-rotate").evaluate(Ke,{})*Math.PI/180,je=[];for(let or of Ht.positionedLines)for(let $e of or.positionedGlyphs){if(!$e.rect)continue;let Re=$e.rect||{},Pr=xU+1,gr=!0,Bi=1,os=0,ds=(ve||Qe)&&$e.vertical,Eo=$e.metrics.advance*$e.scale/2;if(Qe&&Ht.verticalizable&&(os=or.lineOffset/2-($e.imageName?-(So-$e.metrics.width*$e.scale)/2:($e.scale-1)*So)),$e.imageName){let Co=mr[$e.imageName];gr=Co.sdf,Bi=Co.pixelRatio,Pr=Fl/Bi}let Ac=ve?[$e.x+Eo,$e.y]:[0,0],cl=ve?[0,0]:[$e.x+Eo+Jt[0],$e.y+Jt[1]-os],uo=[0,0];ds&&(uo=cl,cl=[0,0]);let ta=$e.metrics.isDoubleResolution?2:1,ga=($e.metrics.left-Pr)*$e.scale-Eo+cl[0],ul=(-$e.metrics.top-Pr)*$e.scale+cl[1],hl=ga+Re.w/ta*$e.scale/Bi,Io=ul+Re.h/ta*$e.scale/Bi,Mo=new g(ga,ul),Na=new g(hl,ul),fl=new g(ga,Io),La=new g(hl,Io);if(ds){let Co=new g(-Eo,Eo-tv),Gi=-Math.PI/2,Fa=So/2-Eo,_a=new g(5-tv-Fa,-($e.imageName?Fa:0)),Po=new g(...uo);Mo._rotateAround(Gi,Co)._add(_a)._add(Po),Na._rotateAround(Gi,Co)._add(_a)._add(Po),fl._rotateAround(Gi,Co)._add(_a)._add(Po),La._rotateAround(Gi,Co)._add(_a)._add(Po)}if(Ye){let Co=Math.sin(Ye),Gi=Math.cos(Ye),Fa=[Gi,-Co,Co,Gi];Mo._matMult(Fa),Na._matMult(Fa),fl._matMult(Fa),La._matMult(Fa)}let zl=new g(0,0),Ul=new g(0,0);je.push({tl:Mo,tr:Na,bl:fl,br:La,tex:Re,writingMode:Ht.writingMode,glyphOffset:Ac,sectionIndex:$e.sectionIndex,isSDF:gr,pixelOffsetTL:zl,pixelOffsetBR:Ul,minFontScaleX:0,minFontScaleY:0})}return je}(0,f,F,S,k,D,x,u.allowVerticalPlacement),Nt=u.textSizeData,Ut=null;Nt.kind==="source"?(Ut=[Xf*S.layout.get("text-size").evaluate(D,{})],Ut[0]>_m&&re(`${u.layerIds[0]}: Value for "text-size" is >= ${rv}. Reduce your "text-size".`)):Nt.kind==="composite"&&(Ut=[Xf*ct.compositeTextSizes[0].evaluate(D,{},ht),Xf*ct.compositeTextSizes[1].evaluate(D,{},ht)],(Ut[0]>_m||Ut[1]>_m)&&re(`${u.layerIds[0]}: Value for "text-size" is >= ${rv}. Reduce your "text-size".`)),u.addSymbols(u.text,Tt,Ut,F,k,D,Y,l,j.lineStartIndex,j.lineLength,st,ht);for(let Kt of K)et[Kt]=u.text.placedSymbolArray.length-1;return 4*Tt.length}function sV(u){for(let l in u)return u[l];return null}function Vft(u,l,f,x){let S=u.compareText;if(l in S){let k=S[l];for(let D=k.length-1;D>=0;D--)if(x.dist(k[D])<f)return!0}else S[l]=[];return S[l].push(x),!1}let oV=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class xR{static from(l){if(!(l instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");let[f,x]=new Uint8Array(l,0,2);if(f!==219)throw new Error("Data does not appear to be in a KDBush format.");let S=x>>4;if(S!==1)throw new Error(`Got v${S} data when expected v1.`);let k=oV[15&x];if(!k)throw new Error("Unrecognized array type.");let[D]=new Uint16Array(l,2,1),[F]=new Uint32Array(l,4,1);return new xR(F,D,k,l)}constructor(l,f=64,x=Float64Array,S){if(isNaN(l)||l<0)throw new Error(`Unpexpected numItems value: ${l}.`);this.numItems=+l,this.nodeSize=Math.min(Math.max(+f,2),65535),this.ArrayType=x,this.IndexArrayType=l<65536?Uint16Array:Uint32Array;let k=oV.indexOf(this.ArrayType),D=2*l*this.ArrayType.BYTES_PER_ELEMENT,F=l*this.IndexArrayType.BYTES_PER_ELEMENT,j=(8-F%8)%8;if(k<0)throw new Error(`Unexpected typed array class: ${x}.`);S&&S instanceof ArrayBuffer?(this.data=S,this.ids=new this.IndexArrayType(this.data,8,l),this.coords=new this.ArrayType(this.data,8+F+j,2*l),this._pos=2*l,this._finished=!0):(this.data=new ArrayBuffer(8+D+F+j),this.ids=new this.IndexArrayType(this.data,8,l),this.coords=new this.ArrayType(this.data,8+F+j,2*l),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+k]),new Uint16Array(this.data,2,1)[0]=f,new Uint32Array(this.data,4,1)[0]=l)}add(l,f){let x=this._pos>>1;return this.ids[x]=x,this.coords[this._pos++]=l,this.coords[this._pos++]=f,x}finish(){let l=this._pos>>1;if(l!==this.numItems)throw new Error(`Added ${l} items when expected ${this.numItems}.`);return bR(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(l,f,x,S){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");let{ids:k,coords:D,nodeSize:F}=this,j=[0,k.length-1,0],Y=[];for(;j.length;){let K=j.pop()||0,et=j.pop()||0,st=j.pop()||0;if(et-st<=F){for(let Nt=st;Nt<=et;Nt++){let Ut=D[2*Nt],Kt=D[2*Nt+1];Ut>=l&&Ut<=x&&Kt>=f&&Kt<=S&&Y.push(k[Nt])}continue}let ct=st+et>>1,ht=D[2*ct],Tt=D[2*ct+1];ht>=l&&ht<=x&&Tt>=f&&Tt<=S&&Y.push(k[ct]),(K===0?l<=ht:f<=Tt)&&(j.push(st),j.push(ct-1),j.push(1-K)),(K===0?x>=ht:S>=Tt)&&(j.push(ct+1),j.push(et),j.push(1-K))}return Y}within(l,f,x){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");let{ids:S,coords:k,nodeSize:D}=this,F=[0,S.length-1,0],j=[],Y=x*x;for(;F.length;){let K=F.pop()||0,et=F.pop()||0,st=F.pop()||0;if(et-st<=D){for(let Nt=st;Nt<=et;Nt++)lV(k[2*Nt],k[2*Nt+1],l,f)<=Y&&j.push(S[Nt]);continue}let ct=st+et>>1,ht=k[2*ct],Tt=k[2*ct+1];lV(ht,Tt,l,f)<=Y&&j.push(S[ct]),(K===0?l-x<=ht:f-x<=Tt)&&(F.push(st),F.push(ct-1),F.push(1-K)),(K===0?l+x>=ht:f+x>=Tt)&&(F.push(ct+1),F.push(et),F.push(1-K))}return j}}function bR(u,l,f,x,S,k){if(S-x<=f)return;let D=x+S>>1;aV(u,l,D,x,S,k),bR(u,l,f,x,D-1,1-k),bR(u,l,f,D+1,S,1-k)}function aV(u,l,f,x,S,k){for(;S>x;){if(S-x>600){let Y=S-x+1,K=f-x+1,et=Math.log(Y),st=.5*Math.exp(2*et/3),ct=.5*Math.sqrt(et*st*(Y-st)/Y)*(K-Y/2<0?-1:1);aV(u,l,f,Math.max(x,Math.floor(f-K*st/Y+ct)),Math.min(S,Math.floor(f+(Y-K)*st/Y+ct)),k)}let D=l[2*f+k],F=x,j=S;for(nv(u,l,x,f),l[2*S+k]>D&&nv(u,l,x,S);F<j;){for(nv(u,l,F,j),F++,j--;l[2*F+k]<D;)F++;for(;l[2*j+k]>D;)j--}l[2*x+k]===D?nv(u,l,x,j):(j++,nv(u,l,j,S)),j<=f&&(x=j+1),f<=j&&(S=j-1)}}function nv(u,l,f,x){vR(u,f,x),vR(l,2*f,2*x),vR(l,2*f+1,2*x+1)}function vR(u,l,f){let x=u[l];u[l]=u[f],u[f]=x}function lV(u,l,f,x){let S=u-f,k=l-x;return S*S+k*k}var wR;n.bh=void 0,(wR=n.bh||(n.bh={})).create="create",wR.load="load",wR.fullLoad="fullLoad";let j4=null,sv=[],TR=1e3/60,SR="loadTime",ER="fullLoadTime",jft={mark(u){performance.mark(u)},frame(u){let l=u;j4!=null&&sv.push(l-j4),j4=l},clearMetrics(){j4=null,sv=[],performance.clearMeasures(SR),performance.clearMeasures(ER);for(let u in n.bh)performance.clearMarks(n.bh[u])},getPerformanceMetrics(){performance.measure(SR,n.bh.create,n.bh.load),performance.measure(ER,n.bh.create,n.bh.fullLoad);let u=performance.getEntriesByName(SR)[0].duration,l=performance.getEntriesByName(ER)[0].duration,f=sv.length,x=1/(sv.reduce((k,D)=>k+D,0)/f/1e3),S=sv.filter(k=>k>TR).reduce((k,D)=>k+(D-TR)/TR,0);return{loadTime:u,fullLoadTime:l,fps:x,percentDroppedFrames:S/(f+S)*100,totalFrames:f}}};n.$=function(u,l,f){var x,S,k,D,F,j,Y,K,et,st,ct,ht,Tt=f[0],Nt=f[1],Ut=f[2];return l===u?(u[12]=l[0]*Tt+l[4]*Nt+l[8]*Ut+l[12],u[13]=l[1]*Tt+l[5]*Nt+l[9]*Ut+l[13],u[14]=l[2]*Tt+l[6]*Nt+l[10]*Ut+l[14],u[15]=l[3]*Tt+l[7]*Nt+l[11]*Ut+l[15]):(S=l[1],k=l[2],D=l[3],F=l[4],j=l[5],Y=l[6],K=l[7],et=l[8],st=l[9],ct=l[10],ht=l[11],u[0]=x=l[0],u[1]=S,u[2]=k,u[3]=D,u[4]=F,u[5]=j,u[6]=Y,u[7]=K,u[8]=et,u[9]=st,u[10]=ct,u[11]=ht,u[12]=x*Tt+F*Nt+et*Ut+l[12],u[13]=S*Tt+j*Nt+st*Ut+l[13],u[14]=k*Tt+Y*Nt+ct*Ut+l[14],u[15]=D*Tt+K*Nt+ht*Ut+l[15]),u},n.A=wd,n.B=al,n.C=class{constructor(u,l,f){this.receive=x=>{let S=x.data,k=S.id;if(k&&(!S.targetMapId||this.mapId===S.targetMapId))if(S.type==="<cancel>"){delete this.tasks[k];let D=this.cancelCallbacks[k];delete this.cancelCallbacks[k],D&&D()}else Vt()||S.mustQueue?(this.tasks[k]=S,this.taskQueue.push(k),this.invoker.trigger()):this.processTask(k,S)},this.process=()=>{if(!this.taskQueue.length)return;let x=this.taskQueue.shift(),S=this.tasks[x];delete this.tasks[x],this.taskQueue.length&&this.invoker.trigger(),S&&this.processTask(x,S)},this.target=u,this.parent=l,this.mapId=f,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},this.invoker=new kft(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=Vt()?u:window}send(u,l,f,x,S=!1){let k=Math.round(1e18*Math.random()).toString(36).substring(0,10);f&&(this.callbacks[k]=f);let D=[],F={id:k,type:u,hasCallback:!!f,targetMapId:x,mustQueue:S,sourceMapId:this.mapId,data:ws(l,D)};return this.target.postMessage(F,{transfer:D}),{cancel:()=>{f&&delete this.callbacks[k],this.target.postMessage({id:k,type:"<cancel>",targetMapId:x,sourceMapId:this.mapId})}}}processTask(u,l){if(l.type==="<response>"){let f=this.callbacks[u];delete this.callbacks[u],f&&(l.error?f(Ou(l.error)):f(null,Ou(l.data)))}else{let f=!1,x=[],S=l.hasCallback?(F,j)=>{f=!0,delete this.cancelCallbacks[u];let Y={id:u,type:"<response>",sourceMapId:this.mapId,error:F?ws(F):null,data:ws(j,x)};this.target.postMessage(Y,{transfer:x})}:F=>{f=!0},k=null,D=Ou(l.data);if(this.parent[l.type])k=this.parent[l.type](l.sourceMapId,D,S);else if("getWorkerSource"in this.parent){let F=l.type.split(".");k=this.parent.getWorkerSource(l.sourceMapId,F[0],D.source)[F[1]](D,S)}else S(new Error(`Could not find function ${l.type}`));!f&&k&&k.cancel&&(this.cancelCallbacks[u]=k.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},n.D=ur,n.E=Er,n.F=function(u,l){let f={};for(let x=0;x<l.length;x++){let S=l[x];S in u&&(f[S]=u[S])}return f},n.G=NU,n.H=LU,n.I=aR,n.J=z,n.K=W,n.L=ym,n.M=Se,n.N=Vs,n.O=su,n.P=g,n.Q=Xn,n.R=R,n.S=Vn,n.T=uy,n.U=L4,n.V=class extends Fh{},n.W=gR,n.X=function(u,l){let f=window.document.createElement("video");f.muted=!0,f.onloadstart=function(){l(null,f)};for(let x=0;x<u.length;x++){let S=window.document.createElement("source");Ie(u[x])||(f.crossOrigin="Anonymous"),S.src=u[x],f.appendChild(S)}return{cancel:()=>{}}},n.Y=Ne,n.Z=function(){var u=new wd(16);return wd!=Float32Array&&(u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[11]=0,u[12]=0,u[13]=0,u[14]=0),u[0]=1,u[5]=1,u[10]=1,u[15]=1,u},n._=o,n.a=de,n.a$=class extends lt{},n.a0=function(u,l,f){var x=f[0],S=f[1],k=f[2];return u[0]=l[0]*x,u[1]=l[1]*x,u[2]=l[2]*x,u[3]=l[3]*x,u[4]=l[4]*S,u[5]=l[5]*S,u[6]=l[6]*S,u[7]=l[7]*S,u[8]=l[8]*k,u[9]=l[9]*k,u[10]=l[10]*k,u[11]=l[11]*k,u[12]=l[12],u[13]=l[13],u[14]=l[14],u[15]=l[15],u},n.a1=Ge,n.a2=function(){return Mt++},n.a3=Rt,n.a4=vy,n.a5=function(){ka.isLoading()||ka.isLoaded()||pg()!=="deferred"||cy()},n.a6=Gc,n.a7=Hf,n.a8=Yn,n.a9=$U,n.aA=yd,n.aB=function(u){u=u.slice();let l=Object.create(null);for(let f=0;f<u.length;f++)l[u[f].id]=u[f];for(let f=0;f<u.length;f++)"ref"in u[f]&&(u[f]=an(u[f],l[u[f].ref]));return u},n.aC=function(u){if(u.type==="custom")return new Rft(u);switch(u.type){case"background":return new Mft(u);case"circle":return new gy(u);case"fill":return new Dht(u);case"fill-extrusion":return new Xht(u);case"heatmap":return new N(u);case"hillshade":return new ot(u);case"line":return new rft(u);case"raster":return new Pft(u);case"symbol":return new N4(u)}},n.aD=vt,n.aE=function(u,l){if(!u)return[{command:$i.setStyle,args:[l]}];let f=[];try{if(!Ji(u.version,l.version))return[{command:$i.setStyle,args:[l]}];Ji(u.center,l.center)||f.push({command:$i.setCenter,args:[l.center]}),Ji(u.zoom,l.zoom)||f.push({command:$i.setZoom,args:[l.zoom]}),Ji(u.bearing,l.bearing)||f.push({command:$i.setBearing,args:[l.bearing]}),Ji(u.pitch,l.pitch)||f.push({command:$i.setPitch,args:[l.pitch]}),Ji(u.sprite,l.sprite)||f.push({command:$i.setSprite,args:[l.sprite]}),Ji(u.glyphs,l.glyphs)||f.push({command:$i.setGlyphs,args:[l.glyphs]}),Ji(u.transition,l.transition)||f.push({command:$i.setTransition,args:[l.transition]}),Ji(u.light,l.light)||f.push({command:$i.setLight,args:[l.light]});let x={},S=[];(function(D,F,j,Y){let K;for(K in F=F||{},D=D||{})Object.prototype.hasOwnProperty.call(D,K)&&(Object.prototype.hasOwnProperty.call(F,K)||Pu(K,j,Y));for(K in F)Object.prototype.hasOwnProperty.call(F,K)&&(Object.prototype.hasOwnProperty.call(D,K)?Ji(D[K],F[K])||(D[K].type==="geojson"&&F[K].type==="geojson"&&Zo(D,F,K)?j.push({command:$i.setGeoJSONSourceData,args:[K,F[K].data]}):Rl(K,F,j,Y)):zo(K,F,j))})(u.sources,l.sources,S,x);let k=[];u.layers&&u.layers.forEach(D=>{x[D.source]?f.push({command:$i.removeLayer,args:[D.id]}):k.push(D)}),f=f.concat(S),function(D,F,j){F=F||[];let Y=(D=D||[]).map(rl),K=F.map(rl),et=D.reduce(Go,{}),st=F.reduce(Go,{}),ct=Y.slice(),ht=Object.create(null),Tt,Nt,Ut,Kt,Ht,Jt,le;for(Tt=0,Nt=0;Tt<Y.length;Tt++)Ut=Y[Tt],Object.prototype.hasOwnProperty.call(st,Ut)?Nt++:(j.push({command:$i.removeLayer,args:[Ut]}),ct.splice(ct.indexOf(Ut,Nt),1));for(Tt=0,Nt=0;Tt<K.length;Tt++)Ut=K[K.length-1-Tt],ct[ct.length-1-Tt]!==Ut&&(Object.prototype.hasOwnProperty.call(et,Ut)?(j.push({command:$i.removeLayer,args:[Ut]}),ct.splice(ct.lastIndexOf(Ut,ct.length-Nt),1)):Nt++,Jt=ct[ct.length-Tt],j.push({command:$i.addLayer,args:[st[Ut],Jt]}),ct.splice(ct.length-Tt,0,Ut),ht[Ut]=!0);for(Tt=0;Tt<K.length;Tt++)if(Ut=K[Tt],Kt=et[Ut],Ht=st[Ut],!ht[Ut]&&!Ji(Kt,Ht))if(Ji(Kt.source,Ht.source)&&Ji(Kt["source-layer"],Ht["source-layer"])&&Ji(Kt.type,Ht.type)){for(le in kl(Kt.layout,Ht.layout,j,Ut,null,$i.setLayoutProperty),kl(Kt.paint,Ht.paint,j,Ut,null,$i.setPaintProperty),Ji(Kt.filter,Ht.filter)||j.push({command:$i.setFilter,args:[Ut,Ht.filter]}),Ji(Kt.minzoom,Ht.minzoom)&&Ji(Kt.maxzoom,Ht.maxzoom)||j.push({command:$i.setLayerZoomRange,args:[Ut,Ht.minzoom,Ht.maxzoom]}),Kt)Object.prototype.hasOwnProperty.call(Kt,le)&&le!=="layout"&&le!=="paint"&&le!=="filter"&&le!=="metadata"&&le!=="minzoom"&&le!=="maxzoom"&&(le.indexOf("paint.")===0?kl(Kt[le],Ht[le],j,Ut,le.slice(6),$i.setPaintProperty):Ji(Kt[le],Ht[le])||j.push({command:$i.setLayerProperty,args:[Ut,le,Ht[le]]}));for(le in Ht)Object.prototype.hasOwnProperty.call(Ht,le)&&!Object.prototype.hasOwnProperty.call(Kt,le)&&le!=="layout"&&le!=="paint"&&le!=="filter"&&le!=="metadata"&&le!=="minzoom"&&le!=="maxzoom"&&(le.indexOf("paint.")===0?kl(Kt[le],Ht[le],j,Ut,le.slice(6),$i.setPaintProperty):Ji(Kt[le],Ht[le])||j.push({command:$i.setLayerProperty,args:[Ut,le,Ht[le]]}))}else j.push({command:$i.removeLayer,args:[Ut]}),Jt=ct[ct.lastIndexOf(Ut)+1],j.push({command:$i.addLayer,args:[Ht,Jt]})}(k,l.layers,f)}catch(x){console.warn("Unable to compute style diff:",x),f=[{command:$i.setStyle,args:[l]}]}return f},n.aF=function(u){let l=[],f=u.id;return f===void 0&&l.push({message:`layers.${f}: missing required property "id"`}),u.render===void 0&&l.push({message:`layers.${f}: missing required method "render"`}),u.renderingMode&&u.renderingMode!=="2d"&&u.renderingMode!=="3d"&&l.push({message:`layers.${f}: property "renderingMode" must be either "2d" or "3d"`}),l},n.aG=function u(l,f){if(Array.isArray(l)){if(!Array.isArray(f)||l.length!==f.length)return!1;for(let x=0;x<l.length;x++)if(!u(l[x],f[x]))return!1;return!0}if(typeof l=="object"&&l!==null&&f!==null){if(typeof f!="object"||Object.keys(l).length!==Object.keys(f).length)return!1;for(let x in l)if(!u(l[x],f[x]))return!1;return!0}return l===f},n.aH=_t,n.aI=Et,n.aJ=Vf,n.aK=function(u){return u({pluginStatus:Qo,pluginURL:pc}),Vf.on("pluginStateChange",u),u},n.aL=class extends Uh{constructor(u,l){super(u,l),this.current=0}set(u){this.current!==u&&(this.current=u,this.gl.uniform1i(this.location,u))}},n.aM=fm,n.aN=class extends Uh{constructor(u,l){super(u,l),this.current=Wb}set(u){if(u[12]!==this.current[12]||u[0]!==this.current[0])return this.current=u,void this.gl.uniformMatrix4fv(this.location,!1,u);for(let l=1;l<16;l++)if(u[l]!==this.current[l]){this.current=u,this.gl.uniformMatrix4fv(this.location,!1,u);break}}},n.aO=py,n.aP=class extends Uh{constructor(u,l){super(u,l),this.current=[0,0,0]}set(u){u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]||(this.current=u,this.gl.uniform3f(this.location,u[0],u[1],u[2]))}},n.aQ=class extends Uh{constructor(u,l){super(u,l),this.current=[0,0]}set(u){u[0]===this.current[0]&&u[1]===this.current[1]||(this.current=u,this.gl.uniform2f(this.location,u[0],u[1]))}},n.aR=dy,n.aS=function(u,l,f,x,S,k,D){var F=1/(l-f),j=1/(x-S),Y=1/(k-D);return u[0]=-2*F,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=-2*j,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=2*Y,u[11]=0,u[12]=(l+f)*F,u[13]=(S+x)*j,u[14]=(D+k)*Y,u[15]=1,u},n.aT=Hi,n.aU=qb,n.aV=class extends w{},n.aW=oft,n.aX=class extends P{},n.aY=function(u){return u<=1?1:Math.pow(2,Math.ceil(Math.log(u)/Math.LN2))},n.aZ=O,n.a_=Le,n.aa=function(u){let l={};if(u.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(f,x,S,k)=>{let D=S||k;return l[x]=!D||D.toLowerCase(),""}),l["max-age"]){let f=parseInt(l["max-age"],10);isNaN(f)?delete l["max-age"]:l["max-age"]=f}return l},n.ab=function(u,l){let f=[];for(let x in u)x in l||f.push(x);return f},n.ac=function(u){if(qt==null){let l=u.navigator?u.navigator.userAgent:null;qt=!!u.safari||!(!l||!(/\b(iPad|iPhone|iPod)\b/.test(l)||l.match("Safari")&&!l.match("Chrome")))}return qt},n.ad=q,n.ae=function(u,l,f){var x=Math.sin(f),S=Math.cos(f),k=l[0],D=l[1],F=l[2],j=l[3],Y=l[4],K=l[5],et=l[6],st=l[7];return l!==u&&(u[8]=l[8],u[9]=l[9],u[10]=l[10],u[11]=l[11],u[12]=l[12],u[13]=l[13],u[14]=l[14],u[15]=l[15]),u[0]=k*S+Y*x,u[1]=D*S+K*x,u[2]=F*S+et*x,u[3]=j*S+st*x,u[4]=Y*S-k*x,u[5]=K*S-D*x,u[6]=et*S-F*x,u[7]=st*S-j*x,u},n.af=function(u){var l=new wd(16);return l[0]=u[0],l[1]=u[1],l[2]=u[2],l[3]=u[3],l[4]=u[4],l[5]=u[5],l[6]=u[6],l[7]=u[7],l[8]=u[8],l[9]=u[9],l[10]=u[10],l[11]=u[11],l[12]=u[12],l[13]=u[13],l[14]=u[14],l[15]=u[15],l},n.ag=Td,n.ah=function(u,l){let f=0,x=0;if(u.kind==="constant")x=u.layoutSize;else if(u.kind!=="source"){let{interpolationType:S,minZoom:k,maxZoom:D}=u,F=S?q(ll.interpolationFactor(S,l,k,D),0,1):0;u.kind==="camera"?x=al.number(u.minSize,u.maxSize,F):f=F}return{uSizeT:f,uSize:x}},n.aj=function(u,{uSize:l,uSizeT:f},{lowerSize:x,upperSize:S}){return u.kind==="source"?x/Xf:u.kind==="composite"?al.number(x/Xf,S/Xf,f):l},n.ak=hR,n.al=function(u,l,f,x){let S=l.y-u.y,k=l.x-u.x,D=x.y-f.y,F=x.x-f.x,j=D*k-F*S;if(j===0)return null;let Y=(F*(u.y-f.y)-D*(u.x-f.x))/j;return new g(u.x+Y*k,u.y+Y*S)},n.am=XU,n.an=M4,n.ao=De,n.ap=So,n.ar=uR,n.as=function(u,l){var f=l[0],x=l[1],S=l[2],k=l[3],D=l[4],F=l[5],j=l[6],Y=l[7],K=l[8],et=l[9],st=l[10],ct=l[11],ht=l[12],Tt=l[13],Nt=l[14],Ut=l[15],Kt=f*F-x*D,Ht=f*j-S*D,Jt=f*Y-k*D,le=x*j-S*F,ve=x*Y-k*F,Ke=S*Y-k*j,mr=K*Tt-et*ht,Qe=K*Nt-st*ht,Ye=K*Ut-ct*ht,je=et*Nt-st*Tt,or=et*Ut-ct*Tt,$e=st*Ut-ct*Nt,Re=Kt*$e-Ht*or+Jt*je+le*Ye-ve*Qe+Ke*mr;return Re?(u[0]=(F*$e-j*or+Y*je)*(Re=1/Re),u[1]=(S*or-x*$e-k*je)*Re,u[2]=(Tt*Ke-Nt*ve+Ut*le)*Re,u[3]=(st*ve-et*Ke-ct*le)*Re,u[4]=(j*Ye-D*$e-Y*Qe)*Re,u[5]=(f*$e-S*Ye+k*Qe)*Re,u[6]=(Nt*Jt-ht*Ke-Ut*Ht)*Re,u[7]=(K*Ke-st*Jt+ct*Ht)*Re,u[8]=(D*or-F*Ye+Y*mr)*Re,u[9]=(x*Ye-f*or-k*mr)*Re,u[10]=(ht*ve-Tt*Jt+Ut*Kt)*Re,u[11]=(et*Jt-K*ve-ct*Kt)*Re,u[12]=(F*Qe-D*je-j*mr)*Re,u[13]=(f*je-x*Qe+S*mr)*Re,u[14]=(Tt*Ht-ht*le-Nt*Kt)*Re,u[15]=(K*le-et*Ht+st*Kt)*Re,u):null},n.at=yR,n.au=cR,n.av=xR,n.aw=function(){let u={},l=ae.$version;for(let f in ae.$root){let x=ae.$root[f];if(x.required){let S=null;S=f==="version"?l:x.type==="array"?[]:{},S!=null&&(u[f]=S)}}return u},n.ax=$i,n.ay=lg,n.az=zr,n.b=function(u,l){let f=new Blob([new Uint8Array(u)],{type:"image/png"});createImageBitmap(f).then(x=>{l(null,x)}).catch(x=>{l(new Error(`Could not load image because of ${x.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})},n.b0=vo,n.b1=function(u,l){var f=u[0],x=u[1],S=u[2],k=u[3],D=u[4],F=u[5],j=u[6],Y=u[7],K=u[8],et=u[9],st=u[10],ct=u[11],ht=u[12],Tt=u[13],Nt=u[14],Ut=u[15],Kt=l[0],Ht=l[1],Jt=l[2],le=l[3],ve=l[4],Ke=l[5],mr=l[6],Qe=l[7],Ye=l[8],je=l[9],or=l[10],$e=l[11],Re=l[12],Pr=l[13],gr=l[14],Bi=l[15];return Math.abs(f-Kt)<=Ks*Math.max(1,Math.abs(f),Math.abs(Kt))&&Math.abs(x-Ht)<=Ks*Math.max(1,Math.abs(x),Math.abs(Ht))&&Math.abs(S-Jt)<=Ks*Math.max(1,Math.abs(S),Math.abs(Jt))&&Math.abs(k-le)<=Ks*Math.max(1,Math.abs(k),Math.abs(le))&&Math.abs(D-ve)<=Ks*Math.max(1,Math.abs(D),Math.abs(ve))&&Math.abs(F-Ke)<=Ks*Math.max(1,Math.abs(F),Math.abs(Ke))&&Math.abs(j-mr)<=Ks*Math.max(1,Math.abs(j),Math.abs(mr))&&Math.abs(Y-Qe)<=Ks*Math.max(1,Math.abs(Y),Math.abs(Qe))&&Math.abs(K-Ye)<=Ks*Math.max(1,Math.abs(K),Math.abs(Ye))&&Math.abs(et-je)<=Ks*Math.max(1,Math.abs(et),Math.abs(je))&&Math.abs(st-or)<=Ks*Math.max(1,Math.abs(st),Math.abs(or))&&Math.abs(ct-$e)<=Ks*Math.max(1,Math.abs(ct),Math.abs($e))&&Math.abs(ht-Re)<=Ks*Math.max(1,Math.abs(ht),Math.abs(Re))&&Math.abs(Tt-Pr)<=Ks*Math.max(1,Math.abs(Tt),Math.abs(Pr))&&Math.abs(Nt-gr)<=Ks*Math.max(1,Math.abs(Nt),Math.abs(gr))&&Math.abs(Ut-Bi)<=Ks*Math.max(1,Math.abs(Ut),Math.abs(Bi))},n.b2=function(u,l){return u[0]=l[0],u[1]=l[1],u[2]=l[2],u[3]=l[3],u[4]=l[4],u[5]=l[5],u[6]=l[6],u[7]=l[7],u[8]=l[8],u[9]=l[9],u[10]=l[10],u[11]=l[11],u[12]=l[12],u[13]=l[13],u[14]=l[14],u[15]=l[15],u},n.b3=function(u,l,f){return u[0]=l[0]*f[0],u[1]=l[1]*f[1],u[2]=l[2]*f[2],u[3]=l[3]*f[3],u},n.b4=function(u,l){return u[0]*l[0]+u[1]*l[1]+u[2]*l[2]+u[3]*l[3]},n.b5=it,n.b6=VU,n.b7=FU,n.b8=function(u,l,f,x,S){var k,D=1/Math.tan(l/2);return u[0]=D/f,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=D,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[11]=-1,u[12]=0,u[13]=0,u[15]=0,S!=null&&S!==1/0?(u[10]=(S+x)*(k=1/(x-S)),u[14]=2*S*x*k):(u[10]=-1,u[14]=-2*x),u},n.b9=function(u,l,f){var x=Math.sin(f),S=Math.cos(f),k=l[4],D=l[5],F=l[6],j=l[7],Y=l[8],K=l[9],et=l[10],st=l[11];return l!==u&&(u[0]=l[0],u[1]=l[1],u[2]=l[2],u[3]=l[3],u[12]=l[12],u[13]=l[13],u[14]=l[14],u[15]=l[15]),u[4]=k*S+Y*x,u[5]=D*S+K*x,u[6]=F*S+et*x,u[7]=j*S+st*x,u[8]=Y*S-k*x,u[9]=K*S-D*x,u[10]=et*S-F*x,u[11]=st*S-j*x,u},n.bA=h,n.bB=pU,n.bC=tm,n.bD=ka,n.ba=Z,n.bb=X,n.bc=function(u,l){return u[0]=l[0],u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=l[1],u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=l[2],u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u},n.bd=class extends vd{},n.be=mR,n.bf=zU,n.bg=jft,n.bi=Kr,n.bj=function(u,l,f=!1){if(Qo===Uf||Qo===eu||Qo===fc)throw new Error("setRTLTextPlugin cannot be called multiple times.");pc=yi.resolveURL(u),Qo=Uf,lm=l,fg(),f||cy()},n.bk=pg,n.bl=function(u,l){let f={};for(let S=0;S<u.length;S++){let k=l&&l[u[S].id]||pt(u[S]);l&&(l[u[S].id]=k);let D=f[k];D||(D=f[k]=[]),D.push(u[S])}let x=[];for(let S in f)x.push(f[S]);return x},n.bm=Ve,n.bn=WU,n.bo=HU,n.bp=vU,n.bq=function(u){u.bucket.createArrays(),u.bucket.tilePixelRatio=Vs/(512*u.bucket.overscaling),u.bucket.compareText={},u.bucket.iconsNeedLinear=!1;let l=u.bucket.layers[0],f=l.layout,x=l._unevaluatedLayout._values,S={layoutIconSize:x["icon-size"].possiblyEvaluate(new Yn(u.bucket.zoom+1),u.canonical),layoutTextSize:x["text-size"].possiblyEvaluate(new Yn(u.bucket.zoom+1),u.canonical),textMaxSize:x["text-size"].possiblyEvaluate(new Yn(18))};if(u.bucket.textSizeData.kind==="composite"){let{minZoom:Y,maxZoom:K}=u.bucket.textSizeData;S.compositeTextSizes=[x["text-size"].possiblyEvaluate(new Yn(Y),u.canonical),x["text-size"].possiblyEvaluate(new Yn(K),u.canonical)]}if(u.bucket.iconSizeData.kind==="composite"){let{minZoom:Y,maxZoom:K}=u.bucket.iconSizeData;S.compositeIconSizes=[x["icon-size"].possiblyEvaluate(new Yn(Y),u.canonical),x["icon-size"].possiblyEvaluate(new Yn(K),u.canonical)]}let k=f.get("text-line-height")*So,D=f.get("text-rotation-alignment")!=="viewport"&&f.get("symbol-placement")!=="point",F=f.get("text-keep-upright"),j=f.get("text-size");for(let Y of u.bucket.features){let K=f.get("text-font").evaluate(Y,{},u.canonical).join(","),et=j.evaluate(Y,{},u.canonical),st=S.layoutTextSize.evaluate(Y,{},u.canonical),ct=S.layoutIconSize.evaluate(Y,{},u.canonical),ht={horizontal:{},vertical:void 0},Tt=Y.text,Nt,Ut=[0,0];if(Tt){let Jt=Tt.toString(),le=f.get("text-letter-spacing").evaluate(Y,{},u.canonical)*So,ve=ug(Jt)?le:0,Ke=f.get("text-anchor").evaluate(Y,{},u.canonical),mr=iV(l,Y,u.canonical);if(!mr){let $e=f.get("text-radial-offset").evaluate(Y,{},u.canonical);Ut=$e?rV(Ke,[$e*So,_R]):f.get("text-offset").evaluate(Y,{},u.canonical).map(Re=>Re*So)}let Qe=D?"center":f.get("text-justify").evaluate(Y,{},u.canonical),Ye=f.get("symbol-placement"),je=Ye==="point"?f.get("text-max-width").evaluate(Y,{},u.canonical)*So:0,or=()=>{u.bucket.allowVerticalPlacement&&cg(Jt)&&(ht.vertical=D4(Tt,u.glyphMap,u.glyphPositions,u.imagePositions,K,je,k,Ke,"left",ve,Ut,n.ai.vertical,!0,Ye,st,et))};if(!D&&mr){let $e=new Set;if(Qe==="auto")for(let Pr=0;Pr<mr.values.length;Pr+=2)$e.add(yR(mr.values[Pr]));else $e.add(Qe);let Re=!1;for(let Pr of $e)if(!ht.horizontal[Pr])if(Re)ht.horizontal[Pr]=ht.horizontal[0];else{let gr=D4(Tt,u.glyphMap,u.glyphPositions,u.imagePositions,K,je,k,"center",Pr,ve,Ut,n.ai.horizontal,!1,Ye,st,et);gr&&(ht.horizontal[Pr]=gr,Re=gr.positionedLines.length===1)}or()}else{Qe==="auto"&&(Qe=yR(Ke));let $e=D4(Tt,u.glyphMap,u.glyphPositions,u.imagePositions,K,je,k,Ke,Qe,ve,Ut,n.ai.horizontal,!1,Ye,st,et);$e&&(ht.horizontal[Qe]=$e),or(),cg(Jt)&&D&&F&&(ht.vertical=D4(Tt,u.glyphMap,u.glyphPositions,u.imagePositions,K,je,k,Ke,Qe,ve,Ut,n.ai.vertical,!1,Ye,st,et))}}let Kt=!1;if(Y.icon&&Y.icon.name){let Jt=u.imageMap[Y.icon.name];Jt&&(Nt=wft(u.imagePositions[Y.icon.name],f.get("icon-offset").evaluate(Y,{},u.canonical),f.get("icon-anchor").evaluate(Y,{},u.canonical)),Kt=!!Jt.sdf,u.bucket.sdfIcons===void 0?u.bucket.sdfIcons=Kt:u.bucket.sdfIcons!==Kt&&re("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Jt.pixelRatio!==u.bucket.pixelRatio||f.get("icon-rotate").constantOr(1)!==0)&&(u.bucket.iconsNeedLinear=!0))}let Ht=sV(ht.horizontal)||ht.vertical;u.bucket.iconsInText=!!Ht&&Ht.iconsInText,(Ht||Nt)&&Uft(u.bucket,Y,ht,Nt,u.imageMap,S,st,ct,Ut,Kt,u.canonical)}u.showCollisionBoxes&&u.bucket.generateCollisionDebugBuffers()},n.br=iR,n.bs=tR,n.bt=rR,n.bu=class{constructor(u){this._marks={start:[u.url,"start"].join("#"),end:[u.url,"end"].join("#"),measure:u.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let u=performance.getEntriesByName(this._marks.measure);return u.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),u=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),u}},n.bv=sR,n.bw=Am,n.bx=function(u,l,f,x,S){return o(this,void 0,void 0,function*(){if(W())try{return yield Se(u,l,f,x,S)}catch{}return function(k,D,F,j,Y){let K=k.width,et=k.height;ze&&ke||(ze=new OffscreenCanvas(K,et),ke=ze.getContext("2d",{willReadFrequently:!0})),ze.width=K,ze.height=et,ke.drawImage(k,0,0,K,et);let st=ke.getImageData(D,F,j,Y);return ke.clearRect(0,0,K,et),st.data}(u,l,f,x,S)})},n.by=jU,n.bz=a,n.c=hi,n.d=function(u,l){let f=new Image;f.onload=()=>{l(null,f),URL.revokeObjectURL(f.src),f.onload=null,window.requestAnimationFrame(()=>{f.src=Ee})},f.onerror=()=>l(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));let x=new Blob([new Uint8Array(u)],{type:"image/png"});f.src=u.byteLength?URL.createObjectURL(x):Ee},n.e=nt,n.f=function(u,l){return Sr(nt(u,{type:"json"}),l)},n.g=Br,n.h=yi,n.i=Vt,n.j=fn,n.k=rn,n.l=$r,n.m=Sr,n.n=function(u){return new sR(u).readFields(gft,[])},n.o=function(u,l,f){if(!u.length)return f(null,[]);let x=u.length,S=new Array(u.length),k=null;u.forEach((D,F)=>{l(D,(j,Y)=>{j&&(k=j),S[F]=Y,--x==0&&f(k,S)})})},n.p=bU,n.q=I,n.r=Ds,n.s=Ie,n.t=ay,n.u=qe,n.v=ae,n.w=re,n.x=om,n.y=Jc,n.z=function([u,l,f]){return l+=90,l*=Math.PI/180,f*=Math.PI/180,{x:u*Math.cos(l)*Math.sin(f),y:u*Math.sin(l)*Math.sin(f),z:u*Math.cos(f)}}}),i(["./shared"],function(n){"use strict";class o{constructor(rt){this.keyCache={},rt&&this.replace(rt)}replace(rt){this._layerConfigs={},this._layers={},this.update(rt,[])}update(rt,at){for(let Dt of rt){this._layerConfigs[Dt.id]=Dt;let Ot=this._layers[Dt.id]=n.aC(Dt);Ot._featureFilter=n.a6(Ot.filter),this.keyCache[Dt.id]&&delete this.keyCache[Dt.id]}for(let Dt of at)delete this.keyCache[Dt],delete this._layerConfigs[Dt],delete this._layers[Dt];this.familiesBySource={};let mt=n.bl(Object.values(this._layerConfigs),this.keyCache);for(let Dt of mt){let Ot=Dt.map(ye=>this._layers[ye.id]),It=Ot[0];if(It.visibility==="none")continue;let Yt=It.source||"",Ft=this.familiesBySource[Yt];Ft||(Ft=this.familiesBySource[Yt]={});let Qt=It.sourceLayer||"_geojsonTileLayer",_e=Ft[Qt];_e||(_e=Ft[Qt]=[]),_e.push(Ot)}}}class a{constructor(rt){let at={},mt=[];for(let Yt in rt){let Ft=rt[Yt],Qt=at[Yt]={};for(let _e in Ft){let ye=Ft[+_e];if(!ye||ye.bitmap.width===0||ye.bitmap.height===0)continue;let be={x:0,y:0,w:ye.bitmap.width+2,h:ye.bitmap.height+2};mt.push(be),Qt[_e]={rect:be,metrics:ye.metrics}}}let{w:Dt,h:Ot}=n.p(mt),It=new n.q({width:Dt||1,height:Ot||1});for(let Yt in rt){let Ft=rt[Yt];for(let Qt in Ft){let _e=Ft[+Qt];if(!_e||_e.bitmap.width===0||_e.bitmap.height===0)continue;let ye=at[Yt][Qt].rect;n.q.copy(_e.bitmap,It,{x:0,y:0},{x:ye.x+1,y:ye.y+1},_e.bitmap)}}this.image=It,this.positions=at}}n.bm("GlyphAtlas",a);class h{constructor(rt){this.tileID=new n.O(rt.tileID.overscaledZ,rt.tileID.wrap,rt.tileID.canonical.z,rt.tileID.canonical.x,rt.tileID.canonical.y),this.uid=rt.uid,this.zoom=rt.zoom,this.pixelRatio=rt.pixelRatio,this.tileSize=rt.tileSize,this.source=rt.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=rt.showCollisionBoxes,this.collectResourceTiming=!!rt.collectResourceTiming,this.returnDependencies=!!rt.returnDependencies,this.promoteId=rt.promoteId,this.inFlightDependencies=[],this.dependencySentinel=-1}parse(rt,at,mt,Dt,Ot){this.status="parsing",this.data=rt,this.collisionBoxArray=new n.a3;let It=new n.bn(Object.keys(rt.layers).sort()),Yt=new n.bo(this.tileID,this.promoteId);Yt.bucketLayerIDs=[];let Ft={},Qt={featureIndex:Yt,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:mt},_e=at.familiesBySource[this.source];for(let Vi in _e){let Ai=rt.layers[Vi];if(!Ai)continue;Ai.version===1&&n.w(`Vector tile source "${this.source}" layer "${Vi}" does not use vector tile spec v2 and therefore may have some rendering errors.`);let Ps=It.encode(Vi),pn=[];for(let ns=0;ns<Ai.length;ns++){let zs=Ai.feature(ns),Ca=Yt.getId(zs,Vi);pn.push({feature:zs,id:Ca,index:ns,sourceLayerIndex:Ps})}for(let ns of _e[Vi]){let zs=ns[0];zs.source!==this.source&&n.w(`layer.source = ${zs.source} does not equal this.source = ${this.source}`),zs.minzoom&&this.zoom<Math.floor(zs.minzoom)||zs.maxzoom&&this.zoom>=zs.maxzoom||zs.visibility!=="none"&&(p(ns,this.zoom,mt),(Ft[zs.id]=zs.createBucket({index:Yt.bucketLayerIDs.length,layers:ns,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Ps,sourceID:this.source})).populate(pn,Qt,this.tileID.canonical),Yt.bucketLayerIDs.push(ns.map(Ca=>Ca.id)))}}let ye,be,br,Lr,cr=n.aH(Qt.glyphDependencies,Vi=>Object.keys(Vi).map(Number));this.inFlightDependencies.forEach(Vi=>Vi?.cancel()),this.inFlightDependencies=[];let vr=++this.dependencySentinel;Object.keys(cr).length?this.inFlightDependencies.push(Dt.send("getGlyphs",{uid:this.uid,stacks:cr,source:this.source,tileID:this.tileID,type:"glyphs"},(Vi,Ai)=>{vr===this.dependencySentinel&&(ye||(ye=Vi,be=Ai,yn.call(this)))})):be={};let jr=Object.keys(Qt.iconDependencies);jr.length?this.inFlightDependencies.push(Dt.send("getImages",{icons:jr,source:this.source,tileID:this.tileID,type:"icons"},(Vi,Ai)=>{vr===this.dependencySentinel&&(ye||(ye=Vi,br=Ai,yn.call(this)))})):br={};let ln=Object.keys(Qt.patternDependencies);function yn(){if(ye)return Ot(ye);if(be&&br&&Lr){let Vi=new a(be),Ai=new n.bp(br,Lr);for(let Ps in Ft){let pn=Ft[Ps];pn instanceof n.a4?(p(pn.layers,this.zoom,mt),n.bq({bucket:pn,glyphMap:be,glyphPositions:Vi.positions,imageMap:br,imagePositions:Ai.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):pn.hasPattern&&(pn instanceof n.br||pn instanceof n.bs||pn instanceof n.bt)&&(p(pn.layers,this.zoom,mt),pn.addFeatures(Qt,this.tileID.canonical,Ai.patternPositions))}this.status="done",Ot(null,{buckets:Object.values(Ft).filter(Ps=>!Ps.isEmpty()),featureIndex:Yt,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Vi.image,imageAtlas:Ai,glyphMap:this.returnDependencies?be:null,iconMap:this.returnDependencies?br:null,glyphPositions:this.returnDependencies?Vi.positions:null})}}ln.length?this.inFlightDependencies.push(Dt.send("getImages",{icons:ln,source:this.source,tileID:this.tileID,type:"patterns"},(Vi,Ai)=>{vr===this.dependencySentinel&&(ye||(ye=Vi,Lr=Ai,yn.call(this)))})):Lr={},yn.call(this)}}function p(Ct,rt,at){let mt=new n.a8(rt);for(let Dt of Ct)Dt.recalculate(mt,at)}function g(Ct,rt){let at=n.l(Ct.request,(mt,Dt,Ot,It)=>{if(mt)rt(mt);else if(Dt)try{let Yt=new n.bw.VectorTile(new n.bv(Dt));rt(null,{vectorTile:Yt,rawData:Dt,cacheControl:Ot,expires:It})}catch(Yt){let Ft=new Uint8Array(Dt),Qt=`Unable to parse the tile at ${Ct.request.url}, `;Qt+=Ft[0]===31&&Ft[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${Yt.messge}`,rt(new Error(Qt))}});return()=>{at.cancel(),rt()}}class v{constructor(rt,at,mt,Dt){this.actor=rt,this.layerIndex=at,this.availableImages=mt,this.loadVectorData=Dt||g,this.fetching={},this.loading={},this.loaded={}}loadTile(rt,at){let mt=rt.uid;this.loading||(this.loading={});let Dt=!!(rt&&rt.request&&rt.request.collectResourceTiming)&&new n.bu(rt.request),Ot=this.loading[mt]=new h(rt);Ot.abort=this.loadVectorData(rt,(It,Yt)=>{if(delete this.loading[mt],It||!Yt)return Ot.status="done",this.loaded[mt]=Ot,at(It);let Ft=Yt.rawData,Qt={};Yt.expires&&(Qt.expires=Yt.expires),Yt.cacheControl&&(Qt.cacheControl=Yt.cacheControl);let _e={};if(Dt){let ye=Dt.finish();ye&&(_e.resourceTiming=JSON.parse(JSON.stringify(ye)))}Ot.vectorTile=Yt.vectorTile,Ot.parse(Yt.vectorTile,this.layerIndex,this.availableImages,this.actor,(ye,be)=>{if(delete this.fetching[mt],ye||!be)return at(ye);at(null,n.e({rawTileData:Ft.slice(0)},be,Qt,_e))}),this.loaded=this.loaded||{},this.loaded[mt]=Ot,this.fetching[mt]={rawTileData:Ft,cacheControl:Qt,resourceTiming:_e}})}reloadTile(rt,at){let mt=this.loaded,Dt=rt.uid;if(mt&&mt[Dt]){let Ot=mt[Dt];Ot.showCollisionBoxes=rt.showCollisionBoxes,Ot.status==="parsing"?Ot.parse(Ot.vectorTile,this.layerIndex,this.availableImages,this.actor,(It,Yt)=>{if(It||!Yt)return at(It,Yt);let Ft;if(this.fetching[Dt]){let{rawTileData:Qt,cacheControl:_e,resourceTiming:ye}=this.fetching[Dt];delete this.fetching[Dt],Ft=n.e({rawTileData:Qt.slice(0)},Yt,_e,ye)}else Ft=Yt;at(null,Ft)}):Ot.status==="done"&&(Ot.vectorTile?Ot.parse(Ot.vectorTile,this.layerIndex,this.availableImages,this.actor,at):at())}}abortTile(rt,at){let mt=this.loading,Dt=rt.uid;mt&&mt[Dt]&&mt[Dt].abort&&(mt[Dt].abort(),delete mt[Dt]),at()}removeTile(rt,at){let mt=this.loaded,Dt=rt.uid;mt&&mt[Dt]&&delete mt[Dt],at()}}class T{constructor(){this.loaded={}}loadTile(rt,at){return n._(this,void 0,void 0,function*(){let{uid:mt,encoding:Dt,rawImageData:Ot,redFactor:It,greenFactor:Yt,blueFactor:Ft,baseShift:Qt}=rt,_e=Ot.width+2,ye=Ot.height+2,be=n.a(Ot)?new n.R({width:_e,height:ye},yield n.bx(Ot,-1,-1,_e,ye)):Ot,br=new n.by(mt,be,Dt,It,Yt,Ft,Qt);this.loaded=this.loaded||{},this.loaded[mt]=br,at(null,br)})}removeTile(rt){let at=this.loaded,mt=rt.uid;at&&at[mt]&&delete at[mt]}}function C(Ct,rt){if(Ct.length!==0){B(Ct[0],rt);for(var at=1;at<Ct.length;at++)B(Ct[at],!rt)}}function B(Ct,rt){for(var at=0,mt=0,Dt=0,Ot=Ct.length,It=Ot-1;Dt<Ot;It=Dt++){var Yt=(Ct[Dt][0]-Ct[It][0])*(Ct[It][1]+Ct[Dt][1]),Ft=at+Yt;mt+=Math.abs(at)>=Math.abs(Yt)?at-Ft+Yt:Yt-Ft+at,at=Ft}at+mt>=0!=!!rt&&Ct.reverse()}var L=n.bz(function Ct(rt,at){var mt,Dt=rt&&rt.type;if(Dt==="FeatureCollection")for(mt=0;mt<rt.features.length;mt++)Ct(rt.features[mt],at);else if(Dt==="GeometryCollection")for(mt=0;mt<rt.geometries.length;mt++)Ct(rt.geometries[mt],at);else if(Dt==="Feature")Ct(rt.geometry,at);else if(Dt==="Polygon")C(rt.coordinates,at);else if(Dt==="MultiPolygon")for(mt=0;mt<rt.coordinates.length;mt++)C(rt.coordinates[mt],at);return rt});let z=n.bw.VectorTileFeature.prototype.toGeoJSON;var W={exports:{}},Z=n.bA,X=n.bw.VectorTileFeature,q=it;function it(Ct,rt){this.options=rt||{},this.features=Ct,this.length=Ct.length}function nt(Ct,rt){this.id=typeof Ct.id=="number"?Ct.id:void 0,this.type=Ct.type,this.rawGeometry=Ct.type===1?[Ct.geometry]:Ct.geometry,this.properties=Ct.tags,this.extent=rt||4096}it.prototype.feature=function(Ct){return new nt(this.features[Ct],this.options.extent)},nt.prototype.loadGeometry=function(){var Ct=this.rawGeometry;this.geometry=[];for(var rt=0;rt<Ct.length;rt++){for(var at=Ct[rt],mt=[],Dt=0;Dt<at.length;Dt++)mt.push(new Z(at[Dt][0],at[Dt][1]));this.geometry.push(mt)}return this.geometry},nt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Ct=this.geometry,rt=1/0,at=-1/0,mt=1/0,Dt=-1/0,Ot=0;Ot<Ct.length;Ot++)for(var It=Ct[Ot],Yt=0;Yt<It.length;Yt++){var Ft=It[Yt];rt=Math.min(rt,Ft.x),at=Math.max(at,Ft.x),mt=Math.min(mt,Ft.y),Dt=Math.max(Dt,Ft.y)}return[rt,mt,at,Dt]},nt.prototype.toGeoJSON=X.prototype.toGeoJSON;var Mt=n.bB,_t=q;function Et(Ct){var rt=new Mt;return function(at,mt){for(var Dt in at.layers)mt.writeMessage(3,vt,at.layers[Dt])}(Ct,rt),rt.finish()}function vt(Ct,rt){var at;rt.writeVarintField(15,Ct.version||1),rt.writeStringField(1,Ct.name||""),rt.writeVarintField(5,Ct.extent||4096);var mt={keys:[],values:[],keycache:{},valuecache:{}};for(at=0;at<Ct.length;at++)mt.feature=Ct.feature(at),rt.writeMessage(2,Pt,mt);var Dt=mt.keys;for(at=0;at<Dt.length;at++)rt.writeStringField(3,Dt[at]);var Ot=mt.values;for(at=0;at<Ot.length;at++)rt.writeMessage(4,qt,Ot[at])}function Pt(Ct,rt){var at=Ct.feature;at.id!==void 0&&rt.writeVarintField(1,at.id),rt.writeMessage(2,re,Ct),rt.writeVarintField(3,at.type),rt.writeMessage(4,Vt,at)}function re(Ct,rt){var at=Ct.feature,mt=Ct.keys,Dt=Ct.values,Ot=Ct.keycache,It=Ct.valuecache;for(var Yt in at.properties){var Ft=at.properties[Yt],Qt=Ot[Yt];if(Ft!==null){Qt===void 0&&(mt.push(Yt),Ot[Yt]=Qt=mt.length-1),rt.writeVarint(Qt);var _e=typeof Ft;_e!=="string"&&_e!=="boolean"&&_e!=="number"&&(Ft=JSON.stringify(Ft));var ye=_e+":"+Ft,be=It[ye];be===void 0&&(Dt.push(Ft),It[ye]=be=Dt.length-1),rt.writeVarint(be)}}}function $t(Ct,rt){return(rt<<3)+(7&Ct)}function xt(Ct){return Ct<<1^Ct>>31}function Vt(Ct,rt){for(var at=Ct.loadGeometry(),mt=Ct.type,Dt=0,Ot=0,It=at.length,Yt=0;Yt<It;Yt++){var Ft=at[Yt],Qt=1;mt===1&&(Qt=Ft.length),rt.writeVarint($t(1,Qt));for(var _e=mt===3?Ft.length-1:Ft.length,ye=0;ye<_e;ye++){ye===1&&mt!==1&&rt.writeVarint($t(2,_e-1));var be=Ft[ye].x-Dt,br=Ft[ye].y-Ot;rt.writeVarint(xt(be)),rt.writeVarint(xt(br)),Dt+=be,Ot+=br}mt===3&&rt.writeVarint($t(7,1))}}function qt(Ct,rt){var at=typeof Ct;at==="string"?rt.writeStringField(1,Ct):at==="boolean"?rt.writeBooleanField(7,Ct):at==="number"&&(Ct%1!=0?rt.writeDoubleField(3,Ct):Ct<0?rt.writeSVarintField(6,Ct):rt.writeVarintField(5,Ct))}W.exports=Et,W.exports.fromVectorTileJs=Et,W.exports.fromGeojsonVt=function(Ct,rt){rt=rt||{};var at={};for(var mt in Ct)at[mt]=new _t(Ct[mt].features,rt),at[mt].name=mt,at[mt].version=rt.version,at[mt].extent=rt.extent;return Et({layers:at})},W.exports.GeoJSONWrapper=_t;var de=n.bz(W.exports);let Ee={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Ct=>Ct},Se=Math.fround||(ze=new Float32Array(1),Ct=>(ze[0]=+Ct,ze[0]));var ze;let ke=3,nr=5,Si=6;class yi{constructor(rt){this.options=Object.assign(Object.create(Ee),rt),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(rt){let{log:at,minZoom:mt,maxZoom:Dt}=this.options;at&&console.time("total time");let Ot=`prepare ${rt.length} points`;at&&console.time(Ot),this.points=rt;let It=[];for(let Ft=0;Ft<rt.length;Ft++){let Qt=rt[Ft];if(!Qt.geometry)continue;let[_e,ye]=Qt.geometry.coordinates,be=Se(zr(_e)),br=Se(Br(ye));It.push(be,br,1/0,Ft,-1,1),this.options.reduce&&It.push(0)}let Yt=this.trees[Dt+1]=this._createTree(It);at&&console.timeEnd(Ot);for(let Ft=Dt;Ft>=mt;Ft--){let Qt=+Date.now();Yt=this.trees[Ft]=this._createTree(this._cluster(Yt,Ft)),at&&console.log("z%d: %d clusters in %dms",Ft,Yt.numItems,+Date.now()-Qt)}return at&&console.timeEnd("total time"),this}getClusters(rt,at){let mt=((rt[0]+180)%360+360)%360-180,Dt=Math.max(-90,Math.min(90,rt[1])),Ot=rt[2]===180?180:((rt[2]+180)%360+360)%360-180,It=Math.max(-90,Math.min(90,rt[3]));if(rt[2]-rt[0]>=360)mt=-180,Ot=180;else if(mt>Ot){let ye=this.getClusters([mt,Dt,180,It],at),be=this.getClusters([-180,Dt,Ot,It],at);return ye.concat(be)}let Yt=this.trees[this._limitZoom(at)],Ft=Yt.range(zr(mt),Br(It),zr(Ot),Br(Dt)),Qt=Yt.data,_e=[];for(let ye of Ft){let be=this.stride*ye;_e.push(Qt[be+nr]>1?hi(Qt,be,this.clusterProps):this.points[Qt[be+ke]])}return _e}getChildren(rt){let at=this._getOriginId(rt),mt=this._getOriginZoom(rt),Dt="No cluster with the specified id.",Ot=this.trees[mt];if(!Ot)throw new Error(Dt);let It=Ot.data;if(at*this.stride>=It.length)throw new Error(Dt);let Yt=this.options.radius/(this.options.extent*Math.pow(2,mt-1)),Ft=Ot.within(It[at*this.stride],It[at*this.stride+1],Yt),Qt=[];for(let _e of Ft){let ye=_e*this.stride;It[ye+4]===rt&&Qt.push(It[ye+nr]>1?hi(It,ye,this.clusterProps):this.points[It[ye+ke]])}if(Qt.length===0)throw new Error(Dt);return Qt}getLeaves(rt,at,mt){let Dt=[];return this._appendLeaves(Dt,rt,at=at||10,mt=mt||0,0),Dt}getTile(rt,at,mt){let Dt=this.trees[this._limitZoom(rt)],Ot=Math.pow(2,rt),{extent:It,radius:Yt}=this.options,Ft=Yt/It,Qt=(mt-Ft)/Ot,_e=(mt+1+Ft)/Ot,ye={features:[]};return this._addTileFeatures(Dt.range((at-Ft)/Ot,Qt,(at+1+Ft)/Ot,_e),Dt.data,at,mt,Ot,ye),at===0&&this._addTileFeatures(Dt.range(1-Ft/Ot,Qt,1,_e),Dt.data,Ot,mt,Ot,ye),at===Ot-1&&this._addTileFeatures(Dt.range(0,Qt,Ft/Ot,_e),Dt.data,-1,mt,Ot,ye),ye.features.length?ye:null}getClusterExpansionZoom(rt){let at=this._getOriginZoom(rt)-1;for(;at<=this.options.maxZoom;){let mt=this.getChildren(rt);if(at++,mt.length!==1)break;rt=mt[0].properties.cluster_id}return at}_appendLeaves(rt,at,mt,Dt,Ot){let It=this.getChildren(at);for(let Yt of It){let Ft=Yt.properties;if(Ft&&Ft.cluster?Ot+Ft.point_count<=Dt?Ot+=Ft.point_count:Ot=this._appendLeaves(rt,Ft.cluster_id,mt,Dt,Ot):Ot<Dt?Ot++:rt.push(Yt),rt.length===mt)break}return Ot}_createTree(rt){let at=new n.av(rt.length/this.stride|0,this.options.nodeSize,Float32Array);for(let mt=0;mt<rt.length;mt+=this.stride)at.add(rt[mt],rt[mt+1]);return at.finish(),at.data=rt,at}_addTileFeatures(rt,at,mt,Dt,Ot,It){for(let Yt of rt){let Ft=Yt*this.stride,Qt=at[Ft+nr]>1,_e,ye,be;if(Qt)_e=Kr(at,Ft,this.clusterProps),ye=at[Ft],be=at[Ft+1];else{let cr=this.points[at[Ft+ke]];_e=cr.properties;let[vr,jr]=cr.geometry.coordinates;ye=zr(vr),be=Br(jr)}let br={type:1,geometry:[[Math.round(this.options.extent*(ye*Ot-mt)),Math.round(this.options.extent*(be*Ot-Dt))]],tags:_e},Lr;Lr=Qt||this.options.generateId?at[Ft+ke]:this.points[at[Ft+ke]].id,Lr!==void 0&&(br.id=Lr),It.features.push(br)}}_limitZoom(rt){return Math.max(this.options.minZoom,Math.min(Math.floor(+rt),this.options.maxZoom+1))}_cluster(rt,at){let{radius:mt,extent:Dt,reduce:Ot,minPoints:It}=this.options,Yt=mt/(Dt*Math.pow(2,at)),Ft=rt.data,Qt=[],_e=this.stride;for(let ye=0;ye<Ft.length;ye+=_e){if(Ft[ye+2]<=at)continue;Ft[ye+2]=at;let be=Ft[ye],br=Ft[ye+1],Lr=rt.within(Ft[ye],Ft[ye+1],Yt),cr=Ft[ye+nr],vr=cr;for(let jr of Lr){let ln=jr*_e;Ft[ln+2]>at&&(vr+=Ft[ln+nr])}if(vr>cr&&vr>=It){let jr,ln=be*cr,yn=br*cr,Vi=-1,Ai=((ye/_e|0)<<5)+(at+1)+this.points.length;for(let Ps of Lr){let pn=Ps*_e;if(Ft[pn+2]<=at)continue;Ft[pn+2]=at;let ns=Ft[pn+nr];ln+=Ft[pn]*ns,yn+=Ft[pn+1]*ns,Ft[pn+4]=Ai,Ot&&(jr||(jr=this._map(Ft,ye,!0),Vi=this.clusterProps.length,this.clusterProps.push(jr)),Ot(jr,this._map(Ft,pn)))}Ft[ye+4]=Ai,Qt.push(ln/vr,yn/vr,1/0,Ai,-1,vr),Ot&&Qt.push(Vi)}else{for(let jr=0;jr<_e;jr++)Qt.push(Ft[ye+jr]);if(vr>1)for(let jr of Lr){let ln=jr*_e;if(!(Ft[ln+2]<=at)){Ft[ln+2]=at;for(let yn=0;yn<_e;yn++)Qt.push(Ft[ln+yn])}}}}return Qt}_getOriginId(rt){return rt-this.points.length>>5}_getOriginZoom(rt){return(rt-this.points.length)%32}_map(rt,at,mt){if(rt[at+nr]>1){let It=this.clusterProps[rt[at+Si]];return mt?Object.assign({},It):It}let Dt=this.points[rt[at+ke]].properties,Ot=this.options.map(Dt);return mt&&Ot===Dt?Object.assign({},Ot):Ot}}function hi(Ct,rt,at){return{type:"Feature",id:Ct[rt+ke],properties:Kr(Ct,rt,at),geometry:{type:"Point",coordinates:[(mt=Ct[rt],360*(mt-.5)),Fe(Ct[rt+1])]}};var mt}function Kr(Ct,rt,at){let mt=Ct[rt+nr],Dt=mt>=1e4?`${Math.round(mt/1e3)}k`:mt>=1e3?Math.round(mt/100)/10+"k":mt,Ot=Ct[rt+Si],It=Ot===-1?{}:Object.assign({},at[Ot]);return Object.assign(It,{cluster:!0,cluster_id:Ct[rt+ke],point_count:mt,point_count_abbreviated:Dt})}function zr(Ct){return Ct/360+.5}function Br(Ct){let rt=Math.sin(Ct*Math.PI/180),at=.5-.25*Math.log((1+rt)/(1-rt))/Math.PI;return at<0?0:at>1?1:at}function Fe(Ct){let rt=(180-360*Ct)*Math.PI/180;return 360*Math.atan(Math.exp(rt))/Math.PI-90}function Sr(Ct,rt,at,mt){for(var Dt,Ot=mt,It=at-rt>>1,Yt=at-rt,Ft=Ct[rt],Qt=Ct[rt+1],_e=Ct[at],ye=Ct[at+1],be=rt+3;be<at;be+=3){var br=$r(Ct[be],Ct[be+1],Ft,Qt,_e,ye);if(br>Ot)Dt=be,Ot=br;else if(br===Ot){var Lr=Math.abs(be-It);Lr<Yt&&(Dt=be,Yt=Lr)}}Ot>mt&&(Dt-rt>3&&Sr(Ct,rt,Dt,mt),Ct[Dt+2]=Ot,at-Dt>3&&Sr(Ct,Dt,at,mt))}function $r(Ct,rt,at,mt,Dt,Ot){var It=Dt-at,Yt=Ot-mt;if(It!==0||Yt!==0){var Ft=((Ct-at)*It+(rt-mt)*Yt)/(It*It+Yt*Yt);Ft>1?(at=Dt,mt=Ot):Ft>0&&(at+=It*Ft,mt+=Yt*Ft)}return(It=Ct-at)*It+(Yt=rt-mt)*Yt}function Ie(Ct,rt,at,mt){var Dt={id:Ct===void 0?null:Ct,type:rt,geometry:at,tags:mt,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Ot){var It=Ot.geometry,Yt=Ot.type;if(Yt==="Point"||Yt==="MultiPoint"||Yt==="LineString")en(Ot,It);else if(Yt==="Polygon"||Yt==="MultiLineString")for(var Ft=0;Ft<It.length;Ft++)en(Ot,It[Ft]);else if(Yt==="MultiPolygon")for(Ft=0;Ft<It.length;Ft++)for(var Qt=0;Qt<It[Ft].length;Qt++)en(Ot,It[Ft][Qt])}(Dt),Dt}function en(Ct,rt){for(var at=0;at<rt.length;at+=3)Ct.minX=Math.min(Ct.minX,rt[at]),Ct.minY=Math.min(Ct.minY,rt[at+1]),Ct.maxX=Math.max(Ct.maxX,rt[at]),Ct.maxY=Math.max(Ct.maxY,rt[at+1])}function xi(Ct,rt,at,mt){if(rt.geometry){var Dt=rt.geometry.coordinates,Ot=rt.geometry.type,It=Math.pow(at.tolerance/((1<<at.maxZoom)*at.extent),2),Yt=[],Ft=rt.id;if(at.promoteId?Ft=rt.properties[at.promoteId]:at.generateId&&(Ft=mt||0),Ot==="Point")rn(Dt,Yt);else if(Ot==="MultiPoint")for(var Qt=0;Qt<Dt.length;Qt++)rn(Dt[Qt],Yt);else if(Ot==="LineString")fn(Dt,Yt,It,!1);else if(Ot==="MultiLineString"){if(at.lineMetrics){for(Qt=0;Qt<Dt.length;Qt++)fn(Dt[Qt],Yt=[],It,!1),Ct.push(Ie(Ft,"LineString",Yt,rt.properties));return}Er(Dt,Yt,It,!1)}else if(Ot==="Polygon")Er(Dt,Yt,It,!0);else{if(Ot!=="MultiPolygon"){if(Ot==="GeometryCollection"){for(Qt=0;Qt<rt.geometry.geometries.length;Qt++)xi(Ct,{id:Ft,geometry:rt.geometry.geometries[Qt],properties:rt.properties},at,mt);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Qt=0;Qt<Dt.length;Qt++){var _e=[];Er(Dt[Qt],_e,It,!0),Yt.push(_e)}}Ct.push(Ie(Ft,Ot,Yt,rt.properties))}}function rn(Ct,rt){rt.push(ae(Ct[0])),rt.push(Gn(Ct[1])),rt.push(0)}function fn(Ct,rt,at,mt){for(var Dt,Ot,It=0,Yt=0;Yt<Ct.length;Yt++){var Ft=ae(Ct[Yt][0]),Qt=Gn(Ct[Yt][1]);rt.push(Ft),rt.push(Qt),rt.push(0),Yt>0&&(It+=mt?(Dt*Qt-Ft*Ot)/2:Math.sqrt(Math.pow(Ft-Dt,2)+Math.pow(Qt-Ot,2))),Dt=Ft,Ot=Qt}var _e=rt.length-3;rt[2]=1,Sr(rt,0,_e,at),rt[_e+2]=1,rt.size=Math.abs(It),rt.start=0,rt.end=rt.size}function Er(Ct,rt,at,mt){for(var Dt=0;Dt<Ct.length;Dt++){var Ot=[];fn(Ct[Dt],Ot,at,mt),rt.push(Ot)}}function ae(Ct){return Ct/360+.5}function Gn(Ct){var rt=Math.sin(Ct*Math.PI/180),at=.5-.25*Math.log((1+rt)/(1-rt))/Math.PI;return at<0?0:at>1?1:at}function an(Ct,rt,at,mt,Dt,Ot,It,Yt){if(mt/=rt,Ot>=(at/=rt)&&It<mt)return Ct;if(It<at||Ot>=mt)return null;for(var Ft=[],Qt=0;Qt<Ct.length;Qt++){var _e=Ct[Qt],ye=_e.geometry,be=_e.type,br=Dt===0?_e.minX:_e.minY,Lr=Dt===0?_e.maxX:_e.maxY;if(br>=at&&Lr<mt)Ft.push(_e);else if(!(Lr<at||br>=mt)){var cr=[];if(be==="Point"||be==="MultiPoint")Ji(ye,cr,at,mt,Dt);else if(be==="LineString")$i(ye,cr,at,mt,Dt,!1,Yt.lineMetrics);else if(be==="MultiLineString")Pu(ye,cr,at,mt,Dt,!1);else if(be==="Polygon")Pu(ye,cr,at,mt,Dt,!0);else if(be==="MultiPolygon")for(var vr=0;vr<ye.length;vr++){var jr=[];Pu(ye[vr],jr,at,mt,Dt,!0),jr.length&&cr.push(jr)}if(cr.length){if(Yt.lineMetrics&&be==="LineString"){for(vr=0;vr<cr.length;vr++)Ft.push(Ie(_e.id,be,cr[vr],_e.tags));continue}be!=="LineString"&&be!=="MultiLineString"||(cr.length===1?(be="LineString",cr=cr[0]):be="MultiLineString"),be!=="Point"&&be!=="MultiPoint"||(be=cr.length===3?"Point":"MultiPoint"),Ft.push(Ie(_e.id,be,cr,_e.tags))}}}return Ft.length?Ft:null}function Ji(Ct,rt,at,mt,Dt){for(var Ot=0;Ot<Ct.length;Ot+=3){var It=Ct[Ot+Dt];It>=at&&It<=mt&&(rt.push(Ct[Ot]),rt.push(Ct[Ot+1]),rt.push(Ct[Ot+2]))}}function $i(Ct,rt,at,mt,Dt,Ot,It){for(var Yt,Ft,Qt=zo(Ct),_e=Dt===0?Zo:kl,ye=Ct.start,be=0;be<Ct.length-3;be+=3){var br=Ct[be],Lr=Ct[be+1],cr=Ct[be+2],vr=Ct[be+3],jr=Ct[be+4],ln=Dt===0?br:Lr,yn=Dt===0?vr:jr,Vi=!1;It&&(Yt=Math.sqrt(Math.pow(br-vr,2)+Math.pow(Lr-jr,2))),ln<at?yn>at&&(Ft=_e(Qt,br,Lr,vr,jr,at),It&&(Qt.start=ye+Yt*Ft)):ln>mt?yn<mt&&(Ft=_e(Qt,br,Lr,vr,jr,mt),It&&(Qt.start=ye+Yt*Ft)):Rl(Qt,br,Lr,cr),yn<at&&ln>=at&&(Ft=_e(Qt,br,Lr,vr,jr,at),Vi=!0),yn>mt&&ln<=mt&&(Ft=_e(Qt,br,Lr,vr,jr,mt),Vi=!0),!Ot&&Vi&&(It&&(Qt.end=ye+Yt*Ft),rt.push(Qt),Qt=zo(Ct)),It&&(ye+=Yt)}var Ai=Ct.length-3;br=Ct[Ai],Lr=Ct[Ai+1],cr=Ct[Ai+2],(ln=Dt===0?br:Lr)>=at&&ln<=mt&&Rl(Qt,br,Lr,cr),Ai=Qt.length-3,Ot&&Ai>=3&&(Qt[Ai]!==Qt[0]||Qt[Ai+1]!==Qt[1])&&Rl(Qt,Qt[0],Qt[1],Qt[2]),Qt.length&&rt.push(Qt)}function zo(Ct){var rt=[];return rt.size=Ct.size,rt.start=Ct.start,rt.end=Ct.end,rt}function Pu(Ct,rt,at,mt,Dt,Ot){for(var It=0;It<Ct.length;It++)$i(Ct[It],rt,at,mt,Dt,Ot,!1)}function Rl(Ct,rt,at,mt){Ct.push(rt),Ct.push(at),Ct.push(mt)}function Zo(Ct,rt,at,mt,Dt,Ot){var It=(Ot-rt)/(mt-rt);return Ct.push(Ot),Ct.push(at+(Dt-at)*It),Ct.push(1),It}function kl(Ct,rt,at,mt,Dt,Ot){var It=(Ot-at)/(Dt-at);return Ct.push(rt+(mt-rt)*It),Ct.push(Ot),Ct.push(1),It}function rl(Ct,rt){for(var at=[],mt=0;mt<Ct.length;mt++){var Dt,Ot=Ct[mt],It=Ot.type;if(It==="Point"||It==="MultiPoint"||It==="LineString")Dt=Go(Ot.geometry,rt);else if(It==="MultiLineString"||It==="Polygon"){Dt=[];for(var Yt=0;Yt<Ot.geometry.length;Yt++)Dt.push(Go(Ot.geometry[Yt],rt))}else if(It==="MultiPolygon")for(Dt=[],Yt=0;Yt<Ot.geometry.length;Yt++){for(var Ft=[],Qt=0;Qt<Ot.geometry[Yt].length;Qt++)Ft.push(Go(Ot.geometry[Yt][Qt],rt));Dt.push(Ft)}at.push(Ie(Ot.id,It,Dt,Ot.tags))}return at}function Go(Ct,rt){var at=[];at.size=Ct.size,Ct.start!==void 0&&(at.start=Ct.start,at.end=Ct.end);for(var mt=0;mt<Ct.length;mt+=3)at.push(Ct[mt]+rt,Ct[mt+1],Ct[mt+2]);return at}function Ne(Ct,rt){if(Ct.transformed)return Ct;var at,mt,Dt,Ot=1<<Ct.z,It=Ct.x,Yt=Ct.y;for(at=0;at<Ct.features.length;at++){var Ft=Ct.features[at],Qt=Ft.geometry,_e=Ft.type;if(Ft.geometry=[],_e===1)for(mt=0;mt<Qt.length;mt+=2)Ft.geometry.push(la(Qt[mt],Qt[mt+1],rt,Ot,It,Yt));else for(mt=0;mt<Qt.length;mt++){var ye=[];for(Dt=0;Dt<Qt[mt].length;Dt+=2)ye.push(la(Qt[mt][Dt],Qt[mt][Dt+1],rt,Ot,It,Yt));Ft.geometry.push(ye)}}return Ct.transformed=!0,Ct}function la(Ct,rt,at,mt,Dt,Ot){return[Math.round(at*(Ct*mt-Dt)),Math.round(at*(rt*mt-Ot))]}function Qn(Ct,rt,at,mt,Dt){for(var Ot=rt===Dt.maxZoom?0:Dt.tolerance/((1<<rt)*Dt.extent),It={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:at,y:mt,z:rt,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Yt=0;Yt<Ct.length;Yt++){It.numFeatures++,nc(It,Ct[Yt],Ot,Dt);var Ft=Ct[Yt].minX,Qt=Ct[Yt].minY,_e=Ct[Yt].maxX,ye=Ct[Yt].maxY;Ft<It.minX&&(It.minX=Ft),Qt<It.minY&&(It.minY=Qt),_e>It.maxX&&(It.maxX=_e),ye>It.maxY&&(It.maxY=ye)}return It}function nc(Ct,rt,at,mt){var Dt=rt.geometry,Ot=rt.type,It=[];if(Ot==="Point"||Ot==="MultiPoint")for(var Yt=0;Yt<Dt.length;Yt+=3)It.push(Dt[Yt]),It.push(Dt[Yt+1]),Ct.numPoints++,Ct.numSimplified++;else if(Ot==="LineString")il(It,Dt,Ct,at,!1,!1);else if(Ot==="MultiLineString"||Ot==="Polygon")for(Yt=0;Yt<Dt.length;Yt++)il(It,Dt[Yt],Ct,at,Ot==="Polygon",Yt===0);else if(Ot==="MultiPolygon")for(var Ft=0;Ft<Dt.length;Ft++){var Qt=Dt[Ft];for(Yt=0;Yt<Qt.length;Yt++)il(It,Qt[Yt],Ct,at,!0,Yt===0)}if(It.length){var _e=rt.tags||null;if(Ot==="LineString"&&mt.lineMetrics){for(var ye in _e={},rt.tags)_e[ye]=rt.tags[ye];_e.mapbox_clip_start=Dt.start/Dt.size,_e.mapbox_clip_end=Dt.end/Dt.size}var be={geometry:It,type:Ot==="Polygon"||Ot==="MultiPolygon"?3:Ot==="LineString"||Ot==="MultiLineString"?2:1,tags:_e};rt.id!==null&&(be.id=rt.id),Ct.features.push(be)}}function il(Ct,rt,at,mt,Dt,Ot){var It=mt*mt;if(mt>0&&rt.size<(Dt?It:mt))at.numPoints+=rt.length/3;else{for(var Yt=[],Ft=0;Ft<rt.length;Ft+=3)(mt===0||rt[Ft+2]>It)&&(at.numSimplified++,Yt.push(rt[Ft]),Yt.push(rt[Ft+1])),at.numPoints++;Dt&&function(Qt,_e){for(var ye=0,be=0,br=Qt.length,Lr=br-2;be<br;Lr=be,be+=2)ye+=(Qt[be]-Qt[Lr])*(Qt[be+1]+Qt[Lr+1]);if(ye>0===_e)for(be=0,br=Qt.length;be<br/2;be+=2){var cr=Qt[be],vr=Qt[be+1];Qt[be]=Qt[br-2-be],Qt[be+1]=Qt[br-1-be],Qt[br-2-be]=cr,Qt[br-1-be]=vr}}(Yt,Ot),Ct.push(Yt)}}function Ue(Ct,rt){var at=(rt=this.options=function(Dt,Ot){for(var It in Ot)Dt[It]=Ot[It];return Dt}(Object.create(this.options),rt)).debug;if(at&&console.time("preprocess data"),rt.maxZoom<0||rt.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(rt.promoteId&&rt.generateId)throw new Error("promoteId and generateId cannot be used together.");var mt=function(Dt,Ot){var It=[];if(Dt.type==="FeatureCollection")for(var Yt=0;Yt<Dt.features.length;Yt++)xi(It,Dt.features[Yt],Ot,Yt);else xi(It,Dt.type==="Feature"?Dt:{geometry:Dt},Ot);return It}(Ct,rt);this.tiles={},this.tileCoords=[],at&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",rt.indexMaxZoom,rt.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),mt=function(Dt,Ot){var It=Ot.buffer/Ot.extent,Yt=Dt,Ft=an(Dt,1,-1-It,It,0,-1,2,Ot),Qt=an(Dt,1,1-It,2+It,0,-1,2,Ot);return(Ft||Qt)&&(Yt=an(Dt,1,-It,1+It,0,-1,2,Ot)||[],Ft&&(Yt=rl(Ft,1).concat(Yt)),Qt&&(Yt=Yt.concat(rl(Qt,-1)))),Yt}(mt,rt),mt.length&&this.splitTile(mt,0,0,0),at&&(mt.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function ni(Ct,rt,at){return 32*((1<<Ct)*at+rt)+Ct}function Nr(Ct,rt){return rt?Ct.properties[rt]:Ct.id}function xo(Ct,rt){if(Ct==null)return!0;if(Ct.type==="Feature")return Nr(Ct,rt)!=null;if(Ct.type==="FeatureCollection"){let at=new Set;for(let mt of Ct.features){let Dt=Nr(mt,rt);if(Dt==null||at.has(Dt))return!1;at.add(Dt)}return!0}return!1}function nl(Ct,rt){let at=new Map;if(Ct!=null)if(Ct.type==="Feature")at.set(Nr(Ct,rt),Ct);else for(let mt of Ct.features)at.set(Nr(mt,rt),mt);return at}Ue.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Ue.prototype.splitTile=function(Ct,rt,at,mt,Dt,Ot,It){for(var Yt=[Ct,rt,at,mt],Ft=this.options,Qt=Ft.debug;Yt.length;){mt=Yt.pop(),at=Yt.pop(),rt=Yt.pop(),Ct=Yt.pop();var _e=1<<rt,ye=ni(rt,at,mt),be=this.tiles[ye];if(!be&&(Qt>1&&console.time("creation"),be=this.tiles[ye]=Qn(Ct,rt,at,mt,Ft),this.tileCoords.push({z:rt,x:at,y:mt}),Qt)){Qt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",rt,at,mt,be.numFeatures,be.numPoints,be.numSimplified),console.timeEnd("creation"));var br="z"+rt;this.stats[br]=(this.stats[br]||0)+1,this.total++}if(be.source=Ct,Dt){if(rt===Ft.maxZoom||rt===Dt)continue;var Lr=1<<Dt-rt;if(at!==Math.floor(Ot/Lr)||mt!==Math.floor(It/Lr))continue}else if(rt===Ft.indexMaxZoom||be.numPoints<=Ft.indexMaxPoints)continue;if(be.source=null,Ct.length!==0){Qt>1&&console.time("clipping");var cr,vr,jr,ln,yn,Vi,Ai=.5*Ft.buffer/Ft.extent,Ps=.5-Ai,pn=.5+Ai,ns=1+Ai;cr=vr=jr=ln=null,yn=an(Ct,_e,at-Ai,at+pn,0,be.minX,be.maxX,Ft),Vi=an(Ct,_e,at+Ps,at+ns,0,be.minX,be.maxX,Ft),Ct=null,yn&&(cr=an(yn,_e,mt-Ai,mt+pn,1,be.minY,be.maxY,Ft),vr=an(yn,_e,mt+Ps,mt+ns,1,be.minY,be.maxY,Ft),yn=null),Vi&&(jr=an(Vi,_e,mt-Ai,mt+pn,1,be.minY,be.maxY,Ft),ln=an(Vi,_e,mt+Ps,mt+ns,1,be.minY,be.maxY,Ft),Vi=null),Qt>1&&console.timeEnd("clipping"),Yt.push(cr||[],rt+1,2*at,2*mt),Yt.push(vr||[],rt+1,2*at,2*mt+1),Yt.push(jr||[],rt+1,2*at+1,2*mt),Yt.push(ln||[],rt+1,2*at+1,2*mt+1)}}},Ue.prototype.getTile=function(Ct,rt,at){var mt=this.options,Dt=mt.extent,Ot=mt.debug;if(Ct<0||Ct>24)return null;var It=1<<Ct,Yt=ni(Ct,rt=(rt%It+It)%It,at);if(this.tiles[Yt])return Ne(this.tiles[Yt],Dt);Ot>1&&console.log("drilling down to z%d-%d-%d",Ct,rt,at);for(var Ft,Qt=Ct,_e=rt,ye=at;!Ft&&Qt>0;)Qt--,_e=Math.floor(_e/2),ye=Math.floor(ye/2),Ft=this.tiles[ni(Qt,_e,ye)];return Ft&&Ft.source?(Ot>1&&console.log("found parent tile z%d-%d-%d",Qt,_e,ye),Ot>1&&console.time("drilling down"),this.splitTile(Ft.source,Qt,_e,ye,Ct,rt,at),Ot>1&&console.timeEnd("drilling down"),this.tiles[Yt]?Ne(this.tiles[Yt],Dt):null):null};class qr extends v{constructor(rt,at,mt,Dt){super(rt,at,mt),this._dataUpdateable=new Map,this.loadGeoJSON=(Ot,It)=>{let{promoteId:Yt}=Ot;if(Ot.request)return n.f(Ot.request,(Ft,Qt,_e,ye)=>{this._dataUpdateable=xo(Qt,Yt)?nl(Qt,Yt):void 0,It(Ft,Qt,_e,ye)});if(typeof Ot.data=="string")try{let Ft=JSON.parse(Ot.data);this._dataUpdateable=xo(Ft,Yt)?nl(Ft,Yt):void 0,It(null,Ft)}catch{It(new Error(`Input data given to '${Ot.source}' is not a valid GeoJSON object.`))}else Ot.dataDiff?this._dataUpdateable?(function(Ft,Qt,_e){var ye,be,br,Lr;if(Qt.removeAll&&Ft.clear(),Qt.remove)for(let cr of Qt.remove)Ft.delete(cr);if(Qt.add)for(let cr of Qt.add){let vr=Nr(cr,_e);vr!=null&&Ft.set(vr,cr)}if(Qt.update)for(let cr of Qt.update){let vr=Ft.get(cr.id);if(vr==null)continue;let jr=!cr.removeAllProperties&&(((ye=cr.removeProperties)===null||ye===void 0?void 0:ye.length)>0||((be=cr.addOrUpdateProperties)===null||be===void 0?void 0:be.length)>0);if((cr.newGeometry||cr.removeAllProperties||jr)&&(vr=Object.assign({},vr),Ft.set(cr.id,vr),jr&&(vr.properties=Object.assign({},vr.properties))),cr.newGeometry&&(vr.geometry=cr.newGeometry),cr.removeAllProperties)vr.properties={};else if(((br=cr.removeProperties)===null||br===void 0?void 0:br.length)>0)for(let ln of cr.removeProperties)Object.prototype.hasOwnProperty.call(vr.properties,ln)&&delete vr.properties[ln];if(((Lr=cr.addOrUpdateProperties)===null||Lr===void 0?void 0:Lr.length)>0)for(let{key:ln,value:yn}of cr.addOrUpdateProperties)vr.properties[ln]=yn}}(this._dataUpdateable,Ot.dataDiff,Yt),It(null,{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())})):It(new Error(`Cannot update existing geojson data in ${Ot.source}`)):It(new Error(`Input data given to '${Ot.source}' is not a valid GeoJSON object.`));return{cancel:()=>{}}},this.loadVectorData=this.loadGeoJSONTile,Dt&&(this.loadGeoJSON=Dt)}loadGeoJSONTile(rt,at){let mt=rt.tileID.canonical;if(!this._geoJSONIndex)return at(null,null);let Dt=this._geoJSONIndex.getTile(mt.z,mt.x,mt.y);if(!Dt)return at(null,null);let Ot=new class{constructor(Yt){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=n.N,this.length=Yt.length,this._features=Yt}feature(Yt){return new class{constructor(Ft){this._feature=Ft,this.extent=n.N,this.type=Ft.type,this.properties=Ft.tags,"id"in Ft&&!isNaN(Ft.id)&&(this.id=parseInt(Ft.id,10))}loadGeometry(){if(this._feature.type===1){let Ft=[];for(let Qt of this._feature.geometry)Ft.push([new n.P(Qt[0],Qt[1])]);return Ft}{let Ft=[];for(let Qt of this._feature.geometry){let _e=[];for(let ye of Qt)_e.push(new n.P(ye[0],ye[1]));Ft.push(_e)}return Ft}}toGeoJSON(Ft,Qt,_e){return z.call(this,Ft,Qt,_e)}}(this._features[Yt])}}(Dt.features),It=de(Ot);It.byteOffset===0&&It.byteLength===It.buffer.byteLength||(It=new Uint8Array(It)),at(null,{vectorTile:Ot,rawData:It.buffer})}loadData(rt,at){var mt;(mt=this._pendingRequest)===null||mt===void 0||mt.cancel(),this._pendingCallback&&this._pendingCallback(null,{abandoned:!0});let Dt=!!(rt&&rt.request&&rt.request.collectResourceTiming)&&new n.bu(rt.request);this._pendingCallback=at,this._pendingRequest=this.loadGeoJSON(rt,(Ot,It)=>{if(delete this._pendingCallback,delete this._pendingRequest,Ot||!It)return at(Ot);if(typeof It!="object")return at(new Error(`Input data given to '${rt.source}' is not a valid GeoJSON object.`));{L(It,!0);try{if(rt.filter){let Ft=n.bC(rt.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Ft.result==="error")throw new Error(Ft.value.map(_e=>`${_e.key}: ${_e.message}`).join(", "));It={type:"FeatureCollection",features:It.features.filter(_e=>Ft.value.evaluate({zoom:0},_e))}}this._geoJSONIndex=rt.cluster?new yi(function({superclusterOptions:Ft,clusterProperties:Qt}){if(!Qt||!Ft)return Ft;let _e={},ye={},be={accumulated:null,zoom:0},br={properties:null},Lr=Object.keys(Qt);for(let cr of Lr){let[vr,jr]=Qt[cr],ln=n.bC(jr),yn=n.bC(typeof vr=="string"?[vr,["accumulated"],["get",cr]]:vr);_e[cr]=ln.value,ye[cr]=yn.value}return Ft.map=cr=>{br.properties=cr;let vr={};for(let jr of Lr)vr[jr]=_e[jr].evaluate(be,br);return vr},Ft.reduce=(cr,vr)=>{br.properties=vr;for(let jr of Lr)be.accumulated=cr[jr],cr[jr]=ye[jr].evaluate(be,br)},Ft}(rt)).load(It.features):function(Ft,Qt){return new Ue(Ft,Qt)}(It,rt.geojsonVtOptions)}catch(Ft){return at(Ft)}this.loaded={};let Yt={};if(Dt){let Ft=Dt.finish();Ft&&(Yt.resourceTiming={},Yt.resourceTiming[rt.source]=JSON.parse(JSON.stringify(Ft)))}at(null,Yt)}})}reloadTile(rt,at){let mt=this.loaded;return mt&&mt[rt.uid]?super.reloadTile(rt,at):this.loadTile(rt,at)}removeSource(rt,at){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),at()}getClusterExpansionZoom(rt,at){try{at(null,this._geoJSONIndex.getClusterExpansionZoom(rt.clusterId))}catch(mt){at(mt)}}getClusterChildren(rt,at){try{at(null,this._geoJSONIndex.getChildren(rt.clusterId))}catch(mt){at(mt)}}getClusterLeaves(rt,at){try{at(null,this._geoJSONIndex.getLeaves(rt.clusterId,rt.limit,rt.offset))}catch(mt){at(mt)}}}class Ma{constructor(rt){this.self=rt,this.actor=new n.C(rt,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:v,geojson:qr},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(at,mt)=>{if(this.workerSourceTypes[at])throw new Error(`Worker source with name "${at}" already registered.`);this.workerSourceTypes[at]=mt},this.self.registerRTLTextPlugin=at=>{if(n.bD.isParsed())throw new Error("RTL text plugin already registered.");n.bD.applyArabicShaping=at.applyArabicShaping,n.bD.processBidirectionalText=at.processBidirectionalText,n.bD.processStyledBidirectionalText=at.processStyledBidirectionalText}}setReferrer(rt,at){this.referrer=at}setImages(rt,at,mt){this.availableImages[rt]=at;for(let Dt in this.workerSources[rt]){let Ot=this.workerSources[rt][Dt];for(let It in Ot)Ot[It].availableImages=at}mt()}setLayers(rt,at,mt){this.getLayerIndex(rt).replace(at),mt()}updateLayers(rt,at,mt){this.getLayerIndex(rt).update(at.layers,at.removedIds),mt()}loadTile(rt,at,mt){this.getWorkerSource(rt,at.type,at.source).loadTile(at,mt)}loadDEMTile(rt,at,mt){this.getDEMWorkerSource(rt,at.source).loadTile(at,mt)}reloadTile(rt,at,mt){this.getWorkerSource(rt,at.type,at.source).reloadTile(at,mt)}abortTile(rt,at,mt){this.getWorkerSource(rt,at.type,at.source).abortTile(at,mt)}removeTile(rt,at,mt){this.getWorkerSource(rt,at.type,at.source).removeTile(at,mt)}removeDEMTile(rt,at){this.getDEMWorkerSource(rt,at.source).removeTile(at)}removeSource(rt,at,mt){if(!this.workerSources[rt]||!this.workerSources[rt][at.type]||!this.workerSources[rt][at.type][at.source])return;let Dt=this.workerSources[rt][at.type][at.source];delete this.workerSources[rt][at.type][at.source],Dt.removeSource!==void 0?Dt.removeSource(at,mt):mt()}loadWorkerSource(rt,at,mt){try{this.self.importScripts(at.url),mt()}catch(Dt){mt(Dt.toString())}}syncRTLPluginState(rt,at,mt){try{n.bD.setState(at);let Dt=n.bD.getPluginURL();if(n.bD.isLoaded()&&!n.bD.isParsed()&&Dt!=null){this.self.importScripts(Dt);let Ot=n.bD.isParsed();mt(Ot?void 0:new Error(`RTL Text Plugin failed to import scripts from ${Dt}`),Ot)}}catch(Dt){mt(Dt.toString())}}getAvailableImages(rt){let at=this.availableImages[rt];return at||(at=[]),at}getLayerIndex(rt){let at=this.layerIndexes[rt];return at||(at=this.layerIndexes[rt]=new o),at}getWorkerSource(rt,at,mt){return this.workerSources[rt]||(this.workerSources[rt]={}),this.workerSources[rt][at]||(this.workerSources[rt][at]={}),this.workerSources[rt][at][mt]||(this.workerSources[rt][at][mt]=new this.workerSourceTypes[at]({send:(Dt,Ot,It)=>{this.actor.send(Dt,Ot,It,rt)}},this.getLayerIndex(rt),this.getAvailableImages(rt))),this.workerSources[rt][at][mt]}getDEMWorkerSource(rt,at){return this.demWorkerSources[rt]||(this.demWorkerSources[rt]={}),this.demWorkerSources[rt][at]||(this.demWorkerSources[rt][at]=new T),this.demWorkerSources[rt][at]}}return n.i()&&(self.worker=new Ma(self)),Ma}),i(["./shared"],function(n){"use strict";var o="3.6.2";class a{static testProp(c){if(!a.docStyle)return c[0];for(let A=0;A<c.length;A++)if(c[A]in a.docStyle)return c[A];return c[0]}static create(c,A,w){let E=window.document.createElement(c);return A!==void 0&&(E.className=A),w&&w.appendChild(E),E}static createNS(c,A){return window.document.createElementNS(c,A)}static disableDrag(){a.docStyle&&a.selectProp&&(a.userSelect=a.docStyle[a.selectProp],a.docStyle[a.selectProp]="none")}static enableDrag(){a.docStyle&&a.selectProp&&(a.docStyle[a.selectProp]=a.userSelect)}static setTransform(c,A){c.style[a.transformProp]=A}static addEventListener(c,A,w,E={}){c.addEventListener(A,w,"passive"in E?E:E.capture)}static removeEventListener(c,A,w,E={}){c.removeEventListener(A,w,"passive"in E?E:E.capture)}static suppressClickInternal(c){c.preventDefault(),c.stopPropagation(),window.removeEventListener("click",a.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",a.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",a.suppressClickInternal,!0)},0)}static mousePos(c,A){let w=c.getBoundingClientRect();return new n.P(A.clientX-w.left-c.clientLeft,A.clientY-w.top-c.clientTop)}static touchPos(c,A){let w=c.getBoundingClientRect(),E=[];for(let P=0;P<A.length;P++)E.push(new n.P(A[P].clientX-w.left-c.clientLeft,A[P].clientY-w.top-c.clientTop));return E}static mouseButton(c){return c.button}static remove(c){c.parentNode&&c.parentNode.removeChild(c)}}a.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,a.selectProp=a.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),a.transformProp=a.testProp(["transform","WebkitTransform"]);let h={supported:!1,testSupport:function(M){!v&&g&&(T?C(M):p=M)}},p,g,v=!1,T=!1;function C(M){let c=M.createTexture();M.bindTexture(M.TEXTURE_2D,c);try{if(M.texImage2D(M.TEXTURE_2D,0,M.RGBA,M.RGBA,M.UNSIGNED_BYTE,g),M.isContextLost())return;h.supported=!0}catch{}M.deleteTexture(c),v=!0}var B,L;typeof document<"u"&&(g=document.createElement("img"),g.onload=function(){p&&C(p),p=null,T=!0},g.onerror=function(){v=!0,p=null},g.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(M){let c,A,w,E;M.resetRequestQueue=()=>{c=[],A=0,w=0,E={}},M.addThrottleControl=G=>{let J=w++;return E[J]=G,J},M.removeThrottleControl=G=>{delete E[G],V()},M.getImage=(G,J,tt=!0)=>{h.supported&&(G.headers||(G.headers={}),G.headers.accept="image/webp,*/*");let lt={requestParameters:G,supportImageRefresh:tt,callback:J,cancelled:!1,completed:!1,cancel:()=>{lt.completed||lt.cancelled||(lt.cancelled=!0,lt.innerRequest&&(lt.innerRequest.cancel(),A--),V())}};return c.push(lt),V(),lt};let P=G=>{let{requestParameters:J,supportImageRefresh:tt,callback:lt}=G;return n.e(J,{type:"image"}),(tt!==!1||n.i()||n.g(J.url)||J.headers&&!Object.keys(J.headers).reduce((wt,bt)=>wt&&bt==="accept",!0)?n.m:$)(J,(wt,bt,Rt,yt)=>{U(G,lt,wt,bt,Rt,yt)})},U=(G,J,tt,lt,wt,bt)=>{tt?J(tt):lt instanceof HTMLImageElement||n.a(lt)?J(null,lt):lt&&((Rt,yt)=>{typeof createImageBitmap=="function"?n.b(Rt,yt):n.d(Rt,yt)})(lt,(Rt,yt)=>{Rt!=null?J(Rt):yt!=null&&J(null,yt,{cacheControl:wt,expires:bt})}),G.cancelled||(G.completed=!0,A--,V())},V=()=>{let G=(()=>{let J=Object.keys(E),tt=!1;if(J.length>0){for(let lt of J)if(tt=E[lt](),tt)break}return tt})()?n.c.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:n.c.MAX_PARALLEL_IMAGE_REQUESTS;for(let J=A;J<G&&c.length>0;J++){let tt=c.shift();if(tt.cancelled){J--;continue}let lt=P(tt);A++,tt.innerRequest=lt}},$=(G,J)=>{let tt=new Image,lt=G.url,wt=!1,bt=G.credentials;return bt&&bt==="include"?tt.crossOrigin="use-credentials":(bt&&bt==="same-origin"||!n.s(lt))&&(tt.crossOrigin="anonymous"),tt.fetchPriority="high",tt.onload=()=>{J(null,tt),tt.onerror=tt.onload=null},tt.onerror=()=>{wt||J(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.")),tt.onerror=tt.onload=null},tt.src=lt,{cancel:()=>{wt=!0,tt.src=""}}}}(B||(B={})),B.resetRequestQueue(),function(M){M.Glyphs="Glyphs",M.Image="Image",M.Source="Source",M.SpriteImage="SpriteImage",M.SpriteJSON="SpriteJSON",M.Style="Style",M.Tile="Tile",M.Unknown="Unknown"}(L||(L={}));class z{constructor(c){this._transformRequestFn=c}transformRequest(c,A){return this._transformRequestFn&&this._transformRequestFn(c,A)||{url:c}}normalizeSpriteURL(c,A,w){let E=function(P){let U=P.match(W);if(!U)throw new Error(`Unable to parse URL "${P}"`);return{protocol:U[1],authority:U[2],path:U[3]||"/",params:U[4]?U[4].split("&"):[]}}(c);return E.path+=`${A}${w}`,function(P){let U=P.params.length?`?${P.params.join("&")}`:"";return`${P.protocol}://${P.authority}${P.path}${U}`}(E)}setTransformRequest(c){this._transformRequestFn=c}}let W=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Z(M){var c=new n.A(3);return c[0]=M[0],c[1]=M[1],c[2]=M[2],c}var X,q=function(M,c,A){return M[0]=c[0]-A[0],M[1]=c[1]-A[1],M[2]=c[2]-A[2],M};X=new n.A(3),n.A!=Float32Array&&(X[0]=0,X[1]=0,X[2]=0);var it=function(M){var c=M[0],A=M[1];return c*c+A*A};function nt(M){let c=[];if(typeof M=="string")c.push({id:"default",url:M});else if(M&&M.length>0){let A=[];for(let{id:w,url:E}of M){let P=`${w}${E}`;A.indexOf(P)===-1&&(A.push(P),c.push({id:w,url:E}))}}return c}function Mt(M,c,A,w,E){if(w)return void M(w);if(E!==Object.values(c).length||E!==Object.values(A).length)return;let P={};for(let U in c){P[U]={};let V=n.h.getImageCanvasContext(A[U]),$=c[U];for(let G in $){let{width:J,height:tt,x:lt,y:wt,sdf:bt,pixelRatio:Rt,stretchX:yt,stretchY:Zt,content:se}=$[G];P[U][G]={data:null,pixelRatio:Rt,sdf:bt,stretchX:yt,stretchY:Zt,content:se,spriteData:{width:J,height:tt,x:lt,y:wt,context:V}}}}M(null,P)}(function(){var M=new n.A(2);n.A!=Float32Array&&(M[0]=0,M[1]=0)})();class _t{constructor(c,A,w,E){this.context=c,this.format=w,this.texture=c.gl.createTexture(),this.update(A,E)}update(c,A,w){let{width:E,height:P}=c,U=!(this.size&&this.size[0]===E&&this.size[1]===P||w),{context:V}=this,{gl:$}=V;if(this.useMipmap=!!(A&&A.useMipmap),$.bindTexture($.TEXTURE_2D,this.texture),V.pixelStoreUnpackFlipY.set(!1),V.pixelStoreUnpack.set(1),V.pixelStoreUnpackPremultiplyAlpha.set(this.format===$.RGBA&&(!A||A.premultiply!==!1)),U)this.size=[E,P],c instanceof HTMLImageElement||c instanceof HTMLCanvasElement||c instanceof HTMLVideoElement||c instanceof ImageData||n.a(c)?$.texImage2D($.TEXTURE_2D,0,this.format,this.format,$.UNSIGNED_BYTE,c):$.texImage2D($.TEXTURE_2D,0,this.format,E,P,0,this.format,$.UNSIGNED_BYTE,c.data);else{let{x:G,y:J}=w||{x:0,y:0};c instanceof HTMLImageElement||c instanceof HTMLCanvasElement||c instanceof HTMLVideoElement||c instanceof ImageData||n.a(c)?$.texSubImage2D($.TEXTURE_2D,0,G,J,$.RGBA,$.UNSIGNED_BYTE,c):$.texSubImage2D($.TEXTURE_2D,0,G,J,E,P,$.RGBA,$.UNSIGNED_BYTE,c.data)}this.useMipmap&&this.isSizePowerOfTwo()&&$.generateMipmap($.TEXTURE_2D)}bind(c,A,w){let{context:E}=this,{gl:P}=E;P.bindTexture(P.TEXTURE_2D,this.texture),w!==P.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(w=P.LINEAR),c!==this.filter&&(P.texParameteri(P.TEXTURE_2D,P.TEXTURE_MAG_FILTER,c),P.texParameteri(P.TEXTURE_2D,P.TEXTURE_MIN_FILTER,w||c),this.filter=c),A!==this.wrap&&(P.texParameteri(P.TEXTURE_2D,P.TEXTURE_WRAP_S,A),P.texParameteri(P.TEXTURE_2D,P.TEXTURE_WRAP_T,A),this.wrap=A)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){let{gl:c}=this.context;c.deleteTexture(this.texture),this.texture=null}}function Et(M){let{userImage:c}=M;return!!(c&&c.render&&c.render())&&(M.data.replace(new Uint8Array(c.data.buffer)),!0)}class vt extends n.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new n.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(c){if(this.loaded!==c&&(this.loaded=c,c)){for(let{ids:A,callback:w}of this.requestors)this._notify(A,w);this.requestors=[]}}getImage(c){let A=this.images[c];if(A&&!A.data&&A.spriteData){let w=A.spriteData;A.data=new n.R({width:w.width,height:w.height},w.context.getImageData(w.x,w.y,w.width,w.height).data),A.spriteData=null}return A}addImage(c,A){if(this.images[c])throw new Error(`Image id ${c} already exist, use updateImage instead`);this._validate(c,A)&&(this.images[c]=A)}_validate(c,A){let w=!0,E=A.data||A.spriteData;return this._validateStretch(A.stretchX,E&&E.width)||(this.fire(new n.j(new Error(`Image "${c}" has invalid "stretchX" value`))),w=!1),this._validateStretch(A.stretchY,E&&E.height)||(this.fire(new n.j(new Error(`Image "${c}" has invalid "stretchY" value`))),w=!1),this._validateContent(A.content,A)||(this.fire(new n.j(new Error(`Image "${c}" has invalid "content" value`))),w=!1),w}_validateStretch(c,A){if(!c)return!0;let w=0;for(let E of c){if(E[0]<w||E[1]<E[0]||A<E[1])return!1;w=E[1]}return!0}_validateContent(c,A){if(!c)return!0;if(c.length!==4)return!1;let w=A.spriteData,E=w&&w.width||A.data.width,P=w&&w.height||A.data.height;return!(c[0]<0||E<c[0]||c[1]<0||P<c[1]||c[2]<0||E<c[2]||c[3]<0||P<c[3]||c[2]<c[0]||c[3]<c[1])}updateImage(c,A,w=!0){let E=this.getImage(c);if(w&&(E.data.width!==A.data.width||E.data.height!==A.data.height))throw new Error(`size mismatch between old image (${E.data.width}x${E.data.height}) and new image (${A.data.width}x${A.data.height}).`);A.version=E.version+1,this.images[c]=A,this.updatedImages[c]=!0}removeImage(c){let A=this.images[c];delete this.images[c],delete this.patterns[c],A.userImage&&A.userImage.onRemove&&A.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(c,A){let w=!0;if(!this.isLoaded())for(let E of c)this.images[E]||(w=!1);this.isLoaded()||w?this._notify(c,A):this.requestors.push({ids:c,callback:A})}_notify(c,A){let w={};for(let E of c){let P=this.getImage(E);P||(this.fire(new n.k("styleimagemissing",{id:E})),P=this.getImage(E)),P?w[E]={data:P.data.clone(),pixelRatio:P.pixelRatio,sdf:P.sdf,version:P.version,stretchX:P.stretchX,stretchY:P.stretchY,content:P.content,hasRenderCallback:!!(P.userImage&&P.userImage.render)}:n.w(`Image "${E}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}A(null,w)}getPixelSize(){let{width:c,height:A}=this.atlasImage;return{width:c,height:A}}getPattern(c){let A=this.patterns[c],w=this.getImage(c);if(!w)return null;if(A&&A.position.version===w.version)return A.position;if(A)A.position.version=w.version;else{let E={w:w.data.width+2,h:w.data.height+2,x:0,y:0},P=new n.I(E,w);this.patterns[c]={bin:E,position:P}}return this._updatePatternAtlas(),this.patterns[c].position}bind(c){let A=c.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new _t(c,this.atlasImage,A.RGBA),this.atlasTexture.bind(A.LINEAR,A.CLAMP_TO_EDGE)}_updatePatternAtlas(){let c=[];for(let P in this.patterns)c.push(this.patterns[P].bin);let{w:A,h:w}=n.p(c),E=this.atlasImage;E.resize({width:A||1,height:w||1});for(let P in this.patterns){let{bin:U}=this.patterns[P],V=U.x+1,$=U.y+1,G=this.getImage(P).data,J=G.width,tt=G.height;n.R.copy(G,E,{x:0,y:0},{x:V,y:$},{width:J,height:tt}),n.R.copy(G,E,{x:0,y:tt-1},{x:V,y:$-1},{width:J,height:1}),n.R.copy(G,E,{x:0,y:0},{x:V,y:$+tt},{width:J,height:1}),n.R.copy(G,E,{x:J-1,y:0},{x:V-1,y:$},{width:1,height:tt}),n.R.copy(G,E,{x:0,y:0},{x:V+J,y:$},{width:1,height:tt})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(c){for(let A of c){if(this.callbackDispatchedThisFrame[A])continue;this.callbackDispatchedThisFrame[A]=!0;let w=this.getImage(A);w||n.w(`Image with ID: "${A}" was not found`),Et(w)&&this.updateImage(A,w)}}}let Pt=1e20;function re(M,c,A,w,E,P,U,V,$){for(let G=c;G<c+w;G++)$t(M,A*P+G,P,E,U,V,$);for(let G=A;G<A+E;G++)$t(M,G*P+c,1,w,U,V,$)}function $t(M,c,A,w,E,P,U){P[0]=0,U[0]=-Pt,U[1]=Pt,E[0]=M[c];for(let V=1,$=0,G=0;V<w;V++){E[V]=M[c+V*A];let J=V*V;do{let tt=P[$];G=(E[V]-E[tt]+J-tt*tt)/(V-tt)/2}while(G<=U[$]&&--$>-1);$++,P[$]=V,U[$]=G,U[$+1]=Pt}for(let V=0,$=0;V<w;V++){for(;U[$+1]<V;)$++;let G=P[$],J=V-G;M[c+V*A]=E[G]+J*J}}class xt{constructor(c,A){this.requestManager=c,this.localIdeographFontFamily=A,this.entries={}}setURL(c){this.url=c}getGlyphs(c,A){let w=[];for(let E in c)for(let P of c[E])w.push({stack:E,id:P});n.o(w,({stack:E,id:P},U)=>{let V=this.entries[E];V||(V=this.entries[E]={glyphs:{},requests:{},ranges:{}});let $=V.glyphs[P];if($!==void 0)return void U(null,{stack:E,id:P,glyph:$});if($=this._tinySDF(V,E,P),$)return V.glyphs[P]=$,void U(null,{stack:E,id:P,glyph:$});let G=Math.floor(P/256);if(256*G>65535)return void U(new Error("glyphs > 65535 not supported"));if(V.ranges[G])return void U(null,{stack:E,id:P,glyph:$});if(!this.url)return void U(new Error("glyphsUrl is not set"));let J=V.requests[G];J||(J=V.requests[G]=[],xt.loadGlyphRange(E,G,this.url,this.requestManager,(tt,lt)=>{if(lt){for(let wt in lt)this._doesCharSupportLocalGlyph(+wt)||(V.glyphs[+wt]=lt[+wt]);V.ranges[G]=!0}for(let wt of J)wt(tt,lt);delete V.requests[G]})),J.push((tt,lt)=>{tt?U(tt):lt&&U(null,{stack:E,id:P,glyph:lt[P]||null})})},(E,P)=>{if(E)A(E);else if(P){let U={};for(let{stack:V,id:$,glyph:G}of P)(U[V]||(U[V]={}))[$]=G&&{id:G.id,bitmap:G.bitmap.clone(),metrics:G.metrics};A(null,U)}})}_doesCharSupportLocalGlyph(c){return!!this.localIdeographFontFamily&&(n.u["CJK Unified Ideographs"](c)||n.u["Hangul Syllables"](c)||n.u.Hiragana(c)||n.u.Katakana(c))}_tinySDF(c,A,w){let E=this.localIdeographFontFamily;if(!E||!this._doesCharSupportLocalGlyph(w))return;let P=c.tinySDF;if(!P){let V="400";/bold/i.test(A)?V="900":/medium/i.test(A)?V="500":/light/i.test(A)&&(V="200"),P=c.tinySDF=new xt.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:E,fontWeight:V})}let U=P.draw(String.fromCharCode(w));return{id:w,bitmap:new n.q({width:U.width||60,height:U.height||60},U.data),metrics:{width:U.glyphWidth/2||24,height:U.glyphHeight/2||24,left:U.glyphLeft/2+.5||0,top:U.glyphTop/2-27.5||-8,advance:U.glyphAdvance/2||24,isDoubleResolution:!0}}}}xt.loadGlyphRange=function(M,c,A,w,E){let P=256*c,U=P+255,V=w.transformRequest(A.replace("{fontstack}",M).replace("{range}",`${P}-${U}`),L.Glyphs);n.l(V,($,G)=>{if($)E($);else if(G){let J={};for(let tt of n.n(G))J[tt.id]=tt;E(null,J)}})},xt.TinySDF=class{constructor({fontSize:M=24,buffer:c=3,radius:A=8,cutoff:w=.25,fontFamily:E="sans-serif",fontWeight:P="normal",fontStyle:U="normal"}={}){this.buffer=c,this.cutoff=w,this.radius=A;let V=this.size=M+4*c,$=this._createCanvas(V),G=this.ctx=$.getContext("2d",{willReadFrequently:!0});G.font=`${U} ${P} ${M}px ${E}`,G.textBaseline="alphabetic",G.textAlign="left",G.fillStyle="black",this.gridOuter=new Float64Array(V*V),this.gridInner=new Float64Array(V*V),this.f=new Float64Array(V),this.z=new Float64Array(V+1),this.v=new Uint16Array(V)}_createCanvas(M){let c=document.createElement("canvas");return c.width=c.height=M,c}draw(M){let{width:c,actualBoundingBoxAscent:A,actualBoundingBoxDescent:w,actualBoundingBoxLeft:E,actualBoundingBoxRight:P}=this.ctx.measureText(M),U=Math.ceil(A),V=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(P-E))),$=Math.min(this.size-this.buffer,U+Math.ceil(w)),G=V+2*this.buffer,J=$+2*this.buffer,tt=Math.max(G*J,0),lt=new Uint8ClampedArray(tt),wt={data:lt,width:G,height:J,glyphWidth:V,glyphHeight:$,glyphTop:U,glyphLeft:0,glyphAdvance:c};if(V===0||$===0)return wt;let{ctx:bt,buffer:Rt,gridInner:yt,gridOuter:Zt}=this;bt.clearRect(Rt,Rt,V,$),bt.fillText(M,Rt,Rt+U);let se=bt.getImageData(Rt,Rt,V,$);Zt.fill(Pt,0,tt),yt.fill(0,0,tt);for(let Bt=0;Bt<$;Bt++)for(let Gt=0;Gt<V;Gt++){let he=se.data[4*(Bt*V+Gt)+3]/255;if(he===0)continue;let ce=(Bt+Rt)*G+Gt+Rt;if(he===1)Zt[ce]=0,yt[ce]=Pt;else{let xe=.5-he;Zt[ce]=xe>0?xe*xe:0,yt[ce]=xe<0?xe*xe:0}}re(Zt,0,0,G,J,G,this.f,this.v,this.z),re(yt,Rt,Rt,V,$,G,this.f,this.v,this.z);for(let Bt=0;Bt<tt;Bt++){let Gt=Math.sqrt(Zt[Bt])-Math.sqrt(yt[Bt]);lt[Bt]=Math.round(255-255*(Gt/this.radius+this.cutoff))}return wt}};class Vt{constructor(){this.specification=n.v.light.position}possiblyEvaluate(c,A){return n.z(c.expression.evaluate(A))}interpolate(c,A,w){return{x:n.B.number(c.x,A.x,w),y:n.B.number(c.y,A.y,w),z:n.B.number(c.z,A.z,w)}}}let qt;class de extends n.E{constructor(c){super(),qt=qt||new n.r({anchor:new n.D(n.v.light.anchor),position:new Vt,color:new n.D(n.v.light.color),intensity:new n.D(n.v.light.intensity)}),this._transitionable=new n.T(qt),this.setLight(c),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(c,A={}){if(!this._validate(n.t,c,A))for(let w in c){let E=c[w];w.endsWith("-transition")?this._transitionable.setTransition(w.slice(0,-11),E):this._transitionable.setValue(w,E)}}updateTransitions(c){this._transitioning=this._transitionable.transitioned(c,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(c){this.properties=this._transitioning.possiblyEvaluate(c)}_validate(c,A,w){return(!w||w.validate!==!1)&&n.x(this,c.call(n.y,n.e({value:A,style:{glyphs:!0,sprite:!0},styleSpec:n.v})))}}class Ee{constructor(c,A){this.width=c,this.height=A,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(c,A){let w=c.join(",")+String(A);return this.dashEntry[w]||(this.dashEntry[w]=this.addDash(c,A)),this.dashEntry[w]}getDashRanges(c,A,w){let E=[],P=c.length%2==1?-c[c.length-1]*w:0,U=c[0]*w,V=!0;E.push({left:P,right:U,isDash:V,zeroLength:c[0]===0});let $=c[0];for(let G=1;G<c.length;G++){V=!V;let J=c[G];P=$*w,$+=J,U=$*w,E.push({left:P,right:U,isDash:V,zeroLength:J===0})}return E}addRoundDash(c,A,w){let E=A/2;for(let P=-w;P<=w;P++){let U=this.width*(this.nextRow+w+P),V=0,$=c[V];for(let G=0;G<this.width;G++){G/$.right>1&&($=c[++V]);let J=Math.abs(G-$.left),tt=Math.abs(G-$.right),lt=Math.min(J,tt),wt,bt=P/w*(E+1);if($.isDash){let Rt=E-Math.abs(bt);wt=Math.sqrt(lt*lt+Rt*Rt)}else wt=E-Math.sqrt(lt*lt+bt*bt);this.data[U+G]=Math.max(0,Math.min(255,wt+128))}}}addRegularDash(c){for(let V=c.length-1;V>=0;--V){let $=c[V],G=c[V+1];$.zeroLength?c.splice(V,1):G&&G.isDash===$.isDash&&(G.left=$.left,c.splice(V,1))}let A=c[0],w=c[c.length-1];A.isDash===w.isDash&&(A.left=w.left-this.width,w.right=A.right+this.width);let E=this.width*this.nextRow,P=0,U=c[P];for(let V=0;V<this.width;V++){V/U.right>1&&(U=c[++P]);let $=Math.abs(V-U.left),G=Math.abs(V-U.right),J=Math.min($,G);this.data[E+V]=Math.max(0,Math.min(255,(U.isDash?J:-J)+128))}}addDash(c,A){let w=A?7:0,E=2*w+1;if(this.nextRow+E>this.height)return n.w("LineAtlas out of space"),null;let P=0;for(let V=0;V<c.length;V++)P+=c[V];if(P!==0){let V=this.width/P,$=this.getDashRanges(c,this.width,V);A?this.addRoundDash($,V,w):this.addRegularDash($)}let U={y:(this.nextRow+w+.5)/this.height,height:2*w/this.height,width:P};return this.nextRow+=E,this.dirty=!0,U}bind(c){let A=c.gl;this.texture?(A.bindTexture(A.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,A.texSubImage2D(A.TEXTURE_2D,0,0,0,this.width,this.height,A.ALPHA,A.UNSIGNED_BYTE,this.data))):(this.texture=A.createTexture(),A.bindTexture(A.TEXTURE_2D,this.texture),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_WRAP_S,A.REPEAT),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_WRAP_T,A.REPEAT),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_MIN_FILTER,A.LINEAR),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_MAG_FILTER,A.LINEAR),A.texImage2D(A.TEXTURE_2D,0,A.ALPHA,this.width,this.height,0,A.ALPHA,A.UNSIGNED_BYTE,this.data))}}class Se{constructor(c,A,w){this.workerPool=c,this.actors=[],this.currentActor=0,this.id=w;let E=this.workerPool.acquire(w);for(let P=0;P<E.length;P++){let U=new n.C(E[P],A,w);U.name=`Worker ${P}`,this.actors.push(U)}if(!this.actors.length)throw new Error("No actors found")}broadcast(c,A,w){n.o(this.actors,(E,P)=>{E.send(c,A,P)},w=w||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(c=!0){this.actors.forEach(A=>{A.remove()}),this.actors=[],c&&this.workerPool.release(this.id)}}function ze(M,c,A){let w=function(E,P){if(E)return A(E);if(P){let U=n.F(n.e(P,M),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);P.vector_layers&&(U.vectorLayers=P.vector_layers,U.vectorLayerIds=U.vectorLayers.map(V=>V.id)),A(null,U)}};return M.url?n.f(c.transformRequest(M.url,L.Source),w):n.h.frame(()=>w(null,M))}class ke{constructor(c,A){c&&(A?this.setSouthWest(c).setNorthEast(A):Array.isArray(c)&&(c.length===4?this.setSouthWest([c[0],c[1]]).setNorthEast([c[2],c[3]]):this.setSouthWest(c[0]).setNorthEast(c[1])))}setNorthEast(c){return this._ne=c instanceof n.L?new n.L(c.lng,c.lat):n.L.convert(c),this}setSouthWest(c){return this._sw=c instanceof n.L?new n.L(c.lng,c.lat):n.L.convert(c),this}extend(c){let A=this._sw,w=this._ne,E,P;if(c instanceof n.L)E=c,P=c;else{if(!(c instanceof ke))return Array.isArray(c)?c.length===4||c.every(Array.isArray)?this.extend(ke.convert(c)):this.extend(n.L.convert(c)):c&&("lng"in c||"lon"in c)&&"lat"in c?this.extend(n.L.convert(c)):this;if(E=c._sw,P=c._ne,!E||!P)return this}return A||w?(A.lng=Math.min(E.lng,A.lng),A.lat=Math.min(E.lat,A.lat),w.lng=Math.max(P.lng,w.lng),w.lat=Math.max(P.lat,w.lat)):(this._sw=new n.L(E.lng,E.lat),this._ne=new n.L(P.lng,P.lat)),this}getCenter(){return new n.L((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new n.L(this.getWest(),this.getNorth())}getSouthEast(){return new n.L(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(c){let{lng:A,lat:w}=n.L.convert(c),E=this._sw.lng<=A&&A<=this._ne.lng;return this._sw.lng>this._ne.lng&&(E=this._sw.lng>=A&&A>=this._ne.lng),this._sw.lat<=w&&w<=this._ne.lat&&E}static convert(c){return c instanceof ke?c:c&&new ke(c)}static fromLngLat(c,A=0){let w=360*A/40075017,E=w/Math.cos(Math.PI/180*c.lat);return new ke(new n.L(c.lng-E,c.lat-w),new n.L(c.lng+E,c.lat+w))}}class nr{constructor(c,A,w){this.bounds=ke.convert(this.validateBounds(c)),this.minzoom=A||0,this.maxzoom=w||24}validateBounds(c){return Array.isArray(c)&&c.length===4?[Math.max(-180,c[0]),Math.max(-90,c[1]),Math.min(180,c[2]),Math.min(90,c[3])]:[-180,-90,180,90]}contains(c){let A=Math.pow(2,c.z),w=Math.floor(n.G(this.bounds.getWest())*A),E=Math.floor(n.H(this.bounds.getNorth())*A),P=Math.ceil(n.G(this.bounds.getEast())*A),U=Math.ceil(n.H(this.bounds.getSouth())*A);return c.x>=w&&c.x<P&&c.y>=E&&c.y<U}}class Si extends n.E{constructor(c,A,w,E){if(super(),this.load=()=>{this._loaded=!1,this.fire(new n.k("dataloading",{dataType:"source"})),this._tileJSONRequest=ze(this._options,this.map._requestManager,(P,U)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),P?this.fire(new n.j(P)):U&&(n.e(this,U),U.bounds&&(this.tileBounds=new nr(U.bounds,this.minzoom,this.maxzoom)),this.fire(new n.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new n.k("data",{dataType:"source",sourceDataType:"content"})))})},this.serialize=()=>n.e({},this._options),this.id=c,this.dispatcher=w,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,n.e(this,n.F(A,["url","scheme","tileSize","promoteId"])),this._options=n.e({type:"vector"},A),this._collectResourceTiming=A.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(E)}loaded(){return this._loaded}hasTile(c){return!this.tileBounds||this.tileBounds.contains(c.canonical)}onAdd(c){this.map=c,this.load()}setSourceProperty(c){this._tileJSONRequest&&this._tileJSONRequest.cancel(),c(),this.load()}setTiles(c){return this.setSourceProperty(()=>{this._options.tiles=c}),this}setUrl(c){return this.setSourceProperty(()=>{this.url=c,this._options.url=c}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}loadTile(c,A){let w=c.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),E={request:this.map._requestManager.transformRequest(w,L.Tile),uid:c.uid,tileID:c.tileID,zoom:c.tileID.overscaledZ,tileSize:this.tileSize*c.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function P(U,V){return delete c.request,c.aborted?A(null):U&&U.status!==404?A(U):(V&&V.resourceTiming&&(c.resourceTiming=V.resourceTiming),this.map._refreshExpiredTiles&&V&&c.setExpiryData(V),c.loadVectorData(V,this.map.painter),A(null),void(c.reloadCallback&&(this.loadTile(c,c.reloadCallback),c.reloadCallback=null)))}E.request.collectResourceTiming=this._collectResourceTiming,c.actor&&c.state!=="expired"?c.state==="loading"?c.reloadCallback=A:c.request=c.actor.send("reloadTile",E,P.bind(this)):(c.actor=this.dispatcher.getActor(),c.request=c.actor.send("loadTile",E,P.bind(this)))}abortTile(c){c.request&&(c.request.cancel(),delete c.request),c.actor&&c.actor.send("abortTile",{uid:c.uid,type:this.type,source:this.id},void 0)}unloadTile(c){c.unloadVectorData(),c.actor&&c.actor.send("removeTile",{uid:c.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class yi extends n.E{constructor(c,A,w,E){super(),this.id=c,this.dispatcher=w,this.setEventedParent(E),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=n.e({type:"raster"},A),n.e(this,n.F(A,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new n.k("dataloading",{dataType:"source"})),this._tileJSONRequest=ze(this._options,this.map._requestManager,(c,A)=>{this._tileJSONRequest=null,this._loaded=!0,c?this.fire(new n.j(c)):A&&(n.e(this,A),A.bounds&&(this.tileBounds=new nr(A.bounds,this.minzoom,this.maxzoom)),this.fire(new n.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new n.k("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(c){this.map=c,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}setSourceProperty(c){this._tileJSONRequest&&this._tileJSONRequest.cancel(),c(),this.load()}setTiles(c){return this.setSourceProperty(()=>{this._options.tiles=c}),this}serialize(){return n.e({},this._options)}hasTile(c){return!this.tileBounds||this.tileBounds.contains(c.canonical)}loadTile(c,A){let w=c.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);c.request=B.getImage(this.map._requestManager.transformRequest(w,L.Tile),(E,P,U)=>{if(delete c.request,c.aborted)c.state="unloaded",A(null);else if(E)c.state="errored",A(E);else if(P){this.map._refreshExpiredTiles&&U&&c.setExpiryData(U);let V=this.map.painter.context,$=V.gl;c.texture=this.map.painter.getTileTexture(P.width),c.texture?c.texture.update(P,{useMipmap:!0}):(c.texture=new _t(V,P,$.RGBA,{useMipmap:!0}),c.texture.bind($.LINEAR,$.CLAMP_TO_EDGE,$.LINEAR_MIPMAP_NEAREST),V.extTextureFilterAnisotropic&&$.texParameterf($.TEXTURE_2D,V.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,V.extTextureFilterAnisotropicMax)),c.state="loaded",A(null)}},this.map._refreshExpiredTiles)}abortTile(c,A){c.request&&(c.request.cancel(),delete c.request),A()}unloadTile(c,A){c.texture&&this.map.painter.saveTileTexture(c.texture),A()}hasTransition(){return!1}}class hi extends yi{constructor(c,A,w,E){super(c,A,w,E),this.type="raster-dem",this.maxzoom=22,this._options=n.e({type:"raster-dem"},A),this.encoding=A.encoding||"mapbox",this.redFactor=A.redFactor,this.greenFactor=A.greenFactor,this.blueFactor=A.blueFactor,this.baseShift=A.baseShift}loadTile(c,A){let w=c.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),E=this.map._requestManager.transformRequest(w,L.Tile);function P(U,V){U&&(c.state="errored",A(U)),V&&(c.dem=V,c.needsHillshadePrepare=!0,c.needsTerrainPrepare=!0,c.state="loaded",A(null))}c.neighboringTiles=this._getNeighboringTiles(c.tileID),c.request=B.getImage(E,(U,V,$)=>n._(this,void 0,void 0,function*(){if(delete c.request,c.aborted)c.state="unloaded",A(null);else if(U)c.state="errored",A(U);else if(V){this.map._refreshExpiredTiles&&c.setExpiryData($);let G=n.a(V)&&n.J()?V:yield function(tt){return n._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&n.K()){let lt=tt.width+2,wt=tt.height+2;try{return new n.R({width:lt,height:wt},yield n.M(tt,-1,-1,lt,wt))}catch{}}return n.h.getImageData(tt,1)})}(V),J={uid:c.uid,coord:c.tileID,source:this.id,rawImageData:G,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};c.actor&&c.state!=="expired"||(c.actor=this.dispatcher.getActor(),c.actor.send("loadDEMTile",J,P))}}),this.map._refreshExpiredTiles)}_getNeighboringTiles(c){let A=c.canonical,w=Math.pow(2,A.z),E=(A.x-1+w)%w,P=A.x===0?c.wrap-1:c.wrap,U=(A.x+1+w)%w,V=A.x+1===w?c.wrap+1:c.wrap,$={};return $[new n.O(c.overscaledZ,P,A.z,E,A.y).key]={backfilled:!1},$[new n.O(c.overscaledZ,V,A.z,U,A.y).key]={backfilled:!1},A.y>0&&($[new n.O(c.overscaledZ,P,A.z,E,A.y-1).key]={backfilled:!1},$[new n.O(c.overscaledZ,c.wrap,A.z,A.x,A.y-1).key]={backfilled:!1},$[new n.O(c.overscaledZ,V,A.z,U,A.y-1).key]={backfilled:!1}),A.y+1<w&&($[new n.O(c.overscaledZ,P,A.z,E,A.y+1).key]={backfilled:!1},$[new n.O(c.overscaledZ,c.wrap,A.z,A.x,A.y+1).key]={backfilled:!1},$[new n.O(c.overscaledZ,V,A.z,U,A.y+1).key]={backfilled:!1}),$}unloadTile(c){c.demTexture&&this.map.painter.saveTileTexture(c.demTexture),c.fbo&&(c.fbo.destroy(),delete c.fbo),c.dem&&delete c.dem,delete c.neighboringTiles,c.state="unloaded",c.actor&&c.actor.send("removeDEMTile",{uid:c.uid,source:this.id})}}class Kr extends n.E{constructor(c,A,w,E){super(),this.load=()=>{this._updateWorkerData()},this.serialize=()=>n.e({},this._options,{type:this.type,data:this._data}),this.id=c,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=w.getActor(),this.setEventedParent(E),this._data=A.data,this._options=n.e({},A),this._collectResourceTiming=A.collectResourceTiming,A.maxzoom!==void 0&&(this.maxzoom=A.maxzoom),A.type&&(this.type=A.type),A.attribution&&(this.attribution=A.attribution),this.promoteId=A.promoteId;let P=n.N/this.tileSize;this.workerOptions=n.e({source:this.id,cluster:A.cluster||!1,geojsonVtOptions:{buffer:(A.buffer!==void 0?A.buffer:128)*P,tolerance:(A.tolerance!==void 0?A.tolerance:.375)*P,extent:n.N,maxZoom:this.maxzoom,lineMetrics:A.lineMetrics||!1,generateId:A.generateId||!1},superclusterOptions:{maxZoom:A.clusterMaxZoom!==void 0?A.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,A.clusterMinPoints||2),extent:n.N,radius:(A.clusterRadius||50)*P,log:!1,generateId:A.generateId||!1},clusterProperties:A.clusterProperties,filter:A.filter},A.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}onAdd(c){this.map=c,this.load()}setData(c){return this._data=c,this._updateWorkerData(),this}updateData(c){return this._updateWorkerData(c),this}setClusterOptions(c){return this.workerOptions.cluster=c.cluster,c&&(c.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=c.clusterRadius),c.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=c.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(c,A){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:c,source:this.id},A),this}getClusterChildren(c,A){return this.actor.send("geojson.getClusterChildren",{clusterId:c,source:this.id},A),this}getClusterLeaves(c,A,w,E){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:c,limit:A,offset:w},E),this}_updateWorkerData(c){let A=n.e({},this.workerOptions);c?A.dataDiff=c:typeof this._data=="string"?(A.request=this.map._requestManager.transformRequest(n.h.resolveURL(this._data),L.Source),A.request.collectResourceTiming=this._collectResourceTiming):A.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new n.k("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,A,(w,E)=>{if(this._pendingLoads--,this._removed||E&&E.abandoned)return void this.fire(new n.k("dataabort",{dataType:"source"}));let P=null;if(E&&E.resourceTiming&&E.resourceTiming[this.id]&&(P=E.resourceTiming[this.id].slice(0)),w)return void this.fire(new n.j(w));let U={dataType:"source"};this._collectResourceTiming&&P&&P.length>0&&n.e(U,{resourceTiming:P}),this.fire(new n.k("data",Object.assign(Object.assign({},U),{sourceDataType:"metadata"}))),this.fire(new n.k("data",Object.assign(Object.assign({},U),{sourceDataType:"content"})))})}loaded(){return this._pendingLoads===0}loadTile(c,A){let w=c.actor?"reloadTile":"loadTile";c.actor=this.actor;let E={type:this.type,uid:c.uid,tileID:c.tileID,zoom:c.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};c.request=this.actor.send(w,E,(P,U)=>(delete c.request,c.unloadVectorData(),c.aborted?A(null):P?A(P):(c.loadVectorData(U,this.map.painter,w==="reloadTile"),A(null))))}abortTile(c){c.request&&(c.request.cancel(),delete c.request),c.aborted=!0}unloadTile(c){c.unloadVectorData(),this.actor.send("removeTile",{uid:c.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}hasTransition(){return!1}}var zr=n.Q([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Br extends n.E{constructor(c,A,w,E){super(),this.load=(P,U)=>{this._loaded=!1,this.fire(new n.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=B.getImage(this.map._requestManager.transformRequest(this.url,L.Image),(V,$)=>{this._request=null,this._loaded=!0,V?this.fire(new n.j(V)):$&&(this.image=$,P&&(this.coordinates=P),U&&U(),this._finishLoading())})},this.prepare=()=>{if(Object.keys(this.tiles).length===0||!this.image)return;let P=this.map.painter.context,U=P.gl;this.boundsBuffer||(this.boundsBuffer=P.createVertexBuffer(this._boundsArray,zr.members)),this.boundsSegments||(this.boundsSegments=n.S.simpleSegment(0,0,4,2)),this.texture||(this.texture=new _t(P,this.image,U.RGBA),this.texture.bind(U.LINEAR,U.CLAMP_TO_EDGE));let V=!1;for(let $ in this.tiles){let G=this.tiles[$];G.state!=="loaded"&&(G.state="loaded",G.texture=this.texture,V=!0)}V&&this.fire(new n.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"image",url:this.options.url,coordinates:this.coordinates}),this.id=c,this.dispatcher=w,this.coordinates=A.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(E),this.options=A}loaded(){return this._loaded}updateImage(c){return c.url?(this._request&&(this._request.cancel(),this._request=null),this.options.url=c.url,this.load(c.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new n.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(c){this.map=c,this.load()}onRemove(){this._request&&(this._request.cancel(),this._request=null)}setCoordinates(c){this.coordinates=c;let A=c.map(n.U.fromLngLat);this.tileID=function(E){let P=1/0,U=1/0,V=-1/0,$=-1/0;for(let lt of E)P=Math.min(P,lt.x),U=Math.min(U,lt.y),V=Math.max(V,lt.x),$=Math.max($,lt.y);let G=Math.max(V-P,$-U),J=Math.max(0,Math.floor(-Math.log(G)/Math.LN2)),tt=Math.pow(2,J);return new n.W(J,Math.floor((P+V)/2*tt),Math.floor((U+$)/2*tt))}(A),this.minzoom=this.maxzoom=this.tileID.z;let w=A.map(E=>this.tileID.getTilePoint(E)._round());return this._boundsArray=new n.V,this._boundsArray.emplaceBack(w[0].x,w[0].y,0,0),this._boundsArray.emplaceBack(w[1].x,w[1].y,n.N,0),this._boundsArray.emplaceBack(w[3].x,w[3].y,0,n.N),this._boundsArray.emplaceBack(w[2].x,w[2].y,n.N,n.N),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new n.k("data",{dataType:"source",sourceDataType:"content"})),this}loadTile(c,A){this.tileID&&this.tileID.equals(c.tileID.canonical)?(this.tiles[String(c.tileID.wrap)]=c,c.buckets={},A(null)):(c.state="errored",A(null))}hasTransition(){return!1}}class Fe extends Br{constructor(c,A,w,E){super(c,A,w,E),this.load=()=>{this._loaded=!1;let P=this.options;this.urls=[];for(let U of P.urls)this.urls.push(this.map._requestManager.transformRequest(U,L.Source).url);n.X(this.urls,(U,V)=>{this._loaded=!0,U?this.fire(new n.j(U)):V&&(this.video=V,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})},this.prepare=()=>{if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;let P=this.map.painter.context,U=P.gl;this.boundsBuffer||(this.boundsBuffer=P.createVertexBuffer(this._boundsArray,zr.members)),this.boundsSegments||(this.boundsSegments=n.S.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(U.LINEAR,U.CLAMP_TO_EDGE),U.texSubImage2D(U.TEXTURE_2D,0,0,0,U.RGBA,U.UNSIGNED_BYTE,this.video)):(this.texture=new _t(P,this.video,U.RGBA),this.texture.bind(U.LINEAR,U.CLAMP_TO_EDGE));let V=!1;for(let $ in this.tiles){let G=this.tiles[$];G.state!=="loaded"&&(G.state="loaded",G.texture=this.texture,V=!0)}V&&this.fire(new n.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"video",urls:this.urls,coordinates:this.coordinates}),this.roundZoom=!0,this.type="video",this.options=A}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(c){if(this.video){let A=this.video.seekable;c<A.start(0)||c>A.end(0)?this.fire(new n.j(new n.Y(`sources.${this.id}`,null,`Playback for this video can be set only between the ${A.start(0)} and ${A.end(0)}-second mark.`))):this.video.currentTime=c}}getVideo(){return this.video}onAdd(c){this.map||(this.map=c,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}hasTransition(){return this.video&&!this.video.paused}}class Sr extends Br{constructor(c,A,w,E){super(c,A,w,E),this.load=()=>{this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new n.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},this.prepare=()=>{let P=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,P=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,P=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;let U=this.map.painter.context,V=U.gl;this.boundsBuffer||(this.boundsBuffer=U.createVertexBuffer(this._boundsArray,zr.members)),this.boundsSegments||(this.boundsSegments=n.S.simpleSegment(0,0,4,2)),this.texture?(P||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new _t(U,this.canvas,V.RGBA,{premultiply:!0});let $=!1;for(let G in this.tiles){let J=this.tiles[G];J.state!=="loaded"&&(J.state="loaded",J.texture=this.texture,$=!0)}$&&this.fire(new n.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"canvas",coordinates:this.coordinates}),A.coordinates?Array.isArray(A.coordinates)&&A.coordinates.length===4&&!A.coordinates.some(P=>!Array.isArray(P)||P.length!==2||P.some(U=>typeof U!="number"))||this.fire(new n.j(new n.Y(`sources.${c}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new n.j(new n.Y(`sources.${c}`,null,'missing required property "coordinates"'))),A.animate&&typeof A.animate!="boolean"&&this.fire(new n.j(new n.Y(`sources.${c}`,null,'optional "animate" property must be a boolean value'))),A.canvas?typeof A.canvas=="string"||A.canvas instanceof HTMLCanvasElement||this.fire(new n.j(new n.Y(`sources.${c}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new n.j(new n.Y(`sources.${c}`,null,'missing required property "canvas"'))),this.options=A,this.animate=A.animate===void 0||A.animate}getCanvas(){return this.canvas}onAdd(c){this.map=c,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}hasTransition(){return this._playing}_hasInvalidDimensions(){for(let c of[this.canvas.width,this.canvas.height])if(isNaN(c)||c<=0)return!0;return!1}}let $r={},Ie=M=>{switch(M){case"geojson":return Kr;case"image":return Br;case"raster":return yi;case"raster-dem":return hi;case"vector":return Si;case"video":return Fe;case"canvas":return Sr}return $r[M]};function en(M,c){let A=n.Z();return n.$(A,A,[1,1,0]),n.a0(A,A,[.5*M.width,.5*M.height,1]),n.a1(A,A,M.calculatePosMatrix(c.toUnwrapped()))}function xi(M,c,A,w,E,P){let U=function(tt,lt,wt){if(tt)for(let bt of tt){let Rt=lt[bt];if(Rt&&Rt.source===wt&&Rt.type==="fill-extrusion")return!0}else for(let bt in lt){let Rt=lt[bt];if(Rt.source===wt&&Rt.type==="fill-extrusion")return!0}return!1}(E&&E.layers,c,M.id),V=P.maxPitchScaleFactor(),$=M.tilesIn(w,V,U);$.sort(rn);let G=[];for(let tt of $)G.push({wrappedTileID:tt.tileID.wrapped().key,queryResults:tt.tile.queryRenderedFeatures(c,A,M._state,tt.queryGeometry,tt.cameraQueryGeometry,tt.scale,E,P,V,en(M.transform,tt.tileID))});let J=function(tt){let lt={},wt={};for(let bt of tt){let Rt=bt.queryResults,yt=bt.wrappedTileID,Zt=wt[yt]=wt[yt]||{};for(let se in Rt){let Bt=Rt[se],Gt=Zt[se]=Zt[se]||{},he=lt[se]=lt[se]||[];for(let ce of Bt)Gt[ce.featureIndex]||(Gt[ce.featureIndex]=!0,he.push(ce))}}return lt}(G);for(let tt in J)J[tt].forEach(lt=>{let wt=lt.feature,bt=M.getFeatureState(wt.layer["source-layer"],wt.id);wt.source=wt.layer.source,wt.layer["source-layer"]&&(wt.sourceLayer=wt.layer["source-layer"]),wt.state=bt});return J}function rn(M,c){let A=M.tileID,w=c.tileID;return A.overscaledZ-w.overscaledZ||A.canonical.y-w.canonical.y||A.wrap-w.wrap||A.canonical.x-w.canonical.x}class fn{constructor(c,A){this.timeAdded=0,this.fadeEndTime=0,this.tileID=c,this.uid=n.a2(),this.uses=0,this.tileSize=A,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(c){let A=c+this.timeAdded;A<this.fadeEndTime||(this.fadeEndTime=A)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(c){this.demTexture&&c.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(c,A,w){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",c){c.featureIndex&&(this.latestFeatureIndex=c.featureIndex,c.rawTileData?(this.latestRawTileData=c.rawTileData,this.latestFeatureIndex.rawTileData=c.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=c.collisionBoxArray,this.buckets=function(E,P){let U={};if(!P)return U;for(let V of E){let $=V.layerIds.map(G=>P.getLayer(G)).filter(Boolean);if($.length!==0){V.layers=$,V.stateDependentLayerIds&&(V.stateDependentLayers=V.stateDependentLayerIds.map(G=>$.filter(J=>J.id===G)[0]));for(let G of $)U[G.id]=V}}return U}(c.buckets,A.style),this.hasSymbolBuckets=!1;for(let E in this.buckets){let P=this.buckets[E];if(P instanceof n.a4){if(this.hasSymbolBuckets=!0,!w)break;P.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(let E in this.buckets){let P=this.buckets[E];if(P instanceof n.a4&&P.hasRTLText){this.hasRTLText=!0,n.a5();break}}this.queryPadding=0;for(let E in this.buckets){let P=this.buckets[E];this.queryPadding=Math.max(this.queryPadding,A.style.getLayer(E).queryRadius(P))}c.imageAtlas&&(this.imageAtlas=c.imageAtlas),c.glyphAtlasImage&&(this.glyphAtlasImage=c.glyphAtlasImage)}else this.collisionBoxArray=new n.a3}unloadVectorData(){for(let c in this.buckets)this.buckets[c].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(c){return this.buckets[c.id]}upload(c){for(let w in this.buckets){let E=this.buckets[w];E.uploadPending()&&E.upload(c)}let A=c.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new _t(c,this.imageAtlas.image,A.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new _t(c,this.glyphAtlasImage,A.ALPHA),this.glyphAtlasImage=null)}prepare(c){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(c,this.imageAtlasTexture)}queryRenderedFeatures(c,A,w,E,P,U,V,$,G,J){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:E,cameraQueryGeometry:P,scale:U,tileSize:this.tileSize,pixelPosMatrix:J,transform:$,params:V,queryPadding:this.queryPadding*G},c,A,w):{}}querySourceFeatures(c,A){let w=this.latestFeatureIndex;if(!w||!w.rawTileData)return;let E=w.loadVTLayers(),P=A&&A.sourceLayer?A.sourceLayer:"",U=E._geojsonTileLayer||E[P];if(!U)return;let V=n.a6(A&&A.filter),{z:$,x:G,y:J}=this.tileID.canonical,tt={z:$,x:G,y:J};for(let lt=0;lt<U.length;lt++){let wt=U.feature(lt);if(V.needGeometry){let yt=n.a7(wt,!0);if(!V.filter(new n.a8(this.tileID.overscaledZ),yt,this.tileID.canonical))continue}else if(!V.filter(new n.a8(this.tileID.overscaledZ),wt))continue;let bt=w.getId(wt,P),Rt=new n.a9(wt,$,G,J,bt);Rt.tile=tt,c.push(Rt)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(c){let A=this.expirationTime;if(c.cacheControl){let w=n.aa(c.cacheControl);w["max-age"]&&(this.expirationTime=Date.now()+1e3*w["max-age"])}else c.expires&&(this.expirationTime=new Date(c.expires).getTime());if(this.expirationTime){let w=Date.now(),E=!1;if(this.expirationTime>w)E=!1;else if(A)if(this.expirationTime<A)E=!0;else{let P=this.expirationTime-A;P?this.expirationTime=w+Math.max(P,3e4):E=!0}else E=!0;E?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(c,A){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(c).length===0)return;let w=this.latestFeatureIndex.loadVTLayers();for(let E in this.buckets){if(!A.style.hasLayer(E))continue;let P=this.buckets[E],U=P.layers[0].sourceLayer||"_geojsonTileLayer",V=w[U],$=c[U];if(!V||!$||Object.keys($).length===0)continue;P.update($,V,this.imageAtlas&&this.imageAtlas.patternPositions||{});let G=A&&A.style&&A.style.getLayer(E);G&&(this.queryPadding=Math.max(this.queryPadding,G.queryRadius(P)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<n.h.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(c){this.symbolFadeHoldUntil=n.h.now()+c}setDependencies(c,A){let w={};for(let E of A)w[E]=!0;this.dependencies[c]=w}hasDependency(c,A){for(let w of c){let E=this.dependencies[w];if(E){for(let P of A)if(E[P])return!0}}return!1}}class Er{constructor(c,A){this.max=c,this.onRemove=A,this.reset()}reset(){for(let c in this.data)for(let A of this.data[c])A.timeout&&clearTimeout(A.timeout),this.onRemove(A.value);return this.data={},this.order=[],this}add(c,A,w){let E=c.wrapped().key;this.data[E]===void 0&&(this.data[E]=[]);let P={value:A,timeout:void 0};if(w!==void 0&&(P.timeout=setTimeout(()=>{this.remove(c,P)},w)),this.data[E].push(P),this.order.push(E),this.order.length>this.max){let U=this._getAndRemoveByKey(this.order[0]);U&&this.onRemove(U)}return this}has(c){return c.wrapped().key in this.data}getAndRemove(c){return this.has(c)?this._getAndRemoveByKey(c.wrapped().key):null}_getAndRemoveByKey(c){let A=this.data[c].shift();return A.timeout&&clearTimeout(A.timeout),this.data[c].length===0&&delete this.data[c],this.order.splice(this.order.indexOf(c),1),A.value}getByKey(c){let A=this.data[c];return A?A[0].value:null}get(c){return this.has(c)?this.data[c.wrapped().key][0].value:null}remove(c,A){if(!this.has(c))return this;let w=c.wrapped().key,E=A===void 0?0:this.data[w].indexOf(A),P=this.data[w][E];return this.data[w].splice(E,1),P.timeout&&clearTimeout(P.timeout),this.data[w].length===0&&delete this.data[w],this.onRemove(P.value),this.order.splice(this.order.indexOf(w),1),this}setMaxSize(c){for(this.max=c;this.order.length>this.max;){let A=this._getAndRemoveByKey(this.order[0]);A&&this.onRemove(A)}return this}filter(c){let A=[];for(let w in this.data)for(let E of this.data[w])c(E.value)||A.push(E);for(let w of A)this.remove(w.value.tileID,w)}}class ae{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(c,A,w){let E=String(A);if(this.stateChanges[c]=this.stateChanges[c]||{},this.stateChanges[c][E]=this.stateChanges[c][E]||{},n.e(this.stateChanges[c][E],w),this.deletedStates[c]===null){this.deletedStates[c]={};for(let P in this.state[c])P!==E&&(this.deletedStates[c][P]=null)}else if(this.deletedStates[c]&&this.deletedStates[c][E]===null){this.deletedStates[c][E]={};for(let P in this.state[c][E])w[P]||(this.deletedStates[c][E][P]=null)}else for(let P in w)this.deletedStates[c]&&this.deletedStates[c][E]&&this.deletedStates[c][E][P]===null&&delete this.deletedStates[c][E][P]}removeFeatureState(c,A,w){if(this.deletedStates[c]===null)return;let E=String(A);if(this.deletedStates[c]=this.deletedStates[c]||{},w&&A!==void 0)this.deletedStates[c][E]!==null&&(this.deletedStates[c][E]=this.deletedStates[c][E]||{},this.deletedStates[c][E][w]=null);else if(A!==void 0)if(this.stateChanges[c]&&this.stateChanges[c][E])for(w in this.deletedStates[c][E]={},this.stateChanges[c][E])this.deletedStates[c][E][w]=null;else this.deletedStates[c][E]=null;else this.deletedStates[c]=null}getState(c,A){let w=String(A),E=n.e({},(this.state[c]||{})[w],(this.stateChanges[c]||{})[w]);if(this.deletedStates[c]===null)return{};if(this.deletedStates[c]){let P=this.deletedStates[c][A];if(P===null)return{};for(let U in P)delete E[U]}return E}initializeTileState(c,A){c.setFeatureState(this.state,A)}coalesceChanges(c,A){let w={};for(let E in this.stateChanges){this.state[E]=this.state[E]||{};let P={};for(let U in this.stateChanges[E])this.state[E][U]||(this.state[E][U]={}),n.e(this.state[E][U],this.stateChanges[E][U]),P[U]=this.state[E][U];w[E]=P}for(let E in this.deletedStates){this.state[E]=this.state[E]||{};let P={};if(this.deletedStates[E]===null)for(let U in this.state[E])P[U]={},this.state[E][U]={};else for(let U in this.deletedStates[E]){if(this.deletedStates[E][U]===null)this.state[E][U]={};else for(let V of Object.keys(this.deletedStates[E][U]))delete this.state[E][U][V];P[U]=this.state[E][U]}w[E]=w[E]||{},n.e(w[E],P)}if(this.stateChanges={},this.deletedStates={},Object.keys(w).length!==0)for(let E in c)c[E].setFeatureState(w,A)}}class Gn extends n.E{constructor(c,A,w){super(),this.id=c,this.dispatcher=w,this.on("data",E=>{E.dataType==="source"&&E.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&E.dataType==="source"&&E.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((E,P,U,V)=>{let $=new(Ie(P.type))(E,P,U,V);if($.id!==E)throw new Error(`Expected Source id to be ${E} instead of ${$.id}`);return $})(c,A,w,this),this._tiles={},this._cache=new Er(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new ae,this._didEmitContent=!1,this._updated=!1}onAdd(c){this.map=c,this._maxTileCacheSize=c?c._maxTileCacheSize:null,this._maxTileCacheZoomLevels=c?c._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(c)}onRemove(c){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(c)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(let c in this._tiles){let A=this._tiles[c];if(A.state!=="loaded"&&A.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;let c=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,c&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(c,A){return this._source.loadTile(c,A)}_unloadTile(c){if(this._source.unloadTile)return this._source.unloadTile(c,()=>{})}_abortTile(c){this._source.abortTile&&this._source.abortTile(c,()=>{}),this._source.fire(new n.k("dataabort",{tile:c,coord:c.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(c){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(let A in this._tiles){let w=this._tiles[A];w.upload(c),w.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(c=>c.tileID).sort(an).map(c=>c.key)}getRenderableIds(c){let A=[];for(let w in this._tiles)this._isIdRenderable(w,c)&&A.push(this._tiles[w]);return c?A.sort((w,E)=>{let P=w.tileID,U=E.tileID,V=new n.P(P.canonical.x,P.canonical.y)._rotate(this.transform.angle),$=new n.P(U.canonical.x,U.canonical.y)._rotate(this.transform.angle);return P.overscaledZ-U.overscaledZ||$.y-V.y||$.x-V.x}).map(w=>w.tileID.key):A.map(w=>w.tileID).sort(an).map(w=>w.key)}hasRenderableParent(c){let A=this.findLoadedParent(c,0);return!!A&&this._isIdRenderable(A.tileID.key)}_isIdRenderable(c,A){return this._tiles[c]&&this._tiles[c].hasData()&&!this._coveredTiles[c]&&(A||!this._tiles[c].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(let c in this._tiles)this._tiles[c].state!=="errored"&&this._reloadTile(c,"reloading")}}_reloadTile(c,A){let w=this._tiles[c];w&&(w.state!=="loading"&&(w.state=A),this._loadTile(w,this._tileLoaded.bind(this,w,c,A)))}_tileLoaded(c,A,w,E){if(E)return c.state="errored",void(E.status!==404?this._source.fire(new n.j(E,{tile:c})):this.update(this.transform,this.terrain));c.timeAdded=n.h.now(),w==="expired"&&(c.refreshedUponExpiration=!0),this._setTileReloadTimer(A,c),this.getSource().type==="raster-dem"&&c.dem&&this._backfillDEM(c),this._state.initializeTileState(c,this.map?this.map.painter:null),c.aborted||this._source.fire(new n.k("data",{dataType:"source",tile:c,coord:c.tileID}))}_backfillDEM(c){let A=this.getRenderableIds();for(let E=0;E<A.length;E++){let P=A[E];if(c.neighboringTiles&&c.neighboringTiles[P]){let U=this.getTileByID(P);w(c,U),w(U,c)}}function w(E,P){E.needsHillshadePrepare=!0,E.needsTerrainPrepare=!0;let U=P.tileID.canonical.x-E.tileID.canonical.x,V=P.tileID.canonical.y-E.tileID.canonical.y,$=Math.pow(2,E.tileID.canonical.z),G=P.tileID.key;U===0&&V===0||Math.abs(V)>1||(Math.abs(U)>1&&(Math.abs(U+$)===1?U+=$:Math.abs(U-$)===1&&(U-=$)),P.dem&&E.dem&&(E.dem.backfillBorder(P.dem,U,V),E.neighboringTiles&&E.neighboringTiles[G]&&(E.neighboringTiles[G].backfilled=!0)))}}getTile(c){return this.getTileByID(c.key)}getTileByID(c){return this._tiles[c]}_retainLoadedChildren(c,A,w,E){for(let P in this._tiles){let U=this._tiles[P];if(E[P]||!U.hasData()||U.tileID.overscaledZ<=A||U.tileID.overscaledZ>w)continue;let V=U.tileID;for(;U&&U.tileID.overscaledZ>A+1;){let G=U.tileID.scaledTo(U.tileID.overscaledZ-1);U=this._tiles[G.key],U&&U.hasData()&&(V=G)}let $=V;for(;$.overscaledZ>A;)if($=$.scaledTo($.overscaledZ-1),c[$.key]){E[V.key]=V;break}}}findLoadedParent(c,A){if(c.key in this._loadedParentTiles){let w=this._loadedParentTiles[c.key];return w&&w.tileID.overscaledZ>=A?w:null}for(let w=c.overscaledZ-1;w>=A;w--){let E=c.scaledTo(w),P=this._getLoadedTile(E);if(P)return P}}_getLoadedTile(c){let A=this._tiles[c.key];return A&&A.hasData()?A:this._cache.getByKey(c.wrapped().key)}updateCacheSize(c){let A=Math.ceil(c.width/this._source.tileSize)+1,w=Math.ceil(c.height/this._source.tileSize)+1,E=Math.floor(A*w*(this._maxTileCacheZoomLevels===null?n.c.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),P=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,E):E;this._cache.setMaxSize(P)}handleWrapJump(c){let A=Math.round((c-(this._prevLng===void 0?c:this._prevLng))/360);if(this._prevLng=c,A){let w={};for(let E in this._tiles){let P=this._tiles[E];P.tileID=P.tileID.unwrapTo(P.tileID.wrap+A),w[P.tileID.key]=P}this._tiles=w;for(let E in this._timers)clearTimeout(this._timers[E]),delete this._timers[E];for(let E in this._tiles)this._setTileReloadTimer(E,this._tiles[E])}}update(c,A){if(this.transform=c,this.terrain=A,!this._sourceLoaded||this._paused)return;let w;this.updateCacheSize(c),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?w=c.getVisibleUnwrappedCoordinates(this._source.tileID).map(J=>new n.O(J.canonical.z,J.wrap,J.canonical.z,J.canonical.x,J.canonical.y)):(w=c.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:A}),this._source.hasTile&&(w=w.filter(J=>this._source.hasTile(J)))):w=[];let E=c.coveringZoomLevel(this._source),P=Math.max(E-Gn.maxOverzooming,this._source.minzoom),U=Math.max(E+Gn.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){let J={};for(let tt of w)if(tt.canonical.z>this._source.minzoom){let lt=tt.scaledTo(tt.canonical.z-1);J[lt.key]=lt;let wt=tt.scaledTo(Math.max(this._source.minzoom,Math.min(tt.canonical.z,5)));J[wt.key]=wt}w=w.concat(Object.values(J))}let V=w.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,V&&this.fire(new n.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));let $=this._updateRetainedTiles(w,E);if(Ji(this._source.type)){let J={},tt={},lt=Object.keys($),wt=n.h.now();for(let bt of lt){let Rt=$[bt],yt=this._tiles[bt];if(!yt||yt.fadeEndTime!==0&&yt.fadeEndTime<=wt)continue;let Zt=this.findLoadedParent(Rt,P);Zt&&(this._addTile(Zt.tileID),J[Zt.tileID.key]=Zt.tileID),tt[bt]=Rt}this._retainLoadedChildren(tt,E,U,$);for(let bt in J)$[bt]||(this._coveredTiles[bt]=!0,$[bt]=J[bt]);if(A){let bt={},Rt={};for(let yt of w)this._tiles[yt.key].hasData()?bt[yt.key]=yt:Rt[yt.key]=yt;for(let yt in Rt){let Zt=Rt[yt].children(this._source.maxzoom);this._tiles[Zt[0].key]&&this._tiles[Zt[1].key]&&this._tiles[Zt[2].key]&&this._tiles[Zt[3].key]&&(bt[Zt[0].key]=$[Zt[0].key]=Zt[0],bt[Zt[1].key]=$[Zt[1].key]=Zt[1],bt[Zt[2].key]=$[Zt[2].key]=Zt[2],bt[Zt[3].key]=$[Zt[3].key]=Zt[3],delete Rt[yt])}for(let yt in Rt){let Zt=this.findLoadedParent(Rt[yt],this._source.minzoom);if(Zt){bt[Zt.tileID.key]=$[Zt.tileID.key]=Zt.tileID;for(let se in bt)bt[se].isChildOf(Zt.tileID)&&delete bt[se]}}for(let yt in this._tiles)bt[yt]||(this._coveredTiles[yt]=!0)}}for(let J in $)this._tiles[J].clearFadeHold();let G=n.ab(this._tiles,$);for(let J of G){let tt=this._tiles[J];tt.hasSymbolBuckets&&!tt.holdingForFade()?tt.setHoldDuration(this.map._fadeDuration):tt.hasSymbolBuckets&&!tt.symbolFadeFinished()||this._removeTile(J)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(let c in this._tiles)this._tiles[c].holdingForFade()&&this._removeTile(c)}_updateRetainedTiles(c,A){let w={},E={},P=Math.max(A-Gn.maxOverzooming,this._source.minzoom),U=Math.max(A+Gn.maxUnderzooming,this._source.minzoom),V={};for(let $ of c){let G=this._addTile($);w[$.key]=$,G.hasData()||A<this._source.maxzoom&&(V[$.key]=$)}this._retainLoadedChildren(V,A,U,w);for(let $ of c){let G=this._tiles[$.key];if(G.hasData())continue;if(A+1>this._source.maxzoom){let tt=$.children(this._source.maxzoom)[0],lt=this.getTile(tt);if(lt&&lt.hasData()){w[tt.key]=tt;continue}}else{let tt=$.children(this._source.maxzoom);if(w[tt[0].key]&&w[tt[1].key]&&w[tt[2].key]&&w[tt[3].key])continue}let J=G.wasRequested();for(let tt=$.overscaledZ-1;tt>=P;--tt){let lt=$.scaledTo(tt);if(E[lt.key])break;if(E[lt.key]=!0,G=this.getTile(lt),!G&&J&&(G=this._addTile(lt)),G){let wt=G.hasData();if((J||wt)&&(w[lt.key]=lt),J=G.wasRequested(),wt)break}}}return w}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(let c in this._tiles){let A=[],w,E=this._tiles[c].tileID;for(;E.overscaledZ>0;){if(E.key in this._loadedParentTiles){w=this._loadedParentTiles[E.key];break}A.push(E.key);let P=E.scaledTo(E.overscaledZ-1);if(w=this._getLoadedTile(P),w)break;E=P}for(let P of A)this._loadedParentTiles[P]=w}}_addTile(c){let A=this._tiles[c.key];if(A)return A;A=this._cache.getAndRemove(c),A&&(this._setTileReloadTimer(c.key,A),A.tileID=c,this._state.initializeTileState(A,this.map?this.map.painter:null),this._cacheTimers[c.key]&&(clearTimeout(this._cacheTimers[c.key]),delete this._cacheTimers[c.key],this._setTileReloadTimer(c.key,A)));let w=A;return A||(A=new fn(c,this._source.tileSize*c.overscaleFactor()),this._loadTile(A,this._tileLoaded.bind(this,A,c.key,A.state))),A.uses++,this._tiles[c.key]=A,w||this._source.fire(new n.k("dataloading",{tile:A,coord:A.tileID,dataType:"source"})),A}_setTileReloadTimer(c,A){c in this._timers&&(clearTimeout(this._timers[c]),delete this._timers[c]);let w=A.getExpiryTimeout();w&&(this._timers[c]=setTimeout(()=>{this._reloadTile(c,"expired"),delete this._timers[c]},w))}_removeTile(c){let A=this._tiles[c];A&&(A.uses--,delete this._tiles[c],this._timers[c]&&(clearTimeout(this._timers[c]),delete this._timers[c]),A.uses>0||(A.hasData()&&A.state!=="reloading"?this._cache.add(A.tileID,A,A.getExpiryTimeout()):(A.aborted=!0,this._abortTile(A),this._unloadTile(A))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(let c in this._tiles)this._removeTile(c);this._cache.reset()}tilesIn(c,A,w){let E=[],P=this.transform;if(!P)return E;let U=w?P.getCameraQueryGeometry(c):c,V=c.map(bt=>P.pointCoordinate(bt,this.terrain)),$=U.map(bt=>P.pointCoordinate(bt,this.terrain)),G=this.getIds(),J=1/0,tt=1/0,lt=-1/0,wt=-1/0;for(let bt of $)J=Math.min(J,bt.x),tt=Math.min(tt,bt.y),lt=Math.max(lt,bt.x),wt=Math.max(wt,bt.y);for(let bt=0;bt<G.length;bt++){let Rt=this._tiles[G[bt]];if(Rt.holdingForFade())continue;let yt=Rt.tileID,Zt=Math.pow(2,P.zoom-Rt.tileID.overscaledZ),se=A*Rt.queryPadding*n.N/Rt.tileSize/Zt,Bt=[yt.getTilePoint(new n.U(J,tt)),yt.getTilePoint(new n.U(lt,wt))];if(Bt[0].x-se<n.N&&Bt[0].y-se<n.N&&Bt[1].x+se>=0&&Bt[1].y+se>=0){let Gt=V.map(ce=>yt.getTilePoint(ce)),he=$.map(ce=>yt.getTilePoint(ce));E.push({tile:Rt,tileID:yt,queryGeometry:Gt,cameraQueryGeometry:he,scale:Zt})}}return E}getVisibleCoordinates(c){let A=this.getRenderableIds(c).map(w=>this._tiles[w].tileID);for(let w of A)w.posMatrix=this.transform.calculatePosMatrix(w.toUnwrapped());return A}hasTransition(){if(this._source.hasTransition())return!0;if(Ji(this._source.type)){let c=n.h.now();for(let A in this._tiles)if(this._tiles[A].fadeEndTime>=c)return!0}return!1}setFeatureState(c,A,w){this._state.updateState(c=c||"_geojsonTileLayer",A,w)}removeFeatureState(c,A,w){this._state.removeFeatureState(c=c||"_geojsonTileLayer",A,w)}getFeatureState(c,A){return this._state.getState(c=c||"_geojsonTileLayer",A)}setDependencies(c,A,w){let E=this._tiles[c];E&&E.setDependencies(A,w)}reloadTilesForDependencies(c,A){for(let w in this._tiles)this._tiles[w].hasDependency(c,A)&&this._reloadTile(w,"reloading");this._cache.filter(w=>!w.hasDependency(c,A))}}function an(M,c){let A=Math.abs(2*M.wrap)-+(M.wrap<0),w=Math.abs(2*c.wrap)-+(c.wrap<0);return M.overscaledZ-c.overscaledZ||w-A||c.canonical.y-M.canonical.y||c.canonical.x-M.canonical.x}function Ji(M){return M==="raster"||M==="image"||M==="video"}Gn.maxOverzooming=10,Gn.maxUnderzooming=3;let $i="mapboxgl_preloaded_worker_pool";class zo{constructor(){this.active={}}acquire(c){if(!this.workers)for(this.workers=[];this.workers.length<zo.workerCount;)this.workers.push(new Worker(n.c.WORKER_URL));return this.active[c]=!0,this.workers.slice()}release(c){delete this.active[c],this.numActive()===0&&(this.workers.forEach(A=>{A.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[$i]}numActive(){return Object.keys(this.active).length}}let Pu=Math.floor(n.h.hardwareConcurrency/2),Rl;function Zo(){return Rl||(Rl=new zo),Rl}zo.workerCount=n.ac(globalThis)?Math.max(Math.min(Pu,3),1):1;class kl{constructor(c,A){this.reset(c,A)}reset(c,A){this.points=c||[],this._distances=[0];for(let w=1;w<this.points.length;w++)this._distances[w]=this._distances[w-1]+this.points[w].dist(this.points[w-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(A||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(c){if(this.points.length===1)return this.points[0];c=n.ad(c,0,1);let A=1,w=this._distances[A],E=c*this.paddedLength+this.padding;for(;w<E&&A<this._distances.length;)w=this._distances[++A];let P=A-1,U=this._distances[P],V=w-U,$=V>0?(E-U)/V:0;return this.points[P].mult(1-$).add(this.points[A].mult($))}}function rl(M,c){let A=!0;return M==="always"||M!=="never"&&c!=="never"||(A=!1),A}class Go{constructor(c,A,w){let E=this.boxCells=[],P=this.circleCells=[];this.xCellCount=Math.ceil(c/w),this.yCellCount=Math.ceil(A/w);for(let U=0;U<this.xCellCount*this.yCellCount;U++)E.push([]),P.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=c,this.height=A,this.xScale=this.xCellCount/c,this.yScale=this.yCellCount/A,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(c,A,w,E,P){this._forEachCell(A,w,E,P,this._insertBoxCell,this.boxUid++),this.boxKeys.push(c),this.bboxes.push(A),this.bboxes.push(w),this.bboxes.push(E),this.bboxes.push(P)}insertCircle(c,A,w,E){this._forEachCell(A-E,w-E,A+E,w+E,this._insertCircleCell,this.circleUid++),this.circleKeys.push(c),this.circles.push(A),this.circles.push(w),this.circles.push(E)}_insertBoxCell(c,A,w,E,P,U){this.boxCells[P].push(U)}_insertCircleCell(c,A,w,E,P,U){this.circleCells[P].push(U)}_query(c,A,w,E,P,U,V){if(w<0||c>this.width||E<0||A>this.height)return[];let $=[];if(c<=0&&A<=0&&this.width<=w&&this.height<=E){if(P)return[{key:null,x1:c,y1:A,x2:w,y2:E}];for(let G=0;G<this.boxKeys.length;G++)$.push({key:this.boxKeys[G],x1:this.bboxes[4*G],y1:this.bboxes[4*G+1],x2:this.bboxes[4*G+2],y2:this.bboxes[4*G+3]});for(let G=0;G<this.circleKeys.length;G++){let J=this.circles[3*G],tt=this.circles[3*G+1],lt=this.circles[3*G+2];$.push({key:this.circleKeys[G],x1:J-lt,y1:tt-lt,x2:J+lt,y2:tt+lt})}}else this._forEachCell(c,A,w,E,this._queryCell,$,{hitTest:P,overlapMode:U,seenUids:{box:{},circle:{}}},V);return $}query(c,A,w,E){return this._query(c,A,w,E,!1,null)}hitTest(c,A,w,E,P,U){return this._query(c,A,w,E,!0,P,U).length>0}hitTestCircle(c,A,w,E,P){let U=c-w,V=c+w,$=A-w,G=A+w;if(V<0||U>this.width||G<0||$>this.height)return!1;let J=[];return this._forEachCell(U,$,V,G,this._queryCellCircle,J,{hitTest:!0,overlapMode:E,circle:{x:c,y:A,radius:w},seenUids:{box:{},circle:{}}},P),J.length>0}_queryCell(c,A,w,E,P,U,V,$){let{seenUids:G,hitTest:J,overlapMode:tt}=V,lt=this.boxCells[P];if(lt!==null){let bt=this.bboxes;for(let Rt of lt)if(!G.box[Rt]){G.box[Rt]=!0;let yt=4*Rt,Zt=this.boxKeys[Rt];if(c<=bt[yt+2]&&A<=bt[yt+3]&&w>=bt[yt+0]&&E>=bt[yt+1]&&(!$||$(Zt))&&(!J||!rl(tt,Zt.overlapMode))&&(U.push({key:Zt,x1:bt[yt],y1:bt[yt+1],x2:bt[yt+2],y2:bt[yt+3]}),J))return!0}}let wt=this.circleCells[P];if(wt!==null){let bt=this.circles;for(let Rt of wt)if(!G.circle[Rt]){G.circle[Rt]=!0;let yt=3*Rt,Zt=this.circleKeys[Rt];if(this._circleAndRectCollide(bt[yt],bt[yt+1],bt[yt+2],c,A,w,E)&&(!$||$(Zt))&&(!J||!rl(tt,Zt.overlapMode))){let se=bt[yt],Bt=bt[yt+1],Gt=bt[yt+2];if(U.push({key:Zt,x1:se-Gt,y1:Bt-Gt,x2:se+Gt,y2:Bt+Gt}),J)return!0}}}return!1}_queryCellCircle(c,A,w,E,P,U,V,$){let{circle:G,seenUids:J,overlapMode:tt}=V,lt=this.boxCells[P];if(lt!==null){let bt=this.bboxes;for(let Rt of lt)if(!J.box[Rt]){J.box[Rt]=!0;let yt=4*Rt,Zt=this.boxKeys[Rt];if(this._circleAndRectCollide(G.x,G.y,G.radius,bt[yt+0],bt[yt+1],bt[yt+2],bt[yt+3])&&(!$||$(Zt))&&!rl(tt,Zt.overlapMode))return U.push(!0),!0}}let wt=this.circleCells[P];if(wt!==null){let bt=this.circles;for(let Rt of wt)if(!J.circle[Rt]){J.circle[Rt]=!0;let yt=3*Rt,Zt=this.circleKeys[Rt];if(this._circlesCollide(bt[yt],bt[yt+1],bt[yt+2],G.x,G.y,G.radius)&&(!$||$(Zt))&&!rl(tt,Zt.overlapMode))return U.push(!0),!0}}}_forEachCell(c,A,w,E,P,U,V,$){let G=this._convertToXCellCoord(c),J=this._convertToYCellCoord(A),tt=this._convertToXCellCoord(w),lt=this._convertToYCellCoord(E);for(let wt=G;wt<=tt;wt++)for(let bt=J;bt<=lt;bt++)if(P.call(this,c,A,w,E,this.xCellCount*bt+wt,U,V,$))return}_convertToXCellCoord(c){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(c*this.xScale)))}_convertToYCellCoord(c){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(c*this.yScale)))}_circlesCollide(c,A,w,E,P,U){let V=E-c,$=P-A,G=w+U;return G*G>V*V+$*$}_circleAndRectCollide(c,A,w,E,P,U,V){let $=(U-E)/2,G=Math.abs(c-(E+$));if(G>$+w)return!1;let J=(V-P)/2,tt=Math.abs(A-(P+J));if(tt>J+w)return!1;if(G<=$||tt<=J)return!0;let lt=G-$,wt=tt-J;return lt*lt+wt*wt<=w*w}}function Ne(M,c,A,w,E){let P=n.Z();return c?(n.a0(P,P,[1/E,1/E,1]),A||n.ae(P,P,w.angle)):n.a1(P,w.labelPlaneMatrix,M),P}function la(M,c,A,w,E){if(c){let P=n.af(M);return n.a0(P,P,[E,E,1]),A||n.ae(P,P,-w.angle),P}return w.glCoordMatrix}function Qn(M,c,A){let w;A?(w=[M.x,M.y,A(M.x,M.y),1],n.ag(w,w,c)):(w=[M.x,M.y,0,1],Dt(w,w,c));let E=w[3];return{point:new n.P(w[0]/E,w[1]/E),signedDistanceFromCamera:E}}function nc(M,c){return .5+M/c*.5}function il(M,c){let A=M[0]/M[3],w=M[1]/M[3];return A>=-c[0]&&A<=c[0]&&w>=-c[1]&&w<=c[1]}function Ue(M,c,A,w,E,P,U,V,$,G){let J=w?M.textSizeData:M.iconSizeData,tt=n.ah(J,A.transform.zoom),lt=[256/A.width*2+1,256/A.height*2+1],wt=w?M.text.dynamicLayoutVertexArray:M.icon.dynamicLayoutVertexArray;wt.clear();let bt=M.lineVertexArray,Rt=w?M.text.placedSymbolArray:M.icon.placedSymbolArray,yt=A.transform.width/A.transform.height,Zt=!1;for(let se=0;se<Rt.length;se++){let Bt=Rt.get(se);if(Bt.hidden||Bt.writingMode===n.ai.vertical&&!Zt){mt(Bt.numGlyphs,wt);continue}let Gt;if(Zt=!1,G?(Gt=[Bt.anchorX,Bt.anchorY,G(Bt.anchorX,Bt.anchorY),1],n.ag(Gt,Gt,c)):(Gt=[Bt.anchorX,Bt.anchorY,0,1],Dt(Gt,Gt,c)),!il(Gt,lt)){mt(Bt.numGlyphs,wt);continue}let he=nc(A.transform.cameraToCenterDistance,Gt[3]),ce=n.aj(J,tt,Bt),xe=U?ce/he:ce*he,Pe=new n.P(Bt.anchorX,Bt.anchorY),Te=Qn(Pe,E,G).point,Le={projections:{},offsets:{}},hr=xo(Bt,xe,!1,V,c,E,P,M.glyphOffsetArray,bt,wt,Te,Pe,Le,yt,$,G);Zt=hr.useVertical,(hr.notEnoughRoom||Zt||hr.needsFlipping&&xo(Bt,xe,!0,V,c,E,P,M.glyphOffsetArray,bt,wt,Te,Pe,Le,yt,$,G).notEnoughRoom)&&mt(Bt.numGlyphs,wt)}w?M.text.dynamicLayoutVertexBuffer.updateData(wt):M.icon.dynamicLayoutVertexBuffer.updateData(wt)}function ni(M,c,A,w,E,P,U,V,$,G,J,tt,lt){let wt=V.glyphStartIndex+V.numGlyphs,bt=V.lineStartIndex,Rt=V.lineStartIndex+V.lineLength,yt=c.getoffsetX(V.glyphStartIndex),Zt=c.getoffsetX(wt-1),se=rt(M*yt,A,w,E,P,U,V.segment,bt,Rt,$,G,J,tt,lt);if(!se)return null;let Bt=rt(M*Zt,A,w,E,P,U,V.segment,bt,Rt,$,G,J,tt,lt);return Bt?{first:se,last:Bt}:null}function Nr(M,c,A,w){return M===n.ai.horizontal&&Math.abs(A.y-c.y)>Math.abs(A.x-c.x)*w?{useVertical:!0}:(M===n.ai.vertical?c.y<A.y:c.x>A.x)?{needsFlipping:!0}:null}function xo(M,c,A,w,E,P,U,V,$,G,J,tt,lt,wt,bt,Rt){let yt=c/24,Zt=M.lineOffsetX*yt,se=M.lineOffsetY*yt,Bt;if(M.numGlyphs>1){let Gt=M.glyphStartIndex+M.numGlyphs,he=M.lineStartIndex,ce=M.lineStartIndex+M.lineLength,xe=ni(yt,V,Zt,se,A,J,tt,M,$,P,lt,bt,Rt);if(!xe)return{notEnoughRoom:!0};let Pe=Qn(xe.first.point,U,Rt).point,Te=Qn(xe.last.point,U,Rt).point;if(w&&!A){let Le=Nr(M.writingMode,Pe,Te,wt);if(Le)return Le}Bt=[xe.first];for(let Le=M.glyphStartIndex+1;Le<Gt-1;Le++)Bt.push(rt(yt*V.getoffsetX(Le),Zt,se,A,J,tt,M.segment,he,ce,$,P,lt,bt,Rt));Bt.push(xe.last)}else{if(w&&!A){let he=Qn(tt,E,Rt).point,ce=M.lineStartIndex+M.segment+1,xe=new n.P($.getx(ce),$.gety(ce)),Pe=Qn(xe,E,Rt),Te=Pe.signedDistanceFromCamera>0?Pe.point:nl(tt,xe,he,1,E,Rt),Le=Nr(M.writingMode,he,Te,wt);if(Le)return Le}let Gt=rt(yt*V.getoffsetX(M.glyphStartIndex),Zt,se,A,J,tt,M.segment,M.lineStartIndex,M.lineStartIndex+M.lineLength,$,P,lt,bt,Rt);if(!Gt)return{notEnoughRoom:!0};Bt=[Gt]}for(let Gt of Bt)n.ak(G,Gt.point,Gt.angle);return{}}function nl(M,c,A,w,E,P){let U=Qn(M.add(M.sub(c)._unit()),E,P).point,V=A.sub(U);return A.add(V._mult(w/V.mag()))}function qr(M,c){let{projectionCache:A,lineVertexArray:w,labelPlaneMatrix:E,tileAnchorPoint:P,distanceFromAnchor:U,getElevation:V,previousVertex:$,direction:G,absOffsetX:J}=c;if(A.projections[M])return A.projections[M];let tt=new n.P(w.getx(M),w.gety(M)),lt=Qn(tt,E,V);if(lt.signedDistanceFromCamera>0)return A.projections[M]=lt.point,lt.point;let wt=M-G;return nl(U===0?P:new n.P(w.getx(wt),w.gety(wt)),tt,$,J-U+1,E,V)}function Ma(M,c,A){return M._unit()._perp()._mult(c*A)}function Ct(M,c,A,w,E,P,U,V){let{projectionCache:$,direction:G}=V;if($.offsets[M])return $.offsets[M];let J=A.add(c);if(M+G<w||M+G>=E)return $.offsets[M]=J,J;let tt=qr(M+G,V),lt=Ma(tt.sub(A),U,G),wt=A.add(lt),bt=tt.add(lt);return $.offsets[M]=n.al(P,J,wt,bt)||J,$.offsets[M]}function rt(M,c,A,w,E,P,U,V,$,G,J,tt,lt,wt){let bt=w?M-c:M+c,Rt=bt>0?1:-1,yt=0;w&&(Rt*=-1,yt=Math.PI),Rt<0&&(yt+=Math.PI);let Zt,se,Bt=Rt>0?V+U:V+U+1,Gt=E,he=E,ce=0,xe=0,Pe=Math.abs(bt),Te=[],Le;for(;ce+xe<=Pe;){if(Bt+=Rt,Bt<V||Bt>=$)return null;ce+=xe,he=Gt,se=Zt;let He={projectionCache:tt,lineVertexArray:G,labelPlaneMatrix:J,tileAnchorPoint:P,distanceFromAnchor:ce,getElevation:wt,previousVertex:he,direction:Rt,absOffsetX:Pe};if(Gt=qr(Bt,He),A===0)Te.push(he),Le=Gt.sub(he);else{let Cr,fr=Gt.sub(he);Cr=fr.mag()===0?Ma(qr(Bt+Rt,He).sub(Gt),A,Rt):Ma(fr,A,Rt),se||(se=he.add(Cr)),Zt=Ct(Bt,Cr,Gt,V,$,se,A,He),Te.push(se),Le=Zt.sub(se)}xe=Le.mag()}let hr=Le._mult((Pe-ce)/xe)._add(se||he),Di=yt+Math.atan2(Gt.y-he.y,Gt.x-he.x);return Te.push(hr),{point:hr,angle:lt?Di:0,path:Te}}let at=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function mt(M,c){for(let A=0;A<M;A++){let w=c.length;c.resize(w+4),c.float32.set(at,3*w)}}function Dt(M,c,A){let w=c[0],E=c[1];return M[0]=A[0]*w+A[4]*E+A[12],M[1]=A[1]*w+A[5]*E+A[13],M[3]=A[3]*w+A[7]*E+A[15],M}let Ot=100;class It{constructor(c,A=new Go(c.width+200,c.height+200,25),w=new Go(c.width+200,c.height+200,25)){this.transform=c,this.grid=A,this.ignoredGrid=w,this.pitchfactor=Math.cos(c._pitch)*c.cameraToCenterDistance,this.screenRightBoundary=c.width+Ot,this.screenBottomBoundary=c.height+Ot,this.gridRightBoundary=c.width+200,this.gridBottomBoundary=c.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(c,A,w,E,P,U){let V=this.projectAndGetPerspectiveRatio(E,c.anchorPointX,c.anchorPointY,U),$=w*V.perspectiveRatio,G=c.x1*$+V.point.x,J=c.y1*$+V.point.y,tt=c.x2*$+V.point.x,lt=c.y2*$+V.point.y;return!this.isInsideGrid(G,J,tt,lt)||A!=="always"&&this.grid.hitTest(G,J,tt,lt,A,P)||V.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[G,J,tt,lt],offscreen:this.isOffscreen(G,J,tt,lt)}}placeCollisionCircles(c,A,w,E,P,U,V,$,G,J,tt,lt,wt,bt){let Rt=[],yt=new n.P(A.anchorX,A.anchorY),Zt=Qn(yt,U,bt),se=nc(this.transform.cameraToCenterDistance,Zt.signedDistanceFromCamera),Bt=(J?P/se:P*se)/n.ap,Gt=Qn(yt,V,bt).point,he=ni(Bt,E,A.lineOffsetX*Bt,A.lineOffsetY*Bt,!1,Gt,yt,A,w,V,{projections:{},offsets:{}},!1,bt),ce=!1,xe=!1,Pe=!0;if(he){let Te=.5*lt*se+wt,Le=new n.P(-100,-100),hr=new n.P(this.screenRightBoundary,this.screenBottomBoundary),Di=new kl,He=he.first,Cr=he.last,fr=[];for(let fi=He.path.length-1;fi>=1;fi--)fr.push(He.path[fi]);for(let fi=1;fi<Cr.path.length;fi++)fr.push(Cr.path[fi]);let dn=2.5*Te;if($){let fi=fr.map(Oi=>Qn(Oi,$,bt));fr=fi.some(Oi=>Oi.signedDistanceFromCamera<=0)?[]:fi.map(Oi=>Oi.point)}let Ci=[];if(fr.length>0){let fi=fr[0].clone(),Oi=fr[0].clone();for(let Ts=1;Ts<fr.length;Ts++)fi.x=Math.min(fi.x,fr[Ts].x),fi.y=Math.min(fi.y,fr[Ts].y),Oi.x=Math.max(Oi.x,fr[Ts].x),Oi.y=Math.max(Oi.y,fr[Ts].y);Ci=fi.x>=Le.x&&Oi.x<=hr.x&&fi.y>=Le.y&&Oi.y<=hr.y?[fr]:Oi.x<Le.x||fi.x>hr.x||Oi.y<Le.y||fi.y>hr.y?[]:n.am([fr],Le.x,Le.y,hr.x,hr.y)}for(let fi of Ci){Di.reset(fi,.25*Te);let Oi=0;Oi=Di.length<=.5*Te?1:Math.ceil(Di.paddedLength/dn)+1;for(let Ts=0;Ts<Oi;Ts++){let Un=Ts/Math.max(Oi-1,1),vo=Di.lerp(Un),Gs=vo.x+Ot,Ss=vo.y+Ot;Rt.push(Gs,Ss,Te,0);let Oa=Gs-Te,Vn=Ss-Te,co=Gs+Te,Bl=Ss+Te;if(Pe=Pe&&this.isOffscreen(Oa,Vn,co,Bl),xe=xe||this.isInsideGrid(Oa,Vn,co,Bl),c!=="always"&&this.grid.hitTestCircle(Gs,Ss,Te,c,tt)&&(ce=!0,!G))return{circles:[],offscreen:!1,collisionDetected:ce}}}}return{circles:!G&&ce||!xe||se<this.perspectiveRatioCutoff?[]:Rt,offscreen:Pe,collisionDetected:ce}}queryRenderedSymbols(c){if(c.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};let A=[],w=1/0,E=1/0,P=-1/0,U=-1/0;for(let J of c){let tt=new n.P(J.x+Ot,J.y+Ot);w=Math.min(w,tt.x),E=Math.min(E,tt.y),P=Math.max(P,tt.x),U=Math.max(U,tt.y),A.push(tt)}let V=this.grid.query(w,E,P,U).concat(this.ignoredGrid.query(w,E,P,U)),$={},G={};for(let J of V){let tt=J.key;if($[tt.bucketInstanceId]===void 0&&($[tt.bucketInstanceId]={}),$[tt.bucketInstanceId][tt.featureIndex])continue;let lt=[new n.P(J.x1,J.y1),new n.P(J.x2,J.y1),new n.P(J.x2,J.y2),new n.P(J.x1,J.y2)];n.an(A,lt)&&($[tt.bucketInstanceId][tt.featureIndex]=!0,G[tt.bucketInstanceId]===void 0&&(G[tt.bucketInstanceId]=[]),G[tt.bucketInstanceId].push(tt.featureIndex))}return G}insertCollisionBox(c,A,w,E,P,U){(w?this.ignoredGrid:this.grid).insert({bucketInstanceId:E,featureIndex:P,collisionGroupID:U,overlapMode:A},c[0],c[1],c[2],c[3])}insertCollisionCircles(c,A,w,E,P,U){let V=w?this.ignoredGrid:this.grid,$={bucketInstanceId:E,featureIndex:P,collisionGroupID:U,overlapMode:A};for(let G=0;G<c.length;G+=4)V.insertCircle($,c[G],c[G+1],c[G+2])}projectAndGetPerspectiveRatio(c,A,w,E){let P;return E?(P=[A,w,E(A,w),1],n.ag(P,P,c)):(P=[A,w,0,1],Dt(P,P,c)),{point:new n.P((P[0]/P[3]+1)/2*this.transform.width+Ot,(-P[1]/P[3]+1)/2*this.transform.height+Ot),perspectiveRatio:.5+this.transform.cameraToCenterDistance/P[3]*.5}}isOffscreen(c,A,w,E){return w<Ot||c>=this.screenRightBoundary||E<Ot||A>this.screenBottomBoundary}isInsideGrid(c,A,w,E){return w>=0&&c<this.gridRightBoundary&&E>=0&&A<this.gridBottomBoundary}getViewportMatrix(){let c=n.ao([]);return n.$(c,c,[-100,-100,0]),c}}function Yt(M,c,A){return c*(n.N/(M.tileSize*Math.pow(2,A-M.tileID.overscaledZ)))}class Ft{constructor(c,A,w,E){this.opacity=c?Math.max(0,Math.min(1,c.opacity+(c.placed?A:-A))):E&&w?1:0,this.placed=w}isHidden(){return this.opacity===0&&!this.placed}}class Qt{constructor(c,A,w,E,P){this.text=new Ft(c?c.text:null,A,w,P),this.icon=new Ft(c?c.icon:null,A,E,P)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class _e{constructor(c,A,w){this.text=c,this.icon=A,this.skipFade=w}}class ye{constructor(){this.invProjMatrix=n.Z(),this.viewportMatrix=n.Z(),this.circles=[]}}class be{constructor(c,A,w,E,P){this.bucketInstanceId=c,this.featureIndex=A,this.sourceLayerIndex=w,this.bucketIndex=E,this.tileID=P}}class br{constructor(c){this.crossSourceCollisions=c,this.maxGroupID=0,this.collisionGroups={}}get(c){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[c]){let A=++this.maxGroupID;this.collisionGroups[c]={ID:A,predicate:w=>w.collisionGroupID===A}}return this.collisionGroups[c]}}function Lr(M,c,A,w,E){let{horizontalAlign:P,verticalAlign:U}=n.au(M);return new n.P(-(P-.5)*c+w[0]*E,-(U-.5)*A+w[1]*E)}function cr(M,c,A,w,E,P){let{x1:U,x2:V,y1:$,y2:G,anchorPointX:J,anchorPointY:tt}=M,lt=new n.P(c,A);return w&&lt._rotate(E?P:-P),{x1:U+lt.x,y1:$+lt.y,x2:V+lt.x,y2:G+lt.y,anchorPointX:J,anchorPointY:tt}}class vr{constructor(c,A,w,E,P){this.transform=c.clone(),this.terrain=A,this.collisionIndex=new It(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=w,this.retainedQueryData={},this.collisionGroups=new br(E),this.collisionCircleArrays={},this.prevPlacement=P,P&&(P.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(c,A,w,E){let P=w.getBucket(A),U=w.latestFeatureIndex;if(!P||!U||A.id!==P.layerIds[0])return;let V=w.collisionBoxArray,$=P.layers[0].layout,G=Math.pow(2,this.transform.zoom-w.tileID.overscaledZ),J=w.tileSize/n.N,tt=this.transform.calculatePosMatrix(w.tileID.toUnwrapped()),lt=$.get("text-pitch-alignment")==="map",wt=$.get("text-rotation-alignment")==="map",bt=Yt(w,1,this.transform.zoom),Rt=Ne(tt,lt,wt,this.transform,bt),yt=null;if(lt){let se=la(tt,lt,wt,this.transform,bt);yt=n.a1([],this.transform.labelPlaneMatrix,se)}this.retainedQueryData[P.bucketInstanceId]=new be(P.bucketInstanceId,U,P.sourceLayerIndex,P.index,w.tileID);let Zt={bucket:P,layout:$,posMatrix:tt,textLabelPlaneMatrix:Rt,labelToScreenMatrix:yt,scale:G,textPixelRatio:J,holdingForFade:w.holdingForFade(),collisionBoxArray:V,partiallyEvaluatedTextSize:n.ah(P.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(P.sourceID)};if(E)for(let se of P.sortKeyRanges){let{sortKey:Bt,symbolInstanceStart:Gt,symbolInstanceEnd:he}=se;c.push({sortKey:Bt,symbolInstanceStart:Gt,symbolInstanceEnd:he,parameters:Zt})}else c.push({symbolInstanceStart:0,symbolInstanceEnd:P.symbolInstances.length,parameters:Zt})}attemptAnchorPlacement(c,A,w,E,P,U,V,$,G,J,tt,lt,wt,bt,Rt,yt){let Zt=n.aq[c.textAnchor],se=[c.textOffset0,c.textOffset1],Bt=Lr(Zt,w,E,se,P),Gt=this.collisionIndex.placeCollisionBox(cr(A,Bt.x,Bt.y,U,V,this.transform.angle),tt,$,G,J.predicate,yt);if((!Rt||this.collisionIndex.placeCollisionBox(cr(Rt,Bt.x,Bt.y,U,V,this.transform.angle),tt,$,G,J.predicate,yt).box.length!==0)&&Gt.box.length>0){let he;if(this.prevPlacement&&this.prevPlacement.variableOffsets[lt.crossTileID]&&this.prevPlacement.placements[lt.crossTileID]&&this.prevPlacement.placements[lt.crossTileID].text&&(he=this.prevPlacement.variableOffsets[lt.crossTileID].anchor),lt.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[lt.crossTileID]={textOffset:se,width:w,height:E,anchor:Zt,textBoxScale:P,prevAnchor:he},this.markUsedJustification(wt,Zt,lt,bt),wt.allowVerticalPlacement&&(this.markUsedOrientation(wt,bt,lt),this.placedOrientations[lt.crossTileID]=bt),{shift:Bt,placedGlyphBoxes:Gt}}}placeLayerBucketPart(c,A,w){let{bucket:E,layout:P,posMatrix:U,textLabelPlaneMatrix:V,labelToScreenMatrix:$,textPixelRatio:G,holdingForFade:J,collisionBoxArray:tt,partiallyEvaluatedTextSize:lt,collisionGroup:wt}=c.parameters,bt=P.get("text-optional"),Rt=P.get("icon-optional"),yt=n.ar(P,"text-overlap","text-allow-overlap"),Zt=yt==="always",se=n.ar(P,"icon-overlap","icon-allow-overlap"),Bt=se==="always",Gt=P.get("text-rotation-alignment")==="map",he=P.get("text-pitch-alignment")==="map",ce=P.get("icon-text-fit")!=="none",xe=P.get("symbol-z-order")==="viewport-y",Pe=Zt&&(Bt||!E.hasIconData()||Rt),Te=Bt&&(Zt||!E.hasTextData()||bt);!E.collisionArrays&&tt&&E.deserializeCollisionBoxes(tt);let Le=this.retainedQueryData[E.bucketInstanceId].tileID,hr=this.terrain?(He,Cr)=>this.terrain.getElevation(Le,He,Cr):null,Di=(He,Cr)=>{var fr,dn;if(A[He.crossTileID])return;if(J)return void(this.placements[He.crossTileID]=new _e(!1,!1,!1));let Ci=!1,fi=!1,Oi=!0,Ts=null,Un={box:null,offscreen:null},vo={box:null,offscreen:null},Gs=null,Ss=null,Oa=null,Vn=0,co=0,Bl=0;Cr.textFeatureIndex?Vn=Cr.textFeatureIndex:He.useRuntimeCollisionCircles&&(Vn=He.featureIndex),Cr.verticalTextFeatureIndex&&(co=Cr.verticalTextFeatureIndex);let Fu=Cr.textBox;if(Fu){let Vo=ps=>{let Qs=n.ai.horizontal;if(E.allowVerticalPlacement&&!ps&&this.prevPlacement){let da=this.prevPlacement.placedOrientations[He.crossTileID];da&&(this.placedOrientations[He.crossTileID]=da,Qs=da,this.markUsedOrientation(E,Qs,He))}return Qs},wo=(ps,Qs)=>{if(E.allowVerticalPlacement&&He.numVerticalGlyphVertices>0&&Cr.verticalTextBox){for(let da of E.writingModes)if(da===n.ai.vertical?(Un=Qs(),vo=Un):Un=ps(),Un&&Un.box&&Un.box.length)break}else Un=ps()},Es=He.textAnchorOffsetStartIndex,zu=He.textAnchorOffsetEndIndex;if(zu===Es){let ps=(Qs,da)=>{let Is=this.collisionIndex.placeCollisionBox(Qs,yt,G,U,wt.predicate,hr);return Is&&Is.box&&Is.box.length&&(this.markUsedOrientation(E,da,He),this.placedOrientations[He.crossTileID]=da),Is};wo(()=>ps(Fu,n.ai.horizontal),()=>{let Qs=Cr.verticalTextBox;return E.allowVerticalPlacement&&He.numVerticalGlyphVertices>0&&Qs?ps(Qs,n.ai.vertical):{box:null,offscreen:null}}),Vo(Un&&Un.box&&Un.box.length)}else{let ps=n.aq[(dn=(fr=this.prevPlacement)===null||fr===void 0?void 0:fr.variableOffsets[He.crossTileID])===null||dn===void 0?void 0:dn.anchor],Qs=(Is,Uh,fm)=>{let py=Is.x2-Is.x1,dy=Is.y2-Is.y1,Wb=He.textBoxScale,yg=ce&&se==="never"?Uh:null,dc={box:[],offscreen:!1},Vh=yt==="never"?1:2,Nl="never";ps&&Vh++;for(let Ba=0;Ba<Vh;Ba++){for(let Cn=Es;Cn<zu;Cn++){let xg=E.textAnchorOffsets.get(Cn);if(ps&&xg.textAnchor!==ps)continue;let iu=this.attemptAnchorPlacement(xg,Is,py,dy,Wb,Gt,he,G,U,wt,Nl,He,E,fm,yg,hr);if(iu&&(dc=iu.placedGlyphBoxes,dc&&dc.box&&dc.box.length))return Ci=!0,Ts=iu.shift,dc}ps?ps=null:Nl=yt}return dc};wo(()=>Qs(Fu,Cr.iconBox,n.ai.horizontal),()=>{let Is=Cr.verticalTextBox;return E.allowVerticalPlacement&&!(Un&&Un.box&&Un.box.length)&&He.numVerticalGlyphVertices>0&&Is?Qs(Is,Cr.verticalIconBox,n.ai.vertical):{box:null,offscreen:null}}),Un&&(Ci=Un.box,Oi=Un.offscreen);let da=Vo(Un&&Un.box);if(!Ci&&this.prevPlacement){let Is=this.prevPlacement.variableOffsets[He.crossTileID];Is&&(this.variableOffsets[He.crossTileID]=Is,this.markUsedJustification(E,Is.anchor,He,da))}}}if(Gs=Un,Ci=Gs&&Gs.box&&Gs.box.length>0,Oi=Gs&&Gs.offscreen,He.useRuntimeCollisionCircles){let Vo=E.text.placedSymbolArray.get(He.centerJustifiedTextSymbolIndex),wo=n.aj(E.textSizeData,lt,Vo),Es=P.get("text-padding");Ss=this.collisionIndex.placeCollisionCircles(yt,Vo,E.lineVertexArray,E.glyphOffsetArray,wo,U,V,$,w,he,wt.predicate,He.collisionCircleDiameter,Es,hr),Ss.circles.length&&Ss.collisionDetected&&!w&&n.w("Collisions detected, but collision boxes are not shown"),Ci=Zt||Ss.circles.length>0&&!Ss.collisionDetected,Oi=Oi&&Ss.offscreen}if(Cr.iconFeatureIndex&&(Bl=Cr.iconFeatureIndex),Cr.iconBox){let Vo=wo=>{let Es=ce&&Ts?cr(wo,Ts.x,Ts.y,Gt,he,this.transform.angle):wo;return this.collisionIndex.placeCollisionBox(Es,se,G,U,wt.predicate,hr)};vo&&vo.box&&vo.box.length&&Cr.verticalIconBox?(Oa=Vo(Cr.verticalIconBox),fi=Oa.box.length>0):(Oa=Vo(Cr.iconBox),fi=Oa.box.length>0),Oi=Oi&&Oa.offscreen}let zh=bt||He.numHorizontalGlyphVertices===0&&He.numVerticalGlyphVertices===0,Wf=Rt||He.numIconVertices===0;if(zh||Wf?Wf?zh||(fi=fi&&Ci):Ci=fi&&Ci:fi=Ci=fi&&Ci,Ci&&Gs&&Gs.box&&this.collisionIndex.insertCollisionBox(Gs.box,yt,P.get("text-ignore-placement"),E.bucketInstanceId,vo&&vo.box&&co?co:Vn,wt.ID),fi&&Oa&&this.collisionIndex.insertCollisionBox(Oa.box,se,P.get("icon-ignore-placement"),E.bucketInstanceId,Bl,wt.ID),Ss&&(Ci&&this.collisionIndex.insertCollisionCircles(Ss.circles,yt,P.get("text-ignore-placement"),E.bucketInstanceId,Vn,wt.ID),w)){let Vo=E.bucketInstanceId,wo=this.collisionCircleArrays[Vo];wo===void 0&&(wo=this.collisionCircleArrays[Vo]=new ye);for(let Es=0;Es<Ss.circles.length;Es+=4)wo.circles.push(Ss.circles[Es+0]),wo.circles.push(Ss.circles[Es+1]),wo.circles.push(Ss.circles[Es+2]),wo.circles.push(Ss.collisionDetected?1:0)}if(He.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(E.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[He.crossTileID]=new _e(Ci||Pe,fi||Te,Oi||E.justReloaded),A[He.crossTileID]=!0};if(xe){if(c.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");let He=E.getSortedSymbolIndexes(this.transform.angle);for(let Cr=He.length-1;Cr>=0;--Cr){let fr=He[Cr];Di(E.symbolInstances.get(fr),E.collisionArrays[fr])}}else for(let He=c.symbolInstanceStart;He<c.symbolInstanceEnd;He++)Di(E.symbolInstances.get(He),E.collisionArrays[He]);if(w&&E.bucketInstanceId in this.collisionCircleArrays){let He=this.collisionCircleArrays[E.bucketInstanceId];n.as(He.invProjMatrix,U),He.viewportMatrix=this.collisionIndex.getViewportMatrix()}E.justReloaded=!1}markUsedJustification(c,A,w,E){let P;P=E===n.ai.vertical?w.verticalPlacedTextSymbolIndex:{left:w.leftJustifiedTextSymbolIndex,center:w.centerJustifiedTextSymbolIndex,right:w.rightJustifiedTextSymbolIndex}[n.at(A)];let U=[w.leftJustifiedTextSymbolIndex,w.centerJustifiedTextSymbolIndex,w.rightJustifiedTextSymbolIndex,w.verticalPlacedTextSymbolIndex];for(let V of U)V>=0&&(c.text.placedSymbolArray.get(V).crossTileID=P>=0&&V!==P?0:w.crossTileID)}markUsedOrientation(c,A,w){let E=A===n.ai.horizontal||A===n.ai.horizontalOnly?A:0,P=A===n.ai.vertical?A:0,U=[w.leftJustifiedTextSymbolIndex,w.centerJustifiedTextSymbolIndex,w.rightJustifiedTextSymbolIndex];for(let V of U)c.text.placedSymbolArray.get(V).placedOrientation=E;w.verticalPlacedTextSymbolIndex&&(c.text.placedSymbolArray.get(w.verticalPlacedTextSymbolIndex).placedOrientation=P)}commit(c){this.commitTime=c,this.zoomAtLastRecencyCheck=this.transform.zoom;let A=this.prevPlacement,w=!1;this.prevZoomAdjustment=A?A.zoomAdjustment(this.transform.zoom):0;let E=A?A.symbolFadeChange(c):1,P=A?A.opacities:{},U=A?A.variableOffsets:{},V=A?A.placedOrientations:{};for(let $ in this.placements){let G=this.placements[$],J=P[$];J?(this.opacities[$]=new Qt(J,E,G.text,G.icon),w=w||G.text!==J.text.placed||G.icon!==J.icon.placed):(this.opacities[$]=new Qt(null,E,G.text,G.icon,G.skipFade),w=w||G.text||G.icon)}for(let $ in P){let G=P[$];if(!this.opacities[$]){let J=new Qt(G,E,!1,!1);J.isHidden()||(this.opacities[$]=J,w=w||G.text.placed||G.icon.placed)}}for(let $ in U)this.variableOffsets[$]||!this.opacities[$]||this.opacities[$].isHidden()||(this.variableOffsets[$]=U[$]);for(let $ in V)this.placedOrientations[$]||!this.opacities[$]||this.opacities[$].isHidden()||(this.placedOrientations[$]=V[$]);if(A&&A.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");w?this.lastPlacementChangeTime=c:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=A?A.lastPlacementChangeTime:c)}updateLayerOpacities(c,A){let w={};for(let E of A){let P=E.getBucket(c);P&&E.latestFeatureIndex&&c.id===P.layerIds[0]&&this.updateBucketOpacities(P,w,E.collisionBoxArray)}}updateBucketOpacities(c,A,w){c.hasTextData()&&(c.text.opacityVertexArray.clear(),c.text.hasVisibleVertices=!1),c.hasIconData()&&(c.icon.opacityVertexArray.clear(),c.icon.hasVisibleVertices=!1),c.hasIconCollisionBoxData()&&c.iconCollisionBox.collisionVertexArray.clear(),c.hasTextCollisionBoxData()&&c.textCollisionBox.collisionVertexArray.clear();let E=c.layers[0],P=E.layout,U=new Qt(null,0,!1,!1,!0),V=P.get("text-allow-overlap"),$=P.get("icon-allow-overlap"),G=E._unevaluatedLayout.hasValue("text-variable-anchor")||E._unevaluatedLayout.hasValue("text-variable-anchor-offset"),J=P.get("text-rotation-alignment")==="map",tt=P.get("text-pitch-alignment")==="map",lt=P.get("icon-text-fit")!=="none",wt=new Qt(null,0,V&&($||!c.hasIconData()||P.get("icon-optional")),$&&(V||!c.hasTextData()||P.get("text-optional")),!0);!c.collisionArrays&&w&&(c.hasIconCollisionBoxData()||c.hasTextCollisionBoxData())&&c.deserializeCollisionBoxes(w);let bt=(Rt,yt,Zt)=>{for(let se=0;se<yt/4;se++)Rt.opacityVertexArray.emplaceBack(Zt);Rt.hasVisibleVertices=Rt.hasVisibleVertices||Zt!==Ca};for(let Rt=0;Rt<c.symbolInstances.length;Rt++){let yt=c.symbolInstances.get(Rt),{numHorizontalGlyphVertices:Zt,numVerticalGlyphVertices:se,crossTileID:Bt}=yt,Gt=this.opacities[Bt];A[Bt]?Gt=U:Gt||(Gt=wt,this.opacities[Bt]=Gt),A[Bt]=!0;let he=yt.numIconVertices>0,ce=this.placedOrientations[yt.crossTileID],xe=ce===n.ai.vertical,Pe=ce===n.ai.horizontal||ce===n.ai.horizontalOnly;if(Zt>0||se>0){let Te=zs(Gt.text);bt(c.text,Zt,xe?Ca:Te),bt(c.text,se,Pe?Ca:Te);let Le=Gt.text.isHidden();[yt.rightJustifiedTextSymbolIndex,yt.centerJustifiedTextSymbolIndex,yt.leftJustifiedTextSymbolIndex].forEach(He=>{He>=0&&(c.text.placedSymbolArray.get(He).hidden=Le||xe?1:0)}),yt.verticalPlacedTextSymbolIndex>=0&&(c.text.placedSymbolArray.get(yt.verticalPlacedTextSymbolIndex).hidden=Le||Pe?1:0);let hr=this.variableOffsets[yt.crossTileID];hr&&this.markUsedJustification(c,hr.anchor,yt,ce);let Di=this.placedOrientations[yt.crossTileID];Di&&(this.markUsedJustification(c,"left",yt,Di),this.markUsedOrientation(c,Di,yt))}if(he){let Te=zs(Gt.icon),Le=!(lt&&yt.verticalPlacedIconSymbolIndex&&xe);yt.placedIconSymbolIndex>=0&&(bt(c.icon,yt.numIconVertices,Le?Te:Ca),c.icon.placedSymbolArray.get(yt.placedIconSymbolIndex).hidden=Gt.icon.isHidden()),yt.verticalPlacedIconSymbolIndex>=0&&(bt(c.icon,yt.numVerticalIconVertices,Le?Ca:Te),c.icon.placedSymbolArray.get(yt.verticalPlacedIconSymbolIndex).hidden=Gt.icon.isHidden())}if(c.hasIconCollisionBoxData()||c.hasTextCollisionBoxData()){let Te=c.collisionArrays[Rt];if(Te){let Le=new n.P(0,0);if(Te.textBox||Te.verticalTextBox){let Di=!0;if(G){let He=this.variableOffsets[Bt];He?(Le=Lr(He.anchor,He.width,He.height,He.textOffset,He.textBoxScale),J&&Le._rotate(tt?this.transform.angle:-this.transform.angle)):Di=!1}Te.textBox&&jr(c.textCollisionBox.collisionVertexArray,Gt.text.placed,!Di||xe,Le.x,Le.y),Te.verticalTextBox&&jr(c.textCollisionBox.collisionVertexArray,Gt.text.placed,!Di||Pe,Le.x,Le.y)}let hr=!!(!Pe&&Te.verticalIconBox);Te.iconBox&&jr(c.iconCollisionBox.collisionVertexArray,Gt.icon.placed,hr,lt?Le.x:0,lt?Le.y:0),Te.verticalIconBox&&jr(c.iconCollisionBox.collisionVertexArray,Gt.icon.placed,!hr,lt?Le.x:0,lt?Le.y:0)}}}if(c.sortFeatures(this.transform.angle),this.retainedQueryData[c.bucketInstanceId]&&(this.retainedQueryData[c.bucketInstanceId].featureSortOrder=c.featureSortOrder),c.hasTextData()&&c.text.opacityVertexBuffer&&c.text.opacityVertexBuffer.updateData(c.text.opacityVertexArray),c.hasIconData()&&c.icon.opacityVertexBuffer&&c.icon.opacityVertexBuffer.updateData(c.icon.opacityVertexArray),c.hasIconCollisionBoxData()&&c.iconCollisionBox.collisionVertexBuffer&&c.iconCollisionBox.collisionVertexBuffer.updateData(c.iconCollisionBox.collisionVertexArray),c.hasTextCollisionBoxData()&&c.textCollisionBox.collisionVertexBuffer&&c.textCollisionBox.collisionVertexBuffer.updateData(c.textCollisionBox.collisionVertexArray),c.text.opacityVertexArray.length!==c.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${c.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${c.text.layoutVertexArray.length}) / 4`);if(c.icon.opacityVertexArray.length!==c.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${c.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${c.icon.layoutVertexArray.length}) / 4`);if(c.bucketInstanceId in this.collisionCircleArrays){let Rt=this.collisionCircleArrays[c.bucketInstanceId];c.placementInvProjMatrix=Rt.invProjMatrix,c.placementViewportMatrix=Rt.viewportMatrix,c.collisionCircleArray=Rt.circles,delete this.collisionCircleArrays[c.bucketInstanceId]}}symbolFadeChange(c){return this.fadeDuration===0?1:(c-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(c){return Math.max(0,(this.transform.zoom-c)/1.5)}hasTransitions(c){return this.stale||c-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(c,A){let w=this.zoomAtLastRecencyCheck===A?1-this.zoomAdjustment(A):1;return this.zoomAtLastRecencyCheck=A,this.commitTime+this.fadeDuration*w>c}setStale(){this.stale=!0}}function jr(M,c,A,w,E){M.emplaceBack(c?1:0,A?1:0,w||0,E||0),M.emplaceBack(c?1:0,A?1:0,w||0,E||0),M.emplaceBack(c?1:0,A?1:0,w||0,E||0),M.emplaceBack(c?1:0,A?1:0,w||0,E||0)}let ln=Math.pow(2,25),yn=Math.pow(2,24),Vi=Math.pow(2,17),Ai=Math.pow(2,16),Ps=Math.pow(2,9),pn=Math.pow(2,8),ns=Math.pow(2,1);function zs(M){if(M.opacity===0&&!M.placed)return 0;if(M.opacity===1&&M.placed)return 4294967295;let c=M.placed?1:0,A=Math.floor(127*M.opacity);return A*ln+c*yn+A*Vi+c*Ai+A*Ps+c*pn+A*ns+c}let Ca=0;class HA{constructor(c){this._sortAcrossTiles=c.layout.get("symbol-z-order")!=="viewport-y"&&!c.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(c,A,w,E,P){let U=this._bucketParts;for(;this._currentTileIndex<c.length;)if(A.getBucketParts(U,E,c[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,P())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,U.sort((V,$)=>V.sortKey-$.sortKey));this._currentPartIndex<U.length;)if(A.placeLayerBucketPart(U[this._currentPartIndex],this._seenCrossTileIDs,w),this._currentPartIndex++,P())return!0;return!1}}class sc{constructor(c,A,w,E,P,U,V,$){this.placement=new vr(c,A,U,V,$),this._currentPlacementIndex=w.length-1,this._forceFullPlacement=E,this._showCollisionBoxes=P,this._done=!1}isDone(){return this._done}continuePlacement(c,A,w){let E=n.h.now(),P=()=>!this._forceFullPlacement&&n.h.now()-E>2;for(;this._currentPlacementIndex>=0;){let U=A[c[this._currentPlacementIndex]],V=this.placement.collisionIndex.transform.zoom;if(U.type==="symbol"&&(!U.minzoom||U.minzoom<=V)&&(!U.maxzoom||U.maxzoom>V)){if(this._inProgressLayer||(this._inProgressLayer=new HA(U)),this._inProgressLayer.continuePlacement(w[U.source],this.placement,this._showCollisionBoxes,U,P))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(c){return this.placement.commit(c),this.placement}}let oo=512/n.N/2;class kh{constructor(c,A,w){this.tileID=c,this.bucketInstanceId=w,this._symbolsByKey={};let E=new Map;for(let P=0;P<A.length;P++){let U=A.get(P),V=U.key,$=E.get(V);$?$.push(U):E.set(V,[U])}for(let[P,U]of E){let V={positions:U.map($=>({x:Math.floor($.anchorX*oo),y:Math.floor($.anchorY*oo)})),crossTileIDs:U.map($=>$.crossTileID)};if(V.positions.length>128){let $=new n.av(V.positions.length,16,Uint16Array);for(let{x:G,y:J}of V.positions)$.add(G,J);$.finish(),delete V.positions,V.index=$}this._symbolsByKey[P]=V}}getScaledCoordinates(c,A){let{x:w,y:E,z:P}=this.tileID.canonical,{x:U,y:V,z:$}=A.canonical,G=oo/Math.pow(2,$-P),J=(V*n.N+c.anchorY)*G,tt=E*n.N*oo;return{x:Math.floor((U*n.N+c.anchorX)*G-w*n.N*oo),y:Math.floor(J-tt)}}findMatches(c,A,w){let E=this.tileID.canonical.z<A.canonical.z?1:Math.pow(2,this.tileID.canonical.z-A.canonical.z);for(let P=0;P<c.length;P++){let U=c.get(P);if(U.crossTileID)continue;let V=this._symbolsByKey[U.key];if(!V)continue;let $=this.getScaledCoordinates(U,A);if(V.index){let G=V.index.range($.x-E,$.y-E,$.x+E,$.y+E).sort();for(let J of G){let tt=V.crossTileIDs[J];if(!w[tt]){w[tt]=!0,U.crossTileID=tt;break}}}else if(V.positions)for(let G=0;G<V.positions.length;G++){let J=V.positions[G],tt=V.crossTileIDs[G];if(Math.abs(J.x-$.x)<=E&&Math.abs(J.y-$.y)<=E&&!w[tt]){w[tt]=!0,U.crossTileID=tt;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:c})=>c)}}class Hi{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class sl{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(c){let A=Math.round((c-this.lng)/360);if(A!==0)for(let w in this.indexes){let E=this.indexes[w],P={};for(let U in E){let V=E[U];V.tileID=V.tileID.unwrapTo(V.tileID.wrap+A),P[V.tileID.key]=V}this.indexes[w]=P}this.lng=c}addBucket(c,A,w){if(this.indexes[c.overscaledZ]&&this.indexes[c.overscaledZ][c.key]){if(this.indexes[c.overscaledZ][c.key].bucketInstanceId===A.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(c.overscaledZ,this.indexes[c.overscaledZ][c.key])}for(let P=0;P<A.symbolInstances.length;P++)A.symbolInstances.get(P).crossTileID=0;this.usedCrossTileIDs[c.overscaledZ]||(this.usedCrossTileIDs[c.overscaledZ]={});let E=this.usedCrossTileIDs[c.overscaledZ];for(let P in this.indexes){let U=this.indexes[P];if(Number(P)>c.overscaledZ)for(let V in U){let $=U[V];$.tileID.isChildOf(c)&&$.findMatches(A.symbolInstances,c,E)}else{let V=U[c.scaledTo(Number(P)).key];V&&V.findMatches(A.symbolInstances,c,E)}}for(let P=0;P<A.symbolInstances.length;P++){let U=A.symbolInstances.get(P);U.crossTileID||(U.crossTileID=w.generate(),E[U.crossTileID]=!0)}return this.indexes[c.overscaledZ]===void 0&&(this.indexes[c.overscaledZ]={}),this.indexes[c.overscaledZ][c.key]=new kh(c,A.symbolInstances,A.bucketInstanceId),!0}removeBucketCrossTileIDs(c,A){for(let w of A.getCrossTileIDsLists())for(let E of w)delete this.usedCrossTileIDs[c][E]}removeStaleBuckets(c){let A=!1;for(let w in this.indexes){let E=this.indexes[w];for(let P in E)c[E[P].bucketInstanceId]||(this.removeBucketCrossTileIDs(w,E[P]),delete E[P],A=!0)}return A}}class Xc{constructor(){this.layerIndexes={},this.crossTileIDs=new Hi,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(c,A,w){let E=this.layerIndexes[c.id];E===void 0&&(E=this.layerIndexes[c.id]=new sl);let P=!1,U={};E.handleWrapJump(w);for(let V of A){let $=V.getBucket(c);$&&c.id===$.layerIds[0]&&($.bucketInstanceId||($.bucketInstanceId=++this.maxBucketInstanceId),E.addBucket(V.tileID,$,this.crossTileIDs)&&(P=!0),U[$.bucketInstanceId]=!0)}return E.removeStaleBuckets(U)&&(P=!0),P}pruneUnusedLayers(c){let A={};c.forEach(w=>{A[w]=!0});for(let w in this.layerIndexes)A[w]||delete this.layerIndexes[w]}}let Hn=(M,c)=>n.x(M,c&&c.filter(A=>A.identifier!=="source.canvas")),bs=n.F(n.ax,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setGlyphs","setSprite"]),qA=n.F(n.ax,["setCenter","setZoom","setBearing","setPitch"]),ca=n.aw();class Rs extends n.E{constructor(c,A={}){super(),this.map=c,this.dispatcher=new Se(Zo(),this,c._getMapId()),this.imageManager=new vt,this.imageManager.setEventedParent(this),this.glyphManager=new xt(c._requestManager,A.localIdeographFontFamily),this.lineAtlas=new Ee(256,512),this.crossTileSymbolIndex=new Xc,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new n.ay,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",n.az());let w=this;this._rtlTextPluginCallback=Rs.registerForPluginStateChange(E=>{w.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:E.pluginStatus,pluginURL:E.pluginURL},(P,U)=>{if(n.aA(P),U&&U.every(V=>V))for(let V in w.sourceCaches){let $=w.sourceCaches[V].getSource().type;$!=="vector"&&$!=="geojson"||w.sourceCaches[V].reload()}})}),this.on("data",E=>{if(E.dataType!=="source"||E.sourceDataType!=="metadata")return;let P=this.sourceCaches[E.sourceId];if(!P)return;let U=P.getSource();if(U&&U.vectorLayerIds)for(let V in this._layers){let $=this._layers[V];$.source===U.id&&this._validateLayer($)}})}loadURL(c,A={},w){this.fire(new n.k("dataloading",{dataType:"style"})),A.validate=typeof A.validate!="boolean"||A.validate;let E=this.map._requestManager.transformRequest(c,L.Style);this._request=n.f(E,(P,U)=>{this._request=null,P?this.fire(new n.j(P)):U&&this._load(U,A,w)})}loadJSON(c,A={},w){this.fire(new n.k("dataloading",{dataType:"style"})),this._request=n.h.frame(()=>{this._request=null,A.validate=A.validate!==!1,this._load(c,A,w)})}loadEmpty(){this.fire(new n.k("dataloading",{dataType:"style"})),this._load(ca,{validate:!1})}_load(c,A,w){var E;let P=A.transformStyle?A.transformStyle(w,c):c;if(!A.validate||!Hn(this,n.y(P))){this._loaded=!0,this.stylesheet=P;for(let U in P.sources)this.addSource(U,P.sources[U],{validate:!1});P.sprite?this._loadSprite(P.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(P.glyphs),this._createLayers(),this.light=new de(this.stylesheet.light),this.map.setTerrain((E=this.stylesheet.terrain)!==null&&E!==void 0?E:null),this.fire(new n.k("data",{dataType:"style"})),this.fire(new n.k("style.load"))}}_createLayers(){let c=n.aB(this.stylesheet.layers);this.dispatcher.broadcast("setLayers",c),this._order=c.map(A=>A.id),this._layers={},this._serializedLayers=null;for(let A of c){let w=n.aC(A);w.setEventedParent(this,{layer:{id:A.id}}),this._layers[A.id]=w}}_loadSprite(c,A=!1,w=void 0){this.imageManager.setLoaded(!1),this._spriteRequest=function(E,P,U,V){let $=nt(E),G=$.length,J=U>1?"@2x":"",tt={},lt={},wt={};for(let{id:bt,url:Rt}of $){let yt=P.transformRequest(P.normalizeSpriteURL(Rt,J,".json"),L.SpriteJSON),Zt=`${bt}_${yt.url}`;tt[Zt]=n.f(yt,(Gt,he)=>{delete tt[Zt],lt[bt]=he,Mt(V,lt,wt,Gt,G)});let se=P.transformRequest(P.normalizeSpriteURL(Rt,J,".png"),L.SpriteImage),Bt=`${bt}_${se.url}`;tt[Bt]=B.getImage(se,(Gt,he)=>{delete tt[Bt],wt[bt]=he,Mt(V,lt,wt,Gt,G)})}return{cancel(){for(let bt of Object.values(tt))bt.cancel()}}}(c,this.map._requestManager,this.map.getPixelRatio(),(E,P)=>{if(this._spriteRequest=null,E)this.fire(new n.j(E));else if(P)for(let U in P){this._spritesImagesIds[U]=[];let V=this._spritesImagesIds[U]?this._spritesImagesIds[U].filter($=>!($ in P)):[];for(let $ of V)this.imageManager.removeImage($),this._changedImages[$]=!0;for(let $ in P[U]){let G=U==="default"?$:`${U}:${$}`;this._spritesImagesIds[U].push(G),G in this.imageManager.images?this.imageManager.updateImage(G,P[U][$],!1):this.imageManager.addImage(G,P[U][$]),A&&(this._changedImages[G]=!0)}}this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),A&&(this._changed=!0),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new n.k("data",{dataType:"style"})),w&&w(E)})}_unloadSprite(){for(let c of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(c),this._changedImages[c]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new n.k("data",{dataType:"style"}))}_validateLayer(c){let A=this.sourceCaches[c.source];if(!A)return;let w=c.sourceLayer;if(!w)return;let E=A.getSource();(E.type==="geojson"||E.vectorLayerIds&&E.vectorLayerIds.indexOf(w)===-1)&&this.fire(new n.j(new Error(`Source layer "${w}" does not exist on source "${E.id}" as specified by style layer "${c.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(let c in this.sourceCaches)if(!this.sourceCaches[c].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(c){let A=this._serializedAllLayers();if(!c||c.length===0)return Object.values(A);let w=[];for(let E of c)A[E]&&w.push(A[E]);return w}_serializedAllLayers(){let c=this._serializedLayers;if(c)return c;c=this._serializedLayers={};let A=Object.keys(this._layers);for(let w of A){let E=this._layers[w];E.type!=="custom"&&(c[w]=E.serialize())}return c}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(let c in this.sourceCaches)if(this.sourceCaches[c].hasTransition())return!0;for(let c in this._layers)if(this._layers[c].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(c){if(!this._loaded)return;let A=this._changed;if(this._changed){let E=Object.keys(this._updatedLayers),P=Object.keys(this._removedLayers);(E.length||P.length)&&this._updateWorkerLayers(E,P);for(let U in this._updatedSources){let V=this._updatedSources[U];if(V==="reload")this._reloadSource(U);else{if(V!=="clear")throw new Error(`Invalid action ${V}`);this._clearSource(U)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(let U in this._updatedPaintProps)this._layers[U].updateTransitions(c);this.light.updateTransitions(c),this._resetUpdates()}let w={};for(let E in this.sourceCaches){let P=this.sourceCaches[E];w[E]=P.used,P.used=!1}for(let E of this._order){let P=this._layers[E];P.recalculate(c,this._availableImages),!P.isHidden(c.zoom)&&P.source&&(this.sourceCaches[P.source].used=!0)}for(let E in w){let P=this.sourceCaches[E];w[E]!==P.used&&P.fire(new n.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:E}))}this.light.recalculate(c),this.z=c.zoom,A&&this.fire(new n.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){let c=Object.keys(this._changedImages);if(c.length){for(let A in this.sourceCaches)this.sourceCaches[A].reloadTilesForDependencies(["icons","patterns"],c);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(let c in this.sourceCaches)this.sourceCaches[c].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(c,A){this.dispatcher.broadcast("updateLayers",{layers:this._serializeByIds(c),removedIds:A})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(c,A={}){this._checkLoaded();let w=this.serialize();if(c=A.transformStyle?A.transformStyle(w,c):c,Hn(this,n.y(c)))return!1;(c=n.aD(c)).layers=n.aB(c.layers);let E=n.aE(w,c).filter(U=>!(U.command in qA));if(E.length===0)return!1;let P=E.filter(U=>!(U.command in bs));if(P.length>0)throw new Error(`Unimplemented: ${P.map(U=>U.command).join(", ")}.`);for(let U of E)U.command!=="setTransition"&&this[U.command].apply(this,U.args);return this.stylesheet=c,this._serializedLayers=null,!0}addImage(c,A){if(this.getImage(c))return this.fire(new n.j(new Error(`An image named "${c}" already exists.`)));this.imageManager.addImage(c,A),this._afterImageUpdated(c)}updateImage(c,A){this.imageManager.updateImage(c,A)}getImage(c){return this.imageManager.getImage(c)}removeImage(c){if(!this.getImage(c))return this.fire(new n.j(new Error(`An image named "${c}" does not exist.`)));this.imageManager.removeImage(c),this._afterImageUpdated(c)}_afterImageUpdated(c){this._availableImages=this.imageManager.listImages(),this._changedImages[c]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new n.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(c,A,w={}){if(this._checkLoaded(),this.sourceCaches[c]!==void 0)throw new Error(`Source "${c}" already exists.`);if(!A.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(A).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(A.type)>=0&&this._validate(n.y.source,`sources.${c}`,A,null,w))return;this.map&&this.map._collectResourceTiming&&(A.collectResourceTiming=!0);let E=this.sourceCaches[c]=new Gn(c,A,this.dispatcher);E.style=this,E.setEventedParent(this,()=>({isSourceLoaded:E.loaded(),source:E.serialize(),sourceId:c})),E.onAdd(this.map),this._changed=!0}removeSource(c){if(this._checkLoaded(),this.sourceCaches[c]===void 0)throw new Error("There is no source with this ID");for(let w in this._layers)if(this._layers[w].source===c)return this.fire(new n.j(new Error(`Source "${c}" cannot be removed while layer "${w}" is using it.`)));let A=this.sourceCaches[c];delete this.sourceCaches[c],delete this._updatedSources[c],A.fire(new n.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:c})),A.setEventedParent(null),A.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(c,A){if(this._checkLoaded(),this.sourceCaches[c]===void 0)throw new Error(`There is no source with this ID=${c}`);let w=this.sourceCaches[c].getSource();if(w.type!=="geojson")throw new Error(`geojsonSource.type is ${w.type}, which is !== 'geojson`);w.setData(A),this._changed=!0}getSource(c){return this.sourceCaches[c]&&this.sourceCaches[c].getSource()}addLayer(c,A,w={}){this._checkLoaded();let E=c.id;if(this.getLayer(E))return void this.fire(new n.j(new Error(`Layer "${E}" already exists on this map.`)));let P;if(c.type==="custom"){if(Hn(this,n.aF(c)))return;P=n.aC(c)}else{if("source"in c&&typeof c.source=="object"&&(this.addSource(E,c.source),c=n.aD(c),c=n.e(c,{source:E})),this._validate(n.y.layer,`layers.${E}`,c,{arrayIndex:-1},w))return;P=n.aC(c),this._validateLayer(P),P.setEventedParent(this,{layer:{id:E}})}let U=A?this._order.indexOf(A):this._order.length;if(A&&U===-1)this.fire(new n.j(new Error(`Cannot add layer "${E}" before non-existing layer "${A}".`)));else{if(this._order.splice(U,0,E),this._layerOrderChanged=!0,this._layers[E]=P,this._removedLayers[E]&&P.source&&P.type!=="custom"){let V=this._removedLayers[E];delete this._removedLayers[E],V.type!==P.type?this._updatedSources[P.source]="clear":(this._updatedSources[P.source]="reload",this.sourceCaches[P.source].pause())}this._updateLayer(P),P.onAdd&&P.onAdd(this.map)}}moveLayer(c,A){if(this._checkLoaded(),this._changed=!0,!this._layers[c])return void this.fire(new n.j(new Error(`The layer '${c}' does not exist in the map's style and cannot be moved.`)));if(c===A)return;let w=this._order.indexOf(c);this._order.splice(w,1);let E=A?this._order.indexOf(A):this._order.length;A&&E===-1?this.fire(new n.j(new Error(`Cannot move layer "${c}" before non-existing layer "${A}".`))):(this._order.splice(E,0,c),this._layerOrderChanged=!0)}removeLayer(c){this._checkLoaded();let A=this._layers[c];if(!A)return void this.fire(new n.j(new Error(`Cannot remove non-existing layer "${c}".`)));A.setEventedParent(null);let w=this._order.indexOf(c);this._order.splice(w,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[c]=A,delete this._layers[c],this._serializedLayers&&delete this._serializedLayers[c],delete this._updatedLayers[c],delete this._updatedPaintProps[c],A.onRemove&&A.onRemove(this.map)}getLayer(c){return this._layers[c]}getLayersOrder(){return[...this._order]}hasLayer(c){return c in this._layers}setLayerZoomRange(c,A,w){this._checkLoaded();let E=this.getLayer(c);E?E.minzoom===A&&E.maxzoom===w||(A!=null&&(E.minzoom=A),w!=null&&(E.maxzoom=w),this._updateLayer(E)):this.fire(new n.j(new Error(`Cannot set the zoom range of non-existing layer "${c}".`)))}setFilter(c,A,w={}){this._checkLoaded();let E=this.getLayer(c);if(E){if(!n.aG(E.filter,A))return A==null?(E.filter=void 0,void this._updateLayer(E)):void(this._validate(n.y.filter,`layers.${E.id}.filter`,A,null,w)||(E.filter=n.aD(A),this._updateLayer(E)))}else this.fire(new n.j(new Error(`Cannot filter non-existing layer "${c}".`)))}getFilter(c){return n.aD(this.getLayer(c).filter)}setLayoutProperty(c,A,w,E={}){this._checkLoaded();let P=this.getLayer(c);P?n.aG(P.getLayoutProperty(A),w)||(P.setLayoutProperty(A,w,E),this._updateLayer(P)):this.fire(new n.j(new Error(`Cannot style non-existing layer "${c}".`)))}getLayoutProperty(c,A){let w=this.getLayer(c);if(w)return w.getLayoutProperty(A);this.fire(new n.j(new Error(`Cannot get style of non-existing layer "${c}".`)))}setPaintProperty(c,A,w,E={}){this._checkLoaded();let P=this.getLayer(c);P?n.aG(P.getPaintProperty(A),w)||(P.setPaintProperty(A,w,E)&&this._updateLayer(P),this._changed=!0,this._updatedPaintProps[c]=!0):this.fire(new n.j(new Error(`Cannot style non-existing layer "${c}".`)))}getPaintProperty(c,A){return this.getLayer(c).getPaintProperty(A)}setFeatureState(c,A){this._checkLoaded();let w=c.source,E=c.sourceLayer,P=this.sourceCaches[w];if(P===void 0)return void this.fire(new n.j(new Error(`The source '${w}' does not exist in the map's style.`)));let U=P.getSource().type;U==="geojson"&&E?this.fire(new n.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):U!=="vector"||E?(c.id===void 0&&this.fire(new n.j(new Error("The feature id parameter must be provided."))),P.setFeatureState(E,c.id,A)):this.fire(new n.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(c,A){this._checkLoaded();let w=c.source,E=this.sourceCaches[w];if(E===void 0)return void this.fire(new n.j(new Error(`The source '${w}' does not exist in the map's style.`)));let P=E.getSource().type,U=P==="vector"?c.sourceLayer:void 0;P!=="vector"||U?A&&typeof c.id!="string"&&typeof c.id!="number"?this.fire(new n.j(new Error("A feature id is required to remove its specific state property."))):E.removeFeatureState(U,c.id,A):this.fire(new n.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(c){this._checkLoaded();let A=c.source,w=c.sourceLayer,E=this.sourceCaches[A];if(E!==void 0)return E.getSource().type!=="vector"||w?(c.id===void 0&&this.fire(new n.j(new Error("The feature id parameter must be provided."))),E.getFeatureState(w,c.id)):void this.fire(new n.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new n.j(new Error(`The source '${A}' does not exist in the map's style.`)))}getTransition(){return n.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;let c=n.aH(this.sourceCaches,P=>P.serialize()),A=this._serializeByIds(this._order),w=this.map.getTerrain()||void 0,E=this.stylesheet;return n.aI({version:E.version,name:E.name,metadata:E.metadata,light:E.light,center:E.center,zoom:E.zoom,bearing:E.bearing,pitch:E.pitch,sprite:E.sprite,glyphs:E.glyphs,transition:E.transition,sources:c,layers:A,terrain:w},P=>P!==void 0)}_updateLayer(c){this._updatedLayers[c.id]=!0,c.source&&!this._updatedSources[c.source]&&this.sourceCaches[c.source].getSource().type!=="raster"&&(this._updatedSources[c.source]="reload",this.sourceCaches[c.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(c){let A=U=>this._layers[U].type==="fill-extrusion",w={},E=[];for(let U=this._order.length-1;U>=0;U--){let V=this._order[U];if(A(V)){w[V]=U;for(let $ of c){let G=$[V];if(G)for(let J of G)E.push(J)}}}E.sort((U,V)=>V.intersectionZ-U.intersectionZ);let P=[];for(let U=this._order.length-1;U>=0;U--){let V=this._order[U];if(A(V))for(let $=E.length-1;$>=0;$--){let G=E[$].feature;if(w[G.layer.id]<U)break;P.push(G),E.pop()}else for(let $ of c){let G=$[V];if(G)for(let J of G)P.push(J.feature)}}return P}queryRenderedFeatures(c,A,w){A&&A.filter&&this._validate(n.y.filter,"queryRenderedFeatures.filter",A.filter,null,A);let E={};if(A&&A.layers){if(!Array.isArray(A.layers))return this.fire(new n.j(new Error("parameters.layers must be an Array."))),[];for(let V of A.layers){let $=this._layers[V];if(!$)return this.fire(new n.j(new Error(`The layer '${V}' does not exist in the map's style and cannot be queried for features.`))),[];E[$.source]=!0}}let P=[];A.availableImages=this._availableImages;let U=this._serializedAllLayers();for(let V in this.sourceCaches)A.layers&&!E[V]||P.push(xi(this.sourceCaches[V],this._layers,U,c,A,w));return this.placement&&P.push(function(V,$,G,J,tt,lt,wt){let bt={},Rt=lt.queryRenderedSymbols(J),yt=[];for(let Zt of Object.keys(Rt).map(Number))yt.push(wt[Zt]);yt.sort(rn);for(let Zt of yt){let se=Zt.featureIndex.lookupSymbolFeatures(Rt[Zt.bucketInstanceId],$,Zt.bucketIndex,Zt.sourceLayerIndex,tt.filter,tt.layers,tt.availableImages,V);for(let Bt in se){let Gt=bt[Bt]=bt[Bt]||[],he=se[Bt];he.sort((ce,xe)=>{let Pe=Zt.featureSortOrder;if(Pe){let Te=Pe.indexOf(ce.featureIndex);return Pe.indexOf(xe.featureIndex)-Te}return xe.featureIndex-ce.featureIndex});for(let ce of he)Gt.push(ce)}}for(let Zt in bt)bt[Zt].forEach(se=>{let Bt=se.feature,Gt=G[V[Zt].source].getFeatureState(Bt.layer["source-layer"],Bt.id);Bt.source=Bt.layer.source,Bt.layer["source-layer"]&&(Bt.sourceLayer=Bt.layer["source-layer"]),Bt.state=Gt});return bt}(this._layers,U,this.sourceCaches,c,A,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(P)}querySourceFeatures(c,A){A&&A.filter&&this._validate(n.y.filter,"querySourceFeatures.filter",A.filter,null,A);let w=this.sourceCaches[c];return w?function(E,P){let U=E.getRenderableIds().map(G=>E.getTileByID(G)),V=[],$={};for(let G=0;G<U.length;G++){let J=U[G],tt=J.tileID.canonical.key;$[tt]||($[tt]=!0,J.querySourceFeatures(V,P))}return V}(w,A):[]}addSourceType(c,A,w){return Ie(c)?w(new Error(`A source type called "${c}" already exists.`)):(((E,P)=>{$r[E]=P})(c,A),A.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:c,url:A.workerSourceURL},w):w(null,null))}getLight(){return this.light.getLight()}setLight(c,A={}){this._checkLoaded();let w=this.light.getLight(),E=!1;for(let U in c)if(!n.aG(c[U],w[U])){E=!0;break}if(!E)return;let P={now:n.h.now(),transition:n.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(c,A),this.light.updateTransitions(P)}_validate(c,A,w,E,P={}){return(!P||P.validate!==!1)&&Hn(this,c.call(n.y,n.e({key:A,style:this.serialize(),value:w,styleSpec:n.v},E)))}_remove(c=!0){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),n.aJ.off("pluginStateChange",this._rtlTextPluginCallback);for(let A in this._layers)this._layers[A].setEventedParent(null);for(let A in this.sourceCaches){let w=this.sourceCaches[A];w.setEventedParent(null),w.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove(c)}_clearSource(c){this.sourceCaches[c].clearTiles()}_reloadSource(c){this.sourceCaches[c].resume(),this.sourceCaches[c].reload()}_updateSources(c){for(let A in this.sourceCaches)this.sourceCaches[A].update(c,this.map.terrain)}_generateCollisionBoxes(){for(let c in this.sourceCaches)this._reloadSource(c)}_updatePlacement(c,A,w,E,P=!1){let U=!1,V=!1,$={};for(let G of this._order){let J=this._layers[G];if(J.type!=="symbol")continue;if(!$[J.source]){let lt=this.sourceCaches[J.source];$[J.source]=lt.getRenderableIds(!0).map(wt=>lt.getTileByID(wt)).sort((wt,bt)=>bt.tileID.overscaledZ-wt.tileID.overscaledZ||(wt.tileID.isLessThan(bt.tileID)?-1:1))}let tt=this.crossTileSymbolIndex.addLayer(J,$[J.source],c.center.lng);U=U||tt}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((P=P||this._layerOrderChanged||w===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(n.h.now(),c.zoom))&&(this.pauseablePlacement=new sc(c,this.map.terrain,this._order,P,A,w,E,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,$),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(n.h.now()),V=!0),U&&this.pauseablePlacement.placement.setStale()),V||U)for(let G of this._order){let J=this._layers[G];J.type==="symbol"&&this.placement.updateLayerOpacities(J,$[J.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(n.h.now())}_releaseSymbolFadeTiles(){for(let c in this.sourceCaches)this.sourceCaches[c].releaseSymbolFadeTiles()}getImages(c,A,w){this.imageManager.getImages(A.icons,w),this._updateTilesForChangedImages();let E=this.sourceCaches[A.source];E&&E.setDependencies(A.tileID.key,A.type,A.icons)}getGlyphs(c,A,w){this.glyphManager.getGlyphs(A.stacks,w);let E=this.sourceCaches[A.source];E&&E.setDependencies(A.tileID.key,A.type,[""])}getResource(c,A,w){return n.m(A,w)}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(c,A={}){this._checkLoaded(),c&&this._validate(n.y.glyphs,"glyphs",c,null,A)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=c,this.glyphManager.entries={},this.glyphManager.setURL(c))}addSprite(c,A,w={},E){this._checkLoaded();let P=[{id:c,url:A}],U=[...nt(this.stylesheet.sprite),...P];this._validate(n.y.sprite,"sprite",U,null,w)||(this.stylesheet.sprite=U,this._loadSprite(P,!0,E))}removeSprite(c){this._checkLoaded();let A=nt(this.stylesheet.sprite);if(A.find(w=>w.id===c)){if(this._spritesImagesIds[c])for(let w of this._spritesImagesIds[c])this.imageManager.removeImage(w),this._changedImages[w]=!0;A.splice(A.findIndex(w=>w.id===c),1),this.stylesheet.sprite=A.length>0?A:void 0,delete this._spritesImagesIds[c],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new n.k("data",{dataType:"style"}))}else this.fire(new n.j(new Error(`Sprite "${c}" doesn't exists on this map.`)))}getSprite(){return nt(this.stylesheet.sprite)}setSprite(c,A={},w){this._checkLoaded(),c&&this._validate(n.y.sprite,"sprite",c,null,A)||(this.stylesheet.sprite=c,c?this._loadSprite(c,!0,w):(this._unloadSprite(),w&&w(null)))}}Rs.registerForPluginStateChange=n.aK;var Uo=n.Q([{name:"a_pos",type:"Int16",components:2}]),oc="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}";let zn={prelude:tn(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:tn(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:tn(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:tn(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:tn("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:tn(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:tn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:tn("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:tn("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:tn("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:tn(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:tn(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:tn(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:tn(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:tn(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:tn(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:tn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:tn(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:tn(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:tn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:tn(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:tn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:tn(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:tn(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:tn(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:tn(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:tn("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",oc),terrainDepth:tn("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",oc),terrainCoords:tn("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",oc)};function tn(M,c){let A=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,w=c.match(/attribute ([\w]+) ([\w]+)/g),E=M.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),P=c.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),U=P?P.concat(E):E,V={};return{fragmentSource:M=M.replace(A,($,G,J,tt,lt)=>(V[lt]=!0,G==="define"?`
#ifndef HAS_UNIFORM_u_${lt}
varying ${J} ${tt} ${lt};
#else
uniform ${J} ${tt} u_${lt};
#endif
`:`
#ifdef HAS_UNIFORM_u_${lt}
    ${J} ${tt} ${lt} = u_${lt};
#endif
`)),vertexSource:c=c.replace(A,($,G,J,tt,lt)=>{let wt=tt==="float"?"vec2":"vec4",bt=lt.match(/color/)?"color":wt;return V[lt]?G==="define"?`
#ifndef HAS_UNIFORM_u_${lt}
uniform lowp float u_${lt}_t;
attribute ${J} ${wt} a_${lt};
varying ${J} ${tt} ${lt};
#else
uniform ${J} ${tt} u_${lt};
#endif
`:bt==="vec4"?`
#ifndef HAS_UNIFORM_u_${lt}
    ${lt} = a_${lt};
#else
    ${J} ${tt} ${lt} = u_${lt};
#endif
`:`
#ifndef HAS_UNIFORM_u_${lt}
    ${lt} = unpack_mix_${bt}(a_${lt}, u_${lt}_t);
#else
    ${J} ${tt} ${lt} = u_${lt};
#endif
`:G==="define"?`
#ifndef HAS_UNIFORM_u_${lt}
uniform lowp float u_${lt}_t;
attribute ${J} ${wt} a_${lt};
#else
uniform ${J} ${tt} u_${lt};
#endif
`:bt==="vec4"?`
#ifndef HAS_UNIFORM_u_${lt}
    ${J} ${tt} ${lt} = a_${lt};
#else
    ${J} ${tt} ${lt} = u_${lt};
#endif
`:`
#ifndef HAS_UNIFORM_u_${lt}
    ${J} ${tt} ${lt} = unpack_mix_${bt}(a_${lt}, u_${lt}_t);
#else
    ${J} ${tt} ${lt} = u_${lt};
#endif
`}),staticAttributes:w,staticUniforms:U}}class ac{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(c,A,w,E,P,U,V,$,G){this.context=c;let J=this.boundPaintVertexBuffers.length!==E.length;for(let tt=0;!J&&tt<E.length;tt++)this.boundPaintVertexBuffers[tt]!==E[tt]&&(J=!0);!this.vao||this.boundProgram!==A||this.boundLayoutVertexBuffer!==w||J||this.boundIndexBuffer!==P||this.boundVertexOffset!==U||this.boundDynamicVertexBuffer!==V||this.boundDynamicVertexBuffer2!==$||this.boundDynamicVertexBuffer3!==G?this.freshBind(A,w,E,P,U,V,$,G):(c.bindVertexArray.set(this.vao),V&&V.bind(),P&&P.dynamicDraw&&P.bind(),$&&$.bind(),G&&G.bind())}freshBind(c,A,w,E,P,U,V,$){let G=c.numAttributes,J=this.context,tt=J.gl;this.vao&&this.destroy(),this.vao=J.createVertexArray(),J.bindVertexArray.set(this.vao),this.boundProgram=c,this.boundLayoutVertexBuffer=A,this.boundPaintVertexBuffers=w,this.boundIndexBuffer=E,this.boundVertexOffset=P,this.boundDynamicVertexBuffer=U,this.boundDynamicVertexBuffer2=V,this.boundDynamicVertexBuffer3=$,A.enableAttributes(tt,c);for(let lt of w)lt.enableAttributes(tt,c);U&&U.enableAttributes(tt,c),V&&V.enableAttributes(tt,c),$&&$.enableAttributes(tt,c),A.bind(),A.setVertexAttribPointers(tt,c,P);for(let lt of w)lt.bind(),lt.setVertexAttribPointers(tt,c,P);U&&(U.bind(),U.setVertexAttribPointers(tt,c,P)),E&&E.bind(),V&&(V.bind(),V.setVertexAttribPointers(tt,c,P)),$&&($.bind(),$.setVertexAttribPointers(tt,c,P)),J.currentNumAttributes=G}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}function qn(M){let c=[];for(let A=0;A<M.length;A++){if(M[A]===null)continue;let w=M[A].split(" ");c.push(w.pop())}return c}class Ru{constructor(c,A,w,E,P,U){let V=c.gl;this.program=V.createProgram();let $=qn(A.staticAttributes),G=w?w.getBinderAttributes():[],J=$.concat(G),tt=zn.prelude.staticUniforms?qn(zn.prelude.staticUniforms):[],lt=A.staticUniforms?qn(A.staticUniforms):[],wt=w?w.getBinderUniforms():[],bt=tt.concat(lt).concat(wt),Rt=[];for(let ce of bt)Rt.indexOf(ce)<0&&Rt.push(ce);let yt=w?w.defines():[];P&&yt.push("#define OVERDRAW_INSPECTOR;"),U&&yt.push("#define TERRAIN3D;");let Zt=yt.concat(zn.prelude.fragmentSource,A.fragmentSource).join(`
`),se=yt.concat(zn.prelude.vertexSource,A.vertexSource).join(`
`),Bt=V.createShader(V.FRAGMENT_SHADER);if(V.isContextLost())return void(this.failedToCreate=!0);if(V.shaderSource(Bt,Zt),V.compileShader(Bt),!V.getShaderParameter(Bt,V.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${V.getShaderInfoLog(Bt)}`);V.attachShader(this.program,Bt);let Gt=V.createShader(V.VERTEX_SHADER);if(V.isContextLost())return void(this.failedToCreate=!0);if(V.shaderSource(Gt,se),V.compileShader(Gt),!V.getShaderParameter(Gt,V.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${V.getShaderInfoLog(Gt)}`);V.attachShader(this.program,Gt),this.attributes={};let he={};this.numAttributes=J.length;for(let ce=0;ce<this.numAttributes;ce++)J[ce]&&(V.bindAttribLocation(this.program,ce,J[ce]),this.attributes[J[ce]]=ce);if(V.linkProgram(this.program),!V.getProgramParameter(this.program,V.LINK_STATUS))throw new Error(`Program failed to link: ${V.getProgramInfoLog(this.program)}`);V.deleteShader(Gt),V.deleteShader(Bt);for(let ce=0;ce<Rt.length;ce++){let xe=Rt[ce];if(xe&&!he[xe]){let Pe=V.getUniformLocation(this.program,xe);Pe&&(he[xe]=Pe)}}this.fixedUniforms=E(c,he),this.terrainUniforms=((ce,xe)=>({u_depth:new n.aL(ce,xe.u_depth),u_terrain:new n.aL(ce,xe.u_terrain),u_terrain_dim:new n.aM(ce,xe.u_terrain_dim),u_terrain_matrix:new n.aN(ce,xe.u_terrain_matrix),u_terrain_unpack:new n.aO(ce,xe.u_terrain_unpack),u_terrain_exaggeration:new n.aM(ce,xe.u_terrain_exaggeration)}))(c,he),this.binderUniforms=w?w.getUniforms(c,he):[]}draw(c,A,w,E,P,U,V,$,G,J,tt,lt,wt,bt,Rt,yt,Zt,se){let Bt=c.gl;if(this.failedToCreate)return;if(c.program.set(this.program),c.setDepthMode(w),c.setStencilMode(E),c.setColorMode(P),c.setCullFace(U),$){c.activeTexture.set(Bt.TEXTURE2),Bt.bindTexture(Bt.TEXTURE_2D,$.depthTexture),c.activeTexture.set(Bt.TEXTURE3),Bt.bindTexture(Bt.TEXTURE_2D,$.texture);for(let he in this.terrainUniforms)this.terrainUniforms[he].set($[he])}for(let he in this.fixedUniforms)this.fixedUniforms[he].set(V[he]);Rt&&Rt.setUniforms(c,this.binderUniforms,wt,{zoom:bt});let Gt=0;switch(A){case Bt.LINES:Gt=2;break;case Bt.TRIANGLES:Gt=3;break;case Bt.LINE_STRIP:Gt=1}for(let he of lt.get()){let ce=he.vaos||(he.vaos={});(ce[G]||(ce[G]=new ac)).bind(c,this,J,Rt?Rt.getPaintVertexBuffers():[],tt,he.vertexOffset,yt,Zt,se),Bt.drawElements(A,he.primitiveLength*Gt,Bt.UNSIGNED_SHORT,he.primitiveOffset*Gt*2)}}}function ks(M,c,A){let w=1/Yt(A,1,c.transform.tileZoom),E=Math.pow(2,A.tileID.overscaledZ),P=A.tileSize*Math.pow(2,c.transform.tileZoom)/E,U=P*(A.tileID.canonical.x+A.tileID.wrap*E),V=P*A.tileID.canonical.y;return{u_image:0,u_texsize:A.imageAtlasTexture.size,u_scale:[w,M.fromScale,M.toScale],u_fade:M.t,u_pixel_coord_upper:[U>>16,V>>16],u_pixel_coord_lower:[65535&U,65535&V]}}let Z0=(M,c,A,w)=>{let E=c.style.light,P=E.properties.get("position"),U=[P.x,P.y,P.z],V=function(){var G=new n.A(9);return n.A!=Float32Array&&(G[1]=0,G[2]=0,G[3]=0,G[5]=0,G[6]=0,G[7]=0),G[0]=1,G[4]=1,G[8]=1,G}();E.properties.get("anchor")==="viewport"&&function(G,J){var tt=Math.sin(J),lt=Math.cos(J);G[0]=lt,G[1]=tt,G[2]=0,G[3]=-tt,G[4]=lt,G[5]=0,G[6]=0,G[7]=0,G[8]=1}(V,-c.transform.angle),function(G,J,tt){var lt=J[0],wt=J[1],bt=J[2];G[0]=lt*tt[0]+wt*tt[3]+bt*tt[6],G[1]=lt*tt[1]+wt*tt[4]+bt*tt[7],G[2]=lt*tt[2]+wt*tt[5]+bt*tt[8]}(U,U,V);let $=E.properties.get("color");return{u_matrix:M,u_lightpos:U,u_lightintensity:E.properties.get("intensity"),u_lightcolor:[$.r,$.g,$.b],u_vertical_gradient:+A,u_opacity:w}},lc=(M,c,A,w,E,P,U)=>n.e(Z0(M,c,A,w),ks(P,c,U),{u_height_factor:-Math.pow(2,E.overscaledZ)/U.tileSize/8}),ad=M=>({u_matrix:M}),ld=(M,c,A,w)=>n.e(ad(M),ks(A,c,w)),cd=(M,c)=>({u_matrix:M,u_world:c}),ud=(M,c,A,w,E)=>n.e(ld(M,c,A,w),{u_world:E}),ut=(M,c,A,w)=>{let E=M.transform,P,U;if(w.paint.get("circle-pitch-alignment")==="map"){let V=Yt(A,1,E.zoom);P=!0,U=[V,V]}else P=!1,U=E.pixelsToGLUnits;return{u_camera_to_center_distance:E.cameraToCenterDistance,u_scale_with_map:+(w.paint.get("circle-pitch-scale")==="map"),u_matrix:M.translatePosMatrix(c.posMatrix,A,w.paint.get("circle-translate"),w.paint.get("circle-translate-anchor")),u_pitch_with_map:+P,u_device_pixel_ratio:M.pixelRatio,u_extrude_scale:U}},gt=(M,c,A)=>{let w=Yt(A,1,c.zoom),E=Math.pow(2,c.zoom-A.tileID.overscaledZ),P=A.tileID.overscaleFactor();return{u_matrix:M,u_camera_to_center_distance:c.cameraToCenterDistance,u_pixels_to_tile_units:w,u_extrude_scale:[c.pixelsToGLUnits[0]/(w*E),c.pixelsToGLUnits[1]/(w*E)],u_overscale_factor:P}},Wt=(M,c,A=1)=>({u_matrix:M,u_color:c,u_overlay:0,u_overlay_scale:A}),pe=M=>({u_matrix:M}),Be=(M,c,A,w)=>({u_matrix:M,u_extrude_scale:Yt(c,1,A),u_intensity:w});function lr(M,c){let A=Math.pow(2,c.canonical.z),w=c.canonical.y;return[new n.U(0,w/A).toLngLat().lat,new n.U(0,(w+1)/A).toLngLat().lat]}let ki=(M,c,A,w)=>{let E=M.transform;return{u_matrix:YA(M,c,A,w),u_ratio:1/Yt(c,1,E.zoom),u_device_pixel_ratio:M.pixelRatio,u_units_to_pixels:[1/E.pixelsToGLUnits[0],1/E.pixelsToGLUnits[1]]}},Us=(M,c,A,w,E)=>n.e(ki(M,c,A,E),{u_image:0,u_image_height:w}),ao=(M,c,A,w,E)=>{let P=M.transform,U=ol(c,P);return{u_matrix:YA(M,c,A,E),u_texsize:c.imageAtlasTexture.size,u_ratio:1/Yt(c,1,P.zoom),u_device_pixel_ratio:M.pixelRatio,u_image:0,u_scale:[U,w.fromScale,w.toScale],u_fade:w.t,u_units_to_pixels:[1/P.pixelsToGLUnits[0],1/P.pixelsToGLUnits[1]]}},bo=(M,c,A,w,E,P)=>{let U=M.lineAtlas,V=ol(c,M.transform),$=A.layout.get("line-cap")==="round",G=U.getDash(w.from,$),J=U.getDash(w.to,$),tt=G.width*E.fromScale,lt=J.width*E.toScale;return n.e(ki(M,c,A,P),{u_patternscale_a:[V/tt,-G.height/2],u_patternscale_b:[V/lt,-J.height/2],u_sdfgamma:U.width/(256*Math.min(tt,lt)*M.pixelRatio)/2,u_image:0,u_tex_y_a:G.y,u_tex_y_b:J.y,u_mix:E.t})};function ol(M,c){return 1/Yt(M,1,c.tileZoom)}function YA(M,c,A,w){return M.translatePosMatrix(w?w.posMatrix:c.tileID.posMatrix,c,A.paint.get("line-translate"),A.paint.get("line-translate-anchor"))}let Bb=(M,c,A,w,E)=>{return{u_matrix:M,u_tl_parent:c,u_scale_parent:A,u_buffer_scale:1,u_fade_t:w.mix,u_opacity:w.opacity*E.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:E.paint.get("raster-brightness-min"),u_brightness_high:E.paint.get("raster-brightness-max"),u_saturation_factor:(U=E.paint.get("raster-saturation"),U>0?1-1/(1.001-U):-U),u_contrast_factor:(P=E.paint.get("raster-contrast"),P>0?1/(1-P):1+P),u_spin_weights:Nb(E.paint.get("raster-hue-rotate"))};var P,U};function Nb(M){M*=Math.PI/180;let c=Math.sin(M),A=Math.cos(M);return[(2*A+1)/3,(-Math.sqrt(3)*c-A+1)/3,(Math.sqrt(3)*c-A+1)/3]}let q_=(M,c,A,w,E,P,U,V,$,G)=>{let J=E.transform;return{u_is_size_zoom_constant:+(M==="constant"||M==="source"),u_is_size_feature_constant:+(M==="constant"||M==="camera"),u_size_t:c?c.uSizeT:0,u_size:c?c.uSize:0,u_camera_to_center_distance:J.cameraToCenterDistance,u_pitch:J.pitch/360*2*Math.PI,u_rotate_symbol:+A,u_aspect_ratio:J.width/J.height,u_fade_change:E.options.fadeDuration?E.symbolFadeChange:1,u_matrix:P,u_label_plane_matrix:U,u_coord_matrix:V,u_is_text:+$,u_pitch_with_map:+w,u_texsize:G,u_texture:0}},Y_=(M,c,A,w,E,P,U,V,$,G,J)=>{let tt=E.transform;return n.e(q_(M,c,A,w,E,P,U,V,$,G),{u_gamma_scale:w?Math.cos(tt._pitch)*tt.cameraToCenterDistance:1,u_device_pixel_ratio:E.pixelRatio,u_is_halo:+J})},Df=(M,c,A,w,E,P,U,V,$,G)=>n.e(Y_(M,c,A,w,E,P,U,V,!0,$,!0),{u_texsize_icon:G,u_texture_icon:1}),XA=(M,c,A)=>({u_matrix:M,u_opacity:c,u_color:A}),Dl=(M,c,A,w,E,P)=>n.e(function(U,V,$,G){let J=$.imageManager.getPattern(U.from.toString()),tt=$.imageManager.getPattern(U.to.toString()),{width:lt,height:wt}=$.imageManager.getPixelSize(),bt=Math.pow(2,G.tileID.overscaledZ),Rt=G.tileSize*Math.pow(2,$.transform.tileZoom)/bt,yt=Rt*(G.tileID.canonical.x+G.tileID.wrap*bt),Zt=Rt*G.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:J.tl,u_pattern_br_a:J.br,u_pattern_tl_b:tt.tl,u_pattern_br_b:tt.br,u_texsize:[lt,wt],u_mix:V.t,u_pattern_size_a:J.displaySize,u_pattern_size_b:tt.displaySize,u_scale_a:V.fromScale,u_scale_b:V.toScale,u_tile_units_to_pixels:1/Yt(G,1,$.transform.tileZoom),u_pixel_coord_upper:[yt>>16,Zt>>16],u_pixel_coord_lower:[65535&yt,65535&Zt]}}(w,P,A,E),{u_matrix:M,u_opacity:c}),ZA={fillExtrusion:(M,c)=>({u_matrix:new n.aN(M,c.u_matrix),u_lightpos:new n.aP(M,c.u_lightpos),u_lightintensity:new n.aM(M,c.u_lightintensity),u_lightcolor:new n.aP(M,c.u_lightcolor),u_vertical_gradient:new n.aM(M,c.u_vertical_gradient),u_opacity:new n.aM(M,c.u_opacity)}),fillExtrusionPattern:(M,c)=>({u_matrix:new n.aN(M,c.u_matrix),u_lightpos:new n.aP(M,c.u_lightpos),u_lightintensity:new n.aM(M,c.u_lightintensity),u_lightcolor:new n.aP(M,c.u_lightcolor),u_vertical_gradient:new n.aM(M,c.u_vertical_gradient),u_height_factor:new n.aM(M,c.u_height_factor),u_image:new n.aL(M,c.u_image),u_texsize:new n.aQ(M,c.u_texsize),u_pixel_coord_upper:new n.aQ(M,c.u_pixel_coord_upper),u_pixel_coord_lower:new n.aQ(M,c.u_pixel_coord_lower),u_scale:new n.aP(M,c.u_scale),u_fade:new n.aM(M,c.u_fade),u_opacity:new n.aM(M,c.u_opacity)}),fill:(M,c)=>({u_matrix:new n.aN(M,c.u_matrix)}),fillPattern:(M,c)=>({u_matrix:new n.aN(M,c.u_matrix),u_image:new n.aL(M,c.u_image),u_texsize:new n.aQ(M,c.u_texsize),u_pixel_coord_upper:new n.aQ(M,c.u_pixel_coord_upper),u_pixel_coord_lower:new n.aQ(M,c.u_pixel_coord_lower),u_scale:new n.aP(M,c.u_scale),u_fade:new n.aM(M,c.u_fade)}),fillOutline:(M,c)=>({u_matrix:new n.aN(M,c.u_matrix),u_world:new n.aQ(M,c.u_world)}),fillOutlinePattern:(M,c)=>({u_matrix:new n.aN(M,c.u_matrix),u_world:new n.aQ(M,c.u_world),u_image:new n.aL(M,c.u_image),u_texsize:new n.aQ(M,c.u_texsize),u_pixel_coord_upper:new n.aQ(M,c.u_pixel_coord_upper),u_pixel_coord_lower:new n.aQ(M,c.u_pixel_coord_lower),u_scale:new n.aP(M,c.u_scale),u_fade:new n.aM(M,c.u_fade)}),circle:(M,c)=>({u_camera_to_center_distance:new n.aM(M,c.u_camera_to_center_distance),u_scale_with_map:new n.aL(M,c.u_scale_with_map),u_pitch_with_map:new n.aL(M,c.u_pitch_with_map),u_extrude_scale:new n.aQ(M,c.u_extrude_scale),u_device_pixel_ratio:new n.aM(M,c.u_device_pixel_ratio),u_matrix:new n.aN(M,c.u_matrix)}),collisionBox:(M,c)=>({u_matrix:new n.aN(M,c.u_matrix),u_camera_to_center_distance:new n.aM(M,c.u_camera_to_center_distance),u_pixels_to_tile_units:new n.aM(M,c.u_pixels_to_tile_units),u_extrude_scale:new n.aQ(M,c.u_extrude_scale),u_overscale_factor:new n.aM(M,c.u_overscale_factor)}),collisionCircle:(M,c)=>({u_matrix:new n.aN(M,c.u_matrix),u_inv_matrix:new n.aN(M,c.u_inv_matrix),u_camera_to_center_distance:new n.aM(M,c.u_camera_to_center_distance),u_viewport_size:new n.aQ(M,c.u_viewport_size)}),debug:(M,c)=>({u_color:new n.aR(M,c.u_color),u_matrix:new n.aN(M,c.u_matrix),u_overlay:new n.aL(M,c.u_overlay),u_overlay_scale:new n.aM(M,c.u_overlay_scale)}),clippingMask:(M,c)=>({u_matrix:new n.aN(M,c.u_matrix)}),heatmap:(M,c)=>({u_extrude_scale:new n.aM(M,c.u_extrude_scale),u_intensity:new n.aM(M,c.u_intensity),u_matrix:new n.aN(M,c.u_matrix)}),heatmapTexture:(M,c)=>({u_matrix:new n.aN(M,c.u_matrix),u_world:new n.aQ(M,c.u_world),u_image:new n.aL(M,c.u_image),u_color_ramp:new n.aL(M,c.u_color_ramp),u_opacity:new n.aM(M,c.u_opacity)}),hillshade:(M,c)=>({u_matrix:new n.aN(M,c.u_matrix),u_image:new n.aL(M,c.u_image),u_latrange:new n.aQ(M,c.u_latrange),u_light:new n.aQ(M,c.u_light),u_shadow:new n.aR(M,c.u_shadow),u_highlight:new n.aR(M,c.u_highlight),u_accent:new n.aR(M,c.u_accent)}),hillshadePrepare:(M,c)=>({u_matrix:new n.aN(M,c.u_matrix),u_image:new n.aL(M,c.u_image),u_dimension:new n.aQ(M,c.u_dimension),u_zoom:new n.aM(M,c.u_zoom),u_unpack:new n.aO(M,c.u_unpack)}),line:(M,c)=>({u_matrix:new n.aN(M,c.u_matrix),u_ratio:new n.aM(M,c.u_ratio),u_device_pixel_ratio:new n.aM(M,c.u_device_pixel_ratio),u_units_to_pixels:new n.aQ(M,c.u_units_to_pixels)}),lineGradient:(M,c)=>({u_matrix:new n.aN(M,c.u_matrix),u_ratio:new n.aM(M,c.u_ratio),u_device_pixel_ratio:new n.aM(M,c.u_device_pixel_ratio),u_units_to_pixels:new n.aQ(M,c.u_units_to_pixels),u_image:new n.aL(M,c.u_image),u_image_height:new n.aM(M,c.u_image_height)}),linePattern:(M,c)=>({u_matrix:new n.aN(M,c.u_matrix),u_texsize:new n.aQ(M,c.u_texsize),u_ratio:new n.aM(M,c.u_ratio),u_device_pixel_ratio:new n.aM(M,c.u_device_pixel_ratio),u_image:new n.aL(M,c.u_image),u_units_to_pixels:new n.aQ(M,c.u_units_to_pixels),u_scale:new n.aP(M,c.u_scale),u_fade:new n.aM(M,c.u_fade)}),lineSDF:(M,c)=>({u_matrix:new n.aN(M,c.u_matrix),u_ratio:new n.aM(M,c.u_ratio),u_device_pixel_ratio:new n.aM(M,c.u_device_pixel_ratio),u_units_to_pixels:new n.aQ(M,c.u_units_to_pixels),u_patternscale_a:new n.aQ(M,c.u_patternscale_a),u_patternscale_b:new n.aQ(M,c.u_patternscale_b),u_sdfgamma:new n.aM(M,c.u_sdfgamma),u_image:new n.aL(M,c.u_image),u_tex_y_a:new n.aM(M,c.u_tex_y_a),u_tex_y_b:new n.aM(M,c.u_tex_y_b),u_mix:new n.aM(M,c.u_mix)}),raster:(M,c)=>({u_matrix:new n.aN(M,c.u_matrix),u_tl_parent:new n.aQ(M,c.u_tl_parent),u_scale_parent:new n.aM(M,c.u_scale_parent),u_buffer_scale:new n.aM(M,c.u_buffer_scale),u_fade_t:new n.aM(M,c.u_fade_t),u_opacity:new n.aM(M,c.u_opacity),u_image0:new n.aL(M,c.u_image0),u_image1:new n.aL(M,c.u_image1),u_brightness_low:new n.aM(M,c.u_brightness_low),u_brightness_high:new n.aM(M,c.u_brightness_high),u_saturation_factor:new n.aM(M,c.u_saturation_factor),u_contrast_factor:new n.aM(M,c.u_contrast_factor),u_spin_weights:new n.aP(M,c.u_spin_weights)}),symbolIcon:(M,c)=>({u_is_size_zoom_constant:new n.aL(M,c.u_is_size_zoom_constant),u_is_size_feature_constant:new n.aL(M,c.u_is_size_feature_constant),u_size_t:new n.aM(M,c.u_size_t),u_size:new n.aM(M,c.u_size),u_camera_to_center_distance:new n.aM(M,c.u_camera_to_center_distance),u_pitch:new n.aM(M,c.u_pitch),u_rotate_symbol:new n.aL(M,c.u_rotate_symbol),u_aspect_ratio:new n.aM(M,c.u_aspect_ratio),u_fade_change:new n.aM(M,c.u_fade_change),u_matrix:new n.aN(M,c.u_matrix),u_label_plane_matrix:new n.aN(M,c.u_label_plane_matrix),u_coord_matrix:new n.aN(M,c.u_coord_matrix),u_is_text:new n.aL(M,c.u_is_text),u_pitch_with_map:new n.aL(M,c.u_pitch_with_map),u_texsize:new n.aQ(M,c.u_texsize),u_texture:new n.aL(M,c.u_texture)}),symbolSDF:(M,c)=>({u_is_size_zoom_constant:new n.aL(M,c.u_is_size_zoom_constant),u_is_size_feature_constant:new n.aL(M,c.u_is_size_feature_constant),u_size_t:new n.aM(M,c.u_size_t),u_size:new n.aM(M,c.u_size),u_camera_to_center_distance:new n.aM(M,c.u_camera_to_center_distance),u_pitch:new n.aM(M,c.u_pitch),u_rotate_symbol:new n.aL(M,c.u_rotate_symbol),u_aspect_ratio:new n.aM(M,c.u_aspect_ratio),u_fade_change:new n.aM(M,c.u_fade_change),u_matrix:new n.aN(M,c.u_matrix),u_label_plane_matrix:new n.aN(M,c.u_label_plane_matrix),u_coord_matrix:new n.aN(M,c.u_coord_matrix),u_is_text:new n.aL(M,c.u_is_text),u_pitch_with_map:new n.aL(M,c.u_pitch_with_map),u_texsize:new n.aQ(M,c.u_texsize),u_texture:new n.aL(M,c.u_texture),u_gamma_scale:new n.aM(M,c.u_gamma_scale),u_device_pixel_ratio:new n.aM(M,c.u_device_pixel_ratio),u_is_halo:new n.aL(M,c.u_is_halo)}),symbolTextAndIcon:(M,c)=>({u_is_size_zoom_constant:new n.aL(M,c.u_is_size_zoom_constant),u_is_size_feature_constant:new n.aL(M,c.u_is_size_feature_constant),u_size_t:new n.aM(M,c.u_size_t),u_size:new n.aM(M,c.u_size),u_camera_to_center_distance:new n.aM(M,c.u_camera_to_center_distance),u_pitch:new n.aM(M,c.u_pitch),u_rotate_symbol:new n.aL(M,c.u_rotate_symbol),u_aspect_ratio:new n.aM(M,c.u_aspect_ratio),u_fade_change:new n.aM(M,c.u_fade_change),u_matrix:new n.aN(M,c.u_matrix),u_label_plane_matrix:new n.aN(M,c.u_label_plane_matrix),u_coord_matrix:new n.aN(M,c.u_coord_matrix),u_is_text:new n.aL(M,c.u_is_text),u_pitch_with_map:new n.aL(M,c.u_pitch_with_map),u_texsize:new n.aQ(M,c.u_texsize),u_texsize_icon:new n.aQ(M,c.u_texsize_icon),u_texture:new n.aL(M,c.u_texture),u_texture_icon:new n.aL(M,c.u_texture_icon),u_gamma_scale:new n.aM(M,c.u_gamma_scale),u_device_pixel_ratio:new n.aM(M,c.u_device_pixel_ratio),u_is_halo:new n.aL(M,c.u_is_halo)}),background:(M,c)=>({u_matrix:new n.aN(M,c.u_matrix),u_opacity:new n.aM(M,c.u_opacity),u_color:new n.aR(M,c.u_color)}),backgroundPattern:(M,c)=>({u_matrix:new n.aN(M,c.u_matrix),u_opacity:new n.aM(M,c.u_opacity),u_image:new n.aL(M,c.u_image),u_pattern_tl_a:new n.aQ(M,c.u_pattern_tl_a),u_pattern_br_a:new n.aQ(M,c.u_pattern_br_a),u_pattern_tl_b:new n.aQ(M,c.u_pattern_tl_b),u_pattern_br_b:new n.aQ(M,c.u_pattern_br_b),u_texsize:new n.aQ(M,c.u_texsize),u_mix:new n.aM(M,c.u_mix),u_pattern_size_a:new n.aQ(M,c.u_pattern_size_a),u_pattern_size_b:new n.aQ(M,c.u_pattern_size_b),u_scale_a:new n.aM(M,c.u_scale_a),u_scale_b:new n.aM(M,c.u_scale_b),u_pixel_coord_upper:new n.aQ(M,c.u_pixel_coord_upper),u_pixel_coord_lower:new n.aQ(M,c.u_pixel_coord_lower),u_tile_units_to_pixels:new n.aM(M,c.u_tile_units_to_pixels)}),terrain:(M,c)=>({u_matrix:new n.aN(M,c.u_matrix),u_texture:new n.aL(M,c.u_texture),u_ele_delta:new n.aM(M,c.u_ele_delta)}),terrainDepth:(M,c)=>({u_matrix:new n.aN(M,c.u_matrix),u_ele_delta:new n.aM(M,c.u_ele_delta)}),terrainCoords:(M,c)=>({u_matrix:new n.aN(M,c.u_matrix),u_texture:new n.aL(M,c.u_texture),u_terrain_coords_id:new n.aM(M,c.u_terrain_coords_id),u_ele_delta:new n.aM(M,c.u_ele_delta)})};class GA{constructor(c,A,w){this.context=c;let E=c.gl;this.buffer=E.createBuffer(),this.dynamicDraw=!!w,this.context.unbindVAO(),c.bindElementBuffer.set(this.buffer),E.bufferData(E.ELEMENT_ARRAY_BUFFER,A.arrayBuffer,this.dynamicDraw?E.DYNAMIC_DRAW:E.STATIC_DRAW),this.dynamicDraw||delete A.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(c){let A=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),A.bufferSubData(A.ELEMENT_ARRAY_BUFFER,0,c.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}let G0={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class QA{constructor(c,A,w,E){this.length=A.length,this.attributes=w,this.itemSize=A.bytesPerElement,this.dynamicDraw=E,this.context=c;let P=c.gl;this.buffer=P.createBuffer(),c.bindVertexBuffer.set(this.buffer),P.bufferData(P.ARRAY_BUFFER,A.arrayBuffer,this.dynamicDraw?P.DYNAMIC_DRAW:P.STATIC_DRAW),this.dynamicDraw||delete A.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(c){if(c.length!==this.length)throw new Error(`Length of new data is ${c.length}, which doesn't match current length of ${this.length}`);let A=this.context.gl;this.bind(),A.bufferSubData(A.ARRAY_BUFFER,0,c.arrayBuffer)}enableAttributes(c,A){for(let w=0;w<this.attributes.length;w++){let E=A.attributes[this.attributes[w].name];E!==void 0&&c.enableVertexAttribArray(E)}}setVertexAttribPointers(c,A,w){for(let E=0;E<this.attributes.length;E++){let P=this.attributes[E],U=A.attributes[P.name];U!==void 0&&c.vertexAttribPointer(U,P.components,c[G0[P.type]],!1,this.itemSize,P.offset+this.itemSize*(w||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}let hd=new WeakMap;function Dh(M){var c;if(hd.has(M))return hd.get(M);{let A=(c=M.getParameter(M.VERSION))===null||c===void 0?void 0:c.startsWith("WebGL 2.0");return hd.set(M,A),A}}class Xi{constructor(c){this.gl=c.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(c){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class KA extends Xi{getDefault(){return n.aT.transparent}set(c){let A=this.current;(c.r!==A.r||c.g!==A.g||c.b!==A.b||c.a!==A.a||this.dirty)&&(this.gl.clearColor(c.r,c.g,c.b,c.a),this.current=c,this.dirty=!1)}}class al extends Xi{getDefault(){return 1}set(c){(c!==this.current||this.dirty)&&(this.gl.clearDepth(c),this.current=c,this.dirty=!1)}}class ll extends Xi{getDefault(){return 0}set(c){(c!==this.current||this.dirty)&&(this.gl.clearStencil(c),this.current=c,this.dirty=!1)}}class X_ extends Xi{getDefault(){return[!0,!0,!0,!0]}set(c){let A=this.current;(c[0]!==A[0]||c[1]!==A[1]||c[2]!==A[2]||c[3]!==A[3]||this.dirty)&&(this.gl.colorMask(c[0],c[1],c[2],c[3]),this.current=c,this.dirty=!1)}}class JA extends Xi{getDefault(){return!0}set(c){(c!==this.current||this.dirty)&&(this.gl.depthMask(c),this.current=c,this.dirty=!1)}}class tg extends Xi{getDefault(){return 255}set(c){(c!==this.current||this.dirty)&&(this.gl.stencilMask(c),this.current=c,this.dirty=!1)}}class Z_ extends Xi{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(c){let A=this.current;(c.func!==A.func||c.ref!==A.ref||c.mask!==A.mask||this.dirty)&&(this.gl.stencilFunc(c.func,c.ref,c.mask),this.current=c,this.dirty=!1)}}class G_ extends Xi{getDefault(){let c=this.gl;return[c.KEEP,c.KEEP,c.KEEP]}set(c){let A=this.current;(c[0]!==A[0]||c[1]!==A[1]||c[2]!==A[2]||this.dirty)&&(this.gl.stencilOp(c[0],c[1],c[2]),this.current=c,this.dirty=!1)}}class eg extends Xi{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;let A=this.gl;c?A.enable(A.STENCIL_TEST):A.disable(A.STENCIL_TEST),this.current=c,this.dirty=!1}}class Q_ extends Xi{getDefault(){return[0,1]}set(c){let A=this.current;(c[0]!==A[0]||c[1]!==A[1]||this.dirty)&&(this.gl.depthRange(c[0],c[1]),this.current=c,this.dirty=!1)}}class K_ extends Xi{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;let A=this.gl;c?A.enable(A.DEPTH_TEST):A.disable(A.DEPTH_TEST),this.current=c,this.dirty=!1}}class rg extends Xi{getDefault(){return this.gl.LESS}set(c){(c!==this.current||this.dirty)&&(this.gl.depthFunc(c),this.current=c,this.dirty=!1)}}class Lb extends Xi{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;let A=this.gl;c?A.enable(A.BLEND):A.disable(A.BLEND),this.current=c,this.dirty=!1}}class Fb extends Xi{getDefault(){let c=this.gl;return[c.ONE,c.ZERO]}set(c){let A=this.current;(c[0]!==A[0]||c[1]!==A[1]||this.dirty)&&(this.gl.blendFunc(c[0],c[1]),this.current=c,this.dirty=!1)}}class fd extends Xi{getDefault(){return n.aT.transparent}set(c){let A=this.current;(c.r!==A.r||c.g!==A.g||c.b!==A.b||c.a!==A.a||this.dirty)&&(this.gl.blendColor(c.r,c.g,c.b,c.a),this.current=c,this.dirty=!1)}}class w4 extends Xi{getDefault(){return this.gl.FUNC_ADD}set(c){(c!==this.current||this.dirty)&&(this.gl.blendEquation(c),this.current=c,this.dirty=!1)}}class T4 extends Xi{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;let A=this.gl;c?A.enable(A.CULL_FACE):A.disable(A.CULL_FACE),this.current=c,this.dirty=!1}}class S4 extends Xi{getDefault(){return this.gl.BACK}set(c){(c!==this.current||this.dirty)&&(this.gl.cullFace(c),this.current=c,this.dirty=!1)}}class E4 extends Xi{getDefault(){return this.gl.CCW}set(c){(c!==this.current||this.dirty)&&(this.gl.frontFace(c),this.current=c,this.dirty=!1)}}class J_ extends Xi{getDefault(){return null}set(c){(c!==this.current||this.dirty)&&(this.gl.useProgram(c),this.current=c,this.dirty=!1)}}class zb extends Xi{getDefault(){return this.gl.TEXTURE0}set(c){(c!==this.current||this.dirty)&&(this.gl.activeTexture(c),this.current=c,this.dirty=!1)}}class ig extends Xi{getDefault(){let c=this.gl;return[0,0,c.drawingBufferWidth,c.drawingBufferHeight]}set(c){let A=this.current;(c[0]!==A[0]||c[1]!==A[1]||c[2]!==A[2]||c[3]!==A[3]||this.dirty)&&(this.gl.viewport(c[0],c[1],c[2],c[3]),this.current=c,this.dirty=!1)}}class Of extends Xi{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;let A=this.gl;A.bindFramebuffer(A.FRAMEBUFFER,c),this.current=c,this.dirty=!1}}class Q0 extends Xi{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;let A=this.gl;A.bindRenderbuffer(A.RENDERBUFFER,c),this.current=c,this.dirty=!1}}class K0 extends Xi{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;let A=this.gl;A.bindTexture(A.TEXTURE_2D,c),this.current=c,this.dirty=!1}}class Oh extends Xi{getDefault(){return null}set(c){if(c===this.current&&!this.dirty)return;let A=this.gl;A.bindBuffer(A.ARRAY_BUFFER,c),this.current=c,this.dirty=!1}}class pd extends Xi{getDefault(){return null}set(c){let A=this.gl;A.bindBuffer(A.ELEMENT_ARRAY_BUFFER,c),this.current=c,this.dirty=!1}}class J0 extends Xi{getDefault(){return null}set(c){var A;if(c===this.current&&!this.dirty)return;let w=this.gl;Dh(w)?w.bindVertexArray(c):(A=w.getExtension("OES_vertex_array_object"))===null||A===void 0||A.bindVertexArrayOES(c),this.current=c,this.dirty=!1}}class Zc extends Xi{getDefault(){return 4}set(c){if(c===this.current&&!this.dirty)return;let A=this.gl;A.pixelStorei(A.UNPACK_ALIGNMENT,c),this.current=c,this.dirty=!1}}class oe extends Xi{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;let A=this.gl;A.pixelStorei(A.UNPACK_PREMULTIPLY_ALPHA_WEBGL,c),this.current=c,this.dirty=!1}}class we extends Xi{getDefault(){return!1}set(c){if(c===this.current&&!this.dirty)return;let A=this.gl;A.pixelStorei(A.UNPACK_FLIP_Y_WEBGL,c),this.current=c,this.dirty=!1}}class We extends Xi{constructor(c,A){super(c),this.context=c,this.parent=A}getDefault(){return null}}class kr extends We{setDirty(){this.dirty=!0}set(c){if(c===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let A=this.gl;A.framebufferTexture2D(A.FRAMEBUFFER,A.COLOR_ATTACHMENT0,A.TEXTURE_2D,c,0),this.current=c,this.dirty=!1}}class _ extends We{set(c){if(c===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let A=this.gl;A.framebufferRenderbuffer(A.FRAMEBUFFER,A.DEPTH_ATTACHMENT,A.RENDERBUFFER,c),this.current=c,this.dirty=!1}}class wn extends We{set(c){if(c===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);let A=this.gl;A.framebufferRenderbuffer(A.FRAMEBUFFER,A.DEPTH_STENCIL_ATTACHMENT,A.RENDERBUFFER,c),this.current=c,this.dirty=!1}}class yr{constructor(c,A,w,E,P){this.context=c,this.width=A,this.height=w;let U=c.gl,V=this.framebuffer=U.createFramebuffer();if(this.colorAttachment=new kr(c,V),E)this.depthAttachment=P?new wn(c,V):new _(c,V);else if(P)throw new Error("Stencil cannot be setted without depth");if(U.checkFramebufferStatus(U.FRAMEBUFFER)!==U.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){let c=this.context.gl,A=this.colorAttachment.get();if(A&&c.deleteTexture(A),this.depthAttachment){let w=this.depthAttachment.get();w&&c.deleteRenderbuffer(w)}c.deleteFramebuffer(this.framebuffer)}}class ft{constructor(c,A,w){this.blendFunction=c,this.blendColor=A,this.mask=w}}ft.Replace=[1,0],ft.disabled=new ft(ft.Replace,n.aT.transparent,[!1,!1,!1,!1]),ft.unblended=new ft(ft.Replace,n.aT.transparent,[!0,!0,!0,!0]),ft.alphaBlended=new ft([1,771],n.aT.transparent,[!0,!0,!0,!0]);class lo{constructor(c){var A,w;if(this.gl=c,this.clearColor=new KA(this),this.clearDepth=new al(this),this.clearStencil=new ll(this),this.colorMask=new X_(this),this.depthMask=new JA(this),this.stencilMask=new tg(this),this.stencilFunc=new Z_(this),this.stencilOp=new G_(this),this.stencilTest=new eg(this),this.depthRange=new Q_(this),this.depthTest=new K_(this),this.depthFunc=new rg(this),this.blend=new Lb(this),this.blendFunc=new Fb(this),this.blendColor=new fd(this),this.blendEquation=new w4(this),this.cullFace=new T4(this),this.cullFaceSide=new S4(this),this.frontFace=new E4(this),this.program=new J_(this),this.activeTexture=new zb(this),this.viewport=new ig(this),this.bindFramebuffer=new Of(this),this.bindRenderbuffer=new Q0(this),this.bindTexture=new K0(this),this.bindVertexBuffer=new Oh(this),this.bindElementBuffer=new pd(this),this.bindVertexArray=new J0(this),this.pixelStoreUnpack=new Zc(this),this.pixelStoreUnpackPremultiplyAlpha=new oe(this),this.pixelStoreUnpackFlipY=new we(this),this.extTextureFilterAnisotropic=c.getExtension("EXT_texture_filter_anisotropic")||c.getExtension("MOZ_EXT_texture_filter_anisotropic")||c.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=c.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=c.getParameter(c.MAX_TEXTURE_SIZE),Dh(c)){this.HALF_FLOAT=c.HALF_FLOAT;let E=c.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(A=c.RGBA16F)!==null&&A!==void 0?A:E?.RGBA16F_EXT,this.RGB16F=(w=c.RGB16F)!==null&&w!==void 0?w:E?.RGB16F_EXT,c.getExtension("EXT_color_buffer_float")}else{c.getExtension("EXT_color_buffer_half_float"),c.getExtension("OES_texture_half_float_linear");let E=c.getExtension("OES_texture_half_float");this.HALF_FLOAT=E?.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(c,A){return new GA(this,c,A)}createVertexBuffer(c,A,w){return new QA(this,c,A,w)}createRenderbuffer(c,A,w){let E=this.gl,P=E.createRenderbuffer();return this.bindRenderbuffer.set(P),E.renderbufferStorage(E.RENDERBUFFER,c,A,w),this.bindRenderbuffer.set(null),P}createFramebuffer(c,A,w,E){return new yr(this,c,A,w,E)}clear({color:c,depth:A,stencil:w}){let E=this.gl,P=0;c&&(P|=E.COLOR_BUFFER_BIT,this.clearColor.set(c),this.colorMask.set([!0,!0,!0,!0])),A!==void 0&&(P|=E.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(A),this.depthMask.set(!0)),w!==void 0&&(P|=E.STENCIL_BUFFER_BIT,this.clearStencil.set(w),this.stencilMask.set(255)),E.clear(P)}setCullFace(c){c.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(c.mode),this.frontFace.set(c.frontFace))}setDepthMode(c){c.func!==this.gl.ALWAYS||c.mask?(this.depthTest.set(!0),this.depthFunc.set(c.func),this.depthMask.set(c.mask),this.depthRange.set(c.range)):this.depthTest.set(!1)}setStencilMode(c){c.test.func!==this.gl.ALWAYS||c.mask?(this.stencilTest.set(!0),this.stencilMask.set(c.mask),this.stencilOp.set([c.fail,c.depthFail,c.pass]),this.stencilFunc.set({func:c.test.func,ref:c.ref,mask:c.test.mask})):this.stencilTest.set(!1)}setColorMode(c){n.aG(c.blendFunction,ft.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(c.blendFunction),this.blendColor.set(c.blendColor)),this.colorMask.set(c.mask)}createVertexArray(){var c;return Dh(this.gl)?this.gl.createVertexArray():(c=this.gl.getExtension("OES_vertex_array_object"))===null||c===void 0?void 0:c.createVertexArrayOES()}deleteVertexArray(c){var A;return Dh(this.gl)?this.gl.deleteVertexArray(c):(A=this.gl.getExtension("OES_vertex_array_object"))===null||A===void 0?void 0:A.deleteVertexArrayOES(c)}unbindVAO(){this.bindVertexArray.set(null)}}class Wr{constructor(c,A,w){this.func=c,this.mask=A,this.range=w}}Wr.ReadOnly=!1,Wr.ReadWrite=!0,Wr.disabled=new Wr(519,Wr.ReadOnly,[0,1]);let ss=7680;class Fr{constructor(c,A,w,E,P,U){this.test=c,this.ref=A,this.mask=w,this.fail=E,this.depthFail=P,this.pass=U}}Fr.disabled=new Fr({func:519,mask:0},0,0,ss,ss,ss);class Jr{constructor(c,A,w){this.enable=c,this.mode=A,this.frontFace=w}}let vs;function cn(M,c,A,w,E,P,U){let V=M.context,$=V.gl,G=M.useProgram("collisionBox"),J=[],tt=0,lt=0;for(let Bt=0;Bt<w.length;Bt++){let Gt=w[Bt],he=c.getTile(Gt),ce=he.getBucket(A);if(!ce)continue;let xe=Gt.posMatrix;E[0]===0&&E[1]===0||(xe=M.translatePosMatrix(Gt.posMatrix,he,E,P));let Pe=U?ce.textCollisionBox:ce.iconCollisionBox,Te=ce.collisionCircleArray;if(Te.length>0){let Le=n.Z(),hr=xe;n.aU(Le,ce.placementInvProjMatrix,M.transform.glCoordMatrix),n.aU(Le,Le,ce.placementViewportMatrix),J.push({circleArray:Te,circleOffset:lt,transform:hr,invTransform:Le,coord:Gt}),tt+=Te.length/4,lt=tt}Pe&&G.draw(V,$.LINES,Wr.disabled,Fr.disabled,M.colorModeForRenderPass(),Jr.disabled,gt(xe,M.transform,he),M.style.map.terrain&&M.style.map.terrain.getTerrainData(Gt),A.id,Pe.layoutVertexBuffer,Pe.indexBuffer,Pe.segments,null,M.transform.zoom,null,null,Pe.collisionVertexBuffer)}if(!U||!J.length)return;let wt=M.useProgram("collisionCircle"),bt=new n.aV;bt.resize(4*tt),bt._trim();let Rt=0;for(let Bt of J)for(let Gt=0;Gt<Bt.circleArray.length/4;Gt++){let he=4*Gt,ce=Bt.circleArray[he+0],xe=Bt.circleArray[he+1],Pe=Bt.circleArray[he+2],Te=Bt.circleArray[he+3];bt.emplace(Rt++,ce,xe,Pe,Te,0),bt.emplace(Rt++,ce,xe,Pe,Te,1),bt.emplace(Rt++,ce,xe,Pe,Te,2),bt.emplace(Rt++,ce,xe,Pe,Te,3)}(!vs||vs.length<2*tt)&&(vs=function(Bt){let Gt=2*Bt,he=new n.aX;he.resize(Gt),he._trim();for(let ce=0;ce<Gt;ce++){let xe=6*ce;he.uint16[xe+0]=4*ce+0,he.uint16[xe+1]=4*ce+1,he.uint16[xe+2]=4*ce+2,he.uint16[xe+3]=4*ce+2,he.uint16[xe+4]=4*ce+3,he.uint16[xe+5]=4*ce+0}return he}(tt));let yt=V.createIndexBuffer(vs,!0),Zt=V.createVertexBuffer(bt,n.aW.members,!0);for(let Bt of J){let Gt={u_matrix:Bt.transform,u_inv_matrix:Bt.invTransform,u_camera_to_center_distance:(se=M.transform).cameraToCenterDistance,u_viewport_size:[se.width,se.height]};wt.draw(V,$.TRIANGLES,Wr.disabled,Fr.disabled,M.colorModeForRenderPass(),Jr.disabled,Gt,M.style.map.terrain&&M.style.map.terrain.getTerrainData(Bt.coord),A.id,Zt,yt,n.S.simpleSegment(0,2*Bt.circleOffset,Bt.circleArray.length,Bt.circleArray.length/2),null,M.transform.zoom,null,null,null)}var se;Zt.destroy(),yt.destroy()}Jr.disabled=new Jr(!1,1029,2305),Jr.backCCW=new Jr(!0,1029,2305);let un=n.ao(new Float32Array(16));function ku(M,c,A,w,E,P){let{horizontalAlign:U,verticalAlign:V}=n.au(M);return new n.P((-(U-.5)*c/E+w[0])*P,(-(V-.5)*A/E+w[1])*P)}function tm(M,c,A,w,E,P,U,V,$,G,J){let tt=M.text.placedSymbolArray,lt=M.text.dynamicLayoutVertexArray,wt=M.icon.dynamicLayoutVertexArray,bt={};lt.clear();for(let Rt=0;Rt<tt.length;Rt++){let yt=tt.get(Rt),Zt=yt.hidden||!yt.crossTileID||M.allowVerticalPlacement&&!yt.placedOrientation?null:w[yt.crossTileID];if(Zt){let se=new n.P(yt.anchorX,yt.anchorY),Bt=Qn(se,A?U:P,J),Gt=nc(E.cameraToCenterDistance,Bt.signedDistanceFromCamera),he=n.aj(M.textSizeData,$,yt)*Gt/n.ap;A&&(he*=M.tilePixelRatio/V);let{width:ce,height:xe,anchor:Pe,textOffset:Te,textBoxScale:Le}=Zt,hr=ku(Pe,ce,xe,Te,Le,he),Di=A?Qn(se.add(hr),P,J).point:Bt.point.add(c?hr.rotate(-E.angle):hr),He=M.allowVerticalPlacement&&yt.placedOrientation===n.ai.vertical?Math.PI/2:0;for(let Cr=0;Cr<yt.numGlyphs;Cr++)n.ak(lt,Di,He);G&&yt.associatedIconIndex>=0&&(bt[yt.associatedIconIndex]={shiftedAnchor:Di,angle:He})}else mt(yt.numGlyphs,lt)}if(G){wt.clear();let Rt=M.icon.placedSymbolArray;for(let yt=0;yt<Rt.length;yt++){let Zt=Rt.get(yt);if(Zt.hidden)mt(Zt.numGlyphs,wt);else{let se=bt[yt];if(se)for(let Bt=0;Bt<Zt.numGlyphs;Bt++)n.ak(wt,se.shiftedAnchor,se.angle);else mt(Zt.numGlyphs,wt)}}M.icon.dynamicLayoutVertexBuffer.updateData(wt)}M.text.dynamicLayoutVertexBuffer.updateData(lt)}function ng(M,c,A){return A.iconsInText&&c?"symbolTextAndIcon":M?"symbolSDF":"symbolIcon"}function Bf(M,c,A,w,E,P,U,V,$,G,J,tt){let lt=M.context,wt=lt.gl,bt=M.transform,Rt=V==="map",yt=$==="map",Zt=V!=="viewport"&&A.layout.get("symbol-placement")!=="point",se=Rt&&!yt&&!Zt,Bt=!A.layout.get("symbol-sort-key").isConstant(),Gt=!1,he=M.depthModeForSublayer(0,Wr.ReadOnly),ce=A._unevaluatedLayout.hasValue("text-variable-anchor")||A._unevaluatedLayout.hasValue("text-variable-anchor-offset"),xe=[];for(let Pe of w){let Te=c.getTile(Pe),Le=Te.getBucket(A);if(!Le)continue;let hr=E?Le.text:Le.icon;if(!hr||!hr.segments.get().length||!hr.hasVisibleVertices)continue;let Di=hr.programConfigurations.get(A.id),He=E||Le.sdfIcons,Cr=E?Le.textSizeData:Le.iconSizeData,fr=yt||bt.pitch!==0,dn=M.useProgram(ng(He,E,Le),Di),Ci=n.ah(Cr,bt.zoom),fi=M.style.map.terrain&&M.style.map.terrain.getTerrainData(Pe),Oi,Ts,Un,vo,Gs=[0,0],Ss=null;if(E)Ts=Te.glyphAtlasTexture,Un=wt.LINEAR,Oi=Te.glyphAtlasTexture.size,Le.iconsInText&&(Gs=Te.imageAtlasTexture.size,Ss=Te.imageAtlasTexture,vo=fr||M.options.rotating||M.options.zooming||Cr.kind==="composite"||Cr.kind==="camera"?wt.LINEAR:wt.NEAREST);else{let ps=A.layout.get("icon-size").constantOr(0)!==1||Le.iconsNeedLinear;Ts=Te.imageAtlasTexture,Un=He||M.options.rotating||M.options.zooming||ps||fr?wt.LINEAR:wt.NEAREST,Oi=Te.imageAtlasTexture.size}let Oa=Yt(Te,1,M.transform.zoom),Vn=Ne(Pe.posMatrix,yt,Rt,M.transform,Oa),co=la(Pe.posMatrix,yt,Rt,M.transform,Oa),Bl=ce&&Le.hasTextData(),Fu=A.layout.get("icon-text-fit")!=="none"&&Bl&&Le.hasIconData();if(Zt){let ps=M.style.map.terrain?(da,Is)=>M.style.map.terrain.getElevation(Pe,da,Is):null,Qs=A.layout.get("text-rotation-alignment")==="map";Ue(Le,Pe.posMatrix,M,E,Vn,co,yt,G,Qs,ps)}let zh=M.translatePosMatrix(Pe.posMatrix,Te,P,U),Wf=Zt||E&&ce||Fu?un:Vn,Vo=M.translatePosMatrix(co,Te,P,U,!0),wo=He&&A.paint.get(E?"text-halo-width":"icon-halo-width").constantOr(1)!==0,Es;Es=He?Le.iconsInText?Df(Cr.kind,Ci,se,yt,M,zh,Wf,Vo,Oi,Gs):Y_(Cr.kind,Ci,se,yt,M,zh,Wf,Vo,E,Oi,!0):q_(Cr.kind,Ci,se,yt,M,zh,Wf,Vo,E,Oi);let zu={program:dn,buffers:hr,uniformValues:Es,atlasTexture:Ts,atlasTextureIcon:Ss,atlasInterpolation:Un,atlasInterpolationIcon:vo,isSDF:He,hasHalo:wo};if(Bt&&Le.canOverlap){Gt=!0;let ps=hr.segments.get();for(let Qs of ps)xe.push({segments:new n.S([Qs]),sortKey:Qs.sortKey,state:zu,terrainData:fi})}else xe.push({segments:hr.segments,sortKey:0,state:zu,terrainData:fi})}Gt&&xe.sort((Pe,Te)=>Pe.sortKey-Te.sortKey);for(let Pe of xe){let Te=Pe.state;if(lt.activeTexture.set(wt.TEXTURE0),Te.atlasTexture.bind(Te.atlasInterpolation,wt.CLAMP_TO_EDGE),Te.atlasTextureIcon&&(lt.activeTexture.set(wt.TEXTURE1),Te.atlasTextureIcon&&Te.atlasTextureIcon.bind(Te.atlasInterpolationIcon,wt.CLAMP_TO_EDGE)),Te.isSDF){let Le=Te.uniformValues;Te.hasHalo&&(Le.u_is_halo=1,ua(Te.buffers,Pe.segments,A,M,Te.program,he,J,tt,Le,Pe.terrainData)),Le.u_is_halo=0}ua(Te.buffers,Pe.segments,A,M,Te.program,he,J,tt,Te.uniformValues,Pe.terrainData)}}function ua(M,c,A,w,E,P,U,V,$,G){let J=w.context;E.draw(J,J.gl.TRIANGLES,P,U,V,Jr.disabled,$,G,A.id,M.layoutVertexBuffer,M.indexBuffer,c,A.paint,w.transform.zoom,M.programConfigurations.get(A.id),M.dynamicLayoutVertexBuffer,M.opacityVertexBuffer)}function cc(M,c,A,w,E){if(!A||!w||!w.imageAtlas)return;let P=w.imageAtlas.patternPositions,U=P[A.to.toString()],V=P[A.from.toString()];if(!U&&V&&(U=V),!V&&U&&(V=U),!U||!V){let $=E.getPaintProperty(c);U=P[$],V=P[$]}U&&V&&M.setConstantPatternPositions(U,V)}function ha(M,c,A,w,E,P,U){let V=M.context.gl,$="fill-pattern",G=A.paint.get($),J=G&&G.constantOr(1),tt=A.getCrossfadeParameters(),lt,wt,bt,Rt,yt;U?(wt=J&&!A.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",lt=V.LINES):(wt=J?"fillPattern":"fill",lt=V.TRIANGLES);let Zt=G.constantOr(null);for(let se of w){let Bt=c.getTile(se);if(J&&!Bt.patternsLoaded())continue;let Gt=Bt.getBucket(A);if(!Gt)continue;let he=Gt.programConfigurations.get(A.id),ce=M.useProgram(wt,he),xe=M.style.map.terrain&&M.style.map.terrain.getTerrainData(se);J&&(M.context.activeTexture.set(V.TEXTURE0),Bt.imageAtlasTexture.bind(V.LINEAR,V.CLAMP_TO_EDGE),he.updatePaintBuffers(tt)),cc(he,$,Zt,Bt,A);let Pe=xe?se:null,Te=M.translatePosMatrix(Pe?Pe.posMatrix:se.posMatrix,Bt,A.paint.get("fill-translate"),A.paint.get("fill-translate-anchor"));if(U){Rt=Gt.indexBuffer2,yt=Gt.segments2;let Le=[V.drawingBufferWidth,V.drawingBufferHeight];bt=wt==="fillOutlinePattern"&&J?ud(Te,M,tt,Bt,Le):cd(Te,Le)}else Rt=Gt.indexBuffer,yt=Gt.segments,bt=J?ld(Te,M,tt,Bt):ad(Te);ce.draw(M.context,lt,E,M.stencilModeForClipping(se),P,Jr.disabled,bt,xe,A.id,Gt.layoutVertexBuffer,Rt,yt,A.paint,M.transform.zoom,he)}}function Bh(M,c,A,w,E,P,U){let V=M.context,$=V.gl,G="fill-extrusion-pattern",J=A.paint.get(G),tt=J.constantOr(1),lt=A.getCrossfadeParameters(),wt=A.paint.get("fill-extrusion-opacity"),bt=J.constantOr(null);for(let Rt of w){let yt=c.getTile(Rt),Zt=yt.getBucket(A);if(!Zt)continue;let se=M.style.map.terrain&&M.style.map.terrain.getTerrainData(Rt),Bt=Zt.programConfigurations.get(A.id),Gt=M.useProgram(tt?"fillExtrusionPattern":"fillExtrusion",Bt);tt&&(M.context.activeTexture.set($.TEXTURE0),yt.imageAtlasTexture.bind($.LINEAR,$.CLAMP_TO_EDGE),Bt.updatePaintBuffers(lt)),cc(Bt,G,bt,yt,A);let he=M.translatePosMatrix(Rt.posMatrix,yt,A.paint.get("fill-extrusion-translate"),A.paint.get("fill-extrusion-translate-anchor")),ce=A.paint.get("fill-extrusion-vertical-gradient"),xe=tt?lc(he,M,ce,wt,Rt,lt,yt):Z0(he,M,ce,wt);Gt.draw(V,V.gl.TRIANGLES,E,P,U,Jr.backCCW,xe,se,A.id,Zt.layoutVertexBuffer,Zt.indexBuffer,Zt.segments,A.paint,M.transform.zoom,Bt,M.style.map.terrain&&Zt.centroidVertexBuffer)}}function Ub(M,c,A,w,E,P,U){let V=M.context,$=V.gl,G=A.fbo;if(!G)return;let J=M.useProgram("hillshade"),tt=M.style.map.terrain&&M.style.map.terrain.getTerrainData(c);V.activeTexture.set($.TEXTURE0),$.bindTexture($.TEXTURE_2D,G.colorAttachment.get()),J.draw(V,$.TRIANGLES,E,P,U,Jr.disabled,((lt,wt,bt,Rt)=>{let yt=bt.paint.get("hillshade-shadow-color"),Zt=bt.paint.get("hillshade-highlight-color"),se=bt.paint.get("hillshade-accent-color"),Bt=bt.paint.get("hillshade-illumination-direction")*(Math.PI/180);bt.paint.get("hillshade-illumination-anchor")==="viewport"&&(Bt-=lt.transform.angle);let Gt=!lt.options.moving;return{u_matrix:Rt?Rt.posMatrix:lt.transform.calculatePosMatrix(wt.tileID.toUnwrapped(),Gt),u_image:0,u_latrange:lr(0,wt.tileID),u_light:[bt.paint.get("hillshade-exaggeration"),Bt],u_shadow:yt,u_highlight:Zt,u_accent:se}})(M,A,w,tt?c:null),tt,w.id,M.rasterBoundsBuffer,M.quadTriangleIndexBuffer,M.rasterBoundsSegments)}function Gc(M,c,A,w,E,P){let U=M.context,V=U.gl,$=c.dem;if($&&$.data){let G=$.dim,J=$.stride,tt=$.getPixels();if(U.activeTexture.set(V.TEXTURE1),U.pixelStoreUnpackPremultiplyAlpha.set(!1),c.demTexture=c.demTexture||M.getTileTexture(J),c.demTexture){let wt=c.demTexture;wt.update(tt,{premultiply:!1}),wt.bind(V.NEAREST,V.CLAMP_TO_EDGE)}else c.demTexture=new _t(U,tt,V.RGBA,{premultiply:!1}),c.demTexture.bind(V.NEAREST,V.CLAMP_TO_EDGE);U.activeTexture.set(V.TEXTURE0);let lt=c.fbo;if(!lt){let wt=new _t(U,{width:G,height:G,data:null},V.RGBA);wt.bind(V.LINEAR,V.CLAMP_TO_EDGE),lt=c.fbo=U.createFramebuffer(G,G,!0,!1),lt.colorAttachment.set(wt.texture)}U.bindFramebuffer.set(lt.framebuffer),U.viewport.set([0,0,G,G]),M.useProgram("hillshadePrepare").draw(U,V.TRIANGLES,w,E,P,Jr.disabled,((wt,bt)=>{let Rt=bt.stride,yt=n.Z();return n.aS(yt,0,n.N,-n.N,0,0,1),n.$(yt,yt,[0,-n.N,0]),{u_matrix:yt,u_image:1,u_dimension:[Rt,Rt],u_zoom:wt.overscaledZ,u_unpack:bt.getUnpackVector()}})(c.tileID,$),null,A.id,M.rasterBoundsBuffer,M.quadTriangleIndexBuffer,M.rasterBoundsSegments),c.needsHillshadePrepare=!1}}function Ei(M,c,A,w,E,P){let U=w.paint.get("raster-fade-duration");if(!P&&U>0){let V=n.h.now(),$=(V-M.timeAdded)/U,G=c?(V-c.timeAdded)/U:-1,J=A.getSource(),tt=E.coveringZoomLevel({tileSize:J.tileSize,roundZoom:J.roundZoom}),lt=!c||Math.abs(c.tileID.overscaledZ-tt)>Math.abs(M.tileID.overscaledZ-tt),wt=lt&&M.refreshedUponExpiration?1:n.ad(lt?$:1-G,0,1);return M.refreshedUponExpiration&&$>=1&&(M.refreshedUponExpiration=!1),c?{opacity:1,mix:1-wt}:{opacity:wt,mix:0}}return{opacity:1,mix:0}}let St=new n.aT(1,0,0,1),Ur=new n.aT(0,1,0,1),em=new n.aT(0,0,1,1),ty=new n.aT(1,0,1,1),ey=new n.aT(0,1,1,1);function dd(M,c,A,w){pt(M,0,c+A/2,M.transform.width,A,w)}function rm(M,c,A,w){pt(M,c-A/2,0,A,M.transform.height,w)}function pt(M,c,A,w,E,P){let U=M.context,V=U.gl;V.enable(V.SCISSOR_TEST),V.scissor(c*M.pixelRatio,A*M.pixelRatio,w*M.pixelRatio,E*M.pixelRatio),U.clear({color:P}),V.disable(V.SCISSOR_TEST)}function ry(M,c,A){let w=M.context,E=w.gl,P=A.posMatrix,U=M.useProgram("debug"),V=Wr.disabled,$=Fr.disabled,G=M.colorModeForRenderPass(),J="$debug",tt=M.style.map.terrain&&M.style.map.terrain.getTerrainData(A);w.activeTexture.set(E.TEXTURE0);let lt=c.getTileByID(A.key).latestRawTileData,wt=Math.floor((lt&&lt.byteLength||0)/1024),bt=c.getTile(A).tileSize,Rt=512/Math.min(bt,512)*(A.overscaledZ/M.transform.zoom)*.5,yt=A.canonical.toString();A.overscaledZ!==A.canonical.z&&(yt+=` => ${A.overscaledZ}`),function(Zt,se){Zt.initDebugOverlayCanvas();let Bt=Zt.debugOverlayCanvas,Gt=Zt.context.gl,he=Zt.debugOverlayCanvas.getContext("2d");he.clearRect(0,0,Bt.width,Bt.height),he.shadowColor="white",he.shadowBlur=2,he.lineWidth=1.5,he.strokeStyle="white",he.textBaseline="top",he.font="bold 36px Open Sans, sans-serif",he.fillText(se,5,5),he.strokeText(se,5,5),Zt.debugOverlayTexture.update(Bt),Zt.debugOverlayTexture.bind(Gt.LINEAR,Gt.CLAMP_TO_EDGE)}(M,`${yt} ${wt}kB`),U.draw(w,E.TRIANGLES,V,$,ft.alphaBlended,Jr.disabled,Wt(P,n.aT.transparent,Rt),null,J,M.debugBuffer,M.quadTriangleIndexBuffer,M.debugSegments),U.draw(w,E.LINE_STRIP,V,$,G,Jr.disabled,Wt(P,n.aT.red),tt,J,M.debugBuffer,M.tileBorderIndexBuffer,M.debugSegments)}function fs(M,c,A){let w=M.context,E=w.gl,P=M.colorModeForRenderPass(),U=new Wr(E.LEQUAL,Wr.ReadWrite,M.depthRangeFor3D),V=M.useProgram("terrain"),$=c.getTerrainMesh();w.bindFramebuffer.set(null),w.viewport.set([0,0,M.width,M.height]);for(let G of A){let J=M.renderToTexture.getTexture(G),tt=c.getTerrainData(G.tileID);w.activeTexture.set(E.TEXTURE0),E.bindTexture(E.TEXTURE_2D,J.texture);let lt={u_matrix:M.transform.calculatePosMatrix(G.tileID.toUnwrapped()),u_texture:0,u_ele_delta:c.getMeshFrameDelta(M.transform.zoom)};V.draw(w,E.TRIANGLES,U,Fr.disabled,P,Jr.backCCW,lt,tt,"terrain",$.vertexBuffer,$.indexBuffer,$.segments)}}class Nh{constructor(c,A){this.context=new lo(c),this.transform=A,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:n.Z(),renderTime:0},this.setup(),this.numSublayers=Gn.maxUnderzooming+Gn.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Xc}resize(c,A,w){if(this.width=Math.floor(c*w),this.height=Math.floor(A*w),this.pixelRatio=w,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(let E of this.style._order)this.style._layers[E].resize()}setup(){let c=this.context,A=new n.a_;A.emplaceBack(0,0),A.emplaceBack(n.N,0),A.emplaceBack(0,n.N),A.emplaceBack(n.N,n.N),this.tileExtentBuffer=c.createVertexBuffer(A,Uo.members),this.tileExtentSegments=n.S.simpleSegment(0,0,4,2);let w=new n.a_;w.emplaceBack(0,0),w.emplaceBack(n.N,0),w.emplaceBack(0,n.N),w.emplaceBack(n.N,n.N),this.debugBuffer=c.createVertexBuffer(w,Uo.members),this.debugSegments=n.S.simpleSegment(0,0,4,5);let E=new n.V;E.emplaceBack(0,0,0,0),E.emplaceBack(n.N,0,n.N,0),E.emplaceBack(0,n.N,0,n.N),E.emplaceBack(n.N,n.N,n.N,n.N),this.rasterBoundsBuffer=c.createVertexBuffer(E,zr.members),this.rasterBoundsSegments=n.S.simpleSegment(0,0,4,2);let P=new n.a_;P.emplaceBack(0,0),P.emplaceBack(1,0),P.emplaceBack(0,1),P.emplaceBack(1,1),this.viewportBuffer=c.createVertexBuffer(P,Uo.members),this.viewportSegments=n.S.simpleSegment(0,0,4,2);let U=new n.a$;U.emplaceBack(0),U.emplaceBack(1),U.emplaceBack(3),U.emplaceBack(2),U.emplaceBack(0),this.tileBorderIndexBuffer=c.createIndexBuffer(U);let V=new n.b0;V.emplaceBack(0,1,2),V.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=c.createIndexBuffer(V);let $=this.context.gl;this.stencilClearMode=new Fr({func:$.ALWAYS,mask:0},0,255,$.ZERO,$.ZERO,$.ZERO)}clearStencil(){let c=this.context,A=c.gl;this.nextStencilID=1,this.currentStencilSource=void 0;let w=n.Z();n.aS(w,0,this.width,this.height,0,0,1),n.a0(w,w,[A.drawingBufferWidth,A.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(c,A.TRIANGLES,Wr.disabled,this.stencilClearMode,ft.disabled,Jr.disabled,pe(w),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(c,A){if(this.currentStencilSource===c.source||!c.isTileClipped()||!A||!A.length)return;this.currentStencilSource=c.source;let w=this.context,E=w.gl;this.nextStencilID+A.length>256&&this.clearStencil(),w.setColorMode(ft.disabled),w.setDepthMode(Wr.disabled);let P=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(let U of A){let V=this._tileClippingMaskIDs[U.key]=this.nextStencilID++,$=this.style.map.terrain&&this.style.map.terrain.getTerrainData(U);P.draw(w,E.TRIANGLES,Wr.disabled,new Fr({func:E.ALWAYS,mask:0},V,255,E.KEEP,E.KEEP,E.REPLACE),ft.disabled,Jr.disabled,pe(U.posMatrix),$,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();let c=this.nextStencilID++,A=this.context.gl;return new Fr({func:A.NOTEQUAL,mask:255},c,255,A.KEEP,A.KEEP,A.REPLACE)}stencilModeForClipping(c){let A=this.context.gl;return new Fr({func:A.EQUAL,mask:255},this._tileClippingMaskIDs[c.key],0,A.KEEP,A.KEEP,A.REPLACE)}stencilConfigForOverlap(c){let A=this.context.gl,w=c.sort((U,V)=>V.overscaledZ-U.overscaledZ),E=w[w.length-1].overscaledZ,P=w[0].overscaledZ-E+1;if(P>1){this.currentStencilSource=void 0,this.nextStencilID+P>256&&this.clearStencil();let U={};for(let V=0;V<P;V++)U[V+E]=new Fr({func:A.GEQUAL,mask:255},V+this.nextStencilID,255,A.KEEP,A.KEEP,A.REPLACE);return this.nextStencilID+=P,[U,w]}return[{[E]:Fr.disabled},w]}colorModeForRenderPass(){let c=this.context.gl;return this._showOverdrawInspector?new ft([c.CONSTANT_COLOR,c.ONE],new n.aT(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?ft.unblended:ft.alphaBlended}depthModeForSublayer(c,A,w){if(!this.opaquePassEnabledForLayer())return Wr.disabled;let E=1-((1+this.currentLayer)*this.numSublayers+c)*this.depthEpsilon;return new Wr(w||this.context.gl.LEQUAL,A,[E,E])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(c,A){this.style=c,this.options=A,this.lineAtlas=c.lineAtlas,this.imageManager=c.imageManager,this.glyphManager=c.glyphManager,this.symbolFadeChange=c.placement.symbolFadeChange(n.h.now()),this.imageManager.beginFrame();let w=this.style._order,E=this.style.sourceCaches,P={},U={},V={};for(let $ in E){let G=E[$];G.used&&G.prepare(this.context),P[$]=G.getVisibleCoordinates(),U[$]=P[$].slice().reverse(),V[$]=G.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let $=0;$<w.length;$++)if(this.style._layers[w[$]].is3D()){this.opaquePassCutoff=$;break}if(this.renderToTexture){this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0;let $=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!n.b1(this.terrainFacilitator.matrix,this.transform.projMatrix)||$.length)&&(n.b2(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(G,J){let tt=G.context,lt=tt.gl,wt=ft.unblended,bt=new Wr(lt.LEQUAL,Wr.ReadWrite,[0,1]),Rt=J.getTerrainMesh(),yt=J.sourceCache.getRenderableTiles(),Zt=G.useProgram("terrainDepth");tt.bindFramebuffer.set(J.getFramebuffer("depth").framebuffer),tt.viewport.set([0,0,G.width/devicePixelRatio,G.height/devicePixelRatio]),tt.clear({color:n.aT.transparent,depth:1});for(let se of yt){let Bt=J.getTerrainData(se.tileID),Gt={u_matrix:G.transform.calculatePosMatrix(se.tileID.toUnwrapped()),u_ele_delta:J.getMeshFrameDelta(G.transform.zoom)};Zt.draw(tt,lt.TRIANGLES,bt,Fr.disabled,wt,Jr.backCCW,Gt,Bt,"terrain",Rt.vertexBuffer,Rt.indexBuffer,Rt.segments)}tt.bindFramebuffer.set(null),tt.viewport.set([0,0,G.width,G.height])}(this,this.style.map.terrain),function(G,J){let tt=G.context,lt=tt.gl,wt=ft.unblended,bt=new Wr(lt.LEQUAL,Wr.ReadWrite,[0,1]),Rt=J.getTerrainMesh(),yt=J.getCoordsTexture(),Zt=J.sourceCache.getRenderableTiles(),se=G.useProgram("terrainCoords");tt.bindFramebuffer.set(J.getFramebuffer("coords").framebuffer),tt.viewport.set([0,0,G.width/devicePixelRatio,G.height/devicePixelRatio]),tt.clear({color:n.aT.transparent,depth:1}),J.coordsIndex=[];for(let Bt of Zt){let Gt=J.getTerrainData(Bt.tileID);tt.activeTexture.set(lt.TEXTURE0),lt.bindTexture(lt.TEXTURE_2D,yt.texture);let he={u_matrix:G.transform.calculatePosMatrix(Bt.tileID.toUnwrapped()),u_terrain_coords_id:(255-J.coordsIndex.length)/255,u_texture:0,u_ele_delta:J.getMeshFrameDelta(G.transform.zoom)};se.draw(tt,lt.TRIANGLES,bt,Fr.disabled,wt,Jr.backCCW,he,Gt,"terrain",Rt.vertexBuffer,Rt.indexBuffer,Rt.segments),J.coordsIndex.push(Bt.tileID.key)}tt.bindFramebuffer.set(null),tt.viewport.set([0,0,G.width,G.height])}(this,this.style.map.terrain))}this.renderPass="offscreen";for(let $ of w){let G=this.style._layers[$];if(!G.hasOffscreenPass()||G.isHidden(this.transform.zoom))continue;let J=U[G.source];(G.type==="custom"||J.length)&&this.renderLayer(this,E[G.source],G,J)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:A.showOverdrawInspector?n.aT.black:n.aT.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=A.showOverdrawInspector,this.depthRangeFor3D=[0,1-(c._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=w.length-1;this.currentLayer>=0;this.currentLayer--){let $=this.style._layers[w[this.currentLayer]],G=E[$.source],J=P[$.source];this._renderTileClippingMasks($,J),this.renderLayer(this,G,$,J)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<w.length;this.currentLayer++){let $=this.style._layers[w[this.currentLayer]],G=E[$.source];if(this.renderToTexture&&this.renderToTexture.renderLayer($))continue;let J=($.type==="symbol"?V:U)[$.source];this._renderTileClippingMasks($,P[$.source]),this.renderLayer(this,G,$,J)}if(this.options.showTileBoundaries){let $=function(G,J){let tt=null,lt=Object.values(G._layers).flatMap(yt=>yt.source&&!yt.isHidden(J)?[G.sourceCaches[yt.source]]:[]),wt=lt.filter(yt=>yt.getSource().type==="vector"),bt=lt.filter(yt=>yt.getSource().type!=="vector"),Rt=yt=>{(!tt||tt.getSource().maxzoom<yt.getSource().maxzoom)&&(tt=yt)};return wt.forEach(yt=>Rt(yt)),tt||bt.forEach(yt=>Rt(yt)),tt}(this.style,this.transform.zoom);$&&function(G,J,tt){for(let lt=0;lt<tt.length;lt++)ry(G,J,tt[lt])}(this,$,$.getVisibleCoordinates())}this.options.showPadding&&function($){let G=$.transform.padding;dd($,$.transform.height-(G.top||0),3,St),dd($,G.bottom||0,3,Ur),rm($,G.left||0,3,em),rm($,$.transform.width-(G.right||0),3,ty);let J=$.transform.centerPoint;(function(tt,lt,wt,bt){pt(tt,lt-1,wt-10,2,20,bt),pt(tt,lt-10,wt-1,20,2,bt)})($,J.x,$.transform.height-J.y,ey)}(this),this.context.setDefault()}renderLayer(c,A,w,E){if(!w.isHidden(this.transform.zoom)&&(w.type==="background"||w.type==="custom"||(E||[]).length))switch(this.id=w.id,w.type){case"symbol":(function(P,U,V,$,G){if(P.renderPass!=="translucent")return;let J=Fr.disabled,tt=P.colorModeForRenderPass();(V._unevaluatedLayout.hasValue("text-variable-anchor")||V._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(lt,wt,bt,Rt,yt,Zt,se){let Bt=wt.transform,Gt=yt==="map",he=Zt==="map";for(let ce of lt){let xe=Rt.getTile(ce),Pe=xe.getBucket(bt);if(!Pe||!Pe.text||!Pe.text.segments.get().length)continue;let Te=n.ah(Pe.textSizeData,Bt.zoom),Le=Yt(xe,1,wt.transform.zoom),hr=Ne(ce.posMatrix,he,Gt,wt.transform,Le),Di=bt.layout.get("icon-text-fit")!=="none"&&Pe.hasIconData();if(Te){let He=Math.pow(2,Bt.zoom-xe.tileID.overscaledZ);tm(Pe,Gt,he,se,Bt,hr,ce.posMatrix,He,Te,Di,wt.style.map.terrain?(Cr,fr)=>wt.style.map.terrain.getElevation(ce,Cr,fr):null)}}}($,P,V,U,V.layout.get("text-rotation-alignment"),V.layout.get("text-pitch-alignment"),G),V.paint.get("icon-opacity").constantOr(1)!==0&&Bf(P,U,V,$,!1,V.paint.get("icon-translate"),V.paint.get("icon-translate-anchor"),V.layout.get("icon-rotation-alignment"),V.layout.get("icon-pitch-alignment"),V.layout.get("icon-keep-upright"),J,tt),V.paint.get("text-opacity").constantOr(1)!==0&&Bf(P,U,V,$,!0,V.paint.get("text-translate"),V.paint.get("text-translate-anchor"),V.layout.get("text-rotation-alignment"),V.layout.get("text-pitch-alignment"),V.layout.get("text-keep-upright"),J,tt),U.map.showCollisionBoxes&&(cn(P,U,V,$,V.paint.get("text-translate"),V.paint.get("text-translate-anchor"),!0),cn(P,U,V,$,V.paint.get("icon-translate"),V.paint.get("icon-translate-anchor"),!1))})(c,A,w,E,this.style.placement.variableOffsets);break;case"circle":(function(P,U,V,$){if(P.renderPass!=="translucent")return;let G=V.paint.get("circle-opacity"),J=V.paint.get("circle-stroke-width"),tt=V.paint.get("circle-stroke-opacity"),lt=!V.layout.get("circle-sort-key").isConstant();if(G.constantOr(1)===0&&(J.constantOr(1)===0||tt.constantOr(1)===0))return;let wt=P.context,bt=wt.gl,Rt=P.depthModeForSublayer(0,Wr.ReadOnly),yt=Fr.disabled,Zt=P.colorModeForRenderPass(),se=[];for(let Bt=0;Bt<$.length;Bt++){let Gt=$[Bt],he=U.getTile(Gt),ce=he.getBucket(V);if(!ce)continue;let xe=ce.programConfigurations.get(V.id),Pe=P.useProgram("circle",xe),Te=ce.layoutVertexBuffer,Le=ce.indexBuffer,hr=P.style.map.terrain&&P.style.map.terrain.getTerrainData(Gt),Di={programConfiguration:xe,program:Pe,layoutVertexBuffer:Te,indexBuffer:Le,uniformValues:ut(P,Gt,he,V),terrainData:hr};if(lt){let He=ce.segments.get();for(let Cr of He)se.push({segments:new n.S([Cr]),sortKey:Cr.sortKey,state:Di})}else se.push({segments:ce.segments,sortKey:0,state:Di})}lt&&se.sort((Bt,Gt)=>Bt.sortKey-Gt.sortKey);for(let Bt of se){let{programConfiguration:Gt,program:he,layoutVertexBuffer:ce,indexBuffer:xe,uniformValues:Pe,terrainData:Te}=Bt.state;he.draw(wt,bt.TRIANGLES,Rt,yt,Zt,Jr.disabled,Pe,Te,V.id,ce,xe,Bt.segments,V.paint,P.transform.zoom,Gt)}})(c,A,w,E);break;case"heatmap":(function(P,U,V,$){if(V.paint.get("heatmap-opacity")!==0)if(P.renderPass==="offscreen"){let G=P.context,J=G.gl,tt=Fr.disabled,lt=new ft([J.ONE,J.ONE],n.aT.transparent,[!0,!0,!0,!0]);(function(wt,bt,Rt){let yt=wt.gl;wt.activeTexture.set(yt.TEXTURE1),wt.viewport.set([0,0,bt.width/4,bt.height/4]);let Zt=Rt.heatmapFbo;if(Zt)yt.bindTexture(yt.TEXTURE_2D,Zt.colorAttachment.get()),wt.bindFramebuffer.set(Zt.framebuffer);else{let se=yt.createTexture();yt.bindTexture(yt.TEXTURE_2D,se),yt.texParameteri(yt.TEXTURE_2D,yt.TEXTURE_WRAP_S,yt.CLAMP_TO_EDGE),yt.texParameteri(yt.TEXTURE_2D,yt.TEXTURE_WRAP_T,yt.CLAMP_TO_EDGE),yt.texParameteri(yt.TEXTURE_2D,yt.TEXTURE_MIN_FILTER,yt.LINEAR),yt.texParameteri(yt.TEXTURE_2D,yt.TEXTURE_MAG_FILTER,yt.LINEAR),Zt=Rt.heatmapFbo=wt.createFramebuffer(bt.width/4,bt.height/4,!1,!1),function(Bt,Gt,he,ce){var xe,Pe;let Te=Bt.gl,Le=(xe=Bt.HALF_FLOAT)!==null&&xe!==void 0?xe:Te.UNSIGNED_BYTE,hr=(Pe=Bt.RGBA16F)!==null&&Pe!==void 0?Pe:Te.RGBA;Te.texImage2D(Te.TEXTURE_2D,0,hr,Gt.width/4,Gt.height/4,0,Te.RGBA,Le,null),ce.colorAttachment.set(he)}(wt,bt,se,Zt)}})(G,P,V),G.clear({color:n.aT.transparent});for(let wt=0;wt<$.length;wt++){let bt=$[wt];if(U.hasRenderableParent(bt))continue;let Rt=U.getTile(bt),yt=Rt.getBucket(V);if(!yt)continue;let Zt=yt.programConfigurations.get(V.id),se=P.useProgram("heatmap",Zt),{zoom:Bt}=P.transform;se.draw(G,J.TRIANGLES,Wr.disabled,tt,lt,Jr.disabled,Be(bt.posMatrix,Rt,Bt,V.paint.get("heatmap-intensity")),null,V.id,yt.layoutVertexBuffer,yt.indexBuffer,yt.segments,V.paint,P.transform.zoom,Zt)}G.viewport.set([0,0,P.width,P.height])}else P.renderPass==="translucent"&&(P.context.setColorMode(P.colorModeForRenderPass()),function(G,J){let tt=G.context,lt=tt.gl,wt=J.heatmapFbo;if(!wt)return;tt.activeTexture.set(lt.TEXTURE0),lt.bindTexture(lt.TEXTURE_2D,wt.colorAttachment.get()),tt.activeTexture.set(lt.TEXTURE1);let bt=J.colorRampTexture;bt||(bt=J.colorRampTexture=new _t(tt,J.colorRamp,lt.RGBA)),bt.bind(lt.LINEAR,lt.CLAMP_TO_EDGE),G.useProgram("heatmapTexture").draw(tt,lt.TRIANGLES,Wr.disabled,Fr.disabled,G.colorModeForRenderPass(),Jr.disabled,((Rt,yt,Zt,se)=>{let Bt=n.Z();n.aS(Bt,0,Rt.width,Rt.height,0,0,1);let Gt=Rt.context.gl;return{u_matrix:Bt,u_world:[Gt.drawingBufferWidth,Gt.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:yt.paint.get("heatmap-opacity")}})(G,J),null,J.id,G.viewportBuffer,G.quadTriangleIndexBuffer,G.viewportSegments,J.paint,G.transform.zoom)}(P,V))})(c,A,w,E);break;case"line":(function(P,U,V,$){if(P.renderPass!=="translucent")return;let G=V.paint.get("line-opacity"),J=V.paint.get("line-width");if(G.constantOr(1)===0||J.constantOr(1)===0)return;let tt=P.depthModeForSublayer(0,Wr.ReadOnly),lt=P.colorModeForRenderPass(),wt=V.paint.get("line-dasharray"),bt=V.paint.get("line-pattern"),Rt=bt.constantOr(1),yt=V.paint.get("line-gradient"),Zt=V.getCrossfadeParameters(),se=Rt?"linePattern":wt?"lineSDF":yt?"lineGradient":"line",Bt=P.context,Gt=Bt.gl,he=!0;for(let ce of $){let xe=U.getTile(ce);if(Rt&&!xe.patternsLoaded())continue;let Pe=xe.getBucket(V);if(!Pe)continue;let Te=Pe.programConfigurations.get(V.id),Le=P.context.program.get(),hr=P.useProgram(se,Te),Di=he||hr.program!==Le,He=P.style.map.terrain&&P.style.map.terrain.getTerrainData(ce),Cr=bt.constantOr(null);if(Cr&&xe.imageAtlas){let Ci=xe.imageAtlas,fi=Ci.patternPositions[Cr.to.toString()],Oi=Ci.patternPositions[Cr.from.toString()];fi&&Oi&&Te.setConstantPatternPositions(fi,Oi)}let fr=He?ce:null,dn=Rt?ao(P,xe,V,Zt,fr):wt?bo(P,xe,V,wt,Zt,fr):yt?Us(P,xe,V,Pe.lineClipsArray.length,fr):ki(P,xe,V,fr);if(Rt)Bt.activeTexture.set(Gt.TEXTURE0),xe.imageAtlasTexture.bind(Gt.LINEAR,Gt.CLAMP_TO_EDGE),Te.updatePaintBuffers(Zt);else if(wt&&(Di||P.lineAtlas.dirty))Bt.activeTexture.set(Gt.TEXTURE0),P.lineAtlas.bind(Bt);else if(yt){let Ci=Pe.gradients[V.id],fi=Ci.texture;if(V.gradientVersion!==Ci.version){let Oi=256;if(V.stepInterpolant){let Ts=U.getSource().maxzoom,Un=ce.canonical.z===Ts?Math.ceil(1<<P.transform.maxZoom-ce.canonical.z):1;Oi=n.ad(n.aY(Pe.maxLineLength/n.N*1024*Un),256,Bt.maxTextureSize)}Ci.gradient=n.aZ({expression:V.gradientExpression(),evaluationKey:"lineProgress",resolution:Oi,image:Ci.gradient||void 0,clips:Pe.lineClipsArray}),Ci.texture?Ci.texture.update(Ci.gradient):Ci.texture=new _t(Bt,Ci.gradient,Gt.RGBA),Ci.version=V.gradientVersion,fi=Ci.texture}Bt.activeTexture.set(Gt.TEXTURE0),fi.bind(V.stepInterpolant?Gt.NEAREST:Gt.LINEAR,Gt.CLAMP_TO_EDGE)}hr.draw(Bt,Gt.TRIANGLES,tt,P.stencilModeForClipping(ce),lt,Jr.disabled,dn,He,V.id,Pe.layoutVertexBuffer,Pe.indexBuffer,Pe.segments,V.paint,P.transform.zoom,Te,Pe.layoutVertexBuffer2),he=!1}})(c,A,w,E);break;case"fill":(function(P,U,V,$){let G=V.paint.get("fill-color"),J=V.paint.get("fill-opacity");if(J.constantOr(1)===0)return;let tt=P.colorModeForRenderPass(),lt=V.paint.get("fill-pattern"),wt=P.opaquePassEnabledForLayer()&&!lt.constantOr(1)&&G.constantOr(n.aT.transparent).a===1&&J.constantOr(0)===1?"opaque":"translucent";if(P.renderPass===wt){let bt=P.depthModeForSublayer(1,P.renderPass==="opaque"?Wr.ReadWrite:Wr.ReadOnly);ha(P,U,V,$,bt,tt,!1)}if(P.renderPass==="translucent"&&V.paint.get("fill-antialias")){let bt=P.depthModeForSublayer(V.getPaintProperty("fill-outline-color")?2:0,Wr.ReadOnly);ha(P,U,V,$,bt,tt,!0)}})(c,A,w,E);break;case"fill-extrusion":(function(P,U,V,$){let G=V.paint.get("fill-extrusion-opacity");if(G!==0&&P.renderPass==="translucent"){let J=new Wr(P.context.gl.LEQUAL,Wr.ReadWrite,P.depthRangeFor3D);if(G!==1||V.paint.get("fill-extrusion-pattern").constantOr(1))Bh(P,U,V,$,J,Fr.disabled,ft.disabled),Bh(P,U,V,$,J,P.stencilModeFor3D(),P.colorModeForRenderPass());else{let tt=P.colorModeForRenderPass();Bh(P,U,V,$,J,Fr.disabled,tt)}}})(c,A,w,E);break;case"hillshade":(function(P,U,V,$){if(P.renderPass!=="offscreen"&&P.renderPass!=="translucent")return;let G=P.context,J=P.depthModeForSublayer(0,Wr.ReadOnly),tt=P.colorModeForRenderPass(),[lt,wt]=P.renderPass==="translucent"?P.stencilConfigForOverlap($):[{},$];for(let bt of wt){let Rt=U.getTile(bt);Rt.needsHillshadePrepare!==void 0&&Rt.needsHillshadePrepare&&P.renderPass==="offscreen"?Gc(P,Rt,V,J,Fr.disabled,tt):P.renderPass==="translucent"&&Ub(P,bt,Rt,V,J,lt[bt.overscaledZ],tt)}G.viewport.set([0,0,P.width,P.height])})(c,A,w,E);break;case"raster":(function(P,U,V,$){if(P.renderPass!=="translucent"||V.paint.get("raster-opacity")===0||!$.length)return;let G=P.context,J=G.gl,tt=U.getSource(),lt=P.useProgram("raster"),wt=P.colorModeForRenderPass(),[bt,Rt]=tt instanceof Br?[{},$]:P.stencilConfigForOverlap($),yt=Rt[Rt.length-1].overscaledZ,Zt=!P.options.moving;for(let se of Rt){let Bt=P.depthModeForSublayer(se.overscaledZ-yt,V.paint.get("raster-opacity")===1?Wr.ReadWrite:Wr.ReadOnly,J.LESS),Gt=U.getTile(se);Gt.registerFadeDuration(V.paint.get("raster-fade-duration"));let he=U.findLoadedParent(se,0),ce=Ei(Gt,he,U,V,P.transform,P.style.map.terrain),xe,Pe,Te=V.paint.get("raster-resampling")==="nearest"?J.NEAREST:J.LINEAR;G.activeTexture.set(J.TEXTURE0),Gt.texture.bind(Te,J.CLAMP_TO_EDGE,J.LINEAR_MIPMAP_NEAREST),G.activeTexture.set(J.TEXTURE1),he?(he.texture.bind(Te,J.CLAMP_TO_EDGE,J.LINEAR_MIPMAP_NEAREST),xe=Math.pow(2,he.tileID.overscaledZ-Gt.tileID.overscaledZ),Pe=[Gt.tileID.canonical.x*xe%1,Gt.tileID.canonical.y*xe%1]):Gt.texture.bind(Te,J.CLAMP_TO_EDGE,J.LINEAR_MIPMAP_NEAREST);let Le=P.style.map.terrain&&P.style.map.terrain.getTerrainData(se),hr=Le?se:null,Di=hr?hr.posMatrix:P.transform.calculatePosMatrix(se.toUnwrapped(),Zt),He=Bb(Di,Pe||[0,0],xe||1,ce,V);tt instanceof Br?lt.draw(G,J.TRIANGLES,Bt,Fr.disabled,wt,Jr.disabled,He,Le,V.id,tt.boundsBuffer,P.quadTriangleIndexBuffer,tt.boundsSegments):lt.draw(G,J.TRIANGLES,Bt,bt[se.overscaledZ],wt,Jr.disabled,He,Le,V.id,P.rasterBoundsBuffer,P.quadTriangleIndexBuffer,P.rasterBoundsSegments)}})(c,A,w,E);break;case"background":(function(P,U,V,$){let G=V.paint.get("background-color"),J=V.paint.get("background-opacity");if(J===0)return;let tt=P.context,lt=tt.gl,wt=P.transform,bt=wt.tileSize,Rt=V.paint.get("background-pattern");if(P.isPatternMissing(Rt))return;let yt=!Rt&&G.a===1&&J===1&&P.opaquePassEnabledForLayer()?"opaque":"translucent";if(P.renderPass!==yt)return;let Zt=Fr.disabled,se=P.depthModeForSublayer(0,yt==="opaque"?Wr.ReadWrite:Wr.ReadOnly),Bt=P.colorModeForRenderPass(),Gt=P.useProgram(Rt?"backgroundPattern":"background"),he=$||wt.coveringTiles({tileSize:bt,terrain:P.style.map.terrain});Rt&&(tt.activeTexture.set(lt.TEXTURE0),P.imageManager.bind(P.context));let ce=V.getCrossfadeParameters();for(let xe of he){let Pe=$?xe.posMatrix:P.transform.calculatePosMatrix(xe.toUnwrapped()),Te=Rt?Dl(Pe,J,P,Rt,{tileID:xe,tileSize:bt},ce):XA(Pe,J,G),Le=P.style.map.terrain&&P.style.map.terrain.getTerrainData(xe);Gt.draw(tt,lt.TRIANGLES,se,Zt,Bt,Jr.disabled,Te,Le,V.id,P.tileExtentBuffer,P.quadTriangleIndexBuffer,P.tileExtentSegments)}})(c,0,w,E);break;case"custom":(function(P,U,V){let $=P.context,G=V.implementation;if(P.renderPass==="offscreen"){let J=G.prerender;J&&(P.setCustomLayerDefaults(),$.setColorMode(P.colorModeForRenderPass()),J.call(G,$.gl,P.transform.customLayerMatrix()),$.setDirty(),P.setBaseState())}else if(P.renderPass==="translucent"){P.setCustomLayerDefaults(),$.setColorMode(P.colorModeForRenderPass()),$.setStencilMode(Fr.disabled);let J=G.renderingMode==="3d"?new Wr(P.context.gl.LEQUAL,Wr.ReadWrite,P.depthRangeFor3D):P.depthModeForSublayer(0,Wr.ReadOnly);$.setDepthMode(J),G.render($.gl,P.transform.customLayerMatrix()),$.setDirty(),P.setBaseState(),$.bindFramebuffer.set(null)}})(c,0,w)}}translatePosMatrix(c,A,w,E,P){if(!w[0]&&!w[1])return c;let U=P?E==="map"?this.transform.angle:0:E==="viewport"?-this.transform.angle:0;if(U){let G=Math.sin(U),J=Math.cos(U);w=[w[0]*J-w[1]*G,w[0]*G+w[1]*J]}let V=[P?w[0]:Yt(A,w[0],this.transform.zoom),P?w[1]:Yt(A,w[1],this.transform.zoom),0],$=new Float32Array(16);return n.$($,c,V),$}saveTileTexture(c){let A=this._tileTextures[c.size[0]];A?A.push(c):this._tileTextures[c.size[0]]=[c]}getTileTexture(c){let A=this._tileTextures[c];return A&&A.length>0?A.pop():null}isPatternMissing(c){if(!c)return!1;if(!c.from||!c.to)return!0;let A=this.imageManager.getPattern(c.from.toString()),w=this.imageManager.getPattern(c.to.toString());return!A||!w}useProgram(c,A){this.cache=this.cache||{};let w=c+(A?A.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[w]||(this.cache[w]=new Ru(this.context,zn[c],A,ZA[c],this._showOverdrawInspector,this.style.map.terrain)),this.cache[w]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){let c=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(c.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new _t(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){let{drawingBufferWidth:c,drawingBufferHeight:A}=this.context.gl;return this.width!==c||this.height!==A}}class fa{constructor(c,A){this.points=c,this.planes=A}static fromInvProjectionMatrix(c,A,w){let E=Math.pow(2,w),P=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(V=>{let $=1/(V=n.ag([],V,c))[3]/A*E;return n.b3(V,V,[$,$,1/V[3],$])}),U=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(V=>{let $=function(lt,wt){var bt=wt[0],Rt=wt[1],yt=wt[2],Zt=bt*bt+Rt*Rt+yt*yt;return Zt>0&&(Zt=1/Math.sqrt(Zt)),lt[0]=wt[0]*Zt,lt[1]=wt[1]*Zt,lt[2]=wt[2]*Zt,lt}([],function(lt,wt,bt){var Rt=wt[0],yt=wt[1],Zt=wt[2],se=bt[0],Bt=bt[1],Gt=bt[2];return lt[0]=yt*Gt-Zt*Bt,lt[1]=Zt*se-Rt*Gt,lt[2]=Rt*Bt-yt*se,lt}([],q([],P[V[0]],P[V[1]]),q([],P[V[2]],P[V[1]]))),G=-((J=$)[0]*(tt=P[V[1]])[0]+J[1]*tt[1]+J[2]*tt[2]);var J,tt;return $.concat(G)});return new fa(P,U)}}class Nf{constructor(c,A){this.min=c,this.max=A,this.center=function(w,E,P){return w[0]=.5*E[0],w[1]=.5*E[1],w[2]=.5*E[2],w}([],function(w,E,P){return w[0]=E[0]+P[0],w[1]=E[1]+P[1],w[2]=E[2]+P[2],w}([],this.min,this.max))}quadrant(c){let A=[c%2==0,c<2],w=Z(this.min),E=Z(this.max);for(let P=0;P<A.length;P++)w[P]=A[P]?this.min[P]:this.center[P],E[P]=A[P]?this.center[P]:this.max[P];return E[2]=this.max[2],new Nf(w,E)}distanceX(c){return Math.max(Math.min(this.max[0],c[0]),this.min[0])-c[0]}distanceY(c){return Math.max(Math.min(this.max[1],c[1]),this.min[1])-c[1]}intersects(c){let A=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]],w=!0;for(let E=0;E<c.planes.length;E++){let P=c.planes[E],U=0;for(let V=0;V<A.length;V++)n.b4(P,A[V])>=0&&U++;if(U===0)return 0;U!==A.length&&(w=!1)}if(w)return 2;for(let E=0;E<3;E++){let P=Number.MAX_VALUE,U=-Number.MAX_VALUE;for(let V=0;V<c.points.length;V++){let $=c.points[V][E]-this.min[E];P=Math.min(P,$),U=Math.max(U,$)}if(U<0||P>this.max[E]-this.min[E])return 0}return 1}}class md{constructor(c=0,A=0,w=0,E=0){if(isNaN(c)||c<0||isNaN(A)||A<0||isNaN(w)||w<0||isNaN(E)||E<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=c,this.bottom=A,this.left=w,this.right=E}interpolate(c,A,w){return A.top!=null&&c.top!=null&&(this.top=n.B.number(c.top,A.top,w)),A.bottom!=null&&c.bottom!=null&&(this.bottom=n.B.number(c.bottom,A.bottom,w)),A.left!=null&&c.left!=null&&(this.left=n.B.number(c.left,A.left,w)),A.right!=null&&c.right!=null&&(this.right=n.B.number(c.right,A.right,w)),this}getCenter(c,A){let w=n.ad((this.left+c-this.right)/2,0,c),E=n.ad((this.top+A-this.bottom)/2,0,A);return new n.P(w,E)}equals(c){return this.top===c.top&&this.bottom===c.bottom&&this.left===c.left&&this.right===c.right}clone(){return new md(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class Ad{constructor(c,A,w,E,P){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=P===void 0||!!P,this._minZoom=c||0,this._maxZoom=A||22,this._minPitch=w??0,this._maxPitch=E??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new n.L(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new md,this._posMatrixCache={},this._alignedPosMatrixCache={},this._minEleveationForCurrentTile=0}clone(){let c=new Ad(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return c.apply(this),c}apply(c){this.tileSize=c.tileSize,this.latRange=c.latRange,this.width=c.width,this.height=c.height,this._center=c._center,this._elevation=c._elevation,this._minEleveationForCurrentTile=c._minEleveationForCurrentTile,this.zoom=c.zoom,this.angle=c.angle,this._fov=c._fov,this._pitch=c._pitch,this._unmodified=c._unmodified,this._edgeInsets=c._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(c){this._minZoom!==c&&(this._minZoom=c,this.zoom=Math.max(this.zoom,c))}get maxZoom(){return this._maxZoom}set maxZoom(c){this._maxZoom!==c&&(this._maxZoom=c,this.zoom=Math.min(this.zoom,c))}get minPitch(){return this._minPitch}set minPitch(c){this._minPitch!==c&&(this._minPitch=c,this.pitch=Math.max(this.pitch,c))}get maxPitch(){return this._maxPitch}set maxPitch(c){this._maxPitch!==c&&(this._maxPitch=c,this.pitch=Math.min(this.pitch,c))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(c){c===void 0?c=!0:c===null&&(c=!1),this._renderWorldCopies=c}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new n.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(c){let A=-n.b5(c,-180,180)*Math.PI/180;this.angle!==A&&(this._unmodified=!1,this.angle=A,this._calcMatrices(),this.rotationMatrix=function(){var w=new n.A(4);return n.A!=Float32Array&&(w[1]=0,w[2]=0),w[0]=1,w[3]=1,w}(),function(w,E,P){var U=E[0],V=E[1],$=E[2],G=E[3],J=Math.sin(P),tt=Math.cos(P);w[0]=U*tt+$*J,w[1]=V*tt+G*J,w[2]=U*-J+$*tt,w[3]=V*-J+G*tt}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(c){let A=n.ad(c,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==A&&(this._unmodified=!1,this._pitch=A,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(c){c=Math.max(.01,Math.min(60,c)),this._fov!==c&&(this._unmodified=!1,this._fov=c/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(c){let A=Math.min(Math.max(c,this.minZoom),this.maxZoom);this._zoom!==A&&(this._unmodified=!1,this._zoom=A,this.tileZoom=Math.max(0,Math.floor(A)),this.scale=this.zoomScale(A),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(c){c.lat===this._center.lat&&c.lng===this._center.lng||(this._unmodified=!1,this._center=c,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(c){c!==this._elevation&&(this._elevation=c,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(c){this._edgeInsets.equals(c)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,c,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(c){return this._edgeInsets.equals(c)}interpolatePadding(c,A,w){this._unmodified=!1,this._edgeInsets.interpolate(c,A,w),this._constrain(),this._calcMatrices()}coveringZoomLevel(c){let A=(c.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/c.tileSize));return Math.max(0,A)}getVisibleUnwrappedCoordinates(c){let A=[new n.b6(0,c)];if(this._renderWorldCopies){let w=this.pointCoordinate(new n.P(0,0)),E=this.pointCoordinate(new n.P(this.width,0)),P=this.pointCoordinate(new n.P(this.width,this.height)),U=this.pointCoordinate(new n.P(0,this.height)),V=Math.floor(Math.min(w.x,E.x,P.x,U.x)),$=Math.floor(Math.max(w.x,E.x,P.x,U.x)),G=1;for(let J=V-G;J<=$+G;J++)J!==0&&A.push(new n.b6(J,c))}return A}coveringTiles(c){var A,w;let E=this.coveringZoomLevel(c),P=E;if(c.minzoom!==void 0&&E<c.minzoom)return[];c.maxzoom!==void 0&&E>c.maxzoom&&(E=c.maxzoom);let U=this.pointCoordinate(this.getCameraPoint()),V=n.U.fromLngLat(this.center),$=Math.pow(2,E),G=[$*U.x,$*U.y,0],J=[$*V.x,$*V.y,0],tt=fa.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,E),lt=c.minzoom||0;!c.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(lt=E);let wt=c.terrain?2/Math.min(this.tileSize,c.tileSize)*this.tileSize:3,bt=Bt=>({aabb:new Nf([Bt*$,0,0],[(Bt+1)*$,$,0]),zoom:0,x:0,y:0,wrap:Bt,fullyVisible:!1}),Rt=[],yt=[],Zt=E,se=c.reparseOverscaled?P:E;if(this._renderWorldCopies)for(let Bt=1;Bt<=3;Bt++)Rt.push(bt(-Bt)),Rt.push(bt(Bt));for(Rt.push(bt(0));Rt.length>0;){let Bt=Rt.pop(),Gt=Bt.x,he=Bt.y,ce=Bt.fullyVisible;if(!ce){let hr=Bt.aabb.intersects(tt);if(hr===0)continue;ce=hr===2}let xe=c.terrain?G:J,Pe=Bt.aabb.distanceX(xe),Te=Bt.aabb.distanceY(xe),Le=Math.max(Math.abs(Pe),Math.abs(Te));if(Bt.zoom===Zt||Le>wt+(1<<Zt-Bt.zoom)-2&&Bt.zoom>=lt){let hr=Zt-Bt.zoom,Di=G[0]-.5-(Gt<<hr),He=G[1]-.5-(he<<hr);yt.push({tileID:new n.O(Bt.zoom===Zt?se:Bt.zoom,Bt.wrap,Bt.zoom,Gt,he),distanceSq:it([J[0]-.5-Gt,J[1]-.5-he]),tileDistanceToCamera:Math.sqrt(Di*Di+He*He)})}else for(let hr=0;hr<4;hr++){let Di=(Gt<<1)+hr%2,He=(he<<1)+(hr>>1),Cr=Bt.zoom+1,fr=Bt.aabb.quadrant(hr);if(c.terrain){let dn=new n.O(Cr,Bt.wrap,Cr,Di,He),Ci=c.terrain.getMinMaxElevation(dn),fi=(A=Ci.minElevation)!==null&&A!==void 0?A:this.elevation,Oi=(w=Ci.maxElevation)!==null&&w!==void 0?w:this.elevation;fr=new Nf([fr.min[0],fr.min[1],fi],[fr.max[0],fr.max[1],Oi])}Rt.push({aabb:fr,zoom:Cr,x:Di,y:He,wrap:Bt.wrap,fullyVisible:ce})}}return yt.sort((Bt,Gt)=>Bt.distanceSq-Gt.distanceSq).map(Bt=>Bt.tileID)}resize(c,A){this.width=c,this.height=A,this.pixelsToGLUnits=[2/c,-2/A],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(c){return Math.pow(2,c)}scaleZoom(c){return Math.log(c)/Math.LN2}project(c){let A=n.ad(c.lat,-this.maxValidLatitude,this.maxValidLatitude);return new n.P(n.G(c.lng)*this.worldSize,n.H(A)*this.worldSize)}unproject(c){return new n.U(c.x/this.worldSize,c.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(c){let A=this.pointLocation(this.centerPoint,c),w=c.getElevationForLngLatZoom(A,this.tileZoom);if(!(this.elevation-w))return;let E=this.getCameraPosition(),P=n.U.fromLngLat(E.lngLat,E.altitude),U=n.U.fromLngLat(A,w),V=P.x-U.x,$=P.y-U.y,G=P.z-U.z,J=Math.sqrt(V*V+$*$+G*G),tt=this.scaleZoom(this.cameraToCenterDistance/J/this.tileSize);this._elevation=w,this._center=A,this.zoom=tt}setLocationAtPoint(c,A){let w=this.pointCoordinate(A),E=this.pointCoordinate(this.centerPoint),P=this.locationCoordinate(c),U=new n.U(P.x-(w.x-E.x),P.y-(w.y-E.y));this.center=this.coordinateLocation(U),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(c,A){return A?this.coordinatePoint(this.locationCoordinate(c),A.getElevationForLngLatZoom(c,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(c))}pointLocation(c,A){return this.coordinateLocation(this.pointCoordinate(c,A))}locationCoordinate(c){return n.U.fromLngLat(c)}coordinateLocation(c){return c&&c.toLngLat()}pointCoordinate(c,A){if(A){let lt=A.pointCoordinate(c);if(lt!=null)return lt}let w=[c.x,c.y,0,1],E=[c.x,c.y,1,1];n.ag(w,w,this.pixelMatrixInverse),n.ag(E,E,this.pixelMatrixInverse);let P=w[3],U=E[3],V=w[1]/P,$=E[1]/U,G=w[2]/P,J=E[2]/U,tt=G===J?0:(0-G)/(J-G);return new n.U(n.B.number(w[0]/P,E[0]/U,tt)/this.worldSize,n.B.number(V,$,tt)/this.worldSize)}coordinatePoint(c,A=0,w=this.pixelMatrix){let E=[c.x*this.worldSize,c.y*this.worldSize,A,1];return n.ag(E,E,w),new n.P(E[0]/E[3],E[1]/E[3])}getBounds(){let c=Math.max(0,this.height/2-this.getHorizon());return new ke().extend(this.pointLocation(new n.P(0,c))).extend(this.pointLocation(new n.P(this.width,c))).extend(this.pointLocation(new n.P(this.width,this.height))).extend(this.pointLocation(new n.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new ke([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(c){c?(this.lngRange=[c.getWest(),c.getEast()],this.latRange=[c.getSouth(),c.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(c,A=!1){let w=c.key,E=A?this._alignedPosMatrixCache:this._posMatrixCache;if(E[w])return E[w];let P=c.canonical,U=this.worldSize/this.zoomScale(P.z),V=P.x+Math.pow(2,P.z)*c.wrap,$=n.ao(new Float64Array(16));return n.$($,$,[V*U,P.y*U,0]),n.a0($,$,[U/n.N,U/n.N,1]),n.a1($,A?this.alignedProjMatrix:this.projMatrix,$),E[w]=new Float32Array($),E[w]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let c,A,w,E,P=-90,U=90,V=-180,$=180,G=this.size,J=this._unmodified;if(this.latRange){let wt=this.latRange;P=n.H(wt[1])*this.worldSize,U=n.H(wt[0])*this.worldSize,c=U-P<G.y?G.y/(U-P):0}if(this.lngRange){let wt=this.lngRange;V=n.b5(n.G(wt[0])*this.worldSize,0,this.worldSize),$=n.b5(n.G(wt[1])*this.worldSize,0,this.worldSize),$<V&&($+=this.worldSize),A=$-V<G.x?G.x/($-V):0}let tt=this.point,lt=Math.max(A||0,c||0);if(lt)return this.center=this.unproject(new n.P(A?($+V)/2:tt.x,c?(U+P)/2:tt.y)),this.zoom+=this.scaleZoom(lt),this._unmodified=J,void(this._constraining=!1);if(this.latRange){let wt=tt.y,bt=G.y/2;wt-bt<P&&(E=P+bt),wt+bt>U&&(E=U-bt)}if(this.lngRange){let wt=(V+$)/2,bt=n.b5(tt.x,wt-this.worldSize/2,wt+this.worldSize/2),Rt=G.x/2;bt-Rt<V&&(w=V+Rt),bt+Rt>$&&(w=$-Rt)}w===void 0&&E===void 0||(this.center=this.unproject(new n.P(w!==void 0?w:tt.x,E!==void 0?E:tt.y)).wrap()),this._unmodified=J,this._constraining=!1}_calcMatrices(){if(!this.height)return;let c=this.centerOffset,A=this.point.x,w=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=n.b7(1,this.center.lat)*this.worldSize;let E=n.ao(new Float64Array(16));n.a0(E,E,[this.width/2,-this.height/2,1]),n.$(E,E,[1,-1,0]),this.labelPlaneMatrix=E,E=n.ao(new Float64Array(16)),n.a0(E,E,[1,-1,1]),n.$(E,E,[-1,-1,0]),n.a0(E,E,[2/this.width,2/this.height,1]),this.glCoordMatrix=E;let P=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),U=Math.min(this.elevation,this._minEleveationForCurrentTile),V=P-U*this._pixelPerMeter/Math.cos(this._pitch),$=U<0?V:P,G=Math.PI/2+this._pitch,J=this._fov*(.5+c.y/this.height),tt=Math.sin(J)*$/Math.sin(n.ad(Math.PI-G-J,.01,Math.PI-.01)),lt=this.getHorizon(),wt=2*Math.atan(lt/this.cameraToCenterDistance)*(.5+c.y/(2*lt)),bt=Math.sin(wt)*$/Math.sin(n.ad(Math.PI-G-wt,.01,Math.PI-.01)),Rt=Math.min(tt,bt),yt=1.01*(Math.cos(Math.PI/2-this._pitch)*Rt+$),Zt=this.height/50;E=new Float64Array(16),n.b8(E,this._fov,this.width/this.height,Zt,yt),E[8]=2*-c.x/this.width,E[9]=2*c.y/this.height,n.a0(E,E,[1,-1,1]),n.$(E,E,[0,0,-this.cameraToCenterDistance]),n.b9(E,E,this._pitch),n.ae(E,E,this.angle),n.$(E,E,[-A,-w,0]),this.mercatorMatrix=n.a0([],E,[this.worldSize,this.worldSize,this.worldSize]),n.a0(E,E,[1,1,this._pixelPerMeter]),this.pixelMatrix=n.a1(new Float64Array(16),this.labelPlaneMatrix,E),n.$(E,E,[0,0,-this.elevation]),this.projMatrix=E,this.invProjMatrix=n.as([],E),this.pixelMatrix3D=n.a1(new Float64Array(16),this.labelPlaneMatrix,E);let se=this.width%2/2,Bt=this.height%2/2,Gt=Math.cos(this.angle),he=Math.sin(this.angle),ce=A-Math.round(A)+Gt*se+he*Bt,xe=w-Math.round(w)+Gt*Bt+he*se,Pe=new Float64Array(E);if(n.$(Pe,Pe,[ce>.5?ce-1:ce,xe>.5?xe-1:xe,0]),this.alignedProjMatrix=Pe,E=n.as(new Float64Array(16),this.pixelMatrix),!E)throw new Error("failed to invert matrix");this.pixelMatrixInverse=E,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;let c=this.pointCoordinate(new n.P(0,0)),A=[c.x*this.worldSize,c.y*this.worldSize,0,1];return n.ag(A,A,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){let c=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new n.P(0,c))}getCameraQueryGeometry(c){let A=this.getCameraPoint();if(c.length===1)return[c[0],A];{let w=A.x,E=A.y,P=A.x,U=A.y;for(let V of c)w=Math.min(w,V.x),E=Math.min(E,V.y),P=Math.max(P,V.x),U=Math.max(U,V.y);return[new n.P(w,E),new n.P(P,E),new n.P(P,U),new n.P(w,U),new n.P(w,E)]}}}function Du(M,c){let A,w=!1,E=null,P=null,U=()=>{E=null,w&&(M.apply(P,A),E=setTimeout(U,c),w=!1)};return(...V)=>(w=!0,P=this,A=V,E||U(),E)}class Lf{constructor(c){this._getCurrentHash=()=>{let A=window.location.hash.replace("#","");if(this._hashName){let w;return A.split("&").map(E=>E.split("=")).forEach(E=>{E[0]===this._hashName&&(w=E)}),(w&&w[1]||"").split("/")}return A.split("/")},this._onHashChange=()=>{let A=this._getCurrentHash();if(A.length>=3&&!A.some(w=>isNaN(w))){let w=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(A[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+A[2],+A[1]],zoom:+A[0],bearing:w,pitch:+(A[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{let A=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,A)}catch{}},this._updateHash=Du(this._updateHashUnthrottled,300),this._hashName=c&&encodeURIComponent(c)}addTo(c){return this._map=c,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(c){let A=this._map.getCenter(),w=Math.round(100*this._map.getZoom())/100,E=Math.ceil((w*Math.LN2+Math.log(512/360/.5))/Math.LN10),P=Math.pow(10,E),U=Math.round(A.lng*P)/P,V=Math.round(A.lat*P)/P,$=this._map.getBearing(),G=this._map.getPitch(),J="";if(J+=c?`/${U}/${V}/${w}`:`${w}/${V}/${U}`,($||G)&&(J+="/"+Math.round(10*$)/10),G&&(J+=`/${Math.round(G)}`),this._hashName){let tt=this._hashName,lt=!1,wt=window.location.hash.slice(1).split("&").map(bt=>{let Rt=bt.split("=")[0];return Rt===tt?(lt=!0,`${Rt}=${J}`):bt}).filter(bt=>bt);return lt||wt.push(`${tt}=${J}`),`#${wt.join("&")}`}return`#${J}`}}let pa={linearity:.3,easing:n.ba(0,0,.3,1)},Zs=n.e({deceleration:2500,maxSpeed:1400},pa),im=n.e({deceleration:20,maxSpeed:1400},pa),iy=n.e({deceleration:1e3,maxSpeed:360},pa),ny=n.e({deceleration:1e3,maxSpeed:90},pa);class sg{constructor(c){this._map=c,this.clear()}clear(){this._inertiaBuffer=[]}record(c){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:n.h.now(),settings:c})}_drainInertiaBuffer(){let c=this._inertiaBuffer,A=n.h.now();for(;c.length>0&&A-c[0].time>160;)c.shift()}_onMoveEnd(c){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;let A={zoom:0,bearing:0,pitch:0,pan:new n.P(0,0),pinchAround:void 0,around:void 0};for(let{settings:P}of this._inertiaBuffer)A.zoom+=P.zoomDelta||0,A.bearing+=P.bearingDelta||0,A.pitch+=P.pitchDelta||0,P.panDelta&&A.pan._add(P.panDelta),P.around&&(A.around=P.around),P.pinchAround&&(A.pinchAround=P.pinchAround);let w=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,E={};if(A.pan.mag()){let P=gd(A.pan.mag(),w,n.e({},Zs,c||{}));E.offset=A.pan.mult(P.amount/A.pan.mag()),E.center=this._map.transform.center,uc(E,P)}if(A.zoom){let P=gd(A.zoom,w,im);E.zoom=this._map.transform.zoom+P.amount,uc(E,P)}if(A.bearing){let P=gd(A.bearing,w,iy);E.bearing=this._map.transform.bearing+n.ad(P.amount,-179,179),uc(E,P)}if(A.pitch){let P=gd(A.pitch,w,ny);E.pitch=this._map.transform.pitch+P.amount,uc(E,P)}if(E.zoom||E.bearing){let P=A.pinchAround===void 0?A.around:A.pinchAround;E.around=P?this._map.unproject(P):this._map.getCenter()}return this.clear(),n.e(E,{noMoveStart:!0})}}function uc(M,c){(!M.duration||M.duration<c.duration)&&(M.duration=c.duration,M.easing=c.easing)}function gd(M,c,A){let{maxSpeed:w,linearity:E,deceleration:P}=A,U=n.ad(M*E/(c/1e3),-w,w),V=Math.abs(U)/(P*E);return{easing:A.easing,duration:1e3*V,amount:U*(V/2)}}class Pa extends n.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(c,A,w,E={}){let P=a.mousePos(A.getCanvasContainer(),w),U=A.unproject(P);super(c,n.e({point:P,lngLat:U,originalEvent:w},E)),this._defaultPrevented=!1,this.target=A}}class Tn extends n.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(c,A,w){let E=c==="touchend"?w.changedTouches:w.touches,P=a.touchPos(A.getCanvasContainer(),E),U=P.map($=>A.unproject($)),V=P.reduce(($,G,J,tt)=>$.add(G.div(tt.length)),new n.P(0,0));super(c,{points:P,point:V,lngLats:U,lngLat:A.unproject(V),originalEvent:w}),this._defaultPrevented=!1}}class nm extends n.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(c,A,w){super(c,{originalEvent:w}),this._defaultPrevented=!1}}class og{constructor(c,A){this._map=c,this._clickTolerance=A.clickTolerance}reset(){delete this._mousedownPos}wheel(c){return this._firePreventable(new nm(c.type,this._map,c))}mousedown(c,A){return this._mousedownPos=A,this._firePreventable(new Pa(c.type,this._map,c))}mouseup(c){this._map.fire(new Pa(c.type,this._map,c))}click(c,A){this._mousedownPos&&this._mousedownPos.dist(A)>=this._clickTolerance||this._map.fire(new Pa(c.type,this._map,c))}dblclick(c){return this._firePreventable(new Pa(c.type,this._map,c))}mouseover(c){this._map.fire(new Pa(c.type,this._map,c))}mouseout(c){this._map.fire(new Pa(c.type,this._map,c))}touchstart(c){return this._firePreventable(new Tn(c.type,this._map,c))}touchmove(c){this._map.fire(new Tn(c.type,this._map,c))}touchend(c){this._map.fire(new Tn(c.type,this._map,c))}touchcancel(c){this._map.fire(new Tn(c.type,this._map,c))}_firePreventable(c){if(this._map.fire(c),c.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class sy{constructor(c){this._map=c}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(c){this._map.fire(new Pa(c.type,this._map,c))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Pa("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(c){this._delayContextMenu?this._contextMenuEvent=c:this._ignoreContextMenu||this._map.fire(new Pa(c.type,this._map,c)),this._map.listens("contextmenu")&&c.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Qc{constructor(c){this._map=c}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(c){return this.transform.pointLocation(n.P.convert(c),this._map.terrain)}}class oy{constructor(c,A){this._map=c,this._tr=new Qc(c),this._el=c.getCanvasContainer(),this._container=c.getContainer(),this._clickTolerance=A.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(c,A){this.isEnabled()&&c.shiftKey&&c.button===0&&(a.disableDrag(),this._startPos=this._lastPos=A,this._active=!0)}mousemoveWindow(c,A){if(!this._active)return;let w=A;if(this._lastPos.equals(w)||!this._box&&w.dist(this._startPos)<this._clickTolerance)return;let E=this._startPos;this._lastPos=w,this._box||(this._box=a.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",c));let P=Math.min(E.x,w.x),U=Math.max(E.x,w.x),V=Math.min(E.y,w.y),$=Math.max(E.y,w.y);a.setTransform(this._box,`translate(${P}px,${V}px)`),this._box.style.width=U-P+"px",this._box.style.height=$-V+"px"}mouseupWindow(c,A){if(!this._active||c.button!==0)return;let w=this._startPos,E=A;if(this.reset(),a.suppressClick(),w.x!==E.x||w.y!==E.y)return this._map.fire(new n.k("boxzoomend",{originalEvent:c})),{cameraAnimation:P=>P.fitScreenCoordinates(w,E,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",c)}keydown(c){this._active&&c.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",c))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(a.remove(this._box),this._box=null),a.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(c,A){return this._map.fire(new n.k(c,{originalEvent:A}))}}function Ra(M,c){if(M.length!==c.length)throw new Error(`The number of touches and points are not equal - touches ${M.length}, points ${c.length}`);let A={};for(let w=0;w<M.length;w++)A[M[w].identifier]=c[w];return A}class Ol{constructor(c){this.reset(),this.numTouches=c.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(c,A,w){(this.centroid||w.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=c.timeStamp),w.length===this.numTouches&&(this.centroid=function(E){let P=new n.P(0,0);for(let U of E)P._add(U);return P.div(E.length)}(A),this.touches=Ra(w,A)))}touchmove(c,A,w){if(this.aborted||!this.centroid)return;let E=Ra(w,A);for(let P in this.touches){let U=E[P];(!U||U.dist(this.touches[P])>30)&&(this.aborted=!0)}}touchend(c,A,w){if((!this.centroid||c.timeStamp-this.startTime>500)&&(this.aborted=!0),w.length===0){let E=!this.aborted&&this.centroid;if(this.reset(),E)return E}}}class Ff{constructor(c){this.singleTap=new Ol(c),this.numTaps=c.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(c,A,w){this.singleTap.touchstart(c,A,w)}touchmove(c,A,w){this.singleTap.touchmove(c,A,w)}touchend(c,A,w){let E=this.singleTap.touchend(c,A,w);if(E){let P=c.timeStamp-this.lastTime<500,U=!this.lastTap||this.lastTap.dist(E)<30;if(P&&U||this.reset(),this.count++,this.lastTime=c.timeStamp,this.lastTap=E,this.count===this.numTaps)return this.reset(),E}}}class Kc{constructor(c){this._tr=new Qc(c),this._zoomIn=new Ff({numTouches:1,numTaps:2}),this._zoomOut=new Ff({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(c,A,w){this._zoomIn.touchstart(c,A,w),this._zoomOut.touchstart(c,A,w)}touchmove(c,A,w){this._zoomIn.touchmove(c,A,w),this._zoomOut.touchmove(c,A,w)}touchend(c,A,w){let E=this._zoomIn.touchend(c,A,w),P=this._zoomOut.touchend(c,A,w),U=this._tr;return E?(this._active=!0,c.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:V=>V.easeTo({duration:300,zoom:U.zoom+1,around:U.unproject(E)},{originalEvent:c})}):P?(this._active=!0,c.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:V=>V.easeTo({duration:300,zoom:U.zoom-1,around:U.unproject(P)},{originalEvent:c})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Jc{constructor(c){this._enabled=!!c.enable,this._moveStateManager=c.moveStateManager,this._clickTolerance=c.clickTolerance||1,this._moveFunction=c.move,this._activateOnStart=!!c.activateOnStart,c.assignEvents(this),this.reset()}reset(c){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(c)}_move(...c){let A=this._moveFunction(...c);if(A.bearingDelta||A.pitchDelta||A.around||A.panDelta)return this._active=!0,A}dragStart(c,A){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(c)&&(this._moveStateManager.startMove(c),this._lastPoint=A.length?A[0]:A,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(c,A){if(!this.isEnabled())return;let w=this._lastPoint;if(!w)return;if(c.preventDefault(),!this._moveStateManager.isValidMoveEvent(c))return void this.reset(c);let E=A.length?A[0]:A;return!this._moved&&E.dist(w)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=E,this._move(w,E))}dragEnd(c){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(c)&&(this._moved&&a.suppressClick(),this.reset(c))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}let ay={0:1,2:2};class sm{constructor(c){this._correctEvent=c.checkCorrectEvent}startMove(c){let A=a.mouseButton(c);this._eventButton=A}endMove(c){delete this._eventButton}isValidStartEvent(c){return this._correctEvent(c)}isValidMoveEvent(c){return!function(A,w){let E=ay[w];return A.buttons===void 0||(A.buttons&E)!==E}(c,this._eventButton)}isValidEndEvent(c){return a.mouseButton(c)===this._eventButton}}class ag{constructor(){this._firstTouch=void 0}_isOneFingerTouch(c){return c.targetTouches.length===1}_isSameTouchEvent(c){return c.targetTouches[0].identifier===this._firstTouch}startMove(c){this._firstTouch=c.targetTouches[0].identifier}endMove(c){delete this._firstTouch}isValidStartEvent(c){return this._isOneFingerTouch(c)}isValidMoveEvent(c){return this._isOneFingerTouch(c)&&this._isSameTouchEvent(c)}isValidEndEvent(c){return this._isOneFingerTouch(c)&&this._isSameTouchEvent(c)}}let om=M=>{M.mousedown=M.dragStart,M.mousemoveWindow=M.dragMove,M.mouseup=M.dragEnd,M.contextmenu=function(c){c.preventDefault()}},zf=({enable:M,clickTolerance:c,bearingDegreesPerPixelMoved:A=.8})=>{let w=new sm({checkCorrectEvent:E=>a.mouseButton(E)===0&&E.ctrlKey||a.mouseButton(E)===2});return new Jc({clickTolerance:c,move:(E,P)=>({bearingDelta:(P.x-E.x)*A}),moveStateManager:w,enable:M,assignEvents:om})},tu=({enable:M,clickTolerance:c,pitchDegreesPerPixelMoved:A=-.5})=>{let w=new sm({checkCorrectEvent:E=>a.mouseButton(E)===0&&E.ctrlKey||a.mouseButton(E)===2});return new Jc({clickTolerance:c,move:(E,P)=>({pitchDelta:(P.y-E.y)*A}),moveStateManager:w,enable:M,assignEvents:om})};class Ve{constructor(c,A){this._minTouches=c.cooperativeGestures?2:1,this._clickTolerance=c.clickTolerance||1,this._map=A,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new n.P(0,0),setTimeout(()=>{this._cancelCooperativeMessage=!1},200)}touchstart(c,A,w){return this._calculateTransform(c,A,w)}touchmove(c,A,w){if(this._map._cooperativeGestures&&(this._minTouches===2&&w.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(c,!1,w.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(w.length<this._minTouches))return c.preventDefault(),this._calculateTransform(c,A,w)}touchend(c,A,w){this._calculateTransform(c,A,w),this._active&&w.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(c,A,w){w.length>0&&(this._active=!0);let E=Ra(w,A),P=new n.P(0,0),U=new n.P(0,0),V=0;for(let G in E){let J=E[G],tt=this._touches[G];tt&&(P._add(J),U._add(J.sub(tt)),V++,E[G]=J)}if(this._touches=E,V<this._minTouches||!U.mag())return;let $=U.div(V);return this._sum._add($),this._sum.mag()<this._clickTolerance?void 0:{around:P.div(V),panDelta:$}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class hc{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(c,A,w){this._firstTwoTouches||w.length<2||(this._firstTwoTouches=[w[0].identifier,w[1].identifier],this._start([A[0],A[1]]))}touchmove(c,A,w){if(!this._firstTwoTouches)return;c.preventDefault();let[E,P]=this._firstTwoTouches,U=ws(w,A,E),V=ws(w,A,P);if(!U||!V)return;let $=this._aroundCenter?null:U.add(V).div(2);return this._move([U,V],$,c)}touchend(c,A,w){if(!this._firstTwoTouches)return;let[E,P]=this._firstTwoTouches,U=ws(w,A,E),V=ws(w,A,P);U&&V||(this._active&&a.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(c){this._enabled=!0,this._aroundCenter=!!c&&c.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function ws(M,c,A){for(let w=0;w<M.length;w++)if(M[w].identifier===A)return c[w]}function Ou(M,c){return Math.log(M/c)/Math.LN2}class lg extends hc{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(c){this._startDistance=this._distance=c[0].dist(c[1])}_move(c,A){let w=this._distance;if(this._distance=c[0].dist(c[1]),this._active||!(Math.abs(Ou(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Ou(this._distance,w),pinchAround:A}}}function qe(M,c){return 180*M.angleWith(c)/Math.PI}class cg extends hc{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(c){this._startVector=this._vector=c[0].sub(c[1]),this._minDiameter=c[0].dist(c[1])}_move(c,A){let w=this._vector;if(this._vector=c[0].sub(c[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:qe(this._vector,w),pinchAround:A}}_isBelowThreshold(c){this._minDiameter=Math.min(this._minDiameter,c.mag());let A=25/(Math.PI*this._minDiameter)*360,w=qe(c,this._startVector);return Math.abs(w)<A}}function ug(M){return Math.abs(M.y)>Math.abs(M.x)}class Vb extends hc{constructor(c){super(),this._map=c}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(c,A,w){super.touchstart(c,A,w),this._currentTouchCount=w.length}_start(c){this._lastPoints=c,ug(c[0].sub(c[1]))&&(this._valid=!1)}_move(c,A,w){if(this._map._cooperativeGestures&&this._currentTouchCount<3)return;let E=c[0].sub(this._lastPoints[0]),P=c[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(E,P,w.timeStamp),this._valid?(this._lastPoints=c,this._active=!0,{pitchDelta:(E.y+P.y)/2*-.5}):void 0}gestureBeginsVertically(c,A,w){if(this._valid!==void 0)return this._valid;let E=c.mag()>=2,P=A.mag()>=2;if(!E&&!P)return;if(!E||!P)return this._firstMove===void 0&&(this._firstMove=w),w-this._firstMove<100&&void 0;let U=c.y>0==A.y>0;return ug(c)&&ug(A)&&U}}let am={panStep:100,bearingStep:15,pitchStep:10};class _d{constructor(c){this._tr=new Qc(c);let A=am;this._panStep=A.panStep,this._bearingStep=A.bearingStep,this._pitchStep=A.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(c){if(c.altKey||c.ctrlKey||c.metaKey)return;let A=0,w=0,E=0,P=0,U=0;switch(c.keyCode){case 61:case 107:case 171:case 187:A=1;break;case 189:case 109:case 173:A=-1;break;case 37:c.shiftKey?w=-1:(c.preventDefault(),P=-1);break;case 39:c.shiftKey?w=1:(c.preventDefault(),P=1);break;case 38:c.shiftKey?E=1:(c.preventDefault(),U=-1);break;case 40:c.shiftKey?E=-1:(c.preventDefault(),U=1);break;default:return}return this._rotationDisabled&&(w=0,E=0),{cameraAnimation:V=>{let $=this._tr;V.easeTo({duration:300,easeId:"keyboardHandler",easing:Bu,zoom:A?Math.round($.zoom)+A*(c.shiftKey?2:1):$.zoom,bearing:$.bearing+w*this._bearingStep,pitch:$.pitch+E*this._pitchStep,offset:[-P*this._panStep,-U*this._panStep],center:$.center},{originalEvent:c})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Bu(M){return M*(2-M)}let hg=4.000244140625;class ly{constructor(c,A){this._onTimeout=w=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(w)},this._map=c,this._tr=new Qc(c),this._el=c.getCanvasContainer(),this._triggerRenderFrame=A,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(c){this._defaultZoomRate=c}setWheelZoomRate(c){this._wheelZoomRate=c}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(c){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!c&&c.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(c){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!c[this._map._metaKey])return;c.preventDefault()}let A=c.deltaMode===WheelEvent.DOM_DELTA_LINE?40*c.deltaY:c.deltaY,w=n.h.now(),E=w-(this._lastWheelEventTime||0);this._lastWheelEventTime=w,A!==0&&A%hg==0?this._type="wheel":A!==0&&Math.abs(A)<4?this._type="trackpad":E>400?(this._type=null,this._lastValue=A,this._timeout=setTimeout(this._onTimeout,40,c)):this._type||(this._type=Math.abs(E*A)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,A+=this._lastValue)),c.shiftKey&&A&&(A/=4),this._type&&(this._lastWheelEvent=c,this._delta-=A,this._active||this._start(c)),c.preventDefault()}_start(c){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);let A=a.mousePos(this._el,c),w=this._tr;this._around=n.L.convert(this._aroundCenter?w.center:w.unproject(A)),this._aroundPoint=w.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;let c=this._tr.transform;if(this._delta!==0){let V=this._type==="wheel"&&Math.abs(this._delta)>hg?this._wheelZoomRate:this._defaultZoomRate,$=2/(1+Math.exp(-Math.abs(this._delta*V)));this._delta<0&&$!==0&&($=1/$);let G=typeof this._targetZoom=="number"?c.zoomScale(this._targetZoom):c.scale;this._targetZoom=Math.min(c.maxZoom,Math.max(c.minZoom,c.scaleZoom(G*$))),this._type==="wheel"&&(this._startZoom=c.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}let A=typeof this._targetZoom=="number"?this._targetZoom:c.zoom,w=this._startZoom,E=this._easing,P,U=!1;if(this._type==="wheel"&&w&&E){let V=Math.min((n.h.now()-this._lastWheelEventTime)/200,1),$=E(V);P=n.B.number(w,A,$),V<1?this._frameId||(this._frameId=!0):U=!0}else P=A,U=!0;return this._active=!0,U&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!U,zoomDelta:P-c.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(c){let A=n.bb;if(this._prevEase){let w=this._prevEase,E=(n.h.now()-w.start)/w.duration,P=w.easing(E+.01)-w.easing(E),U=.27/Math.sqrt(P*P+1e-4)*.01,V=Math.sqrt(.0729-U*U);A=n.ba(U,V,.25,1)}return this._prevEase={start:n.h.now(),duration:c,easing:A},A}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Uf{constructor(c,A){this._clickZoom=c,this._tapZoom=A}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class eu{constructor(c){this._tr=new Qc(c),this.reset()}reset(){this._active=!1}dblclick(c,A){return c.preventDefault(),{cameraAnimation:w=>{w.easeTo({duration:300,zoom:this._tr.zoom+(c.shiftKey?-1:1),around:this._tr.unproject(A)},{originalEvent:c})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class fc{constructor(){this._tap=new Ff({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(c,A,w){if(!this._swipePoint)if(this._tapTime){let E=A[0],P=c.timeStamp-this._tapTime<500,U=this._tapPoint.dist(E)<30;P&&U?w.length>0&&(this._swipePoint=E,this._swipeTouch=w[0].identifier):this.reset()}else this._tap.touchstart(c,A,w)}touchmove(c,A,w){if(this._tapTime){if(this._swipePoint){if(w[0].identifier!==this._swipeTouch)return;let E=A[0],P=E.y-this._swipePoint.y;return this._swipePoint=E,c.preventDefault(),this._active=!0,{zoomDelta:P/128}}}else this._tap.touchmove(c,A,w)}touchend(c,A,w){if(this._tapTime)this._swipePoint&&w.length===0&&this.reset();else{let E=this._tap.touchend(c,A,w);E&&(this._tapTime=c.timeStamp,this._tapPoint=E)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class lm{constructor(c,A,w){this._el=c,this._mousePan=A,this._touchPan=w}enable(c){this._inertiaOptions=c||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Qo{constructor(c,A,w){this._pitchWithRotate=c.pitchWithRotate,this._mouseRotate=A,this._mousePitch=w}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class pc{constructor(c,A,w,E){this._el=c,this._touchZoom=A,this._touchRotate=w,this._tapDragZoom=E,this._rotationDisabled=!1,this._enabled=!0}enable(c){this._touchZoom.enable(c),this._rotationDisabled||this._touchRotate.enable(c),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}let yd=M=>M.zoom||M.drag||M.pitch||M.rotate;class fg extends n.k{}function Vf(M){return M.panDelta&&M.panDelta.mag()||M.zoomDelta||M.bearingDelta||M.pitchDelta}class pg{constructor(c,A){this.handleWindowEvent=E=>{this.handleEvent(E,`${E.type}Window`)},this.handleEvent=(E,P)=>{if(E.type==="blur")return void this.stop(!0);this._updatingCamera=!0;let U=E.type==="renderFrame"?void 0:E,V={needsRenderFrame:!1},$={},G={},J=E.touches,tt=J?this._getMapTouches(J):void 0,lt=tt?a.touchPos(this._el,tt):a.mousePos(this._el,E);for(let{handlerName:Rt,handler:yt,allowed:Zt}of this._handlers){if(!yt.isEnabled())continue;let se;this._blockedByActive(G,Zt,Rt)?yt.reset():yt[P||E.type]&&(se=yt[P||E.type](E,lt,tt),this.mergeHandlerResult(V,$,se,Rt,U),se&&se.needsRenderFrame&&this._triggerRenderFrame()),(se||yt.isActive())&&(G[Rt]=yt)}let wt={};for(let Rt in this._previousActiveHandlers)G[Rt]||(wt[Rt]=U);this._previousActiveHandlers=G,(Object.keys(wt).length||Vf(V))&&(this._changes.push([V,$,wt]),this._triggerRenderFrame()),(Object.keys(G).length||Vf(V))&&this._map._stop(!0),this._updatingCamera=!1;let{cameraAnimation:bt}=V;bt&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],bt(this._map))},this._map=c,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new sg(c),this._bearingSnap=A.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(A);let w=this._el;this._listeners=[[w,"touchstart",{passive:!0}],[w,"touchmove",{passive:!1}],[w,"touchend",void 0],[w,"touchcancel",void 0],[w,"mousedown",void 0],[w,"mousemove",void 0],[w,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[w,"mouseover",void 0],[w,"mouseout",void 0],[w,"dblclick",void 0],[w,"click",void 0],[w,"keydown",{capture:!1}],[w,"keyup",void 0],[w,"wheel",{passive:!1}],[w,"contextmenu",void 0],[window,"blur",void 0]];for(let[E,P,U]of this._listeners)a.addEventListener(E,P,E===document?this.handleWindowEvent:this.handleEvent,U)}destroy(){for(let[c,A,w]of this._listeners)a.removeEventListener(c,A,c===document?this.handleWindowEvent:this.handleEvent,w)}_addDefaultHandlers(c){let A=this._map,w=A.getCanvasContainer();this._add("mapEvent",new og(A,c));let E=A.boxZoom=new oy(A,c);this._add("boxZoom",E),c.interactive&&c.boxZoom&&E.enable();let P=new Kc(A),U=new eu(A);A.doubleClickZoom=new Uf(U,P),this._add("tapZoom",P),this._add("clickZoom",U),c.interactive&&c.doubleClickZoom&&A.doubleClickZoom.enable();let V=new fc;this._add("tapDragZoom",V);let $=A.touchPitch=new Vb(A);this._add("touchPitch",$),c.interactive&&c.touchPitch&&A.touchPitch.enable(c.touchPitch);let G=zf(c),J=tu(c);A.dragRotate=new Qo(c,G,J),this._add("mouseRotate",G,["mousePitch"]),this._add("mousePitch",J,["mouseRotate"]),c.interactive&&c.dragRotate&&A.dragRotate.enable();let tt=(({enable:Zt,clickTolerance:se})=>{let Bt=new sm({checkCorrectEvent:Gt=>a.mouseButton(Gt)===0&&!Gt.ctrlKey});return new Jc({clickTolerance:se,move:(Gt,he)=>({around:he,panDelta:he.sub(Gt)}),activateOnStart:!0,moveStateManager:Bt,enable:Zt,assignEvents:om})})(c),lt=new Ve(c,A);A.dragPan=new lm(w,tt,lt),this._add("mousePan",tt),this._add("touchPan",lt,["touchZoom","touchRotate"]),c.interactive&&c.dragPan&&A.dragPan.enable(c.dragPan);let wt=new cg,bt=new lg;A.touchZoomRotate=new pc(w,bt,wt,V),this._add("touchRotate",wt,["touchPan","touchZoom"]),this._add("touchZoom",bt,["touchPan","touchRotate"]),c.interactive&&c.touchZoomRotate&&A.touchZoomRotate.enable(c.touchZoomRotate);let Rt=A.scrollZoom=new ly(A,()=>this._triggerRenderFrame());this._add("scrollZoom",Rt,["mousePan"]),c.interactive&&c.scrollZoom&&A.scrollZoom.enable(c.scrollZoom);let yt=A.keyboard=new _d(A);this._add("keyboard",yt),c.interactive&&c.keyboard&&A.keyboard.enable(),this._add("blockableMapEvent",new sy(A))}_add(c,A,w){this._handlers.push({handlerName:c,handler:A,allowed:w}),this._handlersById[c]=A}stop(c){if(!this._updatingCamera){for(let{handler:A}of this._handlers)A.reset();this._inertia.clear(),this._fireEvents({},{},c),this._changes=[]}}isActive(){for(let{handler:c}of this._handlers)if(c.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!yd(this._eventsInProgress)||this.isZooming()}_blockedByActive(c,A,w){for(let E in c)if(E!==w&&(!A||A.indexOf(E)<0))return!0;return!1}_getMapTouches(c){let A=[];for(let w of c)this._el.contains(w.target)&&A.push(w);return A}mergeHandlerResult(c,A,w,E,P){if(!w)return;n.e(c,w);let U={handlerName:E,originalEvent:w.originalEvent||P};w.zoomDelta!==void 0&&(A.zoom=U),w.panDelta!==void 0&&(A.drag=U),w.pitchDelta!==void 0&&(A.pitch=U),w.bearingDelta!==void 0&&(A.rotate=U)}_applyChanges(){let c={},A={},w={};for(let[E,P,U]of this._changes)E.panDelta&&(c.panDelta=(c.panDelta||new n.P(0,0))._add(E.panDelta)),E.zoomDelta&&(c.zoomDelta=(c.zoomDelta||0)+E.zoomDelta),E.bearingDelta&&(c.bearingDelta=(c.bearingDelta||0)+E.bearingDelta),E.pitchDelta&&(c.pitchDelta=(c.pitchDelta||0)+E.pitchDelta),E.around!==void 0&&(c.around=E.around),E.pinchAround!==void 0&&(c.pinchAround=E.pinchAround),E.noInertia&&(c.noInertia=E.noInertia),n.e(A,P),n.e(w,U);this._updateMapTransform(c,A,w),this._changes=[]}_updateMapTransform(c,A,w){let E=this._map,P=E._getTransformForUpdate(),U=E.terrain;if(!(Vf(c)||U&&this._terrainMovement))return this._fireEvents(A,w,!0);let{panDelta:V,zoomDelta:$,bearingDelta:G,pitchDelta:J,around:tt,pinchAround:lt}=c;lt!==void 0&&(tt=lt),E._stop(!0),tt=tt||E.transform.centerPoint;let wt=P.pointLocation(V?tt.sub(V):tt);G&&(P.bearing+=G),J&&(P.pitch+=J),$&&(P.zoom+=$),U?this._terrainMovement||!A.drag&&!A.zoom?A.drag&&this._terrainMovement?P.center=P.pointLocation(P.centerPoint.sub(V)):P.setLocationAtPoint(wt,tt):(this._terrainMovement=!0,this._map._elevationFreeze=!0,P.setLocationAtPoint(wt,tt),this._map.once("moveend",()=>{this._map._elevationFreeze=!1,this._terrainMovement=!1,P.recalculateZoom(E.terrain)})):P.setLocationAtPoint(wt,tt),E._applyUpdatedTransform(P),this._map._update(),c.noInertia||this._inertia.record(c),this._fireEvents(A,w,!0)}_fireEvents(c,A,w){let E=yd(this._eventsInProgress),P=yd(c),U={};for(let J in c){let{originalEvent:tt}=c[J];this._eventsInProgress[J]||(U[`${J}start`]=tt),this._eventsInProgress[J]=c[J]}!E&&P&&this._fireEvent("movestart",P.originalEvent);for(let J in U)this._fireEvent(J,U[J]);P&&this._fireEvent("move",P.originalEvent);for(let J in c){let{originalEvent:tt}=c[J];this._fireEvent(J,tt)}let V={},$;for(let J in this._eventsInProgress){let{handlerName:tt,originalEvent:lt}=this._eventsInProgress[J];this._handlersById[tt].isActive()||(delete this._eventsInProgress[J],$=A[tt]||lt,V[`${J}end`]=$)}for(let J in V)this._fireEvent(J,V[J]);let G=yd(this._eventsInProgress);if(w&&(E||P)&&!G){this._updatingCamera=!0;let J=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),tt=lt=>lt!==0&&-this._bearingSnap<lt&&lt<this._bearingSnap;!J||!J.essential&&n.h.prefersReducedMotion?(this._map.fire(new n.k("moveend",{originalEvent:$})),tt(this._map.getBearing())&&this._map.resetNorth()):(tt(J.bearing||this._map.getBearing())&&(J.bearing=0),J.freezeElevation=!0,this._map.easeTo(J,{originalEvent:$})),this._updatingCamera=!1}}_fireEvent(c,A){this._map.fire(new n.k(c,A?{originalEvent:A}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(c=>{delete this._frameId,this.handleEvent(new fg("renderFrame",{timeStamp:c})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class cy extends n.E{constructor(c,A){super(),this._renderFrameCallback=()=>{let w=Math.min((n.h.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(w)),w<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=c,this._bearingSnap=A.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new n.L(this.transform.center.lng,this.transform.center.lat)}setCenter(c,A){return this.jumpTo({center:c},A)}panBy(c,A,w){return c=n.P.convert(c).mult(-1),this.panTo(this.transform.center,n.e({offset:c},A),w)}panTo(c,A,w){return this.easeTo(n.e({center:c},A),w)}getZoom(){return this.transform.zoom}setZoom(c,A){return this.jumpTo({zoom:c},A),this}zoomTo(c,A,w){return this.easeTo(n.e({zoom:c},A),w)}zoomIn(c,A){return this.zoomTo(this.getZoom()+1,c,A),this}zoomOut(c,A){return this.zoomTo(this.getZoom()-1,c,A),this}getBearing(){return this.transform.bearing}setBearing(c,A){return this.jumpTo({bearing:c},A),this}getPadding(){return this.transform.padding}setPadding(c,A){return this.jumpTo({padding:c},A),this}rotateTo(c,A,w){return this.easeTo(n.e({bearing:c},A),w)}resetNorth(c,A){return this.rotateTo(0,n.e({duration:1e3},c),A),this}resetNorthPitch(c,A){return this.easeTo(n.e({bearing:0,pitch:0,duration:1e3},c),A),this}snapToNorth(c,A){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(c,A):this}getPitch(){return this.transform.pitch}setPitch(c,A){return this.jumpTo({pitch:c},A),this}cameraForBounds(c,A){c=ke.convert(c);let w=A&&A.bearing||0;return this._cameraForBoxAndBearing(c.getNorthWest(),c.getSouthEast(),w,A)}_cameraForBoxAndBearing(c,A,w,E){let P={top:0,bottom:0,right:0,left:0};if(typeof(E=n.e({padding:P,offset:[0,0],maxZoom:this.transform.maxZoom},E)).padding=="number"){let he=E.padding;E.padding={top:he,bottom:he,right:he,left:he}}E.padding=n.e(P,E.padding);let U=this.transform,V=U.padding,$=U.project(n.L.convert(c)),G=U.project(n.L.convert(A)),J=$.rotate(-w*Math.PI/180),tt=G.rotate(-w*Math.PI/180),lt=new n.P(Math.max(J.x,tt.x),Math.max(J.y,tt.y)),wt=new n.P(Math.min(J.x,tt.x),Math.min(J.y,tt.y)),bt=lt.sub(wt),Rt=(U.width-(V.left+V.right+E.padding.left+E.padding.right))/bt.x,yt=(U.height-(V.top+V.bottom+E.padding.top+E.padding.bottom))/bt.y;if(yt<0||Rt<0)return void n.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");let Zt=Math.min(U.scaleZoom(U.scale*Math.min(Rt,yt)),E.maxZoom),se=n.P.convert(E.offset),Bt=new n.P((E.padding.left-E.padding.right)/2,(E.padding.top-E.padding.bottom)/2).rotate(w*Math.PI/180),Gt=se.add(Bt).mult(U.scale/U.zoomScale(Zt));return{center:U.unproject($.add(G).div(2).sub(Gt)),zoom:Zt,bearing:w}}fitBounds(c,A,w){return this._fitInternal(this.cameraForBounds(c,A),A,w)}fitScreenCoordinates(c,A,w,E,P){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(n.P.convert(c)),this.transform.pointLocation(n.P.convert(A)),w,E),E,P)}_fitInternal(c,A,w){return c?(delete(A=n.e(c,A)).padding,A.linear?this.easeTo(A,w):this.flyTo(A,w)):this}jumpTo(c,A){this.stop();let w=this._getTransformForUpdate(),E=!1,P=!1,U=!1;return"zoom"in c&&w.zoom!==+c.zoom&&(E=!0,w.zoom=+c.zoom),c.center!==void 0&&(w.center=n.L.convert(c.center)),"bearing"in c&&w.bearing!==+c.bearing&&(P=!0,w.bearing=+c.bearing),"pitch"in c&&w.pitch!==+c.pitch&&(U=!0,w.pitch=+c.pitch),c.padding==null||w.isPaddingEqual(c.padding)||(w.padding=c.padding),this._applyUpdatedTransform(w),this.fire(new n.k("movestart",A)).fire(new n.k("move",A)),E&&this.fire(new n.k("zoomstart",A)).fire(new n.k("zoom",A)).fire(new n.k("zoomend",A)),P&&this.fire(new n.k("rotatestart",A)).fire(new n.k("rotate",A)).fire(new n.k("rotateend",A)),U&&this.fire(new n.k("pitchstart",A)).fire(new n.k("pitch",A)).fire(new n.k("pitchend",A)),this.fire(new n.k("moveend",A))}calculateCameraOptionsFromTo(c,A,w,E=0){let P=n.U.fromLngLat(c,A),U=n.U.fromLngLat(w,E),V=U.x-P.x,$=U.y-P.y,G=U.z-P.z,J=Math.hypot(V,$,G);if(J===0)throw new Error("Can't calculate camera options with same From and To");let tt=Math.hypot(V,$),lt=this.transform.scaleZoom(this.transform.cameraToCenterDistance/J/this.transform.tileSize),wt=180*Math.atan2(V,-$)/Math.PI,bt=180*Math.acos(tt/J)/Math.PI;return bt=G<0?90-bt:90+bt,{center:U.toLngLat(),zoom:lt,pitch:bt,bearing:wt}}easeTo(c,A){this._stop(!1,c.easeId),((c=n.e({offset:[0,0],duration:500,easing:n.bb},c)).animate===!1||!c.essential&&n.h.prefersReducedMotion)&&(c.duration=0);let w=this._getTransformForUpdate(),E=this.getZoom(),P=this.getBearing(),U=this.getPitch(),V=this.getPadding(),$="zoom"in c?+c.zoom:E,G="bearing"in c?this._normalizeBearing(c.bearing,P):P,J="pitch"in c?+c.pitch:U,tt="padding"in c?c.padding:w.padding,lt=n.P.convert(c.offset),wt=w.centerPoint.add(lt),bt=w.pointLocation(wt),Rt=n.L.convert(c.center||bt);this._normalizeCenter(Rt);let yt=w.project(bt),Zt=w.project(Rt).sub(yt),se=w.zoomScale($-E),Bt,Gt;c.around&&(Bt=n.L.convert(c.around),Gt=w.locationPoint(Bt));let he={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||$!==E,this._rotating=this._rotating||P!==G,this._pitching=this._pitching||J!==U,this._padding=!w.isPaddingEqual(tt),this._easeId=c.easeId,this._prepareEase(A,c.noMoveStart,he),this.terrain&&this._prepareElevation(Rt),this._ease(ce=>{if(this._zooming&&(w.zoom=n.B.number(E,$,ce)),this._rotating&&(w.bearing=n.B.number(P,G,ce)),this._pitching&&(w.pitch=n.B.number(U,J,ce)),this._padding&&(w.interpolatePadding(V,tt,ce),wt=w.centerPoint.add(lt)),this.terrain&&!c.freezeElevation&&this._updateElevation(ce),Bt)w.setLocationAtPoint(Bt,Gt);else{let xe=w.zoomScale(w.zoom-E),Pe=$>E?Math.min(2,se):Math.max(.5,se),Te=Math.pow(Pe,1-ce),Le=w.unproject(yt.add(Zt.mult(ce*Te)).mult(xe));w.setLocationAtPoint(w.renderWorldCopies?Le.wrap():Le,wt)}this._applyUpdatedTransform(w),this._fireMoveEvents(A)},ce=>{this.terrain&&this._finalizeElevation(),this._afterEase(A,ce)},c),this}_prepareEase(c,A,w={}){this._moving=!0,A||w.moving||this.fire(new n.k("movestart",c)),this._zooming&&!w.zooming&&this.fire(new n.k("zoomstart",c)),this._rotating&&!w.rotating&&this.fire(new n.k("rotatestart",c)),this._pitching&&!w.pitching&&this.fire(new n.k("pitchstart",c))}_prepareElevation(c){this._elevationCenter=c,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(c,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(c){this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);let A=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(c<1&&A!==this._elevationTarget){let w=this._elevationTarget-this._elevationStart;this._elevationStart+=c*(w-(A-(w*c+this._elevationStart))/(1-c)),this._elevationTarget=A}this.transform.elevation=n.B.number(this._elevationStart,this._elevationTarget,c)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(c){if(!this.transformCameraUpdate)return;let A=c.clone(),{center:w,zoom:E,pitch:P,bearing:U,elevation:V}=this.transformCameraUpdate(A);w&&(A.center=w),E!==void 0&&(A.zoom=E),P!==void 0&&(A.pitch=P),U!==void 0&&(A.bearing=U),V!==void 0&&(A.elevation=V),this.transform.apply(A)}_fireMoveEvents(c){this.fire(new n.k("move",c)),this._zooming&&this.fire(new n.k("zoom",c)),this._rotating&&this.fire(new n.k("rotate",c)),this._pitching&&this.fire(new n.k("pitch",c))}_afterEase(c,A){if(this._easeId&&A&&this._easeId===A)return;delete this._easeId;let w=this._zooming,E=this._rotating,P=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,w&&this.fire(new n.k("zoomend",c)),E&&this.fire(new n.k("rotateend",c)),P&&this.fire(new n.k("pitchend",c)),this.fire(new n.k("moveend",c))}flyTo(c,A){if(!c.essential&&n.h.prefersReducedMotion){let fr=n.F(c,["center","zoom","bearing","pitch","around"]);return this.jumpTo(fr,A)}this.stop(),c=n.e({offset:[0,0],speed:1.2,curve:1.42,easing:n.bb},c);let w=this._getTransformForUpdate(),E=this.getZoom(),P=this.getBearing(),U=this.getPitch(),V=this.getPadding(),$="zoom"in c?n.ad(+c.zoom,w.minZoom,w.maxZoom):E,G="bearing"in c?this._normalizeBearing(c.bearing,P):P,J="pitch"in c?+c.pitch:U,tt="padding"in c?c.padding:w.padding,lt=w.zoomScale($-E),wt=n.P.convert(c.offset),bt=w.centerPoint.add(wt),Rt=w.pointLocation(bt),yt=n.L.convert(c.center||Rt);this._normalizeCenter(yt);let Zt=w.project(Rt),se=w.project(yt).sub(Zt),Bt=c.curve,Gt=Math.max(w.width,w.height),he=Gt/lt,ce=se.mag();if("minZoom"in c){let fr=n.ad(Math.min(c.minZoom,E,$),w.minZoom,w.maxZoom),dn=Gt/w.zoomScale(fr-E);Bt=Math.sqrt(dn/ce*2)}let xe=Bt*Bt;function Pe(fr){let dn=(he*he-Gt*Gt+(fr?-1:1)*xe*xe*ce*ce)/(2*(fr?he:Gt)*xe*ce);return Math.log(Math.sqrt(dn*dn+1)-dn)}function Te(fr){return(Math.exp(fr)-Math.exp(-fr))/2}function Le(fr){return(Math.exp(fr)+Math.exp(-fr))/2}let hr=Pe(!1),Di=function(fr){return Le(hr)/Le(hr+Bt*fr)},He=function(fr){return Gt*((Le(hr)*(Te(dn=hr+Bt*fr)/Le(dn))-Te(hr))/xe)/ce;var dn},Cr=(Pe(!0)-hr)/Bt;if(Math.abs(ce)<1e-6||!isFinite(Cr)){if(Math.abs(Gt-he)<1e-6)return this.easeTo(c,A);let fr=he<Gt?-1:1;Cr=Math.abs(Math.log(he/Gt))/Bt,He=function(){return 0},Di=function(dn){return Math.exp(fr*Bt*dn)}}return c.duration="duration"in c?+c.duration:1e3*Cr/("screenSpeed"in c?+c.screenSpeed/Bt:+c.speed),c.maxDuration&&c.duration>c.maxDuration&&(c.duration=0),this._zooming=!0,this._rotating=P!==G,this._pitching=J!==U,this._padding=!w.isPaddingEqual(tt),this._prepareEase(A,!1),this.terrain&&this._prepareElevation(yt),this._ease(fr=>{let dn=fr*Cr,Ci=1/Di(dn);w.zoom=fr===1?$:E+w.scaleZoom(Ci),this._rotating&&(w.bearing=n.B.number(P,G,fr)),this._pitching&&(w.pitch=n.B.number(U,J,fr)),this._padding&&(w.interpolatePadding(V,tt,fr),bt=w.centerPoint.add(wt)),this.terrain&&!c.freezeElevation&&this._updateElevation(fr);let fi=fr===1?yt:w.unproject(Zt.add(se.mult(He(dn))).mult(Ci));w.setLocationAtPoint(w.renderWorldCopies?fi.wrap():fi,bt),this._applyUpdatedTransform(w),this._fireMoveEvents(A)},()=>{this.terrain&&this._finalizeElevation(),this._afterEase(A)},c),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(c,A){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){let w=this._onEaseEnd;delete this._onEaseEnd,w.call(this,A)}if(!c){let w=this.handlers;w&&w.stop(!1)}return this}_ease(c,A,w){w.animate===!1||w.duration===0?(c(1),A()):(this._easeStart=n.h.now(),this._easeOptions=w,this._onEaseFrame=c,this._onEaseEnd=A,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(c,A){c=n.b5(c,-180,180);let w=Math.abs(c-A);return Math.abs(c-360-A)<w&&(c-=360),Math.abs(c+360-A)<w&&(c+=360),c}_normalizeCenter(c){let A=this.transform;if(!A.renderWorldCopies||A.lngRange)return;let w=c.lng-A.center.lng;c.lng+=w>180?-360:w<-180?360:0}queryTerrainElevation(c){return this.terrain?this.terrain.getElevationForLngLatZoom(n.L.convert(c),this.transform.tileZoom)-this.transform.elevation:null}}class ka{constructor(c={}){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=A=>{!A||A.sourceDataType!=="metadata"&&A.sourceDataType!=="visibility"&&A.dataType!=="style"&&A.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=c}getDefaultPosition(){return"bottom-right"}onAdd(c){return this._map=c,this._compact=this.options&&this.options.compact,this._container=a.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=a.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=a.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){a.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(c,A){let w=this._map._getUIString(`AttributionControl.${A}`);c.title=w,c.setAttribute("aria-label",w)}_updateAttributions(){if(!this._map.style)return;let c=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?c=c.concat(this.options.customAttribution.map(E=>typeof E!="string"?"":E)):typeof this.options.customAttribution=="string"&&c.push(this.options.customAttribution)),this._map.style.stylesheet){let E=this._map.style.stylesheet;this.styleOwner=E.owner,this.styleId=E.id}let A=this._map.style.sourceCaches;for(let E in A){let P=A[E];if(P.used||P.usedForTerrain){let U=P.getSource();U.attribution&&c.indexOf(U.attribution)<0&&c.push(U.attribution)}}c=c.filter(E=>String(E).trim()),c.sort((E,P)=>E.length-P.length),c=c.filter((E,P)=>{for(let U=P+1;U<c.length;U++)if(c[U].indexOf(E)>=0)return!1;return!0});let w=c.join(" | ");w!==this._attribHTML&&(this._attribHTML=w,c.length?(this._innerContainer.innerHTML=w,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Yn{constructor(c={}){this._updateCompact=()=>{let A=this._container.children;if(A.length){let w=A[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&w.classList.add("maplibregl-compact"):w.classList.remove("maplibregl-compact")}},this.options=c}getDefaultPosition(){return"bottom-left"}onAdd(c){this._map=c,this._compact=this.options&&this.options.compact,this._container=a.create("div","maplibregl-ctrl");let A=a.create("a","maplibregl-ctrl-logo");return A.target="_blank",A.rel="noopener nofollow",A.href="https://maplibre.org/",A.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),A.setAttribute("rel","noopener nofollow"),this._container.appendChild(A),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){a.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class cm{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(c){let A=++this._id;return this._queue.push({callback:c,id:A,cancelled:!1}),A}remove(c){let A=this._currentlyRunning,w=A?this._queue.concat(A):this._queue;for(let E of w)if(E.id===c)return void(E.cancelled=!0)}run(c=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");let A=this._currentlyRunning=this._queue;this._queue=[];for(let w of A)if(!w.cancelled&&(w.callback(c),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}let dg={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"};var uy=n.Q([{name:"a_pos3d",type:"Int16",components:3}]);class hy extends n.E{constructor(c){super(),this.sourceCache=c,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,c.usedForTerrain=!0,c.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(c,A){this.sourceCache.update(c,A),this._renderableTilesKeys=[];let w={};for(let E of c.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:A}))w[E.key]=!0,this._renderableTilesKeys.push(E.key),this._tiles[E.key]||(E.posMatrix=new Float64Array(16),n.aS(E.posMatrix,0,n.N,0,n.N,0,1),this._tiles[E.key]=new fn(E,this.tileSize));for(let E in this._tiles)w[E]||delete this._tiles[E]}freeRtt(c){for(let A in this._tiles){let w=this._tiles[A];(!c||w.tileID.equals(c)||w.tileID.isChildOf(c)||c.isChildOf(w.tileID))&&(w.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(c=>this.getTileByID(c))}getTileByID(c){return this._tiles[c]}getTerrainCoords(c){let A={};for(let w of this._renderableTilesKeys){let E=this._tiles[w].tileID;if(E.canonical.equals(c.canonical)){let P=c.clone();P.posMatrix=new Float64Array(16),n.aS(P.posMatrix,0,n.N,0,n.N,0,1),A[w]=P}else if(E.canonical.isChildOf(c.canonical)){let P=c.clone();P.posMatrix=new Float64Array(16);let U=E.canonical.z-c.canonical.z,V=E.canonical.x-(E.canonical.x>>U<<U),$=E.canonical.y-(E.canonical.y>>U<<U),G=n.N>>U;n.aS(P.posMatrix,0,G,0,G,0,1),n.$(P.posMatrix,P.posMatrix,[-V*G,-$*G,0]),A[w]=P}else if(c.canonical.isChildOf(E.canonical)){let P=c.clone();P.posMatrix=new Float64Array(16);let U=c.canonical.z-E.canonical.z,V=c.canonical.x-(c.canonical.x>>U<<U),$=c.canonical.y-(c.canonical.y>>U<<U),G=n.N>>U;n.aS(P.posMatrix,0,n.N,0,n.N,0,1),n.$(P.posMatrix,P.posMatrix,[V*G,$*G,0]),n.a0(P.posMatrix,P.posMatrix,[1/2**U,1/2**U,0]),A[w]=P}}return A}getSourceTile(c,A){let w=this.sourceCache._source,E=c.overscaledZ-this.deltaZoom;if(E>w.maxzoom&&(E=w.maxzoom),E<w.minzoom)return null;this._sourceTileCache[c.key]||(this._sourceTileCache[c.key]=c.scaledTo(E).key);let P=this.sourceCache.getTileByID(this._sourceTileCache[c.key]);if((!P||!P.dem)&&A)for(;E>=w.minzoom&&(!P||!P.dem);)P=this.sourceCache.getTileByID(c.scaledTo(E--).key);return P}tilesAfterTime(c=Date.now()){return Object.values(this._tiles).filter(A=>A.timeAdded>=c)}}class xd{constructor(c,A,w){this.painter=c,this.sourceCache=new hy(A),this.options=w,this.exaggeration=typeof w.exaggeration=="number"?w.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(c,A,w,E=n.N){var P;if(!(A>=0&&A<E&&w>=0&&w<E))return 0;let U=this.getTerrainData(c),V=(P=U.tile)===null||P===void 0?void 0:P.dem;if(!V)return 0;let $=function(bt,Rt,yt){var Zt=Rt[0],se=Rt[1];return bt[0]=yt[0]*Zt+yt[4]*se+yt[12],bt[1]=yt[1]*Zt+yt[5]*se+yt[13],bt}([],[A/E*n.N,w/E*n.N],U.u_terrain_matrix),G=[$[0]*V.dim,$[1]*V.dim],J=Math.floor(G[0]),tt=Math.floor(G[1]),lt=G[0]-J,wt=G[1]-tt;return V.get(J,tt)*(1-lt)*(1-wt)+V.get(J+1,tt)*lt*(1-wt)+V.get(J,tt+1)*(1-lt)*wt+V.get(J+1,tt+1)*lt*wt}getElevationForLngLatZoom(c,A){let{tileID:w,mercatorX:E,mercatorY:P}=this._getOverscaledTileIDFromLngLatZoom(c,A);return this.getElevation(w,E%n.N,P%n.N,n.N)}getElevation(c,A,w,E=n.N){return this.getDEMElevation(c,A,w,E)*this.exaggeration}getTerrainData(c){if(!this._emptyDemTexture){let E=this.painter.context,P=new n.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new _t(E,P,E.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new _t(E,new n.R({width:1,height:1}),E.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(E.gl.NEAREST,E.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=n.ao([])}let A=this.sourceCache.getSourceTile(c,!0);if(A&&A.dem&&(!A.demTexture||A.needsTerrainPrepare)){let E=this.painter.context;A.demTexture=this.painter.getTileTexture(A.dem.stride),A.demTexture?A.demTexture.update(A.dem.getPixels(),{premultiply:!1}):A.demTexture=new _t(E,A.dem.getPixels(),E.gl.RGBA,{premultiply:!1}),A.demTexture.bind(E.gl.NEAREST,E.gl.CLAMP_TO_EDGE),A.needsTerrainPrepare=!1}let w=A&&A+A.tileID.key+c.key;if(w&&!this._demMatrixCache[w]){let E=this.sourceCache.sourceCache._source.maxzoom,P=c.canonical.z-A.tileID.canonical.z;c.overscaledZ>c.canonical.z&&(c.canonical.z>=E?P=c.canonical.z-E:n.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));let U=c.canonical.x-(c.canonical.x>>P<<P),V=c.canonical.y-(c.canonical.y>>P<<P),$=n.bc(new Float64Array(16),[1/(n.N<<P),1/(n.N<<P),0]);n.$($,$,[U*n.N,V*n.N,0]),this._demMatrixCache[c.key]={matrix:$,coord:c}}return{u_depth:2,u_terrain:3,u_terrain_dim:A&&A.dem&&A.dem.dim||1,u_terrain_matrix:w?this._demMatrixCache[c.key].matrix:this._emptyDemMatrix,u_terrain_unpack:A&&A.dem&&A.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(A&&A.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:A}}getFramebuffer(c){let A=this.painter,w=A.width/devicePixelRatio,E=A.height/devicePixelRatio;return!this._fbo||this._fbo.width===w&&this._fbo.height===E||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new _t(A.context,{width:w,height:E,data:null},A.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(A.context.gl.NEAREST,A.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new _t(A.context,{width:w,height:E,data:null},A.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(A.context.gl.NEAREST,A.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=A.context.createFramebuffer(w,E,!0,!1),this._fbo.depthAttachment.set(A.context.createRenderbuffer(A.context.gl.DEPTH_COMPONENT16,w,E))),this._fbo.colorAttachment.set(c==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){let c=this.painter.context;if(this._coordsTexture)return this._coordsTexture;let A=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let P=0,U=0;P<this._coordsTextureSize;P++)for(let V=0;V<this._coordsTextureSize;V++,U+=4)A[U+0]=255&V,A[U+1]=255&P,A[U+2]=V>>8<<4|P>>8,A[U+3]=0;let w=new n.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(A.buffer)),E=new _t(c,w,c.gl.RGBA,{premultiply:!1});return E.bind(c.gl.NEAREST,c.gl.CLAMP_TO_EDGE),this._coordsTexture=E,E}pointCoordinate(c){let A=new Uint8Array(4),w=this.painter.context,E=w.gl;w.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),E.readPixels(c.x,this.painter.height/devicePixelRatio-c.y-1,1,1,E.RGBA,E.UNSIGNED_BYTE,A),w.bindFramebuffer.set(null);let P=A[0]+(A[2]>>4<<8),U=A[1]+((15&A[2])<<8),V=this.coordsIndex[255-A[3]],$=V&&this.sourceCache.getTileByID(V);if(!$)return null;let G=this._coordsTextureSize,J=(1<<$.tileID.canonical.z)*G;return new n.U(this._allowMercatorOverflow(c,($.tileID.canonical.x*G+P)/J),($.tileID.canonical.y*G+U)/J,this.getElevation($.tileID,P,U,G))}getTerrainMesh(){if(this._mesh)return this._mesh;let c=this.painter.context,A=new n.bd,w=new n.b0,E=this.meshSize,P=n.N/E,U=E*E;for(let tt=0;tt<=E;tt++)for(let lt=0;lt<=E;lt++)A.emplaceBack(lt*P,tt*P,0);for(let tt=0;tt<U;tt+=E+1)for(let lt=0;lt<E;lt++)w.emplaceBack(lt+tt,E+lt+tt+1,E+lt+tt+2),w.emplaceBack(lt+tt,E+lt+tt+2,lt+tt+1);let V=A.length,$=V+2*(E+1);for(let tt of[0,1])for(let lt=0;lt<=E;lt++)for(let wt of[0,1])A.emplaceBack(lt*P,tt*n.N,wt);for(let tt=0;tt<2*E;tt+=2)w.emplaceBack($+tt,$+tt+1,$+tt+3),w.emplaceBack($+tt,$+tt+3,$+tt+2),w.emplaceBack(V+tt,V+tt+3,V+tt+1),w.emplaceBack(V+tt,V+tt+2,V+tt+3);let G=A.length,J=G+2*(E+1);for(let tt of[0,1])for(let lt=0;lt<=E;lt++)for(let wt of[0,1])A.emplaceBack(tt*n.N,lt*P,wt);for(let tt=0;tt<2*E;tt+=2)w.emplaceBack(G+tt,G+tt+1,G+tt+3),w.emplaceBack(G+tt,G+tt+3,G+tt+2),w.emplaceBack(J+tt,J+tt+3,J+tt+1),w.emplaceBack(J+tt,J+tt+2,J+tt+3);return this._mesh={indexBuffer:c.createIndexBuffer(w),vertexBuffer:c.createVertexBuffer(A,uy.members),segments:n.S.simpleSegment(0,0,A.length,w.length)},this._mesh}getMeshFrameDelta(c){return 2*Math.PI*n.be/Math.pow(2,c)/5}getMinTileElevationForLngLatZoom(c,A){var w;let{tileID:E}=this._getOverscaledTileIDFromLngLatZoom(c,A);return(w=this.getMinMaxElevation(E).minElevation)!==null&&w!==void 0?w:0}getMinMaxElevation(c){let A=this.getTerrainData(c).tile,w={minElevation:null,maxElevation:null};return A&&A.dem&&(w.minElevation=A.dem.min*this.exaggeration,w.maxElevation=A.dem.max*this.exaggeration),w}_getOverscaledTileIDFromLngLatZoom(c,A){let w=n.U.fromLngLat(c.wrap()),E=(1<<A)*n.N,P=w.x*E,U=w.y*E,V=Math.floor(P/n.N),$=Math.floor(U/n.N);return{tileID:new n.O(A,0,A,V,$),mercatorX:P,mercatorY:U}}_allowMercatorOverflow(c,A){let w=c.x<this.painter.width/2,E=n.bf(A),P=this.painter.transform.center.lng;return w&&Math.sign(E)>0&&Math.sign(P)<0||!w&&Math.sign(E)<0&&Math.sign(P)>0?(E=360*Math.sign(P)+E,n.G(E)):A}}class jb{constructor(c,A,w){this._context=c,this._size=A,this._tileSize=w,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(let c of this._objects)c.texture.destroy(),c.fbo.destroy()}_createObject(c){let A=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),w=new _t(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return w.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),A.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),A.colorAttachment.set(w.texture),{id:c,fbo:A,texture:w,stamp:-1,inUse:!1}}getObjectForId(c){return this._objects[c]}useObject(c){c.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(A=>c.id!==A),this._recentlyUsed.push(c.id)}stampObject(c){c.stamp=++this._stamp}getOrCreateFreeObject(){for(let A of this._recentlyUsed)if(!this._objects[A].inUse)return this._objects[A];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");let c=this._createObject(this._objects.length);return this._objects.push(c),c}freeObject(c){c.inUse=!1}freeAllObjects(){for(let c of this._objects)this.freeObject(c)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(c=>!c.inUse)===!1}}let Ko={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class um{constructor(c,A){this.painter=c,this.terrain=A,this.pool=new jb(c.context,30,A.sourceCache.tileSize*A.qualityFactor)}destruct(){this.pool.destruct()}getTexture(c){return this.pool.getObjectForId(c.rtt[this._stacks.length-1].id).texture}prepareForRender(c,A){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=c._order.filter(w=>!c._layers[w].isHidden(A)),this._coordsDescendingInv={};for(let w in c.sourceCaches){this._coordsDescendingInv[w]={};let E=c.sourceCaches[w].getVisibleCoordinates();for(let P of E){let U=this.terrain.sourceCache.getTerrainCoords(P);for(let V in U)this._coordsDescendingInv[w][V]||(this._coordsDescendingInv[w][V]=[]),this._coordsDescendingInv[w][V].push(U[V])}}this._coordsDescendingInvStr={};for(let w of c._order){let E=c._layers[w],P=E.source;if(Ko[E.type]&&!this._coordsDescendingInvStr[P]){this._coordsDescendingInvStr[P]={};for(let U in this._coordsDescendingInv[P])this._coordsDescendingInvStr[P][U]=this._coordsDescendingInv[P][U].map(V=>V.key).sort().join()}}for(let w of this._renderableTiles)for(let E in this._coordsDescendingInvStr){let P=this._coordsDescendingInvStr[E][w.tileID.key];P&&P!==w.rttCoords[E]&&(w.rtt=[])}}renderLayer(c){if(c.isHidden(this.painter.transform.zoom))return!1;let A=c.type,w=this.painter,E=this._renderableLayerIds[this._renderableLayerIds.length-1]===c.id;if(Ko[A]&&(this._prevType&&Ko[this._prevType]||this._stacks.push([]),this._prevType=A,this._stacks[this._stacks.length-1].push(c.id),!E))return!0;if(Ko[this._prevType]||Ko[A]&&E){this._prevType=A;let P=this._stacks.length-1,U=this._stacks[P]||[];for(let V of this._renderableTiles){if(this.pool.isFull()&&(fs(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(V),V.rtt[P]){let G=this.pool.getObjectForId(V.rtt[P].id);if(G.stamp===V.rtt[P].stamp){this.pool.useObject(G);continue}}let $=this.pool.getOrCreateFreeObject();this.pool.useObject($),this.pool.stampObject($),V.rtt[P]={id:$.id,stamp:$.stamp},w.context.bindFramebuffer.set($.fbo.framebuffer),w.context.clear({color:n.aT.transparent,stencil:0}),w.currentStencilSource=void 0;for(let G=0;G<U.length;G++){let J=w.style._layers[U[G]],tt=J.source?this._coordsDescendingInv[J.source][V.tileID.key]:[V.tileID];w.context.viewport.set([0,0,$.fbo.width,$.fbo.height]),w._renderTileClippingMasks(J,tt),w.renderLayer(w,w.style.sourceCaches[J.source],J,tt),J.source&&(V.rttCoords[J.source]=this._coordsDescendingInvStr[J.source][V.tileID.key])}}return fs(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),Ko[A]}return!1}}let ur=o,Dr={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:n.c.MAX_TILE_CACHE_ZOOM_LEVELS,localIdeographFontFamily:"sans-serif",transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,validateStyle:!0,maxCanvasSize:[4096,4096]},Lh=M=>{M.touchstart=M.dragStart,M.touchmoveWindow=M.dragMove,M.touchend=M.dragEnd},hm={showCompass:!0,showZoom:!0,visualizePitch:!1};class Nu{constructor(c,A,w=!1){this.mousedown=U=>{this.startMouse(n.e({},U,{ctrlKey:!0,preventDefault:()=>U.preventDefault()}),a.mousePos(this.element,U)),a.addEventListener(window,"mousemove",this.mousemove),a.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=U=>{this.moveMouse(U,a.mousePos(this.element,U))},this.mouseup=U=>{this.mouseRotate.dragEnd(U),this.mousePitch&&this.mousePitch.dragEnd(U),this.offTemp()},this.touchstart=U=>{U.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=a.touchPos(this.element,U.targetTouches)[0],this.startTouch(U,this._startPos),a.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),a.addEventListener(window,"touchend",this.touchend))},this.touchmove=U=>{U.targetTouches.length!==1?this.reset():(this._lastPos=a.touchPos(this.element,U.targetTouches)[0],this.moveTouch(U,this._lastPos))},this.touchend=U=>{U.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;let E=c.dragRotate._mouseRotate.getClickTolerance(),P=c.dragRotate._mousePitch.getClickTolerance();this.element=A,this.mouseRotate=zf({clickTolerance:E,enable:!0}),this.touchRotate=(({enable:U,clickTolerance:V,bearingDegreesPerPixelMoved:$=.8})=>{let G=new ag;return new Jc({clickTolerance:V,move:(J,tt)=>({bearingDelta:(tt.x-J.x)*$}),moveStateManager:G,enable:U,assignEvents:Lh})})({clickTolerance:E,enable:!0}),this.map=c,w&&(this.mousePitch=tu({clickTolerance:P,enable:!0}),this.touchPitch=(({enable:U,clickTolerance:V,pitchDegreesPerPixelMoved:$=-.5})=>{let G=new ag;return new Jc({clickTolerance:V,move:(J,tt)=>({pitchDelta:(tt.y-J.y)*$}),moveStateManager:G,enable:U,assignEvents:Lh})})({clickTolerance:P,enable:!0})),a.addEventListener(A,"mousedown",this.mousedown),a.addEventListener(A,"touchstart",this.touchstart,{passive:!1}),a.addEventListener(A,"touchcancel",this.reset)}startMouse(c,A){this.mouseRotate.dragStart(c,A),this.mousePitch&&this.mousePitch.dragStart(c,A),a.disableDrag()}startTouch(c,A){this.touchRotate.dragStart(c,A),this.touchPitch&&this.touchPitch.dragStart(c,A),a.disableDrag()}moveMouse(c,A){let w=this.map,{bearingDelta:E}=this.mouseRotate.dragMove(c,A)||{};if(E&&w.setBearing(w.getBearing()+E),this.mousePitch){let{pitchDelta:P}=this.mousePitch.dragMove(c,A)||{};P&&w.setPitch(w.getPitch()+P)}}moveTouch(c,A){let w=this.map,{bearingDelta:E}=this.touchRotate.dragMove(c,A)||{};if(E&&w.setBearing(w.getBearing()+E),this.touchPitch){let{pitchDelta:P}=this.touchPitch.dragMove(c,A)||{};P&&w.setPitch(w.getPitch()+P)}}off(){let c=this.element;a.removeEventListener(c,"mousedown",this.mousedown),a.removeEventListener(c,"touchstart",this.touchstart,{passive:!1}),a.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),a.removeEventListener(window,"touchend",this.touchend),a.removeEventListener(c,"touchcancel",this.reset),this.offTemp()}offTemp(){a.enableDrag(),a.removeEventListener(window,"mousemove",this.mousemove),a.removeEventListener(window,"mouseup",this.mouseup),a.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),a.removeEventListener(window,"touchend",this.touchend)}}let Ds;function bd(M,c,A){if(M=new n.L(M.lng,M.lat),c){let w=new n.L(M.lng-360,M.lat),E=new n.L(M.lng+360,M.lat),P=A.locationPoint(M).distSqr(c);A.locationPoint(w).distSqr(c)<P?M=w:A.locationPoint(E).distSqr(c)<P&&(M=E)}for(;Math.abs(M.lng-A.center.lng)>180;){let w=A.locationPoint(M);if(w.x>=0&&w.y>=0&&w.x<=A.width&&w.y<=A.height)break;M.lng>A.center.lng?M.lng-=360:M.lng+=360}return M}let Da={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function fy(M,c,A){let w=M.classList;for(let E in Da)w.remove(`maplibregl-${A}-anchor-${E}`);w.add(`maplibregl-${A}-anchor-${c}`)}class Lu extends n.E{constructor(c){if(super(),this._onKeyPress=A=>{let w=A.code,E=A.charCode||A.keyCode;w!=="Space"&&w!=="Enter"&&E!==32&&E!==13||this.togglePopup()},this._onMapClick=A=>{let w=A.originalEvent.target,E=this._element;this._popup&&(w===E||E.contains(w))&&this.togglePopup()},this._update=A=>{if(!this._map)return;let w=this._map.loaded()&&!this._map.isMoving();(A?.type==="terrain"||A?.type==="render"&&!w)&&this._map.once("render",this._update),this._map.transform.renderWorldCopies&&(this._lngLat=bd(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let E="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?E=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(E=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let P="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?P="rotateX(0deg)":this._pitchAlignment==="map"&&(P=`rotateX(${this._map.getPitch()}deg)`),A&&A.type!=="moveend"||(this._pos=this._pos.round()),a.setTransform(this._element,`${Da[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${P} ${E}`),this._map.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout(()=>{let U=this._map.unproject(this._pos),V=40075016686e-3*Math.abs(Math.cos(this._lngLat.lat*Math.PI/180))/Math.pow(2,this._map.transform.tileZoom+8);this._element.style.opacity=U.distanceTo(this._lngLat)>20*V?"0.2":"1.0",this._opacityTimeout=null},100))},this._onMove=A=>{if(!this._isDragging){let w=this._clickTolerance||this._map._clickTolerance;this._isDragging=A.point.dist(this._pointerdownPos)>=w}this._isDragging&&(this._pos=A.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new n.k("dragstart"))),this.fire(new n.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new n.k("dragend")),this._state="inactive"},this._addDragHandler=A=>{this._element.contains(A.originalEvent.target)&&(A.preventDefault(),this._positionDelta=A.point.sub(this._pos).add(this._offset),this._pointerdownPos=A.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=c&&c.anchor||"center",this._color=c&&c.color||"#3FB1CE",this._scale=c&&c.scale||1,this._draggable=c&&c.draggable||!1,this._clickTolerance=c&&c.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=c&&c.rotation||0,this._rotationAlignment=c&&c.rotationAlignment||"auto",this._pitchAlignment=c&&c.pitchAlignment&&c.pitchAlignment!=="auto"?c.pitchAlignment:this._rotationAlignment,c&&c.element)this._element=c.element,this._offset=n.P.convert(c&&c.offset||[0,0]);else{this._defaultMarker=!0,this._element=a.create("div"),this._element.setAttribute("aria-label","Map marker");let A=a.createNS("http://www.w3.org/2000/svg","svg"),w=41,E=27;A.setAttributeNS(null,"display","block"),A.setAttributeNS(null,"height",`${w}px`),A.setAttributeNS(null,"width",`${E}px`),A.setAttributeNS(null,"viewBox",`0 0 ${E} ${w}`);let P=a.createNS("http://www.w3.org/2000/svg","g");P.setAttributeNS(null,"stroke","none"),P.setAttributeNS(null,"stroke-width","1"),P.setAttributeNS(null,"fill","none"),P.setAttributeNS(null,"fill-rule","evenodd");let U=a.createNS("http://www.w3.org/2000/svg","g");U.setAttributeNS(null,"fill-rule","nonzero");let V=a.createNS("http://www.w3.org/2000/svg","g");V.setAttributeNS(null,"transform","translate(3.0, 29.0)"),V.setAttributeNS(null,"fill","#000000");let $=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(let Zt of $){let se=a.createNS("http://www.w3.org/2000/svg","ellipse");se.setAttributeNS(null,"opacity","0.04"),se.setAttributeNS(null,"cx","10.5"),se.setAttributeNS(null,"cy","5.80029008"),se.setAttributeNS(null,"rx",Zt.rx),se.setAttributeNS(null,"ry",Zt.ry),V.appendChild(se)}let G=a.createNS("http://www.w3.org/2000/svg","g");G.setAttributeNS(null,"fill",this._color);let J=a.createNS("http://www.w3.org/2000/svg","path");J.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),G.appendChild(J);let tt=a.createNS("http://www.w3.org/2000/svg","g");tt.setAttributeNS(null,"opacity","0.25"),tt.setAttributeNS(null,"fill","#000000");let lt=a.createNS("http://www.w3.org/2000/svg","path");lt.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),tt.appendChild(lt);let wt=a.createNS("http://www.w3.org/2000/svg","g");wt.setAttributeNS(null,"transform","translate(6.0, 7.0)"),wt.setAttributeNS(null,"fill","#FFFFFF");let bt=a.createNS("http://www.w3.org/2000/svg","g");bt.setAttributeNS(null,"transform","translate(8.0, 8.0)");let Rt=a.createNS("http://www.w3.org/2000/svg","circle");Rt.setAttributeNS(null,"fill","#000000"),Rt.setAttributeNS(null,"opacity","0.25"),Rt.setAttributeNS(null,"cx","5.5"),Rt.setAttributeNS(null,"cy","5.5"),Rt.setAttributeNS(null,"r","5.4999962");let yt=a.createNS("http://www.w3.org/2000/svg","circle");yt.setAttributeNS(null,"fill","#FFFFFF"),yt.setAttributeNS(null,"cx","5.5"),yt.setAttributeNS(null,"cy","5.5"),yt.setAttributeNS(null,"r","5.4999962"),bt.appendChild(Rt),bt.appendChild(yt),U.appendChild(V),U.appendChild(G),U.appendChild(tt),U.appendChild(wt),U.appendChild(bt),A.appendChild(U),A.setAttributeNS(null,"height",w*this._scale+"px"),A.setAttributeNS(null,"width",E*this._scale+"px"),this._element.appendChild(A),this._offset=n.P.convert(c&&c.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",A=>{A.preventDefault()}),this._element.addEventListener("mousedown",A=>{A.preventDefault()}),fy(this._element,this._anchor,"marker"),c&&c.className)for(let A of c.className.split(" "))this._element.classList.add(A);this._popup=null}addTo(c){return this.remove(),this._map=c,c.getCanvasContainer().appendChild(this._element),c.on("move",this._update),c.on("moveend",this._update),c.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),a.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(c){return this._lngLat=n.L.convert(c),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(c){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),c){if(!("offset"in c.options)){let E=Math.abs(13.5)/Math.SQRT2;c.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[E,-1*(38.1-13.5+E)],"bottom-right":[-E,-1*(38.1-13.5+E)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=c,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}getPopup(){return this._popup}togglePopup(){let c=this._popup;return c?(c.isOpen()?c.remove():c.addTo(this._map),this):this}getOffset(){return this._offset}setOffset(c){return this._offset=n.P.convert(c),this._update(),this}addClassName(c){this._element.classList.add(c)}removeClassName(c){this._element.classList.remove(c)}toggleClassName(c){return this._element.classList.toggle(c)}setDraggable(c){return this._draggable=!!c,this._map&&(c?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(c){return this._rotation=c||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(c){return this._rotationAlignment=c||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(c){return this._pitchAlignment=c&&c!=="auto"?c:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}let Kn={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},Xn=0,ru=!1,Sn={maxWidth:100,unit:"metric"};function vd(M,c,A){let w=A&&A.maxWidth||100,E=M._container.clientHeight/2,P=M.unproject([0,E]),U=M.unproject([w,E]),V=P.distanceTo(U);if(A&&A.unit==="imperial"){let $=3.2808*V;$>5280?Fh(c,w,$/5280,M._getUIString("ScaleControl.Miles")):Fh(c,w,$,M._getUIString("ScaleControl.Feet"))}else A&&A.unit==="nautical"?Fh(c,w,V/1852,M._getUIString("ScaleControl.NauticalMiles")):V>=1e3?Fh(c,w,V/1e3,M._getUIString("ScaleControl.Kilometers")):Fh(c,w,V,M._getUIString("ScaleControl.Meters"))}function Fh(M,c,A,w){let E=function(P){let U=Math.pow(10,`${Math.floor(P)}`.length-1),V=P/U;return V=V>=10?10:V>=5?5:V>=3?3:V>=2?2:V>=1?1:function($){let G=Math.pow(10,Math.ceil(-Math.log($)/Math.LN10));return Math.round($*G)/G}(V),U*V}(A);M.style.width=c*(E/A)+"px",M.innerHTML=`${E}&nbsp;${w}`}let mg={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Ag=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function jf(M){if(M){if(typeof M=="number"){let c=Math.round(Math.abs(M)/Math.SQRT2);return{center:new n.P(0,0),top:new n.P(0,M),"top-left":new n.P(c,c),"top-right":new n.P(-c,c),bottom:new n.P(0,-M),"bottom-left":new n.P(c,-c),"bottom-right":new n.P(-c,-c),left:new n.P(M,0),right:new n.P(-M,0)}}if(M instanceof n.P||Array.isArray(M)){let c=n.P.convert(M);return{center:c,top:c,"top-left":c,"top-right":c,bottom:c,"bottom-left":c,"bottom-right":c,left:c,right:c}}return{center:n.P.convert(M.center||[0,0]),top:n.P.convert(M.top||[0,0]),"top-left":n.P.convert(M["top-left"]||[0,0]),"top-right":n.P.convert(M["top-right"]||[0,0]),bottom:n.P.convert(M.bottom||[0,0]),"bottom-left":n.P.convert(M["bottom-left"]||[0,0]),"bottom-right":n.P.convert(M["bottom-right"]||[0,0]),left:n.P.convert(M.left||[0,0]),right:n.P.convert(M.right||[0,0])}}return jf(new n.P(0,0))}let gg={extend:(M,...c)=>n.e(M,...c),run(M){M()},logToElement(M,c=!1,A="log"){let w=window.document.getElementById(A);w&&(c&&(w.innerHTML=""),w.innerHTML+=`<br>${M}`)}},_g=o;class si{static get version(){return _g}static get workerCount(){return zo.workerCount}static set workerCount(c){zo.workerCount=c}static get maxParallelImageRequests(){return n.c.MAX_PARALLEL_IMAGE_REQUESTS}static set maxParallelImageRequests(c){n.c.MAX_PARALLEL_IMAGE_REQUESTS=c}static get workerUrl(){return n.c.WORKER_URL}static set workerUrl(c){n.c.WORKER_URL=c}static addProtocol(c,A){n.c.REGISTERED_PROTOCOLS[c]=A}static removeProtocol(c){delete n.c.REGISTERED_PROTOCOLS[c]}}return si.Map=class extends cy{constructor(M){if(n.bg.mark(n.bh.create),(M=n.e({},Dr,M)).minZoom!=null&&M.maxZoom!=null&&M.minZoom>M.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(M.minPitch!=null&&M.maxPitch!=null&&M.minPitch>M.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(M.minPitch!=null&&M.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(M.maxPitch!=null&&M.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new Ad(M.minZoom,M.maxZoom,M.minPitch,M.maxPitch,M.renderWorldCopies),{bearingSnap:M.bearingSnap}),this._cooperativeGesturesOnWheel=c=>{this._onCooperativeGesture(c,c[this._metaKey],1)},this._contextLost=c=>{c.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new n.k("webglcontextlost",{originalEvent:c}))},this._contextRestored=c=>{this._setupPainter(),this.resize(),this._update(),this.fire(new n.k("webglcontextrestored",{originalEvent:c}))},this._onMapScroll=c=>{if(c.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=M.interactive,this._cooperativeGestures=M.cooperativeGestures,this._metaKey=navigator.platform.indexOf("Mac")===0?"metaKey":"ctrlKey",this._maxTileCacheSize=M.maxTileCacheSize,this._maxTileCacheZoomLevels=M.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=M.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=M.preserveDrawingBuffer,this._antialias=M.antialias,this._trackResize=M.trackResize,this._bearingSnap=M.bearingSnap,this._refreshExpiredTiles=M.refreshExpiredTiles,this._fadeDuration=M.fadeDuration,this._crossSourceCollisions=M.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=M.collectResourceTiming,this._renderTaskQueue=new cm,this._controls=[],this._mapId=n.a2(),this._locale=n.e({},dg,M.locale),this._clickTolerance=M.clickTolerance,this._overridePixelRatio=M.pixelRatio,this._maxCanvasSize=M.maxCanvasSize,this.transformCameraUpdate=M.transformCameraUpdate,this._imageQueueHandle=B.addThrottleControl(()=>this.isMoving()),this._requestManager=new z(M.transformRequest),typeof M.container=="string"){if(this._container=document.getElementById(M.container),!this._container)throw new Error(`Container '${M.container}' not found.`)}else{if(!(M.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=M.container}if(M.maxBounds&&this.setMaxBounds(M.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let c=!1,A=Du(w=>{this._trackResize&&!this._removed&&this.resize(w)._update()},50);this._resizeObserver=new ResizeObserver(w=>{c?A(w):c=!0}),this._resizeObserver.observe(this._container)}this.handlers=new pg(this,M),this._cooperativeGestures&&this._setupCooperativeGestures(),this._hash=M.hash&&new Lf(typeof M.hash=="string"&&M.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:M.center,zoom:M.zoom,bearing:M.bearing,pitch:M.pitch}),M.bounds&&(this.resize(),this.fitBounds(M.bounds,n.e({},M.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=M.localIdeographFontFamily,this._validateStyle=M.validateStyle,M.style&&this.setStyle(M.style,{localIdeographFontFamily:M.localIdeographFontFamily}),M.attributionControl&&this.addControl(new ka({customAttribution:M.customAttribution})),M.maplibreLogo&&this.addControl(new Yn,M.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",c=>{this._update(c.dataType==="style"),this.fire(new n.k(`${c.dataType}data`,c))}),this.on("dataloading",c=>{this.fire(new n.k(`${c.dataType}dataloading`,c))}),this.on("dataabort",c=>{this.fire(new n.k("sourcedataabort",c))})}_getMapId(){return this._mapId}addControl(M,c){if(c===void 0&&(c=M.getDefaultPosition?M.getDefaultPosition():"top-right"),!M||!M.onAdd)return this.fire(new n.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));let A=M.onAdd(this);this._controls.push(M);let w=this._controlPositions[c];return c.indexOf("bottom")!==-1?w.insertBefore(A,w.firstChild):w.appendChild(A),this}removeControl(M){if(!M||!M.onRemove)return this.fire(new n.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));let c=this._controls.indexOf(M);return c>-1&&this._controls.splice(c,1),M.onRemove(this),this}hasControl(M){return this._controls.indexOf(M)>-1}calculateCameraOptionsFromTo(M,c,A,w){return w==null&&this.terrain&&(w=this.terrain.getElevationForLngLatZoom(A,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(M,c,A,w)}resize(M){var c;let A=this._containerDimensions(),w=A[0],E=A[1],P=this._getClampedPixelRatio(w,E);if(this._resizeCanvas(w,E,P),this.painter.resize(w,E,P),this.painter.overLimit()){let V=this.painter.context.gl;this._maxCanvasSize=[V.drawingBufferWidth,V.drawingBufferHeight];let $=this._getClampedPixelRatio(w,E);this._resizeCanvas(w,E,$),this.painter.resize(w,E,$)}this.transform.resize(w,E),(c=this._requestedCameraState)===null||c===void 0||c.resize(w,E);let U=!this._moving;return U&&(this.stop(),this.fire(new n.k("movestart",M)).fire(new n.k("move",M))),this.fire(new n.k("resize",M)),U&&this.fire(new n.k("moveend",M)),this}_getClampedPixelRatio(M,c){let{0:A,1:w}=this._maxCanvasSize,E=this.getPixelRatio(),P=M*E,U=c*E;return Math.min(P>A?A/P:1,U>w?w/U:1)*E}getPixelRatio(){var M;return(M=this._overridePixelRatio)!==null&&M!==void 0?M:devicePixelRatio}setPixelRatio(M){this._overridePixelRatio=M,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(M){return this.transform.setMaxBounds(ke.convert(M)),this._update()}setMinZoom(M){if((M=M??-2)>=-2&&M<=this.transform.maxZoom)return this.transform.minZoom=M,this._update(),this.getZoom()<M&&this.setZoom(M),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(M){if((M=M??22)>=this.transform.minZoom)return this.transform.maxZoom=M,this._update(),this.getZoom()>M&&this.setZoom(M),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(M){if((M=M??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(M>=0&&M<=this.transform.maxPitch)return this.transform.minPitch=M,this._update(),this.getPitch()<M&&this.setPitch(M),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(M){if((M=M??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(M>=this.transform.minPitch)return this.transform.maxPitch=M,this._update(),this.getPitch()>M&&this.setPitch(M),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(M){return this.transform.renderWorldCopies=M,this._update()}getCooperativeGestures(){return this._cooperativeGestures}setCooperativeGestures(M){return this._cooperativeGestures=M,this._cooperativeGestures?this._setupCooperativeGestures():this._destroyCooperativeGestures(),this}project(M){return this.transform.locationPoint(n.L.convert(M),this.style&&this.terrain)}unproject(M){return this.transform.pointLocation(n.P.convert(M),this.terrain)}isMoving(){var M;return this._moving||((M=this.handlers)===null||M===void 0?void 0:M.isMoving())}isZooming(){var M;return this._zooming||((M=this.handlers)===null||M===void 0?void 0:M.isZooming())}isRotating(){var M;return this._rotating||((M=this.handlers)===null||M===void 0?void 0:M.isRotating())}_createDelegatedListener(M,c,A){if(M==="mouseenter"||M==="mouseover"){let w=!1;return{layer:c,listener:A,delegates:{mousemove:P=>{let U=this.getLayer(c)?this.queryRenderedFeatures(P.point,{layers:[c]}):[];U.length?w||(w=!0,A.call(this,new Pa(M,this,P.originalEvent,{features:U}))):w=!1},mouseout:()=>{w=!1}}}}if(M==="mouseleave"||M==="mouseout"){let w=!1;return{layer:c,listener:A,delegates:{mousemove:U=>{(this.getLayer(c)?this.queryRenderedFeatures(U.point,{layers:[c]}):[]).length?w=!0:w&&(w=!1,A.call(this,new Pa(M,this,U.originalEvent)))},mouseout:U=>{w&&(w=!1,A.call(this,new Pa(M,this,U.originalEvent)))}}}}{let w=E=>{let P=this.getLayer(c)?this.queryRenderedFeatures(E.point,{layers:[c]}):[];P.length&&(E.features=P,A.call(this,E),delete E.features)};return{layer:c,listener:A,delegates:{[M]:w}}}}on(M,c,A){if(A===void 0)return super.on(M,c);let w=this._createDelegatedListener(M,c,A);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[M]=this._delegatedListeners[M]||[],this._delegatedListeners[M].push(w);for(let E in w.delegates)this.on(E,w.delegates[E]);return this}once(M,c,A){if(A===void 0)return super.once(M,c);let w=this._createDelegatedListener(M,c,A);for(let E in w.delegates)this.once(E,w.delegates[E]);return this}off(M,c,A){return A===void 0?super.off(M,c):(this._delegatedListeners&&this._delegatedListeners[M]&&(w=>{let E=this._delegatedListeners[M];for(let P=0;P<E.length;P++){let U=E[P];if(U.layer===c&&U.listener===A){for(let V in U.delegates)this.off(V,U.delegates[V]);return E.splice(P,1),this}}})(),this)}queryRenderedFeatures(M,c){if(!this.style)return[];let A,w=M instanceof n.P||Array.isArray(M),E=w?M:[[0,0],[this.transform.width,this.transform.height]];if(c=c||(w?{}:M)||{},E instanceof n.P||typeof E[0]=="number")A=[n.P.convert(E)];else{let P=n.P.convert(E[0]),U=n.P.convert(E[1]);A=[P,new n.P(U.x,P.y),U,new n.P(P.x,U.y),P]}return this.style.queryRenderedFeatures(A,c,this.transform)}querySourceFeatures(M,c){return this.style.querySourceFeatures(M,c)}setStyle(M,c){return(c=n.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},c)).diff!==!1&&c.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&M?(this._diffStyle(M,c),this):(this._localIdeographFontFamily=c.localIdeographFontFamily,this._updateStyle(M,c))}setTransformRequest(M){return this._requestManager.setTransformRequest(M),this}_getUIString(M){let c=this._locale[M];if(c==null)throw new Error(`Missing UI string '${M}'`);return c}_updateStyle(M,c){if(c.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(M,c));let A=this.style&&c.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!M)),M?(this.style=new Rs(this,c||{}),this.style.setEventedParent(this,{style:this.style}),typeof M=="string"?this.style.loadURL(M,c,A):this.style.loadJSON(M,c,A),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Rs(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(M,c){if(typeof M=="string"){let A=this._requestManager.transformRequest(M,L.Style);n.f(A,(w,E)=>{w?this.fire(new n.j(w)):E&&this._updateDiff(E,c)})}else typeof M=="object"&&this._updateDiff(M,c)}_updateDiff(M,c){try{this.style.setState(M,c)&&this._update(!0)}catch(A){n.w(`Unable to perform style diff: ${A.message||A.error||A}.  Rebuilding the style from scratch.`),this._updateStyle(M,c)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():n.w("There is no style added to the map.")}addSource(M,c){return this._lazyInitEmptyStyle(),this.style.addSource(M,c),this._update(!0)}isSourceLoaded(M){let c=this.style&&this.style.sourceCaches[M];if(c!==void 0)return c.loaded();this.fire(new n.j(new Error(`There is no source with ID '${M}'`)))}setTerrain(M){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),M){let c=this.style.sourceCaches[M.source];if(!c)throw new Error(`cannot load terrain, because there exists no source with ID: ${M.source}`);for(let A in this.style._layers){let w=this.style._layers[A];w.type==="hillshade"&&w.source===M.source&&n.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new xd(this.painter,c,M),this.painter.renderToTexture=new um(this.painter,this.terrain),this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=A=>{A.dataType==="style"?this.terrain.sourceCache.freeRtt():A.dataType==="source"&&A.tile&&(A.sourceId!==M.source||this._elevationFreeze||(this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(A.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform._minEleveationForCurrentTile=0,this.transform.elevation=0;return this.fire(new n.k("terrain",{terrain:M})),this}getTerrain(){var M,c;return(c=(M=this.terrain)===null||M===void 0?void 0:M.options)!==null&&c!==void 0?c:null}areTilesLoaded(){let M=this.style&&this.style.sourceCaches;for(let c in M){let A=M[c]._tiles;for(let w in A){let E=A[w];if(E.state!=="loaded"&&E.state!=="errored")return!1}}return!0}addSourceType(M,c,A){return this._lazyInitEmptyStyle(),this.style.addSourceType(M,c,A)}removeSource(M){return this.style.removeSource(M),this._update(!0)}getSource(M){return this.style.getSource(M)}addImage(M,c,A={}){let{pixelRatio:w=1,sdf:E=!1,stretchX:P,stretchY:U,content:V}=A;if(this._lazyInitEmptyStyle(),!(c instanceof HTMLImageElement||n.a(c))){if(c.width===void 0||c.height===void 0)return this.fire(new n.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{let{width:$,height:G,data:J}=c,tt=c;return this.style.addImage(M,{data:new n.R({width:$,height:G},new Uint8Array(J)),pixelRatio:w,stretchX:P,stretchY:U,content:V,sdf:E,version:0,userImage:tt}),tt.onAdd&&tt.onAdd(this,M),this}}{let{width:$,height:G,data:J}=n.h.getImageData(c);this.style.addImage(M,{data:new n.R({width:$,height:G},J),pixelRatio:w,stretchX:P,stretchY:U,content:V,sdf:E,version:0})}}updateImage(M,c){let A=this.style.getImage(M);if(!A)return this.fire(new n.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));let w=c instanceof HTMLImageElement||n.a(c)?n.h.getImageData(c):c,{width:E,height:P,data:U}=w;if(E===void 0||P===void 0)return this.fire(new n.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(E!==A.data.width||P!==A.data.height)return this.fire(new n.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));let V=!(c instanceof HTMLImageElement||n.a(c));return A.data.replace(U,V),this.style.updateImage(M,A),this}getImage(M){return this.style.getImage(M)}hasImage(M){return M?!!this.style.getImage(M):(this.fire(new n.j(new Error("Missing required image id"))),!1)}removeImage(M){this.style.removeImage(M)}loadImage(M,c){B.getImage(this._requestManager.transformRequest(M,L.Image),c)}listImages(){return this.style.listImages()}addLayer(M,c){return this._lazyInitEmptyStyle(),this.style.addLayer(M,c),this._update(!0)}moveLayer(M,c){return this.style.moveLayer(M,c),this._update(!0)}removeLayer(M){return this.style.removeLayer(M),this._update(!0)}getLayer(M){return this.style.getLayer(M)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(M,c,A){return this.style.setLayerZoomRange(M,c,A),this._update(!0)}setFilter(M,c,A={}){return this.style.setFilter(M,c,A),this._update(!0)}getFilter(M){return this.style.getFilter(M)}setPaintProperty(M,c,A,w={}){return this.style.setPaintProperty(M,c,A,w),this._update(!0)}getPaintProperty(M,c){return this.style.getPaintProperty(M,c)}setLayoutProperty(M,c,A,w={}){return this.style.setLayoutProperty(M,c,A,w),this._update(!0)}getLayoutProperty(M,c){return this.style.getLayoutProperty(M,c)}setGlyphs(M,c={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(M,c),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(M,c,A={}){return this._lazyInitEmptyStyle(),this.style.addSprite(M,c,A,w=>{w||this._update(!0)}),this}removeSprite(M){return this._lazyInitEmptyStyle(),this.style.removeSprite(M),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(M,c={}){return this._lazyInitEmptyStyle(),this.style.setSprite(M,c,A=>{A||this._update(!0)}),this}setLight(M,c={}){return this._lazyInitEmptyStyle(),this.style.setLight(M,c),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(M,c){return this.style.setFeatureState(M,c),this._update()}removeFeatureState(M,c){return this.style.removeFeatureState(M,c),this._update()}getFeatureState(M){return this.style.getFeatureState(M)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let M=0,c=0;return this._container&&(M=this._container.clientWidth||400,c=this._container.clientHeight||300),[M,c]}_setupContainer(){let M=this._container;M.classList.add("maplibregl-map");let c=this._canvasContainer=a.create("div","maplibregl-canvas-container",M);this._interactive&&c.classList.add("maplibregl-interactive"),this._canvas=a.create("canvas","maplibregl-canvas",c),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");let A=this._containerDimensions(),w=this._getClampedPixelRatio(A[0],A[1]);this._resizeCanvas(A[0],A[1],w);let E=this._controlContainer=a.create("div","maplibregl-control-container",M),P=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(U=>{P[U]=a.create("div",`maplibregl-ctrl-${U} `,E)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_setupCooperativeGestures(){this._cooperativeGesturesScreen=a.create("div","maplibregl-cooperative-gesture-screen",this._container);let M=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";navigator.platform.indexOf("Mac")===0&&(M=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use \u2318 + scroll to zoom the map"),this._cooperativeGesturesScreen.innerHTML=`
            <div class="maplibregl-desktop-message">${M}</div>
            <div class="maplibregl-mobile-message">${typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map"}</div>
        `,this._cooperativeGesturesScreen.setAttribute("aria-hidden","true"),this._canvasContainer.addEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.add("maplibregl-cooperative-gestures")}_destroyCooperativeGestures(){a.remove(this._cooperativeGesturesScreen),this._canvasContainer.removeEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.remove("maplibregl-cooperative-gestures")}_resizeCanvas(M,c,A){this._canvas.width=Math.floor(A*M),this._canvas.height=Math.floor(A*c),this._canvas.style.width=`${M}px`,this._canvas.style.height=`${c}px`}_setupPainter(){let M={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1},c=null;this._canvas.addEventListener("webglcontextcreationerror",w=>{c={requestedAttributes:M},w&&(c.statusMessage=w.statusMessage,c.type=w.type)},{once:!0});let A=this._canvas.getContext("webgl2",M)||this._canvas.getContext("webgl",M);if(!A){let w="Failed to initialize WebGL";throw c?(c.message=w,new Error(JSON.stringify(c))):new Error(w)}this.painter=new Nh(A,this.transform),h.testSupport(A)}_onCooperativeGesture(M,c,A){return!c&&A<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout(()=>{this._cooperativeGesturesScreen.classList.remove("maplibregl-show")},100)),!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(M){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||M,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(M){return this._update(),this._renderTaskQueue.add(M)}_cancelRenderFrame(M){this._renderTaskQueue.remove(M)}_render(M){let c=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(M),this._removed)return;let A=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;let E=this.transform.zoom,P=n.h.now();this.style.zoomHistory.update(E,P);let U=new n.a8(E,{now:P,fadeDuration:c,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),V=U.crossFadingFactor();V===1&&V===this._crossFadingFactor||(A=!0,this._crossFadingFactor=V),this.style.update(U)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform._minEleveationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,c,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:c,showPadding:this.showPadding}),this.fire(new n.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,n.bg.mark(n.bh.load),this.fire(new n.k("load"))),this.style&&(this.style.hasTransitions()||A)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();let w=this._sourcesDirty||this._styleDirty||this._placementDirty;return w||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new n.k("idle")),!this._loaded||this._fullyLoaded||w||(this._fullyLoaded=!0,n.bg.mark(n.bh.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){var M;this._hash&&this._hash.remove();for(let A of this._controls)A.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),B.removeThrottleControl(this._imageQueueHandle),(M=this._resizeObserver)===null||M===void 0||M.disconnect();let c=this.painter.context.gl.getExtension("WEBGL_lose_context");c&&c.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),a.remove(this._canvasContainer),a.remove(this._controlContainer),this._cooperativeGestures&&this._destroyCooperativeGestures(),this._container.classList.remove("maplibregl-map"),n.bg.clearMetrics(),this._removed=!0,this.fire(new n.k("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=n.h.frame(M=>{n.bg.frame(M),this._frame=null,this._render(M)}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(M){this._showTileBoundaries!==M&&(this._showTileBoundaries=M,this._update())}get showPadding(){return!!this._showPadding}set showPadding(M){this._showPadding!==M&&(this._showPadding=M,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(M){this._showCollisionBoxes!==M&&(this._showCollisionBoxes=M,M?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(M){this._showOverdrawInspector!==M&&(this._showOverdrawInspector=M,this._update())}get repaint(){return!!this._repaint}set repaint(M){this._repaint!==M&&(this._repaint=M,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(M){this._vertices=M,this._update()}get version(){return ur}getCameraTargetElevation(){return this.transform.elevation}},si.NavigationControl=class{constructor(M){this._updateZoomButtons=()=>{let c=this._map.getZoom(),A=c===this._map.getMaxZoom(),w=c===this._map.getMinZoom();this._zoomInButton.disabled=A,this._zoomOutButton.disabled=w,this._zoomInButton.setAttribute("aria-disabled",A.toString()),this._zoomOutButton.setAttribute("aria-disabled",w.toString())},this._rotateCompassArrow=()=>{let c=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=c},this._setButtonTitle=(c,A)=>{let w=this._map._getUIString(`NavigationControl.${A}`);c.title=w,c.setAttribute("aria-label",w)},this.options=n.e({},hm,M),this._container=a.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",c=>c.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",c=>this._map.zoomIn({},{originalEvent:c})),a.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",c=>this._map.zoomOut({},{originalEvent:c})),a.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",c=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:c}):this._map.resetNorth({},{originalEvent:c})}),this._compassIcon=a.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(M){return this._map=M,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Nu(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){a.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(M,c){let A=a.create("button",M,this._container);return A.type="button",A.addEventListener("click",c),A}},si.GeolocateControl=class extends n.E{constructor(M){super(),this._onSuccess=c=>{if(this._map){if(this._isOutOfMapMaxBounds(c))return this._setErrorState(),this.fire(new n.k("outofmaxbounds",c)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=c,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(c),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(c),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new n.k("geolocate",c)),this._finish()}},this._updateCamera=c=>{let A=new n.L(c.coords.longitude,c.coords.latitude),w=c.coords.accuracy,E=this._map.getBearing(),P=n.e({bearing:E},this.options.fitBoundsOptions),U=ke.fromLngLat(A,w);this._map.fitBounds(U,P,{geolocateSource:!0})},this._updateMarker=c=>{if(c){let A=new n.L(c.coords.longitude,c.coords.latitude);this._accuracyCircleMarker.setLngLat(A).addTo(this._map),this._userLocationDotMarker.setLngLat(A).addTo(this._map),this._accuracy=c.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=c=>{if(this._map){if(this.options.trackUserLocation)if(c.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;let A=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=A,this._geolocateButton.setAttribute("aria-label",A),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(c.code===3&&ru)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new n.k("error",c)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=c=>{if(this._map){if(this._container.addEventListener("contextmenu",A=>A.preventDefault()),this._geolocateButton=a.create("button","maplibregl-ctrl-geolocate",this._container),a.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",c===!1){n.w("Geolocation support is not available so the GeolocateControl will be disabled.");let A=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=A,this._geolocateButton.setAttribute("aria-label",A)}else{let A=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=A,this._geolocateButton.setAttribute("aria-label",A)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=a.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Lu({element:this._dotElement}),this._circleElement=a.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Lu({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",A=>{A.geolocateSource||this._watchState!=="ACTIVE_LOCK"||A.originalEvent&&A.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new n.k("trackuserlocationend")))})}},this.options=n.e({},Kn,M)}onAdd(M){return this._map=M,this._container=a.create("div","maplibregl-ctrl maplibregl-ctrl-group"),function(c,A=!1){Ds===void 0||A?window.navigator.permissions!==void 0?window.navigator.permissions.query({name:"geolocation"}).then(w=>{Ds=w.state!=="denied",c(Ds)}).catch(()=>{Ds=!!window.navigator.geolocation,c(Ds)}):(Ds=!!window.navigator.geolocation,c(Ds)):c(Ds)}(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),a.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Xn=0,ru=!1}_isOutOfMapMaxBounds(M){let c=this._map.getMaxBounds(),A=M.coords;return c&&(A.longitude<c.getWest()||A.longitude>c.getEast()||A.latitude<c.getSouth()||A.latitude>c.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){let M=this._map.getBounds(),c=M.getSouthEast(),A=M.getNorthEast(),w=c.distanceTo(A),E=Math.ceil(this._accuracy/(w/this._map._container.clientHeight)*2);this._circleElement.style.width=`${E}px`,this._circleElement.style.height=`${E}px`}trigger(){if(!this._setup)return n.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new n.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Xn--,ru=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new n.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new n.k("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let M;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Xn++,Xn>1?(M={maximumAge:6e5,timeout:0},ru=!0):(M=this.options.positionOptions,ru=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,M)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},si.AttributionControl=ka,si.LogoControl=Yn,si.ScaleControl=class{constructor(M){this._onMove=()=>{vd(this._map,this._container,this.options)},this.setUnit=c=>{this.options.unit=c,vd(this._map,this._container,this.options)},this.options=n.e({},Sn,M)}getDefaultPosition(){return"bottom-left"}onAdd(M){return this._map=M,this._container=a.create("div","maplibregl-ctrl maplibregl-ctrl-scale",M.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){a.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},si.FullscreenControl=class extends n.E{constructor(M={}){super(),this._onFullscreenChange=()=>{(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,M&&M.container&&(M.container instanceof HTMLElement?this._container=M.container:n.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(M){return this._map=M,this._container||(this._container=this._map.getContainer()),this._controlContainer=a.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){a.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){let M=this._fullscreenButton=a.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);a.create("span","maplibregl-ctrl-icon",M).setAttribute("aria-hidden","true"),M.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){let M=this._getTitle();this._fullscreenButton.setAttribute("aria-label",M),this._fullscreenButton.title=M}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new n.k("fullscreenstart")),this._map._cooperativeGestures&&(this._prevCooperativeGestures=this._map._cooperativeGestures,this._map.setCooperativeGestures())):(this.fire(new n.k("fullscreenend")),this._prevCooperativeGestures&&(this._map.setCooperativeGestures(this._prevCooperativeGestures),delete this._prevCooperativeGestures))}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},si.TerrainControl=class{constructor(M){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))},this.options=M}onAdd(M){return this._map=M,this._container=a.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=a.create("button","maplibregl-ctrl-terrain",this._container),a.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){a.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},si.Popup=class extends n.E{constructor(M){super(),this.remove=()=>(this._content&&a.remove(this._content),this._container&&(a.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new n.k("close")),this),this._onMouseUp=c=>{this._update(c.point)},this._onMouseMove=c=>{this._update(c.point)},this._onDrag=c=>{this._update(c.point)},this._update=c=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=a.create("div","maplibregl-popup",this._map.getContainer()),this._tip=a.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(let U of this.options.className.split(" "))this._container.classList.add(U);this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=bd(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!c)return;let A=this._pos=this._trackPointer&&c?c:this._map.project(this._lngLat),w=this.options.anchor,E=jf(this.options.offset);if(!w){let U=this._container.offsetWidth,V=this._container.offsetHeight,$;$=A.y+E.bottom.y<V?["top"]:A.y>this._map.transform.height-V?["bottom"]:[],A.x<U/2?$.push("left"):A.x>this._map.transform.width-U/2&&$.push("right"),w=$.length===0?"bottom":$.join("-")}let P=A.add(E[w]).round();a.setTransform(this._container,`${Da[w]} translate(${P.x}px,${P.y}px)`),fy(this._container,w,"popup")},this._onClose=()=>{this.remove()},this.options=n.e(Object.create(mg),M)}addTo(M){return this._map&&this.remove(),this._map=M,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new n.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(M){return this._lngLat=n.L.convert(M),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(M){return this.setDOMContent(document.createTextNode(M))}setHTML(M){let c=document.createDocumentFragment(),A=document.createElement("body"),w;for(A.innerHTML=M;w=A.firstChild,w;)c.appendChild(w);return this.setDOMContent(c)}getMaxWidth(){var M;return(M=this._container)===null||M===void 0?void 0:M.style.maxWidth}setMaxWidth(M){return this.options.maxWidth=M,this._update(),this}setDOMContent(M){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=a.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(M),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(M){this._container&&this._container.classList.add(M)}removeClassName(M){this._container&&this._container.classList.remove(M)}setOffset(M){return this.options.offset=M,this._update(),this}toggleClassName(M){if(this._container)return this._container.classList.toggle(M)}_createCloseButton(){this.options.closeButton&&(this._closeButton=a.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;let M=this._container.querySelector(Ag);M&&M.focus()}},si.Marker=Lu,si.Style=Rs,si.LngLat=n.L,si.LngLatBounds=ke,si.Point=n.P,si.MercatorCoordinate=n.U,si.Evented=n.E,si.AJAXError=n.bi,si.config=n.c,si.CanvasSource=Sr,si.GeoJSONSource=Kr,si.ImageSource=Br,si.RasterDEMTileSource=hi,si.RasterTileSource=yi,si.VectorTileSource=Si,si.VideoSource=Fe,si.setRTLTextPlugin=n.bj,si.getRTLTextPluginStatus=n.bk,si.prewarm=function(){Zo().acquire($i)},si.clearPrewarmedResources=function(){let M=Rl;M&&(M.isPreloaded()&&M.numActive()===1?(M.release($i),Rl=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},gg.extend(si,{isSafari:n.ac,getPerformanceMetrics:n.bg.getPerformanceMetrics}),si});var s=r;return s})});function vm(e,t){if(!e)throw new Error(t||"loader assertion failed.")}var Gf={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document},opt=Gf.self||Gf.window||Gf.global||{},apt=Gf.window||Gf.self||Gf.global||{},lpt=Gf.global||Gf.self||Gf.window||{},cpt=Gf.document||{};var Sg=!!(typeof process!="object"||String(process)!=="[object process]"||process.browser);var pV=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version),upt=pV&&parseFloat(pV[1])||0;var $4=globalThis,hpt=globalThis.document||{},H4=globalThis.process||{},fpt=globalThis.console,dV=globalThis.navigator||{};function q4(e){if(typeof window<"u"&&window.process?.type==="renderer"||typeof process<"u"&&process.versions?.electron)return!0;let t=typeof navigator<"u"&&navigator.userAgent,r=e||t;return!!(r&&r.indexOf("Electron")>=0)}function pl(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process?.browser)||q4()}function kR(e){return!e&&!pl()?"Node":q4(e)?"Electron":(e||dV.userAgent||"").indexOf("Edge")>-1?"Edge":globalThis.chrome?"Chrome":globalThis.safari?"Safari":globalThis.mozInnerScreenX?"Firefox":"Unknown"}var DR="4.0.7";function dpt(e){try{let t=window[e],r="__storage_test__";return t.setItem(r,r),t.removeItem(r),t}catch{return null}}var Y4=class{constructor(t,r,i="sessionStorage"){this.storage=dpt(i),this.id=t,this.config=r,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(t){if(Object.assign(this.config,t),this.storage){let r=JSON.stringify(this.config);this.storage.setItem(this.id,r)}}_loadConfiguration(){let t={};if(this.storage){let r=this.storage.getItem(this.id);t=r?JSON.parse(r):{}}return Object.assign(this.config,t),this}};function mV(e){let t;return e<10?t=`${e.toFixed(2)}ms`:e<100?t=`${e.toFixed(1)}ms`:e<1e3?t=`${e.toFixed(0)}ms`:t=`${(e/1e3).toFixed(2)}s`,t}function AV(e,t=8){let r=Math.max(t-e.length,0);return`${" ".repeat(r)}${e}`}var X4;(function(e){e[e.BLACK=30]="BLACK",e[e.RED=31]="RED",e[e.GREEN=32]="GREEN",e[e.YELLOW=33]="YELLOW",e[e.BLUE=34]="BLUE",e[e.MAGENTA=35]="MAGENTA",e[e.CYAN=36]="CYAN",e[e.WHITE=37]="WHITE",e[e.BRIGHT_BLACK=90]="BRIGHT_BLACK",e[e.BRIGHT_RED=91]="BRIGHT_RED",e[e.BRIGHT_GREEN=92]="BRIGHT_GREEN",e[e.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",e[e.BRIGHT_BLUE=94]="BRIGHT_BLUE",e[e.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",e[e.BRIGHT_CYAN=96]="BRIGHT_CYAN",e[e.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(X4||(X4={}));var mpt=10;function gV(e){return typeof e!="string"?e:(e=e.toUpperCase(),X4[e]||X4.WHITE)}function _V(e,t,r){return!pl&&typeof e=="string"&&(t&&(e=`\x1B[${gV(t)}m${e}\x1B[39m`),r&&(e=`\x1B[${gV(r)+mpt}m${e}\x1B[49m`)),e}function yV(e,t=["constructor"]){let r=Object.getPrototypeOf(e),i=Object.getOwnPropertyNames(r),s=e;for(let n of i){let o=s[n];typeof o=="function"&&(t.find(a=>n===a)||(s[n]=o.bind(e)))}}function av(e,t){if(!e)throw new Error(t||"Assertion failed")}function Eg(){let e;if(pl()&&$4.performance)e=$4?.performance?.now?.();else if("hrtime"in H4){let t=H4?.hrtime?.();e=t[0]*1e3+t[1]/1e6}else e=Date.now();return e}var Sy={debug:pl()&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},Apt={enabled:!0,level:0};function Ey(){}var xV={},bV={once:!0},gc=class{constructor({id:t}={id:""}){this.VERSION=DR,this._startTs=Eg(),this._deltaTs=Eg(),this.userData={},this.LOG_THROTTLE_TIMEOUT=0,this.id=t,this.userData={},this._storage=new Y4(`__probe-${this.id}__`,Apt),this.timeStamp(`${this.id} started`),yV(this),Object.seal(this)}set level(t){this.setLevel(t)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((Eg()-this._startTs).toPrecision(10))}getDelta(){return Number((Eg()-this._deltaTs).toPrecision(10))}set priority(t){this.level=t}get priority(){return this.level}getPriority(){return this.level}enable(t=!0){return this._storage.setConfiguration({enabled:t}),this}setLevel(t){return this._storage.setConfiguration({level:t}),this}get(t){return this._storage.config[t]}set(t,r){this._storage.setConfiguration({[t]:r})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(t,r){if(!t)throw new Error(r||"Assertion failed")}warn(t){return this._getLogFunction(0,t,Sy.warn,arguments,bV)}error(t){return this._getLogFunction(0,t,Sy.error,arguments)}deprecated(t,r){return this.warn(`\`${t}\` is deprecated and will be removed in a later version. Use \`${r}\` instead`)}removed(t,r){return this.error(`\`${t}\` has been removed. Use \`${r}\` instead`)}probe(t,r){return this._getLogFunction(t,r,Sy.log,arguments,{time:!0,once:!0})}log(t,r){return this._getLogFunction(t,r,Sy.debug,arguments)}info(t,r){return this._getLogFunction(t,r,console.info,arguments)}once(t,r){return this._getLogFunction(t,r,Sy.debug||Sy.info,arguments,bV)}table(t,r,i){return r?this._getLogFunction(t,r,console.table||Ey,i&&[i],{tag:_pt(r)}):Ey}time(t,r){return this._getLogFunction(t,r,console.time?console.time:console.info)}timeEnd(t,r){return this._getLogFunction(t,r,console.timeEnd?console.timeEnd:console.info)}timeStamp(t,r){return this._getLogFunction(t,r,console.timeStamp||Ey)}group(t,r,i={collapsed:!1}){let s=vV({logLevel:t,message:r,opts:i}),{collapsed:n}=i;return s.method=(n?console.groupCollapsed:console.group)||console.info,this._getLogFunction(s)}groupCollapsed(t,r,i={}){return this.group(t,r,Object.assign({},i,{collapsed:!0}))}groupEnd(t){return this._getLogFunction(t,"",console.groupEnd||Ey)}withGroup(t,r,i){this.group(t,r)();try{i()}finally{this.groupEnd(t)()}}trace(){console.trace&&console.trace()}_shouldLog(t){return this.isEnabled()&&this.getLevel()>=wV(t)}_getLogFunction(t,r,i,s,n){if(this._shouldLog(t)){n=vV({logLevel:t,message:r,args:s,opts:n}),i=i||n.method,av(i),n.total=this.getTotal(),n.delta=this.getDelta(),this._deltaTs=Eg();let o=n.tag||n.message;if(n.once&&o)if(!xV[o])xV[o]=Eg();else return Ey;return r=gpt(this.id,n.message,n),i.bind(console,r,...n.args)}return Ey}};gc.VERSION=DR;function wV(e){if(!e)return 0;let t;switch(typeof e){case"number":t=e;break;case"object":t=e.logLevel||e.priority||0;break;default:return 0}return av(Number.isFinite(t)&&t>=0),t}function vV(e){let{logLevel:t,message:r}=e;e.logLevel=wV(t);let i=e.args?Array.from(e.args):[];for(;i.length&&i.shift()!==r;);switch(typeof t){case"string":case"function":r!==void 0&&i.unshift(r),e.message=t;break;case"object":Object.assign(e,t);break;default:}typeof e.message=="function"&&(e.message=e.message());let s=typeof e.message;return av(s==="string"||s==="object"),Object.assign(e,{args:i},e.opts)}function gpt(e,t,r){if(typeof t=="string"){let i=r.time?AV(mV(r.total)):"";t=r.time?`${e}: ${i}  ${t}`:`${e}: ${t}`,t=_V(t,r.color,r.background)}return t}function _pt(e){for(let t in e)for(let r in e[t])return r||"untitled";return"empty"}globalThis.probe={};var oRt=new gc({id:"@probe.gl/log"});function OR(e,t){return TV(e||{},t)}function TV(e,t,r=0){if(r>3)return t;let i={...e};for(let[s,n]of Object.entries(t))n&&typeof n=="object"&&!Array.isArray(n)?i[s]=TV(i[s]||{},t[s],r+1):i[s]=t[s];return i}var SV="latest";function ypt(){return globalThis._loadersgl_?.version||(globalThis._loadersgl_=globalThis._loadersgl_||{},globalThis._loadersgl_.version="4.2.0"),globalThis._loadersgl_.version}var BR=ypt();function jl(e,t){if(!e)throw new Error(t||"loaders.gl assertion failed.")}var Qf={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document},pRt=Qf.self||Qf.window||Qf.global||{},dRt=Qf.window||Qf.self||Qf.global||{},mRt=Qf.global||Qf.self||Qf.window||{},ARt=Qf.document||{};var Wu=typeof process!="object"||String(process)!=="[object process]"||process.browser;var IV=typeof window<"u"&&typeof window.orientation<"u",EV=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version),gRt=EV&&parseFloat(EV[1])||0;var lv=class{name;workerThread;isRunning=!0;result;_resolve=()=>{};_reject=()=>{};constructor(t,r){this.name=t,this.workerThread=r,this.result=new Promise((i,s)=>{this._resolve=i,this._reject=s})}postMessage(t,r){this.workerThread.postMessage({source:"loaders.gl",type:t,payload:r})}done(t){jl(this.isRunning),this.isRunning=!1,this._resolve(t)}error(t){jl(this.isRunning),this.isRunning=!1,this._reject(t)}};var Iy=class{terminate(){}};var NR=new Map;function MV(e){jl(e.source&&!e.url||!e.source&&e.url);let t=NR.get(e.source||e.url);return t||(e.url&&(t=xpt(e.url),NR.set(e.url,t)),e.source&&(t=CV(e.source),NR.set(e.source,t))),jl(t),t}function xpt(e){if(!e.startsWith("http"))return e;let t=bpt(e);return CV(t)}function CV(e){let t=new Blob([e],{type:"application/javascript"});return URL.createObjectURL(t)}function bpt(e){return`try {
  importScripts('${e}');
} catch (error) {
  console.error(error);
  throw error;
}`}function LR(e,t=!0,r){let i=r||new Set;if(e){if(PV(e))i.add(e);else if(PV(e.buffer))i.add(e.buffer);else if(!ArrayBuffer.isView(e)){if(t&&typeof e=="object")for(let s in e)LR(e[s],t,i)}}return r===void 0?Array.from(i):[]}function PV(e){return e?e instanceof ArrayBuffer||typeof MessagePort<"u"&&e instanceof MessagePort||typeof ImageBitmap<"u"&&e instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas:!1}var FR=()=>{},wm=class{name;source;url;terminated=!1;worker;onMessage;onError;_loadableURL="";static isSupported(){return typeof Worker<"u"&&Wu||typeof Iy<"u"&&!Wu}constructor(t){let{name:r,source:i,url:s}=t;jl(i||s),this.name=r,this.source=i,this.url=s,this.onMessage=FR,this.onError=n=>console.log(n),this.worker=Wu?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=FR,this.onError=FR,this.worker.terminate(),this.terminated=!0}get isRunning(){return!!this.onMessage}postMessage(t,r){r=r||LR(t),this.worker.postMessage(t,r)}_getErrorFromErrorEvent(t){let r="Failed to load ";return r+=`worker ${this.name} from ${this.url}. `,t.message&&(r+=`${t.message} in `),t.lineno&&(r+=`:${t.lineno}:${t.colno}`),new Error(r)}_createBrowserWorker(){this._loadableURL=MV({source:this.source,url:this.url});let t=new Worker(this._loadableURL,{name:this.name});return t.onmessage=r=>{r.data?this.onMessage(r.data):this.onError(new Error("No data received"))},t.onerror=r=>{this.onError(this._getErrorFromErrorEvent(r)),this.terminated=!0},t.onmessageerror=r=>console.error(r),t}_createNodeWorker(){let t;if(this.url){let i=this.url.includes(":/")||this.url.startsWith("/")?this.url:`./${this.url}`;t=new Iy(i,{eval:!1})}else if(this.source)t=new Iy(this.source,{eval:!0});else throw new Error("no worker");return t.on("message",r=>{this.onMessage(r)}),t.on("error",r=>{this.onError(r)}),t.on("exit",r=>{}),t}};var cv=class{name="unnamed";source;url;maxConcurrency=1;maxMobileConcurrency=1;onDebug=()=>{};reuseWorkers=!0;props={};jobQueue=[];idleQueue=[];count=0;isDestroyed=!1;static isSupported(){return wm.isSupported()}constructor(t){this.source=t.source,this.url=t.url,this.setProps(t)}destroy(){this.idleQueue.forEach(t=>t.destroy()),this.isDestroyed=!0}setProps(t){this.props={...this.props,...t},t.name!==void 0&&(this.name=t.name),t.maxConcurrency!==void 0&&(this.maxConcurrency=t.maxConcurrency),t.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=t.maxMobileConcurrency),t.reuseWorkers!==void 0&&(this.reuseWorkers=t.reuseWorkers),t.onDebug!==void 0&&(this.onDebug=t.onDebug)}async startJob(t,r=(s,n,o)=>s.done(o),i=(s,n)=>s.error(n)){let s=new Promise(n=>(this.jobQueue.push({name:t,onMessage:r,onError:i,onStart:n}),this));return this._startQueuedJob(),await s}async _startQueuedJob(){if(!this.jobQueue.length)return;let t=this._getAvailableWorker();if(!t)return;let r=this.jobQueue.shift();if(r){this.onDebug({message:"Starting job",name:r.name,workerThread:t,backlog:this.jobQueue.length});let i=new lv(r.name,t);t.onMessage=s=>r.onMessage(i,s.type,s.payload),t.onError=s=>r.onError(i,s),r.onStart(i);try{await i.result}catch(s){console.error(`Worker exception: ${s}`)}finally{this.returnWorkerToQueue(t)}}}returnWorkerToQueue(t){!Wu||this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(t.destroy(),this.count--):this.idleQueue.push(t),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;let t=`${this.name.toLowerCase()} (#${this.count} of ${this.maxConcurrency})`;return new wm({name:t,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return IV?this.maxMobileConcurrency:this.maxConcurrency}};var vpt={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}},Ig=class e{props;workerPools=new Map;static _workerFarm;static isSupported(){return wm.isSupported()}static getWorkerFarm(t={}){return e._workerFarm=e._workerFarm||new e({}),e._workerFarm.setProps(t),e._workerFarm}constructor(t){this.props={...vpt},this.setProps(t),this.workerPools=new Map}destroy(){for(let t of this.workerPools.values())t.destroy();this.workerPools=new Map}setProps(t){this.props={...this.props,...t};for(let r of this.workerPools.values())r.setProps(this._getWorkerPoolProps())}getWorkerPool(t){let{name:r,source:i,url:s}=t,n=this.workerPools.get(r);return n||(n=new cv({name:r,source:i,url:s}),n.setProps(this._getWorkerPoolProps()),this.workerPools.set(r,n)),n}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}};function zR(e,t={}){let r=t[e.id]||{},i=Wu?`${e.id}-worker.js`:`${e.id}-worker-node.js`,s=r.workerUrl;if(!s&&e.id==="compression"&&(s=t.workerUrl),t._workerType==="test"&&(Wu?s=`modules/${e.module}/dist/${i}`:s=`modules/${e.module}/src/workers/${e.id}-worker-node.ts`),!s){let n=e.version;n==="latest"&&(n=SV);let o=n?`@${n}`:"";s=`https://unpkg.com/@loaders.gl/${e.module}${o}/dist/${i}`}return jl(s),s}function UR(e,t=BR){jl(e,"no worker provided");let r=e.version;return!(!t||!r)}function VR(e,t){return!Ig.isSupported()||!Wu&&!t?._nodeWorkers?!1:e.worker&&t?.worker}async function jR(e,t,r,i,s){let n=e.id,o=zR(e,r),h=Ig.getWorkerFarm(r).getWorkerPool({name:n,url:o});r=JSON.parse(JSON.stringify(r)),i=JSON.parse(JSON.stringify(i||{}));let p=await h.startJob("process-on-worker",wpt.bind(null,s));return p.postMessage("process",{input:t,options:r,context:i}),await(await p.result).result}async function wpt(e,t,r,i){switch(r){case"done":t.done(i);break;case"error":t.error(new Error(i.error));break;case"process":let{id:s,input:n,options:o}=i;try{let a=await e(n,o);t.postMessage("done",{id:s,result:a})}catch(a){let h=a instanceof Error?a.message:"unknown error";t.postMessage("error",{id:s,error:h})}break;default:console.warn(`parse-with-worker unknown message ${r}`)}}function WR(e,t,r){if(r=r||e.byteLength,e.byteLength<r||t.byteLength<r)return!1;let i=new Uint8Array(e),s=new Uint8Array(t);for(let n=0;n<i.length;++n)if(i[n]!==s[n])return!1;return!0}function $R(...e){return RV(e)}function RV(e){let t=e.map(n=>n instanceof ArrayBuffer?new Uint8Array(n):n),r=t.reduce((n,o)=>n+o.byteLength,0),i=new Uint8Array(r),s=0;for(let n of t)i.set(n,s),s+=n.byteLength;return i.buffer}async function HR(e){let t=[];for await(let r of e)t.push(r);return $R(...t)}function uv(){let e;if(typeof window<"u"&&window.performance)e=window.performance.now();else if(typeof process<"u"&&process.hrtime){let t=process.hrtime();e=t[0]*1e3+t[1]/1e6}else e=Date.now();return e}var Mg=class{constructor(t,r){this.sampleSize=1,this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this.name=t,this.type=r,this.reset()}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}setSampleSize(t){return this.sampleSize=t,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(t){return this._count+=t,this._samples++,this._checkSampling(),this}subtractCount(t){return this._count-=t,this._samples++,this._checkSampling(),this}addTime(t){return this._time+=t,this.lastTiming=t,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=uv(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(uv()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}};var _c=class{constructor(t){this.stats={},this.id=t.id,this.stats={},this._initializeStats(t.stats),Object.seal(this)}get(t,r="count"){return this._getOrCreate({name:t,type:r})}get size(){return Object.keys(this.stats).length}reset(){for(let t of Object.values(this.stats))t.reset();return this}forEach(t){for(let r of Object.values(this.stats))t(r)}getTable(){let t={};return this.forEach(r=>{t[r.name]={time:r.time||0,count:r.count||0,average:r.getAverageTime()||0,hz:r.getHz()||0}}),t}_initializeStats(t=[]){t.forEach(r=>this._getOrCreate(r))}_getOrCreate(t){let{name:r,type:i}=t,s=this.stats[r];return s||(t instanceof Mg?s=t:s=new Mg(r,i),this.stats[r]=s),s}};var Tpt="Queued Requests",Spt="Active Requests",Ept="Cancelled Requests",Ipt="Queued Requests Ever",Mpt="Active Requests Ever",Cpt={id:"request-scheduler",throttleRequests:!0,maxRequests:6,debounceTime:0},My=class{props;stats;activeRequestCount=0;requestQueue=[];requestMap=new Map;updateTimer=null;constructor(t={}){this.props={...Cpt,...t},this.stats=new _c({id:this.props.id}),this.stats.get(Tpt),this.stats.get(Spt),this.stats.get(Ept),this.stats.get(Ipt),this.stats.get(Mpt)}scheduleRequest(t,r=()=>0){if(!this.props.throttleRequests)return Promise.resolve({done:()=>{}});if(this.requestMap.has(t))return this.requestMap.get(t);let i={handle:t,priority:0,getPriority:r},s=new Promise(n=>(i.resolve=n,i));return this.requestQueue.push(i),this.requestMap.set(t,s),this._issueNewRequests(),s}_issueRequest(t){let{handle:r,resolve:i}=t,s=!1,n=()=>{s||(s=!0,this.requestMap.delete(r),this.activeRequestCount--,this._issueNewRequests())};return this.activeRequestCount++,i?i({done:n}):Promise.resolve({done:n})}_issueNewRequests(){this.updateTimer!==null&&clearTimeout(this.updateTimer),this.updateTimer=setTimeout(()=>this._issueNewRequestsAsync(),this.props.debounceTime)}_issueNewRequestsAsync(){this.updateTimer!==null&&clearTimeout(this.updateTimer),this.updateTimer=null;let t=Math.max(this.props.maxRequests-this.activeRequestCount,0);if(t!==0){this._updateAllRequests();for(let r=0;r<t;++r){let i=this.requestQueue.shift();i&&this._issueRequest(i)}}}_updateAllRequests(){let t=this.requestQueue;for(let r=0;r<t.length;++r){let i=t[r];this._updateRequest(i)||(t.splice(r,1),this.requestMap.delete(i.handle),r--)}t.sort((r,i)=>r.priority-i.priority)}_updateRequest(t){return t.priority=t.getPriority(t.handle),t.priority<0?(t.resolve(null),!1):!0}};var Ppt="",kV={};function qR(e){for(let t in kV)if(e.startsWith(t)){let r=kV[t];e=e.replace(t,r)}return!e.startsWith("http://")&&!e.startsWith("https://")&&(e=`${Ppt}${e}`),e}function DV(e){return e&&typeof e=="object"&&e.isBuffer}function Z4(e){if(DV(e))return e;if(e instanceof ArrayBuffer)return e;if(ArrayBuffer.isView(e))return e.byteOffset===0&&e.byteLength===e.buffer.byteLength?e.buffer:e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength);if(typeof e=="string"){let t=e;return new TextEncoder().encode(t).buffer}if(e&&typeof e=="object"&&e._toArrayBuffer)return e._toArrayBuffer();throw new Error("toArrayBuffer")}var Cg={};Ua(Cg,{dirname:()=>kpt,filename:()=>Rpt,join:()=>Dpt,resolve:()=>Opt});function OV(){if(typeof process<"u"&&typeof process.cwd<"u")return process.cwd();let e=window.location?.pathname;return e?.slice(0,e.lastIndexOf("/")+1)||""}function Rpt(e){let t=e?e.lastIndexOf("/"):-1;return t>=0?e.substr(t+1):""}function kpt(e){let t=e?e.lastIndexOf("/"):-1;return t>=0?e.substr(0,t):""}function Dpt(...e){let t="/";return e=e.map((r,i)=>(i&&(r=r.replace(new RegExp(`^${t}`),"")),i!==e.length-1&&(r=r.replace(new RegExp(`${t}$`),"")),r)),e.join(t)}function Opt(...e){let t=[];for(let n=0;n<e.length;n++)t[n]=e[n];let r="",i=!1,s;for(let n=t.length-1;n>=-1&&!i;n--){let o;n>=0?o=t[n]:(s===void 0&&(s=OV()),o=s),o.length!==0&&(r=`${o}/${r}`,i=o.charCodeAt(0)===hv)}return r=Bpt(r,!i),i?`/${r}`:r.length>0?r:"."}var hv=47,YR=46;function Bpt(e,t){let r="",i=-1,s=0,n,o=!1;for(let a=0;a<=e.length;++a){if(a<e.length)n=e.charCodeAt(a);else{if(n===hv)break;n=hv}if(n===hv){if(!(i===a-1||s===1))if(i!==a-1&&s===2){if(r.length<2||!o||r.charCodeAt(r.length-1)!==YR||r.charCodeAt(r.length-2)!==YR){if(r.length>2){let h=r.length-1,p=h;for(;p>=0&&r.charCodeAt(p)!==hv;--p);if(p!==h){r=p===-1?"":r.slice(0,p),i=a,s=0,o=!1;continue}}else if(r.length===2||r.length===1){r="",i=a,s=0,o=!1;continue}}t&&(r.length>0?r+="/..":r="..",o=!0)}else{let h=e.slice(i+1,a);r.length>0?r+=`/${h}`:r=h,o=!1}i=a,s=0}else n===YR&&s!==-1?++s:s=-1}return r}var Npt=e=>typeof e=="boolean",fv=e=>typeof e=="function",Pg=e=>e!==null&&typeof e=="object",XR=e=>Pg(e)&&e.constructor==={}.constructor;var BV=e=>!!e&&typeof e[Symbol.iterator]=="function",NV=e=>e&&typeof e[Symbol.asyncIterator]=="function";var $u=e=>typeof Response<"u"&&e instanceof Response||e&&e.arrayBuffer&&e.text&&e.json;var Hu=e=>typeof Blob<"u"&&e instanceof Blob,LV=e=>e&&typeof e=="object"&&e.isBuffer;var Lpt=e=>typeof ReadableStream<"u"&&e instanceof ReadableStream||Pg(e)&&fv(e.tee)&&fv(e.cancel)&&fv(e.getReader);var Fpt=e=>Pg(e)&&fv(e.read)&&fv(e.pipe)&&Npt(e.readable),G4=e=>Lpt(e)||Fpt(e);var Q4=class extends Error{constructor(t,r){super(t),this.reason=r.reason,this.url=r.url,this.response=r.response}reason;url;response};var zpt=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,Upt=/^([-\w.]+\/[-\w.+]+)/;function ZR(e,t){return e.toLowerCase()===t.toLowerCase()}function FV(e){let t=Upt.exec(e);return t?t[1]:e}function GR(e){let t=zpt.exec(e);return t?t[1]:""}var zV=/\?.*/;function UV(e){let t=e.match(zV);return t&&t[0]}function Cy(e){return e.replace(zV,"")}function VV(e){if(e.length<50)return e;let t=e.slice(e.length-15);return`${e.substr(0,32)}...${t}`}function Rg(e){return $u(e)?e.url:Hu(e)?e.name||"":typeof e=="string"?e:""}function pv(e){if($u(e)){let t=e,r=t.headers.get("content-type")||"",i=Cy(t.url);return FV(r)||GR(i)}return Hu(e)?e.type||"":typeof e=="string"?GR(e):""}function jV(e){return $u(e)?e.headers["content-length"]||-1:Hu(e)?e.size:typeof e=="string"?e.length:e instanceof ArrayBuffer||ArrayBuffer.isView(e)?e.byteLength:-1}async function K4(e){if($u(e))return e;let t={},r=jV(e);r>=0&&(t["content-length"]=String(r));let i=Rg(e),s=pv(e);s&&(t["content-type"]=s);let n=await jpt(e);n&&(t["x-first-bytes"]=n),typeof e=="string"&&(e=new TextEncoder().encode(e));let o=new Response(e,{headers:t});return Object.defineProperty(o,"url",{value:i}),o}async function WV(e){if(!e.ok)throw await Vpt(e)}async function Vpt(e){let t=VV(e.url),r=`Failed to fetch resource (${e.status}) ${e.statusText}: ${t}`;r=r.length>100?`${r.slice(0,100)}...`:r;let i={reason:e.statusText,url:e.url,response:e};try{let s=e.headers.get("Content-Type");i.reason=s?.includes("application/json")?await e.json():e.text()}catch{}return new Q4(r,i)}async function jpt(e){if(typeof e=="string")return`data:,${e.slice(0,5)}`;if(e instanceof Blob){let r=e.slice(0,5);return await new Promise(i=>{let s=new FileReader;s.onload=n=>i(n?.target?.result),s.readAsDataURL(r)})}if(e instanceof ArrayBuffer){let r=e.slice(0,5);return`data:base64,${Wpt(r)}`}return null}function Wpt(e){let t="",r=new Uint8Array(e);for(let i=0;i<r.byteLength;i++)t+=String.fromCharCode(r[i]);return btoa(t)}function $pt(e){return!Hpt(e)&&!qpt(e)}function Hpt(e){return e.startsWith("http:")||e.startsWith("https:")}function qpt(e){return e.startsWith("data:")}async function QR(e,t){if(typeof e=="string"){let r=qR(e);return $pt(r)&&globalThis.loaders?.fetchNode?globalThis.loaders?.fetchNode(r,t):await fetch(r,t)}return await K4(e)}var KR=new gc({id:"loaders.gl"}),J4=class{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}},t5=class{console;constructor(){this.console=console}log(...t){return this.console.log.bind(this.console,...t)}info(...t){return this.console.info.bind(this.console,...t)}warn(...t){return this.console.warn.bind(this.console,...t)}error(...t){return this.console.error.bind(this.console,...t)}};var JR={fetch:null,mimeType:void 0,nothrow:!1,log:new t5,useLocalLibraries:!1,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:Sg,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},$V={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function tk(){globalThis.loaders=globalThis.loaders||{};let{loaders:e}=globalThis;return e._state||(e._state={}),e._state}function ek(){let e=tk();return e.globalOptions=e.globalOptions||{...JR},e.globalOptions}function YV(e,t,r,i){return r=r||[],r=Array.isArray(r)?r:[r],Ypt(e,r),Zpt(t,e,i)}function Ypt(e,t){HV(e,null,JR,$V,t);for(let r of t){let i=e&&e[r.id]||{},s=r.options&&r.options[r.id]||{},n=r.deprecatedOptions&&r.deprecatedOptions[r.id]||{};HV(i,r.id,s,n,t)}}function HV(e,t,r,i,s){let n=t||"Top level",o=t?`${t}.`:"";for(let a in e){let h=!t&&Pg(e[a]),p=a==="baseUri"&&!t,g=a==="workerUrl"&&t;if(!(a in r)&&!p&&!g){if(a in i)KR.warn(`${n} loader option '${o}${a}' no longer supported, use '${i[a]}'`)();else if(!h){let v=Xpt(a,s);KR.warn(`${n} loader option '${o}${a}' not recognized. ${v}`)()}}}}function Xpt(e,t){let r=e.toLowerCase(),i="";for(let s of t)for(let n in s.options){if(e===n)return`Did you mean '${s.id}.${n}'?`;let o=n.toLowerCase();(r.startsWith(o)||o.startsWith(r))&&(i=i||`Did you mean '${s.id}.${n}'?`)}return i}function Zpt(e,t,r){let s={...e.options||{}};return Gpt(s,r),s.log===null&&(s.log=new J4),qV(s,ek()),qV(s,t),s}function qV(e,t){for(let r in t)if(r in t){let i=t[r];XR(i)&&XR(e[r])?e[r]={...e[r],...t[r]}:e[r]=t[r]}}function Gpt(e,t){t&&!("baseUri"in e)&&(e.baseUri=t)}function dv(e){return e?(Array.isArray(e)&&(e=e[0]),Array.isArray(e?.extensions)):!1}function mv(e){vm(e,"null loader"),vm(dv(e),"invalid loader");let t;return Array.isArray(e)&&(t=e[1],e=e[0],e={...e,options:{...e.options,...t}}),(e?.parseTextSync||e?.parseText)&&(e.text=!0),e.text||(e.binary=!0),e}var XV=()=>{let e=tk();return e.loaderRegistry=e.loaderRegistry||[],e.loaderRegistry};function rk(e){let t=XV();e=Array.isArray(e)?e:[e];for(let r of e){let i=mv(r);t.find(s=>i===s)||t.unshift(i)}}function ZV(){return XV()}var GV=new gc({id:"loaders.gl"});var Qpt=/\.([^.]+)$/;async function JV(e,t=[],r,i){if(!tj(e))return null;let s=QV(e,t,{...r,nothrow:!0},i);if(s)return s;if(Hu(e)&&(e=await e.slice(0,10).arrayBuffer(),s=QV(e,t,r,i)),!s&&!r?.nothrow)throw new Error(ej(e));return s}function QV(e,t=[],r,i){if(!tj(e))return null;if(t&&!Array.isArray(t))return mv(t);let s=[];t&&(s=s.concat(t)),r?.ignoreRegisteredLoaders||s.push(...ZV()),Jpt(s);let n=Kpt(e,s,r,i);if(!n&&!r?.nothrow)throw new Error(ej(e));return n}function Kpt(e,t,r,i){let s=Rg(e),n=pv(e),o=Cy(s)||i?.url,a=null,h="";return r?.mimeType&&(a=ik(t,r?.mimeType),h=`match forced by supplied MIME type ${r?.mimeType}`),a=a||tdt(t,o),h=h||(a?`matched url ${o}`:""),a=a||ik(t,n),h=h||(a?`matched MIME type ${n}`:""),a=a||rdt(t,e),h=h||(a?`matched initial data ${rj(e)}`:""),r?.fallbackMimeType&&(a=a||ik(t,r?.fallbackMimeType),h=h||(a?`matched fallback MIME type ${n}`:"")),h&&GV.log(1,`selectLoader selected ${a?.name}: ${h}.`),a}function tj(e){return!(e instanceof Response&&e.status===204)}function ej(e){let t=Rg(e),r=pv(e),i="No valid loader found (";i+=t?`${Cg.filename(t)}, `:"no url provided, ",i+=`MIME type: ${r?`"${r}"`:"not provided"}, `;let s=e?rj(e):"";return i+=s?` first bytes: "${s}"`:"first bytes: not available",i+=")",i}function Jpt(e){for(let t of e)mv(t)}function tdt(e,t){let r=t&&Qpt.exec(t),i=r&&r[1];return i?edt(e,i):null}function edt(e,t){t=t.toLowerCase();for(let r of e)for(let i of r.extensions)if(i.toLowerCase()===t)return r;return null}function ik(e,t){for(let r of e)if(r.mimeTypes?.some(i=>ZR(t,i))||ZR(t,`application/x.${r.id}`))return r;return null}function rdt(e,t){if(!t)return null;for(let r of e)if(typeof t=="string"){if(idt(t,r))return r}else if(ArrayBuffer.isView(t)){if(KV(t.buffer,t.byteOffset,r))return r}else if(t instanceof ArrayBuffer&&KV(t,0,r))return r;return null}function idt(e,t){return t.testText?t.testText(e):(Array.isArray(t.tests)?t.tests:[t.tests]).some(i=>e.startsWith(i))}function KV(e,t,r){return(Array.isArray(r.tests)?r.tests:[r.tests]).some(s=>ndt(e,t,r,s))}function ndt(e,t,r,i){if(i instanceof ArrayBuffer)return WR(i,e,i.byteLength);switch(typeof i){case"function":return i(e);case"string":let s=nk(e,t,i.length);return i===s;default:return!1}}function rj(e,t=5){return typeof e=="string"?e.slice(0,t):ArrayBuffer.isView(e)?nk(e.buffer,e.byteOffset,t):e instanceof ArrayBuffer?nk(e,0,t):""}function nk(e,t,r){if(e.byteLength<t+r)return"";let i=new DataView(e),s="";for(let n=0;n<r;n++)s+=String.fromCharCode(i.getUint8(t+n));return s}function*ij(e,t){let r=t?.chunkSize||262144,i=0,s=new TextEncoder;for(;i<e.length;){let n=Math.min(e.length-i,r),o=e.slice(i,i+n);i+=n,yield s.encode(o)}}function*nj(e,t={}){let{chunkSize:r=262144}=t,i=0;for(;i<e.byteLength;){let s=Math.min(e.byteLength-i,r),n=new ArrayBuffer(s),o=new Uint8Array(e,i,s);new Uint8Array(n).set(o),i+=s,yield n}}async function*sj(e,t){let r=t?.chunkSize||1048576,i=0;for(;i<e.size;){let s=i+r,n=await e.slice(i,s).arrayBuffer();i=s,yield n}}function sk(e,t){return Sg?sdt(e,t):odt(e,t)}async function*sdt(e,t){let r=e.getReader(),i;try{for(;;){let s=i||r.read();t?._streamReadAhead&&(i=r.read());let{done:n,value:o}=await s;if(n)return;yield Z4(o)}}catch{r.releaseLock()}}async function*odt(e,t){for await(let r of e)yield Z4(r)}function oj(e,t){if(typeof e=="string")return ij(e,t);if(e instanceof ArrayBuffer)return nj(e,t);if(Hu(e))return sj(e,t);if(G4(e))return sk(e,t);if($u(e))return sk(e.body,t);throw new Error("makeIterator")}var aj="Cannot convert supplied data type";function adt(e,t,r){if(t.text&&typeof e=="string")return e;if(LV(e)&&(e=e.buffer),e instanceof ArrayBuffer){let i=e;return t.text&&!t.binary?new TextDecoder("utf8").decode(i):i}if(ArrayBuffer.isView(e)){if(t.text&&!t.binary)return new TextDecoder("utf8").decode(e);let i=e.buffer,s=e.byteLength||e.length;return(e.byteOffset!==0||s!==i.byteLength)&&(i=i.slice(e.byteOffset,e.byteOffset+s)),i}throw new Error(aj)}async function lj(e,t,r){let i=e instanceof ArrayBuffer||ArrayBuffer.isView(e);if(typeof e=="string"||i)return adt(e,t,r);if(Hu(e)&&(e=await K4(e)),$u(e)){let s=e;return await WV(s),t.binary?await s.arrayBuffer():await s.text()}if(G4(e)&&(e=oj(e,r)),BV(e)||NV(e))return HR(e);throw new Error(aj)}function e5(e,t){let r=ek(),i=e||r;return typeof i.fetch=="function"?i.fetch:Pg(i.fetch)?s=>QR(s,i.fetch):t?.fetch?t?.fetch:QR}function cj(e,t,r){if(r)return r;let i={fetch:e5(t,e),...e};if(i.url){let s=Cy(i.url);i.baseUrl=s,i.queryString=UV(i.url),i.filename=Cg.filename(s),i.baseUrl=Cg.dirname(s)}return Array.isArray(i.loaders)||(i.loaders=null),i}function uj(e,t){if(e&&!Array.isArray(e))return e;let r;if(e&&(r=Array.isArray(e)?e:[e]),t&&t.loaders){let i=Array.isArray(t.loaders)?t.loaders:[t.loaders];r=r?[...r,...i]:i}return r&&r.length?r:void 0}async function Av(e,t,r,i){t&&!Array.isArray(t)&&!dv(t)&&(i=void 0,r=t,t=void 0),e=await e,r=r||{};let s=Rg(e),o=uj(t,i),a=await JV(e,o,r);return a?(r=YV(r,a,o,s),i=cj({url:s,_parse:Av,loaders:o},r,i||null),await ldt(a,e,r,i)):null}async function ldt(e,t,r,i){if(UR(e),r=OR(e.options,r),$u(t)){let n=t,{ok:o,redirected:a,status:h,statusText:p,type:g,url:v}=n,T=Object.fromEntries(n.headers.entries());i.response={headers:T,ok:o,redirected:a,status:h,statusText:p,type:g,url:v}}t=await lj(t,e,r);let s=e;if(s.parseTextSync&&typeof t=="string")return s.parseTextSync(t,r,i);if(VR(e,r))return await jR(e,t,r,i,Av);if(s.parseText&&typeof t=="string")return await s.parseText(t,r,i);if(s.parse)return await s.parse(t,r,i);throw jl(!s.parseSync),new Error(`${e.id} loader - no parser found and worker is disabled`)}async function Tm(e,t,r,i){let s,n;!Array.isArray(t)&&!dv(t)?(s=[],n=t,i=void 0):(s=t,n=r);let o=e5(n),a=e;return typeof e=="string"&&(a=await o(e)),Hu(e)&&(a=await o(e)),Array.isArray(s)?await Av(a,s,n):await Av(a,s,n)}var hj="4.2.0";var cdt=globalThis.loaders?.parseImageNode,ok=typeof Image<"u",ak=typeof ImageBitmap<"u",udt=!!cdt,lk=Sg?!0:udt;function fj(e){switch(e){case"auto":return ak||ok||lk;case"imagebitmap":return ak;case"image":return ok;case"data":return lk;default:throw new Error(`@loaders.gl/images: image ${e} not supported in this environment`)}}function pj(){if(ak)return"imagebitmap";if(ok)return"image";if(lk)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}function hdt(e){let t=fdt(e);if(!t)throw new Error("Not an image");return t}function dj(e){switch(hdt(e)){case"data":return e;case"image":case"imagebitmap":let t=document.createElement("canvas"),r=t.getContext("2d");if(!r)throw new Error("getImageData");return t.width=e.width,t.height=e.height,r.drawImage(e,0,0),r.getImageData(0,0,e.width,e.height);default:throw new Error("getImageData")}}function fdt(e){return typeof ImageBitmap<"u"&&e instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&e instanceof Image?"image":e&&typeof e=="object"&&e.data&&e.width&&e.height?"data":null}var pdt=/^data:image\/svg\+xml/,ddt=/\.svg((\?|#).*)?$/;function r5(e){return e&&(pdt.test(e)||ddt.test(e))}function mj(e,t){if(r5(t)){let i=new TextDecoder().decode(e);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(i=unescape(encodeURIComponent(i)))}catch(n){throw new Error(n.message)}return`data:image/svg+xml;base64,${btoa(i)}`}return ck(e,t)}function ck(e,t){if(r5(t))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(e)])}async function i5(e,t,r){let i=mj(e,r),s=self.URL||self.webkitURL,n=typeof i!="string"&&s.createObjectURL(i);try{return await mdt(n||i,t)}finally{n&&s.revokeObjectURL(n)}}async function mdt(e,t){let r=new Image;return r.src=e,t.image&&t.image.decode&&r.decode?(await r.decode(),r):await new Promise((i,s)=>{try{r.onload=()=>i(r),r.onerror=n=>{let o=n instanceof Error?n.message:"error";s(new Error(o))}}catch(n){s(n)}})}var Adt={},Aj=!0;async function gj(e,t,r){let i;r5(r)?i=await i5(e,t,r):i=ck(e,r);let s=t&&t.imagebitmap;return await gdt(i,s)}async function gdt(e,t=null){if((_dt(t)||!Aj)&&(t=null),t)try{return await createImageBitmap(e,t)}catch(r){console.warn(r),Aj=!1}return await createImageBitmap(e)}function _dt(e){for(let t in e||Adt)return!1;return!0}function _j(e){return!vdt(e,"ftyp",4)||!(e[8]&96)?null:ydt(e)}function ydt(e){switch(xdt(e,8,12).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}}function xdt(e,t,r){return String.fromCharCode(...e.slice(t,r))}function bdt(e){return[...e].map(t=>t.charCodeAt(0))}function vdt(e,t,r=0){let i=bdt(t);for(let s=0;s<i.length;++s)if(i[s]!==e[s+r])return!1;return!0}var Kf=!1,gv=!0;function n5(e){let t=_v(e);return Tdt(t)||Idt(t)||Sdt(t)||Edt(t)||wdt(t)}function wdt(e){let t=new Uint8Array(e instanceof DataView?e.buffer:e),r=_j(t);return r?{mimeType:r.mimeType,width:0,height:0}:null}function Tdt(e){let t=_v(e);return t.byteLength>=24&&t.getUint32(0,Kf)===2303741511?{mimeType:"image/png",width:t.getUint32(16,Kf),height:t.getUint32(20,Kf)}:null}function Sdt(e){let t=_v(e);return t.byteLength>=10&&t.getUint32(0,Kf)===1195984440?{mimeType:"image/gif",width:t.getUint16(6,gv),height:t.getUint16(8,gv)}:null}function Edt(e){let t=_v(e);return t.byteLength>=14&&t.getUint16(0,Kf)===16973&&t.getUint32(2,gv)===t.byteLength?{mimeType:"image/bmp",width:t.getUint32(18,gv),height:t.getUint32(22,gv)}:null}function Idt(e){let t=_v(e);if(!(t.byteLength>=3&&t.getUint16(0,Kf)===65496&&t.getUint8(2)===255))return null;let{tableMarkers:i,sofMarkers:s}=Mdt(),n=2;for(;n+9<t.byteLength;){let o=t.getUint16(n,Kf);if(s.has(o))return{mimeType:"image/jpeg",height:t.getUint16(n+5,Kf),width:t.getUint16(n+7,Kf)};if(!i.has(o))return null;n+=2,n+=t.getUint16(n,Kf)}return null}function Mdt(){let e=new Set([65499,65476,65484,65501,65534]);for(let r=65504;r<65520;++r)e.add(r);return{tableMarkers:e,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}function _v(e){if(e instanceof DataView)return e;if(ArrayBuffer.isView(e))return new DataView(e.buffer);if(e instanceof ArrayBuffer)return new DataView(e);throw new Error("toDataView")}async function yj(e,t){let{mimeType:r}=n5(e)||{},i=globalThis.loaders?.parseImageNode;return vm(i),await i(e,r)}async function xj(e,t,r){t=t||{};let s=(t.image||{}).type||"auto",{url:n}=r||{},o=Cdt(s),a;switch(o){case"imagebitmap":a=await gj(e,t,n);break;case"image":a=await i5(e,t,n);break;case"data":a=await yj(e,t);break;default:vm(!1)}return s==="data"&&(a=dj(a)),a}function Cdt(e){switch(e){case"auto":case"data":return pj();default:return fj(e),e}}var Pdt=["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],Rdt=["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],kdt={image:{type:"auto",decode:!0}},uk={dataType:null,batchType:null,id:"image",module:"images",name:"Images",version:hj,mimeTypes:Rdt,extensions:Pdt,parse:xj,tests:[e=>!!n5(new DataView(e))],options:kdt};var Ddt=new gc({id:"deck"}),Ir=Ddt;var hk={};function bj(e){hk=e}function ho(e,t,r,i){Ir.level>0&&hk[e]&&hk[e].call(null,t,r,i)}function Odt(e){let t=e[0],r=e[e.length-1];return t==="{"&&r==="}"||t==="["&&r==="]"}var vj={dataType:null,batchType:null,id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:Odt,parseTextSync:JSON.parse};function Bdt(){let e="9.0.14",t=globalThis.deck&&globalThis.deck.VERSION;if(t&&t!==e)throw new Error(`deck.gl - multiple versions detected: ${t} vs ${e}`);return t||(Ir.log(1,`deck.gl ${e}`)(),globalThis.deck={...globalThis.deck,VERSION:e,version:e,log:Ir,_registerLoggers:bj},rk([vj,[uk,{imagebitmap:{premultiplyAlpha:"none"}}]])),e}var wj=Bdt();function Jf(e,t){if(!e)throw new Error(t||"shadertools: assertion failed.")}var fk={number:{type:"number",validate(e,t){return Number.isFinite(e)&&typeof t=="object"&&(t.max===void 0||e<=t.max)&&(t.min===void 0||e>=t.min)}},array:{type:"array",validate(e,t){return Array.isArray(e)||ArrayBuffer.isView(e)}}};function Sj(e){let t={};for(let[r,i]of Object.entries(e))t[r]=Ndt(i);return t}function Ej(e,t,r){let i={};for(let[s,n]of Object.entries(t))e&&s in e&&!n.private?(n.validate&&Jf(n.validate(e[s],n),`${r}: invalid ${s}`),i[s]=e[s]):i[s]=n.value;return i}function Ndt(e){let t=Tj(e);if(t!=="object")return{value:e,...fk[t],type:t};if(typeof e=="object")return e?e.type!==void 0?{...e,...fk[e.type],type:e.type}:e.value===void 0?{type:"object",value:e}:(t=Tj(e.value),{...e,...fk[t],type:t}):{type:"object",value:null};throw new Error("props")}function Tj(e){return Array.isArray(e)||ArrayBuffer.isView(e)?"array":typeof e}var Ij=`#ifdef MODULE_LOGDEPTH
logdepth_adjustPosition(gl_Position);
#endif
`,Mj=`#ifdef MODULE_MATERIAL
gl_FragColor = material_filterColor(gl_FragColor);
#endif
#ifdef MODULE_LIGHTING
gl_FragColor = lighting_filterColor(gl_FragColor);
#endif
#ifdef MODULE_FOG
gl_FragColor = fog_filterColor(gl_FragColor);
#endif
#ifdef MODULE_PICKING
gl_FragColor = picking_filterHighlightColor(gl_FragColor);
gl_FragColor = picking_filterPickingColor(gl_FragColor);
#endif
#ifdef MODULE_LOGDEPTH
logdepth_setFragDepth();
#endif
`;var Ldt={vertex:Ij,fragment:Mj},Cj=/void\s+main\s*\([^)]*\)\s*\{\n?/,Pj=/}\n?[^{}]*$/,pk=[],yv="__LUMA_INJECT_DECLARATIONS__";function Rj(e){let t={vertex:{},fragment:{}};for(let r in e){let i=e[r],s=Fdt(r);typeof i=="string"&&(i={order:0,injection:i}),t[s][r]=i}return t}function Fdt(e){let t=e.slice(0,2);switch(t){case"vs":return"vertex";case"fs":return"fragment";default:throw new Error(t)}}function xv(e,t,r,i=!1){let s=t==="vertex";for(let n in r){let o=r[n];o.sort((h,p)=>h.order-p.order),pk.length=o.length;for(let h=0,p=o.length;h<p;++h)pk[h]=o[h].injection;let a=`${pk.join(`
`)}
`;switch(n){case"vs:#decl":s&&(e=e.replace(yv,a));break;case"vs:#main-start":s&&(e=e.replace(Cj,h=>h+a));break;case"vs:#main-end":s&&(e=e.replace(Pj,h=>a+h));break;case"fs:#decl":s||(e=e.replace(yv,a));break;case"fs:#main-start":s||(e=e.replace(Cj,h=>h+a));break;case"fs:#main-end":s||(e=e.replace(Pj,h=>a+h));break;default:e=e.replace(n,h=>h+a)}}return e=e.replace(yv,""),i&&(e=e.replace(/\}\s*$/,n=>n+Ldt[t])),e}var zdt=1,Py=class e{name;vs;fs;getModuleUniforms;dependencies;deprecations;defines;injections;uniforms={};uniformTypes={};static instantiateModules(t){return t.map(r=>{if(r instanceof e)return r;Jf(typeof r!="string",`Shader module use by name is deprecated. Import shader module '${JSON.stringify(r)}' and use it directly.`),r.name||(console.warn("shader module has no name"),r.name=`shader-module-${zdt++}`);let i=new e(r);return i.dependencies=e.instantiateModules(r.dependencies||[]),i})}constructor(t){let{name:r,vs:i,fs:s,dependencies:n=[],uniformTypes:o={},uniformPropTypes:a={},getUniforms:h,deprecations:p=[],defines:g={},inject:v={}}=t;Jf(typeof r=="string"),this.name=r,this.vs=i,this.fs=s,this.getModuleUniforms=h,this.dependencies=e.instantiateModules(n),this.deprecations=this._parseDeprecationDefinitions(p),this.defines=g,this.injections=Rj(v),this.uniformTypes=o,a&&(this.uniforms=Sj(a))}getModuleSource(t){let r;switch(t){case"vertex":r=this.vs||"";break;case"fragment":r=this.fs||"";break;default:Jf(!1)}let i=this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_");return`// ----- MODULE ${this.name} ---------------

#define MODULE_${i}
${r}

`}getUniforms(t,r){return this.getModuleUniforms?this.getModuleUniforms(t,r):Ej(t,this.uniforms,this.name)}getDefines(){return this.defines}checkDeprecations(t,r){this.deprecations.forEach(i=>{i.regex?.test(t)&&(i.deprecated?r.deprecated(i.old,i.new)():r.removed(i.old,i.new)())})}_parseDeprecationDefinitions(t){return t.forEach(r=>{switch(r.type){case"function":r.regex=new RegExp(`\\b${r.old}\\(`);break;default:r.regex=new RegExp(`${r.type} ${r.old};`)}}),t}_defaultGetUniforms(t={}){let r={},i=this.uniforms;for(let s in i){let n=i[s];s in t&&!n.private?(n.validate&&Jf(n.validate(t[s],n),`${this.name}: invalid ${s}`),r[s]=t[s]):r[s]=n.value}return r}};function dk(e){if(e.source&&e.platformInfo.type==="webgpu")return{...e,vs:void 0,fs:void 0};if(!e.vs)throw new Error("no vertex shader");let t=kj(e.platformInfo,e.vs),r;return e.fs&&(r=kj(e.platformInfo,e.fs)),{...e,vs:t,fs:r}}function kj(e,t){if(typeof t=="string")return t;switch(e.type){case"webgpu":if(t?.wgsl)return t.wgsl;throw new Error("WebGPU does not support GLSL shaders");default:if(t?.glsl)return t.glsl;throw new Error("WebGL does not support WGSL shaders")}}function kg(e){let t=Py.instantiateModules(e);return Udt(t)}function Udt(e){let t={},r={};return Dj({modules:e,level:0,moduleMap:t,moduleDepth:r}),Object.keys(r).sort((i,s)=>r[s]-r[i]).map(i=>t[i])}function Dj(e){let{modules:t,level:r,moduleMap:i,moduleDepth:s}=e;if(r>=5)throw new Error("Possible loop in shader dependency graph");for(let n of t)i[n.name]=n,(s[n.name]===void 0||s[n.name]<r)&&(s[n.name]=r);for(let n of t)n.dependencies&&Dj({modules:n.dependencies,level:r+1,moduleMap:i,moduleDepth:s})}function Oj(e){switch(e?.gpu.toLowerCase()){case"apple":return`#define APPLE_GPU
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"nvidia":return`#define NVIDIA_GPU
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
`;case"intel":return`#define INTEL_GPU
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"amd":return`#define AMD_GPU
`;default:return`#define DEFAULT_GPU
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`}}function Nj(e,t){if(Number(e.match(/^#version[ \t]+(\d+)/m)?.[1]||100)!==300)throw new Error("luma.gl v9 only supports GLSL 3.00 shader sources");switch(t){case"vertex":return e=Bj(e,Vdt),e;case"fragment":return e=Bj(e,jdt),e;default:throw new Error(t)}}var Lj=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,`#version 300 es
`],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],Vdt=[...Lj,[mk("attribute"),"in $1"],[mk("varying"),"out $1"]],jdt=[...Lj,[mk("varying"),"in $1"]];function Bj(e,t){for(let[r,i]of t)e=e.replace(r,i);return e}function mk(e){return new RegExp(`\\b${e}[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)`,"g")}function Ak(e,t){let r="";for(let i in e){let s=e[i];if(r+=`void ${s.signature} {
`,s.header&&(r+=`  ${s.header}`),t[i]){let n=t[i];n.sort((o,a)=>o.order-a.order);for(let o of n)r+=`  ${o.injection}
`}s.footer&&(r+=`  ${s.footer}`),r+=`}
`}return r}function gk(e){let t={vertex:{},fragment:{}};for(let r of e){let i,s;typeof r!="string"?(i=r,s=i.hook):(i={},s=r),s=s.trim();let[n,o]=s.split(":"),a=s.replace(/\(.+/,""),h=Object.assign(i,{signature:o});switch(n){case"vs":t.vertex[a]=h;break;case"fs":t.fragment[a]=h;break;default:throw new Error(n)}}return t}function Fj(e,t){return{name:Wdt(e,t),language:"glsl",version:$dt(e)}}function Wdt(e,t="unnamed"){let i=/#define[^\S\r\n]*SHADER_NAME[^\S\r\n]*([A-Za-z0-9_-]+)\s*/.exec(e);return i?i[1]:t}function $dt(e){let t=100,r=e.match(/[^\s]+/g);if(r&&r.length>=2&&r[0]==="#version"){let i=parseInt(r[1],10);Number.isFinite(i)&&(t=i)}if(t!==100&&t!==300)throw new Error(`Invalid GLSL version ${t}`);return t}var Uj=`

${yv}
`,Hdt=`precision highp float;
`;function Vj(e){let t=kg(e.modules||[]);return{source:_k(e.platformInfo,{...e,source:e.source,stage:"vertex",modules:t}),getUniforms:yk(t)}}function jj(e){let t=kg(e.modules||[]);return{vs:_k(e.platformInfo,{...e,source:e.vs,stage:"vertex",modules:t}),fs:_k(e.platformInfo,{...e,source:e.fs,stage:"fragment",modules:t}),getUniforms:yk(t)}}function Wj(e){let{vs:t,fs:r}=e,i=kg(e.modules||[]);return{vs:zj(e.platformInfo,{...e,source:t,stage:"vertex",modules:i}),fs:zj(e.platformInfo,{...e,source:r,stage:"fragment",modules:i}),getUniforms:yk(i)}}function _k(e,t){let{source:r,stage:i,modules:s,hookFunctions:n=[],inject:o={},log:a}=t;Jf(typeof r=="string","shader source must be a string");let h=r,p="",g=gk(n),v={},T={},C={};for(let L in o){let z=typeof o[L]=="string"?{injection:o[L],order:0}:o[L],W=/^(v|f)s:(#)?([\w-]+)$/.exec(L);if(W){let Z=W[2],X=W[3];Z?X==="decl"?T[L]=[z]:C[L]=[z]:v[L]=[z]}else C[L]=[z]}let B=e.type!=="webgpu"?s:[];for(let L of B){a&&L.checkDeprecations(h,a);let z=L.getModuleSource(i,"wgsl");p+=z;let W=L.injections[i];for(let Z in W){let X=/^(v|f)s:#([\w-]+)$/.exec(Z);if(X){let it=X[2]==="decl"?T:C;it[Z]=it[Z]||[],it[Z].push(W[Z])}else v[Z]=v[Z]||[],v[Z].push(W[Z])}}return p+=Uj,p=xv(p,i,T),p+=Ak(g[i],v),p+=h,p=xv(p,i,C),p}function zj(e,t){let{id:r,source:i,stage:s,language:n="glsl",modules:o,defines:a={},hookFunctions:h=[],inject:p={},prologue:g=!0,log:v}=t;Jf(typeof i=="string","shader source must be a string");let T=n==="glsl"?Fj(i).version:-1,C=e.shaderLanguageVersion,B=T===100?"#version 100":"#version 300 es",z=i.split(`
`).slice(1).join(`
`),W={};o.forEach(Mt=>{Object.assign(W,Mt.getDefines())}),Object.assign(W,a);let Z="";switch(n){case"wgsl":break;case"glsl":Z=g?`${B}

// ----- PROLOGUE -------------------------
${qdt({id:r,source:i,stage:s})}
${`#define SHADER_TYPE_${s.toUpperCase()}`}
${Oj(e)}
${s==="fragment"?Hdt:""}

// ----- APPLICATION DEFINES -------------------------

${Ydt(W)}

`:`${B}
`;break}let X=gk(h),q={},it={},nt={};for(let Mt in p){let _t=typeof p[Mt]=="string"?{injection:p[Mt],order:0}:p[Mt],Et=/^(v|f)s:(#)?([\w-]+)$/.exec(Mt);if(Et){let vt=Et[2],Pt=Et[3];vt?Pt==="decl"?it[Mt]=[_t]:nt[Mt]=[_t]:q[Mt]=[_t]}else nt[Mt]=[_t]}for(let Mt of o){v&&Mt.checkDeprecations(z,v);let _t=Mt.getModuleSource(s);Z+=_t;let Et=Mt.injections[s];for(let vt in Et){let Pt=/^(v|f)s:#([\w-]+)$/.exec(vt);if(Pt){let $t=Pt[2]==="decl"?it:nt;$t[vt]=$t[vt]||[],$t[vt].push(Et[vt])}else q[vt]=q[vt]||[],q[vt].push(Et[vt])}}return Z+="// ----- MAIN SHADER SOURCE -------------------------",Z+=Uj,Z=xv(Z,s,it),Z+=Ak(X[s],q),Z+=z,Z=xv(Z,s,nt),n==="glsl"&&T!==C&&(Z=Nj(Z,s)),Z.trim()}function yk(e){return function(r){let i={};for(let s of e){let n=s.getUniforms(r,i);Object.assign(i,n)}return i}}function qdt(e){let{id:t,source:r,stage:i}=e;return t&&r.indexOf("SHADER_NAME")===-1?`
#define SHADER_NAME ${t}_${i}

`:""}function Ydt(e={}){let t="";for(let r in e){let i=e[r];(i||Number.isFinite(i))&&(t+=`#define ${r.toUpperCase()} ${e[r]}
`)}return t}var Dg=class e{static defaultShaderAssembler;_hookFunctions=[];_defaultModules=[];static getDefaultShaderAssembler(){return e.defaultShaderAssembler=e.defaultShaderAssembler||new e,e.defaultShaderAssembler}addDefaultModule(t){this._defaultModules.find(r=>r.name===(typeof t=="string"?t:t.name))||this._defaultModules.push(t)}removeDefaultModule(t){let r=typeof t=="string"?t:t.name;this._defaultModules=this._defaultModules.filter(i=>i.name!==r)}addShaderHook(t,r){r&&(t=Object.assign(r,{hook:t})),this._hookFunctions.push(t)}assembleShader(t){let r=this._getModuleList(t.modules),i=this._hookFunctions,s=dk(t);return{...Vj({platformInfo:t.platformInfo,...s,modules:r,hookFunctions:i}),modules:r}}assembleShaderPair(t){let r=dk(t),i=this._getModuleList(t.modules),s=this._hookFunctions,{platformInfo:n}=t;return{...t.platformInfo.shaderLanguage==="wgsl"?jj({platformInfo:n,...r,modules:i,hookFunctions:s}):Wj({platformInfo:n,...r,modules:i,hookFunctions:s}),modules:i}}_getModuleList(t=[]){let r=new Array(this._defaultModules.length+t.length),i={},s=0;for(let n=0,o=this._defaultModules.length;n<o;++n){let a=this._defaultModules[n],h=a.name;r[s++]=a,i[h]=!0}for(let n=0,o=t.length;n<o;++n){let a=t[n],h=a.name;i[h]||(r[s++]=a,i[h]=!0)}return r.length=s,Py.instantiateModules(r)}};var Xdt=`out vec4 transform_output;
void main() {
transform_output = vec4(0);
}`,Zdt=`#version 300 es
${Xdt}`;function xk(e){let{input:t,inputChannels:r,output:i}=e||{};if(!t)return Zdt;if(!r)throw new Error("inputChannels");let s=Gdt(r),n=$j(t,r);return`#version 300 es
in ${s} ${t};
out vec4 ${i};
void main() {
  ${i} = ${n};
}`}function Gdt(e){switch(e){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error(`invalid channels: ${e}`)}}function $j(e,t){switch(t){case 1:return`vec4(${e}, 0.0, 0.0, 1.0)`;case 2:return`vec4(${e}, 0.0, 1.0)`;case 3:return`vec4(${e}, 1.0)`;case 4:return e;default:throw new Error(`invalid channels: ${t}`)}}var Ce=new gc({id:"luma.gl"});var bk=class{stats=new Map;getStats(t){return this.get(t)}get(t){return this.stats.has(t)||this.stats.set(t,new _c({id:t})),this.stats.get(t)}},Ry=new bk;function Qdt(){let e="9.0.14",t="set luma.log.level=1 (or higher) to trace rendering";if(globalThis.luma&&globalThis.luma.VERSION!==e)throw new Error(`luma.gl - multiple VERSIONs detected: ${globalThis.luma.VERSION} vs ${e}`);return globalThis.luma||(pl()&&Ce.log(1,`${e} - ${t}`)(),globalThis.luma=globalThis.luma||{VERSION:e,version:e,log:Ce,stats:Ry}),e}var Hj=Qdt();function Kdt(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)?e:null}function Sm(e){return Array.isArray(e)?e.length===0||typeof e[0]=="number"?e:null:Kdt(e)}var vk={};function Wl(e="id"){vk[e]=vk[e]||1;let t=vk[e]++;return`${e}-${t}`}function Em(e){let t=!0;for(let r in e){t=!1;break}return t}var Ni=class{static defaultProps={id:"undefined",handle:void 0,userData:void 0};id;props;userData={};_device;destroyed=!1;allocatedBytes=0;_attachedResources=new Set;constructor(t,r,i){if(!t)throw new Error("no device");this._device=t,this.props=Jdt(r,i);let s=this.props.id!=="undefined"?this.props.id:Wl(this[Symbol.toStringTag]);this.props.id=s,this.id=s,this.userData=this.props.userData||{},this.addStats()}destroy(){this.destroyResource()}delete(){return this.destroy(),this}toString(){return`${this[Symbol.toStringTag]||this.constructor.name}(${this.id})`}getProps(){return this.props}attachResource(t){this._attachedResources.add(t)}detachResource(t){this._attachedResources.delete(t)}destroyAttachedResource(t){this._attachedResources.delete(t)&&t.destroy()}destroyAttachedResources(){for(let t of Object.values(this._attachedResources))t.destroy();this._attachedResources=new Set}destroyResource(){this.destroyAttachedResources(),this.removeStats(),this.destroyed=!0}removeStats(){let t=this._device.statsManager.getStats("Resource Counts"),r=this[Symbol.toStringTag];t.get(`${r}s Active`).decrementCount()}trackAllocatedMemory(t,r=this[Symbol.toStringTag]){let i=this._device.statsManager.getStats("Resource Counts");i.get("GPU Memory").addCount(t),i.get(`${r} Memory`).addCount(t),this.allocatedBytes=t}trackDeallocatedMemory(t=this[Symbol.toStringTag]){let r=this._device.statsManager.getStats("Resource Counts");r.get("GPU Memory").subtractCount(this.allocatedBytes),r.get(`${t} Memory`).subtractCount(this.allocatedBytes),this.allocatedBytes=0}addStats(){let t=this._device.statsManager.getStats("Resource Counts"),r=this[Symbol.toStringTag];t.get("Resources Created").incrementCount(),t.get(`${r}s Created`).incrementCount(),t.get(`${r}s Active`).incrementCount()}};function Jdt(e,t){let r={...t};for(let i in e)e[i]!==void 0&&(r[i]=e[i]);return r}var En=class e extends Ni{static defaultProps={...Ni.defaultProps,usage:0,byteLength:0,byteOffset:0,data:null,indexType:"uint16",mappedAtCreation:!1};static MAP_READ=1;static MAP_WRITE=2;static COPY_SRC=4;static COPY_DST=8;static INDEX=16;static VERTEX=32;static UNIFORM=64;static STORAGE=128;static INDIRECT=256;static QUERY_RESOLVE=512;get[Symbol.toStringTag](){return"Buffer"}usage;indexType;updateTimestamp;constructor(t,r){let i={...r};(r.usage||0)&e.INDEX&&!r.indexType&&(r.data instanceof Uint32Array?i.indexType="uint32":r.data instanceof Uint16Array&&(i.indexType="uint16")),super(t,i,e.defaultProps),this.usage=r.usage||0,this.indexType=i.indexType,this.updateTimestamp=t.incrementTimestamp()}readSyncWebGL(t,r){throw new Error("not implemented")}static DEBUG_DATA_MAX_LENGTH=32;debugData=new ArrayBuffer(0);_setDebugData(t,r,i){let s=ArrayBuffer.isView(t)?t.buffer:t,n=Math.min(t?t.byteLength:i,e.DEBUG_DATA_MAX_LENGTH);t===null?this.debugData=new ArrayBuffer(n):r===0&&i===t.byteLength?this.debugData=s.slice(0,n):this.debugData=s.slice(r,r+n)}};function s5(e){let t=qj[e],r=t0t(t),i=e.includes("norm"),s=!i&&!e.startsWith("float"),n=e.startsWith("s");return{dataType:qj[e],byteLength:r,integer:s,signed:n,normalized:i}}function t0t(e){return e0t[e]}var qj={uint8:"uint8",sint8:"sint8",unorm8:"uint8",snorm8:"sint8",uint16:"uint16",sint16:"sint16",unorm16:"uint16",snorm16:"sint16",float16:"float16",float32:"float32",uint32:"uint32",sint32:"sint32"},e0t={uint8:1,sint8:1,uint16:2,sint16:2,float16:2,float32:4,uint32:4,sint32:4};var r0t=["bc1","bc2","bc3","bc4","bc5","bc6","bc7","etc1","etc2","eac","atc","astc","pvrtc"],i0t=/^(rg?b?a?)([0-9]*)([a-z]*)(-srgb)?(-webgl|-unsized)?$/;function Yj(e){return r0t.some(t=>e.startsWith(t))}function o5(e){let t=i0t.exec(e);if(t){let[,r,i,s,n,o]=t;if(r){let a=`${s}${i}`,h=s5(a);return{format:r,components:r.length,srgb:n==="-srgb",unsized:o==="-unsized",webgl:o==="-webgl",...h}}}return s0t(e)}var n0t={"rgba4unorm-webgl":{format:"rgba",bpp:2},"rgb565unorm-webgl":{format:"rgb",bpp:2},"rgb5a1unorm-webgl":{format:"rgba",bbp:2},rgb9e5ufloat:{format:"rgb",bbp:4},rg11b10ufloat:{format:"rgb",bbp:4},rgb10a2unorm:{format:"rgba",bbp:4},"rgb10a2uint-webgl":{format:"rgba",bbp:4},stencil8:{components:1,bpp:1,a:"stencil"},depth16unorm:{components:1,bpp:2,a:"depth"},depth24plus:{components:1,bpp:3,a:"depth"},depth32float:{components:1,bpp:4,a:"depth"},"depth24plus-stencil8":{components:2,bpp:4,a:"depth-stencil"},"depth24unorm-stencil8":{components:2,bpp:4,a:"depth-stencil"},"depth32float-stencil8":{components:2,bpp:4,a:"depth-stencil"}};function s0t(e){let t=n0t[e];if(!t)throw new Error(`Unknown format ${e}`);return{format:t.format||"",components:t.components||t.format?.length||1,byteLength:t.bpp||1,srgb:!1,unsized:!1}}var bv=class{},vv=class{features;disabledFeatures;constructor(t=[],r){this.features=new Set(t),this.disabledFeatures=r||{}}*[Symbol.iterator](){yield*this.features}has(t){return!this.disabledFeatures[t]&&this.features.has(t)}},Cd=class e{static defaultProps={id:null,canvas:null,container:null,manageState:!0,width:800,height:600,requestMaxLimits:!0,debug:!!Ce.get("debug"),spector:!!(Ce.get("spector")||Ce.get("spectorjs")),break:[],initalizeFeatures:!0,disabledFeatures:{"compilation-status-async-webgl":!0},gl:null,onError:t=>Ce.error(t.message)};get[Symbol.toStringTag](){return"Device"}static VERSION=Hj;constructor(t){this.props={...e.defaultProps,...t},this.id=this.props.id||Wl(this[Symbol.toStringTag].toLowerCase())}id;props;userData={};statsManager=Ry;_lumaData={};isTextureFormatCompressed(t){return Yj(t)}loseDevice(){return!1}getCanvasContext(){if(!this.canvasContext)throw new Error("Device has no CanvasContext");return this.canvasContext}createTexture(t){return(t instanceof Promise||typeof t=="string")&&(t={data:t}),this._createTexture(t)}createCommandEncoder(t={}){throw new Error("not implemented")}readPixelsToArrayWebGL(t,r){throw new Error("not implemented")}readPixelsToBufferWebGL(t,r){throw new Error("not implemented")}setParametersWebGL(t){throw new Error("not implemented")}getParametersWebGL(t){throw new Error("not implemented")}withParametersWebGL(t,r){throw new Error("not implemented")}clearWebGL(t){throw new Error("not implemented")}resetWebGL(){throw new Error("not implemented")}timestamp=0;incrementTimestamp(){return this.timestamp++}onError(t){this.props.onError(t)}_getBufferProps(t){(t instanceof ArrayBuffer||ArrayBuffer.isView(t))&&(t={data:t});let r={...t};return(t.usage||0)&En.INDEX&&!t.indexType&&(t.data instanceof Uint32Array?r.indexType="uint32":t.data instanceof Uint16Array?r.indexType="uint16":Ce.warn("indices buffer content must be of integer type")()),r}};function Qi(e,t){if(!e)throw new Error(t||"luma.gl: assertion failed.")}var wv=new Map,Pd=class e{static defaultProps={...Cd.defaultProps,type:"best-available",devices:void 0};static stats=Ry;static log=Ce;static registerDevices(t){for(let r of t)Qi(r.type&&r.isSupported&&r.create),wv.set(r.type,r)}static getAvailableDevices(){return Array.from(wv).map(t=>t.type)}static getSupportedDevices(){return Array.from(wv).filter(t=>t.isSupported()).map(t=>t.type)}static setDefaultDeviceProps(t){Object.assign(Cd.defaultProps,t)}static async attachDevice(t){let r=Xj(t.devices)||wv;if(t.handle instanceof WebGL2RenderingContext){let i=r.get("webgl");if(i)return await i.attach(t.handle)}if(t.handle===null){let i=r.get("unknown");if(i)return await i.attach(null)}throw new Error("Failed to attach device. Ensure `@luma.gl/webgl` and/or `@luma.gl/webgpu` modules are imported.")}static async createDevice(t={}){t={...e.defaultProps,...t},t.gl&&(t.type="webgl");let r=Xj(t.devices)||wv;switch(t.type){case"webgpu":let i=r.get("webgpu");if(i)return await i.create(t);break;case"webgl":let s=r.get("webgl");if(s)return await s.create(t);break;case"unknown":let n=r.get("unknown");if(n)return await n.create(t);break;case"best-available":if(i=r.get("webgpu"),i?.isSupported?.())return await i.create(t);if(s=r.get("webgl"),s?.isSupported?.())return await s.create(t);break}throw new Error("No matching device found. Ensure `@luma.gl/webgl` and/or `@luma.gl/webgpu` modules are imported.")}static enforceWebGL2(t=!0){let r=HTMLCanvasElement.prototype;if(!t&&r.originalGetContext){r.getContext=r.originalGetContext,r.originalGetContext=void 0;return}r.originalGetContext=r.getContext,r.getContext=function(i,s){return i==="webgl"||i==="experimental-webgl"?this.originalGetContext("webgl2",s):this.originalGetContext(i,s)}}};function Xj(e){if(!e||e?.length===0)return null;let t=new Map;for(let r of e)t.set(r.type,r);return t}var o0t=pl()&&typeof document<"u",a5=()=>o0t&&document.readyState==="complete",a0t={canvas:null,width:800,height:600,useDevicePixels:!0,autoResize:!0,container:null,visible:!0,colorSpace:"srgb",alphaMode:"opaque"},Og=class{id;props;canvas;htmlCanvas;offscreenCanvas;type;width=1;height=1;resizeObserver;_canvasSizeInfo={clientWidth:0,clientHeight:0,devicePixelRatio:1};static get isPageLoaded(){return a5()}static pageLoaded=l0t();constructor(t){if(this.props={...a0t,...t},t=this.props,!pl()){this.id="node-canvas-context",this.type="node",this.width=this.props.width,this.height=this.props.height,this.canvas=null;return}if(t.canvas)typeof t.canvas=="string"?this.canvas=u0t(t.canvas):this.canvas=t.canvas;else{let r=h0t(t),i=c0t(t?.container||null);i.insertBefore(r,i.firstChild),this.canvas=r,t?.visible||(this.canvas.style.visibility="hidden")}this.canvas instanceof HTMLCanvasElement?(this.id=this.canvas.id,this.type="html-canvas",this.htmlCanvas=this.canvas):(this.id="offscreen-canvas",this.type="offscreen-canvas",this.offscreenCanvas=this.canvas),this.canvas instanceof HTMLCanvasElement&&t.autoResize&&(this.resizeObserver=new ResizeObserver(r=>{for(let i of r)i.target===this.canvas&&this.update()}),this.resizeObserver.observe(this.canvas))}getDevicePixelRatio(t){return typeof OffscreenCanvas<"u"&&this.canvas instanceof OffscreenCanvas||(t=t===void 0?this.props.useDevicePixels:t,!t||t<=0)?1:t===!0?typeof window<"u"&&window.devicePixelRatio||1:t}getPixelSize(){switch(this.type){case"node":return[this.width,this.height];case"offscreen-canvas":return[this.canvas.width,this.canvas.height];case"html-canvas":let t=this.getDevicePixelRatio(),r=this.canvas;return r.parentElement?[r.clientWidth*t,r.clientHeight*t]:[this.canvas.width,this.canvas.height];default:throw new Error(this.type)}}getAspect(){let[t,r]=this.getPixelSize();return t/r}cssToDeviceRatio(){try{let[t]=this.getDrawingBufferSize(),{clientWidth:r}=this._canvasSizeInfo;return r?t/r:1}catch{return 1}}cssToDevicePixels(t,r=!0){let i=this.cssToDeviceRatio(),[s,n]=this.getDrawingBufferSize();return f0t(t,i,s,n,r)}setDevicePixelRatio(t,r={}){if(!this.htmlCanvas)return;let i="width"in r?r.width:this.htmlCanvas.clientWidth,s="height"in r?r.height:this.htmlCanvas.clientHeight;(!i||!s)&&(Ce.log(1,"Canvas clientWidth/clientHeight is 0")(),t=1,i=this.htmlCanvas.width||1,s=this.htmlCanvas.height||1);let n=this._canvasSizeInfo;if(n.clientWidth!==i||n.clientHeight!==s||n.devicePixelRatio!==t){let o=t,a=Math.floor(i*o),h=Math.floor(s*o);this.htmlCanvas.width=a,this.htmlCanvas.height=h;let[p,g]=this.getDrawingBufferSize();(p!==a||g!==h)&&(o=Math.min(p/i,g/s),this.htmlCanvas.width=Math.floor(i*o),this.htmlCanvas.height=Math.floor(s*o),Ce.warn("Device pixel ratio clamped")()),this._canvasSizeInfo.clientWidth=i,this._canvasSizeInfo.clientHeight=s,this._canvasSizeInfo.devicePixelRatio=t}}getDrawingBufferSize(){let t=this.device.gl;if(!t)throw new Error("canvas size");return[t.drawingBufferWidth,t.drawingBufferHeight]}_setAutoCreatedCanvasId(t){this.htmlCanvas?.id==="lumagl-auto-created-canvas"&&(this.htmlCanvas.id=t)}};function l0t(){return a5()||typeof window>"u"?Promise.resolve():new Promise(e=>{window.addEventListener("load",()=>e())})}function c0t(e){if(typeof e=="string"){let t=document.getElementById(e);if(!t&&!a5())throw new Error(`Accessing '${e}' before page was loaded`);if(!t)throw new Error(`${e} is not an HTML element`);return t}else if(e)return e;return document.body}function u0t(e){let t=document.getElementById(e);if(!t&&!a5())throw new Error(`Accessing '${e}' before page was loaded`);if(!(t instanceof HTMLCanvasElement))throw new Error("Object is not a canvas element");return t}function h0t(e){let{width:t,height:r}=e,i=document.createElement("canvas");return i.id="lumagl-auto-created-canvas",i.width=t||1,i.height=r||1,i.style.width=Number.isFinite(t)?`${t}px`:"100%",i.style.height=Number.isFinite(r)?`${r}px`:"100%",i}function f0t(e,t,r,i,s){let n=e,o=Zj(n[0],t,r),a=Gj(n[1],t,i,s),h=Zj(n[0]+1,t,r),p=h===r-1?h:h-1;h=Gj(n[1]+1,t,i,s);let g;return s?(h=h===0?h:h+1,g=a,a=h):g=h===i-1?h:h-1,{x:o,y:a,width:Math.max(p-o+1,1),height:Math.max(g-a+1,1)}}function Zj(e,t,r){return Math.min(Math.round(e*t),r-1)}function Gj(e,t,r,i){return i?Math.max(0,r-1-Math.round(e*t)):Math.min(Math.round(e*t),r-1)}var jo=class e extends Ni{static defaultProps={...Ni.defaultProps,data:null,dimension:"2d",format:"rgba8unorm",width:void 0,height:void 0,depth:1,mipmaps:!0,compressed:!1,usage:0,mipLevels:void 0,samples:void 0,type:void 0,sampler:{},view:void 0};static COPY_SRC=1;static COPY_DST=2;static TEXTURE_BINDING=4;static STORAGE_BINDING=8;static RENDER_ATTACHMENT=16;get[Symbol.toStringTag](){return"Texture"}dimension;format;width;height;depth;updateTimestamp;constructor(t,r,i=e.defaultProps){super(t,r,i),this.dimension=this.props.dimension,this.format=this.props.format,this.width=this.props.width,this.height=this.props.height,this.depth=this.props.depth,this.updateTimestamp=t.incrementTimestamp()}};var Bg=class e extends Ni{static defaultProps={...Ni.defaultProps,format:void 0,dimension:void 0,aspect:"all",baseMipLevel:0,mipLevelCount:void 0,baseArrayLayer:0,arrayLayerCount:void 0};get[Symbol.toStringTag](){return"TextureView"}constructor(t,r){super(t,r,e.defaultProps)}};function Kj(e,t,r){let i="",s=t.split(/\r?\n/),n=e.slice().sort((o,a)=>o.lineNum-a.lineNum);switch(r?.showSourceCode||"no"){case"all":let o=0;for(let a=1;a<=s.length;a++)for(i+=Jj(s[a-1],a,r);n.length>o&&n[o].lineNum===a;){let h=n[o++];i+=Qj(h,s,h.lineNum,{...r,inlineSource:!1})}return i;case"issues":case"no":for(let a of e)i+=Qj(a,s,a.lineNum,{inlineSource:r?.showSourceCode!=="no"});return i}}function Qj(e,t,r,i){if(i?.inlineSource){let s=p0t(t,r),n=e.linePos>0?`${" ".repeat(e.linePos+5)}^^^
`:"";return`
${s}${n}${e.type.toUpperCase()}: ${e.message}

`}return i?.html?`<div class='luma-compiler-log-error' style="color:red;"><b> ${e.type.toUpperCase()}: ${e.message}</b></div>`:`${e.type.toUpperCase()}: ${e.message}`}function p0t(e,t,r){let i="";for(let s=t-2;s<=t;s++){let n=e[s-1];n!==void 0&&(i+=Jj(n,t,r))}return i}function Jj(e,t,r){let i=r?.html?m0t(e):e;return`${d0t(String(t),4)}: ${i}${r?.html?"<br/>":`
`}`}function d0t(e,t){let r="";for(let i=e.length;i<t;++i)r+=" ";return r+e}function m0t(e){return e.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;")}function wk(e,t){return{name:A0t(e,t),language:"glsl",version:g0t(e)}}function A0t(e,t="unnamed"){let i=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/.exec(e);return i?i[1]:t}function g0t(e){let t=100,r=e.match(/[^\s]+/g);if(r&&r.length>=2&&r[0]==="#version"){let i=parseInt(r[1],10);Number.isFinite(i)&&(t=i)}return t}var Ng=class e extends Ni{static defaultProps={...Ni.defaultProps,language:"auto",stage:void 0,source:"",sourceMap:null,entryPoint:"main",debug:"errors"};get[Symbol.toStringTag](){return"Shader"}stage;source;compilationStatus="pending";constructor(t,r){super(t,{id:_0t(r),...r},e.defaultProps),this.stage=this.props.stage,this.source=this.props.source}getCompilationInfoSync(){return null}getTranslatedSource(){return null}async debugShader(t=this.props.debug){switch(t){case"never":return;case"errors":if(this.compilationStatus==="success")return;break;case"warnings":case"always":break}let r=await this.getCompilationInfo();this.props.debug==="warnings"&&r?.length===0||this._displayShaderLog(r)}_displayShaderLog(t){if(typeof document>"u"||!document?.createElement)return;let r=wk(this.source).name,i=`${this.stage} ${r}`,s=Kj(t,this.source,{showSourceCode:"all",html:!0}),n=this.getTranslatedSource();n&&(s+=`<br /><br /><h1>Translated Source</h1><br /><br /><code style="user-select:text;"><pre>${n}</pre></code>`);let o=document.createElement("Button");o.innerHTML=`
<h1>Shader Compilation Error in ${i}</h1><br /><br />
<code style="user-select:text;"><pre>
${s}
</pre></code>`,o.style.top="10px",o.style.left="10px",o.style.position="absolute",o.style.zIndex="9999",o.style.width="100%",o.style.textAlign="left",document.body.appendChild(o);let a=document.getElementsByClassName("luma-compiler-log-error");a[0]?.scrollIntoView&&a[0].scrollIntoView(),o.onclick=()=>{let h=`data:text/plain,${encodeURIComponent(this.source)}`;navigator.clipboard.writeText(h)}}};function _0t(e){return wk(e.source).name||e.id||Wl(`unnamed ${e.stage}-shader`)}var Lg=class e extends Ni{static defaultProps={...Ni.defaultProps,type:"color-sampler",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge",addressModeW:"clamp-to-edge",magFilter:"nearest",minFilter:"nearest",mipmapFilter:"nearest",lodMinClamp:0,lodMaxClamp:32,compare:"less-equal",maxAnisotropy:1};get[Symbol.toStringTag](){return"Sampler"}constructor(t,r){super(t,r,e.defaultProps)}};var Fg=class e extends Ni{static defaultProps={...Ni.defaultProps,width:1,height:1,colorAttachments:[],depthStencilAttachment:null};get[Symbol.toStringTag](){return"Framebuffer"}width;height;colorAttachments=[];depthStencilAttachment=null;constructor(t,r={}){super(t,r,e.defaultProps),this.width=this.props.width,this.height=this.props.height}resize(t){let r=!t;if(t){let[i,s]=Array.isArray(t)?t:[t.width,t.height];r=r||s!==this.height||i!==this.width,this.width=i,this.height=s}r&&(Ce.log(2,`Resizing framebuffer ${this.id} to ${this.width}x${this.height}`)(),this.resizeAttachments(this.width,this.height))}autoCreateAttachmentTextures(){if(this.props.colorAttachments.length===0&&!this.props.depthStencilAttachment)throw new Error("Framebuffer has noattachments");this.colorAttachments=this.props.colorAttachments.map(r=>{if(typeof r=="string"){let i=this.createColorTexture(r);return this.attachResource(i),i.view}return r instanceof jo?r.view:r});let t=this.props.depthStencilAttachment;if(t)if(typeof t=="string"){let r=this.createDepthStencilTexture(t);this.attachResource(r),this.depthStencilAttachment=r.view}else t instanceof jo?this.depthStencilAttachment=t.view:this.depthStencilAttachment=t}createColorTexture(t){return this.device.createTexture({id:"color-attachment",usage:jo.RENDER_ATTACHMENT,format:t,width:this.width,height:this.height})}createDepthStencilTexture(t){return this.device.createTexture({id:"depth-stencil-attachment",usage:jo.RENDER_ATTACHMENT,format:t,width:this.width,height:this.height})}resizeAttachments(t,r){for(let i=0;i<this.colorAttachments.length;++i)if(this.colorAttachments[i]){let s=this.device._createTexture({...this.colorAttachments[i].props,width:t,height:r});this.destroyAttachedResource(this.colorAttachments[i]),this.colorAttachments[i]=s.view,this.attachResource(s.view)}if(this.depthStencilAttachment){let i=this.device._createTexture({...this.depthStencilAttachment.props,width:t,height:r});this.destroyAttachedResource(this.depthStencilAttachment),this.depthStencilAttachment=i.view,this.attachResource(i)}}};var tp=class e extends Ni{static defaultProps={...Ni.defaultProps,vs:null,vertexEntryPoint:"vertexMain",vsConstants:{},fs:null,fragmentEntryPoint:"fragmentMain",fsConstants:{},shaderLayout:null,bufferLayout:[],topology:"triangle-list",parameters:{},bindings:{},uniforms:{}};get[Symbol.toStringTag](){return"RenderPipeline"}shaderLayout;bufferLayout;linkStatus="pending";hash="";constructor(t,r){super(t,r,e.defaultProps),this.shaderLayout=this.props.shaderLayout,this.bufferLayout=this.props.bufferLayout||[]}setUniformsWebGL(t){throw new Error("Use uniform blocks")}};var Tv=class e extends Ni{static defaultProps={...Ni.defaultProps,framebuffer:null,parameters:void 0,clearColor:[0,0,0,0],clearDepth:1,clearStencil:0,depthReadOnly:!1,stencilReadOnly:!1,discard:!1,occlusionQuerySet:void 0,timestampQuerySet:void 0,beginTimestampIndex:void 0,endTimestampIndex:void 0};get[Symbol.toStringTag](){return"RenderPass"}constructor(t,r){super(t,r,e.defaultProps)}};var ky=class e extends Ni{static defaultProps={...Ni.defaultProps,shader:void 0,entryPoint:void 0,constants:{},shaderLayout:void 0};get[Symbol.toStringTag](){return"ComputePipeline"}hash="";constructor(t,r){super(t,r,e.defaultProps)}};var Sv=class e extends Ni{static defaultProps={...Ni.defaultProps,measureExecutionTime:void 0};get[Symbol.toStringTag](){return"CommandEncoder"}constructor(t,r){super(t,r,e.defaultProps)}};var Ev=class e extends Ni{static defaultProps={...Ni.defaultProps};get[Symbol.toStringTag](){return"CommandBuffer"}constructor(t,r){super(t,r,e.defaultProps)}};function tW(e){let[t,r]=x0t[e],i=t==="i32"||t==="u32",s=t!=="u32",n=b0t[t]*r,o=y0t(t,r);return{dataType:t,components:r,defaultVertexFormat:o,byteLength:n,integer:i,signed:s}}function y0t(e,t){let r;switch(e){case"f32":r="float32";break;case"i32":r="sint32";break;case"u32":r="uint32";break;case"f16":return t<=2?"float16x2":"float16x4"}return t===1?r:`${r}x${t}`}var x0t={f32:["f32",1],"vec2<f32>":["f32",2],"vec3<f32>":["f32",3],"vec4<f32>":["f32",4],f16:["f16",1],"vec2<f16>":["f16",2],"vec3<f16>":["f16",3],"vec4<f16>":["f16",4],i32:["i32",1],"vec2<i32>":["i32",2],"vec3<i32>":["i32",3],"vec4<i32>":["i32",4],u32:["u32",1],"vec2<u32>":["u32",2],"vec3<u32>":["u32",3],"vec4<u32>":["u32",4]},b0t={f32:4,f16:2,i32:4,u32:4};function Tk(e){let t;e.endsWith("-webgl")&&(e.replace("-webgl",""),t=!0);let[r,i]=e.split("x"),s=r,n=i?parseInt(i):1,o=s5(s),a={type:s,components:n,byteLength:o.byteLength*n,integer:o.integer,signed:o.signed,normalized:o.normalized};return t&&(a.webglOnly=!0),a}function l5(e,t){let r={};for(let i of e.attributes)r[i.name]=v0t(e,t,i.name);return r}function eW(e,t,r=16){let i=l5(e,t),s=new Array(r).fill(null);for(let n of Object.values(i))s[n.location]=n;return s}function v0t(e,t,r){let i=w0t(e,r),s=T0t(t,r);if(!i)return null;let n=tW(i.type),o=s?.vertexFormat||n.defaultVertexFormat,a=Tk(o);return{attributeName:s?.attributeName||i.name,bufferName:s?.bufferName||i.name,location:i.location,shaderType:i.type,shaderDataType:n.dataType,shaderComponents:n.components,vertexFormat:o,bufferDataType:a.type,bufferComponents:a.components,normalized:a.normalized,integer:n.integer,stepMode:s?.stepMode||i.stepMode,byteOffset:s?.byteOffset||0,byteStride:s?.byteStride||0}}function w0t(e,t){let r=e.attributes.find(i=>i.name===t);return r||Ce.warn(`shader layout attribute "${t}" not present in shader`),r||null}function T0t(e,t){S0t(e);let r=E0t(e,t);return r||(r=I0t(e,t),r)?r:(Ce.warn(`layout for attribute "${t}" not present in buffer layout`),null)}function S0t(e){for(let t of e)(t.attributes&&t.format||!t.attributes&&!t.format)&&Ce.warn(`BufferLayout ${name} must have either 'attributes' or 'format' field`)}function E0t(e,t){for(let r of e)if(r.format&&r.name===t)return{attributeName:r.name,bufferName:t,stepMode:r.stepMode,vertexFormat:r.format,byteOffset:0,byteStride:r.byteStride||0};return null}function I0t(e,t){for(let r of e){let i=r.byteStride;if(typeof r.byteStride!="number")for(let n of r.attributes||[]){let o=Tk(n.format);i+=o.byteLength}let s=r.attributes?.find(n=>n.attribute===t);if(s)return{attributeName:s.attribute,bufferName:r.name,stepMode:r.stepMode,vertexFormat:s.format,byteOffset:s.byteOffset,byteStride:i}}return null}function Sk(e,t){let r={...e,attributes:e.attributes.map(i=>({...i}))};for(let i of t?.attributes||[]){let s=r.attributes.find(n=>n.name===i.name);s?(s.type=i.type||s.type,s.stepMode=i.stepMode||s.stepMode):Ce.warn(`shader layout attribute ${i.name} not present in shader`)}return r}var Iv=class e extends Ni{static defaultProps={...Ni.defaultProps,renderPipeline:null};get[Symbol.toStringTag](){return"VertexArray"}maxVertexAttributes;attributeInfos;indexBuffer=null;attributes;constructor(t,r){super(t,r,e.defaultProps),this.maxVertexAttributes=t.limits.maxVertexAttributes,this.attributes=new Array(this.maxVertexAttributes).fill(null),this.attributeInfos=eW(r.renderPipeline.shaderLayout,r.renderPipeline.bufferLayout,this.maxVertexAttributes)}setConstantWebGL(t,r){throw new Error("constant attributes not supported")}};var Mv=class e extends Ni{static defaultProps={...Ni.defaultProps,layout:void 0,buffers:{}};get[Symbol.toStringTag](){return"TransformFeedback"}constructor(t,r){super(t,r,e.defaultProps)}};var Cv=class e extends Ni{static defaultProps={...Ni.defaultProps,type:void 0,count:void 0};get[Symbol.toStringTag](){return"QuerySet"}constructor(t,r){super(t,r,e.defaultProps)}};var M0t={f32:{type:"f32",components:1},i32:{type:"i32",components:1},u32:{type:"u32",components:1},"vec2<f32>":{type:"f32",components:2},"vec3<f32>":{type:"f32",components:3},"vec4<f32>":{type:"f32",components:4},"vec2<i32>":{type:"i32",components:2},"vec3<i32>":{type:"i32",components:3},"vec4<i32>":{type:"i32",components:4},"vec2<u32>":{type:"u32",components:2},"vec3<u32>":{type:"u32",components:3},"vec4<u32>":{type:"u32",components:4},"mat2x2<f32>":{type:"f32",components:4},"mat2x3<f32>":{type:"f32",components:6},"mat2x4<f32>":{type:"f32",components:8},"mat3x2<f32>":{type:"f32",components:6},"mat3x3<f32>":{type:"f32",components:9},"mat3x4<f32>":{type:"f32",components:12},"mat4x2<f32>":{type:"f32",components:8},"mat4x3<f32>":{type:"f32",components:12},"mat4x4<f32>":{type:"f32",components:16}};function rW(e){let t=M0t[e];return Qi(e),t}function iW(e,t){switch(t){case 1:return e;case 2:return e+e%2;default:return e+(4-e%4)%4}}var c5;function u5(e){return(!c5||c5.byteLength<e)&&(c5=new ArrayBuffer(e)),c5}function Ek(e,t){let r=u5(e.BYTES_PER_ELEMENT*t);return new e(r,0,t)}function Ik(e){let{target:t,source:r,start:i=0,count:s=1}=e,n=r.length,o=s*n,a=0;for(let h=i;a<n;a++)t[h++]=r[a];for(;a<o;)a<o-a?(t.copyWithin(i+a,i,i+a),a*=2):(t.copyWithin(i+a,i,i+o-a),a=o);return e.target}var nW=1024,h5=class{layout={};byteLength;constructor(t){let r=0;for(let[s,n]of Object.entries(t)){let o=rW(n),{type:a,components:h}=o;r=iW(r,h);let p=r;r+=h,this.layout[s]={type:a,size:h,offset:p}}r+=(4-r%4)%4;let i=r*4;this.byteLength=Math.max(i,nW)}getData(t){let r=Math.max(this.byteLength,nW),i=u5(r),s={i32:new Int32Array(i),u32:new Uint32Array(i),f32:new Float32Array(i),f16:new Uint16Array(i)};for(let[n,o]of Object.entries(t)){let a=this.layout[n];if(!a){Ce.warn(`Supplied uniform value ${n} not present in uniform block layout`)();continue}let{type:h,size:p,offset:g}=a,v=s[h];if(p===1){if(typeof o!="number"&&typeof o!="boolean"){Ce.warn(`Supplied value for single component uniform ${n} is not a number: ${o}`)();continue}v[g]=Number(o)}else{let T=Sm(o);if(!T){Ce.warn(`Supplied value for multi component / array uniform ${n} is not a numeric array: ${o}`)();continue}v.set(T,g)}}return new Uint8Array(i)}has(t){return!!this.layout[t]}get(t){return this.layout[t]}};function sW(e,t,r=16){if(e!==t)return!1;let i=Sm(e);if(!i)return!1;let s=Sm(t);if(s&&i.length===s.length){for(let n=0;n<i.length;++n)if(s[n]!==i[n])return!1}return!0}function oW(e){let t=Sm(e);return t?t.slice():e}var f5=class{name;uniforms={};modifiedUniforms={};modified=!0;bindingLayout={};needsRedraw="initialized";constructor(t){if(this.name=t?.name,t?.name&&t?.shaderLayout){let r=t?.shaderLayout.bindings?.find(s=>s.type==="uniform"&&s.name===t?.name);if(!r)throw new Error(t?.name);let i=r;for(let s of i.uniforms||[])this.bindingLayout[s.name]=s}}setUniforms(t){for(let[r,i]of Object.entries(t))this._setUniform(r,i),this.needsRedraw||this.setNeedsRedraw(`${this.name}.${r}=${i}`)}setNeedsRedraw(t){this.needsRedraw=this.needsRedraw||t}getAllUniforms(){return this.modifiedUniforms={},this.needsRedraw=!1,this.uniforms||{}}_setUniform(t,r){sW(this.uniforms[t],r)||(this.uniforms[t]=oW(r),this.modifiedUniforms[t]=!0,this.modified=!0)}};var Pv=class{uniformBlocks=new Map;uniformBufferLayouts=new Map;uniformBuffers=new Map;constructor(t){for(let[r,i]of Object.entries(t)){let s=r,n=new h5(i.uniformTypes||{});this.uniformBufferLayouts.set(s,n);let o=new f5({name:r});o.setUniforms(i.defaultUniforms||{}),this.uniformBlocks.set(s,o)}}destroy(){for(let t of this.uniformBuffers.values())t.destroy()}setUniforms(t){for(let[r,i]of Object.entries(t))this.uniformBlocks.get(r).setUniforms(i);this.updateUniformBuffers()}getUniformBufferByteLength(t){return this.uniformBufferLayouts.get(t).byteLength}getUniformBufferData(t){let r=this.uniformBlocks.get(t).getAllUniforms();return this.uniformBufferLayouts.get(t).getData(r)}createUniformBuffer(t,r,i){i&&this.setUniforms(i);let s=this.getUniformBufferByteLength(r),n=t.createBuffer({usage:En.UNIFORM|En.COPY_DST,byteLength:s}),o=this.getUniformBufferData(r);return n.write(o),n}getManagedUniformBuffer(t,r){if(!this.uniformBuffers.get(r)){let i=this.getUniformBufferByteLength(r),s=t.createBuffer({usage:En.UNIFORM|En.COPY_DST,byteLength:i});this.uniformBuffers.set(r,s)}return this.uniformBuffers.get(r)}updateUniformBuffers(){let t=!1;for(let r of this.uniformBlocks.keys()){let i=this.updateUniformBuffer(r);t||=i}return t&&Ce.log(3,`UniformStore.updateUniformBuffers(): ${t}`)(),t}updateUniformBuffer(t){let r=this.uniformBlocks.get(t),i=this.uniformBuffers.get(t),s=!1;if(i&&r.needsRedraw){s||=r.needsRedraw;let n=this.getUniformBufferData(t);this.uniformBuffers.get(t).write(n);let a=this.uniformBlocks.get(t).getAllUniforms();Ce.log(4,`Writing to uniform buffer ${String(t)}`,n,a)()}return s}};function p5(e){let t=ArrayBuffer.isView(e)?e.constructor:e;switch(t){case Float32Array:return"float32";case Uint16Array:return"uint16";case Uint32Array:return"uint32";case Uint8Array:case Uint8ClampedArray:return"uint8";case Int8Array:return"sint8";case Int16Array:return"sint16";case Int32Array:return"sint32";default:throw new Error(t.constructor.name)}}function Rv(e){switch(e){case"float32":return Float32Array;case"uint32":return Uint32Array;case"sint32":return Int32Array;case"uint16":case"unorm16":return Uint16Array;case"sint16":case"snorm16":return Int16Array;case"uint8":case"unorm8":return Uint8Array;case"sint8":case"snorm8":return Int8Array;default:throw new Error(e)}}function Mk(e,t,r){if(!t||t>4)throw new Error(`size ${t}`);let i=t,s=p5(e);if(s==="uint8"||s==="sint8"){if(i===1||i===3)throw new Error(`size: ${t}`);return r&&(s=s.replace("int","norm")),`${s}x${i}`}if(s==="uint16"||s==="sint16"){if(i===1||i===3)throw new Error(`size: ${t}`);return r&&(s=s.replace("int","norm")),`${s}x${i}`}return i===1?s:`${s}x${i}`}function aW(e){return Sm(e)!==null||typeof e=="number"||typeof e=="boolean"}function kv(e){let t={bindings:{},uniforms:{}};return Object.keys(e).forEach(r=>{let i=e[r];aW(i)?t.uniforms[r]=i:t.bindings[r]=i}),t}function Ck(e,t,r){let{removedProps:i={},deprecatedProps:s={},replacedProps:n={}}=r;for(let a in i)if(a in t){let p=i[a]?`${e}.${i[a]}`:"N/A";Ce.removed(`${e}.${a}`,p)()}for(let a in s)if(a in t){let h=s[a];Ce.deprecated(`${e}.${a}`,`${e}.${h}`)()}let o=null;for(let[a,h]of Object.entries(n))a in t&&(Ce.deprecated(`${e}.${a}`,`${e}.${h}`)(),o=o||Object.assign({},t),o[h]=t[a],delete o[a]);return o||t}var C0t="";async function Pk(e,t){return await new Promise((r,i)=>{try{let s=new Image;s.onload=()=>r(s),s.onerror=()=>i(new Error(`Could not load image ${e}.`)),s.crossOrigin=t?.crossOrigin||"anonymous",s.src=e.startsWith("http")?e:C0t+e}catch(s){i(s)}})}async function Dv(e,t){let r=document.getElementsByTagName("head")[0];if(!r)throw new Error("loadScript");let i=document.createElement("script");return i.setAttribute("type","text/javascript"),i.setAttribute("src",e),t&&(i.id=t),new Promise((s,n)=>{i.onload=s,i.onerror=o=>n(new Error(`Unable to load script '${e}': ${o}`)),r.appendChild(i)})}function Ov(e,t,r){if(e===t)return!0;if(!r||!e||!t)return!1;if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(!Ov(e[i],t[i],r-1))return!1;return!0}if(Array.isArray(t))return!1;if(typeof e=="object"&&typeof t=="object"){let i=Object.keys(e),s=Object.keys(t);if(i.length!==s.length)return!1;for(let n of i)if(!t.hasOwnProperty(n)||!Ov(e[n],t[n],r-1))return!1;return!0}return!1}function Rk(e){return typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame(e):setTimeout(e,1e3/60)}function kk(e){return typeof window<"u"&&window.cancelAnimationFrame?window.cancelAnimationFrame(e):clearTimeout(e)}var Dk=class{constructor(){this.constants=new Map,this.aliases=new Map,this.structs=new Map}},kd=class{constructor(){}get isAstNode(){return!0}get astNodeType(){return""}evaluate(t){throw new Error("Cannot evaluate node")}evaluateString(t){return this.evaluate(t).toString()}},js=class extends kd{constructor(){super()}},d5=class extends js{constructor(t,r,i,s){super(),this.name=t,this.args=r,this.returnType=i,this.body=s}get astNodeType(){return"function"}},Ok=class extends js{constructor(t){super(),this.expression=t}get astNodeType(){return"staticAssert"}},Bk=class extends js{constructor(t,r){super(),this.condition=t,this.body=r}get astNodeType(){return"while"}},Nk=class extends js{constructor(t){super(),this.body=t}get astNodeType(){return"continuing"}},Lk=class extends js{constructor(t,r,i,s){super(),this.init=t,this.condition=r,this.increment=i,this.body=s}get astNodeType(){return"for"}},Mm=class extends js{constructor(t,r,i,s,n){super(),this.name=t,this.type=r,this.storage=i,this.access=s,this.value=n}get astNodeType(){return"var"}},m5=class extends js{constructor(t,r,i){super(),this.name=t,this.type=r,this.value=i}get astNodeType(){return"override"}},A5=class extends js{constructor(t,r,i,s,n){super(),this.name=t,this.type=r,this.storage=i,this.access=s,this.value=n}get astNodeType(){return"let"}},g5=class extends js{constructor(t,r,i,s,n){super(),this.name=t,this.type=r,this.storage=i,this.access=s,this.value=n}get astNodeType(){return"const"}evaluate(t){return this.value.evaluate(t)}},Ny;(function(e){e.increment="++",e.decrement="--"})(Ny||(Ny={}));(function(e){function t(r){let i=r;if(i=="parse")throw new Error("Invalid value for IncrementOperator");return e[i]}e.parse=t})(Ny||(Ny={}));var Fk=class extends js{constructor(t,r){super(),this.operator=t,this.variable=r}get astNodeType(){return"increment"}},Nv;(function(e){e.assign="=",e.addAssign="+=",e.subtractAssin="-=",e.multiplyAssign="*=",e.divideAssign="/=",e.moduloAssign="%=",e.andAssign="&=",e.orAssign="|=",e.xorAssign="^=",e.shiftLeftAssign="<<=",e.shiftRightAssign=">>="})(Nv||(Nv={}));(function(e){function t(r){let i=r;if(i=="parse")throw new Error("Invalid value for AssignOperator");return e[i]}e.parse=t})(Nv||(Nv={}));var zk=class extends js{constructor(t,r,i){super(),this.operator=t,this.variable=r,this.value=i}get astNodeType(){return"assign"}},Uk=class extends js{constructor(t,r){super(),this.name=t,this.args=r}get astNodeType(){return"call"}},Vk=class extends js{constructor(t,r){super(),this.body=t,this.continuing=r}get astNodeType(){return"loop"}},jk=class extends js{constructor(t,r){super(),this.condition=t,this.body=r}get astNodeType(){return"body"}},Wk=class extends js{constructor(t,r,i,s){super(),this.condition=t,this.body=r,this.elseif=i,this.else=s}get astNodeType(){return"if"}},$k=class extends js{constructor(t){super(),this.value=t}get astNodeType(){return"return"}},Hk=class extends js{constructor(t){super(),this.name=t}get astNodeType(){return"enable"}},_5=class extends js{constructor(t,r){super(),this.name=t,this.type=r}get astNodeType(){return"alias"}},qk=class extends js{constructor(){super()}get astNodeType(){return"discard"}},Yk=class extends js{constructor(){super()}get astNodeType(){return"break"}},Xk=class extends js{constructor(){super()}get astNodeType(){return"continue"}},Dd=class extends js{constructor(t){super(),this.name=t}get astNodeType(){return"type"}get isStruct(){return!1}get isArray(){return!1}},Rd=class extends Dd{constructor(t,r){super(t),this.members=r}get astNodeType(){return"struct"}get isStruct(){return!0}getMemberIndex(t){for(let r=0;r<this.members.length;r++)if(this.members[r].name==t)return r;return-1}},y5=class extends Dd{constructor(t,r,i){super(t),this.format=r,this.access=i}get astNodeType(){return"template"}},Zk=class extends Dd{constructor(t,r,i,s){super(t),this.storage=r,this.type=i,this.access=s}get astNodeType(){return"pointer"}},x5=class extends Dd{constructor(t,r,i,s){super(t),this.attributes=r,this.format=i,this.count=s}get astNodeType(){return"array"}get isArray(){return!0}},zg=class extends Dd{constructor(t,r,i){super(t),this.format=r,this.access=i}get astNodeType(){return"sampler"}},Yu=class extends kd{constructor(){super()}},b5=class extends Yu{constructor(t){super(),this.value=t}get astNodeType(){return"stringExpr"}toString(){return this.value}evaluateString(){return this.value}},Ug=class extends Yu{constructor(t,r){super(),this.type=t,this.args=r}get astNodeType(){return"createExpr"}},Gk=class extends Yu{constructor(t,r){super(),this.name=t,this.args=r}get astNodeType(){return"callExpr"}evaluate(t){switch(this.name){case"abs":return Math.abs(this.args[0].evaluate(t));case"acos":return Math.acos(this.args[0].evaluate(t));case"acosh":return Math.acosh(this.args[0].evaluate(t));case"asin":return Math.asin(this.args[0].evaluate(t));case"asinh":return Math.asinh(this.args[0].evaluate(t));case"atan":return Math.atan(this.args[0].evaluate(t));case"atan2":return Math.atan2(this.args[0].evaluate(t),this.args[1].evaluate(t));case"atanh":return Math.atanh(this.args[0].evaluate(t));case"ceil":return Math.ceil(this.args[0].evaluate(t));case"clamp":return Math.min(Math.max(this.args[0].evaluate(t),this.args[1].evaluate(t)),this.args[2].evaluate(t));case"cos":return Math.cos(this.args[0].evaluate(t));case"degrees":return this.args[0].evaluate(t)*180/Math.PI;case"distance":return Math.sqrt(Math.pow(this.args[0].evaluate(t)-this.args[1].evaluate(t),2));case"dot":case"exp":return Math.exp(this.args[0].evaluate(t));case"exp2":return Math.pow(2,this.args[0].evaluate(t));case"floor":return Math.floor(this.args[0].evaluate(t));case"fma":return this.args[0].evaluate(t)*this.args[1].evaluate(t)+this.args[2].evaluate(t);case"fract":return this.args[0].evaluate(t)-Math.floor(this.args[0].evaluate(t));case"inverseSqrt":return 1/Math.sqrt(this.args[0].evaluate(t));case"log":return Math.log(this.args[0].evaluate(t));case"log2":return Math.log2(this.args[0].evaluate(t));case"max":return Math.max(this.args[0].evaluate(t),this.args[1].evaluate(t));case"min":return Math.min(this.args[0].evaluate(t),this.args[1].evaluate(t));case"mix":return this.args[0].evaluate(t)*(1-this.args[2].evaluate(t))+this.args[1].evaluate(t)*this.args[2].evaluate(t);case"modf":return this.args[0].evaluate(t)-Math.floor(this.args[0].evaluate(t));case"pow":return Math.pow(this.args[0].evaluate(t),this.args[1].evaluate(t));case"radians":return this.args[0].evaluate(t)*Math.PI/180;case"round":return Math.round(this.args[0].evaluate(t));case"sign":return Math.sign(this.args[0].evaluate(t));case"sin":return Math.sin(this.args[0].evaluate(t));case"sinh":return Math.sinh(this.args[0].evaluate(t));case"saturate":return Math.min(Math.max(this.args[0].evaluate(t),0),1);case"smoothstep":return this.args[0].evaluate(t)*this.args[0].evaluate(t)*(3-2*this.args[0].evaluate(t));case"sqrt":return Math.sqrt(this.args[0].evaluate(t));case"step":return this.args[0].evaluate(t)<this.args[1].evaluate(t)?0:1;case"tan":return Math.tan(this.args[0].evaluate(t));case"tanh":return Math.tanh(this.args[0].evaluate(t));case"trunc":return Math.trunc(this.args[0].evaluate(t));default:throw new Error("Non const function: "+this.name)}}},Qk=class extends Yu{constructor(t){super(),this.name=t}get astNodeType(){return"varExpr"}},v5=class extends Yu{constructor(t,r){super(),this.name=t,this.initializer=r}get astNodeType(){return"constExpr"}evaluate(t){var r,i;if(this.initializer instanceof Ug){let s=(r=this.postfix)===null||r===void 0?void 0:r.evaluateString(t),n=(i=this.initializer.type)===null||i===void 0?void 0:i.name,o=t.structs.get(n),a=o?.getMemberIndex(s);if(a!=-1)return this.initializer.args[a].evaluate(t);console.log(a)}return this.initializer.evaluate(t)}},w5=class extends Yu{constructor(t){super(),this.value=t}get astNodeType(){return"literalExpr"}evaluate(){return this.value}},Kk=class extends Yu{constructor(t,r){super(),this.type=t,this.value=r}get astNodeType(){return"bitcastExpr"}},Jk=class extends Yu{constructor(t,r){super(),this.type=t,this.args=r}get astNodeType(){return"typecastExpr"}evaluate(t){return this.args[0].evaluate(t)}},T5=class extends Yu{constructor(t){super(),this.contents=t}get astNodeType(){return"groupExpr"}evaluate(t){return this.contents[0].evaluate(t)}},S5=class extends Yu{constructor(){super()}},t7=class extends S5{constructor(t,r){super(),this.operator=t,this.right=r}get astNodeType(){return"unaryOp"}evaluate(t){switch(this.operator){case"+":return this.right.evaluate(t);case"-":return-this.right.evaluate(t);case"!":return this.right.evaluate(t)?0:1;case"~":return~this.right.evaluate(t);default:throw new Error("Unknown unary operator: "+this.operator)}}},qu=class extends S5{constructor(t,r,i){super(),this.operator=t,this.left=r,this.right=i}get astNodeType(){return"binaryOp"}evaluate(t){switch(this.operator){case"+":return this.left.evaluate(t)+this.right.evaluate(t);case"-":return this.left.evaluate(t)-this.right.evaluate(t);case"*":return this.left.evaluate(t)*this.right.evaluate(t);case"/":return this.left.evaluate(t)/this.right.evaluate(t);case"%":return this.left.evaluate(t)%this.right.evaluate(t);case"==":return this.left.evaluate(t)==this.right.evaluate(t)?1:0;case"!=":return this.left.evaluate(t)!=this.right.evaluate(t)?1:0;case"<":return this.left.evaluate(t)<this.right.evaluate(t)?1:0;case">":return this.left.evaluate(t)>this.right.evaluate(t)?1:0;case"<=":return this.left.evaluate(t)<=this.right.evaluate(t)?1:0;case">=":return this.left.evaluate(t)>=this.right.evaluate(t)?1:0;case"&&":return this.left.evaluate(t)&&this.right.evaluate(t)?1:0;case"||":return this.left.evaluate(t)||this.right.evaluate(t)?1:0;default:throw new Error(`Unknown operator ${this.operator}`)}}},E5=class extends kd{constructor(){super()}},e7=class extends E5{constructor(t,r){super(),this.selector=t,this.body=r}get astNodeType(){return"case"}},r7=class extends E5{constructor(t){super(),this.body=t}get astNodeType(){return"default"}},i7=class extends kd{constructor(t,r,i){super(),this.name=t,this.type=r,this.attributes=i}get astNodeType(){return"argument"}},n7=class extends kd{constructor(t,r){super(),this.condition=t,this.body=r}get astNodeType(){return"elseif"}},s7=class extends kd{constructor(t,r,i){super(),this.name=t,this.type=r,this.attributes=i}get astNodeType(){return"member"}},I5=class extends kd{constructor(t,r){super(),this.name=t,this.value=r}get astNodeType(){return"attribute"}},Me,ee;(function(e){e[e.token=0]="token",e[e.keyword=1]="keyword",e[e.reserved=2]="reserved"})(ee||(ee={}));var te=class{constructor(t,r,i){this.name=t,this.type=r,this.rule=i}toString(){return this.name}},kt=class{};Me=kt;kt.none=new te("",ee.reserved,"");kt.eof=new te("EOF",ee.token,"");kt.reserved={asm:new te("asm",ee.reserved,"asm"),bf16:new te("bf16",ee.reserved,"bf16"),do:new te("do",ee.reserved,"do"),enum:new te("enum",ee.reserved,"enum"),f16:new te("f16",ee.reserved,"f16"),f64:new te("f64",ee.reserved,"f64"),handle:new te("handle",ee.reserved,"handle"),i8:new te("i8",ee.reserved,"i8"),i16:new te("i16",ee.reserved,"i16"),i64:new te("i64",ee.reserved,"i64"),mat:new te("mat",ee.reserved,"mat"),premerge:new te("premerge",ee.reserved,"premerge"),regardless:new te("regardless",ee.reserved,"regardless"),typedef:new te("typedef",ee.reserved,"typedef"),u8:new te("u8",ee.reserved,"u8"),u16:new te("u16",ee.reserved,"u16"),u64:new te("u64",ee.reserved,"u64"),unless:new te("unless",ee.reserved,"unless"),using:new te("using",ee.reserved,"using"),vec:new te("vec",ee.reserved,"vec"),void:new te("void",ee.reserved,"void")};kt.keywords={array:new te("array",ee.keyword,"array"),atomic:new te("atomic",ee.keyword,"atomic"),bool:new te("bool",ee.keyword,"bool"),f32:new te("f32",ee.keyword,"f32"),i32:new te("i32",ee.keyword,"i32"),mat2x2:new te("mat2x2",ee.keyword,"mat2x2"),mat2x3:new te("mat2x3",ee.keyword,"mat2x3"),mat2x4:new te("mat2x4",ee.keyword,"mat2x4"),mat3x2:new te("mat3x2",ee.keyword,"mat3x2"),mat3x3:new te("mat3x3",ee.keyword,"mat3x3"),mat3x4:new te("mat3x4",ee.keyword,"mat3x4"),mat4x2:new te("mat4x2",ee.keyword,"mat4x2"),mat4x3:new te("mat4x3",ee.keyword,"mat4x3"),mat4x4:new te("mat4x4",ee.keyword,"mat4x4"),ptr:new te("ptr",ee.keyword,"ptr"),sampler:new te("sampler",ee.keyword,"sampler"),sampler_comparison:new te("sampler_comparison",ee.keyword,"sampler_comparison"),struct:new te("struct",ee.keyword,"struct"),texture_1d:new te("texture_1d",ee.keyword,"texture_1d"),texture_2d:new te("texture_2d",ee.keyword,"texture_2d"),texture_2d_array:new te("texture_2d_array",ee.keyword,"texture_2d_array"),texture_3d:new te("texture_3d",ee.keyword,"texture_3d"),texture_cube:new te("texture_cube",ee.keyword,"texture_cube"),texture_cube_array:new te("texture_cube_array",ee.keyword,"texture_cube_array"),texture_multisampled_2d:new te("texture_multisampled_2d",ee.keyword,"texture_multisampled_2d"),texture_storage_1d:new te("texture_storage_1d",ee.keyword,"texture_storage_1d"),texture_storage_2d:new te("texture_storage_2d",ee.keyword,"texture_storage_2d"),texture_storage_2d_array:new te("texture_storage_2d_array",ee.keyword,"texture_storage_2d_array"),texture_storage_3d:new te("texture_storage_3d",ee.keyword,"texture_storage_3d"),texture_depth_2d:new te("texture_depth_2d",ee.keyword,"texture_depth_2d"),texture_depth_2d_array:new te("texture_depth_2d_array",ee.keyword,"texture_depth_2d_array"),texture_depth_cube:new te("texture_depth_cube",ee.keyword,"texture_depth_cube"),texture_depth_cube_array:new te("texture_depth_cube_array",ee.keyword,"texture_depth_cube_array"),texture_depth_multisampled_2d:new te("texture_depth_multisampled_2d",ee.keyword,"texture_depth_multisampled_2d"),texture_external:new te("texture_external",ee.keyword,"texture_external"),u32:new te("u32",ee.keyword,"u32"),vec2:new te("vec2",ee.keyword,"vec2"),vec3:new te("vec3",ee.keyword,"vec3"),vec4:new te("vec4",ee.keyword,"vec4"),bitcast:new te("bitcast",ee.keyword,"bitcast"),block:new te("block",ee.keyword,"block"),break:new te("break",ee.keyword,"break"),case:new te("case",ee.keyword,"case"),continue:new te("continue",ee.keyword,"continue"),continuing:new te("continuing",ee.keyword,"continuing"),default:new te("default",ee.keyword,"default"),discard:new te("discard",ee.keyword,"discard"),else:new te("else",ee.keyword,"else"),enable:new te("enable",ee.keyword,"enable"),fallthrough:new te("fallthrough",ee.keyword,"fallthrough"),false:new te("false",ee.keyword,"false"),fn:new te("fn",ee.keyword,"fn"),for:new te("for",ee.keyword,"for"),function:new te("function",ee.keyword,"function"),if:new te("if",ee.keyword,"if"),let:new te("let",ee.keyword,"let"),const:new te("const",ee.keyword,"const"),loop:new te("loop",ee.keyword,"loop"),while:new te("while",ee.keyword,"while"),private:new te("private",ee.keyword,"private"),read:new te("read",ee.keyword,"read"),read_write:new te("read_write",ee.keyword,"read_write"),return:new te("return",ee.keyword,"return"),storage:new te("storage",ee.keyword,"storage"),switch:new te("switch",ee.keyword,"switch"),true:new te("true",ee.keyword,"true"),alias:new te("alias",ee.keyword,"alias"),type:new te("type",ee.keyword,"type"),uniform:new te("uniform",ee.keyword,"uniform"),var:new te("var",ee.keyword,"var"),override:new te("override",ee.keyword,"override"),workgroup:new te("workgroup",ee.keyword,"workgroup"),write:new te("write",ee.keyword,"write"),r8unorm:new te("r8unorm",ee.keyword,"r8unorm"),r8snorm:new te("r8snorm",ee.keyword,"r8snorm"),r8uint:new te("r8uint",ee.keyword,"r8uint"),r8sint:new te("r8sint",ee.keyword,"r8sint"),r16uint:new te("r16uint",ee.keyword,"r16uint"),r16sint:new te("r16sint",ee.keyword,"r16sint"),r16float:new te("r16float",ee.keyword,"r16float"),rg8unorm:new te("rg8unorm",ee.keyword,"rg8unorm"),rg8snorm:new te("rg8snorm",ee.keyword,"rg8snorm"),rg8uint:new te("rg8uint",ee.keyword,"rg8uint"),rg8sint:new te("rg8sint",ee.keyword,"rg8sint"),r32uint:new te("r32uint",ee.keyword,"r32uint"),r32sint:new te("r32sint",ee.keyword,"r32sint"),r32float:new te("r32float",ee.keyword,"r32float"),rg16uint:new te("rg16uint",ee.keyword,"rg16uint"),rg16sint:new te("rg16sint",ee.keyword,"rg16sint"),rg16float:new te("rg16float",ee.keyword,"rg16float"),rgba8unorm:new te("rgba8unorm",ee.keyword,"rgba8unorm"),rgba8unorm_srgb:new te("rgba8unorm_srgb",ee.keyword,"rgba8unorm_srgb"),rgba8snorm:new te("rgba8snorm",ee.keyword,"rgba8snorm"),rgba8uint:new te("rgba8uint",ee.keyword,"rgba8uint"),rgba8sint:new te("rgba8sint",ee.keyword,"rgba8sint"),bgra8unorm:new te("bgra8unorm",ee.keyword,"bgra8unorm"),bgra8unorm_srgb:new te("bgra8unorm_srgb",ee.keyword,"bgra8unorm_srgb"),rgb10a2unorm:new te("rgb10a2unorm",ee.keyword,"rgb10a2unorm"),rg11b10float:new te("rg11b10float",ee.keyword,"rg11b10float"),rg32uint:new te("rg32uint",ee.keyword,"rg32uint"),rg32sint:new te("rg32sint",ee.keyword,"rg32sint"),rg32float:new te("rg32float",ee.keyword,"rg32float"),rgba16uint:new te("rgba16uint",ee.keyword,"rgba16uint"),rgba16sint:new te("rgba16sint",ee.keyword,"rgba16sint"),rgba16float:new te("rgba16float",ee.keyword,"rgba16float"),rgba32uint:new te("rgba32uint",ee.keyword,"rgba32uint"),rgba32sint:new te("rgba32sint",ee.keyword,"rgba32sint"),rgba32float:new te("rgba32float",ee.keyword,"rgba32float"),static_assert:new te("static_assert",ee.keyword,"static_assert")};kt.tokens={decimal_float_literal:new te("decimal_float_literal",ee.token,/((-?[0-9]*\.[0-9]+|-?[0-9]+\.[0-9]*)((e|E)(\+|-)?[0-9]+)?f?)|(-?[0-9]+(e|E)(\+|-)?[0-9]+f?)|([0-9]+f)/),hex_float_literal:new te("hex_float_literal",ee.token,/-?0x((([0-9a-fA-F]*\.[0-9a-fA-F]+|[0-9a-fA-F]+\.[0-9a-fA-F]*)((p|P)(\+|-)?[0-9]+f?)?)|([0-9a-fA-F]+(p|P)(\+|-)?[0-9]+f?))/),int_literal:new te("int_literal",ee.token,/-?0x[0-9a-fA-F]+|0i?|-?[1-9][0-9]*i?/),uint_literal:new te("uint_literal",ee.token,/0x[0-9a-fA-F]+u|0u|[1-9][0-9]*u/),ident:new te("ident",ee.token,/[a-zA-Z][0-9a-zA-Z_]*/),and:new te("and",ee.token,"&"),and_and:new te("and_and",ee.token,"&&"),arrow:new te("arrow ",ee.token,"->"),attr:new te("attr",ee.token,"@"),attr_left:new te("attr_left",ee.token,"[["),attr_right:new te("attr_right",ee.token,"]]"),forward_slash:new te("forward_slash",ee.token,"/"),bang:new te("bang",ee.token,"!"),bracket_left:new te("bracket_left",ee.token,"["),bracket_right:new te("bracket_right",ee.token,"]"),brace_left:new te("brace_left",ee.token,"{"),brace_right:new te("brace_right",ee.token,"}"),colon:new te("colon",ee.token,":"),comma:new te("comma",ee.token,","),equal:new te("equal",ee.token,"="),equal_equal:new te("equal_equal",ee.token,"=="),not_equal:new te("not_equal",ee.token,"!="),greater_than:new te("greater_than",ee.token,">"),greater_than_equal:new te("greater_than_equal",ee.token,">="),shift_right:new te("shift_right",ee.token,">>"),less_than:new te("less_than",ee.token,"<"),less_than_equal:new te("less_than_equal",ee.token,"<="),shift_left:new te("shift_left",ee.token,"<<"),modulo:new te("modulo",ee.token,"%"),minus:new te("minus",ee.token,"-"),minus_minus:new te("minus_minus",ee.token,"--"),period:new te("period",ee.token,"."),plus:new te("plus",ee.token,"+"),plus_plus:new te("plus_plus",ee.token,"++"),or:new te("or",ee.token,"|"),or_or:new te("or_or",ee.token,"||"),paren_left:new te("paren_left",ee.token,"("),paren_right:new te("paren_right",ee.token,")"),semicolon:new te("semicolon",ee.token,";"),star:new te("star",ee.token,"*"),tilde:new te("tilde",ee.token,"~"),underscore:new te("underscore",ee.token,"_"),xor:new te("xor",ee.token,"^"),plus_equal:new te("plus_equal",ee.token,"+="),minus_equal:new te("minus_equal",ee.token,"-="),times_equal:new te("times_equal",ee.token,"*="),division_equal:new te("division_equal",ee.token,"/="),modulo_equal:new te("modulo_equal",ee.token,"%="),and_equal:new te("and_equal",ee.token,"&="),or_equal:new te("or_equal",ee.token,"|="),xor_equal:new te("xor_equal",ee.token,"^="),shift_right_equal:new te("shift_right_equal",ee.token,">>="),shift_left_equal:new te("shift_left_equal",ee.token,"<<=")};kt.storage_class=[Me.keywords.function,Me.keywords.private,Me.keywords.workgroup,Me.keywords.uniform,Me.keywords.storage];kt.access_mode=[Me.keywords.read,Me.keywords.write,Me.keywords.read_write];kt.sampler_type=[Me.keywords.sampler,Me.keywords.sampler_comparison];kt.sampled_texture_type=[Me.keywords.texture_1d,Me.keywords.texture_2d,Me.keywords.texture_2d_array,Me.keywords.texture_3d,Me.keywords.texture_cube,Me.keywords.texture_cube_array];kt.multisampled_texture_type=[Me.keywords.texture_multisampled_2d];kt.storage_texture_type=[Me.keywords.texture_storage_1d,Me.keywords.texture_storage_2d,Me.keywords.texture_storage_2d_array,Me.keywords.texture_storage_3d];kt.depth_texture_type=[Me.keywords.texture_depth_2d,Me.keywords.texture_depth_2d_array,Me.keywords.texture_depth_cube,Me.keywords.texture_depth_cube_array,Me.keywords.texture_depth_multisampled_2d];kt.texture_external_type=[Me.keywords.texture_external];kt.any_texture_type=[...Me.sampled_texture_type,...Me.multisampled_texture_type,...Me.storage_texture_type,...Me.depth_texture_type,...Me.texture_external_type];kt.texel_format=[Me.keywords.r8unorm,Me.keywords.r8snorm,Me.keywords.r8uint,Me.keywords.r8sint,Me.keywords.r16uint,Me.keywords.r16sint,Me.keywords.r16float,Me.keywords.rg8unorm,Me.keywords.rg8snorm,Me.keywords.rg8uint,Me.keywords.rg8sint,Me.keywords.r32uint,Me.keywords.r32sint,Me.keywords.r32float,Me.keywords.rg16uint,Me.keywords.rg16sint,Me.keywords.rg16float,Me.keywords.rgba8unorm,Me.keywords.rgba8unorm_srgb,Me.keywords.rgba8snorm,Me.keywords.rgba8uint,Me.keywords.rgba8sint,Me.keywords.bgra8unorm,Me.keywords.bgra8unorm_srgb,Me.keywords.rgb10a2unorm,Me.keywords.rg11b10float,Me.keywords.rg32uint,Me.keywords.rg32sint,Me.keywords.rg32float,Me.keywords.rgba16uint,Me.keywords.rgba16sint,Me.keywords.rgba16float,Me.keywords.rgba32uint,Me.keywords.rgba32sint,Me.keywords.rgba32float];kt.const_literal=[Me.tokens.int_literal,Me.tokens.uint_literal,Me.tokens.decimal_float_literal,Me.tokens.hex_float_literal,Me.keywords.true,Me.keywords.false];kt.literal_or_ident=[Me.tokens.ident,Me.tokens.int_literal,Me.tokens.uint_literal,Me.tokens.decimal_float_literal,Me.tokens.hex_float_literal];kt.element_count_expression=[Me.tokens.int_literal,Me.tokens.uint_literal,Me.tokens.ident];kt.template_types=[Me.keywords.vec2,Me.keywords.vec3,Me.keywords.vec4,Me.keywords.mat2x2,Me.keywords.mat2x3,Me.keywords.mat2x4,Me.keywords.mat3x2,Me.keywords.mat3x3,Me.keywords.mat3x4,Me.keywords.mat4x2,Me.keywords.mat4x3,Me.keywords.mat4x4,Me.keywords.atomic,Me.keywords.bitcast,...Me.any_texture_type];kt.attribute_name=[Me.tokens.ident,Me.keywords.block];kt.assignment_operators=[Me.tokens.equal,Me.tokens.plus_equal,Me.tokens.minus_equal,Me.tokens.times_equal,Me.tokens.division_equal,Me.tokens.modulo_equal,Me.tokens.and_equal,Me.tokens.or_equal,Me.tokens.xor_equal,Me.tokens.shift_right_equal,Me.tokens.shift_left_equal];kt.increment_operators=[Me.tokens.plus_plus,Me.tokens.minus_minus];var M5=class{constructor(t,r,i){this.type=t,this.lexeme=r,this.line=i}toString(){return this.lexeme}isTemplateType(){return kt.template_types.indexOf(this.type)!=-1}isArrayType(){return this.type==kt.keywords.array}isArrayOrTemplateType(){return this.isArrayType()||this.isTemplateType()}},o7=class{constructor(t){this._tokens=[],this._start=0,this._current=0,this._line=1,this._source=t??""}scanTokens(){for(;!this._isAtEnd();)if(this._start=this._current,!this.scanToken())throw`Invalid syntax at line ${this._line}`;return this._tokens.push(new M5(kt.eof,"",this._line)),this._tokens}scanToken(){let t=this._advance();if(t==`
`)return this._line++,!0;if(this._isWhitespace(t))return!0;if(t=="/"){if(this._peekAhead()=="/"){for(;t!=`
`;){if(this._isAtEnd())return!0;t=this._advance()}return this._line++,!0}else if(this._peekAhead()=="*"){this._advance();let i=1;for(;i>0;){if(this._isAtEnd())return!0;if(t=this._advance(),t==`
`)this._line++;else if(t=="*"){if(this._peekAhead()=="/"&&(this._advance(),i--,i==0))return!0}else t=="/"&&this._peekAhead()=="*"&&(this._advance(),i++)}return!0}}let r=kt.none;for(;;){let i=this._findType(t),s=this._peekAhead();if(t==">"&&(s==">"||s=="=")){let n=!1,o=this._tokens.length-1;for(let a=0;a<5&&o>=0;++a,--o)if(this._tokens[o].type===kt.tokens.less_than){o>0&&this._tokens[o-1].isArrayOrTemplateType()&&(n=!0);break}if(n)return this._addToken(i),!0}if(i===kt.none){let n=t,o=0,a=2;for(let h=0;h<a;++h)if(n+=this._peekAhead(h),i=this._findType(n),i!==kt.none){o=h;break}if(i===kt.none)return r===kt.none?!1:(this._current--,this._addToken(r),!0);t=n,this._current+=o+1}if(r=i,this._isAtEnd())break;t+=this._advance()}return r===kt.none?!1:(this._addToken(r),!0)}_findType(t){for(let r in kt.keywords){let i=kt.keywords[r];if(this._match(t,i.rule))return i}for(let r in kt.tokens){let i=kt.tokens[r];if(this._match(t,i.rule))return i}return kt.none}_match(t,r){if(typeof r=="string"){if(r==t)return!0}else{let i=r.exec(t);if(i&&i.index==0&&i[0]==t)return!0}return!1}_isAtEnd(){return this._current>=this._source.length}_isWhitespace(t){return t==" "||t=="	"||t=="\r"}_advance(t=0){let r=this._source[this._current];return t=t||0,t++,this._current+=t,r}_peekAhead(t=0){return t=t||0,this._current+t>=this._source.length?"\0":this._source[this._current+t]}_addToken(t){let r=this._source.substring(this._start,this._current);this._tokens.push(new M5(t,r,this._line))}},a7=class{constructor(){this._tokens=[],this._current=0,this._context=new Dk}parse(t){this._initialize(t);let r=[];for(;!this._isAtEnd();){let i=this._global_decl_or_directive();if(!i)break;r.push(i)}return r}_initialize(t){if(t)if(typeof t=="string"){let r=new o7(t);this._tokens=r.scanTokens()}else this._tokens=t;else this._tokens=[];this._current=0}_error(t,r){return console.error(t,r),{token:t,message:r,toString:function(){return`${r}`}}}_isAtEnd(){return this._current>=this._tokens.length||this._peek().type==kt.eof}_match(t){if(t instanceof te)return this._check(t)?(this._advance(),!0):!1;for(let r=0,i=t.length;r<i;++r){let s=t[r];if(this._check(s))return this._advance(),!0}return!1}_consume(t,r){if(this._check(t))return this._advance();throw this._error(this._peek(),r)}_check(t){if(this._isAtEnd())return!1;let r=this._peek();if(t instanceof Array){let i=r.type;return t.indexOf(i)!=-1}return r.type==t}_advance(){return this._isAtEnd()||this._current++,this._previous()}_peek(){return this._tokens[this._current]}_previous(){return this._tokens[this._current-1]}_global_decl_or_directive(){for(;this._match(kt.tokens.semicolon)&&!this._isAtEnd(););if(this._match(kt.keywords.alias)){let r=this._type_alias();return this._consume(kt.tokens.semicolon,"Expected ';'"),r}if(this._match(kt.keywords.enable)){let r=this._enable_directive();return this._consume(kt.tokens.semicolon,"Expected ';'"),r}let t=this._attribute();if(this._check(kt.keywords.var)){let r=this._global_variable_decl();return r!=null&&(r.attributes=t),this._consume(kt.tokens.semicolon,"Expected ';'."),r}if(this._check(kt.keywords.override)){let r=this._override_variable_decl();return r!=null&&(r.attributes=t),this._consume(kt.tokens.semicolon,"Expected ';'."),r}if(this._check(kt.keywords.let)){let r=this._global_let_decl();return r!=null&&(r.attributes=t),this._consume(kt.tokens.semicolon,"Expected ';'."),r}if(this._check(kt.keywords.const)){let r=this._global_const_decl();return r!=null&&(r.attributes=t),this._consume(kt.tokens.semicolon,"Expected ';'."),r}if(this._check(kt.keywords.struct)){let r=this._struct_decl();return r!=null&&(r.attributes=t),r}if(this._check(kt.keywords.fn)){let r=this._function_decl();return r!=null&&(r.attributes=t),r}return null}_function_decl(){if(!this._match(kt.keywords.fn))return null;let t=this._consume(kt.tokens.ident,"Expected function name.").toString();this._consume(kt.tokens.paren_left,"Expected '(' for function arguments.");let r=[];if(!this._check(kt.tokens.paren_right))do{if(this._check(kt.tokens.paren_right))break;let n=this._attribute(),o=this._consume(kt.tokens.ident,"Expected argument name.").toString();this._consume(kt.tokens.colon,"Expected ':' for argument type.");let a=this._attribute(),h=this._type_decl();h!=null&&(h.attributes=a,r.push(new i7(o,h,n)))}while(this._match(kt.tokens.comma));this._consume(kt.tokens.paren_right,"Expected ')' after function arguments.");let i=null;if(this._match(kt.tokens.arrow)){let n=this._attribute();i=this._type_decl(),i!=null&&(i.attributes=n)}let s=this._compound_statement();return new d5(t,r,i,s)}_compound_statement(){let t=[];for(this._consume(kt.tokens.brace_left,"Expected '{' for block.");!this._check(kt.tokens.brace_right);){let r=this._statement();r!==null&&t.push(r)}return this._consume(kt.tokens.brace_right,"Expected '}' for block."),t}_statement(){for(;this._match(kt.tokens.semicolon)&&!this._isAtEnd(););if(this._check(kt.keywords.if))return this._if_statement();if(this._check(kt.keywords.switch))return this._switch_statement();if(this._check(kt.keywords.loop))return this._loop_statement();if(this._check(kt.keywords.for))return this._for_statement();if(this._check(kt.keywords.while))return this._while_statement();if(this._check(kt.keywords.continuing))return this._continuing_statement();if(this._check(kt.keywords.static_assert))return this._static_assert_statement();if(this._check(kt.tokens.brace_left))return this._compound_statement();let t=null;return this._check(kt.keywords.return)?t=this._return_statement():this._check([kt.keywords.var,kt.keywords.let,kt.keywords.const])?t=this._variable_statement():this._match(kt.keywords.discard)?t=new qk:this._match(kt.keywords.break)?t=new Yk:this._match(kt.keywords.continue)?t=new Xk:t=this._increment_decrement_statement()||this._func_call_statement()||this._assignment_statement(),t!=null&&this._consume(kt.tokens.semicolon,"Expected ';' after statement."),t}_static_assert_statement(){if(!this._match(kt.keywords.static_assert))return null;let t=this._optional_paren_expression();return new Ok(t)}_while_statement(){if(!this._match(kt.keywords.while))return null;let t=this._optional_paren_expression(),r=this._compound_statement();return new Bk(t,r)}_continuing_statement(){if(!this._match(kt.keywords.continuing))return null;let t=this._compound_statement();return new Nk(t)}_for_statement(){if(!this._match(kt.keywords.for))return null;this._consume(kt.tokens.paren_left,"Expected '('.");let t=this._check(kt.tokens.semicolon)?null:this._for_init();this._consume(kt.tokens.semicolon,"Expected ';'.");let r=this._check(kt.tokens.semicolon)?null:this._short_circuit_or_expression();this._consume(kt.tokens.semicolon,"Expected ';'.");let i=this._check(kt.tokens.paren_right)?null:this._for_increment();this._consume(kt.tokens.paren_right,"Expected ')'.");let s=this._compound_statement();return new Lk(t,r,i,s)}_for_init(){return this._variable_statement()||this._func_call_statement()||this._assignment_statement()}_for_increment(){return this._func_call_statement()||this._increment_decrement_statement()||this._assignment_statement()}_variable_statement(){if(this._check(kt.keywords.var)){let t=this._variable_decl();if(t===null)throw this._error(this._peek(),"Variable declaration expected.");let r=null;return this._match(kt.tokens.equal)&&(r=this._short_circuit_or_expression()),new Mm(t.name,t.type,t.storage,t.access,r)}if(this._match(kt.keywords.let)){let t=this._consume(kt.tokens.ident,"Expected name for let.").toString(),r=null;if(this._match(kt.tokens.colon)){let s=this._attribute();r=this._type_decl(),r!=null&&(r.attributes=s)}this._consume(kt.tokens.equal,"Expected '=' for let.");let i=this._short_circuit_or_expression();return new A5(t,r,null,null,i)}if(this._match(kt.keywords.const)){let t=this._consume(kt.tokens.ident,"Expected name for const.").toString(),r=null;if(this._match(kt.tokens.colon)){let s=this._attribute();r=this._type_decl(),r!=null&&(r.attributes=s)}this._consume(kt.tokens.equal,"Expected '=' for const.");let i=this._short_circuit_or_expression();return new g5(t,r,null,null,i)}return null}_increment_decrement_statement(){let t=this._current,r=this._unary_expression();if(r==null)return null;if(!this._check(kt.increment_operators))return this._current=t,null;let i=this._consume(kt.increment_operators,"Expected increment operator");return new Fk(i.type===kt.tokens.plus_plus?Ny.increment:Ny.decrement,r)}_assignment_statement(){let t=null;if(this._check(kt.tokens.brace_right))return null;let r=this._match(kt.tokens.underscore);if(r||(t=this._unary_expression()),!r&&t==null)return null;let i=this._consume(kt.assignment_operators,"Expected assignment operator."),s=this._short_circuit_or_expression();return new zk(Nv.parse(i.lexeme),t,s)}_func_call_statement(){if(!this._check(kt.tokens.ident))return null;let t=this._current,r=this._consume(kt.tokens.ident,"Expected function name."),i=this._argument_expression_list();return i===null?(this._current=t,null):new Uk(r.lexeme,i)}_loop_statement(){if(!this._match(kt.keywords.loop))return null;this._consume(kt.tokens.brace_left,"Expected '{' for loop.");let t=[],r=this._statement();for(;r!==null;){if(Array.isArray(r))for(let s of r)t.push(s);else t.push(r);r=this._statement()}let i=null;return this._match(kt.keywords.continuing)&&(i=this._compound_statement()),this._consume(kt.tokens.brace_right,"Expected '}' for loop."),new Vk(t,i)}_switch_statement(){if(!this._match(kt.keywords.switch))return null;let t=this._optional_paren_expression();this._consume(kt.tokens.brace_left,"Expected '{' for switch.");let r=this._switch_body();if(r==null||r.length==0)throw this._error(this._previous(),"Expected 'case' or 'default'.");return this._consume(kt.tokens.brace_right,"Expected '}' for switch."),new jk(t,r)}_switch_body(){let t=[];if(this._match(kt.keywords.case)){let r=this._case_selectors();this._match(kt.tokens.colon),this._consume(kt.tokens.brace_left,"Exected '{' for switch case.");let i=this._case_body();this._consume(kt.tokens.brace_right,"Exected '}' for switch case."),t.push(new e7(r,i))}if(this._match(kt.keywords.default)){this._match(kt.tokens.colon),this._consume(kt.tokens.brace_left,"Exected '{' for switch default.");let r=this._case_body();this._consume(kt.tokens.brace_right,"Exected '}' for switch default."),t.push(new r7(r))}if(this._check([kt.keywords.default,kt.keywords.case])){let r=this._switch_body();t.push(r[0])}return t}_case_selectors(){var t,r,i,s;let n=[(r=(t=this._shift_expression())===null||t===void 0?void 0:t.evaluate(this._context).toString())!==null&&r!==void 0?r:""];for(;this._match(kt.tokens.comma);)n.push((s=(i=this._shift_expression())===null||i===void 0?void 0:i.evaluate(this._context).toString())!==null&&s!==void 0?s:"");return n}_case_body(){if(this._match(kt.keywords.fallthrough))return this._consume(kt.tokens.semicolon,"Expected ';'"),[];let t=this._statement();if(t==null)return[];t instanceof Array||(t=[t]);let r=this._case_body();return r.length==0?t:[...t,r[0]]}_if_statement(){if(!this._match(kt.keywords.if))return null;let t=this._optional_paren_expression(),r=this._compound_statement(),i=[];this._match_elseif()&&(i=this._elseif_statement(i));let s=null;return this._match(kt.keywords.else)&&(s=this._compound_statement()),new Wk(t,r,i,s)}_match_elseif(){return this._tokens[this._current].type===kt.keywords.else&&this._tokens[this._current+1].type===kt.keywords.if?(this._advance(),this._advance(),!0):!1}_elseif_statement(t=[]){let r=this._optional_paren_expression(),i=this._compound_statement();return t.push(new n7(r,i)),this._match_elseif()&&this._elseif_statement(t),t}_return_statement(){if(!this._match(kt.keywords.return))return null;let t=this._short_circuit_or_expression();return new $k(t)}_short_circuit_or_expression(){let t=this._short_circuit_and_expr();for(;this._match(kt.tokens.or_or);)t=new qu(this._previous().toString(),t,this._short_circuit_and_expr());return t}_short_circuit_and_expr(){let t=this._inclusive_or_expression();for(;this._match(kt.tokens.and_and);)t=new qu(this._previous().toString(),t,this._inclusive_or_expression());return t}_inclusive_or_expression(){let t=this._exclusive_or_expression();for(;this._match(kt.tokens.or);)t=new qu(this._previous().toString(),t,this._exclusive_or_expression());return t}_exclusive_or_expression(){let t=this._and_expression();for(;this._match(kt.tokens.xor);)t=new qu(this._previous().toString(),t,this._and_expression());return t}_and_expression(){let t=this._equality_expression();for(;this._match(kt.tokens.and);)t=new qu(this._previous().toString(),t,this._equality_expression());return t}_equality_expression(){let t=this._relational_expression();return this._match([kt.tokens.equal_equal,kt.tokens.not_equal])?new qu(this._previous().toString(),t,this._relational_expression()):t}_relational_expression(){let t=this._shift_expression();for(;this._match([kt.tokens.less_than,kt.tokens.greater_than,kt.tokens.less_than_equal,kt.tokens.greater_than_equal]);)t=new qu(this._previous().toString(),t,this._shift_expression());return t}_shift_expression(){let t=this._additive_expression();for(;this._match([kt.tokens.shift_left,kt.tokens.shift_right]);)t=new qu(this._previous().toString(),t,this._additive_expression());return t}_additive_expression(){let t=this._multiplicative_expression();for(;this._match([kt.tokens.plus,kt.tokens.minus]);)t=new qu(this._previous().toString(),t,this._multiplicative_expression());return t}_multiplicative_expression(){let t=this._unary_expression();for(;this._match([kt.tokens.star,kt.tokens.forward_slash,kt.tokens.modulo]);)t=new qu(this._previous().toString(),t,this._unary_expression());return t}_unary_expression(){return this._match([kt.tokens.minus,kt.tokens.bang,kt.tokens.tilde,kt.tokens.star,kt.tokens.and])?new t7(this._previous().toString(),this._unary_expression()):this._singular_expression()}_singular_expression(){let t=this._primary_expression(),r=this._postfix_expression();return r&&(t.postfix=r),t}_postfix_expression(){if(this._match(kt.tokens.bracket_left)){let t=this._short_circuit_or_expression();this._consume(kt.tokens.bracket_right,"Expected ']'.");let r=this._postfix_expression();return r&&(t.postfix=r),t}if(this._match(kt.tokens.period)){let t=this._consume(kt.tokens.ident,"Expected member name."),r=this._postfix_expression(),i=new b5(t.lexeme);return r&&(i.postfix=r),i}return null}_getStruct(t){return this._context.aliases.has(t)?this._context.aliases.get(t).type:this._context.structs.has(t)?this._context.structs.get(t):null}_primary_expression(){if(this._match(kt.tokens.ident)){let i=this._previous().toString();if(this._check(kt.tokens.paren_left)){let s=this._argument_expression_list(),n=this._getStruct(i);return n!=null?new Ug(n,s):new Gk(i,s)}if(this._context.constants.has(i)){let s=this._context.constants.get(i);return new v5(i,s.value)}return new Qk(i)}if(this._match(kt.const_literal))return new w5(parseFloat(this._previous().toString()));if(this._check(kt.tokens.paren_left))return this._paren_expression();if(this._match(kt.keywords.bitcast)){this._consume(kt.tokens.less_than,"Expected '<'.");let i=this._type_decl();this._consume(kt.tokens.greater_than,"Expected '>'.");let s=this._paren_expression();return new Kk(i,s)}let t=this._type_decl(),r=this._argument_expression_list();return new Jk(t,r)}_argument_expression_list(){if(!this._match(kt.tokens.paren_left))return null;let t=[];do{if(this._check(kt.tokens.paren_right))break;let r=this._short_circuit_or_expression();t.push(r)}while(this._match(kt.tokens.comma));return this._consume(kt.tokens.paren_right,"Expected ')' for agument list"),t}_optional_paren_expression(){this._match(kt.tokens.paren_left);let t=this._short_circuit_or_expression();return this._match(kt.tokens.paren_right),new T5([t])}_paren_expression(){this._consume(kt.tokens.paren_left,"Expected '('.");let t=this._short_circuit_or_expression();return this._consume(kt.tokens.paren_right,"Expected ')'."),new T5([t])}_struct_decl(){if(!this._match(kt.keywords.struct))return null;let t=this._consume(kt.tokens.ident,"Expected name for struct.").toString();this._consume(kt.tokens.brace_left,"Expected '{' for struct body.");let r=[];for(;!this._check(kt.tokens.brace_right);){let s=this._attribute(),n=this._consume(kt.tokens.ident,"Expected variable name.").toString();this._consume(kt.tokens.colon,"Expected ':' for struct member type.");let o=this._attribute(),a=this._type_decl();a!=null&&(a.attributes=o),this._check(kt.tokens.brace_right)?this._match(kt.tokens.comma):this._consume(kt.tokens.comma,"Expected ',' for struct member."),r.push(new s7(n,a,s))}this._consume(kt.tokens.brace_right,"Expected '}' after struct body.");let i=new Rd(t,r);return this._context.structs.set(t,i),i}_global_variable_decl(){let t=this._variable_decl();return t&&this._match(kt.tokens.equal)&&(t.value=this._const_expression()),t}_override_variable_decl(){let t=this._override_decl();return t&&this._match(kt.tokens.equal)&&(t.value=this._const_expression()),t}_global_const_decl(){if(!this._match(kt.keywords.const))return null;let t=this._consume(kt.tokens.ident,"Expected variable name"),r=null;if(this._match(kt.tokens.colon)){let n=this._attribute();r=this._type_decl(),r!=null&&(r.attributes=n)}let i=null;if(this._match(kt.tokens.equal)){let n=this._short_circuit_or_expression();if(n instanceof Ug)i=n;else if(n instanceof v5&&n.initializer instanceof Ug)i=n.initializer;else try{let o=n.evaluate(this._context);i=new w5(o)}catch{i=n}}let s=new g5(t.toString(),r,"","",i);return this._context.constants.set(s.name,s),s}_global_let_decl(){if(!this._match(kt.keywords.let))return null;let t=this._consume(kt.tokens.ident,"Expected variable name"),r=null;if(this._match(kt.tokens.colon)){let s=this._attribute();r=this._type_decl(),r!=null&&(r.attributes=s)}let i=null;return this._match(kt.tokens.equal)&&(i=this._const_expression()),new A5(t.toString(),r,"","",i)}_const_expression(){if(this._match(kt.const_literal))return new b5(this._previous().toString());let t=this._type_decl();this._consume(kt.tokens.paren_left,"Expected '('.");let r=[];for(;!this._check(kt.tokens.paren_right)&&(r.push(this._const_expression()),!!this._check(kt.tokens.comma));)this._advance();return this._consume(kt.tokens.paren_right,"Expected ')'."),new Ug(t,r)}_variable_decl(){if(!this._match(kt.keywords.var))return null;let t="",r="";this._match(kt.tokens.less_than)&&(t=this._consume(kt.storage_class,"Expected storage_class.").toString(),this._match(kt.tokens.comma)&&(r=this._consume(kt.access_mode,"Expected access_mode.").toString()),this._consume(kt.tokens.greater_than,"Expected '>'."));let i=this._consume(kt.tokens.ident,"Expected variable name"),s=null;if(this._match(kt.tokens.colon)){let n=this._attribute();s=this._type_decl(),s!=null&&(s.attributes=n)}return new Mm(i.toString(),s,t,r,null)}_override_decl(){if(!this._match(kt.keywords.override))return null;let t=this._consume(kt.tokens.ident,"Expected variable name"),r=null;if(this._match(kt.tokens.colon)){let i=this._attribute();r=this._type_decl(),r!=null&&(r.attributes=i)}return new m5(t.toString(),r,null)}_enable_directive(){let t=this._consume(kt.tokens.ident,"identity expected.");return new Hk(t.toString())}_type_alias(){let t=this._consume(kt.tokens.ident,"identity expected.");this._consume(kt.tokens.equal,"Expected '=' for type alias.");let r=this._type_decl();if(r===null)throw this._error(this._peek(),"Expected Type for Alias.");this._context.aliases.has(r.name)&&(r=this._context.aliases.get(r.name).type);let i=new _5(t.toString(),r);return this._context.aliases.set(i.name,i),i}_type_decl(){if(this._check([kt.tokens.ident,...kt.texel_format,kt.keywords.bool,kt.keywords.f32,kt.keywords.i32,kt.keywords.u32])){let i=this._advance(),s=i.toString();return this._context.structs.has(s)?this._context.structs.get(s):this._context.aliases.has(s)?this._context.aliases.get(s).type:new Dd(i.toString())}let t=this._texture_sampler_types();if(t)return t;if(this._check(kt.template_types)){let i=this._advance().toString(),s=null,n=null;return this._match(kt.tokens.less_than)&&(s=this._type_decl(),n=null,this._match(kt.tokens.comma)&&(n=this._consume(kt.access_mode,"Expected access_mode for pointer").toString()),this._consume(kt.tokens.greater_than,"Expected '>' for type.")),new y5(i,s,n)}if(this._match(kt.keywords.ptr)){let i=this._previous().toString();this._consume(kt.tokens.less_than,"Expected '<' for pointer.");let s=this._consume(kt.storage_class,"Expected storage_class for pointer");this._consume(kt.tokens.comma,"Expected ',' for pointer.");let n=this._type_decl(),o=null;return this._match(kt.tokens.comma)&&(o=this._consume(kt.access_mode,"Expected access_mode for pointer").toString()),this._consume(kt.tokens.greater_than,"Expected '>' for pointer."),new Zk(i,s.toString(),n,o)}let r=this._attribute();if(this._match(kt.keywords.array)){let i=null,s=-1,n=this._previous();if(this._match(kt.tokens.less_than)){i=this._type_decl(),this._context.aliases.has(i.name)&&(i=this._context.aliases.get(i.name).type);let o="";this._match(kt.tokens.comma)&&(o=this._shift_expression().evaluate(this._context).toString()),this._consume(kt.tokens.greater_than,"Expected '>' for array."),s=o?parseInt(o):0}return new x5(n.toString(),r,i,s)}return null}_texture_sampler_types(){if(this._match(kt.sampler_type))return new zg(this._previous().toString(),null,null);if(this._match(kt.depth_texture_type))return new zg(this._previous().toString(),null,null);if(this._match(kt.sampled_texture_type)||this._match(kt.multisampled_texture_type)){let t=this._previous();this._consume(kt.tokens.less_than,"Expected '<' for sampler type.");let r=this._type_decl();return this._consume(kt.tokens.greater_than,"Expected '>' for sampler type."),new zg(t.toString(),r,null)}if(this._match(kt.storage_texture_type)){let t=this._previous();this._consume(kt.tokens.less_than,"Expected '<' for sampler type.");let r=this._consume(kt.texel_format,"Invalid texel format.").toString();this._consume(kt.tokens.comma,"Expected ',' after texel format.");let i=this._consume(kt.access_mode,"Expected access mode for storage texture type.").toString();return this._consume(kt.tokens.greater_than,"Expected '>' for sampler type."),new zg(t.toString(),r,i)}return null}_attribute(){let t=[];for(;this._match(kt.tokens.attr);){let r=this._consume(kt.attribute_name,"Expected attribute name"),i=new I5(r.toString(),null);if(this._match(kt.tokens.paren_left)){if(i.value=this._consume(kt.literal_or_ident,"Expected attribute value").toString(),this._check(kt.tokens.comma)){this._advance();do{let s=this._consume(kt.literal_or_ident,"Expected attribute value").toString();i.value instanceof Array||(i.value=[i.value]),i.value.push(s)}while(this._match(kt.tokens.comma))}this._consume(kt.tokens.paren_right,"Expected ')'")}t.push(i)}for(;this._match(kt.tokens.attr_left);){if(!this._check(kt.tokens.attr_right))do{let r=this._consume(kt.attribute_name,"Expected attribute name"),i=new I5(r.toString(),null);if(this._match(kt.tokens.paren_left)){if(i.value=[this._consume(kt.literal_or_ident,"Expected attribute value").toString()],this._check(kt.tokens.comma)){this._advance();do{let s=this._consume(kt.literal_or_ident,"Expected attribute value").toString();i.value.push(s)}while(this._match(kt.tokens.comma))}this._consume(kt.tokens.paren_right,"Expected ')'")}t.push(i)}while(this._match(kt.tokens.comma));this._consume(kt.tokens.attr_right,"Expected ']]' after attribute declarations")}return t.length==0?null:t}},Cm=class{constructor(t,r){this.name=t,this.attributes=r,this.size=0}get isArray(){return!1}get isStruct(){return!1}get isTemplate(){return!1}},C5=class{constructor(t,r,i){this.name=t,this.type=r,this.attributes=i,this.offset=0,this.size=0}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray?this.type.format:this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}},Dy=class extends Cm{constructor(t,r){super(t,r),this.members=[],this.align=0}get isStruct(){return!0}},Bv=class extends Cm{constructor(t,r){super(t,r),this.count=0,this.stride=0}get isArray(){return!0}},P5=class extends Cm{constructor(t,r,i,s){super(t,i),this.format=r,this.access=s}get isTemplate(){return!0}},Im;(function(e){e[e.Uniform=0]="Uniform",e[e.Storage=1]="Storage",e[e.Texture=2]="Texture",e[e.Sampler=3]="Sampler",e[e.StorageTexture=4]="StorageTexture"})(Im||(Im={}));var Oy=class{constructor(t,r,i,s,n,o,a){this.name=t,this.type=r,this.group=i,this.binding=s,this.attributes=n,this.resourceType=o,this.access=a}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get size(){return this.type.size}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray?this.type.format:this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}},l7=class{constructor(t,r){this.name=t,this.type=r}},By=class{constructor(t,r){this.align=t,this.size=r}},c7=class{constructor(t,r,i,s){this.name=t,this.type=r,this.locationType=i,this.location=s,this.interpolation=null}},R5=class{constructor(t,r,i,s){this.name=t,this.type=r,this.locationType=i,this.location=s}},u7=class{constructor(t,r=null){this.stage=null,this.inputs=[],this.outputs=[],this.name=t,this.stage=r}},h7=class{constructor(){this.vertex=[],this.fragment=[],this.compute=[]}},f7=class{constructor(t,r,i,s){this.name=t,this.type=r,this.attributes=i,this.id=s}},Vg=class e{constructor(t){this.uniforms=[],this.storage=[],this.textures=[],this.samplers=[],this.aliases=[],this.overrides=[],this.structs=[],this.entry=new h7,this._types=new Map,t&&this.update(t)}_isStorageTexture(t){return t.name=="texture_storage_1d"||t.name=="texture_storage_2d"||t.name=="texture_storage_2d_array"||t.name=="texture_storage_3d"}update(t){let i=new a7().parse(t);for(let s of i){if(s instanceof Rd){let n=this._getTypeInfo(s,null);n instanceof Dy&&this.structs.push(n);continue}if(s instanceof _5){this.aliases.push(this._getAliasInfo(s));continue}if(s instanceof m5){let n=s,o=this._getAttributeNum(n.attributes,"id",0),a=n.type!=null?this._getTypeInfo(n.type,n.attributes):null;this.overrides.push(new f7(n.name,a,n.attributes,o));continue}if(this._isUniformVar(s)){let n=s,o=this._getAttributeNum(n.attributes,"group",0),a=this._getAttributeNum(n.attributes,"binding",0),h=this._getTypeInfo(n.type,n.attributes),p=new Oy(n.name,h,o,a,n.attributes,Im.Uniform,n.access);this.uniforms.push(p);continue}if(this._isStorageVar(s)){let n=s,o=this._getAttributeNum(n.attributes,"group",0),a=this._getAttributeNum(n.attributes,"binding",0),h=this._getTypeInfo(n.type,n.attributes),p=this._isStorageTexture(h),g=new Oy(n.name,h,o,a,n.attributes,p?Im.StorageTexture:Im.Storage,n.access);this.storage.push(g);continue}if(this._isTextureVar(s)){let n=s,o=this._getAttributeNum(n.attributes,"group",0),a=this._getAttributeNum(n.attributes,"binding",0),h=this._getTypeInfo(n.type,n.attributes),p=this._isStorageTexture(h),g=new Oy(n.name,h,o,a,n.attributes,p?Im.StorageTexture:Im.Texture,n.access);p?this.storage.push(g):this.textures.push(g);continue}if(this._isSamplerVar(s)){let n=s,o=this._getAttributeNum(n.attributes,"group",0),a=this._getAttributeNum(n.attributes,"binding",0),h=this._getTypeInfo(n.type,n.attributes),p=new Oy(n.name,h,o,a,n.attributes,Im.Sampler,n.access);this.samplers.push(p);continue}if(s instanceof d5){let n=this._getAttribute(s,"vertex"),o=this._getAttribute(s,"fragment"),a=this._getAttribute(s,"compute"),h=n||o||a;if(h){let p=new u7(s.name,h.name);p.inputs=this._getInputs(s.args),p.outputs=this._getOutputs(s.returnType),this.entry[h.name].push(p)}continue}}}getBindGroups(){let t=[];function r(i,s){i>=t.length&&(t.length=i+1),t[i]===void 0&&(t[i]=[]),s>=t[i].length&&(t[i].length=s+1)}for(let i of this.uniforms){r(i.group,i.binding);let s=t[i.group];s[i.binding]=i}for(let i of this.storage){r(i.group,i.binding);let s=t[i.group];s[i.binding]=i}for(let i of this.textures){r(i.group,i.binding);let s=t[i.group];s[i.binding]=i}for(let i of this.samplers){r(i.group,i.binding);let s=t[i.group];s[i.binding]=i}return t}_getOutputs(t,r=void 0){if(r===void 0&&(r=[]),t instanceof Rd)this._getStructOutputs(t,r);else{let i=this._getOutputInfo(t);i!==null&&r.push(i)}return r}_getStructOutputs(t,r){for(let i of t.members)if(i.type instanceof Rd)this._getStructOutputs(i.type,r);else{let s=this._getAttribute(i,"location")||this._getAttribute(i,"builtin");if(s!==null){let n=this._getTypeInfo(i.type,i.type.attributes),o=this._parseInt(s.value),a=new R5(i.name,n,s.name,o);r.push(a)}}}_getOutputInfo(t){let r=this._getAttribute(t,"location")||this._getAttribute(t,"builtin");if(r!==null){let i=this._getTypeInfo(t,t.attributes),s=this._parseInt(r.value);return new R5("",i,r.name,s)}return null}_getInputs(t,r=void 0){r===void 0&&(r=[]);for(let i of t)if(i.type instanceof Rd)this._getStructInputs(i.type,r);else{let s=this._getInputInfo(i);s!==null&&r.push(s)}return r}_getStructInputs(t,r){for(let i of t.members)if(i.type instanceof Rd)this._getStructInputs(i.type,r);else{let s=this._getInputInfo(i);s!==null&&r.push(s)}}_getInputInfo(t){let r=this._getAttribute(t,"location")||this._getAttribute(t,"builtin");if(r!==null){let i=this._getAttribute(t,"interpolation"),s=this._getTypeInfo(t.type,t.attributes),n=this._parseInt(r.value),o=new c7(t.name,s,r.name,n);return i!==null&&(o.interpolation=this._parseString(i.value)),o}return null}_parseString(t){return t instanceof Array&&(t=t[0]),t}_parseInt(t){t instanceof Array&&(t=t[0]);let r=parseInt(t);return isNaN(r)?t:r}_getAlias(t){for(let r of this.aliases)if(r.name==t)return r.type;return null}_getAliasInfo(t){return new l7(t.name,this._getTypeInfo(t.type,null))}_getTypeInfo(t,r){if(this._types.has(t))return this._types.get(t);if(t instanceof x5){let s=t,n=this._getTypeInfo(s.format,s.attributes),o=new Bv(s.name,r);return o.format=n,o.count=s.count,this._types.set(t,o),this._updateTypeInfo(o),o}if(t instanceof Rd){let s=t,n=new Dy(s.name,r);for(let o of s.members){let a=this._getTypeInfo(o.type,o.attributes);n.members.push(new C5(o.name,a,o.attributes))}return this._types.set(t,n),this._updateTypeInfo(n),n}if(t instanceof zg){let s=t,n=s.format instanceof Dd,o=s.format?n?this._getTypeInfo(s.format,null):new Cm(s.format,null):null,a=new P5(s.name,o,r,s.access);return this._types.set(t,a),this._updateTypeInfo(a),a}if(t instanceof y5){let s=t,n=s.format?this._getTypeInfo(s.format,null):null,o=new P5(s.name,n,r,s.access);return this._types.set(t,o),this._updateTypeInfo(o),o}let i=new Cm(t.name,r);return this._types.set(t,i),this._updateTypeInfo(i),i}_updateTypeInfo(t){var r,i;let s=this._getTypeSize(t);if(t.size=(r=s?.size)!==null&&r!==void 0?r:0,t instanceof Bv){let n=this._getTypeSize(t.format);t.stride=(i=n?.size)!==null&&i!==void 0?i:0,this._updateTypeInfo(t.format)}t instanceof Dy&&this._updateStructInfo(t)}_updateStructInfo(t){var r;let i=0,s=0,n=0,o=0;for(let a=0,h=t.members.length;a<h;++a){let p=t.members[a],g=this._getTypeSize(p);if(!g)continue;(r=this._getAlias(p.type.name))!==null&&r!==void 0||p.type;let v=g.align,T=g.size;i=this._roundUp(v,i+s),s=T,n=i,o=Math.max(o,v),p.offset=i,p.size=T,this._updateTypeInfo(p.type)}t.size=this._roundUp(o,n+s),t.align=o}_getTypeSize(t){var r;if(t==null)return null;let i=this._getAttributeNum(t.attributes,"size",0),s=this._getAttributeNum(t.attributes,"align",0);if(t instanceof C5&&(t=t.type),t instanceof Cm){let n=this._getAlias(t.name);n!==null&&(t=n)}{let n=e._typeInfo[t.name];if(n!==void 0){let o=t.format==="f16"?2:1;return new By(Math.max(s,n.align/o),Math.max(i,n.size/o))}}{let n=e._typeInfo[t.name.substring(0,t.name.length-1)];if(n){let o=t.name[t.name.length-1]==="h"?2:1;return new By(Math.max(s,n.align/o),Math.max(i,n.size/o))}}if(t instanceof Bv){let n=t,o=8,a=8,h=this._getTypeSize(n.format);h!==null&&(a=h.size,o=h.align);let p=n.count,g=this._getAttributeNum((r=t?.attributes)!==null&&r!==void 0?r:null,"stride",this._roundUp(o,a));return a=p*g,i&&(a=i),new By(Math.max(s,o),Math.max(i,a))}if(t instanceof Dy){let n=0,o=0,a=0,h=0,p=0;for(let g of t.members){let v=this._getTypeSize(g.type);v!==null&&(n=Math.max(v.align,n),a=this._roundUp(v.align,a+h),h=v.size,p=a)}return o=this._roundUp(n,p+h),new By(Math.max(s,n),Math.max(i,o))}return null}_isUniformVar(t){return t instanceof Mm&&t.storage=="uniform"}_isStorageVar(t){return t instanceof Mm&&t.storage=="storage"}_isTextureVar(t){return t instanceof Mm&&t.type!==null&&e._textureTypes.indexOf(t.type.name)!=-1}_isSamplerVar(t){return t instanceof Mm&&t.type!==null&&e._samplerTypes.indexOf(t.type.name)!=-1}_getAttribute(t,r){let i=t;if(!i||!i.attributes)return null;let s=i.attributes;for(let n of s)if(n.name==r)return n;return null}_getAttributeNum(t,r,i){if(t===null)return i;for(let s of t)if(s.name==r){let n=s!==null&&s.value!==null?s.value:i;return n instanceof Array&&(n=n[0]),typeof n=="number"?n:typeof n=="string"?parseInt(n):i}return i}_roundUp(t,r){return Math.ceil(r/t)*t}};Vg._typeInfo={f16:{align:2,size:2},i32:{align:4,size:4},u32:{align:4,size:4},f32:{align:4,size:4},atomic:{align:4,size:4},vec2:{align:8,size:8},vec3:{align:16,size:12},vec4:{align:16,size:16},mat2x2:{align:8,size:16},mat3x2:{align:8,size:24},mat4x2:{align:8,size:32},mat2x3:{align:16,size:32},mat3x3:{align:16,size:48},mat4x3:{align:16,size:64},mat2x4:{align:16,size:32},mat3x4:{align:16,size:48},mat4x4:{align:16,size:64}};Vg._textureTypes=kt.any_texture_type.map(e=>e.name);Vg._samplerTypes=kt.sampler_type.map(e=>e.name);function p7(e){let t={attributes:[],bindings:[]},r;try{r=P0t(e)}catch(n){return Ce.error(n.message)(),t}for(let n of r.uniforms){let o=[];for(let a of n.type.members)o.push({name:a.name,type:lW(a.type)});t.bindings.push({type:"uniform",name:n.name,location:n.binding,group:n.group,members:o})}let i=r.entry.vertex[0],s=i?.inputs.length||0;for(let n=0;n<s;n++){let o=i.inputs[n];if(o.locationType==="location"){let a=lW(o.type);t.attributes.push({name:o.name,location:o.location,type:a})}}return t}function lW(e){return e.format?`${e.name}<${e.format.name}>`:e.name}function P0t(e){try{return new Vg(e)}catch(t){if(t instanceof Error)throw t;let r="WGSL parse error";throw typeof t=="object"&&t?.message&&(r+=`: ${t.message} `),typeof t=="object"&&t?.token&&(r+=t.token.line||""),new Error(r,{cause:t})}}var R0t=`#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
const float TWO_PI = 6.2831854820251465;
const float PI_2 = 1.5707963705062866;
const float PI_16 = 0.1963495463132858;
const float SIN_TABLE_0 = 0.19509032368659973;
const float SIN_TABLE_1 = 0.3826834261417389;
const float SIN_TABLE_2 = 0.5555702447891235;
const float SIN_TABLE_3 = 0.7071067690849304;
const float COS_TABLE_0 = 0.9807852506637573;
const float COS_TABLE_1 = 0.9238795042037964;
const float COS_TABLE_2 = 0.8314695954322815;
const float COS_TABLE_3 = 0.7071067690849304;
const float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;
const float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;
const float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;
const float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;
float sin_taylor_fp32(float a) {
float r, s, t, x;
if (a == 0.0) {
return 0.0;
}
x = -a * a;
s = a;
r = a;
r = r * x;
t = r * INVERSE_FACTORIAL_3;
s = s + t;
r = r * x;
t = r * INVERSE_FACTORIAL_5;
s = s + t;
r = r * x;
t = r * INVERSE_FACTORIAL_7;
s = s + t;
r = r * x;
t = r * INVERSE_FACTORIAL_9;
s = s + t;
return s;
}
void sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {
if (a == 0.0) {
sin_t = 0.0;
cos_t = 1.0;
}
sin_t = sin_taylor_fp32(a);
cos_t = sqrt(1.0 - sin_t * sin_t);
}
float tan_taylor_fp32(float a) {
float sin_a;
float cos_a;
if (a == 0.0) {
return 0.0;
}
float z = floor(a / TWO_PI);
float r = a - TWO_PI * z;
float t;
float q = floor(r / PI_2 + 0.5);
int j = int(q);
if (j < -2 || j > 2) {
return 1.0 / 0.0;
}
t = r - PI_2 * q;
q = floor(t / PI_16 + 0.5);
int k = int(q);
int abs_k = int(abs(float(k)));
if (abs_k > 4) {
return 1.0 / 0.0;
} else {
t = t - PI_16 * q;
}
float u = 0.0;
float v = 0.0;
float sin_t, cos_t;
float s, c;
sincos_taylor_fp32(t, sin_t, cos_t);
if (k == 0) {
s = sin_t;
c = cos_t;
} else {
if (abs(float(abs_k) - 1.0) < 0.5) {
u = COS_TABLE_0;
v = SIN_TABLE_0;
} else if (abs(float(abs_k) - 2.0) < 0.5) {
u = COS_TABLE_1;
v = SIN_TABLE_1;
} else if (abs(float(abs_k) - 3.0) < 0.5) {
u = COS_TABLE_2;
v = SIN_TABLE_2;
} else if (abs(float(abs_k) - 4.0) < 0.5) {
u = COS_TABLE_3;
v = SIN_TABLE_3;
}
if (k > 0) {
s = u * sin_t + v * cos_t;
c = u * cos_t - v * sin_t;
} else {
s = u * sin_t - v * cos_t;
c = u * cos_t + v * sin_t;
}
}
if (j == 0) {
sin_a = s;
cos_a = c;
} else if (j == 1) {
sin_a = c;
cos_a = -s;
} else if (j == -1) {
sin_a = -c;
cos_a = s;
} else {
sin_a = -s;
cos_a = -c;
}
return sin_a / cos_a;
}
#endif
float tan_fp32(float a) {
#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
return tan_taylor_fp32(a);
#else
return tan(a);
#endif
}
`,d7={name:"fp32",vs:R0t};var k0t=new Float32Array([0,1,1,1]),D0t=`uniform pickingUniforms {
float isActive;
float isAttribute;
float isHighlightActive;
float useFloatColors;
vec3 highlightedObjectColor;
vec4 highlightColor;
} picking;
out vec4 picking_vRGBcolor_Avalid;
vec3 picking_normalizeColor(vec3 color) {
return picking.useFloatColors > 0.5 ? color : color / 255.0;
}
vec4 picking_normalizeColor(vec4 color) {
return picking.useFloatColors > 0.5 ? color : color / 255.0;
}
bool picking_isColorZero(vec3 color) {
return dot(color, vec3(1.0)) < 0.00001;
}
bool picking_isColorValid(vec3 color) {
return dot(color, vec3(1.0)) > 0.00001;
}
bool isVertexHighlighted(vec3 vertexColor) {
vec3 highlightedObjectColor = picking_normalizeColor(picking.highlightedObjectColor);
return
bool(picking.isHighlightActive) && picking_isColorZero(abs(vertexColor - highlightedObjectColor));
}
void picking_setPickingColor(vec3 pickingColor) {
pickingColor = picking_normalizeColor(pickingColor);
if (bool(picking.isActive)) {
picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));
if (!bool(picking.isAttribute)) {
picking_vRGBcolor_Avalid.rgb = pickingColor;
}
} else {
picking_vRGBcolor_Avalid.a = float(isVertexHighlighted(pickingColor));
}
}
void picking_setPickingAttribute(float value) {
if (bool(picking.isAttribute)) {
picking_vRGBcolor_Avalid.r = value;
}
}
void picking_setPickingAttribute(vec2 value) {
if (bool(picking.isAttribute)) {
picking_vRGBcolor_Avalid.rg = value;
}
}
void picking_setPickingAttribute(vec3 value) {
if (bool(picking.isAttribute)) {
picking_vRGBcolor_Avalid.rgb = value;
}
}
`,O0t=`uniform pickingUniforms {
float isActive;
float isAttribute;
float isHighlightActive;
float useFloatColors;
vec3 highlightedObjectColor;
vec4 highlightColor;
} picking;
in vec4 picking_vRGBcolor_Avalid;
vec4 picking_filterHighlightColor(vec4 color) {
if (picking.isActive > 0.5) {
return color;
}
bool selected = bool(picking_vRGBcolor_Avalid.a);
if (selected) {
float highLightAlpha = picking.highlightColor.a;
float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);
float highLightRatio = highLightAlpha / blendedAlpha;
vec3 blendedRGB = mix(color.rgb, picking.highlightColor.rgb, highLightRatio);
return vec4(blendedRGB, blendedAlpha);
} else {
return color;
}
}
vec4 picking_filterPickingColor(vec4 color) {
if (bool(picking.isActive)) {
if (picking_vRGBcolor_Avalid.a == 0.0) {
discard;
}
return picking_vRGBcolor_Avalid;
}
return color;
}
vec4 picking_filterColor(vec4 color) {
vec4 highlightColor = picking_filterHighlightColor(color);
return picking_filterPickingColor(highlightColor);
}
`,k5={name:"picking",vs:D0t,fs:O0t,uniformTypes:{isActive:"f32",isAttribute:"f32",isHighlightActive:"f32",useFloatColors:"f32",highlightedObjectColor:"vec3<f32>",highlightColor:"vec4<f32>"},defaultUniforms:{isActive:!1,isAttribute:!1,isHighlightActive:!1,useFloatColors:!0,highlightedObjectColor:new Float32Array([0,0,0]),highlightColor:k0t},getUniforms:B0t};function B0t(e={},t){let r={};if(e.highlightedObjectColor!==void 0)if(e.highlightedObjectColor===null)r.isHighlightActive=!1;else{r.isHighlightActive=!0;let i=e.highlightedObjectColor.slice(0,3);r.highlightedObjectColor=i}if(e.highlightColor){let i=Array.from(e.highlightColor,s=>s/255);Number.isFinite(i[3])||(i[3]=1),r.highlightColor=i}return e.isActive!==void 0&&(r.isActive=!!e.isActive,r.isAttribute=!!e.isAttribute),e.useFloatColors!==void 0&&(r.useFloatColors=!!e.useFloatColors),r}function m7(e,t=[],r=0){let i=Math.fround(e),s=e-i;return t[r]=i,t[r+1]=s,t}function cW(e){return e-Math.fround(e)}function uW(e){let t=new Float32Array(32);for(let r=0;r<4;++r)for(let i=0;i<4;++i){let s=r*4+i;m7(e[i*4+r],t,s*2)}return t}var hW=`uniform float ONE;
vec2 split(float a) {
const float SPLIT = 4097.0;
float t = a * SPLIT;
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
float a_hi = t * ONE - (t - a);
float a_lo = a * ONE - a_hi;
#else
float a_hi = t - (t - a);
float a_lo = a - a_hi;
#endif
return vec2(a_hi, a_lo);
}
vec2 split2(vec2 a) {
vec2 b = split(a.x);
b.y += a.y;
return b;
}
vec2 quickTwoSum(float a, float b) {
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
float sum = (a + b) * ONE;
float err = b - (sum - a) * ONE;
#else
float sum = a + b;
float err = b - (sum - a);
#endif
return vec2(sum, err);
}
vec2 twoSum(float a, float b) {
float s = (a + b);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
float v = (s * ONE - a) * ONE;
float err = (a - (s - v) * ONE) * ONE * ONE * ONE + (b - v);
#else
float v = s - a;
float err = (a - (s - v)) + (b - v);
#endif
return vec2(s, err);
}
vec2 twoSub(float a, float b) {
float s = (a - b);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
float v = (s * ONE - a) * ONE;
float err = (a - (s - v) * ONE) * ONE * ONE * ONE - (b + v);
#else
float v = s - a;
float err = (a - (s - v)) - (b + v);
#endif
return vec2(s, err);
}
vec2 twoSqr(float a) {
float prod = a * a;
vec2 a_fp64 = split(a);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
float err = ((a_fp64.x * a_fp64.x - prod) * ONE + 2.0 * a_fp64.x *
a_fp64.y * ONE * ONE) + a_fp64.y * a_fp64.y * ONE * ONE * ONE;
#else
float err = ((a_fp64.x * a_fp64.x - prod) + 2.0 * a_fp64.x * a_fp64.y) + a_fp64.y * a_fp64.y;
#endif
return vec2(prod, err);
}
vec2 twoProd(float a, float b) {
float prod = a * b;
vec2 a_fp64 = split(a);
vec2 b_fp64 = split(b);
float err = ((a_fp64.x * b_fp64.x - prod) + a_fp64.x * b_fp64.y +
a_fp64.y * b_fp64.x) + a_fp64.y * b_fp64.y;
return vec2(prod, err);
}
vec2 sum_fp64(vec2 a, vec2 b) {
vec2 s, t;
s = twoSum(a.x, b.x);
t = twoSum(a.y, b.y);
s.y += t.x;
s = quickTwoSum(s.x, s.y);
s.y += t.y;
s = quickTwoSum(s.x, s.y);
return s;
}
vec2 sub_fp64(vec2 a, vec2 b) {
vec2 s, t;
s = twoSub(a.x, b.x);
t = twoSub(a.y, b.y);
s.y += t.x;
s = quickTwoSum(s.x, s.y);
s.y += t.y;
s = quickTwoSum(s.x, s.y);
return s;
}
vec2 mul_fp64(vec2 a, vec2 b) {
vec2 prod = twoProd(a.x, b.x);
prod.y += a.x * b.y;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
prod = split2(prod);
#endif
prod = quickTwoSum(prod.x, prod.y);
prod.y += a.y * b.x;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
prod = split2(prod);
#endif
prod = quickTwoSum(prod.x, prod.y);
return prod;
}
vec2 div_fp64(vec2 a, vec2 b) {
float xn = 1.0 / b.x;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
vec2 yn = mul_fp64(a, vec2(xn, 0));
#else
vec2 yn = a * xn;
#endif
float diff = (sub_fp64(a, mul_fp64(b, yn))).x;
vec2 prod = twoProd(xn, diff);
return sum_fp64(yn, prod);
}
vec2 sqrt_fp64(vec2 a) {
if (a.x == 0.0 && a.y == 0.0) return vec2(0.0, 0.0);
if (a.x < 0.0) return vec2(0.0 / 0.0, 0.0 / 0.0);
float x = 1.0 / sqrt(a.x);
float yn = a.x * x;
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
vec2 yn_sqr = twoSqr(yn) * ONE;
#else
vec2 yn_sqr = twoSqr(yn);
#endif
float diff = sub_fp64(a, yn_sqr).x;
vec2 prod = twoProd(x * 0.5, diff);
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
return sum_fp64(split(yn), prod);
#else
return sum_fp64(vec2(yn, 0.0), prod);
#endif
}
`;var N0t={ONE:1};function L0t(){return N0t}var A7={name:"fp64-arithmetic",vs:hW,getUniforms:L0t,fp64ify:m7,fp64LowPart:cW,fp64ifyMatrix4:uW};var h9t=1/Math.PI*180,f9t=1/180*Math.PI,F0t={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0,_cartographicRadians:!1};globalThis.mathgl=globalThis.mathgl||{config:{...F0t}};var Ro=globalThis.mathgl.config;function g7(e,{precision:t=Ro.precision}={}){return e=z0t(e),`${parseFloat(e.toPrecision(t))}`}function Yh(e){return Array.isArray(e)||ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Xu(e,t,r){return V0t(e,i=>Math.max(t,Math.min(r,i)))}function yc(e,t,r){return Yh(e)?e.map((i,s)=>yc(i,t[s],r)):r*t+(1-r)*e}function $l(e,t,r){let i=Ro.EPSILON;r&&(Ro.EPSILON=r);try{if(e===t)return!0;if(Yh(e)&&Yh(t)){if(e.length!==t.length)return!1;for(let s=0;s<e.length;++s)if(!$l(e[s],t[s]))return!1;return!0}return e&&e.equals?e.equals(t):t&&t.equals?t.equals(e):typeof e=="number"&&typeof t=="number"?Math.abs(e-t)<=Ro.EPSILON*Math.max(1,Math.abs(e),Math.abs(t)):!1}finally{Ro.EPSILON=i}}function z0t(e){return Math.round(e/Ro.EPSILON)*Ro.EPSILON}function U0t(e){return e.clone?e.clone():new Array(e.length)}function V0t(e,t,r){if(Yh(e)){let i=e;r=r||U0t(i);for(let s=0;s<r.length&&s<i.length;++s){let n=typeof e=="number"?e:e[s];r[s]=t(n,s,r)}return r}return t(e)}var Pm=class extends Array{clone(){return new this.constructor().copy(this)}fromArray(t,r=0){for(let i=0;i<this.ELEMENTS;++i)this[i]=t[i+r];return this.check()}toArray(t=[],r=0){for(let i=0;i<this.ELEMENTS;++i)t[r+i]=this[i];return t}toObject(t){return t}from(t){return Array.isArray(t)?this.copy(t):this.fromObject(t)}to(t){return t===this?this:Yh(t)?this.toArray(t):this.toObject(t)}toTarget(t){return t?this.to(t):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(Ro)}formatString(t){let r="";for(let i=0;i<this.ELEMENTS;++i)r+=(i>0?", ":"")+g7(this[i],t);return`${t.printTypes?this.constructor.name:""}[${r}]`}equals(t){if(!t||this.length!==t.length)return!1;for(let r=0;r<this.ELEMENTS;++r)if(!$l(this[r],t[r]))return!1;return!0}exactEquals(t){if(!t||this.length!==t.length)return!1;for(let r=0;r<this.ELEMENTS;++r)if(this[r]!==t[r])return!1;return!0}negate(){for(let t=0;t<this.ELEMENTS;++t)this[t]=-this[t];return this.check()}lerp(t,r,i){if(i===void 0)return this.lerp(this,t,r);for(let s=0;s<this.ELEMENTS;++s){let n=t[s],o=typeof r=="number"?r:r[s];this[s]=n+i*(o-n)}return this.check()}min(t){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(t[r],this[r]);return this.check()}max(t){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.max(t[r],this[r]);return this.check()}clamp(t,r){for(let i=0;i<this.ELEMENTS;++i)this[i]=Math.min(Math.max(this[i],t[i]),r[i]);return this.check()}add(...t){for(let r of t)for(let i=0;i<this.ELEMENTS;++i)this[i]+=r[i];return this.check()}subtract(...t){for(let r of t)for(let i=0;i<this.ELEMENTS;++i)this[i]-=r[i];return this.check()}scale(t){if(typeof t=="number")for(let r=0;r<this.ELEMENTS;++r)this[r]*=t;else for(let r=0;r<this.ELEMENTS&&r<t.length;++r)this[r]*=t[r];return this.check()}multiplyByScalar(t){for(let r=0;r<this.ELEMENTS;++r)this[r]*=t;return this.check()}check(){if(Ro.debug&&!this.validate())throw new Error(`math.gl: ${this.constructor.name} some fields set to invalid numbers'`);return this}validate(){let t=this.length===this.ELEMENTS;for(let r=0;r<this.ELEMENTS;++r)t=t&&Number.isFinite(this[r]);return t}sub(t){return this.subtract(t)}setScalar(t){for(let r=0;r<this.ELEMENTS;++r)this[r]=t;return this.check()}addScalar(t){for(let r=0;r<this.ELEMENTS;++r)this[r]+=t;return this.check()}subScalar(t){return this.addScalar(-t)}multiplyScalar(t){for(let r=0;r<this.ELEMENTS;++r)this[r]*=t;return this.check()}divideScalar(t){return this.multiplyByScalar(1/t)}clampScalar(t,r){for(let i=0;i<this.ELEMENTS;++i)this[i]=Math.min(Math.max(this[i],t),r);return this.check()}get elements(){return this}};function j0t(e,t){if(e.length!==t)return!1;for(let r=0;r<e.length;++r)if(!Number.isFinite(e[r]))return!1;return!0}function On(e){if(!Number.isFinite(e))throw new Error(`Invalid number ${JSON.stringify(e)}`);return e}function Rm(e,t,r=""){if(Ro.debug&&!j0t(e,t))throw new Error(`math.gl: ${r} some fields set to invalid numbers'`);return e}function ep(e,t){if(!e)throw new Error(`math.gl assertion ${t}`)}var Ly=class extends Pm{get x(){return this[0]}set x(t){this[0]=On(t)}get y(){return this[1]}set y(t){this[1]=On(t)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let t=0;for(let r=0;r<this.ELEMENTS;++r)t+=this[r]*this[r];return t}magnitudeSquared(){return this.lengthSquared()}distance(t){return Math.sqrt(this.distanceSquared(t))}distanceSquared(t){let r=0;for(let i=0;i<this.ELEMENTS;++i){let s=this[i]-t[i];r+=s*s}return On(r)}dot(t){let r=0;for(let i=0;i<this.ELEMENTS;++i)r+=this[i]*t[i];return On(r)}normalize(){let t=this.magnitude();if(t!==0)for(let r=0;r<this.ELEMENTS;++r)this[r]/=t;return this.check()}multiply(...t){for(let r of t)for(let i=0;i<this.ELEMENTS;++i)this[i]*=r[i];return this.check()}divide(...t){for(let r of t)for(let i=0;i<this.ELEMENTS;++i)this[i]/=r[i];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(t){return this.distance(t)}distanceToSquared(t){return this.distanceSquared(t)}getComponent(t){return ep(t>=0&&t<this.ELEMENTS,"index is out of range"),On(this[t])}setComponent(t,r){return ep(t>=0&&t<this.ELEMENTS,"index is out of range"),this[t]=r,this.check()}addVectors(t,r){return this.copy(t).add(r)}subVectors(t,r){return this.copy(t).subtract(r)}multiplyVectors(t,r){return this.copy(t).multiply(r)}addScaledVector(t,r){return this.add(new this.constructor(t).multiplyScalar(r))}};var ip={};Ua(ip,{add:()=>Y0t,angle:()=>hmt,ceil:()=>X0t,clone:()=>W0t,copy:()=>H0t,create:()=>fW,cross:()=>smt,dist:()=>xmt,distance:()=>AW,div:()=>ymt,divide:()=>mW,dot:()=>nmt,equals:()=>mmt,exactEquals:()=>dmt,floor:()=>Z0t,forEach:()=>wmt,fromValues:()=>$0t,inverse:()=>rmt,len:()=>Amt,length:()=>_W,lerp:()=>omt,max:()=>Q0t,min:()=>G0t,mul:()=>_mt,multiply:()=>dW,negate:()=>emt,normalize:()=>imt,random:()=>amt,rotate:()=>umt,round:()=>K0t,scale:()=>J0t,scaleAndAdd:()=>tmt,set:()=>q0t,sqrDist:()=>bmt,sqrLen:()=>vmt,squaredDistance:()=>gW,squaredLength:()=>yW,str:()=>pmt,sub:()=>gmt,subtract:()=>pW,transformMat2:()=>lmt,transformMat2d:()=>cmt,transformMat3:()=>_7,transformMat4:()=>y7,zero:()=>fmt});var as=typeof Float32Array<"u"?Float32Array:Array,rp=Math.random;function Zu(e){return e>=0?Math.round(e):e%.5===0?Math.floor(e):Math.round(e)}var w9t=Math.PI/180;function fW(){let e=new as(2);return as!=Float32Array&&(e[0]=0,e[1]=0),e}function W0t(e){let t=new as(2);return t[0]=e[0],t[1]=e[1],t}function $0t(e,t){let r=new as(2);return r[0]=e,r[1]=t,r}function H0t(e,t){return e[0]=t[0],e[1]=t[1],e}function q0t(e,t,r){return e[0]=t,e[1]=r,e}function Y0t(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e}function pW(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e}function dW(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e}function mW(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e}function X0t(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e}function Z0t(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e}function G0t(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e}function Q0t(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e}function K0t(e,t){return e[0]=Zu(t[0]),e[1]=Zu(t[1]),e}function J0t(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e}function tmt(e,t,r,i){return e[0]=t[0]+r[0]*i,e[1]=t[1]+r[1]*i,e}function AW(e,t){let r=t[0]-e[0],i=t[1]-e[1];return Math.sqrt(r*r+i*i)}function gW(e,t){let r=t[0]-e[0],i=t[1]-e[1];return r*r+i*i}function _W(e){let t=e[0],r=e[1];return Math.sqrt(t*t+r*r)}function yW(e){let t=e[0],r=e[1];return t*t+r*r}function emt(e,t){return e[0]=-t[0],e[1]=-t[1],e}function rmt(e,t){return e[0]=1/t[0],e[1]=1/t[1],e}function imt(e,t){let r=t[0],i=t[1],s=r*r+i*i;return s>0&&(s=1/Math.sqrt(s)),e[0]=t[0]*s,e[1]=t[1]*s,e}function nmt(e,t){return e[0]*t[0]+e[1]*t[1]}function smt(e,t,r){let i=t[0]*r[1]-t[1]*r[0];return e[0]=e[1]=0,e[2]=i,e}function omt(e,t,r,i){let s=t[0],n=t[1];return e[0]=s+i*(r[0]-s),e[1]=n+i*(r[1]-n),e}function amt(e,t){t=t===void 0?1:t;let r=rp()*2*Math.PI;return e[0]=Math.cos(r)*t,e[1]=Math.sin(r)*t,e}function lmt(e,t,r){let i=t[0],s=t[1];return e[0]=r[0]*i+r[2]*s,e[1]=r[1]*i+r[3]*s,e}function cmt(e,t,r){let i=t[0],s=t[1];return e[0]=r[0]*i+r[2]*s+r[4],e[1]=r[1]*i+r[3]*s+r[5],e}function _7(e,t,r){let i=t[0],s=t[1];return e[0]=r[0]*i+r[3]*s+r[6],e[1]=r[1]*i+r[4]*s+r[7],e}function y7(e,t,r){let i=t[0],s=t[1];return e[0]=r[0]*i+r[4]*s+r[12],e[1]=r[1]*i+r[5]*s+r[13],e}function umt(e,t,r,i){let s=t[0]-r[0],n=t[1]-r[1],o=Math.sin(i),a=Math.cos(i);return e[0]=s*a-n*o+r[0],e[1]=s*o+n*a+r[1],e}function hmt(e,t){let r=e[0],i=e[1],s=t[0],n=t[1],o=Math.sqrt((r*r+i*i)*(s*s+n*n)),a=o&&(r*s+i*n)/o;return Math.acos(Math.min(Math.max(a,-1),1))}function fmt(e){return e[0]=0,e[1]=0,e}function pmt(e){return`vec2(${e[0]}, ${e[1]})`}function dmt(e,t){return e[0]===t[0]&&e[1]===t[1]}function mmt(e,t){let r=e[0],i=e[1],s=t[0],n=t[1];return Math.abs(r-s)<=1e-6*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(i-n)<=1e-6*Math.max(1,Math.abs(i),Math.abs(n))}var Amt=_W,gmt=pW,_mt=dW,ymt=mW,xmt=AW,bmt=gW,vmt=yW,wmt=function(){let e=fW();return function(t,r,i,s,n,o){let a,h;for(r||(r=2),i||(i=0),s?h=Math.min(s*r+i,t.length):h=t.length,a=i;a<h;a+=r)e[0]=t[a],e[1]=t[a+1],n(e,e,o),t[a]=e[0],t[a+1]=e[1];return t}}();function xW(e,t,r){let i=t[0],s=t[1],n=r[3]*i+r[7]*s||1;return e[0]=(r[0]*i+r[4]*s)/n,e[1]=(r[1]*i+r[5]*s)/n,e}function D5(e,t,r){let i=t[0],s=t[1],n=t[2],o=r[3]*i+r[7]*s+r[11]*n||1;return e[0]=(r[0]*i+r[4]*s+r[8]*n)/o,e[1]=(r[1]*i+r[5]*s+r[9]*n)/o,e[2]=(r[2]*i+r[6]*s+r[10]*n)/o,e}function bW(e,t,r){let i=t[0],s=t[1];return e[0]=r[0]*i+r[2]*s,e[1]=r[1]*i+r[3]*s,e[2]=t[2],e}function vW(e,t,r){let i=t[0],s=t[1];return e[0]=r[0]*i+r[2]*s,e[1]=r[1]*i+r[3]*s,e[2]=t[2],e[3]=t[3],e}function O5(e,t,r){let i=t[0],s=t[1],n=t[2];return e[0]=r[0]*i+r[3]*s+r[6]*n,e[1]=r[1]*i+r[4]*s+r[7]*n,e[2]=r[2]*i+r[5]*s+r[8]*n,e[3]=t[3],e}var xc={};Ua(xc,{add:()=>Imt,angle:()=>T7,bezier:()=>Umt,ceil:()=>Mmt,clone:()=>Tmt,copy:()=>Smt,create:()=>B5,cross:()=>jg,dist:()=>Zmt,distance:()=>IW,div:()=>Xmt,divide:()=>EW,dot:()=>Lv,equals:()=>Hmt,exactEquals:()=>$mt,floor:()=>Cmt,forEach:()=>Kmt,fromValues:()=>N5,hermite:()=>zmt,inverse:()=>Nmt,len:()=>S7,length:()=>wW,lerp:()=>Lmt,max:()=>Rmt,min:()=>Pmt,mul:()=>Ymt,multiply:()=>SW,negate:()=>Bmt,normalize:()=>x7,random:()=>Vmt,rotateX:()=>b7,rotateY:()=>v7,rotateZ:()=>w7,round:()=>kmt,scale:()=>Dmt,scaleAndAdd:()=>Omt,set:()=>Emt,slerp:()=>Fmt,sqrDist:()=>Gmt,sqrLen:()=>Qmt,squaredDistance:()=>MW,squaredLength:()=>CW,str:()=>Wmt,sub:()=>qmt,subtract:()=>TW,transformMat3:()=>Fv,transformMat4:()=>Wg,transformQuat:()=>zv,zero:()=>jmt});function B5(){let e=new as(3);return as!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function Tmt(e){let t=new as(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function wW(e){let t=e[0],r=e[1],i=e[2];return Math.sqrt(t*t+r*r+i*i)}function N5(e,t,r){let i=new as(3);return i[0]=e,i[1]=t,i[2]=r,i}function Smt(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function Emt(e,t,r,i){return e[0]=t,e[1]=r,e[2]=i,e}function Imt(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e}function TW(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e}function SW(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e}function EW(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e}function Mmt(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e}function Cmt(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e}function Pmt(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e}function Rmt(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e}function kmt(e,t){return e[0]=Zu(t[0]),e[1]=Zu(t[1]),e[2]=Zu(t[2]),e}function Dmt(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e}function Omt(e,t,r,i){return e[0]=t[0]+r[0]*i,e[1]=t[1]+r[1]*i,e[2]=t[2]+r[2]*i,e}function IW(e,t){let r=t[0]-e[0],i=t[1]-e[1],s=t[2]-e[2];return Math.sqrt(r*r+i*i+s*s)}function MW(e,t){let r=t[0]-e[0],i=t[1]-e[1],s=t[2]-e[2];return r*r+i*i+s*s}function CW(e){let t=e[0],r=e[1],i=e[2];return t*t+r*r+i*i}function Bmt(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}function Nmt(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e}function x7(e,t){let r=t[0],i=t[1],s=t[2],n=r*r+i*i+s*s;return n>0&&(n=1/Math.sqrt(n)),e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e}function Lv(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function jg(e,t,r){let i=t[0],s=t[1],n=t[2],o=r[0],a=r[1],h=r[2];return e[0]=s*h-n*a,e[1]=n*o-i*h,e[2]=i*a-s*o,e}function Lmt(e,t,r,i){let s=t[0],n=t[1],o=t[2];return e[0]=s+i*(r[0]-s),e[1]=n+i*(r[1]-n),e[2]=o+i*(r[2]-o),e}function Fmt(e,t,r,i){let s=Math.acos(Math.min(Math.max(Lv(t,r),-1),1)),n=Math.sin(s),o=Math.sin((1-i)*s)/n,a=Math.sin(i*s)/n;return e[0]=o*t[0]+a*r[0],e[1]=o*t[1]+a*r[1],e[2]=o*t[2]+a*r[2],e}function zmt(e,t,r,i,s,n){let o=n*n,a=o*(2*n-3)+1,h=o*(n-2)+n,p=o*(n-1),g=o*(3-2*n);return e[0]=t[0]*a+r[0]*h+i[0]*p+s[0]*g,e[1]=t[1]*a+r[1]*h+i[1]*p+s[1]*g,e[2]=t[2]*a+r[2]*h+i[2]*p+s[2]*g,e}function Umt(e,t,r,i,s,n){let o=1-n,a=o*o,h=n*n,p=a*o,g=3*n*a,v=3*h*o,T=h*n;return e[0]=t[0]*p+r[0]*g+i[0]*v+s[0]*T,e[1]=t[1]*p+r[1]*g+i[1]*v+s[1]*T,e[2]=t[2]*p+r[2]*g+i[2]*v+s[2]*T,e}function Vmt(e,t){t=t===void 0?1:t;let r=rp()*2*Math.PI,i=rp()*2-1,s=Math.sqrt(1-i*i)*t;return e[0]=Math.cos(r)*s,e[1]=Math.sin(r)*s,e[2]=i*t,e}function Wg(e,t,r){let i=t[0],s=t[1],n=t[2],o=r[3]*i+r[7]*s+r[11]*n+r[15];return o=o||1,e[0]=(r[0]*i+r[4]*s+r[8]*n+r[12])/o,e[1]=(r[1]*i+r[5]*s+r[9]*n+r[13])/o,e[2]=(r[2]*i+r[6]*s+r[10]*n+r[14])/o,e}function Fv(e,t,r){let i=t[0],s=t[1],n=t[2];return e[0]=i*r[0]+s*r[3]+n*r[6],e[1]=i*r[1]+s*r[4]+n*r[7],e[2]=i*r[2]+s*r[5]+n*r[8],e}function zv(e,t,r){let i=r[0],s=r[1],n=r[2],o=r[3],a=t[0],h=t[1],p=t[2],g=s*p-n*h,v=n*a-i*p,T=i*h-s*a,C=s*T-n*v,B=n*g-i*T,L=i*v-s*g,z=o*2;return g*=z,v*=z,T*=z,C*=2,B*=2,L*=2,e[0]=a+g+C,e[1]=h+v+B,e[2]=p+T+L,e}function b7(e,t,r,i){let s=[],n=[];return s[0]=t[0]-r[0],s[1]=t[1]-r[1],s[2]=t[2]-r[2],n[0]=s[0],n[1]=s[1]*Math.cos(i)-s[2]*Math.sin(i),n[2]=s[1]*Math.sin(i)+s[2]*Math.cos(i),e[0]=n[0]+r[0],e[1]=n[1]+r[1],e[2]=n[2]+r[2],e}function v7(e,t,r,i){let s=[],n=[];return s[0]=t[0]-r[0],s[1]=t[1]-r[1],s[2]=t[2]-r[2],n[0]=s[2]*Math.sin(i)+s[0]*Math.cos(i),n[1]=s[1],n[2]=s[2]*Math.cos(i)-s[0]*Math.sin(i),e[0]=n[0]+r[0],e[1]=n[1]+r[1],e[2]=n[2]+r[2],e}function w7(e,t,r,i){let s=[],n=[];return s[0]=t[0]-r[0],s[1]=t[1]-r[1],s[2]=t[2]-r[2],n[0]=s[0]*Math.cos(i)-s[1]*Math.sin(i),n[1]=s[0]*Math.sin(i)+s[1]*Math.cos(i),n[2]=s[2],e[0]=n[0]+r[0],e[1]=n[1]+r[1],e[2]=n[2]+r[2],e}function T7(e,t){let r=e[0],i=e[1],s=e[2],n=t[0],o=t[1],a=t[2],h=Math.sqrt((r*r+i*i+s*s)*(n*n+o*o+a*a)),p=h&&Lv(e,t)/h;return Math.acos(Math.min(Math.max(p,-1),1))}function jmt(e){return e[0]=0,e[1]=0,e[2]=0,e}function Wmt(e){return`vec3(${e[0]}, ${e[1]}, ${e[2]})`}function $mt(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}function Hmt(e,t){let r=e[0],i=e[1],s=e[2],n=t[0],o=t[1],a=t[2];return Math.abs(r-n)<=1e-6*Math.max(1,Math.abs(r),Math.abs(n))&&Math.abs(i-o)<=1e-6*Math.max(1,Math.abs(i),Math.abs(o))&&Math.abs(s-a)<=1e-6*Math.max(1,Math.abs(s),Math.abs(a))}var qmt=TW,Ymt=SW,Xmt=EW,Zmt=IW,Gmt=MW,S7=wW,Qmt=CW,Kmt=function(){let e=B5();return function(t,r,i,s,n,o){let a,h;for(r||(r=3),i||(i=0),s?h=Math.min(s*r+i,t.length):h=t.length,a=i;a<h;a+=r)e[0]=t[a],e[1]=t[a+1],e[2]=t[a+2],n(e,e,o),t[a]=e[0],t[a+1]=e[1],t[a+2]=e[2];return t}}();var E7=[0,0,0],L5,rr=class e extends Ly{static get ZERO(){return L5||(L5=new e(0,0,0),Object.freeze(L5)),L5}constructor(t=0,r=0,i=0){super(-0,-0,-0),arguments.length===1&&Yh(t)?this.copy(t):(Ro.debug&&(On(t),On(r),On(i)),this[0]=t,this[1]=r,this[2]=i)}set(t,r,i){return this[0]=t,this[1]=r,this[2]=i,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this.check()}fromObject(t){return Ro.debug&&(On(t.x),On(t.y),On(t.z)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this.check()}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t}get ELEMENTS(){return 3}get z(){return this[2]}set z(t){this[2]=On(t)}angle(t){return T7(this,t)}cross(t){return jg(this,this,t),this.check()}rotateX({radians:t,origin:r=E7}){return b7(this,this,r,t),this.check()}rotateY({radians:t,origin:r=E7}){return v7(this,this,r,t),this.check()}rotateZ({radians:t,origin:r=E7}){return w7(this,this,r,t),this.check()}transform(t){return this.transformAsPoint(t)}transformAsPoint(t){return Wg(this,this,t),this.check()}transformAsVector(t){return D5(this,this,t),this.check()}transformByMatrix3(t){return Fv(this,this,t),this.check()}transformByMatrix2(t){return bW(this,this,t),this.check()}transformByQuaternion(t){return zv(this,this,t),this.check()}};var F5,z5=class e extends Ly{static get ZERO(){return F5||(F5=new e(0,0,0,0),Object.freeze(F5)),F5}constructor(t=0,r=0,i=0,s=0){super(-0,-0,-0,-0),Yh(t)&&arguments.length===1?this.copy(t):(Ro.debug&&(On(t),On(r),On(i),On(s)),this[0]=t,this[1]=r,this[2]=i,this[3]=s)}set(t,r,i,s){return this[0]=t,this[1]=r,this[2]=i,this[3]=s,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this.check()}fromObject(t){return Ro.debug&&(On(t.x),On(t.y),On(t.z),On(t.w)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this[3]=t.w,this}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t.w=this[3],t}get ELEMENTS(){return 4}get z(){return this[2]}set z(t){this[2]=On(t)}get w(){return this[3]}set w(t){this[3]=On(t)}transform(t){return Wg(this,this,t),this.check()}transformByMatrix3(t){return O5(this,this,t),this.check()}transformByMatrix2(t){return vW(this,this,t),this.check()}transformByQuaternion(t){return zv(this,this,t),this.check()}applyMatrix4(t){return t.transform(this,this),this}};var zy=class extends Pm{toString(){let t="[";if(Ro.printRowMajor){t+="row-major:";for(let r=0;r<this.RANK;++r)for(let i=0;i<this.RANK;++i)t+=` ${this[i*this.RANK+r]}`}else{t+="column-major:";for(let r=0;r<this.ELEMENTS;++r)t+=` ${this[r]}`}return t+="]",t}getElementIndex(t,r){return r*this.RANK+t}getElement(t,r){return this[r*this.RANK+t]}setElement(t,r,i){return this[r*this.RANK+t]=On(i),this}getColumn(t,r=new Array(this.RANK).fill(-0)){let i=t*this.RANK;for(let s=0;s<this.RANK;++s)r[s]=this[i+s];return r}setColumn(t,r){let i=t*this.RANK;for(let s=0;s<this.RANK;++s)this[i+s]=r[s];return this}};function PW(){let e=new as(9);return as!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function RW(e,t){if(e===t){let r=t[1],i=t[2],s=t[5];e[1]=t[3],e[2]=t[6],e[3]=r,e[5]=t[7],e[6]=i,e[7]=s}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e}function kW(e,t){let r=t[0],i=t[1],s=t[2],n=t[3],o=t[4],a=t[5],h=t[6],p=t[7],g=t[8],v=g*o-a*p,T=-g*n+a*h,C=p*n-o*h,B=r*v+i*T+s*C;return B?(B=1/B,e[0]=v*B,e[1]=(-g*i+s*p)*B,e[2]=(a*i-s*o)*B,e[3]=T*B,e[4]=(g*r-s*h)*B,e[5]=(-a*r+s*n)*B,e[6]=C*B,e[7]=(-p*r+i*h)*B,e[8]=(o*r-i*n)*B,e):null}function DW(e){let t=e[0],r=e[1],i=e[2],s=e[3],n=e[4],o=e[5],a=e[6],h=e[7],p=e[8];return t*(p*n-o*h)+r*(-p*s+o*a)+i*(h*s-n*a)}function I7(e,t,r){let i=t[0],s=t[1],n=t[2],o=t[3],a=t[4],h=t[5],p=t[6],g=t[7],v=t[8],T=r[0],C=r[1],B=r[2],L=r[3],z=r[4],W=r[5],Z=r[6],X=r[7],q=r[8];return e[0]=T*i+C*o+B*p,e[1]=T*s+C*a+B*g,e[2]=T*n+C*h+B*v,e[3]=L*i+z*o+W*p,e[4]=L*s+z*a+W*g,e[5]=L*n+z*h+W*v,e[6]=Z*i+X*o+q*p,e[7]=Z*s+X*a+q*g,e[8]=Z*n+X*h+q*v,e}function OW(e,t,r){let i=t[0],s=t[1],n=t[2],o=t[3],a=t[4],h=t[5],p=t[6],g=t[7],v=t[8],T=r[0],C=r[1];return e[0]=i,e[1]=s,e[2]=n,e[3]=o,e[4]=a,e[5]=h,e[6]=T*i+C*o+p,e[7]=T*s+C*a+g,e[8]=T*n+C*h+v,e}function BW(e,t,r){let i=t[0],s=t[1],n=t[2],o=t[3],a=t[4],h=t[5],p=t[6],g=t[7],v=t[8],T=Math.sin(r),C=Math.cos(r);return e[0]=C*i+T*o,e[1]=C*s+T*a,e[2]=C*n+T*h,e[3]=C*o-T*i,e[4]=C*a-T*s,e[5]=C*h-T*n,e[6]=p,e[7]=g,e[8]=v,e}function M7(e,t,r){let i=r[0],s=r[1];return e[0]=i*t[0],e[1]=i*t[1],e[2]=i*t[2],e[3]=s*t[3],e[4]=s*t[4],e[5]=s*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function NW(e,t){let r=t[0],i=t[1],s=t[2],n=t[3],o=r+r,a=i+i,h=s+s,p=r*o,g=i*o,v=i*a,T=s*o,C=s*a,B=s*h,L=n*o,z=n*a,W=n*h;return e[0]=1-v-B,e[3]=g-W,e[6]=T+z,e[1]=g+W,e[4]=1-p-B,e[7]=C-L,e[2]=T-z,e[5]=C+L,e[8]=1-p-v,e}var C7;(function(e){e[e.COL0ROW0=0]="COL0ROW0",e[e.COL0ROW1=1]="COL0ROW1",e[e.COL0ROW2=2]="COL0ROW2",e[e.COL1ROW0=3]="COL1ROW0",e[e.COL1ROW1=4]="COL1ROW1",e[e.COL1ROW2=5]="COL1ROW2",e[e.COL2ROW0=6]="COL2ROW0",e[e.COL2ROW1=7]="COL2ROW1",e[e.COL2ROW2=8]="COL2ROW2"})(C7||(C7={}));var Jmt=Object.freeze([1,0,0,0,1,0,0,0,1]),Js=class extends zy{static get IDENTITY(){return eAt()}static get ZERO(){return tAt()}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return C7}constructor(t,...r){super(-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(t)?this.copy(t):r.length>0?this.copy([t,...r]):this.identity()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this.check()}identity(){return this.copy(Jmt)}fromObject(t){return this.check()}fromQuaternion(t){return NW(this,t),this.check()}set(t,r,i,s,n,o,a,h,p){return this[0]=t,this[1]=r,this[2]=i,this[3]=s,this[4]=n,this[5]=o,this[6]=a,this[7]=h,this[8]=p,this.check()}setRowMajor(t,r,i,s,n,o,a,h,p){return this[0]=t,this[1]=s,this[2]=a,this[3]=r,this[4]=n,this[5]=h,this[6]=i,this[7]=o,this[8]=p,this.check()}determinant(){return DW(this)}transpose(){return RW(this,this),this.check()}invert(){return kW(this,this),this.check()}multiplyLeft(t){return I7(this,t,this),this.check()}multiplyRight(t){return I7(this,this,t),this.check()}rotate(t){return BW(this,this,t),this.check()}scale(t){return Array.isArray(t)?M7(this,this,t):M7(this,this,[t,t]),this.check()}translate(t){return OW(this,this,t),this.check()}transform(t,r){let i;switch(t.length){case 2:i=_7(r||[-0,-0],t,this);break;case 3:i=Fv(r||[-0,-0,-0],t,this);break;case 4:i=O5(r||[-0,-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return Rm(i,t.length),i}transformVector(t,r){return this.transform(t,r)}transformVector2(t,r){return this.transform(t,r)}transformVector3(t,r){return this.transform(t,r)}},U5,V5=null;function tAt(){return U5||(U5=new Js([0,0,0,0,0,0,0,0,0]),Object.freeze(U5)),U5}function eAt(){return V5||(V5=new Js,Object.freeze(V5)),V5}var ko={};Ua(ko,{add:()=>EAt,adjoint:()=>aAt,clone:()=>iAt,copy:()=>nAt,create:()=>rAt,decompose:()=>gAt,determinant:()=>k7,equals:()=>PAt,exactEquals:()=>CAt,frob:()=>SAt,fromQuat:()=>z7,fromQuat2:()=>dAt,fromRotation:()=>uAt,fromRotationTranslation:()=>zW,fromRotationTranslationScale:()=>_At,fromRotationTranslationScaleOrigin:()=>yAt,fromScaling:()=>cAt,fromTranslation:()=>lAt,fromValues:()=>sAt,fromXRotation:()=>hAt,fromYRotation:()=>fAt,fromZRotation:()=>pAt,frustum:()=>U7,getRotation:()=>AAt,getScaling:()=>UW,getTranslation:()=>mAt,identity:()=>FW,invert:()=>R7,lookAt:()=>W7,mul:()=>RAt,multiply:()=>Uv,multiplyScalar:()=>IAt,multiplyScalarAndAdd:()=>MAt,ortho:()=>j7,orthoNO:()=>jW,orthoZO:()=>vAt,perspective:()=>V7,perspectiveFromFieldOfView:()=>bAt,perspectiveNO:()=>VW,perspectiveZO:()=>xAt,rotate:()=>B7,rotateX:()=>N7,rotateY:()=>L7,rotateZ:()=>F7,scale:()=>O7,set:()=>oAt,str:()=>TAt,sub:()=>kAt,subtract:()=>WW,targetTo:()=>wAt,translate:()=>D7,transpose:()=>P7});function rAt(){let e=new as(16);return as!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function iAt(e){let t=new as(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function nAt(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function sAt(e,t,r,i,s,n,o,a,h,p,g,v,T,C,B,L){let z=new as(16);return z[0]=e,z[1]=t,z[2]=r,z[3]=i,z[4]=s,z[5]=n,z[6]=o,z[7]=a,z[8]=h,z[9]=p,z[10]=g,z[11]=v,z[12]=T,z[13]=C,z[14]=B,z[15]=L,z}function oAt(e,t,r,i,s,n,o,a,h,p,g,v,T,C,B,L,z){return e[0]=t,e[1]=r,e[2]=i,e[3]=s,e[4]=n,e[5]=o,e[6]=a,e[7]=h,e[8]=p,e[9]=g,e[10]=v,e[11]=T,e[12]=C,e[13]=B,e[14]=L,e[15]=z,e}function FW(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function P7(e,t){if(e===t){let r=t[1],i=t[2],s=t[3],n=t[6],o=t[7],a=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=r,e[6]=t[9],e[7]=t[13],e[8]=i,e[9]=n,e[11]=t[14],e[12]=s,e[13]=o,e[14]=a}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function R7(e,t){let r=t[0],i=t[1],s=t[2],n=t[3],o=t[4],a=t[5],h=t[6],p=t[7],g=t[8],v=t[9],T=t[10],C=t[11],B=t[12],L=t[13],z=t[14],W=t[15],Z=r*a-i*o,X=r*h-s*o,q=r*p-n*o,it=i*h-s*a,nt=i*p-n*a,Mt=s*p-n*h,_t=g*L-v*B,Et=g*z-T*B,vt=g*W-C*B,Pt=v*z-T*L,re=v*W-C*L,$t=T*W-C*z,xt=Z*$t-X*re+q*Pt+it*vt-nt*Et+Mt*_t;return xt?(xt=1/xt,e[0]=(a*$t-h*re+p*Pt)*xt,e[1]=(s*re-i*$t-n*Pt)*xt,e[2]=(L*Mt-z*nt+W*it)*xt,e[3]=(T*nt-v*Mt-C*it)*xt,e[4]=(h*vt-o*$t-p*Et)*xt,e[5]=(r*$t-s*vt+n*Et)*xt,e[6]=(z*q-B*Mt-W*X)*xt,e[7]=(g*Mt-T*q+C*X)*xt,e[8]=(o*re-a*vt+p*_t)*xt,e[9]=(i*vt-r*re-n*_t)*xt,e[10]=(B*nt-L*q+W*Z)*xt,e[11]=(v*q-g*nt-C*Z)*xt,e[12]=(a*Et-o*Pt-h*_t)*xt,e[13]=(r*Pt-i*Et+s*_t)*xt,e[14]=(L*X-B*it-z*Z)*xt,e[15]=(g*it-v*X+T*Z)*xt,e):null}function aAt(e,t){let r=t[0],i=t[1],s=t[2],n=t[3],o=t[4],a=t[5],h=t[6],p=t[7],g=t[8],v=t[9],T=t[10],C=t[11],B=t[12],L=t[13],z=t[14],W=t[15],Z=r*a-i*o,X=r*h-s*o,q=r*p-n*o,it=i*h-s*a,nt=i*p-n*a,Mt=s*p-n*h,_t=g*L-v*B,Et=g*z-T*B,vt=g*W-C*B,Pt=v*z-T*L,re=v*W-C*L,$t=T*W-C*z;return e[0]=a*$t-h*re+p*Pt,e[1]=s*re-i*$t-n*Pt,e[2]=L*Mt-z*nt+W*it,e[3]=T*nt-v*Mt-C*it,e[4]=h*vt-o*$t-p*Et,e[5]=r*$t-s*vt+n*Et,e[6]=z*q-B*Mt-W*X,e[7]=g*Mt-T*q+C*X,e[8]=o*re-a*vt+p*_t,e[9]=i*vt-r*re-n*_t,e[10]=B*nt-L*q+W*Z,e[11]=v*q-g*nt-C*Z,e[12]=a*Et-o*Pt-h*_t,e[13]=r*Pt-i*Et+s*_t,e[14]=L*X-B*it-z*Z,e[15]=g*it-v*X+T*Z,e}function k7(e){let t=e[0],r=e[1],i=e[2],s=e[3],n=e[4],o=e[5],a=e[6],h=e[7],p=e[8],g=e[9],v=e[10],T=e[11],C=e[12],B=e[13],L=e[14],z=e[15],W=t*o-r*n,Z=t*a-i*n,X=r*a-i*o,q=p*B-g*C,it=p*L-v*C,nt=g*L-v*B,Mt=t*nt-r*it+i*q,_t=n*nt-o*it+a*q,Et=p*X-g*Z+v*W,vt=C*X-B*Z+L*W;return h*Mt-s*_t+z*Et-T*vt}function Uv(e,t,r){let i=t[0],s=t[1],n=t[2],o=t[3],a=t[4],h=t[5],p=t[6],g=t[7],v=t[8],T=t[9],C=t[10],B=t[11],L=t[12],z=t[13],W=t[14],Z=t[15],X=r[0],q=r[1],it=r[2],nt=r[3];return e[0]=X*i+q*a+it*v+nt*L,e[1]=X*s+q*h+it*T+nt*z,e[2]=X*n+q*p+it*C+nt*W,e[3]=X*o+q*g+it*B+nt*Z,X=r[4],q=r[5],it=r[6],nt=r[7],e[4]=X*i+q*a+it*v+nt*L,e[5]=X*s+q*h+it*T+nt*z,e[6]=X*n+q*p+it*C+nt*W,e[7]=X*o+q*g+it*B+nt*Z,X=r[8],q=r[9],it=r[10],nt=r[11],e[8]=X*i+q*a+it*v+nt*L,e[9]=X*s+q*h+it*T+nt*z,e[10]=X*n+q*p+it*C+nt*W,e[11]=X*o+q*g+it*B+nt*Z,X=r[12],q=r[13],it=r[14],nt=r[15],e[12]=X*i+q*a+it*v+nt*L,e[13]=X*s+q*h+it*T+nt*z,e[14]=X*n+q*p+it*C+nt*W,e[15]=X*o+q*g+it*B+nt*Z,e}function D7(e,t,r){let i=r[0],s=r[1],n=r[2],o,a,h,p,g,v,T,C,B,L,z,W;return t===e?(e[12]=t[0]*i+t[4]*s+t[8]*n+t[12],e[13]=t[1]*i+t[5]*s+t[9]*n+t[13],e[14]=t[2]*i+t[6]*s+t[10]*n+t[14],e[15]=t[3]*i+t[7]*s+t[11]*n+t[15]):(o=t[0],a=t[1],h=t[2],p=t[3],g=t[4],v=t[5],T=t[6],C=t[7],B=t[8],L=t[9],z=t[10],W=t[11],e[0]=o,e[1]=a,e[2]=h,e[3]=p,e[4]=g,e[5]=v,e[6]=T,e[7]=C,e[8]=B,e[9]=L,e[10]=z,e[11]=W,e[12]=o*i+g*s+B*n+t[12],e[13]=a*i+v*s+L*n+t[13],e[14]=h*i+T*s+z*n+t[14],e[15]=p*i+C*s+W*n+t[15]),e}function O7(e,t,r){let i=r[0],s=r[1],n=r[2];return e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i,e[3]=t[3]*i,e[4]=t[4]*s,e[5]=t[5]*s,e[6]=t[6]*s,e[7]=t[7]*s,e[8]=t[8]*n,e[9]=t[9]*n,e[10]=t[10]*n,e[11]=t[11]*n,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function B7(e,t,r,i){let s=i[0],n=i[1],o=i[2],a=Math.sqrt(s*s+n*n+o*o),h,p,g,v,T,C,B,L,z,W,Z,X,q,it,nt,Mt,_t,Et,vt,Pt,re,$t,xt,Vt;return a<1e-6?null:(a=1/a,s*=a,n*=a,o*=a,p=Math.sin(r),h=Math.cos(r),g=1-h,v=t[0],T=t[1],C=t[2],B=t[3],L=t[4],z=t[5],W=t[6],Z=t[7],X=t[8],q=t[9],it=t[10],nt=t[11],Mt=s*s*g+h,_t=n*s*g+o*p,Et=o*s*g-n*p,vt=s*n*g-o*p,Pt=n*n*g+h,re=o*n*g+s*p,$t=s*o*g+n*p,xt=n*o*g-s*p,Vt=o*o*g+h,e[0]=v*Mt+L*_t+X*Et,e[1]=T*Mt+z*_t+q*Et,e[2]=C*Mt+W*_t+it*Et,e[3]=B*Mt+Z*_t+nt*Et,e[4]=v*vt+L*Pt+X*re,e[5]=T*vt+z*Pt+q*re,e[6]=C*vt+W*Pt+it*re,e[7]=B*vt+Z*Pt+nt*re,e[8]=v*$t+L*xt+X*Vt,e[9]=T*$t+z*xt+q*Vt,e[10]=C*$t+W*xt+it*Vt,e[11]=B*$t+Z*xt+nt*Vt,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function N7(e,t,r){let i=Math.sin(r),s=Math.cos(r),n=t[4],o=t[5],a=t[6],h=t[7],p=t[8],g=t[9],v=t[10],T=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=n*s+p*i,e[5]=o*s+g*i,e[6]=a*s+v*i,e[7]=h*s+T*i,e[8]=p*s-n*i,e[9]=g*s-o*i,e[10]=v*s-a*i,e[11]=T*s-h*i,e}function L7(e,t,r){let i=Math.sin(r),s=Math.cos(r),n=t[0],o=t[1],a=t[2],h=t[3],p=t[8],g=t[9],v=t[10],T=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=n*s-p*i,e[1]=o*s-g*i,e[2]=a*s-v*i,e[3]=h*s-T*i,e[8]=n*i+p*s,e[9]=o*i+g*s,e[10]=a*i+v*s,e[11]=h*i+T*s,e}function F7(e,t,r){let i=Math.sin(r),s=Math.cos(r),n=t[0],o=t[1],a=t[2],h=t[3],p=t[4],g=t[5],v=t[6],T=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=n*s+p*i,e[1]=o*s+g*i,e[2]=a*s+v*i,e[3]=h*s+T*i,e[4]=p*s-n*i,e[5]=g*s-o*i,e[6]=v*s-a*i,e[7]=T*s-h*i,e}function lAt(e,t){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e}function cAt(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function uAt(e,t,r){let i=r[0],s=r[1],n=r[2],o=Math.sqrt(i*i+s*s+n*n),a,h,p;return o<1e-6?null:(o=1/o,i*=o,s*=o,n*=o,h=Math.sin(t),a=Math.cos(t),p=1-a,e[0]=i*i*p+a,e[1]=s*i*p+n*h,e[2]=n*i*p-s*h,e[3]=0,e[4]=i*s*p-n*h,e[5]=s*s*p+a,e[6]=n*s*p+i*h,e[7]=0,e[8]=i*n*p+s*h,e[9]=s*n*p-i*h,e[10]=n*n*p+a,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}function hAt(e,t){let r=Math.sin(t),i=Math.cos(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=i,e[6]=r,e[7]=0,e[8]=0,e[9]=-r,e[10]=i,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function fAt(e,t){let r=Math.sin(t),i=Math.cos(t);return e[0]=i,e[1]=0,e[2]=-r,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=r,e[9]=0,e[10]=i,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function pAt(e,t){let r=Math.sin(t),i=Math.cos(t);return e[0]=i,e[1]=r,e[2]=0,e[3]=0,e[4]=-r,e[5]=i,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function zW(e,t,r){let i=t[0],s=t[1],n=t[2],o=t[3],a=i+i,h=s+s,p=n+n,g=i*a,v=i*h,T=i*p,C=s*h,B=s*p,L=n*p,z=o*a,W=o*h,Z=o*p;return e[0]=1-(C+L),e[1]=v+Z,e[2]=T-W,e[3]=0,e[4]=v-Z,e[5]=1-(g+L),e[6]=B+z,e[7]=0,e[8]=T+W,e[9]=B-z,e[10]=1-(g+C),e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function dAt(e,t){let r=new as(3),i=-t[0],s=-t[1],n=-t[2],o=t[3],a=t[4],h=t[5],p=t[6],g=t[7],v=i*i+s*s+n*n+o*o;return v>0?(r[0]=(a*o+g*i+h*n-p*s)*2/v,r[1]=(h*o+g*s+p*i-a*n)*2/v,r[2]=(p*o+g*n+a*s-h*i)*2/v):(r[0]=(a*o+g*i+h*n-p*s)*2,r[1]=(h*o+g*s+p*i-a*n)*2,r[2]=(p*o+g*n+a*s-h*i)*2),zW(e,t,r),e}function mAt(e,t){return e[0]=t[12],e[1]=t[13],e[2]=t[14],e}function UW(e,t){let r=t[0],i=t[1],s=t[2],n=t[4],o=t[5],a=t[6],h=t[8],p=t[9],g=t[10];return e[0]=Math.sqrt(r*r+i*i+s*s),e[1]=Math.sqrt(n*n+o*o+a*a),e[2]=Math.sqrt(h*h+p*p+g*g),e}function AAt(e,t){let r=new as(3);UW(r,t);let i=1/r[0],s=1/r[1],n=1/r[2],o=t[0]*i,a=t[1]*s,h=t[2]*n,p=t[4]*i,g=t[5]*s,v=t[6]*n,T=t[8]*i,C=t[9]*s,B=t[10]*n,L=o+g+B,z=0;return L>0?(z=Math.sqrt(L+1)*2,e[3]=.25*z,e[0]=(v-C)/z,e[1]=(T-h)/z,e[2]=(a-p)/z):o>g&&o>B?(z=Math.sqrt(1+o-g-B)*2,e[3]=(v-C)/z,e[0]=.25*z,e[1]=(a+p)/z,e[2]=(T+h)/z):g>B?(z=Math.sqrt(1+g-o-B)*2,e[3]=(T-h)/z,e[0]=(a+p)/z,e[1]=.25*z,e[2]=(v+C)/z):(z=Math.sqrt(1+B-o-g)*2,e[3]=(a-p)/z,e[0]=(T+h)/z,e[1]=(v+C)/z,e[2]=.25*z),e}function gAt(e,t,r,i){t[0]=i[12],t[1]=i[13],t[2]=i[14];let s=i[0],n=i[1],o=i[2],a=i[4],h=i[5],p=i[6],g=i[8],v=i[9],T=i[10];r[0]=Math.sqrt(s*s+n*n+o*o),r[1]=Math.sqrt(a*a+h*h+p*p),r[2]=Math.sqrt(g*g+v*v+T*T);let C=1/r[0],B=1/r[1],L=1/r[2],z=s*C,W=n*B,Z=o*L,X=a*C,q=h*B,it=p*L,nt=g*C,Mt=v*B,_t=T*L,Et=z+q+_t,vt=0;return Et>0?(vt=Math.sqrt(Et+1)*2,e[3]=.25*vt,e[0]=(it-Mt)/vt,e[1]=(nt-Z)/vt,e[2]=(W-X)/vt):z>q&&z>_t?(vt=Math.sqrt(1+z-q-_t)*2,e[3]=(it-Mt)/vt,e[0]=.25*vt,e[1]=(W+X)/vt,e[2]=(nt+Z)/vt):q>_t?(vt=Math.sqrt(1+q-z-_t)*2,e[3]=(nt-Z)/vt,e[0]=(W+X)/vt,e[1]=.25*vt,e[2]=(it+Mt)/vt):(vt=Math.sqrt(1+_t-z-q)*2,e[3]=(W-X)/vt,e[0]=(nt+Z)/vt,e[1]=(it+Mt)/vt,e[2]=.25*vt),e}function _At(e,t,r,i){let s=t[0],n=t[1],o=t[2],a=t[3],h=s+s,p=n+n,g=o+o,v=s*h,T=s*p,C=s*g,B=n*p,L=n*g,z=o*g,W=a*h,Z=a*p,X=a*g,q=i[0],it=i[1],nt=i[2];return e[0]=(1-(B+z))*q,e[1]=(T+X)*q,e[2]=(C-Z)*q,e[3]=0,e[4]=(T-X)*it,e[5]=(1-(v+z))*it,e[6]=(L+W)*it,e[7]=0,e[8]=(C+Z)*nt,e[9]=(L-W)*nt,e[10]=(1-(v+B))*nt,e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e}function yAt(e,t,r,i,s){let n=t[0],o=t[1],a=t[2],h=t[3],p=n+n,g=o+o,v=a+a,T=n*p,C=n*g,B=n*v,L=o*g,z=o*v,W=a*v,Z=h*p,X=h*g,q=h*v,it=i[0],nt=i[1],Mt=i[2],_t=s[0],Et=s[1],vt=s[2],Pt=(1-(L+W))*it,re=(C+q)*it,$t=(B-X)*it,xt=(C-q)*nt,Vt=(1-(T+W))*nt,qt=(z+Z)*nt,de=(B+X)*Mt,Ee=(z-Z)*Mt,Se=(1-(T+L))*Mt;return e[0]=Pt,e[1]=re,e[2]=$t,e[3]=0,e[4]=xt,e[5]=Vt,e[6]=qt,e[7]=0,e[8]=de,e[9]=Ee,e[10]=Se,e[11]=0,e[12]=r[0]+_t-(Pt*_t+xt*Et+de*vt),e[13]=r[1]+Et-(re*_t+Vt*Et+Ee*vt),e[14]=r[2]+vt-($t*_t+qt*Et+Se*vt),e[15]=1,e}function z7(e,t){let r=t[0],i=t[1],s=t[2],n=t[3],o=r+r,a=i+i,h=s+s,p=r*o,g=i*o,v=i*a,T=s*o,C=s*a,B=s*h,L=n*o,z=n*a,W=n*h;return e[0]=1-v-B,e[1]=g+W,e[2]=T-z,e[3]=0,e[4]=g-W,e[5]=1-p-B,e[6]=C+L,e[7]=0,e[8]=T+z,e[9]=C-L,e[10]=1-p-v,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function U7(e,t,r,i,s,n,o){let a=1/(r-t),h=1/(s-i),p=1/(n-o);return e[0]=n*2*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n*2*h,e[6]=0,e[7]=0,e[8]=(r+t)*a,e[9]=(s+i)*h,e[10]=(o+n)*p,e[11]=-1,e[12]=0,e[13]=0,e[14]=o*n*2*p,e[15]=0,e}function VW(e,t,r,i,s){let n=1/Math.tan(t/2);if(e[0]=n/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,s!=null&&s!==1/0){let o=1/(i-s);e[10]=(s+i)*o,e[14]=2*s*i*o}else e[10]=-1,e[14]=-2*i;return e}var V7=VW;function xAt(e,t,r,i,s){let n=1/Math.tan(t/2);if(e[0]=n/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,s!=null&&s!==1/0){let o=1/(i-s);e[10]=s*o,e[14]=s*i*o}else e[10]=-1,e[14]=-i;return e}function bAt(e,t,r,i){let s=Math.tan(t.upDegrees*Math.PI/180),n=Math.tan(t.downDegrees*Math.PI/180),o=Math.tan(t.leftDegrees*Math.PI/180),a=Math.tan(t.rightDegrees*Math.PI/180),h=2/(o+a),p=2/(s+n);return e[0]=h,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=p,e[6]=0,e[7]=0,e[8]=-((o-a)*h*.5),e[9]=(s-n)*p*.5,e[10]=i/(r-i),e[11]=-1,e[12]=0,e[13]=0,e[14]=i*r/(r-i),e[15]=0,e}function jW(e,t,r,i,s,n,o){let a=1/(t-r),h=1/(i-s),p=1/(n-o);return e[0]=-2*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*h,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*p,e[11]=0,e[12]=(t+r)*a,e[13]=(s+i)*h,e[14]=(o+n)*p,e[15]=1,e}var j7=jW;function vAt(e,t,r,i,s,n,o){let a=1/(t-r),h=1/(i-s),p=1/(n-o);return e[0]=-2*a,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*h,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=p,e[11]=0,e[12]=(t+r)*a,e[13]=(s+i)*h,e[14]=n*p,e[15]=1,e}function W7(e,t,r,i){let s,n,o,a,h,p,g,v,T,C,B=t[0],L=t[1],z=t[2],W=i[0],Z=i[1],X=i[2],q=r[0],it=r[1],nt=r[2];return Math.abs(B-q)<1e-6&&Math.abs(L-it)<1e-6&&Math.abs(z-nt)<1e-6?FW(e):(v=B-q,T=L-it,C=z-nt,s=1/Math.sqrt(v*v+T*T+C*C),v*=s,T*=s,C*=s,n=Z*C-X*T,o=X*v-W*C,a=W*T-Z*v,s=Math.sqrt(n*n+o*o+a*a),s?(s=1/s,n*=s,o*=s,a*=s):(n=0,o=0,a=0),h=T*a-C*o,p=C*n-v*a,g=v*o-T*n,s=Math.sqrt(h*h+p*p+g*g),s?(s=1/s,h*=s,p*=s,g*=s):(h=0,p=0,g=0),e[0]=n,e[1]=h,e[2]=v,e[3]=0,e[4]=o,e[5]=p,e[6]=T,e[7]=0,e[8]=a,e[9]=g,e[10]=C,e[11]=0,e[12]=-(n*B+o*L+a*z),e[13]=-(h*B+p*L+g*z),e[14]=-(v*B+T*L+C*z),e[15]=1,e)}function wAt(e,t,r,i){let s=t[0],n=t[1],o=t[2],a=i[0],h=i[1],p=i[2],g=s-r[0],v=n-r[1],T=o-r[2],C=g*g+v*v+T*T;C>0&&(C=1/Math.sqrt(C),g*=C,v*=C,T*=C);let B=h*T-p*v,L=p*g-a*T,z=a*v-h*g;return C=B*B+L*L+z*z,C>0&&(C=1/Math.sqrt(C),B*=C,L*=C,z*=C),e[0]=B,e[1]=L,e[2]=z,e[3]=0,e[4]=v*z-T*L,e[5]=T*B-g*z,e[6]=g*L-v*B,e[7]=0,e[8]=g,e[9]=v,e[10]=T,e[11]=0,e[12]=s,e[13]=n,e[14]=o,e[15]=1,e}function TAt(e){return`mat4(${e[0]}, ${e[1]}, ${e[2]}, ${e[3]}, ${e[4]}, ${e[5]}, ${e[6]}, ${e[7]}, ${e[8]}, ${e[9]}, ${e[10]}, ${e[11]}, ${e[12]}, ${e[13]}, ${e[14]}, ${e[15]})`}function SAt(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]+e[3]*e[3]+e[4]*e[4]+e[5]*e[5]+e[6]*e[6]+e[7]*e[7]+e[8]*e[8]+e[9]*e[9]+e[10]*e[10]+e[11]*e[11]+e[12]*e[12]+e[13]*e[13]+e[14]*e[14]+e[15]*e[15])}function EAt(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e[4]=t[4]+r[4],e[5]=t[5]+r[5],e[6]=t[6]+r[6],e[7]=t[7]+r[7],e[8]=t[8]+r[8],e[9]=t[9]+r[9],e[10]=t[10]+r[10],e[11]=t[11]+r[11],e[12]=t[12]+r[12],e[13]=t[13]+r[13],e[14]=t[14]+r[14],e[15]=t[15]+r[15],e}function WW(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e[4]=t[4]-r[4],e[5]=t[5]-r[5],e[6]=t[6]-r[6],e[7]=t[7]-r[7],e[8]=t[8]-r[8],e[9]=t[9]-r[9],e[10]=t[10]-r[10],e[11]=t[11]-r[11],e[12]=t[12]-r[12],e[13]=t[13]-r[13],e[14]=t[14]-r[14],e[15]=t[15]-r[15],e}function IAt(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e[4]=t[4]*r,e[5]=t[5]*r,e[6]=t[6]*r,e[7]=t[7]*r,e[8]=t[8]*r,e[9]=t[9]*r,e[10]=t[10]*r,e[11]=t[11]*r,e[12]=t[12]*r,e[13]=t[13]*r,e[14]=t[14]*r,e[15]=t[15]*r,e}function MAt(e,t,r,i){return e[0]=t[0]+r[0]*i,e[1]=t[1]+r[1]*i,e[2]=t[2]+r[2]*i,e[3]=t[3]+r[3]*i,e[4]=t[4]+r[4]*i,e[5]=t[5]+r[5]*i,e[6]=t[6]+r[6]*i,e[7]=t[7]+r[7]*i,e[8]=t[8]+r[8]*i,e[9]=t[9]+r[9]*i,e[10]=t[10]+r[10]*i,e[11]=t[11]+r[11]*i,e[12]=t[12]+r[12]*i,e[13]=t[13]+r[13]*i,e[14]=t[14]+r[14]*i,e[15]=t[15]+r[15]*i,e}function CAt(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]&&e[4]===t[4]&&e[5]===t[5]&&e[6]===t[6]&&e[7]===t[7]&&e[8]===t[8]&&e[9]===t[9]&&e[10]===t[10]&&e[11]===t[11]&&e[12]===t[12]&&e[13]===t[13]&&e[14]===t[14]&&e[15]===t[15]}function PAt(e,t){let r=e[0],i=e[1],s=e[2],n=e[3],o=e[4],a=e[5],h=e[6],p=e[7],g=e[8],v=e[9],T=e[10],C=e[11],B=e[12],L=e[13],z=e[14],W=e[15],Z=t[0],X=t[1],q=t[2],it=t[3],nt=t[4],Mt=t[5],_t=t[6],Et=t[7],vt=t[8],Pt=t[9],re=t[10],$t=t[11],xt=t[12],Vt=t[13],qt=t[14],de=t[15];return Math.abs(r-Z)<=1e-6*Math.max(1,Math.abs(r),Math.abs(Z))&&Math.abs(i-X)<=1e-6*Math.max(1,Math.abs(i),Math.abs(X))&&Math.abs(s-q)<=1e-6*Math.max(1,Math.abs(s),Math.abs(q))&&Math.abs(n-it)<=1e-6*Math.max(1,Math.abs(n),Math.abs(it))&&Math.abs(o-nt)<=1e-6*Math.max(1,Math.abs(o),Math.abs(nt))&&Math.abs(a-Mt)<=1e-6*Math.max(1,Math.abs(a),Math.abs(Mt))&&Math.abs(h-_t)<=1e-6*Math.max(1,Math.abs(h),Math.abs(_t))&&Math.abs(p-Et)<=1e-6*Math.max(1,Math.abs(p),Math.abs(Et))&&Math.abs(g-vt)<=1e-6*Math.max(1,Math.abs(g),Math.abs(vt))&&Math.abs(v-Pt)<=1e-6*Math.max(1,Math.abs(v),Math.abs(Pt))&&Math.abs(T-re)<=1e-6*Math.max(1,Math.abs(T),Math.abs(re))&&Math.abs(C-$t)<=1e-6*Math.max(1,Math.abs(C),Math.abs($t))&&Math.abs(B-xt)<=1e-6*Math.max(1,Math.abs(B),Math.abs(xt))&&Math.abs(L-Vt)<=1e-6*Math.max(1,Math.abs(L),Math.abs(Vt))&&Math.abs(z-qt)<=1e-6*Math.max(1,Math.abs(z),Math.abs(qt))&&Math.abs(W-de)<=1e-6*Math.max(1,Math.abs(W),Math.abs(de))}var RAt=Uv,kAt=WW;var bc={};Ua(bc,{add:()=>$7,ceil:()=>DAt,clone:()=>HW,copy:()=>YW,create:()=>$W,cross:()=>VAt,dist:()=>ZAt,distance:()=>KW,div:()=>XAt,divide:()=>QW,dot:()=>Y7,equals:()=>HAt,exactEquals:()=>t$,floor:()=>OAt,forEach:()=>JAt,fromValues:()=>qW,inverse:()=>UAt,len:()=>QAt,length:()=>j5,lerp:()=>X7,max:()=>NAt,min:()=>BAt,mul:()=>YAt,multiply:()=>GW,negate:()=>zAt,normalize:()=>q7,random:()=>jAt,round:()=>LAt,scale:()=>H7,scaleAndAdd:()=>FAt,set:()=>XW,sqrDist:()=>GAt,sqrLen:()=>KAt,squaredDistance:()=>JW,squaredLength:()=>W5,str:()=>$At,sub:()=>qAt,subtract:()=>ZW,transformMat4:()=>Z7,transformQuat:()=>G7,zero:()=>WAt});function $W(){let e=new as(4);return as!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function HW(e){let t=new as(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function qW(e,t,r,i){let s=new as(4);return s[0]=e,s[1]=t,s[2]=r,s[3]=i,s}function YW(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function XW(e,t,r,i,s){return e[0]=t,e[1]=r,e[2]=i,e[3]=s,e}function $7(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e}function ZW(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e}function GW(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e[3]=t[3]*r[3],e}function QW(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e[3]=t[3]/r[3],e}function DAt(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e[3]=Math.ceil(t[3]),e}function OAt(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e[3]=Math.floor(t[3]),e}function BAt(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e[3]=Math.min(t[3],r[3]),e}function NAt(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e[3]=Math.max(t[3],r[3]),e}function LAt(e,t){return e[0]=Zu(t[0]),e[1]=Zu(t[1]),e[2]=Zu(t[2]),e[3]=Zu(t[3]),e}function H7(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e}function FAt(e,t,r,i){return e[0]=t[0]+r[0]*i,e[1]=t[1]+r[1]*i,e[2]=t[2]+r[2]*i,e[3]=t[3]+r[3]*i,e}function KW(e,t){let r=t[0]-e[0],i=t[1]-e[1],s=t[2]-e[2],n=t[3]-e[3];return Math.sqrt(r*r+i*i+s*s+n*n)}function JW(e,t){let r=t[0]-e[0],i=t[1]-e[1],s=t[2]-e[2],n=t[3]-e[3];return r*r+i*i+s*s+n*n}function j5(e){let t=e[0],r=e[1],i=e[2],s=e[3];return Math.sqrt(t*t+r*r+i*i+s*s)}function W5(e){let t=e[0],r=e[1],i=e[2],s=e[3];return t*t+r*r+i*i+s*s}function zAt(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e}function UAt(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e}function q7(e,t){let r=t[0],i=t[1],s=t[2],n=t[3],o=r*r+i*i+s*s+n*n;return o>0&&(o=1/Math.sqrt(o)),e[0]=r*o,e[1]=i*o,e[2]=s*o,e[3]=n*o,e}function Y7(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function VAt(e,t,r,i){let s=r[0]*i[1]-r[1]*i[0],n=r[0]*i[2]-r[2]*i[0],o=r[0]*i[3]-r[3]*i[0],a=r[1]*i[2]-r[2]*i[1],h=r[1]*i[3]-r[3]*i[1],p=r[2]*i[3]-r[3]*i[2],g=t[0],v=t[1],T=t[2],C=t[3];return e[0]=v*p-T*h+C*a,e[1]=-(g*p)+T*o-C*n,e[2]=g*h-v*o+C*s,e[3]=-(g*a)+v*n-T*s,e}function X7(e,t,r,i){let s=t[0],n=t[1],o=t[2],a=t[3];return e[0]=s+i*(r[0]-s),e[1]=n+i*(r[1]-n),e[2]=o+i*(r[2]-o),e[3]=a+i*(r[3]-a),e}function jAt(e,t){t=t===void 0?1:t;let r,i,s,n,o,a;do r=rp()*2-1,i=rp()*2-1,o=r*r+i*i;while(o>=1);do s=rp()*2-1,n=rp()*2-1,a=s*s+n*n;while(a>=1);let h=Math.sqrt((1-o)/a);return e[0]=t*r,e[1]=t*i,e[2]=t*s*h,e[3]=t*n*h,e}function Z7(e,t,r){let i=t[0],s=t[1],n=t[2],o=t[3];return e[0]=r[0]*i+r[4]*s+r[8]*n+r[12]*o,e[1]=r[1]*i+r[5]*s+r[9]*n+r[13]*o,e[2]=r[2]*i+r[6]*s+r[10]*n+r[14]*o,e[3]=r[3]*i+r[7]*s+r[11]*n+r[15]*o,e}function G7(e,t,r){let i=t[0],s=t[1],n=t[2],o=r[0],a=r[1],h=r[2],p=r[3],g=p*i+a*n-h*s,v=p*s+h*i-o*n,T=p*n+o*s-a*i,C=-o*i-a*s-h*n;return e[0]=g*p+C*-o+v*-h-T*-a,e[1]=v*p+C*-a+T*-o-g*-h,e[2]=T*p+C*-h+g*-a-v*-o,e[3]=t[3],e}function WAt(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e}function $At(e){return`vec4(${e[0]}, ${e[1]}, ${e[2]}, ${e[3]})`}function t$(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function HAt(e,t){let r=e[0],i=e[1],s=e[2],n=e[3],o=t[0],a=t[1],h=t[2],p=t[3];return Math.abs(r-o)<=1e-6*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(i-a)<=1e-6*Math.max(1,Math.abs(i),Math.abs(a))&&Math.abs(s-h)<=1e-6*Math.max(1,Math.abs(s),Math.abs(h))&&Math.abs(n-p)<=1e-6*Math.max(1,Math.abs(n),Math.abs(p))}var qAt=ZW,YAt=GW,XAt=QW,ZAt=KW,GAt=JW,QAt=j5,KAt=W5,JAt=function(){let e=$W();return function(t,r,i,s,n,o){let a,h;for(r||(r=4),i||(i=0),s?h=Math.min(s*r+i,t.length):h=t.length,a=i;a<h;a+=r)e[0]=t[a],e[1]=t[a+1],e[2]=t[a+2],e[3]=t[a+3],n(e,e,o),t[a]=e[0],t[a+1]=e[1],t[a+2]=e[2],t[a+3]=e[3];return t}}();var J7;(function(e){e[e.COL0ROW0=0]="COL0ROW0",e[e.COL0ROW1=1]="COL0ROW1",e[e.COL0ROW2=2]="COL0ROW2",e[e.COL0ROW3=3]="COL0ROW3",e[e.COL1ROW0=4]="COL1ROW0",e[e.COL1ROW1=5]="COL1ROW1",e[e.COL1ROW2=6]="COL1ROW2",e[e.COL1ROW3=7]="COL1ROW3",e[e.COL2ROW0=8]="COL2ROW0",e[e.COL2ROW1=9]="COL2ROW1",e[e.COL2ROW2=10]="COL2ROW2",e[e.COL2ROW3=11]="COL2ROW3",e[e.COL3ROW0=12]="COL3ROW0",e[e.COL3ROW1=13]="COL3ROW1",e[e.COL3ROW2=14]="COL3ROW2",e[e.COL3ROW3=15]="COL3ROW3"})(J7||(J7={}));var tgt=45*Math.PI/180,egt=1,Q7=.1,K7=500,rgt=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),Os=class extends zy{static get IDENTITY(){return ngt()}static get ZERO(){return igt()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return J7}constructor(t){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(t)?this.copy(t):this.identity()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this[9]=t[9],this[10]=t[10],this[11]=t[11],this[12]=t[12],this[13]=t[13],this[14]=t[14],this[15]=t[15],this.check()}set(t,r,i,s,n,o,a,h,p,g,v,T,C,B,L,z){return this[0]=t,this[1]=r,this[2]=i,this[3]=s,this[4]=n,this[5]=o,this[6]=a,this[7]=h,this[8]=p,this[9]=g,this[10]=v,this[11]=T,this[12]=C,this[13]=B,this[14]=L,this[15]=z,this.check()}setRowMajor(t,r,i,s,n,o,a,h,p,g,v,T,C,B,L,z){return this[0]=t,this[1]=n,this[2]=p,this[3]=C,this[4]=r,this[5]=o,this[6]=g,this[7]=B,this[8]=i,this[9]=a,this[10]=v,this[11]=L,this[12]=s,this[13]=h,this[14]=T,this[15]=z,this.check()}toRowMajor(t){return t[0]=this[0],t[1]=this[4],t[2]=this[8],t[3]=this[12],t[4]=this[1],t[5]=this[5],t[6]=this[9],t[7]=this[13],t[8]=this[2],t[9]=this[6],t[10]=this[10],t[11]=this[14],t[12]=this[3],t[13]=this[7],t[14]=this[11],t[15]=this[15],t}identity(){return this.copy(rgt)}fromObject(t){return this.check()}fromQuaternion(t){return z7(this,t),this.check()}frustum(t){let{left:r,right:i,bottom:s,top:n,near:o=Q7,far:a=K7}=t;return a===1/0?sgt(this,r,i,s,n,o):U7(this,r,i,s,n,o,a),this.check()}lookAt(t){let{eye:r,center:i=[0,0,0],up:s=[0,1,0]}=t;return W7(this,r,i,s),this.check()}ortho(t){let{left:r,right:i,bottom:s,top:n,near:o=Q7,far:a=K7}=t;return j7(this,r,i,s,n,o,a),this.check()}orthographic(t){let{fovy:r=tgt,aspect:i=egt,focalDistance:s=1,near:n=Q7,far:o=K7}=t;e$(r);let a=r/2,h=s*Math.tan(a),p=h*i;return this.ortho({left:-p,right:p,bottom:-h,top:h,near:n,far:o})}perspective(t){let{fovy:r=45*Math.PI/180,aspect:i=1,near:s=.1,far:n=500}=t;return e$(r),V7(this,r,i,s,n),this.check()}determinant(){return k7(this)}getScale(t=[-0,-0,-0]){return t[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),t[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),t[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),t}getTranslation(t=[-0,-0,-0]){return t[0]=this[12],t[1]=this[13],t[2]=this[14],t}getRotation(t,r){t=t||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],r=r||[-0,-0,-0];let i=this.getScale(r),s=1/i[0],n=1/i[1],o=1/i[2];return t[0]=this[0]*s,t[1]=this[1]*n,t[2]=this[2]*o,t[3]=0,t[4]=this[4]*s,t[5]=this[5]*n,t[6]=this[6]*o,t[7]=0,t[8]=this[8]*s,t[9]=this[9]*n,t[10]=this[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}getRotationMatrix3(t,r){t=t||[-0,-0,-0,-0,-0,-0,-0,-0,-0],r=r||[-0,-0,-0];let i=this.getScale(r),s=1/i[0],n=1/i[1],o=1/i[2];return t[0]=this[0]*s,t[1]=this[1]*n,t[2]=this[2]*o,t[3]=this[4]*s,t[4]=this[5]*n,t[5]=this[6]*o,t[6]=this[8]*s,t[7]=this[9]*n,t[8]=this[10]*o,t}transpose(){return P7(this,this),this.check()}invert(){return R7(this,this),this.check()}multiplyLeft(t){return Uv(this,t,this),this.check()}multiplyRight(t){return Uv(this,this,t),this.check()}rotateX(t){return N7(this,this,t),this.check()}rotateY(t){return L7(this,this,t),this.check()}rotateZ(t){return F7(this,this,t),this.check()}rotateXYZ(t){return this.rotateX(t[0]).rotateY(t[1]).rotateZ(t[2])}rotateAxis(t,r){return B7(this,this,t,r),this.check()}scale(t){return O7(this,this,Array.isArray(t)?t:[t,t,t]),this.check()}translate(t){return D7(this,this,t),this.check()}transform(t,r){return t.length===4?(r=Z7(r||[-0,-0,-0,-0],t,this),Rm(r,4),r):this.transformAsPoint(t,r)}transformAsPoint(t,r){let{length:i}=t,s;switch(i){case 2:s=y7(r||[-0,-0],t,this);break;case 3:s=Wg(r||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return Rm(s,t.length),s}transformAsVector(t,r){let i;switch(t.length){case 2:i=xW(r||[-0,-0],t,this);break;case 3:i=D5(r||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return Rm(i,t.length),i}transformPoint(t,r){return this.transformAsPoint(t,r)}transformVector(t,r){return this.transformAsPoint(t,r)}transformDirection(t,r){return this.transformAsVector(t,r)}makeRotationX(t){return this.identity().rotateX(t)}makeTranslation(t,r,i){return this.identity().translate([t,r,i])}},$5,H5;function igt(){return $5||($5=new Os([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze($5)),$5}function ngt(){return H5||(H5=new Os,Object.freeze(H5)),H5}function e$(e){if(e>Math.PI*2)throw Error("expected radians")}function sgt(e,t,r,i,s,n){let o=2*n/(r-t),a=2*n/(s-i),h=(r+t)/(r-t),p=(s+i)/(s-i),g=-1,v=-1,T=-2*n;return e[0]=o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=h,e[9]=p,e[10]=g,e[11]=v,e[12]=0,e[13]=0,e[14]=T,e[15]=0,e}function r$(){let e=new as(4);return as!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function i$(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function tD(e,t,r){r=r*.5;let i=Math.sin(r);return e[0]=i*t[0],e[1]=i*t[1],e[2]=i*t[2],e[3]=Math.cos(r),e}function eD(e,t,r){let i=t[0],s=t[1],n=t[2],o=t[3],a=r[0],h=r[1],p=r[2],g=r[3];return e[0]=i*g+o*a+s*p-n*h,e[1]=s*g+o*h+n*a-i*p,e[2]=n*g+o*p+i*h-s*a,e[3]=o*g-i*a-s*h-n*p,e}function n$(e,t,r){r*=.5;let i=t[0],s=t[1],n=t[2],o=t[3],a=Math.sin(r),h=Math.cos(r);return e[0]=i*h+o*a,e[1]=s*h+n*a,e[2]=n*h-s*a,e[3]=o*h-i*a,e}function s$(e,t,r){r*=.5;let i=t[0],s=t[1],n=t[2],o=t[3],a=Math.sin(r),h=Math.cos(r);return e[0]=i*h-n*a,e[1]=s*h+o*a,e[2]=n*h+i*a,e[3]=o*h-s*a,e}function o$(e,t,r){r*=.5;let i=t[0],s=t[1],n=t[2],o=t[3],a=Math.sin(r),h=Math.cos(r);return e[0]=i*h+s*a,e[1]=s*h-i*a,e[2]=n*h+o*a,e[3]=o*h-n*a,e}function a$(e,t){let r=t[0],i=t[1],s=t[2];return e[0]=r,e[1]=i,e[2]=s,e[3]=Math.sqrt(Math.abs(1-r*r-i*i-s*s)),e}function Vv(e,t,r,i){let s=t[0],n=t[1],o=t[2],a=t[3],h=r[0],p=r[1],g=r[2],v=r[3],T,C,B,L,z;return T=s*h+n*p+o*g+a*v,T<0&&(T=-T,h=-h,p=-p,g=-g,v=-v),1-T>1e-6?(C=Math.acos(T),z=Math.sin(C),B=Math.sin((1-i)*C)/z,L=Math.sin(i*C)/z):(B=1-i,L=i),e[0]=B*s+L*h,e[1]=B*n+L*p,e[2]=B*o+L*g,e[3]=B*a+L*v,e}function l$(e,t){let r=t[0],i=t[1],s=t[2],n=t[3],o=r*r+i*i+s*s+n*n,a=o?1/o:0;return e[0]=-r*a,e[1]=-i*a,e[2]=-s*a,e[3]=n*a,e}function c$(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e}function rD(e,t){let r=t[0]+t[4]+t[8],i;if(r>0)i=Math.sqrt(r+1),e[3]=.5*i,i=.5/i,e[0]=(t[5]-t[7])*i,e[1]=(t[6]-t[2])*i,e[2]=(t[1]-t[3])*i;else{let s=0;t[4]>t[0]&&(s=1),t[8]>t[s*3+s]&&(s=2);let n=(s+1)%3,o=(s+2)%3;i=Math.sqrt(t[s*3+s]-t[n*3+n]-t[o*3+o]+1),e[s]=.5*i,i=.5/i,e[3]=(t[n*3+o]-t[o*3+n])*i,e[n]=(t[n*3+s]+t[s*3+n])*i,e[o]=(t[o*3+s]+t[s*3+o])*i}return e}var u$=$7;var h$=H7,f$=Y7,p$=X7,d$=j5;var m$=W5;var A$=q7;var g$=function(){let e=B5(),t=N5(1,0,0),r=N5(0,1,0);return function(i,s,n){let o=Lv(s,n);return o<-.999999?(jg(e,t,s),S7(e)<1e-6&&jg(e,r,s),x7(e,e),tD(i,e,Math.PI),i):o>.999999?(i[0]=0,i[1]=0,i[2]=0,i[3]=1,i):(jg(e,s,n),i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=1+o,A$(i,i))}}(),rLt=function(){let e=r$(),t=r$();return function(r,i,s,n,o,a){return Vv(e,i,o,a),Vv(t,s,n,a),Vv(r,e,t,2*a*(1-a)),r}}(),iLt=function(){let e=PW();return function(t,r,i,s){return e[0]=i[0],e[3]=i[1],e[6]=i[2],e[1]=s[0],e[4]=s[1],e[7]=s[2],e[2]=-r[0],e[5]=-r[1],e[8]=-r[2],A$(t,rD(t,e))}}();var agt=[0,0,0,1],Uy=class extends Pm{constructor(t=0,r=0,i=0,s=1){super(-0,-0,-0,-0),Array.isArray(t)&&arguments.length===1?this.copy(t):this.set(t,r,i,s)}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this.check()}set(t,r,i,s){return this[0]=t,this[1]=r,this[2]=i,this[3]=s,this.check()}fromObject(t){return this[0]=t.x,this[1]=t.y,this[2]=t.z,this[3]=t.w,this.check()}fromMatrix3(t){return rD(this,t),this.check()}fromAxisRotation(t,r){return tD(this,t,r),this.check()}identity(){return i$(this),this.check()}setAxisAngle(t,r){return this.fromAxisRotation(t,r)}get ELEMENTS(){return 4}get x(){return this[0]}set x(t){this[0]=On(t)}get y(){return this[1]}set y(t){this[1]=On(t)}get z(){return this[2]}set z(t){this[2]=On(t)}get w(){return this[3]}set w(t){this[3]=On(t)}len(){return d$(this)}lengthSquared(){return m$(this)}dot(t){return f$(this,t)}rotationTo(t,r){return g$(this,t,r),this.check()}add(t){return u$(this,this,t),this.check()}calculateW(){return a$(this,this),this.check()}conjugate(){return c$(this,this),this.check()}invert(){return l$(this,this),this.check()}lerp(t,r,i){return i===void 0?this.lerp(this,t,r):(p$(this,t,r,i),this.check())}multiplyRight(t){return eD(this,this,t),this.check()}multiplyLeft(t){return eD(this,t,this),this.check()}normalize(){let t=this.len(),r=t>0?1/t:0;return this[0]=this[0]*r,this[1]=this[1]*r,this[2]=this[2]*r,this[3]=this[3]*r,t===0&&(this[3]=1),this.check()}rotateX(t){return n$(this,this,t),this.check()}rotateY(t){return s$(this,this,t),this.check()}rotateZ(t){return o$(this,this,t),this.check()}scale(t){return h$(this,this,t),this.check()}slerp(t,r,i){let s,n,o;switch(arguments.length){case 1:({start:s=agt,target:n,ratio:o}=t);break;case 2:s=this,n=t,o=r;break;default:s=t,n=r,o=i}return Vv(this,s,n,o),this.check()}transformVector4(t,r=new z5){return G7(r,t,this),Rm(r,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(t,r){return this.setAxisAngle(t,r)}premultiply(t){return this.multiplyLeft(t)}multiply(t){return this.multiplyRight(t)}};var jv={};Ua(jv,{EPSILON1:()=>lgt,EPSILON10:()=>ggt,EPSILON11:()=>_gt,EPSILON12:()=>ygt,EPSILON13:()=>xgt,EPSILON14:()=>bgt,EPSILON15:()=>vgt,EPSILON16:()=>wgt,EPSILON17:()=>Tgt,EPSILON18:()=>Sgt,EPSILON19:()=>Egt,EPSILON2:()=>cgt,EPSILON20:()=>Igt,EPSILON3:()=>ugt,EPSILON4:()=>hgt,EPSILON5:()=>fgt,EPSILON6:()=>pgt,EPSILON7:()=>dgt,EPSILON8:()=>mgt,EPSILON9:()=>Agt,PI_OVER_FOUR:()=>Cgt,PI_OVER_SIX:()=>Pgt,PI_OVER_TWO:()=>Mgt,TWO_PI:()=>Rgt});var lgt=.1,cgt=.01,ugt=.001,hgt=1e-4,fgt=1e-5,pgt=1e-6,dgt=1e-7,mgt=1e-8,Agt=1e-9,ggt=1e-10,_gt=1e-11,ygt=1e-12,xgt=1e-13,bgt=1e-14,vgt=1e-15,wgt=1e-16,Tgt=1e-17,Sgt=1e-18,Egt=1e-19,Igt=1e-20,Mgt=Math.PI/2,Cgt=Math.PI/4,Pgt=Math.PI/6,Rgt=Math.PI*2;var iD=`#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))
struct AmbientLight {
vec3 color;
};
struct PointLight {
vec3 color;
vec3 position;
vec3 attenuation;
};
struct DirectionalLight {
vec3 color;
vec3 direction;
};
uniform AmbientLight lighting_uAmbientLight;
uniform PointLight lighting_uPointLight[MAX_LIGHTS];
uniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];
uniform int lighting_uPointLightCount;
uniform int lighting_uDirectionalLightCount;
uniform bool lighting_uEnabled;
float getPointLightAttenuation(PointLight pointLight, float distance) {
return pointLight.attenuation.x
+ pointLight.attenuation.y * distance
+ pointLight.attenuation.z * distance * distance;
}
#endif
`;var kgt={lightSources:{}};function nD(e={}){let{color:t=[0,0,0],intensity:r=1}=e;return t.map(i=>i*r/255)}function Dgt({ambientLight:e,pointLights:t=[],directionalLights:r=[]}){let i={};return e?i["lighting_uAmbientLight.color"]=nD(e):i["lighting_uAmbientLight.color"]=[0,0,0],t.forEach((s,n)=>{i[`lighting_uPointLight[${n}].color`]=nD(s),i[`lighting_uPointLight[${n}].position`]=s.position,i[`lighting_uPointLight[${n}].attenuation`]=s.attenuation||[1,0,0]}),i.lighting_uPointLightCount=t.length,r.forEach((s,n)=>{i[`lighting_uDirectionalLight[${n}].color`]=nD(s),i[`lighting_uDirectionalLight[${n}].direction`]=s.direction}),i.lighting_uDirectionalLightCount=r.length,i}function _$(e=kgt){if("lightSources"in e){let{ambientLight:t,pointLights:r,directionalLights:i}=e.lightSources||{};return t||r&&r.length>0||i&&i.length>0?Object.assign({},Dgt({ambientLight:t,pointLights:r,directionalLights:i}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in e){let t={pointLights:[],directionalLights:[]};for(let r of e.lights||[])switch(r.type){case"ambient":t.ambientLight=r;break;case"directional":t.directionalLights?.push(r);break;case"point":t.pointLights?.push(r);break;default:}return _$({lightSources:t})}return{}}var sD={name:"lights",vs:iD,fs:iD,getUniforms:_$,defines:{MAX_LIGHTS:3}};var oD=`uniform float lighting_uAmbient;
uniform float lighting_uDiffuse;
uniform float lighting_uShininess;
uniform vec3  lighting_uSpecularColor;
vec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {
vec3 halfway_direction = normalize(light_direction + view_direction);
float lambertian = dot(light_direction, normal_worldspace);
float specular = 0.0;
if (lambertian > 0.0) {
float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);
specular = pow(specular_angle, lighting_uShininess);
}
lambertian = max(lambertian, 0.0);
return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;
}
vec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
vec3 lightColor = surfaceColor;
if (lighting_uEnabled) {
vec3 view_direction = normalize(cameraPosition - position_worldspace);
lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;
for (int i = 0; i < MAX_LIGHTS; i++) {
if (i >= lighting_uPointLightCount) {
break;
}
PointLight pointLight = lighting_uPointLight[i];
vec3 light_position_worldspace = pointLight.position;
vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
}
for (int i = 0; i < MAX_LIGHTS; i++) {
if (i >= lighting_uDirectionalLightCount) {
break;
}
DirectionalLight directionalLight = lighting_uDirectionalLight[i];
lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
}
}
return lightColor;
}
vec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
vec3 lightColor = vec3(0, 0, 0);
vec3 surfaceColor = vec3(0, 0, 0);
if (lighting_uEnabled) {
vec3 view_direction = normalize(cameraPosition - position_worldspace);
for (int i = 0; i < MAX_LIGHTS; i++) {
if (i >= lighting_uPointLightCount) {
break;
}
PointLight pointLight = lighting_uPointLight[i];
vec3 light_position_worldspace = pointLight.position;
vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
}
for (int i = 0; i < MAX_LIGHTS; i++) {
if (i >= lighting_uDirectionalLightCount) {
break;
}
DirectionalLight directionalLight = lighting_uDirectionalLight[i];
lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
}
}
return lightColor;
}
`;var Ogt={};function Bgt(e){let{ambient:t=.35,diffuse:r=.6,shininess:i=32,specularColor:s=[30,30,30]}=e;return{lighting_uAmbient:t,lighting_uDiffuse:r,lighting_uShininess:i,lighting_uSpecularColor:s.map(n=>n/255)}}function y$(e=Ogt){if(!("material"in e))return{};let{material:t}=e;return t?Bgt(t):{lighting_uEnabled:!1}}var $g={name:"gouraud-lighting",dependencies:[sD],vs:oD,defines:{LIGHTING_VERTEX:1},getUniforms:y$},Wv={name:"phong-lighting",dependencies:[sD],fs:oD,defines:{LIGHTING_FRAGMENT:1},getUniforms:y$};var x$="#define SMOOTH_EDGE_RADIUS 0.5",Ngt=`
${x$}

struct VertexGeometry {
  vec4 position;
  vec3 worldPosition;
  vec3 worldPositionAlt;
  vec3 normal;
  vec2 uv;
  vec3 pickingColor;
} geometry = VertexGeometry(
  vec4(0.0, 0.0, 1.0, 0.0),
  vec3(0.0),
  vec3(0.0),
  vec3(0.0),
  vec2(0.0),
  vec3(0.0)
);
`,Lgt=`
${x$}

struct FragmentGeometry {
  vec2 uv;
} geometry;

float smoothedge(float edge, float x) {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`,b$={name:"geometry",vs:Ngt,fs:Lgt};var qi={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(qi,"IDENTITY",{get:()=>(Ir.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});var dl={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},ml={common:0,meters:1,pixels:2},$v={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}};var Fgt=Object.keys(qi).map(e=>`const int COORDINATE_SYSTEM_${e} = ${qi[e]};`).join(""),zgt=Object.keys(dl).map(e=>`const int PROJECTION_MODE_${e} = ${dl[e]};`).join(""),Ugt=Object.keys(ml).map(e=>`const int UNIT_${e.toUpperCase()} = ${ml[e]};`).join(""),v$=`${Fgt}
${zgt}
${Ugt}
uniform int project_uCoordinateSystem;
uniform int project_uProjectionMode;
uniform float project_uScale;
uniform bool project_uWrapLongitude;
uniform vec3 project_uCommonUnitsPerMeter;
uniform vec3 project_uCommonUnitsPerWorldUnit;
uniform vec3 project_uCommonUnitsPerWorldUnit2;
uniform vec4 project_uCenter;
uniform mat4 project_uModelMatrix;
uniform mat4 project_uViewProjectionMatrix;
uniform vec2 project_uViewportSize;
uniform float project_uDevicePixelRatio;
uniform float project_uFocalDistance;
uniform vec3 project_uCameraPosition;
uniform vec3 project_uCoordinateOrigin;
uniform vec3 project_uCommonOrigin;
uniform bool project_uPseudoMeters;
const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / (PI * 2.0);
const vec3 ZERO_64_LOW = vec3(0.0);
const float EARTH_RADIUS = 6370972.0;
const float GLOBE_RADIUS = 256.0;
float project_size_at_latitude(float lat) {
float y = clamp(lat, -89.9, 89.9);
return 1.0 / cos(radians(y));
}
float project_size() {
if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&
project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
project_uPseudoMeters == false) {
if (geometry.position.w == 0.0) {
return project_size_at_latitude(geometry.worldPosition.y);
}
float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
float y2 = y * y;
float y4 = y2 * y2;
float y6 = y4 * y2;
return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
}
return 1.0;
}
float project_size_at_latitude(float meters, float lat) {
return meters * project_uCommonUnitsPerMeter.z * project_size_at_latitude(lat);
}
float project_size(float meters) {
return meters * project_uCommonUnitsPerMeter.z * project_size();
}
vec2 project_size(vec2 meters) {
return meters * project_uCommonUnitsPerMeter.xy * project_size();
}
vec3 project_size(vec3 meters) {
return meters * project_uCommonUnitsPerMeter * project_size();
}
vec4 project_size(vec4 meters) {
return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);
}
mat3 project_get_orientation_matrix(vec3 up) {
vec3 uz = normalize(up);
vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));
vec3 uy = cross(uz, ux);
return mat3(ux, uy, uz);
}
bool project_needs_rotation(vec3 commonPosition, out mat3 transform) {
if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
transform = project_get_orientation_matrix(commonPosition);
return true;
}
return false;
}
vec3 project_normal(vec3 vector) {
vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);
vec3 n = normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);
mat3 rotation;
if (project_needs_rotation(geometry.position.xyz, rotation)) {
n = rotation * n;
}
return n;
}
vec4 project_offset_(vec4 offset) {
float dy = offset.y;
vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;
return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}
vec2 project_mercator_(vec2 lnglat) {
float x = lnglat.x;
if (project_uWrapLongitude) {
x = mod(x + 180., 360.0) - 180.;
}
float y = clamp(lnglat.y, -89.9, 89.9);
return vec2(
radians(x) + PI,
PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))
) * WORLD_SCALE;
}
vec3 project_globe_(vec3 lnglatz) {
float lambda = radians(lnglatz.x);
float phi = radians(lnglatz.y);
float cosPhi = cos(phi);
float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;
return vec3(
sin(lambda) * cosPhi,
-cos(lambda) * cosPhi,
sin(phi)
) * D;
}
vec4 project_position(vec4 position, vec3 position64Low) {
vec4 position_world = project_uModelMatrix * position;
if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {
if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
return vec4(
project_mercator_(position_world.xy),
project_size_at_latitude(position_world.z, position_world.y),
position_world.w
);
}
if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
position_world.xyz += project_uCoordinateOrigin;
}
}
if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
return vec4(
project_globe_(position_world.xyz),
position_world.w
);
}
}
if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {
return vec4(
project_mercator_(position_world.xy) - project_uCommonOrigin.xy,
project_size(position_world.z),
position_world.w
);
}
}
}
if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||
(project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
(project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
position_world.xyz -= project_uCoordinateOrigin;
}
return project_offset_(position_world) + project_offset_(project_uModelMatrix * vec4(position64Low, 0.0));
}
vec4 project_position(vec4 position) {
return project_position(position, ZERO_64_LOW);
}
vec3 project_position(vec3 position, vec3 position64Low) {
vec4 projected_position = project_position(vec4(position, 1.0), position64Low);
return projected_position.xyz;
}
vec3 project_position(vec3 position) {
vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);
return projected_position.xyz;
}
vec2 project_position(vec2 position) {
vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);
return projected_position.xy;
}
vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
return viewProjectionMatrix * position + center;
}
vec4 project_common_position_to_clipspace(vec4 position) {
return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;
return offset * project_uFocalDistance;
}
float project_size_to_pixel(float meters) {
return project_size(meters) * project_uScale;
}
float project_size_to_pixel(float size, int unit) {
if (unit == UNIT_METERS) return project_size_to_pixel(size);
if (unit == UNIT_COMMON) return size * project_uScale;
return size;
}
float project_pixel_size(float pixels) {
return pixels / project_uScale;
}
vec2 project_pixel_size(vec2 pixels) {
return pixels / project_uScale;
}
`;function Vgt(e,t){if(e===t)return!0;if(Array.isArray(e)){let r=e.length;if(!t||t.length!==r)return!1;for(let i=0;i<r;i++)if(e[i]!==t[i])return!1;return!0}return!1}function np(e){let t={},r;return i=>{for(let s in i)if(!Vgt(i[s],t[s])){r=e(i),t=i;break}return r}}var w$=[0,0,0,0],jgt=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],T$=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Wgt=[0,0,0],S$=[0,0,0],$gt=np(qgt);function aD(e,t,r=S$){r.length<3&&(r=[r[0],r[1],0]);let i=r,s,n=!0;switch(t===qi.LNGLAT_OFFSETS||t===qi.METER_OFFSETS?s=r:s=e.isGeospatial?[Math.fround(e.longitude),Math.fround(e.latitude),0]:null,e.projectionMode){case dl.WEB_MERCATOR:(t===qi.LNGLAT||t===qi.CARTESIAN)&&(s=[0,0,0],n=!1);break;case dl.WEB_MERCATOR_AUTO_OFFSET:t===qi.LNGLAT?i=s:t===qi.CARTESIAN&&(i=[Math.fround(e.center[0]),Math.fround(e.center[1]),0],s=e.unprojectPosition(i),i[0]-=r[0],i[1]-=r[1],i[2]-=r[2]);break;case dl.IDENTITY:i=e.position.map(Math.fround),i[2]=i[2]||0;break;case dl.GLOBE:n=!1,s=null;break;default:n=!1}return{geospatialOrigin:s,shaderCoordinateOrigin:i,offsetMode:n}}function Hgt(e,t,r){let{viewMatrixUncentered:i,projectionMatrix:s}=e,{viewMatrix:n,viewProjectionMatrix:o}=e,a=w$,h=w$,p=e.cameraPosition,{geospatialOrigin:g,shaderCoordinateOrigin:v,offsetMode:T}=aD(e,t,r);return T&&(h=e.projectPosition(g||v),p=[p[0]-h[0],p[1]-h[1],p[2]-h[2]],h[3]=1,a=bc.transformMat4([],h,o),n=i||n,o=ko.multiply([],s,n),o=ko.multiply([],o,jgt)),{viewMatrix:n,viewProjectionMatrix:o,projectionCenter:a,originCommon:h,cameraPosCommon:p,shaderCoordinateOrigin:v,geospatialOrigin:g}}function E$({viewport:e,devicePixelRatio:t=1,modelMatrix:r=null,coordinateSystem:i=qi.DEFAULT,coordinateOrigin:s=S$,autoWrapLongitude:n=!1}){i===qi.DEFAULT&&(i=e.isGeospatial?qi.LNGLAT:qi.CARTESIAN);let o=$gt({viewport:e,devicePixelRatio:t,coordinateSystem:i,coordinateOrigin:s});return o.project_uWrapLongitude=n,o.project_uModelMatrix=r||T$,o}function qgt({viewport:e,devicePixelRatio:t,coordinateSystem:r,coordinateOrigin:i}){let{projectionCenter:s,viewProjectionMatrix:n,originCommon:o,cameraPosCommon:a,shaderCoordinateOrigin:h,geospatialOrigin:p}=Hgt(e,r,i),g=e.getDistanceScales(),v=[e.width*t,e.height*t],T=bc.transformMat4([],[0,0,-e.focalDistance,1],e.projectionMatrix)[3]||1,C={project_uCoordinateSystem:r,project_uProjectionMode:e.projectionMode,project_uCoordinateOrigin:h,project_uCommonOrigin:o.slice(0,3),project_uCenter:s,project_uPseudoMeters:!!e._pseudoMeters,project_uViewportSize:v,project_uDevicePixelRatio:t,project_uFocalDistance:T,project_uCommonUnitsPerMeter:g.unitsPerMeter,project_uCommonUnitsPerWorldUnit:g.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:Wgt,project_uScale:e.scale,project_uWrapLongitude:!1,project_uViewProjectionMatrix:n,project_uModelMatrix:T$,project_uCameraPosition:a};if(p){let B=e.getDistanceScales(p);switch(r){case qi.METER_OFFSETS:C.project_uCommonUnitsPerWorldUnit=B.unitsPerMeter,C.project_uCommonUnitsPerWorldUnit2=B.unitsPerMeter2;break;case qi.LNGLAT:case qi.LNGLAT_OFFSETS:e._pseudoMeters||(C.project_uCommonUnitsPerMeter=B.unitsPerMeter),C.project_uCommonUnitsPerWorldUnit=B.unitsPerDegree,C.project_uCommonUnitsPerWorldUnit2=B.unitsPerDegree2;break;case qi.CARTESIAN:C.project_uCommonUnitsPerWorldUnit=[1,1,B.unitsPerMeter[2]],C.project_uCommonUnitsPerWorldUnit2=[0,0,B.unitsPerMeter2[2]];break;default:break}}return C}var Ygt={};function Xgt(e=Ygt){return"viewport"in e?E$(e):{}}var Hg={name:"project",dependencies:[d7,b$],vs:v$,getUniforms:Xgt};var Zgt=`
vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition
) {
  vec3 projectedPosition = project_position(position, position64Low);
  mat3 rotation;
  if (project_needs_rotation(projectedPosition, rotation)) {
    // offset is specified as ENU
    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe
    offset = rotation * offset;
  }
  commonPosition = vec4(projectedPosition + offset, 1.0);
  return project_common_position_to_clipspace(commonPosition);
}

vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset
) {
  vec4 commonPosition;
  return project_position_to_clipspace(position, position64Low, offset, commonPosition);
}
`,Al={name:"project32",dependencies:[Hg],vs:Zgt};function lD(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function km(e,t){let r=bc.transformMat4([],t,e);return bc.scale(r,r,1/r[3]),r}function cD(e,t){let r=e%t;return r<0?t+r:r}function Hv(e,t,r){return e<t?t:e>r?r:e}function Ggt(e){return Math.log(e)*Math.LOG2E}var Vy=Math.log2||Ggt;function Xh(e,t){if(!e)throw new Error(t||"@math.gl/web-mercator: assertion failed.")}var Zh=Math.PI,I$=Zh/4,Gu=Zh/180,uD=180/Zh,jy=512,q5=4003e4,Wy=85.051129,M$=1.5;function hD(e){return Vy(e)}function Va(e){let[t,r]=e;Xh(Number.isFinite(t)),Xh(Number.isFinite(r)&&r>=-90&&r<=90,"invalid latitude");let i=t*Gu,s=r*Gu,n=jy*(i+Zh)/(2*Zh),o=jy*(Zh+Math.log(Math.tan(I$+s*.5)))/(2*Zh);return[n,o]}function lu(e){let[t,r]=e,i=t/jy*(2*Zh)-Zh,s=2*(Math.atan(Math.exp(r/jy*(2*Zh)-Zh))-I$);return[i*uD,s*uD]}function fD(e){let{latitude:t}=e;Xh(Number.isFinite(t));let r=Math.cos(t*Gu);return hD(q5*r)-9}function Yg(e){let t=Math.cos(e*Gu);return jy/q5/t}function $y(e){let{latitude:t,longitude:r,highPrecision:i=!1}=e;Xh(Number.isFinite(t)&&Number.isFinite(r));let s=jy,n=Math.cos(t*Gu),o=s/360,a=o/n,h=s/q5/n,p={unitsPerMeter:[h,h,h],metersPerUnit:[1/h,1/h,1/h],unitsPerDegree:[o,a,h],degreesPerUnit:[1/o,1/a,1/h]};if(i){let g=Gu*Math.tan(t*Gu)/n,v=o*g/2,T=s/q5*g,C=T/a*h;p.unitsPerDegree2=[0,v,T],p.unitsPerMeter2=[C,0,C]}return p}function qv(e,t){let[r,i,s]=e,[n,o,a]=t,{unitsPerMeter:h,unitsPerMeter2:p}=$y({longitude:r,latitude:i,highPrecision:!0}),g=Va(e);g[0]+=n*(h[0]+p[0]*o),g[1]+=o*(h[1]+p[1]*o);let v=lu(g),T=(s||0)+(a||0);return Number.isFinite(s)||Number.isFinite(a)?[v[0],v[1],T]:v}function Y5(e){let{height:t,pitch:r,bearing:i,altitude:s,scale:n,center:o}=e,a=lD();ko.translate(a,a,[0,0,-s]),ko.rotateX(a,a,-r*Gu),ko.rotateZ(a,a,i*Gu);let h=n/t;return ko.scale(a,a,[h,h,h]),o&&ko.translate(a,a,xc.negate([],o)),a}function pD(e){let{width:t,height:r,altitude:i,pitch:s=0,offset:n,center:o,scale:a,nearZMultiplier:h=1,farZMultiplier:p=1}=e,{fovy:g=qg(M$)}=e;i!==void 0&&(g=qg(i));let v=g*Gu,T=s*Gu,C=Yv(g),B=C;o&&(B+=o[2]*a/Math.cos(T)/r);let L=v*(.5+(n?n[1]:0)/r),z=Math.sin(L)*B/Math.sin(Hv(Math.PI/2-T-L,.01,Math.PI-.01)),W=Math.sin(T)*z+B,Z=B*10,X=Math.min(W*p,Z);return{fov:v,aspect:t/r,focalDistance:C,near:h,far:X}}function qg(e){return 2*Math.atan(.5/e)*uD}function Yv(e){return .5/Math.tan(.5*e*Gu)}function Hy(e,t){let[r,i,s=0]=e;return Xh(Number.isFinite(r)&&Number.isFinite(i)&&Number.isFinite(s)),km(t,[r,i,s,1])}function Dm(e,t,r=0){let[i,s,n]=e;if(Xh(Number.isFinite(i)&&Number.isFinite(s),"invalid pixel coordinate"),Number.isFinite(n))return km(t,[i,s,n,1]);let o=km(t,[i,s,0,1]),a=km(t,[i,s,1,1]),h=o[2],p=a[2],g=h===p?0:((r||0)-h)/(p-h);return ip.lerp([],o,a,g)}function X5(e){let{width:t,height:r,bounds:i,minExtent:s=0,maxZoom:n=24,offset:o=[0,0]}=e,[[a,h],[p,g]]=i,v=Qgt(e.padding),T=Va([a,Hv(g,-Wy,Wy)]),C=Va([p,Hv(h,-Wy,Wy)]),B=[Math.max(Math.abs(C[0]-T[0]),s),Math.max(Math.abs(C[1]-T[1]),s)],L=[t-v.left-v.right-Math.abs(o[0])*2,r-v.top-v.bottom-Math.abs(o[1])*2];Xh(L[0]>0&&L[1]>0);let z=L[0]/B[0],W=L[1]/B[1],Z=(v.right-v.left)/2/z,X=(v.top-v.bottom)/2/W,q=[(C[0]+T[0])/2+Z,(C[1]+T[1])/2+X],it=lu(q),nt=Math.min(n,Vy(Math.abs(Math.min(z,W))));return Xh(Number.isFinite(nt)),{longitude:it[0],latitude:it[1],zoom:nt}}function Qgt(e=0){return typeof e=="number"?{top:e,bottom:e,left:e,right:e}:(Xh(Number.isFinite(e.top)&&Number.isFinite(e.bottom)&&Number.isFinite(e.left)&&Number.isFinite(e.right)),e)}var C$=Math.PI/180;function Z5(e,t=0){let{width:r,height:i,unproject:s}=e,n={targetZ:t},o=s([0,i],n),a=s([r,i],n),h,p,g=e.fovy?.5*e.fovy*C$:Math.atan(.5/e.altitude),v=(90-e.pitch)*C$;return g>v-.01?(h=P$(e,0,t),p=P$(e,r,t)):(h=s([0,0],n),p=s([r,0],n)),[o,a,p,h]}function P$(e,t,r){let{pixelUnprojectionMatrix:i}=e,s=km(i,[t,0,1,1]),n=km(i,[t,e.height,1,1]),a=(r*e.distanceScales.unitsPerMeter[2]-s[2])/(n[2]-s[2]),h=ip.lerp([],s,n,a),p=lu(h);return p.push(r),p}var k$=512;function dD(e){let{width:t,height:r,pitch:i=0}=e,{longitude:s,latitude:n,zoom:o,bearing:a=0}=e;(s<-180||s>180)&&(s=cD(s+180,360)-180),(a<-180||a>180)&&(a=cD(a+180,360)-180);let h=Vy(r/k$);if(o<=h)o=h,n=0;else{let p=r/2/Math.pow(2,o),g=lu([0,p])[1];if(n<g)n=g;else{let v=lu([0,k$-p])[1];n>v&&(n=v)}}return{width:t,height:r,longitude:s,latitude:n,zoom:o,pitch:i,bearing:a}}var t1t=`
const int max_lights = 2;
uniform mat4 shadow_uViewProjectionMatrices[max_lights];
uniform vec4 shadow_uProjectCenters[max_lights];
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform int shadow_uLightId;
uniform float shadow_uLightCount;

out vec3 shadow_vPosition[max_lights];

vec4 shadow_setVertexPosition(vec4 position_commonspace) {
  if (shadow_uDrawShadowMap) {
    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);
  }
  if (shadow_uUseShadowMap) {
    for (int i = 0; i < max_lights; i++) {
      if(i < int(shadow_uLightCount)) {
        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);
        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;
      }
    }
  }
  return gl_Position;
}
`,e1t=`
const int max_lights = 2;
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform sampler2D shadow_uShadowMap0;
uniform sampler2D shadow_uShadowMap1;
uniform vec4 shadow_uColor;
uniform float shadow_uLightCount;

in vec3 shadow_vPosition[max_lights];

const vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);
const vec4 bitUnpackShift = 1.0 / bitPackShift;
const vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);

float shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {
  vec4 rgbaDepth = texture(shadowMap, position.xy);

  float z = dot(rgbaDepth, bitUnpackShift);
  return smoothstep(0.001, 0.01, position.z - z);
}

vec4 shadow_filterShadowColor(vec4 color) {
  if (shadow_uDrawShadowMap) {
    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);
    rgbaDepth -= rgbaDepth.gbaa * bitMask;
    return rgbaDepth;
  }
  if (shadow_uUseShadowMap) {
    float shadowAlpha = 0.0;
    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);
    if(shadow_uLightCount > 1.0) {
      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);
    }
    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;
    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);

    return vec4(
      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),
      blendedAlpha
    );
  }
  return color;
}
`,r1t=np(a1t),i1t=np(l1t),n1t=[0,0,0,1],s1t=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];function o1t(e,t){let[r,i,s]=e,n=Dm([r,i,s],t);return Number.isFinite(s)?n:[n[0],n[1],0]}function a1t({viewport:e,center:t}){return new Os(e.viewProjectionMatrix).invert().transform(t)}function l1t({viewport:e,shadowMatrices:t}){let r=[],i=e.pixelUnprojectionMatrix,s=e.isGeospatial?void 0:1,n=[[0,0,s],[e.width,0,s],[0,e.height,s],[e.width,e.height,s],[0,0,-1],[e.width,0,-1],[0,e.height,-1],[e.width,e.height,-1]].map(o=>o1t(o,i));for(let o of t){let a=o.clone().translate(new rr(e.center).negate()),h=n.map(g=>a.transform(g)),p=new Os().ortho({left:Math.min(...h.map(g=>g[0])),right:Math.max(...h.map(g=>g[0])),bottom:Math.min(...h.map(g=>g[1])),top:Math.max(...h.map(g=>g[1])),near:Math.min(...h.map(g=>-g[2])),far:Math.max(...h.map(g=>-g[2]))});r.push(p.multiplyRight(o))}return r}function c1t(e,t){let{shadowEnabled:r=!0}=e;if(!r||!e.shadowMatrices||!e.shadowMatrices.length)return{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1,shadow_uShadowMap0:e.dummyShadowMap,shadow_uShadowMap1:e.dummyShadowMap};let i={shadow_uDrawShadowMap:!!e.drawToShadowMap,shadow_uUseShadowMap:e.shadowMaps?e.shadowMaps.length>0:!1,shadow_uColor:e.shadowColor||n1t,shadow_uLightId:e.shadowLightId||0,shadow_uLightCount:e.shadowMatrices.length},s=r1t({viewport:e.viewport,center:t.project_uCenter}),n=[],o=i1t({shadowMatrices:e.shadowMatrices,viewport:e.viewport}).slice();for(let a=0;a<e.shadowMatrices.length;a++){let h=o[a],p=h.clone().translate(new rr(e.viewport.center).negate());t.project_uCoordinateSystem===qi.LNGLAT&&t.project_uProjectionMode===dl.WEB_MERCATOR?(o[a]=p,n[a]=s):(o[a]=h.clone().multiplyRight(s1t),n[a]=p.transform(s))}for(let a=0;a<o.length;a++)i[`shadow_uViewProjectionMatrices[${a}]`]=o[a],i[`shadow_uProjectCenters[${a}]`]=n[a];for(let a=0;a<2;a++)i[`shadow_uShadowMap${a}`]=e.shadowMaps&&e.shadowMaps[a]||e.dummyShadowMap;return i}var G5={name:"shadow",dependencies:[Hg],vs:t1t,fs:e1t,inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    position = shadow_setVertexPosition(geometry.position);
    `,"fs:DECKGL_FILTER_COLOR":`
    color = shadow_filterShadowColor(color);
    `},getUniforms:(e={},t={})=>"viewport"in e&&(e.drawToShadowMap||e.shadowMaps&&e.shadowMaps.length>0)?c1t(e,t):{}};var gl={...k5,defaultUniforms:{...k5.defaultUniforms,useFloatColors:!1},inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    // for picking depth values
    picking_setPickingAttribute(position.z / position.w);
  `,"vs:DECKGL_FILTER_COLOR":`
  picking_setPickingColor(geometry.pickingColor);
  `,"fs:DECKGL_FILTER_COLOR":{order:99,injection:`
  // use highlight color if this fragment belongs to the selected object.
  color = picking_filterHighlightColor(color);

  // use picking color if rendering to picking FBO.
  color = picking_filterPickingColor(color);
    `}}};var u1t=[Hg],h1t=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function D$(){let e=Dg.getDefaultShaderAssembler();for(let t of u1t)e.addDefaultModule(t);for(let t of h1t)e.addShaderHook(t);return e}var f1t=[255,255,255],p1t=1,d1t=0,Q5=class{constructor(t={}){this.type="ambient";let{color:r=f1t}=t,{intensity:i=p1t}=t;this.id=t.id||`ambient-${d1t++}`,this.color=r,this.intensity=i}};var m1t=[255,255,255],A1t=1,g1t=[0,0,-1],_1t=0,Xv=class{constructor(t={}){this.type="directional";let{color:r=m1t}=t,{intensity:i=A1t}=t,{direction:s=g1t}=t,{_shadow:n=!1}=t;this.id=t.id||`directional-${_1t++}`,this.color=r,this.intensity=i,this.type="directional",this.direction=new rr(s).normalize().toArray(),this.shadow=n}getProjectedLight(t){return this}};var Zv=class{constructor(t,r={id:"pass"}){let{id:i}=r;this.id=i,this.device=t,this.props={...r}}setProps(t){Object.assign(this.props,t)}render(t){}cleanup(){}};var Od=class extends Zv{constructor(){super(...arguments),this._lastRenderIndex=-1}render(t){let[r,i]=this.device.canvasContext.getDrawingBufferSize(),s=t.clearCanvas??!0,n=t.clearColor??(s?[0,0,0,0]:!1),o=s?1:!1,a=s?0:!1,h=t.colorMask??15,p={viewport:[0,0,r,i]};t.colorMask&&(p.colorMask=h),t.scissorRect&&(p.scissorRect=t.scissorRect);let g=this.device.beginRenderPass({framebuffer:t.target,parameters:p,clearColor:n,clearDepth:o,clearStencil:a});try{return this._drawLayers(g,t)}finally{g.end()}}_drawLayers(t,r){let{target:i,moduleParameters:s,viewports:n,views:o,onViewportActive:a,clearStack:h=!0}=r;r.pass=r.pass||"unknown",h&&(this._lastRenderIndex=-1);let p=[];for(let g of n){let v=o&&o[g.id];a?.(g);let T=this._getDrawLayerParams(g,r),C=g.subViewports||[g];for(let B of C){let L=this._drawLayersInViewport(t,{target:i,moduleParameters:s,viewport:B,view:v,pass:r.pass,layers:r.layers},T);p.push(L)}}return p}_getDrawLayerParams(t,{layers:r,pass:i,isPicking:s=!1,layerFilter:n,cullRect:o,effects:a,moduleParameters:h},p=!1){let g=[],v=O$(this._lastRenderIndex+1),T={layer:r[0],viewport:t,isPicking:s,renderPass:i,cullRect:o},C={};for(let B=0;B<r.length;B++){let L=r[B],z=this._shouldDrawLayer(L,T,n,C),W={shouldDrawLayer:z};z&&!p&&(W.layerRenderIndex=v(L,z),W.moduleParameters=this._getModuleParameters(L,a,i,h),W.layerParameters={...L.context.deck?.props.parameters,...this.getLayerParameters(L,B,t)}),g[B]=W}return g}_drawLayersInViewport(t,{layers:r,moduleParameters:i,pass:s,target:n,viewport:o,view:a},h){let p=y1t(this.device,{moduleParameters:i,target:n,viewport:o});if(a&&a.props.clear){let v=a.props.clear===!0?{color:!0,depth:!0}:a.props.clear;this.device.withParametersWebGL({scissorTest:!0,scissor:p},()=>this.device.clearWebGL(v))}let g={totalCount:r.length,visibleCount:0,compositeCount:0,pickableCount:0};t.setParameters({viewport:p});for(let v=0;v<r.length;v++){let T=r[v],{shouldDrawLayer:C,layerRenderIndex:B,moduleParameters:L,layerParameters:z}=h[v];if(C&&T.props.pickable&&g.pickableCount++,T.isComposite)g.compositeCount++;else if(C){g.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,B),L.viewport=o,T.context.renderPass=t;try{T._drawLayer({renderPass:t,moduleParameters:L,uniforms:{layerIndex:B},parameters:z})}catch(W){T.raiseError(W,`drawing ${T} to ${s}`)}}}return g}shouldDrawLayer(t){return!0}getModuleParameters(t,r){return null}getLayerParameters(t,r,i){return t.props.parameters}_shouldDrawLayer(t,r,i,s){if(!(t.props.visible&&this.shouldDrawLayer(t)))return!1;r.layer=t;let o=t.parent;for(;o;){if(!o.props.visible||!o.filterSubLayer(r))return!1;r.layer=o,o=o.parent}if(i){let a=r.layer.id;if(a in s||(s[a]=i(r)),!s[a])return!1}return t.activateViewport(r.viewport),!0}_getModuleParameters(t,r,i,s){let n=this.device.canvasContext.cssToDeviceRatio(),o=Object.assign(Object.create(t.internalState?.propsInTransition||t.props),{autoWrapLongitude:t.wrapLongitude,viewport:t.context.viewport,mousePosition:t.context.mousePosition,picking:{isActive:0},devicePixelRatio:n});if(r)for(let a of r)Object.assign(o,a.getModuleParameters?.(t));return Object.assign(o,this.getModuleParameters(t,r),s)}};function O$(e=0,t={}){let r={},i=(s,n)=>{let o=s.props._offset,a=s.id,h=s.parent&&s.parent.id,p;if(h&&!(h in t)&&i(s.parent,!1),h in r){let g=r[h]=r[h]||O$(t[h],t);p=g(s,n),r[a]=g}else Number.isFinite(o)?(p=o+(t[h]||0),r[a]=null):p=e;return n&&p>=e&&(e=p+1),t[a]=p,p};return i}function y1t(e,{moduleParameters:t,target:r,viewport:i}){let s=t&&t.devicePixelRatio||e.canvasContext.cssToDeviceRatio(),[,n]=e.canvasContext.getDrawingBufferSize(),o=r?r.height:n,a=i;return[a.x*s,o-(a.y+a.height)*s,a.width*s,a.height*s]}var Gv=class extends Od{constructor(t,r){super(t,r),this.shadowMap=t.createTexture({width:1,height:1,sampler:{minFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}}),this.depthBuffer=t.createTexture({format:"depth16unorm",width:1,height:1,mipmaps:!1,dataFormat:6402,type:5125}),this.fbo=t.createFramebuffer({id:"shadowmap",width:1,height:1,colorAttachments:[this.shadowMap],depthStencilAttachment:this.depthBuffer})}render(t){let r=this.fbo,i=this.device.canvasContext.cssToDeviceRatio(),s=t.viewports[0],n=s.width*i,o=s.height*i,a=[1,1,1,1];(n!==r.width||o!==r.height)&&r.resize({width:n,height:o}),super.render({...t,clearColor:a,target:r,pass:"shadow"})}getLayerParameters(t,r,i){return{...t.props.parameters,blend:!1,depthRange:[0,1],depthTest:!0}}shouldDrawLayer(t){return t.props.shadowEnabled!==!1}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.destroy(),this.fbo=null),this.shadowMap&&(this.shadowMap.destroy(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.destroy(),this.depthBuffer=null)}};var x1t={color:[255,255,255],intensity:1},B$=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],b1t=[0,0,0,200/255],qy=class{constructor(t={}){this.id="lighting-effect",this.shadowColor=b1t,this.shadow=!1,this.ambientLight=null,this.directionalLights=[],this.pointLights=[],this.shadowPasses=[],this.shadowMaps=[],this.dummyShadowMap=null,this.setProps(t)}setup(t){this.context=t;let{device:r,deck:i}=t;this.shadow&&!this.dummyShadowMap&&(this._createShadowPasses(r),i._addDefaultShaderModule(G5),this.dummyShadowMap=r.createTexture({width:1,height:1}))}setProps(t){this.ambientLight=null,this.directionalLights=[],this.pointLights=[];for(let r in t){let i=t[r];switch(i.type){case"ambient":this.ambientLight=i;break;case"directional":this.directionalLights.push(i);break;case"point":this.pointLights.push(i);break;default:}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(r=>r.shadow),this.context&&this.setup(this.context),this.props=t}preRender({layers:t,layerFilter:r,viewports:i,onViewportActive:s,views:n}){if(this.shadow){this.shadowMatrices=this._calculateMatrices();for(let o=0;o<this.shadowPasses.length;o++)this.shadowPasses[o].render({layers:t,layerFilter:r,viewports:i,onViewportActive:s,views:n,moduleParameters:{shadowLightId:o,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}getModuleParameters(t){let r=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return r.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(i=>i.getProjectedLight({layer:t})),pointLights:this.pointLights.map(i=>i.getProjectedLight({layer:t}))},r}cleanup(t){for(let r of this.shadowPasses)r.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.destroy(),this.dummyShadowMap=null,t.deck._removeDefaultShaderModule(G5))}_calculateMatrices(){let t=[];for(let r of this.directionalLights){let i=new Os().lookAt({eye:new rr(r.direction).negate()});t.push(i)}return t}_createShadowPasses(t){for(let r=0;r<this.directionalLights.length;r++){let i=new Gv(t);this.shadowPasses[r]=i,this.shadowMaps[r]=i.shadowMap}}_applyDefaultLights(){let{ambientLight:t,pointLights:r,directionalLights:i}=this;!t&&r.length===0&&i.length===0&&(this.ambientLight=new Q5(x1t),this.directionalLights.push(new Xv(B$[0]),new Xv(B$[1])))}};var mD=class{constructor(t={}){this._pool=[],this.opts={overAlloc:2,poolSize:100},this.setOptions(t)}setOptions(t){Object.assign(this.opts,t)}allocate(t,r,{size:i=1,type:s,padding:n=0,copy:o=!1,initialize:a=!1,maxCount:h}){let p=s||t&&t.constructor||Float32Array,g=r*i+n;if(ArrayBuffer.isView(t)){if(g<=t.length)return t;if(g*t.BYTES_PER_ELEMENT<=t.buffer.byteLength)return new p(t.buffer,0,g)}let v=1/0;h&&(v=h*i+n);let T=this._allocate(p,g,a,v);return t&&o?T.set(t):a||T.fill(0,0,4),this._release(t),T}release(t){this._release(t)}_allocate(t,r,i,s){let n=Math.max(Math.ceil(r*this.opts.overAlloc),1);n>s&&(n=s);let o=this._pool,a=t.BYTES_PER_ELEMENT*n,h=o.findIndex(p=>p.byteLength>=a);if(h>=0){let p=new t(o.splice(h,1)[0],0,n);return i&&p.fill(0),p}return new t(n)}_release(t){if(!ArrayBuffer.isView(t))return;let r=this._pool,{buffer:i}=t,{byteLength:s}=i,n=r.findIndex(o=>o.byteLength>=s);n<0?r.push(i):(n>0||r.length<this.opts.poolSize)&&r.splice(n,0,i),r.length>this.opts.poolSize&&r.shift()}},Gh=new mD;function Xy(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function L$(e){return[e[12],e[13],e[14]]}function F$(e){return{left:Yy(e[3]+e[0],e[7]+e[4],e[11]+e[8],e[15]+e[12]),right:Yy(e[3]-e[0],e[7]-e[4],e[11]-e[8],e[15]-e[12]),bottom:Yy(e[3]+e[1],e[7]+e[5],e[11]+e[9],e[15]+e[13]),top:Yy(e[3]-e[1],e[7]-e[5],e[11]-e[9],e[15]-e[13]),near:Yy(e[3]+e[2],e[7]+e[6],e[11]+e[10],e[15]+e[14]),far:Yy(e[3]-e[2],e[7]-e[6],e[11]-e[10],e[15]-e[14])}}var N$=new rr;function Yy(e,t,r,i){N$.set(e,t,r);let s=N$.len();return{distance:i/s,normal:new rr(-e/s,-t/s,-r/s)}}function v1t(e){return e-Math.fround(e)}var Qv;function K5(e,t){let{size:r=1,startIndex:i=0}=t,s=t.endIndex!==void 0?t.endIndex:e.length,n=(s-i)/r;Qv=Gh.allocate(Qv,n,{type:Float32Array,size:r*2});let o=i,a=0;for(;o<s;){for(let h=0;h<r;h++){let p=e[o++];Qv[a+h]=p,Qv[a+h+r]=v1t(p)}a+=r*2}return Qv.subarray(0,n*r*2)}function z$(e){let t=null,r=!1;for(let i of e)i&&(t?(r||(t=[[t[0][0],t[0][1]],[t[1][0],t[1][1]]],r=!0),t[0][0]=Math.min(t[0][0],i[0][0]),t[0][1]=Math.min(t[0][1],i[0][1]),t[1][0]=Math.max(t[1][0],i[1][0]),t[1][1]=Math.max(t[1][1],i[1][1])):t=i);return t}var w1t=Math.PI/180,T1t=Xy(),U$=[0,0,0],S1t={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};function E1t({width:e,height:t,orthographic:r,fovyRadians:i,focalDistance:s,padding:n,near:o,far:a}){let h=e/t,p=r?new Os().orthographic({fovy:i,aspect:h,focalDistance:s,near:o,far:a}):new Os().perspective({fovy:i,aspect:h,near:o,far:a});if(n){let{left:g=0,right:v=0,top:T=0,bottom:C=0}=n,B=Xu((g+e-v)/2,0,e)-e/2,L=Xu((T+t-C)/2,0,t)-t/2;p[8]-=B*2/e,p[9]+=L*2/t}return p}var Bd=class e{static{this.displayName="Viewport"}constructor(t={}){this._frustumPlanes={},this.id=t.id||this.constructor.displayName||"viewport",this.x=t.x||0,this.y=t.y||0,this.width=t.width||1,this.height=t.height||1,this.zoom=t.zoom||0,this.padding=t.padding,this.distanceScales=t.distanceScales||S1t,this.focalDistance=t.focalDistance||1,this.position=t.position||U$,this.modelMatrix=t.modelMatrix||null;let{longitude:r,latitude:i}=t;this.isGeospatial=Number.isFinite(i)&&Number.isFinite(r),this._initProps(t),this._initMatrices(t),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?dl.WEB_MERCATOR:dl.WEB_MERCATOR_AUTO_OFFSET:dl.IDENTITY}equals(t){return t instanceof e?this===t?!0:t.width===this.width&&t.height===this.height&&t.scale===this.scale&&$l(t.projectionMatrix,this.projectionMatrix)&&$l(t.viewMatrix,this.viewMatrix):!1}project(t,{topLeft:r=!0}={}){let i=this.projectPosition(t),s=Hy(i,this.pixelProjectionMatrix),[n,o]=s,a=r?o:this.height-o;return t.length===2?[n,a]:[n,a,s[2]]}unproject(t,{topLeft:r=!0,targetZ:i}={}){let[s,n,o]=t,a=r?n:this.height-n,h=i&&i*this.distanceScales.unitsPerMeter[2],p=Dm([s,a,o],this.pixelUnprojectionMatrix,h),[g,v,T]=this.unprojectPosition(p);return Number.isFinite(o)?[g,v,T]:Number.isFinite(i)?[g,v,i]:[g,v]}projectPosition(t){let[r,i]=this.projectFlat(t),s=(t[2]||0)*this.distanceScales.unitsPerMeter[2];return[r,i,s]}unprojectPosition(t){let[r,i]=this.unprojectFlat(t),s=(t[2]||0)*this.distanceScales.metersPerUnit[2];return[r,i,s]}projectFlat(t){if(this.isGeospatial){let r=Va(t);return r[1]=Xu(r[1],-318,830),r}return t}unprojectFlat(t){return this.isGeospatial?lu(t):t}getBounds(t={}){let r={targetZ:t.z||0},i=this.unproject([0,0],r),s=this.unproject([this.width,0],r),n=this.unproject([0,this.height],r),o=this.unproject([this.width,this.height],r);return[Math.min(i[0],s[0],n[0],o[0]),Math.min(i[1],s[1],n[1],o[1]),Math.max(i[0],s[0],n[0],o[0]),Math.max(i[1],s[1],n[1],o[1])]}getDistanceScales(t){return t?$y({longitude:t[0],latitude:t[1],highPrecision:!0}):this.distanceScales}containsPixel({x:t,y:r,width:i=1,height:s=1}){return t<this.x+this.width&&this.x<t+i&&r<this.y+this.height&&this.y<r+s}getFrustumPlanes(){return this._frustumPlanes.near?this._frustumPlanes:(Object.assign(this._frustumPlanes,F$(this.viewProjectionMatrix)),this._frustumPlanes)}panByPosition(t,r){return null}_initProps(t){let r=t.longitude,i=t.latitude;this.isGeospatial&&(Number.isFinite(t.zoom)||(this.zoom=fD({latitude:i})+Math.log2(this.focalDistance)),this.distanceScales=t.distanceScales||$y({latitude:i,longitude:r}));let s=Math.pow(2,this.zoom);this.scale=s;let{position:n,modelMatrix:o}=t,a=U$;if(n&&(a=o?new Os(o).transformAsVector(n,[]):n),this.isGeospatial){let h=this.projectPosition([r,i,0]);this.center=new rr(a).scale(this.distanceScales.unitsPerMeter).add(h)}else this.center=this.projectPosition(a)}_initMatrices(t){let{viewMatrix:r=T1t,projectionMatrix:i=null,orthographic:s=!1,fovyRadians:n,fovy:o=75,near:a=.1,far:h=1e3,padding:p=null,focalDistance:g=1}=t;this.viewMatrixUncentered=r,this.viewMatrix=new Os().multiplyRight(r).translate(new rr(this.center).negate()),this.projectionMatrix=i||E1t({width:this.width,height:this.height,orthographic:s,fovyRadians:n||o*w1t,focalDistance:g,padding:p,near:a,far:h});let v=Xy();ko.multiply(v,v,this.projectionMatrix),ko.multiply(v,v,this.viewMatrix),this.viewProjectionMatrix=v,this.viewMatrixInverse=ko.invert([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=L$(this.viewMatrixInverse);let T=Xy(),C=Xy();ko.scale(T,T,[this.width/2,-this.height/2,1]),ko.translate(T,T,[1,-1,0]),ko.multiply(C,T,this.viewProjectionMatrix),this.pixelProjectionMatrix=C,this.pixelUnprojectionMatrix=ko.invert(Xy(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||Ir.warn("Pixel project matrix not invertible")()}};var cu=class e extends Bd{static{this.displayName="WebMercatorViewport"}constructor(t={}){let{latitude:r=0,longitude:i=0,zoom:s=0,pitch:n=0,bearing:o=0,nearZMultiplier:a=.1,farZMultiplier:h=1.01,nearZ:p,farZ:g,orthographic:v=!1,projectionMatrix:T,repeat:C=!1,worldOffset:B=0,position:L,padding:z,legacyMeterSizes:W=!1}=t,{width:Z,height:X,altitude:q=1.5}=t,it=Math.pow(2,s);Z=Z||1,X=X||1;let nt,Mt=null;if(T)q=T[5]/2,nt=qg(q);else{t.fovy?(nt=t.fovy,q=Yv(nt)):nt=qg(q);let Et;if(z){let{top:vt=0,bottom:Pt=0}=z;Et=[0,Xu((vt+X-Pt)/2,0,X)-X/2]}Mt=pD({width:Z,height:X,scale:it,center:L&&[0,0,L[2]*Yg(r)],offset:Et,pitch:n,fovy:nt,nearZMultiplier:a,farZMultiplier:h}),Number.isFinite(p)&&(Mt.near=p),Number.isFinite(g)&&(Mt.far=g)}let _t=Y5({height:X,pitch:n,bearing:o,scale:it,altitude:q});B&&(_t=new Os().translate([512*B,0,0]).multiplyLeft(_t)),super({...t,width:Z,height:X,viewMatrix:_t,longitude:i,latitude:r,zoom:s,...Mt,fovy:nt,focalDistance:q}),this.latitude=r,this.longitude=i,this.zoom=s,this.pitch=n,this.bearing=o,this.altitude=q,this.fovy=nt,this.orthographic=v,this._subViewports=C?[]:null,this._pseudoMeters=W,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){let t=this.getBounds(),r=Math.floor((t[0]+180)/360),i=Math.ceil((t[2]-180)/360);for(let s=r;s<=i;s++){let n=s?new e({...this,worldOffset:s}):this;this._subViewports.push(n)}}return this._subViewports}projectPosition(t){if(this._pseudoMeters)return super.projectPosition(t);let[r,i]=this.projectFlat(t),s=(t[2]||0)*Yg(t[1]);return[r,i,s]}unprojectPosition(t){if(this._pseudoMeters)return super.unprojectPosition(t);let[r,i]=this.unprojectFlat(t),s=(t[2]||0)/Yg(i);return[r,i,s]}addMetersToLngLat(t,r){return qv(t,r)}panByPosition(t,r){let i=Dm(r,this.pixelUnprojectionMatrix),s=this.projectFlat(t),n=ip.add([],s,ip.negate([],i)),o=ip.add([],this.center,n),[a,h]=this.unprojectFlat(o);return{longitude:a,latitude:h}}getBounds(t={}){let r=Z5(this,t.z||0);return[Math.min(r[0][0],r[1][0],r[2][0],r[3][0]),Math.min(r[0][1],r[1][1],r[2][1],r[3][1]),Math.max(r[0][0],r[1][0],r[2][0],r[3][0]),Math.max(r[0][1],r[1][1],r[2][1],r[3][1])]}fitBounds(t,r={}){let{width:i,height:s}=this,{longitude:n,latitude:o,zoom:a}=X5({width:i,height:s,bounds:t,...r});return new e({width:i,height:s,longitude:n,latitude:o,zoom:a})}};var V$=[0,0,0];function AD(e,t,r=!1){let i=t.projectPosition(e);if(r&&t instanceof cu){let[s,n,o=0]=e,a=t.getDistanceScales([s,n]);i[2]=o*a.unitsPerMeter[2]}return i}function I1t(e){let{viewport:t,modelMatrix:r,coordinateOrigin:i}=e,{coordinateSystem:s,fromCoordinateSystem:n,fromCoordinateOrigin:o}=e;return s===qi.DEFAULT&&(s=t.isGeospatial?qi.LNGLAT:qi.CARTESIAN),n===void 0&&(n=s),o===void 0&&(o=i),{viewport:t,coordinateSystem:s,coordinateOrigin:i,modelMatrix:r,fromCoordinateSystem:n,fromCoordinateOrigin:o}}function gD(e,{viewport:t,modelMatrix:r,coordinateSystem:i,coordinateOrigin:s,offsetMode:n}){let[o,a,h=0]=e;switch(r&&([o,a,h]=bc.transformMat4([],[o,a,h,1],r)),i){case qi.LNGLAT:return AD([o,a,h],t,n);case qi.LNGLAT_OFFSETS:return AD([o+s[0],a+s[1],h+(s[2]||0)],t,n);case qi.METER_OFFSETS:return AD(qv(s,[o,a,h]),t,n);case qi.CARTESIAN:default:return t.isGeospatial?[o+s[0],a+s[1],h+s[2]]:t.projectPosition([o,a,h])}}function j$(e,t){let{viewport:r,coordinateSystem:i,coordinateOrigin:s,modelMatrix:n,fromCoordinateSystem:o,fromCoordinateOrigin:a}=I1t(t),{autoOffset:h=!0}=t,{geospatialOrigin:p=V$,shaderCoordinateOrigin:g=V$,offsetMode:v=!1}=h?aD(r,i,s):{},T=gD(e,{viewport:r,modelMatrix:n,coordinateSystem:o,coordinateOrigin:a,offsetMode:v});if(v){let C=r.projectPosition(p||g);xc.sub(T,T,C)}return T}var M1t=1,C1t=1,Xg=class{time=0;channels=new Map;animations=new Map;playing=!1;lastEngineTime=-1;constructor(){}addChannel(t){let{delay:r=0,duration:i=Number.POSITIVE_INFINITY,rate:s=1,repeat:n=1}=t,o=M1t++,a={time:0,delay:r,duration:i,rate:s,repeat:n};return this._setChannelTime(a,this.time),this.channels.set(o,a),o}removeChannel(t){this.channels.delete(t);for(let[r,i]of this.animations)i.channel===t&&this.detachAnimation(r)}isFinished(t){let r=this.channels.get(t);return r===void 0?!1:this.time>=r.delay+r.duration*r.repeat}getTime(t){if(t===void 0)return this.time;let r=this.channels.get(t);return r===void 0?-1:r.time}setTime(t){this.time=Math.max(0,t);let r=this.channels.values();for(let s of r)this._setChannelTime(s,this.time);let i=this.animations.values();for(let s of i){let{animation:n,channel:o}=s;n.setTime(this.getTime(o))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(t,r){let i=C1t++;return this.animations.set(i,{animation:t,channel:r}),t.setTime(this.getTime(r)),i}detachAnimation(t){this.animations.delete(t)}update(t){this.playing&&(this.lastEngineTime===-1&&(this.lastEngineTime=t),this.setTime(this.time+(t-this.lastEngineTime)),this.lastEngineTime=t)}_setChannelTime(t,r){let i=r-t.delay,s=t.duration*t.repeat;i>=s?t.time=t.duration*t.rate:(t.time=Math.max(0,i)%t.duration,t.time*=t.rate)}};var P1t=0,R1t={device:null,onAddHTML:()=>"",onInitialize:async()=>null,onRender:()=>{},onFinalize:()=>{},onError:e=>console.error(e),stats:Pd.stats.get(`animation-loop-${P1t++}`),useDevicePixels:!0,autoResizeViewport:!1,autoResizeDrawingBuffer:!1},Kv=class{device=null;canvas=null;props;animationProps=null;timeline=null;stats;cpuTime;gpuTime;frameRate;display;needsRedraw="initialized";_initialized=!1;_running=!1;_animationFrameId=null;_nextFramePromise=null;_resolveNextFrame=null;_cpuStartTime=0;constructor(t){if(this.props={...R1t,...t},t=this.props,!t.device)throw new Error("No device provided");let{useDevicePixels:r=!0}=this.props;this.stats=t.stats||new _c({id:"animation-loop-stats"}),this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this.setProps({autoResizeViewport:t.autoResizeViewport,autoResizeDrawingBuffer:t.autoResizeDrawingBuffer,useDevicePixels:r}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}destroy(){this.stop(),this._setDisplay(null)}delete(){this.destroy()}setNeedsRedraw(t){return this.needsRedraw=this.needsRedraw||t,this}setProps(t){return"autoResizeViewport"in t&&(this.props.autoResizeViewport=t.autoResizeViewport||!1),"autoResizeDrawingBuffer"in t&&(this.props.autoResizeDrawingBuffer=t.autoResizeDrawingBuffer||!1),"useDevicePixels"in t&&(this.props.useDevicePixels=t.useDevicePixels||!1),this}async start(){if(this._running)return this;this._running=!0;try{let t;return this._initialized||(this._initialized=!0,await this._initDevice(),this._initialize(),await this.props.onInitialize(this._getAnimationProps())),this._running?(t!==!1&&(this._cancelAnimationFrame(),this._requestAnimationFrame()),this):null}catch(t){let r=t instanceof Error?t:new Error("Unknown error");throw this.props.onError(r),r}}stop(){return this._running&&(this.animationProps&&this.props.onFinalize(this.animationProps),this._cancelAnimationFrame(),this._nextFramePromise=null,this._resolveNextFrame=null,this._running=!1),this}redraw(){return this.device?.isLost?this:(this._beginFrameTimers(),this._setupFrame(),this._updateAnimationProps(),this._renderFrame(this._getAnimationProps()),this._clearNeedsRedraw(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endFrameTimers(),this)}attachTimeline(t){return this.timeline=t,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(t=>{this._resolveNextFrame=t})),this._nextFramePromise}async toDataURL(){if(this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.canvas instanceof HTMLCanvasElement)return this.canvas.toDataURL();throw new Error("OffscreenCanvas")}_initialize(){this._startEventHandling(),this._initializeAnimationProps(),this._updateAnimationProps(),this._resizeCanvasDrawingBuffer(),this._resizeViewport()}_setDisplay(t){this.display&&(this.display.destroy(),this.display.animationLoop=null),t&&(t.animationLoop=this),this.display=t}_requestAnimationFrame(){this._running&&(this._animationFrameId=Rk(this._animationFrame.bind(this)))}_cancelAnimationFrame(){this._animationFrameId!==null&&(kk(this._animationFrameId),this._animationFrameId=null)}_animationFrame(){this._running&&(this.redraw(),this._requestAnimationFrame())}_renderFrame(t){if(this.display){this.display._renderFrame(t);return}this.props.onRender(this._getAnimationProps()),this.device.submit()}_clearNeedsRedraw(){this.needsRedraw=!1}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport()}_initializeAnimationProps(){if(!this.device)throw new Error("loop");this.animationProps={animationLoop:this,device:this.device,canvas:this.device?.canvasContext?.canvas,timeline:this.timeline,useDevicePixels:this.props.useDevicePixels,needsRedraw:!1,width:1,height:1,aspect:1,time:0,startTime:Date.now(),engineTime:0,tick:0,tock:0,_mousePosition:null}}_getAnimationProps(){if(!this.animationProps)throw new Error("animationProps");return this.animationProps}_updateAnimationProps(){if(!this.animationProps)return;let{width:t,height:r,aspect:i}=this._getSizeAndAspect();(t!==this.animationProps.width||r!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),i!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=t,this.animationProps.height=r,this.animationProps.aspect=i,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime}async _initDevice(){if(this.device=await this.props.device,!this.device)throw new Error("No device provided");this.canvas=this.device.canvasContext?.canvas||null}_createInfoDiv(){if(this.canvas&&this.props.onAddHTML){let t=document.createElement("div");document.body.appendChild(t),t.style.position="relative";let r=document.createElement("div");r.style.position="absolute",r.style.left="10px",r.style.bottom="10px",r.style.width="300px",r.style.background="white",this.canvas instanceof HTMLCanvasElement&&t.appendChild(this.canvas),t.appendChild(r);let i=this.props.onAddHTML(r);i&&(r.innerHTML=i)}}_getSizeAndAspect(){if(!this.device)return{width:1,height:1,aspect:1};let[t,r]=this.device?.canvasContext?.getPixelSize()||[1,1],i=1,s=this.device?.canvasContext?.canvas;return s&&s.clientHeight?i=s.clientWidth/s.clientHeight:t>0&&r>0&&(i=t/r),{width:t,height:r,aspect:i}}_resizeViewport(){this.props.autoResizeViewport&&this.device.gl&&this.device.gl.viewport(0,0,this.device.gl.drawingBufferWidth,this.device.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.props.autoResizeDrawingBuffer&&this.device?.canvasContext?.resize({useDevicePixels:this.props.useDevicePixels})}_beginFrameTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this.cpuTime.timeStart()}_endFrameTimers(){this.cpuTime.timeEnd()}_startEventHandling(){this.canvas&&(this.canvas.addEventListener("mousemove",this._onMousemove.bind(this)),this.canvas.addEventListener("mouseleave",this._onMouseleave.bind(this)))}_onMousemove(t){t instanceof MouseEvent&&(this._getAnimationProps()._mousePosition=[t.offsetX,t.offsetY])}_onMouseleave(t){this._getAnimationProps()._mousePosition=null}};var J5=class{id;userData={};topology;bufferLayout=[];vertexCount;indices;attributes;constructor(t){this.id=t.id||Wl("geometry"),this.topology=t.topology,this.indices=t.indices||null,this.attributes=t.attributes,this.vertexCount=t.vertexCount,this.bufferLayout=t.bufferLayout||[],this.indices&&Qi(this.indices.usage===En.INDEX)}destroy(){this.indices?.destroy();for(let t of Object.values(this.attributes))t.destroy()}getVertexCount(){return this.vertexCount}getAttributes(){return this.attributes}getIndexes(){return this.indices}_calculateVertexCount(t){return t.byteLength/12}};function W$(e,t){if(t instanceof J5)return t;let r=k1t(e,t),{attributes:i,bufferLayout:s}=D1t(e,t);return new J5({topology:t.topology||"triangle-list",bufferLayout:s,vertexCount:t.vertexCount,indices:r,attributes:i})}function k1t(e,t){if(!t.indices)return;let r=t.indices.value;return e.createBuffer({usage:En.INDEX,data:r})}function D1t(e,t){let r=[],i={};for(let[n,o]of Object.entries(t.attributes)){let a=n;switch(n){case"POSITION":a="positions";break;case"NORMAL":a="normals";break;case"TEXCOORD_0":a="texCoords";break;case"COLOR_0":a="colors";break}i[a]=e.createBuffer({data:o.value,id:`${n}-buffer`});let{value:h,size:p,normalized:g}=o;r.push({name:a,format:Mk(h,p,g)})}let s=t._calculateVertexCount(t.attributes,t.indices);return{attributes:i,bufferLayout:r,vertexCount:s}}var tE=class{modules;moduleUniforms;moduleBindings;moduleUniformsChanged;constructor(t){let r=kg(Object.values(t).filter(i=>i.dependencies));for(let i of r)t[i.name]=i;Ce.log(1,"Creating ShaderInputs with modules",Object.keys(t))(),this.modules=t,this.moduleUniforms={},this.moduleBindings={};for(let[i,s]of Object.entries(t)){let n=i;this.moduleUniforms[n]=s.defaultUniforms||{},this.moduleBindings[n]={}}}destroy(){}setProps(t){for(let r of Object.keys(t)){let i=r,s=t[i],n=this.modules[i];if(!n){Ce.warn(`Module ${r} not found`)();continue}let o=this.moduleUniforms[i],a=n.getUniforms?.(s,this.moduleUniforms[i])||s;this.moduleUniforms[i]={...o,...a}}}getModules(){return Object.values(this.modules)}getUniformValues(){return this.moduleUniforms}getBindings(){let t={};for(let r of Object.values(this.moduleBindings))Object.assign(t,r);return t}getDebugTable(){let t={};for(let[r,i]of Object.entries(this.moduleUniforms))for(let[s,n]of Object.entries(i))t[`${r}.${s}`]={type:this.modules[r].uniformTypes?.[s],value:String(n)};return t}};var eE=class e{static defaultProps={...tp.defaultProps};device;_hashCounter=0;_hashes={};_renderPipelineCache={};_computePipelineCache={};static getDefaultPipelineFactory(t){return t._lumaData.defaultPipelineFactory=t._lumaData.defaultPipelineFactory||new e(t),t._lumaData.defaultPipelineFactory}constructor(t){this.device=t}createRenderPipeline(t){let r={...tp.defaultProps,...t},i=this._hashRenderPipeline(r);if(!this._renderPipelineCache[i]){let s=this.device.createRenderPipeline({...r,id:r.id?`${r.id}-cached`:void 0});s.hash=i,this._renderPipelineCache[i]={pipeline:s,useCount:0}}return this._renderPipelineCache[i].useCount++,this._renderPipelineCache[i].pipeline}createComputePipeline(t){let r={...ky.defaultProps,...t},i=this._hashComputePipeline(r);if(!this._computePipelineCache[i]){let s=this.device.createComputePipeline({...r,id:r.id?`${r.id}-cached`:void 0});s.hash=i,this._computePipelineCache[i]={pipeline:s,useCount:0}}return this._computePipelineCache[i].useCount++,this._computePipelineCache[i].pipeline}release(t){let r=t.hash,i=t instanceof ky?this._computePipelineCache:this._renderPipelineCache;i[r].useCount--,i[r].useCount===0&&(i[r].pipeline.destroy(),delete i[r])}_hashComputePipeline(t){return`${this._getHash(t.shader.source)}`}_hashRenderPipeline(t){let r=this._getHash(t.vs.source),i=t.fs?this._getHash(t.fs.source):0,s="-",n=this._getHash(JSON.stringify(t.bufferLayout));switch(this.device.type){case"webgl":return`${r}/${i}V${s}BL${n}`;default:let o=this._getHash(JSON.stringify(t.parameters));return`${r}/${i}V${s}T${t.topology}P${o}BL${n}`}}_getHash(t){return this._hashes[t]===void 0&&(this._hashes[t]=this._hashCounter++),this._hashes[t]}};var rE=class e{static defaultProps={...Ng.defaultProps};device;_cache={};static getDefaultShaderFactory(t){return t._lumaData.defaultShaderFactory||=new e(t),t._lumaData.defaultShaderFactory}constructor(t){this.device=t}createShader(t){let r=this._hashShader(t),i=this._cache[r];if(!i){let s=this.device.createShader({...t,id:t.id?`${t.id}-cached`:void 0});this._cache[r]=i={shader:s,useCount:0}}return i.useCount++,i.shader}release(t){let r=this._hashShader(t),i=this._cache[r];i&&(i.useCount--,i.useCount===0&&(delete this._cache[r],i.shader.destroy()))}_hashShader(t){return`${t.stage}:${t.source}`}};function $$(e,t){let r={},i="Values";if(e.attributes.length===0&&!e.varyings?.length)return{"No attributes or varyings":{[i]:"N/A"}};for(let s of e.attributes)if(s){let n=`${s.location} ${s.name}: ${s.type}`;r[`in ${n}`]={[i]:s.stepMode||"vertex"}}for(let s of e.varyings||[]){let n=`${s.location} ${s.name}`;r[`out ${n}`]={[i]:JSON.stringify(s.accessor)}}return r}var ya=null,_D=null;function H$(e,{id:t,minimap:r,opaque:i,top:s="0",left:n="0",rgbaScale:o=1}){ya||(ya=document.createElement("canvas"),ya.id=t,ya.title=t,ya.style.zIndex="100",ya.style.position="absolute",ya.style.top=s,ya.style.left=n,ya.style.border="blue 1px solid",ya.style.transform="scaleY(-1)",document.body.appendChild(ya),_D=ya.getContext("2d")),(ya.width!==e.width||ya.height!==e.height)&&(ya.width=e.width/2,ya.height=e.height/2,ya.style.width="400px",ya.style.height="400px");let a=e.device.readPixelsToArrayWebGL(e),h=_D.createImageData(e.width,e.height),p=0;for(let g=0;g<a.length;g+=4)h.data[p+g+0]=a[g+0]*o,h.data[p+g+1]=a[g+1]*o,h.data[p+g+2]=a[g+2]*o,h.data[p+g+3]=i?255:a[g+3]*o;_D.putImageData(h,0,0)}var Zy=2,O1t=1e4,to=class e{static defaultProps={...tp.defaultProps,source:null,vs:null,fs:null,id:"unnamed",handle:void 0,userData:{},defines:{},modules:[],moduleSettings:void 0,geometry:null,indexBuffer:null,attributes:{},constantAttributes:{},varyings:[],isInstanced:void 0,instanceCount:0,vertexCount:0,shaderInputs:void 0,pipelineFactory:void 0,shaderFactory:void 0,transformFeedback:void 0,shaderAssembler:Dg.getDefaultShaderAssembler(),debugShaders:void 0,disableWarnings:void 0};device;id;source;vs;fs;pipelineFactory;shaderFactory;userData={};parameters;topology;bufferLayout;isInstanced=void 0;instanceCount=0;vertexCount;indexBuffer=null;bufferAttributes={};constantAttributes={};bindings={};uniforms={};vertexArray;transformFeedback=null;pipeline;shaderInputs;_uniformStore;_attributeInfos={};_gpuGeometry=null;_getModuleUniforms;props;_pipelineNeedsUpdate="newly created";_needsRedraw="initializing";_destroyed=!1;_lastDrawTimestamp=-1;constructor(t,r){this.props={...e.defaultProps,...r},r=this.props,this.id=r.id||Wl("model"),this.device=t,Object.assign(this.userData,r.userData);let i=Object.fromEntries(this.props.modules?.map(a=>[a.name,a])||[]);this.setShaderInputs(r.shaderInputs||new tE(i));let s=B1t(t),n=(this.props.modules?.length>0?this.props.modules:this.shaderInputs?.getModules())||[];if(this.device.type==="webgpu"&&this.props.source){this.props.shaderLayout||=p7(this.props.source);let{source:a,getUniforms:h}=this.props.shaderAssembler.assembleShader({platformInfo:s,...this.props,modules:n});this.source=a,this._getModuleUniforms=h}else{let{vs:a,fs:h,getUniforms:p}=this.props.shaderAssembler.assembleShaderPair({platformInfo:s,...this.props,modules:n});this.vs=a,this.fs=h,this._getModuleUniforms=p}this.vertexCount=this.props.vertexCount,this.instanceCount=this.props.instanceCount,this.topology=this.props.topology,this.bufferLayout=this.props.bufferLayout,this.parameters=this.props.parameters,r.geometry&&this.setGeometry(r.geometry),this.pipelineFactory=r.pipelineFactory||eE.getDefaultPipelineFactory(this.device),this.shaderFactory=r.shaderFactory||rE.getDefaultShaderFactory(this.device),this.pipeline=this._updatePipeline(),this.vertexArray=t.createVertexArray({renderPipeline:this.pipeline}),this._gpuGeometry&&this._setGeometryAttributes(this._gpuGeometry),"isInstanced"in r&&(this.isInstanced=r.isInstanced),r.instanceCount&&this.setInstanceCount(r.instanceCount),r.vertexCount&&this.setVertexCount(r.vertexCount),r.indexBuffer&&this.setIndexBuffer(r.indexBuffer),r.attributes&&this.setAttributes(r.attributes),r.constantAttributes&&this.setConstantAttributes(r.constantAttributes),r.bindings&&this.setBindings(r.bindings),r.uniforms&&this.setUniforms(r.uniforms),r.moduleSettings&&this.updateModuleSettings(r.moduleSettings),r.transformFeedback&&(this.transformFeedback=r.transformFeedback),Object.seal(this)}destroy(){this._destroyed||(this.pipelineFactory.release(this.pipeline),this.shaderFactory.release(this.pipeline.vs),this.pipeline.fs&&this.shaderFactory.release(this.pipeline.fs),this._uniformStore.destroy(),this._gpuGeometry?.destroy(),this._destroyed=!0)}needsRedraw(){this._getBindingsUpdateTimestamp()>this._lastDrawTimestamp&&this.setNeedsRedraw("contents of bound textures or buffers updated");let t=this._needsRedraw;return this._needsRedraw=!1,t}setNeedsRedraw(t){this._needsRedraw||=t}predraw(){this.updateShaderInputs(),this.pipeline=this._updatePipeline()}draw(t){this.predraw();let r;try{this._logDrawCallStart(),this.pipeline=this._updatePipeline(),this.pipeline.setBindings(this.bindings,{disableWarnings:this.props.disableWarnings}),Em(this.uniforms)||this.pipeline.setUniformsWebGL(this.uniforms);let{indexBuffer:i}=this.vertexArray,s=i?i.byteLength/(i.indexType==="uint32"?4:2):void 0;r=this.pipeline.draw({renderPass:t,vertexArray:this.vertexArray,isInstanced:this.isInstanced,vertexCount:this.vertexCount,instanceCount:this.instanceCount,indexCount:s,transformFeedback:this.transformFeedback||void 0,parameters:this.parameters,topology:this.topology})}finally{this._logDrawCallEnd()}return this._logFramebuffer(t),r?(this._lastDrawTimestamp=this.device.timestamp,this._needsRedraw=!1):this._needsRedraw="waiting for resource initialization",r}setGeometry(t){this._gpuGeometry?.destroy();let r=t&&W$(this.device,t);r&&(this.setTopology(r.topology||"triangle-list"),this.bufferLayout=q$(r.bufferLayout,this.bufferLayout),this.vertexArray&&this._setGeometryAttributes(r)),this._gpuGeometry=r}setTopology(t){t!==this.topology&&(this.topology=t,this._setPipelineNeedsUpdate("topology"))}setBufferLayout(t){this.bufferLayout=this._gpuGeometry?q$(t,this._gpuGeometry.bufferLayout):t,this._setPipelineNeedsUpdate("bufferLayout"),this.pipeline=this._updatePipeline(),this.vertexArray=this.device.createVertexArray({renderPipeline:this.pipeline}),this._gpuGeometry&&this._setGeometryAttributes(this._gpuGeometry)}setParameters(t){Ov(t,this.parameters,2)||(this.parameters=t,this._setPipelineNeedsUpdate("parameters"))}setInstanceCount(t){this.instanceCount=t,this.isInstanced===void 0&&t>0&&(this.isInstanced=!0),this.setNeedsRedraw("instanceCount")}setVertexCount(t){this.vertexCount=t,this.setNeedsRedraw("vertexCount")}setShaderInputs(t){this.shaderInputs=t,this._uniformStore=new Pv(this.shaderInputs.modules);for(let r of Object.keys(this.shaderInputs.modules)){let i=this._uniformStore.getManagedUniformBuffer(this.device,r);this.bindings[`${r}Uniforms`]=i}this.setNeedsRedraw("shaderInputs")}updateShaderInputs(){this._uniformStore.setUniforms(this.shaderInputs.getUniformValues()),this.setNeedsRedraw("shaderInputs")}setBindings(t){Object.assign(this.bindings,t),this.setNeedsRedraw("bindings")}setTransformFeedback(t){this.transformFeedback=t,this.setNeedsRedraw("transformFeedback")}setIndexBuffer(t){this.vertexArray.setIndexBuffer(t),this.setNeedsRedraw("indexBuffer")}setAttributes(t,r){t.indices&&Ce.warn(`Model:${this.id} setAttributes() - indexBuffer should be set using setIndexBuffer()`)();for(let[i,s]of Object.entries(t)){let n=this.bufferLayout.find(h=>Y$(h).includes(i));if(!n){Ce.warn(`Model(${this.id}): Missing layout for buffer "${i}".`)();continue}let o=Y$(n),a=!1;for(let h of o){let p=this._attributeInfos[h];p&&(this.vertexArray.setBuffer(p.location,s),a=!0)}!a&&!(r?.disableWarnings??this.props.disableWarnings)&&Ce.warn(`Model(${this.id}): Ignoring buffer "${s.id}" for unknown attribute "${i}"`)()}this.setNeedsRedraw("attributes")}setConstantAttributes(t,r){for(let[i,s]of Object.entries(t)){let n=this._attributeInfos[i];n?this.vertexArray.setConstantWebGL(n.location,s):(r?.disableWarnings??this.props.disableWarnings)||Ce.warn(`Model "${this.id}: Ignoring constant supplied for unknown attribute "${i}"`)()}this.setNeedsRedraw("constants")}setUniforms(t){Em(t)||(this.pipeline.setUniformsWebGL(t),Object.assign(this.uniforms,t)),this.setNeedsRedraw("uniforms")}updateModuleSettings(t){let{bindings:r,uniforms:i}=kv(this._getModuleUniforms(t));Object.assign(this.bindings,r),Object.assign(this.uniforms,i),this.setNeedsRedraw("moduleSettings")}_getBindingsUpdateTimestamp(){let t=0;for(let r of Object.values(this.bindings))r instanceof Bg?t=Math.max(t,r.texture.updateTimestamp):r instanceof En||r instanceof jo?t=Math.max(t,r.updateTimestamp):r instanceof Lg||(t=Math.max(t,r.buffer.updateTimestamp));return t}_setGeometryAttributes(t){let r={...t.attributes};for(let[i]of Object.entries(r))!this.pipeline.shaderLayout.attributes.find(s=>s.name===i)&&i!=="positions"&&delete r[i];this.vertexCount=t.vertexCount,this.setIndexBuffer(t.indices||null),this.setAttributes(t.attributes,{disableWarnings:!0}),this.setAttributes(r,{disableWarnings:this.props.disableWarnings}),this.setNeedsRedraw("geometry attributes")}_setPipelineNeedsUpdate(t){this._pipelineNeedsUpdate||=t,this.setNeedsRedraw(t)}_updatePipeline(){if(this._pipelineNeedsUpdate){let t=null,r=null;this.pipeline&&(Ce.log(1,`Model ${this.id}: Recreating pipeline because "${this._pipelineNeedsUpdate}".`)(),t=this.pipeline.vs,r=this.pipeline.fs),this._pipelineNeedsUpdate=!1;let i=this.shaderFactory.createShader({id:`${this.id}-vertex`,stage:"vertex",source:this.source||this.vs,debug:this.props.debugShaders}),s=null;this.source?s=i:this.fs&&(s=this.shaderFactory.createShader({id:`${this.id}-fragment`,stage:"fragment",source:this.source||this.fs,debug:this.props.debugShaders})),this.pipeline=this.pipelineFactory.createRenderPipeline({...this.props,bufferLayout:this.bufferLayout,topology:this.topology,parameters:this.parameters,vs:i,fs:s}),this._attributeInfos=l5(this.pipeline.shaderLayout,this.bufferLayout),t&&this.shaderFactory.release(t),r&&this.shaderFactory.release(r)}return this.pipeline}_lastLogTime=0;_logOpen=!1;_logDrawCallStart(){let t=Ce.level>3?0:O1t;Ce.level<2||Date.now()-this._lastLogTime<t||(this._lastLogTime=Date.now(),this._logOpen=!0,Ce.group(Zy,`>>> DRAWING MODEL ${this.id}`,{collapsed:Ce.level<=2})())}_logDrawCallEnd(){if(this._logOpen){let t=$$(this.pipeline.shaderLayout,this.id);Ce.table(Zy,t)();let r=this.shaderInputs.getDebugTable();for(let[s,n]of Object.entries(this.uniforms))r[s]={value:n};Ce.table(Zy,r)();let i=this._getAttributeDebugTable();Ce.table(Zy,this._attributeInfos)(),Ce.table(Zy,i)(),Ce.groupEnd(Zy)(),this._logOpen=!1}}_drawCount=0;_logFramebuffer(t){let r=Ce.get("framebuffer");if(this._drawCount++,!r||this._drawCount++>3&&this._drawCount%60)return;let i=t.props.framebuffer;i&&H$(i,{id:i.id,minimap:!0})}_getAttributeDebugTable(){let t={};for(let[r,i]of Object.entries(this._attributeInfos))t[i.location]={name:r,type:i.shaderType,values:this._getBufferOrConstantValues(this.vertexArray.attributes[i.location],i.bufferDataType)};if(this.vertexArray.indexBuffer){let{indexBuffer:r}=this.vertexArray,i=r.indexType==="uint32"?new Uint32Array(r.debugData):new Uint16Array(r.debugData);t.indices={name:"indices",type:r.indexType,values:i.toString()}}return t}_getBufferOrConstantValues(t,r){let i=Rv(r);return(t instanceof En?new i(t.debugData):t).toString()}};function q$(e,t){let r=[...e];for(let i of t){let s=r.findIndex(n=>n.name===i.name);s<0?r.push(i):r[s]=i}return r}function B1t(e){return{type:e.type,shaderLanguage:e.info.shadingLanguage,shaderLanguageVersion:e.info.shadingLanguageVersion,gpu:e.info.gpu,features:e.features}}function Y$(e){return e.attributes?e.attributes?.map(t=>t.attribute):[e.name]}var Om=class e{device;model;transformFeedback;static isSupported(t){return t?.info?.type==="webgl"}constructor(t,r=to.defaultProps){Qi(e.isSupported(t),"BufferTransform not yet implemented on WebGPU"),this.device=t,this.model=new to(this.device,{id:r.id||"buffer-transform-model",fs:r.fs||xk(),topology:r.topology||"point-list",...r}),this.transformFeedback=this.device.createTransformFeedback({layout:this.model.pipeline.shaderLayout,buffers:r.feedbackBuffers}),this.model.setTransformFeedback(this.transformFeedback),Object.seal(this)}destroy(){this.model&&this.model.destroy()}delete(){this.destroy()}run(t){let r=this.device.beginRenderPass(t);this.model.draw(r),r.end()}update(...t){console.warn("TextureTransform#update() not implemented")}getBuffer(t){return this.transformFeedback.getBuffer(t)}readAsync(t){let r=this.getBuffer(t);if(r instanceof En)return r.readAsync();let{buffer:i,byteOffset:s=0,byteLength:n=i.byteLength}=r;return i.readAsync(s,n)}};var _l=class{id;topology;vertexCount;indices;attributes;userData={};constructor(t){let{attributes:r={},indices:i=null,vertexCount:s=null}=t;this.id=t.id||Wl("geometry"),this.topology=t.topology,i&&(this.indices=ArrayBuffer.isView(i)?{value:i,size:1}:i),this.attributes={};for(let[n,o]of Object.entries(r)){let a=ArrayBuffer.isView(o)?{value:o}:o;Qi(ArrayBuffer.isView(a.value),`${this._print(n)}: must be typed array or object with value as typed array`),(n==="POSITION"||n==="positions")&&!a.size&&(a.size=3),n==="indices"?(Qi(!this.indices),this.indices=a):this.attributes[n]=a}this.indices&&this.indices.isIndexed!==void 0&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this.vertexCount=s||this._calculateVertexCount(this.attributes,this.indices)}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(t){return`Geometry ${this.id} attribute ${t}`}_setAttributes(t,r){return this}_calculateVertexCount(t,r){if(r)return r.value.length;let i=1/0;for(let s of Object.values(t)){let{value:n,size:o,constant:a}=s;!a&&n&&o>=1&&(i=Math.min(i,n.length/o))}return Qi(Number.isFinite(i)),i}};var N1t={blendColorOperation:"add",blendColorSrcFactor:"one",blendColorDstFactor:"zero",blendAlphaOperation:"add",blendAlphaSrcFactor:"constant-alpha",blendAlphaDstFactor:"zero"},Zg=class extends Od{constructor(){super(...arguments),this._colorEncoderState=null}render(t){return"pickingFBO"in t?this._drawPickingBuffer(t):super.render(t)}_drawPickingBuffer({layers:t,layerFilter:r,views:i,viewports:s,onViewportActive:n,pickingFBO:o,deviceRect:{x:a,y:h,width:p,height:g},cullRect:v,effects:T,pass:C="picking",pickZ:B,moduleParameters:L}){this.pickZ=B;let z=this._resetColorEncoder(B),W=[a,h,p,g],Z=super.render({target:o,layers:t,layerFilter:r,views:i,viewports:s,onViewportActive:n,cullRect:v,effects:T?.filter(q=>q.useInPicking),pass:C,isPicking:!0,moduleParameters:L,clearColor:[0,0,0,0],colorMask:15,scissorRect:W});return this._colorEncoderState=null,{decodePickingColor:z&&F1t.bind(null,z),stats:Z}}shouldDrawLayer(t){let{pickable:r,operation:i}=t.props;return r&&i.includes("draw")||i.includes("terrain")||i.includes("mask")}getModuleParameters(){return{picking:{isActive:1,isAttribute:this.pickZ},lightSources:{}}}getLayerParameters(t,r,i){let s={depthMask:!0,depthTest:!0,depthRange:[0,1],...t.props.parameters},{pickable:n,operation:o}=t.props;return!this._colorEncoderState||o.includes("terrain")?s.blend=!1:n&&o.includes("draw")&&(Object.assign(s,N1t),s.blend=!0,s.blendColor=L1t(this._colorEncoderState,t,i)),s}_resetColorEncoder(t){return this._colorEncoderState=t?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}};function L1t(e,t,r){let{byLayer:i,byAlpha:s}=e,n,o=i.get(t);return o?(o.viewports.push(r),n=o.a):(n=i.size+1,n<=255?(o={a:n,layer:t,viewports:[r]},i.set(t,o),s[n]=o):(Ir.warn("Too many pickable layers, only picking the first 255")(),n=0)),[0,0,0,n/255]}function F1t(e,t){let r=e.byAlpha[t[3]];return r&&{pickedLayer:r.layer,pickedViewports:r.viewports,pickedObjectIndex:r.layer.decodePickingColor(t)}}var Bm={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},Gy=Symbol.for("component"),Qu=Symbol.for("propTypes"),iE=Symbol.for("deprecatedProps"),Nd=Symbol.for("asyncPropDefaults"),sp=Symbol.for("asyncPropOriginal"),Qh=Symbol.for("asyncPropResolved");function vc(e,t=()=>!0){return Array.isArray(e)?X$(e,t,[]):t(e)?[e]:[]}function X$(e,t,r){let i=-1;for(;++i<e.length;){let s=e[i];Array.isArray(s)?X$(s,t,r):t(s)&&r.push(s)}return r}function yD({target:e,source:t,start:r=0,count:i=1}){let s=t.length,n=i*s,o=0;for(let a=r;o<s;o++)e[a++]=t[o];for(;o<n;)o<n-o?(e.copyWithin(r+o,r,r+o),o*=2):(e.copyWithin(r+o,r,r+n-o),o=n);return e}var Jv=class{constructor(t,r,i){this._loadCount=0,this._subscribers=new Set,this.id=t,this.context=i,this.setData(r)}subscribe(t){this._subscribers.add(t)}unsubscribe(t){this._subscribers.delete(t)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(t,r){if(t===this._data&&!r)return;this._data=t;let i=++this._loadCount,s=t;typeof t=="string"&&(s=Tm(t)),s instanceof Promise?(this.isLoaded=!1,this._loader=s.then(n=>{this._loadCount===i&&(this.isLoaded=!0,this._error=void 0,this._content=n)}).catch(n=>{this._loadCount===i&&(this.isLoaded=!0,this._error=n||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=t);for(let n of this._subscribers)n.onChange(this.getData())}};var tw=class{constructor(t){this.protocol=t.protocol||"resource://",this._context={device:t.device,gl:t.device?.gl,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(t){return t.startsWith(this.protocol)?!0:t in this._resources}add({resourceId:t,data:r,forceUpdate:i=!1,persistent:s=!0}){let n=this._resources[t];n?n.setData(r,i):(n=new Jv(t,r,this._context),this._resources[t]=n),n.persistent=s}remove(t){let r=this._resources[t];r&&(r.delete(),delete this._resources[t])}unsubscribe({consumerId:t}){let r=this._consumers[t];if(r){for(let i in r){let s=r[i],n=this._resources[s.resourceId];n&&n.unsubscribe(s)}delete this._consumers[t],this.prune()}}subscribe({resourceId:t,onChange:r,consumerId:i,requestId:s="default"}){let{_resources:n,protocol:o}=this;t.startsWith(o)&&(t=t.replace(o,""),n[t]||this.add({resourceId:t,data:null,persistent:!1}));let a=n[t];if(this._track(i,s,a,r),a)return a.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(let t in this._resources)this._resources[t].delete()}_track(t,r,i,s){let n=this._consumers,o=n[t]=n[t]||{},a=o[r],h=a&&a.resourceId&&this._resources[a.resourceId];h&&(h.unsubscribe(a),this.prune()),i&&(a?(a.onChange=s,a.resourceId=i.id):a={onChange:s,resourceId:i.id},o[r]=a,i.subscribe(a))}_prune(){this._pruneRequest=null;for(let t of Object.keys(this._resources)){let r=this._resources[t];!r.persistent&&!r.inUse()&&(r.delete(),delete this._resources[t])}}};var z1t="layerManager.setLayers",U1t="layerManager.activateViewport",ew=class{constructor(t,r){this._lastRenderedLayers=[],this._needsRedraw=!1,this._needsUpdate=!1,this._nextLayers=null,this._debug=!1,this._defaultShaderModulesChanged=!1,this.activateViewport=a=>{ho(U1t,this,a),a&&(this.context.viewport=a)};let{deck:i,stats:s,viewport:n,timeline:o}=r||{};this.layers=[],this.resourceManager=new tw({device:t,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,device:t,gl:t?.gl,deck:i,shaderAssembler:D$(),defaultShaderModules:[],renderPass:void 0,stats:s||new _c({id:"deck.gl"}),viewport:n||new Bd({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:o||new Xg,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(let t of this.layers)this._finalizeLayer(t)}needsRedraw(t={clearRedrawFlags:!1}){let r=this._needsRedraw;t.clearRedrawFlags&&(this._needsRedraw=!1);for(let i of this.layers){let s=i.getNeedsRedraw(t);r=r||s}return r}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._defaultShaderModulesChanged?"shader modules changed":this._needsUpdate}setNeedsRedraw(t){this._needsRedraw=this._needsRedraw||t}setNeedsUpdate(t){this._needsUpdate=this._needsUpdate||t}getLayers({layerIds:t}={}){return t?this.layers.filter(r=>t.find(i=>r.id.indexOf(i)===0)):this.layers}setProps(t){"debug"in t&&(this._debug=t.debug),"userData"in t&&(this.context.userData=t.userData),"layers"in t&&(this._nextLayers=t.layers),"onError"in t&&(this.context.onError=t.onError)}setLayers(t,r){ho(z1t,this,r,t),this._lastRenderedLayers=t;let i=vc(t,Boolean);for(let s of i)s.context=this.context;this._updateLayers(this.layers,i)}updateLayers(){let t=this.needsUpdate();t&&(this.setNeedsRedraw(`updating layers: ${t}`),this.setLayers(this._nextLayers||this._lastRenderedLayers,t)),this._nextLayers=null}addDefaultShaderModule(t){let{defaultShaderModules:r}=this.context;r.find(i=>i.name===t.name)||(r.push(t),this._defaultShaderModulesChanged=!0)}removeDefaultShaderModule(t){let{defaultShaderModules:r}=this.context,i=r.findIndex(s=>s.name===t.name);i>=0&&(r.splice(i,1),this._defaultShaderModulesChanged=!0)}_handleError(t,r,i){i.raiseError(r,`${t} of ${i}`)}_updateLayers(t,r){let i={};for(let o of t)i[o.id]?Ir.warn(`Multiple old layers with same id ${o.id}`)():i[o.id]=o;if(this._defaultShaderModulesChanged){for(let o of t)o.setNeedsUpdate(),o.setChangeFlags({extensionsChanged:!0});this._defaultShaderModulesChanged=!1}let s=[];this._updateSublayersRecursively(r,i,s),this._finalizeOldLayers(i);let n=!1;for(let o of s)if(o.hasUniformTransition()){n=`Uniform transition in ${o}`;break}this._needsUpdate=n,this.layers=s}_updateSublayersRecursively(t,r,i){for(let s of t){s.context=this.context;let n=r[s.id];n===null&&Ir.warn(`Multiple new layers with same id ${s.id}`)(),r[s.id]=null;let o=null;try{this._debug&&n!==s&&s.validateProps(),n?(this._transferLayerState(n,s),this._updateLayer(s)):this._initializeLayer(s),i.push(s),o=s.isComposite?s.getSubLayers():null}catch(a){this._handleError("matching",a,s)}o&&this._updateSublayersRecursively(o,r,i)}}_finalizeOldLayers(t){for(let r in t){let i=t[r];i&&this._finalizeLayer(i)}}_initializeLayer(t){try{t._initialize(),t.lifecycle=Bm.INITIALIZED}catch(r){this._handleError("initialization",r,t)}}_transferLayerState(t,r){r._transferState(t),r.lifecycle=Bm.MATCHED,r!==t&&(t.lifecycle=Bm.AWAITING_GC)}_updateLayer(t){try{t._update()}catch(r){this._handleError("update",r,t)}}_finalizeLayer(t){this._needsRedraw=this._needsRedraw||`finalized ${t}`,t.lifecycle=Bm.AWAITING_FINALIZATION;try{t._finalize(),t.lifecycle=Bm.FINALIZED}catch(r){this._handleError("finalization",r,t)}}};function ja(e,t,r){if(e===t)return!0;if(!r||!e||!t)return!1;if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(!ja(e[i],t[i],r-1))return!1;return!0}if(Array.isArray(t))return!1;if(typeof e=="object"&&typeof t=="object"){let i=Object.keys(e),s=Object.keys(t);if(i.length!==s.length)return!1;for(let n of i)if(!t.hasOwnProperty(n)||!ja(e[n],t[n],r-1))return!1;return!0}return!1}var rw=class{constructor(t){this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=t.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=t.eventManager,this._eventCallbacks={onViewStateChange:t.onViewStateChange,onInteractionStateChange:t.onInteractionStateChange},Object.seal(this),this.setProps(t)}finalize(){for(let t in this.controllers){let r=this.controllers[t];r&&r.finalize()}this.controllers={}}needsRedraw(t={clearRedrawFlags:!1}){let r=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),r}setNeedsUpdate(t){this._needsUpdate=this._needsUpdate||t,this._needsRedraw=this._needsRedraw||t}updateViewStates(){for(let t in this.controllers){let r=this.controllers[t];r&&r.updateTransition()}}getViewports(t){return t?this._viewports.filter(r=>r.containsPixel(t)):this._viewports}getViews(){let t={};return this.views.forEach(r=>{t[r.id]=r}),t}getView(t){return this.views.find(r=>r.id===t)}getViewState(t){let r=typeof t=="string"?this.getView(t):t,i=r&&this.viewState[r.getViewStateId()]||this.viewState;return r?r.filterViewState(i):i}getViewport(t){return this._viewportMap[t]}unproject(t,r){let i=this.getViewports(),s={x:t[0],y:t[1]};for(let n=i.length-1;n>=0;--n){let o=i[n];if(o.containsPixel(s)){let a=t.slice();return a[0]-=o.x,a[1]-=o.y,o.unproject(a,r)}}return null}setProps(t){t.views&&this._setViews(t.views),t.viewState&&this._setViewState(t.viewState),("width"in t||"height"in t)&&this._setSize(t.width,t.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(t,r){(t!==this.width||r!==this.height)&&(this.width=t,this.height=r,this.setNeedsUpdate("Size changed"))}_setViews(t){t=vc(t,Boolean),this._diffViews(t,this.views)&&this.setNeedsUpdate("views changed"),this.views=t}_setViewState(t){t?(!ja(t,this.viewState,3)&&this.setNeedsUpdate("viewState changed"),this.viewState=t):Ir.warn("missing `viewState` or `initialViewState`")()}_createController(t,r){let i=r.type;return new i({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._eventCallbacks.onViewStateChange,onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:n=>this.getView(t.id)?.makeViewport({viewState:n,width:this.width,height:this.height})})}_updateController(t,r,i,s){let n=t.controller;if(n&&i){let o={...r,...n,id:t.id,x:i.x,y:i.y,width:i.width,height:i.height};return(!s||s.constructor!==n.type)&&(s=this._createController(t,o)),s&&s.setProps(o),s}return null}_rebuildViewports(){let{views:t}=this,r=this.controllers;this._viewports=[],this.controllers={};let i=!1;for(let s=t.length;s--;){let n=t[s],o=this.getViewState(n),a=n.makeViewport({viewState:o,width:this.width,height:this.height}),h=r[n.id],p=!!n.controller;p&&!h&&(i=!0),(i||!p)&&h&&(h.finalize(),h=null),this.controllers[n.id]=this._updateController(n,o,a,h),a&&this._viewports.unshift(a)}for(let s in r){let n=r[s];n&&!this.controllers[s]&&n.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(t=>{t.id&&(this._viewportMap[t.id]=this._viewportMap[t.id]||t)})}_diffViews(t,r){return t.length!==r.length?!0:t.some((i,s)=>!t[s].equals(r[s]))}};var V1t=/([0-9]+\.?[0-9]*)(%|px)/;function Ld(e){switch(typeof e){case"number":return{position:e,relative:!1};case"string":let t=V1t.exec(e);if(t&&t.length>=3){let r=t[2]==="%",i=parseFloat(t[1]);return{position:r?i/100:i,relative:r}}default:throw new Error(`Could not parse position string ${e}`)}}function Fd(e,t){return e.relative?Math.round(e.position*t):e.position}var iw=class{constructor(t){let{id:r,x:i=0,y:s=0,width:n="100%",height:o="100%",padding:a=null}=t;this.id=r||this.constructor.displayName||"view",this.props={...t,id:this.id},this._x=Ld(i),this._y=Ld(s),this._width=Ld(n),this._height=Ld(o),this._padding=a&&{left:Ld(a.left||0),right:Ld(a.right||0),top:Ld(a.top||0),bottom:Ld(a.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(t){return this===t?!0:this.ViewportType===t.ViewportType&&ja(this.props,t.props,2)}makeViewport({width:t,height:r,viewState:i}){i=this.filterViewState(i);let s=this.getDimensions({width:t,height:r});return!s.height||!s.width?null:new this.ViewportType({...i,...this.props,...s})}getViewStateId(){let{viewState:t}=this.props;return typeof t=="string"?t:t?.id||this.id}filterViewState(t){if(this.props.viewState&&typeof this.props.viewState=="object"){if(!this.props.viewState.id)return this.props.viewState;let r={...t};for(let i in this.props.viewState)i!=="id"&&(r[i]=this.props.viewState[i]);return r}return t}getDimensions({width:t,height:r}){let i={x:Fd(this._x,t),y:Fd(this._y,r),width:Fd(this._width,t),height:Fd(this._height,r)};return this._padding&&(i.padding={left:Fd(this._padding.left,t),top:Fd(this._padding.top,r),right:Fd(this._padding.right,t),bottom:Fd(this._padding.bottom,r)}),i}get controller(){let t=this.props.controller;return t?t===!0?{type:this.ControllerType}:typeof t=="function"?{type:t}:{type:this.ControllerType,...t}:null}};var Kh=class{constructor(t){this._inProgress=!1,this._handle=null,this.time=0,this.settings={duration:0},this._timeline=t}get inProgress(){return this._inProgress}start(t){this.cancel(),this.settings=t,this._inProgress=!0,this.settings.onStart?.(this)}end(){this._inProgress&&(this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,this.settings.onEnd?.(this))}cancel(){this._inProgress&&(this.settings.onInterrupt?.(this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1)}update(){if(!this._inProgress)return!1;if(this._handle===null){let{_timeline:t,settings:r}=this;this._handle=t.addChannel({delay:t.getTime(),duration:r.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),this.settings.onUpdate?.(this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}};var Z$=()=>{},xD={BREAK:1,SNAP_TO_END:2,IGNORE:3},j1t=e=>e,W1t=xD.BREAK,nw=class{constructor(t){this._onTransitionUpdate=r=>{let{time:i,settings:{interpolator:s,startProps:n,endProps:o,duration:a,easing:h}}=r,p=h(i/a),g=s.interpolateProps(n,o,p);this.propsInTransition=this.getControllerState({...this.props,...g}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})},this.getControllerState=t.getControllerState,this.propsInTransition=null,this.transition=new Kh(t.timeline),this.onViewStateChange=t.onViewStateChange||Z$,this.onStateChange=t.onStateChange||Z$}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(t){let r=!1,i=this.props;if(this.props=t,!i||this._shouldIgnoreViewportChange(i,t))return!1;if(this._isTransitionEnabled(t)){let s=i;if(this.transition.inProgress){let{interruption:n,endProps:o}=this.transition.settings;s={...i,...n===xD.SNAP_TO_END?o:this.propsInTransition||i}}this._triggerTransition(s,t),r=!0}else this.transition.cancel();return r}updateTransition(){this.transition.update()}_isTransitionEnabled(t){let{transitionDuration:r,transitionInterpolator:i}=t;return(r>0||r==="auto")&&!!i}_isUpdateDueToCurrentTransition(t){return this.transition.inProgress&&this.propsInTransition?this.transition.settings.interpolator.arePropsEqual(t,this.propsInTransition):!1}_shouldIgnoreViewportChange(t,r){return this.transition.inProgress?this.transition.settings.interruption===xD.IGNORE||this._isUpdateDueToCurrentTransition(r):this._isTransitionEnabled(r)?r.transitionInterpolator.arePropsEqual(t,r):!0}_triggerTransition(t,r){let i=this.getControllerState(t),s=this.getControllerState(r).shortestPathFrom(i),n=r.transitionInterpolator,o=n.getDuration?n.getDuration(t,r):r.transitionDuration;if(o===0)return;let a=n.initializeProps(t,s);this.propsInTransition={};let h={duration:o,easing:r.transitionEasing||j1t,interpolator:n,interruption:r.transitionInterruption||W1t,startProps:a.start,endProps:a.end,onStart:r.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(r.onTransitionInterrupt),onEnd:this._onTransitionEnd(r.onTransitionEnd)};this.transition.start(h),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(t){return r=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),t?.(r)}}};function Jn(e,t){if(!e)throw new Error(t||"deck.gl: assertion failed.")}var sw=class{constructor(t){let{compare:r,extract:i,required:s}=t;this._propsToCompare=r,this._propsToExtract=i||r,this._requiredProps=s}arePropsEqual(t,r){for(let i of this._propsToCompare)if(!(i in t)||!(i in r)||!$l(t[i],r[i]))return!1;return!0}initializeProps(t,r){let i={},s={};for(let n of this._propsToExtract)(n in t||n in r)&&(i[n]=t[n],s[n]=r[n]);return this._checkRequiredProps(i),this._checkRequiredProps(s),{start:i,end:s}}getDuration(t,r){return r.transitionDuration}_checkRequiredProps(t){this._requiredProps&&this._requiredProps.forEach(r=>{let i=t[r];Jn(Number.isFinite(i)||Array.isArray(i),`${r} is required for transition`)})}};var $1t=["longitude","latitude","zoom","bearing","pitch"],H1t=["longitude","latitude","zoom"],Gg=class extends sw{constructor(t={}){let r=Array.isArray(t)?t:t.transitionProps,i=Array.isArray(t)?{}:t;i.transitionProps=Array.isArray(r)?{compare:r,required:r}:r||{compare:$1t,required:H1t},super(i.transitionProps),this.opts=i}initializeProps(t,r){let i=super.initializeProps(t,r),{makeViewport:s,around:n}=this.opts;if(s&&n){let o=s(t),a=s(r),h=o.unproject(n);i.start.around=n,Object.assign(i.end,{around:a.project(h),aroundPosition:h,width:r.width,height:r.height})}return i}interpolateProps(t,r,i){let s={};for(let n of this._propsToExtract)s[n]=yc(t[n]||0,r[n]||0,i);if(r.aroundPosition&&this.opts.makeViewport){let n=this.opts.makeViewport({...r,...s});Object.assign(s,n.panByPosition(r.aroundPosition,yc(t.around,r.around,i)))}return s}};var Nm={transitionDuration:0},q1t=300,nE=e=>1-(1-e)*(1-e),Qy={WHEEL:["wheel"],PAN:["panstart","panmove","panend"],PINCH:["pinchstart","pinchmove","pinchend"],TRIPLE_PAN:["tripanstart","tripanmove","tripanend"],DOUBLE_TAP:["doubletap"],KEYBOARD:["keydown"]},Qg={},ow=class{constructor(t){this.state={},this._events={},this._interactionState={isDragging:!1},this._customEvents=[],this._eventStartBlocked=null,this._panMove=!1,this.invertPan=!1,this.dragMode="rotate",this.inertia=0,this.scrollZoom=!0,this.dragPan=!0,this.dragRotate=!0,this.doubleClickZoom=!0,this.touchZoom=!0,this.touchRotate=!1,this.keyboard=!0,this.transitionManager=new nw({...t,getControllerState:r=>new this.ControllerState(r),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=t.eventManager,this.onViewStateChange=t.onViewStateChange||(()=>{}),this.onStateChange=t.onStateChange||(()=>{}),this.makeViewport=t.makeViewport}set events(t){this.toggleEvents(this._customEvents,!1),this.toggleEvents(t,!0),this._customEvents=t,this.props&&this.setProps(this.props)}finalize(){for(let t in this._events)this._events[t]&&this.eventManager?.off(t,this.handleEvent);this.transitionManager.finalize()}handleEvent(t){this._controllerState=void 0;let r=this._eventStartBlocked;switch(t.type){case"panstart":return r?!1:this._onPanStart(t);case"panmove":return this._onPan(t);case"panend":return this._onPanEnd(t);case"pinchstart":return r?!1:this._onPinchStart(t);case"pinchmove":return this._onPinch(t);case"pinchend":return this._onPinchEnd(t);case"tripanstart":return r?!1:this._onTriplePanStart(t);case"tripanmove":return this._onTriplePan(t);case"tripanend":return this._onTriplePanEnd(t);case"doubletap":return this._onDoubleTap(t);case"wheel":return this._onWheel(t);case"keydown":return this._onKeyDown(t);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(t){let{x:r,y:i}=this.props,{offsetCenter:s}=t;return[s.x-r,s.y-i]}isPointInBounds(t,r){let{width:i,height:s}=this.props;if(r&&r.handled)return!1;let n=t[0]>=0&&t[0]<=i&&t[1]>=0&&t[1]<=s;return n&&r&&r.stopPropagation(),n}isFunctionKeyPressed(t){let{srcEvent:r}=t;return!!(r.metaKey||r.altKey||r.ctrlKey||r.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(t){let r=setTimeout(()=>{this._eventStartBlocked===r&&(this._eventStartBlocked=null)},t);this._eventStartBlocked=r}setProps(t){t.dragMode&&(this.dragMode=t.dragMode),this.props=t,"transitionInterpolator"in t||(t.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(t);let{inertia:r}=t;this.inertia=Number.isFinite(r)?r:r===!0?q1t:0;let{scrollZoom:i=!0,dragPan:s=!0,dragRotate:n=!0,doubleClickZoom:o=!0,touchZoom:a=!0,touchRotate:h=!1,keyboard:p=!0}=t,g=!!this.onViewStateChange;this.toggleEvents(Qy.WHEEL,g&&i),this.toggleEvents(Qy.PAN,g),this.toggleEvents(Qy.PINCH,g&&(a||h)),this.toggleEvents(Qy.TRIPLE_PAN,g&&h),this.toggleEvents(Qy.DOUBLE_TAP,g&&o),this.toggleEvents(Qy.KEYBOARD,g&&p),this.scrollZoom=i,this.dragPan=s,this.dragRotate=n,this.doubleClickZoom=o,this.touchZoom=a,this.touchRotate=h,this.keyboard=p}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(t,r){this.eventManager&&t.forEach(i=>{this._events[i]!==r&&(this._events[i]=r,r?this.eventManager.on(i,this.handleEvent):this.eventManager.off(i,this.handleEvent))})}updateViewport(t,r=null,i={}){let s={...t.getViewportProps(),...r},n=this.controllerState!==t;if(this.state=t.getState(),this._setInteractionState(i),n){let o=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:s,interactionState:this._interactionState,oldViewState:o,viewId:this.props.id})}}_onTransition(t){this.onViewStateChange({...t,interactionState:this._interactionState,viewId:this.props.id})}_setInteractionState(t){Object.assign(this._interactionState,t),this.onStateChange(this._interactionState)}_onPanStart(t){let r=this.getCenter(t);if(!this.isPointInBounds(r,t))return!1;let i=this.isFunctionKeyPressed(t)||t.rightButton||!1;(this.invertPan||this.dragMode==="pan")&&(i=!i);let s=this.controllerState[i?"panStart":"rotateStart"]({pos:r});return this._panMove=i,this.updateViewport(s,Nm,{isDragging:!0}),!0}_onPan(t){return this.isDragging()?this._panMove?this._onPanMove(t):this._onPanRotate(t):!1}_onPanEnd(t){return this.isDragging()?this._panMove?this._onPanMoveEnd(t):this._onPanRotateEnd(t):!1}_onPanMove(t){if(!this.dragPan)return!1;let r=this.getCenter(t),i=this.controllerState.pan({pos:r});return this.updateViewport(i,Nm,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(t){let{inertia:r}=this;if(this.dragPan&&r&&t.velocity){let i=this.getCenter(t),s=[i[0]+t.velocityX*r/2,i[1]+t.velocityY*r/2],n=this.controllerState.pan({pos:s}).panEnd();this.updateViewport(n,{...this._getTransitionProps(),transitionDuration:r,transitionEasing:nE},{isDragging:!1,isPanning:!0})}else{let i=this.controllerState.panEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(t){if(!this.dragRotate)return!1;let r=this.getCenter(t),i=this.controllerState.rotate({pos:r});return this.updateViewport(i,Nm,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(t){let{inertia:r}=this;if(this.dragRotate&&r&&t.velocity){let i=this.getCenter(t),s=[i[0]+t.velocityX*r/2,i[1]+t.velocityY*r/2],n=this.controllerState.rotate({pos:s}).rotateEnd();this.updateViewport(n,{...this._getTransitionProps(),transitionDuration:r,transitionEasing:nE},{isDragging:!1,isRotating:!0})}else{let i=this.controllerState.rotateEnd();this.updateViewport(i,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(t){if(!this.scrollZoom)return!1;let r=this.getCenter(t);if(!this.isPointInBounds(r,t))return!1;t.srcEvent.preventDefault();let{speed:i=.01,smooth:s=!1}=this.scrollZoom===!0?{}:this.scrollZoom,{delta:n}=t,o=2/(1+Math.exp(-Math.abs(n*i)));n<0&&o!==0&&(o=1/o);let a=this.controllerState.zoom({pos:r,scale:o});return this.updateViewport(a,{...this._getTransitionProps({around:r}),transitionDuration:s?250:1},{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(t){let r=this.getCenter(t);if(!this.isPointInBounds(r,t))return!1;let i=this.controllerState.rotateStart({pos:r});return this.updateViewport(i,Nm,{isDragging:!0}),!0}_onTriplePan(t){if(!this.touchRotate||!this.isDragging())return!1;let r=this.getCenter(t);r[0]-=t.deltaX;let i=this.controllerState.rotate({pos:r});return this.updateViewport(i,Nm,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(t){if(!this.isDragging())return!1;let{inertia:r}=this;if(this.touchRotate&&r&&t.velocityY){let i=this.getCenter(t),s=[i[0],i[1]+=t.velocityY*r/2],n=this.controllerState.rotate({pos:s});this.updateViewport(n,{...this._getTransitionProps(),transitionDuration:r,transitionEasing:nE},{isDragging:!1,isRotating:!0}),this.blockEvents(r)}else{let i=this.controllerState.rotateEnd();this.updateViewport(i,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(t){let r=this.getCenter(t);if(!this.isPointInBounds(r,t))return!1;let i=this.controllerState.zoomStart({pos:r}).rotateStart({pos:r});return Qg._startPinchRotation=t.rotation,Qg._lastPinchEvent=t,this.updateViewport(i,Nm,{isDragging:!0}),!0}_onPinch(t){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let r=this.controllerState;if(this.touchZoom){let{scale:i}=t,s=this.getCenter(t);r=r.zoom({pos:s,scale:i})}if(this.touchRotate){let{rotation:i}=t;r=r.rotate({deltaAngleX:Qg._startPinchRotation-i})}return this.updateViewport(r,Nm,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),Qg._lastPinchEvent=t,!0}_onPinchEnd(t){if(!this.isDragging())return!1;let{inertia:r}=this,{_lastPinchEvent:i}=Qg;if(this.touchZoom&&r&&i&&t.scale!==i.scale){let s=this.getCenter(t),n=this.controllerState.rotateEnd(),o=Math.log2(t.scale),a=(o-Math.log2(i.scale))/(t.deltaTime-i.deltaTime),h=Math.pow(2,o+a*r/2);n=n.zoom({pos:s,scale:h}).zoomEnd(),this.updateViewport(n,{...this._getTransitionProps({around:s}),transitionDuration:r,transitionEasing:nE},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(r)}else{let s=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(s,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return Qg._startPinchRotation=null,Qg._lastPinchEvent=null,!0}_onDoubleTap(t){if(!this.doubleClickZoom)return!1;let r=this.getCenter(t);if(!this.isPointInBounds(r,t))return!1;let i=this.isFunctionKeyPressed(t),s=this.controllerState.zoom({pos:r,scale:i?.5:2});return this.updateViewport(s,this._getTransitionProps({around:r}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(t){if(!this.keyboard)return!1;let r=this.isFunctionKeyPressed(t),{zoomSpeed:i,moveSpeed:s,rotateSpeedX:n,rotateSpeedY:o}=this.keyboard===!0?{}:this.keyboard,{controllerState:a}=this,h,p={};switch(t.srcEvent.code){case"Minus":h=r?a.zoomOut(i).zoomOut(i):a.zoomOut(i),p.isZooming=!0;break;case"Equal":h=r?a.zoomIn(i).zoomIn(i):a.zoomIn(i),p.isZooming=!0;break;case"ArrowLeft":r?(h=a.rotateLeft(n),p.isRotating=!0):(h=a.moveLeft(s),p.isPanning=!0);break;case"ArrowRight":r?(h=a.rotateRight(n),p.isRotating=!0):(h=a.moveRight(s),p.isPanning=!0);break;case"ArrowUp":r?(h=a.rotateUp(o),p.isRotating=!0):(h=a.moveUp(s),p.isPanning=!0);break;case"ArrowDown":r?(h=a.rotateDown(o),p.isRotating=!0):(h=a.moveDown(s),p.isPanning=!0);break;default:return!1}return this.updateViewport(h,this._getTransitionProps(),p),!0}_getTransitionProps(t){let{transition:r}=this;return!r||!r.transitionInterpolator?Nm:t?{...r,transitionInterpolator:new Gg({...t,...r.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:r}};var aw=class{constructor(t,r){this._viewportProps=this.applyConstraints(t),this._state=r}getViewportProps(){return this._viewportProps}getState(){return this._state}};var G$=5,Y1t=1.2,bD=class extends aw{constructor(t){let{width:r,height:i,latitude:s,longitude:n,zoom:o,bearing:a=0,pitch:h=0,altitude:p=1.5,position:g=[0,0,0],maxZoom:v=20,minZoom:T=0,maxPitch:C=60,minPitch:B=0,startPanLngLat:L,startZoomLngLat:z,startRotatePos:W,startBearing:Z,startPitch:X,startZoom:q,normalize:it=!0}=t;Jn(Number.isFinite(n)),Jn(Number.isFinite(s)),Jn(Number.isFinite(o)),super({width:r,height:i,latitude:s,longitude:n,zoom:o,bearing:a,pitch:h,altitude:p,maxZoom:v,minZoom:T,maxPitch:C,minPitch:B,normalize:it,position:g},{startPanLngLat:L,startZoomLngLat:z,startRotatePos:W,startBearing:Z,startPitch:X,startZoom:q}),this.makeViewport=t.makeViewport}panStart({pos:t}){return this._getUpdatedState({startPanLngLat:this._unproject(t)})}pan({pos:t,startPos:r}){let i=this.getState().startPanLngLat||this._unproject(r);if(!i)return this;let n=this.makeViewport(this.getViewportProps()).panByPosition(i,t);return this._getUpdatedState(n)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:t}){return this._getUpdatedState({startRotatePos:t,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:t,deltaAngleX:r=0,deltaAngleY:i=0}){let{startRotatePos:s,startBearing:n,startPitch:o}=this.getState();if(!s||n===void 0||o===void 0)return this;let a;return t?a=this._getNewRotation(t,s,o,n):a={bearing:n+r,pitch:o+i},this._getUpdatedState(a)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:t}){return this._getUpdatedState({startZoomLngLat:this._unproject(t),startZoom:this.getViewportProps().zoom})}zoom({pos:t,startPos:r,scale:i}){let{startZoom:s,startZoomLngLat:n}=this.getState();if(n||(s=this.getViewportProps().zoom,n=this._unproject(r)||this._unproject(t)),!n)return this;let{maxZoom:o,minZoom:a}=this.getViewportProps(),h=s+Math.log2(i);h=Xu(h,a,o);let p=this.makeViewport({...this.getViewportProps(),zoom:h});return this._getUpdatedState({zoom:h,...p.panByPosition(n,t)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(t=2){return this._zoomFromCenter(t)}zoomOut(t=2){return this._zoomFromCenter(1/t)}moveLeft(t=100){return this._panFromCenter([t,0])}moveRight(t=100){return this._panFromCenter([-t,0])}moveUp(t=100){return this._panFromCenter([0,t])}moveDown(t=100){return this._panFromCenter([0,-t])}rotateLeft(t=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-t})}rotateRight(t=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+t})}rotateUp(t=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+t})}rotateDown(t=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-t})}shortestPathFrom(t){let r=t.getViewportProps(),i={...this.getViewportProps()},{bearing:s,longitude:n}=i;return Math.abs(s-r.bearing)>180&&(i.bearing=s<0?s+360:s-360),Math.abs(n-r.longitude)>180&&(i.longitude=n<0?n+360:n-360),i}applyConstraints(t){let{maxZoom:r,minZoom:i,zoom:s}=t;t.zoom=Xu(s,i,r);let{maxPitch:n,minPitch:o,pitch:a}=t;t.pitch=Xu(a,o,n);let{normalize:h=!0}=t;return h&&Object.assign(t,dD(t)),t}_zoomFromCenter(t){let{width:r,height:i}=this.getViewportProps();return this.zoom({pos:[r/2,i/2],scale:t})}_panFromCenter(t){let{width:r,height:i}=this.getViewportProps();return this.pan({startPos:[r/2,i/2],pos:[r/2+t[0],i/2+t[1]]})}_getUpdatedState(t){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...t})}_unproject(t){let r=this.makeViewport(this.getViewportProps());return t&&r.unproject(t)}_getNewRotation(t,r,i,s){let n=t[0]-r[0],o=t[1]-r[1],a=t[1],h=r[1],{width:p,height:g}=this.getViewportProps(),v=n/p,T=0;o>0?Math.abs(g-h)>G$&&(T=o/(h-g)*Y1t):o<0&&h>G$&&(T=1-a/h),T=Xu(T,-1,1);let{minPitch:C,maxPitch:B}=this.getViewportProps(),L=s+180*v,z=i;return T>0?z=i+T*(B-i):T<0&&(z=i-T*(C-i)),{pitch:z,bearing:L}}},lw=class extends ow{constructor(){super(...arguments),this.ControllerState=bD,this.transition={transitionDuration:300,transitionInterpolator:new Gg({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})},this.dragMode="pan"}setProps(t){t.position=t.position||[0,0,0];let r=this.props;super.setProps(t),(!r||r.height!==t.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...t,...this.state}))}};var Lm=class extends iw{static{this.displayName="MapView"}constructor(t={}){super(t)}get ViewportType(){return cu}get ControllerType(){return lw}};var X1t=new qy;function Z1t(e,t){let r=e.order??1/0,i=t.order??1/0;return r-i}var cw=class{constructor(t){this._resolvedEffects=[],this._defaultEffects=[],this.effects=[],this._context=t,this._needsRedraw="Initial render",this._setEffects([])}addDefaultEffect(t){let r=this._defaultEffects;if(!r.find(i=>i.id===t.id)){let i=r.findIndex(s=>Z1t(s,t)>0);i<0?r.push(t):r.splice(i,0,t),t.setup(this._context),this._setEffects(this.effects)}}setProps(t){"effects"in t&&(ja(t.effects,this.effects,1)||this._setEffects(t.effects))}needsRedraw(t={clearRedrawFlags:!1}){let r=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),r}getEffects(){return this._resolvedEffects}_setEffects(t){let r={};for(let s of this.effects)r[s.id]=s;let i=[];for(let s of t){let n=r[s.id],o=s;n&&n!==s?n.setProps?(n.setProps(s.props),o=n):n.cleanup(this._context):n||s.setup(this._context),i.push(o),delete r[s.id]}for(let s in r)r[s].cleanup(this._context);this.effects=i,this._resolvedEffects=i.concat(this._defaultEffects),t.some(s=>s instanceof qy)||this._resolvedEffects.push(X1t),this._needsRedraw="effects changed"}finalize(){for(let t of this._resolvedEffects)t.cleanup(this._context);this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}};var uw=class extends Od{shouldDrawLayer(t){let{operation:r}=t.props;return r.includes("draw")||r.includes("terrain")}};var G1t="deckRenderer.renderLayers",hw=class{constructor(t){this.device=t,this.gl=t.gl,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new uw(t),this.pickLayersPass=new Zg(t),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(t){this.layerFilter!==t.layerFilter&&(this.layerFilter=t.layerFilter,this._needsRedraw="layerFilter changed"),this.drawPickingColors!==t.drawPickingColors&&(this.drawPickingColors=t.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(t){if(!t.viewports.length)return;let r=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,i={layerFilter:this.layerFilter,isPicking:this.drawPickingColors,...t};i.effects&&this._preRender(i.effects,i);let s=this.lastPostProcessEffect?this.renderBuffers[0]:i.target;this.lastPostProcessEffect&&(i.clearColor=[0,0,0,0],i.clearCanvas=!0);let n=r.render({...i,target:s});i.effects&&this._postRender(i.effects,i),this.renderCount++,ho(G1t,this,n,t)}needsRedraw(t={clearRedrawFlags:!1}){let r=this._needsRedraw;return t.clearRedrawFlags&&(this._needsRedraw=!1),r}finalize(){let{renderBuffers:t}=this;for(let r of t)r.delete();t.length=0}_preRender(t,r){this.lastPostProcessEffect=null,r.preRenderStats=r.preRenderStats||{};for(let i of t)r.preRenderStats[i.id]=i.preRender(r),i.postRender&&(this.lastPostProcessEffect=i.id);this.lastPostProcessEffect&&this._resizeRenderBuffers()}_resizeRenderBuffers(){let{renderBuffers:t}=this,r=this.device.canvasContext.getDrawingBufferSize();t.length===0&&[0,1].map(i=>{let s=this.device.createTexture({sampler:{minFilter:"linear",magFilter:"linear"}});t.push(this.device.createFramebuffer({id:`deck-renderbuffer-${i}`,colorAttachments:[s]}))});for(let i of t)i.resize(r)}_postRender(t,r){let{renderBuffers:i}=this,s={...r,inputBuffer:i[0],swapBuffer:i[1]};for(let n of t)if(n.postRender){s.target=n.id===this.lastPostProcessEffect?r.target:void 0;let o=n.postRender(s);s.inputBuffer=o,s.swapBuffer=o===i[0]?i[1]:i[0]}}};var Q1t={pickedColor:null,pickedObjectIndex:-1};function Q$({pickedColors:e,decodePickingColor:t,deviceX:r,deviceY:i,deviceRadius:s,deviceRect:n}){let{x:o,y:a,width:h,height:p}=n,g=s*s,v=-1,T=0;for(let C=0;C<p;C++){let B=C+a-i,L=B*B;if(L>g)T+=4*h;else for(let z=0;z<h;z++){if(e[T+3]-1>=0){let Z=z+o-r,X=Z*Z+L;X<=g&&(g=X,v=T)}T+=4}}if(v>=0){let C=e.slice(v,v+4),B=t(C);if(B){let L=Math.floor(v/4/h),z=v/4-L*h;return{...B,pickedColor:C,pickedX:o+z,pickedY:a+L}}Ir.error("Picked non-existent layer. Is picking buffer corrupt?")()}return Q1t}function K$({pickedColors:e,decodePickingColor:t}){let r=new Map;if(e){for(let i=0;i<e.length;i+=4)if(e[i+3]-1>=0){let n=e.slice(i,i+4),o=n.join(",");if(!r.has(o)){let a=t(n);a?r.set(o,{...a,color:n}):Ir.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(r.values())}function vD({pickInfo:e,viewports:t,pixelRatio:r,x:i,y:s,z:n}){let o=t[0];t.length>1&&(o=K1t(e?.pickedViewports||t,{x:i,y:s}));let a;if(o){let h=[i-o.x,s-o.y];n!==void 0&&(h[2]=n),a=o.unproject(h)}return{color:null,layer:null,viewport:o,index:-1,picked:!1,x:i,y:s,pixel:[i,s],coordinate:a,devicePixel:e&&"pickedX"in e?[e.pickedX,e.pickedY]:void 0,pixelRatio:r}}function J$(e){let{pickInfo:t,lastPickedInfo:r,mode:i,layers:s}=e,{pickedColor:n,pickedLayer:o,pickedObjectIndex:a}=t,h=o?[o]:[];if(i==="hover"){let v=r.index,T=r.layerId,C=o?o.props.id:null;if(C!==T||a!==v){if(C!==T){let B=s.find(L=>L.props.id===T);B&&h.unshift(B)}r.layerId=C,r.index=a,r.info=null}}let p=vD(e),g=new Map;return g.set(null,p),h.forEach(v=>{let T={...p};v===o&&(T.color=n,T.index=a,T.picked=!0),T=wD({layer:v,info:T,mode:i});let C=T.layer;v===o&&i==="hover"&&(r.info=T),g.set(C.id,T),i==="hover"&&C.updateAutoHighlight(T)}),g}function wD({layer:e,info:t,mode:r}){for(;e&&t;){let i=t.layer||null;t.sourceLayer=i,t.layer=e,t=e.getPickingInfo({info:t,mode:r,sourceLayer:i}),e=e.parent}return t}function K1t(e,t){for(let r=e.length-1;r>=0;r--){let i=e[r];if(i.containsPixel(t))return i}return e[0]}var fw=class{constructor(t){this._pickable=!0,this.device=t,this.pickLayersPass=new Zg(t),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(t){"layerFilter"in t&&(this.layerFilter=t.layerFilter),"_pickable"in t&&(this._pickable=t._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.destroy(),this.depthFBO&&this.depthFBO.destroy()}pickObject(t){return this._pickClosestObject(t)}pickObjects(t){return this._pickVisibleObjects(t)}getLastPickedObject({x:t,y:r,layers:i,viewports:s},n=this.lastPickedInfo.info){let o=n&&n.layer&&n.layer.id,a=n&&n.viewport&&n.viewport.id,h=o?i.find(T=>T.id===o):null,p=a&&s.find(T=>T.id===a)||s[0],g=p&&p.unproject([t-p.x,r-p.y]);return{...n,...{x:t,y:r,viewport:p,coordinate:g,layer:h}}}_resizeBuffer(){if(!this.pickingFBO&&(this.pickingFBO=this.device.createFramebuffer({colorAttachments:["rgba8unorm"],depthStencilAttachment:"depth16unorm"}),this.device.isTextureFormatRenderable("rgba32float"))){let r=this.device.createFramebuffer({colorAttachments:["rgba32float"],depthStencilAttachment:"depth16unorm"});this.depthFBO=r}let t=this.device.gl;this.pickingFBO?.resize({width:t.canvas.width,height:t.canvas.height}),this.depthFBO?.resize({width:t.canvas.width,height:t.canvas.height})}_getPickable(t){if(this._pickable===!1)return null;let r=t.filter(i=>this.pickLayersPass.shouldDrawLayer(i)&&!i.isComposite);return r.length?r:null}_pickClosestObject({layers:t,views:r,viewports:i,x:s,y:n,radius:o=0,depth:a=1,mode:h="query",unproject3D:p,onViewportActive:g,effects:v}){let T=this.device.canvasContext.cssToDeviceRatio(),C=this._getPickable(t);if(!C||i.length===0)return{result:[],emptyInfo:vD({viewports:i,x:s,y:n,pixelRatio:T})};this._resizeBuffer();let B=this.device.canvasContext.cssToDevicePixels([s,n],!0),L=[B.x+Math.floor(B.width/2),B.y+Math.floor(B.height/2)],z=Math.round(o*T),{width:W,height:Z}=this.pickingFBO,X=this._getPickingRect({deviceX:L[0],deviceY:L[1],deviceRadius:z,deviceWidth:W,deviceHeight:Z}),q={x:s-o,y:n-o,width:o*2+1,height:o*2+1},it,nt=[],Mt=new Set;for(let _t=0;_t<a;_t++){let Et;if(X){let Pt=this._drawAndSample({layers:C,views:r,viewports:i,onViewportActive:g,deviceRect:X,cullRect:q,effects:v,pass:`picking:${h}`});Et=Q$({...Pt,deviceX:L[0],deviceY:L[1],deviceRadius:z,deviceRect:X})}else Et={pickedColor:null,pickedObjectIndex:-1};let vt;if(Et.pickedLayer&&p&&this.depthFBO){let{pickedColors:Pt}=this._drawAndSample({layers:[Et.pickedLayer],views:r,viewports:i,onViewportActive:g,deviceRect:{x:Et.pickedX,y:Et.pickedY,width:1,height:1},cullRect:q,effects:v,pass:`picking:${h}:z`},!0);Pt[3]&&(vt=Pt[0])}Et.pickedLayer&&_t+1<a&&(Mt.add(Et.pickedLayer),Et.pickedLayer.disablePickingIndex(Et.pickedObjectIndex)),it=J$({pickInfo:Et,lastPickedInfo:this.lastPickedInfo,mode:h,layers:C,viewports:i,x:s,y:n,z:vt,pixelRatio:T});for(let Pt of it.values())Pt.layer&&nt.push(Pt);if(!Et.pickedColor)break}for(let _t of Mt)_t.restorePickingColors();return{result:nt,emptyInfo:it.get(null)}}_pickVisibleObjects({layers:t,views:r,viewports:i,x:s,y:n,width:o=1,height:a=1,mode:h="query",maxObjects:p=null,onViewportActive:g,effects:v}){let T=this._getPickable(t);if(!T||i.length===0)return[];this._resizeBuffer();let C=this.device.canvasContext.cssToDeviceRatio(),B=this.device.canvasContext.cssToDevicePixels([s,n],!0),L=B.x,z=B.y+B.height,W=this.device.canvasContext.cssToDevicePixels([s+o,n+a],!0),Z=W.x+W.width,X=W.y,q={x:L,y:X,width:Z-L,height:z-X},it=this._drawAndSample({layers:T,views:r,viewports:i,onViewportActive:g,deviceRect:q,cullRect:{x:s,y:n,width:o,height:a},effects:v,pass:`picking:${h}`}),nt=K$(it),Mt=new Map,_t=[],Et=Number.isFinite(p);for(let vt=0;vt<nt.length&&!(Et&&_t.length>=p);vt++){let Pt=nt[vt],re={color:Pt.pickedColor,layer:null,index:Pt.pickedObjectIndex,picked:!0,x:s,y:n,pixelRatio:C};re=wD({layer:Pt.pickedLayer,info:re,mode:h});let $t=re.layer.id;Mt.has($t)||Mt.set($t,new Set);let xt=Mt.get($t),Vt=re.object??re.index;xt.has(Vt)||(xt.add(Vt),_t.push(re))}return _t}_drawAndSample({layers:t,views:r,viewports:i,onViewportActive:s,deviceRect:n,cullRect:o,effects:a,pass:h},p=!1){let g=p?this.depthFBO:this.pickingFBO,v={layers:t,layerFilter:this.layerFilter,views:r,viewports:i,onViewportActive:s,pickingFBO:g,deviceRect:n,cullRect:o,effects:a,pass:h,pickZ:p,preRenderStats:{}};for(let Z of a)Z.useInPicking&&(v.preRenderStats[Z.id]=Z.preRender(v));let{decodePickingColor:T}=this.pickLayersPass.render(v),{x:C,y:B,width:L,height:z}=n,W=new(p?Float32Array:Uint8Array)(L*z*4);return this.device.readPixelsToArrayWebGL(g,{sourceX:C,sourceY:B,sourceWidth:L,sourceHeight:z,target:W}),{pickedColors:W,decodePickingColor:T}}_getPickingRect({deviceX:t,deviceY:r,deviceRadius:i,deviceWidth:s,deviceHeight:n}){let o=Math.max(0,t-i),a=Math.max(0,r-i),h=Math.min(s,t+i+1)-o,p=Math.min(n,r+i+1)-a;return h<=0||p<=0?null:{x:o,y:a,width:h,height:p}}};var J1t={"top-left":{top:0,left:0},"top-right":{top:0,right:0},"bottom-left":{bottom:0,left:0},"bottom-right":{bottom:0,right:0},fill:{top:0,left:0,bottom:0,right:0}},t_t="top-left",tH="__root",sE=class{constructor({deck:t,parentElement:r}){this.defaultWidgets=[],this.widgets=[],this.resolvedWidgets=[],this.containers={},this.lastViewports={},this.deck=t,this.parentElement=r}getWidgets(){return this.resolvedWidgets}setProps(t){t.widgets&&!ja(t.widgets,this.widgets,1)&&this._setWidgets(t.widgets)}finalize(){for(let t of this.getWidgets())this._remove(t);this.defaultWidgets.length=0,this.resolvedWidgets.length=0;for(let t in this.containers)this.containers[t].remove()}addDefault(t){this.defaultWidgets.find(r=>r.id===t.id)||(this._add(t),this.defaultWidgets.push(t),this._setWidgets(this.widgets))}_setWidgets(t){let r={};for(let i of this.resolvedWidgets)r[i.id]=i;this.resolvedWidgets.length=0;for(let i of this.defaultWidgets)r[i.id]=null,this.resolvedWidgets.push(i);for(let i of t){let s=r[i.id];s?s.viewId!==i.viewId||s.placement!==i.placement?(this._remove(s),this._add(i)):i!==s&&(s.setProps(i.props),i=s):this._add(i),r[i.id]=null,this.resolvedWidgets.push(i)}for(let i in r){let s=r[i];s&&this._remove(s)}this.widgets=t}_add(t){let{viewId:r=null,placement:i=t_t}=t,s=t.onAdd({deck:this.deck,viewId:r});s&&this._getContainer(r,i).append(s),t._element=s}_remove(t){t.onRemove(),t._element&&t._element.remove(),t._element=void 0}_getContainer(t,r){let i=t||tH,s=this.containers[i];s||(s=document.createElement("div"),s.style.pointerEvents="none",s.style.position="absolute",s.style.overflow="hidden",this.parentElement?.append(s),this.containers[i]=s);let n=s.querySelector(`.${r}`);return n||(n=document.createElement("div"),n.className=r,n.style.position="absolute",Object.assign(n.style,J1t[r]),s.append(n)),n}_updateContainers(){let t=this.deck.width,r=this.deck.height;for(let i in this.containers){let s=this.lastViewports[i]||null,n=i===tH||s,o=this.containers[i];n?(o.style.display="block",o.style.left=`${s?s.x:0}px`,o.style.top=`${s?s.y:0}px`,o.style.width=`${s?s.width:t}px`,o.style.height=`${s?s.height:r}px`):o.style.display="none"}}onRedraw({viewports:t,layers:r}){let i=t.reduce((n,o)=>(n[o.id]=o,n),{}),{lastViewports:s}=this;for(let n of this.getWidgets()){let{viewId:o}=n;if(o){let a=i[o];a&&(n.onViewportChange&&!a.equals(s[o])&&n.onViewportChange(a),n.onRedraw?.({viewports:[a],layers:r}))}else{if(n.onViewportChange)for(let a of t)a.equals(s[a.id])||n.onViewportChange(a);n.onRedraw?.({viewports:t,layers:r})}}this.lastViewports=i,this._updateContainers()}onHover(t,r){for(let i of this.getWidgets()){let{viewId:s}=i;(!s||s===t.viewport?.id)&&i.onHover?.(t,r)}}onEvent(t,r){let i=$v[r.type];if(i)for(let s of this.getWidgets()){let{viewId:n}=s;(!n||n===t.viewport?.id)&&s[i.handler]?.(t,r)}}};var e_t={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"},pw=class{constructor(){this.id="default-tooltip",this.placement="fill",this.props={},this.isVisible=!1}onAdd({deck:t}){let r=document.createElement("div");return r.className="deck-tooltip",Object.assign(r.style,e_t),this.deck=t,this.element=r,r}onRemove(){this.deck=void 0,this.element=void 0}setProps(){}onViewportChange(t){this.isVisible&&t.id===this.lastViewport?.id&&t!==this.lastViewport&&this.setTooltip(null)}onHover(t){let{deck:r}=this,i=r&&r.props.getTooltip;if(!i)return;let s=i(t);this.lastViewport=t.viewport,this.setTooltip(s,t.x,t.y)}setTooltip(t,r,i){let s=this.element;if(s){if(typeof t=="string")s.innerText=t;else if(t)t.text&&(s.innerText=t.text),t.html&&(s.innerHTML=t.html),t.className&&(s.className=t.className);else{this.isVisible=!1,s.style.display="none";return}this.isVisible=!0,s.style.display="block",s.style.transform=`translate(${r}px, ${i}px)`,t&&typeof t=="object"&&"style"in t&&Object.assign(s.style,t.style)}}};var Fm;(function(e){e[e.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",e[e.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",e[e.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN",e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.SRC_COLOR=768]="SRC_COLOR",e[e.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",e[e.SRC_ALPHA=770]="SRC_ALPHA",e[e.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",e[e.DST_ALPHA=772]="DST_ALPHA",e[e.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",e[e.DST_COLOR=774]="DST_COLOR",e[e.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",e[e.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",e[e.CONSTANT_COLOR=32769]="CONSTANT_COLOR",e[e.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",e[e.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",e[e.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",e[e.FUNC_ADD=32774]="FUNC_ADD",e[e.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",e[e.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",e[e.BLEND_EQUATION=32777]="BLEND_EQUATION",e[e.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",e[e.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",e[e.BLEND_DST_RGB=32968]="BLEND_DST_RGB",e[e.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",e[e.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",e[e.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",e[e.BLEND_COLOR=32773]="BLEND_COLOR",e[e.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",e[e.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",e[e.LINE_WIDTH=2849]="LINE_WIDTH",e[e.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",e[e.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",e[e.CULL_FACE_MODE=2885]="CULL_FACE_MODE",e[e.FRONT_FACE=2886]="FRONT_FACE",e[e.DEPTH_RANGE=2928]="DEPTH_RANGE",e[e.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",e[e.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",e[e.DEPTH_FUNC=2932]="DEPTH_FUNC",e[e.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",e[e.STENCIL_FUNC=2962]="STENCIL_FUNC",e[e.STENCIL_FAIL=2964]="STENCIL_FAIL",e[e.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",e[e.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",e[e.STENCIL_REF=2967]="STENCIL_REF",e[e.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",e[e.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",e[e.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",e[e.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",e[e.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",e[e.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",e[e.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",e[e.VIEWPORT=2978]="VIEWPORT",e[e.SCISSOR_BOX=3088]="SCISSOR_BOX",e[e.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",e[e.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",e[e.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",e[e.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",e[e.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",e[e.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",e[e.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",e[e.RED_BITS=3410]="RED_BITS",e[e.GREEN_BITS=3411]="GREEN_BITS",e[e.BLUE_BITS=3412]="BLUE_BITS",e[e.ALPHA_BITS=3413]="ALPHA_BITS",e[e.DEPTH_BITS=3414]="DEPTH_BITS",e[e.STENCIL_BITS=3415]="STENCIL_BITS",e[e.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",e[e.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",e[e.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",e[e.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",e[e.SAMPLES=32937]="SAMPLES",e[e.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",e[e.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",e[e.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",e[e.VENDOR=7936]="VENDOR",e[e.RENDERER=7937]="RENDERER",e[e.VERSION=7938]="VERSION",e[e.IMPLEMENTATION_COLOR_READ_TYPE=35738]="IMPLEMENTATION_COLOR_READ_TYPE",e[e.IMPLEMENTATION_COLOR_READ_FORMAT=35739]="IMPLEMENTATION_COLOR_READ_FORMAT",e[e.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",e[e.STATIC_DRAW=35044]="STATIC_DRAW",e[e.STREAM_DRAW=35040]="STREAM_DRAW",e[e.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",e[e.ARRAY_BUFFER=34962]="ARRAY_BUFFER",e[e.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",e[e.BUFFER_SIZE=34660]="BUFFER_SIZE",e[e.BUFFER_USAGE=34661]="BUFFER_USAGE",e[e.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",e[e.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",e[e.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",e[e.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",e[e.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",e[e.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",e[e.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",e[e.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",e[e.CULL_FACE=2884]="CULL_FACE",e[e.FRONT=1028]="FRONT",e[e.BACK=1029]="BACK",e[e.FRONT_AND_BACK=1032]="FRONT_AND_BACK",e[e.BLEND=3042]="BLEND",e[e.DEPTH_TEST=2929]="DEPTH_TEST",e[e.DITHER=3024]="DITHER",e[e.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",e[e.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",e[e.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",e[e.SCISSOR_TEST=3089]="SCISSOR_TEST",e[e.STENCIL_TEST=2960]="STENCIL_TEST",e[e.NO_ERROR=0]="NO_ERROR",e[e.INVALID_ENUM=1280]="INVALID_ENUM",e[e.INVALID_VALUE=1281]="INVALID_VALUE",e[e.INVALID_OPERATION=1282]="INVALID_OPERATION",e[e.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",e[e.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",e[e.CW=2304]="CW",e[e.CCW=2305]="CCW",e[e.DONT_CARE=4352]="DONT_CARE",e[e.FASTEST=4353]="FASTEST",e[e.NICEST=4354]="NICEST",e[e.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",e[e.BYTE=5120]="BYTE",e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.SHORT=5122]="SHORT",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.INT=5124]="INT",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.FLOAT=5126]="FLOAT",e[e.DOUBLE=5130]="DOUBLE",e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.ALPHA=6406]="ALPHA",e[e.RGB=6407]="RGB",e[e.RGBA=6408]="RGBA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",e[e.VERTEX_SHADER=35633]="VERTEX_SHADER",e[e.COMPILE_STATUS=35713]="COMPILE_STATUS",e[e.DELETE_STATUS=35712]="DELETE_STATUS",e[e.LINK_STATUS=35714]="LINK_STATUS",e[e.VALIDATE_STATUS=35715]="VALIDATE_STATUS",e[e.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",e[e.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",e[e.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",e[e.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",e[e.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",e[e.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",e[e.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",e[e.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",e[e.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",e[e.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",e[e.SHADER_TYPE=35663]="SHADER_TYPE",e[e.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",e[e.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",e[e.NEVER=512]="NEVER",e[e.LESS=513]="LESS",e[e.EQUAL=514]="EQUAL",e[e.LEQUAL=515]="LEQUAL",e[e.GREATER=516]="GREATER",e[e.NOTEQUAL=517]="NOTEQUAL",e[e.GEQUAL=518]="GEQUAL",e[e.ALWAYS=519]="ALWAYS",e[e.KEEP=7680]="KEEP",e[e.REPLACE=7681]="REPLACE",e[e.INCR=7682]="INCR",e[e.DECR=7683]="DECR",e[e.INVERT=5386]="INVERT",e[e.INCR_WRAP=34055]="INCR_WRAP",e[e.DECR_WRAP=34056]="DECR_WRAP",e[e.NEAREST=9728]="NEAREST",e[e.LINEAR=9729]="LINEAR",e[e.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",e[e.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",e[e.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",e[e.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",e[e.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",e[e.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",e[e.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",e[e.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE=5890]="TEXTURE",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",e[e.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",e[e.TEXTURE0=33984]="TEXTURE0",e[e.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",e[e.REPEAT=10497]="REPEAT",e[e.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",e[e.TEXTURE_WIDTH=4096]="TEXTURE_WIDTH",e[e.TEXTURE_HEIGHT=4097]="TEXTURE_HEIGHT",e[e.FLOAT_VEC2=35664]="FLOAT_VEC2",e[e.FLOAT_VEC3=35665]="FLOAT_VEC3",e[e.FLOAT_VEC4=35666]="FLOAT_VEC4",e[e.INT_VEC2=35667]="INT_VEC2",e[e.INT_VEC3=35668]="INT_VEC3",e[e.INT_VEC4=35669]="INT_VEC4",e[e.BOOL=35670]="BOOL",e[e.BOOL_VEC2=35671]="BOOL_VEC2",e[e.BOOL_VEC3=35672]="BOOL_VEC3",e[e.BOOL_VEC4=35673]="BOOL_VEC4",e[e.FLOAT_MAT2=35674]="FLOAT_MAT2",e[e.FLOAT_MAT3=35675]="FLOAT_MAT3",e[e.FLOAT_MAT4=35676]="FLOAT_MAT4",e[e.SAMPLER_2D=35678]="SAMPLER_2D",e[e.SAMPLER_CUBE=35680]="SAMPLER_CUBE",e[e.LOW_FLOAT=36336]="LOW_FLOAT",e[e.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",e[e.HIGH_FLOAT=36338]="HIGH_FLOAT",e[e.LOW_INT=36339]="LOW_INT",e[e.MEDIUM_INT=36340]="MEDIUM_INT",e[e.HIGH_INT=36341]="HIGH_INT",e[e.FRAMEBUFFER=36160]="FRAMEBUFFER",e[e.RENDERBUFFER=36161]="RENDERBUFFER",e[e.RGBA4=32854]="RGBA4",e[e.RGB5_A1=32855]="RGB5_A1",e[e.RGB565=36194]="RGB565",e[e.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",e[e.STENCIL_INDEX=6401]="STENCIL_INDEX",e[e.STENCIL_INDEX8=36168]="STENCIL_INDEX8",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e[e.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",e[e.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",e[e.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",e[e.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",e[e.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",e[e.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",e[e.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",e[e.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",e[e.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",e[e.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",e[e.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",e[e.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",e[e.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",e[e.NONE=0]="NONE",e[e.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",e[e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",e[e.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",e[e.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",e[e.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",e[e.READ_FRAMEBUFFER=36008]="READ_FRAMEBUFFER",e[e.DRAW_FRAMEBUFFER=36009]="DRAW_FRAMEBUFFER",e[e.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",e[e.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",e[e.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",e[e.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",e[e.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",e[e.READ_BUFFER=3074]="READ_BUFFER",e[e.UNPACK_ROW_LENGTH=3314]="UNPACK_ROW_LENGTH",e[e.UNPACK_SKIP_ROWS=3315]="UNPACK_SKIP_ROWS",e[e.UNPACK_SKIP_PIXELS=3316]="UNPACK_SKIP_PIXELS",e[e.PACK_ROW_LENGTH=3330]="PACK_ROW_LENGTH",e[e.PACK_SKIP_ROWS=3331]="PACK_SKIP_ROWS",e[e.PACK_SKIP_PIXELS=3332]="PACK_SKIP_PIXELS",e[e.TEXTURE_BINDING_3D=32874]="TEXTURE_BINDING_3D",e[e.UNPACK_SKIP_IMAGES=32877]="UNPACK_SKIP_IMAGES",e[e.UNPACK_IMAGE_HEIGHT=32878]="UNPACK_IMAGE_HEIGHT",e[e.MAX_3D_TEXTURE_SIZE=32883]="MAX_3D_TEXTURE_SIZE",e[e.MAX_ELEMENTS_VERTICES=33e3]="MAX_ELEMENTS_VERTICES",e[e.MAX_ELEMENTS_INDICES=33001]="MAX_ELEMENTS_INDICES",e[e.MAX_TEXTURE_LOD_BIAS=34045]="MAX_TEXTURE_LOD_BIAS",e[e.MAX_FRAGMENT_UNIFORM_COMPONENTS=35657]="MAX_FRAGMENT_UNIFORM_COMPONENTS",e[e.MAX_VERTEX_UNIFORM_COMPONENTS=35658]="MAX_VERTEX_UNIFORM_COMPONENTS",e[e.MAX_ARRAY_TEXTURE_LAYERS=35071]="MAX_ARRAY_TEXTURE_LAYERS",e[e.MIN_PROGRAM_TEXEL_OFFSET=35076]="MIN_PROGRAM_TEXEL_OFFSET",e[e.MAX_PROGRAM_TEXEL_OFFSET=35077]="MAX_PROGRAM_TEXEL_OFFSET",e[e.MAX_VARYING_COMPONENTS=35659]="MAX_VARYING_COMPONENTS",e[e.FRAGMENT_SHADER_DERIVATIVE_HINT=35723]="FRAGMENT_SHADER_DERIVATIVE_HINT",e[e.RASTERIZER_DISCARD=35977]="RASTERIZER_DISCARD",e[e.VERTEX_ARRAY_BINDING=34229]="VERTEX_ARRAY_BINDING",e[e.MAX_VERTEX_OUTPUT_COMPONENTS=37154]="MAX_VERTEX_OUTPUT_COMPONENTS",e[e.MAX_FRAGMENT_INPUT_COMPONENTS=37157]="MAX_FRAGMENT_INPUT_COMPONENTS",e[e.MAX_SERVER_WAIT_TIMEOUT=37137]="MAX_SERVER_WAIT_TIMEOUT",e[e.MAX_ELEMENT_INDEX=36203]="MAX_ELEMENT_INDEX",e[e.RED=6403]="RED",e[e.RGB8=32849]="RGB8",e[e.RGBA8=32856]="RGBA8",e[e.RGB10_A2=32857]="RGB10_A2",e[e.TEXTURE_3D=32879]="TEXTURE_3D",e[e.TEXTURE_WRAP_R=32882]="TEXTURE_WRAP_R",e[e.TEXTURE_MIN_LOD=33082]="TEXTURE_MIN_LOD",e[e.TEXTURE_MAX_LOD=33083]="TEXTURE_MAX_LOD",e[e.TEXTURE_BASE_LEVEL=33084]="TEXTURE_BASE_LEVEL",e[e.TEXTURE_MAX_LEVEL=33085]="TEXTURE_MAX_LEVEL",e[e.TEXTURE_COMPARE_MODE=34892]="TEXTURE_COMPARE_MODE",e[e.TEXTURE_COMPARE_FUNC=34893]="TEXTURE_COMPARE_FUNC",e[e.SRGB=35904]="SRGB",e[e.SRGB8=35905]="SRGB8",e[e.SRGB8_ALPHA8=35907]="SRGB8_ALPHA8",e[e.COMPARE_REF_TO_TEXTURE=34894]="COMPARE_REF_TO_TEXTURE",e[e.RGBA32F=34836]="RGBA32F",e[e.RGB32F=34837]="RGB32F",e[e.RGBA16F=34842]="RGBA16F",e[e.RGB16F=34843]="RGB16F",e[e.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",e[e.TEXTURE_BINDING_2D_ARRAY=35869]="TEXTURE_BINDING_2D_ARRAY",e[e.R11F_G11F_B10F=35898]="R11F_G11F_B10F",e[e.RGB9_E5=35901]="RGB9_E5",e[e.RGBA32UI=36208]="RGBA32UI",e[e.RGB32UI=36209]="RGB32UI",e[e.RGBA16UI=36214]="RGBA16UI",e[e.RGB16UI=36215]="RGB16UI",e[e.RGBA8UI=36220]="RGBA8UI",e[e.RGB8UI=36221]="RGB8UI",e[e.RGBA32I=36226]="RGBA32I",e[e.RGB32I=36227]="RGB32I",e[e.RGBA16I=36232]="RGBA16I",e[e.RGB16I=36233]="RGB16I",e[e.RGBA8I=36238]="RGBA8I",e[e.RGB8I=36239]="RGB8I",e[e.RED_INTEGER=36244]="RED_INTEGER",e[e.RGB_INTEGER=36248]="RGB_INTEGER",e[e.RGBA_INTEGER=36249]="RGBA_INTEGER",e[e.R8=33321]="R8",e[e.RG8=33323]="RG8",e[e.R16F=33325]="R16F",e[e.R32F=33326]="R32F",e[e.RG16F=33327]="RG16F",e[e.RG32F=33328]="RG32F",e[e.R8I=33329]="R8I",e[e.R8UI=33330]="R8UI",e[e.R16I=33331]="R16I",e[e.R16UI=33332]="R16UI",e[e.R32I=33333]="R32I",e[e.R32UI=33334]="R32UI",e[e.RG8I=33335]="RG8I",e[e.RG8UI=33336]="RG8UI",e[e.RG16I=33337]="RG16I",e[e.RG16UI=33338]="RG16UI",e[e.RG32I=33339]="RG32I",e[e.RG32UI=33340]="RG32UI",e[e.R8_SNORM=36756]="R8_SNORM",e[e.RG8_SNORM=36757]="RG8_SNORM",e[e.RGB8_SNORM=36758]="RGB8_SNORM",e[e.RGBA8_SNORM=36759]="RGBA8_SNORM",e[e.RGB10_A2UI=36975]="RGB10_A2UI",e[e.TEXTURE_IMMUTABLE_FORMAT=37167]="TEXTURE_IMMUTABLE_FORMAT",e[e.TEXTURE_IMMUTABLE_LEVELS=33503]="TEXTURE_IMMUTABLE_LEVELS",e[e.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",e[e.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",e[e.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",e[e.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",e[e.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",e[e.HALF_FLOAT=5131]="HALF_FLOAT",e[e.RG=33319]="RG",e[e.RG_INTEGER=33320]="RG_INTEGER",e[e.INT_2_10_10_10_REV=36255]="INT_2_10_10_10_REV",e[e.CURRENT_QUERY=34917]="CURRENT_QUERY",e[e.QUERY_RESULT=34918]="QUERY_RESULT",e[e.QUERY_RESULT_AVAILABLE=34919]="QUERY_RESULT_AVAILABLE",e[e.ANY_SAMPLES_PASSED=35887]="ANY_SAMPLES_PASSED",e[e.ANY_SAMPLES_PASSED_CONSERVATIVE=36202]="ANY_SAMPLES_PASSED_CONSERVATIVE",e[e.MAX_DRAW_BUFFERS=34852]="MAX_DRAW_BUFFERS",e[e.DRAW_BUFFER0=34853]="DRAW_BUFFER0",e[e.DRAW_BUFFER1=34854]="DRAW_BUFFER1",e[e.DRAW_BUFFER2=34855]="DRAW_BUFFER2",e[e.DRAW_BUFFER3=34856]="DRAW_BUFFER3",e[e.DRAW_BUFFER4=34857]="DRAW_BUFFER4",e[e.DRAW_BUFFER5=34858]="DRAW_BUFFER5",e[e.DRAW_BUFFER6=34859]="DRAW_BUFFER6",e[e.DRAW_BUFFER7=34860]="DRAW_BUFFER7",e[e.DRAW_BUFFER8=34861]="DRAW_BUFFER8",e[e.DRAW_BUFFER9=34862]="DRAW_BUFFER9",e[e.DRAW_BUFFER10=34863]="DRAW_BUFFER10",e[e.DRAW_BUFFER11=34864]="DRAW_BUFFER11",e[e.DRAW_BUFFER12=34865]="DRAW_BUFFER12",e[e.DRAW_BUFFER13=34866]="DRAW_BUFFER13",e[e.DRAW_BUFFER14=34867]="DRAW_BUFFER14",e[e.DRAW_BUFFER15=34868]="DRAW_BUFFER15",e[e.MAX_COLOR_ATTACHMENTS=36063]="MAX_COLOR_ATTACHMENTS",e[e.COLOR_ATTACHMENT1=36065]="COLOR_ATTACHMENT1",e[e.COLOR_ATTACHMENT2=36066]="COLOR_ATTACHMENT2",e[e.COLOR_ATTACHMENT3=36067]="COLOR_ATTACHMENT3",e[e.COLOR_ATTACHMENT4=36068]="COLOR_ATTACHMENT4",e[e.COLOR_ATTACHMENT5=36069]="COLOR_ATTACHMENT5",e[e.COLOR_ATTACHMENT6=36070]="COLOR_ATTACHMENT6",e[e.COLOR_ATTACHMENT7=36071]="COLOR_ATTACHMENT7",e[e.COLOR_ATTACHMENT8=36072]="COLOR_ATTACHMENT8",e[e.COLOR_ATTACHMENT9=36073]="COLOR_ATTACHMENT9",e[e.COLOR_ATTACHMENT10=36074]="COLOR_ATTACHMENT10",e[e.COLOR_ATTACHMENT11=36075]="COLOR_ATTACHMENT11",e[e.COLOR_ATTACHMENT12=36076]="COLOR_ATTACHMENT12",e[e.COLOR_ATTACHMENT13=36077]="COLOR_ATTACHMENT13",e[e.COLOR_ATTACHMENT14=36078]="COLOR_ATTACHMENT14",e[e.COLOR_ATTACHMENT15=36079]="COLOR_ATTACHMENT15",e[e.SAMPLER_3D=35679]="SAMPLER_3D",e[e.SAMPLER_2D_SHADOW=35682]="SAMPLER_2D_SHADOW",e[e.SAMPLER_2D_ARRAY=36289]="SAMPLER_2D_ARRAY",e[e.SAMPLER_2D_ARRAY_SHADOW=36292]="SAMPLER_2D_ARRAY_SHADOW",e[e.SAMPLER_CUBE_SHADOW=36293]="SAMPLER_CUBE_SHADOW",e[e.INT_SAMPLER_2D=36298]="INT_SAMPLER_2D",e[e.INT_SAMPLER_3D=36299]="INT_SAMPLER_3D",e[e.INT_SAMPLER_CUBE=36300]="INT_SAMPLER_CUBE",e[e.INT_SAMPLER_2D_ARRAY=36303]="INT_SAMPLER_2D_ARRAY",e[e.UNSIGNED_INT_SAMPLER_2D=36306]="UNSIGNED_INT_SAMPLER_2D",e[e.UNSIGNED_INT_SAMPLER_3D=36307]="UNSIGNED_INT_SAMPLER_3D",e[e.UNSIGNED_INT_SAMPLER_CUBE=36308]="UNSIGNED_INT_SAMPLER_CUBE",e[e.UNSIGNED_INT_SAMPLER_2D_ARRAY=36311]="UNSIGNED_INT_SAMPLER_2D_ARRAY",e[e.MAX_SAMPLES=36183]="MAX_SAMPLES",e[e.SAMPLER_BINDING=35097]="SAMPLER_BINDING",e[e.PIXEL_PACK_BUFFER=35051]="PIXEL_PACK_BUFFER",e[e.PIXEL_UNPACK_BUFFER=35052]="PIXEL_UNPACK_BUFFER",e[e.PIXEL_PACK_BUFFER_BINDING=35053]="PIXEL_PACK_BUFFER_BINDING",e[e.PIXEL_UNPACK_BUFFER_BINDING=35055]="PIXEL_UNPACK_BUFFER_BINDING",e[e.COPY_READ_BUFFER=36662]="COPY_READ_BUFFER",e[e.COPY_WRITE_BUFFER=36663]="COPY_WRITE_BUFFER",e[e.COPY_READ_BUFFER_BINDING=36662]="COPY_READ_BUFFER_BINDING",e[e.COPY_WRITE_BUFFER_BINDING=36663]="COPY_WRITE_BUFFER_BINDING",e[e.FLOAT_MAT2x3=35685]="FLOAT_MAT2x3",e[e.FLOAT_MAT2x4=35686]="FLOAT_MAT2x4",e[e.FLOAT_MAT3x2=35687]="FLOAT_MAT3x2",e[e.FLOAT_MAT3x4=35688]="FLOAT_MAT3x4",e[e.FLOAT_MAT4x2=35689]="FLOAT_MAT4x2",e[e.FLOAT_MAT4x3=35690]="FLOAT_MAT4x3",e[e.UNSIGNED_INT_VEC2=36294]="UNSIGNED_INT_VEC2",e[e.UNSIGNED_INT_VEC3=36295]="UNSIGNED_INT_VEC3",e[e.UNSIGNED_INT_VEC4=36296]="UNSIGNED_INT_VEC4",e[e.UNSIGNED_NORMALIZED=35863]="UNSIGNED_NORMALIZED",e[e.SIGNED_NORMALIZED=36764]="SIGNED_NORMALIZED",e[e.VERTEX_ATTRIB_ARRAY_INTEGER=35069]="VERTEX_ATTRIB_ARRAY_INTEGER",e[e.VERTEX_ATTRIB_ARRAY_DIVISOR=35070]="VERTEX_ATTRIB_ARRAY_DIVISOR",e[e.TRANSFORM_FEEDBACK_BUFFER_MODE=35967]="TRANSFORM_FEEDBACK_BUFFER_MODE",e[e.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS=35968]="MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS",e[e.TRANSFORM_FEEDBACK_VARYINGS=35971]="TRANSFORM_FEEDBACK_VARYINGS",e[e.TRANSFORM_FEEDBACK_BUFFER_START=35972]="TRANSFORM_FEEDBACK_BUFFER_START",e[e.TRANSFORM_FEEDBACK_BUFFER_SIZE=35973]="TRANSFORM_FEEDBACK_BUFFER_SIZE",e[e.TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN=35976]="TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN",e[e.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS=35978]="MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS",e[e.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS=35979]="MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS",e[e.INTERLEAVED_ATTRIBS=35980]="INTERLEAVED_ATTRIBS",e[e.SEPARATE_ATTRIBS=35981]="SEPARATE_ATTRIBS",e[e.TRANSFORM_FEEDBACK_BUFFER=35982]="TRANSFORM_FEEDBACK_BUFFER",e[e.TRANSFORM_FEEDBACK_BUFFER_BINDING=35983]="TRANSFORM_FEEDBACK_BUFFER_BINDING",e[e.TRANSFORM_FEEDBACK=36386]="TRANSFORM_FEEDBACK",e[e.TRANSFORM_FEEDBACK_PAUSED=36387]="TRANSFORM_FEEDBACK_PAUSED",e[e.TRANSFORM_FEEDBACK_ACTIVE=36388]="TRANSFORM_FEEDBACK_ACTIVE",e[e.TRANSFORM_FEEDBACK_BINDING=36389]="TRANSFORM_FEEDBACK_BINDING",e[e.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING=33296]="FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING",e[e.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE=33297]="FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE",e[e.FRAMEBUFFER_ATTACHMENT_RED_SIZE=33298]="FRAMEBUFFER_ATTACHMENT_RED_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_GREEN_SIZE=33299]="FRAMEBUFFER_ATTACHMENT_GREEN_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_BLUE_SIZE=33300]="FRAMEBUFFER_ATTACHMENT_BLUE_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE=33301]="FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE=33302]="FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE=33303]="FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE",e[e.FRAMEBUFFER_DEFAULT=33304]="FRAMEBUFFER_DEFAULT",e[e.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",e[e.DRAW_FRAMEBUFFER_BINDING=36006]="DRAW_FRAMEBUFFER_BINDING",e[e.READ_FRAMEBUFFER_BINDING=36010]="READ_FRAMEBUFFER_BINDING",e[e.RENDERBUFFER_SAMPLES=36011]="RENDERBUFFER_SAMPLES",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER=36052]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER",e[e.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE=36182]="FRAMEBUFFER_INCOMPLETE_MULTISAMPLE",e[e.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",e[e.UNIFORM_BUFFER_BINDING=35368]="UNIFORM_BUFFER_BINDING",e[e.UNIFORM_BUFFER_START=35369]="UNIFORM_BUFFER_START",e[e.UNIFORM_BUFFER_SIZE=35370]="UNIFORM_BUFFER_SIZE",e[e.MAX_VERTEX_UNIFORM_BLOCKS=35371]="MAX_VERTEX_UNIFORM_BLOCKS",e[e.MAX_FRAGMENT_UNIFORM_BLOCKS=35373]="MAX_FRAGMENT_UNIFORM_BLOCKS",e[e.MAX_COMBINED_UNIFORM_BLOCKS=35374]="MAX_COMBINED_UNIFORM_BLOCKS",e[e.MAX_UNIFORM_BUFFER_BINDINGS=35375]="MAX_UNIFORM_BUFFER_BINDINGS",e[e.MAX_UNIFORM_BLOCK_SIZE=35376]="MAX_UNIFORM_BLOCK_SIZE",e[e.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS=35377]="MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS",e[e.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS=35379]="MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS",e[e.UNIFORM_BUFFER_OFFSET_ALIGNMENT=35380]="UNIFORM_BUFFER_OFFSET_ALIGNMENT",e[e.ACTIVE_UNIFORM_BLOCKS=35382]="ACTIVE_UNIFORM_BLOCKS",e[e.UNIFORM_TYPE=35383]="UNIFORM_TYPE",e[e.UNIFORM_SIZE=35384]="UNIFORM_SIZE",e[e.UNIFORM_BLOCK_INDEX=35386]="UNIFORM_BLOCK_INDEX",e[e.UNIFORM_OFFSET=35387]="UNIFORM_OFFSET",e[e.UNIFORM_ARRAY_STRIDE=35388]="UNIFORM_ARRAY_STRIDE",e[e.UNIFORM_MATRIX_STRIDE=35389]="UNIFORM_MATRIX_STRIDE",e[e.UNIFORM_IS_ROW_MAJOR=35390]="UNIFORM_IS_ROW_MAJOR",e[e.UNIFORM_BLOCK_BINDING=35391]="UNIFORM_BLOCK_BINDING",e[e.UNIFORM_BLOCK_DATA_SIZE=35392]="UNIFORM_BLOCK_DATA_SIZE",e[e.UNIFORM_BLOCK_ACTIVE_UNIFORMS=35394]="UNIFORM_BLOCK_ACTIVE_UNIFORMS",e[e.UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES=35395]="UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES",e[e.UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER=35396]="UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER",e[e.UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER=35398]="UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER",e[e.OBJECT_TYPE=37138]="OBJECT_TYPE",e[e.SYNC_CONDITION=37139]="SYNC_CONDITION",e[e.SYNC_STATUS=37140]="SYNC_STATUS",e[e.SYNC_FLAGS=37141]="SYNC_FLAGS",e[e.SYNC_FENCE=37142]="SYNC_FENCE",e[e.SYNC_GPU_COMMANDS_COMPLETE=37143]="SYNC_GPU_COMMANDS_COMPLETE",e[e.UNSIGNALED=37144]="UNSIGNALED",e[e.SIGNALED=37145]="SIGNALED",e[e.ALREADY_SIGNALED=37146]="ALREADY_SIGNALED",e[e.TIMEOUT_EXPIRED=37147]="TIMEOUT_EXPIRED",e[e.CONDITION_SATISFIED=37148]="CONDITION_SATISFIED",e[e.WAIT_FAILED=37149]="WAIT_FAILED",e[e.SYNC_FLUSH_COMMANDS_BIT=1]="SYNC_FLUSH_COMMANDS_BIT",e[e.COLOR=6144]="COLOR",e[e.DEPTH=6145]="DEPTH",e[e.STENCIL=6146]="STENCIL",e[e.MIN=32775]="MIN",e[e.MAX=32776]="MAX",e[e.DEPTH_COMPONENT24=33190]="DEPTH_COMPONENT24",e[e.STREAM_READ=35041]="STREAM_READ",e[e.STREAM_COPY=35042]="STREAM_COPY",e[e.STATIC_READ=35045]="STATIC_READ",e[e.STATIC_COPY=35046]="STATIC_COPY",e[e.DYNAMIC_READ=35049]="DYNAMIC_READ",e[e.DYNAMIC_COPY=35050]="DYNAMIC_COPY",e[e.DEPTH_COMPONENT32F=36012]="DEPTH_COMPONENT32F",e[e.DEPTH32F_STENCIL8=36013]="DEPTH32F_STENCIL8",e[e.INVALID_INDEX=4294967295]="INVALID_INDEX",e[e.TIMEOUT_IGNORED=-1]="TIMEOUT_IGNORED",e[e.MAX_CLIENT_WAIT_TIMEOUT_WEBGL=37447]="MAX_CLIENT_WAIT_TIMEOUT_WEBGL",e[e.UNMASKED_VENDOR_WEBGL=37445]="UNMASKED_VENDOR_WEBGL",e[e.UNMASKED_RENDERER_WEBGL=37446]="UNMASKED_RENDERER_WEBGL",e[e.MAX_TEXTURE_MAX_ANISOTROPY_EXT=34047]="MAX_TEXTURE_MAX_ANISOTROPY_EXT",e[e.TEXTURE_MAX_ANISOTROPY_EXT=34046]="TEXTURE_MAX_ANISOTROPY_EXT",e[e.R16_EXT=33322]="R16_EXT",e[e.RG16_EXT=33324]="RG16_EXT",e[e.RGB16_EXT=32852]="RGB16_EXT",e[e.RGBA16_EXT=32859]="RGBA16_EXT",e[e.R16_SNORM_EXT=36760]="R16_SNORM_EXT",e[e.RG16_SNORM_EXT=36761]="RG16_SNORM_EXT",e[e.RGB16_SNORM_EXT=36762]="RGB16_SNORM_EXT",e[e.RGBA16_SNORM_EXT=36763]="RGBA16_SNORM_EXT",e[e.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",e[e.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",e[e.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",e[e.COMPRESSED_RED_RGTC1_EXT=36283]="COMPRESSED_RED_RGTC1_EXT",e[e.COMPRESSED_SIGNED_RED_RGTC1_EXT=36284]="COMPRESSED_SIGNED_RED_RGTC1_EXT",e[e.COMPRESSED_RED_GREEN_RGTC2_EXT=36285]="COMPRESSED_RED_GREEN_RGTC2_EXT",e[e.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT=36286]="COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT",e[e.COMPRESSED_RGBA_BPTC_UNORM_EXT=36492]="COMPRESSED_RGBA_BPTC_UNORM_EXT",e[e.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=36493]="COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT",e[e.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT=36494]="COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT",e[e.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT=36495]="COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT",e[e.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",e[e.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",e[e.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",e[e.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",e[e.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",e[e.COMPRESSED_RGBA8_ETC2_EAC=37493]="COMPRESSED_RGBA8_ETC2_EAC",e[e.COMPRESSED_SRGB8_ETC2=37494]="COMPRESSED_SRGB8_ETC2",e[e.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37495]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",e[e.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37496]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37497]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",e[e.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",e[e.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",e[e.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",e[e.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",e[e.COMPRESSED_RGBA_ASTC_5x4_KHR=37809]="COMPRESSED_RGBA_ASTC_5x4_KHR",e[e.COMPRESSED_RGBA_ASTC_5x5_KHR=37810]="COMPRESSED_RGBA_ASTC_5x5_KHR",e[e.COMPRESSED_RGBA_ASTC_6x5_KHR=37811]="COMPRESSED_RGBA_ASTC_6x5_KHR",e[e.COMPRESSED_RGBA_ASTC_6x6_KHR=37812]="COMPRESSED_RGBA_ASTC_6x6_KHR",e[e.COMPRESSED_RGBA_ASTC_8x5_KHR=37813]="COMPRESSED_RGBA_ASTC_8x5_KHR",e[e.COMPRESSED_RGBA_ASTC_8x6_KHR=37814]="COMPRESSED_RGBA_ASTC_8x6_KHR",e[e.COMPRESSED_RGBA_ASTC_8x8_KHR=37815]="COMPRESSED_RGBA_ASTC_8x8_KHR",e[e.COMPRESSED_RGBA_ASTC_10x5_KHR=37816]="COMPRESSED_RGBA_ASTC_10x5_KHR",e[e.COMPRESSED_RGBA_ASTC_10x6_KHR=37817]="COMPRESSED_RGBA_ASTC_10x6_KHR",e[e.COMPRESSED_RGBA_ASTC_10x8_KHR=37818]="COMPRESSED_RGBA_ASTC_10x8_KHR",e[e.COMPRESSED_RGBA_ASTC_10x10_KHR=37819]="COMPRESSED_RGBA_ASTC_10x10_KHR",e[e.COMPRESSED_RGBA_ASTC_12x10_KHR=37820]="COMPRESSED_RGBA_ASTC_12x10_KHR",e[e.COMPRESSED_RGBA_ASTC_12x12_KHR=37821]="COMPRESSED_RGBA_ASTC_12x12_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR=37840]="COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR=37841]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR=37842]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR=37843]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR=37844]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR=37845]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR=37846]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR=37847]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR=37848]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR=37849]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR=37850]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR=37851]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR=37852]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR",e[e.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR=37853]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR",e[e.QUERY_COUNTER_BITS_EXT=34916]="QUERY_COUNTER_BITS_EXT",e[e.CURRENT_QUERY_EXT=34917]="CURRENT_QUERY_EXT",e[e.QUERY_RESULT_EXT=34918]="QUERY_RESULT_EXT",e[e.QUERY_RESULT_AVAILABLE_EXT=34919]="QUERY_RESULT_AVAILABLE_EXT",e[e.TIME_ELAPSED_EXT=35007]="TIME_ELAPSED_EXT",e[e.TIMESTAMP_EXT=36392]="TIMESTAMP_EXT",e[e.GPU_DISJOINT_EXT=36795]="GPU_DISJOINT_EXT",e[e.COMPLETION_STATUS_KHR=37297]="COMPLETION_STATUS_KHR",e[e.DEPTH_CLAMP_EXT=34383]="DEPTH_CLAMP_EXT",e[e.FIRST_VERTEX_CONVENTION_WEBGL=36429]="FIRST_VERTEX_CONVENTION_WEBGL",e[e.LAST_VERTEX_CONVENTION_WEBGL=36430]="LAST_VERTEX_CONVENTION_WEBGL",e[e.PROVOKING_VERTEX_WEBL=36431]="PROVOKING_VERTEX_WEBL",e[e.POLYGON_MODE_WEBGL=2880]="POLYGON_MODE_WEBGL",e[e.POLYGON_OFFSET_LINE_WEBGL=10754]="POLYGON_OFFSET_LINE_WEBGL",e[e.LINE_WEBGL=6913]="LINE_WEBGL",e[e.FILL_WEBGL=6914]="FILL_WEBGL",e[e.MAX_CLIP_DISTANCES_WEBGL=3378]="MAX_CLIP_DISTANCES_WEBGL",e[e.MAX_CULL_DISTANCES_WEBGL=33529]="MAX_CULL_DISTANCES_WEBGL",e[e.MAX_COMBINED_CLIP_AND_CULL_DISTANCES_WEBGL=33530]="MAX_COMBINED_CLIP_AND_CULL_DISTANCES_WEBGL",e[e.CLIP_DISTANCE0_WEBGL=12288]="CLIP_DISTANCE0_WEBGL",e[e.CLIP_DISTANCE1_WEBGL=12289]="CLIP_DISTANCE1_WEBGL",e[e.CLIP_DISTANCE2_WEBGL=12290]="CLIP_DISTANCE2_WEBGL",e[e.CLIP_DISTANCE3_WEBGL=12291]="CLIP_DISTANCE3_WEBGL",e[e.CLIP_DISTANCE4_WEBGL=12292]="CLIP_DISTANCE4_WEBGL",e[e.CLIP_DISTANCE5_WEBGL=12293]="CLIP_DISTANCE5_WEBGL",e[e.CLIP_DISTANCE6_WEBGL=12294]="CLIP_DISTANCE6_WEBGL",e[e.CLIP_DISTANCE7_WEBGL=12295]="CLIP_DISTANCE7_WEBGL",e[e.POLYGON_OFFSET_CLAMP_EXT=36379]="POLYGON_OFFSET_CLAMP_EXT",e[e.LOWER_LEFT_EXT=36001]="LOWER_LEFT_EXT",e[e.UPPER_LEFT_EXT=36002]="UPPER_LEFT_EXT",e[e.NEGATIVE_ONE_TO_ONE_EXT=37726]="NEGATIVE_ONE_TO_ONE_EXT",e[e.ZERO_TO_ONE_EXT=37727]="ZERO_TO_ONE_EXT",e[e.CLIP_ORIGIN_EXT=37724]="CLIP_ORIGIN_EXT",e[e.CLIP_DEPTH_MODE_EXT=37725]="CLIP_DEPTH_MODE_EXT",e[e.SRC1_COLOR_WEBGL=35065]="SRC1_COLOR_WEBGL",e[e.SRC1_ALPHA_WEBGL=34185]="SRC1_ALPHA_WEBGL",e[e.ONE_MINUS_SRC1_COLOR_WEBGL=35066]="ONE_MINUS_SRC1_COLOR_WEBGL",e[e.ONE_MINUS_SRC1_ALPHA_WEBGL=35067]="ONE_MINUS_SRC1_ALPHA_WEBGL",e[e.MAX_DUAL_SOURCE_DRAW_BUFFERS_WEBGL=35068]="MAX_DUAL_SOURCE_DRAW_BUFFERS_WEBGL",e[e.MIRROR_CLAMP_TO_EDGE_EXT=34627]="MIRROR_CLAMP_TO_EDGE_EXT"})(Fm||(Fm={}));var mw={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,35725:null,36006:null,36007:null,34229:null,34964:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32926:!1,32928:!1,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],36389:null,36662:null,36663:null,35053:null,35055:null,35723:4352,36010:null,35977:!1,3333:4,3317:4,37440:!1,37441:!1,37443:37444,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},Wo=(e,t,r)=>t?e.enable(r):e.disable(r),eH=(e,t,r)=>e.hint(r,t),uu=(e,t,r)=>e.pixelStorei(r,t),rH=(e,t,r)=>{let i=r===36006?36009:36008;return e.bindFramebuffer(i,t)},dw=(e,t,r)=>{let s={34964:34962,36662:36662,36663:36663,35053:35051,35055:35052}[r];e.bindBuffer(s,t)};function TD(e){return Array.isArray(e)||ArrayBuffer.isView(e)&&!(e instanceof DataView)}var iH={3042:Wo,32773:(e,t)=>e.blendColor(...t),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(e,t)=>e.clearColor(...t),3107:(e,t)=>e.colorMask(...t),2884:Wo,2885:(e,t)=>e.cullFace(t),2929:Wo,2931:(e,t)=>e.clearDepth(t),2932:(e,t)=>e.depthFunc(t),2928:(e,t)=>e.depthRange(...t),2930:(e,t)=>e.depthMask(t),3024:Wo,35723:eH,35725:(e,t)=>e.useProgram(t),36007:(e,t)=>e.bindRenderbuffer(36161,t),36389:(e,t)=>e.bindTransformFeedback?.(36386,t),34229:(e,t)=>e.bindVertexArray(t),36006:rH,36010:rH,34964:dw,36662:dw,36663:dw,35053:dw,35055:dw,2886:(e,t)=>e.frontFace(t),33170:eH,2849:(e,t)=>e.lineWidth(t),32823:Wo,32824:"polygonOffset",10752:"polygonOffset",35977:Wo,32926:Wo,32928:Wo,32938:"sampleCoverage",32939:"sampleCoverage",3089:Wo,3088:(e,t)=>e.scissor(...t),2960:Wo,2961:(e,t)=>e.clearStencil(t),2968:(e,t)=>e.stencilMaskSeparate(1028,t),36005:(e,t)=>e.stencilMaskSeparate(1029,t),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(e,t)=>e.viewport(...t),34383:Wo,10754:Wo,12288:Wo,12289:Wo,12290:Wo,12291:Wo,12292:Wo,12293:Wo,12294:Wo,12295:Wo,3333:uu,3317:uu,37440:uu,37441:uu,37443:uu,3330:uu,3332:uu,3331:uu,3314:uu,32878:uu,3316:uu,3315:uu,32877:uu,framebuffer:(e,t)=>{let r=t&&"handle"in t?t.handle:t;return e.bindFramebuffer(36160,r)},blend:(e,t)=>t?e.enable(3042):e.disable(3042),blendColor:(e,t)=>e.blendColor(...t),blendEquation:(e,t)=>{let r=typeof t=="number"?[t,t]:t;e.blendEquationSeparate(...r)},blendFunc:(e,t)=>{let r=t?.length===2?[...t,...t]:t;e.blendFuncSeparate(...r)},clearColor:(e,t)=>e.clearColor(...t),clearDepth:(e,t)=>e.clearDepth(t),clearStencil:(e,t)=>e.clearStencil(t),colorMask:(e,t)=>e.colorMask(...t),cull:(e,t)=>t?e.enable(2884):e.disable(2884),cullFace:(e,t)=>e.cullFace(t),depthTest:(e,t)=>t?e.enable(2929):e.disable(2929),depthFunc:(e,t)=>e.depthFunc(t),depthMask:(e,t)=>e.depthMask(t),depthRange:(e,t)=>e.depthRange(...t),dither:(e,t)=>t?e.enable(3024):e.disable(3024),derivativeHint:(e,t)=>{e.hint(35723,t)},frontFace:(e,t)=>e.frontFace(t),mipmapHint:(e,t)=>e.hint(33170,t),lineWidth:(e,t)=>e.lineWidth(t),polygonOffsetFill:(e,t)=>t?e.enable(32823):e.disable(32823),polygonOffset:(e,t)=>e.polygonOffset(...t),sampleCoverage:(e,t)=>e.sampleCoverage(...t),scissorTest:(e,t)=>t?e.enable(3089):e.disable(3089),scissor:(e,t)=>e.scissor(...t),stencilTest:(e,t)=>t?e.enable(2960):e.disable(2960),stencilMask:(e,t)=>{t=TD(t)?t:[t,t];let[r,i]=t;e.stencilMaskSeparate(1028,r),e.stencilMaskSeparate(1029,i)},stencilFunc:(e,t)=>{t=TD(t)&&t.length===3?[...t,...t]:t;let[r,i,s,n,o,a]=t;e.stencilFuncSeparate(1028,r,i,s),e.stencilFuncSeparate(1029,n,o,a)},stencilOp:(e,t)=>{t=TD(t)&&t.length===3?[...t,...t]:t;let[r,i,s,n,o,a]=t;e.stencilOpSeparate(1028,r,i,s),e.stencilOpSeparate(1029,n,o,a)},viewport:(e,t)=>e.viewport(...t)};function fo(e,t,r){return t[e]!==void 0?t[e]:r[e]}var nH={blendEquation:(e,t,r)=>e.blendEquationSeparate(fo(32777,t,r),fo(34877,t,r)),blendFunc:(e,t,r)=>e.blendFuncSeparate(fo(32969,t,r),fo(32968,t,r),fo(32971,t,r),fo(32970,t,r)),polygonOffset:(e,t,r)=>e.polygonOffset(fo(32824,t,r),fo(10752,t,r)),sampleCoverage:(e,t,r)=>e.sampleCoverage(fo(32938,t,r),fo(32939,t,r)),stencilFuncFront:(e,t,r)=>e.stencilFuncSeparate(1028,fo(2962,t,r),fo(2967,t,r),fo(2963,t,r)),stencilFuncBack:(e,t,r)=>e.stencilFuncSeparate(1029,fo(34816,t,r),fo(36003,t,r),fo(36004,t,r)),stencilOpFront:(e,t,r)=>e.stencilOpSeparate(1028,fo(2964,t,r),fo(2965,t,r),fo(2966,t,r)),stencilOpBack:(e,t,r)=>e.stencilOpSeparate(1029,fo(34817,t,r),fo(34818,t,r),fo(34819,t,r))},SD={enable:(e,t)=>e({[t]:!0}),disable:(e,t)=>e({[t]:!1}),pixelStorei:(e,t,r)=>e({[t]:r}),hint:(e,t,r)=>e({[t]:r}),useProgram:(e,t)=>e({35725:t}),bindRenderbuffer:(e,t,r)=>e({36007:r}),bindTransformFeedback:(e,t,r)=>e({36389:r}),bindVertexArray:(e,t)=>e({34229:t}),bindFramebuffer:(e,t,r)=>{switch(t){case 36160:return e({36006:r,36010:r});case 36009:return e({36006:r});case 36008:return e({36010:r});default:return null}},bindBuffer:(e,t,r)=>{let i={34962:[34964],36662:[36662],36663:[36663],35051:[35053],35052:[35055]}[t];return i?e({[i]:r}):{valueChanged:!0}},blendColor:(e,t,r,i,s)=>e({32773:new Float32Array([t,r,i,s])}),blendEquation:(e,t)=>e({32777:t,34877:t}),blendEquationSeparate:(e,t,r)=>e({32777:t,34877:r}),blendFunc:(e,t,r)=>e({32969:t,32968:r,32971:t,32970:r}),blendFuncSeparate:(e,t,r,i,s)=>e({32969:t,32968:r,32971:i,32970:s}),clearColor:(e,t,r,i,s)=>e({3106:new Float32Array([t,r,i,s])}),clearDepth:(e,t)=>e({2931:t}),clearStencil:(e,t)=>e({2961:t}),colorMask:(e,t,r,i,s)=>e({3107:[t,r,i,s]}),cullFace:(e,t)=>e({2885:t}),depthFunc:(e,t)=>e({2932:t}),depthRange:(e,t,r)=>e({2928:new Float32Array([t,r])}),depthMask:(e,t)=>e({2930:t}),frontFace:(e,t)=>e({2886:t}),lineWidth:(e,t)=>e({2849:t}),polygonOffset:(e,t,r)=>e({32824:t,10752:r}),sampleCoverage:(e,t,r)=>e({32938:t,32939:r}),scissor:(e,t,r,i,s)=>e({3088:new Int32Array([t,r,i,s])}),stencilMask:(e,t)=>e({2968:t,36005:t}),stencilMaskSeparate:(e,t,r)=>e({[t===1028?2968:36005]:r}),stencilFunc:(e,t,r,i)=>e({2962:t,2967:r,2963:i,34816:t,36003:r,36004:i}),stencilFuncSeparate:(e,t,r,i,s)=>e({[t===1028?2962:34816]:r,[t===1028?2967:36003]:i,[t===1028?2963:36004]:s}),stencilOp:(e,t,r,i)=>e({2964:t,2965:r,2966:i,34817:t,34818:r,34819:i}),stencilOpSeparate:(e,t,r,i,s)=>e({[t===1028?2964:34817]:r,[t===1028?2965:34818]:i,[t===1028?2966:34819]:s}),viewport:(e,t,r,i,s)=>e({2978:[t,r,i,s]})},ap=(e,t)=>e.isEnabled(t),ED={3042:ap,2884:ap,2929:ap,3024:ap,32823:ap,32926:ap,32928:ap,3089:ap,2960:ap,35977:ap},sH=new Set([34016,36388,36387,35983,35368,34965,35739,35738,3074,34853,34854,34855,34856,34857,34858,34859,34860,34861,34862,34863,34864,34865,34866,34867,34868,35097,32873,35869,32874,34068]);function Jh(e,t){if(r_t(t))return;let r={};for(let s in t){let n=Number(s),o=iH[s];o&&(typeof o=="string"?r[o]=!0:o(e,t[s],n))}let i=e.state&&e.state.cache;if(i)for(let s in r){let n=nH[s];n(e,t,i)}}function oE(e,t=mw){if(typeof t=="number"){let s=t,n=ED[s];return n?n(e,s):e.getParameter(s)}let r=Array.isArray(t)?t:Object.keys(t),i={};for(let s of r){let n=ED[s];i[s]=n?n(e,Number(s)):e.getParameter(Number(s))}return i}function oH(e){Jh(e,mw)}function r_t(e){for(let t in e)return!1;return!0}function aH(e,t){if(e===t)return!0;let r=Array.isArray(e)||ArrayBuffer.isView(e),i=Array.isArray(t)||ArrayBuffer.isView(t);if(r&&i&&e.length===t.length){for(let s=0;s<e.length;++s)if(e[s]!==t[s])return!1;return!0}return!1}var ID=class{gl;program=null;stateStack=[];enable=!0;cache;log;constructor(t,{copyState:r=!1,log:i=()=>{}}={}){this.gl=t,this.cache=r?oE(t):Object.assign({},mw),this.log=i,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(t={}){this.stateStack.push({})}pop(){Qi(this.stateStack.length>0);let t=this.stateStack[this.stateStack.length-1];Jh(this.gl,t),this.stateStack.pop()}_updateCache(t){let r=!1,i,s=this.stateStack.length>0?this.stateStack[this.stateStack.length-1]:null;for(let n in t){Qi(n!==void 0);let o=t[n],a=this.cache[n];aH(o,a)||(r=!0,i=a,s&&!(n in s)&&(s[n]=a),this.cache[n]=o)}return{valueChanged:r,oldValue:i}}};function Kg(e){return e.state}function MD(e,t){let{enable:r=!0,copyState:i}=t;if(Qi(i!==void 0),!e.state){e.state=new ID(e,{copyState:i}),n_t(e);for(let n in SD){let o=SD[n];i_t(e,n,o)}lH(e,"getParameter"),lH(e,"isEnabled")}let s=Kg(e);return s.enable=r,e}function zm(e){let t=Kg(e);t||(MD(e,{copyState:!1}),t=Kg(e)),t.push()}function zd(e){let t=Kg(e);Qi(t),t.pop()}function lH(e,t){let r=e[t].bind(e);e[t]=function(s){if(s===void 0||sH.has(s))return r(s);let n=Kg(e);return s in n.cache||(n.cache[s]=r(s)),n.enable?n.cache[s]:r(s)},Object.defineProperty(e[t],"name",{value:`${t}-from-cache`,configurable:!1})}function i_t(e,t,r){if(!e[t])return;let i=e[t].bind(e);e[t]=function(...n){let o=Kg(e),{valueChanged:a,oldValue:h}=r(o._updateCache,...n);return a&&i(...n),h},Object.defineProperty(e[t],"name",{value:`${t}-to-cache`,configurable:!1})}function n_t(e){let t=e.useProgram.bind(e);e.useProgram=function(i){let s=Kg(e);s.program!==i&&(t(i),s.program=i)}}var s_t={powerPreference:"high-performance",onContextLost:()=>console.error("WebGL context lost"),onContextRestored:()=>console.info("WebGL context restored")};function cH(e,t){t={...s_t,...t};let r=null,i=n=>r=n.statusMessage||r;e.addEventListener("webglcontextcreationerror",i,!1);let s=null;if(s||=e.getContext("webgl2",t),e.removeEventListener("webglcontextcreationerror",i,!1),!s)throw new Error(`Failed to create WebGL context: ${r||"Unknown error"}`);if(t.onContextLost){let{onContextLost:n}=t;e.addEventListener("webglcontextlost",o=>n(o),!1)}if(t.onContextRestored){let{onContextRestored:n}=t;e.addEventListener("webglcontextrestored",o=>n(o),!1)}return s}function Ku(e,t,r){return r[t]===void 0&&(r[t]=e.getExtension(t)||null),r[t]}function uH(e,t){let r=e.getParameter(7936),i=e.getParameter(7937);Ku(e,"WEBGL_debug_renderer_info",t);let s=t.WEBGL_debug_renderer_info,n=e.getParameter(s?s.UNMASKED_VENDOR_WEBGL:7936),o=e.getParameter(s?s.UNMASKED_RENDERER_WEBGL:7937),a=n||r,h=o||i,p=e.getParameter(7938),g=hH(a,h),v=o_t(a,h),T=a_t(a,h);return{type:"webgl",gpu:g,gpuType:T,gpuBackend:v,vendor:a,renderer:h,version:p,shadingLanguage:"glsl",shadingLanguageVersion:300}}function hH(e,t){return/NVIDIA/i.exec(e)||/NVIDIA/i.exec(t)?"nvidia":/INTEL/i.exec(e)||/INTEL/i.exec(t)?"intel":/Apple/i.exec(e)||/Apple/i.exec(t)?"apple":/AMD/i.exec(e)||/AMD/i.exec(t)||/ATI/i.exec(e)||/ATI/i.exec(t)?"amd":/SwiftShader/i.exec(e)||/SwiftShader/i.exec(t)?"software":"unknown"}function o_t(e,t){return/Metal/i.exec(e)||/Metal/i.exec(t)?"metal":/ANGLE/i.exec(e)||/ANGLE/i.exec(t)?"opengl":"unknown"}function a_t(e,t){if(/SwiftShader/i.exec(e)||/SwiftShader/i.exec(t))return"cpu";switch(hH(e,t)){case"intel":return"integrated";case"software":return"cpu";case"unknown":return"unknown";default:return"discrete"}}function aE(e){switch(e){case"uint8":return 5121;case"sint8":return 5120;case"unorm8":return 5121;case"snorm8":return 5120;case"uint16":return 5123;case"sint16":return 5122;case"unorm16":return 5123;case"snorm16":return 5122;case"uint32":return 5125;case"sint32":return 5124;case"float16":return 5131;case"float32":return 5126}throw new Error(String(e))}var yl="texture-compression-bc",ls="texture-compression-astc",lp="texture-compression-etc2",l_t="texture-compression-etc1-webgl",lE="texture-compression-pvrtc-webgl",CD="texture-compression-atc-webgl",Aw="float32-renderable-webgl",PD="float16-renderable-webgl",c_t="rgb9e5ufloat_renderable-webgl",RD="snorm8-renderable-webgl",gw="norm16-renderable-webgl",kD="snorm16-renderable-webgl",cE="float32-filterable",fH="float16-filterable-webgl",_w="WEBGL_compressed_texture_s3tc",yw="WEBGL_compressed_texture_s3tc_srgb",Ky="EXT_texture_compression_rgtc",Jy="EXT_texture_compression_bptc",u_t="WEBGL_compressed_texture_etc",h_t="WEBGL_compressed_texture_astc",f_t="WEBGL_compressed_texture_etc1",p_t="WEBGL_compressed_texture_pvrtc",d_t="WEBGL_compressed_texture_atc",pH="EXT_texture_norm16",dH="EXT_render_snorm",m_t="EXT_color_buffer_float",uE={"float32-renderable-webgl":["EXT_color_buffer_float"],"float16-renderable-webgl":["EXT_color_buffer_half_float"],"rgb9e5ufloat_renderable-webgl":["WEBGL_render_shared_exponent"],"snorm8-renderable-webgl":[dH],"norm16-renderable-webgl":[pH],"snorm16-renderable-webgl":[pH,dH],"float32-filterable":["OES_texture_float_linear"],"float16-filterable-webgl":["OES_texture_half_float_linear"],"texture-filterable-anisotropic-webgl":["EXT_texture_filter_anisotropic"],"texture-blend-float-webgl":["EXT_float_blend"],"texture-compression-bc":[_w,yw,Ky,Jy],"texture-compression-bc5-webgl":[Ky],"texture-compression-bc7-webgl":[Jy],"texture-compression-etc2":[u_t],"texture-compression-astc":[h_t],"texture-compression-etc1-webgl":[f_t],"texture-compression-pvrtc-webgl":[p_t],"texture-compression-atc-webgl":[d_t]};function mH(e){return e in uE}function AH(e,t,r){return(uE[t]||[]).every(s=>Ku(e,s,r))}var hE={"rgb8unorm-unsized":{gl:6407,b:4,c:2,bpp:4,dataFormat:6407,types:[5121,33635]},"rgba8unorm-unsized":{gl:6408,b:4,c:2,bpp:4,dataFormat:6408,types:[5121,32819,32820]},r8unorm:{gl:33321,b:1,c:1,rb:!0},r8snorm:{gl:36756,b:1,c:1,render:RD},r8uint:{gl:33330,b:1,c:1,rb:!0},r8sint:{gl:33329,b:1,c:1,rb:!0},rg8unorm:{gl:33323,b:2,c:2,rb:!0},rg8snorm:{gl:36757,b:2,c:2,render:RD},rg8uint:{gl:33336,b:2,c:2,rb:!0},rg8sint:{gl:33335,b:2,c:2,rb:!0},r16uint:{gl:33332,b:2,c:1,rb:!0},r16sint:{gl:33331,b:2,c:1,rb:!0},r16float:{gl:33325,b:2,c:1,render:PD,filter:"float16-filterable-webgl",rb:!0},"r16unorm-webgl":{gl:33322,b:2,c:1,f:gw,rb:!0},"r16snorm-webgl":{gl:36760,b:2,c:1,f:kD},"rgba4unorm-webgl":{gl:32854,b:2,c:4,wgpu:!1,rb:!0},"rgb565unorm-webgl":{gl:36194,b:2,c:4,wgpu:!1,rb:!0},"rgb5a1unorm-webgl":{gl:32855,b:2,c:4,wgpu:!1,rb:!0},"rgb8unorm-webgl":{gl:32849,b:3,c:3,wgpu:!1},"rgb8snorm-webgl":{gl:36758,b:3,c:3,wgpu:!1},rgba8unorm:{gl:32856,b:4,c:2,bpp:4},"rgba8unorm-srgb":{gl:35907,b:4,c:4,bpp:4},rgba8snorm:{gl:36759,b:4,c:4,render:RD},rgba8uint:{gl:36220,b:4,c:4,bpp:4},rgba8sint:{gl:36238,b:4,c:4,bpp:4},bgra8unorm:{b:4,c:4},"bgra8unorm-srgb":{b:4,c:4},rg16uint:{gl:33338,b:4,c:1,bpp:4},rg16sint:{gl:33337,b:4,c:2,bpp:4},rg16float:{gl:33327,bpp:4,b:4,c:2,render:PD,filter:fH,rb:!0},"rg16unorm-webgl":{gl:33324,b:2,c:2,render:gw},"rg16snorm-webgl":{gl:36761,b:2,c:2,render:kD},r32uint:{gl:33334,b:4,c:1,bpp:4,rb:!0},r32sint:{gl:33333,b:4,c:1,bpp:4,rb:!0},r32float:{gl:33326,bpp:4,b:4,c:1,render:Aw,filter:cE},rgb9e5ufloat:{gl:35901,b:4,c:3,p:1,render:c_t},rg11b10ufloat:{gl:35898,b:4,c:3,p:1,render:Aw,rb:!0},rgb10a2unorm:{gl:32857,b:4,c:4,p:1,rb:!0},"rgb10a2uint-webgl":{b:4,c:4,gl:36975,p:1,wgpu:!1,bpp:4,rb:!0},"rgb16unorm-webgl":{gl:32852,b:2,c:3,f:gw},"rgb16snorm-webgl":{gl:36762,b:2,c:3,f:gw},rg32uint:{gl:33340,b:8,c:2,rb:!0},rg32sint:{gl:33339,b:8,c:2,rb:!0},rg32float:{gl:33328,b:8,c:2,render:Aw,filter:cE,rb:!0},rgba16uint:{gl:36214,b:8,c:4,rb:!0},rgba16sint:{gl:36232,b:8,c:4,rb:!0},rgba16float:{gl:34842,b:8,c:4,render:PD,filter:fH},"rgba16unorm-webgl":{gl:32859,b:2,c:4,render:gw,rb:!0},"rgba16snorm-webgl":{gl:36763,b:2,c:4,render:kD},"rgb32float-webgl":{gl:34837,render:Aw,filter:cE,gl2ext:m_t,dataFormat:6407,types:[5126]},rgba32uint:{gl:36208,b:16,c:4,rb:!0},rgba32sint:{gl:36226,b:16,c:4,rb:!0},rgba32float:{gl:34836,b:16,c:4,render:Aw,filter:cE,rb:!0},stencil8:{gl:36168,b:1,c:1,attachment:36128,rb:!0},depth16unorm:{gl:33189,b:2,c:1,attachment:36096,dataFormat:6402,types:[5123],rb:!0},depth24plus:{gl:33190,b:3,c:1,attachment:36096,dataFormat:6402,types:[5125]},depth32float:{gl:36012,b:4,c:1,attachment:36096,dataFormat:6402,types:[5126],rb:!0},"depth24plus-stencil8":{gl:35056,b:4,c:2,p:1,attachment:33306,rb:!0,depthTexture:!0,dataFormat:34041,types:[34042]},"depth24unorm-stencil8":{gl:35056,b:4,c:2,p:1,attachment:33306,dataFormat:34041,types:[34042],rb:!0},"depth32float-stencil8":{gl:36013,b:5,c:2,p:1,attachment:33306,dataFormat:34041,types:[36269],rb:!0},"bc1-rgb-unorm-webgl":{gl:33776,x:_w,f:yl},"bc1-rgb-unorm-srgb-webgl":{gl:35916,x:yw,f:yl},"bc1-rgba-unorm":{gl:33777,x:_w,f:yl},"bc1-rgba-unorm-srgb":{gl:35916,x:yw,f:yl},"bc2-rgba-unorm":{gl:33778,x:_w,f:yl},"bc2-rgba-unorm-srgb":{gl:35918,x:yw,f:yl},"bc3-rgba-unorm":{gl:33779,x:_w,f:yl},"bc3-rgba-unorm-srgb":{gl:35919,x:yw,f:yl},"bc4-r-unorm":{gl:36283,x:Ky,f:yl},"bc4-r-snorm":{gl:36284,x:Ky,f:yl},"bc5-rg-unorm":{gl:36285,x:Ky,f:yl},"bc5-rg-snorm":{gl:36286,x:Ky,f:yl},"bc6h-rgb-ufloat":{gl:36495,x:Jy,f:yl},"bc6h-rgb-float":{gl:36494,x:Jy,f:yl},"bc7-rgba-unorm":{gl:36492,x:Jy,f:yl},"bc7-rgba-unorm-srgb":{gl:36493,x:Jy,f:yl},"etc2-rgb8unorm":{gl:37492,f:lp},"etc2-rgb8unorm-srgb":{gl:37494,f:lp},"etc2-rgb8a1unorm":{gl:37496,f:lp},"etc2-rgb8a1unorm-srgb":{gl:37497,f:lp},"etc2-rgba8unorm":{gl:37493,f:lp},"etc2-rgba8unorm-srgb":{gl:37495,f:lp},"eac-r11unorm":{gl:37488,f:lp},"eac-r11snorm":{gl:37489,f:lp},"eac-rg11unorm":{gl:37490,f:lp},"eac-rg11snorm":{gl:37491,f:lp},"astc-4x4-unorm":{gl:37808,f:ls},"astc-4x4-unorm-srgb":{gl:37840,f:ls},"astc-5x4-unorm":{gl:37809,f:ls},"astc-5x4-unorm-srgb":{gl:37841,f:ls},"astc-5x5-unorm":{gl:37810,f:ls},"astc-5x5-unorm-srgb":{gl:37842,f:ls},"astc-6x5-unorm":{gl:37811,f:ls},"astc-6x5-unorm-srgb":{gl:37843,f:ls},"astc-6x6-unorm":{gl:37812,f:ls},"astc-6x6-unorm-srgb":{gl:37844,f:ls},"astc-8x5-unorm":{gl:37813,f:ls},"astc-8x5-unorm-srgb":{gl:37845,f:ls},"astc-8x6-unorm":{gl:37814,f:ls},"astc-8x6-unorm-srgb":{gl:37846,f:ls},"astc-8x8-unorm":{gl:37815,f:ls},"astc-8x8-unorm-srgb":{gl:37847,f:ls},"astc-10x5-unorm":{gl:37819,f:ls},"astc-10x5-unorm-srgb":{gl:37851,f:ls},"astc-10x6-unorm":{gl:37817,f:ls},"astc-10x6-unorm-srgb":{gl:37849,f:ls},"astc-10x8-unorm":{gl:37818,f:ls},"astc-10x8-unorm-srgb":{gl:37850,f:ls},"astc-10x10-unorm":{gl:37819,f:ls},"astc-10x10-unorm-srgb":{gl:37851,f:ls},"astc-12x10-unorm":{gl:37820,f:ls},"astc-12x10-unorm-srgb":{gl:37852,f:ls},"astc-12x12-unorm":{gl:37821,f:ls},"astc-12x12-unorm-srgb":{gl:37853,f:ls},"pvrtc-rgb4unorm-webgl":{gl:35840,f:lE},"pvrtc-rgba4unorm-webgl":{gl:35842,f:lE},"pvrtc-rbg2unorm-webgl":{gl:35841,f:lE},"pvrtc-rgba2unorm-webgl":{gl:35843,f:lE},"etc1-rbg-unorm-webgl":{gl:36196,f:l_t},"atc-rgb-unorm-webgl":{gl:35986,f:CD},"atc-rgba-unorm-webgl":{gl:35986,f:CD},"atc-rgbai-unorm-webgl":{gl:34798,f:CD}},A_t={6403:1,36244:1,33319:2,33320:2,6407:3,36248:3,6408:4,36249:4,6402:1,34041:1,6406:1,6409:1,6410:2},g_t={5126:4,5125:4,5124:4,5123:2,5122:2,5131:2,5120:1,5121:1};function fE(e,t,r){let i=hE[t];if(!i||i.gl===void 0)return!1;let s=i.x||i.gl2ext;return s?!!Ku(e,s,r):!0}function DD(e){let r=hE[e]?.gl;if(r===void 0)throw new Error(`Unsupported texture format ${e}`);return r}function gH(e,t,r){if(!fE(e,t,r)||t.startsWith("depth")||t.startsWith("stencil"))return!1;try{if(o5(t).signed)return!1}catch{return!1}return t.endsWith("32float")?!!Ku(e,"OES_texture_float_linear, extensions",r):t.endsWith("16float")?!!Ku(e,"OES_texture_half_float_linear, extensions",r):!0}function _H(e,t,r){return!(!fE(e,t,r)||typeof t=="number")}function t2(e){let t=hE[e],r=DD(e),i=o5(e);return{format:r,dataFormat:t?.dataFormat||__t(i.format,i.integer,i.normalized,r),type:i.dataType?aE(i.dataType):t?.types?.[0]||5121,compressed:i.compressed}}function yH(e){let t=hE[e];if(!t?.attachment)throw new Error(`${e} is not a depth stencil format`);return t.attachment}function OD(e){let t=t2(e),r=A_t[t.dataFormat]||4,i=g_t[t.type]||1;return r*i}function __t(e,t,r,i){if(i===6408||i===6407)return i;switch(e){case"r":return t&&!r?36244:6403;case"rg":return t&&!r?33320:33319;case"rgb":return t&&!r?36248:6407;case"rgba":return t&&!r?36249:6408;default:return 6408}}var xH={"depth-clip-control":"EXT_depth_clamp","timer-query-webgl":"EXT_disjoint_timer_query_webgl2","compilation-status-async-webgl":"KHR_parallel_shader_compile","polygon-mode-webgl":"WEBGL_polygon_mode","provoking-vertex-webgl":"WEBGL_provoking_vertex","shader-clip-cull-distance-webgl":"WEBGL_clip_cull_distance","shader-noperspective-interpolation-webgl":"NV_shader_noperspective_interpolation","shader-conservative-depth-webgl":"EXT_conservative_depth"},pE=class extends vv{gl;extensions;testedFeatures=new Set;constructor(t,r,i){super([],i),this.gl=t,this.extensions=r,Ku(t,"EXT_color_buffer_float",r)}*[Symbol.iterator](){let t=this.getFeatures();for(let r of t)this.has(r)&&(yield r);return[]}has(t){return this.disabledFeatures[t]?!1:(this.testedFeatures.has(t)||(this.testedFeatures.add(t),mH(t)&&AH(this.gl,t,this.extensions)&&this.features.add(t),this.getWebGLFeature(t)&&this.features.add(t)),this.features.has(t))}initializeFeatures(){let t=this.getFeatures().filter(r=>r!=="polygon-mode-webgl");for(let r of t)this.has(r)}getFeatures(){return[...Object.keys(xH),...Object.keys(uE)]}getWebGLFeature(t){let r=xH[t];return typeof r=="string"?!!Ku(this.gl,r,this.extensions):!!r}};var dE=class extends bv{get maxTextureDimension1D(){return 0}get maxTextureDimension2D(){return this.getParameter(3379)}get maxTextureDimension3D(){return this.getParameter(32883)}get maxTextureArrayLayers(){return this.getParameter(35071)}get maxBindGroups(){return 0}get maxDynamicUniformBuffersPerPipelineLayout(){return 0}get maxDynamicStorageBuffersPerPipelineLayout(){return 0}get maxSampledTexturesPerShaderStage(){return this.getParameter(35660)}get maxSamplersPerShaderStage(){return this.getParameter(35661)}get maxStorageBuffersPerShaderStage(){return 0}get maxStorageTexturesPerShaderStage(){return 0}get maxUniformBuffersPerShaderStage(){return this.getParameter(35375)}get maxUniformBufferBindingSize(){return this.getParameter(35376)}get maxStorageBufferBindingSize(){return 0}get minUniformBufferOffsetAlignment(){return this.getParameter(35380)}get minStorageBufferOffsetAlignment(){return 0}get maxVertexBuffers(){return 16}get maxVertexAttributes(){return this.getParameter(34921)}get maxVertexBufferArrayStride(){return 2048}get maxInterStageShaderComponents(){return this.getParameter(35659)}get maxComputeWorkgroupStorageSize(){return 0}get maxComputeInvocationsPerWorkgroup(){return 0}get maxComputeWorkgroupSizeX(){return 0}get maxComputeWorkgroupSizeY(){return 0}get maxComputeWorkgroupSizeZ(){return 0}get maxComputeWorkgroupsPerDimension(){return 0}gl;limits={};constructor(t){super(),this.gl=t}getParameter(t){return this.limits[t]===void 0&&(this.limits[t]=this.gl.getParameter(t)),this.limits[t]}};function Ju(e,t,r){if(y_t(t))return r(e);let{nocatch:i=!0}=t;zm(e),Jh(e,t);let s;if(i)s=r(e),zd(e);else try{s=r(e)}finally{zd(e)}return s}function y_t(e){for(let t in e)return!1;return!0}function vH(e,t,r,i){if(Em(t))return i(e);let s=e;zm(s.gl);try{return x_t(e,t),Jh(s.gl,r),i(e)}finally{zd(s.gl)}}function x_t(e,t){let r=e,{gl:i}=r;if(t.cullMode)switch(t.cullMode){case"none":i.disable(2884);break;case"front":i.enable(2884),i.cullFace(1028);break;case"back":i.enable(2884),i.cullFace(1029);break}if(t.frontFace&&i.frontFace(Jg("frontFace",t.frontFace,{ccw:2305,cw:2304})),t.unclippedDepth&&e.features.has("depth-clip-control")&&i.enable(34383),t.depthBias!==void 0&&(i.enable(32823),i.polygonOffset(t.depthBias,t.depthBiasSlopeScale||0)),t.provokingVertex&&e.features.has("provoking-vertex-webgl")){let n=r.getExtension("WEBGL_provoking_vertex").WEBGL_provoking_vertex,o=Jg("provokingVertex",t.provokingVertex,{first:36429,last:36430});n?.provokingVertexWEBGL(o)}if((t.polygonMode||t.polygonOffsetLine)&&e.features.has("polygon-mode-webgl")){if(t.polygonMode){let n=r.getExtension("WEBGL_polygon_mode").WEBGL_polygon_mode,o=Jg("polygonMode",t.polygonMode,{fill:6914,line:6913});n?.polygonModeWEBGL(1028,o),n?.polygonModeWEBGL(1029,o)}t.polygonOffsetLine&&i.enable(10754)}if(e.features.has("shader-clip-cull-distance-webgl")&&(t.clipDistance0&&i.enable(12288),t.clipDistance1&&i.enable(12289),t.clipDistance2&&i.enable(12290),t.clipDistance3&&i.enable(12291),t.clipDistance4&&i.enable(12292),t.clipDistance5&&i.enable(12293),t.clipDistance6&&i.enable(12294),t.clipDistance7&&i.enable(12295)),t.depthWriteEnabled!==void 0&&i.depthMask(v_t("depthWriteEnabled",t.depthWriteEnabled)),t.depthCompare&&(t.depthCompare!=="always"?i.enable(2929):i.disable(2929),i.depthFunc(AE("depthCompare",t.depthCompare))),t.stencilWriteMask){let s=t.stencilWriteMask;i.stencilMaskSeparate(1028,s),i.stencilMaskSeparate(1029,s)}if(t.stencilReadMask&&Ce.warn("stencilReadMask not supported under WebGL"),t.stencilCompare){let s=t.stencilReadMask||4294967295,n=AE("depthCompare",t.stencilCompare);t.stencilCompare!=="always"?i.enable(2960):i.disable(2960),i.stencilFuncSeparate(1028,n,0,s),i.stencilFuncSeparate(1029,n,0,s)}if(t.stencilPassOperation&&t.stencilFailOperation&&t.stencilDepthFailOperation){let s=BD("stencilPassOperation",t.stencilPassOperation),n=BD("stencilFailOperation",t.stencilFailOperation),o=BD("stencilDepthFailOperation",t.stencilDepthFailOperation);i.stencilOpSeparate(1028,n,o,s),i.stencilOpSeparate(1029,n,o,s)}if(t.blendColorOperation||t.blendAlphaOperation){i.enable(3042);let s=bH("blendColorOperation",t.blendColorOperation||"add"),n=bH("blendAlphaOperation",t.blendAlphaOperation||"add");i.blendEquationSeparate(s,n);let o=mE("blendColorSrcFactor",t.blendColorSrcFactor||"one"),a=mE("blendColorDstFactor",t.blendColorDstFactor||"zero"),h=mE("blendAlphaSrcFactor",t.blendAlphaSrcFactor||"one"),p=mE("blendAlphaDstFactor",t.blendAlphaDstFactor||"zero");i.blendFuncSeparate(o,a,h,p)}}function AE(e,t){return Jg(e,t,{never:512,less:513,equal:514,"less-equal":515,greater:516,"not-equal":517,"greater-equal":518,always:519})}function BD(e,t){return Jg(e,t,{keep:7680,zero:0,replace:7681,invert:5386,"increment-clamp":7682,"decrement-clamp":7683,"increment-wrap":34055,"decrement-wrap":34056})}function bH(e,t){return Jg(e,t,{add:32774,subtract:32778,"reverse-subtract":32779,min:32775,max:32776})}function mE(e,t){return Jg(e,t,{one:1,zero:0,"src-color":768,"one-minus-src-color":769,"dst-color":774,"one-minus-dst-color":775,"src-alpha":770,"one-minus-src-alpha":771,"dst-alpha":772,"one-minus-dst-alpha":773,"src-alpha-saturated":776,"constant-color":32769,"one-minus-constant-color":32770,"constant-alpha":32771,"one-minus-constant-alpha":32772})}function b_t(e,t){return`Illegal parameter ${t} for ${e}`}function Jg(e,t,r){if(!(t in r))throw new Error(b_t(e,t));return r[t]}function v_t(e,t){return t}function gE(e){let t={};return e.addressModeU&&(t[10242]=ND(e.addressModeU)),e.addressModeV&&(t[10243]=ND(e.addressModeV)),e.addressModeW&&(t[32882]=ND(e.addressModeW)),e.magFilter&&(t[10240]=wH(e.magFilter)),(e.minFilter||e.mipmapFilter)&&(t[10241]=w_t(e.minFilter||"linear",e.mipmapFilter)),e.lodMinClamp!==void 0&&(t[33082]=e.lodMinClamp),e.lodMaxClamp!==void 0&&(t[33083]=e.lodMaxClamp),e.type==="comparison-sampler"&&(t[34892]=34894),e.compare&&(t[34893]=AE("compare",e.compare)),e.maxAnisotropy&&(t[34046]=e.maxAnisotropy),t}function ND(e){switch(e){case"clamp-to-edge":return 33071;case"repeat":return 10497;case"mirror-repeat":return 33648}}function wH(e){switch(e){case"nearest":return 9728;case"linear":return 9729}}function w_t(e,t){if(!t)return wH(e);switch(e){case"nearest":return t==="nearest"?9984:9986;case"linear":return t==="nearest"?9985:9987}}var Hl=class extends En{device;gl;handle;glTarget;glUsage;glIndexType=5123;byteLength;bytesUsed;constructor(t,r={}){super(t,r),this.device=t,this.gl=this.device.gl;let i=typeof r=="object"?r.handle:void 0;this.handle=i||this.gl.createBuffer(),t.setSpectorMetadata(this.handle,{...this.props,data:typeof this.props.data}),this.glTarget=T_t(this.props.usage),this.glUsage=S_t(this.props.usage),this.glIndexType=this.props.indexType==="uint32"?5125:5123,r.data?this._initWithData(r.data,r.byteOffset,r.byteLength):this._initWithByteLength(r.byteLength||0)}_initWithData(t,r=0,i=t.byteLength+r){let s=this.glTarget;this.gl.bindBuffer(s,this.handle),this.gl.bufferData(s,i,this.glUsage),this.gl.bufferSubData(s,r,t),this.gl.bindBuffer(s,null),this.bytesUsed=i,this.byteLength=i,this._setDebugData(t,r,i),this.trackAllocatedMemory(i)}_initWithByteLength(t){Qi(t>=0);let r=t;t===0&&(r=new Float32Array(0));let i=this.glTarget;return this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,r,this.glUsage),this.gl.bindBuffer(i,null),this.bytesUsed=t,this.byteLength=t,this._setDebugData(null,0,t),this.trackAllocatedMemory(t),this}destroy(){!this.destroyed&&this.handle&&(this.removeStats(),this.trackDeallocatedMemory(),this.gl.deleteBuffer(this.handle),this.destroyed=!0,this.handle=null)}write(t,r=0){this.gl.bindBuffer(36663,this.handle),this.gl.bufferSubData(36663,r,t),this.gl.bindBuffer(36663,null),this._setDebugData(t,r,t.byteLength)}async readAsync(t=0,r){return this.readSyncWebGL(t,r)}readSyncWebGL(t=0,r){r=r??this.byteLength-t;let i=new Uint8Array(r),s=0;return this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,t,i,s,r),this.gl.bindBuffer(36662,null),this._setDebugData(i,t,r),i}};function T_t(e){return e&En.INDEX?34963:e&En.VERTEX?34962:e&En.UNIFORM?35345:34962}function S_t(e){return e&En.INDEX||e&En.VERTEX?35044:e&En.UNIFORM?35048:35044}var t1=class extends Lg{device;handle;parameters;constructor(t,r){super(t,r),this.device=t,this.parameters=gE(r),this.handle=this.handle||this.device.gl.createSampler(),this._setSamplerParameters(this.parameters)}destroy(){this.handle&&(this.device.gl.deleteSampler(this.handle),this.handle=void 0)}toString(){return`Sampler(${this.id},${JSON.stringify(this.props)})`}_setSamplerParameters(t){for(let[r,i]of Object.entries(t)){let s=Number(r);switch(s){case 33082:case 33083:this.device.gl.samplerParameterf(this.handle,s,i);break;default:this.device.gl.samplerParameteri(this.handle,s,i);break}}}};var tf=class extends Bg{device;gl;handle;texture;constructor(t,r){super(t,{...jo.defaultProps,...r}),this.device=t,this.gl=this.device.gl,this.handle=null,this.texture=r.texture}};var E_t={parameters:{},pixelStore:{},pixels:null,border:0,dataFormat:void 0,textureUnit:void 0,target:void 0},wc=class e extends jo{static FACES=[34069,34070,34071,34072,34073,34074];MAX_ATTRIBUTES;device;gl;handle;sampler=void 0;view=void 0;glFormat=void 0;type=void 0;dataFormat=void 0;mipmaps=void 0;target;textureUnit=void 0;loaded=!1;_video;constructor(t,r){super(t,{...E_t,format:"rgba8unorm",...r}),this.device=t,this.gl=this.device.gl,this.handle=this.props.handle||this.gl.createTexture(),this.device.setSpectorMetadata(this.handle,{...this.props,data:typeof this.props.data}),this.glFormat=6408,this.target=I_t(this.props),this.loaded=!1,typeof this.props?.data=="string"&&Object.assign(this.props,{data:Pk(this.props.data)}),this.initialize(this.props),Object.seal(this)}destroy(){this.handle&&(this.gl.deleteTexture(this.handle),this.removeStats(),this.trackDeallocatedMemory("Texture"),this.destroyed=!0)}toString(){return`Texture(${this.id},${this.width}x${this.height})`}createView(t){return new tf(this.device,{...t,texture:this})}initialize(t={}){if(this.props.dimension==="cube")return this.initializeCube(t);let r=t.data;if(r instanceof Promise)return r.then(z=>this.initialize(Object.assign({},t,{pixels:z,data:z}))),this;let i=typeof HTMLVideoElement<"u"&&r instanceof HTMLVideoElement;if(i&&r.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,r.addEventListener("loadeddata",()=>this.initialize(t)),this;let{parameters:s={}}=t,{pixels:n=null,pixelStore:o={},textureUnit:a=void 0,mipmaps:h=!0}=t;r||(r=n);let{width:p,height:g,dataFormat:v,type:T,compressed:C=!1}=t,{depth:B=0}=t,L=DD(t.format);return{width:p,height:g,compressed:C,dataFormat:v,type:T}=this._deduceParameters({format:t.format,type:T,dataFormat:v,compressed:C,data:r,width:p,height:g}),this.width=p,this.height=g,this.glFormat=L,this.type=T,this.dataFormat=v,this.textureUnit=a,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),this.mipmaps=h,this.setImageData({data:r,width:p,height:g,depth:B,format:L,type:T,dataFormat:v,parameters:o,compressed:C}),this.setSampler(t.sampler),this._setSamplerParameters(s),this.view=this.createView({...this.props,mipLevelCount:1,arrayLayerCount:1}),h&&this.device.isTextureFormatFilterable(t.format)&&this.generateMipmap(),i&&(this._video={video:r,parameters:s,lastTime:r.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?r.currentTime:-1}),this}initializeCube(t){let{mipmaps:r=!0,parameters:i={}}=t;return this.setCubeMapImageData(t).then(()=>{this.loaded=!0,r&&this.generateMipmap(t),this.setSampler(t.sampler),this._setSamplerParameters(i)}),this}setSampler(t={}){let r;t instanceof t1?(this.sampler=t,r=t.props):(this.sampler=new t1(this.device,t),r=t);let i=gE(r);return this._setSamplerParameters(i),this}resize(t){let{height:r,width:i,mipmaps:s=!1}=t;return i!==this.width||r!==this.height?this.initialize({width:i,height:r,format:this.format,type:this.type,dataFormat:this.dataFormat,mipmaps:s}):this}update(){if(this._video){let{video:t,parameters:r,lastTime:i}=this._video;if(i===t.currentTime||t.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:t,parameters:r}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=t.currentTime}}generateMipmap(t={}){return this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),Ju(this.gl,t,()=>{this.gl.generateMipmap(this.target)}),this.gl.bindTexture(this.target,null),this}setImageData(t){if(this.props.dimension==="3d"||this.props.dimension==="2d-array")return this.setImageData3D(t);this.trackDeallocatedMemory("Texture");let{target:r=this.target,pixels:i=null,level:s=0,glFormat:n=this.glFormat,offset:o=0,parameters:a={}}=t,{data:h=null,type:p=this.type,width:g=this.width,height:v=this.height,dataFormat:T=this.dataFormat,compressed:C=!1}=t;h||(h=i),{type:p,dataFormat:T,compressed:C,width:g,height:v}=this._deduceParameters({format:this.props.format,type:p,dataFormat:T,compressed:C,data:h,width:g,height:v});let{gl:B}=this;B.bindTexture(this.target,this.handle);let L=null;if({data:h,dataType:L}=this._getDataType({data:h,compressed:C}),Ju(this.gl,a,()=>{switch(L){case"null":B.texImage2D(r,s,n,g,v,0,T,p,h);break;case"typed-array":B.texImage2D(r,s,n,g,v,0,T,p,h,o);break;case"buffer":this.device.gl.bindBuffer(35052,h.handle||h),this.device.gl.texImage2D(r,s,n,g,v,0,T,p,o),this.device.gl.bindBuffer(35052,null);break;case"browser-object":B.texImage2D(r,s,n,g,v,0,T,p,h);break;case"compressed":for(let[z,W]of h.entries())B.compressedTexImage2D(r,z,W.format,W.width,W.height,0,W.data);break;default:Qi(!1,"Unknown image data type")}}),h&&h.byteLength)this.trackAllocatedMemory(h.byteLength,"Texture");else{let z=OD(this.props.format);this.trackAllocatedMemory(this.width*this.height*z,"Texture")}return this.loaded=!0,this}setSubImageData({target:t=this.target,pixels:r=null,data:i=null,x:s=0,y:n=0,width:o=this.width,height:a=this.height,level:h=0,glFormat:p=this.glFormat,type:g=this.type,dataFormat:v=this.dataFormat,compressed:T=!1,offset:C=0,parameters:B={}}){if({type:g,dataFormat:v,compressed:T,width:o,height:a}=this._deduceParameters({format:this.props.format,type:g,dataFormat:v,compressed:T,data:i,width:o,height:a}),Qi(this.depth===1,"texSubImage not supported for 3D textures"),i||(i=r),i&&i.data){let L=i;i=L.data,o=L.shape[0],a=L.shape[1]}i instanceof Hl&&(i=i.handle),this.gl.bindTexture(this.target,this.handle),Ju(this.gl,B,()=>{T?this.gl.compressedTexSubImage2D(t,h,s,n,o,a,p,i):i===null?this.gl.texSubImage2D(t,h,s,n,o,a,v,g,null):ArrayBuffer.isView(i)?this.gl.texSubImage2D(t,h,s,n,o,a,v,g,i,C):typeof WebGLBuffer<"u"&&i instanceof WebGLBuffer?(this.device.gl.bindBuffer(35052,i),this.device.gl.texSubImage2D(t,h,s,n,o,a,v,g,C),this.device.gl.bindBuffer(35052,null)):this.device.gl.texSubImage2D(t,h,s,n,o,a,v,g,i)}),this.gl.bindTexture(this.target,null)}copyFramebuffer(t={}){return Ce.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(t=this.textureUnit){let{gl:r}=this;return t!==void 0&&(this.textureUnit=t,r.activeTexture(33984+t)),r.bindTexture(this.target,this.handle),t}unbind(t=this.textureUnit){let{gl:r}=this;return t!==void 0&&(this.textureUnit=t,r.activeTexture(33984+t)),r.bindTexture(this.target,null),t}_getDataType({data:t,compressed:r=!1}){return r?{data:t,dataType:"compressed"}:t===null?{data:t,dataType:"null"}:ArrayBuffer.isView(t)?{data:t,dataType:"typed-array"}:t instanceof Hl?{data:t.handle,dataType:"buffer"}:typeof WebGLBuffer<"u"&&t instanceof WebGLBuffer?{data:t,dataType:"buffer"}:{data:t,dataType:"browser-object"}}_deduceParameters(t){let{format:r,data:i}=t,{width:s,height:n,dataFormat:o,type:a,compressed:h}=t,p=t2(r);return o=o||p.dataFormat,a=a||p.type,h=h||p.compressed,{width:s,height:n}=this._deduceImageSize(i,s,n),{dataFormat:o,type:a,compressed:h,width:s,height:n,format:r,data:i}}_deduceImageSize(t,r,i){let s;return typeof ImageData<"u"&&t instanceof ImageData?s={width:t.width,height:t.height}:typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement?s={width:t.naturalWidth,height:t.naturalHeight}:typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement?s={width:t.width,height:t.height}:typeof ImageBitmap<"u"&&t instanceof ImageBitmap?s={width:t.width,height:t.height}:typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement?s={width:t.videoWidth,height:t.videoHeight}:t?s={width:r,height:i}:s={width:r>=0?r:1,height:i>=0?i:1},Qi(s,"Could not deduced texture size"),Qi(r===void 0||s.width===r,"Deduced texture width does not match supplied width"),Qi(i===void 0||s.height===i,"Deduced texture height does not match supplied height"),s}async setCubeMapImageData(t){let{gl:r}=this,{width:i,height:s,pixels:n,data:o,format:a=6408,type:h=5121}=t,p=n||o,g=await Promise.all(e.FACES.map(v=>{let T=p[v];return Promise.all(Array.isArray(T)?T:[T])}));this.bind(),e.FACES.forEach((v,T)=>{g[T].length>1&&this.props.mipmaps!==!1&&Ce.warn(`${this.id} has mipmap and multiple LODs.`)(),g[T].forEach((C,B)=>{i&&s?r.texImage2D(v,B,a,i,s,0,a,h,C):r.texImage2D(v,B,a,a,h,C)})}),this.unbind()}setImageDataForFace(t){let{face:r,width:i,height:s,pixels:n,data:o,format:a=6408,type:h=5121}=t,{gl:p}=this,g=n||o;return this.bind(),g instanceof Promise?g.then(v=>this.setImageDataForFace(Object.assign({},t,{face:r,data:v,pixels:v}))):this.width||this.height?p.texImage2D(r,0,a,i,s,0,a,h,g):p.texImage2D(r,0,a,a,h,g),this}setImageData3D(t){let{level:r=0,dataFormat:i,format:s,type:n,width:o,height:a,depth:h=1,offset:p=0,data:g,parameters:v={}}=t;this.trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle);let T=t2(s);if(Ju(this.gl,v,()=>{ArrayBuffer.isView(g)&&this.gl.texImage3D(this.target,r,T.format,o,a,h,0,T.dataFormat,T.type,g),g instanceof Hl&&(this.gl.bindBuffer(35052,g.handle),this.gl.texImage3D(this.target,r,i,o,a,h,0,s,n,p))}),g&&g.byteLength)this.trackAllocatedMemory(g.byteLength,"Texture");else{let C=OD(this.props.format);this.trackAllocatedMemory(this.width*this.height*this.depth*C,"Texture")}return this.loaded=!0,this}_setSamplerParameters(t){if(!Em(t)){M_t(t),this.gl.bindTexture(this.target,this.handle);for(let[r,i]of Object.entries(t)){let s=Number(r),n=i;switch(s){case 33082:case 33083:this.gl.texParameterf(this.target,s,n);break;default:this.gl.texParameteri(this.target,s,n);break}}this.gl.bindTexture(this.target,null)}}};function I_t(e){switch(e.dimension){case"2d":return 3553;case"cube":return 34067;case"2d-array":return 35866;case"3d":return 32879;case"1d":case"cube-array":default:throw new Error(e.dimension)}}function M_t(e){Ce.log(1,"texture sampler parameters",e)()}var cp=class extends Fg{device;gl;handle;get texture(){return this.colorAttachments[0]}constructor(t,r){super(t,r);let i=r.handle===null;if(this.device=t,this.gl=t.gl,this.handle=this.props.handle||i?this.props.handle:this.gl.createFramebuffer(),!i){t.setSpectorMetadata(this.handle,{id:this.props.id,props:this.props}),this.autoCreateAttachmentTextures();let s=this.gl.bindFramebuffer(36160,this.handle);for(let n=0;n<this.colorAttachments.length;++n){let o=this.colorAttachments[n],a=36064+n;o&&this._attachOne(a,o)}if(this.depthStencilAttachment&&this._attachOne(yH(this.depthStencilAttachment.props.format),this.depthStencilAttachment),r.check!==!1){let n=this.gl.checkFramebufferStatus(36160);if(n!==36053)throw new Error(`Framebuffer ${P_t(n)}`)}this.gl.bindFramebuffer(36160,s)}}destroy(){super.destroy(),!this.destroyed&&this.handle!==null&&this.gl.deleteFramebuffer(this.handle)}createDepthStencilTexture(t){return new wc(this.device,{id:`${this.id}-depth-stencil`,format:t,width:this.width,height:this.height,mipmaps:!1})}resizeAttachments(t,r){if(this.handle===null)return this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;t===void 0&&(t=this.gl.drawingBufferWidth),r===void 0&&(r=this.gl.drawingBufferHeight);for(let i of this.colorAttachments)i.texture.resize({width:t,height:r});return this.depthStencilAttachment&&this.depthStencilAttachment.texture.resize({width:t,height:r}),this}_attachOne(t,r){if(Array.isArray(r)){let[i,s=0,n=0]=r;return this._attachTexture(t,i,s,n),i}if(r instanceof wc)return this._attachTexture(t,r,0,0),r;if(r instanceof tf){let i=r;return this._attachTexture(t,i.texture,i.props.baseMipLevel,i.props.baseArrayLayer),r.texture}throw new Error("attach")}_attachTexture(t,r,i,s){let{gl:n}=this.device;switch(n.bindTexture(r.target,r.handle),r.target){case 35866:case 32879:n.framebufferTextureLayer(36160,t,r.target,s,i);break;case 34067:let o=C_t(i);n.framebufferTexture2D(36160,t,o,r.handle,s);break;case 3553:n.framebufferTexture2D(36160,t,3553,r.handle,s);break;default:Qi(!1,"Illegal texture type")}n.bindTexture(r.target,null)}};function C_t(e){return e<34069?e+34069:e}function P_t(e){switch(e){case 36053:return"success";case 36054:return"Mismatched attachments";case 36055:return"No attachments";case 36057:return"Height/width mismatch";case 36061:return"Unsupported or split attachments";case 36182:return"Samples mismatch";default:return`${e}`}}var _E=class extends Og{device;presentationSize;_framebuffer=null;constructor(t,r){super(r),this.device=t,this.presentationSize=[-1,-1],this._setAutoCreatedCanvasId(`${this.device.id}-canvas`),this.update()}getCurrentFramebuffer(){return this.update(),this._framebuffer=this._framebuffer||new cp(this.device,{handle:null}),this._framebuffer}update(){let t=this.getPixelSize();(t[0]!==this.presentationSize[0]||t[1]!==this.presentationSize[1])&&(this.presentationSize=t,this.resize())}resize(t){if(this.device.gl&&this.canvas){let r=this.getDevicePixelRatio(t?.useDevicePixels);this.setDevicePixelRatio(r,t);return}}commit(){}};var R_t={spector:Ce.get("spector")||Ce.get("spectorjs")},k_t="https://cdn.jsdelivr.net/npm/spectorjs@0.9.30/dist/spector.bundle.js",D_t=1,Tc=null,TH=!1;async function SH(e){if(!globalThis.SPECTOR)try{await Dv(k_t)}catch(t){Ce.warn(String(t))}}function EH(e){if(e={...R_t,...e},!e?.spector||(!Tc&&globalThis.SPECTOR&&(Ce.probe(D_t,"SPECTOR found and initialized")(),Tc=new globalThis.SPECTOR.Spector,globalThis.luma&&(globalThis.luma.spector=Tc)),!Tc))return null;if(TH||(TH=!0,Tc.spyCanvases(),Tc?.onCaptureStarted.add(t=>Ce.info("Spector capture started:",t)()),Tc?.onCapture.add(t=>{Ce.info("Spector capture complete:",t)(),Tc?.getResultUI(),Tc?.resultView.display(),Tc?.resultView.addCapture(t)})),e?.canvas){if(typeof e.spector=="string"&&e.spector!==e.canvas.id)return Tc;Tc?.startCapture(e?.canvas,500),new Promise(t=>setTimeout(t,2e3)).then(t=>{Ce.info("Spector capture stopped after 2 seconds")(),Tc?.stopCapture()})}return Tc}var O_t="https://unpkg.com/webgl-debug@2.0.1/index.js";function IH(e){return e.luma=e.luma||{},e.luma}async function MH(){pl()&&!globalThis.WebGLDebugUtils&&(globalThis.global=globalThis.global||globalThis,globalThis.global.module={},await Dv(O_t))}function CH(e,t={}){return e?t.debug?N_t(e,t):B_t(e):null}function B_t(e){let t=IH(e);return t.realContext?t.realContext:e}function N_t(e,t){if(!globalThis.WebGLDebugUtils)return Ce.warn("webgl-debug not loaded")(),e;let r=IH(e);if(r.debugContext)return r.debugContext;globalThis.WebGLDebugUtils.init({...Fm,...e});let i=globalThis.WebGLDebugUtils.makeDebugContext(e,L_t.bind(null,t),F_t.bind(null,t));for(let o in Fm)!(o in i)&&typeof Fm[o]=="number"&&(i[o]=Fm[o]);class s{}Object.setPrototypeOf(i,Object.getPrototypeOf(e)),Object.setPrototypeOf(s,i);let n=Object.create(s);return r.realContext=e,r.debugContext=n,n.debug=!0,n}function LD(e,t){t=Array.from(t).map(i=>i===void 0?"undefined":i);let r=globalThis.WebGLDebugUtils.glFunctionArgsToString(e,t);return r=`${r.slice(0,100)}${r.length>100?"...":""}`,`gl.${e}(${r})`}function L_t(e,t,r,i){i=Array.from(i).map(a=>a===void 0?"undefined":a);let s=globalThis.WebGLDebugUtils.glEnumToString(t),n=globalThis.WebGLDebugUtils.glFunctionArgsToString(r,i),o=`${s} in gl.${r}(${n})`;Ce.error(o)();debugger;if(e.throwOnError)throw new Error(o)}function F_t(e,t,r){let i="";if(Ce.level>=1&&(i=LD(t,r),Ce.log(1,i)()),e.break&&e.break.length>0&&(i=i||LD(t,r),e.break.every(n=>i.indexOf(n)!==-1)))debugger;for(let s of r)if(s===void 0){if(i=i||LD(t,r),e.throwOnError)throw new Error(`Undefined argument: ${i}`);Ce.error(`Undefined argument: ${i}`)();debugger}}function RH(e){let t=e.split(/\r?\n/),r=[];for(let i of t){if(i.length<=1)continue;let s=i.split(":");if(s.length===2){let[v,T]=s;r.push({message:T.trim(),type:PH(v),lineNum:0,linePos:0});continue}let[n,o,a,...h]=s,p=parseInt(a,10);isNaN(p)&&(p=0);let g=parseInt(o,10);isNaN(g)&&(g=0),r.push({message:h.join(":").trim(),type:PH(n),lineNum:p,linePos:g})}return r}function PH(e){let t=["warning","error","info"],r=e.toLowerCase();return t.includes(r)?r:"info"}var yE=class extends Ng{device;handle;constructor(t,r){switch(super(t,r),this.device=t,this.props.stage){case"vertex":this.handle=this.props.handle||this.device.gl.createShader(35633);break;case"fragment":this.handle=this.props.handle||this.device.gl.createShader(35632);break;default:throw new Error(this.props.stage)}this._compile(this.source)}destroy(){this.handle&&(this.removeStats(),this.device.gl.deleteShader(this.handle),this.destroyed=!0)}async getCompilationInfo(){return await this._waitForCompilationComplete(),this.getCompilationInfoSync()}getCompilationInfoSync(){let t=this.device.gl.getShaderInfoLog(this.handle);return RH(t)}getTranslatedSource(){return this.device.getExtension("WEBGL_debug_shaders").WEBGL_debug_shaders?.getTranslatedShaderSource(this.handle)}async _compile(t){t=(s=>s.startsWith("#version ")?s:`#version 100
${s}`)(t);let{gl:i}=this.device;if(i.shaderSource(this.handle,t),i.compileShader(this.handle),Ce.level===0){this.compilationStatus="pending";return}if(!this.device.features.has("compilation-status-async-webgl")){if(this._getCompilationStatus(),this.debugShader(),this.compilationStatus==="error")throw new Error(`GLSL compilation errors in ${this.props.stage} shader ${this.props.id}`);return}Ce.once(1,"Shader compilation is asynchronous")(),await this._waitForCompilationComplete(),Ce.info(2,`Shader ${this.id} - async compilation complete: ${this.compilationStatus}`)(),this._getCompilationStatus(),this.debugShader()}async _waitForCompilationComplete(){let t=async s=>await new Promise(n=>setTimeout(n,s));if(!this.device.features.has("compilation-status-async-webgl")){await t(10);return}let{gl:i}=this.device;for(;;){if(i.getShaderParameter(this.handle,37297))return;await t(10)}}_getCompilationStatus(){this.compilationStatus=this.device.gl.getShaderParameter(this.handle,35713)?"success":"error"}};var z_t=256,U_t=1024,V_t=16384,FD=6144,j_t=[1,2,4,8],xE=class extends Tv{device;glParameters;constructor(t,r){super(t,r),this.device=t,zm(this.device.gl),this.setParameters(this.props.parameters),this.clear()}end(){zd(this.device.gl)}pushDebugGroup(t){}popDebugGroup(){}insertDebugMarker(t){}setParameters(t={}){let r={...this.glParameters};this.props.framebuffer&&(r.framebuffer=this.props.framebuffer),this.props.depthReadOnly&&(r.depthMask=!this.props.depthReadOnly),r.stencilMask=this.props.stencilReadOnly?0:1,r[35977]=this.props.discard,t.viewport&&(t.viewport.length>=6?(r.viewport=t.viewport.slice(0,4),r.depthRange=[t.viewport[4],t.viewport[5]]):r.viewport=t.viewport),t.scissorRect&&(r.scissorTest=!0,r.scissor=t.scissorRect),t.blendConstant&&(r.blendColor=t.blendConstant),t.stencilReference&&(console.warn("RenderPassParameters.stencilReference not yet implemented in WebGL"),t[2967]=t.stencilReference),t.colorMask&&(r.colorMask=j_t.map(i=>!!(i&t.colorMask))),this.glParameters=r,Jh(this.device.gl,r)}beginOcclusionQuery(t){this.props.occlusionQuerySet?.beginOcclusionQuery()}endOcclusionQuery(){this.props.occlusionQuerySet?.endOcclusionQuery()}clear(){let t={...this.glParameters},r=0;this.props.clearColor!==!1&&(r|=V_t,t.clearColor=this.props.clearColor),this.props.clearDepth!==!1&&(r|=z_t,t.clearDepth=this.props.clearDepth),this.props.clearStencil!==!1&&(r|=U_t,t.clearStencil=this.props.clearStencil),r!==0&&Ju(this.device.gl,t,()=>{this.device.gl.clear(r)})}clearColorBuffer(t=0,r=[0,0,0,0]){Ju(this.device.gl,{framebuffer:this.props.framebuffer},()=>{switch(r.constructor){case Int32Array:this.device.gl.clearBufferiv(FD,t,r);break;case Uint32Array:this.device.gl.clearBufferuiv(FD,t,r);break;case Float32Array:default:this.device.gl.clearBufferfv(FD,t,r);break}})}};var W_t="Failed to deduce GL constant from typed array";function kH(e){switch(ArrayBuffer.isView(e)?e.constructor:e){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:return 5121;case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(W_t)}}function xw(e,t){let{clamped:r=!0}=t||{};switch(e){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return r?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}var $_t={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},H_t={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}},bE=class e{offset;stride;type;size;divisor;normalized;integer;buffer;index;static getBytesPerElement(t){return xw(t.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(t){return Qi(t.size),xw(t.type||5126).BYTES_PER_ELEMENT*t.size}static resolve(...t){return new e($_t,...t)}constructor(...t){t.forEach(r=>this._assign(r)),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return e.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return e.getBytesPerVertex(this)}_assign(t={}){return t=Ck("Accessor",t,H_t),t.type!==void 0&&(this.type=t.type,(t.type===5124||t.type===5125)&&(this.integer=!0)),t.size!==void 0&&(this.size=t.size),t.offset!==void 0&&(this.offset=t.offset),t.stride!==void 0&&(this.stride=t.stride),t.normalize!==void 0&&(this.normalized=t.normalize),t.normalized!==void 0&&(this.normalized=t.normalized),t.integer!==void 0&&(this.integer=t.integer),t.divisor!==void 0&&(this.divisor=t.divisor),t.buffer!==void 0&&(this.buffer=t.buffer),t.index!==void 0&&(typeof t.index=="boolean"?this.index=t.index?1:0:this.index=t.index),t.instanced!==void 0&&(this.divisor=t.instanced?1:0),t.isInstanced!==void 0&&(this.divisor=t.isInstanced?1:0),this.offset===void 0&&delete this.offset,this.stride===void 0&&delete this.stride,this.type===void 0&&delete this.type,this.size===void 0&&delete this.size,this.divisor===void 0&&delete this.divisor,this.normalized===void 0&&delete this.normalized,this.integer===void 0&&delete this.integer,this.buffer===void 0&&delete this.buffer,this.index===void 0&&delete this.index,this}};function DH(e){return q_t.includes(e)}var q_t=[35678,35680,35679,35682,36289,36292,36293,36298,36299,36300,36303,36306,36307,36308,36311],OH={5126:[5126,1,"float","f32","float32"],35664:[5126,2,"vec2","vec2<f32>","float32x2"],35665:[5126,3,"vec3","vec3<f32>","float32x3"],35666:[5126,4,"vec4","vec4<f32>","float32x4"],5124:[5124,1,"int","i32","sint32"],35667:[5124,2,"ivec2","vec2<i32>","sint32x2"],35668:[5124,3,"ivec3","vec3<i32>","sint32x3"],35669:[5124,4,"ivec4","vec4<i32>","sint32x4"],5125:[5125,1,"uint","u32","uint32"],36294:[5125,2,"uvec2","vec2<u32>","uint32x2"],36295:[5125,3,"uvec3","vec3<u32>","uint32x3"],36296:[5125,4,"uvec4","vec4<u32>","uint32x4"],35670:[5126,1,"bool","f32","float32"],35671:[5126,2,"bvec2","vec2<f32>","float32x2"],35672:[5126,3,"bvec3","vec3<f32>","float32x3"],35673:[5126,4,"bvec4","vec4<f32>","float32x4"],35674:[5126,8,"mat2","mat2x2<f32>"],35685:[5126,8,"mat2x3","mat2x3<f32>"],35686:[5126,8,"mat2x4","mat2x4<f32>"],35687:[5126,12,"mat3x2","mat3x2<f32>"],35675:[5126,12,"mat3","mat3x3<f32>"],35688:[5126,12,"mat3x4","mat3x4<f32>"],35689:[5126,16,"mat4x2","mat4x2<f32>"],35690:[5126,16,"mat4x3","mat4x3<f32>"],35676:[5126,16,"mat4","mat4x4<f32>"]};function zD(e){let t=OH[e];if(!t)throw new Error("uniform");let[r,i,,s]=t;return{format:s,components:i,glType:r}}function BH(e){let t=OH[e];if(!t)throw new Error("attribute");let[,r,,i,s]=t;return{attributeType:i,vertexFormat:s,components:r}}function NH(e,t){let r={attributes:[],bindings:[]};r.attributes=Y_t(e,t);let i=G_t(e,t);for(let a of i){let h=a.uniforms.map(p=>({name:p.name,format:p.format,byteOffset:p.byteOffset,byteStride:p.byteStride,arrayLength:p.arrayLength}));r.bindings.push({type:"uniform",name:a.name,location:a.location,visibility:(a.vertex?1:0)&(a.fragment?2:0),minBindingSize:a.byteLength,uniforms:h})}let s=Z_t(e,t),n=0;for(let a of s)if(DH(a.type)){let{viewDimension:h,sampleType:p}=K_t(a.type);r.bindings.push({type:"texture",name:a.name,location:n,viewDimension:h,sampleType:p}),a.textureUnit=n,n+=1}s.length&&(r.uniforms=s);let o=X_t(e,t);return o?.length&&(r.varyings=o),r}function Y_t(e,t){let r=[],i=e.getProgramParameter(t,35721);for(let s=0;s<i;s++){let n=e.getActiveAttrib(t,s);if(!n)throw new Error("activeInfo");let{name:o,type:a}=n,h=e.getAttribLocation(t,o);if(h>=0){let{attributeType:p}=BH(a),g=/instance/i.test(o)?"instance":"vertex";r.push({name:o,location:h,stepMode:g,type:p})}}return r.sort((s,n)=>s.location-n.location),r}function X_t(e,t){let r=[],i=e.getProgramParameter(t,35971);for(let s=0;s<i;s++){let n=e.getTransformFeedbackVarying(t,s);if(!n)throw new Error("activeInfo");let{name:o,type:a,size:h}=n,{glType:p,components:g}=zD(a),v=new bE({type:p,size:h*g}),T={location:s,name:o,accessor:v};r.push(T)}return r.sort((s,n)=>s.location-n.location),r}function Z_t(e,t){let r=[],i=e.getProgramParameter(t,35718);for(let s=0;s<i;s++){let n=e.getActiveUniform(t,s);if(!n)throw new Error("activeInfo");let{name:o,size:a,type:h}=n,{name:p,isArray:g}=J_t(o),v=e.getUniformLocation(t,p),T={location:v,name:p,size:a,type:h,isArray:g};if(r.push(T),T.size>1)for(let C=0;C<T.size;C++){let B=`${p}[${C}]`;v=e.getUniformLocation(t,B);let L={...T,name:B,location:v};r.push(L)}}return r}function G_t(e,t){let r=(n,o)=>e.getActiveUniformBlockParameter(t,n,o),i=[],s=e.getProgramParameter(t,35382);for(let n=0;n<s;n++){let o={name:e.getActiveUniformBlockName(t,n)||"",location:r(n,35391),byteLength:r(n,35392),vertex:r(n,35396),fragment:r(n,35398),uniformCount:r(n,35394),uniforms:[]},a=r(n,35395)||[],h=e.getActiveUniforms(t,a,35383),p=e.getActiveUniforms(t,a,35384),g=e.getActiveUniforms(t,a,35387),v=e.getActiveUniforms(t,a,35388);for(let T=0;T<o.uniformCount;++T){let C=e.getActiveUniform(t,a[T]);if(!C)throw new Error("activeInfo");o.uniforms.push({name:C.name,format:zD(h[T]).format,type:h[T],arrayLength:p[T],byteOffset:g[T],byteStride:v[T]})}i.push(o)}return i.sort((n,o)=>n.location-o.location),i}var Q_t={35678:["2d","float"],35680:["cube","float"],35679:["3d","float"],35682:["3d","depth"],36289:["2d-array","float"],36292:["2d-array","depth"],36293:["cube","float"],36298:["2d","sint"],36299:["3d","sint"],36300:["cube","sint"],36303:["2d-array","uint"],36306:["2d","uint"],36307:["3d","uint"],36308:["cube","uint"],36311:["2d-array","uint"]};function K_t(e){let t=Q_t[e];if(!t)throw new Error("sampler");let[r,i]=t;return{viewDimension:r,sampleType:i}}function J_t(e){if(e[e.length-1]!=="]")return{name:e,length:1,isArray:!1};let r=/([^[]*)(\[[0-9]+\])?/.exec(e);if(!r||r.length<2)throw new Error(`Failed to parse GLSL uniform name ${e}`);return{name:r[1],length:r[2]?1:0,isArray:!!r[2]}}function LH(e,t,r,i){let s=e,n=i;n===!0&&(n=1),n===!1&&(n=0);let o=typeof n=="number"?[n]:n;switch(r){case 35678:case 35680:case 35679:case 35682:case 36289:case 36292:case 36293:case 36298:case 36299:case 36300:case 36303:case 36306:case 36307:case 36308:case 36311:if(typeof i!="number")throw new Error("samplers must be set to integers");return e.uniform1i(t,i);case 5126:return e.uniform1fv(t,o);case 35664:return e.uniform2fv(t,o);case 35665:return e.uniform3fv(t,o);case 35666:return e.uniform4fv(t,o);case 5124:return e.uniform1iv(t,o);case 35667:return e.uniform2iv(t,o);case 35668:return e.uniform3iv(t,o);case 35669:return e.uniform4iv(t,o);case 35670:return e.uniform1iv(t,o);case 35671:return e.uniform2iv(t,o);case 35672:return e.uniform3iv(t,o);case 35673:return e.uniform4iv(t,o);case 5125:return s.uniform1uiv(t,o,1);case 36294:return s.uniform2uiv(t,o,2);case 36295:return s.uniform3uiv(t,o,3);case 36296:return s.uniform4uiv(t,o,4);case 35674:return e.uniformMatrix2fv(t,!1,o);case 35675:return e.uniformMatrix3fv(t,!1,o);case 35676:return e.uniformMatrix4fv(t,!1,o);case 35685:return s.uniformMatrix2x3fv(t,!1,o);case 35686:return s.uniformMatrix2x4fv(t,!1,o);case 35687:return s.uniformMatrix3x2fv(t,!1,o);case 35688:return s.uniformMatrix3x4fv(t,!1,o);case 35689:return s.uniformMatrix4x2fv(t,!1,o);case 35690:return s.uniformMatrix4x3fv(t,!1,o)}throw new Error("Illegal uniform")}function FH(e){switch(e){case"point-list":return 0;case"line-list":return 1;case"line-strip":return 3;case"line-loop-webgl":return 2;case"triangle-list":return 4;case"triangle-strip":return 5;case"triangle-fan-webgl":return 6;default:throw new Error(e)}}function zH(e){switch(e){case"point-list":return 0;case"line-list":return 1;case"line-strip":return 1;case"line-loop-webgl":return 1;case"triangle-list":return 4;case"triangle-strip":return 4;case"triangle-fan-webgl":return 4;default:throw new Error(e)}}var UH=4,vE=class extends tp{device;handle;vs;fs;introspectedLayout;uniforms={};bindings={};varyings=null;_uniformCount=0;_uniformSetters={};constructor(t,r){super(t,r),this.device=t,this.handle=this.props.handle||this.device.gl.createProgram(),this.device.setSpectorMetadata(this.handle,{id:this.props.id}),this.vs=r.vs,this.fs=r.fs;let{varyings:i,bufferMode:s=35981}=r;switch(i&&i.length>0&&(this.varyings=i,this.device.gl.transformFeedbackVaryings(this.handle,i,s)),this._linkShaders(),Ce.time(1,`RenderPipeline ${this.id} - shaderLayout introspection`)(),this.introspectedLayout=NH(this.device.gl,this.handle),Ce.timeEnd(1,`RenderPipeline ${this.id} - shaderLayout introspection`)(),this.shaderLayout=Sk(this.introspectedLayout,r.shaderLayout),this.props.topology){case"triangle-fan-webgl":case"line-loop-webgl":Ce.warn(`Primitive topology ${this.props.topology} is deprecated and will be removed in v9.1`);break;default:}}destroy(){this.handle&&(this.device.gl.deleteProgram(this.handle),this.destroyed=!0)}setBindings(t,r){for(let[i,s]of Object.entries(t)){let n=this.shaderLayout.bindings.find(o=>o.name===i)||this.shaderLayout.bindings.find(o=>o.name===`${i}Uniforms`);if(!n){let o=this.shaderLayout.bindings.map(a=>`"${a.name}"`).join(", ");r?.disableWarnings||Ce.warn(`Unknown binding "${i}" in render pipeline "${this.id}", expected one of ${o}`)();continue}switch(s||Ce.warn(`Unsetting binding "${i}" in render pipeline "${this.id}"`)(),n.type){case"uniform":if(!(s instanceof Hl)&&!(s.buffer instanceof Hl))throw new Error("buffer value");break;case"texture":if(!(s instanceof tf||s instanceof wc||s instanceof cp))throw new Error("texture value");break;case"sampler":Ce.warn(`Ignoring sampler ${i}`)();break;default:throw new Error(n.type)}this.bindings[i]=s}}draw(t){let{renderPass:r,parameters:i=this.props.parameters,topology:s=this.props.topology,vertexArray:n,vertexCount:o,instanceCount:a,isInstanced:h=!1,firstVertex:p=0,transformFeedback:g}=t,v=FH(s),T=!!n.indexBuffer,C=n.indexBuffer?.glIndexType;if(this.linkStatus!=="success")return Ce.info(2,`RenderPipeline:${this.id}.draw() aborted - waiting for shader linking`)(),!1;if(!this._areTexturesRenderable()||o===0)return Ce.info(2,`RenderPipeline:${this.id}.draw() aborted - textures not yet loaded`)(),!1;if(o===0)return Ce.info(2,`RenderPipeline:${this.id}.draw() aborted - no vertices to draw`)(),!0;this.device.gl.useProgram(this.handle),n.bindBeforeRender(r),g&&g.begin(this.props.topology),this._applyBindings(),this._applyUniforms();let B=r;return vH(this.device,i,B.glParameters,()=>{T&&h?this.device.gl.drawElementsInstanced(v,o||0,C,p,a||0):T?this.device.gl.drawElements(v,o||0,C,p):h?this.device.gl.drawArraysInstanced(v,p,o||0,a||0):this.device.gl.drawArrays(v,p,o||0),g&&g.end()}),n.unbindAfterRender(r),!0}setUniformsWebGL(t){let{bindings:r}=kv(t);Object.keys(r).forEach(i=>{Ce.warn(`Unsupported value "${JSON.stringify(r[i])}" used in setUniforms() for key ${i}. Use setBindings() instead?`)()}),Object.assign(this.uniforms,t)}async _linkShaders(){let{gl:t}=this.device;if(t.attachShader(this.handle,this.vs.handle),t.attachShader(this.handle,this.fs.handle),Ce.time(UH,`linkProgram for ${this.id}`)(),t.linkProgram(this.handle),Ce.timeEnd(UH,`linkProgram for ${this.id}`)(),Ce.level,!this.device.features.has("compilation-status-async-webgl")){let i=this._getLinkStatus();this._reportLinkStatus(i);return}Ce.once(1,"RenderPipeline linking is asynchronous")(),await this._waitForLinkComplete(),Ce.info(2,`RenderPipeline ${this.id} - async linking complete: ${this.linkStatus}`)();let r=this._getLinkStatus();this._reportLinkStatus(r)}_reportLinkStatus(t){switch(t){case"success":return;default:throw this.vs.compilationStatus==="error"?(this.vs.debugShader(),new Error(`Error during compilation of shader ${this.vs.id}`)):this.fs?.compilationStatus==="error"?(this.fs.debugShader(),new Error(`Error during compilation of shader ${this.fs.id}`)):new Error(`Error during ${t}: ${this.device.gl.getProgramInfoLog(this.handle)}`)}}_getLinkStatus(){let{gl:t}=this.device;return t.getProgramParameter(this.handle,35714)?(t.validateProgram(this.handle),t.getProgramParameter(this.handle,35715)?(this.linkStatus="success","success"):(this.linkStatus="error","validation")):(this.linkStatus="error","linking")}async _waitForLinkComplete(){let t=async s=>await new Promise(n=>setTimeout(n,s));if(!this.device.features.has("compilation-status-async-webgl")){await t(10);return}let{gl:i}=this.device;for(;;){if(i.getProgramParameter(this.handle,37297))return;await t(10)}}_areTexturesRenderable(){let t=!0;for(let[,r]of Object.entries(this.bindings))r instanceof wc&&(r.update(),t=t&&r.loaded);return t}_applyBindings(){if(this.linkStatus!=="success")return;let{gl:t}=this.device;t.useProgram(this.handle);let r=0,i=0;for(let s of this.shaderLayout.bindings){let n=this.bindings[s.name]||this.bindings[s.name.replace(/Uniforms$/,"")];if(!n)throw new Error(`No value for binding ${s.name} in ${this.id}`);switch(s.type){case"uniform":let{name:o}=s,a=t.getUniformBlockIndex(this.handle,o);if(a===4294967295)throw new Error(`Invalid uniform block name ${o}`);t.uniformBlockBinding(this.handle,i,a),n instanceof Hl?t.bindBufferBase(35345,i,n.handle):t.bindBufferRange(35345,i,n.buffer.handle,n.offset||0,n.size||n.buffer.byteLength-n.offset),i+=1;break;case"texture":if(!(n instanceof tf||n instanceof wc||n instanceof cp))throw new Error("texture");let h;if(n instanceof tf)h=n.texture;else if(n instanceof wc)h=n;else if(n instanceof cp&&n.colorAttachments[0]instanceof tf)Ce.warn("Passing framebuffer in texture binding may be deprecated. Use fbo.colorAttachments[0] instead")(),h=n.colorAttachments[0].texture;else throw new Error("No texture");t.activeTexture(33984+r),t.bindTexture(h.target,h.handle),r+=1;break;case"sampler":break;case"storage":case"read-only-storage":throw new Error(`binding type '${s.type}' not supported in WebGL`)}}}_applyUniforms(){for(let t of this.shaderLayout.uniforms||[]){let{name:r,location:i,type:s,textureUnit:n}=t,o=this.uniforms[r]??n;o!==void 0&&LH(this.device.gl,i,s,o)}}};var wE=class extends Ev{device;commands=[];constructor(t){super(t,{}),this.device=t}submitCommands(t=this.commands){for(let r of t)switch(r.name){case"copy-buffer-to-buffer":tyt(this.device,r.options);break;case"copy-buffer-to-texture":eyt(this.device,r.options);break;case"copy-texture-to-buffer":ryt(this.device,r.options);break;case"copy-texture-to-texture":iyt(this.device,r.options);break}}};function tyt(e,t){let r=t.source,i=t.destination;e.gl.bindBuffer(36662,r.handle),e.gl.bindBuffer(36663,i.handle),e.gl.copyBufferSubData(36662,36663,t.sourceOffset??0,t.destinationOffset??0,t.size),e.gl.bindBuffer(36662,null),e.gl.bindBuffer(36663,null)}function eyt(e,t){throw new Error("Not implemented")}function ryt(e,t){let{source:r,mipLevel:i=0,aspect:s="all",width:n=t.source.width,height:o=t.source.height,depthOrArrayLayers:a=0,origin:h=[0,0],destination:p,byteOffset:g=0,bytesPerRow:v,rowsPerImage:T}=t;if(s!=="all")throw new Error("not supported");if(i!==0||a!==0||v||T)throw new Error("not implemented");let{framebuffer:C,destroyFramebuffer:B}=VH(r),L;try{let z=p,W=n||C.width,Z=o||C.height,X=t2(C.texture.props.format),q=X.dataFormat,it=X.type;e.gl.bindBuffer(35051,z.handle),L=e.gl.bindFramebuffer(36160,C.handle),e.gl.readPixels(h[0],h[1],W,Z,q,it,g)}finally{e.gl.bindBuffer(35051,null),L!==void 0&&e.gl.bindFramebuffer(36160,L),B&&C.destroy()}}function iyt(e,t){let{source:r,destinationMipLevel:i=0,origin:s=[0,0],destinationOrigin:n=[0,0],destination:o}=t,{width:a=t.destination.width,height:h=t.destination.height}=t,{framebuffer:p,destroyFramebuffer:g}=VH(r),[v,T]=s,[C,B,L]=n,z=e.gl.bindFramebuffer(36160,p.handle),W=null,Z;if(o instanceof wc)W=o,a=Number.isFinite(a)?a:W.width,h=Number.isFinite(h)?h:W.height,W.bind(0),Z=W.target;else throw new Error("invalid destination");switch(Z){case 3553:case 34067:e.gl.copyTexSubImage2D(Z,i,C,B,v,T,a,h);break;case 35866:case 32879:e.gl.copyTexSubImage3D(Z,i,C,B,L,v,T,a,h);break;default:}W&&W.unbind(),e.gl.bindFramebuffer(36160,z),g&&p.destroy()}function VH(e){if(e instanceof jo){let{width:t,height:r,id:i}=e;return{framebuffer:e.device.createFramebuffer({id:`framebuffer-for-${i}`,width:t,height:r,colorAttachments:[e]}),destroyFramebuffer:!0}}return{framebuffer:e,destroyFramebuffer:!1}}var TE=class extends Sv{device;commandBuffer;constructor(t,r){super(t,r),this.device=t,this.commandBuffer=new wE(t)}destroy(){}finish(){this.commandBuffer.submitCommands()}copyBufferToBuffer(t){this.commandBuffer.commands.push({name:"copy-buffer-to-buffer",options:t})}copyBufferToTexture(t){this.commandBuffer.commands.push({name:"copy-buffer-to-texture",options:t})}copyTextureToBuffer(t){this.commandBuffer.commands.push({name:"copy-texture-to-buffer",options:t})}copyTextureToTexture(t){this.commandBuffer.commands.push({name:"copy-texture-to-texture",options:t})}pushDebugGroup(t){}popDebugGroup(){}insertDebugMarker(t){}resolveQuerySet(t,r,i){}};var SE=class e extends Iv{get[Symbol.toStringTag](){return"VertexArray"}device;handle;buffer=null;bufferValue=null;static isConstantAttributeZeroSupported(t){return kR()==="Chrome"}constructor(t,r){super(t,r),this.device=t,this.handle=this.device.gl.createVertexArray()}destroy(){super.destroy(),this.buffer&&this.buffer?.destroy(),this.handle&&(this.device.gl.deleteVertexArray(this.handle),this.handle=void 0)}setIndexBuffer(t){let r=t;if(r&&r.glTarget!==34963)throw new Error("Use .setBuffer()");this.device.gl.bindVertexArray(this.handle),this.device.gl.bindBuffer(34963,r?r.handle:null),this.indexBuffer=r,this.device.gl.bindVertexArray(null)}setBuffer(t,r){let i=r;if(i.glTarget===34963)throw new Error("Use .setIndexBuffer()");let{size:s,type:n,stride:o,offset:a,normalized:h,integer:p,divisor:g}=this._getAccessor(t);this.device.gl.bindVertexArray(this.handle),this.device.gl.bindBuffer(34962,i.handle),p?this.device.gl.vertexAttribIPointer(t,s,n,o,a):this.device.gl.vertexAttribPointer(t,s,n,h,o,a),this.device.gl.bindBuffer(34962,null),this.device.gl.enableVertexAttribArray(t),this.device.gl.vertexAttribDivisor(t,g||0),this.attributes[t]=i,this.device.gl.bindVertexArray(null)}setConstantWebGL(t,r){this._enable(t,!1),this.attributes[t]=r}bindBeforeRender(){this.device.gl.bindVertexArray(this.handle),this._applyConstantAttributes()}unbindAfterRender(){this.device.gl.bindVertexArray(null)}_applyConstantAttributes(){for(let t=0;t<this.maxVertexAttributes;++t){let r=this.attributes[t];ArrayBuffer.isView(r)&&this.device.setConstantAttributeWebGL(t,r)}}_getAccessor(t){let r=this.attributeInfos[t];if(!r)throw new Error(`Unknown attribute location ${t}`);let i=aE(r.bufferDataType);return{size:r.bufferComponents,type:i,stride:r.byteStride,offset:r.byteOffset,normalized:r.normalized,integer:r.integer,divisor:r.stepMode==="instance"?1:0}}_enable(t,r=!0){let s=e.isConstantAttributeZeroSupported(this.device)||t!==0;(r||s)&&(t=Number(t),this.device.gl.bindVertexArray(this.handle),r?this.device.gl.enableVertexAttribArray(t):this.device.gl.disableVertexAttribArray(t),this.device.gl.bindVertexArray(null))}getConstantBuffer(t,r){let i=nyt(r),s=i.byteLength*t,n=i.length*t;if(this.buffer&&s!==this.buffer.byteLength)throw new Error(`Buffer size is immutable, byte length ${s} !== ${this.buffer.byteLength}.`);let o=!this.buffer;if(this.buffer=this.buffer||this.device.createBuffer({byteLength:s}),o=o||!syt(i,this.bufferValue),o){let a=Ek(r.constructor,n);Ik({target:a,source:i,start:0,count:n}),this.buffer.write(a),this.bufferValue=r}return this.buffer}};function nyt(e){return Array.isArray(e)?new Float32Array(e):e}function syt(e,t){if(!e||!t||e.length!==t.length||e.constructor!==t.constructor)return!1;for(let r=0;r<e.length;++r)if(e[r]!==t[r])return!1;return!0}var EE=class extends Mv{device;gl;handle;layout;buffers={};unusedBuffers={};bindOnUse=!0;_bound=!1;constructor(t,r){super(t,r),this.device=t,this.gl=t.gl,this.handle=this.props.handle||this.gl.createTransformFeedback(),this.layout=this.props.layout,r.buffers&&this.setBuffers(r.buffers),Object.seal(this)}destroy(){this.gl.deleteTransformFeedback(this.handle),super.destroy()}begin(t="point-list"){this.gl.bindTransformFeedback(36386,this.handle),this.bindOnUse&&this._bindBuffers(),this.gl.beginTransformFeedback(zH(t))}end(){this.gl.endTransformFeedback(),this.bindOnUse&&this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null)}setBuffers(t){this.buffers={},this.unusedBuffers={},this.bind(()=>{for(let r in t)this.setBuffer(r,t[r])})}setBuffer(t,r){let i=this._getVaryingIndex(t),{buffer:s,byteLength:n,byteOffset:o}=this._getBufferRange(r);if(i<0){this.unusedBuffers[t]=s,Ce.warn(`${this.id} unusedBuffers varying buffer ${t}`)();return}this.buffers[i]={buffer:s,byteLength:n,byteOffset:o},this.bindOnUse||this._bindBuffer(i,s,o,n)}getBuffer(t){if(jH(t))return this.buffers[t]||null;let r=this._getVaryingIndex(t);return r>=0?this.buffers[r]:null}bind(t=this.handle){if(typeof t!="function")return this.gl.bindTransformFeedback(36386,t),this;let r;return this._bound?r=t():(this.gl.bindTransformFeedback(36386,this.handle),this._bound=!0,r=t(),this._bound=!1,this.gl.bindTransformFeedback(36386,null)),r}unbind(){this.bind(null)}_getBufferRange(t){if(t instanceof Hl)return{buffer:t,byteOffset:0,byteLength:t.byteLength};let{buffer:r,byteOffset:i=0,byteLength:s=t.buffer.byteLength}=t;return{buffer:r,byteOffset:i,byteLength:s}}_getVaryingIndex(t){if(jH(t))return Number(t);for(let r of this.layout.varyings)if(t===r.name)return r.location;return-1}_bindBuffers(){for(let t in this.buffers){let{buffer:r,byteLength:i,byteOffset:s}=this._getBufferRange(this.buffers[t]);this._bindBuffer(Number(t),r,s,i)}}_unbindBuffers(){for(let t in this.buffers)this.gl.bindBufferBase(35982,Number(t),null)}_bindBuffer(t,r,i=0,s){let n=r&&r.handle;!n||s===void 0?this.gl.bindBufferBase(35982,t,n):this.gl.bindBufferRange(35982,t,n,i,s)}};function jH(e){return typeof e=="number"?Number.isInteger(e):/^\d+$/.test(e)}var IE=class extends Cv{device;handle;target=null;_queryPending=!1;_pollingPromise=null;get[Symbol.toStringTag](){return"Query"}constructor(t,r){if(super(t,r),this.device=t,r.count>1)throw new Error("WebGL QuerySet can only have one value");this.handle=this.device.gl.createQuery(),Object.seal(this)}destroy(){this.device.gl.deleteQuery(this.handle)}beginTimestampQuery(){return this._begin(35007)}endTimestampQuery(){this._end()}beginOcclusionQuery(t){return this._begin(t?.conservative?36202:35887)}endOcclusionQuery(){this._end()}beginTransformFeedbackQuery(){return this._begin(35976)}endTransformFeedbackQuery(){this._end()}async resolveQuery(){return[await this.pollQuery()]}_begin(t){this._queryPending||(this.target=t,this.device.gl.beginQuery(this.target,this.handle))}_end(){this._queryPending||this.target&&(this.device.gl.endQuery(this.target),this.target=null,this._queryPending=!0)}isResultAvailable(){if(!this._queryPending)return!1;let t=this.device.gl.getQueryParameter(this.handle,34919);return t&&(this._queryPending=!1),t}isTimerDisjoint(){return this.device.gl.getParameter(36795)}getResult(){return this.device.gl.getQueryParameter(this.handle,34918)}getTimerMilliseconds(){return this.getResult()/1e6}pollQuery(t=Number.POSITIVE_INFINITY){if(this._pollingPromise)return this._pollingPromise;let r=0;return this._pollingPromise=new Promise((i,s)=>{let n=()=>{this.isResultAvailable()?(i(this.getResult()),this._pollingPromise=null):r++>t?(s("Timed out"),this._pollingPromise=null):requestAnimationFrame(n)};requestAnimationFrame(n)}),this._pollingPromise}};function UD(e){switch(e){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return Qi(!1),0}}function WH(e){switch(e){case 5121:return 1;case 33635:case 32819:case 32820:return 2;case 5126:return 4;default:return Qi(!1),0}}function $H(e,t){let{sourceX:r=0,sourceY:i=0,sourceFormat:s=6408,sourceAttachment:n=36064}=t||{},{target:o=null,sourceWidth:a,sourceHeight:h,sourceType:p}=t||{},{framebuffer:g,deleteFramebuffer:v}=qH(e);Qi(g);let{gl:T,handle:C}=g;a=a||g.width,h=h||g.height;let B=n-36064;p=p||g.colorAttachments[B]?.texture?.type||5121,o=ayt(o,p,s,a,h),p=p||kH(o);let L=T.bindFramebuffer(36160,C);return T.readPixels(r,i,a,h,s,p,o),T.bindFramebuffer(36160,L||null),v&&g.destroy(),o}function HH(e,t){let{target:r,sourceX:i=0,sourceY:s=0,sourceFormat:n=6408,targetByteOffset:o=0}=t||{},{sourceWidth:a,sourceHeight:h,sourceType:p}=t||{},{framebuffer:g,deleteFramebuffer:v}=qH(e);Qi(g),a=a||g.width,h=h||g.height;let T=g;p=p||5121;let C=r;if(!C){let L=UD(n),z=WH(p),W=o+a*h*L*z;C=T.device.createBuffer({byteLength:W})}let B=e.device.createCommandEncoder();return B.copyTextureToBuffer({source:e,width:a,height:h,origin:[i,s],destination:C,byteOffset:o}),B.destroy(),v&&g.destroy(),C}function qH(e){return e instanceof Fg?{framebuffer:e,deleteFramebuffer:!1}:{framebuffer:oyt(e),deleteFramebuffer:!0}}function oyt(e,t){let{device:r,width:i,height:s,id:n}=e;return r.createFramebuffer({...t,id:`framebuffer-for-${n}`,width:i,height:s,colorAttachments:[e]})}function ayt(e,t,r,i,s){if(e)return e;t=t||5121;let n=xw(t,{clamped:!1}),o=UD(r);return new n(i*s*o)}var lyt=256,cyt=1024,uyt=16384;var hyt="clear: bad arguments";function YH(e,t){let{framebuffer:r=null,color:i=null,depth:s=null,stencil:n=null}=t||{},o={};r&&(o.framebuffer=r);let a=0;i&&(a|=uyt,i!==!0&&(o.clearColor=i)),s&&(a|=lyt,s!==!0&&(o.clearDepth=s)),n&&(a|=cyt,s!==!0&&(o.clearStencil=s)),Qi(a!==0,hyt);let h=e.gl;Ju(h,o,()=>{h.clear(a)})}var bw=1,e1=class e extends Cd{static type="webgl";type="webgl";handle;features;limits;info;canvasContext;lost;_resolveContextLost;static isSupported(){return typeof WebGL2RenderingContext<"u"}static attach(t){if(t instanceof e)return t;if(t?.device instanceof Cd)return t.device;if(!fyt(t))throw new Error("Invalid WebGL2RenderingContext");return new e({gl:t})}static async create(t={}){Ce.groupCollapsed(bw,"WebGLDevice created")();let r=[];t.debug&&r.push(MH()),t.spector&&r.push(SH()),typeof t.canvas=="string"&&r.push(Og.pageLoaded);let i=await Promise.allSettled(r);for(let o of i)o.status==="rejected"&&Ce.error(`Failed to initialize debug libraries ${o.reason}`)();if(Ce.probe(bw+1,"DOM is loaded")(),t.gl?.device)return Ce.warn("reattaching existing device")(),e.attach(t.gl);let s=new e(t),n=`Created ${s.type}${s.debug?" debug":""} context: ${s.info.vendor}, ${s.info.renderer} for canvas: ${s.canvasContext.id}`;return Ce.probe(bw,n)(),Ce.table(bw,s.info)(),Ce.groupEnd(bw)(),s}constructor(t){super({...t,id:t.id||Wl("webgl-device")});let r=t.gl?.device;if(r)throw new Error(`WebGL context already attached to device ${r.id}`);let i=t.gl?.canvas||t.canvas;this.canvasContext=new _E(this,{...t,canvas:i}),this.lost=new Promise(a=>{this._resolveContextLost=a});let s=t.gl||null;if(s||=cH(this.canvasContext.canvas,{...t,onContextLost:a=>this._resolveContextLost?.({reason:"destroyed",message:"Entered sleep mode, or too many apps or browser tabs are using the GPU."})}),!s)throw new Error("WebGL context creation failed");this.handle=s,this.gl=s,this.gl.device=this,this.gl._version=2,t.spector&&(this.spectorJS=EH({...this.props,canvas:this.handle.canvas})),this.info=uH(this.gl,this._extensions),this.limits=new dE(this.gl),this.features=new pE(this.gl,this._extensions,this.props.disabledFeatures),this.props.initalizeFeatures&&this.features.initializeFeatures(),this.canvasContext.resize();let{enable:n=!0,copyState:o=!1}=t;MD(this.gl,{enable:n,copyState:o,log:(...a)=>Ce.log(1,...a)()}),t.debug&&(this.gl=CH(this.gl,{...t,throwOnError:!0}),this.debug=!0,Ce.level=Math.max(Ce.level,1),Ce.warn("WebGL debug mode activated. Performance reduced.")())}destroy(){}get isLost(){return this.gl.isContextLost()}getSize(){return[this.gl.drawingBufferWidth,this.gl.drawingBufferHeight]}isTextureFormatSupported(t){return fE(this.gl,t,this._extensions)}isTextureFormatFilterable(t){return gH(this.gl,t,this._extensions)}isTextureFormatRenderable(t){return _H(this.gl,t,this._extensions)}createCanvasContext(t){throw new Error("WebGL only supports a single canvas")}createBuffer(t){let r=this._getBufferProps(t);return new Hl(this,r)}_createTexture(t){return new wc(this,t)}createExternalTexture(t){throw new Error("createExternalTexture() not implemented")}createSampler(t){return new t1(this,t)}createShader(t){return new yE(this,t)}createFramebuffer(t){return new cp(this,t)}createVertexArray(t){return new SE(this,t)}createTransformFeedback(t){return new EE(this,t)}createQuerySet(t){return new IE(this,t)}createRenderPipeline(t){return new vE(this,t)}beginRenderPass(t){return new xE(this,t)}createComputePipeline(t){throw new Error("ComputePipeline not supported in WebGL")}beginComputePass(t){throw new Error("ComputePass not supported in WebGL")}renderPass=null;createCommandEncoder(t){return new TE(this,t)}submit(){this.renderPass?.end(),this.renderPass=null}readPixelsToArrayWebGL(t,r){return $H(t,r)}readPixelsToBufferWebGL(t,r){return HH(t,r)}setParametersWebGL(t){Jh(this.gl,t)}getParametersWebGL(t){return oE(this.gl,t)}withParametersWebGL(t,r){return Ju(this.gl,t,r)}clearWebGL(t){YH(this,t)}resetWebGL(){Ce.warn("WebGLDevice.resetWebGL is deprecated, use only for debugging")(),oH(this.gl)}gl;debug=!1;_canvasSizeInfo={clientWidth:0,clientHeight:0,devicePixelRatio:1};_extensions={};_polyfilled=!1;spectorJS;loseDevice(){let t=!1,i=this.getExtension("WEBGL_lose_context").WEBGL_lose_context;return i&&(t=!0,i.loseContext()),this._resolveContextLost?.({reason:"destroyed",message:"Application triggered context loss"}),t}pushState(){zm(this.gl)}popState(){zd(this.gl)}setSpectorMetadata(t,r){t.__SPECTOR_Metadata=r}getGLKey(t,r){r=r||this.gl2||this.gl;let i=Number(t);for(let s in r)if(r[s]===i)return`GL.${s}`;return String(t)}_constants;setConstantAttributeWebGL(t,r){let i=this.limits.maxVertexAttributes;this._constants=this._constants||new Array(i).fill(null);let s=this._constants[t];switch(s&&Ayt(s,r)&&Ce.info(1,`setConstantAttributeWebGL(${t}) could have been skipped, value unchanged`)(),this._constants[t]=r,r.constructor){case Float32Array:pyt(this,t,r);break;case Int32Array:dyt(this,t,r);break;case Uint32Array:myt(this,t,r);break;default:Qi(!1)}}getExtension(t){return Ku(this.gl,t,this._extensions),this._extensions}};function fyt(e){return typeof WebGL2RenderingContext<"u"&&e instanceof WebGL2RenderingContext?!0:!!(e&&Number.isFinite(e._version))}function pyt(e,t,r){switch(r.length){case 1:e.gl.vertexAttrib1fv(t,r);break;case 2:e.gl.vertexAttrib2fv(t,r);break;case 3:e.gl.vertexAttrib3fv(t,r);break;case 4:e.gl.vertexAttrib4fv(t,r);break;default:Qi(!1)}}function dyt(e,t,r){e.gl.vertexAttribI4iv(t,r)}function myt(e,t,r){e.gl.vertexAttribI4uiv(t,r)}function Ayt(e,t){if(!e||!t||e.length!==t.length||e.constructor!==t.constructor)return!1;for(let r=0;r<e.length;++r)if(e[r]!==t[r])return!1;return!0}var r1=RR(XH());var gyt={mousedown:1,mousemove:2,mouseup:4};function _yt(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return!0;return!1}function ZH(e){let t=e.prototype.handler;e.prototype.handler=function(i){let s=this.store;i.button>0&&i.type==="pointerdown"&&(_yt(s,n=>n.pointerId===i.pointerId)||s.push(i)),t.call(this,i)}}function GH(e){e.prototype.handler=function(r){let i=gyt[r.type];i&1&&r.button>=0&&(this.pressed=!0),i&2&&r.buttons===0&&(i=4),this.pressed&&(i&4&&(this.pressed=!1),this.callback(this.manager,i,{pointers:[r],changedPointers:[r],pointerType:"mouse",srcEvent:r}))}}ZH(r1.PointerEventInput);GH(r1.MouseInput);var QH=r1.Manager,ef=r1;var rf=class{constructor(t,r,i){this.element=t,this.callback=r,this.options={enable:!0,...i}}};var KH=ef?[[ef.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[ef.Rotate,{enable:!1}],[ef.Pinch,{enable:!1}],[ef.Swipe,{enable:!1}],[ef.Pan,{threshold:0,enable:!1}],[ef.Press,{enable:!1}],[ef.Tap,{event:"doubletap",taps:2,enable:!1}],[ef.Tap,{event:"anytap",enable:!1}],[ef.Tap,{enable:!1}]]:null,VD={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},JH={doubletap:["tap"]},tq={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},e2={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},eq={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},jD={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"};var rq=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",i1=typeof window<"u"?window:global;var CE=!1;try{let e={get passive(){return CE=!0,!0}};i1.addEventListener("test",null,e),i1.removeEventListener("test",null)}catch{CE=!1}var yyt=rq.indexOf("firefox")!==-1,{WHEEL_EVENTS:xyt}=e2,iq="wheel",nq=4.000244140625,byt=40,vyt=.25,vw=class extends rf{constructor(t,r,i){super(t,r,i),this.handleEvent=s=>{if(!this.options.enable)return;let n=s.deltaY;i1.WheelEvent&&(yyt&&s.deltaMode===i1.WheelEvent.DOM_DELTA_PIXEL&&(n/=i1.devicePixelRatio),s.deltaMode===i1.WheelEvent.DOM_DELTA_LINE&&(n*=byt)),n!==0&&n%nq===0&&(n=Math.floor(n/nq)),s.shiftKey&&n&&(n=n*vyt),this.callback({type:iq,center:{x:s.clientX,y:s.clientY},delta:-n,srcEvent:s,pointerType:"mouse",target:s.target})},this.events=(this.options.events||[]).concat(xyt),this.events.forEach(s=>t.addEventListener(s,this.handleEvent,CE?{passive:!1}:!1))}destroy(){this.events.forEach(t=>this.element.removeEventListener(t,this.handleEvent))}enableEventType(t,r){t===iq&&(this.options.enable=r)}};var{MOUSE_EVENTS:wyt}=e2,sq="pointermove",oq="pointerover",aq="pointerout",lq="pointerenter",cq="pointerleave",ww=class extends rf{constructor(t,r,i){super(t,r,i),this.handleEvent=n=>{this.handleOverEvent(n),this.handleOutEvent(n),this.handleEnterEvent(n),this.handleLeaveEvent(n),this.handleMoveEvent(n)},this.pressed=!1;let{enable:s}=this.options;this.enableMoveEvent=s,this.enableLeaveEvent=s,this.enableEnterEvent=s,this.enableOutEvent=s,this.enableOverEvent=s,this.events=(this.options.events||[]).concat(wyt),this.events.forEach(n=>t.addEventListener(n,this.handleEvent))}destroy(){this.events.forEach(t=>this.element.removeEventListener(t,this.handleEvent))}enableEventType(t,r){t===sq&&(this.enableMoveEvent=r),t===oq&&(this.enableOverEvent=r),t===aq&&(this.enableOutEvent=r),t===lq&&(this.enableEnterEvent=r),t===cq&&(this.enableLeaveEvent=r)}handleOverEvent(t){this.enableOverEvent&&t.type==="mouseover"&&this._emit(oq,t)}handleOutEvent(t){this.enableOutEvent&&t.type==="mouseout"&&this._emit(aq,t)}handleEnterEvent(t){this.enableEnterEvent&&t.type==="mouseenter"&&this._emit(lq,t)}handleLeaveEvent(t){this.enableLeaveEvent&&t.type==="mouseleave"&&this._emit(cq,t)}handleMoveEvent(t){if(this.enableMoveEvent)switch(t.type){case"mousedown":t.button>=0&&(this.pressed=!0);break;case"mousemove":t.buttons===0&&(this.pressed=!1),this.pressed||this._emit(sq,t);break;case"mouseup":this.pressed=!1;break;default:}}_emit(t,r){this.callback({type:t,center:{x:r.clientX,y:r.clientY},srcEvent:r,pointerType:"mouse",target:r.target})}};var{KEY_EVENTS:Tyt}=e2,uq="keydown",hq="keyup",Tw=class extends rf{constructor(t,r,i){super(t,r,i),this.handleEvent=s=>{let n=s.target||s.srcElement;n.tagName==="INPUT"&&n.type==="text"||n.tagName==="TEXTAREA"||(this.enableDownEvent&&s.type==="keydown"&&this.callback({type:uq,srcEvent:s,key:s.key,target:s.target}),this.enableUpEvent&&s.type==="keyup"&&this.callback({type:hq,srcEvent:s,key:s.key,target:s.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=(this.options.events||[]).concat(Tyt),t.tabIndex=this.options.tabIndex||0,t.style.outline="none",this.events.forEach(s=>t.addEventListener(s,this.handleEvent))}destroy(){this.events.forEach(t=>this.element.removeEventListener(t,this.handleEvent))}enableEventType(t,r){t===uq&&(this.enableDownEvent=r),t===hq&&(this.enableUpEvent=r)}};var fq="contextmenu",Sw=class extends rf{constructor(t,r,i){super(t,r,i),this.handleEvent=s=>{this.options.enable&&this.callback({type:fq,center:{x:s.clientX,y:s.clientY},srcEvent:s,pointerType:"mouse",target:s.target})},t.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(t,r){t===fq&&(this.options.enable=r)}};var Syt={pointerdown:1,pointermove:2,pointerup:4,mousedown:1,mousemove:2,mouseup:4},Eyt=0,Iyt=1,Myt=2,Cyt=1,Pyt=2,Ryt=4;function pq(e){let t=Syt[e.srcEvent.type];if(!t)return null;let{buttons:r,button:i}=e.srcEvent,s=!1,n=!1,o=!1;return t===2?(s=!!(r&Cyt),n=!!(r&Ryt),o=!!(r&Pyt)):(s=i===Eyt,n=i===Iyt,o=i===Myt),{leftButton:s,middleButton:n,rightButton:o}}function dq(e,t){let r=e.center;if(!r)return null;let i=t.getBoundingClientRect(),s=i.width/t.offsetWidth||1,n=i.height/t.offsetHeight||1,o={x:(r.x-i.left-t.clientLeft)/s,y:(r.y-i.top-t.clientTop)/n};return{center:r,offsetCenter:o}}var WD={srcElement:"root",priority:0},Ew=class{constructor(t){this.handleEvent=r=>{if(this.isEmpty())return;let i=this._normalizeEvent(r),s=r.srcEvent.target;for(;s&&s!==i.rootElement;){if(this._emit(i,s),i.handled)return;s=s.parentNode}this._emit(i,"root")},this.eventManager=t,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(t,r,i,s=!1,n=!1){let{handlers:o,handlersByElement:a}=this,h=WD;typeof i=="string"||i&&i.addEventListener?h={...WD,srcElement:i}:i&&(h={...WD,...i});let p=a.get(h.srcElement);p||(p=[],a.set(h.srcElement,p));let g={type:t,handler:r,srcElement:h.srcElement,priority:h.priority};s&&(g.once=!0),n&&(g.passive=!0),o.push(g),this._active=this._active||!g.passive;let v=p.length-1;for(;v>=0&&!(p[v].priority>=g.priority);)v--;p.splice(v+1,0,g)}remove(t,r){let{handlers:i,handlersByElement:s}=this;for(let n=i.length-1;n>=0;n--){let o=i[n];if(o.type===t&&o.handler===r){i.splice(n,1);let a=s.get(o.srcElement);a.splice(a.indexOf(o),1),a.length===0&&s.delete(o.srcElement)}}this._active=i.some(n=>!n.passive)}_emit(t,r){let i=this.handlersByElement.get(r);if(i){let s=!1,n=()=>{t.handled=!0},o=()=>{t.handled=!0,s=!0},a=[];for(let h=0;h<i.length;h++){let{type:p,handler:g,once:v}=i[h];if(g({...t,type:p,stopPropagation:n,stopImmediatePropagation:o}),v&&a.push(i[h]),s)break}for(let h=0;h<a.length;h++){let{type:p,handler:g}=a[h];this.remove(p,g)}}}_normalizeEvent(t){let r=this.eventManager.getElement();return{...t,...pq(t),...dq(t,r),preventDefault:()=>{t.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:r}}};var kyt={events:null,recognizers:null,recognizerOptions:{},Manager:QH,touchAction:"none",tabIndex:0},r2=class{constructor(t=null,r){this._onBasicInput=s=>{let{srcEvent:n}=s,o=tq[n.type];o&&this.manager.emit(o,s)},this._onOtherEvent=s=>{this.manager.emit(s.type,s)},this.options={...kyt,...r},this.events=new Map,this.setElement(t);let{events:i}=this.options;i&&this.on(i)}getElement(){return this.element}setElement(t){if(this.element&&this.destroy(),this.element=t,!t)return;let{options:r}=this,i=r.Manager;this.manager=new i(t,{touchAction:r.touchAction,recognizers:r.recognizers||KH}).on("hammer.input",this._onBasicInput),r.recognizers||Object.keys(VD).forEach(s=>{let n=this.manager.get(s);n&&VD[s].forEach(o=>{n.recognizeWith(o)})});for(let s in r.recognizerOptions){let n=this.manager.get(s);if(n){let o=r.recognizerOptions[s];delete o.enable,n.set(o)}}this.wheelInput=new vw(t,this._onOtherEvent,{enable:!1}),this.moveInput=new ww(t,this._onOtherEvent,{enable:!1}),this.keyInput=new Tw(t,this._onOtherEvent,{enable:!1,tabIndex:r.tabIndex}),this.contextmenuInput=new Sw(t,this._onOtherEvent,{enable:!1});for(let[s,n]of this.events)n.isEmpty()||(this._toggleRecognizer(n.recognizerName,!0),this.manager.on(s,n.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(t,r,i){this._addEventHandler(t,r,i,!1)}once(t,r,i){this._addEventHandler(t,r,i,!0)}watch(t,r,i){this._addEventHandler(t,r,i,!1,!0)}off(t,r){this._removeEventHandler(t,r)}_toggleRecognizer(t,r){let{manager:i}=this;if(!i)return;let s=i.get(t);if(s&&s.options.enable!==r){s.set({enable:r});let n=JH[t];n&&!this.options.recognizers&&n.forEach(o=>{let a=i.get(o);r?(a.requireFailure(t),s.dropRequireFailure(o)):a.dropRequireFailure(t)})}this.wheelInput.enableEventType(t,r),this.moveInput.enableEventType(t,r),this.keyInput.enableEventType(t,r),this.contextmenuInput.enableEventType(t,r)}_addEventHandler(t,r,i,s,n){if(typeof t!="string"){i=r;for(let g in t)this._addEventHandler(g,t[g],i,s,n);return}let{manager:o,events:a}=this,h=jD[t]||t,p=a.get(h);p||(p=new Ew(this),a.set(h,p),p.recognizerName=eq[h]||h,o&&o.on(h,p.handleEvent)),p.add(t,r,i,s,n),p.isEmpty()||this._toggleRecognizer(p.recognizerName,!0)}_removeEventHandler(t,r){if(typeof t!="string"){for(let o in t)this._removeEventHandler(o,t[o]);return}let{events:i}=this,s=jD[t]||t,n=i.get(s);if(n&&(n.remove(t,r),n.isEmpty())){let{recognizerName:o}=n,a=!1;for(let h of i.values())if(h.recognizerName===o&&!h.isEmpty()){a=!0;break}a||this._toggleRecognizer(o,!1)}}};function Um(){}var Dyt=({isDragging:e})=>e?"grabbing":"grab",mq={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,parameters:{},parent:null,device:null,deviceProps:{type:"webgl"},gl:null,glOptions:{},canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,widgets:[],onDeviceInitialized:Um,onWebGLInitialized:Um,onResize:Um,onViewStateChange:Um,onInteractionStateChange:Um,onBeforeRender:Um,onAfterRender:Um,onLoad:Um,onError:e=>Ir.error(e.message,e.cause)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:Dyt,getTooltip:null,debug:!1,drawPickingColors:!1},Ud=class{static{this.defaultProps=mq}static{this.VERSION=wj}constructor(t){this.width=0,this.height=0,this.userData={},this.device=null,this.canvas=null,this.viewManager=null,this.layerManager=null,this.effectManager=null,this.deckRenderer=null,this.deckPicker=null,this.eventManager=null,this.widgetManager=null,this.tooltip=null,this.animationLoop=null,this.cursorState={isHovering:!1,isDragging:!1},this.stats=new _c({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this._lastPointerDownInfo=null,this._onPointerMove=i=>{let{_pickRequest:s}=this;if(i.type==="pointerleave")s.x=-1,s.y=-1,s.radius=0;else{if(i.leftButton||i.rightButton)return;{let n=i.offsetCenter;if(!n)return;s.x=n.x,s.y=n.y,s.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:s.x,y:s.y}),s.event=i},this._onEvent=i=>{let s=$v[i.type],n=i.offsetCenter;if(!s||!n||!this.layerManager)return;let o=this.layerManager.getLayers(),a=this.deckPicker.getLastPickedObject({x:n.x,y:n.y,layers:o,viewports:this.getViewports(n)},this._lastPointerDownInfo),{layer:h}=a,p=h&&(h[s.handler]||h.props[s.handler]),g=this.props[s.handler],v=!1;p&&(v=p.call(h,a,i)),v||(g?.(a,i),this.widgetManager.onEvent(a,i))},this._onPointerDown=i=>{let s=i.offsetCenter,n=this._pick("pickObject","pickObject Time",{x:s.x,y:s.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=n.result[0]||n.emptyInfo},this.props={...mq,...t},t=this.props,t.viewState&&t.initialViewState&&Ir.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),this.viewState=this.props.initialViewState,t.device?this.device=t.device:t.gl&&(t.gl instanceof WebGLRenderingContext&&Ir.error("WebGL1 context not supported.")(),this.device=e1.attach(t.gl));let r=this.device;r||(Pd.registerDevices([e1]),r=Pd.createDevice({...t.deviceProps,canvas:this._createCanvas(t)})),this.animationLoop=this._createAnimationLoop(r,t),this.setProps(t),t._typedArrayManagerProps&&Gh.setOptions(t._typedArrayManagerProps),this.animationLoop.start()}finalize(){this.animationLoop?.stop(),this.animationLoop?.destroy(),this.animationLoop=null,this._lastPointerDownInfo=null,this.layerManager?.finalize(),this.layerManager=null,this.viewManager?.finalize(),this.viewManager=null,this.effectManager?.finalize(),this.effectManager=null,this.deckRenderer?.finalize(),this.deckRenderer=null,this.deckPicker?.finalize(),this.deckPicker=null,this.eventManager?.destroy(),this.eventManager=null,this.widgetManager?.finalize(),this.widgetManager=null,!this.props.canvas&&!this.props.device&&!this.props.gl&&this.canvas&&(this.canvas.parentElement?.removeChild(this.canvas),this.canvas=null)}setProps(t){this.stats.get("setProps Time").timeStart(),"onLayerHover"in t&&Ir.removed("onLayerHover","onHover")(),"onLayerClick"in t&&Ir.removed("onLayerClick","onClick")(),t.initialViewState&&!ja(this.props.initialViewState,t.initialViewState,3)&&(this.viewState=t.initialViewState),Object.assign(this.props,t),this._setCanvasSize(this.props);let r=Object.create(this.props);Object.assign(r,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop?.setProps(r),this.layerManager&&(this.viewManager.setProps(r),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(r),this.effectManager.setProps(r),this.deckRenderer.setProps(r),this.deckPicker.setProps(r),this.widgetManager.setProps(r)),this.stats.get("setProps Time").timeEnd()}needsRedraw(t={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let r=this._needsRedraw;t.clearRedrawFlags&&(this._needsRedraw=!1);let i=this.viewManager.needsRedraw(t),s=this.layerManager.needsRedraw(t),n=this.effectManager.needsRedraw(t),o=this.deckRenderer.needsRedraw(t);return r=r||i||s||n||o,r}redraw(t){if(!this.layerManager)return;let r=this.needsRedraw({clearRedrawFlags:!0});r=t||r,r&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(r):this._drawLayers(r))}get isInitialized(){return this.viewManager!==null}getViews(){return Jn(this.viewManager),this.viewManager.views}getViewports(t){return Jn(this.viewManager),this.viewManager.getViewports(t)}getCanvas(){return this.canvas}pickObject(t){let r=this._pick("pickObject","pickObject Time",t).result;return r.length?r[0]:null}pickMultipleObjects(t){return t.depth=t.depth||10,this._pick("pickObject","pickMultipleObjects Time",t).result}pickObjects(t){return this._pick("pickObjects","pickObjects Time",t)}_addResources(t,r=!1){for(let i in t)this.layerManager.resourceManager.add({resourceId:i,data:t[i],forceUpdate:r})}_removeResources(t){for(let r of t)this.layerManager.resourceManager.remove(r)}_addDefaultEffect(t){this.effectManager.addDefaultEffect(t)}_addDefaultShaderModule(t){this.layerManager.addDefaultShaderModule(t)}_removeDefaultShaderModule(t){this.layerManager?.removeDefaultShaderModule(t)}_pick(t,r,i){Jn(this.deckPicker);let{stats:s}=this;s.get("Pick Count").incrementCount(),s.get(r).timeStart();let n=this.deckPicker[t]({layers:this.layerManager.getLayers(i),views:this.viewManager.getViews(),viewports:this.getViewports(i),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...i});return s.get(r).timeEnd(),n}_createCanvas(t){let r=t.canvas;return typeof r=="string"&&(r=document.getElementById(r),Jn(r)),r||(r=document.createElement("canvas"),r.id=t.id||"deckgl-overlay",(t.parent||document.body).appendChild(r)),Object.assign(r.style,t.style),r}_setCanvasSize(t){if(!this.canvas)return;let{width:r,height:i}=t;if(r||r===0){let s=Number.isFinite(r)?`${r}px`:r;this.canvas.style.width=s}if(i||i===0){let s=Number.isFinite(i)?`${i}px`:i;this.canvas.style.position=t.style?.position||"absolute",this.canvas.style.height=s}}_updateCanvasSize(){let{canvas:t}=this;if(!t)return;let r=t.clientWidth??t.width,i=t.clientHeight??t.height;(r!==this.width||i!==this.height)&&(this.width=r,this.height=i,this.viewManager?.setProps({width:r,height:i}),this.layerManager?.activateViewport(this.getViewports()[0]),this.props.onResize({width:r,height:i}))}_createAnimationLoop(t,r){let{gl:i,onError:s,useDevicePixels:n}=r;return new Kv({device:t,useDevicePixels:n,autoResizeDrawingBuffer:!i,autoResizeViewport:!1,onInitialize:o=>this._setDevice(o.device),onRender:this._onRenderFrame.bind(this),onError:s})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let{views:t}=this.props,r=Array.isArray(t)?t:t?[t]:[new Lm({id:"default-view"})];return r.length&&this.props.controller&&(r[0].props.controller=this.props.controller),r}_onContextLost(){let{onError:t}=this.props;this.animationLoop&&t&&t(new Error("WebGL context is lost"))}_pickAndCallback(){let{_pickRequest:t}=this;if(t.event){let{result:r,emptyInfo:i}=this._pick("pickObject","pickObject Time",t);this.cursorState.isHovering=r.length>0;let s=i,n=!1;for(let o of r)s=o,n=o.layer?.onHover(o,t.event)||n;n||(this.props.onHover?.(s,t.event),this.widgetManager.onHover(s,t.event)),t.event=null}}_updateCursor(){let t=this.props.parent||this.canvas;t&&(t.style.cursor=this.props.getCursor(this.cursorState))}_setDevice(t){if(this.device=t,!this.animationLoop)return;this.canvas||(this.canvas=this.device.canvasContext?.canvas),this.device.setParametersWebGL({blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onDeviceInitialized(this.device),this.device instanceof e1&&this.props.onWebGLInitialized(this.device.gl);let r=new Xg;r.play(),this.animationLoop.attachTimeline(r),this.eventManager=new r2(this.props.parent||this.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(let s in $v)this.eventManager.on(s,this._onEvent);this.viewManager=new rw({timeline:r,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});let i=this.viewManager.getViewports()[0];this.layerManager=new ew(this.device,{deck:this,stats:this.stats,viewport:i,timeline:r}),this.effectManager=new cw({deck:this,device:this.device}),this.deckRenderer=new hw(this.device),this.deckPicker=new fw(this.device),this.widgetManager=new sE({deck:this,parentElement:this.canvas?.parentElement}),this.widgetManager.addDefault(new pw),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(t,r){let{device:i,gl:s}=this.layerManager.context;this.props.onBeforeRender({device:i,gl:s});let n={target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",effects:this.effectManager.getEffects(),...r};this.deckRenderer?.renderLayers(n),n.pass==="screen"&&this.widgetManager.onRedraw({viewports:n.viewports,layers:n.layers}),this.props.onAfterRender({device:i,gl:s})}_onRenderFrame(){this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),Ir.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(t){let r=this.props.onViewStateChange(t)||t.viewState;this.viewState&&(this.viewState={...this.viewState,[t.viewId]:r},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(t){this.cursorState.isDragging=t.isDragging||!1,this.props.onInteractionStateChange(t)}_getFrameStats(){let{stats:t}=this;t.get("frameRate").timeEnd(),t.get("frameRate").timeStart();let r=this.animationLoop.stats;t.get("GPU Time").addTime(r.get("GPU Time").lastTiming),t.get("CPU Time").addTime(r.get("CPU Time").lastTiming)}_getMetrics(){let{metrics:t,stats:r}=this;t.fps=r.get("frameRate").getHz(),t.setPropsTime=r.get("setProps Time").time,t.updateAttributesTime=r.get("Update Attributes").time,t.framesRedrawn=r.get("Redraw Count").count,t.pickTime=r.get("pickObject Time").time+r.get("pickMultipleObjects Time").time+r.get("pickObjects Time").time,t.pickCount=r.get("Pick Count").count,t.gpuTime=r.get("GPU Time").time,t.cpuTime=r.get("CPU Time").time,t.gpuTimePerFrame=r.get("GPU Time").getAverageTime(),t.cpuTimePerFrame=r.get("CPU Time").getAverageTime();let i=Pd.stats.get("Memory Usage");t.bufferMemory=i.get("Buffer Memory").count,t.textureMemory=i.get("Texture Memory").count,t.renderbufferMemory=i.get("Renderbuffer Memory").count,t.gpuMemory=i.get("GPU Memory").count}};function Aq(e){switch(e){case"float64":return Float64Array;case"uint8":case"unorm8":return Uint8ClampedArray;default:return Rv(e)}}var gq=p5;function Iw(e,t){return{attribute:e,format:t.size>1?`${t.type}x${t.size}`:t.type,byteOffset:t.offset||0}}function Vm(e){return e.stride||e.size*e.bytesPerElement}function _q(e,t){return e.type===t.type&&e.size===t.size&&Vm(e)===Vm(t)&&(e.offset||0)===(t.offset||0)}function $D(e,t){t.offset&&Ir.removed("shaderAttribute.offset","vertexOffset, elementOffset")();let r=Vm(e),i=t.vertexOffset!==void 0?t.vertexOffset:e.vertexOffset||0,s=t.elementOffset||0,n=i*r+s*e.bytesPerElement+(e.offset||0);return{...t,offset:n,stride:r}}function Oyt(e,t){let r=$D(e,t);return{high:r,low:{...r,offset:r.offset+e.size*4}}}var Mw=class{constructor(t,r,i){this._buffer=null,this.device=t,this.id=r.id||"",this.size=r.size||1;let s=r.logicalType||r.type,n=s==="float64",{defaultValue:o}=r;o=Number.isFinite(o)?[o]:o||new Array(this.size).fill(0);let a;n?a="float32":!s&&r.isIndexed?a="uint32":a=s||"float32";let h=Aq(s||a);this.doublePrecision=n,n&&r.fp64===!1&&(h=Float32Array),this.value=null,this.settings={...r,defaultType:h,defaultValue:o,logicalType:s,type:a,normalized:a.includes("norm"),size:this.size,bytesPerElement:h.BYTES_PER_ELEMENT},this.state={...i,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1}}get isConstant(){return this.state.constant}get buffer(){return this._buffer}get byteOffset(){let t=this.getAccessor();return t.vertexOffset?t.vertexOffset*Vm(t):0}get numInstances(){return this.state.numInstances}set numInstances(t){this.state.numInstances=t}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),Gh.release(this.state.allocatedValue)}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(t=this.id,r=null){let i={};if(this.state.constant){let s=this.value;if(r){let n=$D(this.getAccessor(),r),o=n.offset/s.BYTES_PER_ELEMENT,a=n.size||this.size;i[t]=s.subarray(o,o+a)}else i[t]=s}else i[t]=this.getBuffer();return this.doublePrecision&&(this.value instanceof Float64Array?i[`${t}64Low`]=i[t]:i[`${t}64Low`]=new Float32Array(this.size)),i}_getBufferLayout(t=this.id,r=null){let i=this.getAccessor(),s=[],n={name:this.id,byteStride:Vm(i),attributes:s};if(this.doublePrecision){let o=Oyt(i,r||{});s.push(Iw(t,{...i,...o.high}),Iw(`${t}64Low`,{...i,...o.low}))}else if(r){let o=$D(i,r);s.push(Iw(t,{...i,...o}))}else s.push(Iw(t,i));return n}setAccessor(t){this.state.bufferAccessor=t}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let t=null;if(this.state.constant&&this.value){let r=Array.from(this.value);t=[r,r]}else{let{value:r,numInstances:i,size:s}=this,n=i*s;if(r&&n&&r.length>=n){let o=new Array(s).fill(1/0),a=new Array(s).fill(-1/0);for(let h=0;h<n;)for(let p=0;p<s;p++){let g=r[h++];g<o[p]&&(o[p]=g),g>a[p]&&(a[p]=g)}t=[o,a]}}return this.state.bounds=t,t}setData(t){let{state:r}=this,i;ArrayBuffer.isView(t)?i={value:t}:t instanceof En?i={buffer:t}:i=t;let s={...this.settings,...i};if(ArrayBuffer.isView(i.value)){if(!i.type)if(this.doublePrecision&&i.value instanceof Float64Array)s.type="float32";else{let o=gq(i.value);s.type=s.normalized?o.replace("int","norm"):o}s.bytesPerElement=i.value.BYTES_PER_ELEMENT,s.stride=Vm(s)}if(r.bounds=null,i.constant){let n=i.value;if(n=this._normalizeValue(n,[],0),this.settings.normalized&&(n=this.normalizeConstant(n)),!(!r.constant||!this._areValuesEqual(n,this.value)))return!1;r.externalBuffer=null,r.constant=!0,this.value=ArrayBuffer.isView(n)?n:new Float32Array(n)}else if(i.buffer){let n=i.buffer;r.externalBuffer=n,r.constant=!1,this.value=i.value||null}else if(i.value){this._checkExternalBuffer(i);let n=i.value;r.externalBuffer=null,r.constant=!1,this.value=n;let{buffer:o}=this,a=Vm(s),h=(s.vertexOffset||0)*a;if(this.doublePrecision&&n instanceof Float64Array&&(n=K5(n,s)),this.settings.isIndexed){let g=this.settings.defaultType;n.constructor!==g&&(n=new g(n))}let p=n.byteLength+h+a*2;(!o||o.byteLength<p)&&(o=this._createBuffer(p)),o.write(n,h)}return this.setAccessor(s),!0}updateSubBuffer(t={}){this.state.bounds=null;let r=this.value,{startOffset:i=0,endOffset:s}=t;this.buffer.write(this.doublePrecision&&r instanceof Float64Array?K5(r,{size:this.size,startIndex:i,endIndex:s}):r.subarray(i,s),i*r.BYTES_PER_ELEMENT+this.byteOffset)}allocate(t,r=!1){let{state:i}=this,s=i.allocatedValue,n=Gh.allocate(s,t+1,{size:this.size,type:this.settings.defaultType,copy:r});this.value=n;let{byteOffset:o}=this,{buffer:a}=this;return(!a||a.byteLength<n.byteLength+o)&&(a=this._createBuffer(n.byteLength+o),r&&s&&a.write(s instanceof Float64Array?K5(s,this):s,o)),i.allocatedValue=n,i.constant=!1,i.externalBuffer=null,this.setAccessor(this.settings),!0}_checkExternalBuffer(t){let{value:r}=t;if(!ArrayBuffer.isView(r))throw new Error(`Attribute ${this.id} value is not TypedArray`);let i=this.settings.defaultType,s=!1;if(this.doublePrecision&&(s=r.BYTES_PER_ELEMENT<4),s)throw new Error(`Attribute ${this.id} does not support ${r.constructor.name}`);!(r instanceof i)&&this.settings.normalized&&!("normalized"in t)&&Ir.warn(`Attribute ${this.id} is normalized`)()}normalizeConstant(t){switch(this.settings.type){case"snorm8":return new Float32Array(t).map(r=>(r+128)/255*2-1);case"snorm16":return new Float32Array(t).map(r=>(r+32768)/65535*2-1);case"unorm8":return new Float32Array(t).map(r=>r/255);case"unorm16":return new Float32Array(t).map(r=>r/65535);default:return t}}_normalizeValue(t,r,i){let{defaultValue:s,size:n}=this.settings;if(Number.isFinite(t))return r[i]=t,r;if(!t){let o=n;for(;--o>=0;)r[i+o]=s[o];return r}switch(n){case 4:r[i+3]=Number.isFinite(t[3])?t[3]:s[3];case 3:r[i+2]=Number.isFinite(t[2])?t[2]:s[2];case 2:r[i+1]=Number.isFinite(t[1])?t[1]:s[1];case 1:r[i+0]=Number.isFinite(t[0])?t[0]:s[0];break;default:let o=n;for(;--o>=0;)r[i+o]=Number.isFinite(t[o])?t[o]:s[o]}return r}_areValuesEqual(t,r){if(!t||!r)return!1;let{size:i}=this;for(let s=0;s<i;s++)if(t[s]!==r[s])return!1;return!0}_createBuffer(t){this._buffer&&this._buffer.destroy();let{isIndexed:r,type:i}=this.settings;return this._buffer=this.device.createBuffer({...this._buffer?.props,id:this.id,usage:r?En.INDEX:En.VERTEX,indexType:r?i:void 0,byteLength:t}),this._buffer}};var yq=[],xq=[];function hu(e,t=0,r=1/0){let i=yq,s={index:-1,data:e,target:[]};return e?typeof e[Symbol.iterator]=="function"?i=e:e.length>0&&(xq.length=e.length,i=xq):i=yq,(t>0||Number.isFinite(r))&&(i=(Array.isArray(i)?i:Array.from(i)).slice(t,r),s.index=t-1),{iterable:i,objectInfo:s}}function PE(e){return e&&e[Symbol.asyncIterator]}function RE(e,t){let{size:r,stride:i,offset:s,startIndices:n,nested:o}=t,a=e.BYTES_PER_ELEMENT,h=i?i/a:r,p=s?s/a:0,g=Math.floor((e.length-p)/h);return(v,{index:T,target:C})=>{if(!n){let W=T*h+p;for(let Z=0;Z<r;Z++)C[Z]=e[W+Z];return C}let B=n[T],L=n[T+1]||g,z;if(o){z=new Array(L-B);for(let W=B;W<L;W++){let Z=W*h+p;C=new Array(r);for(let X=0;X<r;X++)C[X]=e[Z+X];z[W-B]=C}}else if(h===r)z=e.subarray(B*r+p,L*r+p);else{z=new e.constructor((L-B)*r);let W=0;for(let Z=B;Z<L;Z++){let X=Z*h+p;for(let q=0;q<r;q++)z[W++]=e[X+q]}}return z}}var bq=[],Cw=[[0,1/0]];function vq(e,t){if(e===Cw||(t[0]<0&&(t[0]=0),t[0]>=t[1]))return e;let r=[],i=e.length,s=0;for(let n=0;n<i;n++){let o=e[n];o[1]<t[0]?(r.push(o),s=n+1):o[0]>t[1]?r.push(o):t=[Math.min(o[0],t[0]),Math.max(o[1],t[1])]}return r.splice(s,0,t),r}var Nyt={interpolation:{duration:0,easing:e=>e},spring:{stiffness:.05,damping:.5}};function kE(e,t){if(!e)return null;Number.isFinite(e)&&(e={type:"interpolation",duration:e});let r=e.type||"interpolation";return{...Nyt[r],...t,...e,type:r}}var n1=class extends Mw{constructor(t,r){super(t,r,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,layoutChanged:!1,updateRanges:Cw}),this.constant=!1,this.settings.update=r.update||(r.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(t){this.state.startIndices=t}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:t=!1}={}){let r=this.state.needsRedraw;return this.state.needsRedraw=r&&!t,r}layoutChanged(){return this.state.layoutChanged}setAccessor(t){this.state.layoutChanged||=!_q(t,this.getAccessor()),super.setAccessor(t)}getUpdateTriggers(){let{accessor:t}=this.settings;return[this.id].concat(typeof t!="function"&&t||[])}supportsTransition(){return!!this.settings.transition}getTransitionSetting(t){if(!t||!this.supportsTransition())return null;let{accessor:r}=this.settings,i=this.settings.transition,s=Array.isArray(r)?t[r.find(n=>t[n])]:t[r];return kE(s,i)}setNeedsUpdate(t=this.id,r){if(this.state.needsUpdate=this.state.needsUpdate||t,this.setNeedsRedraw(t),r){let{startRow:i=0,endRow:s=1/0}=r;this.state.updateRanges=vq(this.state.updateRanges,[i,s])}else this.state.updateRanges=Cw}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=bq}setNeedsRedraw(t=this.id){this.state.needsRedraw=this.state.needsRedraw||t}allocate(t){let{state:r,settings:i}=this;return i.noAlloc?!1:i.update?(super.allocate(t,r.updateRanges!==Cw),!0):!1}updateBuffer({numInstances:t,data:r,props:i,context:s}){if(!this.needsUpdate())return!1;let{state:{updateRanges:n},settings:{update:o,noAlloc:a}}=this,h=!0;if(o){for(let[p,g]of n)o.call(s,this,{data:r,startRow:p,endRow:g,props:i,numInstances:t});if(this.value)if(this.constant||!this.buffer||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(let[p,g]of n){let v=Number.isFinite(p)?this.getVertexOffset(p):0,T=Number.isFinite(g)?this.getVertexOffset(g):a||!Number.isFinite(t)?this.value.length:t*this.size;super.updateSubBuffer({startOffset:v,endOffset:T})}this._checkAttributeArray()}else h=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),h}setConstantValue(t){return t===void 0||typeof t=="function"?!1:(this.setData({constant:!0,value:t})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(t){let{state:r}=this;return t?(this.clearNeedsUpdate(),r.lastExternalBuffer===t||(r.lastExternalBuffer=t,this.setNeedsRedraw(),this.setData(t)),!0):(r.lastExternalBuffer=null,!1)}setBinaryValue(t,r=null){let{state:i,settings:s}=this;if(!t)return i.binaryValue=null,i.binaryAccessor=null,!1;if(s.noAlloc)return!1;if(i.binaryValue===t)return this.clearNeedsUpdate(),!0;if(i.binaryValue=t,this.setNeedsRedraw(),s.transform||r!==this.startIndices){ArrayBuffer.isView(t)&&(t={value:t});let o=t;Jn(ArrayBuffer.isView(o.value),`invalid ${s.accessor}`);let a=!!o.size&&o.size!==this.size;return i.binaryAccessor=RE(o.value,{size:o.size||this.size,stride:o.stride,offset:o.offset,startIndices:r,nested:a}),!1}return this.clearNeedsUpdate(),this.setData(t),!0}getVertexOffset(t){let{startIndices:r}=this;return(r?t<r.length?r[t]:this.numInstances:t)*this.size}getValue(){let t=this.settings.shaderAttributes,r=super.getValue();if(!t)return r;for(let i in t)Object.assign(r,super.getValue(i,t[i]));return r}getBufferLayout(t){this.state.layoutChanged=!1;let r=this.settings.shaderAttributes,i=super._getBufferLayout(),{stepMode:s}=this.settings;if(s==="dynamic"?i.stepMode=t?t.isInstanced?"instance":"vertex":"instance":i.stepMode=s??"vertex",!r)return i;for(let n in r){let o=super._getBufferLayout(n,r[n]);i.attributes.push(...o.attributes)}return i}_autoUpdater(t,{data:r,startRow:i,endRow:s,props:n,numInstances:o}){if(t.constant)return;let{settings:a,state:h,value:p,size:g,startIndices:v}=t,{accessor:T,transform:C}=a,B=h.binaryAccessor||(typeof T=="function"?T:n[T]);Jn(typeof B=="function",`accessor "${T}" is not a function`);let L=t.getVertexOffset(i),{iterable:z,objectInfo:W}=hu(r,i,s);for(let Z of z){W.index++;let X=B(Z,W);if(C&&(X=C.call(this,X)),v){let q=(W.index<v.length-1?v[W.index+1]:o)-v[W.index];if(X&&Array.isArray(X[0])){let it=L;for(let nt of X)t._normalizeValue(nt,p,it),it+=g}else X&&X.length>g?p.set(X,L):(t._normalizeValue(X,W.target,0),yD({target:p,source:W.target,start:L,count:q}));L+=q*g}else t._normalizeValue(X,p,L),L+=g}}_validateAttributeUpdaters(){let{settings:t}=this;if(!(t.noAlloc||typeof t.update=="function"))throw new Error(`Attribute ${this.id} missing update or accessor`)}_checkAttributeArray(){let{value:t}=this,r=Math.min(4,this.size);if(t&&t.length>=r){let i=!0;switch(r){case 4:i=i&&Number.isFinite(t[3]);case 3:i=i&&Number.isFinite(t[2]);case 2:i=i&&Number.isFinite(t[1]);case 1:i=i&&Number.isFinite(t[0]);break;default:i=!1}if(!i)throw new Error(`Illegal attribute generated for ${this.id}`)}}};function HD(e){let{source:t,target:r,start:i=0,size:s,getData:n}=e,o=e.end||r.length,a=t.length,h=o-i;if(a>h){r.set(t.subarray(0,h),i);return}if(r.set(t,i),!n)return;let p=a;for(;p<h;){let g=n(p,t);for(let v=0;v<s;v++)r[i+p]=g[v]||0,p++}}function wq({source:e,target:t,size:r,getData:i,sourceStartIndices:s,targetStartIndices:n}){if(!s||!n)return HD({source:e,target:t,size:r,getData:i}),t;let o=0,a=0,h=i&&((g,v)=>i(g+a,v)),p=Math.min(s.length,n.length);for(let g=1;g<p;g++){let v=s[g]*r,T=n[g]*r;HD({source:e.subarray(o,v),target:t,start:a,end:T,size:r,getData:h}),o=v,a=T}return a<t.length&&HD({source:[],target:t,start:a,size:r,getData:h}),t}function Tq(e){let{device:t,settings:r,value:i}=e,s=new n1(t,r);return s.setData({value:i instanceof Float64Array?new Float64Array(0):new Float32Array(0),normalized:r.normalized}),s}function DE(e){switch(e){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error(`No defined attribute type for size "${e}"`)}}function OE(e){switch(e){case 1:return"float32";case 2:return"float32x2";case 3:return"float32x3";case 4:return"float32x4";default:throw new Error("invalid type size")}}function BE(e){e.push(e.shift())}function Sq(e,t){let{doublePrecision:r,settings:i,value:s,size:n}=e,o=r&&s instanceof Float64Array?2:1,a=0,{shaderAttributes:h}=e.settings;if(h)for(let p of Object.values(h))a=Math.max(a,p.vertexOffset??0);return(i.noAlloc?s.length:(t+a)*n)*o}function NE({device:e,source:t,target:r}){return(!r||r.byteLength<t.byteLength)&&(r?.destroy(),r=e.createBuffer({byteLength:t.byteLength,usage:t.usage})),r}function LE({device:e,buffer:t,attribute:r,fromLength:i,toLength:s,fromStartIndices:n,getData:o=a=>a}){let a=r.doublePrecision&&r.value instanceof Float64Array?2:1,h=r.size*a,p=r.byteOffset,g=r.settings.bytesPerElement<4?p/r.settings.bytesPerElement*4:p,v=r.startIndices,T=n&&v,C=r.isConstant;if(!T&&t&&i>=s)return t;let B=r.value instanceof Float64Array?Float32Array:r.value.constructor,L=C?r.value:new B(r.getBuffer().readSyncWebGL(p,s*B.BYTES_PER_ELEMENT).buffer);if(r.settings.normalized&&!C){let X=o;o=(q,it)=>r.normalizeConstant(X(q,it))}let z=C?(X,q)=>o(L,q):(X,q)=>o(L.subarray(X+p,X+p+h),q),W=t?new Float32Array(t.readSyncWebGL(g,i*4).buffer):new Float32Array(0),Z=new Float32Array(s);return wq({source:W,target:Z,sourceStartIndices:n,targetStartIndices:v,size:h,getData:z}),(!t||t.byteLength<Z.byteLength+g)&&(t?.destroy(),t=e.createBuffer({byteLength:Z.byteLength+g,usage:35050})),t.write(Z,g),t}var i2=class{constructor({device:t,attribute:r,timeline:i}){this.buffers=[],this.currentLength=0,this.device=t,this.transition=new Kh(i),this.attribute=r,this.attributeInTransition=Tq(r),this.currentStartIndices=r.startIndices}get inProgress(){return this.transition.inProgress}start(t,r,i=1/0){this.settings=t,this.currentStartIndices=this.attribute.startIndices,this.currentLength=Sq(this.attribute,r),this.transition.start({...t,duration:i})}update(){let t=this.transition.update();return t&&this.onUpdate(),t}setBuffer(t){this.attributeInTransition.setData({buffer:t,normalized:this.attribute.settings.normalized,value:this.attributeInTransition.value})}cancel(){this.transition.cancel()}delete(){this.cancel();for(let t of this.buffers)t.destroy();this.buffers.length=0}};var Pw=class extends i2{constructor({device:t,attribute:r,timeline:i}){super({device:t,attribute:r,timeline:i}),this.type="interpolation",this.transform=zyt(t,r)}start(t,r){let i=this.currentLength,s=this.currentStartIndices;if(super.start(t,r,t.duration),t.duration<=0){this.transition.cancel();return}let{buffers:n,attribute:o}=this;BE(n),n[0]=LE({device:this.device,buffer:n[0],attribute:o,fromLength:i,toLength:this.currentLength,fromStartIndices:s,getData:t.enter}),n[1]=NE({device:this.device,source:n[0],target:n[1]}),this.setBuffer(n[1]);let{transform:a}=this,h=a.model,p=Math.floor(this.currentLength/o.size);Eq(o)&&(p/=2),h.setVertexCount(p),o.isConstant?(h.setAttributes({aFrom:n[0]}),h.setConstantAttributes({aTo:o.value})):h.setAttributes({aFrom:n[0],aTo:o.getBuffer()}),a.transformFeedback.setBuffers({vCurrent:n[1]})}onUpdate(){let{duration:t,easing:r}=this.settings,{time:i}=this.transition,s=i/t;r&&(s=r(s));let{model:n}=this.transform;n.setUniforms({time:s}),n.device.gl.bindBuffer(34962,null),this.transform.run({discard:!0})}delete(){super.delete(),this.transform.destroy()}},Lyt=`#version 300 es
#define SHADER_NAME interpolation-transition-vertex-shader

uniform float time;
in ATTRIBUTE_TYPE aFrom;
in ATTRIBUTE_TYPE aTo;
out ATTRIBUTE_TYPE vCurrent;

void main(void) {
  vCurrent = mix(aFrom, aTo, time);
  gl_Position = vec4(0.0);
}
`,Fyt=`#version 300 es
#define SHADER_NAME interpolation-transition-vertex-shader

uniform float time;
in ATTRIBUTE_TYPE aFrom;
in ATTRIBUTE_TYPE aFrom64Low;
in ATTRIBUTE_TYPE aTo;
in ATTRIBUTE_TYPE aTo64Low;
out ATTRIBUTE_TYPE vCurrent;
out ATTRIBUTE_TYPE vCurrent64Low;

vec2 mix_fp64(vec2 a, vec2 b, float x) {
  vec2 range = sub_fp64(b, a);
  return sum_fp64(a, mul_fp64(range, vec2(x, 0.0)));
}

void main(void) {
  for (int i=0; i<ATTRIBUTE_SIZE; i++) {
    vec2 value = mix_fp64(vec2(aFrom[i], aFrom64Low[i]), vec2(aTo[i], aTo64Low[i]), time);
    vCurrent[i] = value.x;
    vCurrent64Low[i] = value.y;
  }
  gl_Position = vec4(0.0);
}
`;function Eq(e){return e.doublePrecision&&e.value instanceof Float64Array}function zyt(e,t){let r=t.size,i=DE(r),s=OE(r),n=t.getBufferLayout();return Eq(t)?new Om(e,{vs:Fyt,bufferLayout:[{name:"aFrom",byteStride:8*r,attributes:[{attribute:"aFrom",format:s,byteOffset:0},{attribute:"aFrom64Low",format:s,byteOffset:4*r}]},{name:"aTo",byteStride:8*r,attributes:[{attribute:"aTo",format:s,byteOffset:0},{attribute:"aTo64Low",format:s,byteOffset:4*r}]}],modules:[A7],defines:{ATTRIBUTE_TYPE:i,ATTRIBUTE_SIZE:r},moduleSettings:{},varyings:["vCurrent","vCurrent64Low"],bufferMode:35980,disableWarnings:!0}):new Om(e,{vs:Lyt,bufferLayout:[{name:"aFrom",format:s},{name:"aTo",format:n.attributes[0].format}],defines:{ATTRIBUTE_TYPE:i},varyings:["vCurrent"],disableWarnings:!0})}var Rw=class extends i2{constructor({device:t,attribute:r,timeline:i}){super({device:t,attribute:r,timeline:i}),this.type="spring",this.texture=Wyt(t),this.framebuffer=$yt(t,this.texture),this.transform=jyt(t,r)}start(t,r){let i=this.currentLength,s=this.currentStartIndices;super.start(t,r);let{buffers:n,attribute:o}=this;for(let h=0;h<2;h++)n[h]=LE({device:this.device,buffer:n[h],attribute:o,fromLength:i,toLength:this.currentLength,fromStartIndices:s,getData:t.enter});n[2]=NE({device:this.device,source:n[0],target:n[2]}),this.setBuffer(n[1]);let{model:a}=this.transform;a.setVertexCount(Math.floor(this.currentLength/o.size)),o.isConstant?a.setConstantAttributes({aTo:o.value}):a.setAttributes({aTo:o.getBuffer()})}onUpdate(){let{buffers:t,transform:r,framebuffer:i,transition:s}=this,n=this.settings;r.model.setAttributes({aPrev:t[0],aCur:t[1]}),r.transformFeedback.setBuffers({vNext:t[2]}),r.model.setUniforms({stiffness:n.stiffness,damping:n.damping}),r.run({framebuffer:i,discard:!1,parameters:{viewport:[0,0,1,1]},clearColor:[0,0,0,0]}),BE(t),this.setBuffer(t[1]),this.device.readPixelsToArrayWebGL(i)[0]>0||s.end()}delete(){super.delete(),this.transform.destroy(),this.texture.destroy(),this.framebuffer.destroy()}},Uyt=`#version 300 es
#define SHADER_NAME spring-transition-vertex-shader

#define EPSILON 0.00001

uniform float stiffness;
uniform float damping;
in ATTRIBUTE_TYPE aPrev;
in ATTRIBUTE_TYPE aCur;
in ATTRIBUTE_TYPE aTo;
out ATTRIBUTE_TYPE vNext;
out float vIsTransitioningFlag;

ATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {
  ATTRIBUTE_TYPE velocity = cur - prev;
  ATTRIBUTE_TYPE delta = dest - cur;
  ATTRIBUTE_TYPE spring = delta * stiffness;
  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;
  return spring + damper + velocity + cur;
}

void main(void) {
  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;
  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;

  vNext = getNextValue(aCur, aPrev, aTo);
  gl_Position = vec4(0, 0, 0, 1);
  gl_PointSize = 100.0;
}
`,Vyt=`#version 300 es
#define SHADER_NAME spring-transition-is-transitioning-fragment-shader

in float vIsTransitioningFlag;

out vec4 fragColor;

void main(void) {
  if (vIsTransitioningFlag == 0.0) {
    discard;
  }
  fragColor = vec4(1.0);
}`;function jyt(e,t){let r=DE(t.size),i=OE(t.size);return new Om(e,{vs:Uyt,fs:Vyt,bufferLayout:[{name:"aPrev",format:i},{name:"aCur",format:i},{name:"aTo",format:t.getBufferLayout().attributes[0].format}],varyings:["vNext"],defines:{ATTRIBUTE_TYPE:r},parameters:{depthCompare:"always",blendColorOperation:"max",blendColorSrcFactor:"one",blendColorDstFactor:"one",blendAlphaOperation:"max",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one"}})}function Wyt(e){return e.createTexture({data:new Uint8Array(4),format:"rgba8unorm",mipmaps:!1,width:1,height:1})}function $yt(e,t){return e.createFramebuffer({id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,colorAttachments:[t]})}var Hyt={interpolation:Pw,spring:Rw},kw=class{constructor(t,{id:r,timeline:i}){if(!t)throw new Error("AttributeTransitionManager is constructed without device");this.id=r,this.device=t,this.timeline=i,this.transitions={},this.needsRedraw=!1,this.numInstances=1}finalize(){for(let t in this.transitions)this._removeTransition(t)}update({attributes:t,transitions:r,numInstances:i}){this.numInstances=i||1;for(let s in t){let n=t[s],o=n.getTransitionSetting(r);o&&this._updateAttribute(s,n,o)}for(let s in this.transitions){let n=t[s];(!n||!n.getTransitionSetting(r))&&this._removeTransition(s)}}hasAttribute(t){let r=this.transitions[t];return r&&r.inProgress}getAttributes(){let t={};for(let r in this.transitions){let i=this.transitions[r];i.inProgress&&(t[r]=i.attributeInTransition)}return t}run(){if(this.numInstances===0)return!1;for(let r in this.transitions)this.transitions[r].update()&&(this.needsRedraw=!0);let t=this.needsRedraw;return this.needsRedraw=!1,t}_removeTransition(t){this.transitions[t].delete(),delete this.transitions[t]}_updateAttribute(t,r,i){let s=this.transitions[t],n=!s||s.type!==i.type;if(n){s&&this._removeTransition(t);let o=Hyt[i.type];o?this.transitions[t]=new o({attribute:r,timeline:this.timeline,device:this.device}):(Ir.error(`unsupported transition type '${i.type}'`)(),n=!1)}(n||r.needsRedraw())&&(this.needsRedraw=!0,this.transitions[t].start(i,this.numInstances))}};var Iq="attributeManager.invalidate",qyt="attributeManager.updateStart",Yyt="attributeManager.updateEnd",Xyt="attribute.updateStart",Zyt="attribute.allocate",Gyt="attribute.updateEnd",Dw=class{constructor(t,{id:r="attribute-manager",stats:i,timeline:s}={}){this.mergeBoundsMemoized=np(z$),this.id=r,this.device=t,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=i,this.attributeTransitionManager=new kw(t,{id:`${r}-transitions`,timeline:s}),Object.seal(this)}finalize(){for(let t in this.attributes)this.attributes[t].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(t={clearRedrawFlags:!1}){let r=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!t.clearRedrawFlags,r&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(t){this._add(t)}addInstanced(t){this._add(t,{stepMode:"instance"})}remove(t){for(let r of t)this.attributes[r]!==void 0&&(this.attributes[r].delete(),delete this.attributes[r])}invalidate(t,r){let i=this._invalidateTrigger(t,r);ho(Iq,this,t,i)}invalidateAll(t){for(let r in this.attributes)this.attributes[r].setNeedsUpdate(r,t);ho(Iq,this,"all")}update({data:t,numInstances:r,startIndices:i=null,transitions:s,props:n={},buffers:o={},context:a={}}){let h=!1;ho(qyt,this),this.stats&&this.stats.get("Update Attributes").timeStart();for(let p in this.attributes){let g=this.attributes[p],v=g.settings.accessor;g.startIndices=i,g.numInstances=r,n[p]&&Ir.removed(`props.${p}`,`data.attributes.${p}`)(),g.setExternalBuffer(o[p])||g.setBinaryValue(typeof v=="string"?o[v]:void 0,t.startIndices)||typeof v=="string"&&!o[v]&&g.setConstantValue(n[v])||g.needsUpdate()&&(h=!0,this._updateAttribute({attribute:g,numInstances:r,data:t,props:n,context:a})),this.needsRedraw=this.needsRedraw||g.needsRedraw()}h&&ho(Yyt,this,r),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:r,transitions:s})}updateTransition(){let{attributeTransitionManager:t}=this,r=t.run();return this.needsRedraw=this.needsRedraw||r,r}getAttributes(){return{...this.attributes,...this.attributeTransitionManager.getAttributes()}}getBounds(t){let r=t.map(i=>this.attributes[i]?.getBounds());return this.mergeBoundsMemoized(r)}getChangedAttributes(t={clearChangedFlags:!1}){let{attributes:r,attributeTransitionManager:i}=this,s={...i.getAttributes()};for(let n in r){let o=r[n];o.needsRedraw(t)&&!i.hasAttribute(n)&&(s[n]=o)}return s}getBufferLayouts(t){return Object.values(this.getAttributes()).map(r=>r.getBufferLayout(t))}_add(t,r){for(let i in t){let s=t[i],n={...s,id:i,size:s.isIndexed&&1||s.size||1,...r};this.attributes[i]=new n1(this.device,n)}this._mapUpdateTriggersToAttributes()}_mapUpdateTriggersToAttributes(){let t={};for(let r in this.attributes)this.attributes[r].getUpdateTriggers().forEach(s=>{t[s]||(t[s]=[]),t[s].push(r)});this.updateTriggers=t}_invalidateTrigger(t,r){let{attributes:i,updateTriggers:s}=this,n=s[t];return n&&n.forEach(o=>{let a=i[o];a&&a.setNeedsUpdate(a.id,r)}),n}_updateAttribute(t){let{attribute:r,numInstances:i}=t;if(ho(Xyt,r),r.constant){r.setConstantValue(r.value);return}r.allocate(i)&&ho(Zyt,r,i),r.updateBuffer(t)&&(this.needsRedraw=!0,ho(Gyt,r,i))}};var Ow=class extends Kh{get value(){return this._value}_onUpdate(){let{time:t,settings:{fromValue:r,toValue:i,duration:s,easing:n}}=this,o=n(t/s);this._value=yc(r,i,o)}};var Mq=1e-5;function Cq(e,t,r,i,s){let n=t-e,a=(r-t)*s,h=-n*i;return a+h+n+t}function Qyt(e,t,r,i,s){if(Array.isArray(r)){let n=[];for(let o=0;o<r.length;o++)n[o]=Cq(e[o],t[o],r[o],i,s);return n}return Cq(e,t,r,i,s)}function Pq(e,t){if(Array.isArray(e)){let r=0;for(let i=0;i<e.length;i++){let s=e[i]-t[i];r+=s*s}return Math.sqrt(r)}return Math.abs(e-t)}var Bw=class extends Kh{get value(){return this._currValue}_onUpdate(){let{fromValue:t,toValue:r,damping:i,stiffness:s}=this.settings,{_prevValue:n=t,_currValue:o=t}=this,a=Qyt(n,o,r,i,s),h=Pq(a,r),p=Pq(a,o);h<Mq&&p<Mq&&(a=r,this.end()),this._prevValue=o,this._currValue=a}};var Kyt={interpolation:Ow,spring:Bw},Nw=class{constructor(t){this.transitions=new Map,this.timeline=t}get active(){return this.transitions.size>0}add(t,r,i,s){let{transitions:n}=this;if(n.has(t)){let h=n.get(t),{value:p=h.settings.fromValue}=h;r=p,this.remove(t)}if(s=kE(s),!s)return;let o=Kyt[s.type];if(!o){Ir.error(`unsupported transition type '${s.type}'`)();return}let a=new o(this.timeline);a.start({...s,fromValue:r,toValue:i}),n.set(t,a)}remove(t){let{transitions:r}=this;r.has(t)&&(r.get(t).cancel(),r.delete(t))}update(){let t={};for(let[r,i]of this.transitions)i.update(),t[r]=i.value,i.inProgress||this.remove(r);return t}clear(){for(let t of this.transitions.keys())this.remove(t)}};function kq(e){let t=e[Qu];for(let r in t){let i=t[r],{validate:s}=i;if(s&&!s(e[r],i))throw new Error(`Invalid prop ${r}: ${e[r]}`)}}function Dq(e,t){let r=Oq({newProps:e,oldProps:t,propTypes:e[Qu],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),i=t2t(e,t),s=!1;return i||(s=e2t(e,t)),{dataChanged:i,propsChanged:r,updateTriggersChanged:s,extensionsChanged:r2t(e,t),transitionsChanged:Jyt(e,t)}}function Jyt(e,t){if(!e.transitions)return!1;let r={},i=e[Qu],s=!1;for(let n in e.transitions){let o=i[n],a=o&&o.type;(a==="number"||a==="color"||a==="array")&&qD(e[n],t[n],o)&&(r[n]=!0,s=!0)}return s?r:!1}function Oq({newProps:e,oldProps:t,ignoreProps:r={},propTypes:i={},triggerName:s="props"}){if(t===e)return!1;if(typeof e!="object"||e===null)return`${s} changed shallowly`;if(typeof t!="object"||t===null)return`${s} changed shallowly`;for(let n of Object.keys(e))if(!(n in r)){if(!(n in t))return`${s}.${n} added`;let o=qD(e[n],t[n],i[n]);if(o)return`${s}.${n} ${o}`}for(let n of Object.keys(t))if(!(n in r)){if(!(n in e))return`${s}.${n} dropped`;if(!Object.hasOwnProperty.call(e,n)){let o=qD(e[n],t[n],i[n]);if(o)return`${s}.${n} ${o}`}}return!1}function qD(e,t,r){let i=r&&r.equal;return i&&!i(e,t,r)||!i&&(i=e&&t&&e.equals,i&&!i.call(e,t))?"changed deeply":!i&&t!==e?"changed shallowly":null}function t2t(e,t){if(t===null)return"oldProps is null, initial diff";let r=!1,{dataComparator:i,_dataDiff:s}=e;return i?i(e.data,t.data)||(r="Data comparator detected a change"):e.data!==t.data&&(r="A new data container was supplied"),r&&s&&(r=s(e.data,t.data)||r),r}function e2t(e,t){if(t===null)return{all:!0};if("all"in e.updateTriggers&&Rq(e,t,"all"))return{all:!0};let r={},i=!1;for(let s in e.updateTriggers)s!=="all"&&Rq(e,t,s)&&(r[s]=!0,i=!0);return i?r:!1}function r2t(e,t){if(t===null)return!0;let r=t.extensions,{extensions:i}=e;if(i===r)return!1;if(!r||!i||i.length!==r.length)return!0;for(let s=0;s<i.length;s++)if(!i[s].equals(r[s]))return!0;return!1}function Rq(e,t,r){let i=e.updateTriggers[r];i=i??{};let s=t.updateTriggers[r];return s=s??{},Oq({oldProps:s,newProps:i,triggerName:r})}var i2t="count(): argument not an object",n2t="count(): argument not a container";function Bq(e){if(!o2t(e))throw new Error(i2t);if(typeof e.count=="function")return e.count();if(Number.isFinite(e.size))return e.size;if(Number.isFinite(e.length))return e.length;if(s2t(e))return Object.keys(e).length;throw new Error(n2t)}function s2t(e){return e!==null&&typeof e=="object"&&e.constructor===Object}function o2t(e){return e!==null&&typeof e=="object"}function YD(e,t){if(!t)return e;let r={...e,...t};if("defines"in t&&(r.defines={...e.defines,...t.defines}),"modules"in t&&(r.modules=(e.modules||[]).concat(t.modules),t.modules.some(i=>i.name==="project64"))){let i=r.modules.findIndex(s=>s.name==="project32");i>=0&&r.modules.splice(i,1)}if("inject"in t)if(!e.inject)r.inject=t.inject;else{let i={...e.inject};for(let s in t.inject)i[s]=(i[s]||"")+t.inject[s];r.inject=i}return r}var a2t={minFilter:"linear",mipmapFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},XD={};function Nq(e,t,r,i){if(r instanceof jo)return r;r.constructor&&r.constructor.name!=="Object"&&(r={data:r});let s=null;r.compressed&&(s={minFilter:"linear",mipmapFilter:r.data.length>1?"nearest":"linear"});let n=t.createTexture({...r,sampler:{...a2t,...s,...i}});return XD[n.id]=e,n}function Lq(e,t){!t||!(t instanceof jo)||XD[t.id]===e&&(t.delete(),delete XD[t.id])}var l2t={boolean:{validate(e,t){return!0},equal(e,t,r){return!!e==!!t}},number:{validate(e,t){return Number.isFinite(e)&&(!("max"in t)||e<=t.max)&&(!("min"in t)||e>=t.min)}},color:{validate(e,t){return t.optional&&!e||ZD(e)&&(e.length===3||e.length===4)},equal(e,t,r){return ja(e,t,1)}},accessor:{validate(e,t){let r=FE(e);return r==="function"||r===FE(t.value)},equal(e,t,r){return typeof t=="function"?!0:ja(e,t,1)}},array:{validate(e,t){return t.optional&&!e||ZD(e)},equal(e,t,r){let{compare:i}=r,s=Number.isInteger(i)?i:i?1:0;return i?ja(e,t,s):e===t}},object:{equal(e,t,r){if(r.ignore)return!0;let{compare:i}=r,s=Number.isInteger(i)?i:i?1:0;return i?ja(e,t,s):e===t}},function:{validate(e,t){return t.optional&&!e||typeof e=="function"},equal(e,t,r){return!r.compare&&r.ignore!==!1||e===t}},data:{transform:(e,t,r)=>{if(!e)return e;let{dataTransform:i}=r.props;return i?i(e):typeof e.shape=="string"&&e.shape.endsWith("-table")&&Array.isArray(e.data)?e.data:e}},image:{transform:(e,t,r)=>{let i=r.context;return!i||!i.device?null:Nq(r.id,i.device,e,{...t.parameters,...r.props.textureParameters})},release:(e,t,r)=>{Lq(r.id,e)}}};function Fq(e){let t={},r={},i={};for(let[s,n]of Object.entries(e)){let o=n?.deprecatedFor;if(o)i[s]=Array.isArray(o)?o:[o];else{let a=c2t(s,n);t[s]=a,r[s]=a.value}}return{propTypes:t,defaultProps:r,deprecatedProps:i}}function c2t(e,t){switch(FE(t)){case"object":return Lw(e,t);case"array":return Lw(e,{type:"array",value:t,compare:!1});case"boolean":return Lw(e,{type:"boolean",value:t});case"number":return Lw(e,{type:"number",value:t});case"function":return Lw(e,{type:"function",value:t,compare:!0});default:return{name:e,type:"unknown",value:t}}}function Lw(e,t){return"type"in t?{name:e,...l2t[t.type],...t}:"value"in t?{name:e,type:FE(t.value),...t}:{name:e,type:"object",value:t}}function ZD(e){return Array.isArray(e)||ArrayBuffer.isView(e)}function FE(e){return ZD(e)?"array":e===null?"null":typeof e}function zq(e,t){let r;for(let n=t.length-1;n>=0;n--){let o=t[n];"extensions"in o&&(r=o.extensions)}let i=GD(e.constructor,r),s=Object.create(i);s[Gy]=e,s[sp]={},s[Qh]={};for(let n=0;n<t.length;++n){let o=t[n];for(let a in o)s[a]=o[a]}return Object.freeze(s),s}var u2t="_mergedDefaultProps";function GD(e,t){let r=u2t;if(t)for(let s of t){let n=s.constructor;n&&(r+=`:${n.extensionName||n.name}`)}let i=Uq(e,r);return i||(e[r]=h2t(e,t||[]))}function h2t(e,t){if(!e.prototype)return null;let i=Object.getPrototypeOf(e),s=GD(i),n=Uq(e,"defaultProps")||{},o=Fq(n),a=Object.assign(Object.create(null),s,o.defaultProps),h=Object.assign(Object.create(null),s?.[Qu],o.propTypes),p=Object.assign(Object.create(null),s?.[iE],o.deprecatedProps);for(let g of t){let v=GD(g.constructor);v&&(Object.assign(a,v),Object.assign(h,v[Qu]),Object.assign(p,v[iE]))}return f2t(a,e),d2t(a,h),p2t(a,p),a[Qu]=h,a[iE]=p,t.length===0&&!QD(e,"_propTypes")&&(e._propTypes=h),a}function f2t(e,t){let r=A2t(t);Object.defineProperties(e,{id:{writable:!0,value:r}})}function p2t(e,t){for(let r in t)Object.defineProperty(e,r,{enumerable:!1,set(i){let s=`${this.id}: ${r}`;for(let n of t[r])QD(this,n)||(this[n]=i);Ir.deprecated(s,t[r].join("/"))()}})}function d2t(e,t){let r={},i={};for(let s in t){let n=t[s],{name:o,value:a}=n;n.async&&(r[o]=a,i[o]=m2t(o))}e[Nd]=r,e[sp]={},Object.defineProperties(e,i)}function m2t(e){return{enumerable:!0,set(t){typeof t=="string"||t instanceof Promise||PE(t)?this[sp][e]=t:this[Qh][e]=t},get(){if(this[Qh]){if(e in this[Qh])return this[Qh][e]||this[Nd][e];if(e in this[sp]){let t=this[Gy]&&this[Gy].internalState;if(t&&t.hasAsyncProp(e))return t.getAsyncProp(e)||this[Nd][e]}}return this[Nd][e]}}}function QD(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Uq(e,t){return QD(e,t)&&e[t]}function A2t(e){let t=e.componentName;return t||Ir.warn(`${e.name}.componentName not specified`)(),t||e.name}var g2t=0,Fw=class{static{this.componentName="Component"}static{this.defaultProps={}}constructor(...t){this.props=zq(this,t),this.id=this.props.id,this.count=g2t++}clone(t){let{props:r}=this,i={};for(let s in r[Nd])s in r[Qh]?i[s]=r[Qh][s]:s in r[sp]&&(i[s]=r[sp][s]);return new this.constructor({...r,...i,...t})}};var _2t=Object.freeze({}),zw=class{constructor(t){this.component=t,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(let t in this.asyncProps){let r=this.asyncProps[t];r&&r.type&&r.type.release&&r.type.release(r.resolvedValue,r.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||_2t}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp(t){return t in this.asyncProps}getAsyncProp(t){let r=this.asyncProps[t];return r&&r.resolvedValue}isAsyncPropLoading(t){if(t){let r=this.asyncProps[t];return!!(r&&r.pendingLoadCount>0&&r.pendingLoadCount!==r.resolvedLoadCount)}for(let r in this.asyncProps)if(this.isAsyncPropLoading(r))return!0;return!1}reloadAsyncProp(t,r){this._watchPromise(t,Promise.resolve(r))}setAsyncProps(t){this.component=t[Gy]||this.component;let r=t[Qh]||{},i=t[sp]||t,s=t[Nd]||{};for(let n in r){let o=r[n];this._createAsyncPropData(n,s[n]),this._updateAsyncProp(n,o),r[n]=this.getAsyncProp(n)}for(let n in i){let o=i[n];this._createAsyncPropData(n,s[n]),this._updateAsyncProp(n,o)}}_fetch(t,r){return null}_onResolve(t,r){}_onError(t,r){}_updateAsyncProp(t,r){if(this._didAsyncInputValueChange(t,r)){if(typeof r=="string"&&(r=this._fetch(t,r)),r instanceof Promise){this._watchPromise(t,r);return}if(PE(r)){this._resolveAsyncIterable(t,r);return}this._setPropValue(t,r)}}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(let t in this.asyncProps)Object.defineProperty(this.oldAsyncProps,t,{enumerable:!0,value:this.oldProps[t]})}}_didAsyncInputValueChange(t,r){let i=this.asyncProps[t];return r===i.resolvedValue||r===i.lastValue?!1:(i.lastValue=r,!0)}_setPropValue(t,r){this._freezeAsyncOldProps();let i=this.asyncProps[t];i&&(r=this._postProcessValue(i,r),i.resolvedValue=r,i.pendingLoadCount++,i.resolvedLoadCount=i.pendingLoadCount)}_setAsyncPropValue(t,r,i){let s=this.asyncProps[t];s&&i>=s.resolvedLoadCount&&r!==void 0&&(this._freezeAsyncOldProps(),s.resolvedValue=r,s.resolvedLoadCount=i,this.onAsyncPropUpdated(t,r))}_watchPromise(t,r){let i=this.asyncProps[t];if(i){i.pendingLoadCount++;let s=i.pendingLoadCount;r.then(n=>{this.component&&(n=this._postProcessValue(i,n),this._setAsyncPropValue(t,n,s),this._onResolve(t,n))}).catch(n=>{this._onError(t,n)})}}async _resolveAsyncIterable(t,r){if(t!=="data"){this._setPropValue(t,r);return}let i=this.asyncProps[t];if(!i)return;i.pendingLoadCount++;let s=i.pendingLoadCount,n=[],o=0;for await(let a of r){if(!this.component)return;let{dataTransform:h}=this.component.props;h?n=h(a,n):n=n.concat(a),Object.defineProperty(n,"__diff",{enumerable:!1,value:[{startRow:o,endRow:n.length}]}),o=n.length,this._setAsyncPropValue(t,n,s)}this._onResolve(t,n)}_postProcessValue(t,r){let i=t.type;return i&&this.component&&(i.release&&i.release(t.resolvedValue,i,this.component),i.transform)?i.transform(r,i,this.component):r}_createAsyncPropData(t,r){if(!this.asyncProps[t]){let s=this.component&&this.component.props[Qu];this.asyncProps[t]={type:s&&s[t],lastValue:null,resolvedValue:r,pendingLoadCount:0,resolvedLoadCount:0}}}};var Uw=class extends zw{constructor({attributeManager:t,layer:r}){super(r),this.attributeManager=t,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch(t,r){let i=this.layer,s=i?.props.fetch;return s?s(r,{propName:t,layer:i}):super._fetch(t,r)}_onResolve(t,r){let i=this.layer;if(i){let s=i.props.onDataLoad;t==="data"&&s&&s(r,{propName:t,layer:i})}}_onError(t,r){let i=this.layer;i&&i.raiseError(r,`loading ${t} of ${this.layer}`)}};var y2t="layer.changeFlag",x2t="layer.initialize",b2t="layer.update",v2t="layer.finalize",w2t="layer.matched",Vq=2**24-1,T2t=Object.freeze([]),S2t=np(({oldViewport:e,viewport:t})=>e.equals(t)),up=new Uint8ClampedArray(0),E2t={data:{type:"data",value:T2t,async:!0},dataComparator:{type:"function",value:null,optional:!0},_dataDiff:{type:"function",value:e=>e&&e.__diff,optional:!0},dataTransform:{type:"function",value:null,optional:!0},onDataLoad:{type:"function",value:null,optional:!0},onError:{type:"function",value:null,optional:!0},fetch:{type:"function",value:(e,{propName:t,layer:r,loaders:i,loadOptions:s,signal:n})=>{let{resourceManager:o}=r.context;s=s||r.getLoadOptions(),i=i||r.props.loaders,n&&(s={...s,fetch:{...s?.fetch,signal:n}});let a=o.contains(e);return!a&&!s&&(o.add({resourceId:e,data:Tm(e,i),persistent:!1}),a=!0),a?o.subscribe({resourceId:e,onChange:h=>r.internalState?.reloadAsyncProp(t,h),consumerId:r.id,requestId:t}):Tm(e,i,s)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,optional:!0},onClick:{type:"function",value:null,optional:!0},onDragStart:{type:"function",value:null,optional:!0},onDrag:{type:"function",value:null,optional:!0},onDragEnd:{type:"function",value:null,optional:!0},coordinateSystem:qi.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:2},loadOptions:{type:"object",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:"function",value:({layerIndex:e})=>[0,-e*100]},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}},$o=class extends Fw{constructor(){super(...arguments),this.internalState=null,this.lifecycle=Bm.NO_STATE,this.parent=null}static{this.defaultProps=E2t}static{this.layerName="Layer"}static get componentName(){return Object.prototype.hasOwnProperty.call(this,"layerName")?this.layerName:""}get root(){let t=this;for(;t.parent;)t=t.parent;return t}toString(){return`${this.constructor.layerName||this.constructor.name}({id: '${this.props.id}'})`}project(t){Jn(this.internalState);let r=this.internalState.viewport||this.context.viewport,i=gD(t,{viewport:r,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[s,n,o]=Hy(i,r.pixelProjectionMatrix);return t.length===2?[s,n]:[s,n,o]}unproject(t){return Jn(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(t)}projectPosition(t,r){Jn(this.internalState);let i=this.internalState.viewport||this.context.viewport;return j$(t,{viewport:i,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...r})}get isComposite(){return!1}setState(t){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,t),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return this.internalState?!this.internalState.isAsyncPropLoading():!1}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){let t=this.state;return t&&(t.models||t.model&&[t.model])||[]}setModuleParameters(t){for(let r of this.getModels())r.updateModuleSettings(t)}setShaderModuleProps(...t){for(let r of this.getModels())r.shaderInputs.setProps(...t)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){let{coordinateSystem:t}=this.props;return t===qi.DEFAULT||t===qi.LNGLAT||t===qi.CARTESIAN}onHover(t,r){return this.props.onHover&&this.props.onHover(t,r)||!1}onClick(t,r){return this.props.onClick&&this.props.onClick(t,r)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(t,r=[]){return r[0]=t+1&255,r[1]=t+1>>8&255,r[2]=t+1>>8>>8&255,r}decodePickingColor(t){Jn(t instanceof Uint8Array);let[r,i,s]=t;return r+i*256+s*65536-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&this.state.numInstances!==void 0?this.state.numInstances:Bq(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){return this.getAttributeManager()?.getBounds(["positions","instancePositions"])}getShaders(t){t=YD(t,{disableWarnings:!0,modules:this.context.defaultShaderModules});for(let r of this.props.extensions)t=YD(t,r.getShaders.call(this,r));return t}shouldUpdateState(t){return t.changeFlags.propsOrDataChanged}updateState(t){let r=this.getAttributeManager(),{dataChanged:i}=t.changeFlags;if(i&&r)if(Array.isArray(i))for(let s of i)r.invalidateAll(s);else r.invalidateAll();if(r){let{props:s}=t,n=this.internalState.hasPickingBuffer,o=Number.isInteger(s.highlightedObjectIndex)||s.pickable||s.extensions.some(a=>a.getNeedsPickingBuffer.call(this,a));if(n!==o){this.internalState.hasPickingBuffer=o;let{pickingColors:a,instancePickingColors:h}=r.attributes,p=a||h;p&&(o&&p.constant&&(p.constant=!1,r.invalidate(p.id)),!p.value&&!o&&(p.constant=!0,p.value=[0,0,0]))}}}finalizeState(t){for(let i of this.getModels())i.destroy();let r=this.getAttributeManager();r&&r.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(t){for(let r of this.getModels())r.draw(t)}getPickingInfo({info:t,mode:r,sourceLayer:i}){let{index:s}=t;return s>=0&&Array.isArray(this.props.data)&&(t.object=this.props.data[s]),t}raiseError(t,r){r&&(t=new Error(`${r}: ${t.message}`,{cause:t})),this.props.onError?.(t)||this.context?.onError?.(t,this)}getNeedsRedraw(t={clearRedrawFlags:!1}){return this._getNeedsRedraw(t)}needsUpdate(){return this.internalState?this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()):!1}hasUniformTransition(){return this.internalState?.uniformTransitions.active||!1}activateViewport(t){if(!this.internalState)return;let r=this.internalState.viewport;this.internalState.viewport=t,(!r||!S2t({oldViewport:r,viewport:t}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(t="all"){let r=this.getAttributeManager();r&&(t==="all"?r.invalidateAll():r.invalidate(t))}updateAttributes(t){let r=!1;for(let i in t)t[i].layoutChanged()&&(r=!0);for(let i of this.getModels())this._setModelAttributes(i,t,r)}_updateAttributes(){let t=this.getAttributeManager();if(!t)return;let r=this.props,i=this.getNumInstances(),s=this.getStartIndices();t.update({data:r.data,numInstances:i,startIndices:s,props:r,transitions:r.transitions,buffers:r.data.attributes,context:this});let n=t.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(n)}_updateAttributeTransition(){let t=this.getAttributeManager();t&&t.updateTransition()}_updateUniformTransition(){let{uniformTransitions:t}=this.internalState;if(t.active){let r=t.update(),i=Object.create(this.props);for(let s in r)Object.defineProperty(i,s,{value:r[s]});return i}return this.props}calculateInstancePickingColors(t,{numInstances:r}){if(t.constant)return;let i=Math.floor(up.length/4);if(this.internalState.usesPickingColorCache=!0,i<r){r>Vq&&Ir.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),up=Gh.allocate(up,r,{size:4,copy:!0,maxCount:Math.max(r,Vq)});let s=Math.floor(up.length/4),n=[];for(let o=i;o<s;o++)this.encodePickingColor(o,n),up[o*4+0]=n[0],up[o*4+1]=n[1],up[o*4+2]=n[2]}t.value=up.subarray(0,r*4)}_setModelAttributes(t,r,i=!1){if(!Object.keys(r).length)return;if(i){let a=this.getAttributeManager();t.setBufferLayout(a.getBufferLayouts(t)),r=a.getAttributes()}let s=t.userData?.excludeAttributes||{},n={},o={};for(let a in r){if(s[a])continue;let h=r[a].getValue();for(let p in h){let g=h[p];g instanceof En?r[a].settings.isIndexed?t.setIndexBuffer(g):n[p]=g:g&&(o[p]=g)}}t.setAttributes(n),t.setConstantAttributes(o)}disablePickingIndex(t){let r=this.props.data;if(!("attributes"in r)){this._disablePickingIndex(t);return}let{pickingColors:i,instancePickingColors:s}=this.getAttributeManager().attributes,n=i||s,o=n&&r.attributes&&r.attributes[n.id];if(o&&o.value){let a=o.value,h=this.encodePickingColor(t);for(let p=0;p<r.length;p++){let g=n.getVertexOffset(p);a[g]===h[0]&&a[g+1]===h[1]&&a[g+2]===h[2]&&this._disablePickingIndex(p)}}else this._disablePickingIndex(t)}_disablePickingIndex(t){let{pickingColors:r,instancePickingColors:i}=this.getAttributeManager().attributes,s=r||i;if(!s)return;let n=s.getVertexOffset(t),o=s.getVertexOffset(t+1);s.buffer.write(new Uint8Array(o-n),n)}restorePickingColors(){let{pickingColors:t,instancePickingColors:r}=this.getAttributeManager().attributes,i=t||r;i&&(this.internalState.usesPickingColorCache&&i.value.buffer!==up.buffer&&(i.value=up.subarray(0,i.value.length)),i.updateSubBuffer({startOffset:0}))}_initialize(){Jn(!this.internalState),Jn(Number.isFinite(this.props.coordinateSystem)),ho(x2t,this);let t=this._getAttributeManager();t&&t.addInstanced({instancePickingColors:{type:"uint8",size:4,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new Uw({attributeManager:t,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(Ir.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),t)}),this.internalState.uniformTransitions=new Nw(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(let r of this.props.extensions)r.initializeState.call(this,this.context,r);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(t){ho(w2t,this,this===t);let{state:r,internalState:i}=t;this!==t&&(this.internalState=i,this.state=r,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){let t=this.needsUpdate();if(ho(b2t,this,t),!t)return;let r=this.props,i=this.context,s=this.internalState,n=i.viewport,o=this._updateUniformTransition();s.propsInTransition=o,i.viewport=s.viewport||n,this.props=o;try{let a=this._getUpdateParams(),h=this.getModels();if(i.device)this.updateState(a);else try{this.updateState(a)}catch{}for(let g of this.props.extensions)g.updateState.call(this,a,g);let p=this.getModels()[0]!==h[0];this._postUpdate(a,p)}finally{i.viewport=n,this.props=r,this._clearChangeFlags(),s.needsUpdate=!1,s.resetOldProps()}}_finalize(){ho(v2t,this),this.finalizeState(this.context);for(let t of this.props.extensions)t.finalizeState.call(this,this.context,t)}_drawLayer({renderPass:t,moduleParameters:r=null,uniforms:i={},parameters:s={}}){this._updateAttributeTransition();let n=this.props,o=this.context;this.props=this.internalState.propsInTransition||n;let a=this.props.opacity;i.opacity=Math.pow(a,1/2.2);try{if(r){let{isActive:g,isAttribute:v}=r.picking;this.setModuleParameters(r),this.setShaderModuleProps({picking:{isActive:g,isAttribute:v}})}let{getPolygonOffset:h}=this.props,p=h&&h(i)||[0,0];o.device.setParametersWebGL({polygonOffset:p});for(let g of this.getModels())g.setParameters(s);o.device.withParametersWebGL(s,()=>{let g={renderPass:t,moduleParameters:r,uniforms:i,parameters:s,context:o};for(let v of this.props.extensions)v.draw.call(this,g,v);this.draw(g)})}finally{this.props=n}}getChangeFlags(){return this.internalState?.changeFlags}setChangeFlags(t){if(!this.internalState)return;let{changeFlags:r}=this.internalState;for(let s in t)if(t[s]){let n=!1;switch(s){case"dataChanged":let o=t[s],a=r[s];o&&Array.isArray(a)&&(r.dataChanged=Array.isArray(o)?a.concat(o):o,n=!0);default:r[s]||(r[s]=t[s],n=!0)}n&&ho(y2t,this,s,t)}let i=!!(r.dataChanged||r.updateTriggersChanged||r.propsChanged||r.extensionsChanged);r.propsOrDataChanged=i,r.somethingChanged=i||r.viewportChanged||r.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(t,r){let i=Dq(t,r);if(i.updateTriggersChanged)for(let s in i.updateTriggersChanged)i.updateTriggersChanged[s]&&this.invalidateAttribute(s);if(i.transitionsChanged)for(let s in i.transitionsChanged)this.internalState.uniformTransitions.add(s,r[s],t[s],t.transitions?.[s]);return this.setChangeFlags(i)}validateProps(){kq(this.props)}updateAutoHighlight(t){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(t)}_updateAutoHighlight(t){let r={highlightedObjectColor:t.picked?t.color:null},{highlightColor:i}=this.props;t.picked&&typeof i=="function"&&(r.highlightColor=i(t)),this.setShaderModuleProps({picking:r}),this.setNeedsRedraw()}_getAttributeManager(){let t=this.context;return new Dw(t.device,{id:this.props.id,stats:t.stats,timeline:t.timeline})}_postUpdate(t,r){let{props:i,oldProps:s}=t;this.setNeedsRedraw(),this._updateAttributes();let n=this.state.model;n?.isInstanced&&n.setInstanceCount(this.getNumInstances());let{autoHighlight:o,highlightedObjectIndex:a,highlightColor:h}=i;if(r||s.autoHighlight!==o||s.highlightedObjectIndex!==a||s.highlightColor!==h){let p={};o||(p.highlightedObjectColor=null),Array.isArray(h)&&(p.highlightColor=h),(r||a!==s.highlightedObjectIndex)&&(p.highlightedObjectColor=Number.isFinite(a)&&a>=0?this.encodePickingColor(a):null),this.setShaderModuleProps({picking:p})}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(t){if(!this.internalState)return!1;let r=!1;r=r||this.internalState.needsRedraw&&this.id;let i=this.getAttributeManager(),s=i?i.getNeedsRedraw(t):!1;if(r=r||s,r)for(let n of this.props.extensions)n.onNeedsRedraw.call(this,n);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!t.clearRedrawFlags,r}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}};var I2t="compositeLayer.renderLayers",Sc=class extends $o{static{this.layerName="CompositeLayer"}get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(t=>t.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(t){}setState(t){super.setState(t),this.setNeedsUpdate()}getPickingInfo({info:t}){let{object:r}=t;return r&&r.__source&&r.__source.parent&&r.__source.parent.id===this.id&&(t.object=r.__source.object,t.index=r.__source.index),t}filterSubLayer(t){return!0}shouldRenderSubLayer(t,r){return r&&r.length}getSubLayerClass(t,r){let{_subLayerProps:i}=this.props;return i&&i[t]&&i[t].type||r}getSubLayerRow(t,r,i){return t.__source={parent:this,object:r,index:i},t}getSubLayerAccessor(t){if(typeof t=="function"){let r={index:-1,data:this.props.data,target:[]};return(i,s)=>i&&i.__source?(r.index=i.__source.index,t(i.__source.object,r)):t(i,s)}return t}getSubLayerProps(t={}){let{opacity:r,pickable:i,visible:s,parameters:n,getPolygonOffset:o,highlightedObjectIndex:a,autoHighlight:h,highlightColor:p,coordinateSystem:g,coordinateOrigin:v,wrapLongitude:T,positionFormat:C,modelMatrix:B,extensions:L,fetch:z,operation:W,_subLayerProps:Z}=this.props,X={id:"",updateTriggers:{},opacity:r,pickable:i,visible:s,parameters:n,getPolygonOffset:o,highlightedObjectIndex:a,autoHighlight:h,highlightColor:p,coordinateSystem:g,coordinateOrigin:v,wrapLongitude:T,positionFormat:C,modelMatrix:B,extensions:L,fetch:z,operation:W},q=Z&&t.id&&Z[t.id],it=q&&q.updateTriggers,nt=t.id||"sublayer";if(q){let Mt=this.props[Qu],_t=t.type?t.type._propTypes:{};for(let Et in q){let vt=_t[Et]||Mt[Et];vt&&vt.type==="accessor"&&(q[Et]=this.getSubLayerAccessor(q[Et]))}}Object.assign(X,t,q),X.id=`${this.props.id}-${nt}`,X.updateTriggers={all:this.props.updateTriggers?.all,...t.updateTriggers,...it};for(let Mt of L){let _t=Mt.getSubLayerProps.call(this,Mt);_t&&Object.assign(X,_t,{updateTriggers:Object.assign(X.updateTriggers,_t.updateTriggers)})}return X}_updateAutoHighlight(t){for(let r of this.getSubLayers())r.updateAutoHighlight(t)}_getAttributeManager(){return null}_postUpdate(t,r){let i=this.internalState.subLayers,s=!i||this.needsUpdate();if(s){let n=this.renderLayers();i=vc(n,Boolean),this.internalState.subLayers=i}ho(I2t,this,s,i);for(let n of i)n.parent=this}};var zE=Math.PI/180,jq=180/Math.PI,UE=6370972,n2=256;function M2t(){let e=n2/UE,t=Math.PI/180*n2;return{unitsPerMeter:[e,e,e],unitsPerMeter2:[0,0,0],metersPerUnit:[1/e,1/e,1/e],unitsPerDegree:[t,t,e],unitsPerDegree2:[0,0,0],degreesPerUnit:[1/t,1/t,1/e]}}var s2=class extends Bd{constructor(t={}){let{latitude:r=0,longitude:i=0,zoom:s=0,nearZMultiplier:n=.1,farZMultiplier:o=2,resolution:a=10}=t,{height:h,altitude:p=1.5}=t;h=h||1,p=Math.max(.75,p);let g=new Os().lookAt({eye:[0,-p,0],up:[0,0,1]}),v=Math.pow(2,s);g.rotateX(r*zE),g.rotateZ(-i*zE),g.scale(v/h);let T=Math.atan(.5/p),C=n2*2*v/h;super({...t,height:h,viewMatrix:g,longitude:i,latitude:r,zoom:s,distanceScales:M2t(),fovyRadians:T*2,focalDistance:p,near:n,far:Math.min(2,1/C+1)*p*o}),this.latitude=r,this.longitude=i,this.resolution=a}get projectionMode(){return dl.GLOBE}getDistanceScales(){return this.distanceScales}getBounds(t={}){let r={targetZ:t.z||0},i=this.unproject([0,this.height/2],r),s=this.unproject([this.width/2,0],r),n=this.unproject([this.width,this.height/2],r),o=this.unproject([this.width/2,this.height],r);return n[0]<this.longitude&&(n[0]+=360),i[0]>this.longitude&&(i[0]-=360),[Math.min(i[0],n[0],s[0],o[0]),Math.min(i[1],n[1],s[1],o[1]),Math.max(i[0],n[0],s[0],o[0]),Math.max(i[1],n[1],s[1],o[1])]}unproject(t,{topLeft:r=!0,targetZ:i}={}){let[s,n,o]=t,a=r?n:this.height-n,{pixelUnprojectionMatrix:h}=this,p;if(Number.isFinite(o))p=KD(h,[s,a,o,1]);else{let C=KD(h,[s,a,-1,1]),B=KD(h,[s,a,1,1]),L=((i||0)/UE+1)*n2,z=xc.sqrLen(xc.sub([],C,B)),W=xc.sqrLen(C),Z=xc.sqrLen(B),q=4*((4*W*Z-(z-W-Z)**2)/16)/z,it=Math.sqrt(W-q),nt=Math.sqrt(Math.max(0,L*L-q)),Mt=(it-nt)/Math.sqrt(z);p=xc.lerp([],C,B,Mt)}let[g,v,T]=this.unprojectPosition(p);return Number.isFinite(o)?[g,v,T]:Number.isFinite(i)?[g,v,i]:[g,v]}projectPosition(t){let[r,i,s=0]=t,n=r*zE,o=i*zE,a=Math.cos(o),h=(s/UE+1)*n2;return[Math.sin(n)*a*h,-Math.cos(n)*a*h,Math.sin(o)*h]}unprojectPosition(t){let[r,i,s]=t,n=xc.len(t),o=Math.asin(s/n),h=Math.atan2(r,-i)*jq,p=o*jq,g=(n/n2-1)*UE;return[h,p,g]}projectFlat(t){return t}unprojectFlat(t){return t}panByPosition(t,r){let i=this.unproject(r);return{longitude:t[0]-i[0]+this.longitude,latitude:t[1]-i[1]+this.latitude}}};function KD(e,t){let r=bc.transformMat4([],t,e);return bc.scale(r,r,1/r[3]),r}var jm=class{constructor(t){this.indexStarts=[0],this.vertexStarts=[0],this.vertexCount=0,this.instanceCount=0;let{attributes:r={}}=t;this.typedArrayManager=Gh,this.attributes={},this._attributeDefs=r,this.opts=t,this.updateGeometry(t)}updateGeometry(t){Object.assign(this.opts,t);let{data:r,buffers:i={},getGeometry:s,geometryBuffer:n,positionFormat:o,dataChanged:a,normalize:h=!0}=this.opts;if(this.data=r,this.getGeometry=s,this.positionSize=n&&n.size||(o==="XY"?2:3),this.buffers=i,this.normalize=h,n&&(Jn(r.startIndices),this.getGeometry=this.getGeometryFromBuffer(n),h||(i.vertexPositions=n)),this.geometryBuffer=i.vertexPositions,Array.isArray(a))for(let p of a)this._rebuildGeometry(p);else this._rebuildGeometry()}updatePartialGeometry({startRow:t,endRow:r}){this._rebuildGeometry({startRow:t,endRow:r})}getGeometryFromBuffer(t){let r=t.value||t;return ArrayBuffer.isView(r)?RE(r,{size:this.positionSize,offset:t.offset,stride:t.stride,startIndices:this.data.startIndices}):null}_allocate(t,r){let{attributes:i,buffers:s,_attributeDefs:n,typedArrayManager:o}=this;for(let a in n)if(a in s)o.release(i[a]),i[a]=null;else{let h=n[a];h.copy=r,i[a]=o.allocate(i[a],t,h)}}_forEachGeometry(t,r,i){let{data:s,getGeometry:n}=this,{iterable:o,objectInfo:a}=hu(s,r,i);for(let h of o){a.index++;let p=n?n(h,a):null;t(p,a.index)}}_rebuildGeometry(t){if(!this.data)return;let{indexStarts:r,vertexStarts:i,instanceCount:s}=this,{data:n,geometryBuffer:o}=this,{startRow:a=0,endRow:h=1/0}=t||{},p={};if(t||(r=[0],i=[0]),this.normalize||!o)this._forEachGeometry((v,T)=>{let C=v&&this.normalizeGeometry(v);p[T]=C,i[T+1]=i[T]+(C?this.getGeometrySize(C):0)},a,h),s=i[i.length-1];else if(i=n.startIndices,s=i[n.length]||0,ArrayBuffer.isView(o))s=s||o.length/this.positionSize;else if(o instanceof En){let v=this.positionSize*4;s=s||o.byteLength/v}else if(o.buffer){let v=o.stride||this.positionSize*4;s=s||o.buffer.byteLength/v}else if(o.value){let v=o.value,T=o.stride/v.BYTES_PER_ELEMENT||this.positionSize;s=s||v.length/T}this._allocate(s,!!t),this.indexStarts=r,this.vertexStarts=i,this.instanceCount=s;let g={};this._forEachGeometry((v,T)=>{let C=p[T]||v;g.vertexStart=i[T],g.indexStart=r[T];let B=T<i.length-1?i[T+1]:s;g.geometrySize=B-i[T],g.geometryIndex=T,this.updateGeometryAttributes(C,g)},a,h),this.vertexCount=r[r.length-1]}};var JD=512,C2t=Math.PI/180;function VE({map:e,gl:t,deck:r}){if(e.__deck)return e.__deck;let i=r?.props._customRender,s=r?.props.onLoad,n=eO({...r?.props,_customRender:()=>{e.triggerRepaint(),i?.("")}}),o;return(!r||r.props.gl===t)&&(Object.assign(n,{gl:t,width:null,height:null,touchAction:"unset",viewState:o2(e)}),r?.isInitialized?Wq(r,e):n.onLoad=()=>{s?.(),Wq(o,e)}),r?(o=r,r.setProps(n),r.userData.isExternal=!0):(o=new Ud(n),e.on("remove",()=>{tO(e)})),o.userData.mapboxLayers=new Set,e.__deck=o,e.on("render",()=>{o.isInitialized&&R2t(o,e)}),o}function Wq(e,t){let r=()=>{e.isInitialized?k2t(e,t):t.off("move",r)};t.on("move",r)}function tO(e){e.__deck?.finalize(),e.__deck=null}function eO(e){return{...e,parameters:{depthMask:!0,depthTest:!0,blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthFunc:515,blendEquation:32774,...e.parameters},views:e.views||[new Lm({id:"mapbox"})]}}function $q(e,t){e.userData.mapboxLayers.add(t),rO(e)}function Hq(e,t){e.userData.mapboxLayers.delete(t),rO(e)}function qq(e,t){rO(e)}function Yq(e,t,r){let{currentViewport:i}=e.userData,s=!1;i||(i=Xq(e,t,!0),e.userData.currentViewport=i,s=!0),e.isInitialized&&e._drawLayers("mapbox-repaint",{viewports:[i],layerFilter:({layer:n})=>r.id===n.id||n.props.operation.includes("terrain"),clearStack:s,clearCanvas:!1})}function o2(e){let{lng:t,lat:r}=e.getCenter(),i={longitude:(t+540)%360-180,latitude:r,zoom:e.getZoom(),bearing:e.getBearing(),pitch:e.getPitch(),padding:e.getPadding(),repeat:e.getRenderWorldCopies()};return e.getTerrain?.()&&P2t(e,i),i}function P2t(e,t){if(e.getFreeCameraOptions){let{position:r}=e.getFreeCameraOptions();if(!r||r.z===void 0)return;let i=e.transform.height,{longitude:s,latitude:n,pitch:o}=t,a=r.x*JD,h=(1-r.y)*JD,p=r.z*JD,g=Va([s,n]),v=a-g[0],T=h-g[1],C=Math.sqrt(v*v+T*T),B=o*C2t,L=1.5*i,z=B<.001?L*Math.cos(B)/p:L*Math.sin(B)/C;t.zoom=Math.log2(z);let W=L*Math.cos(B)/z,Z=p-W;t.position=[0,0,Z/Yg(n)]}else typeof e.transform.elevation=="number"&&(t.position=[0,0,e.transform.elevation])}function Xq(e,t,r=!0){return new cu({id:"mapbox",x:0,y:0,width:e.width,height:e.height,...o2(t),nearZMultiplier:r?.02:.1,nearZ:t.transform._nearZ/t.transform.height,farZ:t.transform._farZ/t.transform.height})}function R2t(e,t){let{mapboxLayers:r,isExternal:i}=e.userData;if(i){let s=Array.from(r,g=>g.id),o=vc(e.props.layers,Boolean).some(g=>g&&!s.includes(g.id)),a=e.getViewports(),h=a.findIndex(g=>g.id==="mapbox"),p=a.length>1||h<0;(o||p)&&(h>=0&&(a=a.slice(),a[h]=Xq(e,t,!1)),e._drawLayers("mapbox-repaint",{viewports:a,layerFilter:g=>(!e.props.layerFilter||e.props.layerFilter(g))&&(g.viewport.id!=="mapbox"||!s.includes(g.layer.id)),clearCanvas:!1}))}e.userData.currentViewport=null}function k2t(e,t){e.setProps({viewState:o2(t)}),e.needsRedraw({clearRedrawFlags:!0})}function rO(e){if(e.userData.isExternal)return;let t=[];e.userData.mapboxLayers.forEach(r=>{let i=r.props.type,s=new i(r.props);t.push(s)}),e.setProps({layers:t})}var Vw=class{constructor(t){if(!t.id)throw new Error("Layer must have an unique id");this.id=t.id,this.type="custom",this.renderingMode=t.renderingMode||"3d",this.map=null,this.deck=null,this.props=t}onAdd(t,r){this.map=t,this.deck=VE({map:t,gl:r,deck:this.props.deck}),$q(this.deck,this)}onRemove(){this.deck&&Hq(this.deck,this)}setProps(t){Object.assign(this.props,t,{id:this.id}),this.deck&&qq(this.deck,this)}render(){Yq(this.deck,this.map,this)}};var iO="__UNDEFINED__";function jw(e,t,r,i){if(!e||!t||!e.style||!e.style._loaded)return;let s=vc(i,Boolean);if(r!==i){let a=vc(r,Boolean),h=new Set(a.map(p=>p.id));for(let p of s)h.delete(p.id);for(let p of h)e.getLayer(p)&&e.removeLayer(p)}for(let a of s){let h=e.getLayer(a.id);h?h.implementation.setProps(a.props):e.addLayer(new Vw({id:a.id,deck:t}),a.props.beforeId)}let n=e.style._order,o={};for(let a of s){let{beforeId:h}=a.props;(!h||!n.includes(h))&&(h=iO),o[h]=o[h]||[],o[h].push(a.id)}for(let a in o){let h=o[a],p=a===iO?n.length:n.indexOf(a),g=a===iO?void 0:a;for(let v=h.length-1;v>=0;v--){let T=h[v],C=n.indexOf(T);C!==p-1&&(e.moveLayer(T,g),C>p&&p++),p--,g=T}}}var a2=class{constructor(t){this._handleStyleChange=()=>{jw(this._map,this._deck,this._props.layers,this._props.layers)},this._updateContainerSize=()=>{if(this._map&&this._container){let{clientWidth:s,clientHeight:n}=this._map.getContainer();Object.assign(this._container.style,{width:`${s}px`,height:`${n}px`})}},this._updateViewState=()=>{let s=this._deck;s&&(s.setProps({viewState:o2(this._map)}),s.isInitialized&&s.redraw())},this._handleMouseEvent=s=>{let n=this._deck;if(!n||!n.isInitialized)return;let o={type:s.type,offsetCenter:s.point,srcEvent:s},a=this._lastMouseDownPoint;switch(!s.point&&a&&(o.deltaX=s.originalEvent.clientX-a.clientX,o.deltaY=s.originalEvent.clientY-a.clientY,o.offsetCenter={x:a.x+o.deltaX,y:a.y+o.deltaY}),o.type){case"mousedown":n._onPointerDown(o),this._lastMouseDownPoint={...s.point,clientX:s.originalEvent.clientX,clientY:s.originalEvent.clientY};break;case"dragstart":o.type="panstart",n._onEvent(o);break;case"drag":o.type="panmove",n._onEvent(o);break;case"dragend":o.type="panend",n._onEvent(o);break;case"click":o.tapCount=1,n._onEvent(o);break;case"dblclick":o.type="click",o.tapCount=2,n._onEvent(o);break;case"mousemove":o.type="pointermove",n._onPointerMove(o);break;case"mouseout":o.type="pointerleave",n._onPointerMove(o);break;default:return}};let{interleaved:r=!1,...i}=t;this._interleaved=r,this._props=i}setProps(t){this._interleaved&&t.layers&&jw(this._map,this._deck,this._props.layers,t.layers),Object.assign(this._props,t),this._deck&&this._deck.setProps(this._interleaved?eO(this._props):this._props)}onAdd(t){return this._map=t,this._interleaved?this._onAddInterleaved(t):this._onAddOverlaid(t)}_onAddOverlaid(t){let r=document.createElement("div");return Object.assign(r.style,{position:"absolute",left:0,top:0,textAlign:"initial",pointerEvents:"none"}),this._container=r,this._deck=new Ud({...this._props,parent:r,viewState:o2(t)}),t.on("resize",this._updateContainerSize),t.on("render",this._updateViewState),t.on("mousedown",this._handleMouseEvent),t.on("dragstart",this._handleMouseEvent),t.on("drag",this._handleMouseEvent),t.on("dragend",this._handleMouseEvent),t.on("mousemove",this._handleMouseEvent),t.on("mouseout",this._handleMouseEvent),t.on("click",this._handleMouseEvent),t.on("dblclick",this._handleMouseEvent),this._updateContainerSize(),r}_onAddInterleaved(t){let r=t.painter.context.gl;return r instanceof WebGLRenderingContext&&Ir.warn("Incompatible basemap library. See: https://deck.gl/docs/api-reference/mapbox/overview#compatibility")(),this._deck=VE({map:t,gl:r,deck:new Ud({...this._props,gl:r})}),t.on("styledata",this._handleStyleChange),jw(t,this._deck,[],this._props.layers),document.createElement("div")}onRemove(){let t=this._map;t&&(this._interleaved?this._onRemoveInterleaved(t):this._onRemoveOverlaid(t)),this._deck=void 0,this._map=void 0,this._container=void 0}_onRemoveOverlaid(t){t.off("resize",this._updateContainerSize),t.off("render",this._updateViewState),t.off("mousedown",this._handleMouseEvent),t.off("dragstart",this._handleMouseEvent),t.off("drag",this._handleMouseEvent),t.off("dragend",this._handleMouseEvent),t.off("mousemove",this._handleMouseEvent),t.off("mouseout",this._handleMouseEvent),t.off("click",this._handleMouseEvent),t.off("dblclick",this._handleMouseEvent),this._deck?.finalize()}_onRemoveInterleaved(t){t.off("styledata",this._handleStyleChange),jw(t,this._deck,this._props.layers,[]),tO(t)}getDefaultPosition(){return"top-left"}pickObject(t){return Jn(this._deck),this._deck.pickObject(t)}pickMultipleObjects(t){return Jn(this._deck),this._deck.pickMultipleObjects(t)}pickObjects(t){return Jn(this._deck),this._deck.pickObjects(t)}finalize(){this._map&&this._map.removeControl(this)}getCanvas(){return this._map?this._interleaved?this._map.getCanvas():this._deck.getCanvas():null}};var D2t=new Uint32Array([0,2,1,0,3,2]),O2t=new Float32Array([0,1,0,0,1,0,1,1]);function nO(e,t){if(!t)return B2t(e);let r=Math.max(Math.abs(e[0][0]-e[3][0]),Math.abs(e[1][0]-e[2][0])),i=Math.max(Math.abs(e[1][1]-e[0][1]),Math.abs(e[2][1]-e[3][1])),s=Math.ceil(r/t)+1,n=Math.ceil(i/t)+1,o=(s-1)*(n-1)*6,a=new Uint32Array(o),h=new Float32Array(s*n*2),p=new Float64Array(s*n*3),g=0,v=0;for(let T=0;T<s;T++){let C=T/(s-1);for(let B=0;B<n;B++){let L=B/(n-1),z=N2t(e,C,L);p[g*3+0]=z[0],p[g*3+1]=z[1],p[g*3+2]=z[2]||0,h[g*2+0]=C,h[g*2+1]=1-L,T>0&&B>0&&(a[v++]=g-n,a[v++]=g-n-1,a[v++]=g-1,a[v++]=g-n,a[v++]=g-1,a[v++]=g),g++}}return{vertexCount:o,positions:p,indices:a,texCoords:h}}function B2t(e){let t=new Float64Array(12);for(let r=0;r<e.length;r++)t[r*3+0]=e[r][0],t[r*3+1]=e[r][1],t[r*3+2]=e[r][2]||0;return{vertexCount:6,positions:t,indices:D2t,texCoords:O2t}}function N2t(e,t,r){return yc(yc(e[0],e[1],r),yc(e[3],e[2],r),t)}var Zq=`#version 300 es
#define SHADER_NAME bitmap-layer-vertex-shader

in vec2 texCoords;
in vec3 positions;
in vec3 positions64Low;

out vec2 vTexCoord;
out vec2 vTexPos;

uniform float coordinateConversion;

const vec3 pickingColor = vec3(1.0, 0.0, 0.0);

void main(void) {
  geometry.worldPosition = positions;
  geometry.uv = texCoords;
  geometry.pickingColor = pickingColor;

  gl_Position = project_position_to_clipspace(positions, positions64Low, vec3(0.0), geometry.position);
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  vTexCoord = texCoords;

  if (coordinateConversion < -0.5) {
    vTexPos = geometry.position.xy + project_uCommonOrigin.xy;
  } else if (coordinateConversion > 0.5) {
    vTexPos = geometry.worldPosition.xy;
  }

  vec4 color = vec4(0.0);
  DECKGL_FILTER_COLOR(color, geometry);
}
`;var L2t=`
vec3 packUVsIntoRGB(vec2 uv) {
  // Extract the top 8 bits. We want values to be truncated down so we can add a fraction
  vec2 uv8bit = floor(uv * 256.);

  // Calculate the normalized remainders of u and v parts that do not fit into 8 bits
  // Scale and clamp to 0-1 range
  vec2 uvFraction = fract(uv * 256.);
  vec2 uvFraction4bit = floor(uvFraction * 16.);

  // Remainder can be encoded in blue channel, encode as 4 bits for pixel coordinates
  float fractions = uvFraction4bit.x + uvFraction4bit.y * 16.;

  return vec3(uv8bit, fractions) / 255.;
}
`,Gq=`#version 300 es
#define SHADER_NAME bitmap-layer-fragment-shader

#ifdef GL_ES
precision highp float;
#endif

uniform sampler2D bitmapTexture;

in vec2 vTexCoord;
in vec2 vTexPos;

out vec4 fragColor;

uniform float desaturate;
uniform vec4 transparentColor;
uniform vec3 tintColor;
uniform float opacity;

uniform float coordinateConversion;
uniform vec4 bounds;

/* projection utils */
const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / PI / 2.0;

// from degrees to Web Mercator
vec2 lnglat_to_mercator(vec2 lnglat) {
  float x = lnglat.x;
  float y = clamp(lnglat.y, -89.9, 89.9);
  return vec2(
    radians(x) + PI,
    PI + log(tan(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

// from Web Mercator to degrees
vec2 mercator_to_lnglat(vec2 xy) {
  xy /= WORLD_SCALE;
  return degrees(vec2(
    xy.x - PI,
    atan(exp(xy.y - PI)) * 2.0 - PI * 0.5
  ));
}
/* End projection utils */

// apply desaturation
vec3 color_desaturate(vec3 color) {
  float luminance = (color.r + color.g + color.b) * 0.333333333;
  return mix(color, vec3(luminance), desaturate);
}

// apply tint
vec3 color_tint(vec3 color) {
  return color * tintColor;
}

// blend with background color
vec4 apply_opacity(vec3 color, float alpha) {
  if (transparentColor.a == 0.0) {
    return vec4(color, alpha);
  }
  float blendedAlpha = alpha + transparentColor.a * (1.0 - alpha);
  float highLightRatio = alpha / blendedAlpha;
  vec3 blendedRGB = mix(transparentColor.rgb, color, highLightRatio);
  return vec4(blendedRGB, blendedAlpha);
}

vec2 getUV(vec2 pos) {
  return vec2(
    (pos.x - bounds[0]) / (bounds[2] - bounds[0]),
    (pos.y - bounds[3]) / (bounds[1] - bounds[3])
  );
}

${L2t}

void main(void) {
  vec2 uv = vTexCoord;
  if (coordinateConversion < -0.5) {
    vec2 lnglat = mercator_to_lnglat(vTexPos);
    uv = getUV(lnglat);
  } else if (coordinateConversion > 0.5) {
    vec2 commonPos = lnglat_to_mercator(vTexPos);
    uv = getUV(commonPos);
  }
  vec4 bitmapColor = texture(bitmapTexture, uv);

  fragColor = apply_opacity(color_tint(color_desaturate(bitmapColor.rgb)), bitmapColor.a * opacity);

  geometry.uv = uv;
  DECKGL_FILTER_COLOR(fragColor, geometry);

  if (bool(picking.isActive) && !bool(picking.isAttribute)) {
    // Since instance information is not used, we can use picking color for pixel index
    fragColor.rgb = packUVsIntoRGB(uv);
  }
}
`;var F2t={image:{type:"image",value:null,async:!0},bounds:{type:"array",value:[1,0,0,1],compare:!0},_imageCoordinateSystem:qi.DEFAULT,desaturate:{type:"number",min:0,max:1,value:0},transparentColor:{type:"color",value:[0,0,0,0]},tintColor:{type:"color",value:[255,255,255]},textureParameters:{type:"object",ignore:!0,value:null}},l2=class extends $o{static{this.layerName="BitmapLayer"}static{this.defaultProps=F2t}getShaders(){return super.getShaders({vs:Zq,fs:Gq,modules:[Al,gl]})}initializeState(){let t=this.getAttributeManager();t.remove(["instancePickingColors"]);let r=!0;t.add({indices:{size:1,isIndexed:!0,update:i=>i.value=this.state.mesh.indices,noAlloc:r},positions:{size:3,type:"float64",fp64:this.use64bitPositions(),update:i=>i.value=this.state.mesh.positions,noAlloc:r},texCoords:{size:2,update:i=>i.value=this.state.mesh.texCoords,noAlloc:r}})}updateState({props:t,oldProps:r,changeFlags:i}){let s=this.getAttributeManager();if(i.extensionsChanged&&(this.state.model?.destroy(),this.state.model=this._getModel(),s.invalidateAll()),t.bounds!==r.bounds){let n=this.state.mesh,o=this._createMesh();this.state.model.setVertexCount(o.vertexCount);for(let a in o)n&&n[a]!==o[a]&&s.invalidate(a);this.setState({mesh:o,...this._getCoordinateUniforms()})}else t._imageCoordinateSystem!==r._imageCoordinateSystem&&this.setState(this._getCoordinateUniforms())}getPickingInfo(t){let{image:r}=this.props,i=t.info;if(!i.color||!r)return i.bitmap=null,i;let{width:s,height:n}=r;i.index=0;let o=z2t(i.color);return i.bitmap={size:{width:s,height:n},uv:o,pixel:[Math.floor(o[0]*s),Math.floor(o[1]*n)]},i}disablePickingIndex(){this.setState({disablePicking:!0})}restorePickingColors(){this.setState({disablePicking:!1})}_updateAutoHighlight(t){super._updateAutoHighlight({...t,color:this.encodePickingColor(0)})}_createMesh(){let{bounds:t}=this.props,r=t;return Qq(t)&&(r=[[t[0],t[1]],[t[0],t[3]],[t[2],t[3]],[t[2],t[1]]]),nO(r,this.context.viewport.resolution)}_getModel(){return new to(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),topology:"triangle-list",isInstanced:!1})}draw(t){let{uniforms:r,moduleParameters:i}=t,{model:s,coordinateConversion:n,bounds:o,disablePicking:a}=this.state,{image:h,desaturate:p,transparentColor:g,tintColor:v}=this.props;i.picking.isActive&&a||h&&s&&(s.setUniforms(r),s.setBindings({bitmapTexture:h}),s.setUniforms({desaturate:p,transparentColor:g.map(T=>T/255),tintColor:v.slice(0,3).map(T=>T/255),coordinateConversion:n,bounds:o}),s.draw(this.context.renderPass))}_getCoordinateUniforms(){let{LNGLAT:t,CARTESIAN:r,DEFAULT:i}=qi,{_imageCoordinateSystem:s}=this.props;if(s!==i){let{bounds:n}=this.props;if(!Qq(n))throw new Error("_imageCoordinateSystem only supports rectangular bounds");let o=this.context.viewport.resolution?t:r;if(s=s===t?t:r,s===t&&o===r)return{coordinateConversion:-1,bounds:n};if(s===r&&o===t){let a=Va([n[0],n[1]]),h=Va([n[2],n[3]]);return{coordinateConversion:1,bounds:[a[0],a[1],h[0],h[1]]}}}return{coordinateConversion:0,bounds:[0,0,0,0]}}};function z2t(e){let[t,r,i]=e,s=(i&240)/256,n=(i&15)/16;return[(t+n)/256,(r+s)/256]}function Qq(e){return Number.isFinite(e[0])}var Kq=`#version 300 es
#define SHADER_NAME icon-layer-vertex-shader
in vec2 positions;
in vec3 instancePositions;
in vec3 instancePositions64Low;
in float instanceSizes;
in float instanceAngles;
in vec4 instanceColors;
in vec3 instancePickingColors;
in vec4 instanceIconFrames;
in float instanceColorModes;
in vec2 instanceOffsets;
in vec2 instancePixelOffset;
uniform float sizeScale;
uniform vec2 iconsTextureDim;
uniform float sizeMinPixels;
uniform float sizeMaxPixels;
uniform bool billboard;
uniform int sizeUnits;
out float vColorMode;
out vec4 vColor;
out vec2 vTextureCoords;
out vec2 uv;
vec2 rotate_by_angle(vec2 vertex, float angle) {
float angle_radian = angle * PI / 180.0;
float cos_angle = cos(angle_radian);
float sin_angle = sin(angle_radian);
mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);
return rotationMatrix * vertex;
}
void main(void) {
geometry.worldPosition = instancePositions;
geometry.uv = positions;
geometry.pickingColor = instancePickingColors;
uv = positions;
vec2 iconSize = instanceIconFrames.zw;
float sizePixels = clamp(
project_size_to_pixel(instanceSizes * sizeScale, sizeUnits),
sizeMinPixels, sizeMaxPixels
);
float instanceScale = iconSize.y == 0.0 ? 0.0 : sizePixels / iconSize.y;
vec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;
pixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;
pixelOffset += instancePixelOffset;
pixelOffset.y *= -1.0;
if (billboard)  {
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
vec3 offset = vec3(pixelOffset, 0.0);
DECKGL_FILTER_SIZE(offset, geometry);
gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
} else {
vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);
DECKGL_FILTER_SIZE(offset_common, geometry);
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
}
vTextureCoords = mix(
instanceIconFrames.xy,
instanceIconFrames.xy + iconSize,
(positions.xy + 1.0) / 2.0
) / iconsTextureDim;
vColor = instanceColors;
DECKGL_FILTER_COLOR(vColor, geometry);
vColorMode = instanceColorModes;
}
`;var Jq=`#version 300 es
#define SHADER_NAME icon-layer-fragment-shader
precision highp float;
uniform float opacity;
uniform sampler2D iconsTexture;
uniform float alphaCutoff;
in float vColorMode;
in vec4 vColor;
in vec2 vTextureCoords;
in vec2 uv;
out vec4 fragColor;
void main(void) {
geometry.uv = uv;
vec4 texColor = texture(iconsTexture, vTextureCoords);
vec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);
float a = texColor.a * opacity * vColor.a;
if (a < alphaCutoff) {
discard;
}
fragColor = vec4(color, a);
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`;var U2t=1024,V2t=4,tY=()=>{},eY={minFilter:"linear",mipmapFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},j2t={x:0,y:0,width:0,height:0};function W2t(e){return Math.pow(2,Math.ceil(Math.log2(e)))}function $2t(e,t,r,i){let s=Math.min(r/t.width,i/t.height),n=Math.floor(t.width*s),o=Math.floor(t.height*s);return s===1?{data:t,width:n,height:o}:(e.canvas.height=o,e.canvas.width=n,e.clearRect(0,0,n,o),e.drawImage(t,0,0,t.width,t.height,0,0,n,o),{data:e.canvas,width:n,height:o})}function Ww(e){return e&&(e.id||e.url)}function H2t(e,t,r,i){let{width:s,height:n,device:o}=e,a=o.createTexture({format:"rgba8unorm",width:t,height:r,sampler:i}),h=o.createCommandEncoder();return h.copyTextureToTexture({source:e,destination:a,width:s,height:n}),h.finish(),e.destroy(),a}function rY(e,t,r){for(let i=0;i<t.length;i++){let{icon:s,xOffset:n}=t[i],o=Ww(s);e[o]={...s,x:n,y:r}}}function q2t({icons:e,buffer:t,mapping:r={},xOffset:i=0,yOffset:s=0,rowHeight:n=0,canvasWidth:o}){let a=[];for(let h=0;h<e.length;h++){let p=e[h],g=Ww(p);if(!r[g]){let{height:v,width:T}=p;i+T+t>o&&(rY(r,a,s),i=0,s=n+s+t,n=0,a=[]),a.push({icon:p,xOffset:i}),i=i+T+t,n=Math.max(n,v)}}return a.length>0&&rY(r,a,s),{mapping:r,rowHeight:n,xOffset:i,yOffset:s,canvasWidth:o,canvasHeight:W2t(n+s+t)}}function Y2t(e,t,r){if(!e||!t)return null;r=r||{};let i={},{iterable:s,objectInfo:n}=hu(e);for(let o of s){n.index++;let a=t(o,n),h=Ww(a);if(!a)throw new Error("Icon is missing.");if(!a.url)throw new Error("Icon url is missing.");!i[h]&&(!r[h]||a.url!==r[h].url)&&(i[h]={...a,source:o,sourceIndex:n.index})}return i}var $w=class{constructor(t,{onUpdate:r=tY,onError:i=tY}){this._loadOptions=null,this._texture=null,this._externalTexture=null,this._mapping={},this._textureParameters=null,this._pendingCount=0,this._autoPacking=!1,this._xOffset=0,this._yOffset=0,this._rowHeight=0,this._buffer=V2t,this._canvasWidth=U2t,this._canvasHeight=0,this._canvas=null,this.device=t,this.onUpdate=r,this.onError=i}finalize(){this._texture?.delete()}getTexture(){return this._texture||this._externalTexture}getIconMapping(t){let r=this._autoPacking?Ww(t):t;return this._mapping[r]||j2t}setProps({loadOptions:t,autoPacking:r,iconAtlas:i,iconMapping:s,textureParameters:n}){t&&(this._loadOptions=t),r!==void 0&&(this._autoPacking=r),s&&(this._mapping=s),i&&(this._texture?.delete(),this._texture=null,this._externalTexture=i),n&&(this._textureParameters=n)}get isLoaded(){return this._pendingCount===0}packIcons(t,r){if(!this._autoPacking||typeof document>"u")return;let i=Object.values(Y2t(t,r,this._mapping)||{});if(i.length>0){let{mapping:s,xOffset:n,yOffset:o,rowHeight:a,canvasHeight:h}=q2t({icons:i,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset});this._rowHeight=a,this._mapping=s,this._xOffset=n,this._yOffset=o,this._canvasHeight=h,this._texture||(this._texture=this.device.createTexture({format:"rgba8unorm",width:this._canvasWidth,height:this._canvasHeight,sampler:this._textureParameters||eY})),this._texture.height!==this._canvasHeight&&(this._texture=H2t(this._texture,this._canvasWidth,this._canvasHeight,this._textureParameters||eY)),this.onUpdate(),this._canvas=this._canvas||document.createElement("canvas"),this._loadIcons(i)}}_loadIcons(t){let r=this._canvas.getContext("2d",{willReadFrequently:!0});for(let i of t)this._pendingCount++,Tm(i.url,this._loadOptions).then(s=>{let n=Ww(i),o=this._mapping[n],{x:a,y:h,width:p,height:g}=o,{data:v,width:T,height:C}=$2t(r,s,p,g);this._texture.setSubImageData({data:v,x:a+(p-T)/2,y:h+(g-C)/2,width:T,height:C}),o.width=T,o.height=C,this._texture.generateMipmap(),this.onUpdate()}).catch(s=>{this.onError({url:i.url,source:i.source,sourceIndex:i.sourceIndex,loadOptions:this._loadOptions,error:s})}).finally(()=>{this._pendingCount--})}};var iY=[0,0,0,255],X2t={iconAtlas:{type:"image",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:.05,min:0,max:1},getPosition:{type:"accessor",value:e=>e.position},getIcon:{type:"accessor",value:e=>e.icon},getColor:{type:"accessor",value:iY},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},onIconError:{type:"function",value:null,optional:!0},textureParameters:{type:"object",ignore:!0,value:null}},s1=class extends $o{static{this.defaultProps=X2t}static{this.layerName="IconLayer"}getShaders(){return super.getShaders({vs:Kq,fs:Jq,modules:[Al,gl]})}initializeState(){this.state={iconManager:new $w(this.context.device,{onUpdate:this._onUpdate.bind(this),onError:this._onError.bind(this)})},this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:"uint8",accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:"unorm8",transition:!0,accessor:"getColor",defaultValue:iY},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}updateState(t){super.updateState(t);let{props:r,oldProps:i,changeFlags:s}=t,n=this.getAttributeManager(),{iconAtlas:o,iconMapping:a,data:h,getIcon:p,textureParameters:g}=r,{iconManager:v}=this.state;if(typeof o=="string")return;let T=o||this.internalState.isAsyncPropLoading("iconAtlas");v.setProps({loadOptions:r.loadOptions,autoPacking:!T,iconAtlas:o,iconMapping:T?a:null,textureParameters:g}),T?i.iconMapping!==r.iconMapping&&n.invalidate("getIcon"):(s.dataChanged||s.updateTriggersChanged&&(s.updateTriggersChanged.all||s.updateTriggersChanged.getIcon))&&v.packIcons(h,p),s.extensionsChanged&&(this.state.model?.destroy(),this.state.model=this._getModel(),n.invalidateAll())}get isLoaded(){return super.isLoaded&&this.state.iconManager.isLoaded}finalizeState(t){super.finalizeState(t),this.state.iconManager.finalize()}draw({uniforms:t}){let{sizeScale:r,sizeMinPixels:i,sizeMaxPixels:s,sizeUnits:n,billboard:o,alphaCutoff:a}=this.props,{iconManager:h}=this.state,p=h.getTexture();if(p){let g=this.state.model;g.setBindings({iconsTexture:p}),g.setUniforms(t),g.setUniforms({iconsTextureDim:[p.width,p.height],sizeUnits:ml[n],sizeScale:r,sizeMinPixels:i,sizeMaxPixels:s,billboard:o,alphaCutoff:a}),g.draw(this.context.renderPass)}}_getModel(){let t=[-1,-1,1,-1,-1,1,1,1];return new to(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new _l({topology:"triangle-strip",attributes:{positions:{size:2,value:new Float32Array(t)}}}),isInstanced:!0})}_onUpdate(){this.setNeedsRedraw()}_onError(t){let r=this.getCurrentLayer()?.props.onIconError;r?r(t):Ir.error(t.error.message)()}getInstanceOffset(t){let{width:r,height:i,anchorX:s=r/2,anchorY:n=i/2}=this.state.iconManager.getIconMapping(t);return[r/2-s,i/2-n]}getInstanceColorMode(t){return this.state.iconManager.getIconMapping(t).mask?1:0}getInstanceIconFrame(t){let{x:r,y:i,width:s,height:n}=this.state.iconManager.getIconMapping(t);return[r,i,s,n]}};var nY=`#version 300 es
#define SHADER_NAME scatterplot-layer-vertex-shader
in vec3 positions;
in vec3 instancePositions;
in vec3 instancePositions64Low;
in float instanceRadius;
in float instanceLineWidths;
in vec4 instanceFillColors;
in vec4 instanceLineColors;
in vec3 instancePickingColors;
uniform float opacity;
uniform float radiusScale;
uniform float radiusMinPixels;
uniform float radiusMaxPixels;
uniform float lineWidthScale;
uniform float lineWidthMinPixels;
uniform float lineWidthMaxPixels;
uniform float stroked;
uniform bool filled;
uniform bool antialiasing;
uniform bool billboard;
uniform int radiusUnits;
uniform int lineWidthUnits;
out vec4 vFillColor;
out vec4 vLineColor;
out vec2 unitPosition;
out float innerUnitRadius;
out float outerRadiusPixels;
void main(void) {
geometry.worldPosition = instancePositions;
outerRadiusPixels = clamp(
project_size_to_pixel(radiusScale * instanceRadius, radiusUnits),
radiusMinPixels, radiusMaxPixels
);
float lineWidthPixels = clamp(
project_size_to_pixel(lineWidthScale * instanceLineWidths, lineWidthUnits),
lineWidthMinPixels, lineWidthMaxPixels
);
outerRadiusPixels += stroked * lineWidthPixels / 2.0;
float edgePadding = antialiasing ? (outerRadiusPixels + SMOOTH_EDGE_RADIUS) / outerRadiusPixels : 1.0;
unitPosition = edgePadding * positions.xy;
geometry.uv = unitPosition;
geometry.pickingColor = instancePickingColors;
innerUnitRadius = 1.0 - stroked * lineWidthPixels / outerRadiusPixels;
if (billboard) {
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
vec3 offset = edgePadding * positions * outerRadiusPixels;
DECKGL_FILTER_SIZE(offset, geometry);
gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
} else {
vec3 offset = edgePadding * positions * project_pixel_size(outerRadiusPixels);
DECKGL_FILTER_SIZE(offset, geometry);
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
}
vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);
DECKGL_FILTER_COLOR(vFillColor, geometry);
vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);
DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`;var sY=`#version 300 es
#define SHADER_NAME scatterplot-layer-fragment-shader
precision highp float;
uniform bool filled;
uniform float stroked;
uniform bool antialiasing;
in vec4 vFillColor;
in vec4 vLineColor;
in vec2 unitPosition;
in float innerUnitRadius;
in float outerRadiusPixels;
out vec4 fragColor;
void main(void) {
geometry.uv = unitPosition;
float distToCenter = length(unitPosition) * outerRadiusPixels;
float inCircle = antialiasing ?
smoothedge(distToCenter, outerRadiusPixels) :
step(distToCenter, outerRadiusPixels);
if (inCircle == 0.0) {
discard;
}
if (stroked > 0.5) {
float isLine = antialiasing ?
smoothedge(innerUnitRadius * outerRadiusPixels, distToCenter) :
step(innerUnitRadius * outerRadiusPixels, distToCenter);
if (filled) {
fragColor = mix(vFillColor, vLineColor, isLine);
} else {
if (isLine == 0.0) {
discard;
}
fragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);
}
} else if (!filled) {
discard;
} else {
fragColor = vFillColor;
}
fragColor.a *= inCircle;
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`;var oY=[0,0,0,255],Z2t={radiusUnits:"meters",radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthUnits:"meters",lineWidthScale:{type:"number",min:0,value:1},lineWidthMinPixels:{type:"number",min:0,value:0},lineWidthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,filled:!0,billboard:!1,antialiasing:!0,getPosition:{type:"accessor",value:e=>e.position},getRadius:{type:"accessor",value:1},getFillColor:{type:"accessor",value:oY},getLineColor:{type:"accessor",value:oY},getLineWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getLineWidth"},outline:{deprecatedFor:"stroked"},getColor:{deprecatedFor:["getFillColor","getLineColor"]}},Hw=class extends $o{static{this.defaultProps=Z2t}static{this.layerName="ScatterplotLayer"}getShaders(){return super.getShaders({vs:nY,fs:sY,modules:[Al,gl]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceFillColors:{size:this.props.colorFormat.length,transition:!0,type:"unorm8",accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:this.props.colorFormat.length,transition:!0,type:"unorm8",accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(t){super.updateState(t),t.changeFlags.extensionsChanged&&(this.state.model?.destroy(),this.state.model=this._getModel(),this.getAttributeManager().invalidateAll())}draw({uniforms:t}){let{radiusUnits:r,radiusScale:i,radiusMinPixels:s,radiusMaxPixels:n,stroked:o,filled:a,billboard:h,antialiasing:p,lineWidthUnits:g,lineWidthScale:v,lineWidthMinPixels:T,lineWidthMaxPixels:C}=this.props,B=this.state.model;B.setUniforms(t),B.setUniforms({stroked:o?1:0,filled:a,billboard:h,antialiasing:p,radiusUnits:ml[r],radiusScale:i,radiusMinPixels:s,radiusMaxPixels:n,lineWidthUnits:ml[g],lineWidthScale:v,lineWidthMinPixels:T,lineWidthMaxPixels:C}),B.draw(this.context.renderPass)}_getModel(){let t=[-1,-1,0,1,-1,0,-1,1,0,1,1,0];return new to(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new _l({topology:"triangle-strip",attributes:{positions:{size:3,value:new Float32Array(t)}}}),isInstanced:!0})}};var c2={CLOCKWISE:1,COUNTER_CLOCKWISE:-1};function o1(e,t,r={}){return aY(e,r)!==t?(G2t(e,r),!0):!1}function aY(e,t={}){return Math.sign(jE(e,t))}var sO={x:0,y:1,z:2};function jE(e,t={}){let{start:r=0,end:i=e.length,plane:s="xy"}=t,n=t.size||2,o=0,a=sO[s[0]],h=sO[s[1]];for(let p=r,g=i-n;p<i;p+=n)o+=(e[p+a]-e[g+a])*(e[p+h]+e[g+h]),g=p;return o/2}function G2t(e,t){let{start:r=0,end:i=e.length,size:s=2}=t,n=(i-r)/s,o=Math.floor(n/2);for(let a=0;a<o;++a){let h=r+a*s,p=r+(n-1-a)*s;for(let g=0;g<s;++g){let v=e[h+g];e[h+g]=e[p+g],e[p+g]=v}}}function Ec(e,t){let r=t.length,i=e.length;if(i>0){let s=!0;for(let n=0;n<r;n++)if(e[i-r+n]!==t[n]){s=!1;break}if(s)return!1}for(let s=0;s<r;s++)e[i+s]=t[s];return!0}function qw(e,t){let r=t.length;for(let i=0;i<r;i++)e[i]=t[i]}function Wm(e,t,r,i,s=[]){let n=i+t*r;for(let o=0;o<r;o++)s[o]=e[n+o];return s}function WE(e,t,r,i,s=[]){let n,o;if(r&8)n=(i[3]-e[1])/(t[1]-e[1]),o=3;else if(r&4)n=(i[1]-e[1])/(t[1]-e[1]),o=1;else if(r&2)n=(i[2]-e[0])/(t[0]-e[0]),o=2;else if(r&1)n=(i[0]-e[0])/(t[0]-e[0]),o=0;else return null;for(let a=0;a<e.length;a++)s[a]=(o&1)===a?i[o]:n*(t[a]-e[a])+e[a];return s}function Yw(e,t){let r=0;return e[0]<t[0]?r|=1:e[0]>t[2]&&(r|=2),e[1]<t[1]?r|=4:e[1]>t[3]&&(r|=8),r}function Xw(e,t){let{size:r=2,broken:i=!1,gridResolution:s=10,gridOffset:n=[0,0],startIndex:o=0,endIndex:a=e.length}=t||{},h=(a-o)/r,p=[],g=[p],v=Wm(e,0,r,o),T,C,B=uY(v,s,n,[]),L=[];Ec(p,v);for(let z=1;z<h;z++){for(T=Wm(e,z,r,o,T),C=Yw(T,B);C;){WE(v,T,C,B,L);let W=Yw(L,B);W&&(WE(v,L,W,B,L),C=W),Ec(p,L),qw(v,L),J2t(B,s,C),i&&p.length>r&&(p=[],g.push(p),Ec(p,v)),C=Yw(T,B)}Ec(p,T),qw(v,T)}return i?g:g[0]}var lY=0,K2t=1;function Zw(e,t=null,r){if(!e.length)return[];let{size:i=2,gridResolution:s=10,gridOffset:n=[0,0],edgeTypes:o=!1}=r||{},a=[],h=[{pos:e,types:o?new Array(e.length/i).fill(K2t):null,holes:t||[]}],p=[[],[]],g=[];for(;h.length;){let{pos:v,types:T,holes:C}=h.shift();txt(v,i,C[0]||v.length,p),g=uY(p[0],s,n,g);let B=Yw(p[1],g);if(B){let L=cY(v,T,i,0,C[0]||v.length,g,B),z={pos:L[0].pos,types:L[0].types,holes:[]},W={pos:L[1].pos,types:L[1].types,holes:[]};h.push(z,W);for(let Z=0;Z<C.length;Z++)L=cY(v,T,i,C[Z],C[Z+1]||v.length,g,B),L[0]&&(z.holes.push(z.pos.length),z.pos=$E(z.pos,L[0].pos),o&&(z.types=$E(z.types,L[0].types))),L[1]&&(W.holes.push(W.pos.length),W.pos=$E(W.pos,L[1].pos),o&&(W.types=$E(W.types,L[1].types)))}else{let L={positions:v};o&&(L.edgeTypes=T),C.length&&(L.holeIndices=C),a.push(L)}}return a}function cY(e,t,r,i,s,n,o){let a=(s-i)/r,h=[],p=[],g=[],v=[],T=[],C,B,L,z=Wm(e,a-1,r,i),W=Math.sign(o&8?z[1]-n[3]:z[0]-n[2]),Z=t&&t[a-1],X=0,q=0;for(let it=0;it<a;it++)C=Wm(e,it,r,i,C),B=Math.sign(o&8?C[1]-n[3]:C[0]-n[2]),L=t&&t[i/r+it],B&&W&&W!==B&&(WE(z,C,o,n,T),Ec(h,T)&&g.push(Z),Ec(p,T)&&v.push(Z)),B<=0?(Ec(h,C)&&g.push(L),X-=B):g.length&&(g[g.length-1]=lY),B>=0?(Ec(p,C)&&v.push(L),q+=B):v.length&&(v[v.length-1]=lY),qw(z,C),W=B,Z=L;return[X?{pos:h,types:t&&g}:null,q?{pos:p,types:t&&v}:null]}function uY(e,t,r,i){let s=Math.floor((e[0]-r[0])/t)*t+r[0],n=Math.floor((e[1]-r[1])/t)*t+r[1];return i[0]=s,i[1]=n,i[2]=s+t,i[3]=n+t,i}function J2t(e,t,r){r&8?(e[1]+=t,e[3]+=t):r&4?(e[1]-=t,e[3]-=t):r&2?(e[0]+=t,e[2]+=t):r&1&&(e[0]-=t,e[2]-=t)}function txt(e,t,r,i){let s=1/0,n=-1/0,o=1/0,a=-1/0;for(let h=0;h<r;h+=t){let p=e[h],g=e[h+1];s=p<s?p:s,n=p>n?p:n,o=g<o?g:o,a=g>a?g:a}return i[0][0]=s,i[0][1]=o,i[1][0]=n,i[1][1]=a,i}function $E(e,t){for(let r=0;r<t.length;r++)e.push(t[r]);return e}var ext=85.051129;function oO(e,t){let{size:r=2,startIndex:i=0,endIndex:s=e.length,normalize:n=!0}=t||{},o=e.slice(i,s);hY(o,r,0,s-i);let a=Xw(o,{size:r,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(n)for(let h of a)fY(h,r);return a}function aO(e,t=null,r){let{size:i=2,normalize:s=!0,edgeTypes:n=!1}=r||{};t=t||[];let o=[],a=[],h=0,p=0;for(let v=0;v<=t.length;v++){let T=t[v]||e.length,C=p,B=rxt(e,i,h,T);for(let L=B;L<T;L++)o[p++]=e[L];for(let L=h;L<B;L++)o[p++]=e[L];hY(o,i,C,p),ixt(o,i,C,p,r?.maxLatitude),h=T,a[v]=p}a.pop();let g=Zw(o,a,{size:i,gridResolution:360,gridOffset:[-180,-180],edgeTypes:n});if(s)for(let v of g)fY(v.positions,i);return g}function rxt(e,t,r,i){let s=-1,n=-1;for(let o=r+1;o<i;o+=t){let a=Math.abs(e[o]);a>s&&(s=a,n=o-1)}return n}function ixt(e,t,r,i,s=ext){let n=e[r],o=e[i-t];if(Math.abs(n-o)>180){let a=Wm(e,0,t,r);a[0]+=Math.round((o-n)/360)*360,Ec(e,a),a[1]=Math.sign(a[1])*s,Ec(e,a),a[0]=n,Ec(e,a)}}function hY(e,t,r,i){let s=e[0],n;for(let o=r;o<i;o+=t){n=e[o];let a=n-s;(a>180||a<-180)&&(n-=Math.round(a/360)*360),e[o]=s=n}}function fY(e,t){let r,i=e.length/t;for(let n=0;n<i&&(r=e[n*t],(r+180)%360===0);n++);let s=-Math.round(r/360)*360;if(s!==0)for(let n=0;n<i;n++)e[n*t]+=s}var Gw=class extends _l{constructor(t){let{indices:r,attributes:i}=sxt(t);super({...t,indices:r,attributes:i})}};function sxt(e){let{radius:t,height:r=1,nradial:i=10}=e,{vertices:s}=e;s&&(Ir.assert(s.length>=i),s=s.flatMap(C=>[C[0],C[1]]),o1(s,c2.COUNTER_CLOCKWISE));let n=r>0,o=i+1,a=n?o*3+1:i,h=Math.PI*2/i,p=new Uint16Array(n?i*3*2:0),g=new Float32Array(a*3),v=new Float32Array(a*3),T=0;if(n){for(let C=0;C<o;C++){let B=C*h,L=C%i,z=Math.sin(B),W=Math.cos(B);for(let Z=0;Z<2;Z++)g[T+0]=s?s[L*2]:W*t,g[T+1]=s?s[L*2+1]:z*t,g[T+2]=(1/2-Z)*r,v[T+0]=s?s[L*2]:W,v[T+1]=s?s[L*2+1]:z,T+=3}g[T+0]=g[T-3],g[T+1]=g[T-2],g[T+2]=g[T-1],T+=3}for(let C=n?0:1;C<o;C++){let B=Math.floor(C/2)*Math.sign(.5-C%2),L=B*h,z=(B+i)%i,W=Math.sin(L),Z=Math.cos(L);g[T+0]=s?s[z*2]:Z*t,g[T+1]=s?s[z*2+1]:W*t,g[T+2]=r/2,v[T+2]=1,T+=3}if(n){let C=0;for(let B=0;B<i;B++)p[C++]=B*2+0,p[C++]=B*2+2,p[C++]=B*2+0,p[C++]=B*2+1,p[C++]=B*2+1,p[C++]=B*2+3}return{indices:p,attributes:{POSITION:{size:3,value:g},NORMAL:{size:3,value:v}}}}var pY=`#version 300 es
#define SHADER_NAME column-layer-vertex-shader
in vec3 positions;
in vec3 normals;
in vec3 instancePositions;
in float instanceElevations;
in vec3 instancePositions64Low;
in vec4 instanceFillColors;
in vec4 instanceLineColors;
in float instanceStrokeWidths;
in vec3 instancePickingColors;
uniform float opacity;
uniform float radius;
uniform float angle;
uniform vec2 offset;
uniform bool extruded;
uniform bool stroked;
uniform bool isStroke;
uniform float coverage;
uniform float elevationScale;
uniform float edgeDistance;
uniform float widthScale;
uniform float widthMinPixels;
uniform float widthMaxPixels;
uniform int radiusUnits;
uniform int widthUnits;
out vec4 vColor;
#ifdef FLAT_SHADING
out vec4 position_commonspace;
#endif
void main(void) {
geometry.worldPosition = instancePositions;
vec4 color = isStroke ? instanceLineColors : instanceFillColors;
mat2 rotationMatrix = mat2(cos(angle), sin(angle), -sin(angle), cos(angle));
float elevation = 0.0;
float strokeOffsetRatio = 1.0;
if (extruded) {
elevation = instanceElevations * (positions.z + 1.0) / 2.0 * elevationScale;
} else if (stroked) {
float widthPixels = clamp(
project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),
widthMinPixels, widthMaxPixels) / 2.0;
float halfOffset = project_pixel_size(widthPixels) / project_size(edgeDistance * coverage * radius);
if (isStroke) {
strokeOffsetRatio -= sign(positions.z) * halfOffset;
} else {
strokeOffsetRatio -= halfOffset;
}
}
float shouldRender = float(color.a > 0.0 && instanceElevations >= 0.0);
float dotRadius = radius * coverage * shouldRender;
geometry.pickingColor = instancePickingColors;
vec3 centroidPosition = vec3(instancePositions.xy, instancePositions.z + elevation);
vec3 centroidPosition64Low = instancePositions64Low;
vec2 offset = (rotationMatrix * positions.xy * strokeOffsetRatio + offset) * dotRadius;
if (radiusUnits == UNIT_METERS) {
offset = project_size(offset);
}
vec3 pos = vec3(offset, 0.);
DECKGL_FILTER_SIZE(pos, geometry);
gl_Position = project_position_to_clipspace(centroidPosition, centroidPosition64Low, pos, geometry.position);
geometry.normal = project_normal(vec3(rotationMatrix * normals.xy, normals.z));
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
if (extruded && !isStroke) {
#ifdef FLAT_SHADING
position_commonspace = geometry.position;
vColor = vec4(color.rgb, color.a * opacity);
#else
vec3 lightColor = lighting_getLightColor(color.rgb, project_uCameraPosition, geometry.position.xyz, geometry.normal);
vColor = vec4(lightColor, color.a * opacity);
#endif
} else {
vColor = vec4(color.rgb, color.a * opacity);
}
DECKGL_FILTER_COLOR(vColor, geometry);
}
`;var dY=`#version 300 es
#define SHADER_NAME column-layer-fragment-shader
precision highp float;
uniform vec3 project_uCameraPosition;
uniform bool extruded;
uniform bool isStroke;
out vec4 fragColor;
in vec4 vColor;
#ifdef FLAT_SHADING
in vec4 position_commonspace;
#endif
void main(void) {
fragColor = vColor;
geometry.uv = vec2(0.);
#ifdef FLAT_SHADING
if (extruded && !isStroke && !bool(picking.isActive)) {
vec3 normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));
fragColor.rgb = lighting_getLightColor(vColor.rgb, project_uCameraPosition, position_commonspace.xyz, normal);
}
#endif
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`;var HE=[0,0,0,255],oxt={diskResolution:{type:"number",min:4,value:20},vertices:null,radius:{type:"number",min:0,value:1e3},angle:{type:"number",value:0},offset:{type:"array",value:[0,0]},coverage:{type:"number",min:0,max:1,value:1},elevationScale:{type:"number",min:0,value:1},radiusUnits:"meters",lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,extruded:!0,wireframe:!1,filled:!0,stroked:!1,flatShading:!1,getPosition:{type:"accessor",value:e=>e.position},getFillColor:{type:"accessor",value:HE},getLineColor:{type:"accessor",value:HE},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0,getColor:{deprecatedFor:["getFillColor","getLineColor"]}},u2=class extends $o{static{this.layerName="ColumnLayer"}static{this.defaultProps=oxt}getShaders(){let t={},{flatShading:r}=this.props;return r&&(t.FLAT_SHADING=1),super.getShaders({vs:pY,fs:dY,defines:t,modules:[Al,r?Wv:$g,gl]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceElevations:{size:1,transition:!0,accessor:"getElevation"},instanceFillColors:{size:this.props.colorFormat.length,type:"unorm8",transition:!0,accessor:"getFillColor",defaultValue:HE},instanceLineColors:{size:this.props.colorFormat.length,type:"unorm8",transition:!0,accessor:"getLineColor",defaultValue:HE},instanceStrokeWidths:{size:1,accessor:"getLineWidth",transition:!0}})}updateState(t){super.updateState(t);let{props:r,oldProps:i,changeFlags:s}=t,n=s.extensionsChanged||r.flatShading!==i.flatShading;n&&(this.state.models?.forEach(a=>a.destroy()),this.setState(this._getModels()),this.getAttributeManager().invalidateAll());let o=this.getNumInstances();this.state.fillModel.setInstanceCount(o),this.state.wireframeModel.setInstanceCount(o),(n||r.diskResolution!==i.diskResolution||r.vertices!==i.vertices||(r.extruded||r.stroked)!==(i.extruded||i.stroked))&&this._updateGeometry(r)}getGeometry(t,r,i){let s=new Gw({radius:1,height:i?2:0,vertices:r,nradial:t}),n=0;if(r)for(let o=0;o<t;o++){let a=r[o],h=Math.sqrt(a[0]*a[0]+a[1]*a[1]);n+=h/t}else n=1;return this.setState({edgeDistance:Math.cos(Math.PI/t)*n}),s}_getModels(){let t=this.getShaders(),r=this.getAttributeManager().getBufferLayouts(),i=new to(this.context.device,{...t,id:`${this.props.id}-fill`,bufferLayout:r,isInstanced:!0}),s=new to(this.context.device,{...t,id:`${this.props.id}-wireframe`,bufferLayout:r,isInstanced:!0});return{fillModel:i,wireframeModel:s,models:[s,i]}}_updateGeometry({diskResolution:t,vertices:r,extruded:i,stroked:s}){let n=this.getGeometry(t,r,i||s);this.setState({fillVertexCount:n.attributes.POSITION.value.length/3});let o=this.state.fillModel,a=this.state.wireframeModel;o.setGeometry(n),o.setTopology("triangle-strip"),o.setIndexBuffer(null),a.setGeometry(n),a.setTopology("line-list")}draw({uniforms:t}){let{lineWidthUnits:r,lineWidthScale:i,lineWidthMinPixels:s,lineWidthMaxPixels:n,radiusUnits:o,elevationScale:a,extruded:h,filled:p,stroked:g,wireframe:v,offset:T,coverage:C,radius:B,angle:L}=this.props,z=this.state.fillModel,W=this.state.wireframeModel,{fillVertexCount:Z,edgeDistance:X}=this.state,q={...t,radius:B,angle:L/180*Math.PI,offset:T,extruded:h,stroked:g,coverage:C,elevationScale:a,edgeDistance:X,radiusUnits:ml[o],widthUnits:ml[r],widthScale:i,widthMinPixels:s,widthMaxPixels:n};h&&v&&(W.setUniforms(q),W.setUniforms({isStroke:!0}),W.draw(this.context.renderPass)),z.setUniforms(q),p&&(z.setVertexCount(Z),z.setUniforms({isStroke:!1}),z.draw(this.context.renderPass)),!h&&g&&(z.setVertexCount(Z*2/3),z.setUniforms({isStroke:!0}),z.draw(this.context.renderPass))}};function mY(e,t,r,i){let s;if(Array.isArray(e[0])){let n=e.length*t;s=new Array(n);for(let o=0;o<e.length;o++)for(let a=0;a<t;a++)s[o*t+a]=e[o][a]||0}else s=e;return r?Xw(s,{size:t,gridResolution:r}):i?oO(s,{size:t}):s}var axt=1,lxt=2,lO=4,Qw=class extends jm{constructor(t){super({...t,attributes:{positions:{size:3,padding:18,initialize:!0,type:t.fp64?Float64Array:Float32Array},segmentTypes:{size:1,type:Uint8ClampedArray}}})}get(t){return this.attributes[t]}getGeometryFromBuffer(t){return this.normalize?super.getGeometryFromBuffer(t):null}normalizeGeometry(t){return this.normalize?mY(t,this.positionSize,this.opts.resolution,this.opts.wrapLongitude):t}getGeometrySize(t){if(AY(t)){let i=0;for(let s of t)i+=this.getGeometrySize(s);return i}let r=this.getPathLength(t);return r<2?0:this.isClosed(t)?r<3?0:r+2:r}updateGeometryAttributes(t,r){if(r.geometrySize!==0)if(t&&AY(t))for(let i of t){let s=this.getGeometrySize(i);r.geometrySize=s,this.updateGeometryAttributes(i,r),r.vertexStart+=s}else this._updateSegmentTypes(t,r),this._updatePositions(t,r)}_updateSegmentTypes(t,r){let i=this.attributes.segmentTypes,s=t?this.isClosed(t):!1,{vertexStart:n,geometrySize:o}=r;i.fill(0,n,n+o),s?(i[n]=lO,i[n+o-2]=lO):(i[n]+=axt,i[n+o-2]+=lxt),i[n+o-1]=lO}_updatePositions(t,r){let{positions:i}=this.attributes;if(!i||!t)return;let{vertexStart:s,geometrySize:n}=r,o=new Array(3);for(let a=s,h=0;h<n;a++,h++)this.getPointOnPath(t,h,o),i[a*3]=o[0],i[a*3+1]=o[1],i[a*3+2]=o[2]}getPathLength(t){return t.length/this.positionSize}getPointOnPath(t,r,i=[]){let{positionSize:s}=this;r*s>=t.length&&(r+=1-t.length/s);let n=r*s;return i[0]=t[n],i[1]=t[n+1],i[2]=s===3&&t[n+2]||0,i}isClosed(t){if(!this.normalize)return!!this.opts.loop;let{positionSize:r}=this,i=t.length-r;return t[0]===t[i]&&t[1]===t[i+1]&&(r===2||t[2]===t[i+2])}};function AY(e){return Array.isArray(e[0])}var gY=`#version 300 es
#define SHADER_NAME path-layer-vertex-shader
in vec2 positions;
in float instanceTypes;
in vec3 instanceStartPositions;
in vec3 instanceEndPositions;
in vec3 instanceLeftPositions;
in vec3 instanceRightPositions;
in vec3 instanceLeftPositions64Low;
in vec3 instanceStartPositions64Low;
in vec3 instanceEndPositions64Low;
in vec3 instanceRightPositions64Low;
in float instanceStrokeWidths;
in vec4 instanceColors;
in vec3 instancePickingColors;
uniform float widthScale;
uniform float widthMinPixels;
uniform float widthMaxPixels;
uniform float jointType;
uniform float capType;
uniform float miterLimit;
uniform bool billboard;
uniform int widthUnits;
uniform float opacity;
out vec4 vColor;
out vec2 vCornerOffset;
out float vMiterLength;
out vec2 vPathPosition;
out float vPathLength;
out float vJointType;
const float EPSILON = 0.001;
const vec3 ZERO_OFFSET = vec3(0.0);
float flipIfTrue(bool flag) {
return -(float(flag) * 2. - 1.);
}
vec3 getLineJoinOffset(
vec3 prevPoint, vec3 currPoint, vec3 nextPoint,
vec2 width
) {
bool isEnd = positions.x > 0.0;
float sideOfPath = positions.y;
float isJoint = float(sideOfPath == 0.0);
vec3 deltaA3 = (currPoint - prevPoint);
vec3 deltaB3 = (nextPoint - currPoint);
mat3 rotationMatrix;
bool needsRotation = !billboard && project_needs_rotation(currPoint, rotationMatrix);
if (needsRotation) {
deltaA3 = deltaA3 * rotationMatrix;
deltaB3 = deltaB3 * rotationMatrix;
}
vec2 deltaA = deltaA3.xy / width;
vec2 deltaB = deltaB3.xy / width;
float lenA = length(deltaA);
float lenB = length(deltaB);
vec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);
vec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);
vec2 perpA = vec2(-dirA.y, dirA.x);
vec2 perpB = vec2(-dirB.y, dirB.x);
vec2 tangent = dirA + dirB;
tangent = length(tangent) > 0. ? normalize(tangent) : perpA;
vec2 miterVec = vec2(-tangent.y, tangent.x);
vec2 dir = isEnd ? dirA : dirB;
vec2 perp = isEnd ? perpA : perpB;
float L = isEnd ? lenA : lenB;
float sinHalfA = abs(dot(miterVec, perp));
float cosHalfA = abs(dot(dirA, miterVec));
float turnDirection = flipIfTrue(dirA.x * dirB.y >= dirA.y * dirB.x);
float cornerPosition = sideOfPath * turnDirection;
float miterSize = 1.0 / max(sinHalfA, EPSILON);
miterSize = mix(
min(miterSize, max(lenA, lenB) / max(cosHalfA, EPSILON)),
miterSize,
step(0.0, cornerPosition)
);
vec2 offsetVec = mix(miterVec * miterSize, perp, step(0.5, cornerPosition))
* (sideOfPath + isJoint * turnDirection);
bool isStartCap = lenA == 0.0 || (!isEnd && (instanceTypes == 1.0 || instanceTypes == 3.0));
bool isEndCap = lenB == 0.0 || (isEnd && (instanceTypes == 2.0 || instanceTypes == 3.0));
bool isCap = isStartCap || isEndCap;
if (isCap) {
offsetVec = mix(perp * sideOfPath, dir * capType * 4.0 * flipIfTrue(isStartCap), isJoint);
vJointType = capType;
} else {
vJointType = jointType;
}
vPathLength = L;
vCornerOffset = offsetVec;
vMiterLength = dot(vCornerOffset, miterVec * turnDirection);
vMiterLength = isCap ? isJoint : vMiterLength;
vec2 offsetFromStartOfPath = vCornerOffset + deltaA * float(isEnd);
vPathPosition = vec2(
dot(offsetFromStartOfPath, perp),
dot(offsetFromStartOfPath, dir)
);
geometry.uv = vPathPosition;
float isValid = step(instanceTypes, 3.5);
vec3 offset = vec3(offsetVec * width * isValid, 0.0);
if (needsRotation) {
offset = rotationMatrix * offset;
}
return offset;
}
void clipLine(inout vec4 position, vec4 refPosition) {
if (position.w < EPSILON) {
float r = (EPSILON - refPosition.w) / (position.w - refPosition.w);
position = refPosition + (position - refPosition) * r;
}
}
void main() {
geometry.pickingColor = instancePickingColors;
vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);
float isEnd = positions.x;
vec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);
vec3 prevPosition64Low = mix(instanceLeftPositions64Low, instanceStartPositions64Low, isEnd);
vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);
vec3 currPosition64Low = mix(instanceStartPositions64Low, instanceEndPositions64Low, isEnd);
vec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);
vec3 nextPosition64Low = mix(instanceEndPositions64Low, instanceRightPositions64Low, isEnd);
geometry.worldPosition = currPosition;
vec2 widthPixels = vec2(clamp(
project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),
widthMinPixels, widthMaxPixels) / 2.0);
vec3 width;
if (billboard) {
vec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64Low, ZERO_OFFSET);
vec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64Low, ZERO_OFFSET, geometry.position);
vec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64Low, ZERO_OFFSET);
clipLine(prevPositionScreen, currPositionScreen);
clipLine(nextPositionScreen, currPositionScreen);
clipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));
width = vec3(widthPixels, 0.0);
DECKGL_FILTER_SIZE(width, geometry);
vec3 offset = getLineJoinOffset(
prevPositionScreen.xyz / prevPositionScreen.w,
currPositionScreen.xyz / currPositionScreen.w,
nextPositionScreen.xyz / nextPositionScreen.w,
project_pixel_size_to_clipspace(width.xy)
);
DECKGL_FILTER_GL_POSITION(currPositionScreen, geometry);
gl_Position = vec4(currPositionScreen.xyz + offset * currPositionScreen.w, currPositionScreen.w);
} else {
prevPosition = project_position(prevPosition, prevPosition64Low);
currPosition = project_position(currPosition, currPosition64Low);
nextPosition = project_position(nextPosition, nextPosition64Low);
width = vec3(project_pixel_size(widthPixels), 0.0);
DECKGL_FILTER_SIZE(width, geometry);
vec3 offset = getLineJoinOffset(prevPosition, currPosition, nextPosition, width.xy);
geometry.position = vec4(currPosition + offset, 1.0);
gl_Position = project_common_position_to_clipspace(geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
}
DECKGL_FILTER_COLOR(vColor, geometry);
}
`;var _Y=`#version 300 es
#define SHADER_NAME path-layer-fragment-shader
precision highp float;
uniform float miterLimit;
in vec4 vColor;
in vec2 vCornerOffset;
in float vMiterLength;
in vec2 vPathPosition;
in float vPathLength;
in float vJointType;
out vec4 fragColor;
void main(void) {
geometry.uv = vPathPosition;
if (vPathPosition.y < 0.0 || vPathPosition.y > vPathLength) {
if (vJointType > 0.5 && length(vCornerOffset) > 1.0) {
discard;
}
if (vJointType < 0.5 && vMiterLength > miterLimit + 1.0) {
discard;
}
}
fragColor = vColor;
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`;var yY=[0,0,0,255],cxt={widthUnits:"meters",widthScale:{type:"number",min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},jointRounded:!1,capRounded:!1,miterLimit:{type:"number",min:0,value:4},billboard:!1,_pathType:null,getPath:{type:"accessor",value:e=>e.path},getColor:{type:"accessor",value:yY},getWidth:{type:"accessor",value:1},rounded:{deprecatedFor:["jointRounded","capRounded"]}},cO={enter:(e,t)=>t.length?t.subarray(t.length-e.length):e},a1=class extends $o{static{this.defaultProps=cxt}static{this.layerName="PathLayer"}getShaders(){return super.getShaders({vs:gY,fs:_Y,modules:[Al,gl]})}get wrapLongitude(){return!1}getBounds(){return this.getAttributeManager()?.getBounds(["vertexPositions"])}initializeState(){this.getAttributeManager().addInstanced({vertexPositions:{size:3,vertexOffset:1,type:"float64",fp64:this.use64bitPositions(),transition:cO,accessor:"getPath",update:this.calculatePositions,noAlloc:!0,shaderAttributes:{instanceLeftPositions:{vertexOffset:0},instanceStartPositions:{vertexOffset:1},instanceEndPositions:{vertexOffset:2},instanceRightPositions:{vertexOffset:3}}},instanceTypes:{size:1,type:"uint8",update:this.calculateSegmentTypes,noAlloc:!0},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:cO,defaultValue:1},instanceColors:{size:this.props.colorFormat.length,type:"unorm8",accessor:"getColor",transition:cO,defaultValue:yY},instancePickingColors:{size:4,type:"uint8",accessor:(i,{index:s,target:n})=>this.encodePickingColor(i&&i.__source?i.__source.index:s,n)}}),this.setState({pathTesselator:new Qw({fp64:this.use64bitPositions()})})}updateState(t){super.updateState(t);let{props:r,changeFlags:i}=t,s=this.getAttributeManager();if(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getPath)){let{pathTesselator:o}=this.state,a=r.data.attributes||{};o.updateGeometry({data:r.data,geometryBuffer:a.getPath,buffers:a,normalize:!r._pathType,loop:r._pathType==="loop",getGeometry:r.getPath,positionFormat:r.positionFormat,wrapLongitude:r.wrapLongitude,resolution:this.context.viewport.resolution,dataChanged:i.dataChanged}),this.setState({numInstances:o.instanceCount,startIndices:o.vertexStarts}),i.dataChanged||s.invalidateAll()}i.extensionsChanged&&(this.state.model?.destroy(),this.state.model=this._getModel(),s.invalidateAll())}getPickingInfo(t){let r=super.getPickingInfo(t),{index:i}=r,s=this.props.data;return s[0]&&s[0].__source&&(r.object=s.find(n=>n.__source.index===i)),r}disablePickingIndex(t){let r=this.props.data;if(r[0]&&r[0].__source)for(let i=0;i<r.length;i++)r[i].__source.index===t&&this._disablePickingIndex(i);else super.disablePickingIndex(t)}draw({uniforms:t}){let{jointRounded:r,capRounded:i,billboard:s,miterLimit:n,widthUnits:o,widthScale:a,widthMinPixels:h,widthMaxPixels:p}=this.props,g=this.state.model;g.setUniforms(t),g.setUniforms({jointType:Number(r),capType:Number(i),billboard:s,widthUnits:ml[o],widthScale:a,miterLimit:n,widthMinPixels:h,widthMaxPixels:p}),g.draw(this.context.renderPass)}_getModel(){let t=[0,1,2,1,4,2,1,3,4,3,5,4],r=[0,0,0,-1,0,1,1,-1,1,1,1,0];return new to(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new _l({topology:"triangle-list",attributes:{indices:new Uint16Array(t),positions:{value:new Float32Array(r),size:2}}}),isInstanced:!0})}calculatePositions(t){let{pathTesselator:r}=this.state;t.startIndices=r.vertexStarts,t.value=r.get("positions")}calculateSegmentTypes(t){let{pathTesselator:r}=this.state;t.startIndices=r.vertexStarts,t.value=r.get("segmentTypes")}};var CY=RR(TY(),1);var GE=c2.CLOCKWISE,SY=c2.COUNTER_CLOCKWISE,$m={isClosed:!0};function Sxt(e){if(e=e&&e.positions||e,!Array.isArray(e)&&!ArrayBuffer.isView(e))throw new Error("invalid polygon")}function f2(e){return"positions"in e?e.positions:e}function e3(e){return"holeIndices"in e?e.holeIndices:null}function Ext(e){return Array.isArray(e[0])}function Ixt(e){return e.length>=1&&e[0].length>=2&&Number.isFinite(e[0][0])}function Mxt(e){let t=e[0],r=e[e.length-1];return t[0]===r[0]&&t[1]===r[1]&&t[2]===r[2]}function Cxt(e,t,r,i){for(let s=0;s<t;s++)if(e[r+s]!==e[i-t+s])return!1;return!0}function EY(e,t,r,i,s){let n=t,o=r.length;for(let a=0;a<o;a++)for(let h=0;h<i;h++)e[n++]=r[a][h]||0;if(!Mxt(r))for(let a=0;a<i;a++)e[n++]=r[0][a]||0;return $m.start=t,$m.end=n,$m.size=i,o1(e,s,$m),n}function IY(e,t,r,i,s=0,n,o){n=n||r.length;let a=n-s;if(a<=0)return t;let h=t;for(let p=0;p<a;p++)e[h++]=r[s+p];if(!Cxt(r,i,s,n))for(let p=0;p<i;p++)e[h++]=r[s+p];return $m.start=t,$m.end=h,$m.size=i,o1(e,o,$m),h}function QE(e,t){Sxt(e);let r=[],i=[];if("positions"in e){let{positions:s,holeIndices:n}=e;if(n){let o=0;for(let a=0;a<=n.length;a++)o=IY(r,o,s,t,n[a-1],n[a],a===0?GE:SY),i.push(o);return i.pop(),{positions:r,holeIndices:i}}e=s}if(!Ext(e))return IY(r,0,e,t,0,r.length,GE),r;if(!Ixt(e)){let s=0;for(let[n,o]of e.entries())s=EY(r,s,o,t,n===0?GE:SY),i.push(s);return i.pop(),{positions:r,holeIndices:i}}return EY(r,0,e,t,GE),r}function dO(e,t,r){let i=e.length/3,s=0;for(let n=0;n<i;n++){let o=(n+1)%i;s+=e[n*3+t]*e[o*3+r],s-=e[o*3+t]*e[n*3+r]}return Math.abs(s/2)}function MY(e,t,r,i){let s=e.length/3;for(let n=0;n<s;n++){let o=n*3,a=e[o+0],h=e[o+1],p=e[o+2];e[o+t]=a,e[o+r]=h,e[o+i]=p}}function PY(e,t,r,i){let s=e3(e);s&&(s=s.map(a=>a/t));let n=f2(e),o=i&&t===3;if(r){let a=n.length;n=n.slice();let h=[];for(let p=0;p<a;p+=t){h[0]=n[p],h[1]=n[p+1],o&&(h[2]=n[p+2]);let g=r(h);n[p]=g[0],n[p+1]=g[1],o&&(n[p+2]=g[2])}}if(o){let a=dO(n,0,1),h=dO(n,0,2),p=dO(n,1,2);if(!a&&!h&&!p)return[];a>h&&a>p||(h>p?(r||(n=n.slice()),MY(n,0,2,1)):(r||(n=n.slice()),MY(n,2,0,1)))}return(0,CY.default)(n,s,t)}var r3=class extends jm{constructor(t){let{fp64:r,IndexType:i=Uint32Array}=t;super({...t,attributes:{positions:{size:3,type:r?Float64Array:Float32Array},vertexValid:{type:Uint16Array,size:1},indices:{type:i,size:1}}})}get(t){let{attributes:r}=this;return t==="indices"?r.indices&&r.indices.subarray(0,this.vertexCount):r[t]}updateGeometry(t){super.updateGeometry(t);let r=this.buffers.indices;if(r)this.vertexCount=(r.value||r).length;else if(this.data&&!this.getGeometry)throw new Error("missing indices buffer")}normalizeGeometry(t){if(this.normalize){let r=QE(t,this.positionSize);return this.opts.resolution?Zw(f2(r),e3(r),{size:this.positionSize,gridResolution:this.opts.resolution,edgeTypes:!0}):this.opts.wrapLongitude?aO(f2(r),e3(r),{size:this.positionSize,maxLatitude:86,edgeTypes:!0}):r}return t}getGeometrySize(t){if(kY(t)){let r=0;for(let i of t)r+=this.getGeometrySize(i);return r}return f2(t).length/this.positionSize}getGeometryFromBuffer(t){return this.normalize||!this.buffers.indices?super.getGeometryFromBuffer(t):null}updateGeometryAttributes(t,r){if(t&&kY(t))for(let i of t){let s=this.getGeometrySize(i);r.geometrySize=s,this.updateGeometryAttributes(i,r),r.vertexStart+=s,r.indexStart=this.indexStarts[r.geometryIndex+1]}else{let i=t;this._updateIndices(i,r),this._updatePositions(i,r),this._updateVertexValid(i,r)}}_updateIndices(t,{geometryIndex:r,vertexStart:i,indexStart:s}){let{attributes:n,indexStarts:o,typedArrayManager:a}=this,h=n.indices;if(!h||!t)return;let p=s,g=PY(t,this.positionSize,this.opts.preproject,this.opts.full3d);h=a.allocate(h,s+g.length,{copy:!0});for(let v=0;v<g.length;v++)h[p++]=g[v]+i;o[r+1]=s+g.length,n.indices=h}_updatePositions(t,{vertexStart:r,geometrySize:i}){let{attributes:{positions:s},positionSize:n}=this;if(!s||!t)return;let o=f2(t);for(let a=r,h=0;h<i;a++,h++){let p=o[h*n],g=o[h*n+1],v=n>2?o[h*n+2]:0;s[a*3]=p,s[a*3+1]=g,s[a*3+2]=v}}_updateVertexValid(t,{vertexStart:r,geometrySize:i}){let{positionSize:s}=this,n=this.attributes.vertexValid,o=t&&e3(t);if(t&&t.edgeTypes?n.set(t.edgeTypes,r):n.fill(1,r,r+i),o)for(let a=0;a<o.length;a++)n[r+o[a]/s-1]=0;n[r+i-1]=0}};function kY(e){return Array.isArray(e)&&e.length>0&&!Number.isFinite(e[0])}var KE=`uniform bool extruded;
uniform bool isWireframe;
uniform float elevationScale;
uniform float opacity;
in vec4 fillColors;
in vec4 lineColors;
in vec3 pickingColors;
out vec4 vColor;
struct PolygonProps {
vec3 positions;
vec3 positions64Low;
vec3 normal;
float elevations;
};
vec3 project_offset_normal(vec3 vector) {
if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {
return normalize(vector * project_uCommonUnitsPerWorldUnit);
}
return project_normal(vector);
}
void calculatePosition(PolygonProps props) {
vec3 pos = props.positions;
vec3 pos64Low = props.positions64Low;
vec3 normal = props.normal;
vec4 colors = isWireframe ? lineColors : fillColors;
geometry.worldPosition = props.positions;
geometry.pickingColor = pickingColors;
if (extruded) {
pos.z += props.elevations * elevationScale;
}
gl_Position = project_position_to_clipspace(pos, pos64Low, vec3(0.), geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
if (extruded) {
#ifdef IS_SIDE_VERTEX
normal = project_offset_normal(normal);
#else
normal = project_normal(normal);
#endif
geometry.normal = normal;
vec3 lightColor = lighting_getLightColor(colors.rgb, project_uCameraPosition, geometry.position.xyz, geometry.normal);
vColor = vec4(lightColor, colors.a * opacity);
} else {
vColor = vec4(colors.rgb, colors.a * opacity);
}
DECKGL_FILTER_COLOR(vColor, geometry);
}
`;var DY=`#version 300 es
#define SHADER_NAME solid-polygon-layer-vertex-shader
in vec3 vertexPositions;
in vec3 vertexPositions64Low;
in float elevations;
${KE}
void main(void) {
PolygonProps props;
props.positions = vertexPositions;
props.positions64Low = vertexPositions64Low;
props.elevations = elevations;
props.normal = vec3(0.0, 0.0, 1.0);
calculatePosition(props);
}
`;var OY=`#version 300 es
#define SHADER_NAME solid-polygon-layer-vertex-shader-side
#define IS_SIDE_VERTEX
in vec2 positions;
in vec3 vertexPositions;
in vec3 nextVertexPositions;
in vec3 vertexPositions64Low;
in vec3 nextVertexPositions64Low;
in float elevations;
in float instanceVertexValid;
${KE}
void main(void) {
if(instanceVertexValid < 0.5){
gl_Position = vec4(0.);
return;
}
PolygonProps props;
vec3 pos;
vec3 pos64Low;
vec3 nextPos;
vec3 nextPos64Low;
#if RING_WINDING_ORDER_CW == 1
pos = vertexPositions;
pos64Low = vertexPositions64Low;
nextPos = nextVertexPositions;
nextPos64Low = nextVertexPositions64Low;
#else
pos = nextVertexPositions;
pos64Low = nextVertexPositions64Low;
nextPos = vertexPositions;
nextPos64Low = vertexPositions64Low;
#endif
props.positions = mix(pos, nextPos, positions.x);
props.positions64Low = mix(pos64Low, nextPos64Low, positions.x);
props.normal = vec3(
pos.y - nextPos.y + (pos64Low.y - nextPos64Low.y),
nextPos.x - pos.x + (nextPos64Low.x - pos64Low.x),
0.0);
props.elevations = elevations * positions.y;
calculatePosition(props);
}
`;var BY=`#version 300 es
#define SHADER_NAME solid-polygon-layer-fragment-shader
precision highp float;
in vec4 vColor;
out vec4 fragColor;
void main(void) {
fragColor = vColor;
geometry.uv = vec2(0.);
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`;var t6=[0,0,0,255],Pxt={filled:!0,extruded:!1,wireframe:!1,_normalize:!0,_windingOrder:"CW",_full3d:!1,elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:e=>e.polygon},getElevation:{type:"accessor",value:1e3},getFillColor:{type:"accessor",value:t6},getLineColor:{type:"accessor",value:t6},material:!0},JE={enter:(e,t)=>t.length?t.subarray(t.length-e.length):e},c1=class extends $o{static{this.defaultProps=Pxt}static{this.layerName="SolidPolygonLayer"}getShaders(t){return super.getShaders({vs:t==="top"?DY:OY,fs:BY,defines:{RING_WINDING_ORDER_CW:!this.props._normalize&&this.props._windingOrder==="CCW"?0:1},modules:[Al,$g,gl]})}get wrapLongitude(){return!1}getBounds(){return this.getAttributeManager()?.getBounds(["vertexPositions"])}initializeState(){let{viewport:t}=this.context,{coordinateSystem:r}=this.props,{_full3d:i}=this.props;t.isGeospatial&&r===qi.DEFAULT&&(r=qi.LNGLAT);let s;r===qi.LNGLAT&&(i?s=t.projectPosition.bind(t):s=t.projectFlat.bind(t)),this.setState({numInstances:0,polygonTesselator:new r3({preproject:s,fp64:this.use64bitPositions(),IndexType:Uint32Array})});let n=this.getAttributeManager(),o=!0;n.remove(["instancePickingColors"]),n.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:o},vertexPositions:{size:3,type:"float64",stepMode:"dynamic",fp64:this.use64bitPositions(),transition:JE,accessor:"getPolygon",update:this.calculatePositions,noAlloc:o,shaderAttributes:{nextVertexPositions:{vertexOffset:1}}},instanceVertexValid:{size:1,type:"uint16",stepMode:"instance",update:this.calculateVertexValid,noAlloc:o},elevations:{size:1,stepMode:"dynamic",transition:JE,accessor:"getElevation"},fillColors:{size:this.props.colorFormat.length,type:"unorm8",stepMode:"dynamic",transition:JE,accessor:"getFillColor",defaultValue:t6},lineColors:{size:this.props.colorFormat.length,type:"unorm8",stepMode:"dynamic",transition:JE,accessor:"getLineColor",defaultValue:t6},pickingColors:{size:4,type:"uint8",stepMode:"dynamic",accessor:(a,{index:h,target:p})=>this.encodePickingColor(a&&a.__source?a.__source.index:h,p)}})}getPickingInfo(t){let r=super.getPickingInfo(t),{index:i}=r,s=this.props.data;return s[0]&&s[0].__source&&(r.object=s.find(n=>n.__source.index===i)),r}disablePickingIndex(t){let r=this.props.data;if(r[0]&&r[0].__source)for(let i=0;i<r.length;i++)r[i].__source.index===t&&this._disablePickingIndex(i);else super.disablePickingIndex(t)}draw({uniforms:t}){let{extruded:r,filled:i,wireframe:s,elevationScale:n}=this.props,{topModel:o,sideModel:a,wireframeModel:h,polygonTesselator:p}=this.state,g={...t,extruded:!!r,elevationScale:n};h&&s&&(h.setInstanceCount(p.instanceCount-1),h.setUniforms(g),h.draw(this.context.renderPass)),a&&i&&(a.setInstanceCount(p.instanceCount-1),a.setUniforms(g),a.draw(this.context.renderPass)),o&&i&&(o.setVertexCount(p.vertexCount),o.setUniforms(g),o.draw(this.context.renderPass))}updateState(t){super.updateState(t),this.updateGeometry(t);let{props:r,oldProps:i,changeFlags:s}=t,n=this.getAttributeManager();(s.extensionsChanged||r.filled!==i.filled||r.extruded!==i.extruded)&&(this.state.models?.forEach(a=>a.destroy()),this.setState(this._getModels()),n.invalidateAll())}updateGeometry({props:t,oldProps:r,changeFlags:i}){if(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getPolygon)){let{polygonTesselator:n}=this.state,o=t.data.attributes||{};n.updateGeometry({data:t.data,normalize:t._normalize,geometryBuffer:o.getPolygon,buffers:o,getGeometry:t.getPolygon,positionFormat:t.positionFormat,wrapLongitude:t.wrapLongitude,resolution:this.context.viewport.resolution,fp64:this.use64bitPositions(),dataChanged:i.dataChanged,full3d:t._full3d}),this.setState({numInstances:n.instanceCount,startIndices:n.vertexStarts}),i.dataChanged||this.getAttributeManager().invalidateAll()}}_getModels(){let{id:t,filled:r,extruded:i}=this.props,s,n,o;if(r){let a=this.getShaders("top");a.defines.NON_INSTANCED_MODEL=1;let h=this.getAttributeManager().getBufferLayouts({isInstanced:!1});s=new to(this.context.device,{...a,id:`${t}-top`,topology:"triangle-list",uniforms:{isWireframe:!1},bufferLayout:h,isIndexed:!0,userData:{excludeAttributes:{instanceVertexValid:!0}}})}if(i){let a=this.getAttributeManager().getBufferLayouts({isInstanced:!0});n=new to(this.context.device,{...this.getShaders("side"),id:`${t}-side`,bufferLayout:a,uniforms:{isWireframe:!1},geometry:new _l({topology:"triangle-strip",attributes:{positions:{size:2,value:new Float32Array([1,0,0,0,1,1,0,1])}}}),isInstanced:!0,userData:{excludeAttributes:{indices:!0}}}),o=new to(this.context.device,{...this.getShaders("side"),id:`${t}-wireframe`,bufferLayout:a,uniforms:{isWireframe:!0},geometry:new _l({topology:"line-strip",attributes:{positions:{size:2,value:new Float32Array([1,0,0,0,0,1,1,1])}}}),isInstanced:!0,userData:{excludeAttributes:{indices:!0}}})}return{models:[n,o,s].filter(Boolean),topModel:s,sideModel:n,wireframeModel:o}}calculateIndices(t){let{polygonTesselator:r}=this.state;t.startIndices=r.indexStarts,t.value=r.get("indices")}calculatePositions(t){let{polygonTesselator:r}=this.state;t.startIndices=r.vertexStarts,t.value=r.get("positions")}calculateVertexValid(t){t.value=this.state.polygonTesselator.get("vertexValid")}};function e6({data:e,getIndex:t,dataRange:r,replace:i}){let{startRow:s=0,endRow:n=1/0}=r,o=e.length,a=o,h=o;for(let T=0;T<o;T++){let C=t(e[T]);if(a>T&&C>=s&&(a=T),C>=n){h=T;break}}let p=a,v=h-a!==i.length?e.slice(h):void 0;for(let T=0;T<i.length;T++)e[p++]=i[T];if(v){for(let T=0;T<v.length;T++)e[p++]=v[T];e.length=p}return{startRow:a,endRow:a+i.length}}var NY=[0,0,0,255],Rxt=[0,0,0,255],kxt={stroked:!0,filled:!0,extruded:!1,elevationScale:1,wireframe:!1,_normalize:!0,_windingOrder:"CW",lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,lineJointRounded:!1,lineMiterLimit:4,getPolygon:{type:"accessor",value:e=>e.polygon},getFillColor:{type:"accessor",value:Rxt},getLineColor:{type:"accessor",value:NY},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0},u1=class extends Sc{static{this.layerName="PolygonLayer"}static{this.defaultProps=kxt}initializeState(){this.state={paths:[],pathsDiff:null},this.props.getLineDashArray&&Ir.removed("getLineDashArray","PathStyleExtension")()}updateState({changeFlags:t}){let r=t.dataChanged||t.updateTriggersChanged&&(t.updateTriggersChanged.all||t.updateTriggersChanged.getPolygon);if(r&&Array.isArray(t.dataChanged)){let i=this.state.paths.slice(),s=t.dataChanged.map(n=>e6({data:i,getIndex:o=>o.__source.index,dataRange:n,replace:this._getPaths(n)}));this.setState({paths:i,pathsDiff:s})}else r&&this.setState({paths:this._getPaths(),pathsDiff:null})}_getPaths(t={}){let{data:r,getPolygon:i,positionFormat:s,_normalize:n}=this.props,o=[],a=s==="XY"?2:3,{startRow:h,endRow:p}=t,{iterable:g,objectInfo:v}=hu(r,h,p);for(let T of g){v.index++;let C=i(T,v);n&&(C=QE(C,a));let{holeIndices:B}=C,L=C.positions||C;if(B)for(let z=0;z<=B.length;z++){let W=L.slice(B[z-1]||0,B[z]||L.length);o.push(this.getSubLayerRow({path:W},T,v.index))}else o.push(this.getSubLayerRow({path:L},T,v.index))}return o}renderLayers(){let{data:t,_dataDiff:r,stroked:i,filled:s,extruded:n,wireframe:o,_normalize:a,_windingOrder:h,elevationScale:p,transitions:g,positionFormat:v}=this.props,{lineWidthUnits:T,lineWidthScale:C,lineWidthMinPixels:B,lineWidthMaxPixels:L,lineJointRounded:z,lineMiterLimit:W,lineDashJustified:Z}=this.props,{getFillColor:X,getLineColor:q,getLineWidth:it,getLineDashArray:nt,getElevation:Mt,getPolygon:_t,updateTriggers:Et,material:vt}=this.props,{paths:Pt,pathsDiff:re}=this.state,$t=this.getSubLayerClass("fill",c1),xt=this.getSubLayerClass("stroke",a1),Vt=this.shouldRenderSubLayer("fill",Pt)&&new $t({_dataDiff:r,extruded:n,elevationScale:p,filled:s,wireframe:o,_normalize:a,_windingOrder:h,getElevation:Mt,getFillColor:X,getLineColor:n&&o?q:NY,material:vt,transitions:g},this.getSubLayerProps({id:"fill",updateTriggers:Et&&{getPolygon:Et.getPolygon,getElevation:Et.getElevation,getFillColor:Et.getFillColor,lineColors:n&&o,getLineColor:Et.getLineColor}}),{data:t,positionFormat:v,getPolygon:_t}),qt=!n&&i&&this.shouldRenderSubLayer("stroke",Pt)&&new xt({_dataDiff:re&&(()=>re),widthUnits:T,widthScale:C,widthMinPixels:B,widthMaxPixels:L,jointRounded:z,miterLimit:W,dashJustified:Z,_pathType:"loop",transitions:g&&{getWidth:g.getLineWidth,getColor:g.getLineColor,getPath:g.getPolygon},getColor:this.getSubLayerAccessor(q),getWidth:this.getSubLayerAccessor(it),getDashArray:this.getSubLayerAccessor(nt)},this.getSubLayerProps({id:"stroke",updateTriggers:Et&&{getWidth:Et.getLineWidth,getColor:Et.getLineColor,getDashArray:Et.getLineDashArray}}),{data:Pt,positionFormat:v,getPath:de=>de.path});return[!n&&Vt,qt,n&&Vt]}};function LY(e,t){if(!e)return null;let r="startIndices"in e?e.startIndices[t]:t,i=e.featureIds.value[r];return r!==-1?Dxt(e,i,r):null}function Dxt(e,t,r){let i={properties:{...e.properties[t]}};for(let s in e.numericProps)i.properties[s]=e.numericProps[s].value[r];return i}function FY(e,t){let r={points:null,lines:null,polygons:null};for(let i in r){let s=e[i].globalFeatureIds.value;r[i]=new Uint8ClampedArray(s.length*3);let n=[];for(let o=0;o<s.length;o++)t(s[o],n),r[i][o*3+0]=n[0],r[i][o*3+1]=n[1],r[i][o*3+2]=n[2]}return r}var zY=`#version 300 es
#define SHADER_NAME multi-icon-layer-fragment-shader
precision highp float;
uniform float opacity;
uniform sampler2D iconsTexture;
uniform float gamma;
uniform bool sdf;
uniform float alphaCutoff;
uniform float sdfBuffer;
uniform float outlineBuffer;
uniform vec4 outlineColor;
in vec4 vColor;
in vec2 vTextureCoords;
in vec2 uv;
out vec4 fragColor;
void main(void) {
geometry.uv = uv;
if (!bool(picking.isActive)) {
float alpha = texture(iconsTexture, vTextureCoords).a;
vec4 color = vColor;
if (sdf) {
float distance = alpha;
alpha = smoothstep(sdfBuffer - gamma, sdfBuffer + gamma, distance);
if (outlineBuffer > 0.0) {
float inFill = alpha;
float inBorder = smoothstep(outlineBuffer - gamma, outlineBuffer + gamma, distance);
color = mix(outlineColor, vColor, inFill);
alpha = inBorder;
}
}
float a = alpha * color.a;
if (a < alphaCutoff) {
discard;
}
fragColor = vec4(color.rgb, a * opacity);
}
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`;var mO=192/256,UY=[],Oxt={getIconOffsets:{type:"accessor",value:e=>e.offsets},alphaCutoff:.001,smoothing:.1,outlineWidth:0,outlineColor:{type:"color",value:[0,0,0,255]}},i3=class extends s1{static{this.defaultProps=Oxt}static{this.layerName="MultiIconLayer"}getShaders(){return{...super.getShaders(),fs:zY}}initializeState(){super.initializeState(),this.getAttributeManager().addInstanced({instanceOffsets:{size:2,accessor:"getIconOffsets"},instancePickingColors:{type:"uint8",size:3,accessor:(r,{index:i,target:s})=>this.encodePickingColor(i,s)}})}updateState(t){super.updateState(t);let{props:r,oldProps:i}=t,{outlineColor:s}=r;s!==i.outlineColor&&(s=s.map(n=>n/255),s[3]=Number.isFinite(s[3])?s[3]:1,this.setState({outlineColor:s})),!r.sdf&&r.outlineWidth&&Ir.warn(`${this.id}: fontSettings.sdf is required to render outline`)()}draw(t){let{sdf:r,smoothing:i,outlineWidth:s}=this.props,{outlineColor:n}=this.state,o=s?Math.max(i,mO*(1-s)):-1;if(t.uniforms={...t.uniforms,sdfBuffer:mO,outlineBuffer:o,gamma:i,sdf:!!r,outlineColor:n},super.draw(t),r&&s){let{iconManager:a}=this.state,h=a.getTexture(),p=this.state.model;h&&(p.setUniforms({outlineBuffer:mO}),p.draw(this.context.renderPass))}}getInstanceOffset(t){return t?Array.from(t).flatMap(r=>super.getInstanceOffset(r)):UY}getInstanceColorMode(t){return 1}getInstanceIconFrame(t){return t?Array.from(t).flatMap(r=>super.getInstanceIconFrame(r)):UY}};var n3=class{constructor({fontSize:t=24,buffer:r=3,radius:i=8,cutoff:s=.25,fontFamily:n="sans-serif",fontWeight:o="normal",fontStyle:a="normal"}={}){this.buffer=r,this.cutoff=s,this.radius=i;let h=this.size=t+r*4,p=this._createCanvas(h),g=this.ctx=p.getContext("2d",{willReadFrequently:!0});g.font=`${a} ${o} ${t}px ${n}`,g.textBaseline="alphabetic",g.textAlign="left",g.fillStyle="black",this.gridOuter=new Float64Array(h*h),this.gridInner=new Float64Array(h*h),this.f=new Float64Array(h),this.z=new Float64Array(h+1),this.v=new Uint16Array(h)}_createCanvas(t){let r=document.createElement("canvas");return r.width=r.height=t,r}draw(t){let{width:r,actualBoundingBoxAscent:i,actualBoundingBoxDescent:s,actualBoundingBoxLeft:n,actualBoundingBoxRight:o}=this.ctx.measureText(t),a=Math.ceil(i),h=0,p=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(o-n))),g=Math.min(this.size-this.buffer,a+Math.ceil(s)),v=p+2*this.buffer,T=g+2*this.buffer,C=Math.max(v*T,0),B=new Uint8ClampedArray(C),L={data:B,width:v,height:T,glyphWidth:p,glyphHeight:g,glyphTop:a,glyphLeft:h,glyphAdvance:r};if(p===0||g===0)return L;let{ctx:z,buffer:W,gridInner:Z,gridOuter:X}=this;z.clearRect(W,W,p,g),z.fillText(t,W,W+a);let q=z.getImageData(W,W,p,g);X.fill(1e20,0,C),Z.fill(0,0,C);for(let it=0;it<g;it++)for(let nt=0;nt<p;nt++){let Mt=q.data[4*(it*p+nt)+3]/255;if(Mt===0)continue;let _t=(it+W)*v+nt+W;if(Mt===1)X[_t]=0,Z[_t]=1e20;else{let Et=.5-Mt;X[_t]=Et>0?Et*Et:0,Z[_t]=Et<0?Et*Et:0}}VY(X,0,0,v,T,v,this.f,this.v,this.z),VY(Z,W,W,p,g,v,this.f,this.v,this.z);for(let it=0;it<C;it++){let nt=Math.sqrt(X[it])-Math.sqrt(Z[it]);B[it]=Math.round(255-255*(nt/this.radius+this.cutoff))}return L}};function VY(e,t,r,i,s,n,o,a,h){for(let p=t;p<t+i;p++)jY(e,r*n+p,n,s,o,a,h);for(let p=r;p<r+s;p++)jY(e,p*n+t,1,i,o,a,h)}function jY(e,t,r,i,s,n,o){n[0]=0,o[0]=-1e20,o[1]=1e20,s[0]=e[t];for(let a=1,h=0,p=0;a<i;a++){s[a]=e[t+a*r];let g=a*a;do{let v=n[h];p=(s[a]-s[v]+g-v*v)/(a-v)/2}while(p<=o[h]&&--h>-1);h++,n[h]=a,o[h]=p,o[h+1]=1e20}for(let a=0,h=0;a<i;a++){for(;o[h+1]<a;)h++;let p=n[h],g=a-p;e[t+a*r]=s[p]+g*g}}var Bxt=32,Nxt=[];function Lxt(e){return Math.pow(2,Math.ceil(Math.log2(e)))}function WY({characterSet:e,getFontWidth:t,fontHeight:r,buffer:i,maxCanvasWidth:s,mapping:n={},xOffset:o=0,yOffset:a=0}){let h=0,p=o,g=r+i*2;for(let v of e)if(!n[v]){let T=t(v);p+T+i*2>s&&(p=0,h++),n[v]={x:p+i,y:a+h*g+i,width:T,height:g,layoutWidth:T,layoutHeight:r},p+=T+i*2}return{mapping:n,xOffset:p,yOffset:a+h*g,canvasHeight:Lxt(a+(h+1)*g)}}function $Y(e,t,r,i){let s=0;for(let n=t;n<r;n++){let o=e[n];s+=i[o]?.layoutWidth||0}return s}function HY(e,t,r,i,s,n){let o=t,a=0;for(let h=t;h<r;h++){let p=$Y(e,h,h+1,s);a+p>i&&(o<h&&n.push(h),o=h,a=0),a+=p}return a}function Fxt(e,t,r,i,s,n){let o=t,a=t,h=t,p=0;for(let g=t;g<r;g++)if((e[g]===" "||e[g+1]===" "||g+1===r)&&(h=g+1),h>a){let v=$Y(e,a,h,s);p+v>i&&(o<a&&(n.push(a),o=a,p=0),v>i&&(v=HY(e,a,h,i,s,n),o=n[n.length-1])),a=h,p+=v}return p}function zxt(e,t,r,i,s=0,n){n===void 0&&(n=e.length);let o=[];return t==="break-all"?HY(e,s,n,r,i,o):Fxt(e,s,n,r,i,o),o}function Uxt(e,t,r,i,s,n){let o=0,a=0;for(let h=t;h<r;h++){let p=e[h],g=i[p];g?(a||(a=g.layoutHeight),s[h]=o+g.layoutWidth/2,o+=g.layoutWidth):(Ir.warn(`Missing character: ${p} (${p.codePointAt(0)})`)(),s[h]=o,o+=Bxt)}n[0]=o,n[1]=a}function qY(e,t,r,i,s){let n=Array.from(e),o=n.length,a=new Array(o),h=new Array(o),p=new Array(o),g=(r==="break-word"||r==="break-all")&&isFinite(i)&&i>0,v=[0,0],T=[0,0],C=0,B=0,L=0;for(let z=0;z<=o;z++){let W=n[z];if((W===`
`||z===o)&&(L=z),L>B){let Z=g?zxt(n,r,i,s,B,L):Nxt;for(let X=0;X<=Z.length;X++){let q=X===0?B:Z[X-1],it=X<Z.length?Z[X]:L;Uxt(n,q,it,s,a,T);for(let nt=q;nt<it;nt++){let Mt=n[nt],_t=s[Mt]?.layoutOffsetY||0;h[nt]=C+T[1]/2+_t,p[nt]=T[0]}C=C+T[1]*t,v[0]=Math.max(v[0],T[0])}B=L}W===`
`&&(a[B]=0,h[B]=0,p[B]=0,B++)}return v[1]=C,{x:a,y:h,rowWidth:p,size:v}}function YY({value:e,length:t,stride:r,offset:i,startIndices:s,characterSet:n}){let o=e.BYTES_PER_ELEMENT,a=r?r/o:1,h=i?i/o:0,p=s[t]||Math.ceil((e.length-h)/a),g=n&&new Set,v=new Array(t),T=e;if(a>1||h>0){let C=e.constructor;T=new C(p);for(let B=0;B<p;B++)T[B]=e[B*a+h]}for(let C=0;C<t;C++){let B=s[C],L=s[C+1]||p,z=T.subarray(B,L);v[C]=String.fromCodePoint.apply(null,z),g&&z.forEach(g.add,g)}if(g)for(let C of g)n.add(String.fromCodePoint(C));return{texts:v,characterCount:p}}var p2=class{constructor(t=5){this._cache={},this._order=[],this.limit=t}get(t){let r=this._cache[t];return r&&(this._deleteOrder(t),this._appendOrder(t)),r}set(t,r){this._cache[t]?(this.delete(t),this._cache[t]=r,this._appendOrder(t)):(Object.keys(this._cache).length===this.limit&&this.delete(this._order[0]),this._cache[t]=r,this._appendOrder(t))}delete(t){this._cache[t]&&(delete this._cache[t],this._deleteOrder(t))}_deleteOrder(t){let r=this._order.indexOf(t);r>=0&&this._order.splice(r,1)}_appendOrder(t){this._order.push(t)}};function Vxt(){let e=[];for(let t=32;t<128;t++)e.push(String.fromCharCode(t));return e}var h1={fontFamily:"Monaco, monospace",fontWeight:"normal",characterSet:Vxt(),fontSize:64,buffer:4,sdf:!1,cutoff:.25,radius:12,smoothing:.1},XY=1024,ZY=.9,GY=1.2,KY=3,r6=new p2(KY);function jxt(e,t){let r;typeof t=="string"?r=new Set(Array.from(t)):r=new Set(t);let i=r6.get(e);if(!i)return r;for(let s in i.mapping)r.has(s)&&r.delete(s);return r}function Wxt(e,t){for(let r=0;r<e.length;r++)t.data[4*r+3]=e[r]}function QY(e,t,r,i){e.font=`${i} ${r}px ${t}`,e.fillStyle="#000",e.textBaseline="alphabetic",e.textAlign="left"}function JY(e){Ir.assert(Number.isFinite(e)&&e>=KY,"Invalid cache limit"),r6=new p2(e)}var s3=class{constructor(){this.props={...h1}}get atlas(){return this._atlas}get mapping(){return this._atlas&&this._atlas.mapping}get scale(){let{fontSize:t,buffer:r}=this.props;return(t*GY+r*2)/t}setProps(t={}){Object.assign(this.props,t),this._key=this._getKey();let r=jxt(this._key,this.props.characterSet),i=r6.get(this._key);if(i&&r.size===0){this._atlas!==i&&(this._atlas=i);return}let s=this._generateFontAtlas(r,i);this._atlas=s,r6.set(this._key,s)}_generateFontAtlas(t,r){let{fontFamily:i,fontWeight:s,fontSize:n,buffer:o,sdf:a,radius:h,cutoff:p}=this.props,g=r&&r.data;g||(g=document.createElement("canvas"),g.width=XY);let v=g.getContext("2d",{willReadFrequently:!0});QY(v,i,n,s);let{mapping:T,canvasHeight:C,xOffset:B,yOffset:L}=WY({getFontWidth:z=>v.measureText(z).width,fontHeight:n*GY,buffer:o,characterSet:t,maxCanvasWidth:XY,...r&&{mapping:r.mapping,xOffset:r.xOffset,yOffset:r.yOffset}});if(g.height!==C){let z=v.getImageData(0,0,g.width,g.height);g.height=C,v.putImageData(z,0,0)}if(QY(v,i,n,s),a){let z=new n3({fontSize:n,buffer:o,radius:h,cutoff:p,fontFamily:i,fontWeight:`${s}`});for(let W of t){let{data:Z,width:X,height:q,glyphTop:it}=z.draw(W);T[W].width=X,T[W].layoutOffsetY=n*ZY-it;let nt=v.createImageData(X,q);Wxt(Z,nt),v.putImageData(nt,T[W].x,T[W].y)}}else for(let z of t)v.fillText(z,T[z].x,T[z].y+o+n*ZY);return{xOffset:B,yOffset:L,mapping:T,data:g,width:g.width,height:g.height}}_getKey(){let{fontFamily:t,fontWeight:r,fontSize:i,buffer:s,sdf:n,radius:o,cutoff:a}=this.props;return n?`${t} ${r} ${i} ${s} ${o} ${a}`:`${t} ${r} ${i} ${s}`}};var tX=`#version 300 es
#define SHADER_NAME text-background-layer-vertex-shader
in vec2 positions;
in vec3 instancePositions;
in vec3 instancePositions64Low;
in vec4 instanceRects;
in float instanceSizes;
in float instanceAngles;
in vec2 instancePixelOffsets;
in float instanceLineWidths;
in vec4 instanceFillColors;
in vec4 instanceLineColors;
in vec3 instancePickingColors;
uniform bool billboard;
uniform float opacity;
uniform float sizeScale;
uniform float sizeMinPixels;
uniform float sizeMaxPixels;
uniform vec4 padding;
uniform int sizeUnits;
out vec4 vFillColor;
out vec4 vLineColor;
out float vLineWidth;
out vec2 uv;
out vec2 dimensions;
vec2 rotate_by_angle(vec2 vertex, float angle) {
float angle_radian = radians(angle);
float cos_angle = cos(angle_radian);
float sin_angle = sin(angle_radian);
mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);
return rotationMatrix * vertex;
}
void main(void) {
geometry.worldPosition = instancePositions;
geometry.uv = positions;
geometry.pickingColor = instancePickingColors;
uv = positions;
vLineWidth = instanceLineWidths;
float sizePixels = clamp(
project_size_to_pixel(instanceSizes * sizeScale, sizeUnits),
sizeMinPixels, sizeMaxPixels
);
dimensions = instanceRects.zw * sizePixels + padding.xy + padding.zw;
vec2 pixelOffset = (positions * instanceRects.zw + instanceRects.xy) * sizePixels + mix(-padding.xy, padding.zw, positions);
pixelOffset = rotate_by_angle(pixelOffset, instanceAngles);
pixelOffset += instancePixelOffsets;
pixelOffset.y *= -1.0;
if (billboard)  {
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
vec3 offset = vec3(pixelOffset, 0.0);
DECKGL_FILTER_SIZE(offset, geometry);
gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
} else {
vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);
DECKGL_FILTER_SIZE(offset_common, geometry);
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
}
vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);
DECKGL_FILTER_COLOR(vFillColor, geometry);
vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);
DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`;var eX=`#version 300 es
#define SHADER_NAME text-background-layer-fragment-shader
precision highp float;
uniform bool stroked;
in vec4 vFillColor;
in vec4 vLineColor;
in float vLineWidth;
in vec2 uv;
in vec2 dimensions;
out vec4 fragColor;
void main(void) {
geometry.uv = uv;
vec2 pixelPosition = uv * dimensions;
if (stroked) {
float distToEdge = min(
min(pixelPosition.x, dimensions.x - pixelPosition.x),
min(pixelPosition.y, dimensions.y - pixelPosition.y)
);
float isBorder = smoothedge(distToEdge, vLineWidth);
fragColor = mix(vFillColor, vLineColor, isBorder);
} else {
fragColor = vFillColor;
}
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`;var $xt={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,padding:{type:"array",value:[0,0,0,0]},getPosition:{type:"accessor",value:e=>e.position},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},getBoundingRect:{type:"accessor",value:[0,0,0,0]},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1}},o3=class extends $o{static{this.defaultProps=$xt}static{this.layerName="TextBackgroundLayer"}getShaders(){return super.getShaders({vs:tX,fs:eX,modules:[Al,gl]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instanceRects:{size:4,accessor:"getBoundingRect"},instancePixelOffsets:{size:2,transition:!0,accessor:"getPixelOffset"},instanceFillColors:{size:4,transition:!0,type:"unorm8",accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:4,transition:!0,type:"unorm8",accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(t){super.updateState(t);let{changeFlags:r}=t;r.extensionsChanged&&(this.state.model?.destroy(),this.state.model=this._getModel(),this.getAttributeManager().invalidateAll())}draw({uniforms:t}){let{billboard:r,sizeScale:i,sizeUnits:s,sizeMinPixels:n,sizeMaxPixels:o,getLineWidth:a}=this.props,{padding:h}=this.props;h.length<4&&(h=[h[0],h[1],h[0],h[1]]);let p=this.state.model;p.setUniforms(t),p.setUniforms({billboard:r,stroked:!!a,padding:h,sizeUnits:ml[s],sizeScale:i,sizeMinPixels:n,sizeMaxPixels:o}),p.draw(this.context.renderPass)}_getModel(){let t=[0,0,1,0,1,1,0,1];return new to(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new _l({topology:"triangle-fan-webgl",vertexCount:4,attributes:{positions:{size:2,value:new Float32Array(t)}}}),isInstanced:!0})}};var rX={start:1,middle:0,end:-1},iX={top:1,center:0,bottom:-1},AO=[0,0,0,255],Hxt=1,qxt={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,background:!1,getBackgroundColor:{type:"accessor",value:[255,255,255,255]},getBorderColor:{type:"accessor",value:AO},getBorderWidth:{type:"accessor",value:0},backgroundPadding:{type:"array",value:[0,0,0,0]},characterSet:{type:"object",value:h1.characterSet},fontFamily:h1.fontFamily,fontWeight:h1.fontWeight,lineHeight:Hxt,outlineWidth:{type:"number",value:0,min:0},outlineColor:{type:"color",value:AO},fontSettings:{type:"object",value:{},compare:1},wordBreak:"break-word",maxWidth:{type:"number",value:-1},getText:{type:"accessor",value:e=>e.text},getPosition:{type:"accessor",value:e=>e.position},getColor:{type:"accessor",value:AO},getSize:{type:"accessor",value:32},getAngle:{type:"accessor",value:0},getTextAnchor:{type:"accessor",value:"middle"},getAlignmentBaseline:{type:"accessor",value:"center"},getPixelOffset:{type:"accessor",value:[0,0]},backgroundColor:{deprecatedFor:["background","getBackgroundColor"]}},a3=class extends Sc{constructor(){super(...arguments),this.getBoundingRect=(t,r)=>{let{size:[i,s]}=this.transformParagraph(t,r),{fontSize:n}=this.state.fontAtlasManager.props;i/=n,s/=n;let{getTextAnchor:o,getAlignmentBaseline:a}=this.props,h=rX[typeof o=="function"?o(t,r):o],p=iX[typeof a=="function"?a(t,r):a];return[(h-1)*i/2,(p-1)*s/2,i,s]},this.getIconOffsets=(t,r)=>{let{getTextAnchor:i,getAlignmentBaseline:s}=this.props,{x:n,y:o,rowWidth:a,size:[h,p]}=this.transformParagraph(t,r),g=rX[typeof i=="function"?i(t,r):i],v=iX[typeof s=="function"?s(t,r):s],T=n.length,C=new Array(T*2),B=0;for(let L=0;L<T;L++){let z=(1-g)*(h-a[L])/2;C[B++]=(g-1)*h/2+z+n[L],C[B++]=(v-1)*p/2+o[L]}return C}}static{this.defaultProps=qxt}static{this.layerName="TextLayer"}initializeState(){this.state={styleVersion:0,fontAtlasManager:new s3},this.props.maxWidth>0&&Ir.warn("v8.9 breaking change: TextLayer maxWidth is now relative to text size")()}updateState(t){let{props:r,oldProps:i,changeFlags:s}=t;(s.dataChanged||s.updateTriggersChanged&&(s.updateTriggersChanged.all||s.updateTriggersChanged.getText))&&this._updateText(),(this._updateFontAtlas()||r.lineHeight!==i.lineHeight||r.wordBreak!==i.wordBreak||r.maxWidth!==i.maxWidth)&&this.setState({styleVersion:this.state.styleVersion+1})}getPickingInfo({info:t}){return t.object=t.index>=0?this.props.data[t.index]:null,t}_updateFontAtlas(){let{fontSettings:t,fontFamily:r,fontWeight:i}=this.props,{fontAtlasManager:s,characterSet:n}=this.state,o={...t,characterSet:n,fontFamily:r,fontWeight:i};if(!s.mapping)return s.setProps(o),!0;for(let a in o)if(o[a]!==s.props[a])return s.setProps(o),!0;return!1}_updateText(){let{data:t,characterSet:r}=this.props,i=t.attributes?.getText,{getText:s}=this.props,n=t.startIndices,o,a=r==="auto"&&new Set;if(i&&n){let{texts:h,characterCount:p}=YY({...ArrayBuffer.isView(i)?{value:i}:i,length:t.length,startIndices:n,characterSet:a});o=p,s=(g,{index:v})=>h[v]}else{let{iterable:h,objectInfo:p}=hu(t);n=[0],o=0;for(let g of h){p.index++;let v=Array.from(s(g,p)||"");a&&v.forEach(a.add,a),o+=v.length,n.push(o)}}this.setState({getText:s,startIndices:n,numInstances:o,characterSet:a||r})}transformParagraph(t,r){let{fontAtlasManager:i}=this.state,s=i.mapping,n=this.state.getText,{wordBreak:o,lineHeight:a,maxWidth:h}=this.props,p=n(t,r)||"";return qY(p,a,o,h*i.props.fontSize,s)}renderLayers(){let{startIndices:t,numInstances:r,getText:i,fontAtlasManager:{scale:s,atlas:n,mapping:o},styleVersion:a}=this.state,{data:h,_dataDiff:p,getPosition:g,getColor:v,getSize:T,getAngle:C,getPixelOffset:B,getBackgroundColor:L,getBorderColor:z,getBorderWidth:W,backgroundPadding:Z,background:X,billboard:q,fontSettings:it,outlineWidth:nt,outlineColor:Mt,sizeScale:_t,sizeUnits:Et,sizeMinPixels:vt,sizeMaxPixels:Pt,transitions:re,updateTriggers:$t}=this.props,xt=this.getSubLayerClass("characters",i3),Vt=this.getSubLayerClass("background",o3);return[X&&new Vt({getFillColor:L,getLineColor:z,getLineWidth:W,padding:Z,getPosition:g,getSize:T,getAngle:C,getPixelOffset:B,billboard:q,sizeScale:_t,sizeUnits:Et,sizeMinPixels:vt,sizeMaxPixels:Pt,transitions:re&&{getPosition:re.getPosition,getAngle:re.getAngle,getSize:re.getSize,getFillColor:re.getBackgroundColor,getLineColor:re.getBorderColor,getLineWidth:re.getBorderWidth,getPixelOffset:re.getPixelOffset}},this.getSubLayerProps({id:"background",updateTriggers:{getPosition:$t.getPosition,getAngle:$t.getAngle,getSize:$t.getSize,getFillColor:$t.getBackgroundColor,getLineColor:$t.getBorderColor,getLineWidth:$t.getBorderWidth,getPixelOffset:$t.getPixelOffset,getBoundingRect:{getText:$t.getText,getTextAnchor:$t.getTextAnchor,getAlignmentBaseline:$t.getAlignmentBaseline,styleVersion:a}}}),{data:h.attributes&&h.attributes.background?{length:h.length,attributes:h.attributes.background}:h,_dataDiff:p,autoHighlight:!1,getBoundingRect:this.getBoundingRect}),new xt({sdf:it.sdf,smoothing:Number.isFinite(it.smoothing)?it.smoothing:h1.smoothing,outlineWidth:nt/(it.radius||h1.radius),outlineColor:Mt,iconAtlas:n,iconMapping:o,getPosition:g,getColor:v,getSize:T,getAngle:C,getPixelOffset:B,billboard:q,sizeScale:_t*s,sizeUnits:Et,sizeMinPixels:vt*s,sizeMaxPixels:Pt*s,transitions:re&&{getPosition:re.getPosition,getAngle:re.getAngle,getColor:re.getColor,getSize:re.getSize,getPixelOffset:re.getPixelOffset}},this.getSubLayerProps({id:"characters",updateTriggers:{all:$t.getText,getPosition:$t.getPosition,getAngle:$t.getAngle,getColor:$t.getColor,getSize:$t.getSize,getPixelOffset:$t.getPixelOffset,getIconOffsets:{getTextAnchor:$t.getTextAnchor,getAlignmentBaseline:$t.getAlignmentBaseline,styleVersion:a}}}),{data:h,_dataDiff:p,startIndices:t,numInstances:r,getIconOffsets:this.getIconOffsets,getIcon:i})]}static set fontAtlasCacheLimit(t){JY(t)}};var l3={circle:{type:Hw,props:{filled:"filled",stroked:"stroked",lineWidthMaxPixels:"lineWidthMaxPixels",lineWidthMinPixels:"lineWidthMinPixels",lineWidthScale:"lineWidthScale",lineWidthUnits:"lineWidthUnits",pointRadiusMaxPixels:"radiusMaxPixels",pointRadiusMinPixels:"radiusMinPixels",pointRadiusScale:"radiusScale",pointRadiusUnits:"radiusUnits",pointAntialiasing:"antialiasing",pointBillboard:"billboard",getFillColor:"getFillColor",getLineColor:"getLineColor",getLineWidth:"getLineWidth",getPointRadius:"getRadius"}},icon:{type:s1,props:{iconAtlas:"iconAtlas",iconMapping:"iconMapping",iconSizeMaxPixels:"sizeMaxPixels",iconSizeMinPixels:"sizeMinPixels",iconSizeScale:"sizeScale",iconSizeUnits:"sizeUnits",iconAlphaCutoff:"alphaCutoff",iconBillboard:"billboard",getIcon:"getIcon",getIconAngle:"getAngle",getIconColor:"getColor",getIconPixelOffset:"getPixelOffset",getIconSize:"getSize"}},text:{type:a3,props:{textSizeMaxPixels:"sizeMaxPixels",textSizeMinPixels:"sizeMinPixels",textSizeScale:"sizeScale",textSizeUnits:"sizeUnits",textBackground:"background",textBackgroundPadding:"backgroundPadding",textFontFamily:"fontFamily",textFontWeight:"fontWeight",textLineHeight:"lineHeight",textMaxWidth:"maxWidth",textOutlineColor:"outlineColor",textOutlineWidth:"outlineWidth",textWordBreak:"wordBreak",textCharacterSet:"characterSet",textBillboard:"billboard",textFontSettings:"fontSettings",getText:"getText",getTextAngle:"getAngle",getTextColor:"getColor",getTextPixelOffset:"getPixelOffset",getTextSize:"getSize",getTextAnchor:"getTextAnchor",getTextAlignmentBaseline:"getAlignmentBaseline",getTextBackgroundColor:"getBackgroundColor",getTextBorderColor:"getBorderColor",getTextBorderWidth:"getBorderWidth"}}},c3={type:a1,props:{lineWidthUnits:"widthUnits",lineWidthScale:"widthScale",lineWidthMinPixels:"widthMinPixels",lineWidthMaxPixels:"widthMaxPixels",lineJointRounded:"jointRounded",lineCapRounded:"capRounded",lineMiterLimit:"miterLimit",lineBillboard:"billboard",getLineColor:"getColor",getLineWidth:"getWidth"}},i6={type:c1,props:{extruded:"extruded",filled:"filled",wireframe:"wireframe",elevationScale:"elevationScale",material:"material",_full3d:"_full3d",getElevation:"getElevation",getFillColor:"getFillColor",getLineColor:"getLineColor"}};function d2({type:e,props:t}){let r={};for(let i in t)r[i]=e.defaultProps[t[i]];return r}function n6(e,t){let{transitions:r,updateTriggers:i}=e.props,s={updateTriggers:{},transitions:r&&{getPosition:r.geometry}};for(let n in t){let o=t[n],a=e.props[n];n.startsWith("get")&&(a=e.getSubLayerAccessor(a),s.updateTriggers[o]=i[n],r&&(s.transitions[o]=r[n])),s[o]=a}return s}function sX(e){if(Array.isArray(e))return e;switch(Ir.assert(e.type,"GeoJSON does not have type"),e.type){case"Feature":return[e];case"FeatureCollection":return Ir.assert(Array.isArray(e.features),"GeoJSON does not have features array"),e.features;default:return[{geometry:e}]}}function gO(e,t,r={}){let i={pointFeatures:[],lineFeatures:[],polygonFeatures:[],polygonOutlineFeatures:[]},{startRow:s=0,endRow:n=e.length}=r;for(let o=s;o<n;o++){let a=e[o],{geometry:h}=a;if(h)if(h.type==="GeometryCollection"){Ir.assert(Array.isArray(h.geometries),"GeoJSON does not have geometries array");let{geometries:p}=h;for(let g=0;g<p.length;g++){let v=p[g];nX(v,i,t,a,o)}}else nX(h,i,t,a,o)}return i}function nX(e,t,r,i,s){let{type:n,coordinates:o}=e,{pointFeatures:a,lineFeatures:h,polygonFeatures:p,polygonOutlineFeatures:g}=t;if(!Xxt(n,o)){Ir.warn(`${n} coordinates are malformed`)();return}switch(n){case"Point":a.push(r({geometry:e},i,s));break;case"MultiPoint":o.forEach(v=>{a.push(r({geometry:{type:"Point",coordinates:v}},i,s))});break;case"LineString":h.push(r({geometry:e},i,s));break;case"MultiLineString":o.forEach(v=>{h.push(r({geometry:{type:"LineString",coordinates:v}},i,s))});break;case"Polygon":p.push(r({geometry:e},i,s)),o.forEach(v=>{g.push(r({geometry:{type:"LineString",coordinates:v}},i,s))});break;case"MultiPolygon":o.forEach(v=>{p.push(r({geometry:{type:"Polygon",coordinates:v}},i,s)),v.forEach(T=>{g.push(r({geometry:{type:"LineString",coordinates:T}},i,s))})});break;default:}}var Yxt={Point:1,MultiPoint:2,LineString:2,MultiLineString:3,Polygon:3,MultiPolygon:4};function Xxt(e,t){let r=Yxt[e];for(Ir.assert(r,`Unknown GeoJSON type ${e}`);t&&--r>0;)t=t[0];return t&&Number.isFinite(t[0])}function oX(){return{points:{},lines:{},polygons:{},polygonsOutline:{}}}function s6(e){return e.geometry.coordinates}function aX(e,t){let r=oX(),{pointFeatures:i,lineFeatures:s,polygonFeatures:n,polygonOutlineFeatures:o}=e;return r.points.data=i,r.points._dataDiff=t.pointFeatures&&(()=>t.pointFeatures),r.points.getPosition=s6,r.lines.data=s,r.lines._dataDiff=t.lineFeatures&&(()=>t.lineFeatures),r.lines.getPath=s6,r.polygons.data=n,r.polygons._dataDiff=t.polygonFeatures&&(()=>t.polygonFeatures),r.polygons.getPolygon=s6,r.polygonsOutline.data=o,r.polygonsOutline._dataDiff=t.polygonOutlineFeatures&&(()=>t.polygonOutlineFeatures),r.polygonsOutline.getPath=s6,r}function lX(e,t){let r=oX(),{points:i,lines:s,polygons:n}=e,o=FY(e,t);return r.points.data={length:i.positions.value.length/i.positions.size,attributes:{...i.attributes,getPosition:i.positions,instancePickingColors:{size:3,value:o.points}},properties:i.properties,numericProps:i.numericProps,featureIds:i.featureIds},r.lines.data={length:s.pathIndices.value.length-1,startIndices:s.pathIndices.value,attributes:{...s.attributes,getPath:s.positions,instancePickingColors:{size:3,value:o.lines}},properties:s.properties,numericProps:s.numericProps,featureIds:s.featureIds},r.lines._pathType="open",r.polygons.data={length:n.polygonIndices.value.length-1,startIndices:n.polygonIndices.value,attributes:{...n.attributes,getPolygon:n.positions,pickingColors:{size:3,value:o.polygons}},properties:n.properties,numericProps:n.numericProps,featureIds:n.featureIds},r.polygons._normalize=!1,n.triangles&&(r.polygons.data.attributes.indices=n.triangles.value),r.polygonsOutline.data={length:n.primitivePolygonIndices.value.length-1,startIndices:n.primitivePolygonIndices.value,attributes:{...n.attributes,getPath:n.positions,instancePickingColors:{size:3,value:o.polygons}},properties:n.properties,numericProps:n.numericProps,featureIds:n.featureIds},r.polygonsOutline._pathType="open",r}var Zxt=["points","linestrings","polygons"],Gxt={...d2(l3.circle),...d2(l3.icon),...d2(l3.text),...d2(c3),...d2(i6),stroked:!0,filled:!0,extruded:!1,wireframe:!1,_full3d:!1,iconAtlas:{type:"object",value:null},iconMapping:{type:"object",value:{}},getIcon:{type:"accessor",value:e=>e.properties.icon},getText:{type:"accessor",value:e=>e.properties.text},pointType:"circle",getRadius:{deprecatedFor:"getPointRadius"}},m2=class extends Sc{static{this.layerName="GeoJsonLayer"}static{this.defaultProps=Gxt}initializeState(){this.state={layerProps:{},features:{},featuresDiff:{}}}updateState({props:t,changeFlags:r}){if(!r.dataChanged)return;let{data:i}=this.props,s=i&&"points"in i&&"polygons"in i&&"lines"in i;this.setState({binary:s}),s?this._updateStateBinary({props:t,changeFlags:r}):this._updateStateJSON({props:t,changeFlags:r})}_updateStateBinary({props:t,changeFlags:r}){let i=lX(t.data,this.encodePickingColor);this.setState({layerProps:i})}_updateStateJSON({props:t,changeFlags:r}){let i=sX(t.data),s=this.getSubLayerRow.bind(this),n={},o={};if(Array.isArray(r.dataChanged)){let h=this.state.features;for(let p in h)n[p]=h[p].slice(),o[p]=[];for(let p of r.dataChanged){let g=gO(i,s,p);for(let v in h)o[v].push(e6({data:n[v],getIndex:T=>T.__source.index,dataRange:p,replace:g[v]}))}}else n=gO(i,s);let a=aX(n,o);this.setState({features:n,featuresDiff:o,layerProps:a})}getPickingInfo(t){let r=super.getPickingInfo(t),{index:i,sourceLayer:s}=r;return r.featureType=Zxt.find(n=>s.id.startsWith(`${this.id}-${n}-`)),i>=0&&s.id.startsWith(`${this.id}-points-text`)&&this.state.binary&&(r.index=this.props.data.points.globalFeatureIds.value[i]),r}_updateAutoHighlight(t){let r=`${this.id}-points-`,i=t.featureType==="points";for(let s of this.getSubLayers())s.id.startsWith(r)===i&&s.updateAutoHighlight(t)}_renderPolygonLayer(){let{extruded:t,wireframe:r}=this.props,{layerProps:i}=this.state,s="polygons-fill",n=this.shouldRenderSubLayer(s,i.polygons?.data)&&this.getSubLayerClass(s,i6.type);if(n){let o=n6(this,i6.props),a=t&&r;return a||delete o.getLineColor,o.updateTriggers.lineColors=a,new n(o,this.getSubLayerProps({id:s,updateTriggers:o.updateTriggers}),i.polygons)}return null}_renderLineLayers(){let{extruded:t,stroked:r}=this.props,{layerProps:i}=this.state,s="polygons-stroke",n="linestrings",o=!t&&r&&this.shouldRenderSubLayer(s,i.polygonsOutline?.data)&&this.getSubLayerClass(s,c3.type),a=this.shouldRenderSubLayer(n,i.lines?.data)&&this.getSubLayerClass(n,c3.type);if(o||a){let h=n6(this,c3.props);return[o&&new o(h,this.getSubLayerProps({id:s,updateTriggers:h.updateTriggers}),i.polygonsOutline),a&&new a(h,this.getSubLayerProps({id:n,updateTriggers:h.updateTriggers}),i.lines)]}return null}_renderPointLayers(){let{pointType:t}=this.props,{layerProps:r,binary:i}=this.state,{highlightedObjectIndex:s}=this.props;!i&&Number.isFinite(s)&&(s=r.points.data.findIndex(a=>a.__source.index===s));let n=new Set(t.split("+")),o=[];for(let a of n){let h=`points-${a}`,p=l3[a],g=p&&this.shouldRenderSubLayer(h,r.points?.data)&&this.getSubLayerClass(h,p.type);if(g){let v=n6(this,p.props),T=r.points;if(a==="text"&&i){let{instancePickingColors:C,...B}=T.data.attributes;T={...T,data:{...T.data,attributes:B}}}o.push(new g(v,this.getSubLayerProps({id:h,updateTriggers:v.updateTriggers,highlightedObjectIndex:s}),T))}}return o}renderLayers(){let{extruded:t}=this.props,r=this._renderPolygonLayer(),i=this._renderLineLayers(),s=this._renderPointLayers();return[!t&&r,i,s,t&&r]}getSubLayerAccessor(t){let{binary:r}=this.state;return!r||typeof t!="function"?super.getSubLayerAccessor(t):(i,s)=>{let{data:n,index:o}=s,a=LY(n,o);return t(a,s)}}};var o6=class{constructor(t){this.index=t,this.isVisible=!1,this.isSelected=!1,this.parent=null,this.children=[],this.content=null,this._loader=void 0,this._abortController=null,this._loaderId=0,this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1}get bbox(){return this._bbox}set bbox(t){this._bbox||(this._bbox=t,"west"in t?this.boundingBox=[[t.west,t.south],[t.east,t.north]]:this.boundingBox=[[t.left,t.top],[t.right,t.bottom]])}get data(){return this.isLoading&&this._loader?this._loader.then(()=>this.data):this.content}get isLoaded(){return this._isLoaded&&!this._needsReload}get isLoading(){return!!this._loader&&!this._isCancelled}get needsReload(){return this._needsReload||this._isCancelled}get byteLength(){let t=this.content?this.content.byteLength:0;return Number.isFinite(t)||console.error("byteLength not defined in tile data"),t}async _loadData({getData:t,requestScheduler:r,onLoad:i,onError:s}){let{index:n,id:o,bbox:a,userData:h,zoom:p}=this,g=this._loaderId;this._abortController=new AbortController;let{signal:v}=this._abortController,T=await r.scheduleRequest(this,L=>L.isSelected?1:-1);if(!T){this._isCancelled=!0;return}if(this._isCancelled){T.done();return}let C=null,B;try{C=await t({index:n,id:o,bbox:a,userData:h,zoom:p,signal:v})}catch(L){B=L||!0}finally{T.done()}if(g===this._loaderId){if(this._loader=void 0,this.content=C,this._isCancelled&&!C){this._isLoaded=!1;return}this._isLoaded=!0,this._isCancelled=!1,B?s(B,this):i(this)}}loadData(t){return this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1,this._loaderId++,this._loader=this._loadData(t),this._loader}setNeedsReload(){this.isLoading&&(this.abort(),this._loader=void 0),this._needsReload=!0}abort(){this.isLoaded||(this._isCancelled=!0,this._abortController?.abort())}};var Do={OUTSIDE:-1,INTERSECTING:0,INSIDE:1};var cX=new rr,Qxt=new rr,A2=class e{constructor(t=[0,0,0],r=[0,0,0],i){i=i||cX.copy(t).add(r).scale(.5),this.center=new rr(i),this.halfDiagonal=new rr(r).subtract(this.center),this.minimum=new rr(t),this.maximum=new rr(r)}clone(){return new e(this.minimum,this.maximum,this.center)}equals(t){return this===t||!!t&&this.minimum.equals(t.minimum)&&this.maximum.equals(t.maximum)}transform(t){return this.center.transformAsPoint(t),this.halfDiagonal.transform(t),this.minimum.transform(t),this.maximum.transform(t),this}intersectPlane(t){let{halfDiagonal:r}=this,i=Qxt.from(t.normal),s=r.x*Math.abs(i.x)+r.y*Math.abs(i.y)+r.z*Math.abs(i.z),n=this.center.dot(i)+t.distance;return n-s>0?Do.INSIDE:n+s<0?Do.OUTSIDE:Do.INTERSECTING}distanceTo(t){return Math.sqrt(this.distanceSquaredTo(t))}distanceSquaredTo(t){let r=cX.from(t).subtract(this.center),{halfDiagonal:i}=this,s=0,n;return n=Math.abs(r.x)-i.x,n>0&&(s+=n*n),n=Math.abs(r.y)-i.y,n>0&&(s+=n*n),n=Math.abs(r.z)-i.z,n>0&&(s+=n*n),s}};var u3=new rr,uX=new rr,g2=class e{constructor(t=[0,0,0],r=0){this.radius=-0,this.center=new rr,this.fromCenterRadius(t,r)}fromCenterRadius(t,r){return this.center.from(t),this.radius=r,this}fromCornerPoints(t,r){return r=u3.from(r),this.center=new rr().from(t).add(r).scale(.5),this.radius=this.center.distance(r),this}equals(t){return this===t||!!t&&this.center.equals(t.center)&&this.radius===t.radius}clone(){return new e(this.center,this.radius)}union(t){let r=this.center,i=this.radius,s=t.center,n=t.radius,o=u3.copy(s).subtract(r),a=o.magnitude();if(i>=a+n)return this.clone();if(n>=a+i)return t.clone();let h=(i+a+n)*.5;return uX.copy(o).scale((-i+h)/a).add(r),this.center.copy(uX),this.radius=h,this}expand(t){let i=u3.from(t).subtract(this.center).magnitude();return i>this.radius&&(this.radius=i),this}transform(t){this.center.transform(t);let r=ko.getScaling(u3,t);return this.radius=Math.max(r[0],Math.max(r[1],r[2]))*this.radius,this}distanceSquaredTo(t){let r=this.distanceTo(t);return r*r}distanceTo(t){let i=u3.from(t).subtract(this.center);return Math.max(0,i.len()-this.radius)}intersectPlane(t){let r=this.center,i=this.radius,n=t.normal.dot(r)+t.distance;return n<-i?Do.OUTSIDE:n<i?Do.INTERSECTING:Do.INSIDE}};var Kxt=new rr,Jxt=new rr,a6=new rr,l6=new rr,c6=new rr,tbt=new rr,ebt=new rr,Vd={COLUMN0ROW0:0,COLUMN0ROW1:1,COLUMN0ROW2:2,COLUMN1ROW0:3,COLUMN1ROW1:4,COLUMN1ROW2:5,COLUMN2ROW0:6,COLUMN2ROW1:7,COLUMN2ROW2:8},h3=class e{constructor(t=[0,0,0],r=[0,0,0,0,0,0,0,0,0]){this.center=new rr().from(t),this.halfAxes=new Js(r)}get halfSize(){let t=this.halfAxes.getColumn(0),r=this.halfAxes.getColumn(1),i=this.halfAxes.getColumn(2);return[new rr(t).len(),new rr(r).len(),new rr(i).len()]}get quaternion(){let t=this.halfAxes.getColumn(0),r=this.halfAxes.getColumn(1),i=this.halfAxes.getColumn(2),s=new rr(t).normalize(),n=new rr(r).normalize(),o=new rr(i).normalize();return new Uy().fromMatrix3(new Js([...s,...n,...o]))}fromCenterHalfSizeQuaternion(t,r,i){let s=new Uy(i),n=new Js().fromQuaternion(s);return n[0]=n[0]*r[0],n[1]=n[1]*r[0],n[2]=n[2]*r[0],n[3]=n[3]*r[1],n[4]=n[4]*r[1],n[5]=n[5]*r[1],n[6]=n[6]*r[2],n[7]=n[7]*r[2],n[8]=n[8]*r[2],this.center=new rr().from(t),this.halfAxes=n,this}clone(){return new e(this.center,this.halfAxes)}equals(t){return this===t||!!t&&this.center.equals(t.center)&&this.halfAxes.equals(t.halfAxes)}getBoundingSphere(t=new g2){let r=this.halfAxes,i=r.getColumn(0,a6),s=r.getColumn(1,l6),n=r.getColumn(2,c6),o=Kxt.copy(i).add(s).add(n);return t.center.copy(this.center),t.radius=o.magnitude(),t}intersectPlane(t){let r=this.center,i=t.normal,s=this.halfAxes,n=i.x,o=i.y,a=i.z,h=Math.abs(n*s[Vd.COLUMN0ROW0]+o*s[Vd.COLUMN0ROW1]+a*s[Vd.COLUMN0ROW2])+Math.abs(n*s[Vd.COLUMN1ROW0]+o*s[Vd.COLUMN1ROW1]+a*s[Vd.COLUMN1ROW2])+Math.abs(n*s[Vd.COLUMN2ROW0]+o*s[Vd.COLUMN2ROW1]+a*s[Vd.COLUMN2ROW2]),p=i.dot(r)+t.distance;return p<=-h?Do.OUTSIDE:p>=h?Do.INSIDE:Do.INTERSECTING}distanceTo(t){return Math.sqrt(this.distanceSquaredTo(t))}distanceSquaredTo(t){let r=Jxt.from(t).subtract(this.center),i=this.halfAxes,s=i.getColumn(0,a6),n=i.getColumn(1,l6),o=i.getColumn(2,c6),a=s.magnitude(),h=n.magnitude(),p=o.magnitude();s.normalize(),n.normalize(),o.normalize();let g=0,v;return v=Math.abs(r.dot(s))-a,v>0&&(g+=v*v),v=Math.abs(r.dot(n))-h,v>0&&(g+=v*v),v=Math.abs(r.dot(o))-p,v>0&&(g+=v*v),g}computePlaneDistances(t,r,i=[-0,-0]){let s=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY,o=this.center,a=this.halfAxes,h=a.getColumn(0,a6),p=a.getColumn(1,l6),g=a.getColumn(2,c6),v=tbt.copy(h).add(p).add(g).add(o),T=ebt.copy(v).subtract(t),C=r.dot(T);return s=Math.min(C,s),n=Math.max(C,n),v.copy(o).add(h).add(p).subtract(g),T.copy(v).subtract(t),C=r.dot(T),s=Math.min(C,s),n=Math.max(C,n),v.copy(o).add(h).subtract(p).add(g),T.copy(v).subtract(t),C=r.dot(T),s=Math.min(C,s),n=Math.max(C,n),v.copy(o).add(h).subtract(p).subtract(g),T.copy(v).subtract(t),C=r.dot(T),s=Math.min(C,s),n=Math.max(C,n),o.copy(v).subtract(h).add(p).add(g),T.copy(v).subtract(t),C=r.dot(T),s=Math.min(C,s),n=Math.max(C,n),o.copy(v).subtract(h).add(p).subtract(g),T.copy(v).subtract(t),C=r.dot(T),s=Math.min(C,s),n=Math.max(C,n),o.copy(v).subtract(h).subtract(p).add(g),T.copy(v).subtract(t),C=r.dot(T),s=Math.min(C,s),n=Math.max(C,n),o.copy(v).subtract(h).subtract(p).subtract(g),T.copy(v).subtract(t),C=r.dot(T),s=Math.min(C,s),n=Math.max(C,n),i[0]=s,i[1]=n,i}transform(t){this.center.transformAsPoint(t);let r=this.halfAxes.getColumn(0,a6);r.transformAsPoint(t);let i=this.halfAxes.getColumn(1,l6);i.transformAsPoint(t);let s=this.halfAxes.getColumn(2,c6);return s.transformAsPoint(t),this.halfAxes=new Js([...r,...i,...s]),this}getTransform(){throw new Error("not implemented")}};var hX=new rr,fX=new rr,jd=class e{constructor(t=[0,0,1],r=0){this.normal=new rr,this.distance=-0,this.fromNormalDistance(t,r)}fromNormalDistance(t,r){return ep(Number.isFinite(r)),this.normal.from(t).normalize(),this.distance=r,this}fromPointNormal(t,r){t=hX.from(t),this.normal.from(r).normalize();let i=-this.normal.dot(t);return this.distance=i,this}fromCoefficients(t,r,i,s){return this.normal.set(t,r,i),ep($l(this.normal.len(),1)),this.distance=s,this}clone(){return new e(this.normal,this.distance)}equals(t){return $l(this.distance,t.distance)&&$l(this.normal,t.normal)}getPointDistance(t){return this.normal.dot(t)+this.distance}transform(t){let r=fX.copy(this.normal).transformAsVector(t).normalize(),i=this.normal.scale(-this.distance).transform(t);return this.fromPointNormal(i,r)}projectPointOntoPlane(t,r=[0,0,0]){let i=hX.from(t),s=this.getPointDistance(i),n=fX.copy(this.normal).scale(s);return i.subtract(n).to(r)}};var pX=[new rr([1,0,0]),new rr([0,1,0]),new rr([0,0,1])],dX=new rr,rbt=new rr,Wd=class e{constructor(t=[]){this.planes=t}fromBoundingSphere(t){this.planes.length=2*pX.length;let r=t.center,i=t.radius,s=0;for(let n of pX){let o=this.planes[s],a=this.planes[s+1];o||(o=this.planes[s]=new jd),a||(a=this.planes[s+1]=new jd);let h=dX.copy(n).scale(-i).add(r);o.fromPointNormal(h,n);let p=dX.copy(n).scale(i).add(r),g=rbt.copy(n).negate();a.fromPointNormal(p,g),s+=2}return this}computeVisibility(t){let r=Do.INSIDE;for(let i of this.planes)switch(t.intersectPlane(i)){case Do.OUTSIDE:return Do.OUTSIDE;case Do.INTERSECTING:r=Do.INTERSECTING;break;default:}return r}computeVisibilityWithPlaneMask(t,r){if(ep(Number.isFinite(r),"parentPlaneMask is required."),r===e.MASK_OUTSIDE||r===e.MASK_INSIDE)return r;let i=e.MASK_INSIDE,s=this.planes;for(let n=0;n<this.planes.length;++n){let o=n<31?1<<n:0;if(n<31&&!(r&o))continue;let a=s[n],h=t.intersectPlane(a);if(h===Do.OUTSIDE)return e.MASK_OUTSIDE;h===Do.INTERSECTING&&(i|=o)}return i}};Wd.MASK_OUTSIDE=4294967295;Wd.MASK_INSIDE=0;Wd.MASK_INDETERMINATE=2147483647;var zQt=new rr,UQt=new rr,VQt=new rr,jQt=new rr,WQt=new rr;var ZQt=new rr,GQt=new rr,QQt=new rr,KQt=new rr,JQt=new rr,tKt=new rr,eKt=new rr,rKt=new rr,iKt=new rr,nKt=new rr,sKt=new rr,oKt=new rr;var hp=new Js,nbt=new Js,sbt=new Js,u6=new Js,mX=new Js;function xO(e,t={}){let r=jv.EPSILON20,i=10,s=0,n=0,o=nbt,a=sbt;o.identity(),a.copy(e);let h=r*obt(a);for(;n<i&&abt(a)>h;)lbt(a,u6),mX.copy(u6).transpose(),a.multiplyRight(u6),a.multiplyLeft(mX),o.multiplyRight(u6),++s>2&&(++n,s=0);return t.unitary=o.toTarget(t.unitary),t.diagonal=a.toTarget(t.diagonal),t}function obt(e){let t=0;for(let r=0;r<9;++r){let i=e[r];t+=i*i}return Math.sqrt(t)}var _O=[1,0,0],yO=[2,2,1];function abt(e){let t=0;for(let r=0;r<3;++r){let i=e[hp.getElementIndex(yO[r],_O[r])];t+=2*i*i}return Math.sqrt(t)}function lbt(e,t){let r=jv.EPSILON15,i=0,s=1;for(let p=0;p<3;++p){let g=Math.abs(e[hp.getElementIndex(yO[p],_O[p])]);g>i&&(s=p,i=g)}let n=_O[s],o=yO[s],a=1,h=0;if(Math.abs(e[hp.getElementIndex(o,n)])>r){let p=e[hp.getElementIndex(o,o)],g=e[hp.getElementIndex(n,n)],v=e[hp.getElementIndex(o,n)],T=(p-g)/2/v,C;T<0?C=-1/(-T+Math.sqrt(1+T*T)):C=1/(T+Math.sqrt(1+T*T)),a=1/Math.sqrt(1+C*C),h=C*a}return Js.IDENTITY.to(t),t[hp.getElementIndex(n,n)]=t[hp.getElementIndex(o,o)]=a,t[hp.getElementIndex(o,n)]=h,t[hp.getElementIndex(n,o)]=-h,t}var Hm=new rr,cbt=new rr,ubt=new rr,hbt=new rr,fbt=new rr,pbt=new Js,dbt={diagonal:new Js,unitary:new Js};function bO(e,t=new h3){if(!e||e.length===0)return t.halfAxes=new Js([0,0,0,0,0,0,0,0,0]),t.center=new rr,t;let r=e.length,i=new rr(0,0,0);for(let Et of e)i.add(Et);let s=1/r;i.multiplyByScalar(s);let n=0,o=0,a=0,h=0,p=0,g=0;for(let Et of e){let vt=Hm.copy(Et).subtract(i);n+=vt.x*vt.x,o+=vt.x*vt.y,a+=vt.x*vt.z,h+=vt.y*vt.y,p+=vt.y*vt.z,g+=vt.z*vt.z}n*=s,o*=s,a*=s,h*=s,p*=s,g*=s;let v=pbt;v[0]=n,v[1]=o,v[2]=a,v[3]=o,v[4]=h,v[5]=p,v[6]=a,v[7]=p,v[8]=g;let{unitary:T}=xO(v,dbt),C=t.halfAxes.copy(T),B=C.getColumn(0,ubt),L=C.getColumn(1,hbt),z=C.getColumn(2,fbt),W=-Number.MAX_VALUE,Z=-Number.MAX_VALUE,X=-Number.MAX_VALUE,q=Number.MAX_VALUE,it=Number.MAX_VALUE,nt=Number.MAX_VALUE;for(let Et of e)Hm.copy(Et),W=Math.max(Hm.dot(B),W),Z=Math.max(Hm.dot(L),Z),X=Math.max(Hm.dot(z),X),q=Math.min(Hm.dot(B),q),it=Math.min(Hm.dot(L),it),nt=Math.min(Hm.dot(z),nt);B=B.multiplyByScalar(.5*(q+W)),L=L.multiplyByScalar(.5*(it+Z)),z=z.multiplyByScalar(.5*(nt+X)),t.center.copy(B).add(L).add(z);let Mt=cbt.set(W-q,Z-it,X-nt).multiplyByScalar(.5),_t=new Js([Mt[0],0,0,0,Mt[1],0,0,0,Mt[2]]);return t.halfAxes.multiplyRight(_t),t}var _2=512,AX=3,gX=[[.5,.5],[0,0],[0,1],[1,0],[1,1]],_X=gX.concat([[0,.5],[.5,0],[1,.5],[.5,1]]),mbt=_X.concat([[.25,.5],[.75,.5]]),vO=class e{constructor(t,r,i){this.x=t,this.y=r,this.z=i}get children(){if(!this._children){let t=this.x*2,r=this.y*2,i=this.z+1;this._children=[new e(t,r,i),new e(t,r+1,i),new e(t+1,r,i),new e(t+1,r+1,i)]}return this._children}update(t){let{viewport:r,cullingVolume:i,elevationBounds:s,minZ:n,maxZ:o,bounds:a,offset:h,project:p}=t,g=this.getBoundingVolume(s,h,p);if(a&&!this.insideBounds(a)||i.computeVisibility(g)<0)return!1;if(!this.childVisible){let{z:T}=this;if(T<o&&T>=n){let C=g.distanceTo(r.cameraPosition)*r.scale/r.height;T+=Math.floor(Math.log2(C))}if(T>=o)return this.selected=!0,!0}this.selected=!1,this.childVisible=!0;for(let T of this.children)T.update(t);return!0}getSelected(t=[]){if(this.selected&&t.push(this),this._children)for(let r of this._children)r.getSelected(t);return t}insideBounds([t,r,i,s]){let n=Math.pow(2,this.z),o=_2/n;return this.x*o<i&&this.y*o<s&&(this.x+1)*o>t&&(this.y+1)*o>r}getBoundingVolume(t,r,i){if(i){let h=this.z<1?mbt:this.z<2?_X:gX,p=[];for(let g of h){let v=h6(this.x+g[0],this.y+g[1],this.z);v[2]=t[0],p.push(i(v)),t[0]!==t[1]&&(v[2]=t[1],p.push(i(v)))}return bO(p)}let s=Math.pow(2,this.z),n=_2/s,o=this.x*n+r*_2,a=_2-(this.y+1)*n;return new A2([o,a,t[0]],[o+n,a+n,t[1]])}};function yX(e,t,r,i){let s=e instanceof s2&&e.resolution?e.projectPosition:null,n=Object.values(e.getFrustumPlanes()).map(({normal:C,distance:B})=>new jd(C.clone().negate(),B)),o=new Wd(n),a=e.distanceScales.unitsPerMeter[2],h=r&&r[0]*a||0,p=r&&r[1]*a||0,g=e instanceof cu&&e.pitch<=60?t:0;if(i){let[C,B,L,z]=i,W=Va([C,z]),Z=Va([L,B]);i=[W[0],_2-W[1],Z[0],_2-Z[1]]}let v=new vO(0,0,0),T={viewport:e,project:s,cullingVolume:o,elevationBounds:[h,p],minZ:g,maxZ:t,bounds:i,offset:0};if(v.update(T),e instanceof cu&&e.subViewports&&e.subViewports.length>1){for(T.offset=-1;v.update(T)&&!(--T.offset<-AX););for(T.offset=1;v.update(T)&&!(++T.offset>AX););}return v.getSelected()}var $d=512,Abt=[-1/0,-1/0,1/0,1/0],TO={type:"object",value:null,validate:(e,t)=>t.optional&&e===null||typeof e=="string"||Array.isArray(e)&&e.every(r=>typeof r=="string"),equal:(e,t)=>{if(e===t)return!0;if(!Array.isArray(e)||!Array.isArray(t))return!1;let r=e.length;if(r!==t.length)return!1;for(let i=0;i<r;i++)if(e[i]!==t[i])return!1;return!0}};function bX(e,t){let r=[t.transformAsPoint([e[0],e[1]]),t.transformAsPoint([e[2],e[1]]),t.transformAsPoint([e[0],e[3]]),t.transformAsPoint([e[2],e[3]])];return[Math.min(...r.map(s=>s[0])),Math.min(...r.map(s=>s[1])),Math.max(...r.map(s=>s[0])),Math.max(...r.map(s=>s[1]))]}function gbt(e){return Math.abs(e.split("").reduce((t,r)=>(t<<5)-t+r.charCodeAt(0)|0,0))}function SO(e,t){if(!e||!e.length)return null;let{index:r,id:i}=t;if(Array.isArray(e)){let n=gbt(i)%e.length;e=e[n]}let s=e;for(let n of Object.keys(r)){let o=new RegExp(`{${n}}`,"g");s=s.replace(o,String(r[n]))}return Number.isInteger(r.y)&&Number.isInteger(r.z)&&(s=s.replace(/\{-y\}/g,String(Math.pow(2,r.z)-r.y-1))),s}function _bt(e,t,r){let i;if(t&&t.length===2){let[s,n]=t,o=e.getBounds({z:s}),a=e.getBounds({z:n});i=[Math.min(o[0],a[0]),Math.min(o[1],a[1]),Math.max(o[2],a[2]),Math.max(o[3],a[3])]}else i=e.getBounds();return e.isGeospatial?[Math.max(i[0],r[0]),Math.max(i[1],r[1]),Math.min(i[2],r[2]),Math.min(i[3],r[3])]:[Math.max(Math.min(i[0],r[2]),r[0]),Math.max(Math.min(i[1],r[3]),r[1]),Math.min(Math.max(i[2],r[0]),r[2]),Math.min(Math.max(i[3],r[1]),r[3])]}function vX({viewport:e,z:t,cullRect:r}){return(e.subViewports||[e]).map(s=>wO(s,t||0,r))}function wO(e,t,r){if(!Array.isArray(t)){let n=r.x-e.x,o=r.y-e.y,{width:a,height:h}=r,p={targetZ:t},g=e.unproject([n,o],p),v=e.unproject([n+a,o],p),T=e.unproject([n,o+h],p),C=e.unproject([n+a,o+h],p);return[Math.min(g[0],v[0],T[0],C[0]),Math.min(g[1],v[1],T[1],C[1]),Math.max(g[0],v[0],T[0],C[0]),Math.max(g[1],v[1],T[1],C[1])]}let i=wO(e,t[0],r),s=wO(e,t[1],r);return[Math.min(i[0],s[0]),Math.min(i[1],s[1]),Math.max(i[2],s[2]),Math.max(i[3],s[3])]}function ybt(e,t,r){return r?bX(e,r).map(s=>s*t/$d):e.map(i=>i*t/$d)}function EO(e,t){return Math.pow(2,e)*$d/t}function h6(e,t,r){let i=EO(r,$d),s=e/i*360-180,n=Math.PI-2*Math.PI*t/i,o=180/Math.PI*Math.atan(.5*(Math.exp(n)-Math.exp(-n)));return[s,o]}function xX(e,t,r,i){let s=EO(r,i);return[e/s*$d,t/s*$d]}function IO(e,t,r,i,s=$d){if(e.isGeospatial){let[p,g]=h6(t,r,i),[v,T]=h6(t+1,r+1,i);return{west:p,north:g,east:v,south:T}}let[n,o]=xX(t,r,i,s),[a,h]=xX(t+1,r+1,i,s);return{left:n,top:o,right:a,bottom:h}}function xbt(e,t,r,i,s){let n=_bt(e,null,i),o=EO(t,r),[a,h,p,g]=ybt(n,o,s),v=[];for(let T=Math.floor(a);T<p;T++)for(let C=Math.floor(h);C<g;C++)v.push({x:T,y:C,z:t});return v}function MO({viewport:e,maxZoom:t,minZoom:r,zRange:i,extent:s,tileSize:n=$d,modelMatrix:o,modelMatrixInverse:a,zoomOffset:h=0}){let p=e.isGeospatial?Math.round(e.zoom+Math.log2($d/n))+h:Math.ceil(e.zoom)+h;if(typeof r=="number"&&Number.isFinite(r)&&p<r){if(!s)return[];p=r}typeof t=="number"&&Number.isFinite(t)&&p>t&&(p=t);let g=s;return o&&a&&s&&!e.isGeospatial&&(g=bX(s,o)),e.isGeospatial?yX(e,p,i,s):xbt(e,p,n,g||Abt,a)}function wX(e){let t={},r;return i=>{for(let s in i)if(!bbt(i[s],t[s])){r=e(i),t=i;break}return r}}function bbt(e,t){if(e===t)return!0;if(Array.isArray(e)){let r=e.length;if(!t||t.length!==r)return!1;for(let i=0;i<r;i++)if(e[i]!==t[i])return!1;return!0}return!1}var TX=1,f6=2,vbt="never",wbt="no-overlap",p3="best-available",Tbt=5,Sbt={[p3]:Ibt,[wbt]:Mbt,[vbt]:()=>{}},Ebt={extent:null,tileSize:512,maxZoom:null,minZoom:null,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:"best-available",zRange:null,maxRequests:6,debounceTime:0,zoomOffset:0,onTileLoad:()=>{},onTileUnload:()=>{},onTileError:()=>{}},f3=class{constructor(t){this._getCullBounds=wX(vX),this.opts={...Ebt,...t},this.setOptions(this.opts),this.onTileLoad=r=>{this.opts.onTileLoad?.(r),this.opts.maxCacheByteSize&&(this._cacheByteSize+=r.byteLength,this._resizeCache())},this._requestScheduler=new My({throttleRequests:this.opts.maxRequests>0||this.opts.debounceTime>0,maxRequests:this.opts.maxRequests,debounceTime:this.opts.debounceTime}),this._cache=new Map,this._tiles=[],this._dirty=!1,this._cacheByteSize=0,this._viewport=null,this._zRange=null,this._selectedTiles=null,this._frameNumber=0,this._modelMatrix=new Os,this._modelMatrixInverse=new Os}get tiles(){return this._tiles}get selectedTiles(){return this._selectedTiles}get isLoaded(){return this._selectedTiles!==null&&this._selectedTiles.every(t=>t.isLoaded)}get needsReload(){return this._selectedTiles!==null&&this._selectedTiles.some(t=>t.needsReload)}setOptions(t){Object.assign(this.opts,t),Number.isFinite(t.maxZoom)&&(this._maxZoom=Math.floor(t.maxZoom)),Number.isFinite(t.minZoom)&&(this._minZoom=Math.ceil(t.minZoom))}finalize(){for(let t of this._cache.values())t.isLoading&&t.abort();this._cache.clear(),this._tiles=[],this._selectedTiles=null}reloadAll(){for(let t of this._cache.keys()){let r=this._cache.get(t);!this._selectedTiles||!this._selectedTiles.includes(r)?this._cache.delete(t):r.setNeedsReload()}}update(t,{zRange:r,modelMatrix:i}={zRange:null,modelMatrix:null}){let s=i?new Os(i):new Os,n=!s.equals(this._modelMatrix);if(!this._viewport||!t.equals(this._viewport)||!$l(this._zRange,r)||n){n&&(this._modelMatrixInverse=s.clone().invert(),this._modelMatrix=s),this._viewport=t,this._zRange=r;let a=this.getTileIndices({viewport:t,maxZoom:this._maxZoom,minZoom:this._minZoom,zRange:r,modelMatrix:this._modelMatrix,modelMatrixInverse:this._modelMatrixInverse});this._selectedTiles=a.map(h=>this._getTile(h,!0)),this._dirty&&this._rebuildTree()}else this.needsReload&&(this._selectedTiles=this._selectedTiles.map(a=>this._getTile(a.index,!0)));let o=this.updateTileStates();return this._pruneRequests(),this._dirty&&this._resizeCache(),o&&this._frameNumber++,this._frameNumber}isTileVisible(t,r){if(!t.isVisible)return!1;if(r&&this._viewport){let i=this._getCullBounds({viewport:this._viewport,z:this._zRange,cullRect:r}),{bbox:s}=t;for(let[n,o,a,h]of i){let p;if("west"in s)p=s.west<a&&s.east>n&&s.south<h&&s.north>o;else{let g=Math.min(s.top,s.bottom),v=Math.max(s.top,s.bottom);p=s.left<a&&s.right>n&&g<h&&v>o}if(p)return!0}return!1}return!0}getTileIndices({viewport:t,maxZoom:r,minZoom:i,zRange:s,modelMatrix:n,modelMatrixInverse:o}){let{tileSize:a,extent:h,zoomOffset:p}=this.opts;return MO({viewport:t,maxZoom:r,minZoom:i,zRange:s,tileSize:a,extent:h,modelMatrix:n,modelMatrixInverse:o,zoomOffset:p})}getTileId(t){return`${t.x}-${t.y}-${t.z}`}getTileZoom(t){return t.z}getTileMetadata(t){let{tileSize:r}=this.opts;return{bbox:IO(this._viewport,t.x,t.y,t.z,r)}}getParentIndex(t){let r=Math.floor(t.x/2),i=Math.floor(t.y/2),s=t.z-1;return{x:r,y:i,z:s}}updateTileStates(){let t=this.opts.refinementStrategy||p3,r=new Array(this._cache.size),i=0;for(let s of this._cache.values())r[i++]=s.isVisible,s.isSelected=!1,s.isVisible=!1;for(let s of this._selectedTiles)s.isSelected=!0,s.isVisible=!0;(typeof t=="function"?t:Sbt[t])(Array.from(this._cache.values())),i=0;for(let s of this._cache.values())if(r[i++]!==s.isVisible)return!0;return!1}_pruneRequests(){let{maxRequests:t=0}=this.opts,r=[],i=0;for(let s of this._cache.values())s.isLoading&&(i++,!s.isSelected&&!s.isVisible&&r.push(s));for(;t>0&&i>t&&r.length>0;)r.shift().abort(),i--}_rebuildTree(){let{_cache:t}=this;for(let r of t.values())r.parent=null,r.children&&(r.children.length=0);for(let r of t.values()){let i=this._getNearestAncestor(r);r.parent=i,i?.children&&i.children.push(r)}}_resizeCache(){let{_cache:t,opts:r}=this,i=r.maxCacheSize||(r.maxCacheByteSize?1/0:Tbt*this.selectedTiles.length),s=r.maxCacheByteSize||1/0;if(t.size>i||this._cacheByteSize>s){for(let[o,a]of t)if(!a.isVisible&&!a.isSelected&&(this._cacheByteSize-=r.maxCacheByteSize?a.byteLength:0,t.delete(o),this.opts.onTileUnload?.(a)),t.size<=i&&this._cacheByteSize<=s)break;this._rebuildTree(),this._dirty=!0}this._dirty&&(this._tiles=Array.from(this._cache.values()).sort((o,a)=>o.zoom-a.zoom),this._dirty=!1)}_getTile(t,r){let i=this.getTileId(t),s=this._cache.get(i),n=!1;return!s&&r?(s=new o6(t),Object.assign(s,this.getTileMetadata(s.index)),Object.assign(s,{id:i,zoom:this.getTileZoom(s.index)}),n=!0,this._cache.set(i,s),this._dirty=!0):s&&s.needsReload&&(n=!0),s&&n&&s.loadData({getData:this.opts.getTileData,requestScheduler:this._requestScheduler,onLoad:this.onTileLoad,onError:this.opts.onTileError}),s}_getNearestAncestor(t){let{_minZoom:r=0}=this,i=t.index;for(;this.getTileZoom(i)>r;){i=this.getParentIndex(i);let s=this._getTile(i);if(s)return s}return null}};function Ibt(e){for(let t of e)t.state=0;for(let t of e)t.isSelected&&!SX(t)&&CO(t);for(let t of e)t.isVisible=!!(t.state&f6)}function Mbt(e){for(let r of e)r.state=0;for(let r of e)r.isSelected&&SX(r);let t=Array.from(e).sort((r,i)=>r.zoom-i.zoom);for(let r of t)if(r.isVisible=!!(r.state&f6),r.children&&(r.isVisible||r.state&TX))for(let i of r.children)i.state=TX;else r.isSelected&&CO(r)}function SX(e){let t=e;for(;t;){if(t.isLoaded||t.content)return t.state|=f6,!0;t=t.parent}return!1}function CO(e){for(let t of e.children)t.isLoaded||t.content?t.state|=f6:CO(t)}var Cbt={TilesetClass:f3,data:{type:"data",value:[]},dataComparator:TO.equal,renderSubLayers:{type:"function",value:e=>new m2(e)},getTileData:{type:"function",optional:!0,value:null},onViewportLoad:{type:"function",optional:!0,value:null},onTileLoad:{type:"function",value:e=>{}},onTileUnload:{type:"function",value:e=>{}},onTileError:{type:"function",value:e=>console.error(e)},extent:{type:"array",optional:!0,value:null,compare:!0},tileSize:512,maxZoom:null,minZoom:0,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:p3,zRange:null,maxRequests:6,debounceTime:0,zoomOffset:0},y2=class extends Sc{static{this.defaultProps=Cbt}static{this.layerName="TileLayer"}initializeState(){this.state={tileset:null,isLoaded:!1}}finalizeState(){this.state?.tileset?.finalize()}get isLoaded(){return!!this.state?.tileset?.selectedTiles?.every(t=>t.isLoaded&&t.layers&&t.layers.every(r=>r.isLoaded))}shouldUpdateState({changeFlags:t}){return t.somethingChanged}updateState({changeFlags:t}){let{tileset:r}=this.state,i=t.propsOrDataChanged||t.updateTriggersChanged,s=t.dataChanged||t.updateTriggersChanged&&(t.updateTriggersChanged.all||t.updateTriggersChanged.getTileData);r?i&&(r.setOptions(this._getTilesetOptions()),s?r.reloadAll():r.tiles.forEach(n=>{n.layers=null})):(r=new this.props.TilesetClass(this._getTilesetOptions()),this.setState({tileset:r})),this._updateTileset()}_getTilesetOptions(){let{tileSize:t,maxCacheSize:r,maxCacheByteSize:i,refinementStrategy:s,extent:n,maxZoom:o,minZoom:a,maxRequests:h,debounceTime:p,zoomOffset:g}=this.props;return{maxCacheSize:r,maxCacheByteSize:i,maxZoom:o,minZoom:a,tileSize:t,refinementStrategy:s,extent:n,maxRequests:h,debounceTime:p,zoomOffset:g,getTileData:this.getTileData.bind(this),onTileLoad:this._onTileLoad.bind(this),onTileError:this._onTileError.bind(this),onTileUnload:this._onTileUnload.bind(this)}}_updateTileset(){let t=this.state.tileset,{zRange:r,modelMatrix:i}=this.props,s=t.update(this.context.viewport,{zRange:r,modelMatrix:i}),{isLoaded:n}=t,o=this.state.isLoaded!==n,a=this.state.frameNumber!==s;n&&(o||a)&&this._onViewportLoad(),a&&this.setState({frameNumber:s}),this.state.isLoaded=n}_onViewportLoad(){let{tileset:t}=this.state,{onViewportLoad:r}=this.props;r&&r(t.selectedTiles)}_onTileLoad(t){this.props.onTileLoad(t),t.layers=null,this.setNeedsUpdate()}_onTileError(t,r){this.props.onTileError(t),r.layers=null,this.setNeedsUpdate()}_onTileUnload(t){this.props.onTileUnload(t)}getTileData(t){let{data:r,getTileData:i,fetch:s}=this.props,{signal:n}=t;return t.url=typeof r=="string"||Array.isArray(r)?SO(r,t):null,i?i(t):s&&t.url?s(t.url,{propName:"data",layer:this,signal:n}):null}renderSubLayers(t){return this.props.renderSubLayers(t)}getSubLayerPropsByTile(t){return null}getPickingInfo(t){let r=t.sourceLayer,i=r.props.tile,s=t.info;return s.picked&&(s.tile=i),s.sourceTile=i,s.sourceTileSubLayer=r,s}_updateAutoHighlight(t){t.sourceTileSubLayer.updateAutoHighlight(t)}renderLayers(){return this.state.tileset.tiles.map(t=>{let r=this.getSubLayerPropsByTile(t);if(!(!t.isLoaded&&!t.content))if(t.layers)r&&t.layers[0]&&Object.keys(r).some(i=>t.layers[0].props[i]!==r[i])&&(t.layers=t.layers.map(i=>i.clone(r)));else{let i=this.renderSubLayers({...this.props,...this.getSubLayerProps({id:t.id,updateTriggers:this.props.updateTriggers}),data:t.content,_offset:0,tile:t});t.layers=vc(i,Boolean).map(s=>s.clone({tile:t,...r}))}return t.layers})}filterSubLayer({layer:t,cullRect:r}){let{tile:i}=t.props;return this.state.tileset.isTileVisible(i,r)}};var LO={};Ua(LO,{UNITS:()=>Ic,areNeighborCells:()=>yvt,cellArea:()=>Rvt,cellToBoundary:()=>OO,cellToCenterChild:()=>uvt,cellToChildPos:()=>hvt,cellToChildren:()=>cvt,cellToChildrenSize:()=>VX,cellToLatLng:()=>T2,cellToLocalIj:()=>Mvt,cellToParent:()=>BO,cellToVertex:()=>Dvt,cellToVertexes:()=>Ovt,cellsToDirectedEdge:()=>xvt,cellsToMultiPolygon:()=>Avt,childPosToCell:()=>fvt,compactCells:()=>gvt,degsToRads:()=>_6,directedEdgeToBoundary:()=>Evt,directedEdgeToCells:()=>Tvt,edgeLength:()=>kvt,getBaseCellNumber:()=>avt,getDirectedEdgeDestination:()=>vvt,getDirectedEdgeOrigin:()=>bvt,getHexagonAreaAvg:()=>NO,getHexagonEdgeLengthAvg:()=>x3,getIcosahedronFaces:()=>lvt,getNumCells:()=>Lvt,getPentagons:()=>zvt,getRes0Cells:()=>Fvt,getResolution:()=>fp,greatCircleDistance:()=>Pvt,gridDisk:()=>y3,gridDiskDistances:()=>pvt,gridDistance:()=>S2,gridPathCells:()=>Ivt,gridRingUnsafe:()=>dvt,h3IndexToSplitLong:()=>Yi,isPentagon:()=>DO,isResClassIII:()=>ovt,isValidCell:()=>kO,isValidDirectedEdge:()=>wvt,isValidVertex:()=>Nvt,latLngToCell:()=>_3,localIjToCell:()=>Cvt,originToDirectedEdges:()=>Svt,polygonToCells:()=>mvt,radsToDegs:()=>WX,splitLongToH3Index:()=>LX,uncompactCells:()=>_vt,vertexToLatLng:()=>Bvt});var Ae=function(e){e=e||{};var t=typeof e<"u"?e:{},r={},i;for(i in t)t.hasOwnProperty(i)&&(r[i]=t[i]);var s=[],n="";function o(oe){return t.locateFile?t.locateFile(oe,n):n+oe}var a;typeof document<"u"&&document.currentScript&&(n=document.currentScript.src),n.indexOf("blob:")!==0?n=n.substr(0,n.lastIndexOf("/")+1):n="",a=function(we,We,kr){var _=new XMLHttpRequest;_.open("GET",we,!0),_.responseType="arraybuffer",_.onload=function(){if(_.status==200||_.status==0&&_.response){We(_.response);return}var yr=mt(we);if(yr){We(yr.buffer);return}kr()},_.onerror=kr,_.send(null)};var h=t.print||console.log.bind(console),p=t.printErr||console.warn.bind(console);for(i in r)r.hasOwnProperty(i)&&(t[i]=r[i]);r=null,t.arguments&&(s=t.arguments);var g=0,v=function(oe){g=oe},T=function(){return g},C=8;function B(oe,we,We,kr){switch(We=We||"i8",We.charAt(We.length-1)==="*"&&(We="i32"),We){case"i1":xt[oe>>0]=we;break;case"i8":xt[oe>>0]=we;break;case"i16":qt[oe>>1]=we;break;case"i32":Ee[oe>>2]=we;break;case"i64":Ne=[we>>>0,(Go=we,+Er(Go)>=1?Go>0?(an(+Gn(Go/4294967296),4294967295)|0)>>>0:~~+ae((Go-+(~~Go>>>0))/4294967296)>>>0:0)],Ee[oe>>2]=Ne[0],Ee[oe+4>>2]=Ne[1];break;case"float":ze[oe>>2]=we;break;case"double":ke[oe>>3]=we;break;default:Zc("invalid type for setValue: "+We)}}function L(oe,we,We){switch(we=we||"i8",we.charAt(we.length-1)==="*"&&(we="i32"),we){case"i1":return xt[oe>>0];case"i8":return xt[oe>>0];case"i16":return qt[oe>>1];case"i32":return Ee[oe>>2];case"i64":return Ee[oe>>2];case"float":return ze[oe>>2];case"double":return ke[oe>>3];default:Zc("invalid type for getValue: "+we)}return null}var z=!1;function W(oe,we){oe||Zc("Assertion failed: "+we)}function Z(oe){var we=t["_"+oe];return W(we,"Cannot call unknown function "+oe+", make sure it is exported"),we}function X(oe,we,We,kr,_){var wn={string:function(vs){var cn=0;if(vs!=null&&vs!==0){var un=(vs.length<<2)+1;cn=J_(un),Et(vs,cn,un)}return cn},array:function(vs){var cn=J_(vs.length);return Pt(vs,cn),cn}};function yr(vs){return we==="string"?Mt(vs):we==="boolean"?!!vs:vs}var ft=Z(oe),lo=[],Wr=0;if(kr)for(var ss=0;ss<kr.length;ss++){var Fr=wn[We[ss]];Fr?(Wr===0&&(Wr=ig()),lo[ss]=Fr(kr[ss])):lo[ss]=kr[ss]}var Jr=ft.apply(null,lo);return Jr=yr(Jr),Wr!==0&&zb(Wr),Jr}function q(oe,we,We,kr){We=We||[];var _=We.every(function(yr){return yr==="number"}),wn=we!=="string";return wn&&_&&!kr?Z(oe):function(){return X(oe,we,We,arguments,kr)}}var it=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function nt(oe,we,We){for(var kr=we+We,_=we;oe[_]&&!(_>=kr);)++_;if(_-we>16&&oe.subarray&&it)return it.decode(oe.subarray(we,_));for(var wn="";we<_;){var yr=oe[we++];if(!(yr&128)){wn+=String.fromCharCode(yr);continue}var ft=oe[we++]&63;if((yr&224)==192){wn+=String.fromCharCode((yr&31)<<6|ft);continue}var lo=oe[we++]&63;if((yr&240)==224?yr=(yr&15)<<12|ft<<6|lo:yr=(yr&7)<<18|ft<<12|lo<<6|oe[we++]&63,yr<65536)wn+=String.fromCharCode(yr);else{var Wr=yr-65536;wn+=String.fromCharCode(55296|Wr>>10,56320|Wr&1023)}}return wn}function Mt(oe,we){return oe?nt(Vt,oe,we):""}function _t(oe,we,We,kr){if(!(kr>0))return 0;for(var _=We,wn=We+kr-1,yr=0;yr<oe.length;++yr){var ft=oe.charCodeAt(yr);if(ft>=55296&&ft<=57343){var lo=oe.charCodeAt(++yr);ft=65536+((ft&1023)<<10)|lo&1023}if(ft<=127){if(We>=wn)break;we[We++]=ft}else if(ft<=2047){if(We+1>=wn)break;we[We++]=192|ft>>6,we[We++]=128|ft&63}else if(ft<=65535){if(We+2>=wn)break;we[We++]=224|ft>>12,we[We++]=128|ft>>6&63,we[We++]=128|ft&63}else{if(We+3>=wn)break;we[We++]=240|ft>>18,we[We++]=128|ft>>12&63,we[We++]=128|ft>>6&63,we[We++]=128|ft&63}}return we[We]=0,We-_}function Et(oe,we,We){return _t(oe,Vt,we,We)}var vt=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0;function Pt(oe,we){xt.set(oe,we)}function re(oe,we){return oe%we>0&&(oe+=we-oe%we),oe}var $t,xt,Vt,qt,de,Ee,Se,ze,ke;function nr(oe){$t=oe,t.HEAP8=xt=new Int8Array(oe),t.HEAP16=qt=new Int16Array(oe),t.HEAP32=Ee=new Int32Array(oe),t.HEAPU8=Vt=new Uint8Array(oe),t.HEAPU16=de=new Uint16Array(oe),t.HEAPU32=Se=new Uint32Array(oe),t.HEAPF32=ze=new Float32Array(oe),t.HEAPF64=ke=new Float64Array(oe)}var Si=5267040,yi=24128,hi=t.TOTAL_MEMORY||33554432;t.buffer?$t=t.buffer:$t=new ArrayBuffer(hi),hi=$t.byteLength,nr($t),Ee[yi>>2]=Si;function Kr(oe){for(;oe.length>0;){var we=oe.shift();if(typeof we=="function"){we();continue}var We=we.func;typeof We=="number"?we.arg===void 0?t.dynCall_v(We):t.dynCall_vi(We,we.arg):We(we.arg===void 0?null:we.arg)}}var zr=[],Br=[],Fe=[],Sr=[];function $r(){if(t.preRun)for(typeof t.preRun=="function"&&(t.preRun=[t.preRun]);t.preRun.length;)rn(t.preRun.shift());Kr(zr)}function Ie(){Kr(Br)}function en(){Kr(Fe)}function xi(){if(t.postRun)for(typeof t.postRun=="function"&&(t.postRun=[t.postRun]);t.postRun.length;)fn(t.postRun.shift());Kr(Sr)}function rn(oe){zr.unshift(oe)}function fn(oe){Sr.unshift(oe)}var Er=Math.abs,ae=Math.ceil,Gn=Math.floor,an=Math.min,Ji=0,$i=null,zo=null;function Pu(oe){Ji++,t.monitorRunDependencies&&t.monitorRunDependencies(Ji)}function Rl(oe){if(Ji--,t.monitorRunDependencies&&t.monitorRunDependencies(Ji),Ji==0&&($i!==null&&(clearInterval($i),$i=null),zo)){var we=zo;zo=null,we()}}t.preloadedImages={},t.preloadedAudios={};var Zo=null,kl="data:application/octet-stream;base64,";function rl(oe){return String.prototype.startsWith?oe.startsWith(kl):oe.indexOf(kl)===0}var Go,Ne;Zo="data:application/octet-stream;base64,AAAAAAAAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAGAAAAAQAAAAQAAAADAAAABgAAAAUAAAACAAAAAAAAAAIAAAADAAAAAQAAAAQAAAAGAAAAAAAAAAUAAAADAAAABgAAAAQAAAAFAAAAAAAAAAEAAAACAAAABAAAAAUAAAAGAAAAAAAAAAIAAAADAAAAAQAAAAUAAAACAAAAAAAAAAEAAAADAAAABgAAAAQAAAAGAAAAAAAAAAUAAAACAAAAAQAAAAQAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAAAAAAEAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAYAAAAAAAAABQAAAAAAAAAAAAAABAAAAAUAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAYAAAAAAAAABgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAgAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAMAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAAEAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABQAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAYAAAAAAAAAAQAAAAIAAAADAAAABAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAIAAAAAAAAAAAAAAAYAAAAAAAAAAwAAAAIAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAFAAAABAAAAAAAAAABAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAYAAAAAAAAABAAAAAAAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAgAAAAQAAAADAAAACAAAAAEAAAAHAAAABgAAAAkAAAAAAAAAAwAAAAIAAAACAAAABgAAAAoAAAALAAAAAAAAAAEAAAAFAAAAAwAAAA0AAAABAAAABwAAAAQAAAAMAAAAAAAAAAQAAAB/AAAADwAAAAgAAAADAAAAAAAAAAwAAAAFAAAAAgAAABIAAAAKAAAACAAAAAAAAAAQAAAABgAAAA4AAAALAAAAEQAAAAEAAAAJAAAAAgAAAAcAAAAVAAAACQAAABMAAAADAAAADQAAAAEAAAAIAAAABQAAABYAAAAQAAAABAAAAAAAAAAPAAAACQAAABMAAAAOAAAAFAAAAAEAAAAHAAAABgAAAAoAAAALAAAAGAAAABcAAAAFAAAAAgAAABIAAAALAAAAEQAAABcAAAAZAAAAAgAAAAYAAAAKAAAADAAAABwAAAANAAAAGgAAAAQAAAAPAAAAAwAAAA0AAAAaAAAAFQAAAB0AAAADAAAADAAAAAcAAAAOAAAAfwAAABEAAAAbAAAACQAAABQAAAAGAAAADwAAABYAAAAcAAAAHwAAAAQAAAAIAAAADAAAABAAAAASAAAAIQAAAB4AAAAIAAAABQAAABYAAAARAAAACwAAAA4AAAAGAAAAIwAAABkAAAAbAAAAEgAAABgAAAAeAAAAIAAAAAUAAAAKAAAAEAAAABMAAAAiAAAAFAAAACQAAAAHAAAAFQAAAAkAAAAUAAAADgAAABMAAAAJAAAAKAAAABsAAAAkAAAAFQAAACYAAAATAAAAIgAAAA0AAAAdAAAABwAAABYAAAAQAAAAKQAAACEAAAAPAAAACAAAAB8AAAAXAAAAGAAAAAsAAAAKAAAAJwAAACUAAAAZAAAAGAAAAH8AAAAgAAAAJQAAAAoAAAAXAAAAEgAAABkAAAAXAAAAEQAAAAsAAAAtAAAAJwAAACMAAAAaAAAAKgAAAB0AAAArAAAADAAAABwAAAANAAAAGwAAACgAAAAjAAAALgAAAA4AAAAUAAAAEQAAABwAAAAfAAAAKgAAACwAAAAMAAAADwAAABoAAAAdAAAAKwAAACYAAAAvAAAADQAAABoAAAAVAAAAHgAAACAAAAAwAAAAMgAAABAAAAASAAAAIQAAAB8AAAApAAAALAAAADUAAAAPAAAAFgAAABwAAAAgAAAAHgAAABgAAAASAAAANAAAADIAAAAlAAAAIQAAAB4AAAAxAAAAMAAAABYAAAAQAAAAKQAAACIAAAATAAAAJgAAABUAAAA2AAAAJAAAADMAAAAjAAAALgAAAC0AAAA4AAAAEQAAABsAAAAZAAAAJAAAABQAAAAiAAAAEwAAADcAAAAoAAAANgAAACUAAAAnAAAANAAAADkAAAAYAAAAFwAAACAAAAAmAAAAfwAAACIAAAAzAAAAHQAAAC8AAAAVAAAAJwAAACUAAAAZAAAAFwAAADsAAAA5AAAALQAAACgAAAAbAAAAJAAAABQAAAA8AAAALgAAADcAAAApAAAAMQAAADUAAAA9AAAAFgAAACEAAAAfAAAAKgAAADoAAAArAAAAPgAAABwAAAAsAAAAGgAAACsAAAA+AAAALwAAAEAAAAAaAAAAKgAAAB0AAAAsAAAANQAAADoAAABBAAAAHAAAAB8AAAAqAAAALQAAACcAAAAjAAAAGQAAAD8AAAA7AAAAOAAAAC4AAAA8AAAAOAAAAEQAAAAbAAAAKAAAACMAAAAvAAAAJgAAACsAAAAdAAAARQAAADMAAABAAAAAMAAAADEAAAAeAAAAIQAAAEMAAABCAAAAMgAAADEAAAB/AAAAPQAAAEIAAAAhAAAAMAAAACkAAAAyAAAAMAAAACAAAAAeAAAARgAAAEMAAAA0AAAAMwAAAEUAAAA2AAAARwAAACYAAAAvAAAAIgAAADQAAAA5AAAARgAAAEoAAAAgAAAAJQAAADIAAAA1AAAAPQAAAEEAAABLAAAAHwAAACkAAAAsAAAANgAAAEcAAAA3AAAASQAAACIAAAAzAAAAJAAAADcAAAAoAAAANgAAACQAAABIAAAAPAAAAEkAAAA4AAAARAAAAD8AAABNAAAAIwAAAC4AAAAtAAAAOQAAADsAAABKAAAATgAAACUAAAAnAAAANAAAADoAAAB/AAAAPgAAAEwAAAAsAAAAQQAAACoAAAA7AAAAPwAAAE4AAABPAAAAJwAAAC0AAAA5AAAAPAAAAEgAAABEAAAAUAAAACgAAAA3AAAALgAAAD0AAAA1AAAAMQAAACkAAABRAAAASwAAAEIAAAA+AAAAKwAAADoAAAAqAAAAUgAAAEAAAABMAAAAPwAAAH8AAAA4AAAALQAAAE8AAAA7AAAATQAAAEAAAAAvAAAAPgAAACsAAABUAAAARQAAAFIAAABBAAAAOgAAADUAAAAsAAAAVgAAAEwAAABLAAAAQgAAAEMAAABRAAAAVQAAADEAAAAwAAAAPQAAAEMAAABCAAAAMgAAADAAAABXAAAAVQAAAEYAAABEAAAAOAAAADwAAAAuAAAAWgAAAE0AAABQAAAARQAAADMAAABAAAAALwAAAFkAAABHAAAAVAAAAEYAAABDAAAANAAAADIAAABTAAAAVwAAAEoAAABHAAAAWQAAAEkAAABbAAAAMwAAAEUAAAA2AAAASAAAAH8AAABJAAAANwAAAFAAAAA8AAAAWAAAAEkAAABbAAAASAAAAFgAAAA2AAAARwAAADcAAABKAAAATgAAAFMAAABcAAAANAAAADkAAABGAAAASwAAAEEAAAA9AAAANQAAAF4AAABWAAAAUQAAAEwAAABWAAAAUgAAAGAAAAA6AAAAQQAAAD4AAABNAAAAPwAAAEQAAAA4AAAAXQAAAE8AAABaAAAATgAAAEoAAAA7AAAAOQAAAF8AAABcAAAATwAAAE8AAABOAAAAPwAAADsAAABdAAAAXwAAAE0AAABQAAAARAAAAEgAAAA8AAAAYwAAAFoAAABYAAAAUQAAAFUAAABeAAAAZQAAAD0AAABCAAAASwAAAFIAAABgAAAAVAAAAGIAAAA+AAAATAAAAEAAAABTAAAAfwAAAEoAAABGAAAAZAAAAFcAAABcAAAAVAAAAEUAAABSAAAAQAAAAGEAAABZAAAAYgAAAFUAAABXAAAAZQAAAGYAAABCAAAAQwAAAFEAAABWAAAATAAAAEsAAABBAAAAaAAAAGAAAABeAAAAVwAAAFMAAABmAAAAZAAAAEMAAABGAAAAVQAAAFgAAABIAAAAWwAAAEkAAABjAAAAUAAAAGkAAABZAAAAYQAAAFsAAABnAAAARQAAAFQAAABHAAAAWgAAAE0AAABQAAAARAAAAGoAAABdAAAAYwAAAFsAAABJAAAAWQAAAEcAAABpAAAAWAAAAGcAAABcAAAAUwAAAE4AAABKAAAAbAAAAGQAAABfAAAAXQAAAE8AAABaAAAATQAAAG0AAABfAAAAagAAAF4AAABWAAAAUQAAAEsAAABrAAAAaAAAAGUAAABfAAAAXAAAAE8AAABOAAAAbQAAAGwAAABdAAAAYAAAAGgAAABiAAAAbgAAAEwAAABWAAAAUgAAAGEAAAB/AAAAYgAAAFQAAABnAAAAWQAAAG8AAABiAAAAbgAAAGEAAABvAAAAUgAAAGAAAABUAAAAYwAAAFAAAABpAAAAWAAAAGoAAABaAAAAcQAAAGQAAABmAAAAUwAAAFcAAABsAAAAcgAAAFwAAABlAAAAZgAAAGsAAABwAAAAUQAAAFUAAABeAAAAZgAAAGUAAABXAAAAVQAAAHIAAABwAAAAZAAAAGcAAABbAAAAYQAAAFkAAAB0AAAAaQAAAG8AAABoAAAAawAAAG4AAABzAAAAVgAAAF4AAABgAAAAaQAAAFgAAABnAAAAWwAAAHEAAABjAAAAdAAAAGoAAABdAAAAYwAAAFoAAAB1AAAAbQAAAHEAAABrAAAAfwAAAGUAAABeAAAAcwAAAGgAAABwAAAAbAAAAGQAAABfAAAAXAAAAHYAAAByAAAAbQAAAG0AAABsAAAAXQAAAF8AAAB1AAAAdgAAAGoAAABuAAAAYgAAAGgAAABgAAAAdwAAAG8AAABzAAAAbwAAAGEAAABuAAAAYgAAAHQAAABnAAAAdwAAAHAAAABrAAAAZgAAAGUAAAB4AAAAcwAAAHIAAABxAAAAYwAAAHQAAABpAAAAdQAAAGoAAAB5AAAAcgAAAHAAAABkAAAAZgAAAHYAAAB4AAAAbAAAAHMAAABuAAAAawAAAGgAAAB4AAAAdwAAAHAAAAB0AAAAZwAAAHcAAABvAAAAcQAAAGkAAAB5AAAAdQAAAH8AAABtAAAAdgAAAHEAAAB5AAAAagAAAHYAAAB4AAAAbAAAAHIAAAB1AAAAeQAAAG0AAAB3AAAAbwAAAHMAAABuAAAAeQAAAHQAAAB4AAAAeAAAAHMAAAByAAAAcAAAAHkAAAB3AAAAdgAAAHkAAAB0AAAAeAAAAHcAAAB1AAAAcQAAAHYAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAACAAAABQAAAAEAAAAAAAAA/////wEAAAAAAAAAAwAAAAQAAAACAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAABQAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAEAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAFAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAAAAAABAAAAAwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAUAAAABAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABAAAAAUAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAIAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAD/////AQAAAAAAAAADAAAABAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAFAAAAAAAAAAAAAAAFAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAUAAAABAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAEAAAD//////////wEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAAAAAAAAAAABAAAAAgAAAAYAAAAEAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAAAAAAAAAAAAQAAAAEAAAAFAAAABgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAACAAAAAAAAAAAAAAABAAAAAwAAAAcAAAAGAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAADgAAAAIAAAAAAAAAAAAAAAEAAAAAAAAACQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAMAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAIAAAAAAAAAAAAAAAEAAAAEAAAACAAAAAoAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAALAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAAAAAAAAAAAAQAAAAsAAAAPAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAIAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAgAAAAAAAAAAAAAAAQAAAAwAAAAQAAAADAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAoAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAADwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAACAAAAAAAAAAAAAAABAAAACgAAABMAAAAIAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAQAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAACQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAAAAAAAAAAAAAEAAAANAAAAEQAAAA0AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAARAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA0AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAACAAAAAAAAAAAAAAABAAAADgAAABIAAAAPAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAADwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAASAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABIAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAgAAAAAAAAAAAAAAAQAAAP//////////EwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEgAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAASAAAAAAAAABgAAAAAAAAAIQAAAAAAAAAeAAAAAAAAACAAAAADAAAAMQAAAAEAAAAwAAAAAwAAADIAAAADAAAACAAAAAAAAAAFAAAABQAAAAoAAAAFAAAAFgAAAAAAAAAQAAAAAAAAABIAAAAAAAAAKQAAAAEAAAAhAAAAAAAAAB4AAAAAAAAABAAAAAAAAAAAAAAABQAAAAIAAAAFAAAADwAAAAEAAAAIAAAAAAAAAAUAAAAFAAAAHwAAAAEAAAAWAAAAAAAAABAAAAAAAAAAAgAAAAAAAAAGAAAAAAAAAA4AAAAAAAAACgAAAAAAAAALAAAAAAAAABEAAAADAAAAGAAAAAEAAAAXAAAAAwAAABkAAAADAAAAAAAAAAAAAAABAAAABQAAAAkAAAAFAAAABQAAAAAAAAACAAAAAAAAAAYAAAAAAAAAEgAAAAEAAAAKAAAAAAAAAAsAAAAAAAAABAAAAAEAAAADAAAABQAAAAcAAAAFAAAACAAAAAEAAAAAAAAAAAAAAAEAAAAFAAAAEAAAAAEAAAAFAAAAAAAAAAIAAAAAAAAABwAAAAAAAAAVAAAAAAAAACYAAAAAAAAACQAAAAAAAAATAAAAAAAAACIAAAADAAAADgAAAAEAAAAUAAAAAwAAACQAAAADAAAAAwAAAAAAAAANAAAABQAAAB0AAAAFAAAAAQAAAAAAAAAHAAAAAAAAABUAAAAAAAAABgAAAAEAAAAJAAAAAAAAABMAAAAAAAAABAAAAAIAAAAMAAAABQAAABoAAAAFAAAAAAAAAAEAAAADAAAAAAAAAA0AAAAFAAAAAgAAAAEAAAABAAAAAAAAAAcAAAAAAAAAGgAAAAAAAAAqAAAAAAAAADoAAAAAAAAAHQAAAAAAAAArAAAAAAAAAD4AAAADAAAAJgAAAAEAAAAvAAAAAwAAAEAAAAADAAAADAAAAAAAAAAcAAAABQAAACwAAAAFAAAADQAAAAAAAAAaAAAAAAAAACoAAAAAAAAAFQAAAAEAAAAdAAAAAAAAACsAAAAAAAAABAAAAAMAAAAPAAAABQAAAB8AAAAFAAAAAwAAAAEAAAAMAAAAAAAAABwAAAAFAAAABwAAAAEAAAANAAAAAAAAABoAAAAAAAAAHwAAAAAAAAApAAAAAAAAADEAAAAAAAAALAAAAAAAAAA1AAAAAAAAAD0AAAADAAAAOgAAAAEAAABBAAAAAwAAAEsAAAADAAAADwAAAAAAAAAWAAAABQAAACEAAAAFAAAAHAAAAAAAAAAfAAAAAAAAACkAAAAAAAAAKgAAAAEAAAAsAAAAAAAAADUAAAAAAAAABAAAAAQAAAAIAAAABQAAABAAAAAFAAAADAAAAAEAAAAPAAAAAAAAABYAAAAFAAAAGgAAAAEAAAAcAAAAAAAAAB8AAAAAAAAAMgAAAAAAAAAwAAAAAAAAADEAAAADAAAAIAAAAAAAAAAeAAAAAwAAACEAAAADAAAAGAAAAAMAAAASAAAAAwAAABAAAAADAAAARgAAAAAAAABDAAAAAAAAAEIAAAADAAAANAAAAAMAAAAyAAAAAAAAADAAAAAAAAAAJQAAAAMAAAAgAAAAAAAAAB4AAAADAAAAUwAAAAAAAABXAAAAAwAAAFUAAAADAAAASgAAAAMAAABGAAAAAAAAAEMAAAAAAAAAOQAAAAEAAAA0AAAAAwAAADIAAAAAAAAAGQAAAAAAAAAXAAAAAAAAABgAAAADAAAAEQAAAAAAAAALAAAAAwAAAAoAAAADAAAADgAAAAMAAAAGAAAAAwAAAAIAAAADAAAALQAAAAAAAAAnAAAAAAAAACUAAAADAAAAIwAAAAMAAAAZAAAAAAAAABcAAAAAAAAAGwAAAAMAAAARAAAAAAAAAAsAAAADAAAAPwAAAAAAAAA7AAAAAwAAADkAAAADAAAAOAAAAAMAAAAtAAAAAAAAACcAAAAAAAAALgAAAAMAAAAjAAAAAwAAABkAAAAAAAAAJAAAAAAAAAAUAAAAAAAAAA4AAAADAAAAIgAAAAAAAAATAAAAAwAAAAkAAAADAAAAJgAAAAMAAAAVAAAAAwAAAAcAAAADAAAANwAAAAAAAAAoAAAAAAAAABsAAAADAAAANgAAAAMAAAAkAAAAAAAAABQAAAAAAAAAMwAAAAMAAAAiAAAAAAAAABMAAAADAAAASAAAAAAAAAA8AAAAAwAAAC4AAAADAAAASQAAAAMAAAA3AAAAAAAAACgAAAAAAAAARwAAAAMAAAA2AAAAAwAAACQAAAAAAAAAQAAAAAAAAAAvAAAAAAAAACYAAAADAAAAPgAAAAAAAAArAAAAAwAAAB0AAAADAAAAOgAAAAMAAAAqAAAAAwAAABoAAAADAAAAVAAAAAAAAABFAAAAAAAAADMAAAADAAAAUgAAAAMAAABAAAAAAAAAAC8AAAAAAAAATAAAAAMAAAA+AAAAAAAAACsAAAADAAAAYQAAAAAAAABZAAAAAwAAAEcAAAADAAAAYgAAAAMAAABUAAAAAAAAAEUAAAAAAAAAYAAAAAMAAABSAAAAAwAAAEAAAAAAAAAASwAAAAAAAABBAAAAAAAAADoAAAADAAAAPQAAAAAAAAA1AAAAAwAAACwAAAADAAAAMQAAAAMAAAApAAAAAwAAAB8AAAADAAAAXgAAAAAAAABWAAAAAAAAAEwAAAADAAAAUQAAAAMAAABLAAAAAAAAAEEAAAAAAAAAQgAAAAMAAAA9AAAAAAAAADUAAAADAAAAawAAAAAAAABoAAAAAwAAAGAAAAADAAAAZQAAAAMAAABeAAAAAAAAAFYAAAAAAAAAVQAAAAMAAABRAAAAAwAAAEsAAAAAAAAAOQAAAAAAAAA7AAAAAAAAAD8AAAADAAAASgAAAAAAAABOAAAAAwAAAE8AAAADAAAAUwAAAAMAAABcAAAAAwAAAF8AAAADAAAAJQAAAAAAAAAnAAAAAwAAAC0AAAADAAAANAAAAAAAAAA5AAAAAAAAADsAAAAAAAAARgAAAAMAAABKAAAAAAAAAE4AAAADAAAAGAAAAAAAAAAXAAAAAwAAABkAAAADAAAAIAAAAAMAAAAlAAAAAAAAACcAAAADAAAAMgAAAAMAAAA0AAAAAAAAADkAAAAAAAAALgAAAAAAAAA8AAAAAAAAAEgAAAADAAAAOAAAAAAAAABEAAAAAwAAAFAAAAADAAAAPwAAAAMAAABNAAAAAwAAAFoAAAADAAAAGwAAAAAAAAAoAAAAAwAAADcAAAADAAAAIwAAAAAAAAAuAAAAAAAAADwAAAAAAAAALQAAAAMAAAA4AAAAAAAAAEQAAAADAAAADgAAAAAAAAAUAAAAAwAAACQAAAADAAAAEQAAAAMAAAAbAAAAAAAAACgAAAADAAAAGQAAAAMAAAAjAAAAAAAAAC4AAAAAAAAARwAAAAAAAABZAAAAAAAAAGEAAAADAAAASQAAAAAAAABbAAAAAwAAAGcAAAADAAAASAAAAAMAAABYAAAAAwAAAGkAAAADAAAAMwAAAAAAAABFAAAAAwAAAFQAAAADAAAANgAAAAAAAABHAAAAAAAAAFkAAAAAAAAANwAAAAMAAABJAAAAAAAAAFsAAAADAAAAJgAAAAAAAAAvAAAAAwAAAEAAAAADAAAAIgAAAAMAAAAzAAAAAAAAAEUAAAADAAAAJAAAAAMAAAA2AAAAAAAAAEcAAAAAAAAAYAAAAAAAAABoAAAAAAAAAGsAAAADAAAAYgAAAAAAAABuAAAAAwAAAHMAAAADAAAAYQAAAAMAAABvAAAAAwAAAHcAAAADAAAATAAAAAAAAABWAAAAAwAAAF4AAAADAAAAUgAAAAAAAABgAAAAAAAAAGgAAAAAAAAAVAAAAAMAAABiAAAAAAAAAG4AAAADAAAAOgAAAAAAAABBAAAAAwAAAEsAAAADAAAAPgAAAAMAAABMAAAAAAAAAFYAAAADAAAAQAAAAAMAAABSAAAAAAAAAGAAAAAAAAAAVQAAAAAAAABXAAAAAAAAAFMAAAADAAAAZQAAAAAAAABmAAAAAwAAAGQAAAADAAAAawAAAAMAAABwAAAAAwAAAHIAAAADAAAAQgAAAAAAAABDAAAAAwAAAEYAAAADAAAAUQAAAAAAAABVAAAAAAAAAFcAAAAAAAAAXgAAAAMAAABlAAAAAAAAAGYAAAADAAAAMQAAAAAAAAAwAAAAAwAAADIAAAADAAAAPQAAAAMAAABCAAAAAAAAAEMAAAADAAAASwAAAAMAAABRAAAAAAAAAFUAAAAAAAAAXwAAAAAAAABcAAAAAAAAAFMAAAAAAAAATwAAAAAAAABOAAAAAAAAAEoAAAADAAAAPwAAAAEAAAA7AAAAAwAAADkAAAADAAAAbQAAAAAAAABsAAAAAAAAAGQAAAAFAAAAXQAAAAEAAABfAAAAAAAAAFwAAAAAAAAATQAAAAEAAABPAAAAAAAAAE4AAAAAAAAAdQAAAAQAAAB2AAAABQAAAHIAAAAFAAAAagAAAAEAAABtAAAAAAAAAGwAAAAAAAAAWgAAAAEAAABdAAAAAQAAAF8AAAAAAAAAWgAAAAAAAABNAAAAAAAAAD8AAAAAAAAAUAAAAAAAAABEAAAAAAAAADgAAAADAAAASAAAAAEAAAA8AAAAAwAAAC4AAAADAAAAagAAAAAAAABdAAAAAAAAAE8AAAAFAAAAYwAAAAEAAABaAAAAAAAAAE0AAAAAAAAAWAAAAAEAAABQAAAAAAAAAEQAAAAAAAAAdQAAAAMAAABtAAAABQAAAF8AAAAFAAAAcQAAAAEAAABqAAAAAAAAAF0AAAAAAAAAaQAAAAEAAABjAAAAAQAAAFoAAAAAAAAAaQAAAAAAAABYAAAAAAAAAEgAAAAAAAAAZwAAAAAAAABbAAAAAAAAAEkAAAADAAAAYQAAAAEAAABZAAAAAwAAAEcAAAADAAAAcQAAAAAAAABjAAAAAAAAAFAAAAAFAAAAdAAAAAEAAABpAAAAAAAAAFgAAAAAAAAAbwAAAAEAAABnAAAAAAAAAFsAAAAAAAAAdQAAAAIAAABqAAAABQAAAFoAAAAFAAAAeQAAAAEAAABxAAAAAAAAAGMAAAAAAAAAdwAAAAEAAAB0AAAAAQAAAGkAAAAAAAAAdwAAAAAAAABvAAAAAAAAAGEAAAAAAAAAcwAAAAAAAABuAAAAAAAAAGIAAAADAAAAawAAAAEAAABoAAAAAwAAAGAAAAADAAAAeQAAAAAAAAB0AAAAAAAAAGcAAAAFAAAAeAAAAAEAAAB3AAAAAAAAAG8AAAAAAAAAcAAAAAEAAABzAAAAAAAAAG4AAAAAAAAAdQAAAAEAAABxAAAABQAAAGkAAAAFAAAAdgAAAAEAAAB5AAAAAAAAAHQAAAAAAAAAcgAAAAEAAAB4AAAAAQAAAHcAAAAAAAAAcgAAAAAAAABwAAAAAAAAAGsAAAAAAAAAZAAAAAAAAABmAAAAAAAAAGUAAAADAAAAUwAAAAEAAABXAAAAAwAAAFUAAAADAAAAdgAAAAAAAAB4AAAAAAAAAHMAAAAFAAAAbAAAAAEAAAByAAAAAAAAAHAAAAAAAAAAXAAAAAEAAABkAAAAAAAAAGYAAAAAAAAAdQAAAAAAAAB5AAAABQAAAHcAAAAFAAAAbQAAAAEAAAB2AAAAAAAAAHgAAAAAAAAAXwAAAAEAAABsAAAAAQAAAHIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAGAAAAAgAAAAUAAAABAAAABAAAAAAAAAAAAAAABQAAAAMAAAABAAAABgAAAAQAAAACAAAAAAAAAH6iBfbytuk/Gq6akm/58z/Xrm0Liez0P5doSdOpSwRAWs602ULg8D/dT7Rcbo/1v1N1RQHFNOM/g9Snx7HW3L8HWsP8Q3jfP6VwOLosutk/9rjk1YQcxj+gnmKMsNn6P/HDeuPFY+M/YHwDjqKhB0Ci19/fCVrbP4UxKkDWOP6/pvljWa09tL9wi7wrQXjnv/Z6yLImkM2/3yTlOzY14D+m+WNZrT20PzwKVQnrQwNA9nrIsiaQzT/g40rFrRQFwPa45NWEHMa/kbslHEZq97/xw3rjxWPjv4cLC2SMBci/otff3wla27+rKF5oIAv0P1N1RQHFNOO/iDJPGyWHBUAHWsP8Q3jfvwQf/by16gXAfqIF9vK26b8XrO0Vh0r+v9eubQuJ7PS/BxLrA0ZZ479azrTZQuDwv1MK1EuItPw/yscgV9Z6FkAwHBR2WjQMQJNRzXsQ5vY/GlUHVJYKF0DONuFv2lMNQNCGZ28QJfk/0WUwoIL36D8ggDOMQuATQNqMOeAy/wZAWFYOYM+M2z/LWC4uH3oSQDE+LyTsMgRAkJzhRGWFGEDd4soovCQQQKqk0DJMEP8/rGmNdwOLBUAW2X/9xCbjP4hu3dcqJhNAzuYItRvdB0CgzW3zJW/sPxotm/Y2TxRAQAk9XmdDDEC1Kx9MKgT3P1M+NctcghZAFVqcLlb0C0Bgzd3sB2b2P77mZDPUWhZAFROHJpUGCEDAfma5CxXtPz1DWq/zYxRAmhYY5824F0DOuQKWSbAOQNCMqrvu3fs/L6DR22K2wT9nAAxPBU8RQGiN6mW43AFAZhu25b633D8c1YgmzowSQNM25BRKWARArGS08/lNxD+LFssHwmMRQLC5aNcxBgJABL9HT0WRF0CjCmJmOGEOQHsuaVzMP/s/TWJCaGGwBUCeu1PAPLzjP9nqN9DZOBNAKE4JcydbCkCGtbd1qjPzP8dgm9U8jhVAtPeKTkVwDkCeCLss5l37P401XMPLmBdAFd29VMVQDUBg0yA55h75Pz6odcYLCRdApBM4rBrkAkDyAVWgQxbRP4XDMnK20hFAymLlF7EmzD8GUgo9XBHlP3lbK7T9COc/k+OhPthhy7+YGEpnrOvCPzBFhLs15u4/epbqB6H4uz9IuuLF5svev6lzLKY31es/CaQ0envF5z8ZY0xlUADXv7zaz7HYEuI/CfbK1sn16T8uAQfWwxLWPzKn/YuFN94/5KdbC1AFu793fyCSnlfvPzK2y4doAMY/NRg5t1/X6b/shq4QJaHDP5yNIAKPOeI/vpn7BSE30r/X4YQrO6nrv78Ziv/Thto/DqJ1Y6+y5z9l51NaxFrlv8QlA65HOLS/86dxiEc96z+Hj0+LFjneP6LzBZ8LTc2/DaJ1Y6+y579l51NaxFrlP8QlA65HOLQ/8qdxiEc967+Jj0+LFjnev6LzBZ8LTc0/1qdbC1AFuz93fyCSnlfvvzK2y4doAMa/NRg5t1/X6T/vhq4QJaHDv5yNIAKPOeK/wJn7BSE30j/W4YQrO6nrP78Ziv/Thtq/CaQ0envF578XY0xlUADXP7zaz7HYEuK/CvbK1sn16b8rAQfWwxLWvzKn/YuFN96/zWLlF7EmzL8GUgo9XBHlv3lbK7T9COe/kOOhPthhyz+cGEpnrOvCvzBFhLs15u6/c5bqB6H4u79IuuLF5sveP6lzLKY31eu/AQAAAP////8HAAAA/////zEAAAD/////VwEAAP////9hCQAA/////6dBAAD/////kcsBAP/////3kAwA/////8H2VwAAAAAAAAAAAAAAAAACAAAA/////w4AAAD/////YgAAAP////+uAgAA/////8ISAAD/////ToMAAP////8ilwMA/////+4hGQD/////gu2vAAAAAAAAAAAAAAAAAAAAAAACAAAA//////////8BAAAAAwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////////////////////AQAAAAAAAAACAAAA////////////////AwAAAP//////////////////////////////////////////////////////////AgAAAP//////////AQAAAAAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD/////////////////////AQAAAP///////////////wIAAAD///////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAD///////////////8CAAAAAQAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8BAAAAAgAAAP///////////////wAAAAD/////////////////////AwAAAP///////////////////////////////wIAAAD///////////////8BAAAA/////////////////////wAAAAD/////////////////////AwAAAP////////////////////////////////////////////////////8DAAAA/////////////////////wAAAAABAAAA//////////8CAAAA//////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAA////////////////AgAAAAAAAAABAAAA//////////////////////////////////////////////////////////////////////////8DAAAAAQAAAP//////////AgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAACAAAAAAAAAAIAAAABAAAAAQAAAAIAAAACAAAAAAAAAAUAAAAFAAAAAAAAAAIAAAACAAAAAwAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAgAAAAEAAAACAAAAAgAAAAIAAAAAAAAABQAAAAYAAAAAAAAAAgAAAAIAAAADAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAAAAAACAAAAAQAAAAMAAAACAAAAAgAAAAAAAAAFAAAABwAAAAAAAAACAAAAAgAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAACAAAAAAAAAAIAAAABAAAABAAAAAIAAAACAAAAAAAAAAUAAAAIAAAAAAAAAAIAAAACAAAAAwAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAIAAAAAAAAAAgAAAAEAAAAAAAAAAgAAAAIAAAAAAAAABQAAAAkAAAAAAAAAAgAAAAIAAAADAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAgAAAAIAAAAAAAAAAwAAAA4AAAACAAAAAAAAAAIAAAADAAAAAAAAAAAAAAACAAAAAgAAAAMAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAACAAAAAgAAAAAAAAADAAAACgAAAAIAAAAAAAAAAgAAAAMAAAABAAAAAAAAAAIAAAACAAAAAwAAAAcAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAIAAAACAAAAAAAAAAMAAAALAAAAAgAAAAAAAAACAAAAAwAAAAIAAAAAAAAAAgAAAAIAAAADAAAACAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAgAAAAIAAAAAAAAAAwAAAAwAAAACAAAAAAAAAAIAAAADAAAAAwAAAAAAAAACAAAAAgAAAAMAAAAJAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAACAAAAAgAAAAAAAAADAAAADQAAAAIAAAAAAAAAAgAAAAMAAAAEAAAAAAAAAAIAAAACAAAAAwAAAAoAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAIAAAACAAAAAAAAAAMAAAAGAAAAAgAAAAAAAAACAAAAAwAAAA8AAAAAAAAAAgAAAAIAAAADAAAACwAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAAgAAAAIAAAAAAAAAAwAAAAcAAAACAAAAAAAAAAIAAAADAAAAEAAAAAAAAAACAAAAAgAAAAMAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAACAAAAAgAAAAAAAAADAAAACAAAAAIAAAAAAAAAAgAAAAMAAAARAAAAAAAAAAIAAAACAAAAAwAAAA0AAAAAAAAAAAAAAAAAAAAAAAAACAAAAAIAAAACAAAAAAAAAAMAAAAJAAAAAgAAAAAAAAACAAAAAwAAABIAAAAAAAAAAgAAAAIAAAADAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAJAAAAAgAAAAIAAAAAAAAAAwAAAAUAAAACAAAAAAAAAAIAAAADAAAAEwAAAAAAAAACAAAAAgAAAAMAAAAPAAAAAAAAAAAAAAAAAAAAAAAAABAAAAACAAAAAAAAAAIAAAABAAAAEwAAAAIAAAACAAAAAAAAAAUAAAAKAAAAAAAAAAIAAAACAAAAAwAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEQAAAAIAAAAAAAAAAgAAAAEAAAAPAAAAAgAAAAIAAAAAAAAABQAAAAsAAAAAAAAAAgAAAAIAAAADAAAAEQAAAAAAAAAAAAAAAAAAAAAAAAASAAAAAgAAAAAAAAACAAAAAQAAABAAAAACAAAAAgAAAAAAAAAFAAAADAAAAAAAAAACAAAAAgAAAAMAAAASAAAAAAAAAAAAAAAAAAAAAAAAABMAAAACAAAAAAAAAAIAAAABAAAAEQAAAAIAAAACAAAAAAAAAAUAAAANAAAAAAAAAAIAAAACAAAAAwAAABMAAAAAAAAAAAAAAAAAAAAAAAAADwAAAAIAAAAAAAAAAgAAAAEAAAASAAAAAgAAAAIAAAAAAAAABQAAAA4AAAAAAAAAAgAAAAIAAAADAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAEAAAACAAAAAQAAAAAAAAACAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAAAAAACAAAAAQAAAAAAAAABAAAAAgAAAAAAAAAAAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAABAAAAAAAAAAIAAAACAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAEAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAQAAAAAAAAABQAAAAUAAAAAAAAAAQAAAAAAAAAAAAAAOgehWlKfUEEz1zLi+JsiQa2og3wcMfVAWCbHorc0yEDi+Yn/Y6mbQJ11/mfsnG9At6bnG4UQQkBvMCQWKqUUQJVmwwswmOc/3hVgVBL3uj//qqOEOdGOPw/WDN4gnGE/H3ANkCUgND+AA8btKgAHPwTXBqJVSdo+XfRQAqsKrj4fc+zLYbSPQklEmCZHv2FCUP+uDso1NEKYtPhwphUHQptxnyFXYdpB7CddZAMmrkGAt1AxSTqBQUibBVdTsFNBSuX3MV+AJkFocv82SLf5QAqmgj7AY81A23VDSEnLoEDGEJVSeDFzQDYrqvBk70VA8U157pcRGUBWfEF+ZKbsP7KBdLHZTpFAqKYk69AqekDbeGY41MdjQD8AZzHK501A1vcrrjubNkD5LnquvBYhQCbiRRD71QlAqt72EbOH8z8Eu+jL1YbdP4uaox/xUcY/abedg1XfsD+BsUdzJ4KZP5wE9YFySIM/rW1kAKMpbT+rZFthVRhWPy4PKlXIs0A/qMZLlwDnMEHByqEF0I0ZQQYSFD8lUQNBPpY+dFs07UAH8BZImBPWQN9RY0I0sMBA2T7kLfc6qUByFYvfhBKTQMq+0Mis1XxA0XQbeQXMZUBJJ5aEGXpQQP7/SY0a6ThAaMD92b/UIkAs8s8yqXoMQNIegOvCk/U/aOi7NZJP4D8AAAAA/////wAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAD/////AAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAA/////wAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAP////8AAAAABQAAAAAAAAAAAAAAAAAAAAAAAAD/////BQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAA/////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAABQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAQAAAAAAAAABAAAAAAAAAAUAAAABAAAAAQAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAEAAQAAAQEAAAAAAAEAAAABAAAAAQABAAAAAAAAAAAAAAAAAAAAAAcAAAAHAAAAAQAAAAIAAAAEAAAAAwAAAAAAAAAAAAAABwAAAAMAAAABAAAAAgAAAAUAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAACAAAAAQAAAAMAAAAOAAAABgAAAAsAAAACAAAABwAAAAEAAAAYAAAABQAAAAoAAAABAAAABgAAAAAAAAAmAAAABwAAAAwAAAADAAAACAAAAAIAAAAxAAAACQAAAA4AAAAAAAAABQAAAAQAAAA6AAAACAAAAA0AAAAEAAAACQAAAAMAAAA/AAAACwAAAAYAAAAPAAAACgAAABAAAABIAAAADAAAAAcAAAAQAAAACwAAABEAAABTAAAACgAAAAUAAAATAAAADgAAAA8AAABhAAAADQAAAAgAAAARAAAADAAAABIAAABrAAAADgAAAAkAAAASAAAADQAAABMAAAB1AAAADwAAABMAAAARAAAAEgAAABAAAAAGAAAAAgAAAAMAAAAFAAAABAAAAAAAAAAAAAAAAAAAAAYAAAACAAAAAwAAAAEAAAAFAAAABAAAAAAAAAAAAAAABwAAAAUAAAADAAAABAAAAAEAAAAAAAAAAgAAAAAAAAACAAAAAwAAAAEAAAAFAAAABAAAAAYAAAAAAAAAAAAAAGFsZ29zLmMAaDNOZWlnaGJvclJvdGF0aW9ucwBjb29yZGlqay5jAF91cEFwN0NoZWNrZWQAX3VwQXA3ckNoZWNrZWQAZGlyZWN0ZWRFZGdlLmMAZGlyZWN0ZWRFZGdlVG9Cb3VuZGFyeQBhZGphY2VudEZhY2VEaXJbdG1wRmlqay5mYWNlXVtmaWprLmZhY2VdID09IEtJAGZhY2VpamsuYwBfZmFjZUlqa1BlbnRUb0NlbGxCb3VuZGFyeQBhZGphY2VudEZhY2VEaXJbY2VudGVySUpLLmZhY2VdW2ZhY2UyXSA9PSBLSQBfZmFjZUlqa1RvQ2VsbEJvdW5kYXJ5AGgzSW5kZXguYwBjb21wYWN0Q2VsbHMAbGF0TG5nVG9DZWxsAGNlbGxUb0NoaWxkUG9zAHZhbGlkYXRlQ2hpbGRQb3MAbGF0TG5nLmMAY2VsbEFyZWFSYWRzMgBwb2x5Z29uLT5uZXh0ID09IE5VTEwAbGlua2VkR2VvLmMAYWRkTmV3TGlua2VkUG9seWdvbgBuZXh0ICE9IE5VTEwAbG9vcCAhPSBOVUxMAGFkZE5ld0xpbmtlZExvb3AAcG9seWdvbi0+Zmlyc3QgPT0gTlVMTABhZGRMaW5rZWRMb29wAGNvb3JkICE9IE5VTEwAYWRkTGlua2VkQ29vcmQAbG9vcC0+Zmlyc3QgPT0gTlVMTABpbm5lckxvb3BzICE9IE5VTEwAbm9ybWFsaXplTXVsdGlQb2x5Z29uAGJib3hlcyAhPSBOVUxMAGNhbmRpZGF0ZXMgIT0gTlVMTABmaW5kUG9seWdvbkZvckhvbGUAY2FuZGlkYXRlQkJveGVzICE9IE5VTEwAcmV2RGlyICE9IElOVkFMSURfRElHSVQAbG9jYWxpai5jAGNlbGxUb0xvY2FsSWprAGJhc2VDZWxsICE9IG9yaWdpbkJhc2VDZWxsACEob3JpZ2luT25QZW50ICYmIGluZGV4T25QZW50KQBiYXNlQ2VsbCA9PSBvcmlnaW5CYXNlQ2VsbABiYXNlQ2VsbCAhPSBJTlZBTElEX0JBU0VfQ0VMTABsb2NhbElqa1RvQ2VsbAAhX2lzQmFzZUNlbGxQZW50YWdvbihiYXNlQ2VsbCkAYmFzZUNlbGxSb3RhdGlvbnMgPj0gMABncmlkUGF0aENlbGxzADAAdmVydGV4LmMAY2VsbFRvVmVydGV4AGdyYXBoLT5idWNrZXRzICE9IE5VTEwAdmVydGV4R3JhcGguYwBpbml0VmVydGV4R3JhcGgAbm9kZSAhPSBOVUxMAGFkZFZlcnRleE5vZGU=";var la=24144;function Qn(oe){return oe}function nc(oe){var we=/\b__Z[\w\d_]+/g;return oe.replace(we,function(We){var kr=We;return We===kr?We:kr+" ["+We+"]"})}function il(){var oe=new Error;if(!oe.stack){try{throw new Error(0)}catch(we){oe=we}if(!oe.stack)return"(no stack trace available)"}return oe.stack.toString()}function Ue(){var oe=il();return t.extraStackTrace&&(oe+=`
`+t.extraStackTrace()),nc(oe)}function ni(oe,we,We,kr){Zc("Assertion failed: "+Mt(oe)+", at: "+[we?Mt(we):"unknown filename",We,kr?Mt(kr):"unknown function"])}function Nr(){return xt.length}function xo(oe,we,We){Vt.set(Vt.subarray(we,we+We),oe)}function nl(oe){return t.___errno_location&&(Ee[t.___errno_location()>>2]=oe),oe}function qr(oe){Zc("OOM")}function Ma(oe){try{var we=new ArrayBuffer(oe);return we.byteLength!=oe?void 0:(new Int8Array(we).set(xt),Uo(we),nr(we),1)}catch{}}function Ct(oe){var we=Nr(),We=16777216,kr=2147483648-We;if(oe>kr)return!1;for(var _=16777216,wn=Math.max(we,_);wn<oe;)wn<=536870912?wn=re(2*wn,We):wn=Math.min(re((3*wn+2147483648)/4,We),kr);var yr=Ma(wn);return!!yr}var rt=typeof atob=="function"?atob:function(oe){var we="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",We="",kr,_,wn,yr,ft,lo,Wr,ss=0;oe=oe.replace(/[^A-Za-z0-9\+\/\=]/g,"");do yr=we.indexOf(oe.charAt(ss++)),ft=we.indexOf(oe.charAt(ss++)),lo=we.indexOf(oe.charAt(ss++)),Wr=we.indexOf(oe.charAt(ss++)),kr=yr<<2|ft>>4,_=(ft&15)<<4|lo>>2,wn=(lo&3)<<6|Wr,We=We+String.fromCharCode(kr),lo!==64&&(We=We+String.fromCharCode(_)),Wr!==64&&(We=We+String.fromCharCode(wn));while(ss<oe.length);return We};function at(oe){try{for(var we=rt(oe),We=new Uint8Array(we.length),kr=0;kr<we.length;++kr)We[kr]=we.charCodeAt(kr);return We}catch{throw new Error("Converting base64 string to bytes failed.")}}function mt(oe){if(rl(oe))return at(oe.slice(kl.length))}var Dt={Math,Int8Array,Int32Array,Uint8Array,Float32Array,Float64Array},Ot={a:Zc,b:v,c:T,d:ni,e:nl,f:Nr,g:xo,h:Ct,i:qr,j:Qn,k:nc,l:Ma,m:il,n:Ue,o:la,p:yi},It=function(oe,we,We){"almost asm";var kr=new oe.Int8Array(We),_=new oe.Int32Array(We),wn=new oe.Uint8Array(We),yr=new oe.Float32Array(We),ft=new oe.Float64Array(We),lo=we.o|0,Wr=we.p|0,ss=oe.Math.floor,Fr=oe.Math.abs,Jr=oe.Math.sqrt,vs=oe.Math.pow,cn=oe.Math.cos,un=oe.Math.sin,ku=oe.Math.tan,tm=oe.Math.acos,ng=oe.Math.asin,Bf=oe.Math.atan,ua=oe.Math.atan2,cc=oe.Math.ceil,ha=oe.Math.imul,Bh=oe.Math.min,Ub=oe.Math.max,Gc=oe.Math.clz32,Ei=we.b,St=we.c,Ur=we.d,em=we.e,ty=we.f,ey=we.g,dd=we.h,rm=we.i,pt=24160;function ry(m){return kr=new Int8Array(m),wn=new Uint8Array(m),_=new Int32Array(m),yr=new Float32Array(m),ft=new Float64Array(m),We=m,!0}function fs(m){m=m|0;var d=0;return d=pt,pt=pt+m|0,pt=pt+15&-16,d|0}function Nh(){return pt|0}function fa(m){m=m|0,pt=m}function Nf(m,d){m=m|0,d=d|0,pt=m}function md(m,d){m=m|0,d=d|0;var y=0,b=0,I=0;return(m|0)<0?(d=2,d|0):(m|0)>13780509?(d=Cr(15,d)|0,d|0):(y=((m|0)<0)<<31>>31,I=Jo(m|0,y|0,3,0)|0,b=St()|0,y=Ii(m|0,y|0,1,0)|0,y=Jo(I|0,b|0,y|0,St()|0)|0,y=Ii(y|0,St()|0,1,0)|0,m=St()|0,_[d>>2]=y,_[d+4>>2]=m,d=0,d|0)}function Ad(m,d,y,b){return m=m|0,d=d|0,y=y|0,b=b|0,Du(m,d,y,b,0)|0}function Du(m,d,y,b,I){m=m|0,d=d|0,y=y|0,b=b|0,I=I|0;var R=0,O=0,N=0,H=0,Q=0;if(H=pt,pt=pt+16|0,O=H,!(Lf(m,d,y,b,I)|0))return b=0,pt=H,b|0;do if((y|0)>=0){if((y|0)>13780509){if(R=Cr(15,O)|0,R|0)break;N=O,O=_[N>>2]|0,N=_[N+4>>2]|0}else R=((y|0)<0)<<31>>31,Q=Jo(y|0,R|0,3,0)|0,N=St()|0,R=Ii(y|0,R|0,1,0)|0,R=Jo(Q|0,N|0,R|0,St()|0)|0,R=Ii(R|0,St()|0,1,0)|0,N=St()|0,_[O>>2]=R,_[O+4>>2]=N,O=R;if(Yf(b|0,0,O<<3|0)|0,I|0){Yf(I|0,0,O<<2|0)|0,R=pa(m,d,y,b,I,O,N,0)|0;break}R=nu(O,4)|0,R?(Q=pa(m,d,y,b,R,O,N,0)|0,oi(R),R=Q):R=13}else R=2;while(!1);return Q=R,pt=H,Q|0}function Lf(m,d,y,b,I){m=m|0,d=d|0,y=y|0,b=b|0,I=I|0;var R=0,O=0,N=0,H=0,Q=0,ot=0,At=0,jt=0,Xt=0,zt=0,ie=0;if(ie=pt,pt=pt+16|0,Xt=ie,zt=ie+8|0,jt=Xt,_[jt>>2]=m,_[jt+4>>2]=d,(y|0)<0)return zt=2,pt=ie,zt|0;if(R=b,_[R>>2]=m,_[R+4>>2]=d,R=(I|0)!=0,R&&(_[I>>2]=0),Sn(m,d)|0)return zt=9,pt=ie,zt|0;_[zt>>2]=0;t:do if((y|0)>=1)if(R)for(ot=1,Q=0,At=0,jt=1,R=m;;){if(!(Q|At)){if(R=Zs(R,d,4,zt,Xt)|0,R|0)break t;if(d=Xt,R=_[d>>2]|0,d=_[d+4>>2]|0,Sn(R,d)|0){R=9;break t}}if(R=Zs(R,d,_[22384+(At<<2)>>2]|0,zt,Xt)|0,R|0)break t;if(d=Xt,R=_[d>>2]|0,d=_[d+4>>2]|0,m=b+(ot<<3)|0,_[m>>2]=R,_[m+4>>2]=d,_[I+(ot<<2)>>2]=jt,m=Q+1|0,O=(m|0)==(jt|0),N=At+1|0,H=(N|0)==6,Sn(R,d)|0){R=9;break t}if(jt=jt+(H&O&1)|0,(jt|0)>(y|0)){R=0;break}else ot=ot+1|0,Q=O?0:m,At=O?H?0:N:At}else for(ot=1,Q=0,At=0,jt=1,R=m;;){if(!(Q|At)){if(R=Zs(R,d,4,zt,Xt)|0,R|0)break t;if(d=Xt,R=_[d>>2]|0,d=_[d+4>>2]|0,Sn(R,d)|0){R=9;break t}}if(R=Zs(R,d,_[22384+(At<<2)>>2]|0,zt,Xt)|0,R|0)break t;if(d=Xt,R=_[d>>2]|0,d=_[d+4>>2]|0,m=b+(ot<<3)|0,_[m>>2]=R,_[m+4>>2]=d,m=Q+1|0,O=(m|0)==(jt|0),N=At+1|0,H=(N|0)==6,Sn(R,d)|0){R=9;break t}if(jt=jt+(H&O&1)|0,(jt|0)>(y|0)){R=0;break}else ot=ot+1|0,Q=O?0:m,At=O?H?0:N:At}else R=0;while(!1);return zt=R,pt=ie,zt|0}function pa(m,d,y,b,I,R,O,N){m=m|0,d=d|0,y=y|0,b=b|0,I=I|0,R=R|0,O=O|0,N=N|0;var H=0,Q=0,ot=0,At=0,jt=0,Xt=0,zt=0,ie=0,ge=0,me=0;if(ie=pt,pt=pt+16|0,Xt=ie+8|0,zt=ie,H=Ks(m|0,d|0,R|0,O|0)|0,ot=St()|0,At=b+(H<<3)|0,ge=At,me=_[ge>>2]|0,ge=_[ge+4>>2]|0,Q=(me|0)==(m|0)&(ge|0)==(d|0),!((me|0)==0&(ge|0)==0|Q))do H=Ii(H|0,ot|0,1,0)|0,H=Ay(H|0,St()|0,R|0,O|0)|0,ot=St()|0,At=b+(H<<3)|0,me=At,ge=_[me>>2]|0,me=_[me+4>>2]|0,Q=(ge|0)==(m|0)&(me|0)==(d|0);while(!((ge|0)==0&(me|0)==0|Q));if(H=I+(H<<2)|0,Q&&(_[H>>2]|0)<=(N|0)||(me=At,_[me>>2]=m,_[me+4>>2]=d,_[H>>2]=N,(N|0)>=(y|0)))return me=0,pt=ie,me|0;switch(Q=N+1|0,_[Xt>>2]=0,H=Zs(m,d,2,Xt,zt)|0,H|0){case 9:{jt=9;break}case 0:{H=zt,H=pa(_[H>>2]|0,_[H+4>>2]|0,y,b,I,R,O,Q)|0,H||(jt=9);break}default:}t:do if((jt|0)==9){switch(_[Xt>>2]=0,H=Zs(m,d,3,Xt,zt)|0,H|0){case 9:break;case 0:{if(H=zt,H=pa(_[H>>2]|0,_[H+4>>2]|0,y,b,I,R,O,Q)|0,H|0)break t;break}default:break t}switch(_[Xt>>2]=0,H=Zs(m,d,1,Xt,zt)|0,H|0){case 9:break;case 0:{if(H=zt,H=pa(_[H>>2]|0,_[H+4>>2]|0,y,b,I,R,O,Q)|0,H|0)break t;break}default:break t}switch(_[Xt>>2]=0,H=Zs(m,d,5,Xt,zt)|0,H|0){case 9:break;case 0:{if(H=zt,H=pa(_[H>>2]|0,_[H+4>>2]|0,y,b,I,R,O,Q)|0,H|0)break t;break}default:break t}switch(_[Xt>>2]=0,H=Zs(m,d,4,Xt,zt)|0,H|0){case 9:break;case 0:{if(H=zt,H=pa(_[H>>2]|0,_[H+4>>2]|0,y,b,I,R,O,Q)|0,H|0)break t;break}default:break t}switch(_[Xt>>2]=0,H=Zs(m,d,6,Xt,zt)|0,H|0){case 9:break;case 0:{if(H=zt,H=pa(_[H>>2]|0,_[H+4>>2]|0,y,b,I,R,O,Q)|0,H|0)break t;break}default:break t}return me=0,pt=ie,me|0}while(!1);return me=H,pt=ie,me|0}function Zs(m,d,y,b,I){m=m|0,d=d|0,y=y|0,b=b|0,I=I|0;var R=0,O=0,N=0,H=0,Q=0,ot=0,At=0,jt=0,Xt=0,zt=0;if(y>>>0>6)return I=1,I|0;if(At=(_[b>>2]|0)%6|0,_[b>>2]=At,(At|0)>0){R=0;do y=eu(y)|0,R=R+1|0;while((R|0)<(_[b>>2]|0))}if(At=De(m|0,d|0,45)|0,St()|0,ot=At&127,ot>>>0>121)return I=5,I|0;H=si(m,d)|0,R=De(m|0,d|0,52)|0,St()|0,R=R&15;t:do if(!R)Q=8;else{for(;;){if(O=(15-R|0)*3|0,N=De(m|0,d|0,O|0)|0,St()|0,N=N&7,(N|0)==7){d=5;break}if(zt=(P(R)|0)==0,R=R+-1|0,jt=Ge(7,0,O|0)|0,d=d&~(St()|0),Xt=Ge(_[(zt?432:16)+(N*28|0)+(y<<2)>>2]|0,0,O|0)|0,O=St()|0,y=_[(zt?640:224)+(N*28|0)+(y<<2)>>2]|0,m=Xt|m&~jt,d=O|d,!y){y=0;break t}if(!R){Q=8;break t}}return d|0}while(!1);(Q|0)==8&&(zt=_[848+(ot*28|0)+(y<<2)>>2]|0,Xt=Ge(zt|0,0,45)|0,m=Xt|m,d=St()|0|d&-1040385,y=_[4272+(ot*28|0)+(y<<2)>>2]|0,(zt&127|0)==127&&(zt=Ge(_[848+(ot*28|0)+20>>2]|0,0,45)|0,d=St()|0|d&-1040385,y=_[4272+(ot*28|0)+20>>2]|0,m=c(zt|m,d)|0,d=St()|0,_[b>>2]=(_[b>>2]|0)+1)),N=De(m|0,d|0,45)|0,St()|0,N=N&127;t:do if(Tn(N)|0){e:do if((si(m,d)|0)==1){if((ot|0)!=(N|0))if(Ra(N,_[7696+(ot*28|0)>>2]|0)|0){m=w(m,d)|0,O=1,d=St()|0;break}else Ur(23313,22416,436,22424);switch(H|0){case 3:{m=c(m,d)|0,d=St()|0,_[b>>2]=(_[b>>2]|0)+1,O=0;break e}case 5:{m=w(m,d)|0,d=St()|0,_[b>>2]=(_[b>>2]|0)+5,O=0;break e}case 0:return zt=9,zt|0;default:return zt=1,zt|0}}else O=0;while(!1);if((y|0)>0){R=0;do m=M(m,d)|0,d=St()|0,R=R+1|0;while((R|0)!=(y|0))}if((ot|0)!=(N|0)){if(!(nm(N)|0)){if((O|0)!=0|(si(m,d)|0)!=5)break;_[b>>2]=(_[b>>2]|0)+1;break}switch(At&127){case 8:case 118:break t;default:}(si(m,d)|0)!=3&&(_[b>>2]=(_[b>>2]|0)+1)}}else if((y|0)>0){R=0;do m=c(m,d)|0,d=St()|0,R=R+1|0;while((R|0)!=(y|0))}while(!1);return _[b>>2]=((_[b>>2]|0)+y|0)%6|0,zt=I,_[zt>>2]=m,_[zt+4>>2]=d,zt=0,zt|0}function im(m,d,y,b){m=m|0,d=d|0,y=y|0,b=b|0;var I=0,R=0,O=0,N=0,H=0,Q=0;for(N=pt,pt=pt+16|0,R=N,O=N+8|0,I=(Sn(m,d)|0)==0,I=I?1:2;;){if(_[O>>2]=0,Q=(Zs(m,d,I,O,R)|0)==0,H=R,Q&((_[H>>2]|0)==(y|0)?(_[H+4>>2]|0)==(b|0):0)){m=4;break}if(I=I+1|0,I>>>0>=7){I=7,m=4;break}}return(m|0)==4?(pt=N,I|0):0}function iy(m,d,y,b){m=m|0,d=d|0,y=y|0,b=b|0;var I=0,R=0,O=0,N=0,H=0,Q=0,ot=0,At=0,jt=0,Xt=0,zt=0;if(zt=pt,pt=pt+16|0,jt=zt,Xt=zt+8|0,At=jt,_[At>>2]=m,_[At+4>>2]=d,!y)return Xt=b,_[Xt>>2]=m,_[Xt+4>>2]=d,Xt=0,pt=zt,Xt|0;_[Xt>>2]=0;t:do if(Sn(m,d)|0)m=9;else{if(R=(y|0)>0,R){I=0,At=m;do{if(m=Zs(At,d,4,Xt,jt)|0,m|0)break t;if(d=jt,At=_[d>>2]|0,d=_[d+4>>2]|0,I=I+1|0,Sn(At,d)|0){m=9;break t}}while((I|0)<(y|0));if(ot=b,_[ot>>2]=At,_[ot+4>>2]=d,ot=y+-1|0,R){Q=0,m=1;do{if(I=22384+(Q<<2)|0,(Q|0)==5)for(O=_[I>>2]|0,R=0,I=m;;){if(m=jt,m=Zs(_[m>>2]|0,_[m+4>>2]|0,O,Xt,jt)|0,m|0)break t;if((R|0)!=(ot|0))if(H=jt,N=_[H>>2]|0,H=_[H+4>>2]|0,m=b+(I<<3)|0,_[m>>2]=N,_[m+4>>2]=H,!(Sn(N,H)|0))m=I+1|0;else{m=9;break t}else m=I;if(R=R+1|0,(R|0)>=(y|0))break;I=m}else for(O=jt,H=_[I>>2]|0,N=0,I=m,R=_[O>>2]|0,O=_[O+4>>2]|0;;){if(m=Zs(R,O,H,Xt,jt)|0,m|0)break t;if(O=jt,R=_[O>>2]|0,O=_[O+4>>2]|0,m=b+(I<<3)|0,_[m>>2]=R,_[m+4>>2]=O,m=I+1|0,Sn(R,O)|0){m=9;break t}if(N=N+1|0,(N|0)>=(y|0))break;I=m}Q=Q+1|0}while(Q>>>0<6);m=jt,O=At,I=_[m>>2]|0,R=d,m=_[m+4>>2]|0}else O=At,I=At,R=d,m=d}else O=b,_[O>>2]=m,_[O+4>>2]=d,O=m,I=m,R=d,m=d;m=(O|0)==(I|0)&(R|0)==(m|0)?0:9}while(!1);return Xt=m,pt=zt,Xt|0}function ny(m,d,y,b){m=m|0,d=d|0,y=y|0,b=b|0;var I=0,R=0,O=0,N=0,H=0,Q=0;if(N=pt,pt=pt+48|0,I=N+16|0,R=N+8|0,O=N,y|0)return O=15,pt=N,O|0;if(Q=m,H=_[Q+4>>2]|0,y=R,_[y>>2]=_[Q>>2],_[y+4>>2]=H,ps(R,I),d=ag(I,d,O)|0,!d){if(y=_[R>>2]|0,R=_[m+8>>2]|0,(R|0)>0){I=_[m+12>>2]|0,d=0;do y=(_[I+(d<<3)>>2]|0)+y|0,d=d+1|0;while((d|0)<(R|0))}d=O,I=_[d>>2]|0,d=_[d+4>>2]|0,R=((y|0)<0)<<31>>31,(d|0)<(R|0)|(d|0)==(R|0)&I>>>0<y>>>0?(d=O,_[d>>2]=y,_[d+4>>2]=R,d=R):y=I,H=Ii(y|0,d|0,12,0)|0,Q=St()|0,d=O,_[d>>2]=H,_[d+4>>2]=Q,d=b,_[d>>2]=H,_[d+4>>2]=Q,d=0}return Q=d,pt=N,Q|0}function sg(m,d,y,b,I,R,O){m=m|0,d=d|0,y=y|0,b=b|0,I=I|0,R=R|0,O=O|0;var N=0,H=0,Q=0,ot=0,At=0,jt=0,Xt=0,zt=0,ie=0,ge=0,me=0,ue=0,fe=0,ne=0,tr=0,pr=0,Xe=0,er=0,xn=0,hn=0,Zi=0,Pi=0,Ar=0,gi=0,kn=0,ti=0,Dn=0,To=0,Xb=0;if(kn=pt,pt=pt+64|0,Zi=kn+48|0,Pi=kn+32|0,Ar=kn+24|0,tr=kn+8|0,pr=kn,H=_[m>>2]|0,(H|0)<=0)return gi=0,pt=kn,gi|0;for(Xe=m+4|0,er=Zi+8|0,xn=Pi+8|0,hn=tr+8|0,N=0,fe=0;;){Q=_[Xe>>2]|0,ue=Q+(fe<<4)|0,_[Zi>>2]=_[ue>>2],_[Zi+4>>2]=_[ue+4>>2],_[Zi+8>>2]=_[ue+8>>2],_[Zi+12>>2]=_[ue+12>>2],(fe|0)==(H+-1|0)?(_[Pi>>2]=_[Q>>2],_[Pi+4>>2]=_[Q+4>>2],_[Pi+8>>2]=_[Q+8>>2],_[Pi+12>>2]=_[Q+12>>2]):(ue=Q+(fe+1<<4)|0,_[Pi>>2]=_[ue>>2],_[Pi+4>>2]=_[ue+4>>2],_[Pi+8>>2]=_[ue+8>>2],_[Pi+12>>2]=_[ue+12>>2]),H=om(Zi,Pi,b,Ar)|0;t:do if(H)Q=0,N=H;else if(Q=Ar,H=_[Q>>2]|0,Q=_[Q+4>>2]|0,(Q|0)>0|(Q|0)==0&H>>>0>0){me=0,ue=0;e:for(;;){if(Xb=+ft[Zi>>3],ge=ma(H|0,Q|0,me|0,ue|0)|0,To=+(ge>>>0)+4294967296*+(St()|0),ti=+(H>>>0)+4294967296*+(Q|0),Dn=+(me>>>0)+4294967296*+(ue|0),ft[tr>>3]=Xb*To/ti+ +ft[Pi>>3]*Dn/ti,ft[hn>>3]=+ft[er>>3]*To/ti+ +ft[xn>>3]*Dn/ti,H=U(tr,b,pr)|0,H|0){N=H;break}ge=pr,ie=_[ge>>2]|0,ge=_[ge+4>>2]|0,jt=Ks(ie|0,ge|0,d|0,y|0)|0,ot=St()|0,H=O+(jt<<3)|0,At=H,Q=_[At>>2]|0,At=_[At+4>>2]|0;r:do if((Q|0)==0&(At|0)==0)ne=H,gi=16;else for(Xt=0,zt=0;;){if((Xt|0)>(y|0)|(Xt|0)==(y|0)&zt>>>0>d>>>0){N=1;break e}if((Q|0)==(ie|0)&(At|0)==(ge|0))break r;if(H=Ii(jt|0,ot|0,1,0)|0,jt=Ay(H|0,St()|0,d|0,y|0)|0,ot=St()|0,zt=Ii(zt|0,Xt|0,1,0)|0,Xt=St()|0,H=O+(jt<<3)|0,At=H,Q=_[At>>2]|0,At=_[At+4>>2]|0,(Q|0)==0&(At|0)==0){ne=H,gi=16;break}}while(!1);if((gi|0)==16&&(gi=0,!((ie|0)==0&(ge|0)==0))&&(zt=ne,_[zt>>2]=ie,_[zt+4>>2]=ge,zt=R+(_[I>>2]<<3)|0,_[zt>>2]=ie,_[zt+4>>2]=ge,zt=I,zt=Ii(_[zt>>2]|0,_[zt+4>>2]|0,1,0)|0,ie=St()|0,ge=I,_[ge>>2]=zt,_[ge+4>>2]=ie),me=Ii(me|0,ue|0,1,0)|0,ue=St()|0,Q=Ar,H=_[Q>>2]|0,Q=_[Q+4>>2]|0,!((Q|0)>(ue|0)|(Q|0)==(ue|0)&H>>>0>me>>>0)){Q=1;break t}}Q=0}else Q=1;while(!1);if(fe=fe+1|0,!Q){gi=21;break}if(H=_[m>>2]|0,(fe|0)>=(H|0)){N=0,gi=21;break}}return(gi|0)==21?(pt=kn,N|0):0}function uc(m,d,y,b){m=m|0,d=d|0,y=y|0,b=b|0;var I=0,R=0,O=0,N=0,H=0,Q=0,ot=0,At=0,jt=0,Xt=0,zt=0,ie=0,ge=0,me=0,ue=0,fe=0,ne=0,tr=0,pr=0,Xe=0,er=0,xn=0,hn=0,Zi=0,Pi=0,Ar=0,gi=0,kn=0,ti=0,Dn=0,To=0;if(To=pt,pt=pt+112|0,gi=To+80|0,H=To+72|0,kn=To,ti=To+56|0,y|0)return Dn=15,pt=To,Dn|0;if(Q=m+8|0,Dn=mc((_[Q>>2]<<5)+32|0)|0,!Dn)return Dn=13,pt=To,Dn|0;if(Qs(m,Dn),Pi=m,Ar=_[Pi+4>>2]|0,y=H,_[y>>2]=_[Pi>>2],_[y+4>>2]=Ar,ps(H,gi),y=ag(gi,d,kn)|0,y)Pi=0,Ar=0;else{if(y=_[H>>2]|0,R=_[Q>>2]|0,(R|0)>0){O=_[m+12>>2]|0,I=0;do y=(_[O+(I<<3)>>2]|0)+y|0,I=I+1|0;while((I|0)!=(R|0));I=y}else I=y;y=kn,R=_[y>>2]|0,y=_[y+4>>2]|0,O=((I|0)<0)<<31>>31,(y|0)<(O|0)|(y|0)==(O|0)&R>>>0<I>>>0?(y=kn,_[y>>2]=I,_[y+4>>2]=O,y=O):I=R,Pi=Ii(I|0,y|0,12,0)|0,Ar=St()|0,y=kn,_[y>>2]=Pi,_[y+4>>2]=Ar,y=0}if(y|0)return oi(Dn),Dn=y,pt=To,Dn|0;if(I=nu(Pi,8)|0,!I)return oi(Dn),Dn=13,pt=To,Dn|0;if(N=nu(Pi,8)|0,!N)return oi(Dn),oi(I),Dn=13,pt=To,Dn|0;hn=gi,_[hn>>2]=0,_[hn+4>>2]=0,hn=m,Zi=_[hn+4>>2]|0,y=H,_[y>>2]=_[hn>>2],_[y+4>>2]=Zi,y=sg(H,Pi,Ar,d,gi,I,N)|0;t:do if(y)oi(I),oi(N),oi(Dn);else{e:do if((_[Q>>2]|0)>0){for(O=m+12|0,R=0;y=sg((_[O>>2]|0)+(R<<3)|0,Pi,Ar,d,gi,I,N)|0,R=R+1|0,!(y|0);)if((R|0)>=(_[Q>>2]|0))break e;oi(I),oi(N),oi(Dn);break t}while(!1);(Ar|0)>0|(Ar|0)==0&Pi>>>0>0&&Yf(N|0,0,Pi<<3|0)|0,Zi=gi,hn=_[Zi+4>>2]|0;e:do if((hn|0)>0|(hn|0)==0&(_[Zi>>2]|0)>>>0>0){Xe=I,er=N,xn=I,hn=N,Zi=I,y=I,ne=I,tr=N,pr=N,I=N;r:for(;;){for(ge=0,me=0,ue=0,fe=0,R=0,O=0;;){N=kn,H=N+56|0;do _[N>>2]=0,N=N+4|0;while((N|0)<(H|0));if(d=Xe+(ge<<3)|0,Q=_[d>>2]|0,d=_[d+4>>2]|0,Lf(Q,d,1,kn,0)|0){N=kn,H=N+56|0;do _[N>>2]=0,N=N+4|0;while((N|0)<(H|0));N=nu(7,4)|0,N|0&&(pa(Q,d,1,kn,N,7,0,0)|0,oi(N))}for(ie=0;;){zt=kn+(ie<<3)|0,Xt=_[zt>>2]|0,zt=_[zt+4>>2]|0;i:do if((Xt|0)==0&(zt|0)==0)N=R,H=O;else{if(ot=Ks(Xt|0,zt|0,Pi|0,Ar|0)|0,Q=St()|0,N=b+(ot<<3)|0,d=N,H=_[d>>2]|0,d=_[d+4>>2]|0,!((H|0)==0&(d|0)==0)){At=0,jt=0;do{if((At|0)>(Ar|0)|(At|0)==(Ar|0)&jt>>>0>Pi>>>0)break r;if((H|0)==(Xt|0)&(d|0)==(zt|0)){N=R,H=O;break i}N=Ii(ot|0,Q|0,1,0)|0,ot=Ay(N|0,St()|0,Pi|0,Ar|0)|0,Q=St()|0,jt=Ii(jt|0,At|0,1,0)|0,At=St()|0,N=b+(ot<<3)|0,d=N,H=_[d>>2]|0,d=_[d+4>>2]|0}while(!((H|0)==0&(d|0)==0))}(Xt|0)==0&(zt|0)==0?(N=R,H=O):(G(Xt,zt,ti)|0,da(m,Dn,ti)|0&&(jt=Ii(R|0,O|0,1,0)|0,O=St()|0,At=N,_[At>>2]=Xt,_[At+4>>2]=zt,R=er+(R<<3)|0,_[R>>2]=Xt,_[R+4>>2]=zt,R=jt),N=R,H=O)}while(!1);if(ie=ie+1|0,ie>>>0>=7)break;R=N,O=H}if(ge=Ii(ge|0,me|0,1,0)|0,me=St()|0,ue=Ii(ue|0,fe|0,1,0)|0,fe=St()|0,O=gi,R=_[O>>2]|0,O=_[O+4>>2]|0,(fe|0)<(O|0)|(fe|0)==(O|0)&ue>>>0<R>>>0)R=N,O=H;else break}if((O|0)>0|(O|0)==0&R>>>0>0){R=0,O=0;do fe=Xe+(R<<3)|0,_[fe>>2]=0,_[fe+4>>2]=0,R=Ii(R|0,O|0,1,0)|0,O=St()|0,fe=gi,ue=_[fe+4>>2]|0;while((O|0)<(ue|0)|((O|0)==(ue|0)?R>>>0<(_[fe>>2]|0)>>>0:0))}if(fe=gi,_[fe>>2]=N,_[fe+4>>2]=H,(H|0)>0|(H|0)==0&N>>>0>0)ie=I,ge=pr,me=Zi,ue=tr,fe=er,I=ne,pr=y,tr=xn,ne=ie,y=ge,Zi=hn,hn=me,xn=ue,er=Xe,Xe=fe;else break e}oi(xn),oi(hn),oi(Dn),y=1;break t}else y=N;while(!1);oi(Dn),oi(I),oi(y),y=0}while(!1);return Dn=y,pt=To,Dn|0}function gd(m,d,y){m=m|0,d=d|0,y=y|0;var b=0,I=0,R=0,O=0,N=0,H=0,Q=0,ot=0;if(ot=pt,pt=pt+176|0,H=ot,(d|0)<1)return $f(y,0,0),Q=0,pt=ot,Q|0;for(N=m,N=De(_[N>>2]|0,_[N+4>>2]|0,52)|0,St()|0,$f(y,(d|0)>6?d:6,N&15),N=0;b=m+(N<<3)|0,b=J(_[b>>2]|0,_[b+4>>2]|0,H)|0,!(b|0);){if(b=_[H>>2]|0,(b|0)>0){O=0;do R=H+8+(O<<4)|0,O=O+1|0,b=H+8+(((O|0)%(b|0)|0)<<4)|0,I=YP(y,b,R)|0,I?my(y,I)|0:M4(y,R,b)|0,b=_[H>>2]|0;while((O|0)<(b|0))}if(N=N+1|0,(N|0)>=(d|0)){b=0,Q=13;break}}return(Q|0)==13?(pt=ot,b|0):(Hf(y),Q=b,pt=ot,Q|0)}function Pa(m,d,y){m=m|0,d=d|0,y=y|0;var b=0,I=0,R=0,O=0;if(R=pt,pt=pt+32|0,b=R,I=R+16|0,m=gd(m,d,I)|0,m|0)return y=m,pt=R,y|0;if(_[y>>2]=0,_[y+4>>2]=0,_[y+8>>2]=0,m=vg(I)|0,m|0)do{d=vo(y)|0;do Gs(d,m)|0,O=m+16|0,_[b>>2]=_[O>>2],_[b+4>>2]=_[O+4>>2],_[b+8>>2]=_[O+8>>2],_[b+12>>2]=_[O+12>>2],my(I,m)|0,m=C4(I,b)|0;while(m|0);m=vg(I)|0}while(m|0);return Hf(I),m=Oa(y)|0,m?(Ss(y),O=m,pt=R,O|0):(O=0,pt=R,O|0)}function Tn(m){return m=m|0,m>>>0>121?(m=0,m|0):(m=_[7696+(m*28|0)+16>>2]|0,m|0)}function nm(m){return m=m|0,(m|0)==4|(m|0)==117|0}function og(m){return m=m|0,_[11120+((_[m>>2]|0)*216|0)+((_[m+4>>2]|0)*72|0)+((_[m+8>>2]|0)*24|0)+(_[m+12>>2]<<3)>>2]|0}function sy(m){return m=m|0,_[11120+((_[m>>2]|0)*216|0)+((_[m+4>>2]|0)*72|0)+((_[m+8>>2]|0)*24|0)+(_[m+12>>2]<<3)+4>>2]|0}function Qc(m,d){m=m|0,d=d|0,m=7696+(m*28|0)|0,_[d>>2]=_[m>>2],_[d+4>>2]=_[m+4>>2],_[d+8>>2]=_[m+8>>2],_[d+12>>2]=_[m+12>>2]}function oy(m,d){m=m|0,d=d|0;var y=0,b=0;if(d>>>0>20)return d=-1,d|0;do if((_[11120+(d*216|0)>>2]|0)!=(m|0))if((_[11120+(d*216|0)+8>>2]|0)!=(m|0))if((_[11120+(d*216|0)+16>>2]|0)!=(m|0))if((_[11120+(d*216|0)+24>>2]|0)!=(m|0))if((_[11120+(d*216|0)+32>>2]|0)!=(m|0))if((_[11120+(d*216|0)+40>>2]|0)!=(m|0))if((_[11120+(d*216|0)+48>>2]|0)!=(m|0))if((_[11120+(d*216|0)+56>>2]|0)!=(m|0))if((_[11120+(d*216|0)+64>>2]|0)!=(m|0))if((_[11120+(d*216|0)+72>>2]|0)!=(m|0))if((_[11120+(d*216|0)+80>>2]|0)!=(m|0))if((_[11120+(d*216|0)+88>>2]|0)!=(m|0))if((_[11120+(d*216|0)+96>>2]|0)!=(m|0))if((_[11120+(d*216|0)+104>>2]|0)!=(m|0))if((_[11120+(d*216|0)+112>>2]|0)!=(m|0))if((_[11120+(d*216|0)+120>>2]|0)!=(m|0))if((_[11120+(d*216|0)+128>>2]|0)!=(m|0))if((_[11120+(d*216|0)+136>>2]|0)==(m|0))m=2,y=1,b=2;else{if((_[11120+(d*216|0)+144>>2]|0)==(m|0)){m=0,y=2,b=0;break}if((_[11120+(d*216|0)+152>>2]|0)==(m|0)){m=0,y=2,b=1;break}if((_[11120+(d*216|0)+160>>2]|0)==(m|0)){m=0,y=2,b=2;break}if((_[11120+(d*216|0)+168>>2]|0)==(m|0)){m=1,y=2,b=0;break}if((_[11120+(d*216|0)+176>>2]|0)==(m|0)){m=1,y=2,b=1;break}if((_[11120+(d*216|0)+184>>2]|0)==(m|0)){m=1,y=2,b=2;break}if((_[11120+(d*216|0)+192>>2]|0)==(m|0)){m=2,y=2,b=0;break}if((_[11120+(d*216|0)+200>>2]|0)==(m|0)){m=2,y=2,b=1;break}if((_[11120+(d*216|0)+208>>2]|0)==(m|0)){m=2,y=2,b=2;break}else m=-1;return m|0}else m=2,y=1,b=1;else m=2,y=1,b=0;else m=1,y=1,b=2;else m=1,y=1,b=1;else m=1,y=1,b=0;else m=0,y=1,b=2;else m=0,y=1,b=1;else m=0,y=1,b=0;else m=2,y=0,b=2;else m=2,y=0,b=1;else m=2,y=0,b=0;else m=1,y=0,b=2;else m=1,y=0,b=1;else m=1,y=0,b=0;else m=0,y=0,b=2;else m=0,y=0,b=1;else m=0,y=0,b=0;while(!1);return d=_[11120+(d*216|0)+(y*72|0)+(m*24|0)+(b<<3)+4>>2]|0,d|0}function Ra(m,d){return m=m|0,d=d|0,(_[7696+(m*28|0)+20>>2]|0)==(d|0)?(d=1,d|0):(d=(_[7696+(m*28|0)+24>>2]|0)==(d|0),d|0)}function Ol(m,d){return m=m|0,d=d|0,_[848+(m*28|0)+(d<<2)>>2]|0}function Ff(m,d){return m=m|0,d=d|0,(_[848+(m*28|0)>>2]|0)==(d|0)?(d=0,d|0):(_[848+(m*28|0)+4>>2]|0)==(d|0)?(d=1,d|0):(_[848+(m*28|0)+8>>2]|0)==(d|0)?(d=2,d|0):(_[848+(m*28|0)+12>>2]|0)==(d|0)?(d=3,d|0):(_[848+(m*28|0)+16>>2]|0)==(d|0)?(d=4,d|0):(_[848+(m*28|0)+20>>2]|0)==(d|0)?(d=5,d|0):((_[848+(m*28|0)+24>>2]|0)==(d|0)?6:7)|0}function Kc(){return 122}function Jc(m){m=m|0;var d=0,y=0,b=0;d=0;do Ge(d|0,0,45)|0,b=St()|0|134225919,y=m+(d<<3)|0,_[y>>2]=-1,_[y+4>>2]=b,d=d+1|0;while((d|0)!=122);return 0}function ay(m){return m=m|0,+ft[m+16>>3]<+ft[m+24>>3]|0}function sm(m,d){m=m|0,d=d|0;var y=0,b=0,I=0;return y=+ft[d>>3],!(y>=+ft[m+8>>3])||!(y<=+ft[m>>3])?(d=0,d|0):(b=+ft[m+16>>3],y=+ft[m+24>>3],I=+ft[d+8>>3],d=I>=y,m=I<=b&1,b<y?d&&(m=1):d||(m=0),d=(m|0)!=0,d|0)}function ag(m,d,y){m=m|0,d=d|0,y=y|0;var b=0,I=0,R=0,O=0,N=0,H=0,Q=0,ot=0,At=0,jt=0,Xt=0,zt=0,ie=0,ge=0;zt=pt,pt=pt+288|0,ot=zt+264|0,At=zt+96|0,Q=zt,N=Q,H=N+96|0;do _[N>>2]=0,N=N+4|0;while((N|0)<(H|0));return d=bt(d,Q)|0,d|0?(Xt=d,pt=zt,Xt|0):(H=Q,Q=_[H>>2]|0,H=_[H+4>>2]|0,G(Q,H,ot)|0,J(Q,H,At)|0,O=+ce(ot,At+8|0),ft[ot>>3]=+ft[m>>3],H=ot+8|0,ft[H>>3]=+ft[m+16>>3],ft[At>>3]=+ft[m+8>>3],Q=At+8|0,ft[Q>>3]=+ft[m+24>>3],I=+ce(ot,At),ge=+ft[H>>3]-+ft[Q>>3],R=+Fr(+ge),ie=+ft[ot>>3]-+ft[At>>3],b=+Fr(+ie),!(ge==0|ie==0)&&(ge=+mm(+R,+b),ge=+cc(+(I*I/+qb(+(ge/+qb(+R,+b)),3)/(O*(O*2.59807621135)*.8))),ft[lo>>3]=ge,jt=~~ge>>>0,Xt=+Fr(ge)>=1?ge>0?~~+Bh(+ss(ge/4294967296),4294967295)>>>0:~~+cc((ge-+(~~ge>>>0))/4294967296)>>>0:0,(_[lo+4>>2]&2146435072|0)!=2146435072)?(At=(jt|0)==0&(Xt|0)==0,d=y,_[d>>2]=At?1:jt,_[d+4>>2]=At?0:Xt,d=0):d=1,Xt=d,pt=zt,Xt|0)}function om(m,d,y,b){m=m|0,d=d|0,y=y|0,b=b|0;var I=0,R=0,O=0,N=0,H=0,Q=0,ot=0;Q=pt,pt=pt+288|0,O=Q+264|0,N=Q+96|0,H=Q,I=H,R=I+96|0;do _[I>>2]=0,I=I+4|0;while((I|0)<(R|0));return y=bt(y,H)|0,y|0?(b=y,pt=Q,b|0):(y=H,I=_[y>>2]|0,y=_[y+4>>2]|0,G(I,y,O)|0,J(I,y,N)|0,ot=+ce(O,N+8|0),ot=+cc(+(+ce(m,d)/(ot*2))),ft[lo>>3]=ot,y=~~ot>>>0,I=+Fr(ot)>=1?ot>0?~~+Bh(+ss(ot/4294967296),4294967295)>>>0:~~+cc((ot-+(~~ot>>>0))/4294967296)>>>0:0,(_[lo+4>>2]&2146435072|0)==2146435072?(b=1,pt=Q,b|0):(H=(y|0)==0&(I|0)==0,_[b>>2]=H?1:y,_[b+4>>2]=H?0:I,b=0,pt=Q,b|0))}function zf(m,d,y,b){m=m|0,d=d|0,y=y|0,b=b|0,_[m>>2]=d,_[m+4>>2]=y,_[m+8>>2]=b}function tu(m,d){m=m|0,d=d|0;var y=0,b=0,I=0,R=0,O=0,N=0,H=0,Q=0,ot=0,At=0,jt=0;At=d+8|0,_[At>>2]=0,H=+ft[m>>3],O=+Fr(+H),Q=+ft[m+8>>3],N=+Fr(+Q)/.8660254037844386,O=O+N*.5,y=~~O,m=~~N,O=O-+(y|0),N=N-+(m|0);do if(O<.5)if(O<.3333333333333333)if(_[d>>2]=y,N<(O+1)*.5){_[d+4>>2]=m;break}else{m=m+1|0,_[d+4>>2]=m;break}else if(jt=1-O,m=(!(N<jt)&1)+m|0,_[d+4>>2]=m,jt<=N&N<O*2){y=y+1|0,_[d>>2]=y;break}else{_[d>>2]=y;break}else{if(!(O<.6666666666666666))if(y=y+1|0,_[d>>2]=y,N<O*.5){_[d+4>>2]=m;break}else{m=m+1|0,_[d+4>>2]=m;break}if(N<1-O){if(_[d+4>>2]=m,O*2+-1<N){_[d>>2]=y;break}}else m=m+1|0,_[d+4>>2]=m;y=y+1|0,_[d>>2]=y}while(!1);do if(H<0)if(m&1){ot=(m+1|0)/2|0,ot=ma(y|0,((y|0)<0)<<31>>31|0,ot|0,((ot|0)<0)<<31>>31|0)|0,y=~~(+(y|0)-((+(ot>>>0)+4294967296*+(St()|0))*2+1)),_[d>>2]=y;break}else{ot=(m|0)/2|0,ot=ma(y|0,((y|0)<0)<<31>>31|0,ot|0,((ot|0)<0)<<31>>31|0)|0,y=~~(+(y|0)-(+(ot>>>0)+4294967296*+(St()|0))*2),_[d>>2]=y;break}while(!1);ot=d+4|0,Q<0&&(y=y-((m<<1|1|0)/2|0)|0,_[d>>2]=y,m=0-m|0,_[ot>>2]=m),b=m-y|0,(y|0)<0?(I=0-y|0,_[ot>>2]=b,_[At>>2]=I,_[d>>2]=0,m=b,y=0):I=0,(m|0)<0&&(y=y-m|0,_[d>>2]=y,I=I-m|0,_[At>>2]=I,_[ot>>2]=0,m=0),R=y-I|0,b=m-I|0,(I|0)<0&&(_[d>>2]=R,_[ot>>2]=b,_[At>>2]=0,m=b,y=R,I=0),b=(m|0)<(y|0)?m:y,b=(I|0)<(b|0)?I:b,!((b|0)<=0)&&(_[d>>2]=y-b,_[ot>>2]=m-b,_[At>>2]=I-b)}function Ve(m){m=m|0;var d=0,y=0,b=0,I=0,R=0,O=0;d=_[m>>2]|0,O=m+4|0,y=_[O>>2]|0,(d|0)<0&&(y=y-d|0,_[O>>2]=y,R=m+8|0,_[R>>2]=(_[R>>2]|0)-d,_[m>>2]=0,d=0),(y|0)<0?(d=d-y|0,_[m>>2]=d,R=m+8|0,I=(_[R>>2]|0)-y|0,_[R>>2]=I,_[O>>2]=0,y=0):(I=m+8|0,R=I,I=_[I>>2]|0),(I|0)<0&&(d=d-I|0,_[m>>2]=d,y=y-I|0,_[O>>2]=y,_[R>>2]=0,I=0),b=(y|0)<(d|0)?y:d,b=(I|0)<(b|0)?I:b,!((b|0)<=0)&&(_[m>>2]=d-b,_[O>>2]=y-b,_[R>>2]=I-b)}function hc(m,d){m=m|0,d=d|0;var y=0,b=0;b=_[m+8>>2]|0,y=+((_[m+4>>2]|0)-b|0),ft[d>>3]=+((_[m>>2]|0)-b|0)-y*.5,ft[d+8>>3]=y*.8660254037844386}function ws(m,d,y){m=m|0,d=d|0,y=y|0,_[y>>2]=(_[d>>2]|0)+(_[m>>2]|0),_[y+4>>2]=(_[d+4>>2]|0)+(_[m+4>>2]|0),_[y+8>>2]=(_[d+8>>2]|0)+(_[m+8>>2]|0)}function Ou(m,d,y){m=m|0,d=d|0,y=y|0,_[y>>2]=(_[m>>2]|0)-(_[d>>2]|0),_[y+4>>2]=(_[m+4>>2]|0)-(_[d+4>>2]|0),_[y+8>>2]=(_[m+8>>2]|0)-(_[d+8>>2]|0)}function lg(m,d){m=m|0,d=d|0;var y=0,b=0;y=ha(_[m>>2]|0,d)|0,_[m>>2]=y,y=m+4|0,b=ha(_[y>>2]|0,d)|0,_[y>>2]=b,m=m+8|0,d=ha(_[m>>2]|0,d)|0,_[m>>2]=d}function qe(m){m=m|0;var d=0,y=0,b=0,I=0,R=0,O=0,N=0;O=_[m>>2]|0,N=(O|0)<0,b=(_[m+4>>2]|0)-(N?O:0)|0,R=(b|0)<0,I=(R?0-b|0:0)+((_[m+8>>2]|0)-(N?O:0))|0,y=(I|0)<0,m=y?0:I,d=(R?0:b)-(y?I:0)|0,I=(N?0:O)-(R?b:0)-(y?I:0)|0,y=(d|0)<(I|0)?d:I,y=(m|0)<(y|0)?m:y,b=(y|0)>0,m=m-(b?y:0)|0,d=d-(b?y:0)|0;t:do switch(I-(b?y:0)|0){case 0:switch(d|0){case 0:return N=m|0?(m|0)==1?1:7:0,N|0;case 1:return N=m|0?(m|0)==1?3:7:2,N|0;default:break t}case 1:switch(d|0){case 0:return N=m|0?(m|0)==1?5:7:4,N|0;case 1:{if(!m)m=6;else break t;return m|0}default:break t}default:}while(!1);return N=7,N|0}function cg(m){m=m|0;var d=0,y=0,b=0,I=0,R=0,O=0,N=0;O=m+8|0,I=_[O>>2]|0,R=(_[m>>2]|0)-I|0,N=m+4|0,I=(_[N>>2]|0)-I|0;do if(R>>>0>715827881|I>>>0>715827881){if(y=(R|0)>0,y){if((2147483647-R|0)<(R|0)||(2147483647-(R<<1)|0)<(R|0))return N=1,N|0}else if((-2147483648-R|0)>(R|0)||(-2147483648-(R<<1)|0)>(R|0))return N=1,N|0;if(d=R*3|0,(I|0)>0){if((2147483647-I|0)<(I|0))return N=1,N|0}else if((-2147483648-I|0)>(I|0))return N=1,N|0;if(b=I<<1,(R|0)>-1){if((d|-2147483648|0)>=(I|0))return N=1,N|0}else if((d^-2147483648|0)<(I|0))return N=1,N|0;if(y){if((2147483647-R|0)<(b|0))d=1;else{y=b;break}return d|0}else{if((-2147483648-R|0)>(b|0))d=1;else{y=b;break}return d|0}}else y=I<<1,d=R*3|0;while(!1);b=qf(+(d-I|0)/7)|0,_[m>>2]=b,I=qf(+(y+R|0)/7)|0,_[N>>2]=I,_[O>>2]=0,y=(I|0)<(b|0),d=y?b:I,y=y?I:b;do if((y|0)<0){if((d|0)>0){if((d|-2147483648|0)<(y|0)&((y|0)!=-2147483648&(2147483647-d|0)>=(y|0)))break;Ur(23313,22444,355,22455)}if((y|0)==-2147483648|(-2147483648-d|0)>(y|0)&&Ur(23313,22444,355,22455),(d|0)>-1){if((d|-2147483648|0)<(y|0))break;Ur(23313,22444,355,22455)}else{if((d^-2147483648|0)>=(y|0))break;Ur(23313,22444,355,22455)}}while(!1);return d=I-b|0,(b|0)<0?(y=0-b|0,_[N>>2]=d,_[O>>2]=y,_[m>>2]=0,b=0):(d=I,y=0),(d|0)<0&&(b=b-d|0,_[m>>2]=b,y=y-d|0,_[O>>2]=y,_[N>>2]=0,d=0),R=b-y|0,I=d-y|0,(y|0)<0?(_[m>>2]=R,_[N>>2]=I,_[O>>2]=0,d=I,I=R,y=0):I=b,b=(d|0)<(I|0)?d:I,b=(y|0)<(b|0)?y:b,(b|0)<=0?(N=0,N|0):(_[m>>2]=I-b,_[N>>2]=d-b,_[O>>2]=y-b,N=0,N|0)}function ug(m){m=m|0;var d=0,y=0,b=0,I=0,R=0,O=0,N=0;O=m+8|0,I=_[O>>2]|0,R=(_[m>>2]|0)-I|0,N=m+4|0,I=(_[N>>2]|0)-I|0;do if(R>>>0>715827881|I>>>0>715827881){if(y=(R|0)>0,y){if((2147483647-R|0)<(R|0))return N=1,N|0}else if((-2147483648-R|0)>(R|0))return N=1,N|0;if(d=R<<1,(I|0)>0){if((2147483647-I|0)<(I|0)||(2147483647-(I<<1)|0)<(I|0))return N=1,N|0}else if((-2147483648-I|0)>(I|0)||(-2147483648-(I<<1)|0)>(I|0))return N=1,N|0;if(b=I*3|0,y){if((2147483647-d|0)<(I|0))return N=1,N|0}else if((-2147483648-d|0)>(I|0))return N=1,N|0;if((I|0)>-1){if((b|-2147483648|0)<(R|0)){y=b;break}else d=1;return d|0}else{if((b^-2147483648|0)<(R|0))d=1;else{y=b;break}return d|0}}else y=I*3|0,d=R<<1;while(!1);b=qf(+(d+I|0)/7)|0,_[m>>2]=b,I=qf(+(y-R|0)/7)|0,_[N>>2]=I,_[O>>2]=0,y=(I|0)<(b|0),d=y?b:I,y=y?I:b;do if((y|0)<0){if((d|0)>0){if((d|-2147483648|0)<(y|0)&((y|0)!=-2147483648&(2147483647-d|0)>=(y|0)))break;Ur(23313,22444,404,22469)}if((y|0)==-2147483648|(-2147483648-d|0)>(y|0)&&Ur(23313,22444,404,22469),(d|0)>-1){if((d|-2147483648|0)<(y|0))break;Ur(23313,22444,404,22469)}else{if((d^-2147483648|0)>=(y|0))break;Ur(23313,22444,404,22469)}}while(!1);return d=I-b|0,(b|0)<0?(y=0-b|0,_[N>>2]=d,_[O>>2]=y,_[m>>2]=0,b=0):(d=I,y=0),(d|0)<0&&(b=b-d|0,_[m>>2]=b,y=y-d|0,_[O>>2]=y,_[N>>2]=0,d=0),R=b-y|0,I=d-y|0,(y|0)<0?(_[m>>2]=R,_[N>>2]=I,_[O>>2]=0,d=I,I=R,y=0):I=b,b=(d|0)<(I|0)?d:I,b=(y|0)<(b|0)?y:b,(b|0)<=0?(N=0,N|0):(_[m>>2]=I-b,_[N>>2]=d-b,_[O>>2]=y-b,N=0,N|0)}function Vb(m){m=m|0;var d=0,y=0,b=0,I=0,R=0,O=0,N=0;O=m+8|0,y=_[O>>2]|0,d=(_[m>>2]|0)-y|0,N=m+4|0,y=(_[N>>2]|0)-y|0,b=qf(+((d*3|0)-y|0)/7)|0,_[m>>2]=b,d=qf(+((y<<1)+d|0)/7)|0,_[N>>2]=d,_[O>>2]=0,y=d-b|0,(b|0)<0?(R=0-b|0,_[N>>2]=y,_[O>>2]=R,_[m>>2]=0,d=y,b=0,y=R):y=0,(d|0)<0&&(b=b-d|0,_[m>>2]=b,y=y-d|0,_[O>>2]=y,_[N>>2]=0,d=0),R=b-y|0,I=d-y|0,(y|0)<0?(_[m>>2]=R,_[N>>2]=I,_[O>>2]=0,d=I,I=R,y=0):I=b,b=(d|0)<(I|0)?d:I,b=(y|0)<(b|0)?y:b,!((b|0)<=0)&&(_[m>>2]=I-b,_[N>>2]=d-b,_[O>>2]=y-b)}function am(m){m=m|0;var d=0,y=0,b=0,I=0,R=0,O=0,N=0;O=m+8|0,y=_[O>>2]|0,d=(_[m>>2]|0)-y|0,N=m+4|0,y=(_[N>>2]|0)-y|0,b=qf(+((d<<1)+y|0)/7)|0,_[m>>2]=b,d=qf(+((y*3|0)-d|0)/7)|0,_[N>>2]=d,_[O>>2]=0,y=d-b|0,(b|0)<0?(R=0-b|0,_[N>>2]=y,_[O>>2]=R,_[m>>2]=0,d=y,b=0,y=R):y=0,(d|0)<0&&(b=b-d|0,_[m>>2]=b,y=y-d|0,_[O>>2]=y,_[N>>2]=0,d=0),R=b-y|0,I=d-y|0,(y|0)<0?(_[m>>2]=R,_[N>>2]=I,_[O>>2]=0,d=I,I=R,y=0):I=b,b=(d|0)<(I|0)?d:I,b=(y|0)<(b|0)?y:b,!((b|0)<=0)&&(_[m>>2]=I-b,_[N>>2]=d-b,_[O>>2]=y-b)}function _d(m){m=m|0;var d=0,y=0,b=0,I=0,R=0,O=0,N=0;d=_[m>>2]|0,O=m+4|0,y=_[O>>2]|0,N=m+8|0,b=_[N>>2]|0,I=y+(d*3|0)|0,_[m>>2]=I,y=b+(y*3|0)|0,_[O>>2]=y,d=(b*3|0)+d|0,_[N>>2]=d,b=y-I|0,(I|0)<0?(d=d-I|0,_[O>>2]=b,_[N>>2]=d,_[m>>2]=0,y=b,b=0):b=I,(y|0)<0&&(b=b-y|0,_[m>>2]=b,d=d-y|0,_[N>>2]=d,_[O>>2]=0,y=0),R=b-d|0,I=y-d|0,(d|0)<0?(_[m>>2]=R,_[O>>2]=I,_[N>>2]=0,b=R,d=0):I=y,y=(I|0)<(b|0)?I:b,y=(d|0)<(y|0)?d:y,!((y|0)<=0)&&(_[m>>2]=b-y,_[O>>2]=I-y,_[N>>2]=d-y)}function Bu(m){m=m|0;var d=0,y=0,b=0,I=0,R=0,O=0,N=0;I=_[m>>2]|0,O=m+4|0,d=_[O>>2]|0,N=m+8|0,y=_[N>>2]|0,b=(d*3|0)+I|0,I=y+(I*3|0)|0,_[m>>2]=I,_[O>>2]=b,d=(y*3|0)+d|0,_[N>>2]=d,y=b-I|0,(I|0)<0?(d=d-I|0,_[O>>2]=y,_[N>>2]=d,_[m>>2]=0,I=0):y=b,(y|0)<0&&(I=I-y|0,_[m>>2]=I,d=d-y|0,_[N>>2]=d,_[O>>2]=0,y=0),R=I-d|0,b=y-d|0,(d|0)<0?(_[m>>2]=R,_[O>>2]=b,_[N>>2]=0,I=R,d=0):b=y,y=(b|0)<(I|0)?b:I,y=(d|0)<(y|0)?d:y,!((y|0)<=0)&&(_[m>>2]=I-y,_[O>>2]=b-y,_[N>>2]=d-y)}function hg(m,d){m=m|0,d=d|0;var y=0,b=0,I=0,R=0,O=0,N=0;(d+-1|0)>>>0>=6||(I=(_[15440+(d*12|0)>>2]|0)+(_[m>>2]|0)|0,_[m>>2]=I,N=m+4|0,b=(_[15440+(d*12|0)+4>>2]|0)+(_[N>>2]|0)|0,_[N>>2]=b,O=m+8|0,d=(_[15440+(d*12|0)+8>>2]|0)+(_[O>>2]|0)|0,_[O>>2]=d,y=b-I|0,(I|0)<0?(d=d-I|0,_[N>>2]=y,_[O>>2]=d,_[m>>2]=0,b=0):(y=b,b=I),(y|0)<0&&(b=b-y|0,_[m>>2]=b,d=d-y|0,_[O>>2]=d,_[N>>2]=0,y=0),R=b-d|0,I=y-d|0,(d|0)<0?(_[m>>2]=R,_[N>>2]=I,_[O>>2]=0,b=R,d=0):I=y,y=(I|0)<(b|0)?I:b,y=(d|0)<(y|0)?d:y,!((y|0)<=0)&&(_[m>>2]=b-y,_[N>>2]=I-y,_[O>>2]=d-y))}function ly(m){m=m|0;var d=0,y=0,b=0,I=0,R=0,O=0,N=0;I=_[m>>2]|0,O=m+4|0,d=_[O>>2]|0,N=m+8|0,y=_[N>>2]|0,b=d+I|0,I=y+I|0,_[m>>2]=I,_[O>>2]=b,d=y+d|0,_[N>>2]=d,y=b-I|0,(I|0)<0?(d=d-I|0,_[O>>2]=y,_[N>>2]=d,_[m>>2]=0,b=0):(y=b,b=I),(y|0)<0&&(b=b-y|0,_[m>>2]=b,d=d-y|0,_[N>>2]=d,_[O>>2]=0,y=0),R=b-d|0,I=y-d|0,(d|0)<0?(_[m>>2]=R,_[O>>2]=I,_[N>>2]=0,b=R,d=0):I=y,y=(I|0)<(b|0)?I:b,y=(d|0)<(y|0)?d:y,!((y|0)<=0)&&(_[m>>2]=b-y,_[O>>2]=I-y,_[N>>2]=d-y)}function Uf(m){m=m|0;var d=0,y=0,b=0,I=0,R=0,O=0,N=0;d=_[m>>2]|0,O=m+4|0,b=_[O>>2]|0,N=m+8|0,y=_[N>>2]|0,I=b+d|0,_[m>>2]=I,b=y+b|0,_[O>>2]=b,d=y+d|0,_[N>>2]=d,y=b-I|0,(I|0)<0?(d=d-I|0,_[O>>2]=y,_[N>>2]=d,_[m>>2]=0,b=0):(y=b,b=I),(y|0)<0&&(b=b-y|0,_[m>>2]=b,d=d-y|0,_[N>>2]=d,_[O>>2]=0,y=0),R=b-d|0,I=y-d|0,(d|0)<0?(_[m>>2]=R,_[O>>2]=I,_[N>>2]=0,b=R,d=0):I=y,y=(I|0)<(b|0)?I:b,y=(d|0)<(y|0)?d:y,!((y|0)<=0)&&(_[m>>2]=b-y,_[O>>2]=I-y,_[N>>2]=d-y)}function eu(m){switch(m=m|0,m|0){case 1:{m=5;break}case 5:{m=4;break}case 4:{m=6;break}case 6:{m=2;break}case 2:{m=3;break}case 3:{m=1;break}default:}return m|0}function fc(m){switch(m=m|0,m|0){case 1:{m=3;break}case 3:{m=2;break}case 2:{m=6;break}case 6:{m=4;break}case 4:{m=5;break}case 5:{m=1;break}default:}return m|0}function lm(m){m=m|0;var d=0,y=0,b=0,I=0,R=0,O=0,N=0;d=_[m>>2]|0,O=m+4|0,y=_[O>>2]|0,N=m+8|0,b=_[N>>2]|0,I=y+(d<<1)|0,_[m>>2]=I,y=b+(y<<1)|0,_[O>>2]=y,d=(b<<1)+d|0,_[N>>2]=d,b=y-I|0,(I|0)<0?(d=d-I|0,_[O>>2]=b,_[N>>2]=d,_[m>>2]=0,y=b,b=0):b=I,(y|0)<0&&(b=b-y|0,_[m>>2]=b,d=d-y|0,_[N>>2]=d,_[O>>2]=0,y=0),R=b-d|0,I=y-d|0,(d|0)<0?(_[m>>2]=R,_[O>>2]=I,_[N>>2]=0,b=R,d=0):I=y,y=(I|0)<(b|0)?I:b,y=(d|0)<(y|0)?d:y,!((y|0)<=0)&&(_[m>>2]=b-y,_[O>>2]=I-y,_[N>>2]=d-y)}function Qo(m){m=m|0;var d=0,y=0,b=0,I=0,R=0,O=0,N=0;I=_[m>>2]|0,O=m+4|0,d=_[O>>2]|0,N=m+8|0,y=_[N>>2]|0,b=(d<<1)+I|0,I=y+(I<<1)|0,_[m>>2]=I,_[O>>2]=b,d=(y<<1)+d|0,_[N>>2]=d,y=b-I|0,(I|0)<0?(d=d-I|0,_[O>>2]=y,_[N>>2]=d,_[m>>2]=0,I=0):y=b,(y|0)<0&&(I=I-y|0,_[m>>2]=I,d=d-y|0,_[N>>2]=d,_[O>>2]=0,y=0),R=I-d|0,b=y-d|0,(d|0)<0?(_[m>>2]=R,_[O>>2]=b,_[N>>2]=0,I=R,d=0):b=y,y=(b|0)<(I|0)?b:I,y=(d|0)<(y|0)?d:y,!((y|0)<=0)&&(_[m>>2]=I-y,_[O>>2]=b-y,_[N>>2]=d-y)}function pc(m,d){m=m|0,d=d|0;var y=0,b=0,I=0,R=0,O=0,N=0;return O=(_[m>>2]|0)-(_[d>>2]|0)|0,N=(O|0)<0,b=(_[m+4>>2]|0)-(_[d+4>>2]|0)-(N?O:0)|0,R=(b|0)<0,I=(N?0-O|0:0)+(_[m+8>>2]|0)-(_[d+8>>2]|0)+(R?0-b|0:0)|0,m=(I|0)<0,d=m?0:I,y=(R?0:b)-(m?I:0)|0,I=(N?0:O)-(R?b:0)-(m?I:0)|0,m=(y|0)<(I|0)?y:I,m=(d|0)<(m|0)?d:m,b=(m|0)>0,d=d-(b?m:0)|0,y=y-(b?m:0)|0,m=I-(b?m:0)|0,m=(m|0)>-1?m:0-m|0,y=(y|0)>-1?y:0-y|0,d=(d|0)>-1?d:0-d|0,d=(y|0)>(d|0)?y:d,((m|0)>(d|0)?m:d)|0}function yd(m,d){m=m|0,d=d|0;var y=0;y=_[m+8>>2]|0,_[d>>2]=(_[m>>2]|0)-y,_[d+4>>2]=(_[m+4>>2]|0)-y}function fg(m,d){m=m|0,d=d|0;var y=0,b=0,I=0,R=0,O=0,N=0;b=_[m>>2]|0,_[d>>2]=b,I=_[m+4>>2]|0,O=d+4|0,_[O>>2]=I,N=d+8|0,_[N>>2]=0,y=(I|0)<(b|0),m=y?b:I,y=y?I:b;do if((y|0)<0){if((m|0)>0){if((m|-2147483648|0)<(y|0)&((y|0)!=-2147483648&(2147483647-m|0)>=(y|0)))break;return m=1,m|0}if((y|0)==-2147483648|(-2147483648-m|0)>(y|0))return d=1,d|0;if((m|0)>-1){if((m|-2147483648|0)<(y|0))break;return m=1,m|0}else{if((m^-2147483648|0)<(y|0))m=1;else break;return m|0}}while(!1);return m=I-b|0,(b|0)<0?(y=0-b|0,_[O>>2]=m,_[N>>2]=y,_[d>>2]=0,b=0):(m=I,y=0),(m|0)<0&&(b=b-m|0,_[d>>2]=b,y=y-m|0,_[N>>2]=y,_[O>>2]=0,m=0),R=b-y|0,I=m-y|0,(y|0)<0?(_[d>>2]=R,_[O>>2]=I,_[N>>2]=0,m=I,I=R,y=0):I=b,b=(m|0)<(I|0)?m:I,b=(y|0)<(b|0)?y:b,(b|0)<=0?(d=0,d|0):(_[d>>2]=I-b,_[O>>2]=m-b,_[N>>2]=y-b,d=0,d|0)}function Vf(m){m=m|0;var d=0,y=0,b=0,I=0;d=m+8|0,I=_[d>>2]|0,y=I-(_[m>>2]|0)|0,_[m>>2]=y,b=m+4|0,m=(_[b>>2]|0)-I|0,_[b>>2]=m,_[d>>2]=0-(m+y)}function pg(m){m=m|0;var d=0,y=0,b=0,I=0,R=0,O=0,N=0;y=_[m>>2]|0,d=0-y|0,_[m>>2]=d,O=m+8|0,_[O>>2]=0,N=m+4|0,b=_[N>>2]|0,I=b+y|0,(y|0)>0?(_[N>>2]=I,_[O>>2]=y,_[m>>2]=0,d=0,b=I):y=0,(b|0)<0?(R=d-b|0,_[m>>2]=R,y=y-b|0,_[O>>2]=y,_[N>>2]=0,I=R-y|0,d=0-y|0,(y|0)<0?(_[m>>2]=I,_[N>>2]=d,_[O>>2]=0,b=d,y=0):(b=0,I=R)):I=d,d=(b|0)<(I|0)?b:I,d=(y|0)<(d|0)?y:d,!((d|0)<=0)&&(_[m>>2]=I-d,_[N>>2]=b-d,_[O>>2]=y-d)}function cy(m,d,y,b,I){m=m|0,d=d|0,y=y|0,b=b|0,I=I|0;var R=0,O=0,N=0,H=0,Q=0,ot=0,At=0;if(At=pt,pt=pt+64|0,ot=At,N=At+56|0,!(!0&(d&2013265920|0)==134217728&(!0&(b&2013265920|0)==134217728)))return I=5,pt=At,I|0;if((m|0)==(y|0)&(d|0)==(b|0))return _[I>>2]=0,I=0,pt=At,I|0;if(O=De(m|0,d|0,52)|0,St()|0,O=O&15,Q=De(y|0,b|0,52)|0,St()|0,(O|0)!=(Q&15|0))return I=12,pt=At,I|0;if(R=O+-1|0,O>>>0>1){Xn(m,d,R,ot)|0,Xn(y,b,R,N)|0,Q=ot,H=_[Q>>2]|0,Q=_[Q+4>>2]|0;t:do if((H|0)==(_[N>>2]|0)&&(Q|0)==(_[N+4>>2]|0)){O=(O^15)*3|0,R=De(m|0,d|0,O|0)|0,St()|0,R=R&7,O=De(y|0,b|0,O|0)|0,St()|0,O=O&7;do if((R|0)==0|(O|0)==0)_[I>>2]=1,R=0;else if((R|0)==7)R=5;else{if((R|0)==1|(O|0)==1&&Sn(H,Q)|0){R=5;break}if((_[15536+(R<<2)>>2]|0)!=(O|0)&&(_[15568+(R<<2)>>2]|0)!=(O|0))break t;_[I>>2]=1,R=0}while(!1);return I=R,pt=At,I|0}while(!1)}R=ot,O=R+56|0;do _[R>>2]=0,R=R+4|0;while((R|0)<(O|0));return Ad(m,d,1,ot)|0,d=ot,!((_[d>>2]|0)==(y|0)&&(_[d+4>>2]|0)==(b|0))&&(d=ot+8|0,!((_[d>>2]|0)==(y|0)&&(_[d+4>>2]|0)==(b|0)))&&(d=ot+16|0,!((_[d>>2]|0)==(y|0)&&(_[d+4>>2]|0)==(b|0)))&&(d=ot+24|0,!((_[d>>2]|0)==(y|0)&&(_[d+4>>2]|0)==(b|0)))&&(d=ot+32|0,!((_[d>>2]|0)==(y|0)&&(_[d+4>>2]|0)==(b|0)))&&(d=ot+40|0,!((_[d>>2]|0)==(y|0)&&(_[d+4>>2]|0)==(b|0)))?(R=ot+48|0,R=((_[R>>2]|0)==(y|0)?(_[R+4>>2]|0)==(b|0):0)&1):R=1,_[I>>2]=R,I=0,pt=At,I|0}function ka(m,d,y,b,I){return m=m|0,d=d|0,y=y|0,b=b|0,I=I|0,y=im(m,d,y,b)|0,(y|0)==7?(I=11,I|0):(b=Ge(y|0,0,56)|0,d=d&-2130706433|(St()|0)|268435456,_[I>>2]=m|b,_[I+4>>2]=d,I=0,I|0)}function Yn(m,d,y){return m=m|0,d=d|0,y=y|0,!0&(d&2013265920|0)==268435456?(_[y>>2]=m,_[y+4>>2]=d&-2130706433|134217728,y=0,y|0):(y=6,y|0)}function cm(m,d,y){m=m|0,d=d|0,y=y|0;var b=0,I=0,R=0;return I=pt,pt=pt+16|0,b=I,_[b>>2]=0,!0&(d&2013265920|0)==268435456?(R=De(m|0,d|0,56)|0,St()|0,b=Zs(m,d&-2130706433|134217728,R&7,b,y)|0,pt=I,b|0):(b=6,pt=I,b|0)}function dg(m,d){m=m|0,d=d|0;var y=0;switch(y=De(m|0,d|0,56)|0,St()|0,y&7){case 0:case 7:return y=0,y|0;default:}return y=d&-2130706433|134217728,!(!0&(d&2013265920|0)==268435456)||!0&(d&117440512|0)==16777216&(Sn(m,y)|0)!=0?(y=0,y|0):(y=Kn(m,y)|0,y|0)}function uy(m,d,y){m=m|0,d=d|0,y=y|0;var b=0,I=0,R=0,O=0;return I=pt,pt=pt+16|0,b=I,!0&(d&2013265920|0)==268435456?(R=d&-2130706433|134217728,O=y,_[O>>2]=m,_[O+4>>2]=R,_[b>>2]=0,d=De(m|0,d|0,56)|0,St()|0,b=Zs(m,R,d&7,b,y+8|0)|0,pt=I,b|0):(b=6,pt=I,b|0)}function hy(m,d,y){m=m|0,d=d|0,y=y|0;var b=0,I=0;return I=(Sn(m,d)|0)==0,d=d&-2130706433,b=y,_[b>>2]=I?m:0,_[b+4>>2]=I?d|285212672:0,b=y+8|0,_[b>>2]=m,_[b+4>>2]=d|301989888,b=y+16|0,_[b>>2]=m,_[b+4>>2]=d|318767104,b=y+24|0,_[b>>2]=m,_[b+4>>2]=d|335544320,b=y+32|0,_[b>>2]=m,_[b+4>>2]=d|352321536,y=y+40|0,_[y>>2]=m,_[y+4>>2]=d|369098752,0}function xd(m,d,y){m=m|0,d=d|0,y=y|0;var b=0,I=0,R=0,O=0;return O=pt,pt=pt+16|0,I=O,R=d&-2130706433|134217728,!0&(d&2013265920|0)==268435456?(b=De(m|0,d|0,56)|0,St()|0,b=iu(m,R,b&7)|0,(b|0)==-1?(_[y>>2]=0,R=6,pt=O,R|0):($(m,R,I)|0&&Ur(23313,22484,282,22499),d=De(m|0,d|0,52)|0,St()|0,d=d&15,Sn(m,R)|0?Lh(I,d,b,2,y):bd(I,d,b,2,y),R=0,pt=O,R|0)):(R=6,pt=O,R|0)}function jb(m,d,y){m=m|0,d=d|0,y=y|0;var b=0,I=0;b=pt,pt=pt+16|0,I=b,Ko(m,d,y,I),tu(I,y+4|0),pt=b}function Ko(m,d,y,b){m=m|0,d=d|0,y=y|0,b=b|0;var I=0,R=0,O=0,N=0,H=0;if(N=pt,pt=pt+16|0,H=N,um(m,y,H),R=+tm(+(1-+ft[H>>3]*.5)),R<1e-16){_[b>>2]=0,_[b+4>>2]=0,_[b+8>>2]=0,_[b+12>>2]=0,pt=N;return}if(H=_[y>>2]|0,I=+ft[15920+(H*24|0)>>3],I=+Bt(I-+Bt(+Pe(15600+(H<<4)|0,m))),P(d)|0?O=+Bt(I+-.3334731722518321):O=I,I=+ku(+R)/.381966011250105,(d|0)>0){m=0;do I=I*2.6457513110645907,m=m+1|0;while((m|0)!=(d|0))}R=+cn(+O)*I,ft[b>>3]=R,O=+un(+O)*I,ft[b+8>>3]=O,pt=N}function um(m,d,y){m=m|0,d=d|0,y=y|0;var b=0,I=0,R=0;if(R=pt,pt=pt+32|0,I=R,xg(m,I),_[d>>2]=0,ft[y>>3]=5,b=+Cn(16400,I),b<+ft[y>>3]&&(_[d>>2]=0,ft[y>>3]=b),b=+Cn(16424,I),b<+ft[y>>3]&&(_[d>>2]=1,ft[y>>3]=b),b=+Cn(16448,I),b<+ft[y>>3]&&(_[d>>2]=2,ft[y>>3]=b),b=+Cn(16472,I),b<+ft[y>>3]&&(_[d>>2]=3,ft[y>>3]=b),b=+Cn(16496,I),b<+ft[y>>3]&&(_[d>>2]=4,ft[y>>3]=b),b=+Cn(16520,I),b<+ft[y>>3]&&(_[d>>2]=5,ft[y>>3]=b),b=+Cn(16544,I),b<+ft[y>>3]&&(_[d>>2]=6,ft[y>>3]=b),b=+Cn(16568,I),b<+ft[y>>3]&&(_[d>>2]=7,ft[y>>3]=b),b=+Cn(16592,I),b<+ft[y>>3]&&(_[d>>2]=8,ft[y>>3]=b),b=+Cn(16616,I),b<+ft[y>>3]&&(_[d>>2]=9,ft[y>>3]=b),b=+Cn(16640,I),b<+ft[y>>3]&&(_[d>>2]=10,ft[y>>3]=b),b=+Cn(16664,I),b<+ft[y>>3]&&(_[d>>2]=11,ft[y>>3]=b),b=+Cn(16688,I),b<+ft[y>>3]&&(_[d>>2]=12,ft[y>>3]=b),b=+Cn(16712,I),b<+ft[y>>3]&&(_[d>>2]=13,ft[y>>3]=b),b=+Cn(16736,I),b<+ft[y>>3]&&(_[d>>2]=14,ft[y>>3]=b),b=+Cn(16760,I),b<+ft[y>>3]&&(_[d>>2]=15,ft[y>>3]=b),b=+Cn(16784,I),b<+ft[y>>3]&&(_[d>>2]=16,ft[y>>3]=b),b=+Cn(16808,I),b<+ft[y>>3]&&(_[d>>2]=17,ft[y>>3]=b),b=+Cn(16832,I),b<+ft[y>>3]&&(_[d>>2]=18,ft[y>>3]=b),b=+Cn(16856,I),!(b<+ft[y>>3])){pt=R;return}_[d>>2]=19,ft[y>>3]=b,pt=R}function ur(m,d,y,b,I){m=m|0,d=d|0,y=y|0,b=b|0,I=I|0;var R=0,O=0;if(R=+Vh(m),R<1e-16){d=15600+(d<<4)|0,_[I>>2]=_[d>>2],_[I+4>>2]=_[d+4>>2],_[I+8>>2]=_[d+8>>2],_[I+12>>2]=_[d+12>>2];return}if(O=+ua(+ +ft[m+8>>3],+ +ft[m>>3]),(y|0)>0){m=0;do R=R/2.6457513110645907,m=m+1|0;while((m|0)!=(y|0))}b?(R=R/3,y=(P(y)|0)==0,R=+Bf(+((y?R:R/2.6457513110645907)*.381966011250105))):(R=+Bf(+(R*.381966011250105)),P(y)|0&&(O=+Bt(O+.3334731722518321))),Te(15600+(d<<4)|0,+Bt(+ft[15920+(d*24|0)>>3]-O),R,I)}function Dr(m,d,y){m=m|0,d=d|0,y=y|0;var b=0,I=0;b=pt,pt=pt+16|0,I=b,hc(m+4|0,I),ur(I,_[m>>2]|0,d,0,y),pt=b}function Lh(m,d,y,b,I){m=m|0,d=d|0,y=y|0,b=b|0,I=I|0;var R=0,O=0,N=0,H=0,Q=0,ot=0,At=0,jt=0,Xt=0,zt=0,ie=0,ge=0,me=0,ue=0,fe=0,ne=0,tr=0,pr=0,Xe=0,er=0,xn=0,hn=0,Zi=0,Pi=0,Ar=0,gi=0,kn=0,ti=0;if(gi=pt,pt=pt+272|0,R=gi+256|0,ue=gi+240|0,Zi=gi,Pi=gi+224|0,Ar=gi+208|0,fe=gi+176|0,ne=gi+160|0,tr=gi+192|0,pr=gi+144|0,Xe=gi+128|0,er=gi+112|0,xn=gi+96|0,hn=gi+80|0,_[R>>2]=d,_[ue>>2]=_[m>>2],_[ue+4>>2]=_[m+4>>2],_[ue+8>>2]=_[m+8>>2],_[ue+12>>2]=_[m+12>>2],hm(ue,R,Zi),_[I>>2]=0,ue=b+y+((b|0)==5&1)|0,(ue|0)<=(y|0)){pt=gi;return}H=_[R>>2]|0,Q=Pi+4|0,ot=fe+4|0,At=y+5|0,jt=16880+(H<<2)|0,Xt=16960+(H<<2)|0,zt=Xe+8|0,ie=er+8|0,ge=xn+8|0,me=Ar+4|0,N=y;t:for(;;){O=Zi+(((N|0)%5|0)<<4)|0,_[Ar>>2]=_[O>>2],_[Ar+4>>2]=_[O+4>>2],_[Ar+8>>2]=_[O+8>>2],_[Ar+12>>2]=_[O+12>>2];do;while((Nu(Ar,H,0,1)|0)==2);if((N|0)>(y|0)&(P(d)|0)!=0){if(_[fe>>2]=_[Ar>>2],_[fe+4>>2]=_[Ar+4>>2],_[fe+8>>2]=_[Ar+8>>2],_[fe+12>>2]=_[Ar+12>>2],hc(Q,ne),b=_[fe>>2]|0,R=_[17040+(b*80|0)+(_[Pi>>2]<<2)>>2]|0,_[fe>>2]=_[18640+(b*80|0)+(R*20|0)>>2],O=_[18640+(b*80|0)+(R*20|0)+16>>2]|0,(O|0)>0){m=0;do ly(ot),m=m+1|0;while((m|0)<(O|0))}switch(O=18640+(b*80|0)+(R*20|0)+4|0,_[tr>>2]=_[O>>2],_[tr+4>>2]=_[O+4>>2],_[tr+8>>2]=_[O+8>>2],lg(tr,(_[jt>>2]|0)*3|0),ws(ot,tr,ot),Ve(ot),hc(ot,pr),kn=+(_[Xt>>2]|0),ft[Xe>>3]=kn*3,ft[zt>>3]=0,ti=kn*-1.5,ft[er>>3]=ti,ft[ie>>3]=kn*2.598076211353316,ft[xn>>3]=ti,ft[ge>>3]=kn*-2.598076211353316,_[17040+((_[fe>>2]|0)*80|0)+(_[Ar>>2]<<2)>>2]|0){case 1:{m=er,b=Xe;break}case 3:{m=xn,b=er;break}case 2:{m=Xe,b=xn;break}default:{m=12;break t}}Nl(ne,pr,b,m,hn),ur(hn,_[fe>>2]|0,H,1,I+8+(_[I>>2]<<4)|0),_[I>>2]=(_[I>>2]|0)+1}if((N|0)<(At|0)&&(hc(me,fe),ur(fe,_[Ar>>2]|0,H,1,I+8+(_[I>>2]<<4)|0),_[I>>2]=(_[I>>2]|0)+1),_[Pi>>2]=_[Ar>>2],_[Pi+4>>2]=_[Ar+4>>2],_[Pi+8>>2]=_[Ar+8>>2],_[Pi+12>>2]=_[Ar+12>>2],N=N+1|0,(N|0)>=(ue|0)){m=3;break}}if((m|0)==3){pt=gi;return}else(m|0)==12&&Ur(22522,22569,571,22579)}function hm(m,d,y){m=m|0,d=d|0,y=y|0;var b=0,I=0,R=0,O=0,N=0,H=0;H=pt,pt=pt+128|0,b=H+64|0,I=H,R=b,O=20240,N=R+60|0;do _[R>>2]=_[O>>2],R=R+4|0,O=O+4|0;while((R|0)<(N|0));R=I,O=20304,N=R+60|0;do _[R>>2]=_[O>>2],R=R+4|0,O=O+4|0;while((R|0)<(N|0));N=(P(_[d>>2]|0)|0)==0,b=N?b:I,I=m+4|0,lm(I),Qo(I),P(_[d>>2]|0)|0&&(Bu(I),_[d>>2]=(_[d>>2]|0)+1),_[y>>2]=_[m>>2],d=y+4|0,ws(I,b,d),Ve(d),_[y+16>>2]=_[m>>2],d=y+20|0,ws(I,b+12|0,d),Ve(d),_[y+32>>2]=_[m>>2],d=y+36|0,ws(I,b+24|0,d),Ve(d),_[y+48>>2]=_[m>>2],d=y+52|0,ws(I,b+36|0,d),Ve(d),_[y+64>>2]=_[m>>2],y=y+68|0,ws(I,b+48|0,y),Ve(y),pt=H}function Nu(m,d,y,b){m=m|0,d=d|0,y=y|0,b=b|0;var I=0,R=0,O=0,N=0,H=0,Q=0,ot=0,At=0,jt=0,Xt=0,zt=0;if(zt=pt,pt=pt+32|0,jt=zt+12|0,N=zt,Xt=m+4|0,At=_[16960+(d<<2)>>2]|0,ot=(b|0)!=0,At=ot?At*3|0:At,I=_[Xt>>2]|0,Q=m+8|0,O=_[Q>>2]|0,ot){if(R=m+12|0,b=_[R>>2]|0,I=O+I+b|0,(I|0)==(At|0))return Xt=1,pt=zt,Xt|0;H=R}else H=m+12|0,b=_[H>>2]|0,I=O+I+b|0;if((I|0)<=(At|0))return Xt=0,pt=zt,Xt|0;do if((b|0)>0){if(b=_[m>>2]|0,(O|0)>0){R=18640+(b*80|0)+60|0,b=m;break}b=18640+(b*80|0)+40|0,y?(zf(jt,At,0,0),Ou(Xt,jt,N),Uf(N),ws(N,jt,Xt),R=b,b=m):(R=b,b=m)}else R=18640+((_[m>>2]|0)*80|0)+20|0,b=m;while(!1);if(_[b>>2]=_[R>>2],I=R+16|0,(_[I>>2]|0)>0){b=0;do ly(Xt),b=b+1|0;while((b|0)<(_[I>>2]|0))}return m=R+4|0,_[jt>>2]=_[m>>2],_[jt+4>>2]=_[m+4>>2],_[jt+8>>2]=_[m+8>>2],d=_[16880+(d<<2)>>2]|0,lg(jt,ot?d*3|0:d),ws(Xt,jt,Xt),Ve(Xt),ot?b=((_[Q>>2]|0)+(_[Xt>>2]|0)+(_[H>>2]|0)|0)==(At|0)?1:2:b=2,Xt=b,pt=zt,Xt|0}function Ds(m,d){m=m|0,d=d|0;var y=0;do y=Nu(m,d,0,1)|0;while((y|0)==2);return y|0}function bd(m,d,y,b,I){m=m|0,d=d|0,y=y|0,b=b|0,I=I|0;var R=0,O=0,N=0,H=0,Q=0,ot=0,At=0,jt=0,Xt=0,zt=0,ie=0,ge=0,me=0,ue=0,fe=0,ne=0,tr=0,pr=0,Xe=0,er=0,xn=0,hn=0,Zi=0;if(xn=pt,pt=pt+240|0,R=xn+224|0,tr=xn+208|0,pr=xn,Xe=xn+192|0,er=xn+176|0,ge=xn+160|0,me=xn+144|0,ue=xn+128|0,fe=xn+112|0,ne=xn+96|0,_[R>>2]=d,_[tr>>2]=_[m>>2],_[tr+4>>2]=_[m+4>>2],_[tr+8>>2]=_[m+8>>2],_[tr+12>>2]=_[m+12>>2],Da(tr,R,pr),_[I>>2]=0,ie=b+y+((b|0)==6&1)|0,(ie|0)<=(y|0)){pt=xn;return}H=_[R>>2]|0,Q=y+6|0,ot=16960+(H<<2)|0,At=me+8|0,jt=ue+8|0,Xt=fe+8|0,zt=Xe+4|0,O=0,N=y,b=-1;t:for(;;){if(R=(N|0)%6|0,m=pr+(R<<4)|0,_[Xe>>2]=_[m>>2],_[Xe+4>>2]=_[m+4>>2],_[Xe+8>>2]=_[m+8>>2],_[Xe+12>>2]=_[m+12>>2],m=O,O=Nu(Xe,H,0,1)|0,(N|0)>(y|0)&(P(d)|0)!=0&&(m|0)!=1&&(_[Xe>>2]|0)!=(b|0)){switch(hc(pr+(((R+5|0)%6|0)<<4)+4|0,er),hc(pr+(R<<4)+4|0,ge),hn=+(_[ot>>2]|0),ft[me>>3]=hn*3,ft[At>>3]=0,Zi=hn*-1.5,ft[ue>>3]=Zi,ft[jt>>3]=hn*2.598076211353316,ft[fe>>3]=Zi,ft[Xt>>3]=hn*-2.598076211353316,R=_[tr>>2]|0,_[17040+(R*80|0)+(((b|0)==(R|0)?_[Xe>>2]|0:b)<<2)>>2]|0){case 1:{m=ue,b=me;break}case 3:{m=fe,b=ue;break}case 2:{m=me,b=fe;break}default:{m=8;break t}}Nl(er,ge,b,m,ne),!(Ba(er,ne)|0)&&!(Ba(ge,ne)|0)&&(ur(ne,_[tr>>2]|0,H,1,I+8+(_[I>>2]<<4)|0),_[I>>2]=(_[I>>2]|0)+1)}if((N|0)<(Q|0)&&(hc(zt,er),ur(er,_[Xe>>2]|0,H,1,I+8+(_[I>>2]<<4)|0),_[I>>2]=(_[I>>2]|0)+1),N=N+1|0,(N|0)>=(ie|0)){m=3;break}else b=_[Xe>>2]|0}if((m|0)==3){pt=xn;return}else(m|0)==8&&Ur(22606,22569,736,22651)}function Da(m,d,y){m=m|0,d=d|0,y=y|0;var b=0,I=0,R=0,O=0,N=0,H=0;H=pt,pt=pt+160|0,b=H+80|0,I=H,R=b,O=20368,N=R+72|0;do _[R>>2]=_[O>>2],R=R+4|0,O=O+4|0;while((R|0)<(N|0));R=I,O=20448,N=R+72|0;do _[R>>2]=_[O>>2],R=R+4|0,O=O+4|0;while((R|0)<(N|0));N=(P(_[d>>2]|0)|0)==0,b=N?b:I,I=m+4|0,lm(I),Qo(I),P(_[d>>2]|0)|0&&(Bu(I),_[d>>2]=(_[d>>2]|0)+1),_[y>>2]=_[m>>2],d=y+4|0,ws(I,b,d),Ve(d),_[y+16>>2]=_[m>>2],d=y+20|0,ws(I,b+12|0,d),Ve(d),_[y+32>>2]=_[m>>2],d=y+36|0,ws(I,b+24|0,d),Ve(d),_[y+48>>2]=_[m>>2],d=y+52|0,ws(I,b+36|0,d),Ve(d),_[y+64>>2]=_[m>>2],d=y+68|0,ws(I,b+48|0,d),Ve(d),_[y+80>>2]=_[m>>2],y=y+84|0,ws(I,b+60|0,y),Ve(y),pt=H}function fy(m,d){return m=m|0,d=d|0,d=De(m|0,d|0,52)|0,St()|0,d&15|0}function Lu(m,d){return m=m|0,d=d|0,d=De(m|0,d|0,45)|0,St()|0,d&127|0}function Kn(m,d){m=m|0,d=d|0;var y=0,b=0,I=0,R=0,O=0,N=0;if(!(!0&(d&-16777216|0)==134217728)||(O=De(m|0,d|0,45)|0,St()|0,O=O&127,O>>>0>121))return d=0,d|0;y=De(m|0,d|0,52)|0,St()|0,y=y&15;do if(y|0){for(I=1,b=0;;){if(R=De(m|0,d|0,(15-I|0)*3|0)|0,St()|0,R=R&7,(R|0)!=0&(b^1))if((R|0)==1&(Tn(O)|0)!=0){N=0,b=13;break}else b=1;if((R|0)==7){N=0,b=13;break}if(I>>>0<y>>>0)I=I+1|0;else{b=9;break}}if((b|0)==9){if((y|0)==15)N=1;else break;return N|0}else if((b|0)==13)return N|0}while(!1);for(;;){if(N=De(m|0,d|0,(14-y|0)*3|0)|0,St()|0,!((N&7|0)==7&!0)){N=0,b=13;break}if(y>>>0<14)y=y+1|0;else{N=1,b=13;break}}return(b|0)==13?N|0:0}function Xn(m,d,y,b){m=m|0,d=d|0,y=y|0,b=b|0;var I=0,R=0;if(R=De(m|0,d|0,52)|0,St()|0,R=R&15,y>>>0>15)return b=4,b|0;if((R|0)<(y|0))return b=12,b|0;if((R|0)==(y|0))return _[b>>2]=m,_[b+4>>2]=d,b=0,b|0;if(I=Ge(y|0,0,52)|0,I=I|m,m=St()|0|d&-15728641,(R|0)>(y|0))do d=Ge(7,0,(14-y|0)*3|0)|0,y=y+1|0,I=d|I,m=St()|0|m;while((y|0)<(R|0));return _[b>>2]=I,_[b+4>>2]=m,b=0,b|0}function ru(m,d,y,b){m=m|0,d=d|0,y=y|0,b=b|0;var I=0,R=0,O=0;if(R=De(m|0,d|0,52)|0,St()|0,R=R&15,!((y|0)<16&(R|0)<=(y|0)))return b=4,b|0;I=y-R|0,y=De(m|0,d|0,45)|0,St()|0;t:do if(!(Tn(y&127)|0))y=Es(7,0,I,((I|0)<0)<<31>>31)|0,I=St()|0;else{e:do if(R|0){for(y=1;O=Ge(7,0,(15-y|0)*3|0)|0,!!((O&m|0)==0&((St()|0)&d|0)==0);)if(y>>>0<R>>>0)y=y+1|0;else break e;y=Es(7,0,I,((I|0)<0)<<31>>31)|0,I=St()|0;break t}while(!1);y=Es(7,0,I,((I|0)<0)<<31>>31)|0,y=Jo(y|0,St()|0,5,0)|0,y=Ii(y|0,St()|0,-5,-1)|0,y=Uu(y|0,St()|0,6,0)|0,y=Ii(y|0,St()|0,1,0)|0,I=St()|0}while(!1);return O=b,_[O>>2]=y,_[O+4>>2]=I,O=0,O|0}function Sn(m,d){m=m|0,d=d|0;var y=0,b=0,I=0;if(I=De(m|0,d|0,45)|0,St()|0,!(Tn(I&127)|0))return I=0,I|0;I=De(m|0,d|0,52)|0,St()|0,I=I&15;t:do if(!I)y=0;else for(b=1;;){if(y=De(m|0,d|0,(15-b|0)*3|0)|0,St()|0,y=y&7,y|0)break t;if(b>>>0<I>>>0)b=b+1|0;else{y=0;break}}while(!1);return I=(y|0)==0&1,I|0}function vd(m,d,y,b){m=m|0,d=d|0,y=y|0,b=b|0;var I=0,R=0,O=0,N=0;if(O=pt,pt=pt+16|0,R=O,Zt(R,m,d,y),d=R,m=_[d>>2]|0,d=_[d+4>>2]|0,(m|0)==0&(d|0)==0)return pt=O,0;I=0,y=0;do N=b+(I<<3)|0,_[N>>2]=m,_[N+4>>2]=d,I=Ii(I|0,y|0,1,0)|0,y=St()|0,se(R),N=R,m=_[N>>2]|0,d=_[N+4>>2]|0;while(!((m|0)==0&(d|0)==0));return pt=O,0}function Fh(m,d,y,b){return m=m|0,d=d|0,y=y|0,b=b|0,(b|0)<(y|0)?(y=d,b=m,Ei(y|0),b|0):(y=Ge(-1,-1,((b-y|0)*3|0)+3|0)|0,b=Ge(~y|0,~(St()|0)|0,(15-b|0)*3|0)|0,y=~(St()|0)&d,b=~b&m,Ei(y|0),b|0)}function mg(m,d,y,b){m=m|0,d=d|0,y=y|0,b=b|0;var I=0;return I=De(m|0,d|0,52)|0,St()|0,I=I&15,(y|0)<16&(I|0)<=(y|0)?((I|0)<(y|0)&&(I=Ge(-1,-1,((y+-1-I|0)*3|0)+3|0)|0,I=Ge(~I|0,~(St()|0)|0,(15-y|0)*3|0)|0,d=~(St()|0)&d,m=~I&m),I=Ge(y|0,0,52)|0,y=d&-15728641|(St()|0),_[b>>2]=m|I,_[b+4>>2]=y,b=0,b|0):(b=4,b|0)}function Ag(m,d,y,b){m=m|0,d=d|0,y=y|0,b=b|0;var I=0,R=0,O=0,N=0,H=0,Q=0,ot=0,At=0,jt=0,Xt=0,zt=0,ie=0,ge=0,me=0,ue=0,fe=0,ne=0,tr=0,pr=0,Xe=0,er=0;if((y|0)==0&(b|0)==0)return Xe=0,Xe|0;if(I=m,R=_[I>>2]|0,I=_[I+4>>2]|0,!0&(I&15728640|0)==0){if(!((b|0)>0|(b|0)==0&y>>>0>0)||(Xe=d,_[Xe>>2]=R,_[Xe+4>>2]=I,(y|0)==1&(b|0)==0))return Xe=0,Xe|0;I=1;do tr=m+(I<<3)|0,pr=_[tr+4>>2]|0,Xe=d+(I<<3)|0,_[Xe>>2]=_[tr>>2],_[Xe+4>>2]=pr,I=I+1|0;while(0<(b|0)|(b|0)==0&I>>>0<y>>>0);return I=0,I|0}if(ne=y<<3,pr=mc(ne)|0,!pr)return Xe=13,Xe|0;if(gy(pr|0,m|0,ne|0)|0,tr=nu(y,8)|0,!tr)return oi(pr),Xe=13,Xe|0;t:do if(y|0){e:for(;;){I=pr,me=_[I>>2]|0,I=_[I+4>>2]|0,ue=De(me|0,I|0,52)|0,St()|0,ue=ue&15,fe=ue+-1|0,ge=(y|0)>0;r:do if((ue|0)!=0&ge){if(Xt=((y|0)<0)<<31>>31,zt=Ge(fe|0,0,52)|0,ie=St()|0,fe>>>0>15){if(!((me|0)==0&(I|0)==0)){Xe=17;break e}for(R=0;;){if(R=R+1|0,(R|0)>=(y|0))break r;if(b=pr+(R<<3)|0,ie=_[b>>2]|0,b=_[b+4>>2]|0,!((ie|0)==0&(b|0)==0)){I=b,Xe=17;break e}}}for(R=0,m=me,b=I;;){if(!((m|0)==0&(b|0)==0)){if(!(!0&(b&117440512|0)==0)){Xe=22;break e}if(N=De(m|0,b|0,52)|0,St()|0,N=N&15,(N|0)<(fe|0)){I=12,Xe=28;break e}if((N|0)!=(fe|0)&&(m=m|zt,b=b&-15728641|ie,N>>>0>=ue>>>0)){O=fe;do jt=Ge(7,0,(14-O|0)*3|0)|0,O=O+1|0,m=jt|m,b=St()|0|b;while(O>>>0<N>>>0)}if(O=Ks(m|0,b|0,y|0,Xt|0)|0,St()|0,Q=tr+(O<<3)|0,N=Q,H=_[N>>2]|0,N=_[N+4>>2]|0,(H|0)==0&(N|0)==0)O=Q;else for(jt=0;;){if((jt|0)>(y|0)){Xe=32;break e}if((H|0)==(m|0)&(N&-117440513|0)==(b|0)){ot=De(H|0,N|0,56)|0,St()|0,ot=ot&7,At=ot+1|0,er=De(H|0,N|0,45)|0,St()|0;i:do if(!(Tn(er&127)|0))N=7;else{if(H=De(H|0,N|0,52)|0,St()|0,H=H&15,!H){N=6;break}for(N=1;;){if(er=Ge(7,0,(15-N|0)*3|0)|0,!((er&m|0)==0&((St()|0)&b|0)==0)){N=7;break i}if(N>>>0<H>>>0)N=N+1|0;else{N=6;break}}}while(!1);if((ot+2|0)>>>0>N>>>0){Xe=42;break e}er=Ge(At|0,0,56)|0,b=St()|0|b&-117440513,At=Q,_[At>>2]=0,_[At+4>>2]=0,m=er|m}else O=(O+1|0)%(y|0)|0;if(Q=tr+(O<<3)|0,N=Q,H=_[N>>2]|0,N=_[N+4>>2]|0,(H|0)==0&(N|0)==0){O=Q;break}else jt=jt+1|0}er=O,_[er>>2]=m,_[er+4>>2]=b}if(R=R+1|0,(R|0)>=(y|0))break r;b=pr+(R<<3)|0,m=_[b>>2]|0,b=_[b+4>>2]|0}}while(!1);if((y+5|0)>>>0<11){Xe=85;break}if(ie=nu((y|0)/6|0,8)|0,!ie){Xe=49;break}r:do if(ge){jt=0,At=0;do{if(N=tr+(jt<<3)|0,b=N,R=_[b>>2]|0,b=_[b+4>>2]|0,!((R|0)==0&(b|0)==0)){H=De(R|0,b|0,56)|0,St()|0,H=H&7,m=H+1|0,Q=b&-117440513,er=De(R|0,b|0,45)|0,St()|0;i:do if(Tn(er&127)|0){if(ot=De(R|0,b|0,52)|0,St()|0,ot=ot&15,ot|0)for(O=1;;){if(er=Ge(7,0,(15-O|0)*3|0)|0,!((R&er|0)==0&(Q&(St()|0)|0)==0))break i;if(O>>>0<ot>>>0)O=O+1|0;else break}b=Ge(m|0,0,56)|0,R=b|R,b=St()|0|Q,m=N,_[m>>2]=R,_[m+4>>2]=b,m=H+2|0}while(!1);(m|0)==7&&(er=ie+(At<<3)|0,_[er>>2]=R,_[er+4>>2]=b&-117440513,At=At+1|0)}jt=jt+1|0}while((jt|0)!=(y|0));if(ge){if(jt=((y|0)<0)<<31>>31,Xt=Ge(fe|0,0,52)|0,zt=St()|0,fe>>>0>15){if(!((me|0)==0&(I|0)==0)){I=4,Xe=84;break e}for(I=0;;){if(I=I+1|0,(I|0)>=(y|0)){R=0,I=At;break r}if(er=pr+(I<<3)|0,!((_[er>>2]|0)==0&(_[er+4>>2]|0)==0)){I=4,Xe=84;break e}}}for(ot=0,R=0,Q=me;;){do if(!((Q|0)==0&(I|0)==0)){if(N=De(Q|0,I|0,52)|0,St()|0,N=N&15,(N|0)<(fe|0)){I=12,Xe=84;break e}do if((N|0)==(fe|0))b=Q,N=I;else{if(b=Q|Xt,m=I&-15728641|zt,N>>>0<ue>>>0){N=m;break}O=fe;do er=Ge(7,0,(14-O|0)*3|0)|0,O=O+1|0,b=er|b,m=St()|0|m;while(O>>>0<N>>>0);N=m}while(!1);for(O=Ks(b|0,N|0,y|0,jt|0)|0,St()|0,m=0;;){if((m|0)>(y|0)){Xe=77;break e}if(er=tr+(O<<3)|0,H=_[er+4>>2]|0,(H&-117440513|0)==(N|0)&&(_[er>>2]|0)==(b|0)){Xe=79;break}if(O=(O+1|0)%(y|0)|0,er=tr+(O<<3)|0,(_[er>>2]|0)==(b|0)&&(_[er+4>>2]|0)==(N|0))break;m=m+1|0}if((Xe|0)==79&&(Xe=0,!0&(H&117440512|0)==100663296))break;er=d+(R<<3)|0,_[er>>2]=Q,_[er+4>>2]=I,R=R+1|0}while(!1);if(I=ot+1|0,(I|0)>=(y|0)){I=At;break r}er=pr+(I<<3)|0,ot=I,Q=_[er>>2]|0,I=_[er+4>>2]|0}}else R=0,I=At}else R=0,I=0;while(!1);if(Yf(tr|0,0,ne|0)|0,gy(pr|0,ie|0,I<<3|0)|0,oi(ie),I)d=d+(R<<3)|0,y=I;else break t}if((Xe|0)==17)!0&(I&117440512|0)==0?(I=4,Xe=28):Xe=22;else if((Xe|0)==32)Ur(23313,22674,362,22684);else{if((Xe|0)==42)return oi(pr),oi(tr),er=10,er|0;if((Xe|0)==49)return oi(pr),oi(tr),er=13,er|0;if((Xe|0)==77)Ur(23313,22674,462,22684);else{if((Xe|0)==84)return oi(ie),oi(pr),oi(tr),er=I,er|0;if((Xe|0)==85){gy(d|0,pr|0,y<<3|0)|0;break}}}if((Xe|0)==22)return oi(pr),oi(tr),er=5,er|0;if((Xe|0)==28)return oi(pr),oi(tr),er=I,er|0}while(!1);return oi(pr),oi(tr),er=0,er|0}function jf(m,d,y,b,I,R,O){m=m|0,d=d|0,y=y|0,b=b|0,I=I|0,R=R|0,O=O|0;var N=0,H=0,Q=0,ot=0,At=0,jt=0,Xt=0,zt=0,ie=0;if(ie=pt,pt=pt+16|0,zt=ie,!((y|0)>0|(y|0)==0&d>>>0>0))return zt=0,pt=ie,zt|0;if((O|0)>=16)return zt=12,pt=ie,zt|0;jt=0,Xt=0,At=0,N=0;t:for(;;){if(Q=m+(jt<<3)|0,H=_[Q>>2]|0,Q=_[Q+4>>2]|0,ot=De(H|0,Q|0,52)|0,St()|0,(ot&15|0)>(O|0)){N=12,H=11;break}if(Zt(zt,H,Q,O),ot=zt,Q=_[ot>>2]|0,ot=_[ot+4>>2]|0,(Q|0)==0&(ot|0)==0)H=At;else{H=At;do{if(!((N|0)<(R|0)|(N|0)==(R|0)&H>>>0<I>>>0)){H=10;break t}At=b+(H<<3)|0,_[At>>2]=Q,_[At+4>>2]=ot,H=Ii(H|0,N|0,1,0)|0,N=St()|0,se(zt),At=zt,Q=_[At>>2]|0,ot=_[At+4>>2]|0}while(!((Q|0)==0&(ot|0)==0))}if(jt=Ii(jt|0,Xt|0,1,0)|0,Xt=St()|0,(Xt|0)<(y|0)|(Xt|0)==(y|0)&jt>>>0<d>>>0)At=H;else{N=0,H=11;break}}return(H|0)==10?(zt=14,pt=ie,zt|0):(H|0)==11?(pt=ie,N|0):0}function gg(m,d,y,b,I){m=m|0,d=d|0,y=y|0,b=b|0,I=I|0;var R=0,O=0,N=0,H=0,Q=0,ot=0,At=0,jt=0;jt=pt,pt=pt+16|0,At=jt;t:do if((y|0)>0|(y|0)==0&d>>>0>0){for(Q=0,O=0,R=0,ot=0;;){if(H=m+(Q<<3)|0,N=_[H>>2]|0,H=_[H+4>>2]|0,!((N|0)==0&(H|0)==0)&&(H=(ru(N,H,b,At)|0)==0,N=At,O=Ii(_[N>>2]|0,_[N+4>>2]|0,O|0,R|0)|0,R=St()|0,!H)){R=12;break}if(Q=Ii(Q|0,ot|0,1,0)|0,ot=St()|0,!((ot|0)<(y|0)|(ot|0)==(y|0)&Q>>>0<d>>>0))break t}return pt=jt,R|0}else O=0,R=0;while(!1);return _[I>>2]=O,_[I+4>>2]=R,I=0,pt=jt,I|0}function _g(m,d){return m=m|0,d=d|0,d=De(m|0,d|0,52)|0,St()|0,d&1|0}function si(m,d){m=m|0,d=d|0;var y=0,b=0,I=0;if(I=De(m|0,d|0,52)|0,St()|0,I=I&15,!I)return I=0,I|0;for(b=1;;){if(y=De(m|0,d|0,(15-b|0)*3|0)|0,St()|0,y=y&7,y|0){b=5;break}if(b>>>0<I>>>0)b=b+1|0;else{y=0,b=5;break}}return(b|0)==5?y|0:0}function M(m,d){m=m|0,d=d|0;var y=0,b=0,I=0,R=0,O=0,N=0,H=0;if(H=De(m|0,d|0,52)|0,St()|0,H=H&15,!H)return N=d,H=m,Ei(N|0),H|0;for(N=1,y=0;;){R=(15-N|0)*3|0,b=Ge(7,0,R|0)|0,I=St()|0,O=De(m|0,d|0,R|0)|0,St()|0,R=Ge(eu(O&7)|0,0,R|0)|0,O=St()|0,m=R|m&~b,d=O|d&~I;t:do if(!y)if((R&b|0)==0&(O&I|0)==0)y=0;else if(b=De(m|0,d|0,52)|0,St()|0,b=b&15,!b)y=1;else{y=1;e:for(;;){switch(O=De(m|0,d|0,(15-y|0)*3|0)|0,St()|0,O&7){case 1:break e;case 0:break;default:{y=1;break t}}if(y>>>0<b>>>0)y=y+1|0;else{y=1;break t}}for(y=1;;)if(O=(15-y|0)*3|0,I=De(m|0,d|0,O|0)|0,St()|0,R=Ge(7,0,O|0)|0,d=d&~(St()|0),O=Ge(eu(I&7)|0,0,O|0)|0,m=m&~R|O,d=d|(St()|0),y>>>0<b>>>0)y=y+1|0;else{y=1;break}}while(!1);if(N>>>0<H>>>0)N=N+1|0;else break}return Ei(d|0),m|0}function c(m,d){m=m|0,d=d|0;var y=0,b=0,I=0,R=0,O=0;if(b=De(m|0,d|0,52)|0,St()|0,b=b&15,!b)return y=d,b=m,Ei(y|0),b|0;for(y=1;R=(15-y|0)*3|0,O=De(m|0,d|0,R|0)|0,St()|0,I=Ge(7,0,R|0)|0,d=d&~(St()|0),R=Ge(eu(O&7)|0,0,R|0)|0,m=R|m&~I,d=St()|0|d,y>>>0<b>>>0;)y=y+1|0;return Ei(d|0),m|0}function A(m,d){m=m|0,d=d|0;var y=0,b=0,I=0,R=0,O=0,N=0,H=0;if(H=De(m|0,d|0,52)|0,St()|0,H=H&15,!H)return N=d,H=m,Ei(N|0),H|0;for(N=1,y=0;;){R=(15-N|0)*3|0,b=Ge(7,0,R|0)|0,I=St()|0,O=De(m|0,d|0,R|0)|0,St()|0,R=Ge(fc(O&7)|0,0,R|0)|0,O=St()|0,m=R|m&~b,d=O|d&~I;t:do if(!y)if((R&b|0)==0&(O&I|0)==0)y=0;else if(b=De(m|0,d|0,52)|0,St()|0,b=b&15,!b)y=1;else{y=1;e:for(;;){switch(O=De(m|0,d|0,(15-y|0)*3|0)|0,St()|0,O&7){case 1:break e;case 0:break;default:{y=1;break t}}if(y>>>0<b>>>0)y=y+1|0;else{y=1;break t}}for(y=1;;)if(I=(15-y|0)*3|0,R=Ge(7,0,I|0)|0,O=d&~(St()|0),d=De(m|0,d|0,I|0)|0,St()|0,d=Ge(fc(d&7)|0,0,I|0)|0,m=m&~R|d,d=O|(St()|0),y>>>0<b>>>0)y=y+1|0;else{y=1;break}}while(!1);if(N>>>0<H>>>0)N=N+1|0;else break}return Ei(d|0),m|0}function w(m,d){m=m|0,d=d|0;var y=0,b=0,I=0,R=0,O=0;if(b=De(m|0,d|0,52)|0,St()|0,b=b&15,!b)return y=d,b=m,Ei(y|0),b|0;for(y=1;O=(15-y|0)*3|0,R=Ge(7,0,O|0)|0,I=d&~(St()|0),d=De(m|0,d|0,O|0)|0,St()|0,d=Ge(fc(d&7)|0,0,O|0)|0,m=d|m&~R,d=St()|0|I,y>>>0<b>>>0;)y=y+1|0;return Ei(d|0),m|0}function E(m,d){m=m|0,d=d|0;var y=0,b=0,I=0,R=0,O=0,N=0,H=0,Q=0,ot=0;if(H=pt,pt=pt+64|0,N=H+40|0,b=H+24|0,I=H+12|0,R=H,Ge(d|0,0,52)|0,y=St()|0|134225919,!d)return(_[m+4>>2]|0)>2||(_[m+8>>2]|0)>2||(_[m+12>>2]|0)>2?(O=0,N=0,Ei(O|0),pt=H,N|0):(Ge(og(m)|0,0,45)|0,O=St()|0|y,N=-1,Ei(O|0),pt=H,N|0);if(_[N>>2]=_[m>>2],_[N+4>>2]=_[m+4>>2],_[N+8>>2]=_[m+8>>2],_[N+12>>2]=_[m+12>>2],O=N+4|0,(d|0)>0)for(m=-1;_[b>>2]=_[O>>2],_[b+4>>2]=_[O+4>>2],_[b+8>>2]=_[O+8>>2],d&1?(Vb(O),_[I>>2]=_[O>>2],_[I+4>>2]=_[O+4>>2],_[I+8>>2]=_[O+8>>2],_d(I)):(am(O),_[I>>2]=_[O>>2],_[I+4>>2]=_[O+4>>2],_[I+8>>2]=_[O+8>>2],Bu(I)),Ou(b,I,R),Ve(R),ot=(15-d|0)*3|0,Q=Ge(7,0,ot|0)|0,y=y&~(St()|0),ot=Ge(qe(R)|0,0,ot|0)|0,m=ot|m&~Q,y=St()|0|y,(d|0)>1;)d=d+-1|0;else m=-1;t:do if((_[O>>2]|0)<=2&&(_[N+8>>2]|0)<=2&&(_[N+12>>2]|0)<=2){if(b=og(N)|0,d=Ge(b|0,0,45)|0,d=d|m,m=St()|0|y&-1040385,R=sy(N)|0,!(Tn(b)|0)){if((R|0)<=0)break;for(I=0;;){if(b=De(d|0,m|0,52)|0,St()|0,b=b&15,b)for(y=1;ot=(15-y|0)*3|0,N=De(d|0,m|0,ot|0)|0,St()|0,Q=Ge(7,0,ot|0)|0,m=m&~(St()|0),ot=Ge(eu(N&7)|0,0,ot|0)|0,d=d&~Q|ot,m=m|(St()|0),y>>>0<b>>>0;)y=y+1|0;if(I=I+1|0,(I|0)==(R|0))break t}}I=De(d|0,m|0,52)|0,St()|0,I=I&15;e:do if(I){y=1;r:for(;;){switch(ot=De(d|0,m|0,(15-y|0)*3|0)|0,St()|0,ot&7){case 1:break r;case 0:break;default:break e}if(y>>>0<I>>>0)y=y+1|0;else break e}if(Ra(b,_[N>>2]|0)|0)for(y=1;N=(15-y|0)*3|0,Q=Ge(7,0,N|0)|0,ot=m&~(St()|0),m=De(d|0,m|0,N|0)|0,St()|0,m=Ge(fc(m&7)|0,0,N|0)|0,d=d&~Q|m,m=ot|(St()|0),y>>>0<I>>>0;)y=y+1|0;else for(y=1;ot=(15-y|0)*3|0,N=De(d|0,m|0,ot|0)|0,St()|0,Q=Ge(7,0,ot|0)|0,m=m&~(St()|0),ot=Ge(eu(N&7)|0,0,ot|0)|0,d=d&~Q|ot,m=m|(St()|0),y>>>0<I>>>0;)y=y+1|0}while(!1);if((R|0)>0){y=0;do d=M(d,m)|0,m=St()|0,y=y+1|0;while((y|0)!=(R|0))}}else d=0,m=0;while(!1);return Q=m,ot=d,Ei(Q|0),pt=H,ot|0}function P(m){return m=m|0,(m|0)%2|0|0}function U(m,d,y){m=m|0,d=d|0,y=y|0;var b=0,I=0;return I=pt,pt=pt+16|0,b=I,d>>>0>15?(b=4,pt=I,b|0):(_[m+4>>2]&2146435072|0)==2146435072||(_[m+8+4>>2]&2146435072|0)==2146435072?(b=3,pt=I,b|0):(jb(m,d,b),d=E(b,d)|0,b=St()|0,_[y>>2]=d,_[y+4>>2]=b,(d|0)==0&(b|0)==0&&Ur(23313,22674,786,22697),b=0,pt=I,b|0)}function V(m,d,y){m=m|0,d=d|0,y=y|0;var b=0,I=0,R=0,O=0;if(I=y+4|0,R=De(m|0,d|0,52)|0,St()|0,R=R&15,O=De(m|0,d|0,45)|0,St()|0,b=(R|0)==0,Tn(O&127)|0){if(b)return O=1,O|0;b=1}else{if(b)return O=0,O|0;!(_[I>>2]|0)&&!(_[y+8>>2]|0)?b=(_[y+12>>2]|0)!=0&1:b=1}for(y=1;y&1?_d(I):Bu(I),O=De(m|0,d|0,(15-y|0)*3|0)|0,St()|0,hg(I,O&7),y>>>0<R>>>0;)y=y+1|0;return b|0}function $(m,d,y){m=m|0,d=d|0,y=y|0;var b=0,I=0,R=0,O=0,N=0,H=0,Q=0,ot=0;if(ot=pt,pt=pt+16|0,H=ot,Q=De(m|0,d|0,45)|0,St()|0,Q=Q&127,Q>>>0>121)return _[y>>2]=0,_[y+4>>2]=0,_[y+8>>2]=0,_[y+12>>2]=0,Q=5,pt=ot,Q|0;t:do if(Tn(Q)|0&&(R=De(m|0,d|0,52)|0,St()|0,R=R&15,(R|0)!=0)){b=1;e:for(;;){switch(N=De(m|0,d|0,(15-b|0)*3|0)|0,St()|0,N&7){case 5:break e;case 0:break;default:{b=d;break t}}if(b>>>0<R>>>0)b=b+1|0;else{b=d;break t}}for(I=1,b=d;d=(15-I|0)*3|0,O=Ge(7,0,d|0)|0,N=b&~(St()|0),b=De(m|0,b|0,d|0)|0,St()|0,b=Ge(fc(b&7)|0,0,d|0)|0,m=m&~O|b,b=N|(St()|0),I>>>0<R>>>0;)I=I+1|0}else b=d;while(!1);if(N=7696+(Q*28|0)|0,_[y>>2]=_[N>>2],_[y+4>>2]=_[N+4>>2],_[y+8>>2]=_[N+8>>2],_[y+12>>2]=_[N+12>>2],!(V(m,b,y)|0))return Q=0,pt=ot,Q|0;if(O=y+4|0,_[H>>2]=_[O>>2],_[H+4>>2]=_[O+4>>2],_[H+8>>2]=_[O+8>>2],R=De(m|0,b|0,52)|0,St()|0,N=R&15,R&1?(Bu(O),R=N+1|0):R=N,!(Tn(Q)|0))b=0;else{t:do if(!N)b=0;else for(d=1;;){if(I=De(m|0,b|0,(15-d|0)*3|0)|0,St()|0,I=I&7,I|0){b=I;break t}if(d>>>0<N>>>0)d=d+1|0;else{b=0;break}}while(!1);b=(b|0)==4&1}if(!(Nu(y,R,b,0)|0))(R|0)!=(N|0)&&(_[O>>2]=_[H>>2],_[O+4>>2]=_[H+4>>2],_[O+8>>2]=_[H+8>>2]);else{if(Tn(Q)|0)do;while(Nu(y,R,0,0)|0);(R|0)!=(N|0)&&am(O)}return Q=0,pt=ot,Q|0}function G(m,d,y){m=m|0,d=d|0,y=y|0;var b=0,I=0,R=0;return R=pt,pt=pt+16|0,b=R,I=$(m,d,b)|0,I|0?(pt=R,I|0):(I=De(m|0,d|0,52)|0,St()|0,Dr(b,I&15,y),I=0,pt=R,I|0)}function J(m,d,y){m=m|0,d=d|0,y=y|0;var b=0,I=0,R=0,O=0,N=0;if(O=pt,pt=pt+16|0,R=O,b=$(m,d,R)|0,b|0)return R=b,pt=O,R|0;b=De(m|0,d|0,45)|0,St()|0,b=(Tn(b&127)|0)==0,I=De(m|0,d|0,52)|0,St()|0,I=I&15;t:do if(!b){if(I|0)for(b=1;;){if(N=Ge(7,0,(15-b|0)*3|0)|0,!((N&m|0)==0&((St()|0)&d|0)==0))break t;if(b>>>0<I>>>0)b=b+1|0;else break}return Lh(R,I,0,5,y),N=0,pt=O,N|0}while(!1);return bd(R,I,0,6,y),N=0,pt=O,N|0}function tt(m,d,y){m=m|0,d=d|0,y=y|0;var b=0,I=0,R=0;if(I=De(m|0,d|0,45)|0,St()|0,!(Tn(I&127)|0))return I=2,_[y>>2]=I,0;if(I=De(m|0,d|0,52)|0,St()|0,I=I&15,!I)return I=5,_[y>>2]=I,0;for(b=1;;){if(R=Ge(7,0,(15-b|0)*3|0)|0,!((R&m|0)==0&((St()|0)&d|0)==0)){b=2,m=6;break}if(b>>>0<I>>>0)b=b+1|0;else{b=5,m=6;break}}return(m|0)==6&&(_[y>>2]=b),0}function lt(m,d,y){m=m|0,d=d|0,y=y|0;var b=0,I=0,R=0,O=0,N=0,H=0,Q=0,ot=0,At=0;At=pt,pt=pt+128|0,Q=At+112|0,R=At+96|0,ot=At,I=De(m|0,d|0,52)|0,St()|0,N=I&15,_[Q>>2]=N,O=De(m|0,d|0,45)|0,St()|0,O=O&127;t:do if(Tn(O)|0){if(N|0)for(b=1;;){if(H=Ge(7,0,(15-b|0)*3|0)|0,!((H&m|0)==0&((St()|0)&d|0)==0)){I=0;break t}if(b>>>0<N>>>0)b=b+1|0;else break}if(I&1)I=1;else return H=Ge(N+1|0,0,52)|0,ot=St()|0|d&-15728641,Q=Ge(7,0,(14-N|0)*3|0)|0,ot=lt((H|m)&~Q,ot&~(St()|0),y)|0,pt=At,ot|0}else I=0;while(!1);if(b=$(m,d,R)|0,!b){I?(hm(R,Q,ot),H=5):(Da(R,Q,ot),H=6);t:do if(Tn(O)|0)if(!N)m=5;else for(b=1;;){if(O=Ge(7,0,(15-b|0)*3|0)|0,!((O&m|0)==0&((St()|0)&d|0)==0)){m=2;break t}if(b>>>0<N>>>0)b=b+1|0;else{m=5;break}}else m=2;while(!1);Yf(y|0,-1,m<<2|0)|0;t:do if(I)for(R=0;;){if(O=ot+(R<<4)|0,Ds(O,_[Q>>2]|0)|0,O=_[O>>2]|0,N=_[y>>2]|0,(N|0)==-1|(N|0)==(O|0))b=y;else{I=0;do{if(I=I+1|0,I>>>0>=m>>>0){b=1;break t}b=y+(I<<2)|0,N=_[b>>2]|0}while(!((N|0)==-1|(N|0)==(O|0)))}if(_[b>>2]=O,R=R+1|0,R>>>0>=H>>>0){b=0;break}}else for(R=0;;){if(O=ot+(R<<4)|0,Nu(O,_[Q>>2]|0,0,1)|0,O=_[O>>2]|0,N=_[y>>2]|0,(N|0)==-1|(N|0)==(O|0))b=y;else{I=0;do{if(I=I+1|0,I>>>0>=m>>>0){b=1;break t}b=y+(I<<2)|0,N=_[b>>2]|0}while(!((N|0)==-1|(N|0)==(O|0)))}if(_[b>>2]=O,R=R+1|0,R>>>0>=H>>>0){b=0;break}}while(!1)}return ot=b,pt=At,ot|0}function wt(){return 12}function bt(m,d){m=m|0,d=d|0;var y=0,b=0,I=0,R=0,O=0,N=0,H=0;if(m>>>0>15)return N=4,N|0;if(Ge(m|0,0,52)|0,N=St()|0|134225919,!m){y=0,b=0;do Tn(b)|0&&(Ge(b|0,0,45)|0,O=N|(St()|0),m=d+(y<<3)|0,_[m>>2]=-1,_[m+4>>2]=O,y=y+1|0),b=b+1|0;while((b|0)!=122);return y=0,y|0}y=0,O=0;do{if(Tn(O)|0){for(Ge(O|0,0,45)|0,b=1,I=-1,R=N|(St()|0);H=Ge(7,0,(15-b|0)*3|0)|0,I=I&~H,R=R&~(St()|0),(b|0)!=(m|0);)b=b+1|0;H=d+(y<<3)|0,_[H>>2]=I,_[H+4>>2]=R,y=y+1|0}O=O+1|0}while((O|0)!=122);return y=0,y|0}function Rt(m,d,y,b){m=m|0,d=d|0,y=y|0,b=b|0;var I=0,R=0,O=0,N=0,H=0,Q=0,ot=0,At=0,jt=0,Xt=0,zt=0,ie=0,ge=0,me=0,ue=0;if(ue=pt,pt=pt+16|0,ge=ue,me=De(m|0,d|0,52)|0,St()|0,me=me&15,y>>>0>15)return me=4,pt=ue,me|0;if((me|0)<(y|0))return me=12,pt=ue,me|0;if((me|0)!=(y|0))if(R=Ge(y|0,0,52)|0,R=R|m,N=St()|0|d&-15728641,(me|0)>(y|0)){H=y;do ie=Ge(7,0,(14-H|0)*3|0)|0,H=H+1|0,R=ie|R,N=St()|0|N;while((H|0)<(me|0));ie=R}else ie=R;else ie=m,N=d;zt=De(ie|0,N|0,45)|0,St()|0;t:do if(Tn(zt&127)|0){if(H=De(ie|0,N|0,52)|0,St()|0,H=H&15,H|0)for(R=1;;){if(zt=Ge(7,0,(15-R|0)*3|0)|0,!((zt&ie|0)==0&((St()|0)&N|0)==0)){Q=33;break t}if(R>>>0<H>>>0)R=R+1|0;else break}if(zt=b,_[zt>>2]=0,_[zt+4>>2]=0,(me|0)>(y|0)){for(zt=d&-15728641,Xt=me;;){if(jt=Xt,Xt=Xt+-1|0,Xt>>>0>15|(me|0)<(Xt|0)){Q=19;break}if((me|0)!=(Xt|0))if(R=Ge(Xt|0,0,52)|0,R=R|m,H=St()|0|zt,(me|0)<(jt|0))At=R;else{Q=Xt;do At=Ge(7,0,(14-Q|0)*3|0)|0,Q=Q+1|0,R=At|R,H=St()|0|H;while((Q|0)<(me|0));At=R}else At=m,H=d;if(ot=De(At|0,H|0,45)|0,St()|0,!(Tn(ot&127)|0))R=0;else{ot=De(At|0,H|0,52)|0,St()|0,ot=ot&15;e:do if(!ot)R=0;else for(Q=1;;){if(R=De(At|0,H|0,(15-Q|0)*3|0)|0,St()|0,R=R&7,R|0)break e;if(Q>>>0<ot>>>0)Q=Q+1|0;else{R=0;break}}while(!1);R=(R|0)==0&1}if(H=De(m|0,d|0,(15-jt|0)*3|0)|0,St()|0,H=H&7,(H|0)==7){I=5,Q=42;break}if(R=(R|0)!=0,(H|0)==1&R){I=5,Q=42;break}if(At=H+(((H|0)!=0&R)<<31>>31)|0,At|0&&(Q=me-jt|0,Q=Es(7,0,Q,((Q|0)<0)<<31>>31)|0,ot=St()|0,R?(R=Jo(Q|0,ot|0,5,0)|0,R=Ii(R|0,St()|0,-5,-1)|0,R=Uu(R|0,St()|0,6,0)|0,R=Ii(R|0,St()|0,1,0)|0,H=St()|0):(R=Q,H=ot),jt=At+-1|0,jt=Jo(Q|0,ot|0,jt|0,((jt|0)<0)<<31>>31|0)|0,jt=Ii(R|0,H|0,jt|0,St()|0)|0,At=St()|0,ot=b,ot=Ii(jt|0,At|0,_[ot>>2]|0,_[ot+4>>2]|0)|0,At=St()|0,jt=b,_[jt>>2]=ot,_[jt+4>>2]=At),(Xt|0)<=(y|0)){Q=37;break}}if((Q|0)==19)Ur(23313,22674,1099,22710);else if((Q|0)==37){O=b,I=_[O+4>>2]|0,O=_[O>>2]|0;break}else if((Q|0)==42)return pt=ue,I|0}else I=0,O=0}else Q=33;while(!1);t:do if((Q|0)==33)if(zt=b,_[zt>>2]=0,_[zt+4>>2]=0,(me|0)>(y|0)){for(R=me;;){if(I=De(m|0,d|0,(15-R|0)*3|0)|0,St()|0,I=I&7,(I|0)==7){I=5;break}if(O=me-R|0,O=Es(7,0,O,((O|0)<0)<<31>>31)|0,I=Jo(O|0,St()|0,I|0,0)|0,O=St()|0,zt=b,O=Ii(_[zt>>2]|0,_[zt+4>>2]|0,I|0,O|0)|0,I=St()|0,zt=b,_[zt>>2]=O,_[zt+4>>2]=I,R=R+-1|0,(R|0)<=(y|0))break t}return pt=ue,I|0}else I=0,O=0;while(!1);return ru(ie,N,me,ge)|0&&Ur(23313,22674,1063,22725),me=ge,ge=_[me+4>>2]|0,((I|0)>-1|(I|0)==-1&O>>>0>4294967295)&((ge|0)>(I|0)|((ge|0)==(I|0)?(_[me>>2]|0)>>>0>O>>>0:0))?(me=0,pt=ue,me|0):(Ur(23313,22674,1139,22710),0)}function yt(m,d,y,b,I,R){m=m|0,d=d|0,y=y|0,b=b|0,I=I|0,R=R|0;var O=0,N=0,H=0,Q=0,ot=0,At=0,jt=0,Xt=0,zt=0,ie=0;if(At=pt,pt=pt+16|0,O=At,I>>>0>15)return R=4,pt=At,R|0;if(N=De(y|0,b|0,52)|0,St()|0,N=N&15,(N|0)>(I|0))return R=12,pt=At,R|0;if(ru(y,b,I,O)|0&&Ur(23313,22674,1063,22725),ot=O,Q=_[ot+4>>2]|0,!(((d|0)>-1|(d|0)==-1&m>>>0>4294967295)&((Q|0)>(d|0)|((Q|0)==(d|0)?(_[ot>>2]|0)>>>0>m>>>0:0))))return R=2,pt=At,R|0;ot=I-N|0,I=Ge(I|0,0,52)|0,H=St()|0|b&-15728641,Q=R,_[Q>>2]=I|y,_[Q+4>>2]=H,Q=De(y|0,b|0,45)|0,St()|0;t:do if(Tn(Q&127)|0){if(N|0)for(O=1;;){if(Q=Ge(7,0,(15-O|0)*3|0)|0,!((Q&y|0)==0&((St()|0)&b|0)==0))break t;if(O>>>0<N>>>0)O=O+1|0;else break}if((ot|0)<1)return R=0,pt=At,R|0;for(Q=N^15,b=-1,H=1,O=1;;){N=ot-H|0,N=Es(7,0,N,((N|0)<0)<<31>>31)|0,y=St()|0;do if(O)if(O=Jo(N|0,y|0,5,0)|0,O=Ii(O|0,St()|0,-5,-1)|0,O=Uu(O|0,St()|0,6,0)|0,I=St()|0,(d|0)>(I|0)|(d|0)==(I|0)&m>>>0>O>>>0){d=Ii(m|0,d|0,-1,-1)|0,d=ma(d|0,St()|0,O|0,I|0)|0,O=St()|0,jt=R,zt=_[jt>>2]|0,jt=_[jt+4>>2]|0,ie=(Q+b|0)*3|0,Xt=Ge(7,0,ie|0)|0,jt=jt&~(St()|0),b=Uu(d|0,O|0,N|0,y|0)|0,m=St()|0,I=Ii(b|0,m|0,2,0)|0,ie=Ge(I|0,St()|0,ie|0)|0,jt=St()|0|jt,I=R,_[I>>2]=ie|zt&~Xt,_[I+4>>2]=jt,m=Jo(b|0,m|0,N|0,y|0)|0,m=ma(d|0,O|0,m|0,St()|0)|0,O=0,d=St()|0;break}else{ie=R,Xt=_[ie>>2]|0,ie=_[ie+4>>2]|0,zt=Ge(7,0,(Q+b|0)*3|0)|0,ie=ie&~(St()|0),O=R,_[O>>2]=Xt&~zt,_[O+4>>2]=ie,O=1;break}else Xt=R,I=_[Xt>>2]|0,Xt=_[Xt+4>>2]|0,b=(Q+b|0)*3|0,jt=Ge(7,0,b|0)|0,Xt=Xt&~(St()|0),ie=Uu(m|0,d|0,N|0,y|0)|0,O=St()|0,b=Ge(ie|0,O|0,b|0)|0,Xt=St()|0|Xt,zt=R,_[zt>>2]=b|I&~jt,_[zt+4>>2]=Xt,O=Jo(ie|0,O|0,N|0,y|0)|0,m=ma(m|0,d|0,O|0,St()|0)|0,O=0,d=St()|0;while(!1);if((ot|0)>(H|0))b=~H,H=H+1|0;else{d=0;break}}return pt=At,d|0}while(!1);if((ot|0)<1)return ie=0,pt=At,ie|0;for(I=N^15,O=1;;)if(zt=ot-O|0,zt=Es(7,0,zt,((zt|0)<0)<<31>>31)|0,ie=St()|0,H=R,y=_[H>>2]|0,H=_[H+4>>2]|0,N=(I-O|0)*3|0,b=Ge(7,0,N|0)|0,H=H&~(St()|0),jt=Uu(m|0,d|0,zt|0,ie|0)|0,Xt=St()|0,N=Ge(jt|0,Xt|0,N|0)|0,H=St()|0|H,Q=R,_[Q>>2]=N|y&~b,_[Q+4>>2]=H,ie=Jo(jt|0,Xt|0,zt|0,ie|0)|0,m=ma(m|0,d|0,ie|0,St()|0)|0,d=St()|0,(ot|0)<=(O|0)){d=0;break}else O=O+1|0;return pt=At,d|0}function Zt(m,d,y,b){m=m|0,d=d|0,y=y|0,b=b|0;var I=0,R=0;I=De(d|0,y|0,52)|0,St()|0,I=I&15,(d|0)==0&(y|0)==0|((b|0)>15|(I|0)>(b|0))?(b=-1,I=-1,d=0,y=0):(R=Fh(d,y,I+1|0,b)|0,y=(St()|0)&-15728641,d=Ge(b|0,0,52)|0,d=R|d,y=y|(St()|0),R=(Sn(d,y)|0)==0,b=R?-1:b),R=m,_[R>>2]=d,_[R+4>>2]=y,_[m+8>>2]=I,_[m+12>>2]=b}function se(m){m=m|0;var d=0,y=0,b=0,I=0,R=0,O=0,N=0,H=0,Q=0;if(y=m,d=_[y>>2]|0,y=_[y+4>>2]|0,!((d|0)==0&(y|0)==0)&&(b=De(d|0,y|0,52)|0,St()|0,b=b&15,N=Ge(1,0,(b^15)*3|0)|0,d=Ii(N|0,St()|0,d|0,y|0)|0,y=St()|0,N=m,_[N>>2]=d,_[N+4>>2]=y,N=m+8|0,O=_[N>>2]|0,!((b|0)<(O|0)))){for(H=m+12|0,R=b;;){if((R|0)==(O|0)){b=5;break}if(Q=(R|0)==(_[H>>2]|0),I=(15-R|0)*3|0,b=De(d|0,y|0,I|0)|0,St()|0,b=b&7,Q&((b|0)==1&!0)){b=7;break}if(!((b|0)==7&!0)){b=10;break}if(Q=Ge(1,0,I|0)|0,d=Ii(d|0,y|0,Q|0,St()|0)|0,y=St()|0,Q=m,_[Q>>2]=d,_[Q+4>>2]=y,(R|0)>(O|0))R=R+-1|0;else{b=10;break}}if((b|0)==5){Q=m,_[Q>>2]=0,_[Q+4>>2]=0,_[N>>2]=-1,_[H>>2]=-1;return}else if((b|0)==7){O=Ge(1,0,I|0)|0,O=Ii(d|0,y|0,O|0,St()|0)|0,N=St()|0,Q=m,_[Q>>2]=O,_[Q+4>>2]=N,_[H>>2]=R+-1;return}else if((b|0)==10)return}}function Bt(m){m=+m;var d=0;return d=m<0?m+6.283185307179586:m,+(m>=6.283185307179586?d+-6.283185307179586:d)}function Gt(m,d){return m=m|0,d=d|0,+Fr(+(+ft[m>>3]-+ft[d>>3]))<17453292519943298e-27?(d=+Fr(+(+ft[m+8>>3]-+ft[d+8>>3]))<17453292519943298e-27,d|0):(d=0,d|0)}function he(m,d){m=m|0,d=d|0;var y=0,b=0,I=0,R=0;return I=+ft[d>>3],b=+ft[m>>3],R=+un(+((I-b)*.5)),y=+un(+((+ft[d+8>>3]-+ft[m+8>>3])*.5)),y=R*R+y*(+cn(+I)*+cn(+b)*y),+(+ua(+ +Jr(+y),+ +Jr(+(1-y)))*2)}function ce(m,d){m=m|0,d=d|0;var y=0,b=0,I=0,R=0;return I=+ft[d>>3],b=+ft[m>>3],R=+un(+((I-b)*.5)),y=+un(+((+ft[d+8>>3]-+ft[m+8>>3])*.5)),y=R*R+y*(+cn(+I)*+cn(+b)*y),+(+ua(+ +Jr(+y),+ +Jr(+(1-y)))*2*6371.007180918475)}function xe(m,d){m=m|0,d=d|0;var y=0,b=0,I=0,R=0;return I=+ft[d>>3],b=+ft[m>>3],R=+un(+((I-b)*.5)),y=+un(+((+ft[d+8>>3]-+ft[m+8>>3])*.5)),y=R*R+y*(+cn(+I)*+cn(+b)*y),+(+ua(+ +Jr(+y),+ +Jr(+(1-y)))*2*6371.007180918475*1e3)}function Pe(m,d){m=m|0,d=d|0;var y=0,b=0,I=0,R=0,O=0;return R=+ft[d>>3],b=+cn(+R),I=+ft[d+8>>3]-+ft[m+8>>3],O=b*+un(+I),y=+ft[m>>3],+ +ua(+O,+(+un(+R)*+cn(+y)-+cn(+I)*(b*+un(+y))))}function Te(m,d,y,b){m=m|0,d=+d,y=+y,b=b|0;var I=0,R=0,O=0,N=0;if(y<1e-16){_[b>>2]=_[m>>2],_[b+4>>2]=_[m+4>>2],_[b+8>>2]=_[m+8>>2],_[b+12>>2]=_[m+12>>2];return}R=d<0?d+6.283185307179586:d,R=d>=6.283185307179586?R+-6.283185307179586:R;do if(R<1e-16)d=+ft[m>>3]+y,ft[b>>3]=d,I=b;else{if(I=+Fr(+(R+-3.141592653589793))<1e-16,d=+ft[m>>3],I){d=d-y,ft[b>>3]=d,I=b;break}if(O=+cn(+y),y=+un(+y),d=O*+un(+d)+ +cn(+R)*(y*+cn(+d)),d=d>1?1:d,d=+ng(+(d<-1?-1:d)),ft[b>>3]=d,+Fr(+(d+-1.5707963267948966))<1e-16){ft[b>>3]=1.5707963267948966,ft[b+8>>3]=0;return}if(+Fr(+(d+1.5707963267948966))<1e-16){ft[b>>3]=-1.5707963267948966,ft[b+8>>3]=0;return}if(N=+cn(+d),R=y*+un(+R)/N,y=+ft[m>>3],d=(O-+un(+d)*+un(+y))/+cn(+y)/N,O=R>1?1:R,d=d>1?1:d,d=+ft[m+8>>3]+ +ua(+(O<-1?-1:O),+(d<-1?-1:d)),d>3.141592653589793)do d=d+-6.283185307179586;while(d>3.141592653589793);if(d<-3.141592653589793)do d=d+6.283185307179586;while(d<-3.141592653589793);ft[b+8>>3]=d;return}while(!1);if(+Fr(+(d+-1.5707963267948966))<1e-16){ft[I>>3]=1.5707963267948966,ft[b+8>>3]=0;return}if(+Fr(+(d+1.5707963267948966))<1e-16){ft[I>>3]=-1.5707963267948966,ft[b+8>>3]=0;return}if(d=+ft[m+8>>3],d>3.141592653589793)do d=d+-6.283185307179586;while(d>3.141592653589793);if(d<-3.141592653589793)do d=d+6.283185307179586;while(d<-3.141592653589793);ft[b+8>>3]=d}function Le(m,d){return m=m|0,d=d|0,m>>>0>15?(d=4,d|0):(ft[d>>3]=+ft[20528+(m<<3)>>3],d=0,d|0)}function hr(m,d){return m=m|0,d=d|0,m>>>0>15?(d=4,d|0):(ft[d>>3]=+ft[20656+(m<<3)>>3],d=0,d|0)}function Di(m,d){return m=m|0,d=d|0,m>>>0>15?(d=4,d|0):(ft[d>>3]=+ft[20784+(m<<3)>>3],d=0,d|0)}function He(m,d){return m=m|0,d=d|0,m>>>0>15?(d=4,d|0):(ft[d>>3]=+ft[20912+(m<<3)>>3],d=0,d|0)}function Cr(m,d){m=m|0,d=d|0;var y=0;return m>>>0>15?(d=4,d|0):(y=Es(7,0,m,((m|0)<0)<<31>>31)|0,y=Jo(y|0,St()|0,120,0)|0,m=St()|0,_[d>>2]=y|2,_[d+4>>2]=m,d=0,d|0)}function fr(m,d,y){m=m|0,d=d|0,y=y|0;var b=0,I=0,R=0,O=0,N=0,H=0,Q=0,ot=0,At=0,jt=0;return jt=+ft[d>>3],ot=+ft[m>>3],H=+un(+((jt-ot)*.5)),R=+ft[d+8>>3],Q=+ft[m+8>>3],O=+un(+((R-Q)*.5)),N=+cn(+ot),At=+cn(+jt),O=H*H+O*(At*N*O),O=+ua(+ +Jr(+O),+ +Jr(+(1-O)))*2,H=+ft[y>>3],jt=+un(+((H-jt)*.5)),b=+ft[y+8>>3],R=+un(+((b-R)*.5)),I=+cn(+H),R=jt*jt+R*(At*I*R),R=+ua(+ +Jr(+R),+ +Jr(+(1-R)))*2,H=+un(+((ot-H)*.5)),b=+un(+((Q-b)*.5)),b=H*H+b*(N*I*b),b=+ua(+ +Jr(+b),+ +Jr(+(1-b)))*2,I=(O+R+b)*.5,+(+Bf(+ +Jr(+(+ku(+(I*.5))*+ku(+((I-O)*.5))*+ku(+((I-R)*.5))*+ku(+((I-b)*.5)))))*4)}function dn(m,d,y){m=m|0,d=d|0,y=y|0;var b=0,I=0,R=0,O=0,N=0;if(N=pt,pt=pt+192|0,R=N+168|0,O=N,I=G(m,d,R)|0,I|0)return y=I,pt=N,y|0;if(J(m,d,O)|0&&Ur(23313,22742,386,22751),d=_[O>>2]|0,(d|0)>0){if(b=+fr(O+8|0,O+8+(((d|0)!=1&1)<<4)|0,R)+0,(d|0)!=1){m=1;do I=m,m=m+1|0,b=b+ +fr(O+8+(I<<4)|0,O+8+(((m|0)%(d|0)|0)<<4)|0,R);while((m|0)<(d|0))}}else b=0;return ft[y>>3]=b,y=0,pt=N,y|0}function Ci(m,d,y){return m=m|0,d=d|0,y=y|0,m=dn(m,d,y)|0,m|0||(ft[y>>3]=+ft[y>>3]*6371.007180918475*6371.007180918475),m|0}function fi(m,d,y){return m=m|0,d=d|0,y=y|0,m=dn(m,d,y)|0,m|0||(ft[y>>3]=+ft[y>>3]*6371.007180918475*6371.007180918475*1e3*1e3),m|0}function Oi(m,d,y){m=m|0,d=d|0,y=y|0;var b=0,I=0,R=0,O=0,N=0,H=0,Q=0,ot=0;if(N=pt,pt=pt+176|0,O=N,m=xd(m,d,O)|0,m|0)return O=m,pt=N,O|0;if(ft[y>>3]=0,m=_[O>>2]|0,(m|0)<=1)return O=0,pt=N,O|0;d=m+-1|0,m=0,b=+ft[O+8>>3],I=+ft[O+16>>3],R=0;do m=m+1|0,Q=b,b=+ft[O+8+(m<<4)>>3],ot=+un(+((b-Q)*.5)),H=I,I=+ft[O+8+(m<<4)+8>>3],H=+un(+((I-H)*.5)),H=ot*ot+H*(+cn(+b)*+cn(+Q)*H),R=R+ +ua(+ +Jr(+H),+ +Jr(+(1-H)))*2;while((m|0)<(d|0));return ft[y>>3]=R,O=0,pt=N,O|0}function Ts(m,d,y){m=m|0,d=d|0,y=y|0;var b=0,I=0,R=0,O=0,N=0,H=0,Q=0,ot=0;if(N=pt,pt=pt+176|0,O=N,m=xd(m,d,O)|0,m|0)return O=m,R=+ft[y>>3],R=R*6371.007180918475,ft[y>>3]=R,pt=N,O|0;if(ft[y>>3]=0,m=_[O>>2]|0,(m|0)<=1)return O=0,R=0,R=R*6371.007180918475,ft[y>>3]=R,pt=N,O|0;d=m+-1|0,m=0,b=+ft[O+8>>3],I=+ft[O+16>>3],R=0;do m=m+1|0,Q=b,b=+ft[O+8+(m<<4)>>3],ot=+un(+((b-Q)*.5)),H=I,I=+ft[O+8+(m<<4)+8>>3],H=+un(+((I-H)*.5)),H=ot*ot+H*(+cn(+Q)*+cn(+b)*H),R=R+ +ua(+ +Jr(+H),+ +Jr(+(1-H)))*2;while((m|0)!=(d|0));return ft[y>>3]=R,O=0,ot=R,ot=ot*6371.007180918475,ft[y>>3]=ot,pt=N,O|0}function Un(m,d,y){m=m|0,d=d|0,y=y|0;var b=0,I=0,R=0,O=0,N=0,H=0,Q=0,ot=0;if(N=pt,pt=pt+176|0,O=N,m=xd(m,d,O)|0,m|0)return O=m,R=+ft[y>>3],R=R*6371.007180918475,R=R*1e3,ft[y>>3]=R,pt=N,O|0;if(ft[y>>3]=0,m=_[O>>2]|0,(m|0)<=1)return O=0,R=0,R=R*6371.007180918475,R=R*1e3,ft[y>>3]=R,pt=N,O|0;d=m+-1|0,m=0,b=+ft[O+8>>3],I=+ft[O+16>>3],R=0;do m=m+1|0,Q=b,b=+ft[O+8+(m<<4)>>3],ot=+un(+((b-Q)*.5)),H=I,I=+ft[O+8+(m<<4)+8>>3],H=+un(+((I-H)*.5)),H=ot*ot+H*(+cn(+Q)*+cn(+b)*H),R=R+ +ua(+ +Jr(+H),+ +Jr(+(1-H)))*2;while((m|0)!=(d|0));return ft[y>>3]=R,O=0,ot=R,ot=ot*6371.007180918475,ot=ot*1e3,ft[y>>3]=ot,pt=N,O|0}function vo(m){m=m|0;var d=0,y=0,b=0;return d=nu(1,12)|0,d||Ur(22832,22787,49,22845),y=m+4|0,b=_[y>>2]|0,b|0?(b=b+8|0,_[b>>2]=d,_[y>>2]=d,d|0):(_[m>>2]|0&&Ur(22862,22787,61,22885),b=m,_[b>>2]=d,_[y>>2]=d,d|0)}function Gs(m,d){m=m|0,d=d|0;var y=0,b=0;return b=mc(24)|0,b||Ur(22899,22787,78,22913),_[b>>2]=_[d>>2],_[b+4>>2]=_[d+4>>2],_[b+8>>2]=_[d+8>>2],_[b+12>>2]=_[d+12>>2],_[b+16>>2]=0,d=m+4|0,y=_[d>>2]|0,y|0?(_[y+16>>2]=b,_[d>>2]=b,b|0):(_[m>>2]|0&&Ur(22928,22787,82,22913),_[m>>2]=b,_[d>>2]=b,b|0)}function Ss(m){m=m|0;var d=0,y=0,b=0,I=0;if(m)for(b=1;;){if(d=_[m>>2]|0,d|0)do{if(y=_[d>>2]|0,y|0)do I=y,y=_[y+16>>2]|0,oi(I);while(y|0);I=d,d=_[d+8>>2]|0,oi(I)}while(d|0);if(d=m,m=_[m+8>>2]|0,b||oi(d),m)b=0;else break}}function Oa(m){m=m|0;var d=0,y=0,b=0,I=0,R=0,O=0,N=0,H=0,Q=0,ot=0,At=0,jt=0,Xt=0,zt=0,ie=0,ge=0,me=0,ue=0,fe=0,ne=0,tr=0,pr=0,Xe=0,er=0,xn=0,hn=0,Zi=0,Pi=0,Ar=0,gi=0,kn=0,ti=0;if(I=m+8|0,_[I>>2]|0)return ti=1,ti|0;if(b=_[m>>2]|0,!b)return ti=0,ti|0;d=b,y=0;do y=y+1|0,d=_[d+8>>2]|0;while(d|0);if(y>>>0<2)return ti=0,ti|0;gi=mc(y<<2)|0,gi||Ur(22948,22787,317,22967),Ar=mc(y<<5)|0,Ar||Ur(22989,22787,321,22967),_[m>>2]=0,pr=m+4|0,_[pr>>2]=0,_[I>>2]=0,y=0,Pi=0,tr=0,At=0;t:for(;;){if(ot=_[b>>2]|0,ot){R=0,O=ot;do{if(H=+ft[O+8>>3],d=O,O=_[O+16>>2]|0,Q=(O|0)==0,I=Q?ot:O,N=+ft[I+8>>3],+Fr(+(H-N))>3.141592653589793){ti=14;break}R=R+(N-H)*(+ft[d>>3]+ +ft[I>>3])}while(!Q);if((ti|0)==14){ti=0,R=0,d=ot;do ne=+ft[d+8>>3],Zi=d+16|0,hn=_[Zi>>2]|0,hn=hn|0?hn:ot,fe=+ft[hn+8>>3],R=R+(+ft[d>>3]+ +ft[hn>>3])*((fe<0?fe+6.283185307179586:fe)-(ne<0?ne+6.283185307179586:ne)),d=_[(d|0?Zi:b)>>2]|0;while(d|0)}R>0?(_[gi+(Pi<<2)>>2]=b,Pi=Pi+1|0,I=tr,d=At):ti=19}else ti=19;if((ti|0)==19){ti=0;do if(y){if(d=y+8|0,_[d>>2]|0){ti=21;break t}if(y=nu(1,12)|0,!y){ti=23;break t}_[d>>2]=y,I=y+4|0,O=y,d=At}else if(At){I=pr,O=At+8|0,d=b,y=m;break}else if(_[m>>2]|0){ti=27;break t}else{I=pr,O=m,d=b,y=m;break}while(!1);if(_[O>>2]=b,_[I>>2]=b,O=Ar+(tr<<5)|0,Q=_[b>>2]|0,Q){for(ot=Ar+(tr<<5)+8|0,ft[ot>>3]=17976931348623157e292,At=Ar+(tr<<5)+24|0,ft[At>>3]=17976931348623157e292,ft[O>>3]=-17976931348623157e292,jt=Ar+(tr<<5)+16|0,ft[jt>>3]=-17976931348623157e292,me=17976931348623157e292,ue=-17976931348623157e292,I=0,Xt=Q,H=17976931348623157e292,ie=17976931348623157e292,ge=-17976931348623157e292,N=-17976931348623157e292;R=+ft[Xt>>3],ne=+ft[Xt+8>>3],Xt=_[Xt+16>>2]|0,zt=(Xt|0)==0,fe=+ft[(zt?Q:Xt)+8>>3],R<H&&(ft[ot>>3]=R,H=R),ne<ie&&(ft[At>>3]=ne,ie=ne),R>ge?ft[O>>3]=R:R=ge,ne>N&&(ft[jt>>3]=ne,N=ne),me=ne>0&ne<me?ne:me,ue=ne<0&ne>ue?ne:ue,I=I|+Fr(+(ne-fe))>3.141592653589793,!zt;)ge=R;I&&(ft[jt>>3]=ue,ft[At>>3]=me)}else _[O>>2]=0,_[O+4>>2]=0,_[O+8>>2]=0,_[O+12>>2]=0,_[O+16>>2]=0,_[O+20>>2]=0,_[O+24>>2]=0,_[O+28>>2]=0;I=tr+1|0}if(Zi=b+8|0,b=_[Zi>>2]|0,_[Zi>>2]=0,b)tr=I,At=d;else{ti=45;break}}if((ti|0)==21)Ur(22765,22787,35,22799);else if((ti|0)==23)Ur(22819,22787,37,22799);else if((ti|0)==27)Ur(22862,22787,61,22885);else if((ti|0)==45){t:do if((Pi|0)>0){for(Zi=(I|0)==0,xn=I<<2,hn=(m|0)==0,er=0,d=0;;){if(Xe=_[gi+(er<<2)>>2]|0,Zi)ti=73;else{if(tr=mc(xn)|0,!tr){ti=50;break}if(pr=mc(xn)|0,!pr){ti=52;break}e:do if(hn)y=0;else{for(I=0,y=0,O=m;b=Ar+(I<<5)|0,Vn(_[O>>2]|0,b,_[Xe>>2]|0)|0?(_[tr+(y<<2)>>2]=O,_[pr+(y<<2)>>2]=b,zt=y+1|0):zt=y,O=_[O+8>>2]|0,O;)I=I+1|0,y=zt;if((zt|0)>0)if(b=_[tr>>2]|0,(zt|0)==1)y=b;else for(jt=0,Xt=-1,y=b,At=b;;){for(Q=_[At>>2]|0,b=0,O=0;I=_[_[tr+(O<<2)>>2]>>2]|0,(I|0)==(Q|0)?ot=b:ot=b+((Vn(I,_[pr+(O<<2)>>2]|0,_[Q>>2]|0)|0)&1)|0,O=O+1|0,(O|0)!=(zt|0);)b=ot;if(I=(ot|0)>(Xt|0),y=I?At:y,b=jt+1|0,(b|0)==(zt|0))break e;jt=b,Xt=I?ot:Xt,At=_[tr+(b<<2)>>2]|0}else y=0}while(!1);if(oi(tr),oi(pr),y){if(I=y+4|0,b=_[I>>2]|0,b)y=b+8|0;else if(_[y>>2]|0){ti=70;break}_[y>>2]=Xe,_[I>>2]=Xe}else ti=73}if((ti|0)==73){if(ti=0,d=_[Xe>>2]|0,d|0)do pr=d,d=_[d+16>>2]|0,oi(pr);while(d|0);oi(Xe),d=1}if(er=er+1|0,(er|0)>=(Pi|0)){kn=d;break t}}(ti|0)==50?Ur(23004,22787,249,23023):(ti|0)==52?Ur(23042,22787,252,23023):(ti|0)==70&&Ur(22862,22787,61,22885)}else kn=0;while(!1);return oi(gi),oi(Ar),ti=kn,ti|0}return 0}function Vn(m,d,y){m=m|0,d=d|0,y=y|0;var b=0,I=0,R=0,O=0,N=0,H=0,Q=0,ot=0;if(!(sm(d,y)|0)||(d=ay(d)|0,b=+ft[y>>3],I=+ft[y+8>>3],I=d&I<0?I+6.283185307179586:I,m=_[m>>2]|0,!m))return m=0,m|0;if(d){d=0,Q=I,y=m;t:for(;;){for(;O=+ft[y>>3],I=+ft[y+8>>3],y=y+16|0,ot=_[y>>2]|0,ot=ot|0?ot:m,R=+ft[ot>>3],N=+ft[ot+8>>3],O>R?(H=O,O=N):(H=R,R=O,O=I,I=N),b=b==R|b==H?b+2220446049250313e-31:b,!!(b<R|b>H);)if(y=_[y>>2]|0,!y){y=22;break t}if(N=O<0?O+6.283185307179586:O,O=I<0?I+6.283185307179586:I,Q=N==Q|O==Q?Q+-2220446049250313e-31:Q,H=N+(O-N)*((b-R)/(H-R)),(H<0?H+6.283185307179586:H)>Q&&(d=d^1),y=_[y>>2]|0,!y){y=22;break}}if((y|0)==22)return d|0}else{d=0,Q=I,y=m;t:for(;;){for(;O=+ft[y>>3],I=+ft[y+8>>3],y=y+16|0,ot=_[y>>2]|0,ot=ot|0?ot:m,R=+ft[ot>>3],N=+ft[ot+8>>3],O>R?(H=O,O=N):(H=R,R=O,O=I,I=N),b=b==R|b==H?b+2220446049250313e-31:b,!!(b<R|b>H);)if(y=_[y>>2]|0,!y){y=22;break t}if(Q=O==Q|I==Q?Q+-2220446049250313e-31:Q,O+(I-O)*((b-R)/(H-R))>Q&&(d=d^1),y=_[y>>2]|0,!y){y=22;break}}if((y|0)==22)return d|0}return 0}function co(m,d,y,b,I){m=m|0,d=d|0,y=y|0,b=b|0,I=I|0;var R=0,O=0,N=0,H=0,Q=0,ot=0,At=0,jt=0,Xt=0,zt=0,ie=0,ge=0,me=0,ue=0;if(ue=pt,pt=pt+32|0,me=ue+16|0,ge=ue,R=De(m|0,d|0,52)|0,St()|0,R=R&15,Xt=De(y|0,b|0,52)|0,St()|0,(R|0)!=(Xt&15|0))return me=12,pt=ue,me|0;if(Q=De(m|0,d|0,45)|0,St()|0,Q=Q&127,ot=De(y|0,b|0,45)|0,St()|0,ot=ot&127,Q>>>0>121|ot>>>0>121)return me=5,pt=ue,me|0;if(Xt=(Q|0)!=(ot|0),Xt){if(N=Ff(Q,ot)|0,(N|0)==7)return me=1,pt=ue,me|0;H=Ff(ot,Q)|0,(H|0)==7?Ur(23066,23090,161,23100):(zt=N,O=H)}else zt=0,O=0;At=Tn(Q)|0,jt=Tn(ot)|0,_[me>>2]=0,_[me+4>>2]=0,_[me+8>>2]=0,_[me+12>>2]=0;do if(zt){if(ot=_[4272+(Q*28|0)+(zt<<2)>>2]|0,N=(ot|0)>0,jt)if(N){Q=0,H=y,N=b;do H=A(H,N)|0,N=St()|0,O=fc(O)|0,(O|0)==1&&(O=fc(1)|0),Q=Q+1|0;while((Q|0)!=(ot|0));ot=O,Q=H,H=N}else ot=O,Q=y,H=b;else if(N){Q=0,H=y,N=b;do H=w(H,N)|0,N=St()|0,O=fc(O)|0,Q=Q+1|0;while((Q|0)!=(ot|0));ot=O,Q=H,H=N}else ot=O,Q=y,H=b;if(V(Q,H,me)|0,Xt||Ur(23115,23090,191,23100),N=(At|0)!=0,O=(jt|0)!=0,N&O&&Ur(23142,23090,192,23100),N){if(O=si(m,d)|0,(O|0)==7){R=5;break}if(kr[21872+(O*7|0)+zt>>0]|0){R=1;break}H=_[21040+(O*28|0)+(zt<<2)>>2]|0,Q=H}else if(O){if(O=si(Q,H)|0,(O|0)==7){R=5;break}if(kr[21872+(O*7|0)+ot>>0]|0){R=1;break}Q=0,H=_[21040+(ot*28|0)+(O<<2)>>2]|0}else Q=0,H=0;if((Q|H|0)<0)R=5;else{if((H|0)>0){N=me+4|0,O=0;do Uf(N),O=O+1|0;while((O|0)!=(H|0))}if(_[ge>>2]=0,_[ge+4>>2]=0,_[ge+8>>2]=0,hg(ge,zt),R|0)for(;P(R)|0?_d(ge):Bu(ge),(R|0)>1;)R=R+-1|0;if((Q|0)>0){R=0;do Uf(ge),R=R+1|0;while((R|0)!=(Q|0))}ie=me+4|0,ws(ie,ge,ie),Ve(ie),ie=51}}else if(V(y,b,me)|0,(At|0)!=0&(jt|0)!=0)if((ot|0)!=(Q|0)&&Ur(23173,23090,261,23100),O=si(m,d)|0,R=si(y,b)|0,(O|0)==7|(R|0)==7)R=5;else if(kr[21872+(O*7|0)+R>>0]|0)R=1;else if(O=_[21040+(O*28|0)+(R<<2)>>2]|0,(O|0)>0){N=me+4|0,R=0;do Uf(N),R=R+1|0;while((R|0)!=(O|0));ie=51}else ie=51;else ie=51;while(!1);return(ie|0)==51&&(R=me+4|0,_[I>>2]=_[R>>2],_[I+4>>2]=_[R+4>>2],_[I+8>>2]=_[R+8>>2],R=0),me=R,pt=ue,me|0}function Bl(m,d,y,b){m=m|0,d=d|0,y=y|0,b=b|0;var I=0,R=0,O=0,N=0,H=0,Q=0,ot=0,At=0,jt=0,Xt=0,zt=0,ie=0,ge=0,me=0,ue=0,fe=0;if(ie=pt,pt=pt+48|0,Q=ie+36|0,O=ie+24|0,N=ie+12|0,H=ie,I=De(m|0,d|0,52)|0,St()|0,I=I&15,jt=De(m|0,d|0,45)|0,St()|0,jt=jt&127,jt>>>0>121)return b=5,pt=ie,b|0;if(ot=Tn(jt)|0,Ge(I|0,0,52)|0,ge=St()|0|134225919,R=b,_[R>>2]=-1,_[R+4>>2]=ge,!I)return I=qe(y)|0,(I|0)==7||(I=Ol(jt,I)|0,(I|0)==127)?(ge=1,pt=ie,ge|0):(Xt=Ge(I|0,0,45)|0,zt=St()|0,jt=b,zt=_[jt+4>>2]&-1040385|zt,ge=b,_[ge>>2]=_[jt>>2]|Xt,_[ge+4>>2]=zt,ge=0,pt=ie,ge|0);for(_[Q>>2]=_[y>>2],_[Q+4>>2]=_[y+4>>2],_[Q+8>>2]=_[y+8>>2],y=I;;){if(R=y,y=y+-1|0,_[O>>2]=_[Q>>2],_[O+4>>2]=_[Q+4>>2],_[O+8>>2]=_[Q+8>>2],P(R)|0){if(I=cg(Q)|0,I|0){y=13;break}_[N>>2]=_[Q>>2],_[N+4>>2]=_[Q+4>>2],_[N+8>>2]=_[Q+8>>2],_d(N)}else{if(I=ug(Q)|0,I|0){y=13;break}_[N>>2]=_[Q>>2],_[N+4>>2]=_[Q+4>>2],_[N+8>>2]=_[Q+8>>2],Bu(N)}if(Ou(O,N,H),Ve(H),I=b,ue=_[I>>2]|0,I=_[I+4>>2]|0,fe=(15-R|0)*3|0,me=Ge(7,0,fe|0)|0,I=I&~(St()|0),fe=Ge(qe(H)|0,0,fe|0)|0,I=St()|0|I,ge=b,_[ge>>2]=fe|ue&~me,_[ge+4>>2]=I,(R|0)<=1){y=14;break}}t:do if((y|0)!=13&&(y|0)==14)if((_[Q>>2]|0)<=1&&(_[Q+4>>2]|0)<=1&&(_[Q+8>>2]|0)<=1){y=qe(Q)|0,I=Ol(jt,y)|0,(I|0)==127?H=0:H=Tn(I)|0;e:do if(y){if(ot){if(I=si(m,d)|0,(I|0)==7){I=5;break t}if(R=_[21248+(I*28|0)+(y<<2)>>2]|0,(R|0)>0){I=y,y=0;do I=eu(I)|0,y=y+1|0;while((y|0)!=(R|0))}else I=y;if((I|0)==1){I=9;break t}y=Ol(jt,I)|0,(y|0)==127&&Ur(23200,23090,411,23230),Tn(y)|0?Ur(23245,23090,412,23230):(zt=y,Xt=R,At=I)}else zt=I,Xt=0,At=y;if(N=_[4272+(jt*28|0)+(At<<2)>>2]|0,(N|0)<=-1&&Ur(23276,23090,419,23230),!H){if((Xt|0)<0){I=5;break t}if(Xt|0){R=b,I=0,y=_[R>>2]|0,R=_[R+4>>2]|0;do y=c(y,R)|0,R=St()|0,fe=b,_[fe>>2]=y,_[fe+4>>2]=R,I=I+1|0;while((I|0)<(Xt|0))}if((N|0)<=0){I=zt,y=58;break}for(R=b,I=0,y=_[R>>2]|0,R=_[R+4>>2]|0;;)if(y=c(y,R)|0,R=St()|0,fe=b,_[fe>>2]=y,_[fe+4>>2]=R,I=I+1|0,(I|0)==(N|0)){I=zt,y=58;break e}}if(O=Ff(zt,jt)|0,(O|0)==7&&Ur(23066,23090,428,23230),I=b,y=_[I>>2]|0,I=_[I+4>>2]|0,(N|0)>0){R=0;do y=c(y,I)|0,I=St()|0,fe=b,_[fe>>2]=y,_[fe+4>>2]=I,R=R+1|0;while((R|0)!=(N|0))}if(I=si(y,I)|0,(I|0)==7&&Ur(23313,23090,440,23230),y=nm(zt)|0,y=_[(y?21664:21456)+(O*28|0)+(I<<2)>>2]|0,(y|0)<0&&Ur(23313,23090,454,23230),!y)I=zt,y=58;else{O=b,I=0,R=_[O>>2]|0,O=_[O+4>>2]|0;do R=M(R,O)|0,O=St()|0,fe=b,_[fe>>2]=R,_[fe+4>>2]=O,I=I+1|0;while((I|0)<(y|0));I=zt,y=58}}else if((ot|0)!=0&(H|0)!=0){if(y=si(m,d)|0,R=b,R=si(_[R>>2]|0,_[R+4>>2]|0)|0,(y|0)==7|(R|0)==7){I=5;break t}if(R=_[21248+(y*28|0)+(R<<2)>>2]|0,(R|0)<0){I=5;break t}if(!R)y=59;else{N=b,y=0,O=_[N>>2]|0,N=_[N+4>>2]|0;do O=c(O,N)|0,N=St()|0,fe=b,_[fe>>2]=O,_[fe+4>>2]=N,y=y+1|0;while((y|0)<(R|0));y=58}}else y=58;while(!1);if((y|0)==58&&H&&(y=59),(y|0)==59&&(fe=b,(si(_[fe>>2]|0,_[fe+4>>2]|0)|0)==1)){I=9;break}fe=b,me=_[fe>>2]|0,fe=_[fe+4>>2]&-1040385,ue=Ge(I|0,0,45)|0,fe=fe|(St()|0),I=b,_[I>>2]=me|ue,_[I+4>>2]=fe,I=0}else I=1;while(!1);return fe=I,pt=ie,fe|0}function Fu(m,d,y,b,I,R){m=m|0,d=d|0,y=y|0,b=b|0,I=I|0,R=R|0;var O=0,N=0;return N=pt,pt=pt+16|0,O=N,I?m=15:(m=co(m,d,y,b,O)|0,m||(yd(O,R),m=0)),pt=N,m|0}function zh(m,d,y,b,I){m=m|0,d=d|0,y=y|0,b=b|0,I=I|0;var R=0,O=0;return O=pt,pt=pt+16|0,R=O,b?y=15:(y=fg(y,R)|0,y||(y=Bl(m,d,R,I)|0)),pt=O,y|0}function Wf(m,d,y,b,I){m=m|0,d=d|0,y=y|0,b=b|0,I=I|0;var R=0,O=0,N=0,H=0;return H=pt,pt=pt+32|0,O=H+12|0,N=H,R=co(m,d,m,d,O)|0,R|0?(N=R,pt=H,N|0):(m=co(m,d,y,b,N)|0,m|0?(N=m,pt=H,N|0):(O=pc(O,N)|0,N=I,_[N>>2]=O,_[N+4>>2]=((O|0)<0)<<31>>31,N=0,pt=H,N|0))}function Vo(m,d,y,b,I){m=m|0,d=d|0,y=y|0,b=b|0,I=I|0;var R=0,O=0,N=0,H=0;return H=pt,pt=pt+32|0,O=H+12|0,N=H,R=co(m,d,m,d,O)|0,!R&&(R=co(m,d,y,b,N)|0,!R)?(b=pc(O,N)|0,b=Ii(b|0,((b|0)<0)<<31>>31|0,1,0)|0,O=St()|0,N=I,_[N>>2]=b,_[N+4>>2]=O,N=0,pt=H,N|0):(N=R,pt=H,N|0)}function wo(m,d,y,b,I){m=m|0,d=d|0,y=y|0,b=b|0,I=I|0;var R=0,O=0,N=0,H=0,Q=0,ot=0,At=0,jt=0,Xt=0,zt=0,ie=0,ge=0,me=0,ue=0,fe=0,ne=0,tr=0,pr=0,Xe=0,er=0;if(Xe=pt,pt=pt+48|0,O=Xe+24|0,N=Xe+12|0,pr=Xe,R=co(m,d,m,d,O)|0,!R&&(R=co(m,d,y,b,N)|0,!R)){ne=pc(O,N)|0,tr=((ne|0)<0)<<31>>31,_[O>>2]=0,_[O+4>>2]=0,_[O+8>>2]=0,_[N>>2]=0,_[N+4>>2]=0,_[N+8>>2]=0,co(m,d,m,d,O)|0&&Ur(23313,23090,691,23299),co(m,d,y,b,N)|0&&Ur(23313,23090,696,23299),Vf(O),Vf(N),ne?(At=_[O>>2]|0,zt=+(ne|0),me=O+4|0,jt=_[me>>2]|0,ue=O+8|0,Xt=_[ue>>2]|0,fe=O,b=At,R=jt,y=Xt,ie=+((_[N>>2]|0)-At|0)/zt,ge=+((_[N+4>>2]|0)-jt|0)/zt,zt=+((_[N+8>>2]|0)-Xt|0)/zt):(R=O+4|0,y=O+8|0,me=R,ue=y,fe=O,b=_[O>>2]|0,R=_[R>>2]|0,y=_[y>>2]|0,ie=0,ge=0,zt=0),_[pr>>2]=b,Xt=pr+4|0,_[Xt>>2]=R,jt=pr+8|0,_[jt>>2]=y;t:do if((ne|0)<0)R=0;else for(ot=0,At=0,R=b;;){Q=+(At>>>0)+4294967296*+(ot|0),er=ie*Q+ +(R|0),H=ge*Q+ +(_[me>>2]|0),Q=zt*Q+ +(_[ue>>2]|0),y=~~+Td(+er),O=~~+Td(+H),R=~~+Td(+Q),er=+Fr(+(+(y|0)-er)),H=+Fr(+(+(O|0)-H)),Q=+Fr(+(+(R|0)-Q));do if(er>H&er>Q)y=0-(O+R)|0,b=O;else if(N=0-y|0,H>Q){b=N-R|0;break}else{b=O,R=N-O|0;break}while(!1);if(_[pr>>2]=y,_[Xt>>2]=b,_[jt>>2]=R,pg(pr),R=Bl(m,d,pr,I+(At<<3)|0)|0,R|0)break t;if(!((ot|0)<(tr|0)|(ot|0)==(tr|0)&At>>>0<ne>>>0)){R=0;break t}R=Ii(At|0,ot|0,1,0)|0,N=St()|0,ot=N,At=R,R=_[fe>>2]|0}while(!1);return pr=R,pt=Xe,pr|0}return pr=R,pt=Xe,pr|0}function Es(m,d,y,b){m=m|0,d=d|0,y=y|0,b=b|0;var I=0,R=0,O=0;if((y|0)==0&(b|0)==0)return I=0,R=1,Ei(I|0),R|0;R=m,I=d,m=1,d=0;do O=(y&1|0)==0&!0,m=Jo((O?1:R)|0,(O?0:I)|0,m|0,d|0)|0,d=St()|0,y=wd(y|0,b|0,1)|0,b=St()|0,R=Jo(R|0,I|0,R|0,I|0)|0,I=St()|0;while(!((y|0)==0&(b|0)==0));return Ei(d|0),m|0}function zu(m,d,y){m=m|0,d=d|0,y=y|0;var b=0,I=0,R=0,O=0,N=0,H=0,Q=0,ot=0,At=0,jt=0;if(!(sm(d,y)|0)||(d=ay(d)|0,b=+ft[y>>3],I=+ft[y+8>>3],I=d&I<0?I+6.283185307179586:I,jt=_[m>>2]|0,(jt|0)<=0))return jt=0,jt|0;if(At=_[m+4>>2]|0,d){d=0,ot=I,y=-1,m=0;t:for(;;){for(Q=m;O=+ft[At+(Q<<4)>>3],I=+ft[At+(Q<<4)+8>>3],m=(y+2|0)%(jt|0)|0,R=+ft[At+(m<<4)>>3],N=+ft[At+(m<<4)+8>>3],O>R?(H=O,O=N):(H=R,R=O,O=I,I=N),b=b==R|b==H?b+2220446049250313e-31:b,!!(b<R|b>H);)if(y=Q+1|0,(y|0)>=(jt|0)){y=22;break t}else m=Q,Q=y,y=m;if(N=O<0?O+6.283185307179586:O,O=I<0?I+6.283185307179586:I,ot=N==ot|O==ot?ot+-2220446049250313e-31:ot,H=N+(O-N)*((b-R)/(H-R)),(H<0?H+6.283185307179586:H)>ot&&(d=d^1),m=Q+1|0,(m|0)>=(jt|0)){y=22;break}else y=Q}if((y|0)==22)return d|0}else{d=0,ot=I,y=-1,m=0;t:for(;;){for(Q=m;O=+ft[At+(Q<<4)>>3],I=+ft[At+(Q<<4)+8>>3],m=(y+2|0)%(jt|0)|0,R=+ft[At+(m<<4)>>3],N=+ft[At+(m<<4)+8>>3],O>R?(H=O,O=N):(H=R,R=O,O=I,I=N),b=b==R|b==H?b+2220446049250313e-31:b,!!(b<R|b>H);)if(y=Q+1|0,(y|0)>=(jt|0)){y=22;break t}else m=Q,Q=y,y=m;if(ot=O==ot|I==ot?ot+-2220446049250313e-31:ot,O+(I-O)*((b-R)/(H-R))>ot&&(d=d^1),m=Q+1|0,(m|0)>=(jt|0)){y=22;break}else y=Q}if((y|0)==22)return d|0}return 0}function ps(m,d){m=m|0,d=d|0;var y=0,b=0,I=0,R=0,O=0,N=0,H=0,Q=0,ot=0,At=0,jt=0,Xt=0,zt=0,ie=0,ge=0,me=0,ue=0;if(zt=_[m>>2]|0,!zt){_[d>>2]=0,_[d+4>>2]=0,_[d+8>>2]=0,_[d+12>>2]=0,_[d+16>>2]=0,_[d+20>>2]=0,_[d+24>>2]=0,_[d+28>>2]=0;return}if(ie=d+8|0,ft[ie>>3]=17976931348623157e292,ge=d+24|0,ft[ge>>3]=17976931348623157e292,ft[d>>3]=-17976931348623157e292,me=d+16|0,ft[me>>3]=-17976931348623157e292,!((zt|0)<=0)){for(jt=_[m+4>>2]|0,Q=17976931348623157e292,ot=-17976931348623157e292,At=0,m=-1,R=17976931348623157e292,O=17976931348623157e292,H=-17976931348623157e292,b=-17976931348623157e292,Xt=0;y=+ft[jt+(Xt<<4)>>3],N=+ft[jt+(Xt<<4)+8>>3],m=m+2|0,I=+ft[jt+(((m|0)==(zt|0)?0:m)<<4)+8>>3],y<R&&(ft[ie>>3]=y,R=y),N<O&&(ft[ge>>3]=N,O=N),y>H?ft[d>>3]=y:y=H,N>b&&(ft[me>>3]=N,b=N),Q=N>0&N<Q?N:Q,ot=N<0&N>ot?N:ot,At=At|+Fr(+(N-I))>3.141592653589793,m=Xt+1|0,(m|0)!=(zt|0);)ue=Xt,H=y,Xt=m,m=ue;At&&(ft[me>>3]=ot,ft[ge>>3]=Q)}}function Qs(m,d){m=m|0,d=d|0;var y=0,b=0,I=0,R=0,O=0,N=0,H=0,Q=0,ot=0,At=0,jt=0,Xt=0,zt=0,ie=0,ge=0,me=0,ue=0,fe=0,ne=0,tr=0,pr=0,Xe=0;if(zt=_[m>>2]|0,zt){if(ie=d+8|0,ft[ie>>3]=17976931348623157e292,ge=d+24|0,ft[ge>>3]=17976931348623157e292,ft[d>>3]=-17976931348623157e292,me=d+16|0,ft[me>>3]=-17976931348623157e292,(zt|0)>0){for(I=_[m+4>>2]|0,jt=17976931348623157e292,Xt=-17976931348623157e292,b=0,y=-1,H=17976931348623157e292,Q=17976931348623157e292,At=-17976931348623157e292,O=-17976931348623157e292,ue=0;R=+ft[I+(ue<<4)>>3],ot=+ft[I+(ue<<4)+8>>3],pr=y+2|0,N=+ft[I+(((pr|0)==(zt|0)?0:pr)<<4)+8>>3],R<H&&(ft[ie>>3]=R,H=R),ot<Q&&(ft[ge>>3]=ot,Q=ot),R>At?ft[d>>3]=R:R=At,ot>O&&(ft[me>>3]=ot,O=ot),jt=ot>0&ot<jt?ot:jt,Xt=ot<0&ot>Xt?ot:Xt,b=b|+Fr(+(ot-N))>3.141592653589793,y=ue+1|0,(y|0)!=(zt|0);)pr=ue,At=R,ue=y,y=pr;b&&(ft[me>>3]=Xt,ft[ge>>3]=jt)}}else _[d>>2]=0,_[d+4>>2]=0,_[d+8>>2]=0,_[d+12>>2]=0,_[d+16>>2]=0,_[d+20>>2]=0,_[d+24>>2]=0,_[d+28>>2]=0;if(pr=m+8|0,y=_[pr>>2]|0,!((y|0)<=0)){tr=m+12|0,ne=0;do if(I=_[tr>>2]|0,b=ne,ne=ne+1|0,ge=d+(ne<<5)|0,me=_[I+(b<<3)>>2]|0,me){if(ue=d+(ne<<5)+8|0,ft[ue>>3]=17976931348623157e292,m=d+(ne<<5)+24|0,ft[m>>3]=17976931348623157e292,ft[ge>>3]=-17976931348623157e292,fe=d+(ne<<5)+16|0,ft[fe>>3]=-17976931348623157e292,(me|0)>0){for(zt=_[I+(b<<3)+4>>2]|0,jt=17976931348623157e292,Xt=-17976931348623157e292,I=0,b=-1,ie=0,H=17976931348623157e292,Q=17976931348623157e292,ot=-17976931348623157e292,O=-17976931348623157e292;R=+ft[zt+(ie<<4)>>3],At=+ft[zt+(ie<<4)+8>>3],b=b+2|0,N=+ft[zt+(((b|0)==(me|0)?0:b)<<4)+8>>3],R<H&&(ft[ue>>3]=R,H=R),At<Q&&(ft[m>>3]=At,Q=At),R>ot?ft[ge>>3]=R:R=ot,At>O&&(ft[fe>>3]=At,O=At),jt=At>0&At<jt?At:jt,Xt=At<0&At>Xt?At:Xt,I=I|+Fr(+(At-N))>3.141592653589793,b=ie+1|0,(b|0)!=(me|0);)Xe=ie,ie=b,ot=R,b=Xe;I&&(ft[fe>>3]=Xt,ft[m>>3]=jt)}}else _[ge>>2]=0,_[ge+4>>2]=0,_[ge+8>>2]=0,_[ge+12>>2]=0,_[ge+16>>2]=0,_[ge+20>>2]=0,_[ge+24>>2]=0,_[ge+28>>2]=0,y=_[pr>>2]|0;while((ne|0)<(y|0))}}function da(m,d,y){m=m|0,d=d|0,y=y|0;var b=0,I=0,R=0;if(!(zu(m,d,y)|0))return I=0,I|0;if(I=m+8|0,(_[I>>2]|0)<=0)return I=1,I|0;for(b=m+12|0,m=0;;){if(R=m,m=m+1|0,zu((_[b>>2]|0)+(R<<3)|0,d+(m<<5)|0,y)|0){m=0,b=6;break}if((m|0)>=(_[I>>2]|0)){m=1,b=6;break}}return(b|0)==6?m|0:0}function Is(){return 8}function Uh(){return 16}function fm(){return 168}function py(){return 8}function dy(){return 16}function Wb(){return 12}function yg(){return 8}function dc(m){return m=m|0,+(+((_[m>>2]|0)>>>0)+4294967296*+(_[m+4>>2]|0))}function Vh(m){m=m|0;var d=0,y=0;return y=+ft[m>>3],d=+ft[m+8>>3],+ +Jr(+(y*y+d*d))}function Nl(m,d,y,b,I){m=m|0,d=d|0,y=y|0,b=b|0,I=I|0;var R=0,O=0,N=0,H=0,Q=0,ot=0,At=0,jt=0;Q=+ft[m>>3],H=+ft[d>>3]-Q,N=+ft[m+8>>3],O=+ft[d+8>>3]-N,At=+ft[y>>3],R=+ft[b>>3]-At,jt=+ft[y+8>>3],ot=+ft[b+8>>3]-jt,R=(R*(N-jt)-(Q-At)*ot)/(H*ot-O*R),ft[I>>3]=Q+H*R,ft[I+8>>3]=N+O*R}function Ba(m,d){return m=m|0,d=d|0,+Fr(+(+ft[m>>3]-+ft[d>>3]))<11920928955078125e-23?(d=+Fr(+(+ft[m+8>>3]-+ft[d+8>>3]))<11920928955078125e-23,d|0):(d=0,d|0)}function Cn(m,d){m=m|0,d=d|0;var y=0,b=0,I=0;return I=+ft[m>>3]-+ft[d>>3],b=+ft[m+8>>3]-+ft[d+8>>3],y=+ft[m+16>>3]-+ft[d+16>>3],+(I*I+b*b+y*y)}function xg(m,d){m=m|0,d=d|0;var y=0,b=0,I=0;y=+ft[m>>3],b=+cn(+y),y=+un(+y),ft[d+16>>3]=y,y=+ft[m+8>>3],I=b*+cn(+y),ft[d>>3]=I,y=b*+un(+y),ft[d+8>>3]=y}function iu(m,d,y){m=m|0,d=d|0,y=y|0;var b=0,I=0,R=0;if(R=pt,pt=pt+16|0,I=R,b=Sn(m,d)|0,(y+-1|0)>>>0>5||(b=(b|0)!=0,(y|0)==1&b))return I=-1,pt=R,I|0;do if(bg(m,d,I)|0)b=-1;else if(b){b=((_[21936+(y<<2)>>2]|0)+5-(_[I>>2]|0)|0)%5|0;break}else{b=((_[21968+(y<<2)>>2]|0)+6-(_[I>>2]|0)|0)%6|0;break}while(!1);return I=b,pt=R,I|0}function bg(m,d,y){m=m|0,d=d|0,y=y|0;var b=0,I=0,R=0,O=0,N=0,H=0,Q=0;if(Q=pt,pt=pt+32|0,O=Q+16|0,N=Q,b=$(m,d,O)|0,b|0)return y=b,pt=Q,y|0;R=Lu(m,d)|0,H=si(m,d)|0,Qc(R,N),b=oy(R,_[O>>2]|0)|0;t:do if(Tn(R)|0){do switch(R|0){case 4:{m=0;break}case 14:{m=1;break}case 24:{m=2;break}case 38:{m=3;break}case 49:{m=4;break}case 58:{m=5;break}case 63:{m=6;break}case 72:{m=7;break}case 83:{m=8;break}case 97:{m=9;break}case 107:{m=10;break}case 117:{m=11;break}default:{b=1;break t}}while(!1);if(I=_[22e3+(m*24|0)+8>>2]|0,d=_[22e3+(m*24|0)+16>>2]|0,m=_[O>>2]|0,(m|0)!=(_[N>>2]|0)&&(N=nm(R)|0,m=_[O>>2]|0,N|(m|0)==(d|0)&&(b=(b+1|0)%6|0)),(H|0)==3&(m|0)==(d|0)){b=(b+5|0)%6|0,I=22;break}(H|0)==5&(m|0)==(I|0)&&(b=(b+1|0)%6|0),I=22}else I=22;while(!1);return(I|0)==22&&(_[y>>2]=b,b=0),y=b,pt=Q,y|0}function Ll(m,d,y,b){m=m|0,d=d|0,y=y|0,b=b|0;var I=0,R=0,O=0,N=0,H=0,Q=0,ot=0,At=0,jt=0,Xt=0,zt=0,ie=0,ge=0,me=0,ue=0,fe=0;if(fe=pt,pt=pt+32|0,ue=fe+24|0,ge=fe+20|0,zt=fe+8|0,Xt=fe+16|0,jt=fe,H=(Sn(m,d)|0)==0,H=H?6:5,ot=De(m|0,d|0,52)|0,St()|0,ot=ot&15,H>>>0<=y>>>0)return b=2,pt=fe,b|0;At=(ot|0)==0,!At&&(ie=Ge(7,0,(ot^15)*3|0)|0,(ie&m|0)==0&((St()|0)&d|0)==0)?I=y:R=4;t:do if((R|0)==4){if(I=(Sn(m,d)|0)!=0,((I?4:5)|0)<(y|0)||bg(m,d,ue)|0||(R=(_[ue>>2]|0)+y|0,I?I=22288+(((R|0)%5|0)<<2)|0:I=22320+(((R|0)%6|0)<<2)|0,ie=_[I>>2]|0,(ie|0)==7))return b=1,pt=fe,b|0;_[ge>>2]=0,I=Zs(m,d,ie,ge,zt)|0;do if(!I){if(N=zt,Q=_[N>>2]|0,N=_[N+4>>2]|0,O=N>>>0<d>>>0|(N|0)==(d|0)&Q>>>0<m>>>0,R=O?Q:m,O=O?N:d,!At&&(At=Ge(7,0,(ot^15)*3|0)|0,(Q&At|0)==0&(N&(St()|0)|0)==0))I=y;else{if(N=(y+-1+H|0)%(H|0)|0,I=Sn(m,d)|0,(N|0)<0&&Ur(23313,23315,245,23324),H=(I|0)!=0,((H?4:5)|0)<(N|0)&&Ur(23313,23315,245,23324),bg(m,d,ue)|0&&Ur(23313,23315,245,23324),I=(_[ue>>2]|0)+N|0,H?I=22288+(((I|0)%5|0)<<2)|0:I=22320+(((I|0)%6|0)<<2)|0,N=_[I>>2]|0,(N|0)==7&&Ur(23313,23315,245,23324),_[Xt>>2]=0,I=Zs(m,d,N,Xt,jt)|0,I|0)break;Q=jt,H=_[Q>>2]|0,Q=_[Q+4>>2]|0;do if(Q>>>0<O>>>0|(Q|0)==(O|0)&H>>>0<R>>>0){if(Sn(H,Q)|0?R=im(H,Q,m,d)|0:R=_[22384+((((_[Xt>>2]|0)+(_[22352+(N<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,I=Sn(H,Q)|0,(R+-1|0)>>>0>5){I=-1,R=H,O=Q;break}if(I=(I|0)!=0,(R|0)==1&I){I=-1,R=H,O=Q;break}do if(bg(H,Q,ue)|0)I=-1;else if(I){I=((_[21936+(R<<2)>>2]|0)+5-(_[ue>>2]|0)|0)%5|0;break}else{I=((_[21968+(R<<2)>>2]|0)+6-(_[ue>>2]|0)|0)%6|0;break}while(!1);R=H,O=Q}else I=y;while(!1);N=zt,Q=_[N>>2]|0,N=_[N+4>>2]|0}if((R|0)==(Q|0)&(O|0)==(N|0)){if(H=(Sn(Q,N)|0)!=0,H?m=im(Q,N,m,d)|0:m=_[22384+((((_[ge>>2]|0)+(_[22352+(ie<<2)>>2]|0)|0)%6|0)<<2)>>2]|0,I=Sn(Q,N)|0,(m+-1|0)>>>0<=5&&(me=(I|0)!=0,!((m|0)==1&me)))do if(bg(Q,N,ue)|0)I=-1;else if(me){I=((_[21936+(m<<2)>>2]|0)+5-(_[ue>>2]|0)|0)%5|0;break}else{I=((_[21968+(m<<2)>>2]|0)+6-(_[ue>>2]|0)|0)%6|0;break}while(!1);else I=-1;I=I+1|0,I=(I|0)==6|H&(I|0)==5?0:I}d=O,m=R;break t}while(!1);return b=I,pt=fe,b|0}while(!1);return me=Ge(I|0,0,56)|0,ue=St()|0|d&-2130706433|536870912,_[b>>2]=me|m,_[b+4>>2]=ue,b=0,pt=fe,b|0}function Vs(m,d,y){m=m|0,d=d|0,y=y|0;var b=0,I=0,R=0;return R=(Sn(m,d)|0)==0,b=Ll(m,d,0,y)|0,I=(b|0)==0,R?!I||(b=Ll(m,d,1,y+8|0)|0,b|0)||(b=Ll(m,d,2,y+16|0)|0,b|0)||(b=Ll(m,d,3,y+24|0)|0,b|0)||(b=Ll(m,d,4,y+32|0)|0,b)?(R=b,R|0):Ll(m,d,5,y+40|0)|0:!I||(b=Ll(m,d,1,y+8|0)|0,b|0)||(b=Ll(m,d,2,y+16|0)|0,b|0)||(b=Ll(m,d,3,y+24|0)|0,b|0)||(b=Ll(m,d,4,y+32|0)|0,b|0)?(R=b,R|0):(R=y+40|0,_[R>>2]=0,_[R+4>>2]=0,R=0,R|0)}function $b(m,d,y){m=m|0,d=d|0,y=y|0;var b=0,I=0,R=0,O=0,N=0,H=0;return H=pt,pt=pt+192|0,I=H,R=H+168|0,O=De(m|0,d|0,56)|0,St()|0,O=O&7,N=d&-2130706433|134217728,b=$(m,N,R)|0,b|0?(N=b,pt=H,N|0):(d=De(m|0,d|0,52)|0,St()|0,d=d&15,Sn(m,N)|0?Lh(R,d,O,1,I):bd(R,d,O,1,I),N=I+8|0,_[y>>2]=_[N>>2],_[y+4>>2]=_[N+4>>2],_[y+8>>2]=_[N+8>>2],_[y+12>>2]=_[N+12>>2],N=0,pt=H,N|0)}function I4(m,d){m=m|0,d=d|0;var y=0,b=0,I=0,R=0;return I=pt,pt=pt+16|0,y=I,!(!0&(d&2013265920|0)==536870912)||(b=d&-2130706433|134217728,!(Kn(m,b)|0))?(b=0,pt=I,b|0):(R=De(m|0,d|0,56)|0,St()|0,R=(Ll(m,b,R&7,y)|0)==0,b=y,b=R&((_[b>>2]|0)==(m|0)?(_[b+4>>2]|0)==(d|0):0)&1,pt=I,b|0)}function $f(m,d,y){m=m|0,d=d|0,y=y|0;var b=0;(d|0)>0?(b=nu(d,4)|0,_[m>>2]=b,b||Ur(23337,23360,40,23374)):_[m>>2]=0,_[m+4>>2]=d,_[m+8>>2]=0,_[m+12>>2]=y}function Hf(m){m=m|0;var d=0,y=0,b=0,I=0,R=0,O=0,N=0;I=m+4|0,R=m+12|0,O=m+8|0;t:for(;;){for(y=_[I>>2]|0,d=0;;){if((d|0)>=(y|0))break t;if(b=_[m>>2]|0,N=_[b+(d<<2)>>2]|0,!N)d=d+1|0;else break}d=b+(~~(+Fr(+(+vs(10,+ +(15-(_[R>>2]|0)|0))*(+ft[N>>3]+ +ft[N+8>>3])))%+(y|0))>>>0<<2)|0,y=_[d>>2]|0;e:do if(y|0){if(b=N+32|0,(y|0)==(N|0))_[d>>2]=_[b>>2];else{if(y=y+32|0,d=_[y>>2]|0,!d)break;for(;(d|0)!=(N|0);)if(y=d+32|0,d=_[y>>2]|0,!d)break e;_[y>>2]=_[b>>2]}oi(N),_[O>>2]=(_[O>>2]|0)+-1}while(!1)}oi(_[m>>2]|0)}function vg(m){m=m|0;var d=0,y=0,b=0;for(b=_[m+4>>2]|0,y=0;;){if((y|0)>=(b|0)){d=0,y=4;break}if(d=_[(_[m>>2]|0)+(y<<2)>>2]|0,!d)y=y+1|0;else{y=4;break}}return(y|0)==4?d|0:0}function my(m,d){m=m|0,d=d|0;var y=0,b=0,I=0,R=0;if(y=~~(+Fr(+(+vs(10,+ +(15-(_[m+12>>2]|0)|0))*(+ft[d>>3]+ +ft[d+8>>3])))%+(_[m+4>>2]|0))>>>0,y=(_[m>>2]|0)+(y<<2)|0,b=_[y>>2]|0,!b)return R=1,R|0;R=d+32|0;do if((b|0)!=(d|0)){if(y=_[b+32>>2]|0,!y)return R=1,R|0;for(I=y;;){if((I|0)==(d|0)){I=8;break}if(y=_[I+32>>2]|0,y)b=I,I=y;else{y=1,I=10;break}}if((I|0)==8){_[b+32>>2]=_[R>>2];break}else if((I|0)==10)return y|0}else _[y>>2]=_[R>>2];while(!1);return oi(d),R=m+8|0,_[R>>2]=(_[R>>2]|0)+-1,R=0,R|0}function M4(m,d,y){m=m|0,d=d|0,y=y|0;var b=0,I=0,R=0,O=0;R=mc(40)|0,R||Ur(23390,23360,98,23403),_[R>>2]=_[d>>2],_[R+4>>2]=_[d+4>>2],_[R+8>>2]=_[d+8>>2],_[R+12>>2]=_[d+12>>2],I=R+16|0,_[I>>2]=_[y>>2],_[I+4>>2]=_[y+4>>2],_[I+8>>2]=_[y+8>>2],_[I+12>>2]=_[y+12>>2],_[R+32>>2]=0,I=~~(+Fr(+(+vs(10,+ +(15-(_[m+12>>2]|0)|0))*(+ft[d>>3]+ +ft[d+8>>3])))%+(_[m+4>>2]|0))>>>0,I=(_[m>>2]|0)+(I<<2)|0,b=_[I>>2]|0;do if(!b)_[I>>2]=R;else{for(;!(Gt(b,d)|0&&Gt(b+16|0,y)|0);)if(I=_[b+32>>2]|0,b=I|0?I:b,!(_[b+32>>2]|0)){O=10;break}if((O|0)==10){_[b+32>>2]=R;break}return oi(R),O=b,O|0}while(!1);return O=m+8|0,_[O>>2]=(_[O>>2]|0)+1,O=R,O|0}function YP(m,d,y){m=m|0,d=d|0,y=y|0;var b=0,I=0;if(I=~~(+Fr(+(+vs(10,+ +(15-(_[m+12>>2]|0)|0))*(+ft[d>>3]+ +ft[d+8>>3])))%+(_[m+4>>2]|0))>>>0,I=_[(_[m>>2]|0)+(I<<2)>>2]|0,!I)return y=0,y|0;if(!y){for(m=I;;){if(Gt(m,d)|0){b=10;break}if(m=_[m+32>>2]|0,!m){m=0,b=10;break}}if((b|0)==10)return m|0}for(m=I;;){if(Gt(m,d)|0&&Gt(m+16|0,y)|0){b=10;break}if(m=_[m+32>>2]|0,!m){m=0,b=10;break}}return(b|0)==10?m|0:0}function C4(m,d){m=m|0,d=d|0;var y=0;if(y=~~(+Fr(+(+vs(10,+ +(15-(_[m+12>>2]|0)|0))*(+ft[d>>3]+ +ft[d+8>>3])))%+(_[m+4>>2]|0))>>>0,m=_[(_[m>>2]|0)+(y<<2)>>2]|0,!m)return y=0,y|0;for(;;){if(Gt(m,d)|0){d=5;break}if(m=_[m+32>>2]|0,!m){m=0,d=5;break}}return(d|0)==5?m|0:0}function XP(){return 23424}function Hb(m){return m=+m,+ +Yb(+m)}function qf(m){return m=+m,~~+Hb(m)|0}function mc(m){m=m|0;var d=0,y=0,b=0,I=0,R=0,O=0,N=0,H=0,Q=0,ot=0,At=0,jt=0,Xt=0,zt=0,ie=0,ge=0,me=0,ue=0,fe=0,ne=0,tr=0;tr=pt,pt=pt+16|0,jt=tr;do if(m>>>0<245){if(Q=m>>>0<11?16:m+11&-8,m=Q>>>3,At=_[5857]|0,y=At>>>m,y&3|0)return d=(y&1^1)+m|0,m=23468+(d<<1<<2)|0,y=m+8|0,b=_[y>>2]|0,I=b+8|0,R=_[I>>2]|0,(R|0)==(m|0)?_[5857]=At&~(1<<d):(_[R+12>>2]=m,_[y>>2]=R),ne=d<<3,_[b+4>>2]=ne|3,ne=b+ne+4|0,_[ne>>2]=_[ne>>2]|1,ne=I,pt=tr,ne|0;if(ot=_[5859]|0,Q>>>0>ot>>>0){if(y|0)return d=2<<m,d=y<<m&(d|0-d),d=(d&0-d)+-1|0,N=d>>>12&16,d=d>>>N,y=d>>>5&8,d=d>>>y,R=d>>>2&4,d=d>>>R,m=d>>>1&2,d=d>>>m,b=d>>>1&1,b=(y|N|R|m|b)+(d>>>b)|0,d=23468+(b<<1<<2)|0,m=d+8|0,R=_[m>>2]|0,N=R+8|0,y=_[N>>2]|0,(y|0)==(d|0)?(m=At&~(1<<b),_[5857]=m):(_[y+12>>2]=d,_[m>>2]=y,m=At),ne=b<<3,O=ne-Q|0,_[R+4>>2]=Q|3,I=R+Q|0,_[I+4>>2]=O|1,_[R+ne>>2]=O,ot|0&&(b=_[5862]|0,d=ot>>>3,y=23468+(d<<1<<2)|0,d=1<<d,m&d?(m=y+8|0,d=_[m>>2]|0):(_[5857]=m|d,d=y,m=y+8|0),_[m>>2]=b,_[d+12>>2]=b,_[b+8>>2]=d,_[b+12>>2]=y),_[5859]=O,_[5862]=I,ne=N,pt=tr,ne|0;if(R=_[5858]|0,R){for(y=(R&0-R)+-1|0,I=y>>>12&16,y=y>>>I,b=y>>>5&8,y=y>>>b,O=y>>>2&4,y=y>>>O,N=y>>>1&2,y=y>>>N,H=y>>>1&1,H=_[23732+((b|I|O|N|H)+(y>>>H)<<2)>>2]|0,y=H,N=H,H=(_[H+4>>2]&-8)-Q|0;m=_[y+16>>2]|0,!(!m&&(m=_[y+20>>2]|0,!m));)O=(_[m+4>>2]&-8)-Q|0,I=O>>>0<H>>>0,y=m,N=I?m:N,H=I?O:H;if(O=N+Q|0,O>>>0>N>>>0){I=_[N+24>>2]|0,d=_[N+12>>2]|0;do if((d|0)==(N|0)){if(m=N+20|0,d=_[m>>2]|0,!d&&(m=N+16|0,d=_[m>>2]|0,!d)){y=0;break}for(;;)if(b=d+20|0,y=_[b>>2]|0,y)d=y,m=b;else if(b=d+16|0,y=_[b>>2]|0,y)d=y,m=b;else break;_[m>>2]=0,y=d}else y=_[N+8>>2]|0,_[y+12>>2]=d,_[d+8>>2]=y,y=d;while(!1);do if(I|0){if(d=_[N+28>>2]|0,m=23732+(d<<2)|0,(N|0)==(_[m>>2]|0)){if(_[m>>2]=y,!y){_[5858]=R&~(1<<d);break}}else if(ne=I+16|0,_[((_[ne>>2]|0)==(N|0)?ne:I+20|0)>>2]=y,!y)break;_[y+24>>2]=I,d=_[N+16>>2]|0,d|0&&(_[y+16>>2]=d,_[d+24>>2]=y),d=_[N+20>>2]|0,d|0&&(_[y+20>>2]=d,_[d+24>>2]=y)}while(!1);return H>>>0<16?(ne=H+Q|0,_[N+4>>2]=ne|3,ne=N+ne+4|0,_[ne>>2]=_[ne>>2]|1):(_[N+4>>2]=Q|3,_[O+4>>2]=H|1,_[O+H>>2]=H,ot|0&&(b=_[5862]|0,d=ot>>>3,y=23468+(d<<1<<2)|0,d=1<<d,d&At?(m=y+8|0,d=_[m>>2]|0):(_[5857]=d|At,d=y,m=y+8|0),_[m>>2]=b,_[d+12>>2]=b,_[b+8>>2]=d,_[b+12>>2]=y),_[5859]=H,_[5862]=O),ne=N+8|0,pt=tr,ne|0}else At=Q}else At=Q}else At=Q}else if(m>>>0<=4294967231)if(m=m+11|0,Q=m&-8,b=_[5858]|0,b){I=0-Q|0,m=m>>>8,m?Q>>>0>16777215?H=31:(At=(m+1048320|0)>>>16&8,ie=m<<At,N=(ie+520192|0)>>>16&4,ie=ie<<N,H=(ie+245760|0)>>>16&2,H=14-(N|At|H)+(ie<<H>>>15)|0,H=Q>>>(H+7|0)&1|H<<1):H=0,y=_[23732+(H<<2)>>2]|0;t:do if(!y)y=0,m=0,ie=61;else for(m=0,N=Q<<((H|0)==31?0:25-(H>>>1)|0),R=0;;){if(O=(_[y+4>>2]&-8)-Q|0,O>>>0<I>>>0)if(O)m=y,I=O;else{m=y,I=0,ie=65;break t}if(ie=_[y+20>>2]|0,y=_[y+16+(N>>>31<<2)>>2]|0,R=(ie|0)==0|(ie|0)==(y|0)?R:ie,y)N=N<<1;else{y=R,ie=61;break}}while(!1);if((ie|0)==61){if((y|0)==0&(m|0)==0){if(m=2<<H,m=(m|0-m)&b,!m){At=Q;break}At=(m&0-m)+-1|0,O=At>>>12&16,At=At>>>O,R=At>>>5&8,At=At>>>R,N=At>>>2&4,At=At>>>N,H=At>>>1&2,At=At>>>H,y=At>>>1&1,m=0,y=_[23732+((R|O|N|H|y)+(At>>>y)<<2)>>2]|0}y?ie=65:(N=m,O=I)}if((ie|0)==65)for(R=y;;)if(At=(_[R+4>>2]&-8)-Q|0,y=At>>>0<I>>>0,I=y?At:I,m=y?R:m,y=_[R+16>>2]|0,y||(y=_[R+20>>2]|0),y)R=y;else{N=m,O=I;break}if(N|0&&O>>>0<((_[5859]|0)-Q|0)>>>0&&(ot=N+Q|0,ot>>>0>N>>>0)){R=_[N+24>>2]|0,d=_[N+12>>2]|0;do if((d|0)==(N|0)){if(m=N+20|0,d=_[m>>2]|0,!d&&(m=N+16|0,d=_[m>>2]|0,!d)){d=0;break}for(;;)if(I=d+20|0,y=_[I>>2]|0,y)d=y,m=I;else if(I=d+16|0,y=_[I>>2]|0,y)d=y,m=I;else break;_[m>>2]=0}else ne=_[N+8>>2]|0,_[ne+12>>2]=d,_[d+8>>2]=ne;while(!1);do if(R){if(m=_[N+28>>2]|0,y=23732+(m<<2)|0,(N|0)==(_[y>>2]|0)){if(_[y>>2]=d,!d){b=b&~(1<<m),_[5858]=b;break}}else if(ne=R+16|0,_[((_[ne>>2]|0)==(N|0)?ne:R+20|0)>>2]=d,!d)break;_[d+24>>2]=R,m=_[N+16>>2]|0,m|0&&(_[d+16>>2]=m,_[m+24>>2]=d),m=_[N+20>>2]|0,m&&(_[d+20>>2]=m,_[m+24>>2]=d)}while(!1);t:do if(O>>>0<16)ne=O+Q|0,_[N+4>>2]=ne|3,ne=N+ne+4|0,_[ne>>2]=_[ne>>2]|1;else{if(_[N+4>>2]=Q|3,_[ot+4>>2]=O|1,_[ot+O>>2]=O,d=O>>>3,O>>>0<256){y=23468+(d<<1<<2)|0,m=_[5857]|0,d=1<<d,m&d?(m=y+8|0,d=_[m>>2]|0):(_[5857]=m|d,d=y,m=y+8|0),_[m>>2]=ot,_[d+12>>2]=ot,_[ot+8>>2]=d,_[ot+12>>2]=y;break}if(d=O>>>8,d?O>>>0>16777215?y=31:(fe=(d+1048320|0)>>>16&8,ne=d<<fe,ue=(ne+520192|0)>>>16&4,ne=ne<<ue,y=(ne+245760|0)>>>16&2,y=14-(ue|fe|y)+(ne<<y>>>15)|0,y=O>>>(y+7|0)&1|y<<1):y=0,d=23732+(y<<2)|0,_[ot+28>>2]=y,m=ot+16|0,_[m+4>>2]=0,_[m>>2]=0,m=1<<y,!(b&m)){_[5858]=b|m,_[d>>2]=ot,_[ot+24>>2]=d,_[ot+12>>2]=ot,_[ot+8>>2]=ot;break}d=_[d>>2]|0;e:do if((_[d+4>>2]&-8|0)!=(O|0)){for(b=O<<((y|0)==31?0:25-(y>>>1)|0);y=d+16+(b>>>31<<2)|0,m=_[y>>2]|0,!!m;)if((_[m+4>>2]&-8|0)==(O|0)){d=m;break e}else b=b<<1,d=m;_[y>>2]=ot,_[ot+24>>2]=d,_[ot+12>>2]=ot,_[ot+8>>2]=ot;break t}while(!1);fe=d+8|0,ne=_[fe>>2]|0,_[ne+12>>2]=ot,_[fe>>2]=ot,_[ot+8>>2]=ne,_[ot+12>>2]=d,_[ot+24>>2]=0}while(!1);return ne=N+8|0,pt=tr,ne|0}else At=Q}else At=Q;else At=-1;while(!1);if(y=_[5859]|0,y>>>0>=At>>>0)return d=y-At|0,m=_[5862]|0,d>>>0>15?(ne=m+At|0,_[5862]=ne,_[5859]=d,_[ne+4>>2]=d|1,_[m+y>>2]=d,_[m+4>>2]=At|3):(_[5859]=0,_[5862]=0,_[m+4>>2]=y|3,ne=m+y+4|0,_[ne>>2]=_[ne>>2]|1),ne=m+8|0,pt=tr,ne|0;if(O=_[5860]|0,O>>>0>At>>>0)return ue=O-At|0,_[5860]=ue,ne=_[5863]|0,fe=ne+At|0,_[5863]=fe,_[fe+4>>2]=ue|1,_[ne+4>>2]=At|3,ne=ne+8|0,pt=tr,ne|0;if(_[5975]|0?m=_[5977]|0:(_[5977]=4096,_[5976]=4096,_[5978]=-1,_[5979]=-1,_[5980]=0,_[5968]=0,_[5975]=jt&-16^1431655768,m=4096),N=At+48|0,H=At+47|0,R=m+H|0,I=0-m|0,Q=R&I,Q>>>0<=At>>>0||(m=_[5967]|0,m|0&&(ot=_[5965]|0,jt=ot+Q|0,jt>>>0<=ot>>>0|jt>>>0>m>>>0)))return ne=0,pt=tr,ne|0;t:do if(_[5968]&4)d=0,ie=143;else{y=_[5863]|0;e:do if(y){for(b=23876;jt=_[b>>2]|0,!(jt>>>0<=y>>>0&&(jt+(_[b+4>>2]|0)|0)>>>0>y>>>0);)if(m=_[b+8>>2]|0,m)b=m;else{ie=128;break e}if(d=R-O&I,d>>>0<2147483647)if(m=jh(d|0)|0,(m|0)==((_[b>>2]|0)+(_[b+4>>2]|0)|0)){if((m|0)!=-1){O=d,R=m,ie=145;break t}}else b=m,ie=136;else d=0}else ie=128;while(!1);do if((ie|0)==128)if(y=jh(0)|0,(y|0)!=-1&&(d=y,Xt=_[5976]|0,zt=Xt+-1|0,d=(zt&d|0?(zt+d&0-Xt)-d|0:0)+Q|0,Xt=_[5965]|0,zt=d+Xt|0,d>>>0>At>>>0&d>>>0<2147483647)){if(jt=_[5967]|0,jt|0&&zt>>>0<=Xt>>>0|zt>>>0>jt>>>0){d=0;break}if(m=jh(d|0)|0,(m|0)==(y|0)){O=d,R=y,ie=145;break t}else b=m,ie=136}else d=0;while(!1);do if((ie|0)==136){if(y=0-d|0,!(N>>>0>d>>>0&(d>>>0<2147483647&(b|0)!=-1)))if((b|0)==-1){d=0;break}else{O=d,R=b,ie=145;break t}if(m=_[5977]|0,m=H-d+m&0-m,m>>>0>=2147483647){O=d,R=b,ie=145;break t}if((jh(m|0)|0)==-1){jh(y|0)|0,d=0;break}else{O=m+d|0,R=b,ie=145;break t}}while(!1);_[5968]=_[5968]|4,ie=143}while(!1);if((ie|0)==143&&Q>>>0<2147483647&&(ue=jh(Q|0)|0,zt=jh(0)|0,ge=zt-ue|0,me=ge>>>0>(At+40|0)>>>0,!((ue|0)==-1|me^1|ue>>>0<zt>>>0&((ue|0)!=-1&(zt|0)!=-1)^1))&&(O=me?ge:d,R=ue,ie=145),(ie|0)==145){d=(_[5965]|0)+O|0,_[5965]=d,d>>>0>(_[5966]|0)>>>0&&(_[5966]=d),H=_[5863]|0;t:do if(H){for(d=23876;;){if(m=_[d>>2]|0,y=_[d+4>>2]|0,(R|0)==(m+y|0)){ie=154;break}if(b=_[d+8>>2]|0,b)d=b;else break}if((ie|0)==154&&(fe=d+4|0,(_[d+12>>2]&8|0)==0)&&R>>>0>H>>>0&m>>>0<=H>>>0){_[fe>>2]=y+O,ne=(_[5860]|0)+O|0,ue=H+8|0,ue=ue&7|0?0-ue&7:0,fe=H+ue|0,ue=ne-ue|0,_[5863]=fe,_[5860]=ue,_[fe+4>>2]=ue|1,_[H+ne+4>>2]=40,_[5864]=_[5979];break}for(R>>>0<(_[5861]|0)>>>0&&(_[5861]=R),y=R+O|0,d=23876;;){if((_[d>>2]|0)==(y|0)){ie=162;break}if(m=_[d+8>>2]|0,m)d=m;else break}if((ie|0)==162&&!(_[d+12>>2]&8|0)){_[d>>2]=R,ot=d+4|0,_[ot>>2]=(_[ot>>2]|0)+O,ot=R+8|0,ot=R+(ot&7|0?0-ot&7:0)|0,d=y+8|0,d=y+(d&7|0?0-d&7:0)|0,Q=ot+At|0,N=d-ot-At|0,_[ot+4>>2]=At|3;e:do if((H|0)==(d|0))ne=(_[5860]|0)+N|0,_[5860]=ne,_[5863]=Q,_[Q+4>>2]=ne|1;else{if((_[5862]|0)==(d|0)){ne=(_[5859]|0)+N|0,_[5859]=ne,_[5862]=Q,_[Q+4>>2]=ne|1,_[Q+ne>>2]=ne;break}if(m=_[d+4>>2]|0,(m&3|0)==1){O=m&-8,b=m>>>3;r:do if(m>>>0<256)if(m=_[d+8>>2]|0,y=_[d+12>>2]|0,(y|0)==(m|0)){_[5857]=_[5857]&~(1<<b);break}else{_[m+12>>2]=y,_[y+8>>2]=m;break}else{R=_[d+24>>2]|0,m=_[d+12>>2]|0;do if((m|0)==(d|0)){if(y=d+16|0,b=y+4|0,m=_[b>>2]|0,m)y=b;else if(m=_[y>>2]|0,!m){m=0;break}for(;;)if(I=m+20|0,b=_[I>>2]|0,b)m=b,y=I;else if(I=m+16|0,b=_[I>>2]|0,b)m=b,y=I;else break;_[y>>2]=0}else ne=_[d+8>>2]|0,_[ne+12>>2]=m,_[m+8>>2]=ne;while(!1);if(!R)break;y=_[d+28>>2]|0,b=23732+(y<<2)|0;do if((_[b>>2]|0)!=(d|0)){if(ne=R+16|0,_[((_[ne>>2]|0)==(d|0)?ne:R+20|0)>>2]=m,!m)break r}else{if(_[b>>2]=m,m|0)break;_[5858]=_[5858]&~(1<<y);break r}while(!1);if(_[m+24>>2]=R,y=d+16|0,b=_[y>>2]|0,b|0&&(_[m+16>>2]=b,_[b+24>>2]=m),y=_[y+4>>2]|0,!y)break;_[m+20>>2]=y,_[y+24>>2]=m}while(!1);d=d+O|0,I=O+N|0}else I=N;if(d=d+4|0,_[d>>2]=_[d>>2]&-2,_[Q+4>>2]=I|1,_[Q+I>>2]=I,d=I>>>3,I>>>0<256){y=23468+(d<<1<<2)|0,m=_[5857]|0,d=1<<d,m&d?(m=y+8|0,d=_[m>>2]|0):(_[5857]=m|d,d=y,m=y+8|0),_[m>>2]=Q,_[d+12>>2]=Q,_[Q+8>>2]=d,_[Q+12>>2]=y;break}d=I>>>8;do if(!d)b=0;else{if(I>>>0>16777215){b=31;break}fe=(d+1048320|0)>>>16&8,ne=d<<fe,ue=(ne+520192|0)>>>16&4,ne=ne<<ue,b=(ne+245760|0)>>>16&2,b=14-(ue|fe|b)+(ne<<b>>>15)|0,b=I>>>(b+7|0)&1|b<<1}while(!1);if(d=23732+(b<<2)|0,_[Q+28>>2]=b,m=Q+16|0,_[m+4>>2]=0,_[m>>2]=0,m=_[5858]|0,y=1<<b,!(m&y)){_[5858]=m|y,_[d>>2]=Q,_[Q+24>>2]=d,_[Q+12>>2]=Q,_[Q+8>>2]=Q;break}d=_[d>>2]|0;r:do if((_[d+4>>2]&-8|0)!=(I|0)){for(b=I<<((b|0)==31?0:25-(b>>>1)|0);y=d+16+(b>>>31<<2)|0,m=_[y>>2]|0,!!m;)if((_[m+4>>2]&-8|0)==(I|0)){d=m;break r}else b=b<<1,d=m;_[y>>2]=Q,_[Q+24>>2]=d,_[Q+12>>2]=Q,_[Q+8>>2]=Q;break e}while(!1);fe=d+8|0,ne=_[fe>>2]|0,_[ne+12>>2]=Q,_[fe>>2]=Q,_[Q+8>>2]=ne,_[Q+12>>2]=d,_[Q+24>>2]=0}while(!1);return ne=ot+8|0,pt=tr,ne|0}for(d=23876;m=_[d>>2]|0,!(m>>>0<=H>>>0&&(ne=m+(_[d+4>>2]|0)|0,ne>>>0>H>>>0));)d=_[d+8>>2]|0;I=ne+-47|0,m=I+8|0,m=I+(m&7|0?0-m&7:0)|0,I=H+16|0,m=m>>>0<I>>>0?H:m,d=m+8|0,y=O+-40|0,ue=R+8|0,ue=ue&7|0?0-ue&7:0,fe=R+ue|0,ue=y-ue|0,_[5863]=fe,_[5860]=ue,_[fe+4>>2]=ue|1,_[R+y+4>>2]=40,_[5864]=_[5979],y=m+4|0,_[y>>2]=27,_[d>>2]=_[5969],_[d+4>>2]=_[5970],_[d+8>>2]=_[5971],_[d+12>>2]=_[5972],_[5969]=R,_[5970]=O,_[5972]=0,_[5971]=d,d=m+24|0;do fe=d,d=d+4|0,_[d>>2]=7;while((fe+8|0)>>>0<ne>>>0);if((m|0)!=(H|0)){if(R=m-H|0,_[y>>2]=_[y>>2]&-2,_[H+4>>2]=R|1,_[m>>2]=R,d=R>>>3,R>>>0<256){y=23468+(d<<1<<2)|0,m=_[5857]|0,d=1<<d,m&d?(m=y+8|0,d=_[m>>2]|0):(_[5857]=m|d,d=y,m=y+8|0),_[m>>2]=H,_[d+12>>2]=H,_[H+8>>2]=d,_[H+12>>2]=y;break}if(d=R>>>8,d?R>>>0>16777215?b=31:(fe=(d+1048320|0)>>>16&8,ne=d<<fe,ue=(ne+520192|0)>>>16&4,ne=ne<<ue,b=(ne+245760|0)>>>16&2,b=14-(ue|fe|b)+(ne<<b>>>15)|0,b=R>>>(b+7|0)&1|b<<1):b=0,y=23732+(b<<2)|0,_[H+28>>2]=b,_[H+20>>2]=0,_[I>>2]=0,d=_[5858]|0,m=1<<b,!(d&m)){_[5858]=d|m,_[y>>2]=H,_[H+24>>2]=y,_[H+12>>2]=H,_[H+8>>2]=H;break}d=_[y>>2]|0;e:do if((_[d+4>>2]&-8|0)!=(R|0)){for(b=R<<((b|0)==31?0:25-(b>>>1)|0);y=d+16+(b>>>31<<2)|0,m=_[y>>2]|0,!!m;)if((_[m+4>>2]&-8|0)==(R|0)){d=m;break e}else b=b<<1,d=m;_[y>>2]=H,_[H+24>>2]=d,_[H+12>>2]=H,_[H+8>>2]=H;break t}while(!1);fe=d+8|0,ne=_[fe>>2]|0,_[ne+12>>2]=H,_[fe>>2]=H,_[H+8>>2]=ne,_[H+12>>2]=d,_[H+24>>2]=0}}else ne=_[5861]|0,(ne|0)==0|R>>>0<ne>>>0&&(_[5861]=R),_[5969]=R,_[5970]=O,_[5972]=0,_[5866]=_[5975],_[5865]=-1,_[5870]=23468,_[5869]=23468,_[5872]=23476,_[5871]=23476,_[5874]=23484,_[5873]=23484,_[5876]=23492,_[5875]=23492,_[5878]=23500,_[5877]=23500,_[5880]=23508,_[5879]=23508,_[5882]=23516,_[5881]=23516,_[5884]=23524,_[5883]=23524,_[5886]=23532,_[5885]=23532,_[5888]=23540,_[5887]=23540,_[5890]=23548,_[5889]=23548,_[5892]=23556,_[5891]=23556,_[5894]=23564,_[5893]=23564,_[5896]=23572,_[5895]=23572,_[5898]=23580,_[5897]=23580,_[5900]=23588,_[5899]=23588,_[5902]=23596,_[5901]=23596,_[5904]=23604,_[5903]=23604,_[5906]=23612,_[5905]=23612,_[5908]=23620,_[5907]=23620,_[5910]=23628,_[5909]=23628,_[5912]=23636,_[5911]=23636,_[5914]=23644,_[5913]=23644,_[5916]=23652,_[5915]=23652,_[5918]=23660,_[5917]=23660,_[5920]=23668,_[5919]=23668,_[5922]=23676,_[5921]=23676,_[5924]=23684,_[5923]=23684,_[5926]=23692,_[5925]=23692,_[5928]=23700,_[5927]=23700,_[5930]=23708,_[5929]=23708,_[5932]=23716,_[5931]=23716,ne=O+-40|0,ue=R+8|0,ue=ue&7|0?0-ue&7:0,fe=R+ue|0,ue=ne-ue|0,_[5863]=fe,_[5860]=ue,_[fe+4>>2]=ue|1,_[R+ne+4>>2]=40,_[5864]=_[5979];while(!1);if(d=_[5860]|0,d>>>0>At>>>0)return ue=d-At|0,_[5860]=ue,ne=_[5863]|0,fe=ne+At|0,_[5863]=fe,_[fe+4>>2]=ue|1,_[ne+4>>2]=At|3,ne=ne+8|0,pt=tr,ne|0}return ne=XP()|0,_[ne>>2]=12,ne=0,pt=tr,ne|0}function oi(m){m=m|0;var d=0,y=0,b=0,I=0,R=0,O=0,N=0,H=0;if(m){y=m+-8|0,I=_[5861]|0,m=_[m+-4>>2]|0,d=m&-8,H=y+d|0;do if(m&1)N=y,O=y;else{if(b=_[y>>2]|0,!(m&3)||(O=y+(0-b)|0,R=b+d|0,O>>>0<I>>>0))return;if((_[5862]|0)==(O|0)){if(m=H+4|0,d=_[m>>2]|0,(d&3|0)!=3){N=O,d=R;break}_[5859]=R,_[m>>2]=d&-2,_[O+4>>2]=R|1,_[O+R>>2]=R;return}if(y=b>>>3,b>>>0<256)if(m=_[O+8>>2]|0,d=_[O+12>>2]|0,(d|0)==(m|0)){_[5857]=_[5857]&~(1<<y),N=O,d=R;break}else{_[m+12>>2]=d,_[d+8>>2]=m,N=O,d=R;break}I=_[O+24>>2]|0,m=_[O+12>>2]|0;do if((m|0)==(O|0)){if(d=O+16|0,y=d+4|0,m=_[y>>2]|0,m)d=y;else if(m=_[d>>2]|0,!m){m=0;break}for(;;)if(b=m+20|0,y=_[b>>2]|0,y)m=y,d=b;else if(b=m+16|0,y=_[b>>2]|0,y)m=y,d=b;else break;_[d>>2]=0}else N=_[O+8>>2]|0,_[N+12>>2]=m,_[m+8>>2]=N;while(!1);if(I){if(d=_[O+28>>2]|0,y=23732+(d<<2)|0,(_[y>>2]|0)==(O|0)){if(_[y>>2]=m,!m){_[5858]=_[5858]&~(1<<d),N=O,d=R;break}}else if(N=I+16|0,_[((_[N>>2]|0)==(O|0)?N:I+20|0)>>2]=m,!m){N=O,d=R;break}_[m+24>>2]=I,d=O+16|0,y=_[d>>2]|0,y|0&&(_[m+16>>2]=y,_[y+24>>2]=m),d=_[d+4>>2]|0,d?(_[m+20>>2]=d,_[d+24>>2]=m,N=O,d=R):(N=O,d=R)}else N=O,d=R}while(!1);if(!(O>>>0>=H>>>0)&&(m=H+4|0,b=_[m>>2]|0,!!(b&1))){if(b&2)_[m>>2]=b&-2,_[N+4>>2]=d|1,_[O+d>>2]=d,I=d;else{if((_[5863]|0)==(H|0)){if(H=(_[5860]|0)+d|0,_[5860]=H,_[5863]=N,_[N+4>>2]=H|1,(N|0)!=(_[5862]|0))return;_[5862]=0,_[5859]=0;return}if((_[5862]|0)==(H|0)){H=(_[5859]|0)+d|0,_[5859]=H,_[5862]=O,_[N+4>>2]=H|1,_[O+H>>2]=H;return}I=(b&-8)+d|0,y=b>>>3;do if(b>>>0<256)if(d=_[H+8>>2]|0,m=_[H+12>>2]|0,(m|0)==(d|0)){_[5857]=_[5857]&~(1<<y);break}else{_[d+12>>2]=m,_[m+8>>2]=d;break}else{R=_[H+24>>2]|0,m=_[H+12>>2]|0;do if((m|0)==(H|0)){if(d=H+16|0,y=d+4|0,m=_[y>>2]|0,m)d=y;else if(m=_[d>>2]|0,!m){y=0;break}for(;;)if(b=m+20|0,y=_[b>>2]|0,y)m=y,d=b;else if(b=m+16|0,y=_[b>>2]|0,y)m=y,d=b;else break;_[d>>2]=0,y=m}else y=_[H+8>>2]|0,_[y+12>>2]=m,_[m+8>>2]=y,y=m;while(!1);if(R|0){if(m=_[H+28>>2]|0,d=23732+(m<<2)|0,(_[d>>2]|0)==(H|0)){if(_[d>>2]=y,!y){_[5858]=_[5858]&~(1<<m);break}}else if(b=R+16|0,_[((_[b>>2]|0)==(H|0)?b:R+20|0)>>2]=y,!y)break;_[y+24>>2]=R,m=H+16|0,d=_[m>>2]|0,d|0&&(_[y+16>>2]=d,_[d+24>>2]=y),m=_[m+4>>2]|0,m|0&&(_[y+20>>2]=m,_[m+24>>2]=y)}}while(!1);if(_[N+4>>2]=I|1,_[O+I>>2]=I,(N|0)==(_[5862]|0)){_[5859]=I;return}}if(m=I>>>3,I>>>0<256){y=23468+(m<<1<<2)|0,d=_[5857]|0,m=1<<m,d&m?(d=y+8|0,m=_[d>>2]|0):(_[5857]=d|m,m=y,d=y+8|0),_[d>>2]=N,_[m+12>>2]=N,_[N+8>>2]=m,_[N+12>>2]=y;return}m=I>>>8,m?I>>>0>16777215?b=31:(O=(m+1048320|0)>>>16&8,H=m<<O,R=(H+520192|0)>>>16&4,H=H<<R,b=(H+245760|0)>>>16&2,b=14-(R|O|b)+(H<<b>>>15)|0,b=I>>>(b+7|0)&1|b<<1):b=0,m=23732+(b<<2)|0,_[N+28>>2]=b,_[N+20>>2]=0,_[N+16>>2]=0,d=_[5858]|0,y=1<<b;t:do if(!(d&y))_[5858]=d|y,_[m>>2]=N,_[N+24>>2]=m,_[N+12>>2]=N,_[N+8>>2]=N;else{m=_[m>>2]|0;e:do if((_[m+4>>2]&-8|0)!=(I|0)){for(b=I<<((b|0)==31?0:25-(b>>>1)|0);y=m+16+(b>>>31<<2)|0,d=_[y>>2]|0,!!d;)if((_[d+4>>2]&-8|0)==(I|0)){m=d;break e}else b=b<<1,m=d;_[y>>2]=N,_[N+24>>2]=m,_[N+12>>2]=N,_[N+8>>2]=N;break t}while(!1);O=m+8|0,H=_[O>>2]|0,_[H+12>>2]=N,_[O>>2]=N,_[N+8>>2]=H,_[N+12>>2]=m,_[N+24>>2]=0}while(!1);if(H=(_[5865]|0)+-1|0,_[5865]=H,!(H|0)){for(m=23884;m=_[m>>2]|0,m;)m=m+8|0;_[5865]=-1}}}}function nu(m,d){m=m|0,d=d|0;var y=0;return m?(y=ha(d,m)|0,(d|m)>>>0>65535&&(y=((y>>>0)/(m>>>0)|0|0)==(d|0)?y:-1)):y=0,m=mc(y)|0,!m||!(_[m+-4>>2]&3)||Yf(m|0,0,y|0)|0,m|0}function Ii(m,d,y,b){return m=m|0,d=d|0,y=y|0,b=b|0,y=m+y>>>0,Ei(d+b+(y>>>0<m>>>0|0)>>>0|0),y|0|0}function ma(m,d,y,b){return m=m|0,d=d|0,y=y|0,b=b|0,b=d-b-(y>>>0>m>>>0|0)>>>0,Ei(b|0),m-y>>>0|0|0}function pm(m){return m=m|0,(m?31-(Gc(m^m-1)|0)|0:32)|0}function dm(m,d,y,b,I){m=m|0,d=d|0,y=y|0,b=b|0,I=I|0;var R=0,O=0,N=0,H=0,Q=0,ot=0,At=0,jt=0,Xt=0,zt=0;if(ot=m,H=d,Q=H,O=y,jt=b,N=jt,!Q)return R=(I|0)!=0,N?R?(_[I>>2]=m|0,_[I+4>>2]=d&0,jt=0,I=0,Ei(jt|0),I|0):(jt=0,I=0,Ei(jt|0),I|0):(R&&(_[I>>2]=(ot>>>0)%(O>>>0),_[I+4>>2]=0),jt=0,I=(ot>>>0)/(O>>>0)>>>0,Ei(jt|0),I|0);R=(N|0)==0;do if(O){if(!R){if(R=(Gc(N|0)|0)-(Gc(Q|0)|0)|0,R>>>0<=31){At=R+1|0,N=31-R|0,d=R-31>>31,O=At,m=ot>>>(At>>>0)&d|Q<<N,d=Q>>>(At>>>0)&d,R=0,N=ot<<N;break}return I?(_[I>>2]=m|0,_[I+4>>2]=H|d&0,jt=0,I=0,Ei(jt|0),I|0):(jt=0,I=0,Ei(jt|0),I|0)}if(R=O-1|0,R&O|0){N=(Gc(O|0)|0)+33-(Gc(Q|0)|0)|0,zt=64-N|0,At=32-N|0,H=At>>31,Xt=N-32|0,d=Xt>>31,O=N,m=At-1>>31&Q>>>(Xt>>>0)|(Q<<At|ot>>>(N>>>0))&d,d=d&Q>>>(N>>>0),R=ot<<zt&H,N=(Q<<zt|ot>>>(Xt>>>0))&H|ot<<At&N-33>>31;break}return I|0&&(_[I>>2]=R&ot,_[I+4>>2]=0),(O|0)==1?(Xt=H|d&0,zt=m|0|0,Ei(Xt|0),zt|0):(zt=pm(O|0)|0,Xt=Q>>>(zt>>>0)|0,zt=Q<<32-zt|ot>>>(zt>>>0)|0,Ei(Xt|0),zt|0)}else{if(R)return I|0&&(_[I>>2]=(Q>>>0)%(O>>>0),_[I+4>>2]=0),Xt=0,zt=(Q>>>0)/(O>>>0)>>>0,Ei(Xt|0),zt|0;if(!ot)return I|0&&(_[I>>2]=0,_[I+4>>2]=(Q>>>0)%(N>>>0)),Xt=0,zt=(Q>>>0)/(N>>>0)>>>0,Ei(Xt|0),zt|0;if(R=N-1|0,!(R&N))return I|0&&(_[I>>2]=m|0,_[I+4>>2]=R&Q|d&0),Xt=0,zt=Q>>>((pm(N|0)|0)>>>0),Ei(Xt|0),zt|0;if(R=(Gc(N|0)|0)-(Gc(Q|0)|0)|0,R>>>0<=30){d=R+1|0,N=31-R|0,O=d,m=Q<<N|ot>>>(d>>>0),d=Q>>>(d>>>0),R=0,N=ot<<N;break}return I?(_[I>>2]=m|0,_[I+4>>2]=H|d&0,Xt=0,zt=0,Ei(Xt|0),zt|0):(Xt=0,zt=0,Ei(Xt|0),zt|0)}while(!1);if(!O)Q=N,H=0,N=0;else{At=y|0|0,ot=jt|b&0,Q=Ii(At|0,ot|0,-1,-1)|0,y=St()|0,H=N,N=0;do b=H,H=R>>>31|H<<1,R=N|R<<1,b=m<<1|b>>>31|0,jt=m>>>31|d<<1|0,ma(Q|0,y|0,b|0,jt|0)|0,zt=St()|0,Xt=zt>>31|((zt|0)<0?-1:0)<<1,N=Xt&1,m=ma(b|0,jt|0,Xt&At|0,(((zt|0)<0?-1:0)>>31|((zt|0)<0?-1:0)<<1)&ot|0)|0,d=St()|0,O=O-1|0;while(O|0);Q=H,H=0}return O=0,I|0&&(_[I>>2]=m,_[I+4>>2]=d),Xt=(R|0)>>>31|(Q|O)<<1|(O<<1|R>>>31)&0|H,zt=(R<<1|0)&-2|N,Ei(Xt|0),zt|0}function Uu(m,d,y,b){m=m|0,d=d|0,y=y|0,b=b|0;var I=0,R=0,O=0,N=0,H=0,Q=0;return Q=d>>31|((d|0)<0?-1:0)<<1,H=((d|0)<0?-1:0)>>31|((d|0)<0?-1:0)<<1,R=b>>31|((b|0)<0?-1:0)<<1,I=((b|0)<0?-1:0)>>31|((b|0)<0?-1:0)<<1,N=ma(Q^m|0,H^d|0,Q|0,H|0)|0,O=St()|0,m=R^Q,d=I^H,ma((dm(N,O,ma(R^y|0,I^b|0,R|0,I|0)|0,St()|0,0)|0)^m|0,(St()|0)^d|0,m|0,d|0)|0}function P4(m,d){m=m|0,d=d|0;var y=0,b=0,I=0,R=0;return R=m&65535,I=d&65535,y=ha(I,R)|0,b=m>>>16,m=(y>>>16)+(ha(I,b)|0)|0,I=d>>>16,d=ha(I,R)|0,Ei((m>>>16)+(ha(I,b)|0)+(((m&65535)+d|0)>>>16)|0),m+d<<16|y&65535|0|0}function Jo(m,d,y,b){m=m|0,d=d|0,y=y|0,b=b|0;var I=0,R=0;return I=m,R=y,y=P4(I,R)|0,m=St()|0,Ei((ha(d,R)|0)+(ha(b,I)|0)+m|m&0|0),y|0|0|0}function Ay(m,d,y,b){m=m|0,d=d|0,y=y|0,b=b|0;var I=0,R=0,O=0,N=0,H=0,Q=0;return I=pt,pt=pt+16|0,N=I|0,O=d>>31|((d|0)<0?-1:0)<<1,R=((d|0)<0?-1:0)>>31|((d|0)<0?-1:0)<<1,Q=b>>31|((b|0)<0?-1:0)<<1,H=((b|0)<0?-1:0)>>31|((b|0)<0?-1:0)<<1,m=ma(O^m|0,R^d|0,O|0,R|0)|0,d=St()|0,dm(m,d,ma(Q^y|0,H^b|0,Q|0,H|0)|0,St()|0,N)|0,b=ma(_[N>>2]^O|0,_[N+4>>2]^R|0,O|0,R|0)|0,y=St()|0,pt=I,Ei(y|0),b|0}function Ks(m,d,y,b){m=m|0,d=d|0,y=y|0,b=b|0;var I=0,R=0;return R=pt,pt=pt+16|0,I=R|0,dm(m,d,y,b,I)|0,pt=R,Ei(_[I+4>>2]|0),_[I>>2]|0|0}function wd(m,d,y){return m=m|0,d=d|0,y=y|0,(y|0)<32?(Ei(d>>y|0),m>>>y|(d&(1<<y)-1)<<32-y):(Ei(((d|0)<0?-1:0)|0),d>>y-32|0)}function De(m,d,y){return m=m|0,d=d|0,y=y|0,(y|0)<32?(Ei(d>>>y|0),m>>>y|(d&(1<<y)-1)<<32-y):(Ei(0),d>>>y-32|0)}function Ge(m,d,y){return m=m|0,d=d|0,y=y|0,(y|0)<32?(Ei(d<<y|(m&(1<<y)-1<<32-y)>>>32-y|0),m<<y):(Ei(m<<y-32|0),0)}function mm(m,d){return m=+m,d=+d,m!=m?+d:d!=d?+m:+Ub(+m,+d)}function qb(m,d){return m=+m,d=+d,m!=m?+d:d!=d?+m:+Bh(+m,+d)}function Td(m){return m=+m,m>=0?+ss(m+.5):+cc(m-.5)}function gy(m,d,y){m=m|0,d=d|0,y=y|0;var b=0,I=0,R=0;if((y|0)>=8192)return ey(m|0,d|0,y|0)|0,m|0;if(R=m|0,I=m+y|0,(m&3)==(d&3)){for(;m&3;){if(!y)return R|0;kr[m>>0]=kr[d>>0]|0,m=m+1|0,d=d+1|0,y=y-1|0}for(y=I&-4|0,b=y-64|0;(m|0)<=(b|0);)_[m>>2]=_[d>>2],_[m+4>>2]=_[d+4>>2],_[m+8>>2]=_[d+8>>2],_[m+12>>2]=_[d+12>>2],_[m+16>>2]=_[d+16>>2],_[m+20>>2]=_[d+20>>2],_[m+24>>2]=_[d+24>>2],_[m+28>>2]=_[d+28>>2],_[m+32>>2]=_[d+32>>2],_[m+36>>2]=_[d+36>>2],_[m+40>>2]=_[d+40>>2],_[m+44>>2]=_[d+44>>2],_[m+48>>2]=_[d+48>>2],_[m+52>>2]=_[d+52>>2],_[m+56>>2]=_[d+56>>2],_[m+60>>2]=_[d+60>>2],m=m+64|0,d=d+64|0;for(;(m|0)<(y|0);)_[m>>2]=_[d>>2],m=m+4|0,d=d+4|0}else for(y=I-4|0;(m|0)<(y|0);)kr[m>>0]=kr[d>>0]|0,kr[m+1>>0]=kr[d+1>>0]|0,kr[m+2>>0]=kr[d+2>>0]|0,kr[m+3>>0]=kr[d+3>>0]|0,m=m+4|0,d=d+4|0;for(;(m|0)<(I|0);)kr[m>>0]=kr[d>>0]|0,m=m+1|0,d=d+1|0;return R|0}function Yf(m,d,y){m=m|0,d=d|0,y=y|0;var b=0,I=0,R=0,O=0;if(R=m+y|0,d=d&255,(y|0)>=67){for(;m&3;)kr[m>>0]=d,m=m+1|0;for(b=R&-4|0,O=d|d<<8|d<<16|d<<24,I=b-64|0;(m|0)<=(I|0);)_[m>>2]=O,_[m+4>>2]=O,_[m+8>>2]=O,_[m+12>>2]=O,_[m+16>>2]=O,_[m+20>>2]=O,_[m+24>>2]=O,_[m+28>>2]=O,_[m+32>>2]=O,_[m+36>>2]=O,_[m+40>>2]=O,_[m+44>>2]=O,_[m+48>>2]=O,_[m+52>>2]=O,_[m+56>>2]=O,_[m+60>>2]=O,m=m+64|0;for(;(m|0)<(b|0);)_[m>>2]=O,m=m+4|0}for(;(m|0)<(R|0);)kr[m>>0]=d,m=m+1|0;return R-y|0}function Yb(m){return m=+m,m>=0?+ss(m+.5):+cc(m-.5)}function jh(m){m=m|0;var d=0,y=0,b=0;return b=ty()|0,y=_[Wr>>2]|0,d=y+m|0,(m|0)>0&(d|0)<(y|0)|(d|0)<0?(rm(d|0)|0,em(12),-1):(d|0)>(b|0)&&!(dd(d|0)|0)?(em(12),-1):(_[Wr>>2]=d,y|0)}return{___divdi3:Uu,___muldi3:Jo,___remdi3:Ay,___uremdi3:Ks,_areNeighborCells:cy,_bitshift64Ashr:wd,_bitshift64Lshr:De,_bitshift64Shl:Ge,_calloc:nu,_cellAreaKm2:Ci,_cellAreaM2:fi,_cellAreaRads2:dn,_cellToBoundary:J,_cellToCenterChild:mg,_cellToChildPos:Rt,_cellToChildren:vd,_cellToChildrenSize:ru,_cellToLatLng:G,_cellToLocalIj:Fu,_cellToParent:Xn,_cellToVertex:Ll,_cellToVertexes:Vs,_cellsToDirectedEdge:ka,_cellsToLinkedMultiPolygon:Pa,_childPosToCell:yt,_compactCells:Ag,_destroyLinkedMultiPolygon:Ss,_directedEdgeToBoundary:xd,_directedEdgeToCells:uy,_edgeLengthKm:Ts,_edgeLengthM:Un,_edgeLengthRads:Oi,_emscripten_replace_memory:ry,_free:oi,_getBaseCellNumber:Lu,_getDirectedEdgeDestination:cm,_getDirectedEdgeOrigin:Yn,_getHexagonAreaAvgKm2:Le,_getHexagonAreaAvgM2:hr,_getHexagonEdgeLengthAvgKm:Di,_getHexagonEdgeLengthAvgM:He,_getIcosahedronFaces:lt,_getNumCells:Cr,_getPentagons:bt,_getRes0Cells:Jc,_getResolution:fy,_greatCircleDistanceKm:ce,_greatCircleDistanceM:xe,_greatCircleDistanceRads:he,_gridDisk:Ad,_gridDiskDistances:Du,_gridDistance:Wf,_gridPathCells:wo,_gridPathCellsSize:Vo,_gridRingUnsafe:iy,_i64Add:Ii,_i64Subtract:ma,_isPentagon:Sn,_isResClassIII:_g,_isValidCell:Kn,_isValidDirectedEdge:dg,_isValidVertex:I4,_latLngToCell:U,_llvm_maxnum_f64:mm,_llvm_minnum_f64:qb,_llvm_round_f64:Td,_localIjToCell:zh,_malloc:mc,_maxFaceCount:tt,_maxGridDiskSize:md,_maxPolygonToCellsSize:ny,_memcpy:gy,_memset:Yf,_originToDirectedEdges:hy,_pentagonCount:wt,_polygonToCells:uc,_readInt64AsDoubleFromPointer:dc,_res0CellCount:Kc,_round:Yb,_sbrk:jh,_sizeOfCellBoundary:fm,_sizeOfCoordIJ:yg,_sizeOfGeoLoop:py,_sizeOfGeoPolygon:dy,_sizeOfH3Index:Is,_sizeOfLatLng:Uh,_sizeOfLinkedGeoPolygon:Wb,_uncompactCells:jf,_uncompactCellsSize:gg,_vertexToLatLng:$b,establishStackSpace:Nf,stackAlloc:fs,stackRestore:fa,stackSave:Nh}}(Dt,Ot,$t),Yt=t.___divdi3=It.___divdi3,Ft=t.___muldi3=It.___muldi3,Qt=t.___remdi3=It.___remdi3,_e=t.___uremdi3=It.___uremdi3,ye=t._areNeighborCells=It._areNeighborCells,be=t._bitshift64Ashr=It._bitshift64Ashr,br=t._bitshift64Lshr=It._bitshift64Lshr,Lr=t._bitshift64Shl=It._bitshift64Shl,cr=t._calloc=It._calloc,vr=t._cellAreaKm2=It._cellAreaKm2,jr=t._cellAreaM2=It._cellAreaM2,ln=t._cellAreaRads2=It._cellAreaRads2,yn=t._cellToBoundary=It._cellToBoundary,Vi=t._cellToCenterChild=It._cellToCenterChild,Ai=t._cellToChildPos=It._cellToChildPos,Ps=t._cellToChildren=It._cellToChildren,pn=t._cellToChildrenSize=It._cellToChildrenSize,ns=t._cellToLatLng=It._cellToLatLng,zs=t._cellToLocalIj=It._cellToLocalIj,Ca=t._cellToParent=It._cellToParent,HA=t._cellToVertex=It._cellToVertex,sc=t._cellToVertexes=It._cellToVertexes,oo=t._cellsToDirectedEdge=It._cellsToDirectedEdge,kh=t._cellsToLinkedMultiPolygon=It._cellsToLinkedMultiPolygon,Hi=t._childPosToCell=It._childPosToCell,sl=t._compactCells=It._compactCells,Xc=t._destroyLinkedMultiPolygon=It._destroyLinkedMultiPolygon,Hn=t._directedEdgeToBoundary=It._directedEdgeToBoundary,bs=t._directedEdgeToCells=It._directedEdgeToCells,qA=t._edgeLengthKm=It._edgeLengthKm,ca=t._edgeLengthM=It._edgeLengthM,Rs=t._edgeLengthRads=It._edgeLengthRads,Uo=t._emscripten_replace_memory=It._emscripten_replace_memory,oc=t._free=It._free,zn=t._getBaseCellNumber=It._getBaseCellNumber,tn=t._getDirectedEdgeDestination=It._getDirectedEdgeDestination,ac=t._getDirectedEdgeOrigin=It._getDirectedEdgeOrigin,qn=t._getHexagonAreaAvgKm2=It._getHexagonAreaAvgKm2,Ru=t._getHexagonAreaAvgM2=It._getHexagonAreaAvgM2,ks=t._getHexagonEdgeLengthAvgKm=It._getHexagonEdgeLengthAvgKm,Z0=t._getHexagonEdgeLengthAvgM=It._getHexagonEdgeLengthAvgM,lc=t._getIcosahedronFaces=It._getIcosahedronFaces,ad=t._getNumCells=It._getNumCells,ld=t._getPentagons=It._getPentagons,cd=t._getRes0Cells=It._getRes0Cells,ud=t._getResolution=It._getResolution,ut=t._greatCircleDistanceKm=It._greatCircleDistanceKm,gt=t._greatCircleDistanceM=It._greatCircleDistanceM,Wt=t._greatCircleDistanceRads=It._greatCircleDistanceRads,pe=t._gridDisk=It._gridDisk,Be=t._gridDiskDistances=It._gridDiskDistances,lr=t._gridDistance=It._gridDistance,ki=t._gridPathCells=It._gridPathCells,Us=t._gridPathCellsSize=It._gridPathCellsSize,ao=t._gridRingUnsafe=It._gridRingUnsafe,bo=t._i64Add=It._i64Add,ol=t._i64Subtract=It._i64Subtract,YA=t._isPentagon=It._isPentagon,Bb=t._isResClassIII=It._isResClassIII,Nb=t._isValidCell=It._isValidCell,q_=t._isValidDirectedEdge=It._isValidDirectedEdge,Y_=t._isValidVertex=It._isValidVertex,Df=t._latLngToCell=It._latLngToCell,XA=t._llvm_maxnum_f64=It._llvm_maxnum_f64,Dl=t._llvm_minnum_f64=It._llvm_minnum_f64,ZA=t._llvm_round_f64=It._llvm_round_f64,GA=t._localIjToCell=It._localIjToCell,G0=t._malloc=It._malloc,QA=t._maxFaceCount=It._maxFaceCount,hd=t._maxGridDiskSize=It._maxGridDiskSize,Dh=t._maxPolygonToCellsSize=It._maxPolygonToCellsSize,Xi=t._memcpy=It._memcpy,KA=t._memset=It._memset,al=t._originToDirectedEdges=It._originToDirectedEdges,ll=t._pentagonCount=It._pentagonCount,X_=t._polygonToCells=It._polygonToCells,JA=t._readInt64AsDoubleFromPointer=It._readInt64AsDoubleFromPointer,tg=t._res0CellCount=It._res0CellCount,Z_=t._round=It._round,G_=t._sbrk=It._sbrk,eg=t._sizeOfCellBoundary=It._sizeOfCellBoundary,Q_=t._sizeOfCoordIJ=It._sizeOfCoordIJ,K_=t._sizeOfGeoLoop=It._sizeOfGeoLoop,rg=t._sizeOfGeoPolygon=It._sizeOfGeoPolygon,Lb=t._sizeOfH3Index=It._sizeOfH3Index,Fb=t._sizeOfLatLng=It._sizeOfLatLng,fd=t._sizeOfLinkedGeoPolygon=It._sizeOfLinkedGeoPolygon,w4=t._uncompactCells=It._uncompactCells,T4=t._uncompactCellsSize=It._uncompactCellsSize,S4=t._vertexToLatLng=It._vertexToLatLng,E4=t.establishStackSpace=It.establishStackSpace,J_=t.stackAlloc=It.stackAlloc,zb=t.stackRestore=It.stackRestore,ig=t.stackSave=It.stackSave;if(t.asm=It,t.cwrap=q,t.setValue=B,t.getValue=L,Zo){rl(Zo)||(Zo=o(Zo));{Pu("memory initializer");var Of=function(oe){oe.byteLength&&(oe=new Uint8Array(oe)),Vt.set(oe,C),t.memoryInitializerRequest&&delete t.memoryInitializerRequest.response,Rl("memory initializer")},Q0=function(){a(Zo,Of,function(){throw"could not load memory initializer "+Zo})},K0=mt(Zo);if(K0)Of(K0.buffer);else if(t.memoryInitializerRequest){var Oh=function(){var oe=t.memoryInitializerRequest,we=oe.response;if(oe.status!==200&&oe.status!==0){var We=mt(t.memoryInitializerRequestURL);if(We)we=We.buffer;else{console.warn("a problem seems to have happened with Module.memoryInitializerRequest, status: "+oe.status+", retrying "+Zo),Q0();return}}Of(we)};t.memoryInitializerRequest.response?setTimeout(Oh,0):t.memoryInitializerRequest.addEventListener("load",Oh)}else Q0()}}var pd;zo=function oe(){pd||J0(),pd||(zo=oe)};function J0(oe){if(oe=oe||s,Ji>0||($r(),Ji>0))return;function we(){pd||(pd=!0,!z&&(Ie(),en(),t.onRuntimeInitialized&&t.onRuntimeInitialized(),xi()))}t.setStatus?(t.setStatus("Running..."),setTimeout(function(){setTimeout(function(){t.setStatus("")},1),we()},1)):we()}t.run=J0;function Zc(oe){throw t.onAbort&&t.onAbort(oe),oe+="",h(oe),p(oe),z=!0,"abort("+oe+"). Build with -s ASSERTIONS=1 for more info."}if(t.abort=Zc,t.preInit)for(typeof t.preInit=="function"&&(t.preInit=[t.preInit]);t.preInit.length>0;)t.preInit.pop()();return J0(),e}(typeof Ae=="object"?Ae:{}),ji="number",pi=ji,m3=ji,bi=ji,vi=ji,xl=ji,Mr=ji,Pbt=[["sizeOfH3Index",ji],["sizeOfLatLng",ji],["sizeOfCellBoundary",ji],["sizeOfGeoLoop",ji],["sizeOfGeoPolygon",ji],["sizeOfLinkedGeoPolygon",ji],["sizeOfCoordIJ",ji],["readInt64AsDoubleFromPointer",ji],["isValidCell",m3,[bi,vi]],["latLngToCell",pi,[ji,ji,xl,Mr]],["cellToLatLng",pi,[bi,vi,Mr]],["cellToBoundary",pi,[bi,vi,Mr]],["maxGridDiskSize",pi,[ji,Mr]],["gridDisk",pi,[bi,vi,ji,Mr]],["gridDiskDistances",pi,[bi,vi,ji,Mr,Mr]],["gridRingUnsafe",pi,[bi,vi,ji,Mr]],["maxPolygonToCellsSize",pi,[Mr,xl,ji,Mr]],["polygonToCells",pi,[Mr,xl,ji,Mr]],["cellsToLinkedMultiPolygon",pi,[Mr,ji,Mr]],["destroyLinkedMultiPolygon",null,[Mr]],["compactCells",pi,[Mr,Mr,ji,ji]],["uncompactCells",pi,[Mr,ji,ji,Mr,ji,xl]],["uncompactCellsSize",pi,[Mr,ji,ji,xl,Mr]],["isPentagon",m3,[bi,vi]],["isResClassIII",m3,[bi,vi]],["getBaseCellNumber",ji,[bi,vi]],["getResolution",ji,[bi,vi]],["maxFaceCount",pi,[bi,vi,Mr]],["getIcosahedronFaces",pi,[bi,vi,Mr]],["cellToParent",pi,[bi,vi,xl,Mr]],["cellToChildren",pi,[bi,vi,xl,Mr]],["cellToCenterChild",pi,[bi,vi,xl,Mr]],["cellToChildrenSize",pi,[bi,vi,xl,Mr]],["cellToChildPos",pi,[bi,vi,xl,Mr]],["childPosToCell",pi,[ji,ji,bi,vi,xl,Mr]],["areNeighborCells",pi,[bi,vi,bi,vi,Mr]],["cellsToDirectedEdge",pi,[bi,vi,bi,vi,Mr]],["getDirectedEdgeOrigin",pi,[bi,vi,Mr]],["getDirectedEdgeDestination",pi,[bi,vi,Mr]],["isValidDirectedEdge",m3,[bi,vi]],["directedEdgeToCells",pi,[bi,vi,Mr]],["originToDirectedEdges",pi,[bi,vi,Mr]],["directedEdgeToBoundary",pi,[bi,vi,Mr]],["gridDistance",pi,[bi,vi,bi,vi,Mr]],["gridPathCells",pi,[bi,vi,bi,vi,Mr]],["gridPathCellsSize",pi,[bi,vi,bi,vi,Mr]],["cellToLocalIj",pi,[bi,vi,bi,vi,ji,Mr]],["localIjToCell",pi,[bi,vi,Mr,ji,Mr]],["getHexagonAreaAvgM2",pi,[xl,Mr]],["getHexagonAreaAvgKm2",pi,[xl,Mr]],["getHexagonEdgeLengthAvgM",pi,[xl,Mr]],["getHexagonEdgeLengthAvgKm",pi,[xl,Mr]],["greatCircleDistanceM",ji,[Mr,Mr]],["greatCircleDistanceKm",ji,[Mr,Mr]],["greatCircleDistanceRads",ji,[Mr,Mr]],["cellAreaM2",pi,[bi,vi,Mr]],["cellAreaKm2",pi,[bi,vi,Mr]],["cellAreaRads2",pi,[bi,vi,Mr]],["edgeLengthM",pi,[bi,vi,Mr]],["edgeLengthKm",pi,[bi,vi,Mr]],["edgeLengthRads",pi,[bi,vi,Mr]],["getNumCells",pi,[xl,Mr]],["getRes0Cells",pi,[Mr]],["res0CellCount",ji],["getPentagons",pi,[ji,Mr]],["pentagonCount",ji],["cellToVertex",pi,[bi,vi,ji,Mr]],["cellToVertexes",pi,[bi,vi,Mr]],["vertexToLatLng",pi,[bi,vi,Mr]],["isValidVertex",m3,[bi,vi]]],Rbt=0,kbt=1,Dbt=2,Obt=3,PX=4,RX=5,Bbt=6,Nbt=7,Lbt=8,Fbt=9,zbt=10,Ubt=11,Vbt=12,jbt=13,Wbt=14,$bt=15,Wa={};Wa[Rbt]="Success";Wa[kbt]="The operation failed but a more specific error is not available";Wa[Dbt]="Argument was outside of acceptable range";Wa[Obt]="Latitude or longitude arguments were outside of acceptable range";Wa[PX]="Resolution argument was outside of acceptable range";Wa[RX]="Cell argument was not valid";Wa[Bbt]="Directed edge argument was not valid";Wa[Nbt]="Undirected edge argument was not valid";Wa[Lbt]="Vertex argument was not valid";Wa[Fbt]="Pentagon distortion was encountered";Wa[zbt]="Duplicate input";Wa[Ubt]="Cell arguments were not neighbors";Wa[Vbt]="Cell arguments had incompatible resolutions";Wa[jbt]="Memory allocation failed";Wa[Wbt]="Bounds of provided memory were insufficient";Wa[$bt]="Mode or flags argument was not valid";var b2=1e3,kX=1001,DX=1002,m6={};m6[b2]="Unknown unit";m6[kX]="Array length out of bounds";m6[DX]="Got unexpected null value for H3 index";var Hbt="Unknown error";function OX(e,t,r){var i=r&&"value"in r,s=new Error((e[t]||Hbt)+" (code: "+t+(i?", value: "+r.value:"")+")");return s.code=t,s}function PO(e,t){var r=arguments.length===2?{value:t}:{};return OX(Wa,e,r)}function f1(e,t){var r=arguments.length===2?{value:t}:{};return OX(m6,e,r)}function di(e){if(e!==0)throw PO(e)}var ar={};Pbt.forEach(function(t){ar[t[0]]=Ae.cwrap.apply(Ae,t)});var x2=16,p6=0,ql=4,EX=4,fu=8,Hd=8,ms=ar.sizeOfH3Index(),g3=ar.sizeOfLatLng(),BX=ar.sizeOfCellBoundary(),qbt=ar.sizeOfGeoPolygon(),A3=ar.sizeOfGeoLoop(),Ybt=ar.sizeOfLinkedGeoPolygon(),NX=ar.sizeOfCoordIJ(),Ic={m:"m",m2:"m2",km:"km",km2:"km2",rads:"rads",rads2:"rads2"};function v2(e){if(typeof e!="number"||e<0||e>15||Math.floor(e)!==e)throw PO(PX,e);return e}function qd(e){if(!e)throw f1(DX);return e}var Xbt=Math.pow(2,32)-1;function w2(e){if(e>Xbt)throw f1(kX,e);return e}var Zbt=/[^0-9a-fA-F]/;function Yi(e){if(Array.isArray(e)&&e.length===2&&Number.isInteger(e[0])&&Number.isInteger(e[1]))return e;if(typeof e!="string"||Zbt.test(e))return[0,0];var t=parseInt(e.substring(0,e.length-8),x2),r=parseInt(e.substring(e.length-8),x2);return[r,t]}function IX(e){if(e>=0)return e.toString(x2);e=e&2147483647;var t=FX(8,e.toString(x2)),r=(parseInt(t[0],x2)+8).toString(x2);return t=r+t.substring(1),t}function LX(e,t){return IX(t)+FX(8,IX(e))}function FX(e,t){for(var r=e-t.length,i="",s=0;s<r;s++)i+="0";return i=i+t,i}var Gbt=Math.pow(2,32);function Qbt(e){return typeof e!="number"?[0,0]:[e|0,e/Gbt|0]}function MX(e,t,r){for(var i=e.length,s=Ae._calloc(i,g3),n=r?1:0,o=r?0:1,a=0;a<i*2;a+=2)Ae.HEAPF64.set([e[a/2][n],e[a/2][o]].map(_6),s/fu+a);return Ae.HEAPU32.set([i,s],t/ql),t}function Kbt(e,t){var r=e.length-1,i=Ae._calloc(qbt),s=0,n=s+A3,o=n+ql;MX(e[0],i+s,t);var a;if(r>0){a=Ae._calloc(r,A3);for(var h=0;h<r;h++)MX(e[h+1],a+A3*h,t)}return Ae.setValue(i+n,r,"i32"),Ae.setValue(i+o,a,"i32"),i}function Jbt(e){var t=0,r=t+A3,i=r+ql,s=ql;Ae._free(Ae.getValue(e+t+s,"i8*"));var n=Ae.getValue(e+r,"i32");if(n>0){for(var o=Ae.getValue(e+i,"i32"),a=0;a<n;a++)Ae._free(Ae.getValue(o+A3*a+s,"i8*"));Ae._free(o)}Ae._free(e)}function nf(e,t){t===void 0&&(t=0);var r=Ae.getValue(e+ms*t,"i32"),i=Ae.getValue(e+ms*t+ql,"i32");return i?LX(r,i):null}function tvt(e,t){t===void 0&&(t=0);var r=Ae.getValue(e+ql*t,"i32");return!!r}function A6(e,t){return t===void 0&&(t=0),Ae.getValue(e+fu*t,"double")}function Yd(e){return ar.readInt64AsDoubleFromPointer(e)}function evt(e,t,r){Ae.HEAPU32.set(Yi(e),t/ql+2*r)}function th(e,t){for(var r=[],i=0;i<t;i++){var s=nf(e,i);s!==null&&r.push(s)}return r}function RO(e,t){for(var r=t.length,i=0;i<r;i++)evt(t[i],e,i)}function CX(e,t){var r=Ae._calloc(1,g3);return Ae.HEAPF64.set([e,t].map(_6),r/fu),r}function d6(e){return WX(Ae.getValue(e,"double"))}function g6(e){return[d6(e),d6(e+fu)]}function zX(e){return[d6(e+fu),d6(e)]}function UX(e,t,r){for(var i=Ae.getValue(e,"i32"),s=e+fu,n=[],o=t?zX:g6,a=0;a<i*2;a+=2)n.push(o(s+fu*a));return r&&n.push(n[0]),n}function rvt(e,t){for(var r=[],i=t?zX:g6,s,n,o,a;e;){for(r.push(s=[]),n=Ae.getValue(e,"i8*");n;){for(s.push(o=[]),a=Ae.getValue(n,"i8*");a;)o.push(i(a)),a=Ae.getValue(a+fu*2,"i8*");t&&o.push(o[0]),n=Ae.getValue(n+EX*2,"i8*")}e=Ae.getValue(e+EX*2,"i8*")}return r}function ivt(e){return{i:Ae.getValue(e,"i32"),j:Ae.getValue(e+ql,"i32")}}function nvt(e,t){var r=t.i,i=t.j;Ae.setValue(e,r,"i32"),Ae.setValue(e+ql,i,"i32")}function svt(e,t){for(var r=[],i=0;i<t;i++){var s=Ae.getValue(e+ql*i,"i32");s>=0&&r.push(s)}return r}function kO(e){var t=Yi(e),r=t[0],i=t[1];return!!ar.isValidCell(r,i)}function DO(e){var t=Yi(e),r=t[0],i=t[1];return!!ar.isPentagon(r,i)}function ovt(e){var t=Yi(e),r=t[0],i=t[1];return!!ar.isResClassIII(r,i)}function avt(e){var t=Yi(e),r=t[0],i=t[1];return ar.getBaseCellNumber(r,i)}function lvt(e){var t=Yi(e),r=t[0],i=t[1],s=Ae._malloc(ql);try{di(ar.maxFaceCount(r,i,s));var n=Ae.getValue(s,"i32"),o=Ae._malloc(ql*n);try{return di(ar.getIcosahedronFaces(r,i,o)),svt(o,n)}finally{Ae._free(o)}}finally{Ae._free(s)}}function fp(e){var t=Yi(e),r=t[0],i=t[1];return ar.isValidCell(r,i)?ar.getResolution(r,i):-1}function _3(e,t,r){var i=Ae._malloc(g3);Ae.HEAPF64.set([e,t].map(_6),i/fu);var s=Ae._malloc(ms);try{return di(ar.latLngToCell(i,r,s)),qd(nf(s))}finally{Ae._free(s),Ae._free(i)}}function T2(e){var t=Ae._malloc(g3),r=Yi(e),i=r[0],s=r[1];try{return di(ar.cellToLatLng(i,s,t)),g6(t)}finally{Ae._free(t)}}function OO(e,t){var r=Ae._malloc(BX),i=Yi(e),s=i[0],n=i[1];try{return di(ar.cellToBoundary(s,n,r)),UX(r,t,t)}finally{Ae._free(r)}}function BO(e,t){var r=Yi(e),i=r[0],s=r[1],n=Ae._malloc(ms);try{return di(ar.cellToParent(i,s,t,n)),qd(nf(n))}finally{Ae._free(n)}}function cvt(e,t){if(!kO(e))return[];var r=Yi(e),i=r[0],s=r[1],n=w2(VX(e,t)),o=Ae._calloc(n,ms);try{return di(ar.cellToChildren(i,s,t,o)),th(o,n)}finally{Ae._free(o)}}function VX(e,t){if(!kO(e))throw PO(RX);var r=Yi(e),i=r[0],s=r[1],n=Ae._malloc(Hd);try{return di(ar.cellToChildrenSize(i,s,t,n)),Yd(n)}finally{Ae._free(n)}}function uvt(e,t){var r=Yi(e),i=r[0],s=r[1],n=Ae._malloc(ms);try{return di(ar.cellToCenterChild(i,s,t,n)),qd(nf(n))}finally{Ae._free(n)}}function hvt(e,t){var r=Yi(e),i=r[0],s=r[1],n=Ae._malloc(Hd);try{return di(ar.cellToChildPos(i,s,t,n)),Yd(n)}finally{Ae._free(n)}}function fvt(e,t,r){var i=Qbt(e),s=i[0],n=i[1],o=Yi(t),a=o[0],h=o[1],p=Ae._malloc(ms);try{return di(ar.childPosToCell(s,n,a,h,r,p)),qd(nf(p))}finally{Ae._free(p)}}function y3(e,t){var r=Yi(e),i=r[0],s=r[1],n=Ae._malloc(Hd);try{di(ar.maxGridDiskSize(t,n));var o=w2(Yd(n)),a=Ae._calloc(o,ms);try{return di(ar.gridDisk(i,s,t,a)),th(a,o)}finally{Ae._free(a)}}finally{Ae._free(n)}}function pvt(e,t){var r=Yi(e),i=r[0],s=r[1],n=Ae._malloc(Hd);try{di(ar.maxGridDiskSize(t,n));var o=w2(Yd(n)),a=Ae._calloc(o,ms),h=Ae._calloc(o,ql);try{di(ar.gridDiskDistances(i,s,t,a,h));for(var p=[],g=0;g<t+1;g++)p.push([]);for(var v=0;v<o;v++){var T=nf(a,v),C=Ae.getValue(h+ql*v,"i32");T!==null&&p[C].push(T)}return p}finally{Ae._free(a),Ae._free(h)}}finally{Ae._free(n)}}function dvt(e,t){var r=t===0?1:6*t,i=Ae._calloc(r,ms);try{return di(ar.gridRingUnsafe.apply(ar,Yi(e).concat([t],[i]))),th(i,r)}finally{Ae._free(i)}}function mvt(e,t,r){if(v2(t),r=!!r,e.length===0||e[0].length===0)return[];var i=typeof e[0][0]=="number"?[e]:e,s=Kbt(i,r),n=Ae._malloc(Hd);try{di(ar.maxPolygonToCellsSize(s,t,0,n));var o=w2(Yd(n)),a=Ae._calloc(o,ms);try{return di(ar.polygonToCells(s,t,0,a)),th(a,o)}finally{Ae._free(a)}}finally{Ae._free(n),Jbt(s)}}function Avt(e,t){if(!e||!e.length)return[];var r=e.length,i=Ae._calloc(r,ms);RO(i,e);var s=Ae._calloc(Ybt);try{return di(ar.cellsToLinkedMultiPolygon(i,r,s)),rvt(s,t)}finally{ar.destroyLinkedMultiPolygon(s),Ae._free(s),Ae._free(i)}}function gvt(e){if(!e||!e.length)return[];var t=e.length,r=Ae._calloc(t,ms);RO(r,e);var i=Ae._calloc(t,ms);try{return di(ar.compactCells(r,i,t,p6)),th(i,t)}finally{Ae._free(r),Ae._free(i)}}function _vt(e,t){if(v2(t),!e||!e.length)return[];var r=e.length,i=Ae._calloc(r,ms);RO(i,e);var s=Ae._malloc(Hd);try{di(ar.uncompactCellsSize(i,r,p6,t,s));var n=w2(Yd(s)),o=Ae._calloc(n,ms);try{return di(ar.uncompactCells(i,r,p6,o,n,p6,t)),th(o,n)}finally{Ae._free(i),Ae._free(o)}}finally{Ae._free(s)}}function yvt(e,t){var r=Yi(e),i=r[0],s=r[1],n=Yi(t),o=n[0],a=n[1],h=Ae._malloc(ql);try{return di(ar.areNeighborCells(i,s,o,a,h)),tvt(h)}finally{Ae._free(h)}}function xvt(e,t){var r=Yi(e),i=r[0],s=r[1],n=Yi(t),o=n[0],a=n[1],h=Ae._malloc(ms);try{return di(ar.cellsToDirectedEdge(i,s,o,a,h)),qd(nf(h))}finally{Ae._free(h)}}function bvt(e){var t=Yi(e),r=t[0],i=t[1],s=Ae._malloc(ms);try{return di(ar.getDirectedEdgeOrigin(r,i,s)),qd(nf(s))}finally{Ae._free(s)}}function vvt(e){var t=Yi(e),r=t[0],i=t[1],s=Ae._malloc(ms);try{return di(ar.getDirectedEdgeDestination(r,i,s)),qd(nf(s))}finally{Ae._free(s)}}function wvt(e){var t=Yi(e),r=t[0],i=t[1];return!!ar.isValidDirectedEdge(r,i)}function Tvt(e){var t=Yi(e),r=t[0],i=t[1],s=2,n=Ae._calloc(s,ms);try{return di(ar.directedEdgeToCells(r,i,n)),th(n,s)}finally{Ae._free(n)}}function Svt(e){var t=Yi(e),r=t[0],i=t[1],s=6,n=Ae._calloc(s,ms);try{return di(ar.originToDirectedEdges(r,i,n)),th(n,s)}finally{Ae._free(n)}}function Evt(e,t){var r=Ae._malloc(BX),i=Yi(e),s=i[0],n=i[1];try{return di(ar.directedEdgeToBoundary(s,n,r)),UX(r,t)}finally{Ae._free(r)}}function S2(e,t){var r=Yi(e),i=r[0],s=r[1],n=Yi(t),o=n[0],a=n[1],h=Ae._malloc(Hd);try{return di(ar.gridDistance(i,s,o,a,h)),Yd(h)}finally{Ae._free(h)}}function Ivt(e,t){var r=Yi(e),i=r[0],s=r[1],n=Yi(t),o=n[0],a=n[1],h=Ae._malloc(Hd);try{di(ar.gridPathCellsSize(i,s,o,a,h));var p=w2(Yd(h)),g=Ae._calloc(p,ms);try{return ar.gridPathCells(i,s,o,a,g),th(g,p)}finally{Ae._free(g)}}finally{Ae._free(h)}}var jX=0;function Mvt(e,t){var r=Ae._malloc(NX);try{return di(ar.cellToLocalIj.apply(ar,Yi(e).concat(Yi(t),[jX],[r]))),ivt(r)}finally{Ae._free(r)}}function Cvt(e,t){if(!t||typeof t.i!="number"||typeof t.j!="number")throw new Error("Coordinates must be provided as an {i, j} object");var r=Ae._malloc(NX),i=Ae._malloc(ms);nvt(r,t);try{return di(ar.localIjToCell.apply(ar,Yi(e).concat([r],[jX],[i]))),qd(nf(i))}finally{Ae._free(r),Ae._free(i)}}function Pvt(e,t,r){var i=CX(e[0],e[1]),s=CX(t[0],t[1]),n;switch(r){case Ic.m:n=ar.greatCircleDistanceM(i,s);break;case Ic.km:n=ar.greatCircleDistanceKm(i,s);break;case Ic.rads:n=ar.greatCircleDistanceRads(i,s);break;default:n=null}if(Ae._free(i),Ae._free(s),n===null)throw f1(b2,r);return n}function Rvt(e,t){var r=Yi(e),i=r[0],s=r[1],n=Ae._malloc(fu);try{switch(t){case Ic.m2:di(ar.cellAreaM2(i,s,n));break;case Ic.km2:di(ar.cellAreaKm2(i,s,n));break;case Ic.rads2:di(ar.cellAreaRads2(i,s,n));break;default:throw f1(b2,t)}return A6(n)}finally{Ae._free(n)}}function kvt(e,t){var r=Yi(e),i=r[0],s=r[1],n=Ae._malloc(fu);try{switch(t){case Ic.m:di(ar.edgeLengthM(i,s,n));break;case Ic.km:di(ar.edgeLengthKm(i,s,n));break;case Ic.rads:di(ar.edgeLengthRads(i,s,n));break;default:throw f1(b2,t)}return A6(n)}finally{Ae._free(n)}}function NO(e,t){v2(e);var r=Ae._malloc(fu);try{switch(t){case Ic.m2:di(ar.getHexagonAreaAvgM2(e,r));break;case Ic.km2:di(ar.getHexagonAreaAvgKm2(e,r));break;default:throw f1(b2,t)}return A6(r)}finally{Ae._free(r)}}function x3(e,t){v2(e);var r=Ae._malloc(fu);try{switch(t){case Ic.m:di(ar.getHexagonEdgeLengthAvgM(e,r));break;case Ic.km:di(ar.getHexagonEdgeLengthAvgKm(e,r));break;default:throw f1(b2,t)}return A6(r)}finally{Ae._free(r)}}function Dvt(e,t){var r=Yi(e),i=r[0],s=r[1],n=Ae._malloc(ms);try{return di(ar.cellToVertex(i,s,t,n)),qd(nf(n))}finally{Ae._free(n)}}function Ovt(e){var t=Yi(e),r=t[0],i=t[1],s=6,n=Ae._calloc(s,ms);try{return di(ar.cellToVertexes(r,i,n)),th(n,s)}finally{Ae._free(n)}}function Bvt(e){var t=Ae._malloc(g3),r=Yi(e),i=r[0],s=r[1];try{return di(ar.vertexToLatLng(i,s,t)),g6(t)}finally{Ae._free(t)}}function Nvt(e){var t=Yi(e),r=t[0],i=t[1];return!!ar.isValidVertex(r,i)}function Lvt(e){v2(e);var t=Ae._malloc(Hd);try{return di(ar.getNumCells(e,t)),Yd(t)}finally{Ae._free(t)}}function Fvt(){var e=ar.res0CellCount(),t=Ae._malloc(ms*e);try{return di(ar.getRes0Cells(t)),th(t,e)}finally{Ae._free(t)}}function zvt(e){v2(e);var t=ar.pentagonCount(),r=Ae._malloc(ms*t);try{return di(ar.getPentagons(e,r)),th(r,t)}finally{Ae._free(r)}}function _6(e){return e*Math.PI/180}function WX(e){return e*180/Math.PI}function $X(e,t){t=t===void 0?e[0][0]:t;for(let r of e){let i=r[0]-t;i>180?r[0]-=360:i<-180&&(r[0]+=360)}}function Uvt(e,t,r){let[i,s]=T2(e),n=t.length;$X(t,s);let o=t[0]===t[n-1]?n-1:n;for(let a=0;a<o;a++)t[a][0]=yc(s,t[a][0],r),t[a][1]=yc(i,t[a][1],r)}function HX(e,t,r){let i=e(t,r),[s,n]=T2(i);return[n,s]}function FO(e,t=1){let r=OO(e,!0);return t!==1?Uvt(e,r,t):$X(r),r}function qX(e){let t=new Float64Array(e.length*2),r=0;for(let i of e)t[r++]=i[0],t[r++]=i[1];return t}var Vvt=10;function jvt(e,t){let r;return e==null?r=t:typeof e=="object"?r={...e,coverage:t}:r={getHexagon:e,coverage:t},r}var Wvt={...u1.defaultProps,highPrecision:"auto",coverage:{type:"number",min:0,max:1,value:1},centerHexagon:null,getHexagon:{type:"accessor",value:e=>e.hexagon},extruded:!0},p1=class e extends Sc{static{this.defaultProps=Wvt}static{this.layerName="H3HexagonLayer"}static{this._checkH3Lib=()=>{}}initializeState(){e._checkH3Lib(),this.state={edgeLengthKM:0,resolution:-1}}shouldUpdateState({changeFlags:t}){return this._shouldUseHighPrecision()?t.propsOrDataChanged:t.somethingChanged}updateState({props:t,changeFlags:r}){if(t.highPrecision!==!0&&(r.dataChanged||r.updateTriggersChanged&&r.updateTriggersChanged.getHexagon)){let i=this._calculateH3DataProps();this.setState(i)}this._updateVertices(this.context.viewport)}_calculateH3DataProps(){let t=-1,r=!1,i=!1,{iterable:s,objectInfo:n}=hu(this.props.data);for(let o of s){n.index++;let a=this.props.getHexagon(o,n),h=fp(a);if(t<0){if(t=h,!this.props.highPrecision)break}else if(t!==h){i=!0;break}if(DO(a)){r=!0;break}}return{resolution:t,edgeLengthKM:t>=0?x3(t,"km"):0,hasMultipleRes:i,hasPentagon:r}}_shouldUseHighPrecision(){if(this.props.highPrecision==="auto"){let{resolution:t,hasPentagon:r,hasMultipleRes:i}=this.state,{viewport:s}=this.context;return!!s?.resolution||i||r||t>=0&&t<=5}return this.props.highPrecision}_updateVertices(t){if(this._shouldUseHighPrecision())return;let{resolution:r,edgeLengthKM:i,centerHex:s}=this.state;if(r<0)return;let n=this.props.centerHexagon||_3(t.latitude,t.longitude,r);if(s===n)return;if(s)try{if(S2(s,n)*i<Vvt)return}catch{}let{unitsPerMeter:o}=t.distanceScales,a=FO(n),[h,p]=T2(n),[g,v]=t.projectFlat([p,h]);a=a.map(T=>{let C=t.projectFlat(T);return[(C[0]-g)/o[0],(C[1]-v)/o[1]]}),this.setState({centerHex:n,vertices:a})}renderLayers(){return this._shouldUseHighPrecision()?this._renderPolygonLayer():this._renderColumnLayer()}_getForwardProps(){let{elevationScale:t,material:r,coverage:i,extruded:s,wireframe:n,stroked:o,filled:a,lineWidthUnits:h,lineWidthScale:p,lineWidthMinPixels:g,lineWidthMaxPixels:v,getFillColor:T,getElevation:C,getLineColor:B,getLineWidth:L,transitions:z,updateTriggers:W}=this.props;return{elevationScale:t,extruded:s,coverage:i,wireframe:n,stroked:o,filled:a,lineWidthUnits:h,lineWidthScale:p,lineWidthMinPixels:g,lineWidthMaxPixels:v,material:r,getElevation:C,getFillColor:T,getLineColor:B,getLineWidth:L,transitions:z,updateTriggers:{getFillColor:W.getFillColor,getElevation:W.getElevation,getLineColor:W.getLineColor,getLineWidth:W.getLineWidth}}}_renderPolygonLayer(){let{data:t,getHexagon:r,updateTriggers:i,coverage:s}=this.props,n=this.getSubLayerClass("hexagon-cell-hifi",u1),o=this._getForwardProps();return o.updateTriggers.getPolygon=jvt(i.getHexagon,s),new n(o,this.getSubLayerProps({id:"hexagon-cell-hifi",updateTriggers:o.updateTriggers}),{data:t,_normalize:!1,_windingOrder:"CCW",positionFormat:"XY",getPolygon:(a,h)=>{let p=r(a,h);return qX(FO(p,s))}})}_renderColumnLayer(){let{data:t,getHexagon:r,updateTriggers:i}=this.props,s=this.getSubLayerClass("hexagon-cell",u2),n=this._getForwardProps();return n.updateTriggers.getPosition=i.getHexagon,new s(n,this.getSubLayerProps({id:"hexagon-cell",flatShading:!0,updateTriggers:n.updateTriggers}),{data:t,diskResolution:6,radius:1,vertices:this.state.vertices,getPosition:HX.bind(null,r)})}};var Zz=RR(XX());var EL={};Ua(EL,{Adder:()=>ts,Delaunay:()=>sT,FormatSpecifier:()=>aT,InternMap:()=>sf,InternSet:()=>Cc,Node:()=>Sp,Path:()=>n0,Voronoi:()=>L1,ZoomTransform:()=>hh,active:()=>nK,arc:()=>unt,area:()=>KM,areaRadial:()=>gL,ascending:()=>An,autoType:()=>fN,axisBottom:()=>vZ,axisLeft:()=>wZ,axisRight:()=>bZ,axisTop:()=>xZ,bin:()=>v6,bisect:()=>Mc,bisectCenter:()=>KX,bisectLeft:()=>QX,bisectRight:()=>VO,bisector:()=>qm,blob:()=>KK,blur:()=>JX,blur2:()=>y6,blurImage:()=>tZ,brush:()=>dK,brushSelection:()=>hK,brushX:()=>fK,brushY:()=>pK,buffer:()=>JK,chord:()=>AK,chordDirected:()=>_K,chordTranspose:()=>gK,cluster:()=>fet,color:()=>Rc,contourDensity:()=>RK,contours:()=>eT,count:()=>Xd,create:()=>pG,creator:()=>Xm,cross:()=>WO,csv:()=>eJ,csvFormat:()=>VK,csvFormatBody:()=>jK,csvFormatRow:()=>$K,csvFormatRows:()=>WK,csvFormatValue:()=>HK,csvParse:()=>gI,csvParseRows:()=>UK,cubehelix:()=>bl,cumsum:()=>$O,curveBasis:()=>Tnt,curveBasisClosed:()=>Ent,curveBasisOpen:()=>Mnt,curveBumpX:()=>eC,curveBumpY:()=>rC,curveBundle:()=>Pnt,curveCardinal:()=>Rnt,curveCardinalClosed:()=>knt,curveCardinalOpen:()=>Dnt,curveCatmullRom:()=>Bnt,curveCatmullRomClosed:()=>Lnt,curveCatmullRomOpen:()=>znt,curveLinear:()=>xA,curveLinearClosed:()=>Vnt,curveMonotoneX:()=>Ynt,curveMonotoneY:()=>Xnt,curveNatural:()=>Qnt,curveStep:()=>Knt,curveStepAfter:()=>tst,curveStepBefore:()=>Jnt,descending:()=>b3,deviation:()=>w3,difference:()=>dB,disjoint:()=>mB,dispatch:()=>rh,drag:()=>gG,dragDisable:()=>Qm,dragEnable:()=>Km,dsv:()=>pN,dsvFormat:()=>lA,easeBack:()=>HB,easeBackIn:()=>JQ,easeBackInOut:()=>HB,easeBackOut:()=>tK,easeBounce:()=>j2,easeBounceIn:()=>QQ,easeBounceInOut:()=>KQ,easeBounceOut:()=>j2,easeCircle:()=>jB,easeCircleIn:()=>ZQ,easeCircleInOut:()=>jB,easeCircleOut:()=>GQ,easeCubic:()=>Q3,easeCubicIn:()=>zQ,easeCubicInOut:()=>Q3,easeCubicOut:()=>UQ,easeElastic:()=>XB,easeElasticIn:()=>eK,easeElasticInOut:()=>rK,easeElasticOut:()=>XB,easeExp:()=>VB,easeExpIn:()=>YQ,easeExpInOut:()=>VB,easeExpOut:()=>XQ,easeLinear:()=>NQ,easePoly:()=>zB,easePolyIn:()=>VQ,easePolyInOut:()=>zB,easePolyOut:()=>jQ,easeQuad:()=>LB,easeQuadIn:()=>LQ,easeQuadInOut:()=>LB,easeQuadOut:()=>FQ,easeSin:()=>UB,easeSinIn:()=>HQ,easeSinInOut:()=>UB,easeSinOut:()=>qQ,every:()=>lB,extent:()=>Zd,fcumsum:()=>iZ,filter:()=>uB,flatGroup:()=>lZ,flatRollup:()=>cZ,forceCenter:()=>lJ,forceCollide:()=>IJ,forceLink:()=>CJ,forceManyBody:()=>OJ,forceRadial:()=>BJ,forceSimulation:()=>DJ,forceX:()=>NJ,forceY:()=>LJ,format:()=>j1,formatDefaultLocale:()=>bI,formatLocale:()=>yI,formatPrefix:()=>lT,formatSpecifier:()=>hf,fsum:()=>rZ,geoAlbers:()=>sM,geoAlbersUsa:()=>Qtt,geoArea:()=>QJ,geoAzimuthalEqualArea:()=>Ktt,geoAzimuthalEqualAreaRaw:()=>aM,geoAzimuthalEquidistant:()=>Jtt,geoAzimuthalEquidistantRaw:()=>lM,geoBounds:()=>stt,geoCentroid:()=>htt,geoCircle:()=>Att,geoClipAntimeridian:()=>_T,geoClipCircle:()=>HI,geoClipExtent:()=>ytt,geoClipRectangle:()=>u0,geoConicConformal:()=>eet,geoConicConformalRaw:()=>t9,geoConicEqualArea:()=>G1,geoConicEqualAreaRaw:()=>KN,geoConicEquidistant:()=>iet,geoConicEquidistantRaw:()=>e9,geoContains:()=>Ett,geoDistance:()=>rx,geoEqualEarth:()=>net,geoEqualEarthRaw:()=>hM,geoEquirectangular:()=>ret,geoEquirectangularRaw:()=>K1,geoGnomonic:()=>set,geoGnomonicRaw:()=>fM,geoGraticule:()=>QI,geoGraticule10:()=>Ctt,geoIdentity:()=>oet,geoInterpolate:()=>Ptt,geoLength:()=>ZI,geoMercator:()=>tet,geoMercatorRaw:()=>Q1,geoNaturalEarth1:()=>aet,geoNaturalEarth1Raw:()=>pM,geoOrthographic:()=>cet,geoOrthographicRaw:()=>dM,geoPath:()=>qtt,geoProjection:()=>Bo,geoProjectionMutator:()=>ST,geoRotation:()=>zI,geoStereographic:()=>uet,geoStereographicRaw:()=>mM,geoStream:()=>wa,geoTransform:()=>Ytt,geoTransverseMercator:()=>het,geoTransverseMercatorRaw:()=>AM,gray:()=>DG,greatest:()=>C3,greatestIndex:()=>iB,group:()=>T3,groupSort:()=>XO,groups:()=>qO,hcl:()=>N2,hierarchy:()=>PT,histogram:()=>v6,hsl:()=>O2,html:()=>oJ,image:()=>iJ,index:()=>uZ,indexes:()=>hZ,interpolate:()=>vl,interpolateArray:()=>HG,interpolateBasis:()=>j6,interpolateBasisClosed:()=>W6,interpolateBlues:()=>Hit,interpolateBrBG:()=>Sit,interpolateBuGn:()=>Dit,interpolateBuPu:()=>Oit,interpolateCividis:()=>Qit,interpolateCool:()=>tnt,interpolateCubehelix:()=>oQ,interpolateCubehelixDefault:()=>Kit,interpolateCubehelixLong:()=>M1,interpolateDate:()=>q6,interpolateDiscrete:()=>qG,interpolateGnBu:()=>Bit,interpolateGreens:()=>qit,interpolateGreys:()=>Yit,interpolateHcl:()=>iQ,interpolateHclLong:()=>nQ,interpolateHsl:()=>tQ,interpolateHslLong:()=>eQ,interpolateHue:()=>YG,interpolateInferno:()=>ont,interpolateLab:()=>OB,interpolateMagma:()=>snt,interpolateNumber:()=>ba,interpolateNumberArray:()=>F2,interpolateObject:()=>Y6,interpolateOrRd:()=>Nit,interpolateOranges:()=>Git,interpolatePRGn:()=>Eit,interpolatePiYG:()=>Iit,interpolatePlasma:()=>ant,interpolatePuBu:()=>Fit,interpolatePuBuGn:()=>Lit,interpolatePuOr:()=>Mit,interpolatePuRd:()=>zit,interpolatePurples:()=>Xit,interpolateRainbow:()=>ent,interpolateRdBu:()=>Cit,interpolateRdGy:()=>Pit,interpolateRdPu:()=>Uit,interpolateRdYlBu:()=>Rit,interpolateRdYlGn:()=>kit,interpolateReds:()=>Zit,interpolateRgb:()=>rA,interpolateRgbBasis:()=>$6,interpolateRgbBasisClosed:()=>$G,interpolateRound:()=>iA,interpolateSinebow:()=>rnt,interpolateSpectral:()=>YM,interpolateString:()=>z2,interpolateTransformCss:()=>G6,interpolateTransformSvg:()=>Q6,interpolateTurbo:()=>int,interpolateViridis:()=>nnt,interpolateWarm:()=>Jit,interpolateYlGn:()=>jit,interpolateYlGnBu:()=>Vit,interpolateYlOrBr:()=>Wit,interpolateYlOrRd:()=>$it,interpolateZoom:()=>K6,interrupt:()=>cf,intersection:()=>AB,interval:()=>hQ,isoFormat:()=>uit,isoParse:()=>hit,json:()=>nJ,lab:()=>E1,lch:()=>BG,least:()=>rB,leastIndex:()=>P3,line:()=>xx,lineRadial:()=>AL,link:()=>XT,linkHorizontal:()=>_nt,linkRadial:()=>xnt,linkVertical:()=>ynt,local:()=>k6,map:()=>hB,matcher:()=>R2,max:()=>Kd,maxIndex:()=>_1,mean:()=>QO,median:()=>KO,medianIndex:()=>mZ,merge:()=>b1,min:()=>Ym,minIndex:()=>y1,mode:()=>JO,namespace:()=>dp,namespaces:()=>O3,nice:()=>A1,now:()=>nA,pack:()=>Fet,packEnclose:()=>Cet,packSiblings:()=>Bet,pairs:()=>tB,partition:()=>zet,path:()=>tT,pathRound:()=>xK,permute:()=>S3,pie:()=>mnt,piecewise:()=>W3,pointRadial:()=>d_,pointer:()=>xa,pointers:()=>dG,polygonArea:()=>Xet,polygonCentroid:()=>Zet,polygonContains:()=>Jet,polygonHull:()=>Ket,polygonLength:()=>trt,precisionFixed:()=>vI,precisionPrefix:()=>wI,precisionRound:()=>TI,quadtree:()=>cA,quantile:()=>pp,quantileIndex:()=>T6,quantileSorted:()=>w6,quantize:()=>aQ,quickselect:()=>x1,radialArea:()=>gL,radialLine:()=>AL,randomBates:()=>nrt,randomBernoulli:()=>art,randomBeta:()=>TM,randomBinomial:()=>SM,randomCauchy:()=>crt,randomExponential:()=>srt,randomGamma:()=>dx,randomGeometric:()=>wM,randomInt:()=>rrt,randomIrwinHall:()=>vM,randomLcg:()=>d9,randomLogNormal:()=>irt,randomLogistic:()=>urt,randomNormal:()=>px,randomPareto:()=>ort,randomPoisson:()=>hrt,randomUniform:()=>ert,randomWeibull:()=>lrt,range:()=>eh,rank:()=>eB,reduce:()=>fB,reverse:()=>pB,rgb:()=>e0,ribbon:()=>TK,ribbonArrow:()=>SK,rollup:()=>x6,rollups:()=>YO,scaleBand:()=>kT,scaleDiverging:()=>HM,scaleDivergingLog:()=>z9,scaleDivergingPow:()=>qM,scaleDivergingSqrt:()=>pit,scaleDivergingSymlog:()=>U9,scaleIdentity:()=>MM,scaleImplicit:()=>EM,scaleLinear:()=>IM,scaleLog:()=>CM,scaleOrdinal:()=>mx,scalePoint:()=>drt,scalePow:()=>FT,scaleQuantile:()=>kM,scaleQuantize:()=>DM,scaleRadial:()=>RM,scaleSequential:()=>gx,scaleSequentialLog:()=>L9,scaleSequentialPow:()=>jM,scaleSequentialQuantile:()=>WM,scaleSequentialSqrt:()=>fit,scaleSequentialSymlog:()=>F9,scaleSqrt:()=>vrt,scaleSymlog:()=>PM,scaleThreshold:()=>OM,scaleTime:()=>B9,scaleUtc:()=>N9,scan:()=>nB,schemeAccent:()=>mit,schemeBlues:()=>lL,schemeBrBG:()=>V9,schemeBuGn:()=>G9,schemeBuPu:()=>Q9,schemeCategory10:()=>dit,schemeDark2:()=>Ait,schemeGnBu:()=>K9,schemeGreens:()=>cL,schemeGreys:()=>uL,schemeObservable10:()=>git,schemeOrRd:()=>J9,schemeOranges:()=>pL,schemePRGn:()=>j9,schemePaired:()=>_it,schemePastel1:()=>yit,schemePastel2:()=>xit,schemePiYG:()=>W9,schemePuBu:()=>eL,schemePuBuGn:()=>tL,schemePuOr:()=>$9,schemePuRd:()=>rL,schemePurples:()=>hL,schemeRdBu:()=>H9,schemeRdGy:()=>q9,schemeRdPu:()=>iL,schemeRdYlBu:()=>Y9,schemeRdYlGn:()=>X9,schemeReds:()=>fL,schemeSet1:()=>bit,schemeSet2:()=>vit,schemeSet3:()=>wit,schemeSpectral:()=>Z9,schemeTableau10:()=>Tit,schemeYlGn:()=>sL,schemeYlGnBu:()=>nL,schemeYlOrBr:()=>oL,schemeYlOrRd:()=>aL,select:()=>po,selectAll:()=>mG,selection:()=>mp,selector:()=>Zm,selectorAll:()=>P2,shuffle:()=>AZ,shuffler:()=>sB,some:()=>cB,sort:()=>C2,stack:()=>est,stackOffsetDiverging:()=>ist,stackOffsetExpand:()=>rst,stackOffsetNone:()=>gf,stackOffsetSilhouette:()=>nst,stackOffsetWiggle:()=>sst,stackOrderAppearance:()=>yC,stackOrderAscending:()=>xC,stackOrderDescending:()=>ost,stackOrderInsideOut:()=>ast,stackOrderNone:()=>_f,stackOrderReverse:()=>lst,stratify:()=>jet,style:()=>Jd,subset:()=>gB,sum:()=>oB,superset:()=>k3,svg:()=>aJ,symbol:()=>vL,symbolAsterisk:()=>iC,symbolCircle:()=>wx,symbolCross:()=>nC,symbolDiamond:()=>sC,symbolDiamond2:()=>oC,symbolPlus:()=>aC,symbolSquare:()=>lC,symbolSquare2:()=>cC,symbolStar:()=>uC,symbolTimes:()=>ZT,symbolTriangle:()=>hC,symbolTriangle2:()=>fC,symbolWye:()=>pC,symbolX:()=>ZT,symbols:()=>bL,symbolsFill:()=>bL,symbolsStroke:()=>wnt,text:()=>U1,thresholdFreedmanDiaconis:()=>ZO,thresholdScott:()=>GO,thresholdSturges:()=>g1,tickFormat:()=>DT,tickIncrement:()=>of,tickStep:()=>m1,ticks:()=>Pc,timeDay:()=>Cp,timeDays:()=>Mrt,timeFormat:()=>HT,timeFormatDefaultLocale:()=>zM,timeFormatLocale:()=>$T,timeFriday:()=>w9,timeFridays:()=>Nrt,timeHour:()=>s_,timeHours:()=>Ert,timeInterval:()=>es,timeMillisecond:()=>gA,timeMilliseconds:()=>y9,timeMinute:()=>r_,timeMinutes:()=>Trt,timeMonday:()=>l_,timeMondays:()=>krt,timeMonth:()=>h_,timeMonths:()=>$rt,timeParse:()=>D9,timeSaturday:()=>T9,timeSaturdays:()=>Lrt,timeSecond:()=>mu,timeSeconds:()=>x9,timeSunday:()=>Pp,timeSundays:()=>S9,timeThursday:()=>f0,timeThursdays:()=>Brt,timeTickInterval:()=>FM,timeTicks:()=>LM,timeTuesday:()=>b9,timeTuesdays:()=>Drt,timeWednesday:()=>v9,timeWednesdays:()=>Ort,timeWeek:()=>Pp,timeWeeks:()=>S9,timeYear:()=>Oc,timeYears:()=>qrt,timeout:()=>X3,timer:()=>R1,timerFlush:()=>NB,transition:()=>lI,transpose:()=>R3,tree:()=>Wet,treemap:()=>$et,treemapBinary:()=>Het,treemapDice:()=>Ep,treemapResquarify:()=>Yet,treemapSlice:()=>mA,treemapSliceDice:()=>qet,treemapSquarify:()=>bM,tsv:()=>rJ,tsvFormat:()=>YK,tsvFormatBody:()=>XK,tsvFormatRow:()=>GK,tsvFormatRows:()=>ZK,tsvFormatValue:()=>QK,tsvParse:()=>_I,tsvParseRows:()=>qK,union:()=>_B,unixDay:()=>UT,unixDays:()=>Prt,utcDay:()=>_A,utcDays:()=>Crt,utcFormat:()=>p_,utcFriday:()=>M9,utcFridays:()=>jrt,utcHour:()=>o_,utcHours:()=>Irt,utcMillisecond:()=>gA,utcMilliseconds:()=>y9,utcMinute:()=>i_,utcMinutes:()=>Srt,utcMonday:()=>u_,utcMondays:()=>Frt,utcMonth:()=>f_,utcMonths:()=>Hrt,utcParse:()=>qT,utcSaturday:()=>C9,utcSaturdays:()=>Wrt,utcSecond:()=>mu,utcSeconds:()=>x9,utcSunday:()=>Rp,utcSundays:()=>P9,utcThursday:()=>p0,utcThursdays:()=>Vrt,utcTickInterval:()=>NM,utcTicks:()=>BM,utcTuesday:()=>E9,utcTuesdays:()=>zrt,utcWednesday:()=>I9,utcWednesdays:()=>Urt,utcWeek:()=>Rp,utcWeeks:()=>P9,utcYear:()=>Bc,utcYears:()=>Yrt,variance:()=>v3,window:()=>k2,xml:()=>sJ,zip:()=>aB,zoom:()=>ust,zoomIdentity:()=>Ex,zoomTransform:()=>bC});function An(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function b3(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function qm(e){let t,r,i;e.length!==2?(t=An,r=(a,h)=>An(e(a),h),i=(a,h)=>e(a)-h):(t=e===An||e===b3?e:$vt,r=e,i=e);function s(a,h,p=0,g=a.length){if(p<g){if(t(h,h)!==0)return g;do{let v=p+g>>>1;r(a[v],h)<0?p=v+1:g=v}while(p<g)}return p}function n(a,h,p=0,g=a.length){if(p<g){if(t(h,h)!==0)return g;do{let v=p+g>>>1;r(a[v],h)<=0?p=v+1:g=v}while(p<g)}return p}function o(a,h,p=0,g=a.length){let v=s(a,h,p,g-1);return v>p&&i(a[v-1],h)>-i(a[v],h)?v-1:v}return{left:s,center:o,right:n}}function $vt(){return 0}function d1(e){return e===null?NaN:+e}function*ZX(e,t){if(t===void 0)for(let r of e)r!=null&&(r=+r)>=r&&(yield r);else{let r=-1;for(let i of e)(i=t(i,++r,e))!=null&&(i=+i)>=i&&(yield i)}}var GX=qm(An),VO=GX.right,QX=GX.left,KX=qm(d1).center,Mc=VO;function JX(e,t){if(!((t=+t)>=0))throw new RangeError("invalid r");let r=e.length;if(!((r=Math.floor(r))>=0))throw new RangeError("invalid length");if(!r||!t)return e;let i=jO(t),s=e.slice();return i(e,s,0,r,1),i(s,e,0,r,1),i(e,s,0,r,1),e}var y6=eZ(jO),tZ=eZ(Hvt);function eZ(e){return function(t,r,i=r){if(!((r=+r)>=0))throw new RangeError("invalid rx");if(!((i=+i)>=0))throw new RangeError("invalid ry");let{data:s,width:n,height:o}=t;if(!((n=Math.floor(n))>=0))throw new RangeError("invalid width");if(!((o=Math.floor(o!==void 0?o:s.length/n))>=0))throw new RangeError("invalid height");if(!n||!o||!r&&!i)return t;let a=r&&e(r),h=i&&e(i),p=s.slice();return a&&h?(E2(a,p,s,n,o),E2(a,s,p,n,o),E2(a,p,s,n,o),I2(h,s,p,n,o),I2(h,p,s,n,o),I2(h,s,p,n,o)):a?(E2(a,s,p,n,o),E2(a,p,s,n,o),E2(a,s,p,n,o)):h&&(I2(h,s,p,n,o),I2(h,p,s,n,o),I2(h,s,p,n,o)),t}}function E2(e,t,r,i,s){for(let n=0,o=i*s;n<o;)e(t,r,n,n+=i,1)}function I2(e,t,r,i,s){for(let n=0,o=i*s;n<i;++n)e(t,r,n,n+o,i)}function Hvt(e){let t=jO(e);return(r,i,s,n,o)=>{s<<=2,n<<=2,o<<=2,t(r,i,s+0,n+0,o),t(r,i,s+1,n+1,o),t(r,i,s+2,n+2,o),t(r,i,s+3,n+3,o)}}function jO(e){let t=Math.floor(e);if(t===e)return qvt(e);let r=e-t,i=2*e+1;return(s,n,o,a,h)=>{if(!((a-=h)>=o))return;let p=t*n[o],g=h*t,v=g+h;for(let T=o,C=o+g;T<C;T+=h)p+=n[Math.min(a,T)];for(let T=o,C=a;T<=C;T+=h)p+=n[Math.min(a,T+g)],s[T]=(p+r*(n[Math.max(o,T-v)]+n[Math.min(a,T+v)]))/i,p-=n[Math.max(o,T-g)]}}function qvt(e){let t=2*e+1;return(r,i,s,n,o)=>{if(!((n-=o)>=s))return;let a=e*i[s],h=o*e;for(let p=s,g=s+h;p<g;p+=o)a+=i[Math.min(n,p)];for(let p=s,g=n;p<=g;p+=o)a+=i[Math.min(n,p+h)],r[p]=a/t,a-=i[Math.max(s,p-h)]}}function Xd(e,t){let r=0;if(t===void 0)for(let i of e)i!=null&&(i=+i)>=i&&++r;else{let i=-1;for(let s of e)(s=t(s,++i,e))!=null&&(s=+s)>=s&&++r}return r}function Yvt(e){return e.length|0}function Xvt(e){return!(e>0)}function Zvt(e){return typeof e!="object"||"length"in e?e:Array.from(e)}function Gvt(e){return t=>e(...t)}function WO(...e){let t=typeof e[e.length-1]=="function"&&Gvt(e.pop());e=e.map(Zvt);let r=e.map(Yvt),i=e.length-1,s=new Array(i+1).fill(0),n=[];if(i<0||r.some(Xvt))return n;for(;;){n.push(s.map((a,h)=>e[h][a]));let o=i;for(;++s[o]===r[o];){if(o===0)return t?n.map(t):n;s[o--]=0}}}function $O(e,t){var r=0,i=0;return Float64Array.from(e,t===void 0?s=>r+=+s||0:s=>r+=+t(s,i++,e)||0)}function v3(e,t){let r=0,i,s=0,n=0;if(t===void 0)for(let o of e)o!=null&&(o=+o)>=o&&(i=o-s,s+=i/++r,n+=i*(o-s));else{let o=-1;for(let a of e)(a=t(a,++o,e))!=null&&(a=+a)>=a&&(i=a-s,s+=i/++r,n+=i*(a-s))}if(r>1)return n/(r-1)}function w3(e,t){let r=v3(e,t);return r&&Math.sqrt(r)}function Zd(e,t){let r,i;if(t===void 0)for(let s of e)s!=null&&(r===void 0?s>=s&&(r=i=s):(r>s&&(r=s),i<s&&(i=s)));else{let s=-1;for(let n of e)(n=t(n,++s,e))!=null&&(r===void 0?n>=n&&(r=i=n):(r>n&&(r=n),i<n&&(i=n)))}return[r,i]}var ts=class{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){let r=this._partials,i=0;for(let s=0;s<this._n&&s<32;s++){let n=r[s],o=t+n,a=Math.abs(t)<Math.abs(n)?t-(o-n):n-(o-t);a&&(r[i++]=a),t=o}return r[i]=t,this._n=i+1,this}valueOf(){let t=this._partials,r=this._n,i,s,n,o=0;if(r>0){for(o=t[--r];r>0&&(i=o,s=t[--r],o=i+s,n=s-(o-i),!n););r>0&&(n<0&&t[r-1]<0||n>0&&t[r-1]>0)&&(s=n*2,i=o+s,s==i-o&&(o=i))}return o}};function rZ(e,t){let r=new ts;if(t===void 0)for(let i of e)(i=+i)&&r.add(i);else{let i=-1;for(let s of e)(s=+t(s,++i,e))&&r.add(s)}return+r}function iZ(e,t){let r=new ts,i=-1;return Float64Array.from(e,t===void 0?s=>r.add(+s||0):s=>r.add(+t(s,++i,e)||0))}var sf=class extends Map{constructor(t,r=oZ){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(let[i,s]of t)this.set(i,s)}get(t){return super.get(HO(this,t))}has(t){return super.has(HO(this,t))}set(t,r){return super.set(nZ(this,t),r)}delete(t){return super.delete(sZ(this,t))}},Cc=class extends Set{constructor(t,r=oZ){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(let i of t)this.add(i)}has(t){return super.has(HO(this,t))}add(t){return super.add(nZ(this,t))}delete(t){return super.delete(sZ(this,t))}};function HO({_intern:e,_key:t},r){let i=t(r);return e.has(i)?e.get(i):r}function nZ({_intern:e,_key:t},r){let i=t(r);return e.has(i)?e.get(i):(e.set(i,r),r)}function sZ({_intern:e,_key:t},r){let i=t(r);return e.has(i)&&(r=e.get(i),e.delete(i)),r}function oZ(e){return e!==null&&typeof e=="object"?e.valueOf():e}function Gd(e){return e}function T3(e,...t){return M2(e,Gd,Gd,t)}function qO(e,...t){return M2(e,Array.from,Gd,t)}function aZ(e,t){for(let r=1,i=t.length;r<i;++r)e=e.flatMap(s=>s.pop().map(([n,o])=>[...s,n,o]));return e}function lZ(e,...t){return aZ(qO(e,...t),t)}function cZ(e,t,...r){return aZ(YO(e,t,...r),r)}function x6(e,t,...r){return M2(e,Gd,t,r)}function YO(e,t,...r){return M2(e,Array.from,t,r)}function uZ(e,...t){return M2(e,Gd,fZ,t)}function hZ(e,...t){return M2(e,Array.from,fZ,t)}function fZ(e){if(e.length!==1)throw new Error("duplicate key");return e[0]}function M2(e,t,r,i){return function s(n,o){if(o>=i.length)return r(n);let a=new sf,h=i[o++],p=-1;for(let g of n){let v=h(g,++p,n),T=a.get(v);T?T.push(g):a.set(v,[g])}for(let[g,v]of a)a.set(g,s(v,o));return t(a)}(e,0)}function S3(e,t){return Array.from(t,r=>e[r])}function C2(e,...t){if(typeof e[Symbol.iterator]!="function")throw new TypeError("values is not iterable");e=Array.from(e);let[r]=t;if(r&&r.length!==2||t.length>1){let i=Uint32Array.from(e,(s,n)=>n);return t.length>1?(t=t.map(s=>e.map(s)),i.sort((s,n)=>{for(let o of t){let a=Qd(o[s],o[n]);if(a)return a}})):(r=e.map(r),i.sort((s,n)=>Qd(r[s],r[n]))),S3(e,i)}return e.sort(E3(r))}function E3(e=An){if(e===An)return Qd;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{let i=e(t,r);return i||i===0?i:(e(r,r)===0)-(e(t,t)===0)}}function Qd(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}function XO(e,t,r){return(t.length!==2?C2(x6(e,t,r),([i,s],[n,o])=>An(s,o)||An(i,n)):C2(T3(e,r),([i,s],[n,o])=>t(s,o)||An(i,n))).map(([i])=>i)}var pZ=Array.prototype,dZ=pZ.slice,ute=pZ.map;function I3(e){return()=>e}var Qvt=Math.sqrt(50),Kvt=Math.sqrt(10),Jvt=Math.sqrt(2);function b6(e,t,r){let i=(t-e)/Math.max(0,r),s=Math.floor(Math.log10(i)),n=i/Math.pow(10,s),o=n>=Qvt?10:n>=Kvt?5:n>=Jvt?2:1,a,h,p;return s<0?(p=Math.pow(10,-s)/o,a=Math.round(e*p),h=Math.round(t*p),a/p<e&&++a,h/p>t&&--h,p=-p):(p=Math.pow(10,s)*o,a=Math.round(e/p),h=Math.round(t/p),a*p<e&&++a,h*p>t&&--h),h<a&&.5<=r&&r<2?b6(e,t,r*2):[a,h,p]}function Pc(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];let i=t<e,[s,n,o]=i?b6(t,e,r):b6(e,t,r);if(!(n>=s))return[];let a=n-s+1,h=new Array(a);if(i)if(o<0)for(let p=0;p<a;++p)h[p]=(n-p)/-o;else for(let p=0;p<a;++p)h[p]=(n-p)*o;else if(o<0)for(let p=0;p<a;++p)h[p]=(s+p)/-o;else for(let p=0;p<a;++p)h[p]=(s+p)*o;return h}function of(e,t,r){return t=+t,e=+e,r=+r,b6(e,t,r)[2]}function m1(e,t,r){t=+t,e=+e,r=+r;let i=t<e,s=i?of(t,e,r):of(e,t,r);return(i?-1:1)*(s<0?1/-s:s)}function A1(e,t,r){let i;for(;;){let s=of(e,t,r);if(s===i||s===0||!isFinite(s))return[e,t];s>0?(e=Math.floor(e/s)*s,t=Math.ceil(t/s)*s):s<0&&(e=Math.ceil(e*s)/s,t=Math.floor(t*s)/s),i=s}}function g1(e){return Math.max(1,Math.ceil(Math.log(Xd(e))/Math.LN2)+1)}function v6(){var e=Gd,t=Zd,r=g1;function i(s){Array.isArray(s)||(s=Array.from(s));var n,o=s.length,a,h,p=new Array(o);for(n=0;n<o;++n)p[n]=e(s[n],n,s);var g=t(p),v=g[0],T=g[1],C=r(p,v,T);if(!Array.isArray(C)){let X=T,q=+C;if(t===Zd&&([v,T]=A1(v,T,q)),C=Pc(v,T,q),C[0]<=v&&(h=of(v,T,q)),C[C.length-1]>=T)if(X>=T&&t===Zd){let it=of(v,T,q);isFinite(it)&&(it>0?T=(Math.floor(T/it)+1)*it:it<0&&(T=(Math.ceil(T*-it)+1)/-it))}else C.pop()}for(var B=C.length,L=0,z=B;C[L]<=v;)++L;for(;C[z-1]>T;)--z;(L||z<B)&&(C=C.slice(L,z),B=z-L);var W=new Array(B+1),Z;for(n=0;n<=B;++n)Z=W[n]=[],Z.x0=n>0?C[n-1]:v,Z.x1=n<B?C[n]:T;if(isFinite(h)){if(h>0)for(n=0;n<o;++n)(a=p[n])!=null&&v<=a&&a<=T&&W[Math.min(B,Math.floor((a-v)/h))].push(s[n]);else if(h<0){for(n=0;n<o;++n)if((a=p[n])!=null&&v<=a&&a<=T){let X=Math.floor((v-a)*h);W[Math.min(B,X+(C[X]<=a))].push(s[n])}}}else for(n=0;n<o;++n)(a=p[n])!=null&&v<=a&&a<=T&&W[Mc(C,a,0,B)].push(s[n]);return W}return i.value=function(s){return arguments.length?(e=typeof s=="function"?s:I3(s),i):e},i.domain=function(s){return arguments.length?(t=typeof s=="function"?s:I3([s[0],s[1]]),i):t},i.thresholds=function(s){return arguments.length?(r=typeof s=="function"?s:I3(Array.isArray(s)?dZ.call(s):s),i):r},i}function Kd(e,t){let r;if(t===void 0)for(let i of e)i!=null&&(r<i||r===void 0&&i>=i)&&(r=i);else{let i=-1;for(let s of e)(s=t(s,++i,e))!=null&&(r<s||r===void 0&&s>=s)&&(r=s)}return r}function _1(e,t){let r,i=-1,s=-1;if(t===void 0)for(let n of e)++s,n!=null&&(r<n||r===void 0&&n>=n)&&(r=n,i=s);else for(let n of e)(n=t(n,++s,e))!=null&&(r<n||r===void 0&&n>=n)&&(r=n,i=s);return i}function Ym(e,t){let r;if(t===void 0)for(let i of e)i!=null&&(r>i||r===void 0&&i>=i)&&(r=i);else{let i=-1;for(let s of e)(s=t(s,++i,e))!=null&&(r>s||r===void 0&&s>=s)&&(r=s)}return r}function y1(e,t){let r,i=-1,s=-1;if(t===void 0)for(let n of e)++s,n!=null&&(r>n||r===void 0&&n>=n)&&(r=n,i=s);else for(let n of e)(n=t(n,++s,e))!=null&&(r>n||r===void 0&&n>=n)&&(r=n,i=s);return i}function x1(e,t,r=0,i=1/0,s){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),i=Math.floor(Math.min(e.length-1,i)),!(r<=t&&t<=i))return e;for(s=s===void 0?Qd:E3(s);i>r;){if(i-r>600){let h=i-r+1,p=t-r+1,g=Math.log(h),v=.5*Math.exp(2*g/3),T=.5*Math.sqrt(g*v*(h-v)/h)*(p-h/2<0?-1:1),C=Math.max(r,Math.floor(t-p*v/h+T)),B=Math.min(i,Math.floor(t+(h-p)*v/h+T));x1(e,t,C,B,s)}let n=e[t],o=r,a=i;for(M3(e,r,t),s(e[i],n)>0&&M3(e,r,i);o<a;){for(M3(e,o,a),++o,--a;s(e[o],n)<0;)++o;for(;s(e[a],n)>0;)--a}s(e[r],n)===0?M3(e,r,a):(++a,M3(e,a,i)),a<=t&&(r=a+1),t<=a&&(i=a-1)}return e}function M3(e,t,r){let i=e[t];e[t]=e[r],e[r]=i}function C3(e,t=An){let r,i=!1;if(t.length===1){let s;for(let n of e){let o=t(n);(i?An(o,s)>0:An(o,o)===0)&&(r=n,s=o,i=!0)}}else for(let s of e)(i?t(s,r)>0:t(s,s)===0)&&(r=s,i=!0);return r}function pp(e,t,r){if(e=Float64Array.from(ZX(e,r)),!(!(i=e.length)||isNaN(t=+t))){if(t<=0||i<2)return Ym(e);if(t>=1)return Kd(e);var i,s=(i-1)*t,n=Math.floor(s),o=Kd(x1(e,n).subarray(0,n+1)),a=Ym(e.subarray(n+1));return o+(a-o)*(s-n)}}function w6(e,t,r=d1){if(!(!(i=e.length)||isNaN(t=+t))){if(t<=0||i<2)return+r(e[0],0,e);if(t>=1)return+r(e[i-1],i-1,e);var i,s=(i-1)*t,n=Math.floor(s),o=+r(e[n],n,e),a=+r(e[n+1],n+1,e);return o+(a-o)*(s-n)}}function T6(e,t,r=d1){if(!isNaN(t=+t)){if(i=Float64Array.from(e,(a,h)=>d1(r(e[h],h,e))),t<=0)return y1(i);if(t>=1)return _1(i);var i,s=Uint32Array.from(e,(a,h)=>h),n=i.length-1,o=Math.floor(n*t);return x1(s,o,0,n,(a,h)=>Qd(i[a],i[h])),o=C3(s.subarray(0,o+1),a=>i[a]),o>=0?o:-1}}function ZO(e,t,r){let i=Xd(e),s=pp(e,.75)-pp(e,.25);return i&&s?Math.ceil((r-t)/(2*s*Math.pow(i,-1/3))):1}function GO(e,t,r){let i=Xd(e),s=w3(e);return i&&s?Math.ceil((r-t)*Math.cbrt(i)/(3.49*s)):1}function QO(e,t){let r=0,i=0;if(t===void 0)for(let s of e)s!=null&&(s=+s)>=s&&(++r,i+=s);else{let s=-1;for(let n of e)(n=t(n,++s,e))!=null&&(n=+n)>=n&&(++r,i+=n)}if(r)return i/r}function KO(e,t){return pp(e,.5,t)}function mZ(e,t){return T6(e,.5,t)}function*twt(e){for(let t of e)yield*t}function b1(e){return Array.from(twt(e))}function JO(e,t){let r=new sf;if(t===void 0)for(let n of e)n!=null&&n>=n&&r.set(n,(r.get(n)||0)+1);else{let n=-1;for(let o of e)(o=t(o,++n,e))!=null&&o>=o&&r.set(o,(r.get(o)||0)+1)}let i,s=0;for(let[n,o]of r)o>s&&(s=o,i=n);return i}function tB(e,t=ewt){let r=[],i,s=!1;for(let n of e)s&&r.push(t(i,n)),i=n,s=!0;return r}function ewt(e,t){return[e,t]}function eh(e,t,r){e=+e,t=+t,r=(s=arguments.length)<2?(t=e,e=0,1):s<3?1:+r;for(var i=-1,s=Math.max(0,Math.ceil((t-e)/r))|0,n=new Array(s);++i<s;)n[i]=e+i*r;return n}function eB(e,t=An){if(typeof e[Symbol.iterator]!="function")throw new TypeError("values is not iterable");let r=Array.from(e),i=new Float64Array(r.length);t.length!==2&&(r=r.map(t),t=An);let s=(a,h)=>t(r[a],r[h]),n,o;return e=Uint32Array.from(r,(a,h)=>h),e.sort(t===An?(a,h)=>Qd(r[a],r[h]):E3(s)),e.forEach((a,h)=>{let p=s(a,n===void 0?a:n);p>=0?((n===void 0||p>0)&&(n=a,o=h),i[a]=o):i[a]=NaN}),i}function rB(e,t=An){let r,i=!1;if(t.length===1){let s;for(let n of e){let o=t(n);(i?An(o,s)<0:An(o,o)===0)&&(r=n,s=o,i=!0)}}else for(let s of e)(i?t(s,r)<0:t(s,s)===0)&&(r=s,i=!0);return r}function P3(e,t=An){if(t.length===1)return y1(e,t);let r,i=-1,s=-1;for(let n of e)++s,(i<0?t(n,n)===0:t(n,r)<0)&&(r=n,i=s);return i}function iB(e,t=An){if(t.length===1)return _1(e,t);let r,i=-1,s=-1;for(let n of e)++s,(i<0?t(n,n)===0:t(n,r)>0)&&(r=n,i=s);return i}function nB(e,t){let r=P3(e,t);return r<0?void 0:r}var AZ=sB(Math.random);function sB(e){return function(r,i=0,s=r.length){let n=s-(i=+i);for(;n;){let o=e()*n--|0,a=r[n+i];r[n+i]=r[o+i],r[o+i]=a}return r}}function oB(e,t){let r=0;if(t===void 0)for(let i of e)(i=+i)&&(r+=i);else{let i=-1;for(let s of e)(s=+t(s,++i,e))&&(r+=s)}return r}function R3(e){if(!(n=e.length))return[];for(var t=-1,r=Ym(e,rwt),i=new Array(r);++t<r;)for(var s=-1,n,o=i[t]=new Array(n);++s<n;)o[s]=e[s][t];return i}function rwt(e){return e.length}function aB(){return R3(arguments)}function lB(e,t){if(typeof t!="function")throw new TypeError("test is not a function");let r=-1;for(let i of e)if(!t(i,++r,e))return!1;return!0}function cB(e,t){if(typeof t!="function")throw new TypeError("test is not a function");let r=-1;for(let i of e)if(t(i,++r,e))return!0;return!1}function uB(e,t){if(typeof t!="function")throw new TypeError("test is not a function");let r=[],i=-1;for(let s of e)t(s,++i,e)&&r.push(s);return r}function hB(e,t){if(typeof e[Symbol.iterator]!="function")throw new TypeError("values is not iterable");if(typeof t!="function")throw new TypeError("mapper is not a function");return Array.from(e,(r,i)=>t(r,i,e))}function fB(e,t,r){if(typeof t!="function")throw new TypeError("reducer is not a function");let i=e[Symbol.iterator](),s,n,o=-1;if(arguments.length<3){if({done:s,value:r}=i.next(),s)return;++o}for(;{done:s,value:n}=i.next(),!s;)r=t(r,n,++o,e);return r}function pB(e){if(typeof e[Symbol.iterator]!="function")throw new TypeError("values is not iterable");return Array.from(e).reverse()}function dB(e,...t){e=new Cc(e);for(let r of t)for(let i of r)e.delete(i);return e}function mB(e,t){let r=t[Symbol.iterator](),i=new Cc;for(let s of e){if(i.has(s))return!1;let n,o;for(;({value:n,done:o}=r.next())&&!o;){if(Object.is(s,n))return!1;i.add(n)}}return!0}function AB(e,...t){e=new Cc(e),t=t.map(iwt);t:for(let r of e)for(let i of t)if(!i.has(r)){e.delete(r);continue t}return e}function iwt(e){return e instanceof Cc?e:new Cc(e)}function k3(e,t){let r=e[Symbol.iterator](),i=new Set;for(let s of t){let n=gZ(s);if(i.has(n))continue;let o,a;for(;{value:o,done:a}=r.next();){if(a)return!1;let h=gZ(o);if(i.add(h),Object.is(n,h))break}}return!0}function gZ(e){return e!==null&&typeof e=="object"?e.valueOf():e}function gB(e,t){return k3(t,e)}function _B(...e){let t=new Cc;for(let r of e)for(let i of r)t.add(i);return t}function _Z(e){return e}var S6=1,E6=2,yB=3,D3=4,yZ=1e-6;function nwt(e){return"translate("+e+",0)"}function swt(e){return"translate(0,"+e+")"}function owt(e){return t=>+e(t)}function awt(e,t){return t=Math.max(0,e.bandwidth()-t*2)/2,e.round()&&(t=Math.round(t)),r=>+e(r)+t}function lwt(){return!this.__axis}function I6(e,t){var r=[],i=null,s=null,n=6,o=6,a=3,h=typeof window<"u"&&window.devicePixelRatio>1?0:.5,p=e===S6||e===D3?-1:1,g=e===D3||e===E6?"x":"y",v=e===S6||e===yB?nwt:swt;function T(C){var B=i??(t.ticks?t.ticks.apply(t,r):t.domain()),L=s??(t.tickFormat?t.tickFormat.apply(t,r):_Z),z=Math.max(n,0)+a,W=t.range(),Z=+W[0]+h,X=+W[W.length-1]+h,q=(t.bandwidth?awt:owt)(t.copy(),h),it=C.selection?C.selection():C,nt=it.selectAll(".domain").data([null]),Mt=it.selectAll(".tick").data(B,t).order(),_t=Mt.exit(),Et=Mt.enter().append("g").attr("class","tick"),vt=Mt.select("line"),Pt=Mt.select("text");nt=nt.merge(nt.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),Mt=Mt.merge(Et),vt=vt.merge(Et.append("line").attr("stroke","currentColor").attr(g+"2",p*n)),Pt=Pt.merge(Et.append("text").attr("fill","currentColor").attr(g,p*z).attr("dy",e===S6?"0em":e===yB?"0.71em":"0.32em")),C!==it&&(nt=nt.transition(C),Mt=Mt.transition(C),vt=vt.transition(C),Pt=Pt.transition(C),_t=_t.transition(C).attr("opacity",yZ).attr("transform",function(re){return isFinite(re=q(re))?v(re+h):this.getAttribute("transform")}),Et.attr("opacity",yZ).attr("transform",function(re){var $t=this.parentNode.__axis;return v(($t&&isFinite($t=$t(re))?$t:q(re))+h)})),_t.remove(),nt.attr("d",e===D3||e===E6?o?"M"+p*o+","+Z+"H"+h+"V"+X+"H"+p*o:"M"+h+","+Z+"V"+X:o?"M"+Z+","+p*o+"V"+h+"H"+X+"V"+p*o:"M"+Z+","+h+"H"+X),Mt.attr("opacity",1).attr("transform",function(re){return v(q(re)+h)}),vt.attr(g+"2",p*n),Pt.attr(g,p*z).text(L),it.filter(lwt).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",e===E6?"start":e===D3?"end":"middle"),it.each(function(){this.__axis=q})}return T.scale=function(C){return arguments.length?(t=C,T):t},T.ticks=function(){return r=Array.from(arguments),T},T.tickArguments=function(C){return arguments.length?(r=C==null?[]:Array.from(C),T):r.slice()},T.tickValues=function(C){return arguments.length?(i=C==null?null:Array.from(C),T):i&&i.slice()},T.tickFormat=function(C){return arguments.length?(s=C,T):s},T.tickSize=function(C){return arguments.length?(n=o=+C,T):n},T.tickSizeInner=function(C){return arguments.length?(n=+C,T):n},T.tickSizeOuter=function(C){return arguments.length?(o=+C,T):o},T.tickPadding=function(C){return arguments.length?(a=+C,T):a},T.offset=function(C){return arguments.length?(h=+C,T):h},T}function xZ(e){return I6(S6,e)}function bZ(e){return I6(E6,e)}function vZ(e){return I6(yB,e)}function wZ(e){return I6(D3,e)}var cwt={value:()=>{}};function SZ(){for(var e=0,t=arguments.length,r={},i;e<t;++e){if(!(i=arguments[e]+"")||i in r||/[\s.]/.test(i))throw new Error("illegal type: "+i);r[i]=[]}return new M6(r)}function M6(e){this._=e}function uwt(e,t){return e.trim().split(/^|\s+/).map(function(r){var i="",s=r.indexOf(".");if(s>=0&&(i=r.slice(s+1),r=r.slice(0,s)),r&&!t.hasOwnProperty(r))throw new Error("unknown type: "+r);return{type:r,name:i}})}M6.prototype=SZ.prototype={constructor:M6,on:function(e,t){var r=this._,i=uwt(e+"",r),s,n=-1,o=i.length;if(arguments.length<2){for(;++n<o;)if((s=(e=i[n]).type)&&(s=hwt(r[s],e.name)))return s;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++n<o;)if(s=(e=i[n]).type)r[s]=TZ(r[s],e.name,t);else if(t==null)for(s in r)r[s]=TZ(r[s],e.name,null);return this},copy:function(){var e={},t=this._;for(var r in t)e[r]=t[r].slice();return new M6(e)},call:function(e,t){if((s=arguments.length-2)>0)for(var r=new Array(s),i=0,s,n;i<s;++i)r[i]=arguments[i+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(n=this._[e],i=0,s=n.length;i<s;++i)n[i].value.apply(t,r)},apply:function(e,t,r){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var i=this._[e],s=0,n=i.length;s<n;++s)i[s].value.apply(t,r)}};function hwt(e,t){for(var r=0,i=e.length,s;r<i;++r)if((s=e[r]).name===t)return s.value}function TZ(e,t,r){for(var i=0,s=e.length;i<s;++i)if(e[i].name===t){e[i]=cwt,e=e.slice(0,i).concat(e.slice(i+1));break}return r!=null&&e.push({name:t,value:r}),e}var rh=SZ;var C6="http://www.w3.org/1999/xhtml",O3={svg:"http://www.w3.org/2000/svg",xhtml:C6,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function dp(e){var t=e+="",r=t.indexOf(":");return r>=0&&(t=e.slice(0,r))!=="xmlns"&&(e=e.slice(r+1)),O3.hasOwnProperty(t)?{space:O3[t],local:e}:e}function fwt(e){return function(){var t=this.ownerDocument,r=this.namespaceURI;return r===C6&&t.documentElement.namespaceURI===C6?t.createElement(e):t.createElementNS(r,e)}}function pwt(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Xm(e){var t=dp(e);return(t.local?pwt:fwt)(t)}function dwt(){}function Zm(e){return e==null?dwt:function(){return this.querySelector(e)}}function EZ(e){typeof e!="function"&&(e=Zm(e));for(var t=this._groups,r=t.length,i=new Array(r),s=0;s<r;++s)for(var n=t[s],o=n.length,a=i[s]=new Array(o),h,p,g=0;g<o;++g)(h=n[g])&&(p=e.call(h,h.__data__,g,n))&&("__data__"in h&&(p.__data__=h.__data__),a[g]=p);return new Bs(i,this._parents)}function B3(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function mwt(){return[]}function P2(e){return e==null?mwt:function(){return this.querySelectorAll(e)}}function Awt(e){return function(){return B3(e.apply(this,arguments))}}function IZ(e){typeof e=="function"?e=Awt(e):e=P2(e);for(var t=this._groups,r=t.length,i=[],s=[],n=0;n<r;++n)for(var o=t[n],a=o.length,h,p=0;p<a;++p)(h=o[p])&&(i.push(e.call(h,h.__data__,p,o)),s.push(h));return new Bs(i,s)}function R2(e){return function(){return this.matches(e)}}function P6(e){return function(t){return t.matches(e)}}var gwt=Array.prototype.find;function _wt(e){return function(){return gwt.call(this.children,e)}}function ywt(){return this.firstElementChild}function MZ(e){return this.select(e==null?ywt:_wt(typeof e=="function"?e:P6(e)))}var xwt=Array.prototype.filter;function bwt(){return Array.from(this.children)}function vwt(e){return function(){return xwt.call(this.children,e)}}function CZ(e){return this.selectAll(e==null?bwt:vwt(typeof e=="function"?e:P6(e)))}function PZ(e){typeof e!="function"&&(e=R2(e));for(var t=this._groups,r=t.length,i=new Array(r),s=0;s<r;++s)for(var n=t[s],o=n.length,a=i[s]=[],h,p=0;p<o;++p)(h=n[p])&&e.call(h,h.__data__,p,n)&&a.push(h);return new Bs(i,this._parents)}function R6(e){return new Array(e.length)}function RZ(){return new Bs(this._enter||this._groups.map(R6),this._parents)}function N3(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}N3.prototype={constructor:N3,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function kZ(e){return function(){return e}}function wwt(e,t,r,i,s,n){for(var o=0,a,h=t.length,p=n.length;o<p;++o)(a=t[o])?(a.__data__=n[o],i[o]=a):r[o]=new N3(e,n[o]);for(;o<h;++o)(a=t[o])&&(s[o]=a)}function Twt(e,t,r,i,s,n,o){var a,h,p=new Map,g=t.length,v=n.length,T=new Array(g),C;for(a=0;a<g;++a)(h=t[a])&&(T[a]=C=o.call(h,h.__data__,a,t)+"",p.has(C)?s[a]=h:p.set(C,h));for(a=0;a<v;++a)C=o.call(e,n[a],a,n)+"",(h=p.get(C))?(i[a]=h,h.__data__=n[a],p.delete(C)):r[a]=new N3(e,n[a]);for(a=0;a<g;++a)(h=t[a])&&p.get(T[a])===h&&(s[a]=h)}function Swt(e){return e.__data__}function DZ(e,t){if(!arguments.length)return Array.from(this,Swt);var r=t?Twt:wwt,i=this._parents,s=this._groups;typeof e!="function"&&(e=kZ(e));for(var n=s.length,o=new Array(n),a=new Array(n),h=new Array(n),p=0;p<n;++p){var g=i[p],v=s[p],T=v.length,C=Ewt(e.call(g,g&&g.__data__,p,i)),B=C.length,L=a[p]=new Array(B),z=o[p]=new Array(B),W=h[p]=new Array(T);r(g,v,L,z,W,C,t);for(var Z=0,X=0,q,it;Z<B;++Z)if(q=L[Z]){for(Z>=X&&(X=Z+1);!(it=z[X])&&++X<B;);q._next=it||null}}return o=new Bs(o,i),o._enter=a,o._exit=h,o}function Ewt(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function OZ(){return new Bs(this._exit||this._groups.map(R6),this._parents)}function BZ(e,t,r){var i=this.enter(),s=this,n=this.exit();return typeof e=="function"?(i=e(i),i&&(i=i.selection())):i=i.append(e+""),t!=null&&(s=t(s),s&&(s=s.selection())),r==null?n.remove():r(n),i&&s?i.merge(s).order():s}function NZ(e){for(var t=e.selection?e.selection():e,r=this._groups,i=t._groups,s=r.length,n=i.length,o=Math.min(s,n),a=new Array(s),h=0;h<o;++h)for(var p=r[h],g=i[h],v=p.length,T=a[h]=new Array(v),C,B=0;B<v;++B)(C=p[B]||g[B])&&(T[B]=C);for(;h<s;++h)a[h]=r[h];return new Bs(a,this._parents)}function LZ(){for(var e=this._groups,t=-1,r=e.length;++t<r;)for(var i=e[t],s=i.length-1,n=i[s],o;--s>=0;)(o=i[s])&&(n&&o.compareDocumentPosition(n)^4&&n.parentNode.insertBefore(o,n),n=o);return this}function FZ(e){e||(e=Iwt);function t(v,T){return v&&T?e(v.__data__,T.__data__):!v-!T}for(var r=this._groups,i=r.length,s=new Array(i),n=0;n<i;++n){for(var o=r[n],a=o.length,h=s[n]=new Array(a),p,g=0;g<a;++g)(p=o[g])&&(h[g]=p);h.sort(t)}return new Bs(s,this._parents).order()}function Iwt(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function zZ(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function UZ(){return Array.from(this)}function VZ(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var i=e[t],s=0,n=i.length;s<n;++s){var o=i[s];if(o)return o}return null}function jZ(){let e=0;for(let t of this)++e;return e}function WZ(){return!this.node()}function $Z(e){for(var t=this._groups,r=0,i=t.length;r<i;++r)for(var s=t[r],n=0,o=s.length,a;n<o;++n)(a=s[n])&&e.call(a,a.__data__,n,s);return this}function Mwt(e){return function(){this.removeAttribute(e)}}function Cwt(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Pwt(e,t){return function(){this.setAttribute(e,t)}}function Rwt(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function kwt(e,t){return function(){var r=t.apply(this,arguments);r==null?this.removeAttribute(e):this.setAttribute(e,r)}}function Dwt(e,t){return function(){var r=t.apply(this,arguments);r==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,r)}}function HZ(e,t){var r=dp(e);if(arguments.length<2){var i=this.node();return r.local?i.getAttributeNS(r.space,r.local):i.getAttribute(r)}return this.each((t==null?r.local?Cwt:Mwt:typeof t=="function"?r.local?Dwt:kwt:r.local?Rwt:Pwt)(r,t))}function k2(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function Owt(e){return function(){this.style.removeProperty(e)}}function Bwt(e,t,r){return function(){this.style.setProperty(e,t,r)}}function Nwt(e,t,r){return function(){var i=t.apply(this,arguments);i==null?this.style.removeProperty(e):this.style.setProperty(e,i,r)}}function qZ(e,t,r){return arguments.length>1?this.each((t==null?Owt:typeof t=="function"?Nwt:Bwt)(e,t,r??"")):Jd(this.node(),e)}function Jd(e,t){return e.style.getPropertyValue(t)||k2(e).getComputedStyle(e,null).getPropertyValue(t)}function Lwt(e){return function(){delete this[e]}}function Fwt(e,t){return function(){this[e]=t}}function zwt(e,t){return function(){var r=t.apply(this,arguments);r==null?delete this[e]:this[e]=r}}function YZ(e,t){return arguments.length>1?this.each((t==null?Lwt:typeof t=="function"?zwt:Fwt)(e,t)):this.node()[e]}function XZ(e){return e.trim().split(/^|\s+/)}function xB(e){return e.classList||new ZZ(e)}function ZZ(e){this._node=e,this._names=XZ(e.getAttribute("class")||"")}ZZ.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function GZ(e,t){for(var r=xB(e),i=-1,s=t.length;++i<s;)r.add(t[i])}function QZ(e,t){for(var r=xB(e),i=-1,s=t.length;++i<s;)r.remove(t[i])}function Uwt(e){return function(){GZ(this,e)}}function Vwt(e){return function(){QZ(this,e)}}function jwt(e,t){return function(){(t.apply(this,arguments)?GZ:QZ)(this,e)}}function KZ(e,t){var r=XZ(e+"");if(arguments.length<2){for(var i=xB(this.node()),s=-1,n=r.length;++s<n;)if(!i.contains(r[s]))return!1;return!0}return this.each((typeof t=="function"?jwt:t?Uwt:Vwt)(r,t))}function Wwt(){this.textContent=""}function $wt(e){return function(){this.textContent=e}}function Hwt(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function JZ(e){return arguments.length?this.each(e==null?Wwt:(typeof e=="function"?Hwt:$wt)(e)):this.node().textContent}function qwt(){this.innerHTML=""}function Ywt(e){return function(){this.innerHTML=e}}function Xwt(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function tG(e){return arguments.length?this.each(e==null?qwt:(typeof e=="function"?Xwt:Ywt)(e)):this.node().innerHTML}function Zwt(){this.nextSibling&&this.parentNode.appendChild(this)}function eG(){return this.each(Zwt)}function Gwt(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function rG(){return this.each(Gwt)}function iG(e){var t=typeof e=="function"?e:Xm(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function Qwt(){return null}function nG(e,t){var r=typeof e=="function"?e:Xm(e),i=t==null?Qwt:typeof t=="function"?t:Zm(t);return this.select(function(){return this.insertBefore(r.apply(this,arguments),i.apply(this,arguments)||null)})}function Kwt(){var e=this.parentNode;e&&e.removeChild(this)}function sG(){return this.each(Kwt)}function Jwt(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function t3t(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function oG(e){return this.select(e?t3t:Jwt)}function aG(e){return arguments.length?this.property("__data__",e):this.node().__data__}function e3t(e){return function(t){e.call(this,t,this.__data__)}}function r3t(e){return e.trim().split(/^|\s+/).map(function(t){var r="",i=t.indexOf(".");return i>=0&&(r=t.slice(i+1),t=t.slice(0,i)),{type:t,name:r}})}function i3t(e){return function(){var t=this.__on;if(t){for(var r=0,i=-1,s=t.length,n;r<s;++r)n=t[r],(!e.type||n.type===e.type)&&n.name===e.name?this.removeEventListener(n.type,n.listener,n.options):t[++i]=n;++i?t.length=i:delete this.__on}}}function n3t(e,t,r){return function(){var i=this.__on,s,n=e3t(t);if(i){for(var o=0,a=i.length;o<a;++o)if((s=i[o]).type===e.type&&s.name===e.name){this.removeEventListener(s.type,s.listener,s.options),this.addEventListener(s.type,s.listener=n,s.options=r),s.value=t;return}}this.addEventListener(e.type,n,r),s={type:e.type,name:e.name,value:t,listener:n,options:r},i?i.push(s):this.__on=[s]}}function lG(e,t,r){var i=r3t(e+""),s,n=i.length,o;if(arguments.length<2){var a=this.node().__on;if(a){for(var h=0,p=a.length,g;h<p;++h)for(s=0,g=a[h];s<n;++s)if((o=i[s]).type===g.type&&o.name===g.name)return g.value}return}for(a=t?n3t:i3t,s=0;s<n;++s)this.each(a(i[s],t,r));return this}function cG(e,t,r){var i=k2(e),s=i.CustomEvent;typeof s=="function"?s=new s(t,r):(s=i.document.createEvent("Event"),r?(s.initEvent(t,r.bubbles,r.cancelable),s.detail=r.detail):s.initEvent(t,!1,!1)),e.dispatchEvent(s)}function s3t(e,t){return function(){return cG(this,e,t)}}function o3t(e,t){return function(){return cG(this,e,t.apply(this,arguments))}}function uG(e,t){return this.each((typeof t=="function"?o3t:s3t)(e,t))}function*hG(){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var i=e[t],s=0,n=i.length,o;s<n;++s)(o=i[s])&&(yield o)}var L3=[null];function Bs(e,t){this._groups=e,this._parents=t}function fG(){return new Bs([[document.documentElement]],L3)}function a3t(){return this}Bs.prototype=fG.prototype={constructor:Bs,select:EZ,selectAll:IZ,selectChild:MZ,selectChildren:CZ,filter:PZ,data:DZ,enter:RZ,exit:OZ,join:BZ,merge:NZ,selection:a3t,order:LZ,sort:FZ,call:zZ,nodes:UZ,node:VZ,size:jZ,empty:WZ,each:$Z,attr:HZ,style:qZ,property:YZ,classed:KZ,text:JZ,html:tG,raise:eG,lower:rG,append:iG,insert:nG,remove:sG,clone:oG,datum:aG,on:lG,dispatch:uG,[Symbol.iterator]:hG};var mp=fG;function po(e){return typeof e=="string"?new Bs([[document.querySelector(e)]],[document.documentElement]):new Bs([[e]],L3)}function pG(e){return po(Xm(e).call(document.documentElement))}var l3t=0;function k6(){return new bB}function bB(){this._="@"+(++l3t).toString(36)}bB.prototype=k6.prototype={constructor:bB,get:function(e){for(var t=this._;!(t in e);)if(!(e=e.parentNode))return;return e[t]},set:function(e,t){return e[this._]=t},remove:function(e){return this._ in e&&delete e[this._]},toString:function(){return this._}};function D6(e){let t;for(;t=e.sourceEvent;)e=t;return e}function xa(e,t){if(e=D6(e),t===void 0&&(t=e.currentTarget),t){var r=t.ownerSVGElement||t;if(r.createSVGPoint){var i=r.createSVGPoint();return i.x=e.clientX,i.y=e.clientY,i=i.matrixTransform(t.getScreenCTM().inverse()),[i.x,i.y]}if(t.getBoundingClientRect){var s=t.getBoundingClientRect();return[e.clientX-s.left-t.clientLeft,e.clientY-s.top-t.clientTop]}}return[e.pageX,e.pageY]}function dG(e,t){return e.target&&(e=D6(e),t===void 0&&(t=e.currentTarget),e=e.touches||[e]),Array.from(e,r=>xa(r,t))}function mG(e){return typeof e=="string"?new Bs([document.querySelectorAll(e)],[document.documentElement]):new Bs([B3(e)],L3)}var AG={passive:!1},v1={capture:!0,passive:!1};function O6(e){e.stopImmediatePropagation()}function Gm(e){e.preventDefault(),e.stopImmediatePropagation()}function Qm(e){var t=e.document.documentElement,r=po(e).on("dragstart.drag",Gm,v1);"onselectstart"in t?r.on("selectstart.drag",Gm,v1):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function Km(e,t){var r=e.document.documentElement,i=po(e).on("dragstart.drag",null);t&&(i.on("click.drag",Gm,v1),setTimeout(function(){i.on("click.drag",null)},0)),"onselectstart"in r?i.on("selectstart.drag",null):(r.style.MozUserSelect=r.__noselect,delete r.__noselect)}var F3=e=>()=>e;function z3(e,{sourceEvent:t,subject:r,target:i,identifier:s,active:n,x:o,y:a,dx:h,dy:p,dispatch:g}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:r,enumerable:!0,configurable:!0},target:{value:i,enumerable:!0,configurable:!0},identifier:{value:s,enumerable:!0,configurable:!0},active:{value:n,enumerable:!0,configurable:!0},x:{value:o,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:h,enumerable:!0,configurable:!0},dy:{value:p,enumerable:!0,configurable:!0},_:{value:g}})}z3.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function c3t(e){return!e.ctrlKey&&!e.button}function u3t(){return this.parentNode}function h3t(e,t){return t??{x:e.x,y:e.y}}function f3t(){return navigator.maxTouchPoints||"ontouchstart"in this}function gG(){var e=c3t,t=u3t,r=h3t,i=f3t,s={},n=rh("start","drag","end"),o=0,a,h,p,g,v=0;function T(q){q.on("mousedown.drag",C).filter(i).on("touchstart.drag",z).on("touchmove.drag",W,AG).on("touchend.drag touchcancel.drag",Z).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function C(q,it){if(!(g||!e.call(this,q,it))){var nt=X(this,t.call(this,q,it),q,it,"mouse");nt&&(po(q.view).on("mousemove.drag",B,v1).on("mouseup.drag",L,v1),Qm(q.view),O6(q),p=!1,a=q.clientX,h=q.clientY,nt("start",q))}}function B(q){if(Gm(q),!p){var it=q.clientX-a,nt=q.clientY-h;p=it*it+nt*nt>v}s.mouse("drag",q)}function L(q){po(q.view).on("mousemove.drag mouseup.drag",null),Km(q.view,p),Gm(q),s.mouse("end",q)}function z(q,it){if(e.call(this,q,it)){var nt=q.changedTouches,Mt=t.call(this,q,it),_t=nt.length,Et,vt;for(Et=0;Et<_t;++Et)(vt=X(this,Mt,q,it,nt[Et].identifier,nt[Et]))&&(O6(q),vt("start",q,nt[Et]))}}function W(q){var it=q.changedTouches,nt=it.length,Mt,_t;for(Mt=0;Mt<nt;++Mt)(_t=s[it[Mt].identifier])&&(Gm(q),_t("drag",q,it[Mt]))}function Z(q){var it=q.changedTouches,nt=it.length,Mt,_t;for(g&&clearTimeout(g),g=setTimeout(function(){g=null},500),Mt=0;Mt<nt;++Mt)(_t=s[it[Mt].identifier])&&(O6(q),_t("end",q,it[Mt]))}function X(q,it,nt,Mt,_t,Et){var vt=n.copy(),Pt=xa(Et||nt,it),re,$t,xt;if((xt=r.call(q,new z3("beforestart",{sourceEvent:nt,target:T,identifier:_t,active:o,x:Pt[0],y:Pt[1],dx:0,dy:0,dispatch:vt}),Mt))!=null)return re=xt.x-Pt[0]||0,$t=xt.y-Pt[1]||0,function Vt(qt,de,Ee){var Se=Pt,ze;switch(qt){case"start":s[_t]=Vt,ze=o++;break;case"end":delete s[_t],--o;case"drag":Pt=xa(Ee||de,it),ze=o;break}vt.call(qt,q,new z3(qt,{sourceEvent:de,subject:xt,target:T,identifier:_t,active:ze,x:Pt[0]+re,y:Pt[1]+$t,dx:Pt[0]-Se[0],dy:Pt[1]-Se[1],dispatch:vt}),Mt)}}return T.filter=function(q){return arguments.length?(e=typeof q=="function"?q:F3(!!q),T):e},T.container=function(q){return arguments.length?(t=typeof q=="function"?q:F3(q),T):t},T.subject=function(q){return arguments.length?(r=typeof q=="function"?q:F3(q),T):r},T.touchable=function(q){return arguments.length?(i=typeof q=="function"?q:F3(!!q),T):i},T.on=function(){var q=n.on.apply(n,arguments);return q===n?T:q},T.clickDistance=function(q){return arguments.length?(v=(q=+q)*q,T):Math.sqrt(v)},T}function t0(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function Jm(e,t){var r=Object.create(e.prototype);for(var i in t)r[i]=t[i];return r}function gp(){}var tA=.7,S1=1/tA,D2="\\s*([+-]?\\d+)\\s*",U3="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ap="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",p3t=/^#([0-9a-f]{3,8})$/,d3t=new RegExp(`^rgb\\(${D2},${D2},${D2}\\)$`),m3t=new RegExp(`^rgb\\(${Ap},${Ap},${Ap}\\)$`),A3t=new RegExp(`^rgba\\(${D2},${D2},${D2},${U3}\\)$`),g3t=new RegExp(`^rgba\\(${Ap},${Ap},${Ap},${U3}\\)$`),_3t=new RegExp(`^hsl\\(${U3},${Ap},${Ap}\\)$`),y3t=new RegExp(`^hsla\\(${U3},${Ap},${Ap},${U3}\\)$`),_G={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};t0(gp,Rc,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:yG,formatHex:yG,formatHex8:x3t,formatHsl:b3t,formatRgb:xG,toString:xG});function yG(){return this.rgb().formatHex()}function x3t(){return this.rgb().formatHex8()}function b3t(){return EG(this).formatHsl()}function xG(){return this.rgb().formatRgb()}function Rc(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=p3t.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?bG(t):r===3?new Ho(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?B6(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?B6(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=d3t.exec(e))?new Ho(t[1],t[2],t[3],1):(t=m3t.exec(e))?new Ho(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=A3t.exec(e))?B6(t[1],t[2],t[3],t[4]):(t=g3t.exec(e))?B6(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=_3t.exec(e))?TG(t[1],t[2]/100,t[3]/100,1):(t=y3t.exec(e))?TG(t[1],t[2]/100,t[3]/100,t[4]):_G.hasOwnProperty(e)?bG(_G[e]):e==="transparent"?new Ho(NaN,NaN,NaN,0):null}function bG(e){return new Ho(e>>16&255,e>>8&255,e&255,1)}function B6(e,t,r,i){return i<=0&&(e=t=r=NaN),new Ho(e,t,r,i)}function V3(e){return e instanceof gp||(e=Rc(e)),e?(e=e.rgb(),new Ho(e.r,e.g,e.b,e.opacity)):new Ho}function e0(e,t,r,i){return arguments.length===1?V3(e):new Ho(e,t,r,i??1)}function Ho(e,t,r,i){this.r=+e,this.g=+t,this.b=+r,this.opacity=+i}t0(Ho,e0,Jm(gp,{brighter(e){return e=e==null?S1:Math.pow(S1,e),new Ho(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?tA:Math.pow(tA,e),new Ho(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Ho(T1(this.r),T1(this.g),T1(this.b),L6(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:vG,formatHex:vG,formatHex8:v3t,formatRgb:wG,toString:wG}));function vG(){return`#${w1(this.r)}${w1(this.g)}${w1(this.b)}`}function v3t(){return`#${w1(this.r)}${w1(this.g)}${w1(this.b)}${w1((isNaN(this.opacity)?1:this.opacity)*255)}`}function wG(){let e=L6(this.opacity);return`${e===1?"rgb(":"rgba("}${T1(this.r)}, ${T1(this.g)}, ${T1(this.b)}${e===1?")":`, ${e})`}`}function L6(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function T1(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function w1(e){return e=T1(e),(e<16?"0":"")+e.toString(16)}function TG(e,t,r,i){return i<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new af(e,t,r,i)}function EG(e){if(e instanceof af)return new af(e.h,e.s,e.l,e.opacity);if(e instanceof gp||(e=Rc(e)),!e)return new af;if(e instanceof af)return e;e=e.rgb();var t=e.r/255,r=e.g/255,i=e.b/255,s=Math.min(t,r,i),n=Math.max(t,r,i),o=NaN,a=n-s,h=(n+s)/2;return a?(t===n?o=(r-i)/a+(r<i)*6:r===n?o=(i-t)/a+2:o=(t-r)/a+4,a/=h<.5?n+s:2-n-s,o*=60):a=h>0&&h<1?0:o,new af(o,a,h,e.opacity)}function O2(e,t,r,i){return arguments.length===1?EG(e):new af(e,t,r,i??1)}function af(e,t,r,i){this.h=+e,this.s=+t,this.l=+r,this.opacity=+i}t0(af,O2,Jm(gp,{brighter(e){return e=e==null?S1:Math.pow(S1,e),new af(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?tA:Math.pow(tA,e),new af(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,i=r+(r<.5?r:1-r)*t,s=2*r-i;return new Ho(vB(e>=240?e-240:e+120,s,i),vB(e,s,i),vB(e<120?e+240:e-120,s,i),this.opacity)},clamp(){return new af(SG(this.h),N6(this.s),N6(this.l),L6(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){let e=L6(this.opacity);return`${e===1?"hsl(":"hsla("}${SG(this.h)}, ${N6(this.s)*100}%, ${N6(this.l)*100}%${e===1?")":`, ${e})`}`}}));function SG(e){return e=(e||0)%360,e<0?e+360:e}function N6(e){return Math.max(0,Math.min(1,e||0))}function vB(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}var F6=Math.PI/180,z6=180/Math.PI;var U6=18,IG=.96422,MG=1,CG=.82521,PG=4/29,B2=6/29,RG=3*B2*B2,w3t=B2*B2*B2;function kG(e){if(e instanceof lf)return new lf(e.l,e.a,e.b,e.opacity);if(e instanceof _p)return NG(e);e instanceof Ho||(e=V3(e));var t=EB(e.r),r=EB(e.g),i=EB(e.b),s=wB((.2225045*t+.7168786*r+.0606169*i)/MG),n,o;return t===r&&r===i?n=o=s:(n=wB((.4360747*t+.3850649*r+.1430804*i)/IG),o=wB((.0139322*t+.0971045*r+.7141733*i)/CG)),new lf(116*s-16,500*(n-s),200*(s-o),e.opacity)}function DG(e,t){return new lf(e,0,0,t??1)}function E1(e,t,r,i){return arguments.length===1?kG(e):new lf(e,t,r,i??1)}function lf(e,t,r,i){this.l=+e,this.a=+t,this.b=+r,this.opacity=+i}t0(lf,E1,Jm(gp,{brighter(e){return new lf(this.l+U6*(e??1),this.a,this.b,this.opacity)},darker(e){return new lf(this.l-U6*(e??1),this.a,this.b,this.opacity)},rgb(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,r=isNaN(this.b)?e:e-this.b/200;return t=IG*TB(t),e=MG*TB(e),r=CG*TB(r),new Ho(SB(3.1338561*t-1.6168667*e-.4906146*r),SB(-.9787684*t+1.9161415*e+.033454*r),SB(.0719453*t-.2289914*e+1.4052427*r),this.opacity)}}));function wB(e){return e>w3t?Math.pow(e,1/3):e/RG+PG}function TB(e){return e>B2?e*e*e:RG*(e-PG)}function SB(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function EB(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function OG(e){if(e instanceof _p)return new _p(e.h,e.c,e.l,e.opacity);if(e instanceof lf||(e=kG(e)),e.a===0&&e.b===0)return new _p(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*z6;return new _p(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function BG(e,t,r,i){return arguments.length===1?OG(e):new _p(r,t,e,i??1)}function N2(e,t,r,i){return arguments.length===1?OG(e):new _p(e,t,r,i??1)}function _p(e,t,r,i){this.h=+e,this.c=+t,this.l=+r,this.opacity=+i}function NG(e){if(isNaN(e.h))return new lf(e.l,0,0,e.opacity);var t=e.h*F6;return new lf(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}t0(_p,N2,Jm(gp,{brighter(e){return new _p(this.h,this.c,this.l+U6*(e??1),this.opacity)},darker(e){return new _p(this.h,this.c,this.l-U6*(e??1),this.opacity)},rgb(){return NG(this).rgb()}}));var UG=-.14861,IB=1.78277,MB=-.29227,V6=-.90649,j3=1.97294,LG=j3*V6,FG=j3*IB,zG=IB*MB-V6*UG;function T3t(e){if(e instanceof I1)return new I1(e.h,e.s,e.l,e.opacity);e instanceof Ho||(e=V3(e));var t=e.r/255,r=e.g/255,i=e.b/255,s=(zG*i+LG*t-FG*r)/(zG+LG-FG),n=i-s,o=(j3*(r-s)-MB*n)/V6,a=Math.sqrt(o*o+n*n)/(j3*s*(1-s)),h=a?Math.atan2(o,n)*z6-120:NaN;return new I1(h<0?h+360:h,a,s,e.opacity)}function bl(e,t,r,i){return arguments.length===1?T3t(e):new I1(e,t,r,i??1)}function I1(e,t,r,i){this.h=+e,this.s=+t,this.l=+r,this.opacity=+i}t0(I1,bl,Jm(gp,{brighter(e){return e=e==null?S1:Math.pow(S1,e),new I1(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?tA:Math.pow(tA,e),new I1(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=isNaN(this.h)?0:(this.h+120)*F6,t=+this.l,r=isNaN(this.s)?0:this.s*t*(1-t),i=Math.cos(e),s=Math.sin(e);return new Ho(255*(t+r*(UG*i+IB*s)),255*(t+r*(MB*i+V6*s)),255*(t+r*(j3*i)),this.opacity)}}));function CB(e,t,r,i,s){var n=e*e,o=n*e;return((1-3*e+3*n-o)*t+(4-6*n+3*o)*r+(1+3*e+3*n-3*o)*i+o*s)/6}function j6(e){var t=e.length-1;return function(r){var i=r<=0?r=0:r>=1?(r=1,t-1):Math.floor(r*t),s=e[i],n=e[i+1],o=i>0?e[i-1]:2*s-n,a=i<t-1?e[i+2]:2*n-s;return CB((r-i/t)*t,o,s,n,a)}}function W6(e){var t=e.length;return function(r){var i=Math.floor(((r%=1)<0?++r:r)*t),s=e[(i+t-1)%t],n=e[i%t],o=e[(i+1)%t],a=e[(i+2)%t];return CB((r-i/t)*t,s,n,o,a)}}var L2=e=>()=>e;function VG(e,t){return function(r){return e+r*t}}function S3t(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(i){return Math.pow(e+i*t,r)}}function eA(e,t){var r=t-e;return r?VG(e,r>180||r<-180?r-360*Math.round(r/360):r):L2(isNaN(e)?t:e)}function jG(e){return(e=+e)==1?Ws:function(t,r){return r-t?S3t(t,r,e):L2(isNaN(t)?r:t)}}function Ws(e,t){var r=t-e;return r?VG(e,r):L2(isNaN(e)?t:e)}var rA=function e(t){var r=jG(t);function i(s,n){var o=r((s=e0(s)).r,(n=e0(n)).r),a=r(s.g,n.g),h=r(s.b,n.b),p=Ws(s.opacity,n.opacity);return function(g){return s.r=o(g),s.g=a(g),s.b=h(g),s.opacity=p(g),s+""}}return i.gamma=e,i}(1);function WG(e){return function(t){var r=t.length,i=new Array(r),s=new Array(r),n=new Array(r),o,a;for(o=0;o<r;++o)a=e0(t[o]),i[o]=a.r||0,s[o]=a.g||0,n[o]=a.b||0;return i=e(i),s=e(s),n=e(n),a.opacity=1,function(h){return a.r=i(h),a.g=s(h),a.b=n(h),a+""}}}var $6=WG(j6),$G=WG(W6);function F2(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,i=t.slice(),s;return function(n){for(s=0;s<r;++s)i[s]=e[s]*(1-n)+t[s]*n;return i}}function H6(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function HG(e,t){return(H6(t)?F2:PB)(e,t)}function PB(e,t){var r=t?t.length:0,i=e?Math.min(r,e.length):0,s=new Array(i),n=new Array(r),o;for(o=0;o<i;++o)s[o]=vl(e[o],t[o]);for(;o<r;++o)n[o]=t[o];return function(a){for(o=0;o<i;++o)n[o]=s[o](a);return n}}function q6(e,t){var r=new Date;return e=+e,t=+t,function(i){return r.setTime(e*(1-i)+t*i),r}}function ba(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function Y6(e,t){var r={},i={},s;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(s in t)s in e?r[s]=vl(e[s],t[s]):i[s]=t[s];return function(n){for(s in r)i[s]=r[s](n);return i}}var kB=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,RB=new RegExp(kB.source,"g");function E3t(e){return function(){return e}}function I3t(e){return function(t){return e(t)+""}}function z2(e,t){var r=kB.lastIndex=RB.lastIndex=0,i,s,n,o=-1,a=[],h=[];for(e=e+"",t=t+"";(i=kB.exec(e))&&(s=RB.exec(t));)(n=s.index)>r&&(n=t.slice(r,n),a[o]?a[o]+=n:a[++o]=n),(i=i[0])===(s=s[0])?a[o]?a[o]+=s:a[++o]=s:(a[++o]=null,h.push({i:o,x:ba(i,s)})),r=RB.lastIndex;return r<t.length&&(n=t.slice(r),a[o]?a[o]+=n:a[++o]=n),a.length<2?h[0]?I3t(h[0].x):E3t(t):(t=h.length,function(p){for(var g=0,v;g<t;++g)a[(v=h[g]).i]=v.x(p);return a.join("")})}function vl(e,t){var r=typeof t,i;return t==null||r==="boolean"?L2(t):(r==="number"?ba:r==="string"?(i=Rc(t))?(t=i,rA):z2:t instanceof Rc?rA:t instanceof Date?q6:H6(t)?F2:Array.isArray(t)?PB:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?Y6:ba)(e,t)}function qG(e){var t=e.length;return function(r){return e[Math.max(0,Math.min(t-1,Math.floor(r*t)))]}}function YG(e,t){var r=eA(+e,+t);return function(i){var s=r(i);return s-360*Math.floor(s/360)}}function iA(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}var XG=180/Math.PI,X6={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function DB(e,t,r,i,s,n){var o,a,h;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(h=e*r+t*i)&&(r-=e*h,i-=t*h),(a=Math.sqrt(r*r+i*i))&&(r/=a,i/=a,h/=a),e*i<t*r&&(e=-e,t=-t,h=-h,o=-o),{translateX:s,translateY:n,rotate:Math.atan2(t,e)*XG,skewX:Math.atan(h)*XG,scaleX:o,scaleY:a}}var Z6;function ZG(e){let t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?X6:DB(t.a,t.b,t.c,t.d,t.e,t.f)}function GG(e){return e==null?X6:(Z6||(Z6=document.createElementNS("http://www.w3.org/2000/svg","g")),Z6.setAttribute("transform",e),(e=Z6.transform.baseVal.consolidate())?(e=e.matrix,DB(e.a,e.b,e.c,e.d,e.e,e.f)):X6)}function QG(e,t,r,i){function s(p){return p.length?p.pop()+" ":""}function n(p,g,v,T,C,B){if(p!==v||g!==T){var L=C.push("translate(",null,t,null,r);B.push({i:L-4,x:ba(p,v)},{i:L-2,x:ba(g,T)})}else(v||T)&&C.push("translate("+v+t+T+r)}function o(p,g,v,T){p!==g?(p-g>180?g+=360:g-p>180&&(p+=360),T.push({i:v.push(s(v)+"rotate(",null,i)-2,x:ba(p,g)})):g&&v.push(s(v)+"rotate("+g+i)}function a(p,g,v,T){p!==g?T.push({i:v.push(s(v)+"skewX(",null,i)-2,x:ba(p,g)}):g&&v.push(s(v)+"skewX("+g+i)}function h(p,g,v,T,C,B){if(p!==v||g!==T){var L=C.push(s(C)+"scale(",null,",",null,")");B.push({i:L-4,x:ba(p,v)},{i:L-2,x:ba(g,T)})}else(v!==1||T!==1)&&C.push(s(C)+"scale("+v+","+T+")")}return function(p,g){var v=[],T=[];return p=e(p),g=e(g),n(p.translateX,p.translateY,g.translateX,g.translateY,v,T),o(p.rotate,g.rotate,v,T),a(p.skewX,g.skewX,v,T),h(p.scaleX,p.scaleY,g.scaleX,g.scaleY,v,T),p=g=null,function(C){for(var B=-1,L=T.length,z;++B<L;)v[(z=T[B]).i]=z.x(C);return v.join("")}}}var G6=QG(ZG,"px, ","px)","deg)"),Q6=QG(GG,", ",")",")");var M3t=1e-12;function KG(e){return((e=Math.exp(e))+1/e)/2}function C3t(e){return((e=Math.exp(e))-1/e)/2}function P3t(e){return((e=Math.exp(2*e))-1)/(e+1)}var K6=function e(t,r,i){function s(n,o){var a=n[0],h=n[1],p=n[2],g=o[0],v=o[1],T=o[2],C=g-a,B=v-h,L=C*C+B*B,z,W;if(L<M3t)W=Math.log(T/p)/t,z=function(Mt){return[a+Mt*C,h+Mt*B,p*Math.exp(t*Mt*W)]};else{var Z=Math.sqrt(L),X=(T*T-p*p+i*L)/(2*p*r*Z),q=(T*T-p*p-i*L)/(2*T*r*Z),it=Math.log(Math.sqrt(X*X+1)-X),nt=Math.log(Math.sqrt(q*q+1)-q);W=(nt-it)/t,z=function(Mt){var _t=Mt*W,Et=KG(it),vt=p/(r*Z)*(Et*P3t(t*_t+it)-C3t(it));return[a+vt*C,h+vt*B,p*Et/KG(t*_t+it)]}}return z.duration=W*1e3*t/Math.SQRT2,z}return s.rho=function(n){var o=Math.max(.001,+n),a=o*o,h=a*a;return e(o,a,h)},s}(Math.SQRT2,2,4);function JG(e){return function(t,r){var i=e((t=O2(t)).h,(r=O2(r)).h),s=Ws(t.s,r.s),n=Ws(t.l,r.l),o=Ws(t.opacity,r.opacity);return function(a){return t.h=i(a),t.s=s(a),t.l=n(a),t.opacity=o(a),t+""}}}var tQ=JG(eA),eQ=JG(Ws);function OB(e,t){var r=Ws((e=E1(e)).l,(t=E1(t)).l),i=Ws(e.a,t.a),s=Ws(e.b,t.b),n=Ws(e.opacity,t.opacity);return function(o){return e.l=r(o),e.a=i(o),e.b=s(o),e.opacity=n(o),e+""}}function rQ(e){return function(t,r){var i=e((t=N2(t)).h,(r=N2(r)).h),s=Ws(t.c,r.c),n=Ws(t.l,r.l),o=Ws(t.opacity,r.opacity);return function(a){return t.h=i(a),t.c=s(a),t.l=n(a),t.opacity=o(a),t+""}}}var iQ=rQ(eA),nQ=rQ(Ws);function sQ(e){return function t(r){r=+r;function i(s,n){var o=e((s=bl(s)).h,(n=bl(n)).h),a=Ws(s.s,n.s),h=Ws(s.l,n.l),p=Ws(s.opacity,n.opacity);return function(g){return s.h=o(g),s.s=a(g),s.l=h(Math.pow(g,r)),s.opacity=p(g),s+""}}return i.gamma=t,i}(1)}var oQ=sQ(eA),M1=sQ(Ws);function W3(e,t){t===void 0&&(t=e,e=vl);for(var r=0,i=t.length-1,s=t[0],n=new Array(i<0?0:i);r<i;)n[r]=e(s,s=t[++r]);return function(o){var a=Math.max(0,Math.min(i-1,Math.floor(o*=i)));return n[a](o-a)}}function aQ(e,t){for(var r=new Array(t),i=0;i<t;++i)r[i]=e(i/(t-1));return r}var U2=0,H3=0,$3=0,cQ=1e3,J6,q3,tI=0,C1=0,eI=0,Y3=typeof performance=="object"&&performance.now?performance:Date,uQ=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function nA(){return C1||(uQ(R3t),C1=Y3.now()+eI)}function R3t(){C1=0}function P1(){this._call=this._time=this._next=null}P1.prototype=R1.prototype={constructor:P1,restart:function(e,t,r){if(typeof e!="function")throw new TypeError("callback is not a function");r=(r==null?nA():+r)+(t==null?0:+t),!this._next&&q3!==this&&(q3?q3._next=this:J6=this,q3=this),this._call=e,this._time=r,BB()},stop:function(){this._call&&(this._call=null,this._time=1/0,BB())}};function R1(e,t,r){var i=new P1;return i.restart(e,t,r),i}function NB(){nA(),++U2;for(var e=J6,t;e;)(t=C1-e._time)>=0&&e._call.call(void 0,t),e=e._next;--U2}function lQ(){C1=(tI=Y3.now())+eI,U2=H3=0;try{NB()}finally{U2=0,D3t(),C1=0}}function k3t(){var e=Y3.now(),t=e-tI;t>cQ&&(eI-=t,tI=e)}function D3t(){for(var e,t=J6,r,i=1/0;t;)t._call?(i>t._time&&(i=t._time),e=t,t=t._next):(r=t._next,t._next=null,t=e?e._next=r:J6=r);q3=e,BB(i)}function BB(e){if(!U2){H3&&(H3=clearTimeout(H3));var t=e-C1;t>24?(e<1/0&&(H3=setTimeout(lQ,e-Y3.now()-eI)),$3&&($3=clearInterval($3))):($3||(tI=Y3.now(),$3=setInterval(k3t,cQ)),U2=1,uQ(lQ))}}function X3(e,t,r){var i=new P1;return t=t==null?0:+t,i.restart(s=>{i.stop(),e(s+t)},t,r),i}function hQ(e,t,r){var i=new P1,s=t;return t==null?(i.restart(e,t,r),i):(i._restart=i.restart,i.restart=function(n,o,a){o=+o,a=a==null?nA():+a,i._restart(function h(p){p+=s,i._restart(h,s+=o,a),n(p)},o,a)},i.restart(e,t,r),i)}var O3t=rh("start","end","cancel","interrupt"),B3t=[],pQ=0,iI=1,nI=2,rI=3,fQ=4,sI=5,Z3=6;function sA(e,t,r,i,s,n){var o=e.__transition;if(!o)e.__transition={};else if(r in o)return;N3t(e,r,{name:t,index:i,group:s,on:O3t,tween:B3t,time:n.time,delay:n.delay,duration:n.duration,ease:n.ease,timer:null,state:pQ})}function G3(e,t){var r=ea(e,t);if(r.state>pQ)throw new Error("too late; already scheduled");return r}function $a(e,t){var r=ea(e,t);if(r.state>rI)throw new Error("too late; already running");return r}function ea(e,t){var r=e.__transition;if(!r||!(r=r[t]))throw new Error("transition not found");return r}function N3t(e,t,r){var i=e.__transition,s;i[t]=r,r.timer=R1(n,0,r.time);function n(p){r.state=iI,r.timer.restart(o,r.delay,r.time),r.delay<=p&&o(p-r.delay)}function o(p){var g,v,T,C;if(r.state!==iI)return h();for(g in i)if(C=i[g],C.name===r.name){if(C.state===rI)return X3(o);C.state===fQ?(C.state=Z3,C.timer.stop(),C.on.call("interrupt",e,e.__data__,C.index,C.group),delete i[g]):+g<t&&(C.state=Z3,C.timer.stop(),C.on.call("cancel",e,e.__data__,C.index,C.group),delete i[g])}if(X3(function(){r.state===rI&&(r.state=fQ,r.timer.restart(a,r.delay,r.time),a(p))}),r.state=nI,r.on.call("start",e,e.__data__,r.index,r.group),r.state===nI){for(r.state=rI,s=new Array(T=r.tween.length),g=0,v=-1;g<T;++g)(C=r.tween[g].value.call(e,e.__data__,r.index,r.group))&&(s[++v]=C);s.length=v+1}}function a(p){for(var g=p<r.duration?r.ease.call(null,p/r.duration):(r.timer.restart(h),r.state=sI,1),v=-1,T=s.length;++v<T;)s[v].call(e,g);r.state===sI&&(r.on.call("end",e,e.__data__,r.index,r.group),h())}function h(){r.state=Z3,r.timer.stop(),delete i[t];for(var p in i)return;delete e.__transition}}function cf(e,t){var r=e.__transition,i,s,n=!0,o;if(r){t=t==null?null:t+"";for(o in r){if((i=r[o]).name!==t){n=!1;continue}s=i.state>nI&&i.state<sI,i.state=Z3,i.timer.stop(),i.on.call(s?"interrupt":"cancel",e,e.__data__,i.index,i.group),delete r[o]}n&&delete e.__transition}}function dQ(e){return this.each(function(){cf(this,e)})}function L3t(e,t){var r,i;return function(){var s=$a(this,e),n=s.tween;if(n!==r){i=r=n;for(var o=0,a=i.length;o<a;++o)if(i[o].name===t){i=i.slice(),i.splice(o,1);break}}s.tween=i}}function F3t(e,t,r){var i,s;if(typeof r!="function")throw new Error;return function(){var n=$a(this,e),o=n.tween;if(o!==i){s=(i=o).slice();for(var a={name:t,value:r},h=0,p=s.length;h<p;++h)if(s[h].name===t){s[h]=a;break}h===p&&s.push(a)}n.tween=s}}function mQ(e,t){var r=this._id;if(e+="",arguments.length<2){for(var i=ea(this.node(),r).tween,s=0,n=i.length,o;s<n;++s)if((o=i[s]).name===e)return o.value;return null}return this.each((t==null?L3t:F3t)(r,e,t))}function V2(e,t,r){var i=e._id;return e.each(function(){var s=$a(this,i);(s.value||(s.value={}))[t]=r.apply(this,arguments)}),function(s){return ea(s,i).value[t]}}function oI(e,t){var r;return(typeof t=="number"?ba:t instanceof Rc?rA:(r=Rc(t))?(t=r,rA):z2)(e,t)}function z3t(e){return function(){this.removeAttribute(e)}}function U3t(e){return function(){this.removeAttributeNS(e.space,e.local)}}function V3t(e,t,r){var i,s=r+"",n;return function(){var o=this.getAttribute(e);return o===s?null:o===i?n:n=t(i=o,r)}}function j3t(e,t,r){var i,s=r+"",n;return function(){var o=this.getAttributeNS(e.space,e.local);return o===s?null:o===i?n:n=t(i=o,r)}}function W3t(e,t,r){var i,s,n;return function(){var o,a=r(this),h;return a==null?void this.removeAttribute(e):(o=this.getAttribute(e),h=a+"",o===h?null:o===i&&h===s?n:(s=h,n=t(i=o,a)))}}function $3t(e,t,r){var i,s,n;return function(){var o,a=r(this),h;return a==null?void this.removeAttributeNS(e.space,e.local):(o=this.getAttributeNS(e.space,e.local),h=a+"",o===h?null:o===i&&h===s?n:(s=h,n=t(i=o,a)))}}function AQ(e,t){var r=dp(e),i=r==="transform"?Q6:oI;return this.attrTween(e,typeof t=="function"?(r.local?$3t:W3t)(r,i,V2(this,"attr."+e,t)):t==null?(r.local?U3t:z3t)(r):(r.local?j3t:V3t)(r,i,t))}function H3t(e,t){return function(r){this.setAttribute(e,t.call(this,r))}}function q3t(e,t){return function(r){this.setAttributeNS(e.space,e.local,t.call(this,r))}}function Y3t(e,t){var r,i;function s(){var n=t.apply(this,arguments);return n!==i&&(r=(i=n)&&q3t(e,n)),r}return s._value=t,s}function X3t(e,t){var r,i;function s(){var n=t.apply(this,arguments);return n!==i&&(r=(i=n)&&H3t(e,n)),r}return s._value=t,s}function gQ(e,t){var r="attr."+e;if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;var i=dp(e);return this.tween(r,(i.local?Y3t:X3t)(i,t))}function Z3t(e,t){return function(){G3(this,e).delay=+t.apply(this,arguments)}}function G3t(e,t){return t=+t,function(){G3(this,e).delay=t}}function _Q(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Z3t:G3t)(t,e)):ea(this.node(),t).delay}function Q3t(e,t){return function(){$a(this,e).duration=+t.apply(this,arguments)}}function K3t(e,t){return t=+t,function(){$a(this,e).duration=t}}function yQ(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Q3t:K3t)(t,e)):ea(this.node(),t).duration}function J3t(e,t){if(typeof t!="function")throw new Error;return function(){$a(this,e).ease=t}}function xQ(e){var t=this._id;return arguments.length?this.each(J3t(t,e)):ea(this.node(),t).ease}function tTt(e,t){return function(){var r=t.apply(this,arguments);if(typeof r!="function")throw new Error;$a(this,e).ease=r}}function bQ(e){if(typeof e!="function")throw new Error;return this.each(tTt(this._id,e))}function vQ(e){typeof e!="function"&&(e=R2(e));for(var t=this._groups,r=t.length,i=new Array(r),s=0;s<r;++s)for(var n=t[s],o=n.length,a=i[s]=[],h,p=0;p<o;++p)(h=n[p])&&e.call(h,h.__data__,p,n)&&a.push(h);return new Ha(i,this._parents,this._name,this._id)}function wQ(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,r=e._groups,i=t.length,s=r.length,n=Math.min(i,s),o=new Array(i),a=0;a<n;++a)for(var h=t[a],p=r[a],g=h.length,v=o[a]=new Array(g),T,C=0;C<g;++C)(T=h[C]||p[C])&&(v[C]=T);for(;a<i;++a)o[a]=t[a];return new Ha(o,this._parents,this._name,this._id)}function eTt(e){return(e+"").trim().split(/^|\s+/).every(function(t){var r=t.indexOf(".");return r>=0&&(t=t.slice(0,r)),!t||t==="start"})}function rTt(e,t,r){var i,s,n=eTt(t)?G3:$a;return function(){var o=n(this,e),a=o.on;a!==i&&(s=(i=a).copy()).on(t,r),o.on=s}}function TQ(e,t){var r=this._id;return arguments.length<2?ea(this.node(),r).on.on(e):this.each(rTt(r,e,t))}function iTt(e){return function(){var t=this.parentNode;for(var r in this.__transition)if(+r!==e)return;t&&t.removeChild(this)}}function SQ(){return this.on("end.remove",iTt(this._id))}function EQ(e){var t=this._name,r=this._id;typeof e!="function"&&(e=Zm(e));for(var i=this._groups,s=i.length,n=new Array(s),o=0;o<s;++o)for(var a=i[o],h=a.length,p=n[o]=new Array(h),g,v,T=0;T<h;++T)(g=a[T])&&(v=e.call(g,g.__data__,T,a))&&("__data__"in g&&(v.__data__=g.__data__),p[T]=v,sA(p[T],t,r,T,p,ea(g,r)));return new Ha(n,this._parents,t,r)}function IQ(e){var t=this._name,r=this._id;typeof e!="function"&&(e=P2(e));for(var i=this._groups,s=i.length,n=[],o=[],a=0;a<s;++a)for(var h=i[a],p=h.length,g,v=0;v<p;++v)if(g=h[v]){for(var T=e.call(g,g.__data__,v,h),C,B=ea(g,r),L=0,z=T.length;L<z;++L)(C=T[L])&&sA(C,t,r,L,T,B);n.push(T),o.push(g)}return new Ha(n,o,t,r)}var nTt=mp.prototype.constructor;function MQ(){return new nTt(this._groups,this._parents)}function sTt(e,t){var r,i,s;return function(){var n=Jd(this,e),o=(this.style.removeProperty(e),Jd(this,e));return n===o?null:n===r&&o===i?s:s=t(r=n,i=o)}}function CQ(e){return function(){this.style.removeProperty(e)}}function oTt(e,t,r){var i,s=r+"",n;return function(){var o=Jd(this,e);return o===s?null:o===i?n:n=t(i=o,r)}}function aTt(e,t,r){var i,s,n;return function(){var o=Jd(this,e),a=r(this),h=a+"";return a==null&&(h=a=(this.style.removeProperty(e),Jd(this,e))),o===h?null:o===i&&h===s?n:(s=h,n=t(i=o,a))}}function lTt(e,t){var r,i,s,n="style."+t,o="end."+n,a;return function(){var h=$a(this,e),p=h.on,g=h.value[n]==null?a||(a=CQ(t)):void 0;(p!==r||s!==g)&&(i=(r=p).copy()).on(o,s=g),h.on=i}}function PQ(e,t,r){var i=(e+="")=="transform"?G6:oI;return t==null?this.styleTween(e,sTt(e,i)).on("end.style."+e,CQ(e)):typeof t=="function"?this.styleTween(e,aTt(e,i,V2(this,"style."+e,t))).each(lTt(this._id,e)):this.styleTween(e,oTt(e,i,t),r).on("end.style."+e,null)}function cTt(e,t,r){return function(i){this.style.setProperty(e,t.call(this,i),r)}}function uTt(e,t,r){var i,s;function n(){var o=t.apply(this,arguments);return o!==s&&(i=(s=o)&&cTt(e,o,r)),i}return n._value=t,n}function RQ(e,t,r){var i="style."+(e+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(t==null)return this.tween(i,null);if(typeof t!="function")throw new Error;return this.tween(i,uTt(e,t,r??""))}function hTt(e){return function(){this.textContent=e}}function fTt(e){return function(){var t=e(this);this.textContent=t??""}}function kQ(e){return this.tween("text",typeof e=="function"?fTt(V2(this,"text",e)):hTt(e==null?"":e+""))}function pTt(e){return function(t){this.textContent=e.call(this,t)}}function dTt(e){var t,r;function i(){var s=e.apply(this,arguments);return s!==r&&(t=(r=s)&&pTt(s)),t}return i._value=e,i}function DQ(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,dTt(e))}function OQ(){for(var e=this._name,t=this._id,r=aI(),i=this._groups,s=i.length,n=0;n<s;++n)for(var o=i[n],a=o.length,h,p=0;p<a;++p)if(h=o[p]){var g=ea(h,t);sA(h,e,r,p,o,{time:g.time+g.delay+g.duration,delay:0,duration:g.duration,ease:g.ease})}return new Ha(i,this._parents,e,r)}function BQ(){var e,t,r=this,i=r._id,s=r.size();return new Promise(function(n,o){var a={value:o},h={value:function(){--s===0&&n()}};r.each(function(){var p=$a(this,i),g=p.on;g!==e&&(t=(e=g).copy(),t._.cancel.push(a),t._.interrupt.push(a),t._.end.push(h)),p.on=t}),s===0&&n()})}var mTt=0;function Ha(e,t,r,i){this._groups=e,this._parents=t,this._name=r,this._id=i}function lI(e){return mp().transition(e)}function aI(){return++mTt}var r0=mp.prototype;Ha.prototype=lI.prototype={constructor:Ha,select:EQ,selectAll:IQ,selectChild:r0.selectChild,selectChildren:r0.selectChildren,filter:vQ,merge:wQ,selection:MQ,transition:OQ,call:r0.call,nodes:r0.nodes,node:r0.node,size:r0.size,empty:r0.empty,each:r0.each,on:TQ,attr:AQ,attrTween:gQ,style:PQ,styleTween:RQ,text:kQ,textTween:DQ,remove:SQ,tween:mQ,delay:_Q,duration:yQ,ease:xQ,easeVarying:bQ,end:BQ,[Symbol.iterator]:r0[Symbol.iterator]};var NQ=e=>+e;function LQ(e){return e*e}function FQ(e){return e*(2-e)}function LB(e){return((e*=2)<=1?e*e:--e*(2-e)+1)/2}function zQ(e){return e*e*e}function UQ(e){return--e*e*e+1}function Q3(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var FB=3,VQ=function e(t){t=+t;function r(i){return Math.pow(i,t)}return r.exponent=e,r}(FB),jQ=function e(t){t=+t;function r(i){return 1-Math.pow(1-i,t)}return r.exponent=e,r}(FB),zB=function e(t){t=+t;function r(i){return((i*=2)<=1?Math.pow(i,t):2-Math.pow(2-i,t))/2}return r.exponent=e,r}(FB);var WQ=Math.PI,$Q=WQ/2;function HQ(e){return+e==1?1:1-Math.cos(e*$Q)}function qQ(e){return Math.sin(e*$Q)}function UB(e){return(1-Math.cos(WQ*e))/2}function yp(e){return(Math.pow(2,-10*e)-.0009765625)*1.0009775171065494}function YQ(e){return yp(1-+e)}function XQ(e){return 1-yp(e)}function VB(e){return((e*=2)<=1?yp(1-e):2-yp(e-1))/2}function ZQ(e){return 1-Math.sqrt(1-e*e)}function GQ(e){return Math.sqrt(1- --e*e)}function jB(e){return((e*=2)<=1?1-Math.sqrt(1-e*e):Math.sqrt(1-(e-=2)*e)+1)/2}var WB=.36363636363636365,ATt=6/11,gTt=8/11,_Tt=3/4,yTt=9/11,xTt=10/11,bTt=15/16,vTt=21/22,wTt=63/64,cI=1/WB/WB;function QQ(e){return 1-j2(1-e)}function j2(e){return(e=+e)<WB?cI*e*e:e<gTt?cI*(e-=ATt)*e+_Tt:e<xTt?cI*(e-=yTt)*e+bTt:cI*(e-=vTt)*e+wTt}function KQ(e){return((e*=2)<=1?1-j2(1-e):j2(e-1)+1)/2}var $B=1.70158,JQ=function e(t){t=+t;function r(i){return(i=+i)*i*(t*(i-1)+i)}return r.overshoot=e,r}($B),tK=function e(t){t=+t;function r(i){return--i*i*((i+1)*t+i)+1}return r.overshoot=e,r}($B),HB=function e(t){t=+t;function r(i){return((i*=2)<1?i*i*((t+1)*i-t):(i-=2)*i*((t+1)*i+t)+2)/2}return r.overshoot=e,r}($B);var W2=2*Math.PI,qB=1,YB=.3,eK=function e(t,r){var i=Math.asin(1/(t=Math.max(1,t)))*(r/=W2);function s(n){return t*yp(- --n)*Math.sin((i-n)/r)}return s.amplitude=function(n){return e(n,r*W2)},s.period=function(n){return e(t,n)},s}(qB,YB),XB=function e(t,r){var i=Math.asin(1/(t=Math.max(1,t)))*(r/=W2);function s(n){return 1-t*yp(n=+n)*Math.sin((n+i)/r)}return s.amplitude=function(n){return e(n,r*W2)},s.period=function(n){return e(t,n)},s}(qB,YB),rK=function e(t,r){var i=Math.asin(1/(t=Math.max(1,t)))*(r/=W2);function s(n){return((n=n*2-1)<0?t*yp(-n)*Math.sin((i-n)/r):2-t*yp(n)*Math.sin((i+n)/r))/2}return s.amplitude=function(n){return e(n,r*W2)},s.period=function(n){return e(t,n)},s}(qB,YB);var TTt={time:null,delay:0,duration:250,ease:Q3};function STt(e,t){for(var r;!(r=e.__transition)||!(r=r[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return r}function iK(e){var t,r;e instanceof Ha?(t=e._id,e=e._name):(t=aI(),(r=TTt).time=nA(),e=e==null?null:e+"");for(var i=this._groups,s=i.length,n=0;n<s;++n)for(var o=i[n],a=o.length,h,p=0;p<a;++p)(h=o[p])&&sA(h,e,t,p,o,r||STt(h,t));return new Ha(i,this._parents,e,t)}mp.prototype.interrupt=dQ;mp.prototype.transition=iK;var ETt=[null];function nK(e,t){var r=e.__transition,i,s;if(r){t=t==null?null:t+"";for(s in r)if((i=r[s]).state>iI&&i.name===t)return new Ha([[e]],ETt,t,+s)}return null}var uI=e=>()=>e;function ZB(e,{sourceEvent:t,target:r,selection:i,mode:s,dispatch:n}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},selection:{value:i,enumerable:!0,configurable:!0},mode:{value:s,enumerable:!0,configurable:!0},_:{value:n}})}function sK(e){e.stopImmediatePropagation()}function hI(e){e.preventDefault(),e.stopImmediatePropagation()}var oK={name:"drag"},GB={name:"space"},$2={name:"handle"},H2={name:"center"},{abs:aK,max:wl,min:Tl}=Math;function lK(e){return[+e[0],+e[1]]}function KB(e){return[lK(e[0]),lK(e[1])]}var fI={name:"x",handles:["w","e"].map(K3),input:function(e,t){return e==null?null:[[+e[0],t[0][1]],[+e[1],t[1][1]]]},output:function(e){return e&&[e[0][0],e[1][0]]}},pI={name:"y",handles:["n","s"].map(K3),input:function(e,t){return e==null?null:[[t[0][0],+e[0]],[t[1][0],+e[1]]]},output:function(e){return e&&[e[0][1],e[1][1]]}},ITt={name:"xy",handles:["n","w","e","s","nw","ne","sw","se"].map(K3),input:function(e){return e==null?null:KB(e)},output:function(e){return e}},i0={overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},cK={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},uK={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},MTt={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},CTt={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};function K3(e){return{type:e}}function PTt(e){return!e.ctrlKey&&!e.button}function RTt(){var e=this.ownerSVGElement||this;return e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]}function kTt(){return navigator.maxTouchPoints||"ontouchstart"in this}function QB(e){for(;!e.__brush;)if(!(e=e.parentNode))return;return e.__brush}function DTt(e){return e[0][0]===e[1][0]||e[0][1]===e[1][1]}function hK(e){var t=e.__brush;return t?t.dim.output(t.selection):null}function fK(){return JB(fI)}function pK(){return JB(pI)}function dK(){return JB(ITt)}function JB(e){var t=RTt,r=PTt,i=kTt,s=!0,n=rh("start","brush","end"),o=6,a;function h(z){var W=z.property("__brush",L).selectAll(".overlay").data([K3("overlay")]);W.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",i0.overlay).merge(W).each(function(){var X=QB(this).extent;po(this).attr("x",X[0][0]).attr("y",X[0][1]).attr("width",X[1][0]-X[0][0]).attr("height",X[1][1]-X[0][1])}),z.selectAll(".selection").data([K3("selection")]).enter().append("rect").attr("class","selection").attr("cursor",i0.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var Z=z.selectAll(".handle").data(e.handles,function(X){return X.type});Z.exit().remove(),Z.enter().append("rect").attr("class",function(X){return"handle handle--"+X.type}).attr("cursor",function(X){return i0[X.type]}),z.each(p).attr("fill","none").attr("pointer-events","all").on("mousedown.brush",T).filter(i).on("touchstart.brush",T).on("touchmove.brush",C).on("touchend.brush touchcancel.brush",B).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}h.move=function(z,W,Z){z.tween?z.on("start.brush",function(X){g(this,arguments).beforestart().start(X)}).on("interrupt.brush end.brush",function(X){g(this,arguments).end(X)}).tween("brush",function(){var X=this,q=X.__brush,it=g(X,arguments),nt=q.selection,Mt=e.input(typeof W=="function"?W.apply(this,arguments):W,q.extent),_t=vl(nt,Mt);function Et(vt){q.selection=vt===1&&Mt===null?null:_t(vt),p.call(X),it.brush()}return nt!==null&&Mt!==null?Et:Et(1)}):z.each(function(){var X=this,q=arguments,it=X.__brush,nt=e.input(typeof W=="function"?W.apply(X,q):W,it.extent),Mt=g(X,q).beforestart();cf(X),it.selection=nt===null?null:nt,p.call(X),Mt.start(Z).brush(Z).end(Z)})},h.clear=function(z,W){h.move(z,null,W)};function p(){var z=po(this),W=QB(this).selection;W?(z.selectAll(".selection").style("display",null).attr("x",W[0][0]).attr("y",W[0][1]).attr("width",W[1][0]-W[0][0]).attr("height",W[1][1]-W[0][1]),z.selectAll(".handle").style("display",null).attr("x",function(Z){return Z.type[Z.type.length-1]==="e"?W[1][0]-o/2:W[0][0]-o/2}).attr("y",function(Z){return Z.type[0]==="s"?W[1][1]-o/2:W[0][1]-o/2}).attr("width",function(Z){return Z.type==="n"||Z.type==="s"?W[1][0]-W[0][0]+o:o}).attr("height",function(Z){return Z.type==="e"||Z.type==="w"?W[1][1]-W[0][1]+o:o})):z.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function g(z,W,Z){var X=z.__brush.emitter;return X&&(!Z||!X.clean)?X:new v(z,W,Z)}function v(z,W,Z){this.that=z,this.args=W,this.state=z.__brush,this.active=0,this.clean=Z}v.prototype={beforestart:function(){return++this.active===1&&(this.state.emitter=this,this.starting=!0),this},start:function(z,W){return this.starting?(this.starting=!1,this.emit("start",z,W)):this.emit("brush",z),this},brush:function(z,W){return this.emit("brush",z,W),this},end:function(z,W){return--this.active===0&&(delete this.state.emitter,this.emit("end",z,W)),this},emit:function(z,W,Z){var X=po(this.that).datum();n.call(z,this.that,new ZB(z,{sourceEvent:W,target:h,selection:e.output(this.state.selection),mode:Z,dispatch:n}),X)}};function T(z){if(a&&!z.touches||!r.apply(this,arguments))return;var W=this,Z=z.target.__data__.type,X=(s&&z.metaKey?Z="overlay":Z)==="selection"?oK:s&&z.altKey?H2:$2,q=e===pI?null:MTt[Z],it=e===fI?null:CTt[Z],nt=QB(W),Mt=nt.extent,_t=nt.selection,Et=Mt[0][0],vt,Pt,re=Mt[0][1],$t,xt,Vt=Mt[1][0],qt,de,Ee=Mt[1][1],Se,ze,ke=0,nr=0,Si,yi=q&&it&&s&&z.shiftKey,hi,Kr,zr=Array.from(z.touches||[z],Er=>{let ae=Er.identifier;return Er=xa(Er,W),Er.point0=Er.slice(),Er.identifier=ae,Er});cf(W);var Br=g(W,arguments,!0).beforestart();if(Z==="overlay"){_t&&(Si=!0);let Er=[zr[0],zr[1]||zr[0]];nt.selection=_t=[[vt=e===pI?Et:Tl(Er[0][0],Er[1][0]),$t=e===fI?re:Tl(Er[0][1],Er[1][1])],[qt=e===pI?Vt:wl(Er[0][0],Er[1][0]),Se=e===fI?Ee:wl(Er[0][1],Er[1][1])]],zr.length>1&&en(z)}else vt=_t[0][0],$t=_t[0][1],qt=_t[1][0],Se=_t[1][1];Pt=vt,xt=$t,de=qt,ze=Se;var Fe=po(W).attr("pointer-events","none"),Sr=Fe.selectAll(".overlay").attr("cursor",i0[Z]);if(z.touches)Br.moved=Ie,Br.ended=xi;else{var $r=po(z.view).on("mousemove.brush",Ie,!0).on("mouseup.brush",xi,!0);s&&$r.on("keydown.brush",rn,!0).on("keyup.brush",fn,!0),Qm(z.view)}p.call(W),Br.start(z,X.name);function Ie(Er){for(let ae of Er.changedTouches||[Er])for(let Gn of zr)Gn.identifier===ae.identifier&&(Gn.cur=xa(ae,W));if(yi&&!hi&&!Kr&&zr.length===1){let ae=zr[0];aK(ae.cur[0]-ae[0])>aK(ae.cur[1]-ae[1])?Kr=!0:hi=!0}for(let ae of zr)ae.cur&&(ae[0]=ae.cur[0],ae[1]=ae.cur[1]);Si=!0,hI(Er),en(Er)}function en(Er){let ae=zr[0],Gn=ae.point0;var an;switch(ke=ae[0]-Gn[0],nr=ae[1]-Gn[1],X){case GB:case oK:{q&&(ke=wl(Et-vt,Tl(Vt-qt,ke)),Pt=vt+ke,de=qt+ke),it&&(nr=wl(re-$t,Tl(Ee-Se,nr)),xt=$t+nr,ze=Se+nr);break}case $2:{zr[1]?(q&&(Pt=wl(Et,Tl(Vt,zr[0][0])),de=wl(Et,Tl(Vt,zr[1][0])),q=1),it&&(xt=wl(re,Tl(Ee,zr[0][1])),ze=wl(re,Tl(Ee,zr[1][1])),it=1)):(q<0?(ke=wl(Et-vt,Tl(Vt-vt,ke)),Pt=vt+ke,de=qt):q>0&&(ke=wl(Et-qt,Tl(Vt-qt,ke)),Pt=vt,de=qt+ke),it<0?(nr=wl(re-$t,Tl(Ee-$t,nr)),xt=$t+nr,ze=Se):it>0&&(nr=wl(re-Se,Tl(Ee-Se,nr)),xt=$t,ze=Se+nr));break}case H2:{q&&(Pt=wl(Et,Tl(Vt,vt-ke*q)),de=wl(Et,Tl(Vt,qt+ke*q))),it&&(xt=wl(re,Tl(Ee,$t-nr*it)),ze=wl(re,Tl(Ee,Se+nr*it)));break}}de<Pt&&(q*=-1,an=vt,vt=qt,qt=an,an=Pt,Pt=de,de=an,Z in cK&&Sr.attr("cursor",i0[Z=cK[Z]])),ze<xt&&(it*=-1,an=$t,$t=Se,Se=an,an=xt,xt=ze,ze=an,Z in uK&&Sr.attr("cursor",i0[Z=uK[Z]])),nt.selection&&(_t=nt.selection),hi&&(Pt=_t[0][0],de=_t[1][0]),Kr&&(xt=_t[0][1],ze=_t[1][1]),(_t[0][0]!==Pt||_t[0][1]!==xt||_t[1][0]!==de||_t[1][1]!==ze)&&(nt.selection=[[Pt,xt],[de,ze]],p.call(W),Br.brush(Er,X.name))}function xi(Er){if(sK(Er),Er.touches){if(Er.touches.length)return;a&&clearTimeout(a),a=setTimeout(function(){a=null},500)}else Km(Er.view,Si),$r.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);Fe.attr("pointer-events","all"),Sr.attr("cursor",i0.overlay),nt.selection&&(_t=nt.selection),DTt(_t)&&(nt.selection=null,p.call(W)),Br.end(Er,X.name)}function rn(Er){switch(Er.keyCode){case 16:{yi=q&&it;break}case 18:{X===$2&&(q&&(qt=de-ke*q,vt=Pt+ke*q),it&&(Se=ze-nr*it,$t=xt+nr*it),X=H2,en(Er));break}case 32:{(X===$2||X===H2)&&(q<0?qt=de-ke:q>0&&(vt=Pt-ke),it<0?Se=ze-nr:it>0&&($t=xt-nr),X=GB,Sr.attr("cursor",i0.selection),en(Er));break}default:return}hI(Er)}function fn(Er){switch(Er.keyCode){case 16:{yi&&(hi=Kr=yi=!1,en(Er));break}case 18:{X===H2&&(q<0?qt=de:q>0&&(vt=Pt),it<0?Se=ze:it>0&&($t=xt),X=$2,en(Er));break}case 32:{X===GB&&(Er.altKey?(q&&(qt=de-ke*q,vt=Pt+ke*q),it&&(Se=ze-nr*it,$t=xt+nr*it),X=H2):(q<0?qt=de:q>0&&(vt=Pt),it<0?Se=ze:it>0&&($t=xt),X=$2),Sr.attr("cursor",i0[Z]),en(Er));break}default:return}hI(Er)}}function C(z){g(this,arguments).moved(z)}function B(z){g(this,arguments).ended(z)}function L(){var z=this.__brush||{selection:null};return z.extent=KB(t.apply(this,arguments)),z.dim=e,z}return h.extent=function(z){return arguments.length?(t=typeof z=="function"?z:uI(KB(z)),h):t},h.filter=function(z){return arguments.length?(r=typeof z=="function"?z:uI(!!z),h):r},h.touchable=function(z){return arguments.length?(i=typeof z=="function"?z:uI(!!z),h):i},h.handleSize=function(z){return arguments.length?(o=+z,h):o},h.keyModifiers=function(z){return arguments.length?(s=!!z,h):s},h.on=function(){var z=n.on.apply(n,arguments);return z===n?h:z},h}var tN=Math.abs,k1=Math.cos,D1=Math.sin,mK=Math.PI,J3=mK/2,eN=mK*2,rN=Math.max,dI=1e-12;function iN(e,t){return Array.from({length:t-e},(r,i)=>e+i)}function OTt(e){return function(t,r){return e(t.source.value+t.target.value,r.source.value+r.target.value)}}function AK(){return nN(!1,!1)}function gK(){return nN(!1,!0)}function _K(){return nN(!0,!1)}function nN(e,t){var r=0,i=null,s=null,n=null;function o(a){var h=a.length,p=new Array(h),g=iN(0,h),v=new Array(h*h),T=new Array(h),C=0,B;a=Float64Array.from({length:h*h},t?(L,z)=>a[z%h][z/h|0]:(L,z)=>a[z/h|0][z%h]);for(let L=0;L<h;++L){let z=0;for(let W=0;W<h;++W)z+=a[L*h+W]+e*a[W*h+L];C+=p[L]=z}C=rN(0,eN-r*h)/C,B=C?r:eN/h;{let L=0;i&&g.sort((z,W)=>i(p[z],p[W]));for(let z of g){let W=L;if(e){let Z=iN(~h+1,h).filter(X=>X<0?a[~X*h+z]:a[z*h+X]);s&&Z.sort((X,q)=>s(X<0?-a[~X*h+z]:a[z*h+X],q<0?-a[~q*h+z]:a[z*h+q]));for(let X of Z)if(X<0){let q=v[~X*h+z]||(v[~X*h+z]={source:null,target:null});q.target={index:z,startAngle:L,endAngle:L+=a[~X*h+z]*C,value:a[~X*h+z]}}else{let q=v[z*h+X]||(v[z*h+X]={source:null,target:null});q.source={index:z,startAngle:L,endAngle:L+=a[z*h+X]*C,value:a[z*h+X]}}T[z]={index:z,startAngle:W,endAngle:L,value:p[z]}}else{let Z=iN(0,h).filter(X=>a[z*h+X]||a[X*h+z]);s&&Z.sort((X,q)=>s(a[z*h+X],a[z*h+q]));for(let X of Z){let q;if(z<X?(q=v[z*h+X]||(v[z*h+X]={source:null,target:null}),q.source={index:z,startAngle:L,endAngle:L+=a[z*h+X]*C,value:a[z*h+X]}):(q=v[X*h+z]||(v[X*h+z]={source:null,target:null}),q.target={index:z,startAngle:L,endAngle:L+=a[z*h+X]*C,value:a[z*h+X]},z===X&&(q.source=q.target)),q.source&&q.target&&q.source.value<q.target.value){let it=q.source;q.source=q.target,q.target=it}}T[z]={index:z,startAngle:W,endAngle:L,value:p[z]}}L+=B}}return v=Object.values(v),v.groups=T,n?v.sort(n):v}return o.padAngle=function(a){return arguments.length?(r=rN(0,a),o):r},o.sortGroups=function(a){return arguments.length?(i=a,o):i},o.sortSubgroups=function(a){return arguments.length?(s=a,o):s},o.sortChords=function(a){return arguments.length?(a==null?n=null:(n=OTt(a))._=a,o):n&&n._},o}var sN=Math.PI,oN=2*sN,O1=1e-6,BTt=oN-O1;function yK(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function NTt(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return yK;let r=10**t;return function(i){this._+=i[0];for(let s=1,n=i.length;s<n;++s)this._+=Math.round(arguments[s]*r)/r+i[s]}}var n0=class{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?yK:NTt(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,i,s){this._append`Q${+t},${+r},${this._x1=+i},${this._y1=+s}`}bezierCurveTo(t,r,i,s,n,o){this._append`C${+t},${+r},${+i},${+s},${this._x1=+n},${this._y1=+o}`}arcTo(t,r,i,s,n){if(t=+t,r=+r,i=+i,s=+s,n=+n,n<0)throw new Error(`negative radius: ${n}`);let o=this._x1,a=this._y1,h=i-t,p=s-r,g=o-t,v=a-r,T=g*g+v*v;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(T>O1)if(!(Math.abs(v*h-p*g)>O1)||!n)this._append`L${this._x1=t},${this._y1=r}`;else{let C=i-o,B=s-a,L=h*h+p*p,z=C*C+B*B,W=Math.sqrt(L),Z=Math.sqrt(T),X=n*Math.tan((sN-Math.acos((L+T-z)/(2*W*Z)))/2),q=X/Z,it=X/W;Math.abs(q-1)>O1&&this._append`L${t+q*g},${r+q*v}`,this._append`A${n},${n},0,0,${+(v*C>g*B)},${this._x1=t+it*h},${this._y1=r+it*p}`}}arc(t,r,i,s,n,o){if(t=+t,r=+r,i=+i,o=!!o,i<0)throw new Error(`negative radius: ${i}`);let a=i*Math.cos(s),h=i*Math.sin(s),p=t+a,g=r+h,v=1^o,T=o?s-n:n-s;this._x1===null?this._append`M${p},${g}`:(Math.abs(this._x1-p)>O1||Math.abs(this._y1-g)>O1)&&this._append`L${p},${g}`,i&&(T<0&&(T=T%oN+oN),T>BTt?this._append`A${i},${i},0,1,${v},${t-a},${r-h}A${i},${i},0,1,${v},${this._x1=p},${this._y1=g}`:T>O1&&this._append`A${i},${i},0,${+(T>=sN)},${v},${this._x1=t+i*Math.cos(n)},${this._y1=r+i*Math.sin(n)}`)}rect(t,r,i,s){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${i=+i}v${+s}h${-i}Z`}toString(){return this._}};function tT(){return new n0}tT.prototype=n0.prototype;function xK(e=3){return new n0(+e)}var bK=Array.prototype.slice;function oA(e){return function(){return e}}function LTt(e){return e.source}function FTt(e){return e.target}function vK(e){return e.radius}function zTt(e){return e.startAngle}function UTt(e){return e.endAngle}function VTt(){return 0}function jTt(){return 10}function wK(e){var t=LTt,r=FTt,i=vK,s=vK,n=zTt,o=UTt,a=VTt,h=null;function p(){var g,v=t.apply(this,arguments),T=r.apply(this,arguments),C=a.apply(this,arguments)/2,B=bK.call(arguments),L=+i.apply(this,(B[0]=v,B)),z=n.apply(this,B)-J3,W=o.apply(this,B)-J3,Z=+s.apply(this,(B[0]=T,B)),X=n.apply(this,B)-J3,q=o.apply(this,B)-J3;if(h||(h=g=tT()),C>dI&&(tN(W-z)>C*2+dI?W>z?(z+=C,W-=C):(z-=C,W+=C):z=W=(z+W)/2,tN(q-X)>C*2+dI?q>X?(X+=C,q-=C):(X-=C,q+=C):X=q=(X+q)/2),h.moveTo(L*k1(z),L*D1(z)),h.arc(0,0,L,z,W),z!==X||W!==q)if(e){var it=+e.apply(this,arguments),nt=Z-it,Mt=(X+q)/2;h.quadraticCurveTo(0,0,nt*k1(X),nt*D1(X)),h.lineTo(Z*k1(Mt),Z*D1(Mt)),h.lineTo(nt*k1(q),nt*D1(q))}else h.quadraticCurveTo(0,0,Z*k1(X),Z*D1(X)),h.arc(0,0,Z,X,q);if(h.quadraticCurveTo(0,0,L*k1(z),L*D1(z)),h.closePath(),g)return h=null,g+""||null}return e&&(p.headRadius=function(g){return arguments.length?(e=typeof g=="function"?g:oA(+g),p):e}),p.radius=function(g){return arguments.length?(i=s=typeof g=="function"?g:oA(+g),p):i},p.sourceRadius=function(g){return arguments.length?(i=typeof g=="function"?g:oA(+g),p):i},p.targetRadius=function(g){return arguments.length?(s=typeof g=="function"?g:oA(+g),p):s},p.startAngle=function(g){return arguments.length?(n=typeof g=="function"?g:oA(+g),p):n},p.endAngle=function(g){return arguments.length?(o=typeof g=="function"?g:oA(+g),p):o},p.padAngle=function(g){return arguments.length?(a=typeof g=="function"?g:oA(+g),p):a},p.source=function(g){return arguments.length?(t=g,p):t},p.target=function(g){return arguments.length?(r=g,p):r},p.context=function(g){return arguments.length?(h=g??null,p):h},p}function TK(){return wK()}function SK(){return wK(jTt)}var WTt=Array.prototype,mI=WTt.slice;function EK(e,t){return e-t}function IK(e){for(var t=0,r=e.length,i=e[r-1][1]*e[0][0]-e[r-1][0]*e[0][1];++t<r;)i+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return i}var xp=e=>()=>e;function MK(e,t){for(var r=-1,i=t.length,s;++r<i;)if(s=$Tt(e,t[r]))return s;return 0}function $Tt(e,t){for(var r=t[0],i=t[1],s=-1,n=0,o=e.length,a=o-1;n<o;a=n++){var h=e[n],p=h[0],g=h[1],v=e[a],T=v[0],C=v[1];if(HTt(h,v,t))return 0;g>i!=C>i&&r<(T-p)*(i-g)/(C-g)+p&&(s=-s)}return s}function HTt(e,t,r){var i;return qTt(e,t,r)&&YTt(e[i=+(e[0]===t[0])],r[i],t[i])}function qTt(e,t,r){return(t[0]-e[0])*(r[1]-e[1])===(r[0]-e[0])*(t[1]-e[1])}function YTt(e,t,r){return e<=t&&t<=r||r<=t&&t<=e}function CK(){}var s0=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function eT(){var e=1,t=1,r=g1,i=h;function s(p){var g=r(p);if(Array.isArray(g))g=g.slice().sort(EK);else{let v=Zd(p,XTt);for(g=Pc(...A1(v[0],v[1],g),g);g[g.length-1]>=v[1];)g.pop();for(;g[1]<v[0];)g.shift()}return g.map(v=>n(p,v))}function n(p,g){let v=g==null?NaN:+g;if(isNaN(v))throw new Error(`invalid value: ${g}`);var T=[],C=[];return o(p,v,function(B){i(B,p,v),IK(B)>0?T.push([B]):C.push(B)}),C.forEach(function(B){for(var L=0,z=T.length,W;L<z;++L)if(MK((W=T[L])[0],B)!==-1){W.push(B);return}}),{type:"MultiPolygon",value:g,coordinates:T}}function o(p,g,v){var T=new Array,C=new Array,B,L,z,W,Z,X;for(B=L=-1,W=B1(p[0],g),s0[W<<1].forEach(q);++B<e-1;)z=W,W=B1(p[B+1],g),s0[z|W<<1].forEach(q);for(s0[W<<0].forEach(q);++L<t-1;){for(B=-1,W=B1(p[L*e+e],g),Z=B1(p[L*e],g),s0[W<<1|Z<<2].forEach(q);++B<e-1;)z=W,W=B1(p[L*e+e+B+1],g),X=Z,Z=B1(p[L*e+B+1],g),s0[z|W<<1|Z<<2|X<<3].forEach(q);s0[W|Z<<3].forEach(q)}for(B=-1,Z=p[L*e]>=g,s0[Z<<2].forEach(q);++B<e-1;)X=Z,Z=B1(p[L*e+B+1],g),s0[Z<<2|X<<3].forEach(q);s0[Z<<3].forEach(q);function q(it){var nt=[it[0][0]+B,it[0][1]+L],Mt=[it[1][0]+B,it[1][1]+L],_t=a(nt),Et=a(Mt),vt,Pt;(vt=C[_t])?(Pt=T[Et])?(delete C[vt.end],delete T[Pt.start],vt===Pt?(vt.ring.push(Mt),v(vt.ring)):T[vt.start]=C[Pt.end]={start:vt.start,end:Pt.end,ring:vt.ring.concat(Pt.ring)}):(delete C[vt.end],vt.ring.push(Mt),C[vt.end=Et]=vt):(vt=T[Et])?(Pt=C[_t])?(delete T[vt.start],delete C[Pt.end],vt===Pt?(vt.ring.push(Mt),v(vt.ring)):T[Pt.start]=C[vt.end]={start:Pt.start,end:vt.end,ring:Pt.ring.concat(vt.ring)}):(delete T[vt.start],vt.ring.unshift(nt),T[vt.start=_t]=vt):T[_t]=C[Et]={start:_t,end:Et,ring:[nt,Mt]}}}function a(p){return p[0]*2+p[1]*(e+1)*4}function h(p,g,v){p.forEach(function(T){var C=T[0],B=T[1],L=C|0,z=B|0,W=aN(g[z*e+L]);C>0&&C<e&&L===C&&(T[0]=PK(C,aN(g[z*e+L-1]),W,v)),B>0&&B<t&&z===B&&(T[1]=PK(B,aN(g[(z-1)*e+L]),W,v))})}return s.contour=n,s.size=function(p){if(!arguments.length)return[e,t];var g=Math.floor(p[0]),v=Math.floor(p[1]);if(!(g>=0&&v>=0))throw new Error("invalid size");return e=g,t=v,s},s.thresholds=function(p){return arguments.length?(r=typeof p=="function"?p:Array.isArray(p)?xp(mI.call(p)):xp(p),s):r},s.smooth=function(p){return arguments.length?(i=p?h:CK,s):i===h},s}function XTt(e){return isFinite(e)?e:NaN}function B1(e,t){return e==null?!1:+e>=t}function aN(e){return e==null||isNaN(e=+e)?-1/0:e}function PK(e,t,r,i){let s=i-t,n=r-t,o=isFinite(s)||isFinite(n)?s/n:Math.sign(s)/Math.sign(n);return isNaN(o)?e:e+o-.5}function ZTt(e){return e[0]}function GTt(e){return e[1]}function QTt(){return 1}function RK(){var e=ZTt,t=GTt,r=QTt,i=960,s=500,n=20,o=2,a=n*3,h=i+a*2>>o,p=s+a*2>>o,g=xp(20);function v(Z){var X=new Float32Array(h*p),q=Math.pow(2,-o),it=-1;for(let $t of Z){var nt=(e($t,++it,Z)+a)*q,Mt=(t($t,it,Z)+a)*q,_t=+r($t,it,Z);if(_t&&nt>=0&&nt<h&&Mt>=0&&Mt<p){var Et=Math.floor(nt),vt=Math.floor(Mt),Pt=nt-Et-.5,re=Mt-vt-.5;X[Et+vt*h]+=(1-Pt)*(1-re)*_t,X[Et+1+vt*h]+=Pt*(1-re)*_t,X[Et+1+(vt+1)*h]+=Pt*re*_t,X[Et+(vt+1)*h]+=(1-Pt)*re*_t}}return y6({data:X,width:h,height:p},n*q),X}function T(Z){var X=v(Z),q=g(X),it=Math.pow(2,2*o);return Array.isArray(q)||(q=Pc(Number.MIN_VALUE,Kd(X)/it,q)),eT().size([h,p]).thresholds(q.map(nt=>nt*it))(X).map((nt,Mt)=>(nt.value=+q[Mt],C(nt)))}T.contours=function(Z){var X=v(Z),q=eT().size([h,p]),it=Math.pow(2,2*o),nt=Mt=>{Mt=+Mt;var _t=C(q.contour(X,Mt*it));return _t.value=Mt,_t};return Object.defineProperty(nt,"max",{get:()=>Kd(X)/it}),nt};function C(Z){return Z.coordinates.forEach(B),Z}function B(Z){Z.forEach(L)}function L(Z){Z.forEach(z)}function z(Z){Z[0]=Z[0]*Math.pow(2,o)-a,Z[1]=Z[1]*Math.pow(2,o)-a}function W(){return a=n*3,h=i+a*2>>o,p=s+a*2>>o,T}return T.x=function(Z){return arguments.length?(e=typeof Z=="function"?Z:xp(+Z),T):e},T.y=function(Z){return arguments.length?(t=typeof Z=="function"?Z:xp(+Z),T):t},T.weight=function(Z){return arguments.length?(r=typeof Z=="function"?Z:xp(+Z),T):r},T.size=function(Z){if(!arguments.length)return[i,s];var X=+Z[0],q=+Z[1];if(!(X>=0&&q>=0))throw new Error("invalid size");return i=X,s=q,W()},T.cellSize=function(Z){if(!arguments.length)return 1<<o;if(!((Z=+Z)>=1))throw new Error("invalid cell size");return o=Math.floor(Math.log(Z)/Math.LN2),W()},T.thresholds=function(Z){return arguments.length?(g=typeof Z=="function"?Z:Array.isArray(Z)?xp(mI.call(Z)):xp(Z),T):g},T.bandwidth=function(Z){if(!arguments.length)return Math.sqrt(n*(n+1));if(!((Z=+Z)>=0))throw new Error("invalid bandwidth");return n=(Math.sqrt(4*Z*Z+1)-1)/2,W()},T}var In=11102230246251565e-32,qo=134217729,rT=(3+8*In)*In;function N1(e,t,r,i,s){let n,o,a,h,p=t[0],g=i[0],v=0,T=0;g>p==g>-p?(n=p,p=t[++v]):(n=g,g=i[++T]);let C=0;if(v<e&&T<r)for(g>p==g>-p?(o=p+n,a=n-(o-p),p=t[++v]):(o=g+n,a=n-(o-g),g=i[++T]),n=o,a!==0&&(s[C++]=a);v<e&&T<r;)g>p==g>-p?(o=n+p,h=o-n,a=n-(o-h)+(p-h),p=t[++v]):(o=n+g,h=o-n,a=n-(o-h)+(g-h),g=i[++T]),n=o,a!==0&&(s[C++]=a);for(;v<e;)o=n+p,h=o-n,a=n-(o-h)+(p-h),p=t[++v],n=o,a!==0&&(s[C++]=a);for(;T<r;)o=n+g,h=o-n,a=n-(o-h)+(g-h),g=i[++T],n=o,a!==0&&(s[C++]=a);return(n!==0||C===0)&&(s[C++]=n),C}function iT(e,t){let r=t[0];for(let i=1;i<e;i++)r+=t[i];return r}function Oe(e){return new Float64Array(e)}var KTt=(3+16*In)*In,JTt=(2+12*In)*In,tSt=(9+64*In)*In*In,q2=Oe(4),kK=Oe(8),DK=Oe(12),OK=Oe(16),Yl=Oe(4);function eSt(e,t,r,i,s,n,o){let a,h,p,g,v,T,C,B,L,z,W,Z,X,q,it,nt,Mt,_t,Et=e-s,vt=r-s,Pt=t-n,re=i-n;q=Et*re,T=qo*Et,C=T-(T-Et),B=Et-C,T=qo*re,L=T-(T-re),z=re-L,it=B*z-(q-C*L-B*L-C*z),nt=Pt*vt,T=qo*Pt,C=T-(T-Pt),B=Pt-C,T=qo*vt,L=T-(T-vt),z=vt-L,Mt=B*z-(nt-C*L-B*L-C*z),W=it-Mt,v=it-W,q2[0]=it-(W+v)+(v-Mt),Z=q+W,v=Z-q,X=q-(Z-v)+(W-v),W=X-nt,v=X-W,q2[1]=X-(W+v)+(v-nt),_t=Z+W,v=_t-Z,q2[2]=Z-(_t-v)+(W-v),q2[3]=_t;let $t=iT(4,q2),xt=JTt*o;if($t>=xt||-$t>=xt||(v=e-Et,a=e-(Et+v)+(v-s),v=r-vt,p=r-(vt+v)+(v-s),v=t-Pt,h=t-(Pt+v)+(v-n),v=i-re,g=i-(re+v)+(v-n),a===0&&h===0&&p===0&&g===0)||(xt=tSt*o+rT*Math.abs($t),$t+=Et*g+re*a-(Pt*p+vt*h),$t>=xt||-$t>=xt))return $t;q=a*re,T=qo*a,C=T-(T-a),B=a-C,T=qo*re,L=T-(T-re),z=re-L,it=B*z-(q-C*L-B*L-C*z),nt=h*vt,T=qo*h,C=T-(T-h),B=h-C,T=qo*vt,L=T-(T-vt),z=vt-L,Mt=B*z-(nt-C*L-B*L-C*z),W=it-Mt,v=it-W,Yl[0]=it-(W+v)+(v-Mt),Z=q+W,v=Z-q,X=q-(Z-v)+(W-v),W=X-nt,v=X-W,Yl[1]=X-(W+v)+(v-nt),_t=Z+W,v=_t-Z,Yl[2]=Z-(_t-v)+(W-v),Yl[3]=_t;let Vt=N1(4,q2,4,Yl,kK);q=Et*g,T=qo*Et,C=T-(T-Et),B=Et-C,T=qo*g,L=T-(T-g),z=g-L,it=B*z-(q-C*L-B*L-C*z),nt=Pt*p,T=qo*Pt,C=T-(T-Pt),B=Pt-C,T=qo*p,L=T-(T-p),z=p-L,Mt=B*z-(nt-C*L-B*L-C*z),W=it-Mt,v=it-W,Yl[0]=it-(W+v)+(v-Mt),Z=q+W,v=Z-q,X=q-(Z-v)+(W-v),W=X-nt,v=X-W,Yl[1]=X-(W+v)+(v-nt),_t=Z+W,v=_t-Z,Yl[2]=Z-(_t-v)+(W-v),Yl[3]=_t;let qt=N1(Vt,kK,4,Yl,DK);q=a*g,T=qo*a,C=T-(T-a),B=a-C,T=qo*g,L=T-(T-g),z=g-L,it=B*z-(q-C*L-B*L-C*z),nt=h*p,T=qo*h,C=T-(T-h),B=h-C,T=qo*p,L=T-(T-p),z=p-L,Mt=B*z-(nt-C*L-B*L-C*z),W=it-Mt,v=it-W,Yl[0]=it-(W+v)+(v-Mt),Z=q+W,v=Z-q,X=q-(Z-v)+(W-v),W=X-nt,v=X-W,Yl[1]=X-(W+v)+(v-nt),_t=Z+W,v=_t-Z,Yl[2]=Z-(_t-v)+(W-v),Yl[3]=_t;let de=N1(qt,DK,4,Yl,OK);return OK[de-1]}function Y2(e,t,r,i,s,n){let o=(t-n)*(r-s),a=(e-s)*(i-n),h=o-a,p=Math.abs(o+a);return Math.abs(h)>=KTt*p?h:-eSt(e,t,r,i,s,n,p)}var ehe=(7+56*In)*In,rhe=(3+28*In)*In,ihe=(26+288*In)*In*In,nhe=Oe(4),she=Oe(4),ohe=Oe(4),ahe=Oe(4),lhe=Oe(4),che=Oe(4),uhe=Oe(4),hhe=Oe(4),fhe=Oe(4),phe=Oe(8),dhe=Oe(8),mhe=Oe(8),Ahe=Oe(4),ghe=Oe(8),_he=Oe(8),yhe=Oe(8),xhe=Oe(12),bhe=Oe(192),vhe=Oe(192);var She=(10+96*In)*In,Ehe=(4+48*In)*In,Ihe=(44+576*In)*In*In,Mhe=Oe(4),Che=Oe(4),Phe=Oe(4),Rhe=Oe(4),khe=Oe(4),Dhe=Oe(4),Ohe=Oe(4),Bhe=Oe(4),Nhe=Oe(8),Lhe=Oe(8),Fhe=Oe(8),zhe=Oe(8),Uhe=Oe(8),Vhe=Oe(8),jhe=Oe(8),Whe=Oe(8),$he=Oe(8),Hhe=Oe(4),qhe=Oe(4),Yhe=Oe(4),Xhe=Oe(8),Zhe=Oe(16),Ghe=Oe(16),Qhe=Oe(16),Khe=Oe(32),Jhe=Oe(32),tfe=Oe(48),efe=Oe(64),rfe=Oe(1152),ife=Oe(1152);var afe=(16+224*In)*In,lfe=(5+72*In)*In,cfe=(71+1408*In)*In*In,ufe=Oe(4),hfe=Oe(4),ffe=Oe(4),pfe=Oe(4),dfe=Oe(4),mfe=Oe(4),Afe=Oe(4),gfe=Oe(4),_fe=Oe(4),yfe=Oe(4),xfe=Oe(24),bfe=Oe(24),vfe=Oe(24),wfe=Oe(24),Tfe=Oe(24),Sfe=Oe(24),Efe=Oe(24),Ife=Oe(24),Mfe=Oe(24),Cfe=Oe(24),Pfe=Oe(1152),Rfe=Oe(1152),kfe=Oe(1152),Dfe=Oe(1152),Ofe=Oe(1152),Bfe=Oe(2304),Nfe=Oe(2304),Lfe=Oe(3456),Ffe=Oe(5760),zfe=Oe(8),Ufe=Oe(8),Vfe=Oe(8),jfe=Oe(16),Wfe=Oe(24),$fe=Oe(48),Hfe=Oe(48),qfe=Oe(96),Yfe=Oe(192),Xfe=Oe(384),Zfe=Oe(384),Gfe=Oe(384),Qfe=Oe(768);var Kfe=Oe(96),Jfe=Oe(96),tpe=Oe(96),epe=Oe(1152);var NK=Math.pow(2,-52),AI=new Uint32Array(512),Z2=class e{static from(t,r=aSt,i=lSt){let s=t.length,n=new Float64Array(s*2);for(let o=0;o<s;o++){let a=t[o];n[2*o]=r(a),n[2*o+1]=i(a)}return new e(n)}constructor(t){let r=t.length>>1;if(r>0&&typeof t[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=t;let i=Math.max(2*r-5,0);this._triangles=new Uint32Array(i*3),this._halfedges=new Int32Array(i*3),this._hashSize=Math.ceil(Math.sqrt(r)),this._hullPrev=new Uint32Array(r),this._hullNext=new Uint32Array(r),this._hullTri=new Uint32Array(r),this._hullHash=new Int32Array(this._hashSize),this._ids=new Uint32Array(r),this._dists=new Float64Array(r),this.update()}update(){let{coords:t,_hullPrev:r,_hullNext:i,_hullTri:s,_hullHash:n}=this,o=t.length>>1,a=1/0,h=1/0,p=-1/0,g=-1/0;for(let Et=0;Et<o;Et++){let vt=t[2*Et],Pt=t[2*Et+1];vt<a&&(a=vt),Pt<h&&(h=Pt),vt>p&&(p=vt),Pt>g&&(g=Pt),this._ids[Et]=Et}let v=(a+p)/2,T=(h+g)/2,C,B,L;for(let Et=0,vt=1/0;Et<o;Et++){let Pt=lN(v,T,t[2*Et],t[2*Et+1]);Pt<vt&&(C=Et,vt=Pt)}let z=t[2*C],W=t[2*C+1];for(let Et=0,vt=1/0;Et<o;Et++){if(Et===C)continue;let Pt=lN(z,W,t[2*Et],t[2*Et+1]);Pt<vt&&Pt>0&&(B=Et,vt=Pt)}let Z=t[2*B],X=t[2*B+1],q=1/0;for(let Et=0;Et<o;Et++){if(Et===C||Et===B)continue;let vt=sSt(z,W,Z,X,t[2*Et],t[2*Et+1]);vt<q&&(L=Et,q=vt)}let it=t[2*L],nt=t[2*L+1];if(q===1/0){for(let Pt=0;Pt<o;Pt++)this._dists[Pt]=t[2*Pt]-t[0]||t[2*Pt+1]-t[1];X2(this._ids,this._dists,0,o-1);let Et=new Uint32Array(o),vt=0;for(let Pt=0,re=-1/0;Pt<o;Pt++){let $t=this._ids[Pt],xt=this._dists[$t];xt>re&&(Et[vt++]=$t,re=xt)}this.hull=Et.subarray(0,vt),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(Y2(z,W,Z,X,it,nt)<0){let Et=B,vt=Z,Pt=X;B=L,Z=it,X=nt,L=Et,it=vt,nt=Pt}let Mt=oSt(z,W,Z,X,it,nt);this._cx=Mt.x,this._cy=Mt.y;for(let Et=0;Et<o;Et++)this._dists[Et]=lN(t[2*Et],t[2*Et+1],Mt.x,Mt.y);X2(this._ids,this._dists,0,o-1),this._hullStart=C;let _t=3;i[C]=r[L]=B,i[B]=r[C]=L,i[L]=r[B]=C,s[C]=0,s[B]=1,s[L]=2,n.fill(-1),n[this._hashKey(z,W)]=C,n[this._hashKey(Z,X)]=B,n[this._hashKey(it,nt)]=L,this.trianglesLen=0,this._addTriangle(C,B,L,-1,-1,-1);for(let Et=0,vt,Pt;Et<this._ids.length;Et++){let re=this._ids[Et],$t=t[2*re],xt=t[2*re+1];if(Et>0&&Math.abs($t-vt)<=NK&&Math.abs(xt-Pt)<=NK||(vt=$t,Pt=xt,re===C||re===B||re===L))continue;let Vt=0;for(let ze=0,ke=this._hashKey($t,xt);ze<this._hashSize&&(Vt=n[(ke+ze)%this._hashSize],!(Vt!==-1&&Vt!==i[Vt]));ze++);Vt=r[Vt];let qt=Vt,de;for(;de=i[qt],Y2($t,xt,t[2*qt],t[2*qt+1],t[2*de],t[2*de+1])>=0;)if(qt=de,qt===Vt){qt=-1;break}if(qt===-1)continue;let Ee=this._addTriangle(qt,re,i[qt],-1,-1,s[qt]);s[re]=this._legalize(Ee+2),s[qt]=Ee,_t++;let Se=i[qt];for(;de=i[Se],Y2($t,xt,t[2*Se],t[2*Se+1],t[2*de],t[2*de+1])<0;)Ee=this._addTriangle(Se,re,de,s[re],-1,s[Se]),s[re]=this._legalize(Ee+2),i[Se]=Se,_t--,Se=de;if(qt===Vt)for(;de=r[qt],Y2($t,xt,t[2*de],t[2*de+1],t[2*qt],t[2*qt+1])<0;)Ee=this._addTriangle(de,re,qt,-1,s[qt],s[de]),this._legalize(Ee+2),s[de]=Ee,i[qt]=qt,_t--,qt=de;this._hullStart=r[re]=qt,i[qt]=r[Se]=re,i[re]=Se,n[this._hashKey($t,xt)]=re,n[this._hashKey(t[2*qt],t[2*qt+1])]=qt}this.hull=new Uint32Array(_t);for(let Et=0,vt=this._hullStart;Et<_t;Et++)this.hull[Et]=vt,vt=i[vt];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,r){return Math.floor(iSt(t-this._cx,r-this._cy)*this._hashSize)%this._hashSize}_legalize(t){let{_triangles:r,_halfedges:i,coords:s}=this,n=0,o=0;for(;;){let a=i[t],h=t-t%3;if(o=h+(t+2)%3,a===-1){if(n===0)break;t=AI[--n];continue}let p=a-a%3,g=h+(t+1)%3,v=p+(a+2)%3,T=r[o],C=r[t],B=r[g],L=r[v];if(nSt(s[2*T],s[2*T+1],s[2*C],s[2*C+1],s[2*B],s[2*B+1],s[2*L],s[2*L+1])){r[t]=L,r[a]=T;let W=i[v];if(W===-1){let X=this._hullStart;do{if(this._hullTri[X]===v){this._hullTri[X]=t;break}X=this._hullPrev[X]}while(X!==this._hullStart)}this._link(t,W),this._link(a,i[o]),this._link(o,v);let Z=p+(a+1)%3;n<AI.length&&(AI[n++]=Z)}else{if(n===0)break;t=AI[--n]}}return o}_link(t,r){this._halfedges[t]=r,r!==-1&&(this._halfedges[r]=t)}_addTriangle(t,r,i,s,n,o){let a=this.trianglesLen;return this._triangles[a]=t,this._triangles[a+1]=r,this._triangles[a+2]=i,this._link(a,s),this._link(a+1,n),this._link(a+2,o),this.trianglesLen+=3,a}};function iSt(e,t){let r=e/(Math.abs(e)+Math.abs(t));return(t>0?3-r:1+r)/4}function lN(e,t,r,i){let s=e-r,n=t-i;return s*s+n*n}function nSt(e,t,r,i,s,n,o,a){let h=e-o,p=t-a,g=r-o,v=i-a,T=s-o,C=n-a,B=h*h+p*p,L=g*g+v*v,z=T*T+C*C;return h*(v*z-L*C)-p*(g*z-L*T)+B*(g*C-v*T)<0}function sSt(e,t,r,i,s,n){let o=r-e,a=i-t,h=s-e,p=n-t,g=o*o+a*a,v=h*h+p*p,T=.5/(o*p-a*h),C=(p*g-a*v)*T,B=(o*v-h*g)*T;return C*C+B*B}function oSt(e,t,r,i,s,n){let o=r-e,a=i-t,h=s-e,p=n-t,g=o*o+a*a,v=h*h+p*p,T=.5/(o*p-a*h),C=e+(p*g-a*v)*T,B=t+(o*v-h*g)*T;return{x:C,y:B}}function X2(e,t,r,i){if(i-r<=20)for(let s=r+1;s<=i;s++){let n=e[s],o=t[n],a=s-1;for(;a>=r&&t[e[a]]>o;)e[a+1]=e[a--];e[a+1]=n}else{let s=r+i>>1,n=r+1,o=i;nT(e,s,n),t[e[r]]>t[e[i]]&&nT(e,r,i),t[e[n]]>t[e[i]]&&nT(e,n,i),t[e[r]]>t[e[n]]&&nT(e,r,n);let a=e[n],h=t[a];for(;;){do n++;while(t[e[n]]<h);do o--;while(t[e[o]]>h);if(o<n)break;nT(e,n,o)}e[r+1]=e[o],e[o]=a,i-n+1>=o-r?(X2(e,t,n,i),X2(e,t,r,o-1)):(X2(e,t,r,o-1),X2(e,t,n,i))}}function nT(e,t,r){let i=e[t];e[t]=e[r],e[r]=i}function aSt(e){return e[0]}function lSt(e){return e[1]}var ih=class{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(t,r){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(t,r){this._+=`L${this._x1=+t},${this._y1=+r}`}arc(t,r,i){t=+t,r=+r,i=+i;let s=t+i,n=r;if(i<0)throw new Error("negative radius");this._x1===null?this._+=`M${s},${n}`:(Math.abs(this._x1-s)>1e-6||Math.abs(this._y1-n)>1e-6)&&(this._+="L"+s+","+n),i&&(this._+=`A${i},${i},0,1,1,${t-i},${r}A${i},${i},0,1,1,${this._x1=s},${this._y1=n}`)}rect(t,r,i,s){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${+i}v${+s}h${-i}Z`}value(){return this._||null}};var aA=class{constructor(){this._=[]}moveTo(t,r){this._.push([t,r])}closePath(){this._.push(this._[0].slice())}lineTo(t,r){this._.push([t,r])}value(){return this._.length?this._:null}};var L1=class{constructor(t,[r,i,s,n]=[0,0,960,500]){if(!((s=+s)>=(r=+r))||!((n=+n)>=(i=+i)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(t.points.length*2),this.vectors=new Float64Array(t.points.length*2),this.xmax=s,this.xmin=r,this.ymax=n,this.ymin=i,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){let{delaunay:{points:t,hull:r,triangles:i},vectors:s}=this,n,o,a=this.circumcenters=this._circumcenters.subarray(0,i.length/3*2);for(let L=0,z=0,W=i.length,Z,X;L<W;L+=3,z+=2){let q=i[L]*2,it=i[L+1]*2,nt=i[L+2]*2,Mt=t[q],_t=t[q+1],Et=t[it],vt=t[it+1],Pt=t[nt],re=t[nt+1],$t=Et-Mt,xt=vt-_t,Vt=Pt-Mt,qt=re-_t,de=($t*qt-xt*Vt)*2;if(Math.abs(de)<1e-9){if(n===void 0){n=o=0;for(let Se of r)n+=t[Se*2],o+=t[Se*2+1];n/=r.length,o/=r.length}let Ee=1e9*Math.sign((n-Mt)*qt-(o-_t)*Vt);Z=(Mt+Pt)/2-Ee*qt,X=(_t+re)/2+Ee*Vt}else{let Ee=1/de,Se=$t*$t+xt*xt,ze=Vt*Vt+qt*qt;Z=Mt+(qt*Se-xt*ze)*Ee,X=_t+($t*ze-Vt*Se)*Ee}a[z]=Z,a[z+1]=X}let h=r[r.length-1],p,g=h*4,v,T=t[2*h],C,B=t[2*h+1];s.fill(0);for(let L=0;L<r.length;++L)h=r[L],p=g,v=T,C=B,g=h*4,T=t[2*h],B=t[2*h+1],s[p+2]=s[g]=C-B,s[p+3]=s[g+1]=T-v}render(t){let r=t==null?t=new ih:void 0,{delaunay:{halfedges:i,inedges:s,hull:n},circumcenters:o,vectors:a}=this;if(n.length<=1)return null;for(let g=0,v=i.length;g<v;++g){let T=i[g];if(T<g)continue;let C=Math.floor(g/3)*2,B=Math.floor(T/3)*2,L=o[C],z=o[C+1],W=o[B],Z=o[B+1];this._renderSegment(L,z,W,Z,t)}let h,p=n[n.length-1];for(let g=0;g<n.length;++g){h=p,p=n[g];let v=Math.floor(s[p]/3)*2,T=o[v],C=o[v+1],B=h*4,L=this._project(T,C,a[B+2],a[B+3]);L&&this._renderSegment(T,C,L[0],L[1],t)}return r&&r.value()}renderBounds(t){let r=t==null?t=new ih:void 0;return t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),r&&r.value()}renderCell(t,r){let i=r==null?r=new ih:void 0,s=this._clip(t);if(s===null||!s.length)return;r.moveTo(s[0],s[1]);let n=s.length;for(;s[0]===s[n-2]&&s[1]===s[n-1]&&n>1;)n-=2;for(let o=2;o<n;o+=2)(s[o]!==s[o-2]||s[o+1]!==s[o-1])&&r.lineTo(s[o],s[o+1]);return r.closePath(),i&&i.value()}*cellPolygons(){let{delaunay:{points:t}}=this;for(let r=0,i=t.length/2;r<i;++r){let s=this.cellPolygon(r);s&&(s.index=r,yield s)}}cellPolygon(t){let r=new aA;return this.renderCell(t,r),r.value()}_renderSegment(t,r,i,s,n){let o,a=this._regioncode(t,r),h=this._regioncode(i,s);a===0&&h===0?(n.moveTo(t,r),n.lineTo(i,s)):(o=this._clipSegment(t,r,i,s,a,h))&&(n.moveTo(o[0],o[1]),n.lineTo(o[2],o[3]))}contains(t,r,i){return r=+r,r!==r||(i=+i,i!==i)?!1:this.delaunay._step(t,r,i)===t}*neighbors(t){let r=this._clip(t);if(r)for(let i of this.delaunay.neighbors(t)){let s=this._clip(i);if(s){t:for(let n=0,o=r.length;n<o;n+=2)for(let a=0,h=s.length;a<h;a+=2)if(r[n]===s[a]&&r[n+1]===s[a+1]&&r[(n+2)%o]===s[(a+h-2)%h]&&r[(n+3)%o]===s[(a+h-1)%h]){yield i;break t}}}}_cell(t){let{circumcenters:r,delaunay:{inedges:i,halfedges:s,triangles:n}}=this,o=i[t];if(o===-1)return null;let a=[],h=o;do{let p=Math.floor(h/3);if(a.push(r[p*2],r[p*2+1]),h=h%3===2?h-2:h+1,n[h]!==t)break;h=s[h]}while(h!==o&&h!==-1);return a}_clip(t){if(t===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];let r=this._cell(t);if(r===null)return null;let{vectors:i}=this,s=t*4;return this._simplify(i[s]||i[s+1]?this._clipInfinite(t,r,i[s],i[s+1],i[s+2],i[s+3]):this._clipFinite(t,r))}_clipFinite(t,r){let i=r.length,s=null,n,o,a=r[i-2],h=r[i-1],p,g=this._regioncode(a,h),v,T=0;for(let C=0;C<i;C+=2)if(n=a,o=h,a=r[C],h=r[C+1],p=g,g=this._regioncode(a,h),p===0&&g===0)v=T,T=0,s?s.push(a,h):s=[a,h];else{let B,L,z,W,Z;if(p===0){if((B=this._clipSegment(n,o,a,h,p,g))===null)continue;[L,z,W,Z]=B}else{if((B=this._clipSegment(a,h,n,o,g,p))===null)continue;[W,Z,L,z]=B,v=T,T=this._edgecode(L,z),v&&T&&this._edge(t,v,T,s,s.length),s?s.push(L,z):s=[L,z]}v=T,T=this._edgecode(W,Z),v&&T&&this._edge(t,v,T,s,s.length),s?s.push(W,Z):s=[W,Z]}if(s)v=T,T=this._edgecode(s[0],s[1]),v&&T&&this._edge(t,v,T,s,s.length);else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return s}_clipSegment(t,r,i,s,n,o){let a=n<o;for(a&&([t,r,i,s,n,o]=[i,s,t,r,o,n]);;){if(n===0&&o===0)return a?[i,s,t,r]:[t,r,i,s];if(n&o)return null;let h,p,g=n||o;g&8?(h=t+(i-t)*(this.ymax-r)/(s-r),p=this.ymax):g&4?(h=t+(i-t)*(this.ymin-r)/(s-r),p=this.ymin):g&2?(p=r+(s-r)*(this.xmax-t)/(i-t),h=this.xmax):(p=r+(s-r)*(this.xmin-t)/(i-t),h=this.xmin),n?(t=h,r=p,n=this._regioncode(t,r)):(i=h,s=p,o=this._regioncode(i,s))}}_clipInfinite(t,r,i,s,n,o){let a=Array.from(r),h;if((h=this._project(a[0],a[1],i,s))&&a.unshift(h[0],h[1]),(h=this._project(a[a.length-2],a[a.length-1],n,o))&&a.push(h[0],h[1]),a=this._clipFinite(t,a))for(let p=0,g=a.length,v,T=this._edgecode(a[g-2],a[g-1]);p<g;p+=2)v=T,T=this._edgecode(a[p],a[p+1]),v&&T&&(p=this._edge(t,v,T,a,p),g=a.length);else this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(a=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return a}_edge(t,r,i,s,n){for(;r!==i;){let o,a;switch(r){case 5:r=4;continue;case 4:r=6,o=this.xmax,a=this.ymin;break;case 6:r=2;continue;case 2:r=10,o=this.xmax,a=this.ymax;break;case 10:r=8;continue;case 8:r=9,o=this.xmin,a=this.ymax;break;case 9:r=1;continue;case 1:r=5,o=this.xmin,a=this.ymin;break}(s[n]!==o||s[n+1]!==a)&&this.contains(t,o,a)&&(s.splice(n,0,o,a),n+=2)}return n}_project(t,r,i,s){let n=1/0,o,a,h;if(s<0){if(r<=this.ymin)return null;(o=(this.ymin-r)/s)<n&&(h=this.ymin,a=t+(n=o)*i)}else if(s>0){if(r>=this.ymax)return null;(o=(this.ymax-r)/s)<n&&(h=this.ymax,a=t+(n=o)*i)}if(i>0){if(t>=this.xmax)return null;(o=(this.xmax-t)/i)<n&&(a=this.xmax,h=r+(n=o)*s)}else if(i<0){if(t<=this.xmin)return null;(o=(this.xmin-t)/i)<n&&(a=this.xmin,h=r+(n=o)*s)}return[a,h]}_edgecode(t,r){return(t===this.xmin?1:t===this.xmax?2:0)|(r===this.ymin?4:r===this.ymax?8:0)}_regioncode(t,r){return(t<this.xmin?1:t>this.xmax?2:0)|(r<this.ymin?4:r>this.ymax?8:0)}_simplify(t){if(t&&t.length>4){for(let r=0;r<t.length;r+=2){let i=(r+2)%t.length,s=(r+4)%t.length;(t[r]===t[i]&&t[i]===t[s]||t[r+1]===t[i+1]&&t[i+1]===t[s+1])&&(t.splice(i,2),r-=2)}t.length||(t=null)}return t}};var cSt=2*Math.PI,G2=Math.pow;function uSt(e){return e[0]}function hSt(e){return e[1]}function fSt(e){let{triangles:t,coords:r}=e;for(let i=0;i<t.length;i+=3){let s=2*t[i],n=2*t[i+1],o=2*t[i+2];if((r[o]-r[s])*(r[n+1]-r[s+1])-(r[n]-r[s])*(r[o+1]-r[s+1])>1e-10)return!1}return!0}function pSt(e,t,r){return[e+Math.sin(e+t)*r,t+Math.cos(e-t)*r]}var sT=class e{static from(t,r=uSt,i=hSt,s){return new e("length"in t?dSt(t,r,i,s):Float64Array.from(mSt(t,r,i,s)))}constructor(t){this._delaunator=new Z2(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){let t=this._delaunator,r=this.points;if(t.hull&&t.hull.length>2&&fSt(t)){this.collinear=Int32Array.from({length:r.length/2},(T,C)=>C).sort((T,C)=>r[2*T]-r[2*C]||r[2*T+1]-r[2*C+1]);let h=this.collinear[0],p=this.collinear[this.collinear.length-1],g=[r[2*h],r[2*h+1],r[2*p],r[2*p+1]],v=1e-8*Math.hypot(g[3]-g[1],g[2]-g[0]);for(let T=0,C=r.length/2;T<C;++T){let B=pSt(r[2*T],r[2*T+1],v);r[2*T]=B[0],r[2*T+1]=B[1]}this._delaunator=new Z2(r)}else delete this.collinear;let i=this.halfedges=this._delaunator.halfedges,s=this.hull=this._delaunator.hull,n=this.triangles=this._delaunator.triangles,o=this.inedges.fill(-1),a=this._hullIndex.fill(-1);for(let h=0,p=i.length;h<p;++h){let g=n[h%3===2?h-2:h+1];(i[h]===-1||o[g]===-1)&&(o[g]=h)}for(let h=0,p=s.length;h<p;++h)a[s[h]]=h;s.length<=2&&s.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=s[0],o[s[0]]=1,s.length===2&&(o[s[1]]=0,this.triangles[1]=s[1],this.triangles[2]=s[1]))}voronoi(t){return new L1(this,t)}*neighbors(t){let{inedges:r,hull:i,_hullIndex:s,halfedges:n,triangles:o,collinear:a}=this;if(a){let v=a.indexOf(t);v>0&&(yield a[v-1]),v<a.length-1&&(yield a[v+1]);return}let h=r[t];if(h===-1)return;let p=h,g=-1;do{if(yield g=o[p],p=p%3===2?p-2:p+1,o[p]!==t)return;if(p=n[p],p===-1){let v=i[(s[t]+1)%i.length];v!==g&&(yield v);return}}while(p!==h)}find(t,r,i=0){if(t=+t,t!==t||(r=+r,r!==r))return-1;let s=i,n;for(;(n=this._step(i,t,r))>=0&&n!==i&&n!==s;)i=n;return n}_step(t,r,i){let{inedges:s,hull:n,_hullIndex:o,halfedges:a,triangles:h,points:p}=this;if(s[t]===-1||!p.length)return(t+1)%(p.length>>1);let g=t,v=G2(r-p[t*2],2)+G2(i-p[t*2+1],2),T=s[t],C=T;do{let B=h[C],L=G2(r-p[B*2],2)+G2(i-p[B*2+1],2);if(L<v&&(v=L,g=B),C=C%3===2?C-2:C+1,h[C]!==t)break;if(C=a[C],C===-1){if(C=n[(o[t]+1)%n.length],C!==B&&G2(r-p[C*2],2)+G2(i-p[C*2+1],2)<v)return C;break}}while(C!==T);return g}render(t){let r=t==null?t=new ih:void 0,{points:i,halfedges:s,triangles:n}=this;for(let o=0,a=s.length;o<a;++o){let h=s[o];if(h<o)continue;let p=n[o]*2,g=n[h]*2;t.moveTo(i[p],i[p+1]),t.lineTo(i[g],i[g+1])}return this.renderHull(t),r&&r.value()}renderPoints(t,r){r===void 0&&(!t||typeof t.moveTo!="function")&&(r=t,t=null),r=r==null?2:+r;let i=t==null?t=new ih:void 0,{points:s}=this;for(let n=0,o=s.length;n<o;n+=2){let a=s[n],h=s[n+1];t.moveTo(a+r,h),t.arc(a,h,r,0,cSt)}return i&&i.value()}renderHull(t){let r=t==null?t=new ih:void 0,{hull:i,points:s}=this,n=i[0]*2,o=i.length;t.moveTo(s[n],s[n+1]);for(let a=1;a<o;++a){let h=2*i[a];t.lineTo(s[h],s[h+1])}return t.closePath(),r&&r.value()}hullPolygon(){let t=new aA;return this.renderHull(t),t.value()}renderTriangle(t,r){let i=r==null?r=new ih:void 0,{points:s,triangles:n}=this,o=n[t*=3]*2,a=n[t+1]*2,h=n[t+2]*2;return r.moveTo(s[o],s[o+1]),r.lineTo(s[a],s[a+1]),r.lineTo(s[h],s[h+1]),r.closePath(),i&&i.value()}*trianglePolygons(){let{triangles:t}=this;for(let r=0,i=t.length/3;r<i;++r)yield this.trianglePolygon(r)}trianglePolygon(t){let r=new aA;return this.renderTriangle(t,r),r.value()}};function dSt(e,t,r,i){let s=e.length,n=new Float64Array(s*2);for(let o=0;o<s;++o){let a=e[o];n[o*2]=t.call(i,a,o,e),n[o*2+1]=r.call(i,a,o,e)}return n}function*mSt(e,t,r,i){let s=0;for(let n of e)yield t.call(i,n,s,e),yield r.call(i,n,s,e),++s}var LK={},cN={},uN=34,oT=10,hN=13;function zK(e){return new Function("d","return {"+e.map(function(t,r){return JSON.stringify(t)+": d["+r+'] || ""'}).join(",")+"}")}function ASt(e,t){var r=zK(e);return function(i,s){return t(r(i),s,e)}}function FK(e){var t=Object.create(null),r=[];return e.forEach(function(i){for(var s in i)s in t||r.push(t[s]=s)}),r}function kc(e,t){var r=e+"",i=r.length;return i<t?new Array(t-i+1).join(0)+r:r}function gSt(e){return e<0?"-"+kc(-e,6):e>9999?"+"+kc(e,6):kc(e,4)}function _St(e){var t=e.getUTCHours(),r=e.getUTCMinutes(),i=e.getUTCSeconds(),s=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":gSt(e.getUTCFullYear(),4)+"-"+kc(e.getUTCMonth()+1,2)+"-"+kc(e.getUTCDate(),2)+(s?"T"+kc(t,2)+":"+kc(r,2)+":"+kc(i,2)+"."+kc(s,3)+"Z":i?"T"+kc(t,2)+":"+kc(r,2)+":"+kc(i,2)+"Z":r||t?"T"+kc(t,2)+":"+kc(r,2)+"Z":"")}function lA(e){var t=new RegExp('["'+e+`
\r]`),r=e.charCodeAt(0);function i(v,T){var C,B,L=s(v,function(z,W){if(C)return C(z,W-1);B=z,C=T?ASt(z,T):zK(z)});return L.columns=B||[],L}function s(v,T){var C=[],B=v.length,L=0,z=0,W,Z=B<=0,X=!1;v.charCodeAt(B-1)===oT&&--B,v.charCodeAt(B-1)===hN&&--B;function q(){if(Z)return cN;if(X)return X=!1,LK;var nt,Mt=L,_t;if(v.charCodeAt(Mt)===uN){for(;L++<B&&v.charCodeAt(L)!==uN||v.charCodeAt(++L)===uN;);return(nt=L)>=B?Z=!0:(_t=v.charCodeAt(L++))===oT?X=!0:_t===hN&&(X=!0,v.charCodeAt(L)===oT&&++L),v.slice(Mt+1,nt-1).replace(/""/g,'"')}for(;L<B;){if((_t=v.charCodeAt(nt=L++))===oT)X=!0;else if(_t===hN)X=!0,v.charCodeAt(L)===oT&&++L;else if(_t!==r)continue;return v.slice(Mt,nt)}return Z=!0,v.slice(Mt,B)}for(;(W=q())!==cN;){for(var it=[];W!==LK&&W!==cN;)it.push(W),W=q();T&&(it=T(it,z++))==null||C.push(it)}return C}function n(v,T){return v.map(function(C){return T.map(function(B){return g(C[B])}).join(e)})}function o(v,T){return T==null&&(T=FK(v)),[T.map(g).join(e)].concat(n(v,T)).join(`
`)}function a(v,T){return T==null&&(T=FK(v)),n(v,T).join(`
`)}function h(v){return v.map(p).join(`
`)}function p(v){return v.map(g).join(e)}function g(v){return v==null?"":v instanceof Date?_St(v):t.test(v+="")?'"'+v.replace(/"/g,'""')+'"':v}return{parse:i,parseRows:s,format:o,formatBody:a,formatRows:h,formatRow:p,formatValue:g}}var F1=lA(","),gI=F1.parse,UK=F1.parseRows,VK=F1.format,jK=F1.formatBody,WK=F1.formatRows,$K=F1.formatRow,HK=F1.formatValue;var z1=lA("	"),_I=z1.parse,qK=z1.parseRows,YK=z1.format,XK=z1.formatBody,ZK=z1.formatRows,GK=z1.formatRow,QK=z1.formatValue;function fN(e){for(var t in e){var r=e[t].trim(),i,s;if(!r)r=null;else if(r==="true")r=!0;else if(r==="false")r=!1;else if(r==="NaN")r=NaN;else if(!isNaN(i=+r))r=i;else if(s=r.match(/^([-+]\d{2})?\d{4}(-\d{2}(-\d{2})?)?(T\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/))ySt&&s[4]&&!s[7]&&(r=r.replace(/-/g,"/").replace(/T/," ")),r=new Date(r);else continue;e[t]=r}return e}var ySt=new Date("2019-01-01T00:00").getHours()||new Date("2019-07-01T00:00").getHours();function xSt(e){if(!e.ok)throw new Error(e.status+" "+e.statusText);return e.blob()}function KK(e,t){return fetch(e,t).then(xSt)}function bSt(e){if(!e.ok)throw new Error(e.status+" "+e.statusText);return e.arrayBuffer()}function JK(e,t){return fetch(e,t).then(bSt)}function vSt(e){if(!e.ok)throw new Error(e.status+" "+e.statusText);return e.text()}function U1(e,t){return fetch(e,t).then(vSt)}function tJ(e){return function(t,r,i){return arguments.length===2&&typeof r=="function"&&(i=r,r=void 0),U1(t,r).then(function(s){return e(s,i)})}}function pN(e,t,r,i){arguments.length===3&&typeof r=="function"&&(i=r,r=void 0);var s=lA(e);return U1(t,r).then(function(n){return s.parse(n,i)})}var eJ=tJ(gI),rJ=tJ(_I);function iJ(e,t){return new Promise(function(r,i){var s=new Image;for(var n in t)s[n]=t[n];s.onerror=i,s.onload=function(){r(s)},s.src=e})}function wSt(e){if(!e.ok)throw new Error(e.status+" "+e.statusText);if(!(e.status===204||e.status===205))return e.json()}function nJ(e,t){return fetch(e,t).then(wSt)}function dN(e){return(t,r)=>U1(t,r).then(i=>new DOMParser().parseFromString(i,e))}var sJ=dN("application/xml"),oJ=dN("text/html"),aJ=dN("image/svg+xml");function lJ(e,t){var r,i=1;e==null&&(e=0),t==null&&(t=0);function s(){var n,o=r.length,a,h=0,p=0;for(n=0;n<o;++n)a=r[n],h+=a.x,p+=a.y;for(h=(h/o-e)*i,p=(p/o-t)*i,n=0;n<o;++n)a=r[n],a.x-=h,a.y-=p}return s.initialize=function(n){r=n},s.x=function(n){return arguments.length?(e=+n,s):e},s.y=function(n){return arguments.length?(t=+n,s):t},s.strength=function(n){return arguments.length?(i=+n,s):i},s}function cJ(e){let t=+this._x.call(null,e),r=+this._y.call(null,e);return uJ(this.cover(t,r),t,r,e)}function uJ(e,t,r,i){if(isNaN(t)||isNaN(r))return e;var s,n=e._root,o={data:i},a=e._x0,h=e._y0,p=e._x1,g=e._y1,v,T,C,B,L,z,W,Z;if(!n)return e._root=o,e;for(;n.length;)if((L=t>=(v=(a+p)/2))?a=v:p=v,(z=r>=(T=(h+g)/2))?h=T:g=T,s=n,!(n=n[W=z<<1|L]))return s[W]=o,e;if(C=+e._x.call(null,n.data),B=+e._y.call(null,n.data),t===C&&r===B)return o.next=n,s?s[W]=o:e._root=o,e;do s=s?s[W]=new Array(4):e._root=new Array(4),(L=t>=(v=(a+p)/2))?a=v:p=v,(z=r>=(T=(h+g)/2))?h=T:g=T;while((W=z<<1|L)===(Z=(B>=T)<<1|C>=v));return s[Z]=n,s[W]=o,e}function hJ(e){var t,r,i=e.length,s,n,o=new Array(i),a=new Array(i),h=1/0,p=1/0,g=-1/0,v=-1/0;for(r=0;r<i;++r)isNaN(s=+this._x.call(null,t=e[r]))||isNaN(n=+this._y.call(null,t))||(o[r]=s,a[r]=n,s<h&&(h=s),s>g&&(g=s),n<p&&(p=n),n>v&&(v=n));if(h>g||p>v)return this;for(this.cover(h,p).cover(g,v),r=0;r<i;++r)uJ(this,o[r],a[r],e[r]);return this}function fJ(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var r=this._x0,i=this._y0,s=this._x1,n=this._y1;if(isNaN(r))s=(r=Math.floor(e))+1,n=(i=Math.floor(t))+1;else{for(var o=s-r||1,a=this._root,h,p;r>e||e>=s||i>t||t>=n;)switch(p=(t<i)<<1|e<r,h=new Array(4),h[p]=a,a=h,o*=2,p){case 0:s=r+o,n=i+o;break;case 1:r=s-o,n=i+o;break;case 2:s=r+o,i=n-o;break;case 3:r=s-o,i=n-o;break}this._root&&this._root.length&&(this._root=a)}return this._x0=r,this._y0=i,this._x1=s,this._y1=n,this}function pJ(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function dJ(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function va(e,t,r,i,s){this.node=e,this.x0=t,this.y0=r,this.x1=i,this.y1=s}function mJ(e,t,r){var i,s=this._x0,n=this._y0,o,a,h,p,g=this._x1,v=this._y1,T=[],C=this._root,B,L;for(C&&T.push(new va(C,s,n,g,v)),r==null?r=1/0:(s=e-r,n=t-r,g=e+r,v=t+r,r*=r);B=T.pop();)if(!(!(C=B.node)||(o=B.x0)>g||(a=B.y0)>v||(h=B.x1)<s||(p=B.y1)<n))if(C.length){var z=(o+h)/2,W=(a+p)/2;T.push(new va(C[3],z,W,h,p),new va(C[2],o,W,z,p),new va(C[1],z,a,h,W),new va(C[0],o,a,z,W)),(L=(t>=W)<<1|e>=z)&&(B=T[T.length-1],T[T.length-1]=T[T.length-1-L],T[T.length-1-L]=B)}else{var Z=e-+this._x.call(null,C.data),X=t-+this._y.call(null,C.data),q=Z*Z+X*X;if(q<r){var it=Math.sqrt(r=q);s=e-it,n=t-it,g=e+it,v=t+it,i=C.data}}return i}function AJ(e){if(isNaN(g=+this._x.call(null,e))||isNaN(v=+this._y.call(null,e)))return this;var t,r=this._root,i,s,n,o=this._x0,a=this._y0,h=this._x1,p=this._y1,g,v,T,C,B,L,z,W;if(!r)return this;if(r.length)for(;;){if((B=g>=(T=(o+h)/2))?o=T:h=T,(L=v>=(C=(a+p)/2))?a=C:p=C,t=r,!(r=r[z=L<<1|B]))return this;if(!r.length)break;(t[z+1&3]||t[z+2&3]||t[z+3&3])&&(i=t,W=z)}for(;r.data!==e;)if(s=r,!(r=r.next))return this;return(n=r.next)&&delete r.next,s?(n?s.next=n:delete s.next,this):t?(n?t[z]=n:delete t[z],(r=t[0]||t[1]||t[2]||t[3])&&r===(t[3]||t[2]||t[1]||t[0])&&!r.length&&(i?i[W]=r:this._root=r),this):(this._root=n,this)}function gJ(e){for(var t=0,r=e.length;t<r;++t)this.remove(e[t]);return this}function _J(){return this._root}function yJ(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function xJ(e){var t=[],r,i=this._root,s,n,o,a,h;for(i&&t.push(new va(i,this._x0,this._y0,this._x1,this._y1));r=t.pop();)if(!e(i=r.node,n=r.x0,o=r.y0,a=r.x1,h=r.y1)&&i.length){var p=(n+a)/2,g=(o+h)/2;(s=i[3])&&t.push(new va(s,p,g,a,h)),(s=i[2])&&t.push(new va(s,n,g,p,h)),(s=i[1])&&t.push(new va(s,p,o,a,g)),(s=i[0])&&t.push(new va(s,n,o,p,g))}return this}function bJ(e){var t=[],r=[],i;for(this._root&&t.push(new va(this._root,this._x0,this._y0,this._x1,this._y1));i=t.pop();){var s=i.node;if(s.length){var n,o=i.x0,a=i.y0,h=i.x1,p=i.y1,g=(o+h)/2,v=(a+p)/2;(n=s[0])&&t.push(new va(n,o,a,g,v)),(n=s[1])&&t.push(new va(n,g,a,h,v)),(n=s[2])&&t.push(new va(n,o,v,g,p)),(n=s[3])&&t.push(new va(n,g,v,h,p))}r.push(i)}for(;i=r.pop();)e(i.node,i.x0,i.y0,i.x1,i.y1);return this}function vJ(e){return e[0]}function wJ(e){return arguments.length?(this._x=e,this):this._x}function TJ(e){return e[1]}function SJ(e){return arguments.length?(this._y=e,this):this._y}function cA(e,t,r){var i=new mN(t??vJ,r??TJ,NaN,NaN,NaN,NaN);return e==null?i:i.addAll(e)}function mN(e,t,r,i,s,n){this._x=e,this._y=t,this._x0=r,this._y0=i,this._x1=s,this._y1=n,this._root=void 0}function EJ(e){for(var t={data:e.data},r=t;e=e.next;)r=r.next={data:e.data};return t}var Xl=cA.prototype=mN.prototype;Xl.copy=function(){var e=new mN(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,r,i;if(!t)return e;if(!t.length)return e._root=EJ(t),e;for(r=[{source:t,target:e._root=new Array(4)}];t=r.pop();)for(var s=0;s<4;++s)(i=t.source[s])&&(i.length?r.push({source:i,target:t.target[s]=new Array(4)}):t.target[s]=EJ(i));return e};Xl.add=cJ;Xl.addAll=hJ;Xl.cover=fJ;Xl.data=pJ;Xl.extent=dJ;Xl.find=mJ;Xl.remove=AJ;Xl.removeAll=gJ;Xl.root=_J;Xl.size=yJ;Xl.visit=xJ;Xl.visitAfter=bJ;Xl.x=wJ;Xl.y=SJ;function Ns(e){return function(){return e}}function uf(e){return(e()-.5)*1e-6}function TSt(e){return e.x+e.vx}function SSt(e){return e.y+e.vy}function IJ(e){var t,r,i,s=1,n=1;typeof e!="function"&&(e=Ns(e==null?1:+e));function o(){for(var p,g=t.length,v,T,C,B,L,z,W=0;W<n;++W)for(v=cA(t,TSt,SSt).visitAfter(a),p=0;p<g;++p)T=t[p],L=r[T.index],z=L*L,C=T.x+T.vx,B=T.y+T.vy,v.visit(Z);function Z(X,q,it,nt,Mt){var _t=X.data,Et=X.r,vt=L+Et;if(_t){if(_t.index>T.index){var Pt=C-_t.x-_t.vx,re=B-_t.y-_t.vy,$t=Pt*Pt+re*re;$t<vt*vt&&(Pt===0&&(Pt=uf(i),$t+=Pt*Pt),re===0&&(re=uf(i),$t+=re*re),$t=(vt-($t=Math.sqrt($t)))/$t*s,T.vx+=(Pt*=$t)*(vt=(Et*=Et)/(z+Et)),T.vy+=(re*=$t)*vt,_t.vx-=Pt*(vt=1-vt),_t.vy-=re*vt)}return}return q>C+vt||nt<C-vt||it>B+vt||Mt<B-vt}}function a(p){if(p.data)return p.r=r[p.data.index];for(var g=p.r=0;g<4;++g)p[g]&&p[g].r>p.r&&(p.r=p[g].r)}function h(){if(t){var p,g=t.length,v;for(r=new Array(g),p=0;p<g;++p)v=t[p],r[v.index]=+e(v,p,t)}}return o.initialize=function(p,g){t=p,i=g,h()},o.iterations=function(p){return arguments.length?(n=+p,o):n},o.strength=function(p){return arguments.length?(s=+p,o):s},o.radius=function(p){return arguments.length?(e=typeof p=="function"?p:Ns(+p),h(),o):e},o}function ESt(e){return e.index}function MJ(e,t){var r=e.get(t);if(!r)throw new Error("node not found: "+t);return r}function CJ(e){var t=ESt,r=v,i,s=Ns(30),n,o,a,h,p,g=1;e==null&&(e=[]);function v(z){return 1/Math.min(a[z.source.index],a[z.target.index])}function T(z){for(var W=0,Z=e.length;W<g;++W)for(var X=0,q,it,nt,Mt,_t,Et,vt;X<Z;++X)q=e[X],it=q.source,nt=q.target,Mt=nt.x+nt.vx-it.x-it.vx||uf(p),_t=nt.y+nt.vy-it.y-it.vy||uf(p),Et=Math.sqrt(Mt*Mt+_t*_t),Et=(Et-n[X])/Et*z*i[X],Mt*=Et,_t*=Et,nt.vx-=Mt*(vt=h[X]),nt.vy-=_t*vt,it.vx+=Mt*(vt=1-vt),it.vy+=_t*vt}function C(){if(o){var z,W=o.length,Z=e.length,X=new Map(o.map((it,nt)=>[t(it,nt,o),it])),q;for(z=0,a=new Array(W);z<Z;++z)q=e[z],q.index=z,typeof q.source!="object"&&(q.source=MJ(X,q.source)),typeof q.target!="object"&&(q.target=MJ(X,q.target)),a[q.source.index]=(a[q.source.index]||0)+1,a[q.target.index]=(a[q.target.index]||0)+1;for(z=0,h=new Array(Z);z<Z;++z)q=e[z],h[z]=a[q.source.index]/(a[q.source.index]+a[q.target.index]);i=new Array(Z),B(),n=new Array(Z),L()}}function B(){if(o)for(var z=0,W=e.length;z<W;++z)i[z]=+r(e[z],z,e)}function L(){if(o)for(var z=0,W=e.length;z<W;++z)n[z]=+s(e[z],z,e)}return T.initialize=function(z,W){o=z,p=W,C()},T.links=function(z){return arguments.length?(e=z,C(),T):e},T.id=function(z){return arguments.length?(t=z,T):t},T.iterations=function(z){return arguments.length?(g=+z,T):g},T.strength=function(z){return arguments.length?(r=typeof z=="function"?z:Ns(+z),B(),T):r},T.distance=function(z){return arguments.length?(s=typeof z=="function"?z:Ns(+z),L(),T):s},T}function PJ(){let e=1;return()=>(e=(1664525*e+1013904223)%4294967296)/4294967296}function RJ(e){return e.x}function kJ(e){return e.y}var ISt=10,MSt=Math.PI*(3-Math.sqrt(5));function DJ(e){var t,r=1,i=.001,s=1-Math.pow(i,1/300),n=0,o=.6,a=new Map,h=R1(v),p=rh("tick","end"),g=PJ();e==null&&(e=[]);function v(){T(),p.call("tick",t),r<i&&(h.stop(),p.call("end",t))}function T(L){var z,W=e.length,Z;L===void 0&&(L=1);for(var X=0;X<L;++X)for(r+=(n-r)*s,a.forEach(function(q){q(r)}),z=0;z<W;++z)Z=e[z],Z.fx==null?Z.x+=Z.vx*=o:(Z.x=Z.fx,Z.vx=0),Z.fy==null?Z.y+=Z.vy*=o:(Z.y=Z.fy,Z.vy=0);return t}function C(){for(var L=0,z=e.length,W;L<z;++L){if(W=e[L],W.index=L,W.fx!=null&&(W.x=W.fx),W.fy!=null&&(W.y=W.fy),isNaN(W.x)||isNaN(W.y)){var Z=ISt*Math.sqrt(.5+L),X=L*MSt;W.x=Z*Math.cos(X),W.y=Z*Math.sin(X)}(isNaN(W.vx)||isNaN(W.vy))&&(W.vx=W.vy=0)}}function B(L){return L.initialize&&L.initialize(e,g),L}return C(),t={tick:T,restart:function(){return h.restart(v),t},stop:function(){return h.stop(),t},nodes:function(L){return arguments.length?(e=L,C(),a.forEach(B),t):e},alpha:function(L){return arguments.length?(r=+L,t):r},alphaMin:function(L){return arguments.length?(i=+L,t):i},alphaDecay:function(L){return arguments.length?(s=+L,t):+s},alphaTarget:function(L){return arguments.length?(n=+L,t):n},velocityDecay:function(L){return arguments.length?(o=1-L,t):1-o},randomSource:function(L){return arguments.length?(g=L,a.forEach(B),t):g},force:function(L,z){return arguments.length>1?(z==null?a.delete(L):a.set(L,B(z)),t):a.get(L)},find:function(L,z,W){var Z=0,X=e.length,q,it,nt,Mt,_t;for(W==null?W=1/0:W*=W,Z=0;Z<X;++Z)Mt=e[Z],q=L-Mt.x,it=z-Mt.y,nt=q*q+it*it,nt<W&&(_t=Mt,W=nt);return _t},on:function(L,z){return arguments.length>1?(p.on(L,z),t):p.on(L)}}}function OJ(){var e,t,r,i,s=Ns(-30),n,o=1,a=1/0,h=.81;function p(C){var B,L=e.length,z=cA(e,RJ,kJ).visitAfter(v);for(i=C,B=0;B<L;++B)t=e[B],z.visit(T)}function g(){if(e){var C,B=e.length,L;for(n=new Array(B),C=0;C<B;++C)L=e[C],n[L.index]=+s(L,C,e)}}function v(C){var B=0,L,z,W=0,Z,X,q;if(C.length){for(Z=X=q=0;q<4;++q)(L=C[q])&&(z=Math.abs(L.value))&&(B+=L.value,W+=z,Z+=z*L.x,X+=z*L.y);C.x=Z/W,C.y=X/W}else{L=C,L.x=L.data.x,L.y=L.data.y;do B+=n[L.data.index];while(L=L.next)}C.value=B}function T(C,B,L,z){if(!C.value)return!0;var W=C.x-t.x,Z=C.y-t.y,X=z-B,q=W*W+Z*Z;if(X*X/h<q)return q<a&&(W===0&&(W=uf(r),q+=W*W),Z===0&&(Z=uf(r),q+=Z*Z),q<o&&(q=Math.sqrt(o*q)),t.vx+=W*C.value*i/q,t.vy+=Z*C.value*i/q),!0;if(C.length||q>=a)return;(C.data!==t||C.next)&&(W===0&&(W=uf(r),q+=W*W),Z===0&&(Z=uf(r),q+=Z*Z),q<o&&(q=Math.sqrt(o*q)));do C.data!==t&&(X=n[C.data.index]*i/q,t.vx+=W*X,t.vy+=Z*X);while(C=C.next)}return p.initialize=function(C,B){e=C,r=B,g()},p.strength=function(C){return arguments.length?(s=typeof C=="function"?C:Ns(+C),g(),p):s},p.distanceMin=function(C){return arguments.length?(o=C*C,p):Math.sqrt(o)},p.distanceMax=function(C){return arguments.length?(a=C*C,p):Math.sqrt(a)},p.theta=function(C){return arguments.length?(h=C*C,p):Math.sqrt(h)},p}function BJ(e,t,r){var i,s=Ns(.1),n,o;typeof e!="function"&&(e=Ns(+e)),t==null&&(t=0),r==null&&(r=0);function a(p){for(var g=0,v=i.length;g<v;++g){var T=i[g],C=T.x-t||1e-6,B=T.y-r||1e-6,L=Math.sqrt(C*C+B*B),z=(o[g]-L)*n[g]*p/L;T.vx+=C*z,T.vy+=B*z}}function h(){if(i){var p,g=i.length;for(n=new Array(g),o=new Array(g),p=0;p<g;++p)o[p]=+e(i[p],p,i),n[p]=isNaN(o[p])?0:+s(i[p],p,i)}}return a.initialize=function(p){i=p,h()},a.strength=function(p){return arguments.length?(s=typeof p=="function"?p:Ns(+p),h(),a):s},a.radius=function(p){return arguments.length?(e=typeof p=="function"?p:Ns(+p),h(),a):e},a.x=function(p){return arguments.length?(t=+p,a):t},a.y=function(p){return arguments.length?(r=+p,a):r},a}function NJ(e){var t=Ns(.1),r,i,s;typeof e!="function"&&(e=Ns(e==null?0:+e));function n(a){for(var h=0,p=r.length,g;h<p;++h)g=r[h],g.vx+=(s[h]-g.x)*i[h]*a}function o(){if(r){var a,h=r.length;for(i=new Array(h),s=new Array(h),a=0;a<h;++a)i[a]=isNaN(s[a]=+e(r[a],a,r))?0:+t(r[a],a,r)}}return n.initialize=function(a){r=a,o()},n.strength=function(a){return arguments.length?(t=typeof a=="function"?a:Ns(+a),o(),n):t},n.x=function(a){return arguments.length?(e=typeof a=="function"?a:Ns(+a),o(),n):e},n}function LJ(e){var t=Ns(.1),r,i,s;typeof e!="function"&&(e=Ns(e==null?0:+e));function n(a){for(var h=0,p=r.length,g;h<p;++h)g=r[h],g.vy+=(s[h]-g.y)*i[h]*a}function o(){if(r){var a,h=r.length;for(i=new Array(h),s=new Array(h),a=0;a<h;++a)i[a]=isNaN(s[a]=+e(r[a],a,r))?0:+t(r[a],a,r)}}return n.initialize=function(a){r=a,o()},n.strength=function(a){return arguments.length?(t=typeof a=="function"?a:Ns(+a),o(),n):t},n.y=function(a){return arguments.length?(e=typeof a=="function"?a:Ns(+a),o(),n):e},n}function FJ(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function V1(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,i=e.slice(0,r);return[i.length>1?i[0]+i.slice(2):i,+e.slice(r+1)]}function bp(e){return e=V1(Math.abs(e)),e?e[1]:NaN}function zJ(e,t){return function(r,i){for(var s=r.length,n=[],o=0,a=e[0],h=0;s>0&&a>0&&(h+a+1>i&&(a=Math.max(1,i-h)),n.push(r.substring(s-=a,s+a)),!((h+=a+1)>i));)a=e[o=(o+1)%e.length];return n.reverse().join(t)}}function UJ(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var CSt=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function hf(e){if(!(t=CSt.exec(e)))throw new Error("invalid format: "+e);var t;return new aT({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}hf.prototype=aT.prototype;function aT(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}aT.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function VJ(e){t:for(var t=e.length,r=1,i=-1,s;r<t;++r)switch(e[r]){case".":i=s=r;break;case"0":i===0&&(i=r),s=r;break;default:if(!+e[r])break t;i>0&&(i=0);break}return i>0?e.slice(0,i)+e.slice(s+1):e}var AN;function jJ(e,t){var r=V1(e,t);if(!r)return e+"";var i=r[0],s=r[1],n=s-(AN=Math.max(-8,Math.min(8,Math.floor(s/3)))*3)+1,o=i.length;return n===o?i:n>o?i+new Array(n-o+1).join("0"):n>0?i.slice(0,n)+"."+i.slice(n):"0."+new Array(1-n).join("0")+V1(e,Math.max(0,t+n-1))[0]}function gN(e,t){var r=V1(e,t);if(!r)return e+"";var i=r[0],s=r[1];return s<0?"0."+new Array(-s).join("0")+i:i.length>s+1?i.slice(0,s+1)+"."+i.slice(s+1):i+new Array(s-i.length+2).join("0")}var _N={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:FJ,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>gN(e*100,t),r:gN,s:jJ,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function yN(e){return e}var WJ=Array.prototype.map,$J=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function yI(e){var t=e.grouping===void 0||e.thousands===void 0?yN:zJ(WJ.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",i=e.currency===void 0?"":e.currency[1]+"",s=e.decimal===void 0?".":e.decimal+"",n=e.numerals===void 0?yN:UJ(WJ.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",a=e.minus===void 0?"\u2212":e.minus+"",h=e.nan===void 0?"NaN":e.nan+"";function p(v){v=hf(v);var T=v.fill,C=v.align,B=v.sign,L=v.symbol,z=v.zero,W=v.width,Z=v.comma,X=v.precision,q=v.trim,it=v.type;it==="n"?(Z=!0,it="g"):_N[it]||(X===void 0&&(X=12),q=!0,it="g"),(z||T==="0"&&C==="=")&&(z=!0,T="0",C="=");var nt=L==="$"?r:L==="#"&&/[boxX]/.test(it)?"0"+it.toLowerCase():"",Mt=L==="$"?i:/[%p]/.test(it)?o:"",_t=_N[it],Et=/[defgprs%]/.test(it);X=X===void 0?6:/[gprs]/.test(it)?Math.max(1,Math.min(21,X)):Math.max(0,Math.min(20,X));function vt(Pt){var re=nt,$t=Mt,xt,Vt,qt;if(it==="c")$t=_t(Pt)+$t,Pt="";else{Pt=+Pt;var de=Pt<0||1/Pt<0;if(Pt=isNaN(Pt)?h:_t(Math.abs(Pt),X),q&&(Pt=VJ(Pt)),de&&+Pt==0&&B!=="+"&&(de=!1),re=(de?B==="("?B:a:B==="-"||B==="("?"":B)+re,$t=(it==="s"?$J[8+AN/3]:"")+$t+(de&&B==="("?")":""),Et){for(xt=-1,Vt=Pt.length;++xt<Vt;)if(qt=Pt.charCodeAt(xt),48>qt||qt>57){$t=(qt===46?s+Pt.slice(xt+1):Pt.slice(xt))+$t,Pt=Pt.slice(0,xt);break}}}Z&&!z&&(Pt=t(Pt,1/0));var Ee=re.length+Pt.length+$t.length,Se=Ee<W?new Array(W-Ee+1).join(T):"";switch(Z&&z&&(Pt=t(Se+Pt,Se.length?W-$t.length:1/0),Se=""),C){case"<":Pt=re+Pt+$t+Se;break;case"=":Pt=re+Se+Pt+$t;break;case"^":Pt=Se.slice(0,Ee=Se.length>>1)+re+Pt+$t+Se.slice(Ee);break;default:Pt=Se+re+Pt+$t;break}return n(Pt)}return vt.toString=function(){return v+""},vt}function g(v,T){var C=p((v=hf(v),v.type="f",v)),B=Math.max(-8,Math.min(8,Math.floor(bp(T)/3)))*3,L=Math.pow(10,-B),z=$J[8+B/3];return function(W){return C(L*W)+z}}return{format:p,formatPrefix:g}}var xI,j1,lT;bI({thousands:",",grouping:[3],currency:["$",""]});function bI(e){return xI=yI(e),j1=xI.format,lT=xI.formatPrefix,xI}function vI(e){return Math.max(0,-bp(Math.abs(e)))}function wI(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(bp(t)/3)))*3-bp(Math.abs(e)))}function TI(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,bp(t)-bp(e))+1}var dr=1e-6,o0=1e-12,wi=Math.PI,cs=wi/2,Q2=wi/4,Oo=wi*2,bn=180/wi,wr=wi/180,ei=Math.abs,nh=Math.atan,As=Math.atan2,Je=Math.cos,cT=Math.ceil,SI=Math.exp;var EI=Math.hypot,W1=Math.log,II=Math.pow,Ze=Math.sin,Sl=Math.sign||function(e){return e>0?1:e<0?-1:0},Pn=Math.sqrt,K2=Math.tan;function MI(e){return e>1?0:e<-1?wi:Math.acos(e)}function gs(e){return e>1?cs:e<-1?-cs:Math.asin(e)}function xN(e){return(e=Ze(e/2))*e}function Bn(){}function CI(e,t){e&&qJ.hasOwnProperty(e.type)&&qJ[e.type](e,t)}var HJ={Feature:function(e,t){CI(e.geometry,t)},FeatureCollection:function(e,t){for(var r=e.features,i=-1,s=r.length;++i<s;)CI(r[i].geometry,t)}},qJ={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var r=e.coordinates,i=-1,s=r.length;++i<s;)e=r[i],t.point(e[0],e[1],e[2])},LineString:function(e,t){bN(e.coordinates,t,0)},MultiLineString:function(e,t){for(var r=e.coordinates,i=-1,s=r.length;++i<s;)bN(r[i],t,0)},Polygon:function(e,t){YJ(e.coordinates,t)},MultiPolygon:function(e,t){for(var r=e.coordinates,i=-1,s=r.length;++i<s;)YJ(r[i],t)},GeometryCollection:function(e,t){for(var r=e.geometries,i=-1,s=r.length;++i<s;)CI(r[i],t)}};function bN(e,t,r){var i=-1,s=e.length-r,n;for(t.lineStart();++i<s;)n=e[i],t.point(n[0],n[1],n[2]);t.lineEnd()}function YJ(e,t){var r=-1,i=e.length;for(t.polygonStart();++r<i;)bN(e[r],t,1);t.polygonEnd()}function wa(e,t){e&&HJ.hasOwnProperty(e.type)?HJ[e.type](e,t):CI(e,t)}var uT=new ts,PI=new ts,XJ,ZJ,vN,wN,TN,ff={point:Bn,lineStart:Bn,lineEnd:Bn,polygonStart:function(){uT=new ts,ff.lineStart=PSt,ff.lineEnd=RSt},polygonEnd:function(){var e=+uT;PI.add(e<0?Oo+e:e),this.lineStart=this.lineEnd=this.point=Bn},sphere:function(){PI.add(Oo)}};function PSt(){ff.point=kSt}function RSt(){GJ(XJ,ZJ)}function kSt(e,t){ff.point=GJ,XJ=e,ZJ=t,e*=wr,t*=wr,vN=e,wN=Je(t=t/2+Q2),TN=Ze(t)}function GJ(e,t){e*=wr,t*=wr,t=t/2+Q2;var r=e-vN,i=r>=0?1:-1,s=i*r,n=Je(t),o=Ze(t),a=TN*o,h=wN*n+a*Je(s),p=a*i*Ze(s);uT.add(As(p,h)),vN=e,wN=n,TN=o}function QJ(e){return PI=new ts,wa(e,ff),PI*2}function $1(e){return[As(e[1],e[0]),gs(e[2])]}function sh(e){var t=e[0],r=e[1],i=Je(r);return[i*Je(t),i*Ze(t),Ze(r)]}function hT(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function a0(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function RI(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function fT(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function H1(e){var t=Pn(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var ro,Dc,mo,du,q1,ett,rtt,J2,pT,uA,c0,l0={point:SN,lineStart:KJ,lineEnd:JJ,polygonStart:function(){l0.point=ntt,l0.lineStart=DSt,l0.lineEnd=OSt,pT=new ts,ff.polygonStart()},polygonEnd:function(){ff.polygonEnd(),l0.point=SN,l0.lineStart=KJ,l0.lineEnd=JJ,uT<0?(ro=-(mo=180),Dc=-(du=90)):pT>dr?du=90:pT<-dr&&(Dc=-90),c0[0]=ro,c0[1]=mo},sphere:function(){ro=-(mo=180),Dc=-(du=90)}};function SN(e,t){uA.push(c0=[ro=e,mo=e]),t<Dc&&(Dc=t),t>du&&(du=t)}function itt(e,t){var r=sh([e*wr,t*wr]);if(J2){var i=a0(J2,r),s=[i[1],-i[0],0],n=a0(s,i);H1(n),n=$1(n);var o=e-q1,a=o>0?1:-1,h=n[0]*bn*a,p,g=ei(o)>180;g^(a*q1<h&&h<a*e)?(p=n[1]*bn,p>du&&(du=p)):(h=(h+360)%360-180,g^(a*q1<h&&h<a*e)?(p=-n[1]*bn,p<Dc&&(Dc=p)):(t<Dc&&(Dc=t),t>du&&(du=t))),g?e<q1?pu(ro,e)>pu(ro,mo)&&(mo=e):pu(e,mo)>pu(ro,mo)&&(ro=e):mo>=ro?(e<ro&&(ro=e),e>mo&&(mo=e)):e>q1?pu(ro,e)>pu(ro,mo)&&(mo=e):pu(e,mo)>pu(ro,mo)&&(ro=e)}else uA.push(c0=[ro=e,mo=e]);t<Dc&&(Dc=t),t>du&&(du=t),J2=r,q1=e}function KJ(){l0.point=itt}function JJ(){c0[0]=ro,c0[1]=mo,l0.point=SN,J2=null}function ntt(e,t){if(J2){var r=e-q1;pT.add(ei(r)>180?r+(r>0?360:-360):r)}else ett=e,rtt=t;ff.point(e,t),itt(e,t)}function DSt(){ff.lineStart()}function OSt(){ntt(ett,rtt),ff.lineEnd(),ei(pT)>dr&&(ro=-(mo=180)),c0[0]=ro,c0[1]=mo,J2=null}function pu(e,t){return(t-=e)<0?t+360:t}function BSt(e,t){return e[0]-t[0]}function ttt(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}function stt(e){var t,r,i,s,n,o,a;if(du=mo=-(ro=Dc=1/0),uA=[],wa(e,l0),r=uA.length){for(uA.sort(BSt),t=1,i=uA[0],n=[i];t<r;++t)s=uA[t],ttt(i,s[0])||ttt(i,s[1])?(pu(i[0],s[1])>pu(i[0],i[1])&&(i[1]=s[1]),pu(s[0],i[1])>pu(i[0],i[1])&&(i[0]=s[0])):n.push(i=s);for(o=-1/0,r=n.length-1,t=0,i=n[r];t<=r;i=s,++t)s=n[t],(a=pu(i[1],s[0]))>o&&(o=a,ro=s[0],mo=i[1])}return uA=c0=null,ro===1/0||Dc===1/0?[[NaN,NaN],[NaN,NaN]]:[[ro,Dc],[mo,du]]}var dT,kI,DI,OI,BI,NI,LI,FI,EN,IN,MN,ltt,ctt,Zl,Gl,Ql,pf={sphere:Bn,point:CN,lineStart:ott,lineEnd:att,polygonStart:function(){pf.lineStart=FSt,pf.lineEnd=zSt},polygonEnd:function(){pf.lineStart=ott,pf.lineEnd=att}};function CN(e,t){e*=wr,t*=wr;var r=Je(t);mT(r*Je(e),r*Ze(e),Ze(t))}function mT(e,t,r){++dT,DI+=(e-DI)/dT,OI+=(t-OI)/dT,BI+=(r-BI)/dT}function ott(){pf.point=NSt}function NSt(e,t){e*=wr,t*=wr;var r=Je(t);Zl=r*Je(e),Gl=r*Ze(e),Ql=Ze(t),pf.point=LSt,mT(Zl,Gl,Ql)}function LSt(e,t){e*=wr,t*=wr;var r=Je(t),i=r*Je(e),s=r*Ze(e),n=Ze(t),o=As(Pn((o=Gl*n-Ql*s)*o+(o=Ql*i-Zl*n)*o+(o=Zl*s-Gl*i)*o),Zl*i+Gl*s+Ql*n);kI+=o,NI+=o*(Zl+(Zl=i)),LI+=o*(Gl+(Gl=s)),FI+=o*(Ql+(Ql=n)),mT(Zl,Gl,Ql)}function att(){pf.point=CN}function FSt(){pf.point=USt}function zSt(){utt(ltt,ctt),pf.point=CN}function USt(e,t){ltt=e,ctt=t,e*=wr,t*=wr,pf.point=utt;var r=Je(t);Zl=r*Je(e),Gl=r*Ze(e),Ql=Ze(t),mT(Zl,Gl,Ql)}function utt(e,t){e*=wr,t*=wr;var r=Je(t),i=r*Je(e),s=r*Ze(e),n=Ze(t),o=Gl*n-Ql*s,a=Ql*i-Zl*n,h=Zl*s-Gl*i,p=EI(o,a,h),g=gs(p),v=p&&-g/p;EN.add(v*o),IN.add(v*a),MN.add(v*h),kI+=g,NI+=g*(Zl+(Zl=i)),LI+=g*(Gl+(Gl=s)),FI+=g*(Ql+(Ql=n)),mT(Zl,Gl,Ql)}function htt(e){dT=kI=DI=OI=BI=NI=LI=FI=0,EN=new ts,IN=new ts,MN=new ts,wa(e,pf);var t=+EN,r=+IN,i=+MN,s=EI(t,r,i);return s<o0&&(t=NI,r=LI,i=FI,kI<dr&&(t=DI,r=OI,i=BI),s=EI(t,r,i),s<o0)?[NaN,NaN]:[As(r,t)*bn,gs(i/s)*bn]}function Y1(e){return function(){return e}}function AT(e,t){function r(i,s){return i=e(i,s),t(i[0],i[1])}return e.invert&&t.invert&&(r.invert=function(i,s){return i=t.invert(i,s),i&&e.invert(i[0],i[1])}),r}function PN(e,t){return ei(e)>wi&&(e-=Math.round(e/Oo)*Oo),[e,t]}PN.invert=PN;function gT(e,t,r){return(e%=Oo)?t||r?AT(ptt(e),dtt(t,r)):ptt(e):t||r?dtt(t,r):PN}function ftt(e){return function(t,r){return t+=e,ei(t)>wi&&(t-=Math.round(t/Oo)*Oo),[t,r]}}function ptt(e){var t=ftt(e);return t.invert=ftt(-e),t}function dtt(e,t){var r=Je(e),i=Ze(e),s=Je(t),n=Ze(t);function o(a,h){var p=Je(h),g=Je(a)*p,v=Ze(a)*p,T=Ze(h),C=T*r+g*i;return[As(v*s-C*n,g*r-T*i),gs(C*s+v*n)]}return o.invert=function(a,h){var p=Je(h),g=Je(a)*p,v=Ze(a)*p,T=Ze(h),C=T*s-v*n;return[As(v*s+T*n,g*r+C*i),gs(C*r-g*i)]},o}function zI(e){e=gT(e[0]*wr,e[1]*wr,e.length>2?e[2]*wr:0);function t(r){return r=e(r[0]*wr,r[1]*wr),r[0]*=bn,r[1]*=bn,r}return t.invert=function(r){return r=e.invert(r[0]*wr,r[1]*wr),r[0]*=bn,r[1]*=bn,r},t}function RN(e,t,r,i,s,n){if(r){var o=Je(t),a=Ze(t),h=i*r;s==null?(s=t+i*Oo,n=t-h/2):(s=mtt(o,s),n=mtt(o,n),(i>0?s<n:s>n)&&(s+=i*Oo));for(var p,g=s;i>0?g>n:g<n;g-=h)p=$1([o,-a*Je(g),-a*Ze(g)]),e.point(p[0],p[1])}}function mtt(e,t){t=sh(t),t[0]-=e,H1(t);var r=MI(-t[1]);return((-t[2]<0?-r:r)+Oo-dr)%Oo}function Att(){var e=Y1([0,0]),t=Y1(90),r=Y1(2),i,s,n={point:o};function o(h,p){i.push(h=s(h,p)),h[0]*=bn,h[1]*=bn}function a(){var h=e.apply(this,arguments),p=t.apply(this,arguments)*wr,g=r.apply(this,arguments)*wr;return i=[],s=gT(-h[0]*wr,-h[1]*wr,0).invert,RN(n,p,g,1),h={type:"Polygon",coordinates:[i]},i=s=null,h}return a.center=function(h){return arguments.length?(e=typeof h=="function"?h:Y1([+h[0],+h[1]]),a):e},a.radius=function(h){return arguments.length?(t=typeof h=="function"?h:Y1(+h),a):t},a.precision=function(h){return arguments.length?(r=typeof h=="function"?h:Y1(+h),a):r},a}function UI(){var e=[],t;return{point:function(r,i,s){t.push([r,i,s])},lineStart:function(){e.push(t=[])},lineEnd:Bn,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var r=e;return e=[],t=null,r}}}function tx(e,t){return ei(e[0]-t[0])<dr&&ei(e[1]-t[1])<dr}function VI(e,t,r,i){this.x=e,this.z=t,this.o=r,this.e=i,this.v=!1,this.n=this.p=null}function jI(e,t,r,i,s){var n=[],o=[],a,h;if(e.forEach(function(B){if(!((L=B.length-1)<=0)){var L,z=B[0],W=B[L],Z;if(tx(z,W)){if(!z[2]&&!W[2]){for(s.lineStart(),a=0;a<L;++a)s.point((z=B[a])[0],z[1]);s.lineEnd();return}W[0]+=2*dr}n.push(Z=new VI(z,B,null,!0)),o.push(Z.o=new VI(z,null,Z,!1)),n.push(Z=new VI(W,B,null,!1)),o.push(Z.o=new VI(W,null,Z,!0))}}),!!n.length){for(o.sort(t),gtt(n),gtt(o),a=0,h=o.length;a<h;++a)o[a].e=r=!r;for(var p=n[0],g,v;;){for(var T=p,C=!0;T.v;)if((T=T.n)===p)return;g=T.z,s.lineStart();do{if(T.v=T.o.v=!0,T.e){if(C)for(a=0,h=g.length;a<h;++a)s.point((v=g[a])[0],v[1]);else i(T.x,T.n.x,1,s);T=T.n}else{if(C)for(g=T.p.z,a=g.length-1;a>=0;--a)s.point((v=g[a])[0],v[1]);else i(T.x,T.p.x,-1,s);T=T.p}T=T.o,g=T.z,C=!C}while(!T.v);s.lineEnd()}}}function gtt(e){if(t=e.length){for(var t,r=0,i=e[0],s;++r<t;)i.n=s=e[r],s.p=i,i=s;i.n=s=e[0],s.p=i}}function kN(e){return ei(e[0])<=wi?e[0]:Sl(e[0])*((ei(e[0])+wi)%Oo-wi)}function WI(e,t){var r=kN(t),i=t[1],s=Ze(i),n=[Ze(r),-Je(r),0],o=0,a=0,h=new ts;s===1?i=cs+dr:s===-1&&(i=-cs-dr);for(var p=0,g=e.length;p<g;++p)if(T=(v=e[p]).length)for(var v,T,C=v[T-1],B=kN(C),L=C[1]/2+Q2,z=Ze(L),W=Je(L),Z=0;Z<T;++Z,B=q,z=nt,W=Mt,C=X){var X=v[Z],q=kN(X),it=X[1]/2+Q2,nt=Ze(it),Mt=Je(it),_t=q-B,Et=_t>=0?1:-1,vt=Et*_t,Pt=vt>wi,re=z*nt;if(h.add(As(re*Et*Ze(vt),W*Mt+re*Je(vt))),o+=Pt?_t+Et*Oo:_t,Pt^B>=r^q>=r){var $t=a0(sh(C),sh(X));H1($t);var xt=a0(n,$t);H1(xt);var Vt=(Pt^_t>=0?-1:1)*gs(xt[2]);(i>Vt||i===Vt&&($t[0]||$t[1]))&&(a+=Pt^_t>=0?1:-1)}}return(o<-dr||o<dr&&h<-o0)^a&1}function $I(e,t,r,i){return function(s){var n=t(s),o=UI(),a=t(o),h=!1,p,g,v,T={point:C,lineStart:L,lineEnd:z,polygonStart:function(){T.point=W,T.lineStart=Z,T.lineEnd=X,g=[],p=[]},polygonEnd:function(){T.point=C,T.lineStart=L,T.lineEnd=z,g=b1(g);var q=WI(p,i);g.length?(h||(s.polygonStart(),h=!0),jI(g,jSt,q,r,s)):q&&(h||(s.polygonStart(),h=!0),s.lineStart(),r(null,null,1,s),s.lineEnd()),h&&(s.polygonEnd(),h=!1),g=p=null},sphere:function(){s.polygonStart(),s.lineStart(),r(null,null,1,s),s.lineEnd(),s.polygonEnd()}};function C(q,it){e(q,it)&&s.point(q,it)}function B(q,it){n.point(q,it)}function L(){T.point=B,n.lineStart()}function z(){T.point=C,n.lineEnd()}function W(q,it){v.push([q,it]),a.point(q,it)}function Z(){a.lineStart(),v=[]}function X(){W(v[0][0],v[0][1]),a.lineEnd();var q=a.clean(),it=o.result(),nt,Mt=it.length,_t,Et,vt;if(v.pop(),p.push(v),v=null,!!Mt){if(q&1){if(Et=it[0],(_t=Et.length-1)>0){for(h||(s.polygonStart(),h=!0),s.lineStart(),nt=0;nt<_t;++nt)s.point((vt=Et[nt])[0],vt[1]);s.lineEnd()}return}Mt>1&&q&2&&it.push(it.pop().concat(it.shift())),g.push(it.filter(VSt))}}return T}}function VSt(e){return e.length>1}function jSt(e,t){return((e=e.x)[0]<0?e[1]-cs-dr:cs-e[1])-((t=t.x)[0]<0?t[1]-cs-dr:cs-t[1])}var _T=$I(function(){return!0},WSt,HSt,[-wi,-cs]);function WSt(e){var t=NaN,r=NaN,i=NaN,s;return{lineStart:function(){e.lineStart(),s=1},point:function(n,o){var a=n>0?wi:-wi,h=ei(n-t);ei(h-wi)<dr?(e.point(t,r=(r+o)/2>0?cs:-cs),e.point(i,r),e.lineEnd(),e.lineStart(),e.point(a,r),e.point(n,r),s=0):i!==a&&h>=wi&&(ei(t-i)<dr&&(t-=i*dr),ei(n-a)<dr&&(n-=a*dr),r=$St(t,r,n,o),e.point(i,r),e.lineEnd(),e.lineStart(),e.point(a,r),s=0),e.point(t=n,r=o),i=a},lineEnd:function(){e.lineEnd(),t=r=NaN},clean:function(){return 2-s}}}function $St(e,t,r,i){var s,n,o=Ze(e-r);return ei(o)>dr?nh((Ze(t)*(n=Je(i))*Ze(r)-Ze(i)*(s=Je(t))*Ze(e))/(s*n*o)):(t+i)/2}function HSt(e,t,r,i){var s;if(e==null)s=r*cs,i.point(-wi,s),i.point(0,s),i.point(wi,s),i.point(wi,0),i.point(wi,-s),i.point(0,-s),i.point(-wi,-s),i.point(-wi,0),i.point(-wi,s);else if(ei(e[0]-t[0])>dr){var n=e[0]<t[0]?wi:-wi;s=r*n/2,i.point(-n,s),i.point(0,s),i.point(n,s)}else i.point(t[0],t[1])}function HI(e){var t=Je(e),r=2*wr,i=t>0,s=ei(t)>dr;function n(g,v,T,C){RN(C,e,r,T,g,v)}function o(g,v){return Je(g)*Je(v)>t}function a(g){var v,T,C,B,L;return{lineStart:function(){B=C=!1,L=1},point:function(z,W){var Z=[z,W],X,q=o(z,W),it=i?q?0:p(z,W):q?p(z+(z<0?wi:-wi),W):0;if(!v&&(B=C=q)&&g.lineStart(),q!==C&&(X=h(v,Z),(!X||tx(v,X)||tx(Z,X))&&(Z[2]=1)),q!==C)L=0,q?(g.lineStart(),X=h(Z,v),g.point(X[0],X[1])):(X=h(v,Z),g.point(X[0],X[1],2),g.lineEnd()),v=X;else if(s&&v&&i^q){var nt;!(it&T)&&(nt=h(Z,v,!0))&&(L=0,i?(g.lineStart(),g.point(nt[0][0],nt[0][1]),g.point(nt[1][0],nt[1][1]),g.lineEnd()):(g.point(nt[1][0],nt[1][1]),g.lineEnd(),g.lineStart(),g.point(nt[0][0],nt[0][1],3)))}q&&(!v||!tx(v,Z))&&g.point(Z[0],Z[1]),v=Z,C=q,T=it},lineEnd:function(){C&&g.lineEnd(),v=null},clean:function(){return L|(B&&C)<<1}}}function h(g,v,T){var C=sh(g),B=sh(v),L=[1,0,0],z=a0(C,B),W=hT(z,z),Z=z[0],X=W-Z*Z;if(!X)return!T&&g;var q=t*W/X,it=-t*Z/X,nt=a0(L,z),Mt=fT(L,q),_t=fT(z,it);RI(Mt,_t);var Et=nt,vt=hT(Mt,Et),Pt=hT(Et,Et),re=vt*vt-Pt*(hT(Mt,Mt)-1);if(!(re<0)){var $t=Pn(re),xt=fT(Et,(-vt-$t)/Pt);if(RI(xt,Mt),xt=$1(xt),!T)return xt;var Vt=g[0],qt=v[0],de=g[1],Ee=v[1],Se;qt<Vt&&(Se=Vt,Vt=qt,qt=Se);var ze=qt-Vt,ke=ei(ze-wi)<dr,nr=ke||ze<dr;if(!ke&&Ee<de&&(Se=de,de=Ee,Ee=Se),nr?ke?de+Ee>0^xt[1]<(ei(xt[0]-Vt)<dr?de:Ee):de<=xt[1]&&xt[1]<=Ee:ze>wi^(Vt<=xt[0]&&xt[0]<=qt)){var Si=fT(Et,(-vt+$t)/Pt);return RI(Si,Mt),[xt,$1(Si)]}}}function p(g,v){var T=i?e:wi-e,C=0;return g<-T?C|=1:g>T&&(C|=2),v<-T?C|=4:v>T&&(C|=8),C}return $I(o,a,n,i?[0,-e]:[-wi,e-wi])}function _tt(e,t,r,i,s,n){var o=e[0],a=e[1],h=t[0],p=t[1],g=0,v=1,T=h-o,C=p-a,B;if(B=r-o,!(!T&&B>0)){if(B/=T,T<0){if(B<g)return;B<v&&(v=B)}else if(T>0){if(B>v)return;B>g&&(g=B)}if(B=s-o,!(!T&&B<0)){if(B/=T,T<0){if(B>v)return;B>g&&(g=B)}else if(T>0){if(B<g)return;B<v&&(v=B)}if(B=i-a,!(!C&&B>0)){if(B/=C,C<0){if(B<g)return;B<v&&(v=B)}else if(C>0){if(B>v)return;B>g&&(g=B)}if(B=n-a,!(!C&&B<0)){if(B/=C,C<0){if(B>v)return;B>g&&(g=B)}else if(C>0){if(B<g)return;B<v&&(v=B)}return g>0&&(e[0]=o+g*T,e[1]=a+g*C),v<1&&(t[0]=o+v*T,t[1]=a+v*C),!0}}}}}var yT=1e9,qI=-yT;function u0(e,t,r,i){function s(p,g){return e<=p&&p<=r&&t<=g&&g<=i}function n(p,g,v,T){var C=0,B=0;if(p==null||(C=o(p,v))!==(B=o(g,v))||h(p,g)<0^v>0)do T.point(C===0||C===3?e:r,C>1?i:t);while((C=(C+v+4)%4)!==B);else T.point(g[0],g[1])}function o(p,g){return ei(p[0]-e)<dr?g>0?0:3:ei(p[0]-r)<dr?g>0?2:1:ei(p[1]-t)<dr?g>0?1:0:g>0?3:2}function a(p,g){return h(p.x,g.x)}function h(p,g){var v=o(p,1),T=o(g,1);return v!==T?v-T:v===0?g[1]-p[1]:v===1?p[0]-g[0]:v===2?p[1]-g[1]:g[0]-p[0]}return function(p){var g=p,v=UI(),T,C,B,L,z,W,Z,X,q,it,nt,Mt={point:_t,lineStart:re,lineEnd:$t,polygonStart:vt,polygonEnd:Pt};function _t(Vt,qt){s(Vt,qt)&&g.point(Vt,qt)}function Et(){for(var Vt=0,qt=0,de=C.length;qt<de;++qt)for(var Ee=C[qt],Se=1,ze=Ee.length,ke=Ee[0],nr,Si,yi=ke[0],hi=ke[1];Se<ze;++Se)nr=yi,Si=hi,ke=Ee[Se],yi=ke[0],hi=ke[1],Si<=i?hi>i&&(yi-nr)*(i-Si)>(hi-Si)*(e-nr)&&++Vt:hi<=i&&(yi-nr)*(i-Si)<(hi-Si)*(e-nr)&&--Vt;return Vt}function vt(){g=v,T=[],C=[],nt=!0}function Pt(){var Vt=Et(),qt=nt&&Vt,de=(T=b1(T)).length;(qt||de)&&(p.polygonStart(),qt&&(p.lineStart(),n(null,null,1,p),p.lineEnd()),de&&jI(T,a,Vt,n,p),p.polygonEnd()),g=p,T=C=B=null}function re(){Mt.point=xt,C&&C.push(B=[]),it=!0,q=!1,Z=X=NaN}function $t(){T&&(xt(L,z),W&&q&&v.rejoin(),T.push(v.result())),Mt.point=_t,q&&g.lineEnd()}function xt(Vt,qt){var de=s(Vt,qt);if(C&&B.push([Vt,qt]),it)L=Vt,z=qt,W=de,it=!1,de&&(g.lineStart(),g.point(Vt,qt));else if(de&&q)g.point(Vt,qt);else{var Ee=[Z=Math.max(qI,Math.min(yT,Z)),X=Math.max(qI,Math.min(yT,X))],Se=[Vt=Math.max(qI,Math.min(yT,Vt)),qt=Math.max(qI,Math.min(yT,qt))];_tt(Ee,Se,e,t,r,i)?(q||(g.lineStart(),g.point(Ee[0],Ee[1])),g.point(Se[0],Se[1]),de||g.lineEnd(),nt=!1):de&&(g.lineStart(),g.point(Vt,qt),nt=!1)}Z=Vt,X=qt,q=de}return Mt}}function ytt(){var e=0,t=0,r=960,i=500,s,n,o;return o={stream:function(a){return s&&n===a?s:s=u0(e,t,r,i)(n=a)},extent:function(a){return arguments.length?(e=+a[0][0],t=+a[0][1],r=+a[1][0],i=+a[1][1],s=n=null,o):[[e,t],[r,i]]}}}var DN,ON,YI,XI,ex={sphere:Bn,point:Bn,lineStart:qSt,lineEnd:Bn,polygonStart:Bn,polygonEnd:Bn};function qSt(){ex.point=XSt,ex.lineEnd=YSt}function YSt(){ex.point=ex.lineEnd=Bn}function XSt(e,t){e*=wr,t*=wr,ON=e,YI=Ze(t),XI=Je(t),ex.point=ZSt}function ZSt(e,t){e*=wr,t*=wr;var r=Ze(t),i=Je(t),s=ei(e-ON),n=Je(s),o=Ze(s),a=i*o,h=XI*r-YI*i*n,p=YI*r+XI*i*n;DN.add(As(Pn(a*a+h*h),p)),ON=e,YI=r,XI=i}function ZI(e){return DN=new ts,wa(e,ex),+DN}var BN=[null,null],GSt={type:"LineString",coordinates:BN};function rx(e,t){return BN[0]=e,BN[1]=t,ZI(GSt)}var xtt={Feature:function(e,t){return GI(e.geometry,t)},FeatureCollection:function(e,t){for(var r=e.features,i=-1,s=r.length;++i<s;)if(GI(r[i].geometry,t))return!0;return!1}},btt={Sphere:function(){return!0},Point:function(e,t){return vtt(e.coordinates,t)},MultiPoint:function(e,t){for(var r=e.coordinates,i=-1,s=r.length;++i<s;)if(vtt(r[i],t))return!0;return!1},LineString:function(e,t){return wtt(e.coordinates,t)},MultiLineString:function(e,t){for(var r=e.coordinates,i=-1,s=r.length;++i<s;)if(wtt(r[i],t))return!0;return!1},Polygon:function(e,t){return Ttt(e.coordinates,t)},MultiPolygon:function(e,t){for(var r=e.coordinates,i=-1,s=r.length;++i<s;)if(Ttt(r[i],t))return!0;return!1},GeometryCollection:function(e,t){for(var r=e.geometries,i=-1,s=r.length;++i<s;)if(GI(r[i],t))return!0;return!1}};function GI(e,t){return e&&btt.hasOwnProperty(e.type)?btt[e.type](e,t):!1}function vtt(e,t){return rx(e,t)===0}function wtt(e,t){for(var r,i,s,n=0,o=e.length;n<o;n++){if(i=rx(e[n],t),i===0||n>0&&(s=rx(e[n],e[n-1]),s>0&&r<=s&&i<=s&&(r+i-s)*(1-Math.pow((r-i)/s,2))<o0*s))return!0;r=i}return!1}function Ttt(e,t){return!!WI(e.map(QSt),Stt(t))}function QSt(e){return e=e.map(Stt),e.pop(),e}function Stt(e){return[e[0]*wr,e[1]*wr]}function Ett(e,t){return(e&&xtt.hasOwnProperty(e.type)?xtt[e.type]:GI)(e,t)}function Itt(e,t,r){var i=eh(e,t-dr,r).concat(t);return function(s){return i.map(function(n){return[s,n]})}}function Mtt(e,t,r){var i=eh(e,t-dr,r).concat(t);return function(s){return i.map(function(n){return[n,s]})}}function QI(){var e,t,r,i,s,n,o,a,h=10,p=h,g=90,v=360,T,C,B,L,z=2.5;function W(){return{type:"MultiLineString",coordinates:Z()}}function Z(){return eh(cT(i/g)*g,r,g).map(B).concat(eh(cT(a/v)*v,o,v).map(L)).concat(eh(cT(t/h)*h,e,h).filter(function(X){return ei(X%g)>dr}).map(T)).concat(eh(cT(n/p)*p,s,p).filter(function(X){return ei(X%v)>dr}).map(C))}return W.lines=function(){return Z().map(function(X){return{type:"LineString",coordinates:X}})},W.outline=function(){return{type:"Polygon",coordinates:[B(i).concat(L(o).slice(1),B(r).reverse().slice(1),L(a).reverse().slice(1))]}},W.extent=function(X){return arguments.length?W.extentMajor(X).extentMinor(X):W.extentMinor()},W.extentMajor=function(X){return arguments.length?(i=+X[0][0],r=+X[1][0],a=+X[0][1],o=+X[1][1],i>r&&(X=i,i=r,r=X),a>o&&(X=a,a=o,o=X),W.precision(z)):[[i,a],[r,o]]},W.extentMinor=function(X){return arguments.length?(t=+X[0][0],e=+X[1][0],n=+X[0][1],s=+X[1][1],t>e&&(X=t,t=e,e=X),n>s&&(X=n,n=s,s=X),W.precision(z)):[[t,n],[e,s]]},W.step=function(X){return arguments.length?W.stepMajor(X).stepMinor(X):W.stepMinor()},W.stepMajor=function(X){return arguments.length?(g=+X[0],v=+X[1],W):[g,v]},W.stepMinor=function(X){return arguments.length?(h=+X[0],p=+X[1],W):[h,p]},W.precision=function(X){return arguments.length?(z=+X,T=Itt(n,s,90),C=Mtt(t,e,z),B=Itt(a,o,90),L=Mtt(i,r,z),W):z},W.extentMajor([[-180,-90+dr],[180,90-dr]]).extentMinor([[-180,-80-dr],[180,80+dr]])}function Ctt(){return QI()()}function Ptt(e,t){var r=e[0]*wr,i=e[1]*wr,s=t[0]*wr,n=t[1]*wr,o=Je(i),a=Ze(i),h=Je(n),p=Ze(n),g=o*Je(r),v=o*Ze(r),T=h*Je(s),C=h*Ze(s),B=2*gs(Pn(xN(n-i)+o*h*xN(s-r))),L=Ze(B),z=B?function(W){var Z=Ze(W*=B)/L,X=Ze(B-W)/L,q=X*g+Z*T,it=X*v+Z*C,nt=X*a+Z*p;return[As(it,q)*bn,As(nt,Pn(q*q+it*it))*bn]}:function(){return[r*bn,i*bn]};return z.distance=B,z}var hA=e=>e;var NN=new ts,LN=new ts,Rtt,ktt,FN,zN,fA={point:Bn,lineStart:Bn,lineEnd:Bn,polygonStart:function(){fA.lineStart=KSt,fA.lineEnd=t4t},polygonEnd:function(){fA.lineStart=fA.lineEnd=fA.point=Bn,NN.add(ei(LN)),LN=new ts},result:function(){var e=NN/2;return NN=new ts,e}};function KSt(){fA.point=JSt}function JSt(e,t){fA.point=Dtt,Rtt=FN=e,ktt=zN=t}function Dtt(e,t){LN.add(zN*e-FN*t),FN=e,zN=t}function t4t(){Dtt(Rtt,ktt)}var UN=fA;var ix=1/0,KI=ix,xT=-ix,JI=xT,e4t={point:r4t,lineStart:Bn,lineEnd:Bn,polygonStart:Bn,polygonEnd:Bn,result:function(){var e=[[ix,KI],[xT,JI]];return xT=JI=-(KI=ix=1/0),e}};function r4t(e,t){e<ix&&(ix=e),e>xT&&(xT=e),t<KI&&(KI=t),t>JI&&(JI=t)}var nx=e4t;var VN=0,jN=0,bT=0,tM=0,eM=0,sx=0,WN=0,$N=0,vT=0,Ntt,Ltt,vp,wp,df={point:X1,lineStart:Ott,lineEnd:Btt,polygonStart:function(){df.lineStart=s4t,df.lineEnd=o4t},polygonEnd:function(){df.point=X1,df.lineStart=Ott,df.lineEnd=Btt},result:function(){var e=vT?[WN/vT,$N/vT]:sx?[tM/sx,eM/sx]:bT?[VN/bT,jN/bT]:[NaN,NaN];return VN=jN=bT=tM=eM=sx=WN=$N=vT=0,e}};function X1(e,t){VN+=e,jN+=t,++bT}function Ott(){df.point=i4t}function i4t(e,t){df.point=n4t,X1(vp=e,wp=t)}function n4t(e,t){var r=e-vp,i=t-wp,s=Pn(r*r+i*i);tM+=s*(vp+e)/2,eM+=s*(wp+t)/2,sx+=s,X1(vp=e,wp=t)}function Btt(){df.point=X1}function s4t(){df.point=a4t}function o4t(){Ftt(Ntt,Ltt)}function a4t(e,t){df.point=Ftt,X1(Ntt=vp=e,Ltt=wp=t)}function Ftt(e,t){var r=e-vp,i=t-wp,s=Pn(r*r+i*i);tM+=s*(vp+e)/2,eM+=s*(wp+t)/2,sx+=s,s=wp*e-vp*t,WN+=s*(vp+e),$N+=s*(wp+t),vT+=s*3,X1(vp=e,wp=t)}var HN=df;function rM(e){this._context=e}rM.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t),this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,Oo);break}}},result:Bn};var YN=new ts,qN,ztt,Utt,wT,TT,iM={point:Bn,lineStart:function(){iM.point=l4t},lineEnd:function(){qN&&Vtt(ztt,Utt),iM.point=Bn},polygonStart:function(){qN=!0},polygonEnd:function(){qN=null},result:function(){var e=+YN;return YN=new ts,e}};function l4t(e,t){iM.point=Vtt,ztt=wT=e,Utt=TT=t}function Vtt(e,t){wT-=e,TT-=t,YN.add(Pn(wT*wT+TT*TT)),wT=e,TT=t}var XN=iM;var jtt,nM,Wtt,$tt,ox=class{constructor(t){this._append=t==null?Htt:c4t(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(t,r){switch(this._point){case 0:{this._append`M${t},${r}`,this._point=1;break}case 1:{this._append`L${t},${r}`;break}default:{if(this._append`M${t},${r}`,this._radius!==Wtt||this._append!==nM){let i=this._radius,s=this._;this._="",this._append`m0,${i}a${i},${i} 0 1,1 0,${-2*i}a${i},${i} 0 1,1 0,${2*i}z`,Wtt=i,nM=this._append,$tt=this._,this._=s}this._+=$tt;break}}}result(){let t=this._;return this._="",t.length?t:null}};function Htt(e){let t=1;this._+=e[0];for(let r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function c4t(e){let t=Math.floor(e);if(!(t>=0))throw new RangeError(`invalid digits: ${e}`);if(t>15)return Htt;if(t!==jtt){let r=10**t;jtt=t,nM=function(s){let n=1;this._+=s[0];for(let o=s.length;n<o;++n)this._+=Math.round(arguments[n]*r)/r+s[n]}}return nM}function qtt(e,t){let r=3,i=4.5,s,n;function o(a){return a&&(typeof i=="function"&&n.pointRadius(+i.apply(this,arguments)),wa(a,s(n))),n.result()}return o.area=function(a){return wa(a,s(UN)),UN.result()},o.measure=function(a){return wa(a,s(XN)),XN.result()},o.bounds=function(a){return wa(a,s(nx)),nx.result()},o.centroid=function(a){return wa(a,s(HN)),HN.result()},o.projection=function(a){return arguments.length?(s=a==null?(e=null,hA):(e=a).stream,o):e},o.context=function(a){return arguments.length?(n=a==null?(t=null,new ox(r)):new rM(t=a),typeof i!="function"&&n.pointRadius(i),o):t},o.pointRadius=function(a){return arguments.length?(i=typeof a=="function"?a:(n.pointRadius(+a),+a),o):i},o.digits=function(a){if(!arguments.length)return r;if(a==null)r=null;else{let h=Math.floor(a);if(!(h>=0))throw new RangeError(`invalid digits: ${a}`);r=h}return t===null&&(n=new ox(r)),o},o.projection(e).digits(r).context(t)}function Ytt(e){return{stream:pA(e)}}function pA(e){return function(t){var r=new ZN;for(var i in e)r[i]=e[i];return r.stream=t,r}}function ZN(){}ZN.prototype={constructor:ZN,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function GN(e,t,r){var i=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),i!=null&&e.clipExtent(null),wa(r,e.stream(nx)),t(nx.result()),i!=null&&e.clipExtent(i),e}function Z1(e,t,r){return GN(e,function(i){var s=t[1][0]-t[0][0],n=t[1][1]-t[0][1],o=Math.min(s/(i[1][0]-i[0][0]),n/(i[1][1]-i[0][1])),a=+t[0][0]+(s-o*(i[1][0]+i[0][0]))/2,h=+t[0][1]+(n-o*(i[1][1]+i[0][1]))/2;e.scale(150*o).translate([a,h])},r)}function ax(e,t,r){return Z1(e,[[0,0],t],r)}function lx(e,t,r){return GN(e,function(i){var s=+t,n=s/(i[1][0]-i[0][0]),o=(s-n*(i[1][0]+i[0][0]))/2,a=-n*i[0][1];e.scale(150*n).translate([o,a])},r)}function cx(e,t,r){return GN(e,function(i){var s=+t,n=s/(i[1][1]-i[0][1]),o=-n*i[0][0],a=(s-n*(i[1][1]+i[0][1]))/2;e.scale(150*n).translate([o,a])},r)}var Xtt=16,u4t=Je(30*wr);function QN(e,t){return+t?f4t(e,t):h4t(e)}function h4t(e){return pA({point:function(t,r){t=e(t,r),this.stream.point(t[0],t[1])}})}function f4t(e,t){function r(i,s,n,o,a,h,p,g,v,T,C,B,L,z){var W=p-i,Z=g-s,X=W*W+Z*Z;if(X>4*t&&L--){var q=o+T,it=a+C,nt=h+B,Mt=Pn(q*q+it*it+nt*nt),_t=gs(nt/=Mt),Et=ei(ei(nt)-1)<dr||ei(n-v)<dr?(n+v)/2:As(it,q),vt=e(Et,_t),Pt=vt[0],re=vt[1],$t=Pt-i,xt=re-s,Vt=Z*$t-W*xt;(Vt*Vt/X>t||ei((W*$t+Z*xt)/X-.5)>.3||o*T+a*C+h*B<u4t)&&(r(i,s,n,o,a,h,Pt,re,Et,q/=Mt,it/=Mt,nt,L,z),z.point(Pt,re),r(Pt,re,Et,q,it,nt,p,g,v,T,C,B,L,z))}}return function(i){var s,n,o,a,h,p,g,v,T,C,B,L,z={point:W,lineStart:Z,lineEnd:q,polygonStart:function(){i.polygonStart(),z.lineStart=it},polygonEnd:function(){i.polygonEnd(),z.lineStart=Z}};function W(_t,Et){_t=e(_t,Et),i.point(_t[0],_t[1])}function Z(){v=NaN,z.point=X,i.lineStart()}function X(_t,Et){var vt=sh([_t,Et]),Pt=e(_t,Et);r(v,T,g,C,B,L,v=Pt[0],T=Pt[1],g=_t,C=vt[0],B=vt[1],L=vt[2],Xtt,i),i.point(v,T)}function q(){z.point=W,i.lineEnd()}function it(){Z(),z.point=nt,z.lineEnd=Mt}function nt(_t,Et){X(s=_t,Et),n=v,o=T,a=C,h=B,p=L,z.point=X}function Mt(){r(v,T,g,C,B,L,n,o,s,a,h,p,Xtt,i),z.lineEnd=q,q()}return z}}var p4t=pA({point:function(e,t){this.stream.point(e*wr,t*wr)}});function d4t(e){return pA({point:function(t,r){var i=e(t,r);return this.stream.point(i[0],i[1])}})}function m4t(e,t,r,i,s){function n(o,a){return o*=i,a*=s,[t+e*o,r-e*a]}return n.invert=function(o,a){return[(o-t)/e*i,(r-a)/e*s]},n}function Ztt(e,t,r,i,s,n){if(!n)return m4t(e,t,r,i,s);var o=Je(n),a=Ze(n),h=o*e,p=a*e,g=o/e,v=a/e,T=(a*r-o*t)/e,C=(a*t+o*r)/e;function B(L,z){return L*=i,z*=s,[h*L-p*z+t,r-p*L-h*z]}return B.invert=function(L,z){return[i*(g*L-v*z+T),s*(C-v*L-g*z)]},B}function Bo(e){return ST(function(){return e})()}function ST(e){var t,r=150,i=480,s=250,n=0,o=0,a=0,h=0,p=0,g,v=0,T=1,C=1,B=null,L=_T,z=null,W,Z,X,q=hA,it=.5,nt,Mt,_t,Et,vt;function Pt(Vt){return _t(Vt[0]*wr,Vt[1]*wr)}function re(Vt){return Vt=_t.invert(Vt[0],Vt[1]),Vt&&[Vt[0]*bn,Vt[1]*bn]}Pt.stream=function(Vt){return Et&&vt===Vt?Et:Et=p4t(d4t(g)(L(nt(q(vt=Vt)))))},Pt.preclip=function(Vt){return arguments.length?(L=Vt,B=void 0,xt()):L},Pt.postclip=function(Vt){return arguments.length?(q=Vt,z=W=Z=X=null,xt()):q},Pt.clipAngle=function(Vt){return arguments.length?(L=+Vt?HI(B=Vt*wr):(B=null,_T),xt()):B*bn},Pt.clipExtent=function(Vt){return arguments.length?(q=Vt==null?(z=W=Z=X=null,hA):u0(z=+Vt[0][0],W=+Vt[0][1],Z=+Vt[1][0],X=+Vt[1][1]),xt()):z==null?null:[[z,W],[Z,X]]},Pt.scale=function(Vt){return arguments.length?(r=+Vt,$t()):r},Pt.translate=function(Vt){return arguments.length?(i=+Vt[0],s=+Vt[1],$t()):[i,s]},Pt.center=function(Vt){return arguments.length?(n=Vt[0]%360*wr,o=Vt[1]%360*wr,$t()):[n*bn,o*bn]},Pt.rotate=function(Vt){return arguments.length?(a=Vt[0]%360*wr,h=Vt[1]%360*wr,p=Vt.length>2?Vt[2]%360*wr:0,$t()):[a*bn,h*bn,p*bn]},Pt.angle=function(Vt){return arguments.length?(v=Vt%360*wr,$t()):v*bn},Pt.reflectX=function(Vt){return arguments.length?(T=Vt?-1:1,$t()):T<0},Pt.reflectY=function(Vt){return arguments.length?(C=Vt?-1:1,$t()):C<0},Pt.precision=function(Vt){return arguments.length?(nt=QN(Mt,it=Vt*Vt),xt()):Pn(it)},Pt.fitExtent=function(Vt,qt){return Z1(Pt,Vt,qt)},Pt.fitSize=function(Vt,qt){return ax(Pt,Vt,qt)},Pt.fitWidth=function(Vt,qt){return lx(Pt,Vt,qt)},Pt.fitHeight=function(Vt,qt){return cx(Pt,Vt,qt)};function $t(){var Vt=Ztt(r,0,0,T,C,v).apply(null,t(n,o)),qt=Ztt(r,i-Vt[0],s-Vt[1],T,C,v);return g=gT(a,h,p),Mt=AT(t,qt),_t=AT(g,Mt),nt=QN(Mt,it),xt()}function xt(){return Et=vt=null,Pt}return function(){return t=e.apply(this,arguments),Pt.invert=t.invert&&re,$t()}}function ux(e){var t=0,r=wi/3,i=ST(e),s=i(t,r);return s.parallels=function(n){return arguments.length?i(t=n[0]*wr,r=n[1]*wr):[t*bn,r*bn]},s}function Gtt(e){var t=Je(e);function r(i,s){return[i*t,Ze(s)/t]}return r.invert=function(i,s){return[i/t,gs(s*t)]},r}function KN(e,t){var r=Ze(e),i=(r+Ze(t))/2;if(ei(i)<dr)return Gtt(e);var s=1+r*(2*i-r),n=Pn(s)/i;function o(a,h){var p=Pn(s-2*i*Ze(h))/i;return[p*Ze(a*=i),n-p*Je(a)]}return o.invert=function(a,h){var p=n-h,g=As(a,ei(p))*Sl(p);return p*i<0&&(g-=wi*Sl(a)*Sl(p)),[g/i,gs((s-(a*a+p*p)*i*i)/(2*i))]},o}function G1(){return ux(KN).scale(155.424).center([0,33.6442])}function sM(){return G1().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function A4t(e){var t=e.length;return{point:function(r,i){for(var s=-1;++s<t;)e[s].point(r,i)},sphere:function(){for(var r=-1;++r<t;)e[r].sphere()},lineStart:function(){for(var r=-1;++r<t;)e[r].lineStart()},lineEnd:function(){for(var r=-1;++r<t;)e[r].lineEnd()},polygonStart:function(){for(var r=-1;++r<t;)e[r].polygonStart()},polygonEnd:function(){for(var r=-1;++r<t;)e[r].polygonEnd()}}}function Qtt(){var e,t,r=sM(),i,s=G1().rotate([154,0]).center([-2,58.5]).parallels([55,65]),n,o=G1().rotate([157,0]).center([-3,19.9]).parallels([8,18]),a,h,p={point:function(T,C){h=[T,C]}};function g(T){var C=T[0],B=T[1];return h=null,i.point(C,B),h||(n.point(C,B),h)||(a.point(C,B),h)}g.invert=function(T){var C=r.scale(),B=r.translate(),L=(T[0]-B[0])/C,z=(T[1]-B[1])/C;return(z>=.12&&z<.234&&L>=-.425&&L<-.214?s:z>=.166&&z<.234&&L>=-.214&&L<-.115?o:r).invert(T)},g.stream=function(T){return e&&t===T?e:e=A4t([r.stream(t=T),s.stream(T),o.stream(T)])},g.precision=function(T){return arguments.length?(r.precision(T),s.precision(T),o.precision(T),v()):r.precision()},g.scale=function(T){return arguments.length?(r.scale(T),s.scale(T*.35),o.scale(T),g.translate(r.translate())):r.scale()},g.translate=function(T){if(!arguments.length)return r.translate();var C=r.scale(),B=+T[0],L=+T[1];return i=r.translate(T).clipExtent([[B-.455*C,L-.238*C],[B+.455*C,L+.238*C]]).stream(p),n=s.translate([B-.307*C,L+.201*C]).clipExtent([[B-.425*C+dr,L+.12*C+dr],[B-.214*C-dr,L+.234*C-dr]]).stream(p),a=o.translate([B-.205*C,L+.212*C]).clipExtent([[B-.214*C+dr,L+.166*C+dr],[B-.115*C-dr,L+.234*C-dr]]).stream(p),v()},g.fitExtent=function(T,C){return Z1(g,T,C)},g.fitSize=function(T,C){return ax(g,T,C)},g.fitWidth=function(T,C){return lx(g,T,C)},g.fitHeight=function(T,C){return cx(g,T,C)};function v(){return e=t=null,g}return g.scale(1070)}function oM(e){return function(t,r){var i=Je(t),s=Je(r),n=e(i*s);return n===1/0?[2,0]:[n*s*Ze(t),n*Ze(r)]}}function Tp(e){return function(t,r){var i=Pn(t*t+r*r),s=e(i),n=Ze(s),o=Je(s);return[As(t*n,i*o),gs(i&&r*n/i)]}}var aM=oM(function(e){return Pn(2/(1+e))});aM.invert=Tp(function(e){return 2*gs(e/2)});function Ktt(){return Bo(aM).scale(124.75).clipAngle(180-.001)}var lM=oM(function(e){return(e=MI(e))&&e/Ze(e)});lM.invert=Tp(function(e){return e});function Jtt(){return Bo(lM).scale(79.4188).clipAngle(180-.001)}function Q1(e,t){return[e,W1(K2((cs+t)/2))]}Q1.invert=function(e,t){return[e,2*nh(SI(t))-cs]};function tet(){return JN(Q1).scale(961/Oo)}function JN(e){var t=Bo(e),r=t.center,i=t.scale,s=t.translate,n=t.clipExtent,o=null,a,h,p;t.scale=function(v){return arguments.length?(i(v),g()):i()},t.translate=function(v){return arguments.length?(s(v),g()):s()},t.center=function(v){return arguments.length?(r(v),g()):r()},t.clipExtent=function(v){return arguments.length?(v==null?o=a=h=p=null:(o=+v[0][0],a=+v[0][1],h=+v[1][0],p=+v[1][1]),g()):o==null?null:[[o,a],[h,p]]};function g(){var v=wi*i(),T=t(zI(t.rotate()).invert([0,0]));return n(o==null?[[T[0]-v,T[1]-v],[T[0]+v,T[1]+v]]:e===Q1?[[Math.max(T[0]-v,o),a],[Math.min(T[0]+v,h),p]]:[[o,Math.max(T[1]-v,a)],[h,Math.min(T[1]+v,p)]])}return g()}function cM(e){return K2((cs+e)/2)}function t9(e,t){var r=Je(e),i=e===t?Ze(e):W1(r/Je(t))/W1(cM(t)/cM(e)),s=r*II(cM(e),i)/i;if(!i)return Q1;function n(o,a){s>0?a<-cs+dr&&(a=-cs+dr):a>cs-dr&&(a=cs-dr);var h=s/II(cM(a),i);return[h*Ze(i*o),s-h*Je(i*o)]}return n.invert=function(o,a){var h=s-a,p=Sl(i)*Pn(o*o+h*h),g=As(o,ei(h))*Sl(h);return h*i<0&&(g-=wi*Sl(o)*Sl(h)),[g/i,2*nh(II(s/p,1/i))-cs]},n}function eet(){return ux(t9).scale(109.5).parallels([30,30])}function K1(e,t){return[e,t]}K1.invert=K1;function ret(){return Bo(K1).scale(152.63)}function e9(e,t){var r=Je(e),i=e===t?Ze(e):(r-Je(t))/(t-e),s=r/i+e;if(ei(i)<dr)return K1;function n(o,a){var h=s-a,p=i*o;return[h*Ze(p),s-h*Je(p)]}return n.invert=function(o,a){var h=s-a,p=As(o,ei(h))*Sl(h);return h*i<0&&(p-=wi*Sl(o)*Sl(h)),[p/i,s-Sl(i)*Pn(o*o+h*h)]},n}function iet(){return ux(e9).scale(131.154).center([0,13.9389])}var ET=1.340264,IT=-.081106,MT=893e-6,CT=.003796,uM=Pn(3)/2,g4t=12;function hM(e,t){var r=gs(uM*Ze(t)),i=r*r,s=i*i*i;return[e*Je(r)/(uM*(ET+3*IT*i+s*(7*MT+9*CT*i))),r*(ET+IT*i+s*(MT+CT*i))]}hM.invert=function(e,t){for(var r=t,i=r*r,s=i*i*i,n=0,o,a,h;n<g4t&&(a=r*(ET+IT*i+s*(MT+CT*i))-t,h=ET+3*IT*i+s*(7*MT+9*CT*i),r-=o=a/h,i=r*r,s=i*i*i,!(ei(o)<o0));++n);return[uM*e*(ET+3*IT*i+s*(7*MT+9*CT*i))/Je(r),gs(Ze(r)/uM)]};function net(){return Bo(hM).scale(177.158)}function fM(e,t){var r=Je(t),i=Je(e)*r;return[r*Ze(e)/i,Ze(t)/i]}fM.invert=Tp(nh);function set(){return Bo(fM).scale(144.049).clipAngle(60)}function oet(){var e=1,t=0,r=0,i=1,s=1,n=0,o,a,h=null,p,g,v,T=1,C=1,B=pA({point:function(q,it){var nt=X([q,it]);this.stream.point(nt[0],nt[1])}}),L=hA,z,W;function Z(){return T=e*i,C=e*s,z=W=null,X}function X(q){var it=q[0]*T,nt=q[1]*C;if(n){var Mt=nt*o-it*a;it=it*o+nt*a,nt=Mt}return[it+t,nt+r]}return X.invert=function(q){var it=q[0]-t,nt=q[1]-r;if(n){var Mt=nt*o+it*a;it=it*o-nt*a,nt=Mt}return[it/T,nt/C]},X.stream=function(q){return z&&W===q?z:z=B(L(W=q))},X.postclip=function(q){return arguments.length?(L=q,h=p=g=v=null,Z()):L},X.clipExtent=function(q){return arguments.length?(L=q==null?(h=p=g=v=null,hA):u0(h=+q[0][0],p=+q[0][1],g=+q[1][0],v=+q[1][1]),Z()):h==null?null:[[h,p],[g,v]]},X.scale=function(q){return arguments.length?(e=+q,Z()):e},X.translate=function(q){return arguments.length?(t=+q[0],r=+q[1],Z()):[t,r]},X.angle=function(q){return arguments.length?(n=q%360*wr,a=Ze(n),o=Je(n),Z()):n*bn},X.reflectX=function(q){return arguments.length?(i=q?-1:1,Z()):i<0},X.reflectY=function(q){return arguments.length?(s=q?-1:1,Z()):s<0},X.fitExtent=function(q,it){return Z1(X,q,it)},X.fitSize=function(q,it){return ax(X,q,it)},X.fitWidth=function(q,it){return lx(X,q,it)},X.fitHeight=function(q,it){return cx(X,q,it)},X}function pM(e,t){var r=t*t,i=r*r;return[e*(.8707-.131979*r+i*(-.013791+i*(.003971*r-.001529*i))),t*(1.007226+r*(.015085+i*(-.044475+.028874*r-.005916*i)))]}pM.invert=function(e,t){var r=t,i=25,s;do{var n=r*r,o=n*n;r-=s=(r*(1.007226+n*(.015085+o*(-.044475+.028874*n-.005916*o)))-t)/(1.007226+n*(.015085*3+o*(-.044475*7+.028874*9*n-.005916*11*o)))}while(ei(s)>dr&&--i>0);return[e/(.8707+(n=r*r)*(-.131979+n*(-.013791+n*n*n*(.003971-.001529*n)))),r]};function aet(){return Bo(pM).scale(175.295)}function dM(e,t){return[Je(t)*Ze(e),Ze(t)]}dM.invert=Tp(gs);function cet(){return Bo(dM).scale(249.5).clipAngle(90+dr)}function mM(e,t){var r=Je(t),i=1+Je(e)*r;return[r*Ze(e)/i,Ze(t)/i]}mM.invert=Tp(function(e){return 2*nh(e)});function uet(){return Bo(mM).scale(250).clipAngle(142)}function AM(e,t){return[W1(K2((cs+t)/2)),-e]}AM.invert=function(e,t){return[-t,2*nh(SI(e))-cs]};function het(){var e=JN(AM),t=e.center,r=e.rotate;return e.center=function(i){return arguments.length?t([-i[1],i[0]]):(i=t(),[i[1],-i[0]])},e.rotate=function(i){return arguments.length?r([i[0],i[1],i.length>2?i[2]+90:90]):(i=r(),[i[0],i[1],i[2]-90])},r([0,0,90]).scale(159.155)}function _4t(e,t){return e.parent===t.parent?1:2}function y4t(e){return e.reduce(x4t,0)/e.length}function x4t(e,t){return e+t.x}function b4t(e){return 1+e.reduce(v4t,0)}function v4t(e,t){return Math.max(e,t.y)}function w4t(e){for(var t;t=e.children;)e=t[0];return e}function T4t(e){for(var t;t=e.children;)e=t[t.length-1];return e}function fet(){var e=_4t,t=1,r=1,i=!1;function s(n){var o,a=0;n.eachAfter(function(T){var C=T.children;C?(T.x=y4t(C),T.y=b4t(C)):(T.x=o?a+=e(T,o):0,T.y=0,o=T)});var h=w4t(n),p=T4t(n),g=h.x-e(h,p)/2,v=p.x+e(p,h)/2;return n.eachAfter(i?function(T){T.x=(T.x-n.x)*t,T.y=(n.y-T.y)*r}:function(T){T.x=(T.x-g)/(v-g)*t,T.y=(1-(n.y?T.y/n.y:1))*r})}return s.separation=function(n){return arguments.length?(e=n,s):e},s.size=function(n){return arguments.length?(i=!1,t=+n[0],r=+n[1],s):i?null:[t,r]},s.nodeSize=function(n){return arguments.length?(i=!0,t=+n[0],r=+n[1],s):i?[t,r]:null},s}function S4t(e){var t=0,r=e.children,i=r&&r.length;if(!i)t=1;else for(;--i>=0;)t+=r[i].value;e.value=t}function pet(){return this.eachAfter(S4t)}function det(e,t){let r=-1;for(let i of this)e.call(t,i,++r,this);return this}function met(e,t){for(var r=this,i=[r],s,n,o=-1;r=i.pop();)if(e.call(t,r,++o,this),s=r.children)for(n=s.length-1;n>=0;--n)i.push(s[n]);return this}function Aet(e,t){for(var r=this,i=[r],s=[],n,o,a,h=-1;r=i.pop();)if(s.push(r),n=r.children)for(o=0,a=n.length;o<a;++o)i.push(n[o]);for(;r=s.pop();)e.call(t,r,++h,this);return this}function get(e,t){let r=-1;for(let i of this)if(e.call(t,i,++r,this))return i}function _et(e){return this.eachAfter(function(t){for(var r=+e(t.data)||0,i=t.children,s=i&&i.length;--s>=0;)r+=i[s].value;t.value=r})}function yet(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})}function xet(e){for(var t=this,r=E4t(t,e),i=[t];t!==r;)t=t.parent,i.push(t);for(var s=i.length;e!==r;)i.splice(s,0,e),e=e.parent;return i}function E4t(e,t){if(e===t)return e;var r=e.ancestors(),i=t.ancestors(),s=null;for(e=r.pop(),t=i.pop();e===t;)s=e,e=r.pop(),t=i.pop();return s}function bet(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t}function vet(){return Array.from(this)}function wet(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e}function Tet(){var e=this,t=[];return e.each(function(r){r!==e&&t.push({source:r.parent,target:r})}),t}function*Eet(){var e=this,t,r=[e],i,s,n;do for(t=r.reverse(),r=[];e=t.pop();)if(yield e,i=e.children)for(s=0,n=i.length;s<n;++s)r.push(i[s]);while(r.length)}function PT(e,t){e instanceof Map?(e=[void 0,e],t===void 0&&(t=C4t)):t===void 0&&(t=M4t);for(var r=new Sp(e),i,s=[r],n,o,a,h;i=s.pop();)if((o=t(i.data))&&(h=(o=Array.from(o)).length))for(i.children=o,a=h-1;a>=0;--a)s.push(n=o[a]=new Sp(o[a])),n.parent=i,n.depth=i.depth+1;return r.eachBefore(r9)}function I4t(){return PT(this).eachBefore(P4t)}function M4t(e){return e.children}function C4t(e){return Array.isArray(e)?e[1]:null}function P4t(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function r9(e){var t=0;do e.height=t;while((e=e.parent)&&e.height<++t)}function Sp(e){this.data=e,this.depth=this.height=0,this.parent=null}Sp.prototype=PT.prototype={constructor:Sp,count:pet,each:det,eachAfter:Aet,eachBefore:met,find:get,sum:_et,sort:yet,path:xet,ancestors:bet,descendants:vet,leaves:wet,links:Tet,copy:I4t,[Symbol.iterator]:Eet};function hx(e){return e==null?null:i9(e)}function i9(e){if(typeof e!="function")throw new Error;return e}function h0(){return 0}function dA(e){return function(){return e}}function fx(){let e=1;return()=>(e=(1664525*e+1013904223)%4294967296)/4294967296}function Iet(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Met(e,t){let r=e.length,i,s;for(;r;)s=t()*r--|0,i=e[r],e[r]=e[s],e[s]=i;return e}function Cet(e){return s9(e,fx())}function s9(e,t){for(var r=0,i=(e=Met(Array.from(e),t)).length,s=[],n,o;r<i;)n=e[r],o&&Pet(o,n)?++r:(o=k4t(s=R4t(s,n)),r=0);return o}function R4t(e,t){var r,i;if(n9(t,e))return[t];for(r=0;r<e.length;++r)if(gM(t,e[r])&&n9(RT(e[r],t),e))return[e[r],t];for(r=0;r<e.length-1;++r)for(i=r+1;i<e.length;++i)if(gM(RT(e[r],e[i]),t)&&gM(RT(e[r],t),e[i])&&gM(RT(e[i],t),e[r])&&n9(Ret(e[r],e[i],t),e))return[e[r],e[i],t];throw new Error}function gM(e,t){var r=e.r-t.r,i=t.x-e.x,s=t.y-e.y;return r<0||r*r<i*i+s*s}function Pet(e,t){var r=e.r-t.r+Math.max(e.r,t.r,1)*1e-9,i=t.x-e.x,s=t.y-e.y;return r>0&&r*r>i*i+s*s}function n9(e,t){for(var r=0;r<t.length;++r)if(!Pet(e,t[r]))return!1;return!0}function k4t(e){switch(e.length){case 1:return D4t(e[0]);case 2:return RT(e[0],e[1]);case 3:return Ret(e[0],e[1],e[2])}}function D4t(e){return{x:e.x,y:e.y,r:e.r}}function RT(e,t){var r=e.x,i=e.y,s=e.r,n=t.x,o=t.y,a=t.r,h=n-r,p=o-i,g=a-s,v=Math.sqrt(h*h+p*p);return{x:(r+n+h/v*g)/2,y:(i+o+p/v*g)/2,r:(v+s+a)/2}}function Ret(e,t,r){var i=e.x,s=e.y,n=e.r,o=t.x,a=t.y,h=t.r,p=r.x,g=r.y,v=r.r,T=i-o,C=i-p,B=s-a,L=s-g,z=h-n,W=v-n,Z=i*i+s*s-n*n,X=Z-o*o-a*a+h*h,q=Z-p*p-g*g+v*v,it=C*B-T*L,nt=(B*q-L*X)/(it*2)-i,Mt=(L*z-B*W)/it,_t=(C*X-T*q)/(it*2)-s,Et=(T*W-C*z)/it,vt=Mt*Mt+Et*Et-1,Pt=2*(n+nt*Mt+_t*Et),re=nt*nt+_t*_t-n*n,$t=-(Math.abs(vt)>1e-6?(Pt+Math.sqrt(Pt*Pt-4*vt*re))/(2*vt):re/Pt);return{x:i+nt+Mt*$t,y:s+_t+Et*$t,r:$t}}function ket(e,t,r){var i=e.x-t.x,s,n,o=e.y-t.y,a,h,p=i*i+o*o;p?(n=t.r+r.r,n*=n,h=e.r+r.r,h*=h,n>h?(s=(p+h-n)/(2*p),a=Math.sqrt(Math.max(0,h/p-s*s)),r.x=e.x-s*i-a*o,r.y=e.y-s*o+a*i):(s=(p+n-h)/(2*p),a=Math.sqrt(Math.max(0,n/p-s*s)),r.x=t.x+s*i-a*o,r.y=t.y+s*o+a*i)):(r.x=t.x+r.r,r.y=t.y)}function Det(e,t){var r=e.r+t.r-1e-6,i=t.x-e.x,s=t.y-e.y;return r>0&&r*r>i*i+s*s}function Oet(e){var t=e._,r=e.next._,i=t.r+r.r,s=(t.x*r.r+r.x*t.r)/i,n=(t.y*r.r+r.y*t.r)/i;return s*s+n*n}function _M(e){this._=e,this.next=null,this.previous=null}function o9(e,t){if(!(n=(e=Iet(e)).length))return 0;var r,i,s,n,o,a,h,p,g,v,T;if(r=e[0],r.x=0,r.y=0,!(n>1))return r.r;if(i=e[1],r.x=-i.r,i.x=r.r,i.y=0,!(n>2))return r.r+i.r;ket(i,r,s=e[2]),r=new _M(r),i=new _M(i),s=new _M(s),r.next=s.previous=i,i.next=r.previous=s,s.next=i.previous=r;t:for(h=3;h<n;++h){ket(r._,i._,s=e[h]),s=new _M(s),p=i.next,g=r.previous,v=i._.r,T=r._.r;do if(v<=T){if(Det(p._,s._)){i=p,r.next=i,i.previous=r,--h;continue t}v+=p._.r,p=p.next}else{if(Det(g._,s._)){r=g,r.next=i,i.previous=r,--h;continue t}T+=g._.r,g=g.previous}while(p!==g.next);for(s.previous=r,s.next=i,r.next=i.previous=i=s,o=Oet(r);(s=s.next)!==i;)(a=Oet(s))<o&&(r=s,o=a);i=r.next}for(r=[i._],s=i;(s=s.next)!==i;)r.push(s._);for(s=s9(r,t),h=0;h<n;++h)r=e[h],r.x-=s.x,r.y-=s.y;return s.r}function Bet(e){return o9(e,fx()),e}function O4t(e){return Math.sqrt(e.value)}function Fet(){var e=null,t=1,r=1,i=h0;function s(n){let o=fx();return n.x=t/2,n.y=r/2,e?n.eachBefore(Net(e)).eachAfter(a9(i,.5,o)).eachBefore(Let(1)):n.eachBefore(Net(O4t)).eachAfter(a9(h0,1,o)).eachAfter(a9(i,n.r/Math.min(t,r),o)).eachBefore(Let(Math.min(t,r)/(2*n.r))),n}return s.radius=function(n){return arguments.length?(e=hx(n),s):e},s.size=function(n){return arguments.length?(t=+n[0],r=+n[1],s):[t,r]},s.padding=function(n){return arguments.length?(i=typeof n=="function"?n:dA(+n),s):i},s}function Net(e){return function(t){t.children||(t.r=Math.max(0,+e(t)||0))}}function a9(e,t,r){return function(i){if(s=i.children){var s,n,o=s.length,a=e(i)*t||0,h;if(a)for(n=0;n<o;++n)s[n].r+=a;if(h=o9(s,r),a)for(n=0;n<o;++n)s[n].r-=a;i.r=h+a}}}function Let(e){return function(t){var r=t.parent;t.r*=e,r&&(t.x=r.x+e*t.x,t.y=r.y+e*t.y)}}function yM(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)}function Ep(e,t,r,i,s){for(var n=e.children,o,a=-1,h=n.length,p=e.value&&(i-t)/e.value;++a<h;)o=n[a],o.y0=r,o.y1=s,o.x0=t,o.x1=t+=o.value*p}function zet(){var e=1,t=1,r=0,i=!1;function s(o){var a=o.height+1;return o.x0=o.y0=r,o.x1=e,o.y1=t/a,o.eachBefore(n(t,a)),i&&o.eachBefore(yM),o}function n(o,a){return function(h){h.children&&Ep(h,h.x0,o*(h.depth+1)/a,h.x1,o*(h.depth+2)/a);var p=h.x0,g=h.y0,v=h.x1-r,T=h.y1-r;v<p&&(p=v=(p+v)/2),T<g&&(g=T=(g+T)/2),h.x0=p,h.y0=g,h.x1=v,h.y1=T}}return s.round=function(o){return arguments.length?(i=!!o,s):i},s.size=function(o){return arguments.length?(e=+o[0],t=+o[1],s):[e,t]},s.padding=function(o){return arguments.length?(r=+o,s):r},s}var B4t={depth:-1},Uet={},l9={};function N4t(e){return e.id}function L4t(e){return e.parentId}function jet(){var e=N4t,t=L4t,r;function i(s){var n=Array.from(s),o=e,a=t,h,p,g,v,T,C,B,L,z=new Map;if(r!=null){let W=n.map((q,it)=>F4t(r(q,it,s))),Z=W.map(Vet),X=new Set(W).add("");for(let q of Z)X.has(q)||(X.add(q),W.push(q),Z.push(Vet(q)),n.push(l9));o=(q,it)=>W[it],a=(q,it)=>Z[it]}for(g=0,h=n.length;g<h;++g)p=n[g],C=n[g]=new Sp(p),(B=o(p,g,s))!=null&&(B+="")&&(L=C.id=B,z.set(L,z.has(L)?Uet:C)),(B=a(p,g,s))!=null&&(B+="")&&(C.parent=B);for(g=0;g<h;++g)if(C=n[g],B=C.parent){if(T=z.get(B),!T)throw new Error("missing: "+B);if(T===Uet)throw new Error("ambiguous: "+B);T.children?T.children.push(C):T.children=[C],C.parent=T}else{if(v)throw new Error("multiple roots");v=C}if(!v)throw new Error("no root");if(r!=null){for(;v.data===l9&&v.children.length===1;)v=v.children[0],--h;for(let W=n.length-1;W>=0&&(C=n[W],C.data===l9);--W)C.data=null}if(v.parent=B4t,v.eachBefore(function(W){W.depth=W.parent.depth+1,--h}).eachBefore(r9),v.parent=null,h>0)throw new Error("cycle");return v}return i.id=function(s){return arguments.length?(e=hx(s),i):e},i.parentId=function(s){return arguments.length?(t=hx(s),i):t},i.path=function(s){return arguments.length?(r=hx(s),i):r},i}function F4t(e){e=`${e}`;let t=e.length;return c9(e,t-1)&&!c9(e,t-2)&&(e=e.slice(0,-1)),e[0]==="/"?e:`/${e}`}function Vet(e){let t=e.length;if(t<2)return"";for(;--t>1&&!c9(e,t););return e.slice(0,t)}function c9(e,t){if(e[t]==="/"){let r=0;for(;t>0&&e[--t]==="\\";)++r;if(!(r&1))return!0}return!1}function z4t(e,t){return e.parent===t.parent?1:2}function u9(e){var t=e.children;return t?t[0]:e.t}function h9(e){var t=e.children;return t?t[t.length-1]:e.t}function U4t(e,t,r){var i=r/(t.i-e.i);t.c-=i,t.s+=r,e.c+=i,t.z+=r,t.m+=r}function V4t(e){for(var t=0,r=0,i=e.children,s=i.length,n;--s>=0;)n=i[s],n.z+=t,n.m+=t,t+=n.s+(r+=n.c)}function j4t(e,t,r){return e.a.parent===t.parent?e.a:r}function xM(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}xM.prototype=Object.create(Sp.prototype);function W4t(e){for(var t=new xM(e,0),r,i=[t],s,n,o,a;r=i.pop();)if(n=r._.children)for(r.children=new Array(a=n.length),o=a-1;o>=0;--o)i.push(s=r.children[o]=new xM(n[o],o)),s.parent=r;return(t.parent=new xM(null,0)).children=[t],t}function Wet(){var e=z4t,t=1,r=1,i=null;function s(p){var g=W4t(p);if(g.eachAfter(n),g.parent.m=-g.z,g.eachBefore(o),i)p.eachBefore(h);else{var v=p,T=p,C=p;p.eachBefore(function(Z){Z.x<v.x&&(v=Z),Z.x>T.x&&(T=Z),Z.depth>C.depth&&(C=Z)});var B=v===T?1:e(v,T)/2,L=B-v.x,z=t/(T.x+B+L),W=r/(C.depth||1);p.eachBefore(function(Z){Z.x=(Z.x+L)*z,Z.y=Z.depth*W})}return p}function n(p){var g=p.children,v=p.parent.children,T=p.i?v[p.i-1]:null;if(g){V4t(p);var C=(g[0].z+g[g.length-1].z)/2;T?(p.z=T.z+e(p._,T._),p.m=p.z-C):p.z=C}else T&&(p.z=T.z+e(p._,T._));p.parent.A=a(p,T,p.parent.A||v[0])}function o(p){p._.x=p.z+p.parent.m,p.m+=p.parent.m}function a(p,g,v){if(g){for(var T=p,C=p,B=g,L=T.parent.children[0],z=T.m,W=C.m,Z=B.m,X=L.m,q;B=h9(B),T=u9(T),B&&T;)L=u9(L),C=h9(C),C.a=p,q=B.z+Z-T.z-z+e(B._,T._),q>0&&(U4t(j4t(B,p,v),p,q),z+=q,W+=q),Z+=B.m,z+=T.m,X+=L.m,W+=C.m;B&&!h9(C)&&(C.t=B,C.m+=Z-W),T&&!u9(L)&&(L.t=T,L.m+=z-X,v=p)}return v}function h(p){p.x*=t,p.y=p.depth*r}return s.separation=function(p){return arguments.length?(e=p,s):e},s.size=function(p){return arguments.length?(i=!1,t=+p[0],r=+p[1],s):i?null:[t,r]},s.nodeSize=function(p){return arguments.length?(i=!0,t=+p[0],r=+p[1],s):i?[t,r]:null},s}function mA(e,t,r,i,s){for(var n=e.children,o,a=-1,h=n.length,p=e.value&&(s-r)/e.value;++a<h;)o=n[a],o.x0=t,o.x1=i,o.y0=r,o.y1=r+=o.value*p}var f9=(1+Math.sqrt(5))/2;function p9(e,t,r,i,s,n){for(var o=[],a=t.children,h,p,g=0,v=0,T=a.length,C,B,L=t.value,z,W,Z,X,q,it,nt;g<T;){C=s-r,B=n-i;do z=a[v++].value;while(!z&&v<T);for(W=Z=z,it=Math.max(B/C,C/B)/(L*e),nt=z*z*it,q=Math.max(Z/nt,nt/W);v<T;++v){if(z+=p=a[v].value,p<W&&(W=p),p>Z&&(Z=p),nt=z*z*it,X=Math.max(Z/nt,nt/W),X>q){z-=p;break}q=X}o.push(h={value:z,dice:C<B,children:a.slice(g,v)}),h.dice?Ep(h,r,i,s,L?i+=B*z/L:n):mA(h,r,i,L?r+=C*z/L:s,n),L-=z,g=v}return o}var bM=function e(t){function r(i,s,n,o,a){p9(t,i,s,n,o,a)}return r.ratio=function(i){return e((i=+i)>1?i:1)},r}(f9);function $et(){var e=bM,t=!1,r=1,i=1,s=[0],n=h0,o=h0,a=h0,h=h0,p=h0;function g(T){return T.x0=T.y0=0,T.x1=r,T.y1=i,T.eachBefore(v),s=[0],t&&T.eachBefore(yM),T}function v(T){var C=s[T.depth],B=T.x0+C,L=T.y0+C,z=T.x1-C,W=T.y1-C;z<B&&(B=z=(B+z)/2),W<L&&(L=W=(L+W)/2),T.x0=B,T.y0=L,T.x1=z,T.y1=W,T.children&&(C=s[T.depth+1]=n(T)/2,B+=p(T)-C,L+=o(T)-C,z-=a(T)-C,W-=h(T)-C,z<B&&(B=z=(B+z)/2),W<L&&(L=W=(L+W)/2),e(T,B,L,z,W))}return g.round=function(T){return arguments.length?(t=!!T,g):t},g.size=function(T){return arguments.length?(r=+T[0],i=+T[1],g):[r,i]},g.tile=function(T){return arguments.length?(e=i9(T),g):e},g.padding=function(T){return arguments.length?g.paddingInner(T).paddingOuter(T):g.paddingInner()},g.paddingInner=function(T){return arguments.length?(n=typeof T=="function"?T:dA(+T),g):n},g.paddingOuter=function(T){return arguments.length?g.paddingTop(T).paddingRight(T).paddingBottom(T).paddingLeft(T):g.paddingTop()},g.paddingTop=function(T){return arguments.length?(o=typeof T=="function"?T:dA(+T),g):o},g.paddingRight=function(T){return arguments.length?(a=typeof T=="function"?T:dA(+T),g):a},g.paddingBottom=function(T){return arguments.length?(h=typeof T=="function"?T:dA(+T),g):h},g.paddingLeft=function(T){return arguments.length?(p=typeof T=="function"?T:dA(+T),g):p},g}function Het(e,t,r,i,s){var n=e.children,o,a=n.length,h,p=new Array(a+1);for(p[0]=h=o=0;o<a;++o)p[o+1]=h+=n[o].value;g(0,a,e.value,t,r,i,s);function g(v,T,C,B,L,z,W){if(v>=T-1){var Z=n[v];Z.x0=B,Z.y0=L,Z.x1=z,Z.y1=W;return}for(var X=p[v],q=C/2+X,it=v+1,nt=T-1;it<nt;){var Mt=it+nt>>>1;p[Mt]<q?it=Mt+1:nt=Mt}q-p[it-1]<p[it]-q&&v+1<it&&--it;var _t=p[it]-X,Et=C-_t;if(z-B>W-L){var vt=C?(B*Et+z*_t)/C:z;g(v,it,_t,B,L,vt,W),g(it,T,Et,vt,L,z,W)}else{var Pt=C?(L*Et+W*_t)/C:W;g(v,it,_t,B,L,z,Pt),g(it,T,Et,B,Pt,z,W)}}}function qet(e,t,r,i,s){(e.depth&1?mA:Ep)(e,t,r,i,s)}var Yet=function e(t){function r(i,s,n,o,a){if((h=i._squarify)&&h.ratio===t)for(var h,p,g,v,T=-1,C,B=h.length,L=i.value;++T<B;){for(p=h[T],g=p.children,v=p.value=0,C=g.length;v<C;++v)p.value+=g[v].value;p.dice?Ep(p,s,n,o,L?n+=(a-n)*p.value/L:a):mA(p,s,n,L?s+=(o-s)*p.value/L:o,a),L-=p.value}else i._squarify=h=p9(t,i,s,n,o,a),h.ratio=t}return r.ratio=function(i){return e((i=+i)>1?i:1)},r}(f9);function Xet(e){for(var t=-1,r=e.length,i,s=e[r-1],n=0;++t<r;)i=s,s=e[t],n+=i[1]*s[0]-i[0]*s[1];return n/2}function Zet(e){for(var t=-1,r=e.length,i=0,s=0,n,o=e[r-1],a,h=0;++t<r;)n=o,o=e[t],h+=a=n[0]*o[1]-o[0]*n[1],i+=(n[0]+o[0])*a,s+=(n[1]+o[1])*a;return h*=3,[i/h,s/h]}function Get(e,t,r){return(t[0]-e[0])*(r[1]-e[1])-(t[1]-e[1])*(r[0]-e[0])}function $4t(e,t){return e[0]-t[0]||e[1]-t[1]}function Qet(e){let t=e.length,r=[0,1],i=2,s;for(s=2;s<t;++s){for(;i>1&&Get(e[r[i-2]],e[r[i-1]],e[s])<=0;)--i;r[i++]=s}return r.slice(0,i)}function Ket(e){if((r=e.length)<3)return null;var t,r,i=new Array(r),s=new Array(r);for(t=0;t<r;++t)i[t]=[+e[t][0],+e[t][1],t];for(i.sort($4t),t=0;t<r;++t)s[t]=[i[t][0],-i[t][1]];var n=Qet(i),o=Qet(s),a=o[0]===n[0],h=o[o.length-1]===n[n.length-1],p=[];for(t=n.length-1;t>=0;--t)p.push(e[i[n[t]][2]]);for(t=+a;t<o.length-h;++t)p.push(e[i[o[t]][2]]);return p}function Jet(e,t){for(var r=e.length,i=e[r-1],s=t[0],n=t[1],o=i[0],a=i[1],h,p,g=!1,v=0;v<r;++v)i=e[v],h=i[0],p=i[1],p>n!=a>n&&s<(o-h)*(n-p)/(a-p)+h&&(g=!g),o=h,a=p;return g}function trt(e){for(var t=-1,r=e.length,i=e[r-1],s,n,o=i[0],a=i[1],h=0;++t<r;)s=o,n=a,i=e[t],o=i[0],a=i[1],s-=o,n-=a,h+=Math.hypot(s,n);return h}var Mn=Math.random;var ert=function e(t){function r(i,s){return i=i==null?0:+i,s=s==null?1:+s,arguments.length===1?(s=i,i=0):s-=i,function(){return t()*s+i}}return r.source=e,r}(Mn);var rrt=function e(t){function r(i,s){return arguments.length<2&&(s=i,i=0),i=Math.floor(i),s=Math.floor(s)-i,function(){return Math.floor(t()*s+i)}}return r.source=e,r}(Mn);var px=function e(t){function r(i,s){var n,o;return i=i==null?0:+i,s=s==null?1:+s,function(){var a;if(n!=null)a=n,n=null;else do n=t()*2-1,a=t()*2-1,o=n*n+a*a;while(!o||o>1);return i+s*a*Math.sqrt(-2*Math.log(o)/o)}}return r.source=e,r}(Mn);var irt=function e(t){var r=px.source(t);function i(){var s=r.apply(this,arguments);return function(){return Math.exp(s())}}return i.source=e,i}(Mn);var vM=function e(t){function r(i){return(i=+i)<=0?()=>0:function(){for(var s=0,n=i;n>1;--n)s+=t();return s+n*t()}}return r.source=e,r}(Mn);var nrt=function e(t){var r=vM.source(t);function i(s){if((s=+s)==0)return t;var n=r(s);return function(){return n()/s}}return i.source=e,i}(Mn);var srt=function e(t){function r(i){return function(){return-Math.log1p(-t())/i}}return r.source=e,r}(Mn);var ort=function e(t){function r(i){if((i=+i)<0)throw new RangeError("invalid alpha");return i=1/-i,function(){return Math.pow(1-t(),i)}}return r.source=e,r}(Mn);var art=function e(t){function r(i){if((i=+i)<0||i>1)throw new RangeError("invalid p");return function(){return Math.floor(t()+i)}}return r.source=e,r}(Mn);var wM=function e(t){function r(i){if((i=+i)<0||i>1)throw new RangeError("invalid p");return i===0?()=>1/0:i===1?()=>1:(i=Math.log1p(-i),function(){return 1+Math.floor(Math.log1p(-t())/i)})}return r.source=e,r}(Mn);var dx=function e(t){var r=px.source(t)();function i(s,n){if((s=+s)<0)throw new RangeError("invalid k");if(s===0)return()=>0;if(n=n==null?1:+n,s===1)return()=>-Math.log1p(-t())*n;var o=(s<1?s+1:s)-1/3,a=1/(3*Math.sqrt(o)),h=s<1?()=>Math.pow(t(),1/s):()=>1;return function(){do{do var p=r(),g=1+a*p;while(g<=0);g*=g*g;var v=1-t()}while(v>=1-.0331*p*p*p*p&&Math.log(v)>=.5*p*p+o*(1-g+Math.log(g)));return o*g*h()*n}}return i.source=e,i}(Mn);var TM=function e(t){var r=dx.source(t);function i(s,n){var o=r(s),a=r(n);return function(){var h=o();return h===0?0:h/(h+a())}}return i.source=e,i}(Mn);var SM=function e(t){var r=wM.source(t),i=TM.source(t);function s(n,o){return n=+n,(o=+o)>=1?()=>n:o<=0?()=>0:function(){for(var a=0,h=n,p=o;h*p>16&&h*(1-p)>16;){var g=Math.floor((h+1)*p),v=i(g,h-g+1)();v<=p?(a+=g,h-=g,p=(p-v)/(1-v)):(h=g-1,p/=v)}for(var T=p<.5,C=T?p:1-p,B=r(C),L=B(),z=0;L<=h;++z)L+=B();return a+(T?z:h-z)}}return s.source=e,s}(Mn);var lrt=function e(t){function r(i,s,n){var o;return(i=+i)==0?o=a=>-Math.log(a):(i=1/i,o=a=>Math.pow(a,i)),s=s==null?0:+s,n=n==null?1:+n,function(){return s+n*o(-Math.log1p(-t()))}}return r.source=e,r}(Mn);var crt=function e(t){function r(i,s){return i=i==null?0:+i,s=s==null?1:+s,function(){return i+s*Math.tan(Math.PI*t())}}return r.source=e,r}(Mn);var urt=function e(t){function r(i,s){return i=i==null?0:+i,s=s==null?1:+s,function(){var n=t();return i+s*Math.log(n/(1-n))}}return r.source=e,r}(Mn);var hrt=function e(t){var r=dx.source(t),i=SM.source(t);function s(n){return function(){for(var o=0,a=n;a>16;){var h=Math.floor(.875*a),p=r(h)();if(p>a)return o+i(h-1,a/p)();o+=h,a-=p}for(var g=-Math.log1p(-t()),v=0;g<=a;++v)g-=Math.log1p(-t());return o+v}}return s.source=e,s}(Mn);var frt=23283064365386963e-26;function d9(e=Math.random()){let t=(0<=e&&e<1?e/frt:Math.abs(e))|0;return()=>(t=1664525*t+1013904223|0,frt*(t>>>0))}function $s(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function oh(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}var EM=Symbol("implicit");function mx(){var e=new sf,t=[],r=[],i=EM;function s(n){let o=e.get(n);if(o===void 0){if(i!==EM)return i;e.set(n,o=t.push(n)-1)}return r[o%r.length]}return s.domain=function(n){if(!arguments.length)return t.slice();t=[],e=new sf;for(let o of n)e.has(o)||e.set(o,t.push(o)-1);return s},s.range=function(n){return arguments.length?(r=Array.from(n),s):r.slice()},s.unknown=function(n){return arguments.length?(i=n,s):i},s.copy=function(){return mx(t,r).unknown(i)},$s.apply(s,arguments),s}function kT(){var e=mx().unknown(void 0),t=e.domain,r=e.range,i=0,s=1,n,o,a=!1,h=0,p=0,g=.5;delete e.unknown;function v(){var T=t().length,C=s<i,B=C?s:i,L=C?i:s;n=(L-B)/Math.max(1,T-h+p*2),a&&(n=Math.floor(n)),B+=(L-B-n*(T-h))*g,o=n*(1-h),a&&(B=Math.round(B),o=Math.round(o));var z=eh(T).map(function(W){return B+n*W});return r(C?z.reverse():z)}return e.domain=function(T){return arguments.length?(t(T),v()):t()},e.range=function(T){return arguments.length?([i,s]=T,i=+i,s=+s,v()):[i,s]},e.rangeRound=function(T){return[i,s]=T,i=+i,s=+s,a=!0,v()},e.bandwidth=function(){return o},e.step=function(){return n},e.round=function(T){return arguments.length?(a=!!T,v()):a},e.padding=function(T){return arguments.length?(h=Math.min(1,p=+T),v()):h},e.paddingInner=function(T){return arguments.length?(h=Math.min(1,T),v()):h},e.paddingOuter=function(T){return arguments.length?(p=+T,v()):p},e.align=function(T){return arguments.length?(g=Math.max(0,Math.min(1,T)),v()):g},e.copy=function(){return kT(t(),[i,s]).round(a).paddingInner(h).paddingOuter(p).align(g)},$s.apply(v(),arguments)}function prt(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return prt(t())},e}function drt(){return prt(kT.apply(null,arguments).paddingInner(1))}function m9(e){return function(){return e}}function AA(e){return+e}var mrt=[0,1];function ra(e){return e}function A9(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:m9(isNaN(t)?NaN:.5)}function H4t(e,t){var r;return e>t&&(r=e,e=t,t=r),function(i){return Math.max(e,Math.min(t,i))}}function q4t(e,t,r){var i=e[0],s=e[1],n=t[0],o=t[1];return s<i?(i=A9(s,i),n=r(o,n)):(i=A9(i,s),n=r(n,o)),function(a){return n(i(a))}}function Y4t(e,t,r){var i=Math.min(e.length,t.length)-1,s=new Array(i),n=new Array(i),o=-1;for(e[i]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<i;)s[o]=A9(e[o],e[o+1]),n[o]=r(t[o],t[o+1]);return function(a){var h=Mc(e,a,1,i)-1;return n[h](s[h](a))}}function Ip(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function J1(){var e=mrt,t=mrt,r=vl,i,s,n,o=ra,a,h,p;function g(){var T=Math.min(e.length,t.length);return o!==ra&&(o=H4t(e[0],e[T-1])),a=T>2?Y4t:q4t,h=p=null,v}function v(T){return T==null||isNaN(T=+T)?n:(h||(h=a(e.map(i),t,r)))(i(o(T)))}return v.invert=function(T){return o(s((p||(p=a(t,e.map(i),ba)))(T)))},v.domain=function(T){return arguments.length?(e=Array.from(T,AA),g()):e.slice()},v.range=function(T){return arguments.length?(t=Array.from(T),g()):t.slice()},v.rangeRound=function(T){return t=Array.from(T),r=iA,g()},v.clamp=function(T){return arguments.length?(o=T?!0:ra,g()):o!==ra},v.interpolate=function(T){return arguments.length?(r=T,g()):r},v.unknown=function(T){return arguments.length?(n=T,v):n},function(T,C){return i=T,s=C,g()}}function t_(){return J1()(ra,ra)}function DT(e,t,r,i){var s=m1(e,t,r),n;switch(i=hf(i??",f"),i.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return i.precision==null&&!isNaN(n=wI(s,o))&&(i.precision=n),lT(i,o)}case"":case"e":case"g":case"p":case"r":{i.precision==null&&!isNaN(n=TI(s,Math.max(Math.abs(e),Math.abs(t))))&&(i.precision=n-(i.type==="e"));break}case"f":case"%":{i.precision==null&&!isNaN(n=vI(s))&&(i.precision=n-(i.type==="%")*2);break}}return j1(i)}function Kl(e){var t=e.domain;return e.ticks=function(r){var i=t();return Pc(i[0],i[i.length-1],r??10)},e.tickFormat=function(r,i){var s=t();return DT(s[0],s[s.length-1],r??10,i)},e.nice=function(r){r==null&&(r=10);var i=t(),s=0,n=i.length-1,o=i[s],a=i[n],h,p,g=10;for(a<o&&(p=o,o=a,a=p,p=s,s=n,n=p);g-- >0;){if(p=of(o,a,r),p===h)return i[s]=o,i[n]=a,t(i);if(p>0)o=Math.floor(o/p)*p,a=Math.ceil(a/p)*p;else if(p<0)o=Math.ceil(o*p)/p,a=Math.floor(a*p)/p;else break;h=p}return e},e}function IM(){var e=t_();return e.copy=function(){return Ip(e,IM())},$s.apply(e,arguments),Kl(e)}function MM(e){var t;function r(i){return i==null||isNaN(i=+i)?t:i}return r.invert=r,r.domain=r.range=function(i){return arguments.length?(e=Array.from(i,AA),r):e.slice()},r.unknown=function(i){return arguments.length?(t=i,r):t},r.copy=function(){return MM(e).unknown(t)},e=arguments.length?Array.from(e,AA):[0,1],Kl(r)}function OT(e,t){e=e.slice();var r=0,i=e.length-1,s=e[r],n=e[i],o;return n<s&&(o=r,r=i,i=o,o=s,s=n,n=o),e[r]=t.floor(s),e[i]=t.ceil(n),e}function Art(e){return Math.log(e)}function grt(e){return Math.exp(e)}function X4t(e){return-Math.log(-e)}function Z4t(e){return-Math.exp(-e)}function G4t(e){return isFinite(e)?+("1e"+e):e<0?0:e}function Q4t(e){return e===10?G4t:e===Math.E?Math.exp:t=>Math.pow(e,t)}function K4t(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function _rt(e){return(t,r)=>-e(-t,r)}function BT(e){let t=e(Art,grt),r=t.domain,i=10,s,n;function o(){return s=K4t(i),n=Q4t(i),r()[0]<0?(s=_rt(s),n=_rt(n),e(X4t,Z4t)):e(Art,grt),t}return t.base=function(a){return arguments.length?(i=+a,o()):i},t.domain=function(a){return arguments.length?(r(a),o()):r()},t.ticks=a=>{let h=r(),p=h[0],g=h[h.length-1],v=g<p;v&&([p,g]=[g,p]);let T=s(p),C=s(g),B,L,z=a==null?10:+a,W=[];if(!(i%1)&&C-T<z){if(T=Math.floor(T),C=Math.ceil(C),p>0){for(;T<=C;++T)for(B=1;B<i;++B)if(L=T<0?B/n(-T):B*n(T),!(L<p)){if(L>g)break;W.push(L)}}else for(;T<=C;++T)for(B=i-1;B>=1;--B)if(L=T>0?B/n(-T):B*n(T),!(L<p)){if(L>g)break;W.push(L)}W.length*2<z&&(W=Pc(p,g,z))}else W=Pc(T,C,Math.min(C-T,z)).map(n);return v?W.reverse():W},t.tickFormat=(a,h)=>{if(a==null&&(a=10),h==null&&(h=i===10?"s":","),typeof h!="function"&&(!(i%1)&&(h=hf(h)).precision==null&&(h.trim=!0),h=j1(h)),a===1/0)return h;let p=Math.max(1,i*a/t.ticks().length);return g=>{let v=g/n(Math.round(s(g)));return v*i<i-.5&&(v*=i),v<=p?h(g):""}},t.nice=()=>r(OT(r(),{floor:a=>n(Math.floor(s(a))),ceil:a=>n(Math.ceil(s(a)))})),t}function CM(){let e=BT(J1()).domain([1,10]);return e.copy=()=>Ip(e,CM()).base(e.base()),$s.apply(e,arguments),e}function yrt(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function xrt(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function NT(e){var t=1,r=e(yrt(t),xrt(t));return r.constant=function(i){return arguments.length?e(yrt(t=+i),xrt(t)):t},Kl(r)}function PM(){var e=NT(J1());return e.copy=function(){return Ip(e,PM()).constant(e.constant())},$s.apply(e,arguments)}function brt(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function J4t(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function t5t(e){return e<0?-e*e:e*e}function LT(e){var t=e(ra,ra),r=1;function i(){return r===1?e(ra,ra):r===.5?e(J4t,t5t):e(brt(r),brt(1/r))}return t.exponent=function(s){return arguments.length?(r=+s,i()):r},Kl(t)}function FT(){var e=LT(J1());return e.copy=function(){return Ip(e,FT()).exponent(e.exponent())},$s.apply(e,arguments),e}function vrt(){return FT.apply(null,arguments).exponent(.5)}function wrt(e){return Math.sign(e)*e*e}function e5t(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function RM(){var e=t_(),t=[0,1],r=!1,i;function s(n){var o=e5t(e(n));return isNaN(o)?i:r?Math.round(o):o}return s.invert=function(n){return e.invert(wrt(n))},s.domain=function(n){return arguments.length?(e.domain(n),s):e.domain()},s.range=function(n){return arguments.length?(e.range((t=Array.from(n,AA)).map(wrt)),s):t.slice()},s.rangeRound=function(n){return s.range(n).round(!0)},s.round=function(n){return arguments.length?(r=!!n,s):r},s.clamp=function(n){return arguments.length?(e.clamp(n),s):e.clamp()},s.unknown=function(n){return arguments.length?(i=n,s):i},s.copy=function(){return RM(e.domain(),t).round(r).clamp(e.clamp()).unknown(i)},$s.apply(s,arguments),Kl(s)}function kM(){var e=[],t=[],r=[],i;function s(){var o=0,a=Math.max(1,t.length);for(r=new Array(a-1);++o<a;)r[o-1]=w6(e,o/a);return n}function n(o){return o==null||isNaN(o=+o)?i:t[Mc(r,o)]}return n.invertExtent=function(o){var a=t.indexOf(o);return a<0?[NaN,NaN]:[a>0?r[a-1]:e[0],a<r.length?r[a]:e[e.length-1]]},n.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let a of o)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(An),s()},n.range=function(o){return arguments.length?(t=Array.from(o),s()):t.slice()},n.unknown=function(o){return arguments.length?(i=o,n):i},n.quantiles=function(){return r.slice()},n.copy=function(){return kM().domain(e).range(t).unknown(i)},$s.apply(n,arguments)}function DM(){var e=0,t=1,r=1,i=[.5],s=[0,1],n;function o(h){return h!=null&&h<=h?s[Mc(i,h,0,r)]:n}function a(){var h=-1;for(i=new Array(r);++h<r;)i[h]=((h+1)*t-(h-r)*e)/(r+1);return o}return o.domain=function(h){return arguments.length?([e,t]=h,e=+e,t=+t,a()):[e,t]},o.range=function(h){return arguments.length?(r=(s=Array.from(h)).length-1,a()):s.slice()},o.invertExtent=function(h){var p=s.indexOf(h);return p<0?[NaN,NaN]:p<1?[e,i[0]]:p>=r?[i[r-1],t]:[i[p-1],i[p]]},o.unknown=function(h){return arguments.length&&(n=h),o},o.thresholds=function(){return i.slice()},o.copy=function(){return DM().domain([e,t]).range(s).unknown(n)},$s.apply(Kl(o),arguments)}function OM(){var e=[.5],t=[0,1],r,i=1;function s(n){return n!=null&&n<=n?t[Mc(e,n,0,i)]:r}return s.domain=function(n){return arguments.length?(e=Array.from(n),i=Math.min(e.length,t.length-1),s):e.slice()},s.range=function(n){return arguments.length?(t=Array.from(n),i=Math.min(e.length,t.length-1),s):t.slice()},s.invertExtent=function(n){var o=t.indexOf(n);return[e[o-1],e[o]]},s.unknown=function(n){return arguments.length?(r=n,s):r},s.copy=function(){return OM().domain(e).range(t).unknown(r)},$s.apply(s,arguments)}var g9=new Date,_9=new Date;function es(e,t,r,i){function s(n){return e(n=arguments.length===0?new Date:new Date(+n)),n}return s.floor=n=>(e(n=new Date(+n)),n),s.ceil=n=>(e(n=new Date(n-1)),t(n,1),e(n),n),s.round=n=>{let o=s(n),a=s.ceil(n);return n-o<a-n?o:a},s.offset=(n,o)=>(t(n=new Date(+n),o==null?1:Math.floor(o)),n),s.range=(n,o,a)=>{let h=[];if(n=s.ceil(n),a=a==null?1:Math.floor(a),!(n<o)||!(a>0))return h;let p;do h.push(p=new Date(+n)),t(n,a),e(n);while(p<n&&n<o);return h},s.filter=n=>es(o=>{if(o>=o)for(;e(o),!n(o);)o.setTime(o-1)},(o,a)=>{if(o>=o)if(a<0)for(;++a<=0;)for(;t(o,-1),!n(o););else for(;--a>=0;)for(;t(o,1),!n(o););}),r&&(s.count=(n,o)=>(g9.setTime(+n),_9.setTime(+o),e(g9),e(_9),Math.floor(r(g9,_9))),s.every=n=>(n=Math.floor(n),!isFinite(n)||!(n>0)?null:n>1?s.filter(i?o=>i(o)%n===0:o=>s.count(0,o)%n===0):s)),s}var gA=es(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);gA.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?es(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):gA);var y9=gA.range;var mu=es(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*1e3)},(e,t)=>(t-e)/1e3,e=>e.getUTCSeconds()),x9=mu.range;var r_=es(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*1e3)},(e,t)=>{e.setTime(+e+t*6e4)},(e,t)=>(t-e)/6e4,e=>e.getMinutes()),Trt=r_.range,i_=es(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*6e4)},(e,t)=>(t-e)/6e4,e=>e.getUTCMinutes()),Srt=i_.range;var s_=es(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*1e3-e.getMinutes()*6e4)},(e,t)=>{e.setTime(+e+t*36e5)},(e,t)=>(t-e)/36e5,e=>e.getHours()),Ert=s_.range,o_=es(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*36e5)},(e,t)=>(t-e)/36e5,e=>e.getUTCHours()),Irt=o_.range;var Cp=es(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*6e4)/864e5,e=>e.getDate()-1),Mrt=Cp.range,_A=es(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/864e5,e=>e.getUTCDate()-1),Crt=_A.range,UT=es(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/864e5,e=>Math.floor(e/864e5)),Prt=UT.range;function a_(e){return es(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*6e4)/6048e5)}var Pp=a_(0),l_=a_(1),b9=a_(2),v9=a_(3),f0=a_(4),w9=a_(5),T9=a_(6),S9=Pp.range,krt=l_.range,Drt=b9.range,Ort=v9.range,Brt=f0.range,Nrt=w9.range,Lrt=T9.range;function c_(e){return es(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/6048e5)}var Rp=c_(0),u_=c_(1),E9=c_(2),I9=c_(3),p0=c_(4),M9=c_(5),C9=c_(6),P9=Rp.range,Frt=u_.range,zrt=E9.range,Urt=I9.range,Vrt=p0.range,jrt=M9.range,Wrt=C9.range;var h_=es(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth()),$rt=h_.range,f_=es(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth()),Hrt=f_.range;var Oc=es(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Oc.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:es(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});var qrt=Oc.range,Bc=es(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Bc.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:es(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});var Yrt=Bc.range;function Zrt(e,t,r,i,s,n){let o=[[mu,1,1e3],[mu,5,5*1e3],[mu,15,15*1e3],[mu,30,30*1e3],[n,1,6e4],[n,5,5*6e4],[n,15,15*6e4],[n,30,30*6e4],[s,1,36e5],[s,3,3*36e5],[s,6,6*36e5],[s,12,12*36e5],[i,1,864e5],[i,2,2*864e5],[r,1,6048e5],[t,1,2592e6],[t,3,3*2592e6],[e,1,31536e6]];function a(p,g,v){let T=g<p;T&&([p,g]=[g,p]);let C=v&&typeof v.range=="function"?v:h(p,g,v),B=C?C.range(p,+g+1):[];return T?B.reverse():B}function h(p,g,v){let T=Math.abs(g-p)/v,C=qm(([,,z])=>z).right(o,T);if(C===o.length)return e.every(m1(p/31536e6,g/31536e6,v));if(C===0)return gA.every(Math.max(m1(p,g,v),1));let[B,L]=o[T/o[C-1][2]<o[C][2]/T?C-1:C];return B.every(L)}return[a,h]}var[BM,NM]=Zrt(Bc,f_,Rp,UT,o_,i_),[LM,FM]=Zrt(Oc,h_,Pp,Cp,s_,r_);function R9(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function k9(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function VT(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function $T(e){var t=e.dateTime,r=e.date,i=e.time,s=e.periods,n=e.days,o=e.shortDays,a=e.months,h=e.shortMonths,p=jT(s),g=WT(s),v=jT(n),T=WT(n),C=jT(o),B=WT(o),L=jT(a),z=WT(a),W=jT(h),Z=WT(h),X={a:de,A:Ee,b:Se,B:ze,c:null,d:eit,e:eit,f:S5t,g:B5t,G:L5t,H:v5t,I:w5t,j:T5t,L:oit,m:E5t,M:I5t,p:ke,q:nr,Q:nit,s:sit,S:M5t,u:C5t,U:P5t,V:R5t,w:k5t,W:D5t,x:null,X:null,y:O5t,Y:N5t,Z:F5t,"%":iit},q={a:Si,A:yi,b:hi,B:Kr,c:null,d:rit,e:rit,f:j5t,g:K5t,G:tEt,H:z5t,I:U5t,j:V5t,L:lit,m:W5t,M:$5t,p:zr,q:Br,Q:nit,s:sit,S:H5t,u:q5t,U:Y5t,V:X5t,w:Z5t,W:G5t,x:null,X:null,y:Q5t,Y:J5t,Z:eEt,"%":iit},it={a:vt,A:Pt,b:re,B:$t,c:xt,d:Jrt,e:Jrt,f:_5t,g:Krt,G:Qrt,H:tit,I:tit,j:d5t,L:g5t,m:p5t,M:m5t,p:Et,q:f5t,Q:x5t,s:b5t,S:A5t,u:a5t,U:l5t,V:c5t,w:o5t,W:u5t,x:Vt,X:qt,y:Krt,Y:Qrt,Z:h5t,"%":y5t};X.x=nt(r,X),X.X=nt(i,X),X.c=nt(t,X),q.x=nt(r,q),q.X=nt(i,q),q.c=nt(t,q);function nt(Fe,Sr){return function($r){var Ie=[],en=-1,xi=0,rn=Fe.length,fn,Er,ae;for($r instanceof Date||($r=new Date(+$r));++en<rn;)Fe.charCodeAt(en)===37&&(Ie.push(Fe.slice(xi,en)),(Er=Grt[fn=Fe.charAt(++en)])!=null?fn=Fe.charAt(++en):Er=fn==="e"?" ":"0",(ae=Sr[fn])&&(fn=ae($r,Er)),Ie.push(fn),xi=en+1);return Ie.push(Fe.slice(xi,en)),Ie.join("")}}function Mt(Fe,Sr){return function($r){var Ie=VT(1900,void 0,1),en=_t(Ie,Fe,$r+="",0),xi,rn;if(en!=$r.length)return null;if("Q"in Ie)return new Date(Ie.Q);if("s"in Ie)return new Date(Ie.s*1e3+("L"in Ie?Ie.L:0));if(Sr&&!("Z"in Ie)&&(Ie.Z=0),"p"in Ie&&(Ie.H=Ie.H%12+Ie.p*12),Ie.m===void 0&&(Ie.m="q"in Ie?Ie.q:0),"V"in Ie){if(Ie.V<1||Ie.V>53)return null;"w"in Ie||(Ie.w=1),"Z"in Ie?(xi=k9(VT(Ie.y,0,1)),rn=xi.getUTCDay(),xi=rn>4||rn===0?u_.ceil(xi):u_(xi),xi=_A.offset(xi,(Ie.V-1)*7),Ie.y=xi.getUTCFullYear(),Ie.m=xi.getUTCMonth(),Ie.d=xi.getUTCDate()+(Ie.w+6)%7):(xi=R9(VT(Ie.y,0,1)),rn=xi.getDay(),xi=rn>4||rn===0?l_.ceil(xi):l_(xi),xi=Cp.offset(xi,(Ie.V-1)*7),Ie.y=xi.getFullYear(),Ie.m=xi.getMonth(),Ie.d=xi.getDate()+(Ie.w+6)%7)}else("W"in Ie||"U"in Ie)&&("w"in Ie||(Ie.w="u"in Ie?Ie.u%7:"W"in Ie?1:0),rn="Z"in Ie?k9(VT(Ie.y,0,1)).getUTCDay():R9(VT(Ie.y,0,1)).getDay(),Ie.m=0,Ie.d="W"in Ie?(Ie.w+6)%7+Ie.W*7-(rn+5)%7:Ie.w+Ie.U*7-(rn+6)%7);return"Z"in Ie?(Ie.H+=Ie.Z/100|0,Ie.M+=Ie.Z%100,k9(Ie)):R9(Ie)}}function _t(Fe,Sr,$r,Ie){for(var en=0,xi=Sr.length,rn=$r.length,fn,Er;en<xi;){if(Ie>=rn)return-1;if(fn=Sr.charCodeAt(en++),fn===37){if(fn=Sr.charAt(en++),Er=it[fn in Grt?Sr.charAt(en++):fn],!Er||(Ie=Er(Fe,$r,Ie))<0)return-1}else if(fn!=$r.charCodeAt(Ie++))return-1}return Ie}function Et(Fe,Sr,$r){var Ie=p.exec(Sr.slice($r));return Ie?(Fe.p=g.get(Ie[0].toLowerCase()),$r+Ie[0].length):-1}function vt(Fe,Sr,$r){var Ie=C.exec(Sr.slice($r));return Ie?(Fe.w=B.get(Ie[0].toLowerCase()),$r+Ie[0].length):-1}function Pt(Fe,Sr,$r){var Ie=v.exec(Sr.slice($r));return Ie?(Fe.w=T.get(Ie[0].toLowerCase()),$r+Ie[0].length):-1}function re(Fe,Sr,$r){var Ie=W.exec(Sr.slice($r));return Ie?(Fe.m=Z.get(Ie[0].toLowerCase()),$r+Ie[0].length):-1}function $t(Fe,Sr,$r){var Ie=L.exec(Sr.slice($r));return Ie?(Fe.m=z.get(Ie[0].toLowerCase()),$r+Ie[0].length):-1}function xt(Fe,Sr,$r){return _t(Fe,t,Sr,$r)}function Vt(Fe,Sr,$r){return _t(Fe,r,Sr,$r)}function qt(Fe,Sr,$r){return _t(Fe,i,Sr,$r)}function de(Fe){return o[Fe.getDay()]}function Ee(Fe){return n[Fe.getDay()]}function Se(Fe){return h[Fe.getMonth()]}function ze(Fe){return a[Fe.getMonth()]}function ke(Fe){return s[+(Fe.getHours()>=12)]}function nr(Fe){return 1+~~(Fe.getMonth()/3)}function Si(Fe){return o[Fe.getUTCDay()]}function yi(Fe){return n[Fe.getUTCDay()]}function hi(Fe){return h[Fe.getUTCMonth()]}function Kr(Fe){return a[Fe.getUTCMonth()]}function zr(Fe){return s[+(Fe.getUTCHours()>=12)]}function Br(Fe){return 1+~~(Fe.getUTCMonth()/3)}return{format:function(Fe){var Sr=nt(Fe+="",X);return Sr.toString=function(){return Fe},Sr},parse:function(Fe){var Sr=Mt(Fe+="",!1);return Sr.toString=function(){return Fe},Sr},utcFormat:function(Fe){var Sr=nt(Fe+="",q);return Sr.toString=function(){return Fe},Sr},utcParse:function(Fe){var Sr=Mt(Fe+="",!0);return Sr.toString=function(){return Fe},Sr}}}var Grt={"-":"",_:" ",0:"0"},Ta=/^\s*\d+/,i5t=/^%/,n5t=/[\\^$*+?|[\]().{}]/g;function Nn(e,t,r){var i=e<0?"-":"",s=(i?-e:e)+"",n=s.length;return i+(n<r?new Array(r-n+1).join(t)+s:s)}function s5t(e){return e.replace(n5t,"\\$&")}function jT(e){return new RegExp("^(?:"+e.map(s5t).join("|")+")","i")}function WT(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function o5t(e,t,r){var i=Ta.exec(t.slice(r,r+1));return i?(e.w=+i[0],r+i[0].length):-1}function a5t(e,t,r){var i=Ta.exec(t.slice(r,r+1));return i?(e.u=+i[0],r+i[0].length):-1}function l5t(e,t,r){var i=Ta.exec(t.slice(r,r+2));return i?(e.U=+i[0],r+i[0].length):-1}function c5t(e,t,r){var i=Ta.exec(t.slice(r,r+2));return i?(e.V=+i[0],r+i[0].length):-1}function u5t(e,t,r){var i=Ta.exec(t.slice(r,r+2));return i?(e.W=+i[0],r+i[0].length):-1}function Qrt(e,t,r){var i=Ta.exec(t.slice(r,r+4));return i?(e.y=+i[0],r+i[0].length):-1}function Krt(e,t,r){var i=Ta.exec(t.slice(r,r+2));return i?(e.y=+i[0]+(+i[0]>68?1900:2e3),r+i[0].length):-1}function h5t(e,t,r){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return i?(e.Z=i[1]?0:-(i[2]+(i[3]||"00")),r+i[0].length):-1}function f5t(e,t,r){var i=Ta.exec(t.slice(r,r+1));return i?(e.q=i[0]*3-3,r+i[0].length):-1}function p5t(e,t,r){var i=Ta.exec(t.slice(r,r+2));return i?(e.m=i[0]-1,r+i[0].length):-1}function Jrt(e,t,r){var i=Ta.exec(t.slice(r,r+2));return i?(e.d=+i[0],r+i[0].length):-1}function d5t(e,t,r){var i=Ta.exec(t.slice(r,r+3));return i?(e.m=0,e.d=+i[0],r+i[0].length):-1}function tit(e,t,r){var i=Ta.exec(t.slice(r,r+2));return i?(e.H=+i[0],r+i[0].length):-1}function m5t(e,t,r){var i=Ta.exec(t.slice(r,r+2));return i?(e.M=+i[0],r+i[0].length):-1}function A5t(e,t,r){var i=Ta.exec(t.slice(r,r+2));return i?(e.S=+i[0],r+i[0].length):-1}function g5t(e,t,r){var i=Ta.exec(t.slice(r,r+3));return i?(e.L=+i[0],r+i[0].length):-1}function _5t(e,t,r){var i=Ta.exec(t.slice(r,r+6));return i?(e.L=Math.floor(i[0]/1e3),r+i[0].length):-1}function y5t(e,t,r){var i=i5t.exec(t.slice(r,r+1));return i?r+i[0].length:-1}function x5t(e,t,r){var i=Ta.exec(t.slice(r));return i?(e.Q=+i[0],r+i[0].length):-1}function b5t(e,t,r){var i=Ta.exec(t.slice(r));return i?(e.s=+i[0],r+i[0].length):-1}function eit(e,t){return Nn(e.getDate(),t,2)}function v5t(e,t){return Nn(e.getHours(),t,2)}function w5t(e,t){return Nn(e.getHours()%12||12,t,2)}function T5t(e,t){return Nn(1+Cp.count(Oc(e),e),t,3)}function oit(e,t){return Nn(e.getMilliseconds(),t,3)}function S5t(e,t){return oit(e,t)+"000"}function E5t(e,t){return Nn(e.getMonth()+1,t,2)}function I5t(e,t){return Nn(e.getMinutes(),t,2)}function M5t(e,t){return Nn(e.getSeconds(),t,2)}function C5t(e){var t=e.getDay();return t===0?7:t}function P5t(e,t){return Nn(Pp.count(Oc(e)-1,e),t,2)}function ait(e){var t=e.getDay();return t>=4||t===0?f0(e):f0.ceil(e)}function R5t(e,t){return e=ait(e),Nn(f0.count(Oc(e),e)+(Oc(e).getDay()===4),t,2)}function k5t(e){return e.getDay()}function D5t(e,t){return Nn(l_.count(Oc(e)-1,e),t,2)}function O5t(e,t){return Nn(e.getFullYear()%100,t,2)}function B5t(e,t){return e=ait(e),Nn(e.getFullYear()%100,t,2)}function N5t(e,t){return Nn(e.getFullYear()%1e4,t,4)}function L5t(e,t){var r=e.getDay();return e=r>=4||r===0?f0(e):f0.ceil(e),Nn(e.getFullYear()%1e4,t,4)}function F5t(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Nn(t/60|0,"0",2)+Nn(t%60,"0",2)}function rit(e,t){return Nn(e.getUTCDate(),t,2)}function z5t(e,t){return Nn(e.getUTCHours(),t,2)}function U5t(e,t){return Nn(e.getUTCHours()%12||12,t,2)}function V5t(e,t){return Nn(1+_A.count(Bc(e),e),t,3)}function lit(e,t){return Nn(e.getUTCMilliseconds(),t,3)}function j5t(e,t){return lit(e,t)+"000"}function W5t(e,t){return Nn(e.getUTCMonth()+1,t,2)}function $5t(e,t){return Nn(e.getUTCMinutes(),t,2)}function H5t(e,t){return Nn(e.getUTCSeconds(),t,2)}function q5t(e){var t=e.getUTCDay();return t===0?7:t}function Y5t(e,t){return Nn(Rp.count(Bc(e)-1,e),t,2)}function cit(e){var t=e.getUTCDay();return t>=4||t===0?p0(e):p0.ceil(e)}function X5t(e,t){return e=cit(e),Nn(p0.count(Bc(e),e)+(Bc(e).getUTCDay()===4),t,2)}function Z5t(e){return e.getUTCDay()}function G5t(e,t){return Nn(u_.count(Bc(e)-1,e),t,2)}function Q5t(e,t){return Nn(e.getUTCFullYear()%100,t,2)}function K5t(e,t){return e=cit(e),Nn(e.getUTCFullYear()%100,t,2)}function J5t(e,t){return Nn(e.getUTCFullYear()%1e4,t,4)}function tEt(e,t){var r=e.getUTCDay();return e=r>=4||r===0?p0(e):p0.ceil(e),Nn(e.getUTCFullYear()%1e4,t,4)}function eEt(){return"+0000"}function iit(){return"%"}function nit(e){return+e}function sit(e){return Math.floor(+e/1e3)}var Ax,HT,D9,p_,qT;zM({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function zM(e){return Ax=$T(e),HT=Ax.format,D9=Ax.parse,p_=Ax.utcFormat,qT=Ax.utcParse,Ax}var O9="%Y-%m-%dT%H:%M:%S.%LZ";function rEt(e){return e.toISOString()}var iEt=Date.prototype.toISOString?rEt:p_(O9),uit=iEt;function nEt(e){var t=new Date(e);return isNaN(t)?null:t}var sEt=+new Date("2000-01-01T00:00:00.000Z")?nEt:qT(O9),hit=sEt;function oEt(e){return new Date(e)}function aEt(e){return e instanceof Date?+e:+new Date(+e)}function UM(e,t,r,i,s,n,o,a,h,p){var g=t_(),v=g.invert,T=g.domain,C=p(".%L"),B=p(":%S"),L=p("%I:%M"),z=p("%I %p"),W=p("%a %d"),Z=p("%b %d"),X=p("%B"),q=p("%Y");function it(nt){return(h(nt)<nt?C:a(nt)<nt?B:o(nt)<nt?L:n(nt)<nt?z:i(nt)<nt?s(nt)<nt?W:Z:r(nt)<nt?X:q)(nt)}return g.invert=function(nt){return new Date(v(nt))},g.domain=function(nt){return arguments.length?T(Array.from(nt,aEt)):T().map(oEt)},g.ticks=function(nt){var Mt=T();return e(Mt[0],Mt[Mt.length-1],nt??10)},g.tickFormat=function(nt,Mt){return Mt==null?it:p(Mt)},g.nice=function(nt){var Mt=T();return(!nt||typeof nt.range!="function")&&(nt=t(Mt[0],Mt[Mt.length-1],nt??10)),nt?T(OT(Mt,nt)):g},g.copy=function(){return Ip(g,UM(e,t,r,i,s,n,o,a,h,p))},g}function B9(){return $s.apply(UM(LM,FM,Oc,h_,Pp,Cp,s_,r_,mu,HT).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function N9(){return $s.apply(UM(BM,NM,Bc,f_,Rp,_A,o_,i_,mu,p_).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function VM(){var e=0,t=1,r,i,s,n,o=ra,a=!1,h;function p(v){return v==null||isNaN(v=+v)?h:o(s===0?.5:(v=(n(v)-r)*s,a?Math.max(0,Math.min(1,v)):v))}p.domain=function(v){return arguments.length?([e,t]=v,r=n(e=+e),i=n(t=+t),s=r===i?0:1/(i-r),p):[e,t]},p.clamp=function(v){return arguments.length?(a=!!v,p):a},p.interpolator=function(v){return arguments.length?(o=v,p):o};function g(v){return function(T){var C,B;return arguments.length?([C,B]=T,o=v(C,B),p):[o(0),o(1)]}}return p.range=g(vl),p.rangeRound=g(iA),p.unknown=function(v){return arguments.length?(h=v,p):h},function(v){return n=v,r=v(e),i=v(t),s=r===i?0:1/(i-r),p}}function d0(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function gx(){var e=Kl(VM()(ra));return e.copy=function(){return d0(e,gx())},oh.apply(e,arguments)}function L9(){var e=BT(VM()).domain([1,10]);return e.copy=function(){return d0(e,L9()).base(e.base())},oh.apply(e,arguments)}function F9(){var e=NT(VM());return e.copy=function(){return d0(e,F9()).constant(e.constant())},oh.apply(e,arguments)}function jM(){var e=LT(VM());return e.copy=function(){return d0(e,jM()).exponent(e.exponent())},oh.apply(e,arguments)}function fit(){return jM.apply(null,arguments).exponent(.5)}function WM(){var e=[],t=ra;function r(i){if(i!=null&&!isNaN(i=+i))return t((Mc(e,i,1)-1)/(e.length-1))}return r.domain=function(i){if(!arguments.length)return e.slice();e=[];for(let s of i)s!=null&&!isNaN(s=+s)&&e.push(s);return e.sort(An),r},r.interpolator=function(i){return arguments.length?(t=i,r):t},r.range=function(){return e.map((i,s)=>t(s/(e.length-1)))},r.quantiles=function(i){return Array.from({length:i+1},(s,n)=>pp(e,n/i))},r.copy=function(){return WM(t).domain(e)},oh.apply(r,arguments)}function $M(){var e=0,t=.5,r=1,i=1,s,n,o,a,h,p=ra,g,v=!1,T;function C(L){return isNaN(L=+L)?T:(L=.5+((L=+g(L))-n)*(i*L<i*n?a:h),p(v?Math.max(0,Math.min(1,L)):L))}C.domain=function(L){return arguments.length?([e,t,r]=L,s=g(e=+e),n=g(t=+t),o=g(r=+r),a=s===n?0:.5/(n-s),h=n===o?0:.5/(o-n),i=n<s?-1:1,C):[e,t,r]},C.clamp=function(L){return arguments.length?(v=!!L,C):v},C.interpolator=function(L){return arguments.length?(p=L,C):p};function B(L){return function(z){var W,Z,X;return arguments.length?([W,Z,X]=z,p=W3(L,[W,Z,X]),C):[p(0),p(.5),p(1)]}}return C.range=B(vl),C.rangeRound=B(iA),C.unknown=function(L){return arguments.length?(T=L,C):T},function(L){return g=L,s=L(e),n=L(t),o=L(r),a=s===n?0:.5/(n-s),h=n===o?0:.5/(o-n),i=n<s?-1:1,C}}function HM(){var e=Kl($M()(ra));return e.copy=function(){return d0(e,HM())},oh.apply(e,arguments)}function z9(){var e=BT($M()).domain([.1,1,10]);return e.copy=function(){return d0(e,z9()).base(e.base())},oh.apply(e,arguments)}function U9(){var e=NT($M());return e.copy=function(){return d0(e,U9()).constant(e.constant())},oh.apply(e,arguments)}function qM(){var e=LT($M());return e.copy=function(){return d0(e,qM()).exponent(e.exponent())},oh.apply(e,arguments)}function pit(){return qM.apply(null,arguments).exponent(.5)}function ir(e){for(var t=e.length/6|0,r=new Array(t),i=0;i<t;)r[i]="#"+e.slice(i*6,++i*6);return r}var dit=ir("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf");var mit=ir("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666");var Ait=ir("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666");var git=ir("4269d0efb118ff725c6cc5b03ca951ff8ab7a463f297bbf59c6b4e9498a0");var _it=ir("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928");var yit=ir("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2");var xit=ir("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc");var bit=ir("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999");var vit=ir("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3");var wit=ir("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f");var Tit=ir("4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab");var Hr=e=>$6(e[e.length-1]);var V9=new Array(3).concat("d8b365f5f5f55ab4ac","a6611adfc27d80cdc1018571","a6611adfc27df5f5f580cdc1018571","8c510ad8b365f6e8c3c7eae55ab4ac01665e","8c510ad8b365f6e8c3f5f5f5c7eae55ab4ac01665e","8c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e","8c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e","5430058c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e003c30","5430058c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e003c30").map(ir),Sit=Hr(V9);var j9=new Array(3).concat("af8dc3f7f7f77fbf7b","7b3294c2a5cfa6dba0008837","7b3294c2a5cff7f7f7a6dba0008837","762a83af8dc3e7d4e8d9f0d37fbf7b1b7837","762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837","762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837","762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837","40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b","40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b").map(ir),Eit=Hr(j9);var W9=new Array(3).concat("e9a3c9f7f7f7a1d76a","d01c8bf1b6dab8e1864dac26","d01c8bf1b6daf7f7f7b8e1864dac26","c51b7de9a3c9fde0efe6f5d0a1d76a4d9221","c51b7de9a3c9fde0eff7f7f7e6f5d0a1d76a4d9221","c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221","c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221","8e0152c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221276419","8e0152c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221276419").map(ir),Iit=Hr(W9);var $9=new Array(3).concat("998ec3f7f7f7f1a340","5e3c99b2abd2fdb863e66101","5e3c99b2abd2f7f7f7fdb863e66101","542788998ec3d8daebfee0b6f1a340b35806","542788998ec3d8daebf7f7f7fee0b6f1a340b35806","5427888073acb2abd2d8daebfee0b6fdb863e08214b35806","5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b35806","2d004b5427888073acb2abd2d8daebfee0b6fdb863e08214b358067f3b08","2d004b5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b358067f3b08").map(ir),Mit=Hr($9);var H9=new Array(3).concat("ef8a62f7f7f767a9cf","ca0020f4a58292c5de0571b0","ca0020f4a582f7f7f792c5de0571b0","b2182bef8a62fddbc7d1e5f067a9cf2166ac","b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac","b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac","b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac","67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061","67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061").map(ir),Cit=Hr(H9);var q9=new Array(3).concat("ef8a62ffffff999999","ca0020f4a582bababa404040","ca0020f4a582ffffffbababa404040","b2182bef8a62fddbc7e0e0e09999994d4d4d","b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d","b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d","b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d","67001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a","67001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a").map(ir),Pit=Hr(q9);var Y9=new Array(3).concat("fc8d59ffffbf91bfdb","d7191cfdae61abd9e92c7bb6","d7191cfdae61ffffbfabd9e92c7bb6","d73027fc8d59fee090e0f3f891bfdb4575b4","d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4","d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4","d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4","a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695","a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695").map(ir),Rit=Hr(Y9);var X9=new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(ir),kit=Hr(X9);var Z9=new Array(3).concat("fc8d59ffffbf99d594","d7191cfdae61abdda42b83ba","d7191cfdae61ffffbfabdda42b83ba","d53e4ffc8d59fee08be6f59899d5943288bd","d53e4ffc8d59fee08bffffbfe6f59899d5943288bd","d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd","d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd","9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2","9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2").map(ir),YM=Hr(Z9);var G9=new Array(3).concat("e5f5f999d8c92ca25f","edf8fbb2e2e266c2a4238b45","edf8fbb2e2e266c2a42ca25f006d2c","edf8fbccece699d8c966c2a42ca25f006d2c","edf8fbccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b").map(ir),Dit=Hr(G9);var Q9=new Array(3).concat("e0ecf49ebcda8856a7","edf8fbb3cde38c96c688419d","edf8fbb3cde38c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b").map(ir),Oit=Hr(Q9);var K9=new Array(3).concat("e0f3dba8ddb543a2ca","f0f9e8bae4bc7bccc42b8cbe","f0f9e8bae4bc7bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081").map(ir),Bit=Hr(K9);var J9=new Array(3).concat("fee8c8fdbb84e34a33","fef0d9fdcc8afc8d59d7301f","fef0d9fdcc8afc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000").map(ir),Nit=Hr(J9);var tL=new Array(3).concat("ece2f0a6bddb1c9099","f6eff7bdc9e167a9cf02818a","f6eff7bdc9e167a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636").map(ir),Lit=Hr(tL);var eL=new Array(3).concat("ece7f2a6bddb2b8cbe","f1eef6bdc9e174a9cf0570b0","f1eef6bdc9e174a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858").map(ir),Fit=Hr(eL);var rL=new Array(3).concat("e7e1efc994c7dd1c77","f1eef6d7b5d8df65b0ce1256","f1eef6d7b5d8df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f").map(ir),zit=Hr(rL);var iL=new Array(3).concat("fde0ddfa9fb5c51b8a","feebe2fbb4b9f768a1ae017e","feebe2fbb4b9f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a").map(ir),Uit=Hr(iL);var nL=new Array(3).concat("edf8b17fcdbb2c7fb8","ffffcca1dab441b6c4225ea8","ffffcca1dab441b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58").map(ir),Vit=Hr(nL);var sL=new Array(3).concat("f7fcb9addd8e31a354","ffffccc2e69978c679238443","ffffccc2e69978c67931a354006837","ffffccd9f0a3addd8e78c67931a354006837","ffffccd9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529").map(ir),jit=Hr(sL);var oL=new Array(3).concat("fff7bcfec44fd95f0e","ffffd4fed98efe9929cc4c02","ffffd4fed98efe9929d95f0e993404","ffffd4fee391fec44ffe9929d95f0e993404","ffffd4fee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506").map(ir),Wit=Hr(oL);var aL=new Array(3).concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map(ir),$it=Hr(aL);var lL=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(ir),Hit=Hr(lL);var cL=new Array(3).concat("e5f5e0a1d99b31a354","edf8e9bae4b374c476238b45","edf8e9bae4b374c47631a354006d2c","edf8e9c7e9c0a1d99b74c47631a354006d2c","edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b").map(ir),qit=Hr(cL);var uL=new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(ir),Yit=Hr(uL);var hL=new Array(3).concat("efedf5bcbddc756bb1","f2f0f7cbc9e29e9ac86a51a3","f2f0f7cbc9e29e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d").map(ir),Xit=Hr(hL);var fL=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(ir),Zit=Hr(fL);var pL=new Array(3).concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(ir),Git=Hr(pL);function Qit(e){return e=Math.max(0,Math.min(1,e)),"rgb("+Math.max(0,Math.min(255,Math.round(-4.54-e*(35.34-e*(2381.73-e*(6402.7-e*(7024.72-e*2710.57)))))))+", "+Math.max(0,Math.min(255,Math.round(32.49+e*(170.73+e*(52.82-e*(131.46-e*(176.58-e*67.37)))))))+", "+Math.max(0,Math.min(255,Math.round(81.24+e*(442.36-e*(2482.43-e*(6167.24-e*(6614.94-e*2475.67)))))))+")"}var Kit=M1(bl(300,.5,0),bl(-240,.5,1));var Jit=M1(bl(-100,.75,.35),bl(80,1.5,.8)),tnt=M1(bl(260,.75,.35),bl(80,1.5,.8)),XM=bl();function ent(e){(e<0||e>1)&&(e-=Math.floor(e));var t=Math.abs(e-.5);return XM.h=360*e-100,XM.s=1.5-1.5*t,XM.l=.8-.9*t,XM+""}var ZM=e0(),lEt=Math.PI/3,cEt=Math.PI*2/3;function rnt(e){var t;return e=(.5-e)*Math.PI,ZM.r=255*(t=Math.sin(e))*t,ZM.g=255*(t=Math.sin(e+lEt))*t,ZM.b=255*(t=Math.sin(e+cEt))*t,ZM+""}function int(e){return e=Math.max(0,Math.min(1,e)),"rgb("+Math.max(0,Math.min(255,Math.round(34.61+e*(1172.33-e*(10793.56-e*(33300.12-e*(38394.49-e*14825.05)))))))+", "+Math.max(0,Math.min(255,Math.round(23.31+e*(557.33+e*(1225.33-e*(3574.96-e*(1073.77+e*707.56)))))))+", "+Math.max(0,Math.min(255,Math.round(27.2+e*(3211.1-e*(15327.97-e*(27814-e*(22569.18-e*6838.66)))))))+")"}function GM(e){var t=e.length;return function(r){return e[Math.max(0,Math.min(t-1,Math.floor(r*t)))]}}var nnt=GM(ir("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725")),snt=GM(ir("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),ont=GM(ir("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),ant=GM(ir("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));function ai(e){return function(){return e}}var dL=Math.abs,qa=Math.atan2,mf=Math.cos,lnt=Math.max,kp=Math.min,El=Math.sin,nn=Math.sqrt,Sa=1e-12,Af=Math.PI,YT=Af/2,ah=2*Af;function cnt(e){return e>1?0:e<-1?Af:Math.acos(e)}function mL(e){return e>=1?YT:e<=-1?-YT:Math.asin(e)}function Dp(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{let i=Math.floor(r);if(!(i>=0))throw new RangeError(`invalid digits: ${r}`);t=i}return e},()=>new n0(t)}function uEt(e){return e.innerRadius}function hEt(e){return e.outerRadius}function fEt(e){return e.startAngle}function pEt(e){return e.endAngle}function dEt(e){return e&&e.padAngle}function mEt(e,t,r,i,s,n,o,a){var h=r-e,p=i-t,g=o-s,v=a-n,T=v*h-g*p;if(!(T*T<Sa))return T=(g*(t-n)-v*(e-s))/T,[e+T*h,t+T*p]}function QM(e,t,r,i,s,n,o){var a=e-r,h=t-i,p=(o?n:-n)/nn(a*a+h*h),g=p*h,v=-p*a,T=e+g,C=t+v,B=r+g,L=i+v,z=(T+B)/2,W=(C+L)/2,Z=B-T,X=L-C,q=Z*Z+X*X,it=s-n,nt=T*L-B*C,Mt=(X<0?-1:1)*nn(lnt(0,it*it*q-nt*nt)),_t=(nt*X-Z*Mt)/q,Et=(-nt*Z-X*Mt)/q,vt=(nt*X+Z*Mt)/q,Pt=(-nt*Z+X*Mt)/q,re=_t-z,$t=Et-W,xt=vt-z,Vt=Pt-W;return re*re+$t*$t>xt*xt+Vt*Vt&&(_t=vt,Et=Pt),{cx:_t,cy:Et,x01:-g,y01:-v,x11:_t*(s/it-1),y11:Et*(s/it-1)}}function unt(){var e=uEt,t=hEt,r=ai(0),i=null,s=fEt,n=pEt,o=dEt,a=null,h=Dp(p);function p(){var g,v,T=+e.apply(this,arguments),C=+t.apply(this,arguments),B=s.apply(this,arguments)-YT,L=n.apply(this,arguments)-YT,z=dL(L-B),W=L>B;if(a||(a=g=h()),C<T&&(v=C,C=T,T=v),!(C>Sa))a.moveTo(0,0);else if(z>ah-Sa)a.moveTo(C*mf(B),C*El(B)),a.arc(0,0,C,B,L,!W),T>Sa&&(a.moveTo(T*mf(L),T*El(L)),a.arc(0,0,T,L,B,W));else{var Z=B,X=L,q=B,it=L,nt=z,Mt=z,_t=o.apply(this,arguments)/2,Et=_t>Sa&&(i?+i.apply(this,arguments):nn(T*T+C*C)),vt=kp(dL(C-T)/2,+r.apply(this,arguments)),Pt=vt,re=vt,$t,xt;if(Et>Sa){var Vt=mL(Et/T*El(_t)),qt=mL(Et/C*El(_t));(nt-=Vt*2)>Sa?(Vt*=W?1:-1,q+=Vt,it-=Vt):(nt=0,q=it=(B+L)/2),(Mt-=qt*2)>Sa?(qt*=W?1:-1,Z+=qt,X-=qt):(Mt=0,Z=X=(B+L)/2)}var de=C*mf(Z),Ee=C*El(Z),Se=T*mf(it),ze=T*El(it);if(vt>Sa){var ke=C*mf(X),nr=C*El(X),Si=T*mf(q),yi=T*El(q),hi;if(z<Af)if(hi=mEt(de,Ee,Si,yi,ke,nr,Se,ze)){var Kr=de-hi[0],zr=Ee-hi[1],Br=ke-hi[0],Fe=nr-hi[1],Sr=1/El(cnt((Kr*Br+zr*Fe)/(nn(Kr*Kr+zr*zr)*nn(Br*Br+Fe*Fe)))/2),$r=nn(hi[0]*hi[0]+hi[1]*hi[1]);Pt=kp(vt,(T-$r)/(Sr-1)),re=kp(vt,(C-$r)/(Sr+1))}else Pt=re=0}Mt>Sa?re>Sa?($t=QM(Si,yi,de,Ee,C,re,W),xt=QM(ke,nr,Se,ze,C,re,W),a.moveTo($t.cx+$t.x01,$t.cy+$t.y01),re<vt?a.arc($t.cx,$t.cy,re,qa($t.y01,$t.x01),qa(xt.y01,xt.x01),!W):(a.arc($t.cx,$t.cy,re,qa($t.y01,$t.x01),qa($t.y11,$t.x11),!W),a.arc(0,0,C,qa($t.cy+$t.y11,$t.cx+$t.x11),qa(xt.cy+xt.y11,xt.cx+xt.x11),!W),a.arc(xt.cx,xt.cy,re,qa(xt.y11,xt.x11),qa(xt.y01,xt.x01),!W))):(a.moveTo(de,Ee),a.arc(0,0,C,Z,X,!W)):a.moveTo(de,Ee),!(T>Sa)||!(nt>Sa)?a.lineTo(Se,ze):Pt>Sa?($t=QM(Se,ze,ke,nr,T,-Pt,W),xt=QM(de,Ee,Si,yi,T,-Pt,W),a.lineTo($t.cx+$t.x01,$t.cy+$t.y01),Pt<vt?a.arc($t.cx,$t.cy,Pt,qa($t.y01,$t.x01),qa(xt.y01,xt.x01),!W):(a.arc($t.cx,$t.cy,Pt,qa($t.y01,$t.x01),qa($t.y11,$t.x11),!W),a.arc(0,0,T,qa($t.cy+$t.y11,$t.cx+$t.x11),qa(xt.cy+xt.y11,xt.cx+xt.x11),W),a.arc(xt.cx,xt.cy,Pt,qa(xt.y11,xt.x11),qa(xt.y01,xt.x01),!W))):a.arc(0,0,T,it,q,W)}if(a.closePath(),g)return a=null,g+""||null}return p.centroid=function(){var g=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,v=(+s.apply(this,arguments)+ +n.apply(this,arguments))/2-Af/2;return[mf(v)*g,El(v)*g]},p.innerRadius=function(g){return arguments.length?(e=typeof g=="function"?g:ai(+g),p):e},p.outerRadius=function(g){return arguments.length?(t=typeof g=="function"?g:ai(+g),p):t},p.cornerRadius=function(g){return arguments.length?(r=typeof g=="function"?g:ai(+g),p):r},p.padRadius=function(g){return arguments.length?(i=g==null?null:typeof g=="function"?g:ai(+g),p):i},p.startAngle=function(g){return arguments.length?(s=typeof g=="function"?g:ai(+g),p):s},p.endAngle=function(g){return arguments.length?(n=typeof g=="function"?g:ai(+g),p):n},p.padAngle=function(g){return arguments.length?(o=typeof g=="function"?g:ai(+g),p):o},p.context=function(g){return arguments.length?(a=g??null,p):a},p}var hnt=Array.prototype.slice;function yA(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function fnt(e){this._context=e}fnt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function xA(e){return new fnt(e)}function _x(e){return e[0]}function yx(e){return e[1]}function xx(e,t){var r=ai(!0),i=null,s=xA,n=null,o=Dp(a);e=typeof e=="function"?e:e===void 0?_x:ai(e),t=typeof t=="function"?t:t===void 0?yx:ai(t);function a(h){var p,g=(h=yA(h)).length,v,T=!1,C;for(i==null&&(n=s(C=o())),p=0;p<=g;++p)!(p<g&&r(v=h[p],p,h))===T&&((T=!T)?n.lineStart():n.lineEnd()),T&&n.point(+e(v,p,h),+t(v,p,h));if(C)return n=null,C+""||null}return a.x=function(h){return arguments.length?(e=typeof h=="function"?h:ai(+h),a):e},a.y=function(h){return arguments.length?(t=typeof h=="function"?h:ai(+h),a):t},a.defined=function(h){return arguments.length?(r=typeof h=="function"?h:ai(!!h),a):r},a.curve=function(h){return arguments.length?(s=h,i!=null&&(n=s(i)),a):s},a.context=function(h){return arguments.length?(h==null?i=n=null:n=s(i=h),a):i},a}function KM(e,t,r){var i=null,s=ai(!0),n=null,o=xA,a=null,h=Dp(p);e=typeof e=="function"?e:e===void 0?_x:ai(+e),t=typeof t=="function"?t:t===void 0?ai(0):ai(+t),r=typeof r=="function"?r:r===void 0?yx:ai(+r);function p(v){var T,C,B,L=(v=yA(v)).length,z,W=!1,Z,X=new Array(L),q=new Array(L);for(n==null&&(a=o(Z=h())),T=0;T<=L;++T){if(!(T<L&&s(z=v[T],T,v))===W)if(W=!W)C=T,a.areaStart(),a.lineStart();else{for(a.lineEnd(),a.lineStart(),B=T-1;B>=C;--B)a.point(X[B],q[B]);a.lineEnd(),a.areaEnd()}W&&(X[T]=+e(z,T,v),q[T]=+t(z,T,v),a.point(i?+i(z,T,v):X[T],r?+r(z,T,v):q[T]))}if(Z)return a=null,Z+""||null}function g(){return xx().defined(s).curve(o).context(n)}return p.x=function(v){return arguments.length?(e=typeof v=="function"?v:ai(+v),i=null,p):e},p.x0=function(v){return arguments.length?(e=typeof v=="function"?v:ai(+v),p):e},p.x1=function(v){return arguments.length?(i=v==null?null:typeof v=="function"?v:ai(+v),p):i},p.y=function(v){return arguments.length?(t=typeof v=="function"?v:ai(+v),r=null,p):t},p.y0=function(v){return arguments.length?(t=typeof v=="function"?v:ai(+v),p):t},p.y1=function(v){return arguments.length?(r=v==null?null:typeof v=="function"?v:ai(+v),p):r},p.lineX0=p.lineY0=function(){return g().x(e).y(t)},p.lineY1=function(){return g().x(e).y(r)},p.lineX1=function(){return g().x(i).y(t)},p.defined=function(v){return arguments.length?(s=typeof v=="function"?v:ai(!!v),p):s},p.curve=function(v){return arguments.length?(o=v,n!=null&&(a=o(n)),p):o},p.context=function(v){return arguments.length?(v==null?n=a=null:a=o(n=v),p):n},p}function pnt(e,t){return t<e?-1:t>e?1:t>=e?0:NaN}function dnt(e){return e}function mnt(){var e=dnt,t=pnt,r=null,i=ai(0),s=ai(ah),n=ai(0);function o(a){var h,p=(a=yA(a)).length,g,v,T=0,C=new Array(p),B=new Array(p),L=+i.apply(this,arguments),z=Math.min(ah,Math.max(-ah,s.apply(this,arguments)-L)),W,Z=Math.min(Math.abs(z)/p,n.apply(this,arguments)),X=Z*(z<0?-1:1),q;for(h=0;h<p;++h)(q=B[C[h]=h]=+e(a[h],h,a))>0&&(T+=q);for(t!=null?C.sort(function(it,nt){return t(B[it],B[nt])}):r!=null&&C.sort(function(it,nt){return r(a[it],a[nt])}),h=0,v=T?(z-p*X)/T:0;h<p;++h,L=W)g=C[h],q=B[g],W=L+(q>0?q*v:0)+X,B[g]={data:a[g],index:h,value:q,startAngle:L,endAngle:W,padAngle:Z};return B}return o.value=function(a){return arguments.length?(e=typeof a=="function"?a:ai(+a),o):e},o.sortValues=function(a){return arguments.length?(t=a,r=null,o):t},o.sort=function(a){return arguments.length?(r=a,t=null,o):r},o.startAngle=function(a){return arguments.length?(i=typeof a=="function"?a:ai(+a),o):i},o.endAngle=function(a){return arguments.length?(s=typeof a=="function"?a:ai(+a),o):s},o.padAngle=function(a){return arguments.length?(n=typeof a=="function"?a:ai(+a),o):n},o}var JM=bx(xA);function Ant(e){this._curve=e}Ant.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(e,t){this._curve.point(t*Math.sin(e),t*-Math.cos(e))}};function bx(e){function t(r){return new Ant(e(r))}return t._curve=e,t}function vx(e){var t=e.curve;return e.angle=e.x,delete e.x,e.radius=e.y,delete e.y,e.curve=function(r){return arguments.length?t(bx(r)):t()._curve},e}function AL(){return vx(xx().curve(JM))}function gL(){var e=KM().curve(JM),t=e.curve,r=e.lineX0,i=e.lineX1,s=e.lineY0,n=e.lineY1;return e.angle=e.x,delete e.x,e.startAngle=e.x0,delete e.x0,e.endAngle=e.x1,delete e.x1,e.radius=e.y,delete e.y,e.innerRadius=e.y0,delete e.y0,e.outerRadius=e.y1,delete e.y1,e.lineStartAngle=function(){return vx(r())},delete e.lineX0,e.lineEndAngle=function(){return vx(i())},delete e.lineX1,e.lineInnerRadius=function(){return vx(s())},delete e.lineY0,e.lineOuterRadius=function(){return vx(n())},delete e.lineY1,e.curve=function(o){return arguments.length?t(bx(o)):t()._curve},e}function d_(e,t){return[(t=+t)*Math.cos(e-=Math.PI/2),t*Math.sin(e)]}var tC=class{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}},_L=class{constructor(t){this._context=t}lineStart(){this._point=0}lineEnd(){}point(t,r){if(t=+t,r=+r,this._point===0)this._point=1;else{let i=d_(this._x0,this._y0),s=d_(this._x0,this._y0=(this._y0+r)/2),n=d_(t,this._y0),o=d_(t,r);this._context.moveTo(...i),this._context.bezierCurveTo(...s,...n,...o)}this._x0=t,this._y0=r}};function eC(e){return new tC(e,!0)}function rC(e){return new tC(e,!1)}function gnt(e){return new _L(e)}function AEt(e){return e.source}function gEt(e){return e.target}function XT(e){let t=AEt,r=gEt,i=_x,s=yx,n=null,o=null,a=Dp(h);function h(){let p,g=hnt.call(arguments),v=t.apply(this,g),T=r.apply(this,g);if(n==null&&(o=e(p=a())),o.lineStart(),g[0]=v,o.point(+i.apply(this,g),+s.apply(this,g)),g[0]=T,o.point(+i.apply(this,g),+s.apply(this,g)),o.lineEnd(),p)return o=null,p+""||null}return h.source=function(p){return arguments.length?(t=p,h):t},h.target=function(p){return arguments.length?(r=p,h):r},h.x=function(p){return arguments.length?(i=typeof p=="function"?p:ai(+p),h):i},h.y=function(p){return arguments.length?(s=typeof p=="function"?p:ai(+p),h):s},h.context=function(p){return arguments.length?(p==null?n=o=null:o=e(n=p),h):n},h}function _nt(){return XT(eC)}function ynt(){return XT(rC)}function xnt(){let e=XT(gnt);return e.angle=e.x,delete e.x,e.radius=e.y,delete e.y,e}var _Et=nn(3),iC={draw(e,t){let r=nn(t+kp(t/28,.75))*.59436,i=r/2,s=i*_Et;e.moveTo(0,r),e.lineTo(0,-r),e.moveTo(-s,-i),e.lineTo(s,i),e.moveTo(-s,i),e.lineTo(s,-i)}};var wx={draw(e,t){let r=nn(t/Af);e.moveTo(r,0),e.arc(0,0,r,0,ah)}};var nC={draw(e,t){let r=nn(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}};var bnt=nn(1/3),yEt=bnt*2,sC={draw(e,t){let r=nn(t/yEt),i=r*bnt;e.moveTo(0,-r),e.lineTo(i,0),e.lineTo(0,r),e.lineTo(-i,0),e.closePath()}};var oC={draw(e,t){let r=nn(t)*.62625;e.moveTo(0,-r),e.lineTo(r,0),e.lineTo(0,r),e.lineTo(-r,0),e.closePath()}};var aC={draw(e,t){let r=nn(t-kp(t/7,2))*.87559;e.moveTo(-r,0),e.lineTo(r,0),e.moveTo(0,r),e.lineTo(0,-r)}};var lC={draw(e,t){let r=nn(t),i=-r/2;e.rect(i,i,r,r)}};var cC={draw(e,t){let r=nn(t)*.4431;e.moveTo(r,r),e.lineTo(r,-r),e.lineTo(-r,-r),e.lineTo(-r,r),e.closePath()}};var xEt=.8908130915292852,vnt=El(Af/10)/El(7*Af/10),bEt=El(ah/10)*vnt,vEt=-mf(ah/10)*vnt,uC={draw(e,t){let r=nn(t*xEt),i=bEt*r,s=vEt*r;e.moveTo(0,-r),e.lineTo(i,s);for(let n=1;n<5;++n){let o=ah*n/5,a=mf(o),h=El(o);e.lineTo(h*r,-a*r),e.lineTo(a*i-h*s,h*i+a*s)}e.closePath()}};var yL=nn(3),hC={draw(e,t){let r=-nn(t/(yL*3));e.moveTo(0,r*2),e.lineTo(-yL*r,-r),e.lineTo(yL*r,-r),e.closePath()}};var wEt=nn(3),fC={draw(e,t){let r=nn(t)*.6824,i=r/2,s=r*wEt/2;e.moveTo(0,-r),e.lineTo(s,i),e.lineTo(-s,i),e.closePath()}};var lh=-.5,ch=nn(3)/2,xL=1/nn(12),TEt=(xL/2+1)*3,pC={draw(e,t){let r=nn(t/TEt),i=r/2,s=r*xL,n=i,o=r*xL+r,a=-n,h=o;e.moveTo(i,s),e.lineTo(n,o),e.lineTo(a,h),e.lineTo(lh*i-ch*s,ch*i+lh*s),e.lineTo(lh*n-ch*o,ch*n+lh*o),e.lineTo(lh*a-ch*h,ch*a+lh*h),e.lineTo(lh*i+ch*s,lh*s-ch*i),e.lineTo(lh*n+ch*o,lh*o-ch*n),e.lineTo(lh*a+ch*h,lh*h-ch*a),e.closePath()}};var ZT={draw(e,t){let r=nn(t-kp(t/6,1.7))*.6189;e.moveTo(-r,-r),e.lineTo(r,r),e.moveTo(-r,r),e.lineTo(r,-r)}};var bL=[wx,nC,sC,lC,uC,hC,pC],wnt=[wx,aC,ZT,fC,iC,cC,oC];function vL(e,t){let r=null,i=Dp(s);e=typeof e=="function"?e:ai(e||wx),t=typeof t=="function"?t:ai(t===void 0?64:+t);function s(){let n;if(r||(r=n=i()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),n)return r=null,n+""||null}return s.type=function(n){return arguments.length?(e=typeof n=="function"?n:ai(n),s):e},s.size=function(n){return arguments.length?(t=typeof n=="function"?n:ai(+n),s):t},s.context=function(n){return arguments.length?(r=n??null,s):r},s}function uh(){}function Tx(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function GT(e){this._context=e}GT.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Tx(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Tx(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Tnt(e){return new GT(e)}function Snt(e){this._context=e}Snt.prototype={areaStart:uh,areaEnd:uh,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:Tx(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Ent(e){return new Snt(e)}function Int(e){this._context=e}Int.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,i=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,i):this._context.moveTo(r,i);break;case 3:this._point=4;default:Tx(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Mnt(e){return new Int(e)}function Cnt(e,t){this._basis=new GT(e),this._beta=t}Cnt.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,r=e.length-1;if(r>0)for(var i=e[0],s=t[0],n=e[r]-i,o=t[r]-s,a=-1,h;++a<=r;)h=a/r,this._basis.point(this._beta*e[a]+(1-this._beta)*(i+h*n),this._beta*t[a]+(1-this._beta)*(s+h*o));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};var Pnt=function e(t){function r(i){return t===1?new GT(i):new Cnt(i,t)}return r.beta=function(i){return e(+i)},r}(.85);function Sx(e,t,r){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-r),e._x2,e._y2)}function dC(e,t){this._context=e,this._k=(1-t)/6}dC.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Sx(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:Sx(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Rnt=function e(t){function r(i){return new dC(i,t)}return r.tension=function(i){return e(+i)},r}(0);function mC(e,t){this._context=e,this._k=(1-t)/6}mC.prototype={areaStart:uh,areaEnd:uh,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:Sx(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var knt=function e(t){function r(i){return new mC(i,t)}return r.tension=function(i){return e(+i)},r}(0);function AC(e,t){this._context=e,this._k=(1-t)/6}AC.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Sx(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Dnt=function e(t){function r(i){return new AC(i,t)}return r.tension=function(i){return e(+i)},r}(0);function QT(e,t,r){var i=e._x1,s=e._y1,n=e._x2,o=e._y2;if(e._l01_a>Sa){var a=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,h=3*e._l01_a*(e._l01_a+e._l12_a);i=(i*a-e._x0*e._l12_2a+e._x2*e._l01_2a)/h,s=(s*a-e._y0*e._l12_2a+e._y2*e._l01_2a)/h}if(e._l23_a>Sa){var p=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,g=3*e._l23_a*(e._l23_a+e._l12_a);n=(n*p+e._x1*e._l23_2a-t*e._l12_2a)/g,o=(o*p+e._y1*e._l23_2a-r*e._l12_2a)/g}e._context.bezierCurveTo(i,s,n,o,e._x2,e._y2)}function Ont(e,t){this._context=e,this._alpha=t}Ont.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var r=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(r*r+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:QT(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Bnt=function e(t){function r(i){return t?new Ont(i,t):new dC(i,0)}return r.alpha=function(i){return e(+i)},r}(.5);function Nnt(e,t){this._context=e,this._alpha=t}Nnt.prototype={areaStart:uh,areaEnd:uh,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){if(e=+e,t=+t,this._point){var r=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(r*r+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:QT(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Lnt=function e(t){function r(i){return t?new Nnt(i,t):new mC(i,0)}return r.alpha=function(i){return e(+i)},r}(.5);function Fnt(e,t){this._context=e,this._alpha=t}Fnt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var r=this._x2-e,i=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(r*r+i*i,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:QT(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var znt=function e(t){function r(i){return t?new Fnt(i,t):new AC(i,0)}return r.alpha=function(i){return e(+i)},r}(.5);function Unt(e){this._context=e}Unt.prototype={areaStart:uh,areaEnd:uh,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function Vnt(e){return new Unt(e)}function jnt(e){return e<0?-1:1}function Wnt(e,t,r){var i=e._x1-e._x0,s=t-e._x1,n=(e._y1-e._y0)/(i||s<0&&-0),o=(r-e._y1)/(s||i<0&&-0),a=(n*s+o*i)/(i+s);return(jnt(n)+jnt(o))*Math.min(Math.abs(n),Math.abs(o),.5*Math.abs(a))||0}function $nt(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function wL(e,t,r){var i=e._x0,s=e._y0,n=e._x1,o=e._y1,a=(n-i)/3;e._context.bezierCurveTo(i+a,s+a*t,n-a,o-a*r,n,o)}function gC(e){this._context=e}gC.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:wL(this,this._t0,$nt(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,wL(this,$nt(this,r=Wnt(this,e,t)),r);break;default:wL(this,this._t0,r=Wnt(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function Hnt(e){this._context=new qnt(e)}(Hnt.prototype=Object.create(gC.prototype)).point=function(e,t){gC.prototype.point.call(this,t,e)};function qnt(e){this._context=e}qnt.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,i,s,n){this._context.bezierCurveTo(t,e,i,r,n,s)}};function Ynt(e){return new gC(e)}function Xnt(e){return new Hnt(e)}function Gnt(e){this._context=e}Gnt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var i=Znt(e),s=Znt(t),n=0,o=1;o<r;++n,++o)this._context.bezierCurveTo(i[0][n],s[0][n],i[1][n],s[1][n],e[o],t[o]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function Znt(e){var t,r=e.length-1,i,s=new Array(r),n=new Array(r),o=new Array(r);for(s[0]=0,n[0]=2,o[0]=e[0]+2*e[1],t=1;t<r-1;++t)s[t]=1,n[t]=4,o[t]=4*e[t]+2*e[t+1];for(s[r-1]=2,n[r-1]=7,o[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)i=s[t]/n[t-1],n[t]-=i,o[t]-=i*o[t-1];for(s[r-1]=o[r-1]/n[r-1],t=r-2;t>=0;--t)s[t]=(o[t]-s[t+1])/n[t];for(n[r-1]=(e[r]+s[r-1])/2,t=0;t<r-1;++t)n[t]=2*e[t+1]-s[t+1];return[s,n]}function Qnt(e){return new Gnt(e)}function _C(e,t){this._context=e,this._t=t}_C.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function Knt(e){return new _C(e,.5)}function Jnt(e){return new _C(e,0)}function tst(e){return new _C(e,1)}function gf(e,t){if((o=e.length)>1)for(var r=1,i,s,n=e[t[0]],o,a=n.length;r<o;++r)for(s=n,n=e[t[r]],i=0;i<a;++i)n[i][1]+=n[i][0]=isNaN(s[i][1])?s[i][0]:s[i][1]}function _f(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function SEt(e,t){return e[t]}function EEt(e){let t=[];return t.key=e,t}function est(){var e=ai([]),t=_f,r=gf,i=SEt;function s(n){var o=Array.from(e.apply(this,arguments),EEt),a,h=o.length,p=-1,g;for(let v of n)for(a=0,++p;a<h;++a)(o[a][p]=[0,+i(v,o[a].key,p,n)]).data=v;for(a=0,g=yA(t(o));a<h;++a)o[g[a]].index=a;return r(o,g),o}return s.keys=function(n){return arguments.length?(e=typeof n=="function"?n:ai(Array.from(n)),s):e},s.value=function(n){return arguments.length?(i=typeof n=="function"?n:ai(+n),s):i},s.order=function(n){return arguments.length?(t=n==null?_f:typeof n=="function"?n:ai(Array.from(n)),s):t},s.offset=function(n){return arguments.length?(r=n??gf,s):r},s}function rst(e,t){if((i=e.length)>0){for(var r,i,s=0,n=e[0].length,o;s<n;++s){for(o=r=0;r<i;++r)o+=e[r][s][1]||0;if(o)for(r=0;r<i;++r)e[r][s][1]/=o}gf(e,t)}}function ist(e,t){if((h=e.length)>0)for(var r,i=0,s,n,o,a,h,p=e[t[0]].length;i<p;++i)for(o=a=0,r=0;r<h;++r)(n=(s=e[t[r]][i])[1]-s[0])>0?(s[0]=o,s[1]=o+=n):n<0?(s[1]=a,s[0]=a+=n):(s[0]=0,s[1]=n)}function nst(e,t){if((s=e.length)>0){for(var r=0,i=e[t[0]],s,n=i.length;r<n;++r){for(var o=0,a=0;o<s;++o)a+=e[o][r][1]||0;i[r][1]+=i[r][0]=-a/2}gf(e,t)}}function sst(e,t){if(!(!((o=e.length)>0)||!((n=(s=e[t[0]]).length)>0))){for(var r=0,i=1,s,n,o;i<n;++i){for(var a=0,h=0,p=0;a<o;++a){for(var g=e[t[a]],v=g[i][1]||0,T=g[i-1][1]||0,C=(v-T)/2,B=0;B<a;++B){var L=e[t[B]],z=L[i][1]||0,W=L[i-1][1]||0;C+=z-W}h+=v,p+=C*v}s[i-1][1]+=s[i-1][0]=r,h&&(r-=p/h)}s[i-1][1]+=s[i-1][0]=r,gf(e,t)}}function yC(e){var t=e.map(IEt);return _f(e).sort(function(r,i){return t[r]-t[i]})}function IEt(e){for(var t=-1,r=0,i=e.length,s,n=-1/0;++t<i;)(s=+e[t][1])>n&&(n=s,r=t);return r}function xC(e){var t=e.map(TL);return _f(e).sort(function(r,i){return t[r]-t[i]})}function TL(e){for(var t=0,r=-1,i=e.length,s;++r<i;)(s=+e[r][1])&&(t+=s);return t}function ost(e){return xC(e).reverse()}function ast(e){var t=e.length,r,i,s=e.map(TL),n=yC(e),o=0,a=0,h=[],p=[];for(r=0;r<t;++r)i=n[r],o<a?(o+=s[i],h.push(i)):(a+=s[i],p.push(i));return p.reverse().concat(h)}function lst(e){return _f(e).reverse()}var KT=e=>()=>e;function SL(e,{sourceEvent:t,target:r,transform:i,dispatch:s}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},transform:{value:i,enumerable:!0,configurable:!0},_:{value:s}})}function hh(e,t,r){this.k=e,this.x=t,this.y=r}hh.prototype={constructor:hh,scale:function(e){return e===1?this:new hh(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new hh(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Ex=new hh(1,0,0);bC.prototype=hh.prototype;function bC(e){for(;!e.__zoom;)if(!(e=e.parentNode))return Ex;return e.__zoom}function vC(e){e.stopImmediatePropagation()}function Ix(e){e.preventDefault(),e.stopImmediatePropagation()}function MEt(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function CEt(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function cst(){return this.__zoom||Ex}function PEt(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function REt(){return navigator.maxTouchPoints||"ontouchstart"in this}function kEt(e,t,r){var i=e.invertX(t[0][0])-r[0][0],s=e.invertX(t[1][0])-r[1][0],n=e.invertY(t[0][1])-r[0][1],o=e.invertY(t[1][1])-r[1][1];return e.translate(s>i?(i+s)/2:Math.min(0,i)||Math.max(0,s),o>n?(n+o)/2:Math.min(0,n)||Math.max(0,o))}function ust(){var e=MEt,t=CEt,r=kEt,i=PEt,s=REt,n=[0,1/0],o=[[-1/0,-1/0],[1/0,1/0]],a=250,h=K6,p=rh("start","zoom","end"),g,v,T,C=500,B=150,L=0,z=10;function W(xt){xt.property("__zoom",cst).on("wheel.zoom",_t,{passive:!1}).on("mousedown.zoom",Et).on("dblclick.zoom",vt).filter(s).on("touchstart.zoom",Pt).on("touchmove.zoom",re).on("touchend.zoom touchcancel.zoom",$t).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}W.transform=function(xt,Vt,qt,de){var Ee=xt.selection?xt.selection():xt;Ee.property("__zoom",cst),xt!==Ee?it(xt,Vt,qt,de):Ee.interrupt().each(function(){nt(this,arguments).event(de).start().zoom(null,typeof Vt=="function"?Vt.apply(this,arguments):Vt).end()})},W.scaleBy=function(xt,Vt,qt,de){W.scaleTo(xt,function(){var Ee=this.__zoom.k,Se=typeof Vt=="function"?Vt.apply(this,arguments):Vt;return Ee*Se},qt,de)},W.scaleTo=function(xt,Vt,qt,de){W.transform(xt,function(){var Ee=t.apply(this,arguments),Se=this.__zoom,ze=qt==null?q(Ee):typeof qt=="function"?qt.apply(this,arguments):qt,ke=Se.invert(ze),nr=typeof Vt=="function"?Vt.apply(this,arguments):Vt;return r(X(Z(Se,nr),ze,ke),Ee,o)},qt,de)},W.translateBy=function(xt,Vt,qt,de){W.transform(xt,function(){return r(this.__zoom.translate(typeof Vt=="function"?Vt.apply(this,arguments):Vt,typeof qt=="function"?qt.apply(this,arguments):qt),t.apply(this,arguments),o)},null,de)},W.translateTo=function(xt,Vt,qt,de,Ee){W.transform(xt,function(){var Se=t.apply(this,arguments),ze=this.__zoom,ke=de==null?q(Se):typeof de=="function"?de.apply(this,arguments):de;return r(Ex.translate(ke[0],ke[1]).scale(ze.k).translate(typeof Vt=="function"?-Vt.apply(this,arguments):-Vt,typeof qt=="function"?-qt.apply(this,arguments):-qt),Se,o)},de,Ee)};function Z(xt,Vt){return Vt=Math.max(n[0],Math.min(n[1],Vt)),Vt===xt.k?xt:new hh(Vt,xt.x,xt.y)}function X(xt,Vt,qt){var de=Vt[0]-qt[0]*xt.k,Ee=Vt[1]-qt[1]*xt.k;return de===xt.x&&Ee===xt.y?xt:new hh(xt.k,de,Ee)}function q(xt){return[(+xt[0][0]+ +xt[1][0])/2,(+xt[0][1]+ +xt[1][1])/2]}function it(xt,Vt,qt,de){xt.on("start.zoom",function(){nt(this,arguments).event(de).start()}).on("interrupt.zoom end.zoom",function(){nt(this,arguments).event(de).end()}).tween("zoom",function(){var Ee=this,Se=arguments,ze=nt(Ee,Se).event(de),ke=t.apply(Ee,Se),nr=qt==null?q(ke):typeof qt=="function"?qt.apply(Ee,Se):qt,Si=Math.max(ke[1][0]-ke[0][0],ke[1][1]-ke[0][1]),yi=Ee.__zoom,hi=typeof Vt=="function"?Vt.apply(Ee,Se):Vt,Kr=h(yi.invert(nr).concat(Si/yi.k),hi.invert(nr).concat(Si/hi.k));return function(zr){if(zr===1)zr=hi;else{var Br=Kr(zr),Fe=Si/Br[2];zr=new hh(Fe,nr[0]-Br[0]*Fe,nr[1]-Br[1]*Fe)}ze.zoom(null,zr)}})}function nt(xt,Vt,qt){return!qt&&xt.__zooming||new Mt(xt,Vt)}function Mt(xt,Vt){this.that=xt,this.args=Vt,this.active=0,this.sourceEvent=null,this.extent=t.apply(xt,Vt),this.taps=0}Mt.prototype={event:function(xt){return xt&&(this.sourceEvent=xt),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(xt,Vt){return this.mouse&&xt!=="mouse"&&(this.mouse[1]=Vt.invert(this.mouse[0])),this.touch0&&xt!=="touch"&&(this.touch0[1]=Vt.invert(this.touch0[0])),this.touch1&&xt!=="touch"&&(this.touch1[1]=Vt.invert(this.touch1[0])),this.that.__zoom=Vt,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(xt){var Vt=po(this.that).datum();p.call(xt,this.that,new SL(xt,{sourceEvent:this.sourceEvent,target:W,type:xt,transform:this.that.__zoom,dispatch:p}),Vt)}};function _t(xt,...Vt){if(!e.apply(this,arguments))return;var qt=nt(this,Vt).event(xt),de=this.__zoom,Ee=Math.max(n[0],Math.min(n[1],de.k*Math.pow(2,i.apply(this,arguments)))),Se=xa(xt);if(qt.wheel)(qt.mouse[0][0]!==Se[0]||qt.mouse[0][1]!==Se[1])&&(qt.mouse[1]=de.invert(qt.mouse[0]=Se)),clearTimeout(qt.wheel);else{if(de.k===Ee)return;qt.mouse=[Se,de.invert(Se)],cf(this),qt.start()}Ix(xt),qt.wheel=setTimeout(ze,B),qt.zoom("mouse",r(X(Z(de,Ee),qt.mouse[0],qt.mouse[1]),qt.extent,o));function ze(){qt.wheel=null,qt.end()}}function Et(xt,...Vt){if(T||!e.apply(this,arguments))return;var qt=xt.currentTarget,de=nt(this,Vt,!0).event(xt),Ee=po(xt.view).on("mousemove.zoom",nr,!0).on("mouseup.zoom",Si,!0),Se=xa(xt,qt),ze=xt.clientX,ke=xt.clientY;Qm(xt.view),vC(xt),de.mouse=[Se,this.__zoom.invert(Se)],cf(this),de.start();function nr(yi){if(Ix(yi),!de.moved){var hi=yi.clientX-ze,Kr=yi.clientY-ke;de.moved=hi*hi+Kr*Kr>L}de.event(yi).zoom("mouse",r(X(de.that.__zoom,de.mouse[0]=xa(yi,qt),de.mouse[1]),de.extent,o))}function Si(yi){Ee.on("mousemove.zoom mouseup.zoom",null),Km(yi.view,de.moved),Ix(yi),de.event(yi).end()}}function vt(xt,...Vt){if(e.apply(this,arguments)){var qt=this.__zoom,de=xa(xt.changedTouches?xt.changedTouches[0]:xt,this),Ee=qt.invert(de),Se=qt.k*(xt.shiftKey?.5:2),ze=r(X(Z(qt,Se),de,Ee),t.apply(this,Vt),o);Ix(xt),a>0?po(this).transition().duration(a).call(it,ze,de,xt):po(this).call(W.transform,ze,de,xt)}}function Pt(xt,...Vt){if(e.apply(this,arguments)){var qt=xt.touches,de=qt.length,Ee=nt(this,Vt,xt.changedTouches.length===de).event(xt),Se,ze,ke,nr;for(vC(xt),ze=0;ze<de;++ze)ke=qt[ze],nr=xa(ke,this),nr=[nr,this.__zoom.invert(nr),ke.identifier],Ee.touch0?!Ee.touch1&&Ee.touch0[2]!==nr[2]&&(Ee.touch1=nr,Ee.taps=0):(Ee.touch0=nr,Se=!0,Ee.taps=1+!!g);g&&(g=clearTimeout(g)),Se&&(Ee.taps<2&&(v=nr[0],g=setTimeout(function(){g=null},C)),cf(this),Ee.start())}}function re(xt,...Vt){if(this.__zooming){var qt=nt(this,Vt).event(xt),de=xt.changedTouches,Ee=de.length,Se,ze,ke,nr;for(Ix(xt),Se=0;Se<Ee;++Se)ze=de[Se],ke=xa(ze,this),qt.touch0&&qt.touch0[2]===ze.identifier?qt.touch0[0]=ke:qt.touch1&&qt.touch1[2]===ze.identifier&&(qt.touch1[0]=ke);if(ze=qt.that.__zoom,qt.touch1){var Si=qt.touch0[0],yi=qt.touch0[1],hi=qt.touch1[0],Kr=qt.touch1[1],zr=(zr=hi[0]-Si[0])*zr+(zr=hi[1]-Si[1])*zr,Br=(Br=Kr[0]-yi[0])*Br+(Br=Kr[1]-yi[1])*Br;ze=Z(ze,Math.sqrt(zr/Br)),ke=[(Si[0]+hi[0])/2,(Si[1]+hi[1])/2],nr=[(yi[0]+Kr[0])/2,(yi[1]+Kr[1])/2]}else if(qt.touch0)ke=qt.touch0[0],nr=qt.touch0[1];else return;qt.zoom("touch",r(X(ze,ke,nr),qt.extent,o))}}function $t(xt,...Vt){if(this.__zooming){var qt=nt(this,Vt).event(xt),de=xt.changedTouches,Ee=de.length,Se,ze;for(vC(xt),T&&clearTimeout(T),T=setTimeout(function(){T=null},C),Se=0;Se<Ee;++Se)ze=de[Se],qt.touch0&&qt.touch0[2]===ze.identifier?delete qt.touch0:qt.touch1&&qt.touch1[2]===ze.identifier&&delete qt.touch1;if(qt.touch1&&!qt.touch0&&(qt.touch0=qt.touch1,delete qt.touch1),qt.touch0)qt.touch0[1]=this.__zoom.invert(qt.touch0[0]);else if(qt.end(),qt.taps===2&&(ze=xa(ze,this),Math.hypot(v[0]-ze[0],v[1]-ze[1])<z)){var ke=po(this).on("dblclick.zoom");ke&&ke.apply(this,arguments)}}}return W.wheelDelta=function(xt){return arguments.length?(i=typeof xt=="function"?xt:KT(+xt),W):i},W.filter=function(xt){return arguments.length?(e=typeof xt=="function"?xt:KT(!!xt),W):e},W.touchable=function(xt){return arguments.length?(s=typeof xt=="function"?xt:KT(!!xt),W):s},W.extent=function(xt){return arguments.length?(t=typeof xt=="function"?xt:KT([[+xt[0][0],+xt[0][1]],[+xt[1][0],+xt[1][1]]]),W):t},W.scaleExtent=function(xt){return arguments.length?(n[0]=+xt[0],n[1]=+xt[1],W):[n[0],n[1]]},W.translateExtent=function(xt){return arguments.length?(o[0][0]=+xt[0][0],o[1][0]=+xt[1][0],o[0][1]=+xt[0][1],o[1][1]=+xt[1][1],W):[[o[0][0],o[0][1]],[o[1][0],o[1][1]]]},W.constrain=function(xt){return arguments.length?(r=xt,W):r},W.duration=function(xt){return arguments.length?(a=+xt,W):a},W.interpolate=function(xt){return arguments.length?(h=xt,W):h},W.on=function(){var xt=p.on.apply(p,arguments);return xt===p?W:xt},W.clickDistance=function(xt){return arguments.length?(L=(xt=+xt)*xt,W):Math.sqrt(L)},W.tapDistance=function(xt){return arguments.length?(z=+xt,W):z},W}var ML={};Ua(ML,{legend:()=>IL,swatches:()=>BEt});function DEt(e,{title:t,tickSize:r=6,width:i=320,height:s=44+r,marginTop:n=18,marginRight:o=0,marginBottom:a=16+r,marginLeft:h=0,ticks:p=i/64,tickFormat:g,tickValues:v}={}){function T(z,W=256){let Z=document.createElement("canvas");Z.width=W,Z.height=1;let X=Z.getContext("2d");for(let q=0;q<W;++q)X.fillStyle=z(q/(W-1)),X.fillRect(q,0,1,1);return Z}let C=d3.create("svg").attr("width",i).attr("height",s).attr("viewBox",[0,0,i,s]).style("overflow","visible").style("display","block"),B=z=>z.selectAll(".tick line").attr("y1",n+a-s),L;if(e.interpolate){let z=Math.min(e.domain().length,e.range().length);L=e.copy().rangeRound(d3.quantize(d3.interpolate(h,i-o),z)),C.append("image").attr("x",h).attr("y",n).attr("width",i-h-o).attr("height",s-n-a).attr("preserveAspectRatio","none").attr("xlink:href",T(e.copy().domain(d3.quantize(d3.interpolate(0,1),z))).toDataURL())}else if(e.interpolator){if(L=Object.assign(e.copy().interpolator(d3.interpolateRound(h,i-o)),{range(){return[h,i-o]}}),C.append("image").attr("x",h).attr("y",n).attr("width",i-h-o).attr("height",s-n-a).attr("preserveAspectRatio","none").attr("xlink:href",T(e.interpolator()).toDataURL()),!L.ticks){if(v===void 0){let z=Math.round(p+1);v=d3.range(z).map(W=>d3.quantile(e.domain(),W/(z-1)))}typeof g!="function"&&(g=d3.format(g===void 0?",f":g))}}else if(e.invertExtent){let z=e.thresholds?e.thresholds():e.quantiles?e.quantiles():e.domain(),W=g===void 0?Z=>Z:typeof g=="string"?d3.format(g):g;L=d3.scaleLinear().domain([-1,e.range().length-1]).rangeRound([h,i-o]),C.append("g").selectAll("rect").data(e.range()).join("rect").attr("x",(Z,X)=>L(X-1)).attr("y",n).attr("width",(Z,X)=>L(X)-L(X-1)).attr("height",s-n-a).attr("fill",Z=>Z),v=d3.range(z.length),g=Z=>W(z[Z],Z)}else L=d3.scaleBand().domain(e.domain()).rangeRound([h,i-o]),C.append("g").selectAll("rect").data(e.domain()).join("rect").attr("x",L).attr("y",n).attr("width",Math.max(0,L.bandwidth()-1)).attr("height",s-n-a).attr("fill",e),B=()=>{};return C.append("g").attr("transform",`translate(0,${s-a})`).call(d3.axisBottom(L).ticks(p,typeof g=="string"?g:void 0).tickFormat(typeof g=="function"?g:void 0).tickSize(r).tickValues(v)).call(B).call(z=>z.select(".domain").remove()).call(z=>z.append("text").attr("x",h).attr("y",n+a-s-6).attr("fill","currentColor").attr("text-anchor","start").attr("font-weight","bold").attr("class","title").text(t)),C.node()}function IL({color:e,...t}){return DEt(e,t)}function OEt(e,{columns:t=null,format:r,unknown:i,swatchSize:s=15,swatchWidth:n=s,swatchHeight:o=s,marginLeft:a=0}={}){let h=`-swatches-${Math.random().toString(16).slice(2)}`,p=i==null?void 0:e.unknown(),g=p==null||p===d3.scaleImplicit?[]:[p],v=e.domain().concat(g);r===void 0&&(r=C=>C===p?i:C);function T(C){return`&#${C.charCodeAt(0).toString()};`}return t!==null?htl.html`<div style="display: flex; align-items: center; margin-left: ${+a}px; min-height: 33px; font: 10px sans-serif;">
  <style>

.${h}-item {
  break-inside: avoid;
  display: flex;
  align-items: center;
  padding-bottom: 1px;
}

.${h}-label {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  max-width: calc(100% - ${+n}px - 0.5em);
}

.${h}-swatch {
  width: ${+n}px;
  height: ${+o}px;
  margin: 0 0.5em 0 0;
}

  </style>
  <div style=${{width:"100%",columns:t}}>${v.map(C=>{let B=`${r(C)}`;return htl.html`<div class=${h}-item>
      <div class=${h}-swatch style=${{background:e(C)}}></div>
      <div class=${h}-label title=${B}>${B}</div>
    </div>`})}
  </div>
</div>`:htl.html`<div style="display: flex; align-items: center; min-height: 33px; margin-left: ${+a}px; font: 10px sans-serif;">
  <style>

.${h} {
  display: inline-flex;
  align-items: center;
  margin-right: 1em;
}

.${h}::before {
  content: "";
  width: ${+n}px;
  height: ${+o}px;
  margin-right: 0.5em;
  background: var(--color);
}

  </style>
  <div>${v.map(C=>htl.html`<span class="${h}" style="--color: ${e(C)}">${r(C)}</span>`)}</div>`}function BEt({color:e,...t}){return OEt(e,t)}var Vz={};Ua(Vz,{addAggregateFunction:()=>_ht,addFunction:()=>xht,addPackage:()=>gPt,addTableMethod:()=>Uz,addVerb:()=>bht,addWindowFunction:()=>yht,agg:()=>Fz,all:()=>Iu,bin:()=>cht,desc:()=>SP,endswith:()=>Tlt,escape:()=>uht,field:()=>Cu,frac:()=>hht,from:()=>x4,fromArrow:()=>MP,fromCSV:()=>A4,fromFixed:()=>kP,fromJSON:()=>DP,internal:()=>_Pt,load:()=>kb,loadArrow:()=>VP,loadCSV:()=>oht,loadFixed:()=>aht,loadJSON:()=>lht,matches:()=>gb,names:()=>fht,not:()=>Ab,op:()=>Np,query:()=>Gct,queryFrom:()=>Qct,range:()=>uP,rolling:()=>wb,seed:()=>Ist,startswith:()=>wlt,table:()=>Lz,toArrow:()=>s4,version:()=>yPt});var li=Array.isArray;function Hs(e){return e!=null?li(e)?e:[e]:[]}function fst(e=0,t=1/0){return`${hst(e)} < row_number() && row_number() <= ${hst(t)}`}function hst(e){return e<0?`count() + ${e}`:e}var m0=class{constructor(t){t&&(this._params=t)}params(t){return arguments.length?(t&&(this._params={...this._params,...t}),this):this._params}reify(t){return this.__reify(this,t)}count(t){return this.__count(this,t)}derive(t,r){return this.__derive(this,t,r)}filter(t){return this.__filter(this,t)}slice(t,r){return this.filter(fst(t,r)).reify()}groupby(...t){return this.__groupby(this,t.flat())}orderby(...t){return this.__orderby(this,t.flat())}relocate(t,r){return this.__relocate(this,Hs(t),r)}rename(...t){return this.__rename(this,t.flat())}rollup(t){return this.__rollup(this,t)}sample(t,r){return this.__sample(this,t,r)}select(...t){return this.__select(this,t.flat())}ungroup(){return this.__ungroup(this)}unorder(){return this.__unorder(this)}dedupe(...t){return this.__dedupe(this,t.flat())}impute(t,r){return this.__impute(this,t,r)}fold(t,r){return this.__fold(this,t,r)}pivot(t,r,i){return this.__pivot(this,t,r,i)}spread(t,r){return this.__spread(this,t,r)}unroll(t,r){return this.__unroll(this,t,r)}lookup(t,r,...i){return this.__lookup(this,t,r,i.flat())}join(t,r,i,s){return this.__join(this,t,r,i,s)}join_left(t,r,i,s){let n={...s,left:!0,right:!1};return this.__join(this,t,r,i,n)}join_right(t,r,i,s){let n={...s,left:!1,right:!0};return this.__join(this,t,r,i,n)}join_full(t,r,i,s){let n={...s,left:!0,right:!0};return this.__join(this,t,r,i,n)}cross(t,r,i){return this.__cross(this,t,r,i)}semijoin(t,r){return this.__semijoin(this,t,r)}antijoin(t,r){return this.__antijoin(this,t,r)}concat(...t){return this.__concat(this,t.flat())}union(...t){return this.__union(this,t.flat())}intersect(...t){return this.__intersect(this,t.flat())}except(...t){return this.__except(this,t.flat())}};function sr(e){throw Error(e)}function qs(e){return typeof e=="number"}function Li(e){return typeof e=="function"}function fh(e,t){let r=Array(e);if(Li(t))for(let i=0;i<e;++i)r[i]=t(i);else r.fill(t);return r}var m_=class extends m0{constructor(t,r,i,s,n,o,a){super(a),this._names=Object.freeze(t),this._data=i,this._total=r,this._nrows=s?s.count():r,this._mask=r!==this._nrows&&s||null,this._group=n||null,this._order=o||null}create(t){sr("Not implemented")}get[Symbol.toStringTag](){if(!this._names)return"Object";let t=this.numRows()+" row"+(this.numRows()!==1?"s":"");return`Table: ${this.numCols()+" col"+(this.numCols()!==1?"s":"")} x ${t}`+(this.isFiltered()?` (${this.totalRows()} backing)`:"")+(this.isGrouped()?`, ${this._group.size} groups`:"")+(this.isOrdered()?", ordered":"")}isFiltered(){return!!this._mask}isGrouped(){return!!this._group}isOrdered(){return!!this._order}data(){return this._data}mask(){return this._mask}groups(){return this._group}comparator(){return this._order}totalRows(){return this._total}numRows(){return this._nrows}get size(){return this._nrows}numCols(){return this._names.length}columnNames(t){return t?this._names.filter(t):this._names.slice()}columnName(t){return this._names[t]}columnIndex(t){return this._names.indexOf(t)}columnArray(t,r){return this.array(t,r)}array(t,r){sr("Not implemented")}*values(t){let r=this.getter(t),i=this.numRows();for(let s=0;s<i;++s)yield r(s)}get(t,r=0){sr("Not implemented")}getter(t){sr("Not implemented")}objects(t){sr("Not implemented")}object(t){sr("Not implemented")}[Symbol.iterator](){sr("Not implemented")}print(t={}){qs(t)?t={limit:t}:t.limit==null&&(t.limit=10);let r=this.objects({...t,grouped:!1}),i=`${this[Symbol.toStringTag]}. Showing ${r.length} rows.`;return console.log(i),console.table(r),this}indices(t=!0){if(this._index)return this._index;let r=this.numRows(),i=new Uint32Array(r),s=this.isOrdered(),n=this.mask(),o=-1;if(n)for(let a=n.next(0);a>=0;a=n.next(a+1))i[++o]=a;else for(let a=0;a<r;++a)i[++o]=a;if(t&&s){let a=this._order,h=this._data;i.sort((p,g)=>a(p,g,h))}return(t||!s)&&(this._index=i),i}partitions(t=!0){if(this._partitions)return this._partitions;if(!this.isGrouped())return[this.indices(t)];let{keys:r,size:i}=this._group,s=fh(i,()=>[]),n=this._index,o=this.mask(),a=this.numRows();if(n&&this.isOrdered())for(let h=0,p;h<a;++h)p=n[h],s[r[p]].push(p);else if(o)for(let h=o.next(0);h>=0;h=o.next(h+1))s[r[h]].push(h);else for(let h=0;h<a;++h)s[r[h]].push(h);if(t&&!n&&this.isOrdered()){let h=this._order,p=this._data;for(let g=0;g<i;++g)s[g].sort((v,T)=>h(v,T,p))}return(t||!this.isOrdered())&&(this._partitions=s),s}scan(t,r,i=1/0,s=0){let n=this._mask,o=this._nrows,a=this._data,h=s||0;if(h>o)return;let p=Math.min(o,h+i),g=()=>h=this._total;if(r&&this.isOrdered()||n&&this._index){let v=this.indices(),T=this._data;for(;h<p;++h)t(v[h],T,g)}else if(n){let v=p-h+1;for(h=n.nth(h);--v&&h>-1;h=n.next(h+1))t(h,a,g)}else for(;h<p;++h)t(h,a,g)}slice(t=0,r=1/0){if(this.isGrouped())return super.slice(t,r);let i=[],s=this.numRows();return t=Math.max(0,t+(t<0?s:0)),r=Math.min(s,Math.max(0,r+(r<0?s:0))),this.scan(n=>i.push(n),!0,r-t,t),this.reify(i)}reduce(t){return this.__reduce(this,t)}};var wC=class{constructor(t){this.data=t}get length(){return this.data.length}get(t){return this.data[t]}[Symbol.iterator](){return this.data[Symbol.iterator]()}},TC=function(e){return e&&Li(e.get)?e:new wC(e)};function pst(e){return arguments.length?TC=e:TC}function Ya(e){return e instanceof Date}function _s(e){return e===Object(e)}function A_(e){return e instanceof RegExp}function Ln(e){return typeof e=="string"}function mst(e,t){let r=i=>sr(`Illegal argument type: ${i||typeof e}`);return e instanceof Map?dst(e.entries(),t):Ya(e)?r("Date"):A_(e)?r("RegExp"):Ln(e)?r():li(e)?NEt(e,t):Li(e[Symbol.iterator])?LEt(e,t):_s(e)?dst(Object.entries(e),t):r()}function dst(e,t=["key","value"]){let r=[],i=[];for(let[n,o]of e)r.push(n),i.push(o);let s={};return t[0]&&(s[t[0]]=r),t[1]&&(s[t[1]]=i),s}function NEt(e,t){let r=e.length,i={},s=n=>i[n]=Array(r);if(r){t=t||Object.keys(e[0]);let n=t.map(s),o=n.length;for(let a=0;a<r;++a){let h=e[a];for(let p=0;p<o;++p)n[p][a]=h[t[p]]}}else t&&t.forEach(s);return i}function LEt(e,t){let r={},i=o=>r[o]=[],s,n;for(let o of e){s||(t=t||Object.keys(o),s=t.map(i),n=s.length);for(let a=0;a<n;++a)s[a].push(o[t[a]])}return!s&&t&&t.forEach(i),r}var{hasOwnProperty:FEt}=Object.prototype;function Ea(e,t){return FEt.call(e,t)}function ys(e){return e?new SC({...e.data()},e.columnNames()):new SC}var SC=class{constructor(t,r){this.data=t||{},this.names=r||[]}add(t,r){return this.has(t)||this.names.push(t+""),this.data[t]=r}has(t){return Ea(this.data,t)}new(){return this.filter=null,this.groups=this.groups||null,this.order=null,this}groupby(t){return this.groups=t,this}};var Wi=void 0;var zEt=Object.getPrototypeOf(Int8Array);function Op(e){return e instanceof zEt}function Au(e){return li(e)||Op(e)}function Xa(e){return e!=null&&e===e}var JT=e=>Au(e)||Ln(e),Ast={compact:e=>Au(e)?e.filter(t=>Xa(t)):e,concat:(...e)=>[].concat(...e),includes:(e,t,r)=>JT(e)?e.includes(t,r):!1,indexof:(e,t)=>JT(e)?e.indexOf(t):-1,join:(e,t)=>Au(e)?e.join(t):Wi,lastindexof:(e,t)=>JT(e)?e.lastIndexOf(t):-1,length:e=>JT(e)?e.length:0,pluck:(e,t)=>Au(e)?e.map(r=>Xa(r)?r[t]:Wi):Wi,reverse:e=>Au(e)?e.slice().reverse():Ln(e)?e.split("").reverse().join(""):Wi,slice:(e,t,r)=>JT(e)?e.slice(t,r):Wi};function gst(e,t,r,i,s){return e==null?null:e<t?-1/0:e>r?1/0:(e=Math.max(t,Math.min(e,r)),t+i*Math.floor(1e-14+(e-t)/i+(s||0)))}function tS(e,t,r="0"){let i=e+"",s=i.length;return s<t?Array(t-s+1).join(r)+i:i}var Bp=e=>(e<10?"0":"")+e,UEt=e=>e<0?"-"+tS(-e,6):e>9999?"+"+tS(e,6):tS(e,4);function _st(e,t,r,i,s,n,o,a,h){let p=a?"Z":"";return UEt(e)+"-"+Bp(t+1)+"-"+Bp(r)+(!h||o?"T"+Bp(i)+":"+Bp(s)+":"+Bp(n)+"."+tS(o,3)+p:n?"T"+Bp(i)+":"+Bp(s)+":"+Bp(n)+p:s||i||!a?"T"+Bp(i)+":"+Bp(s)+p:"")}function EC(e,t){return isNaN(e)?"Invalid Date":_st(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds(),!1,t)}function bA(e,t){return isNaN(e)?"Invalid Date":_st(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds(),!0,t)}var VEt=/^([-+]\d{2})?\d{4}(-\d{2}(-\d{2})?)?(T\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/;function Mx(e){return e.match(VEt)&&!isNaN(Date.parse(e))}function yst(e,t=Date.parse){return Mx(e)?t(e):e}var xst=6e4,bst=864e5,vst=6048e5,Ao=new Date,go=new Date,No=e=>(Ao.setTime(typeof e=="string"?yst(e):e),Ao);function jEt(e,t,r,i,s,n,o){return arguments.length?new Date(e,t||0,r??1,i||0,s||0,n||0,o||0):new Date(Date.now())}function WEt(e,t,r,i,s,n,o){return arguments.length?new Date(Date.UTC(e,t||0,r??1,i||0,s||0,n||0,o||0)):new Date(Date.now())}function $Et(e){go.setTime(+e),go.setHours(0,0,0,0),Ao.setTime(+go),Ao.setMonth(0),Ao.setDate(1);let t=(go.getTimezoneOffset()-Ao.getTimezoneOffset())*xst;return Math.floor(1+(go-Ao-t)/bst)}function HEt(e){go.setTime(+e),go.setUTCHours(0,0,0,0);let t=Date.UTC(go.getUTCFullYear(),0,1);return Math.floor(1+(go-t)/bst)}function qEt(e,t){let r=t||0;go.setTime(+e),go.setDate(go.getDate()-(go.getDay()+7-r)%7),go.setHours(0,0,0,0),Ao.setTime(+e),Ao.setMonth(0),Ao.setDate(1),Ao.setDate(1-(Ao.getDay()+7-r)%7),Ao.setHours(0,0,0,0);let i=(go.getTimezoneOffset()-Ao.getTimezoneOffset())*xst;return Math.floor((1+(go-Ao)-i)/vst)}function YEt(e,t){let r=t||0;return go.setTime(+e),go.setUTCDate(go.getUTCDate()-(go.getUTCDay()+7-r)%7),go.setUTCHours(0,0,0,0),Ao.setTime(+e),Ao.setUTCMonth(0),Ao.setUTCDate(1),Ao.setUTCDate(1-(Ao.getUTCDay()+7-r)%7),Ao.setUTCHours(0,0,0,0),Math.floor((1+(go-Ao))/vst)}var wst={format_date:(e,t)=>EC(No(e),!t),format_utcdate:(e,t)=>bA(No(e),!t),timestamp:e=>+No(e),year:e=>No(e).getFullYear(),quarter:e=>Math.floor(No(e).getMonth()/3),month:e=>No(e).getMonth(),date:e=>No(e).getDate(),dayofweek:e=>No(e).getDay(),hours:e=>No(e).getHours(),minutes:e=>No(e).getMinutes(),seconds:e=>No(e).getSeconds(),milliseconds:e=>No(e).getMilliseconds(),utcyear:e=>No(e).getUTCFullYear(),utcquarter:e=>Math.floor(No(e).getUTCMonth()/3),utcmonth:e=>No(e).getUTCMonth(),utcdate:e=>No(e).getUTCDate(),utcdayofweek:e=>No(e).getUTCDay(),utchours:e=>No(e).getUTCHours(),utcminutes:e=>No(e).getUTCMinutes(),utcseconds:e=>No(e).getUTCSeconds(),utcmilliseconds:e=>No(e).getUTCMilliseconds(),datetime:jEt,dayofyear:$Et,week:qEt,utcdatetime:WEt,utcdayofyear:HEt,utcweek:YEt,now:Date.now};function eS(e,t){return e==null||t==null||e!==e||t!==t?!1:e===t?!0:Ya(e)||Ya(t)?+e==+t:A_(e)&&A_(t)?e+""==t+"":_s(e)&&_s(t)?XEt(e,t):!1}function XEt(e,t){if(Object.getPrototypeOf(e)!==Object.getPrototypeOf(t))return!1;if(e.length||t.length)return Tst(e,t);let r=Object.keys(e),i=Object.keys(t);if(r.length!==i.length||(r.sort(),i.sort(),!Tst(r,i,(n,o)=>n===o)))return!1;let s=r.length;for(let n=0;n<s;++n){let o=r[n];if(!eS(e[o],t[o]))return!1}return!0}function Tst(e,t,r=eS){let i=e.length;if(i!==t.length)return!1;for(let s=0;s<i;++s)if(!r(e[s],t[s]))return!1;return!0}var Sst={parse_json:e=>JSON.parse(e),to_json:e=>JSON.stringify(e)};var Est=Math.random;function A0(){return Est()}function Ist(e){Est=Xa(e)&&isFinite(e=+e)?ZEt(e):Math.random}function ZEt(e){let i=23283064365386963e-26;return e=(0<=e&&e<1?e/i:Math.abs(e))|0,()=>(e=1664525*e+1013904223|0,i*(e>>>0))}var Mst={random:A0,is_nan:Number.isNaN,is_finite:Number.isFinite,abs:Math.abs,cbrt:Math.cbrt,ceil:Math.ceil,clz32:Math.clz32,exp:Math.exp,expm1:Math.expm1,floor:Math.floor,fround:Math.fround,greatest:Math.max,least:Math.min,log:Math.log,log10:Math.log10,log1p:Math.log1p,log2:Math.log2,pow:Math.pow,round:Math.round,sign:Math.sign,sqrt:Math.sqrt,trunc:Math.trunc,degrees:e=>180*e/Math.PI,radians:e=>Math.PI*e/180,acos:Math.acos,acosh:Math.acosh,asin:Math.asin,asinh:Math.asinh,atan:Math.atan,atan2:Math.atan2,atanh:Math.atanh,cos:Math.cos,cosh:Math.cosh,sin:Math.sin,sinh:Math.sinh,tan:Math.tan,tanh:Math.tanh};function Cx(e){return e instanceof Map}function Cst(e){return e instanceof Set}function Px(e){return Cx(e)||Cst(e)}function CL(e){return Array.from(e)}var Pst={has:(e,t)=>Px(e)?e.has(t):e!=null?Ea(e,t):!1,keys:e=>Cx(e)?CL(e.keys()):e!=null?Object.keys(e):[],values:e=>Px(e)?CL(e.values()):e!=null?Object.values(e):[],entries:e=>Px(e)?CL(e.entries()):e!=null?Object.entries(e):[],object:e=>e?Object.fromEntries(e):Wi};function Rst(e,t,r){if(t instanceof Map){if(t.has(e))return t.get(e)}else if(Ea(t,e))return t[e];return r!==void 0?r:e}function IC(e,t,r){let i=arguments.length;e=+e,t=+t,r=i<2?(t=e,e=0,1):i<3?1:+r,i=Math.max(0,Math.ceil((t-e)/r))|0;let s=new Array(i);for(let n=0;n<i;++n)s[n]=e+n*r;return s}var kst={parse_date:e=>e==null?e:new Date(e),parse_float:e=>e==null?e:Number.parseFloat(e),parse_int:(e,t)=>e==null?e:Number.parseInt(e,t),endswith:(e,t,r)=>e==null?!1:String(e).endsWith(t,r),match:(e,t,r)=>{let i=e==null?e:String(e).match(t);return r==null||i==null?i:typeof r=="number"?i[r]:i.groups?i.groups[r]:null},normalize:(e,t)=>e==null?e:String(e).normalize(t),padend:(e,t,r)=>e==null?e:String(e).padEnd(t,r),padstart:(e,t,r)=>e==null?e:String(e).padStart(t,r),upper:e=>e==null?e:String(e).toUpperCase(),lower:e=>e==null?e:String(e).toLowerCase(),repeat:(e,t)=>e==null?e:String(e).repeat(t),replace:(e,t,r)=>e==null?e:String(e).replace(t,String(r)),substring:(e,t,r)=>e==null?e:String(e).substring(t,r),split:(e,t,r)=>e==null?[]:String(e).split(t,r),startswith:(e,t,r)=>e==null?!1:String(e).startsWith(t,r),trim:e=>e==null?e:String(e).trim()};var gu={bin:gst,equal:eS,recode:Rst,sequence:IC,...Ast,...wst,...Sst,...Mst,...Pst,...kst};function g0(e){return typeof e=="bigint"}function Ls(e){return e===void 0?e+"":g0(e)?e+"n":JSON.stringify(e)}function Ri(e,t=[],r=[]){return new PL(e,Hs(t),Hs(r))}var PL=class{constructor(t,r,i){this.name=t,this.fields=r,this.params=i}toString(){let t=[...this.fields.map(r=>`d[${Ls(r)}]`),...this.params.map(Ls)];return`d => op.${this.name}(${t})`}toObject(){return{expr:this.toString(),func:!0}}};var RL=e=>Ri("any",e),kL=()=>Ri("count"),DL=e=>Ri("array_agg",e),OL=e=>Ri("array_agg_distinct",e),BL=(e,t)=>Ri("map_agg",[e,t]),NL=(e,t)=>Ri("object_agg",[e,t]),LL=(e,t)=>Ri("entries_agg",[e,t]),Np={...gu,row_object:(...e)=>Ri("row_object",null,e.flat()),count:kL,any:RL,array_agg:DL,array_agg_distinct:OL,object_agg:NL,map_agg:BL,entries_agg:LL,valid:e=>Ri("valid",e),invalid:e=>Ri("invalid",e),distinct:e=>Ri("distinct",e),mode:e=>Ri("mode",e),sum:e=>Ri("sum",e),product:e=>Ri("product",e),mean:e=>Ri("mean",e),average:e=>Ri("average",e),variance:e=>Ri("variance",e),variancep:e=>Ri("variancep",e),stdev:e=>Ri("stdev",e),stdevp:e=>Ri("stdevp",e),min:e=>Ri("min",e),max:e=>Ri("max",e),quantile:(e,t)=>Ri("quantile",e,t),median:e=>Ri("median",e),covariance:(e,t)=>Ri("covariance",[e,t]),covariancep:(e,t)=>Ri("covariancep",[e,t]),corr:(e,t)=>Ri("corr",[e,t]),bins:(e,t,r,i)=>Ri("bins",e,[t,r,i]),row_number:()=>Ri("row_number"),rank:()=>Ri("rank"),avg_rank:()=>Ri("avg_rank"),dense_rank:()=>Ri("dense_rank"),percent_rank:()=>Ri("percent_rank"),cume_dist:()=>Ri("cume_dist"),ntile:e=>Ri("ntile",null,e),lag:(e,t,r)=>Ri("lag",e,[t,r]),lead:(e,t,r)=>Ri("lead",e,[t,r]),first_value:e=>Ri("first_value",e),last_value:e=>Ri("last_value",e),nth_value:(e,t)=>Ri("nth_value",e,t),fill_down:(e,t)=>Ri("fill_down",e,t),fill_up:(e,t)=>Ri("fill_up",e,t)};function Dst(e,t){e=Px(e)?e:new Set(e);let r=t,i=0;for(;e.has(r);)r=t+ ++i;return r}function Ost(e,t){if(!e||!t)return e;let{keys:r,rows:i,size:s}=e,n=new Int32Array(s);t.scan(g=>n[r[g]]=1);let o=n.reduce((g,v)=>g+v,0);if(o===s)return e;let a=Array(o),h=0;for(let g=0;g<s;++g)n[g]&&(a[n[g]=h++]=i[g]);let p=new Uint32Array(r.length);return t.scan(g=>p[g]=n[r[g]]),{...e,keys:p,rows:a,size:h}}function Bst(e,t,r,i){let{keys:s,rows:n,size:o}=e,a=n,h=o,p=null;if(r){p=new Int32Array(o),t(B=>p[s[B]]=1);let C=p.reduce((B,L)=>B+L,0);if(C!==o){a=Array(C),h=0;for(let B=0;B<o;++B)p[B]&&(a[p[B]=h++]=n[B])}}let g=-1,v=new Uint32Array(i);return t(h!==o?C=>v[++g]=p[s[C]]:C=>v[++g]=s[C]),{...e,keys:v,rows:a,size:h}}function Nst(e,t,r,i){let s=i==="map"||i===!0?BL:i==="entries"?LL:i==="object"?NL:sr('groups option must be "map", "entries", or "object".'),{names:n}=e.groups(),o=Dst(e.columnNames(),"_"),a=e.select().reify(t).create({data:{[o]:r}}).rollup({[o]:DL(o)});for(let h=n.length;--h>=0;)a=a.groupby(n.slice(0,h)).rollup({[o]:s(n[h],o)});return a.get(o)}var Lst="ArrayPattern",Fst="ArrowFunctionExpression",zst="FunctionExpression",_0="Identifier",Lp="Literal",FL="MemberExpression",Ust="ObjectExpression",zL="ObjectPattern",MC="Property",vA="Column",Vst="Constant",jst="Dictionary",Wst="Function",$st="Parameter",CC="Op";var Ms=(e,t)=>{let r=GEt[e.type];return r?r(e,t):sr(`Unsupported expression construct: ${e.type}`)},UL=(e,t)=>"("+Ms(e.left,t)+" "+e.operator+" "+Ms(e.right,t)+")",VL=(e,t)=>"("+Fp(e.params,t)+")=>"+Ms(e.body,t),Hst=(e,t)=>Ms(e.callee,t)+"("+Fp(e.arguments,t)+")",Fp=(e,t,r=",")=>e.map(i=>Ms(i,t)).join(r),Yst=e=>e.computed?`[${Ls(e.name)}]`:`.${e.name}`,qst=(e,t,r)=>{let i=e.table||"";return`data${i}${Yst(e)}.${r}(${t.index}${i})`},GEt={Constant:e=>e.raw,Column:(e,t)=>qst(e,t,"get"),Dictionary:(e,t)=>qst(e,t,"key"),Function:e=>`fn.${e.name}`,Parameter:e=>`$${Yst(e)}`,Op:(e,t)=>`op(${Ls(e.name)},${t.op||t.index})`,Literal:e=>e.raw,Identifier:e=>e.name,TemplateLiteral:(e,t)=>{let{quasis:r,expressions:i}=e,s=i.length,n=r[0].value.raw;for(let o=0;o<s;)n+="${"+Ms(i[o],t)+"}"+r[++o].value.raw;return"`"+n+"`"},MemberExpression:(e,t)=>{let r=!e.computed,i=Ms(e.object,t),s=Ms(e.property,t);return i+(r?"."+s:"["+s+"]")},CallExpression:Hst,NewExpression:(e,t)=>"new "+Hst(e,t),ArrayExpression:(e,t)=>"["+Fp(e.elements,t)+"]",AssignmentExpression:UL,BinaryExpression:UL,LogicalExpression:UL,UnaryExpression:(e,t)=>"("+e.operator+Ms(e.argument,t)+")",ConditionalExpression:(e,t)=>"("+Ms(e.test,t)+"?"+Ms(e.consequent,t)+":"+Ms(e.alternate,t)+")",ObjectExpression:(e,t)=>"({"+Fp(e.properties,t)+"})",Property:(e,t)=>{let r=Ms(e.key,t);return(e.computed?`[${r}]`:r)+":"+Ms(e.value,t)},ArrowFunctionExpression:VL,FunctionExpression:VL,FunctionDeclaration:VL,ArrayPattern:(e,t)=>"["+Fp(e.elements,t)+"]",ObjectPattern:(e,t)=>"{"+Fp(e.properties,t)+"}",VariableDeclaration:(e,t)=>e.kind+" "+Fp(e.declarations,t,","),VariableDeclarator:(e,t)=>Ms(e.id,t)+"="+Ms(e.init,t),SpreadElement:(e,t)=>"..."+Ms(e.argument,t),BlockStatement:(e,t)=>"{"+Fp(e.body,t,";")+";}",BreakStatement:()=>"break",ExpressionStatement:(e,t)=>Ms(e.expression,t),IfStatement:(e,t)=>"if ("+Ms(e.test,t)+")"+Ms(e.consequent,t)+(e.alternate?" else "+Ms(e.alternate,t):""),SwitchStatement:(e,t)=>"switch ("+Ms(e.discriminant,t)+") {"+Fp(e.cases,t,"")+"}",SwitchCase:(e,t)=>(e.test?"case "+Ms(e.test,t):"default")+": "+Fp(e.consequent,t,";")+";",ReturnStatement:(e,t)=>"return "+Ms(e.argument,t),Program:(e,t)=>Ms(e.body[0],t)};function g_(e,t={index:"row"}){return Ms(e,t)}function Xst(e,t,r=15,i=!0,s=0,n){let a=Math.LN10;if(n==null){let h=Math.ceil(Math.log(r)/a),p=t-e||Math.abs(e)||1,g=[5,2];for(n=Math.max(s,Math.pow(10,Math.round(Math.log(p)/a)-h));Math.ceil(p/n)>r;)n*=10;let v=g.length;for(let T=0;T<v;++T){let C=n/g[T];C>=s&&p/C<=r&&(n=C)}}if(i){let h=Math.log(n),p=h>=0?0:~~(-h/a)+1,g=Math.pow(10,-p-1);h=Math.floor(e/n+g)*n,e=e<h?h-n:h,t=Math.ceil(t/n)*n}return[e,t===e?e+n:t,n]}function __(e){let t=typeof e;return t==="string"?`"${e}"`:t!=="object"||!e?e:Ya(e)?+e:li(e)||Op(e)?`[${e.map(__)}]`:A_(e)?e+"":QEt(e)}function QEt(e){let t="{",r=-1;for(let i in e)++r>0&&(t+=","),t+=`"${i}":${__(e[i])}`;return t+="}",t}function y_(e,t){let r=e.length;return r===1?(i,s)=>__(e[0](i,s)):(i,s)=>{let n="";for(let o=0;o<r;++o){o>0&&(n+="|");let a=e[o](i,s);if(t&&(a==null||a!==a))return null;n+=__(a)}return n}}function Zst(){let e=new Map;return{count(){return e.size},values(){return Array.from(e.values(),t=>t.v)},increment(t){let r=__(t),i=e.get(r);i?++i.n:e.set(r,{v:t,n:1})},decrement(t){let r=__(t),i=e.get(r);i.n===1?e.delete(r):--i.n},forEach(t){e.forEach(({v:r,n:i})=>t(r,i))}}}function yf(){}function Gst(e,t=0,r=e.length){let i=e[t++];for(let s=t;s<r;++s)i*=e[s];return i}function ia(e){return e.init=e.init||yf,e.add=e.add||yf,e.rem=e.rem||yf,e}function Qst(e,t){return e.product_v=!1,e.product=t}var Rx={count:{create:()=>ia({value:e=>e.count}),param:[]},array_agg:{create:()=>ia({init:e=>e.values=!0,value:e=>e.list.values(e.stream)}),param:[1]},object_agg:{create:()=>ia({init:e=>e.values=!0,value:e=>Object.fromEntries(e.list.values())}),param:[2]},map_agg:{create:()=>ia({init:e=>e.values=!0,value:e=>new Map(e.list.values())}),param:[2]},entries_agg:{create:()=>ia({init:e=>e.values=!0,value:e=>e.list.values(e.stream)}),param:[2]},any:{create:()=>ia({add:(e,t)=>{e.any==null&&(e.any=t)},value:e=>e.valid?e.any:Wi}),param:[1]},valid:{create:()=>ia({value:e=>e.valid}),param:[1]},invalid:{create:()=>ia({value:e=>e.count-e.valid}),param:[1]},distinct:{create:()=>({init:e=>e.distinct=Zst(),value:e=>e.distinct.count()+(e.valid===e.count?0:1),add:(e,t)=>e.distinct.increment(t),rem:(e,t)=>e.distinct.decrement(t)}),param:[1]},array_agg_distinct:{create:()=>ia({value:e=>e.distinct.values()}),param:[1],req:["distinct"]},mode:{create:()=>ia({value:e=>{let t=Wi,r=0;return e.distinct.forEach((i,s)=>{s>r&&(r=s,t=i)}),t}}),param:[1],req:["distinct"]},sum:{create:()=>({init:e=>e.sum=0,value:e=>e.valid?e.sum:Wi,add:(e,t)=>g0(t)?e.sum===0?e.sum=t:e.sum+=t:e.sum+=+t,rem:(e,t)=>e.sum-=t}),param:[1]},product:{create:()=>({init:e=>Qst(e,1),value:e=>e.valid?e.product_v?Qst(e,Gst(e.list.values())):e.product:void 0,add:(e,t)=>g0(t)&&e.product===1?e.product=t:e.product*=t,rem:(e,t)=>t==0||t===1/0||t===-1/0?e.product_v=!0:e.product/=t}),param:[1],stream:["array_agg"]},mean:{create:()=>({init:e=>e.mean=0,value:e=>e.valid?e.mean:Wi,add:(e,t)=>{e.mean_d=t-e.mean,e.mean+=e.mean_d/e.valid},rem:(e,t)=>{e.mean_d=t-e.mean,e.mean-=e.valid?e.mean_d/e.valid:e.mean}}),param:[1]},average:{create:()=>ia({value:e=>e.valid?e.mean:Wi}),param:[1],req:["mean"]},variance:{create:()=>({init:e=>e.dev=0,value:e=>e.valid>1?e.dev/(e.valid-1):Wi,add:(e,t)=>e.dev+=e.mean_d*(t-e.mean),rem:(e,t)=>e.dev-=e.mean_d*(t-e.mean)}),param:[1],req:["mean"]},variancep:{create:()=>ia({value:e=>e.valid>1?e.dev/e.valid:Wi}),param:[1],req:["variance"]},stdev:{create:()=>ia({value:e=>e.valid>1?Math.sqrt(e.dev/(e.valid-1)):Wi}),param:[1],req:["variance"]},stdevp:{create:()=>ia({value:e=>e.valid>1?Math.sqrt(e.dev/e.valid):Wi}),param:[1],req:["variance"]},min:{create:()=>({init:e=>e.min=Wi,value:e=>e.min=Number.isNaN(e.min)?e.list.min():e.min,add:(e,t)=>{(t<e.min||e.min===Wi)&&(e.min=t)},rem:(e,t)=>{t<=e.min&&(e.min=NaN)}}),param:[1],stream:["array_agg"]},max:{create:()=>({init:e=>e.max=Wi,value:e=>e.max=Number.isNaN(e.max)?e.list.max():e.max,add:(e,t)=>{(t>e.max||e.max===Wi)&&(e.max=t)},rem:(e,t)=>{t>=e.max&&(e.max=NaN)}}),param:[1],stream:["array_agg"]},quantile:{create:e=>ia({value:t=>t.list.quantile(e)}),param:[1,1],req:["array_agg"]},median:{create:()=>ia({value:e=>e.list.quantile(.5)}),param:[1],req:["array_agg"]},covariance:{create:()=>({init:e=>{e.cov=e.mean_x=e.mean_y=e.dev_x=e.dev_y=0},value:e=>e.valid>1?e.cov/(e.valid-1):Wi,add:(e,t,r)=>{let i=t-e.mean_x,s=r-e.mean_y;e.mean_x+=i/e.valid,e.mean_y+=s/e.valid;let n=r-e.mean_y;e.dev_x+=i*(t-e.mean_x),e.dev_y+=s*n,e.cov+=i*n},rem:(e,t,r)=>{let i=t-e.mean_x,s=r-e.mean_y;e.mean_x-=e.valid?i/e.valid:e.mean_x,e.mean_y-=e.valid?s/e.valid:e.mean_y;let n=r-e.mean_y;e.dev_x-=i*(t-e.mean_x),e.dev_y-=s*n,e.cov-=i*n}}),param:[2]},covariancep:{create:()=>ia({value:e=>e.valid>1?e.cov/e.valid:Wi}),param:[2],req:["covariance"]},corr:{create:()=>ia({value:e=>e.valid>1?e.cov/(Math.sqrt(e.dev_x)*Math.sqrt(e.dev_y)):Wi}),param:[2],req:["covariance"]},bins:{create:(e,t,r,i)=>ia({value:s=>Xst(s.min,s.max,e,t,r,i)}),param:[1,4],req:["min","max"]}};var Kst={create(){let e;return{init:()=>e=1,value:t=>{let r=t.index;return r&&!t.peer(r)?e=r+1:e}}},param:[]},Jst={create(){let e;return{init:()=>e=0,value:t=>{let{index:r,peer:i,size:s}=t,n=r;if(e<n){for(;n+1<s&&i(n+1);)++n;e=n}return(1+e)/s}}},param:[]},kx={row_number:{create(){return{init:yf,value:e=>e.index+1}},param:[]},rank:Kst,avg_rank:{create(){let e,t;return{init:()=>(e=-1,t=1),value:r=>{let i=r.index;if(i>=e){for(t=e=i+1;r.peer(e);t+=++e);t/=e-i}return t}}},param:[]},dense_rank:{create(){let e;return{init:()=>e=1,value:t=>{let r=t.index;return r&&!t.peer(r)?++e:e}}},param:[]},percent_rank:{create(){let{init:e,value:t}=Kst.create();return{init:e,value:r=>(t(r)-1)/(r.size-1)}},param:[]},cume_dist:Jst,ntile:{create(e){e=+e,e>0||sr("ntile num must be greater than zero.");let{init:t,value:r}=Jst.create();return{init:t,value:i=>Math.ceil(e*r(i))}},param:[0,1]},lag:{create(e,t=Wi){return e=+e||1,{init:yf,value:(r,i)=>{let s=r.index-e;return s>=0?r.value(s,i):t}}},param:[1,2]},lead:{create(e,t=Wi){return e=+e||1,{init:yf,value:(r,i)=>{let s=r.index+e;return s<r.size?r.value(s,i):t}}},param:[1,2]},first_value:{create(){return{init:yf,value:(e,t)=>e.value(e.i0,t)}},param:[1]},last_value:{create(){return{init:yf,value:(e,t)=>e.value(e.i1-1,t)}},param:[1]},nth_value:{create(e){return e=+e,e>0||sr("nth_value nth must be greater than zero."),{init:yf,value:(t,r)=>{let i=t.i0+(e-1);return i<t.i1?t.value(i,r):Wi}}},param:[1,1]},fill_down:{create(e=Wi){let t;return{init:()=>t=e,value:(r,i)=>{let s=r.value(r.index,i);return Xa(s)?t=s:t}}},param:[1,1]},fill_up:{create(e=Wi){let t,r;return{init:()=>(t=e,r=-1),value:(i,s)=>i.index<=r?t:(r=KEt(i,s,i.index))>=0?t=i.value(r,s):(r=i.size,t=e)}},param:[1,1]}};function KEt(e,t,r){for(let i=e.size;r<i;++r)if(Xa(e.value(r,t)))return r;return-1}function rS(e){return Ea(Rx,e)}function iS(e){return Ea(kx,e)}function jL(e){return Ea(gu,e)||e==="row_object"}function PC(e){return rS(e)&&Rx[e]}function RC(e){return iS(e)&&kx[e]}function nS(e,t,r){return e=`"use strict"; return ${e};`,Function("fn","$",e)(t,r)}var Dx={escape:(e,t,r)=>nS(e,t,r),expr:(e,t)=>nS(`(row,data,op)=>${e}`,gu,t),expr2:(e,t)=>nS(`(row0,data0,row,data)=>${e}`,gu,t),join:(e,t)=>nS(`(row1,data1,row2,data2)=>${e}`,gu,t),param:(e,t)=>nS(e,gu,t)};var JEt={"==":1,"!=":1,"===":1,"!==":1};function kC(e,t,r=0,i,s){if(e.type=vA,e.name=t,e.table=r,s&&i&&Li(i.keyFor)){let n=JEt[s.operator]?s.left===e?s.right:s.left:s.callee&&s.callee.name==="equal"?s.arguments[s.arguments[0]===e?1:0]:null;n&&n.type===Lp&&t6t(s,e,n,i.keyFor(n.value))}return e}function t6t(e,t,r,i){return i<0?(e.type=Lp,e.value=!1,e.raw="false"):(t.type=jst,r.value=i,r.raw=i+""),!0}function wA(e){return li(e)?e:Cx(e)?e.entries():e?Object.entries(e):[]}var Ox="row_object";function WL(e,t){e.type=Ust;let r=e.properties=[];for(let i of wA(t)){let[s,n]=li(i)?i:[i,i];r.push({type:MC,key:{type:Lp,raw:Ls(n)},value:kC({computed:!0},s)})}return e}function $L(e){return g_(WL({},e))}function HL(e){return Dx.expr($L(e))}function eot(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,i=Object.getOwnPropertySymbols(e);s<i.length;s++)t.indexOf(i[s])<0&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(r[i[s]]=e[i[s]]);return r}function _r(e,t,r,i){function s(n){return n instanceof r?n:new r(function(o){o(n)})}return new(r||(r=Promise))(function(n,o){function a(g){try{p(i.next(g))}catch(v){o(v)}}function h(g){try{p(i.throw(g))}catch(v){o(v)}}function p(g){g.done?n(g.value):s(g.value).then(a,h)}p((i=i.apply(e,t||[])).next())})}function tot(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Fi(e){return this instanceof Fi?(this.v=e,this):new Fi(e)}function _u(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(e,t||[]),s,n=[];return s={},a("next"),a("throw"),a("return",o),s[Symbol.asyncIterator]=function(){return this},s;function o(C){return function(B){return Promise.resolve(B).then(C,v)}}function a(C,B){i[C]&&(s[C]=function(L){return new Promise(function(z,W){n.push([C,L,z,W])>1||h(C,L)})},B&&(s[C]=B(s[C])))}function h(C,B){try{p(i[C](B))}catch(L){T(n[0][3],L)}}function p(C){C.value instanceof Fi?Promise.resolve(C.value.v).then(g,v):T(n[0][2],C)}function g(C){h("next",C)}function v(C){h("throw",C)}function T(C,B){C(B),n.shift(),n.length&&h(n[0][0],n[0][1])}}function Bx(e){var t,r;return t={},i("next"),i("throw",function(s){throw s}),i("return"),t[Symbol.iterator]=function(){return this},t;function i(s,n){t[s]=e[s]?function(o){return(r=!r)?{value:Fi(e[s](o)),done:!1}:n?n(o):o}:n}}function xf(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof tot=="function"?tot(e):e[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(n){r[n]=e[n]&&function(o){return new Promise(function(a,h){o=e[n](o),s(a,h,o.done,o.value)})}}function s(n,o,a,h){Promise.resolve(h).then(function(p){n({value:p,done:a})},o)}}var QL={};Ua(QL,{compareArrayLike:()=>GL,joinUint8Arrays:()=>xu,memcpy:()=>aS,rebaseValueOffsets:()=>UC,toArrayBufferView:()=>Ki,toArrayBufferViewAsyncIterator:()=>vf,toArrayBufferViewIterator:()=>Up,toBigInt64Array:()=>zC,toBigUint64Array:()=>c6t,toFloat32Array:()=>u6t,toFloat32ArrayAsyncIterator:()=>E6t,toFloat32ArrayIterator:()=>_6t,toFloat64Array:()=>h6t,toFloat64ArrayAsyncIterator:()=>I6t,toFloat64ArrayIterator:()=>y6t,toInt16Array:()=>o6t,toInt16ArrayAsyncIterator:()=>v6t,toInt16ArrayIterator:()=>d6t,toInt32Array:()=>x_,toInt32ArrayAsyncIterator:()=>w6t,toInt32ArrayIterator:()=>m6t,toInt8Array:()=>s6t,toInt8ArrayAsyncIterator:()=>b6t,toInt8ArrayIterator:()=>p6t,toUint16Array:()=>a6t,toUint16ArrayAsyncIterator:()=>T6t,toUint16ArrayIterator:()=>A6t,toUint32Array:()=>l6t,toUint32ArrayAsyncIterator:()=>S6t,toUint32ArrayIterator:()=>g6t,toUint8Array:()=>ii,toUint8ArrayAsyncIterator:()=>ZL,toUint8ArrayIterator:()=>XL,toUint8ClampedArray:()=>f6t,toUint8ClampedArrayAsyncIterator:()=>M6t,toUint8ClampedArrayIterator:()=>x6t});var e6t=new TextDecoder("utf-8"),sS=e=>e6t.decode(e),r6t=new TextEncoder,zp=e=>r6t.encode(e);var i6t=e=>typeof e=="number",rot=e=>typeof e=="boolean",na=e=>typeof e=="function",Jl=e=>e!=null&&Object(e)===e,yu=e=>Jl(e)&&na(e.then);var bf=e=>Jl(e)&&na(e[Symbol.iterator]),ph=e=>Jl(e)&&na(e[Symbol.asyncIterator]),DC=e=>Jl(e)&&Jl(e.schema);var OC=e=>Jl(e)&&"done"in e&&"value"in e;var BC=e=>Jl(e)&&na(e.stat)&&i6t(e.fd);var NC=e=>Jl(e)&&oS(e.body),LC=e=>"_getDOMStream"in e&&"_getNodeStream"in e,iot=e=>Jl(e)&&na(e.abort)&&na(e.getWriter)&&!LC(e),oS=e=>Jl(e)&&na(e.cancel)&&na(e.getReader)&&!LC(e),not=e=>Jl(e)&&na(e.end)&&na(e.write)&&rot(e.writable)&&!LC(e),FC=e=>Jl(e)&&na(e.read)&&na(e.pipe)&&rot(e.readable)&&!LC(e),sot=e=>Jl(e)&&na(e.clear)&&na(e.bytes)&&na(e.position)&&na(e.setPosition)&&na(e.capacity)&&na(e.getBufferIdentifier)&&na(e.createLong);var YL=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:ArrayBuffer;function n6t(e){let t=e[0]?[e[0]]:[],r,i,s,n;for(let o,a,h=0,p=0,g=e.length;++h<g;){if(o=t[p],a=e[h],!o||!a||o.buffer!==a.buffer||a.byteOffset<o.byteOffset){a&&(t[++p]=a);continue}if({byteOffset:r,byteLength:s}=o,{byteOffset:i,byteLength:n}=a,r+s<i||i+n<r){a&&(t[++p]=a);continue}t[p]=new Uint8Array(o.buffer,r,i-r+n)}return t}function aS(e,t,r=0,i=t.byteLength){let s=e.byteLength,n=new Uint8Array(e.buffer,e.byteOffset,s),o=new Uint8Array(t.buffer,t.byteOffset,Math.min(i,s));return n.set(o,r),e}function xu(e,t){let r=n6t(e),i=r.reduce((g,v)=>g+v.byteLength,0),s,n,o,a=0,h=-1,p=Math.min(t||Number.POSITIVE_INFINITY,i);for(let g=r.length;++h<g;){if(s=r[h],n=s.subarray(0,Math.min(s.length,p-a)),p<=a+n.length){n.length<s.length?r[h]=s.subarray(n.length):n.length===s.length&&h++,o?aS(o,n,a):o=n;break}aS(o||(o=new Uint8Array(p)),n,a),a+=n.length}return[o||new Uint8Array(0),r.slice(h),i-(o?o.byteLength:0)]}function Ki(e,t){let r=OC(t)?t.value:t;return r instanceof e?e===Uint8Array?new e(r.buffer,r.byteOffset,r.byteLength):r:r?(typeof r=="string"&&(r=zp(r)),r instanceof ArrayBuffer?new e(r):r instanceof YL?new e(r):sot(r)?Ki(e,r.bytes()):ArrayBuffer.isView(r)?r.byteLength<=0?new e(0):new e(r.buffer,r.byteOffset,r.byteLength/e.BYTES_PER_ELEMENT):e.from(r)):new e(0)}var s6t=e=>Ki(Int8Array,e),o6t=e=>Ki(Int16Array,e),x_=e=>Ki(Int32Array,e),zC=e=>Ki(BigInt64Array,e),ii=e=>Ki(Uint8Array,e),a6t=e=>Ki(Uint16Array,e),l6t=e=>Ki(Uint32Array,e),c6t=e=>Ki(BigUint64Array,e),u6t=e=>Ki(Float32Array,e),h6t=e=>Ki(Float64Array,e),f6t=e=>Ki(Uint8ClampedArray,e),qL=e=>(e.next(),e);function*Up(e,t){let r=function*(s){yield s},i=typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer||t instanceof YL?r(t):bf(t)?t:r(t);return yield*qL(function*(s){let n=null;do n=s.next(yield Ki(e,n));while(!n.done)}(i[Symbol.iterator]())),new e}var p6t=e=>Up(Int8Array,e),d6t=e=>Up(Int16Array,e),m6t=e=>Up(Int32Array,e),XL=e=>Up(Uint8Array,e),A6t=e=>Up(Uint16Array,e),g6t=e=>Up(Uint32Array,e),_6t=e=>Up(Float32Array,e),y6t=e=>Up(Float64Array,e),x6t=e=>Up(Uint8ClampedArray,e);function vf(e,t){return _u(this,arguments,function*(){if(yu(t))return yield Fi(yield Fi(yield*Bx(xf(vf(e,yield Fi(t))))));let i=function(o){return _u(this,arguments,function*(){yield yield Fi(yield Fi(o))})},s=function(o){return _u(this,arguments,function*(){yield Fi(yield*Bx(xf(qL(function*(a){let h=null;do h=a.next(yield h?.value);while(!h.done)}(o[Symbol.iterator]())))))})},n=typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer||t instanceof YL?i(t):bf(t)?s(t):ph(t)?t:i(t);return yield Fi(yield*Bx(xf(qL(function(o){return _u(this,arguments,function*(){let a=null;do a=yield Fi(o.next(yield yield Fi(Ki(e,a))));while(!a.done)})}(n[Symbol.asyncIterator]()))))),yield Fi(new e)})}var b6t=e=>vf(Int8Array,e),v6t=e=>vf(Int16Array,e),w6t=e=>vf(Int32Array,e),ZL=e=>vf(Uint8Array,e),T6t=e=>vf(Uint16Array,e),S6t=e=>vf(Uint32Array,e),E6t=e=>vf(Float32Array,e),I6t=e=>vf(Float64Array,e),M6t=e=>vf(Uint8ClampedArray,e);function UC(e,t,r){if(e!==0){r=r.slice(0,t);for(let i=-1,s=r.length;++i<s;)r[i]+=e}return r.subarray(0,t)}function GL(e,t){let r=0,i=e.length;if(i!==t.length)return!1;if(i>0)do if(e[r]!==t[r])return!1;while(++r<i);return!0}var Za={fromIterable(e){return VC(C6t(e))},fromAsyncIterable(e){return VC(P6t(e))},fromDOMStream(e){return VC(R6t(e))},fromNodeStream(e){return VC(k6t(e))},toDOMStream(e,t){throw new Error('"toDOMStream" not available in this environment')},toNodeStream(e,t){throw new Error('"toNodeStream" not available in this environment')}},VC=e=>(e.next(),e);function*C6t(e){let t,r=!1,i=[],s,n,o,a=0;function h(){return n==="peek"?xu(i,o)[0]:([s,i,a]=xu(i,o),s)}({cmd:n,size:o}=(yield null)||{cmd:"read",size:0});let p=XL(e)[Symbol.iterator]();try{do if({done:t,value:s}=Number.isNaN(o-a)?p.next():p.next(o-a),!t&&s.byteLength>0&&(i.push(s),a+=s.byteLength),t||o<=a)do({cmd:n,size:o}=yield h());while(o<a);while(!t)}catch(g){(r=!0)&&typeof p.throw=="function"&&p.throw(g)}finally{r===!1&&typeof p.return=="function"&&p.return(null)}return null}function P6t(e){return _u(this,arguments,function*(){let r,i=!1,s=[],n,o,a,h=0;function p(){return o==="peek"?xu(s,a)[0]:([n,s,h]=xu(s,a),n)}({cmd:o,size:a}=(yield yield Fi(null))||{cmd:"read",size:0});let g=ZL(e)[Symbol.asyncIterator]();try{do if({done:r,value:n}=Number.isNaN(a-h)?yield Fi(g.next()):yield Fi(g.next(a-h)),!r&&n.byteLength>0&&(s.push(n),h+=n.byteLength),r||a<=h)do({cmd:o,size:a}=yield yield Fi(p()));while(a<h);while(!r)}catch(v){(i=!0)&&typeof g.throw=="function"&&(yield Fi(g.throw(v)))}finally{i===!1&&typeof g.return=="function"&&(yield Fi(g.return(new Uint8Array(0))))}return yield Fi(null)})}function R6t(e){return _u(this,arguments,function*(){let r=!1,i=!1,s=[],n,o,a,h=0;function p(){return o==="peek"?xu(s,a)[0]:([n,s,h]=xu(s,a),n)}({cmd:o,size:a}=(yield yield Fi(null))||{cmd:"read",size:0});let g=new JL(e);try{do if({done:r,value:n}=Number.isNaN(a-h)?yield Fi(g.read()):yield Fi(g.read(a-h)),!r&&n.byteLength>0&&(s.push(ii(n)),h+=n.byteLength),r||a<=h)do({cmd:o,size:a}=yield yield Fi(p()));while(a<h);while(!r)}catch(v){(i=!0)&&(yield Fi(g.cancel(v)))}finally{i===!1?yield Fi(g.cancel()):e.locked&&g.releaseLock()}return yield Fi(null)})}var JL=class{constructor(t){this.source=t,this.reader=null,this.reader=this.source.getReader(),this.reader.closed.catch(()=>{})}get closed(){return this.reader?this.reader.closed.catch(()=>{}):Promise.resolve()}releaseLock(){this.reader&&this.reader.releaseLock(),this.reader=null}cancel(t){return _r(this,void 0,void 0,function*(){let{reader:r,source:i}=this;r&&(yield r.cancel(t).catch(()=>{})),i&&i.locked&&this.releaseLock()})}read(t){return _r(this,void 0,void 0,function*(){if(t===0)return{done:this.reader==null,value:new Uint8Array(0)};let r=yield this.reader.read();return!r.done&&(r.value=ii(r)),r})}},KL=(e,t)=>{let r=s=>i([t,s]),i;return[t,r,new Promise(s=>(i=s)&&e.once(t,r))]};function k6t(e){return _u(this,arguments,function*(){let r=[],i="error",s=!1,n=null,o,a,h=0,p=[],g;function v(){return o==="peek"?xu(p,a)[0]:([g,p,h]=xu(p,a),g)}if({cmd:o,size:a}=(yield yield Fi(null))||{cmd:"read",size:0},e.isTTY)return yield yield Fi(new Uint8Array(0)),yield Fi(null);try{r[0]=KL(e,"end"),r[1]=KL(e,"error");do{if(r[2]=KL(e,"readable"),[i,n]=yield Fi(Promise.race(r.map(C=>C[2]))),i==="error")break;if((s=i==="end")||(Number.isFinite(a-h)?(g=ii(e.read(a-h)),g.byteLength<a-h&&(g=ii(e.read()))):g=ii(e.read()),g.byteLength>0&&(p.push(g),h+=g.byteLength)),s||a<=h)do({cmd:o,size:a}=yield yield Fi(v()));while(a<h)}while(!s)}finally{yield Fi(T(r,i==="error"?n:null))}return yield Fi(null);function T(C,B){return g=p=null,new Promise((L,z)=>{for(let[W,Z]of C)e.off(W,Z);try{let W=e.destroy;W&&W.call(e,B),B=void 0}catch(W){B=W||B}finally{B!=null?z(B):L()}})}})}var Wn;(function(e){e[e.V1=0]="V1",e[e.V2=1]="V2",e[e.V3=2]="V3",e[e.V4=3]="V4",e[e.V5=4]="V5"})(Wn||(Wn={}));var us;(function(e){e[e.Sparse=0]="Sparse",e[e.Dense=1]="Dense"})(us||(us={}));var rs;(function(e){e[e.HALF=0]="HALF",e[e.SINGLE=1]="SINGLE",e[e.DOUBLE=2]="DOUBLE"})(rs||(rs={}));var io;(function(e){e[e.DAY=0]="DAY",e[e.MILLISECOND=1]="MILLISECOND"})(io||(io={}));var Tr;(function(e){e[e.SECOND=0]="SECOND",e[e.MILLISECOND=1]="MILLISECOND",e[e.MICROSECOND=2]="MICROSECOND",e[e.NANOSECOND=3]="NANOSECOND"})(Tr||(Tr={}));var Lo;(function(e){e[e.YEAR_MONTH=0]="YEAR_MONTH",e[e.DAY_TIME=1]="DAY_TIME",e[e.MONTH_DAY_NANO=2]="MONTH_DAY_NANO"})(Lo||(Lo={}));var Vp=new Int32Array(2),jC=new Float32Array(Vp.buffer),WC=new Float64Array(Vp.buffer),Nx=new Uint16Array(new Uint8Array([1,0]).buffer)[0]===1;var lS;(function(e){e[e.UTF8_BYTES=1]="UTF8_BYTES",e[e.UTF16_STRING=2]="UTF16_STRING"})(lS||(lS={}));var bu=class e{constructor(t){this.bytes_=t,this.position_=0,this.text_decoder_=new TextDecoder}static allocate(t){return new e(new Uint8Array(t))}clear(){this.position_=0}bytes(){return this.bytes_}position(){return this.position_}setPosition(t){this.position_=t}capacity(){return this.bytes_.length}readInt8(t){return this.readUint8(t)<<24>>24}readUint8(t){return this.bytes_[t]}readInt16(t){return this.readUint16(t)<<16>>16}readUint16(t){return this.bytes_[t]|this.bytes_[t+1]<<8}readInt32(t){return this.bytes_[t]|this.bytes_[t+1]<<8|this.bytes_[t+2]<<16|this.bytes_[t+3]<<24}readUint32(t){return this.readInt32(t)>>>0}readInt64(t){return BigInt.asIntN(64,BigInt(this.readUint32(t))+(BigInt(this.readUint32(t+4))<<BigInt(32)))}readUint64(t){return BigInt.asUintN(64,BigInt(this.readUint32(t))+(BigInt(this.readUint32(t+4))<<BigInt(32)))}readFloat32(t){return Vp[0]=this.readInt32(t),jC[0]}readFloat64(t){return Vp[Nx?0:1]=this.readInt32(t),Vp[Nx?1:0]=this.readInt32(t+4),WC[0]}writeInt8(t,r){this.bytes_[t]=r}writeUint8(t,r){this.bytes_[t]=r}writeInt16(t,r){this.bytes_[t]=r,this.bytes_[t+1]=r>>8}writeUint16(t,r){this.bytes_[t]=r,this.bytes_[t+1]=r>>8}writeInt32(t,r){this.bytes_[t]=r,this.bytes_[t+1]=r>>8,this.bytes_[t+2]=r>>16,this.bytes_[t+3]=r>>24}writeUint32(t,r){this.bytes_[t]=r,this.bytes_[t+1]=r>>8,this.bytes_[t+2]=r>>16,this.bytes_[t+3]=r>>24}writeInt64(t,r){this.writeInt32(t,Number(BigInt.asIntN(32,r))),this.writeInt32(t+4,Number(BigInt.asIntN(32,r>>BigInt(32))))}writeUint64(t,r){this.writeUint32(t,Number(BigInt.asUintN(32,r))),this.writeUint32(t+4,Number(BigInt.asUintN(32,r>>BigInt(32))))}writeFloat32(t,r){jC[0]=r,this.writeInt32(t,Vp[0])}writeFloat64(t,r){WC[0]=r,this.writeInt32(t,Vp[Nx?0:1]),this.writeInt32(t+4,Vp[Nx?1:0])}getBufferIdentifier(){if(this.bytes_.length<this.position_+4+4)throw new Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");let t="";for(let r=0;r<4;r++)t+=String.fromCharCode(this.readInt8(this.position_+4+r));return t}__offset(t,r){let i=t-this.readInt32(t);return r<this.readInt16(i)?this.readInt16(i+r):0}__union(t,r){return t.bb_pos=r+this.readInt32(r),t.bb=this,t}__string(t,r){t+=this.readInt32(t);let i=this.readInt32(t);t+=4;let s=this.bytes_.subarray(t,t+i);return r===lS.UTF8_BYTES?s:this.text_decoder_.decode(s)}__union_with_string(t,r){return typeof t=="string"?this.__string(r):this.__union(t,r)}__indirect(t){return t+this.readInt32(t)}__vector(t){return t+this.readInt32(t)+4}__vector_len(t){return this.readInt32(t+this.readInt32(t))}__has_identifier(t){if(t.length!=4)throw new Error("FlatBuffers: file identifier must be length "+4);for(let r=0;r<4;r++)if(t.charCodeAt(r)!=this.readInt8(this.position()+4+r))return!1;return!0}createScalarList(t,r){let i=[];for(let s=0;s<r;++s){let n=t(s);n!==null&&i.push(n)}return i}createObjList(t,r){let i=[];for(let s=0;s<r;++s){let n=t(s);n!==null&&i.push(n.unpack())}return i}};var b_=class e{constructor(t){this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null,this.text_encoder=new TextEncoder;let r;t?r=t:r=1024,this.bb=bu.allocate(r),this.space=r}clear(){this.bb.clear(),this.space=this.bb.capacity(),this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null}forceDefaults(t){this.force_defaults=t}dataBuffer(){return this.bb}asUint8Array(){return this.bb.bytes().subarray(this.bb.position(),this.bb.position()+this.offset())}prep(t,r){t>this.minalign&&(this.minalign=t);let i=~(this.bb.capacity()-this.space+r)+1&t-1;for(;this.space<i+t+r;){let s=this.bb.capacity();this.bb=e.growByteBuffer(this.bb),this.space+=this.bb.capacity()-s}this.pad(i)}pad(t){for(let r=0;r<t;r++)this.bb.writeInt8(--this.space,0)}writeInt8(t){this.bb.writeInt8(this.space-=1,t)}writeInt16(t){this.bb.writeInt16(this.space-=2,t)}writeInt32(t){this.bb.writeInt32(this.space-=4,t)}writeInt64(t){this.bb.writeInt64(this.space-=8,t)}writeFloat32(t){this.bb.writeFloat32(this.space-=4,t)}writeFloat64(t){this.bb.writeFloat64(this.space-=8,t)}addInt8(t){this.prep(1,0),this.writeInt8(t)}addInt16(t){this.prep(2,0),this.writeInt16(t)}addInt32(t){this.prep(4,0),this.writeInt32(t)}addInt64(t){this.prep(8,0),this.writeInt64(t)}addFloat32(t){this.prep(4,0),this.writeFloat32(t)}addFloat64(t){this.prep(8,0),this.writeFloat64(t)}addFieldInt8(t,r,i){(this.force_defaults||r!=i)&&(this.addInt8(r),this.slot(t))}addFieldInt16(t,r,i){(this.force_defaults||r!=i)&&(this.addInt16(r),this.slot(t))}addFieldInt32(t,r,i){(this.force_defaults||r!=i)&&(this.addInt32(r),this.slot(t))}addFieldInt64(t,r,i){(this.force_defaults||r!==i)&&(this.addInt64(r),this.slot(t))}addFieldFloat32(t,r,i){(this.force_defaults||r!=i)&&(this.addFloat32(r),this.slot(t))}addFieldFloat64(t,r,i){(this.force_defaults||r!=i)&&(this.addFloat64(r),this.slot(t))}addFieldOffset(t,r,i){(this.force_defaults||r!=i)&&(this.addOffset(r),this.slot(t))}addFieldStruct(t,r,i){r!=i&&(this.nested(r),this.slot(t))}nested(t){if(t!=this.offset())throw new TypeError("FlatBuffers: struct must be serialized inline.")}notNested(){if(this.isNested)throw new TypeError("FlatBuffers: object serialization must not be nested.")}slot(t){this.vtable!==null&&(this.vtable[t]=this.offset())}offset(){return this.bb.capacity()-this.space}static growByteBuffer(t){let r=t.capacity();if(r&3221225472)throw new Error("FlatBuffers: cannot grow buffer beyond 2 gigabytes.");let i=r<<1,s=bu.allocate(i);return s.setPosition(i-r),s.bytes().set(t.bytes(),i-r),s}addOffset(t){this.prep(4,0),this.writeInt32(this.offset()-t+4)}startObject(t){this.notNested(),this.vtable==null&&(this.vtable=[]),this.vtable_in_use=t;for(let r=0;r<t;r++)this.vtable[r]=0;this.isNested=!0,this.object_start=this.offset()}endObject(){if(this.vtable==null||!this.isNested)throw new Error("FlatBuffers: endObject called without startObject");this.addInt32(0);let t=this.offset(),r=this.vtable_in_use-1;for(;r>=0&&this.vtable[r]==0;r--);let i=r+1;for(;r>=0;r--)this.addInt16(this.vtable[r]!=0?t-this.vtable[r]:0);let s=2;this.addInt16(t-this.object_start);let n=(i+s)*2;this.addInt16(n);let o=0,a=this.space;t:for(r=0;r<this.vtables.length;r++){let h=this.bb.capacity()-this.vtables[r];if(n==this.bb.readInt16(h)){for(let p=2;p<n;p+=2)if(this.bb.readInt16(a+p)!=this.bb.readInt16(h+p))continue t;o=this.vtables[r];break}}return o?(this.space=this.bb.capacity()-t,this.bb.writeInt32(this.space,o-t)):(this.vtables.push(this.offset()),this.bb.writeInt32(this.bb.capacity()-t,this.offset()-t)),this.isNested=!1,t}finish(t,r,i){let s=i?4:0;if(r){let n=r;if(this.prep(this.minalign,8+s),n.length!=4)throw new TypeError("FlatBuffers: file identifier must be length "+4);for(let o=3;o>=0;o--)this.writeInt8(n.charCodeAt(o))}this.prep(this.minalign,4+s),this.addOffset(t),s&&this.addInt32(this.bb.capacity()-this.space),this.bb.setPosition(this.space)}finishSizePrefixed(t,r){this.finish(t,r,!0)}requiredField(t,r){let i=this.bb.capacity()-t,s=i-this.bb.readInt32(i);if(!(r<this.bb.readInt16(s)&&this.bb.readInt16(s+r)!=0))throw new TypeError("FlatBuffers: field "+r+" must be set")}startVector(t,r,i){this.notNested(),this.vector_num_elems=r,this.prep(4,t*r),this.prep(i,t*r)}endVector(){return this.writeInt32(this.vector_num_elems),this.offset()}createSharedString(t){if(!t)return 0;if(this.string_maps||(this.string_maps=new Map),this.string_maps.has(t))return this.string_maps.get(t);let r=this.createString(t);return this.string_maps.set(t,r),r}createString(t){if(t==null)return 0;let r;t instanceof Uint8Array?r=t:r=this.text_encoder.encode(t),this.addInt8(0),this.startVector(1,r.length,1),this.bb.setPosition(this.space-=r.length);for(let i=0,s=this.space,n=this.bb.bytes();i<r.length;i++)n[s++]=r[i];return this.endVector()}createObjectOffset(t){return t===null?0:typeof t=="string"?this.createString(t):t.pack(this)}createObjectOffsetList(t){let r=[];for(let i=0;i<t.length;++i){let s=t[i];if(s!==null)r.push(this.createObjectOffset(s));else throw new TypeError("FlatBuffers: Argument for createObjectOffsetList cannot contain null.")}return r}createStructOffsetList(t,r){return r(this,t.length),this.createObjectOffsetList(t.slice().reverse()),this.endVector()}};var cS;(function(e){e[e.BUFFER=0]="BUFFER"})(cS||(cS={}));var uS;(function(e){e[e.LZ4_FRAME=0]="LZ4_FRAME",e[e.ZSTD=1]="ZSTD"})(uS||(uS={}));var HC=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsBodyCompression(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsBodyCompression(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}codec(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt8(this.bb_pos+t):uS.LZ4_FRAME}method(){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt8(this.bb_pos+t):cS.BUFFER}static startBodyCompression(t){t.startObject(2)}static addCodec(t,r){t.addFieldInt8(0,r,uS.LZ4_FRAME)}static addMethod(t,r){t.addFieldInt8(1,r,cS.BUFFER)}static endBodyCompression(t){return t.endObject()}static createBodyCompression(t,r,i){return e.startBodyCompression(t),e.addCodec(t,r),e.addMethod(t,i),e.endBodyCompression(t)}};var Lx=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}offset(){return this.bb.readInt64(this.bb_pos)}length(){return this.bb.readInt64(this.bb_pos+8)}static sizeOf(){return 16}static createBuffer(t,r,i){return t.prep(8,16),t.writeInt64(BigInt(i??0)),t.writeInt64(BigInt(r??0)),t.offset()}};var Fx=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}length(){return this.bb.readInt64(this.bb_pos)}nullCount(){return this.bb.readInt64(this.bb_pos+8)}static sizeOf(){return 16}static createFieldNode(t,r,i){return t.prep(8,16),t.writeInt64(BigInt(i??0)),t.writeInt64(BigInt(r??0)),t.offset()}};var vu=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsRecordBatch(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsRecordBatch(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}length(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt64(this.bb_pos+t):BigInt("0")}nodes(t,r){let i=this.bb.__offset(this.bb_pos,6);return i?(r||new Fx).__init(this.bb.__vector(this.bb_pos+i)+t*16,this.bb):null}nodesLength(){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}buffers(t,r){let i=this.bb.__offset(this.bb_pos,8);return i?(r||new Lx).__init(this.bb.__vector(this.bb_pos+i)+t*16,this.bb):null}buffersLength(){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}compression(t){let r=this.bb.__offset(this.bb_pos,10);return r?(t||new HC).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}static startRecordBatch(t){t.startObject(4)}static addLength(t,r){t.addFieldInt64(0,r,BigInt("0"))}static addNodes(t,r){t.addFieldOffset(1,r,0)}static startNodesVector(t,r){t.startVector(16,r,8)}static addBuffers(t,r){t.addFieldOffset(2,r,0)}static startBuffersVector(t,r){t.startVector(16,r,8)}static addCompression(t,r){t.addFieldOffset(3,r,0)}static endRecordBatch(t){return t.endObject()}};var y0=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsDictionaryBatch(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDictionaryBatch(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}id(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt64(this.bb_pos+t):BigInt("0")}data(t){let r=this.bb.__offset(this.bb_pos,6);return r?(t||new vu).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}isDelta(){let t=this.bb.__offset(this.bb_pos,8);return t?!!this.bb.readInt8(this.bb_pos+t):!1}static startDictionaryBatch(t){t.startObject(3)}static addId(t,r){t.addFieldInt64(0,r,BigInt("0"))}static addData(t,r){t.addFieldOffset(1,r,0)}static addIsDelta(t,r){t.addFieldInt8(2,+r,0)}static endDictionaryBatch(t){return t.endObject()}};var TA;(function(e){e[e.Little=0]="Little",e[e.Big=1]="Big"})(TA||(TA={}));var hS;(function(e){e[e.DenseArray=0]="DenseArray"})(hS||(hS={}));var Tf=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsInt(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsInt(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}bitWidth(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}isSigned(){let t=this.bb.__offset(this.bb_pos,6);return t?!!this.bb.readInt8(this.bb_pos+t):!1}static startInt(t){t.startObject(2)}static addBitWidth(t,r){t.addFieldInt32(0,r,0)}static addIsSigned(t,r){t.addFieldInt8(1,+r,0)}static endInt(t){return t.endObject()}static createInt(t,r,i){return e.startInt(t),e.addBitWidth(t,r),e.addIsSigned(t,i),e.endInt(t)}};var jp=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsDictionaryEncoding(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDictionaryEncoding(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}id(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt64(this.bb_pos+t):BigInt("0")}indexType(t){let r=this.bb.__offset(this.bb_pos,6);return r?(t||new Tf).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}isOrdered(){let t=this.bb.__offset(this.bb_pos,8);return t?!!this.bb.readInt8(this.bb_pos+t):!1}dictionaryKind(){let t=this.bb.__offset(this.bb_pos,10);return t?this.bb.readInt16(this.bb_pos+t):hS.DenseArray}static startDictionaryEncoding(t){t.startObject(4)}static addId(t,r){t.addFieldInt64(0,r,BigInt("0"))}static addIndexType(t,r){t.addFieldOffset(1,r,0)}static addIsOrdered(t,r){t.addFieldInt8(2,+r,0)}static addDictionaryKind(t,r){t.addFieldInt16(3,r,hS.DenseArray)}static endDictionaryEncoding(t){return t.endObject()}};var sa=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsKeyValue(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsKeyValue(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}key(t){let r=this.bb.__offset(this.bb_pos,4);return r?this.bb.__string(this.bb_pos+r,t):null}value(t){let r=this.bb.__offset(this.bb_pos,6);return r?this.bb.__string(this.bb_pos+r,t):null}static startKeyValue(t){t.startObject(2)}static addKey(t,r){t.addFieldOffset(0,r,0)}static addValue(t,r){t.addFieldOffset(1,r,0)}static endKeyValue(t){return t.endObject()}static createKeyValue(t,r,i){return e.startKeyValue(t),e.addKey(t,r),e.addValue(t,i),e.endKeyValue(t)}};var fS=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsBinary(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsBinary(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static startBinary(t){t.startObject(0)}static endBinary(t){return t.endObject()}static createBinary(t){return e.startBinary(t),e.endBinary(t)}};var pS=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsBool(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsBool(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static startBool(t){t.startObject(0)}static endBool(t){return t.endObject()}static createBool(t){return e.startBool(t),e.endBool(t)}};var SA=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsDate(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDate(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}unit(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):io.MILLISECOND}static startDate(t){t.startObject(1)}static addUnit(t,r){t.addFieldInt16(0,r,io.MILLISECOND)}static endDate(t){return t.endObject()}static createDate(t,r){return e.startDate(t),e.addUnit(t,r),e.endDate(t)}};var Wp=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsDecimal(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDecimal(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}precision(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}scale(){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt32(this.bb_pos+t):0}bitWidth(){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readInt32(this.bb_pos+t):128}static startDecimal(t){t.startObject(3)}static addPrecision(t,r){t.addFieldInt32(0,r,0)}static addScale(t,r){t.addFieldInt32(1,r,0)}static addBitWidth(t,r){t.addFieldInt32(2,r,128)}static endDecimal(t){return t.endObject()}static createDecimal(t,r,i,s){return e.startDecimal(t),e.addPrecision(t,r),e.addScale(t,i),e.addBitWidth(t,s),e.endDecimal(t)}};var EA=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsDuration(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDuration(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}unit(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Tr.MILLISECOND}static startDuration(t){t.startObject(1)}static addUnit(t,r){t.addFieldInt16(0,r,Tr.MILLISECOND)}static endDuration(t){return t.endObject()}static createDuration(t,r){return e.startDuration(t),e.addUnit(t,r),e.endDuration(t)}};var IA=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsFixedSizeBinary(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFixedSizeBinary(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}byteWidth(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}static startFixedSizeBinary(t){t.startObject(1)}static addByteWidth(t,r){t.addFieldInt32(0,r,0)}static endFixedSizeBinary(t){return t.endObject()}static createFixedSizeBinary(t,r){return e.startFixedSizeBinary(t),e.addByteWidth(t,r),e.endFixedSizeBinary(t)}};var MA=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsFixedSizeList(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFixedSizeList(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}listSize(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}static startFixedSizeList(t){t.startObject(1)}static addListSize(t,r){t.addFieldInt32(0,r,0)}static endFixedSizeList(t){return t.endObject()}static createFixedSizeList(t,r){return e.startFixedSizeList(t),e.addListSize(t,r),e.endFixedSizeList(t)}};var CA=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsFloatingPoint(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFloatingPoint(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}precision(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):rs.HALF}static startFloatingPoint(t){t.startObject(1)}static addPrecision(t,r){t.addFieldInt16(0,r,rs.HALF)}static endFloatingPoint(t){return t.endObject()}static createFloatingPoint(t,r){return e.startFloatingPoint(t),e.addPrecision(t,r),e.endFloatingPoint(t)}};var PA=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsInterval(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsInterval(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}unit(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Lo.YEAR_MONTH}static startInterval(t){t.startObject(1)}static addUnit(t,r){t.addFieldInt16(0,r,Lo.YEAR_MONTH)}static endInterval(t){return t.endObject()}static createInterval(t,r){return e.startInterval(t),e.addUnit(t,r),e.endInterval(t)}};var dS=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsLargeBinary(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsLargeBinary(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static startLargeBinary(t){t.startObject(0)}static endLargeBinary(t){return t.endObject()}static createLargeBinary(t){return e.startLargeBinary(t),e.endLargeBinary(t)}};var mS=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsLargeUtf8(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsLargeUtf8(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static startLargeUtf8(t){t.startObject(0)}static endLargeUtf8(t){return t.endObject()}static createLargeUtf8(t){return e.startLargeUtf8(t),e.endLargeUtf8(t)}};var AS=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsList(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsList(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static startList(t){t.startObject(0)}static endList(t){return t.endObject()}static createList(t){return e.startList(t),e.endList(t)}};var RA=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsMap(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsMap(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}keysSorted(){let t=this.bb.__offset(this.bb_pos,4);return t?!!this.bb.readInt8(this.bb_pos+t):!1}static startMap(t){t.startObject(1)}static addKeysSorted(t,r){t.addFieldInt8(0,+r,0)}static endMap(t){return t.endObject()}static createMap(t,r){return e.startMap(t),e.addKeysSorted(t,r),e.endMap(t)}};var gS=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsNull(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsNull(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static startNull(t){t.startObject(0)}static endNull(t){return t.endObject()}static createNull(t){return e.startNull(t),e.endNull(t)}};var _S=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsStruct_(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsStruct_(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static startStruct_(t){t.startObject(0)}static endStruct_(t){return t.endObject()}static createStruct_(t){return e.startStruct_(t),e.endStruct_(t)}};var x0=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsTime(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsTime(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}unit(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Tr.MILLISECOND}bitWidth(){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt32(this.bb_pos+t):32}static startTime(t){t.startObject(2)}static addUnit(t,r){t.addFieldInt16(0,r,Tr.MILLISECOND)}static addBitWidth(t,r){t.addFieldInt32(1,r,32)}static endTime(t){return t.endObject()}static createTime(t,r,i){return e.startTime(t),e.addUnit(t,r),e.addBitWidth(t,i),e.endTime(t)}};var b0=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsTimestamp(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsTimestamp(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}unit(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Tr.SECOND}timezone(t){let r=this.bb.__offset(this.bb_pos,6);return r?this.bb.__string(this.bb_pos+r,t):null}static startTimestamp(t){t.startObject(2)}static addUnit(t,r){t.addFieldInt16(0,r,Tr.SECOND)}static addTimezone(t,r){t.addFieldOffset(1,r,0)}static endTimestamp(t){return t.endObject()}static createTimestamp(t,r,i){return e.startTimestamp(t),e.addUnit(t,r),e.addTimezone(t,i),e.endTimestamp(t)}};var Sf=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsUnion(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsUnion(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}mode(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):us.Sparse}typeIds(t){let r=this.bb.__offset(this.bb_pos,6);return r?this.bb.readInt32(this.bb.__vector(this.bb_pos+r)+t*4):0}typeIdsLength(){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}typeIdsArray(){let t=this.bb.__offset(this.bb_pos,6);return t?new Int32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}static startUnion(t){t.startObject(2)}static addMode(t,r){t.addFieldInt16(0,r,us.Sparse)}static addTypeIds(t,r){t.addFieldOffset(1,r,0)}static createTypeIdsVector(t,r){t.startVector(4,r.length,4);for(let i=r.length-1;i>=0;i--)t.addInt32(r[i]);return t.endVector()}static startTypeIdsVector(t,r){t.startVector(4,r,4)}static endUnion(t){return t.endObject()}static createUnion(t,r,i){return e.startUnion(t),e.addMode(t,r),e.addTypeIds(t,i),e.endUnion(t)}};var yS=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsUtf8(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsUtf8(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static startUtf8(t){t.startObject(0)}static endUtf8(t){return t.endObject()}static createUtf8(t){return e.startUtf8(t),e.endUtf8(t)}};var hs;(function(e){e[e.NONE=0]="NONE",e[e.Null=1]="Null",e[e.Int=2]="Int",e[e.FloatingPoint=3]="FloatingPoint",e[e.Binary=4]="Binary",e[e.Utf8=5]="Utf8",e[e.Bool=6]="Bool",e[e.Decimal=7]="Decimal",e[e.Date=8]="Date",e[e.Time=9]="Time",e[e.Timestamp=10]="Timestamp",e[e.Interval=11]="Interval",e[e.List=12]="List",e[e.Struct_=13]="Struct_",e[e.Union=14]="Union",e[e.FixedSizeBinary=15]="FixedSizeBinary",e[e.FixedSizeList=16]="FixedSizeList",e[e.Map=17]="Map",e[e.Duration=18]="Duration",e[e.LargeBinary=19]="LargeBinary",e[e.LargeUtf8=20]="LargeUtf8",e[e.LargeList=21]="LargeList",e[e.RunEndEncoded=22]="RunEndEncoded"})(hs||(hs={}));var Il=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsField(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsField(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}name(t){let r=this.bb.__offset(this.bb_pos,4);return r?this.bb.__string(this.bb_pos+r,t):null}nullable(){let t=this.bb.__offset(this.bb_pos,6);return t?!!this.bb.readInt8(this.bb_pos+t):!1}typeType(){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readUint8(this.bb_pos+t):hs.NONE}type(t){let r=this.bb.__offset(this.bb_pos,10);return r?this.bb.__union(t,this.bb_pos+r):null}dictionary(t){let r=this.bb.__offset(this.bb_pos,12);return r?(t||new jp).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}children(t,r){let i=this.bb.__offset(this.bb_pos,14);return i?(r||new e).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+t*4),this.bb):null}childrenLength(){let t=this.bb.__offset(this.bb_pos,14);return t?this.bb.__vector_len(this.bb_pos+t):0}customMetadata(t,r){let i=this.bb.__offset(this.bb_pos,16);return i?(r||new sa).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+t*4),this.bb):null}customMetadataLength(){let t=this.bb.__offset(this.bb_pos,16);return t?this.bb.__vector_len(this.bb_pos+t):0}static startField(t){t.startObject(7)}static addName(t,r){t.addFieldOffset(0,r,0)}static addNullable(t,r){t.addFieldInt8(1,+r,0)}static addTypeType(t,r){t.addFieldInt8(2,r,hs.NONE)}static addType(t,r){t.addFieldOffset(3,r,0)}static addDictionary(t,r){t.addFieldOffset(4,r,0)}static addChildren(t,r){t.addFieldOffset(5,r,0)}static createChildrenVector(t,r){t.startVector(4,r.length,4);for(let i=r.length-1;i>=0;i--)t.addOffset(r[i]);return t.endVector()}static startChildrenVector(t,r){t.startVector(4,r,4)}static addCustomMetadata(t,r){t.addFieldOffset(6,r,0)}static createCustomMetadataVector(t,r){t.startVector(4,r.length,4);for(let i=r.length-1;i>=0;i--)t.addOffset(r[i]);return t.endVector()}static startCustomMetadataVector(t,r){t.startVector(4,r,4)}static endField(t){return t.endObject()}};var Nc=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsSchema(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsSchema(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}endianness(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):TA.Little}fields(t,r){let i=this.bb.__offset(this.bb_pos,6);return i?(r||new Il).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+t*4),this.bb):null}fieldsLength(){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}customMetadata(t,r){let i=this.bb.__offset(this.bb_pos,8);return i?(r||new sa).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+t*4),this.bb):null}customMetadataLength(){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}features(t){let r=this.bb.__offset(this.bb_pos,10);return r?this.bb.readInt64(this.bb.__vector(this.bb_pos+r)+t*8):BigInt(0)}featuresLength(){let t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__vector_len(this.bb_pos+t):0}static startSchema(t){t.startObject(4)}static addEndianness(t,r){t.addFieldInt16(0,r,TA.Little)}static addFields(t,r){t.addFieldOffset(1,r,0)}static createFieldsVector(t,r){t.startVector(4,r.length,4);for(let i=r.length-1;i>=0;i--)t.addOffset(r[i]);return t.endVector()}static startFieldsVector(t,r){t.startVector(4,r,4)}static addCustomMetadata(t,r){t.addFieldOffset(2,r,0)}static createCustomMetadataVector(t,r){t.startVector(4,r.length,4);for(let i=r.length-1;i>=0;i--)t.addOffset(r[i]);return t.endVector()}static startCustomMetadataVector(t,r){t.startVector(4,r,4)}static addFeatures(t,r){t.addFieldOffset(3,r,0)}static createFeaturesVector(t,r){t.startVector(8,r.length,8);for(let i=r.length-1;i>=0;i--)t.addInt64(r[i]);return t.endVector()}static startFeaturesVector(t,r){t.startVector(8,r,8)}static endSchema(t){return t.endObject()}static finishSchemaBuffer(t,r){t.finish(r)}static finishSizePrefixedSchemaBuffer(t,r){t.finish(r,void 0,!0)}static createSchema(t,r,i,s,n){return e.startSchema(t),e.addEndianness(t,r),e.addFields(t,i),e.addCustomMetadata(t,s),e.addFeatures(t,n),e.endSchema(t)}};var sn;(function(e){e[e.NONE=0]="NONE",e[e.Schema=1]="Schema",e[e.DictionaryBatch=2]="DictionaryBatch",e[e.RecordBatch=3]="RecordBatch",e[e.Tensor=4]="Tensor",e[e.SparseTensor=5]="SparseTensor"})(sn||(sn={}));var Lt;(function(e){e[e.NONE=0]="NONE",e[e.Null=1]="Null",e[e.Int=2]="Int",e[e.Float=3]="Float",e[e.Binary=4]="Binary",e[e.Utf8=5]="Utf8",e[e.Bool=6]="Bool",e[e.Decimal=7]="Decimal",e[e.Date=8]="Date",e[e.Time=9]="Time",e[e.Timestamp=10]="Timestamp",e[e.Interval=11]="Interval",e[e.List=12]="List",e[e.Struct=13]="Struct",e[e.Union=14]="Union",e[e.FixedSizeBinary=15]="FixedSizeBinary",e[e.FixedSizeList=16]="FixedSizeList",e[e.Map=17]="Map",e[e.Duration=18]="Duration",e[e.LargeBinary=19]="LargeBinary",e[e.LargeUtf8=20]="LargeUtf8",e[e.Dictionary=-1]="Dictionary",e[e.Int8=-2]="Int8",e[e.Int16=-3]="Int16",e[e.Int32=-4]="Int32",e[e.Int64=-5]="Int64",e[e.Uint8=-6]="Uint8",e[e.Uint16=-7]="Uint16",e[e.Uint32=-8]="Uint32",e[e.Uint64=-9]="Uint64",e[e.Float16=-10]="Float16",e[e.Float32=-11]="Float32",e[e.Float64=-12]="Float64",e[e.DateDay=-13]="DateDay",e[e.DateMillisecond=-14]="DateMillisecond",e[e.TimestampSecond=-15]="TimestampSecond",e[e.TimestampMillisecond=-16]="TimestampMillisecond",e[e.TimestampMicrosecond=-17]="TimestampMicrosecond",e[e.TimestampNanosecond=-18]="TimestampNanosecond",e[e.TimeSecond=-19]="TimeSecond",e[e.TimeMillisecond=-20]="TimeMillisecond",e[e.TimeMicrosecond=-21]="TimeMicrosecond",e[e.TimeNanosecond=-22]="TimeNanosecond",e[e.DenseUnion=-23]="DenseUnion",e[e.SparseUnion=-24]="SparseUnion",e[e.IntervalDayTime=-25]="IntervalDayTime",e[e.IntervalYearMonth=-26]="IntervalYearMonth",e[e.DurationSecond=-27]="DurationSecond",e[e.DurationMillisecond=-28]="DurationMillisecond",e[e.DurationMicrosecond=-29]="DurationMicrosecond",e[e.DurationNanosecond=-30]="DurationNanosecond"})(Lt||(Lt={}));var mh;(function(e){e[e.OFFSET=0]="OFFSET",e[e.DATA=1]="DATA",e[e.VALIDITY=2]="VALIDITY",e[e.TYPE=3]="TYPE"})(mh||(mh={}));var _F={};Ua(_F,{clampIndex:()=>yIt,clampRange:()=>wS,createElementComparator:()=>OA});var tF={};Ua(tF,{valueToString:()=>Ef});function Ef(e){if(e===null)return"null";if(e===void 0)return"undefined";switch(typeof e){case"number":return`${e}`;case"bigint":return`${e}`;case"string":return`"${e}"`}return typeof e[Symbol.toPrimitive]=="function"?e[Symbol.toPrimitive]("string"):ArrayBuffer.isView(e)?e instanceof BigInt64Array||e instanceof BigUint64Array?`[${[...e].map(t=>Ef(t))}]`:`[${e}]`:ArrayBuffer.isView(e)?`[${e}]`:JSON.stringify(e,(t,r)=>typeof r=="bigint"?`${r}`:r)}var rF={};Ua(rF,{BN:()=>bS,bigNumToBigInt:()=>lot,bigNumToString:()=>Vx,isArrowBigNumSymbol:()=>oot});var oot=Symbol.for("isArrowBigNum");function If(e,...t){return t.length===0?Object.setPrototypeOf(Ki(this.TypedArray,e),this.constructor.prototype):Object.setPrototypeOf(new this.TypedArray(e,...t),this.constructor.prototype)}If.prototype[oot]=!0;If.prototype.toJSON=function(){return`"${Vx(this)}"`};If.prototype.valueOf=function(){return aot(this)};If.prototype.toString=function(){return Vx(this)};If.prototype[Symbol.toPrimitive]=function(e="default"){switch(e){case"number":return aot(this);case"string":return Vx(this);case"default":return lot(this)}return Vx(this)};function zx(...e){return If.apply(this,e)}function Ux(...e){return If.apply(this,e)}function xS(...e){return If.apply(this,e)}Object.setPrototypeOf(zx.prototype,Object.create(Int32Array.prototype));Object.setPrototypeOf(Ux.prototype,Object.create(Uint32Array.prototype));Object.setPrototypeOf(xS.prototype,Object.create(Uint32Array.prototype));Object.assign(zx.prototype,If.prototype,{constructor:zx,signed:!0,TypedArray:Int32Array,BigIntArray:BigInt64Array});Object.assign(Ux.prototype,If.prototype,{constructor:Ux,signed:!1,TypedArray:Uint32Array,BigIntArray:BigUint64Array});Object.assign(xS.prototype,If.prototype,{constructor:xS,signed:!0,TypedArray:Uint32Array,BigIntArray:BigUint64Array});function aot(e){let{buffer:t,byteOffset:r,length:i,signed:s}=e,n=new BigUint64Array(t,r,i),o=s&&n.at(-1)&BigInt(1)<<BigInt(63),a=BigInt(o?1:0),h=BigInt(0);if(o){for(let p of n)a+=~p*(BigInt(1)<<BigInt(32)*h++);a*=BigInt(-1)}else for(let p of n)a+=p*(BigInt(1)<<BigInt(32)*h++);return a}var Vx=e=>{if(e.byteLength===8)return`${new e.BigIntArray(e.buffer,e.byteOffset,1)[0]}`;if(!e.signed)return eF(e);let t=new Uint16Array(e.buffer,e.byteOffset,e.byteLength/2);if(new Int16Array([t.at(-1)])[0]>=0)return eF(e);t=t.slice();let i=1;for(let n=0;n<t.length;n++){let o=t[n],a=~o+i;t[n]=a,i&=o===0?1:0}return`-${eF(t)}`},lot=e=>e.byteLength===8?new e.BigIntArray(e.buffer,e.byteOffset,1)[0]:Vx(e);function eF(e){let t="",r=new Uint32Array(2),i=new Uint16Array(e.buffer,e.byteOffset,e.byteLength/2),s=new Uint32Array((i=new Uint16Array(i).reverse()).buffer),n=-1,o=i.length-1;do{for(r[0]=i[n=0];n<o;)i[n++]=r[1]=r[0]/10,r[0]=(r[0]-r[1]*10<<16)+i[n];i[n]=r[1]=r[0]/10,r[0]=r[0]-r[1]*10,t=`${r[0]}${t}`}while(s[0]||s[1]||s[2]||s[3]);return t??"0"}var bS=class e{static new(t,r){switch(r){case!0:return new zx(t);case!1:return new Ux(t)}switch(t.constructor){case Int8Array:case Int16Array:case Int32Array:case BigInt64Array:return new zx(t)}return t.byteLength===16?new xS(t):new Ux(t)}static signed(t){return new zx(t)}static unsigned(t){return new Ux(t)}static decimal(t){return new xS(t)}constructor(t,r){return e.new(t,r)}};function no(e){if(typeof e=="bigint"&&(e<Number.MIN_SAFE_INTEGER||e>Number.MAX_SAFE_INTEGER))throw new TypeError(`${e} is not safe to convert to a number.`);return Number(e)}var cot,uot,hot,fot,pot,dot,mot,Aot,got,_ot,yot,xot,bot,vot,wot,Tot,Sot,Eot,Iot,Mot,Cot,Pot,xr=class e{static isNull(t){return t?.typeId===Lt.Null}static isInt(t){return t?.typeId===Lt.Int}static isFloat(t){return t?.typeId===Lt.Float}static isBinary(t){return t?.typeId===Lt.Binary}static isLargeBinary(t){return t?.typeId===Lt.LargeBinary}static isUtf8(t){return t?.typeId===Lt.Utf8}static isLargeUtf8(t){return t?.typeId===Lt.LargeUtf8}static isBool(t){return t?.typeId===Lt.Bool}static isDecimal(t){return t?.typeId===Lt.Decimal}static isDate(t){return t?.typeId===Lt.Date}static isTime(t){return t?.typeId===Lt.Time}static isTimestamp(t){return t?.typeId===Lt.Timestamp}static isInterval(t){return t?.typeId===Lt.Interval}static isDuration(t){return t?.typeId===Lt.Duration}static isList(t){return t?.typeId===Lt.List}static isStruct(t){return t?.typeId===Lt.Struct}static isUnion(t){return t?.typeId===Lt.Union}static isFixedSizeBinary(t){return t?.typeId===Lt.FixedSizeBinary}static isFixedSizeList(t){return t?.typeId===Lt.FixedSizeList}static isMap(t){return t?.typeId===Lt.Map}static isDictionary(t){return t?.typeId===Lt.Dictionary}static isDenseUnion(t){return e.isUnion(t)&&t.mode===us.Dense}static isSparseUnion(t){return e.isUnion(t)&&t.mode===us.Sparse}constructor(t){this.typeId=t}};cot=Symbol.toStringTag;xr[cot]=(e=>(e.children=null,e.ArrayType=Array,e.OffsetArrayType=Int32Array,e[Symbol.toStringTag]="DataType"))(xr.prototype);var Ia=class extends xr{constructor(){super(Lt.Null)}toString(){return"Null"}};uot=Symbol.toStringTag;Ia[uot]=(e=>e[Symbol.toStringTag]="Null")(Ia.prototype);var _o=class extends xr{constructor(t,r){super(Lt.Int),this.isSigned=t,this.bitWidth=r}get ArrayType(){switch(this.bitWidth){case 8:return this.isSigned?Int8Array:Uint8Array;case 16:return this.isSigned?Int16Array:Uint16Array;case 32:return this.isSigned?Int32Array:Uint32Array;case 64:return this.isSigned?BigInt64Array:BigUint64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`${this.isSigned?"I":"Ui"}nt${this.bitWidth}`}};hot=Symbol.toStringTag;_o[hot]=(e=>(e.isSigned=null,e.bitWidth=null,e[Symbol.toStringTag]="Int"))(_o.prototype);var v0=class extends _o{constructor(){super(!0,8)}get ArrayType(){return Int8Array}},w0=class extends _o{constructor(){super(!0,16)}get ArrayType(){return Int16Array}},Ml=class extends _o{constructor(){super(!0,32)}get ArrayType(){return Int32Array}},T0=class extends _o{constructor(){super(!0,64)}get ArrayType(){return BigInt64Array}},S0=class extends _o{constructor(){super(!1,8)}get ArrayType(){return Uint8Array}},E0=class extends _o{constructor(){super(!1,16)}get ArrayType(){return Uint16Array}},I0=class extends _o{constructor(){super(!1,32)}get ArrayType(){return Uint32Array}},M0=class extends _o{constructor(){super(!1,64)}get ArrayType(){return BigUint64Array}};Object.defineProperty(v0.prototype,"ArrayType",{value:Int8Array});Object.defineProperty(w0.prototype,"ArrayType",{value:Int16Array});Object.defineProperty(Ml.prototype,"ArrayType",{value:Int32Array});Object.defineProperty(T0.prototype,"ArrayType",{value:BigInt64Array});Object.defineProperty(S0.prototype,"ArrayType",{value:Uint8Array});Object.defineProperty(E0.prototype,"ArrayType",{value:Uint16Array});Object.defineProperty(I0.prototype,"ArrayType",{value:Uint32Array});Object.defineProperty(M0.prototype,"ArrayType",{value:BigUint64Array});var tc=class extends xr{constructor(t){super(Lt.Float),this.precision=t}get ArrayType(){switch(this.precision){case rs.HALF:return Uint16Array;case rs.SINGLE:return Float32Array;case rs.DOUBLE:return Float64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`Float${this.precision<<5||16}`}};fot=Symbol.toStringTag;tc[fot]=(e=>(e.precision=null,e[Symbol.toStringTag]="Float"))(tc.prototype);var v_=class extends tc{constructor(){super(rs.HALF)}},C0=class extends tc{constructor(){super(rs.SINGLE)}},P0=class extends tc{constructor(){super(rs.DOUBLE)}};Object.defineProperty(v_.prototype,"ArrayType",{value:Uint16Array});Object.defineProperty(C0.prototype,"ArrayType",{value:Float32Array});Object.defineProperty(P0.prototype,"ArrayType",{value:Float64Array});var Ah=class extends xr{constructor(){super(Lt.Binary)}toString(){return"Binary"}};pot=Symbol.toStringTag;Ah[pot]=(e=>(e.ArrayType=Uint8Array,e[Symbol.toStringTag]="Binary"))(Ah.prototype);var $p=class extends xr{constructor(){super(Lt.LargeBinary)}toString(){return"LargeBinary"}};dot=Symbol.toStringTag;$p[dot]=(e=>(e.ArrayType=Uint8Array,e.OffsetArrayType=BigInt64Array,e[Symbol.toStringTag]="LargeBinary"))($p.prototype);var wu=class extends xr{constructor(){super(Lt.Utf8)}toString(){return"Utf8"}};mot=Symbol.toStringTag;wu[mot]=(e=>(e.ArrayType=Uint8Array,e[Symbol.toStringTag]="Utf8"))(wu.prototype);var Hp=class extends xr{constructor(){super(Lt.LargeUtf8)}toString(){return"LargeUtf8"}};Aot=Symbol.toStringTag;Hp[Aot]=(e=>(e.ArrayType=Uint8Array,e.OffsetArrayType=BigInt64Array,e[Symbol.toStringTag]="LargeUtf8"))(Hp.prototype);var gh=class extends xr{constructor(){super(Lt.Bool)}toString(){return"Bool"}};got=Symbol.toStringTag;gh[got]=(e=>(e.ArrayType=Uint8Array,e[Symbol.toStringTag]="Bool"))(gh.prototype);var qp=class extends xr{constructor(t,r,i=128){super(Lt.Decimal),this.scale=t,this.precision=r,this.bitWidth=i}toString(){return`Decimal[${this.precision}e${this.scale>0?"+":""}${this.scale}]`}};_ot=Symbol.toStringTag;qp[_ot]=(e=>(e.scale=null,e.precision=null,e.ArrayType=Uint32Array,e[Symbol.toStringTag]="Decimal"))(qp.prototype);var _h=class extends xr{constructor(t){super(Lt.Date),this.unit=t}toString(){return`Date${(this.unit+1)*32}<${io[this.unit]}>`}};yot=Symbol.toStringTag;_h[yot]=(e=>(e.unit=null,e.ArrayType=Int32Array,e[Symbol.toStringTag]="Date"))(_h.prototype);var jx=class extends _h{constructor(){super(io.DAY)}},Wx=class extends _h{constructor(){super(io.MILLISECOND)}},Cl=class extends xr{constructor(t,r){super(Lt.Time),this.unit=t,this.bitWidth=r}toString(){return`Time${this.bitWidth}<${Tr[this.unit]}>`}get ArrayType(){switch(this.bitWidth){case 32:return Int32Array;case 64:return BigInt64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}};xot=Symbol.toStringTag;Cl[xot]=(e=>(e.unit=null,e.bitWidth=null,e[Symbol.toStringTag]="Time"))(Cl.prototype);var $x=class extends Cl{constructor(){super(Tr.SECOND,32)}},Hx=class extends Cl{constructor(){super(Tr.MILLISECOND,32)}},qx=class extends Cl{constructor(){super(Tr.MICROSECOND,64)}},Yx=class extends Cl{constructor(){super(Tr.NANOSECOND,64)}},Yp=class extends xr{constructor(t,r){super(Lt.Timestamp),this.unit=t,this.timezone=r}toString(){return`Timestamp<${Tr[this.unit]}${this.timezone?`, ${this.timezone}`:""}>`}};bot=Symbol.toStringTag;Yp[bot]=(e=>(e.unit=null,e.timezone=null,e.ArrayType=Int32Array,e[Symbol.toStringTag]="Timestamp"))(Yp.prototype);var yh=class extends xr{constructor(t){super(Lt.Interval),this.unit=t}toString(){return`Interval<${Lo[this.unit]}>`}};vot=Symbol.toStringTag;yh[vot]=(e=>(e.unit=null,e.ArrayType=Int32Array,e[Symbol.toStringTag]="Interval"))(yh.prototype);var Xx=class extends yh{constructor(){super(Lo.DAY_TIME)}},Zx=class extends yh{constructor(){super(Lo.YEAR_MONTH)}},Xp=class extends xr{constructor(t){super(Lt.Duration),this.unit=t}toString(){return`Duration<${Tr[this.unit]}>`}};wot=Symbol.toStringTag;Xp[wot]=(e=>(e.unit=null,e.ArrayType=BigInt64Array,e[Symbol.toStringTag]="Duration"))(Xp.prototype);var Lc=class extends xr{constructor(t){super(Lt.List),this.children=[t]}toString(){return`List<${this.valueType}>`}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}};Tot=Symbol.toStringTag;Lc[Tot]=(e=>(e.children=null,e[Symbol.toStringTag]="List"))(Lc.prototype);var is=class extends xr{constructor(t){super(Lt.Struct),this.children=t}toString(){return`Struct<{${this.children.map(t=>`${t.name}:${t.type}`).join(", ")}}>`}};Sot=Symbol.toStringTag;is[Sot]=(e=>(e.children=null,e[Symbol.toStringTag]="Struct"))(is.prototype);var xh=class extends xr{constructor(t,r,i){super(Lt.Union),this.mode=t,this.children=i,this.typeIds=r=Int32Array.from(r),this.typeIdToChildIndex=r.reduce((s,n,o)=>(s[n]=o)&&s||s,Object.create(null))}toString(){return`${this[Symbol.toStringTag]}<${this.children.map(t=>`${t.type}`).join(" | ")}>`}};Eot=Symbol.toStringTag;xh[Eot]=(e=>(e.mode=null,e.typeIds=null,e.children=null,e.typeIdToChildIndex=null,e.ArrayType=Int8Array,e[Symbol.toStringTag]="Union"))(xh.prototype);var Zp=class extends xr{constructor(t){super(Lt.FixedSizeBinary),this.byteWidth=t}toString(){return`FixedSizeBinary[${this.byteWidth}]`}};Iot=Symbol.toStringTag;Zp[Iot]=(e=>(e.byteWidth=null,e.ArrayType=Uint8Array,e[Symbol.toStringTag]="FixedSizeBinary"))(Zp.prototype);var Fc=class extends xr{constructor(t,r){super(Lt.FixedSizeList),this.listSize=t,this.children=[r]}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}toString(){return`FixedSizeList[${this.listSize}]<${this.valueType}>`}};Mot=Symbol.toStringTag;Fc[Mot]=(e=>(e.children=null,e.listSize=null,e[Symbol.toStringTag]="FixedSizeList"))(Fc.prototype);var bh=class extends xr{constructor(t,r=!1){var i,s,n;if(super(Lt.Map),this.children=[t],this.keysSorted=r,t&&(t.name="entries",!((i=t?.type)===null||i===void 0)&&i.children)){let o=(s=t?.type)===null||s===void 0?void 0:s.children[0];o&&(o.name="key");let a=(n=t?.type)===null||n===void 0?void 0:n.children[1];a&&(a.name="value")}}get keyType(){return this.children[0].type.children[0].type}get valueType(){return this.children[0].type.children[1].type}get childType(){return this.children[0].type}toString(){return`Map<{${this.children[0].type.children.map(t=>`${t.name}:${t.type}`).join(", ")}}>`}};Cot=Symbol.toStringTag;bh[Cot]=(e=>(e.children=null,e.keysSorted=null,e[Symbol.toStringTag]="Map_"))(bh.prototype);var D6t=(e=>()=>++e)(-1),Pl=class extends xr{constructor(t,r,i,s){super(Lt.Dictionary),this.indices=r,this.dictionary=t,this.isOrdered=s||!1,this.id=i==null?D6t():no(i)}get children(){return this.dictionary.children}get valueType(){return this.dictionary}get ArrayType(){return this.dictionary.ArrayType}toString(){return`Dictionary<${this.indices}, ${this.dictionary}>`}};Pot=Symbol.toStringTag;Pl[Pot]=(e=>(e.id=null,e.indices=null,e.isOrdered=null,e.dictionary=null,e[Symbol.toStringTag]="Dictionary"))(Pl.prototype);function Tu(e){let t=e;switch(e.typeId){case Lt.Decimal:return e.bitWidth/32;case Lt.Timestamp:return 2;case Lt.Date:return 1+t.unit;case Lt.Interval:return 1+t.unit;case Lt.FixedSizeList:return t.listSize;case Lt.FixedSizeBinary:return t.byteWidth;default:return 1}}var Yr=class{visitMany(t,...r){return t.map((i,s)=>this.visit(i,...r.map(n=>n[s])))}visit(...t){return this.getVisitFn(t[0],!1).apply(this,t)}getVisitFn(t,r=!0){return O6t(this,t,r)}getVisitFnByTypeId(t,r=!0){return Gx(this,t,r)}visitNull(t,...r){return null}visitBool(t,...r){return null}visitInt(t,...r){return null}visitFloat(t,...r){return null}visitUtf8(t,...r){return null}visitLargeUtf8(t,...r){return null}visitBinary(t,...r){return null}visitLargeBinary(t,...r){return null}visitFixedSizeBinary(t,...r){return null}visitDate(t,...r){return null}visitTimestamp(t,...r){return null}visitTime(t,...r){return null}visitDecimal(t,...r){return null}visitList(t,...r){return null}visitStruct(t,...r){return null}visitUnion(t,...r){return null}visitDictionary(t,...r){return null}visitInterval(t,...r){return null}visitDuration(t,...r){return null}visitFixedSizeList(t,...r){return null}visitMap(t,...r){return null}};function O6t(e,t,r=!0){return typeof t=="number"?Gx(e,t,r):typeof t=="string"&&t in Lt?Gx(e,Lt[t],r):t&&t instanceof xr?Gx(e,Rot(t),r):t?.type&&t.type instanceof xr?Gx(e,Rot(t.type),r):Gx(e,Lt.NONE,r)}function Gx(e,t,r=!0){let i=null;switch(t){case Lt.Null:i=e.visitNull;break;case Lt.Bool:i=e.visitBool;break;case Lt.Int:i=e.visitInt;break;case Lt.Int8:i=e.visitInt8||e.visitInt;break;case Lt.Int16:i=e.visitInt16||e.visitInt;break;case Lt.Int32:i=e.visitInt32||e.visitInt;break;case Lt.Int64:i=e.visitInt64||e.visitInt;break;case Lt.Uint8:i=e.visitUint8||e.visitInt;break;case Lt.Uint16:i=e.visitUint16||e.visitInt;break;case Lt.Uint32:i=e.visitUint32||e.visitInt;break;case Lt.Uint64:i=e.visitUint64||e.visitInt;break;case Lt.Float:i=e.visitFloat;break;case Lt.Float16:i=e.visitFloat16||e.visitFloat;break;case Lt.Float32:i=e.visitFloat32||e.visitFloat;break;case Lt.Float64:i=e.visitFloat64||e.visitFloat;break;case Lt.Utf8:i=e.visitUtf8;break;case Lt.LargeUtf8:i=e.visitLargeUtf8;break;case Lt.Binary:i=e.visitBinary;break;case Lt.LargeBinary:i=e.visitLargeBinary;break;case Lt.FixedSizeBinary:i=e.visitFixedSizeBinary;break;case Lt.Date:i=e.visitDate;break;case Lt.DateDay:i=e.visitDateDay||e.visitDate;break;case Lt.DateMillisecond:i=e.visitDateMillisecond||e.visitDate;break;case Lt.Timestamp:i=e.visitTimestamp;break;case Lt.TimestampSecond:i=e.visitTimestampSecond||e.visitTimestamp;break;case Lt.TimestampMillisecond:i=e.visitTimestampMillisecond||e.visitTimestamp;break;case Lt.TimestampMicrosecond:i=e.visitTimestampMicrosecond||e.visitTimestamp;break;case Lt.TimestampNanosecond:i=e.visitTimestampNanosecond||e.visitTimestamp;break;case Lt.Time:i=e.visitTime;break;case Lt.TimeSecond:i=e.visitTimeSecond||e.visitTime;break;case Lt.TimeMillisecond:i=e.visitTimeMillisecond||e.visitTime;break;case Lt.TimeMicrosecond:i=e.visitTimeMicrosecond||e.visitTime;break;case Lt.TimeNanosecond:i=e.visitTimeNanosecond||e.visitTime;break;case Lt.Decimal:i=e.visitDecimal;break;case Lt.List:i=e.visitList;break;case Lt.Struct:i=e.visitStruct;break;case Lt.Union:i=e.visitUnion;break;case Lt.DenseUnion:i=e.visitDenseUnion||e.visitUnion;break;case Lt.SparseUnion:i=e.visitSparseUnion||e.visitUnion;break;case Lt.Dictionary:i=e.visitDictionary;break;case Lt.Interval:i=e.visitInterval;break;case Lt.IntervalDayTime:i=e.visitIntervalDayTime||e.visitInterval;break;case Lt.IntervalYearMonth:i=e.visitIntervalYearMonth||e.visitInterval;break;case Lt.Duration:i=e.visitDuration;break;case Lt.DurationSecond:i=e.visitDurationSecond||e.visitDuration;break;case Lt.DurationMillisecond:i=e.visitDurationMillisecond||e.visitDuration;break;case Lt.DurationMicrosecond:i=e.visitDurationMicrosecond||e.visitDuration;break;case Lt.DurationNanosecond:i=e.visitDurationNanosecond||e.visitDuration;break;case Lt.FixedSizeList:i=e.visitFixedSizeList;break;case Lt.Map:i=e.visitMap;break}if(typeof i=="function")return i;if(!r)return()=>null;throw new Error(`Unrecognized type '${Lt[t]}'`)}function Rot(e){switch(e.typeId){case Lt.Null:return Lt.Null;case Lt.Int:{let{bitWidth:t,isSigned:r}=e;switch(t){case 8:return r?Lt.Int8:Lt.Uint8;case 16:return r?Lt.Int16:Lt.Uint16;case 32:return r?Lt.Int32:Lt.Uint32;case 64:return r?Lt.Int64:Lt.Uint64}return Lt.Int}case Lt.Float:switch(e.precision){case rs.HALF:return Lt.Float16;case rs.SINGLE:return Lt.Float32;case rs.DOUBLE:return Lt.Float64}return Lt.Float;case Lt.Binary:return Lt.Binary;case Lt.LargeBinary:return Lt.LargeBinary;case Lt.Utf8:return Lt.Utf8;case Lt.LargeUtf8:return Lt.LargeUtf8;case Lt.Bool:return Lt.Bool;case Lt.Decimal:return Lt.Decimal;case Lt.Time:switch(e.unit){case Tr.SECOND:return Lt.TimeSecond;case Tr.MILLISECOND:return Lt.TimeMillisecond;case Tr.MICROSECOND:return Lt.TimeMicrosecond;case Tr.NANOSECOND:return Lt.TimeNanosecond}return Lt.Time;case Lt.Timestamp:switch(e.unit){case Tr.SECOND:return Lt.TimestampSecond;case Tr.MILLISECOND:return Lt.TimestampMillisecond;case Tr.MICROSECOND:return Lt.TimestampMicrosecond;case Tr.NANOSECOND:return Lt.TimestampNanosecond}return Lt.Timestamp;case Lt.Date:switch(e.unit){case io.DAY:return Lt.DateDay;case io.MILLISECOND:return Lt.DateMillisecond}return Lt.Date;case Lt.Interval:switch(e.unit){case Lo.DAY_TIME:return Lt.IntervalDayTime;case Lo.YEAR_MONTH:return Lt.IntervalYearMonth}return Lt.Interval;case Lt.Duration:switch(e.unit){case Tr.SECOND:return Lt.DurationSecond;case Tr.MILLISECOND:return Lt.DurationMillisecond;case Tr.MICROSECOND:return Lt.DurationMicrosecond;case Tr.NANOSECOND:return Lt.DurationNanosecond}return Lt.Duration;case Lt.Map:return Lt.Map;case Lt.List:return Lt.List;case Lt.Struct:return Lt.Struct;case Lt.Union:switch(e.mode){case us.Dense:return Lt.DenseUnion;case us.Sparse:return Lt.SparseUnion}return Lt.Union;case Lt.FixedSizeBinary:return Lt.FixedSizeBinary;case Lt.FixedSizeList:return Lt.FixedSizeList;case Lt.Dictionary:return Lt.Dictionary}throw new Error(`Unrecognized type '${Lt[e.typeId]}'`)}Yr.prototype.visitInt8=null;Yr.prototype.visitInt16=null;Yr.prototype.visitInt32=null;Yr.prototype.visitInt64=null;Yr.prototype.visitUint8=null;Yr.prototype.visitUint16=null;Yr.prototype.visitUint32=null;Yr.prototype.visitUint64=null;Yr.prototype.visitFloat16=null;Yr.prototype.visitFloat32=null;Yr.prototype.visitFloat64=null;Yr.prototype.visitDateDay=null;Yr.prototype.visitDateMillisecond=null;Yr.prototype.visitTimestampSecond=null;Yr.prototype.visitTimestampMillisecond=null;Yr.prototype.visitTimestampMicrosecond=null;Yr.prototype.visitTimestampNanosecond=null;Yr.prototype.visitTimeSecond=null;Yr.prototype.visitTimeMillisecond=null;Yr.prototype.visitTimeMicrosecond=null;Yr.prototype.visitTimeNanosecond=null;Yr.prototype.visitDenseUnion=null;Yr.prototype.visitSparseUnion=null;Yr.prototype.visitIntervalDayTime=null;Yr.prototype.visitIntervalYearMonth=null;Yr.prototype.visitDuration=null;Yr.prototype.visitDurationSecond=null;Yr.prototype.visitDurationMillisecond=null;Yr.prototype.visitDurationMicrosecond=null;Yr.prototype.visitDurationNanosecond=null;var iF={};Ua(iF,{float64ToUint16:()=>vS,uint16ToFloat64:()=>qC});var kot=new Float64Array(1),Qx=new Uint32Array(kot.buffer);function qC(e){let t=(e&31744)>>10,r=(e&1023)/1024,i=Math.pow(-1,(e&32768)>>15);switch(t){case 31:return i*(r?Number.NaN:1/0);case 0:return i*(r?6103515625e-14*r:0)}return i*Math.pow(2,t-15)*(1+r)}function vS(e){if(e!==e)return 32256;kot[0]=e;let t=(Qx[1]&2147483648)>>16&65535,r=Qx[1]&2146435072,i=0;return r>=1089470464?Qx[0]>0?r=31744:(r=(r&2080374784)>>16,i=(Qx[1]&1048575)>>10):r<=1056964608?(i=1048576+(Qx[1]&1048575),i=1048576+(i<<(r>>20)-998)>>21,r=0):(r=r-1056964608>>10,i=(Qx[1]&1048575)+512>>10),t|r|i&65535}var ri=class extends Yr{};function mi(e){return(t,r,i)=>{if(t.setValid(r,i!=null))return e(t,r,i)}}var B6t=(e,t,r)=>{e[t]=Math.trunc(r/864e5)},nF=(e,t,r)=>{e[t]=Math.trunc(r%4294967296),e[t+1]=Math.trunc(r/4294967296)},N6t=(e,t,r)=>{e[t]=Math.trunc(r*1e3%4294967296),e[t+1]=Math.trunc(r*1e3/4294967296)},L6t=(e,t,r)=>{e[t]=Math.trunc(r*1e6%4294967296),e[t+1]=Math.trunc(r*1e6/4294967296)},Dot=(e,t,r,i)=>{if(r+1<t.length){let s=no(t[r]),n=no(t[r+1]);e.set(i.subarray(0,n-s),s)}},F6t=({offset:e,values:t},r,i)=>{let s=e+r;i?t[s>>3]|=1<<s%8:t[s>>3]&=~(1<<s%8)},R0=({values:e},t,r)=>{e[t]=r},sF=({values:e},t,r)=>{e[t]=r},Oot=({values:e},t,r)=>{e[t]=vS(r)},z6t=(e,t,r)=>{switch(e.type.precision){case rs.HALF:return Oot(e,t,r);case rs.SINGLE:case rs.DOUBLE:return sF(e,t,r)}},YC=({values:e},t,r)=>{B6t(e,t,r.valueOf())},XC=({values:e},t,r)=>{nF(e,t*2,r.valueOf())},oF=({stride:e,values:t},r,i)=>{t.set(i.subarray(0,e),e*r)},Bot=({values:e,valueOffsets:t},r,i)=>Dot(e,t,r,i),Not=({values:e,valueOffsets:t},r,i)=>Dot(e,t,r,zp(i)),aF=(e,t,r)=>{e.type.unit===io.DAY?YC(e,t,r):XC(e,t,r)},ZC=({values:e},t,r)=>nF(e,t*2,r/1e3),GC=({values:e},t,r)=>nF(e,t*2,r),QC=({values:e},t,r)=>N6t(e,t*2,r),KC=({values:e},t,r)=>L6t(e,t*2,r),lF=(e,t,r)=>{switch(e.type.unit){case Tr.SECOND:return ZC(e,t,r);case Tr.MILLISECOND:return GC(e,t,r);case Tr.MICROSECOND:return QC(e,t,r);case Tr.NANOSECOND:return KC(e,t,r)}},JC=({values:e},t,r)=>{e[t]=r},t8=({values:e},t,r)=>{e[t]=r},e8=({values:e},t,r)=>{e[t]=r},r8=({values:e},t,r)=>{e[t]=r},cF=(e,t,r)=>{switch(e.type.unit){case Tr.SECOND:return JC(e,t,r);case Tr.MILLISECOND:return t8(e,t,r);case Tr.MICROSECOND:return e8(e,t,r);case Tr.NANOSECOND:return r8(e,t,r)}},uF=({values:e,stride:t},r,i)=>{e.set(i.subarray(0,t),t*r)},U6t=(e,t,r)=>{let i=e.children[0],s=e.valueOffsets,n=Ga.getVisitFn(i);if(Array.isArray(r))for(let o=-1,a=s[t],h=s[t+1];a<h;)n(i,a++,r[++o]);else for(let o=-1,a=s[t],h=s[t+1];a<h;)n(i,a++,r.get(++o))},V6t=(e,t,r)=>{let i=e.children[0],{valueOffsets:s}=e,n=Ga.getVisitFn(i),{[t]:o,[t+1]:a}=s,h=r instanceof Map?r.entries():Object.entries(r);for(let p of h)if(n(i,o,p),++o>=a)break},j6t=(e,t)=>(r,i,s,n)=>i&&r(i,e,t[n]),W6t=(e,t)=>(r,i,s,n)=>i&&r(i,e,t.get(n)),$6t=(e,t)=>(r,i,s,n)=>i&&r(i,e,t.get(s.name)),H6t=(e,t)=>(r,i,s,n)=>i&&r(i,e,t[s.name]),q6t=(e,t,r)=>{let i=e.type.children.map(n=>Ga.getVisitFn(n.type)),s=r instanceof Map?$6t(t,r):r instanceof zi?W6t(t,r):Array.isArray(r)?j6t(t,r):H6t(t,r);e.type.children.forEach((n,o)=>s(i[o],e.children[o],n,o))},Y6t=(e,t,r)=>{e.type.mode===us.Dense?Lot(e,t,r):Fot(e,t,r)},Lot=(e,t,r)=>{let i=e.type.typeIdToChildIndex[e.typeIds[t]],s=e.children[i];Ga.visit(s,e.valueOffsets[t],r)},Fot=(e,t,r)=>{let i=e.type.typeIdToChildIndex[e.typeIds[t]],s=e.children[i];Ga.visit(s,t,r)},X6t=(e,t,r)=>{var i;(i=e.dictionary)===null||i===void 0||i.set(e.values[t],r)},hF=(e,t,r)=>{e.type.unit===Lo.DAY_TIME?i8(e,t,r):n8(e,t,r)},i8=({values:e},t,r)=>{e.set(r.subarray(0,2),2*t)},n8=({values:e},t,r)=>{e[t]=r[0]*12+r[1]%12},s8=({values:e},t,r)=>{e[t]=r},o8=({values:e},t,r)=>{e[t]=r},a8=({values:e},t,r)=>{e[t]=r},l8=({values:e},t,r)=>{e[t]=r},fF=(e,t,r)=>{switch(e.type.unit){case Tr.SECOND:return s8(e,t,r);case Tr.MILLISECOND:return o8(e,t,r);case Tr.MICROSECOND:return a8(e,t,r);case Tr.NANOSECOND:return l8(e,t,r)}},Z6t=(e,t,r)=>{let{stride:i}=e,s=e.children[0],n=Ga.getVisitFn(s);if(Array.isArray(r))for(let o=-1,a=t*i;++o<i;)n(s,a+o,r[o]);else for(let o=-1,a=t*i;++o<i;)n(s,a+o,r.get(o))};ri.prototype.visitBool=mi(F6t);ri.prototype.visitInt=mi(R0);ri.prototype.visitInt8=mi(R0);ri.prototype.visitInt16=mi(R0);ri.prototype.visitInt32=mi(R0);ri.prototype.visitInt64=mi(R0);ri.prototype.visitUint8=mi(R0);ri.prototype.visitUint16=mi(R0);ri.prototype.visitUint32=mi(R0);ri.prototype.visitUint64=mi(R0);ri.prototype.visitFloat=mi(z6t);ri.prototype.visitFloat16=mi(Oot);ri.prototype.visitFloat32=mi(sF);ri.prototype.visitFloat64=mi(sF);ri.prototype.visitUtf8=mi(Not);ri.prototype.visitLargeUtf8=mi(Not);ri.prototype.visitBinary=mi(Bot);ri.prototype.visitLargeBinary=mi(Bot);ri.prototype.visitFixedSizeBinary=mi(oF);ri.prototype.visitDate=mi(aF);ri.prototype.visitDateDay=mi(YC);ri.prototype.visitDateMillisecond=mi(XC);ri.prototype.visitTimestamp=mi(lF);ri.prototype.visitTimestampSecond=mi(ZC);ri.prototype.visitTimestampMillisecond=mi(GC);ri.prototype.visitTimestampMicrosecond=mi(QC);ri.prototype.visitTimestampNanosecond=mi(KC);ri.prototype.visitTime=mi(cF);ri.prototype.visitTimeSecond=mi(JC);ri.prototype.visitTimeMillisecond=mi(t8);ri.prototype.visitTimeMicrosecond=mi(e8);ri.prototype.visitTimeNanosecond=mi(r8);ri.prototype.visitDecimal=mi(uF);ri.prototype.visitList=mi(U6t);ri.prototype.visitStruct=mi(q6t);ri.prototype.visitUnion=mi(Y6t);ri.prototype.visitDenseUnion=mi(Lot);ri.prototype.visitSparseUnion=mi(Fot);ri.prototype.visitDictionary=mi(X6t);ri.prototype.visitInterval=mi(hF);ri.prototype.visitIntervalDayTime=mi(i8);ri.prototype.visitIntervalYearMonth=mi(n8);ri.prototype.visitDuration=mi(fF);ri.prototype.visitDurationSecond=mi(s8);ri.prototype.visitDurationMillisecond=mi(o8);ri.prototype.visitDurationMicrosecond=mi(a8);ri.prototype.visitDurationNanosecond=mi(l8);ri.prototype.visitFixedSizeList=mi(Z6t);ri.prototype.visitMap=mi(V6t);var Ga=new ri;var Mf=Symbol.for("parent"),Kx=Symbol.for("rowIndex"),kA=class{constructor(t,r){return this[Mf]=t,this[Kx]=r,new Proxy(this,new dF)}toArray(){return Object.values(this.toJSON())}toJSON(){let t=this[Kx],r=this[Mf],i=r.type.children,s={};for(let n=-1,o=i.length;++n<o;)s[i[n].name]=Yo.visit(r.children[n],t);return s}toString(){return`{${[...this].map(([t,r])=>`${Ef(t)}: ${Ef(r)}`).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}[Symbol.iterator](){return new pF(this[Mf],this[Kx])}},pF=class{constructor(t,r){this.childIndex=0,this.children=t.children,this.rowIndex=r,this.childFields=t.type.children,this.numChildren=this.childFields.length}[Symbol.iterator](){return this}next(){let t=this.childIndex;return t<this.numChildren?(this.childIndex=t+1,{done:!1,value:[this.childFields[t].name,Yo.visit(this.children[t],this.rowIndex)]}):{done:!0,value:null}}};Object.defineProperties(kA.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[Mf]:{writable:!0,enumerable:!1,configurable:!1,value:null},[Kx]:{writable:!0,enumerable:!1,configurable:!1,value:-1}});var dF=class{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(t){return t[Mf].type.children.map(r=>r.name)}has(t,r){return t[Mf].type.children.findIndex(i=>i.name===r)!==-1}getOwnPropertyDescriptor(t,r){if(t[Mf].type.children.findIndex(i=>i.name===r)!==-1)return{writable:!0,enumerable:!0,configurable:!0}}get(t,r){if(Reflect.has(t,r))return t[r];let i=t[Mf].type.children.findIndex(s=>s.name===r);if(i!==-1){let s=Yo.visit(t[Mf].children[i],t[Kx]);return Reflect.set(t,r,s),s}}set(t,r,i){let s=t[Mf].type.children.findIndex(n=>n.name===r);return s!==-1?(Ga.visit(t[Mf].children[s],t[Kx],i),Reflect.set(t,r,i)):Reflect.has(t,r)||typeof r=="symbol"?Reflect.set(t,r,i):!1}};var Xr=class extends Yr{};function ci(e){return(t,r)=>t.getValid(r)?e(t,r):null}var G6t=(e,t)=>864e5*e[t],mF=(e,t)=>4294967296*e[t+1]+(e[t]>>>0),Q6t=(e,t)=>4294967296*(e[t+1]/1e3)+(e[t]>>>0)/1e3,K6t=(e,t)=>4294967296*(e[t+1]/1e6)+(e[t]>>>0)/1e6,zot=e=>new Date(e),J6t=(e,t)=>zot(G6t(e,t)),tIt=(e,t)=>zot(mF(e,t)),eIt=(e,t)=>null,Uot=(e,t,r)=>{if(r+1>=t.length)return null;let i=no(t[r]),s=no(t[r+1]);return e.subarray(i,s)},rIt=({offset:e,values:t},r)=>{let i=e+r;return(t[i>>3]&1<<i%8)!==0},Vot=({values:e},t)=>J6t(e,t),jot=({values:e},t)=>tIt(e,t*2),DA=({stride:e,values:t},r)=>t[e*r],iIt=({stride:e,values:t},r)=>qC(t[e*r]),Wot=({values:e},t)=>e[t],nIt=({stride:e,values:t},r)=>t.subarray(e*r,e*(r+1)),$ot=({values:e,valueOffsets:t},r)=>Uot(e,t,r),Hot=({values:e,valueOffsets:t},r)=>{let i=Uot(e,t,r);return i!==null?sS(i):null},sIt=({values:e},t)=>e[t],oIt=({type:e,values:t},r)=>e.precision!==rs.HALF?t[r]:qC(t[r]),aIt=(e,t)=>e.type.unit===io.DAY?Vot(e,t):jot(e,t),qot=({values:e},t)=>1e3*mF(e,t*2),Yot=({values:e},t)=>mF(e,t*2),Xot=({values:e},t)=>Q6t(e,t*2),Zot=({values:e},t)=>K6t(e,t*2),lIt=(e,t)=>{switch(e.type.unit){case Tr.SECOND:return qot(e,t);case Tr.MILLISECOND:return Yot(e,t);case Tr.MICROSECOND:return Xot(e,t);case Tr.NANOSECOND:return Zot(e,t)}},Got=({values:e},t)=>e[t],Qot=({values:e},t)=>e[t],Kot=({values:e},t)=>e[t],Jot=({values:e},t)=>e[t],cIt=(e,t)=>{switch(e.type.unit){case Tr.SECOND:return Got(e,t);case Tr.MILLISECOND:return Qot(e,t);case Tr.MICROSECOND:return Kot(e,t);case Tr.NANOSECOND:return Jot(e,t)}},uIt=({values:e,stride:t},r)=>bS.decimal(e.subarray(t*r,t*(r+1))),hIt=(e,t)=>{let{valueOffsets:r,stride:i,children:s}=e,{[t*i]:n,[t*i+1]:o}=r,h=s[0].slice(n,o-n);return new zi([h])},fIt=(e,t)=>{let{valueOffsets:r,children:i}=e,{[t]:s,[t+1]:n}=r,o=i[0];return new Gp(o.slice(s,n-s))},pIt=(e,t)=>new kA(e,t),dIt=(e,t)=>e.type.mode===us.Dense?tat(e,t):eat(e,t),tat=(e,t)=>{let r=e.type.typeIdToChildIndex[e.typeIds[t]],i=e.children[r];return Yo.visit(i,e.valueOffsets[t])},eat=(e,t)=>{let r=e.type.typeIdToChildIndex[e.typeIds[t]],i=e.children[r];return Yo.visit(i,t)},mIt=(e,t)=>{var r;return(r=e.dictionary)===null||r===void 0?void 0:r.get(e.values[t])},AIt=(e,t)=>e.type.unit===Lo.DAY_TIME?rat(e,t):iat(e,t),rat=({values:e},t)=>e.subarray(2*t,2*(t+1)),iat=({values:e},t)=>{let r=e[t],i=new Int32Array(2);return i[0]=Math.trunc(r/12),i[1]=Math.trunc(r%12),i},nat=({values:e},t)=>e[t],sat=({values:e},t)=>e[t],oat=({values:e},t)=>e[t],aat=({values:e},t)=>e[t],gIt=(e,t)=>{switch(e.type.unit){case Tr.SECOND:return nat(e,t);case Tr.MILLISECOND:return sat(e,t);case Tr.MICROSECOND:return oat(e,t);case Tr.NANOSECOND:return aat(e,t)}},_It=(e,t)=>{let{stride:r,children:i}=e,n=i[0].slice(t*r,r);return new zi([n])};Xr.prototype.visitNull=ci(eIt);Xr.prototype.visitBool=ci(rIt);Xr.prototype.visitInt=ci(sIt);Xr.prototype.visitInt8=ci(DA);Xr.prototype.visitInt16=ci(DA);Xr.prototype.visitInt32=ci(DA);Xr.prototype.visitInt64=ci(Wot);Xr.prototype.visitUint8=ci(DA);Xr.prototype.visitUint16=ci(DA);Xr.prototype.visitUint32=ci(DA);Xr.prototype.visitUint64=ci(Wot);Xr.prototype.visitFloat=ci(oIt);Xr.prototype.visitFloat16=ci(iIt);Xr.prototype.visitFloat32=ci(DA);Xr.prototype.visitFloat64=ci(DA);Xr.prototype.visitUtf8=ci(Hot);Xr.prototype.visitLargeUtf8=ci(Hot);Xr.prototype.visitBinary=ci($ot);Xr.prototype.visitLargeBinary=ci($ot);Xr.prototype.visitFixedSizeBinary=ci(nIt);Xr.prototype.visitDate=ci(aIt);Xr.prototype.visitDateDay=ci(Vot);Xr.prototype.visitDateMillisecond=ci(jot);Xr.prototype.visitTimestamp=ci(lIt);Xr.prototype.visitTimestampSecond=ci(qot);Xr.prototype.visitTimestampMillisecond=ci(Yot);Xr.prototype.visitTimestampMicrosecond=ci(Xot);Xr.prototype.visitTimestampNanosecond=ci(Zot);Xr.prototype.visitTime=ci(cIt);Xr.prototype.visitTimeSecond=ci(Got);Xr.prototype.visitTimeMillisecond=ci(Qot);Xr.prototype.visitTimeMicrosecond=ci(Kot);Xr.prototype.visitTimeNanosecond=ci(Jot);Xr.prototype.visitDecimal=ci(uIt);Xr.prototype.visitList=ci(hIt);Xr.prototype.visitStruct=ci(pIt);Xr.prototype.visitUnion=ci(dIt);Xr.prototype.visitDenseUnion=ci(tat);Xr.prototype.visitSparseUnion=ci(eat);Xr.prototype.visitDictionary=ci(mIt);Xr.prototype.visitInterval=ci(AIt);Xr.prototype.visitIntervalDayTime=ci(rat);Xr.prototype.visitIntervalYearMonth=ci(iat);Xr.prototype.visitDuration=ci(gIt);Xr.prototype.visitDurationSecond=ci(nat);Xr.prototype.visitDurationMillisecond=ci(sat);Xr.prototype.visitDurationMicrosecond=ci(oat);Xr.prototype.visitDurationNanosecond=ci(aat);Xr.prototype.visitFixedSizeList=ci(_It);Xr.prototype.visitMap=ci(fIt);var Yo=new Xr;var vh=Symbol.for("keys"),Jx=Symbol.for("vals"),Gp=class{constructor(t){return this[vh]=new zi([t.children[0]]).memoize(),this[Jx]=t.children[1],new Proxy(this,new gF)}[Symbol.iterator](){return new AF(this[vh],this[Jx])}get size(){return this[vh].length}toArray(){return Object.values(this.toJSON())}toJSON(){let t=this[vh],r=this[Jx],i={};for(let s=-1,n=t.length;++s<n;)i[t.get(s)]=Yo.visit(r,s);return i}toString(){return`{${[...this].map(([t,r])=>`${Ef(t)}: ${Ef(r)}`).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}},AF=class{constructor(t,r){this.keys=t,this.vals=r,this.keyIndex=0,this.numKeys=t.length}[Symbol.iterator](){return this}next(){let t=this.keyIndex;return t===this.numKeys?{done:!0,value:null}:(this.keyIndex++,{done:!1,value:[this.keys.get(t),Yo.visit(this.vals,t)]})}},gF=class{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(t){return t[vh].toArray().map(String)}has(t,r){return t[vh].includes(r)}getOwnPropertyDescriptor(t,r){if(t[vh].indexOf(r)!==-1)return{writable:!0,enumerable:!0,configurable:!0}}get(t,r){if(Reflect.has(t,r))return t[r];let i=t[vh].indexOf(r);if(i!==-1){let s=Yo.visit(Reflect.get(t,Jx),i);return Reflect.set(t,r,s),s}}set(t,r,i){let s=t[vh].indexOf(r);return s!==-1?(Ga.visit(Reflect.get(t,Jx),s,i),Reflect.set(t,r,i)):Reflect.has(t,r)?Reflect.set(t,r,i):!1}};Object.defineProperties(Gp.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[vh]:{writable:!0,enumerable:!1,configurable:!1,value:null},[Jx]:{writable:!0,enumerable:!1,configurable:!1,value:null}});function yIt(e,t,r){let i=e.length,s=t>-1?t:i+t%i;return r?r(e,s):s}var lat;function wS(e,t,r,i){let{length:s=0}=e,n=typeof t!="number"?0:t,o=typeof r!="number"?s:r;return n<0&&(n=(n%s+s)%s),o<0&&(o=(o%s+s)%s),o<n&&(lat=n,n=o,o=lat),o>s&&(o=s),i?i(e,n,o):[n,o]}var cat=e=>e!==e;function OA(e){if(typeof e!=="object"||e===null)return cat(e)?cat:r=>r===e;if(e instanceof Date){let r=e.valueOf();return i=>i instanceof Date?i.valueOf()===r:!1}return ArrayBuffer.isView(e)?r=>r?GL(e,r):!1:e instanceof Map?bIt(e):Array.isArray(e)?xIt(e):e instanceof zi?vIt(e):wIt(e,!0)}function xIt(e){let t=[];for(let r=-1,i=e.length;++r<i;)t[r]=OA(e[r]);return c8(t)}function bIt(e){let t=-1,r=[];for(let i of e.values())r[++t]=OA(i);return c8(r)}function vIt(e){let t=[];for(let r=-1,i=e.length;++r<i;)t[r]=OA(e.get(r));return c8(t)}function wIt(e,t=!1){let r=Object.keys(e);if(!t&&r.length===0)return()=>!1;let i=[];for(let s=-1,n=r.length;++s<n;)i[s]=OA(e[r[s]]);return c8(i,r)}function c8(e,t){return r=>{if(!r||typeof r!="object")return!1;switch(r.constructor){case Array:return TIt(e,r);case Map:return uat(e,r,r.keys());case Gp:case kA:case Object:case void 0:return uat(e,r,t||Object.keys(r))}return r instanceof zi?SIt(e,r):!1}}function TIt(e,t){let r=e.length;if(t.length!==r)return!1;for(let i=-1;++i<r;)if(!e[i](t[i]))return!1;return!0}function SIt(e,t){let r=e.length;if(t.length!==r)return!1;for(let i=-1;++i<r;)if(!e[i](t.get(i)))return!1;return!0}function uat(e,t,r){let i=r[Symbol.iterator](),s=t instanceof Map?t.keys():Object.keys(t)[Symbol.iterator](),n=t instanceof Map?t.values():Object.values(t)[Symbol.iterator](),o=0,a=e.length,h=n.next(),p=i.next(),g=s.next();for(;o<a&&!p.done&&!g.done&&!h.done&&!(p.value!==g.value||!e[o](h.value));++o,p=i.next(),g=s.next(),h=n.next());return o===a&&p.done&&g.done&&h.done?!0:(i.return&&i.return(),s.return&&s.return(),n.return&&n.return(),!1)}var yF={};Ua(yF,{BitIterator:()=>w_,getBit:()=>hat,getBool:()=>h8,packBools:()=>S_,popcnt_array:()=>fat,popcnt_bit_range:()=>TS,popcnt_uint32:()=>u8,setBool:()=>EIt,truncateBitmap:()=>T_});function h8(e,t,r,i){return(r&1<<i)!==0}function hat(e,t,r,i){return(r&1<<i)>>i}function EIt(e,t,r){return r?!!(e[t>>3]|=1<<t%8)||!0:!(e[t>>3]&=~(1<<t%8))&&!1}function T_(e,t,r){let i=r.byteLength+7&-8;if(e>0||r.byteLength<i){let s=new Uint8Array(i);return s.set(e%8===0?r.subarray(e>>3):S_(new w_(r,e,t,null,h8)).subarray(0,i)),s}return r}function S_(e){let t=[],r=0,i=0,s=0;for(let o of e)o&&(s|=1<<i),++i===8&&(t[r++]=s,s=i=0);(r===0||i>0)&&(t[r++]=s);let n=new Uint8Array(t.length+7&-8);return n.set(t),n}var w_=class{constructor(t,r,i,s,n){this.bytes=t,this.length=i,this.context=s,this.get=n,this.bit=r%8,this.byteIndex=r>>3,this.byte=t[this.byteIndex++],this.index=0}next(){return this.index<this.length?(this.bit===8&&(this.bit=0,this.byte=this.bytes[this.byteIndex++]),{value:this.get(this.context,this.index++,this.byte,this.bit++)}):{done:!0,value:null}}[Symbol.iterator](){return this}};function TS(e,t,r){if(r-t<=0)return 0;if(r-t<8){let n=0;for(let o of new w_(e,t,r-t,e,hat))n+=o;return n}let i=r>>3<<3,s=t+(t%8===0?0:8-t%8);return TS(e,t,s)+TS(e,i,r)+fat(e,s>>3,i-s>>3)}function fat(e,t,r){let i=0,s=Math.trunc(t),n=new DataView(e.buffer,e.byteOffset,e.byteLength),o=r===void 0?e.byteLength:s+r;for(;o-s>=4;)i+=u8(n.getUint32(s)),s+=4;for(;o-s>=2;)i+=u8(n.getUint16(s)),s+=2;for(;o-s>=1;)i+=u8(n.getUint8(s)),s+=1;return i}function u8(e){let t=Math.trunc(e);return t=t-(t>>>1&1431655765),t=(t&858993459)+(t>>>2&858993459),(t+(t>>>4)&252645135)*16843009>>>24}var IIt=-1,gn=class e{get typeId(){return this.type.typeId}get ArrayType(){return this.type.ArrayType}get buffers(){return[this.valueOffsets,this.values,this.nullBitmap,this.typeIds]}get nullable(){if(this._nullCount!==0){let{type:t}=this;return xr.isSparseUnion(t)?this.children.some(r=>r.nullable):xr.isDenseUnion(t)?this.children.some(r=>r.nullable):this.nullBitmap&&this.nullBitmap.byteLength>0}return!0}get byteLength(){let t=0,{valueOffsets:r,values:i,nullBitmap:s,typeIds:n}=this;return r&&(t+=r.byteLength),i&&(t+=i.byteLength),s&&(t+=s.byteLength),n&&(t+=n.byteLength),this.children.reduce((o,a)=>o+a.byteLength,t)}get nullCount(){if(xr.isUnion(this.type))return this.children.reduce((i,s)=>i+s.nullCount,0);let t=this._nullCount,r;return t<=IIt&&(r=this.nullBitmap)&&(this._nullCount=t=this.length-TS(r,this.offset,this.offset+this.length)),t}constructor(t,r,i,s,n,o=[],a){this.type=t,this.children=o,this.dictionary=a,this.offset=Math.floor(Math.max(r||0,0)),this.length=Math.floor(Math.max(i||0,0)),this._nullCount=Math.floor(Math.max(s||0,-1));let h;n instanceof e?(this.stride=n.stride,this.values=n.values,this.typeIds=n.typeIds,this.nullBitmap=n.nullBitmap,this.valueOffsets=n.valueOffsets):(this.stride=Tu(t),n&&((h=n[0])&&(this.valueOffsets=h),(h=n[1])&&(this.values=h),(h=n[2])&&(this.nullBitmap=h),(h=n[3])&&(this.typeIds=h)))}getValid(t){let{type:r}=this;if(xr.isUnion(r)){let i=r,s=this.children[i.typeIdToChildIndex[this.typeIds[t]]],n=i.mode===us.Dense?this.valueOffsets[t]:t;return s.getValid(n)}if(this.nullable&&this.nullCount>0){let i=this.offset+t;return(this.nullBitmap[i>>3]&1<<i%8)!==0}return!0}setValid(t,r){let i,{type:s}=this;if(xr.isUnion(s)){let n=s,o=this.children[n.typeIdToChildIndex[this.typeIds[t]]],a=n.mode===us.Dense?this.valueOffsets[t]:t;i=o.getValid(a),o.setValid(a,r)}else{let{nullBitmap:n}=this,{offset:o,length:a}=this,h=o+t,p=1<<h%8,g=h>>3;(!n||n.byteLength<=g)&&(n=new Uint8Array((o+a+63&-64)>>3).fill(255),this.nullCount>0&&n.set(T_(o,a,this.nullBitmap),0),Object.assign(this,{nullBitmap:n,_nullCount:-1}));let v=n[g];i=(v&p)!==0,r?n[g]=v|p:n[g]=v&~p}return i!==!!r&&(this._nullCount=this.nullCount+(r?-1:1)),r}clone(t=this.type,r=this.offset,i=this.length,s=this._nullCount,n=this,o=this.children){return new e(t,r,i,s,n,o,this.dictionary)}slice(t,r){let{stride:i,typeId:s,children:n}=this,o=+(this._nullCount===0)-1,a=s===16?i:1,h=this._sliceBuffers(t,r,i,s);return this.clone(this.type,this.offset+t,r,o,h,n.length===0||this.valueOffsets?n:this._sliceChildren(n,a*t,a*r))}_changeLengthAndBackfillNullBitmap(t){if(this.typeId===Lt.Null)return this.clone(this.type,0,t,0);let{length:r,nullCount:i}=this,s=new Uint8Array((t+63&-64)>>3).fill(255,0,r>>3);s[r>>3]=(1<<r-(r&-8))-1,i>0&&s.set(T_(this.offset,r,this.nullBitmap),0);let n=this.buffers;return n[mh.VALIDITY]=s,this.clone(this.type,0,t,i+(t-r),n)}_sliceBuffers(t,r,i,s){let n,{buffers:o}=this;return(n=o[mh.TYPE])&&(o[mh.TYPE]=n.subarray(t,t+r)),(n=o[mh.OFFSET])&&(o[mh.OFFSET]=n.subarray(t,t+r+1))||(n=o[mh.DATA])&&(o[mh.DATA]=s===6?n:n.subarray(i*t,i*(t+r))),o}_sliceChildren(t,r,i){return t.map(s=>s.slice(r,i))}};gn.prototype.children=Object.freeze([]);var xF=class e extends Yr{visit(t){return this.getVisitFn(t.type).call(this,t)}visitNull(t){let{["type"]:r,["offset"]:i=0,["length"]:s=0}=t;return new gn(r,i,s,s)}visitBool(t){let{["type"]:r,["offset"]:i=0}=t,s=ii(t.nullBitmap),n=Ki(r.ArrayType,t.data),{["length"]:o=n.length>>3,["nullCount"]:a=t.nullBitmap?-1:0}=t;return new gn(r,i,o,a,[void 0,n,s])}visitInt(t){let{["type"]:r,["offset"]:i=0}=t,s=ii(t.nullBitmap),n=Ki(r.ArrayType,t.data),{["length"]:o=n.length,["nullCount"]:a=t.nullBitmap?-1:0}=t;return new gn(r,i,o,a,[void 0,n,s])}visitFloat(t){let{["type"]:r,["offset"]:i=0}=t,s=ii(t.nullBitmap),n=Ki(r.ArrayType,t.data),{["length"]:o=n.length,["nullCount"]:a=t.nullBitmap?-1:0}=t;return new gn(r,i,o,a,[void 0,n,s])}visitUtf8(t){let{["type"]:r,["offset"]:i=0}=t,s=ii(t.data),n=ii(t.nullBitmap),o=x_(t.valueOffsets),{["length"]:a=o.length-1,["nullCount"]:h=t.nullBitmap?-1:0}=t;return new gn(r,i,a,h,[o,s,n])}visitLargeUtf8(t){let{["type"]:r,["offset"]:i=0}=t,s=ii(t.data),n=ii(t.nullBitmap),o=zC(t.valueOffsets),{["length"]:a=o.length-1,["nullCount"]:h=t.nullBitmap?-1:0}=t;return new gn(r,i,a,h,[o,s,n])}visitBinary(t){let{["type"]:r,["offset"]:i=0}=t,s=ii(t.data),n=ii(t.nullBitmap),o=x_(t.valueOffsets),{["length"]:a=o.length-1,["nullCount"]:h=t.nullBitmap?-1:0}=t;return new gn(r,i,a,h,[o,s,n])}visitLargeBinary(t){let{["type"]:r,["offset"]:i=0}=t,s=ii(t.data),n=ii(t.nullBitmap),o=zC(t.valueOffsets),{["length"]:a=o.length-1,["nullCount"]:h=t.nullBitmap?-1:0}=t;return new gn(r,i,a,h,[o,s,n])}visitFixedSizeBinary(t){let{["type"]:r,["offset"]:i=0}=t,s=ii(t.nullBitmap),n=Ki(r.ArrayType,t.data),{["length"]:o=n.length/Tu(r),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new gn(r,i,o,a,[void 0,n,s])}visitDate(t){let{["type"]:r,["offset"]:i=0}=t,s=ii(t.nullBitmap),n=Ki(r.ArrayType,t.data),{["length"]:o=n.length/Tu(r),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new gn(r,i,o,a,[void 0,n,s])}visitTimestamp(t){let{["type"]:r,["offset"]:i=0}=t,s=ii(t.nullBitmap),n=Ki(r.ArrayType,t.data),{["length"]:o=n.length/Tu(r),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new gn(r,i,o,a,[void 0,n,s])}visitTime(t){let{["type"]:r,["offset"]:i=0}=t,s=ii(t.nullBitmap),n=Ki(r.ArrayType,t.data),{["length"]:o=n.length/Tu(r),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new gn(r,i,o,a,[void 0,n,s])}visitDecimal(t){let{["type"]:r,["offset"]:i=0}=t,s=ii(t.nullBitmap),n=Ki(r.ArrayType,t.data),{["length"]:o=n.length/Tu(r),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new gn(r,i,o,a,[void 0,n,s])}visitList(t){let{["type"]:r,["offset"]:i=0,["child"]:s}=t,n=ii(t.nullBitmap),o=x_(t.valueOffsets),{["length"]:a=o.length-1,["nullCount"]:h=t.nullBitmap?-1:0}=t;return new gn(r,i,a,h,[o,void 0,n],[s])}visitStruct(t){let{["type"]:r,["offset"]:i=0,["children"]:s=[]}=t,n=ii(t.nullBitmap),{length:o=s.reduce((h,{length:p})=>Math.max(h,p),0),nullCount:a=t.nullBitmap?-1:0}=t;return new gn(r,i,o,a,[void 0,void 0,n],s)}visitUnion(t){let{["type"]:r,["offset"]:i=0,["children"]:s=[]}=t,n=Ki(r.ArrayType,t.typeIds),{["length"]:o=n.length,["nullCount"]:a=-1}=t;if(xr.isSparseUnion(r))return new gn(r,i,o,a,[void 0,void 0,void 0,n],s);let h=x_(t.valueOffsets);return new gn(r,i,o,a,[h,void 0,void 0,n],s)}visitDictionary(t){let{["type"]:r,["offset"]:i=0}=t,s=ii(t.nullBitmap),n=Ki(r.indices.ArrayType,t.data),{["dictionary"]:o=new zi([new e().visit({type:r.dictionary})])}=t,{["length"]:a=n.length,["nullCount"]:h=t.nullBitmap?-1:0}=t;return new gn(r,i,a,h,[void 0,n,s],[],o)}visitInterval(t){let{["type"]:r,["offset"]:i=0}=t,s=ii(t.nullBitmap),n=Ki(r.ArrayType,t.data),{["length"]:o=n.length/Tu(r),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new gn(r,i,o,a,[void 0,n,s])}visitDuration(t){let{["type"]:r,["offset"]:i=0}=t,s=ii(t.nullBitmap),n=Ki(r.ArrayType,t.data),{["length"]:o=n.length,["nullCount"]:a=t.nullBitmap?-1:0}=t;return new gn(r,i,o,a,[void 0,n,s])}visitFixedSizeList(t){let{["type"]:r,["offset"]:i=0,["child"]:s=new e().visit({type:r.valueType})}=t,n=ii(t.nullBitmap),{["length"]:o=s.length/Tu(r),["nullCount"]:a=t.nullBitmap?-1:0}=t;return new gn(r,i,o,a,[void 0,void 0,n],[s])}visitMap(t){let{["type"]:r,["offset"]:i=0,["child"]:s=new e().visit({type:r.childType})}=t,n=ii(t.nullBitmap),o=x_(t.valueOffsets),{["length"]:a=o.length-1,["nullCount"]:h=t.nullBitmap?-1:0}=t;return new gn(r,i,a,h,[o,void 0,n],[s])}},MIt=new xF;function _i(e){return MIt.visit(e)}var SS=class{constructor(t=0,r){this.numChunks=t,this.getChunkIterator=r,this.chunkIndex=0,this.chunkIterator=this.getChunkIterator(0)}next(){for(;this.chunkIndex<this.numChunks;){let t=this.chunkIterator.next();if(!t.done)return t;++this.chunkIndex<this.numChunks&&(this.chunkIterator=this.getChunkIterator(this.chunkIndex))}return{done:!0,value:null}}[Symbol.iterator](){return this}};function pat(e){return e.some(t=>t.nullable)}function f8(e){return e.reduce((t,r)=>t+r.nullCount,0)}function p8(e){return e.reduce((t,r,i)=>(t[i+1]=t[i]+r.length,t),new Uint32Array(e.length+1))}function d8(e,t,r,i){let s=[];for(let n=-1,o=e.length;++n<o;){let a=e[n],h=t[n],{length:p}=a;if(h>=i)break;if(r>=h+p)continue;if(h>=r&&h+p<=i){s.push(a);continue}let g=Math.max(0,r-h),v=Math.min(i-h,p);s.push(a.slice(g,v-g))}return s.length===0&&s.push(e[0].slice(0,0)),s}function bF(e,t,r,i){let s=0,n=0,o=t.length-1;do{if(s>=o-1)return r<t[o]?i(e,s,r-t[s]):null;n=s+Math.trunc((o-s)*.5),r<t[n]?o=n:s=n}while(s<o)}function ES(e,t){return e.getValid(t)}function tb(e){function t(r,i,s){return e(r[i],s)}return function(r){let i=this.data;return bF(i,this._offsets,r,t)}}function m8(e){let t;function r(i,s,n){return e(i[s],n,t)}return function(i,s){let n=this.data;t=s;let o=bF(n,this._offsets,i,r);return t=void 0,o}}function A8(e){let t;function r(i,s,n){let o=n,a=0,h=0;for(let p=s-1,g=i.length;++p<g;){let v=i[p];if(~(a=e(v,t,o)))return h+a;o=0,h+=v.length}return-1}return function(i,s){t=i;let n=this.data,o=typeof s!="number"?r(n,0,0):bF(n,this._offsets,s,r);return t=void 0,o}}var Zr=class extends Yr{};function CIt(e,t){return t===null&&e.length>0?0:-1}function PIt(e,t){let{nullBitmap:r}=e;if(!r||e.nullCount<=0)return-1;let i=0;for(let s of new w_(r,e.offset+(t||0),e.length,r,h8)){if(!s)return i;++i}return-1}function Ti(e,t,r){if(t===void 0)return-1;if(t===null)switch(e.typeId){case Lt.Union:break;case Lt.Dictionary:break;default:return PIt(e,r)}let i=Yo.getVisitFn(e),s=OA(t);for(let n=(r||0)-1,o=e.length;++n<o;)if(s(i(e,n)))return n;return-1}function dat(e,t,r){let i=Yo.getVisitFn(e),s=OA(t);for(let n=(r||0)-1,o=e.length;++n<o;)if(s(i(e,n)))return n;return-1}Zr.prototype.visitNull=CIt;Zr.prototype.visitBool=Ti;Zr.prototype.visitInt=Ti;Zr.prototype.visitInt8=Ti;Zr.prototype.visitInt16=Ti;Zr.prototype.visitInt32=Ti;Zr.prototype.visitInt64=Ti;Zr.prototype.visitUint8=Ti;Zr.prototype.visitUint16=Ti;Zr.prototype.visitUint32=Ti;Zr.prototype.visitUint64=Ti;Zr.prototype.visitFloat=Ti;Zr.prototype.visitFloat16=Ti;Zr.prototype.visitFloat32=Ti;Zr.prototype.visitFloat64=Ti;Zr.prototype.visitUtf8=Ti;Zr.prototype.visitLargeUtf8=Ti;Zr.prototype.visitBinary=Ti;Zr.prototype.visitLargeBinary=Ti;Zr.prototype.visitFixedSizeBinary=Ti;Zr.prototype.visitDate=Ti;Zr.prototype.visitDateDay=Ti;Zr.prototype.visitDateMillisecond=Ti;Zr.prototype.visitTimestamp=Ti;Zr.prototype.visitTimestampSecond=Ti;Zr.prototype.visitTimestampMillisecond=Ti;Zr.prototype.visitTimestampMicrosecond=Ti;Zr.prototype.visitTimestampNanosecond=Ti;Zr.prototype.visitTime=Ti;Zr.prototype.visitTimeSecond=Ti;Zr.prototype.visitTimeMillisecond=Ti;Zr.prototype.visitTimeMicrosecond=Ti;Zr.prototype.visitTimeNanosecond=Ti;Zr.prototype.visitDecimal=Ti;Zr.prototype.visitList=Ti;Zr.prototype.visitStruct=Ti;Zr.prototype.visitUnion=Ti;Zr.prototype.visitDenseUnion=dat;Zr.prototype.visitSparseUnion=dat;Zr.prototype.visitDictionary=Ti;Zr.prototype.visitInterval=Ti;Zr.prototype.visitIntervalDayTime=Ti;Zr.prototype.visitIntervalYearMonth=Ti;Zr.prototype.visitDuration=Ti;Zr.prototype.visitDurationSecond=Ti;Zr.prototype.visitDurationMillisecond=Ti;Zr.prototype.visitDurationMicrosecond=Ti;Zr.prototype.visitDurationNanosecond=Ti;Zr.prototype.visitFixedSizeList=Ti;Zr.prototype.visitMap=Ti;var E_=new Zr;var Gr=class extends Yr{};function ui(e){let{type:t}=e;if(e.nullCount===0&&e.stride===1&&(t.typeId===Lt.Timestamp||t instanceof _o&&t.bitWidth!==64||t instanceof Cl&&t.bitWidth!==64||t instanceof tc&&t.precision!==rs.HALF))return new SS(e.data.length,i=>{let s=e.data[i];return s.values.subarray(0,s.length)[Symbol.iterator]()});let r=0;return new SS(e.data.length,i=>{let n=e.data[i].length,o=e.slice(r,r+n);return r+=n,new vF(o)})}var vF=class{constructor(t){this.vector=t,this.index=0}next(){return this.index<this.vector.length?{value:this.vector.get(this.index++)}:{done:!0,value:null}}[Symbol.iterator](){return this}};Gr.prototype.visitNull=ui;Gr.prototype.visitBool=ui;Gr.prototype.visitInt=ui;Gr.prototype.visitInt8=ui;Gr.prototype.visitInt16=ui;Gr.prototype.visitInt32=ui;Gr.prototype.visitInt64=ui;Gr.prototype.visitUint8=ui;Gr.prototype.visitUint16=ui;Gr.prototype.visitUint32=ui;Gr.prototype.visitUint64=ui;Gr.prototype.visitFloat=ui;Gr.prototype.visitFloat16=ui;Gr.prototype.visitFloat32=ui;Gr.prototype.visitFloat64=ui;Gr.prototype.visitUtf8=ui;Gr.prototype.visitLargeUtf8=ui;Gr.prototype.visitBinary=ui;Gr.prototype.visitLargeBinary=ui;Gr.prototype.visitFixedSizeBinary=ui;Gr.prototype.visitDate=ui;Gr.prototype.visitDateDay=ui;Gr.prototype.visitDateMillisecond=ui;Gr.prototype.visitTimestamp=ui;Gr.prototype.visitTimestampSecond=ui;Gr.prototype.visitTimestampMillisecond=ui;Gr.prototype.visitTimestampMicrosecond=ui;Gr.prototype.visitTimestampNanosecond=ui;Gr.prototype.visitTime=ui;Gr.prototype.visitTimeSecond=ui;Gr.prototype.visitTimeMillisecond=ui;Gr.prototype.visitTimeMicrosecond=ui;Gr.prototype.visitTimeNanosecond=ui;Gr.prototype.visitDecimal=ui;Gr.prototype.visitList=ui;Gr.prototype.visitStruct=ui;Gr.prototype.visitUnion=ui;Gr.prototype.visitDenseUnion=ui;Gr.prototype.visitSparseUnion=ui;Gr.prototype.visitDictionary=ui;Gr.prototype.visitInterval=ui;Gr.prototype.visitIntervalDayTime=ui;Gr.prototype.visitIntervalYearMonth=ui;Gr.prototype.visitDuration=ui;Gr.prototype.visitDurationSecond=ui;Gr.prototype.visitDurationMillisecond=ui;Gr.prototype.visitDurationMicrosecond=ui;Gr.prototype.visitDurationNanosecond=ui;Gr.prototype.visitFixedSizeList=ui;Gr.prototype.visitMap=ui;var eb=new Gr;var mat,Aat={},gat={},zi=class e{constructor(t){var r,i,s;let n=t[0]instanceof e?t.flatMap(a=>a.data):t;if(n.length===0||n.some(a=>!(a instanceof gn)))throw new TypeError("Vector constructor expects an Array of Data instances.");let o=(r=n[0])===null||r===void 0?void 0:r.type;switch(n.length){case 0:this._offsets=[0];break;case 1:{let{get:a,set:h,indexOf:p}=Aat[o.typeId],g=n[0];this.isValid=v=>ES(g,v),this.get=v=>a(g,v),this.set=(v,T)=>h(g,v,T),this.indexOf=v=>p(g,v),this._offsets=[0,g.length];break}default:Object.setPrototypeOf(this,gat[o.typeId]),this._offsets=p8(n);break}this.data=n,this.type=o,this.stride=Tu(o),this.numChildren=(s=(i=o.children)===null||i===void 0?void 0:i.length)!==null&&s!==void 0?s:0,this.length=this._offsets.at(-1)}get byteLength(){return this.data.reduce((t,r)=>t+r.byteLength,0)}get nullable(){return pat(this.data)}get nullCount(){return f8(this.data)}get ArrayType(){return this.type.ArrayType}get[Symbol.toStringTag](){return`${this.VectorName}<${this.type[Symbol.toStringTag]}>`}get VectorName(){return`${Lt[this.type.typeId]}Vector`}isValid(t){return!1}get(t){return null}set(t,r){}indexOf(t,r){return-1}includes(t,r){return this.indexOf(t,r)>-1}[Symbol.iterator](){return eb.visit(this)}concat(...t){return new e(this.data.concat(t.flatMap(r=>r.data).flat(Number.POSITIVE_INFINITY)))}slice(t,r){return new e(wS(this,t,r,({data:i,_offsets:s},n,o)=>d8(i,s,n,o)))}toJSON(){return[...this]}toArray(){let{type:t,data:r,length:i,stride:s,ArrayType:n}=this;switch(t.typeId){case Lt.Int:case Lt.Float:case Lt.Decimal:case Lt.Time:case Lt.Timestamp:switch(r.length){case 0:return new n;case 1:return r[0].values.subarray(0,i*s);default:return r.reduce((o,{values:a,length:h})=>(o.array.set(a.subarray(0,h*s),o.offset),o.offset+=h*s,o),{array:new n(i*s),offset:0}).array}}return[...this]}toString(){return`[${[...this].join(",")}]`}getChild(t){var r;return this.getChildAt((r=this.type.children)===null||r===void 0?void 0:r.findIndex(i=>i.name===t))}getChildAt(t){return t>-1&&t<this.numChildren?new e(this.data.map(({children:r})=>r[t])):null}get isMemoized(){return xr.isDictionary(this.type)?this.data[0].dictionary.isMemoized:!1}memoize(){if(xr.isDictionary(this.type)){let t=new g8(this.data[0].dictionary),r=this.data.map(i=>{let s=i.clone();return s.dictionary=t,s});return new e(r)}return new g8(this)}unmemoize(){if(xr.isDictionary(this.type)&&this.isMemoized){let t=this.data[0].dictionary.unmemoize(),r=this.data.map(i=>{let s=i.clone();return s.dictionary=t,s});return new e(r)}return this}};mat=Symbol.toStringTag;zi[mat]=(e=>{e.type=xr.prototype,e.data=[],e.length=0,e.stride=1,e.numChildren=0,e._offsets=new Uint32Array([0]),e[Symbol.isConcatSpreadable]=!0;let t=Object.keys(Lt).map(r=>Lt[r]).filter(r=>typeof r=="number"&&r!==Lt.NONE);for(let r of t){let i=Yo.getVisitFnByTypeId(r),s=Ga.getVisitFnByTypeId(r),n=E_.getVisitFnByTypeId(r);Aat[r]={get:i,set:s,indexOf:n},gat[r]=Object.create(e,{isValid:{value:tb(ES)},get:{value:tb(Yo.getVisitFnByTypeId(r))},set:{value:m8(Ga.getVisitFnByTypeId(r))},indexOf:{value:A8(E_.getVisitFnByTypeId(r))}})}return"Vector"})(zi.prototype);var g8=class e extends zi{constructor(t){super(t.data);let r=this.get,i=this.set,s=this.slice,n=new Array(this.length);Object.defineProperty(this,"get",{value(o){let a=n[o];if(a!==void 0)return a;let h=r.call(this,o);return n[o]=h,h}}),Object.defineProperty(this,"set",{value(o,a){i.call(this,o,a),n[o]=a}}),Object.defineProperty(this,"slice",{value:(o,a)=>new e(s.call(this,o,a))}),Object.defineProperty(this,"isMemoized",{value:!0}),Object.defineProperty(this,"unmemoize",{value:()=>new zi(this.data)}),Object.defineProperty(this,"memoize",{value:()=>this})}};function _at(e){if(!e||e.length<=0)return function(s){return!0};let t="",r=e.filter(i=>i===i);return r.length>0&&(t=`
    switch (x) {${r.map(i=>`
        case ${RIt(i)}:`).join("")}
            return false;
    }`),e.length!==r.length&&(t=`if (x !== x) return false;
${t}`),new Function("x",`${t}
return true;`)}function RIt(e){return typeof e!="bigint"?Ef(e):`${Ef(e)}n`}function wF(e,t){let r=Math.ceil(e)*t-1;return(r-r%64+64||64)/t}function yat(e,t=0){return e.length>=t?e.subarray(0,t):aS(new e.constructor(t),e,0)}var Cf=class{constructor(t,r=0,i=1){this.length=Math.ceil(r/i),this.buffer=new t(this.length),this.stride=i,this.BYTES_PER_ELEMENT=t.BYTES_PER_ELEMENT,this.ArrayType=t}get byteLength(){return Math.ceil(this.length*this.stride)*this.BYTES_PER_ELEMENT}get reservedLength(){return this.buffer.length/this.stride}get reservedByteLength(){return this.buffer.byteLength}set(t,r){return this}append(t){return this.set(this.length,t)}reserve(t){if(t>0){this.length+=t;let r=this.stride,i=this.length*r,s=this.buffer.length;i>=s&&this._resize(s===0?wF(i*1,this.BYTES_PER_ELEMENT):wF(i*2,this.BYTES_PER_ELEMENT))}return this}flush(t=this.length){t=wF(t*this.stride,this.BYTES_PER_ELEMENT);let r=yat(this.buffer,t);return this.clear(),r}clear(){return this.length=0,this.buffer=new this.ArrayType,this}_resize(t){return this.buffer=yat(this.buffer,t)}},k0=class extends Cf{last(){return this.get(this.length-1)}get(t){return this.buffer[t]}set(t,r){return this.reserve(t-this.length+1),this.buffer[t*this.stride]=r,this}},rb=class extends k0{constructor(){super(Uint8Array,0,1/8),this.numValid=0}get numInvalid(){return this.length-this.numValid}get(t){return this.buffer[t>>3]>>t%8&1}set(t,r){let{buffer:i}=this.reserve(t-this.length+1),s=t>>3,n=t%8,o=i[s]>>n&1;return r?o===0&&(i[s]|=1<<n,++this.numValid):o===1&&(i[s]&=~(1<<n),--this.numValid),this}clear(){return this.numValid=0,super.clear()}},ib=class extends k0{constructor(t){super(t.OffsetArrayType,1,1)}append(t){return this.set(this.length-1,t)}set(t,r){let i=this.length-1,s=this.reserve(t-i+1).buffer;return i<t++&&i>=0&&s.fill(s[i],i,t),s[t]=s[t-1]+r,this}flush(t=this.length-1){return t>this.length&&this.set(t-1,this.BYTES_PER_ELEMENT>4?BigInt(0):0),super.flush(t+1)}};var Fs=class{static throughNode(t){throw new Error('"throughNode" not available in this environment')}static throughDOM(t){throw new Error('"throughDOM" not available in this environment')}constructor({type:t,nullValues:r}){this.length=0,this.finished=!1,this.type=t,this.children=[],this.nullValues=r,this.stride=Tu(t),this._nulls=new rb,r&&r.length>0&&(this._isValid=_at(r))}toVector(){return new zi([this.flush()])}get ArrayType(){return this.type.ArrayType}get nullCount(){return this._nulls.numInvalid}get numChildren(){return this.children.length}get byteLength(){let t=0,{_offsets:r,_values:i,_nulls:s,_typeIds:n,children:o}=this;return r&&(t+=r.byteLength),i&&(t+=i.byteLength),s&&(t+=s.byteLength),n&&(t+=n.byteLength),o.reduce((a,h)=>a+h.byteLength,t)}get reservedLength(){return this._nulls.reservedLength}get reservedByteLength(){let t=0;return this._offsets&&(t+=this._offsets.reservedByteLength),this._values&&(t+=this._values.reservedByteLength),this._nulls&&(t+=this._nulls.reservedByteLength),this._typeIds&&(t+=this._typeIds.reservedByteLength),this.children.reduce((r,i)=>r+i.reservedByteLength,t)}get valueOffsets(){return this._offsets?this._offsets.buffer:null}get values(){return this._values?this._values.buffer:null}get nullBitmap(){return this._nulls?this._nulls.buffer:null}get typeIds(){return this._typeIds?this._typeIds.buffer:null}append(t){return this.set(this.length,t)}isValid(t){return this._isValid(t)}set(t,r){return this.setValid(t,this.isValid(r))&&this.setValue(t,r),this}setValue(t,r){this._setValue(this,t,r)}setValid(t,r){return this.length=this._nulls.set(t,+r).length,r}addChild(t,r=`${this.numChildren}`){throw new Error(`Cannot append children to non-nested type "${this.type}"`)}getChildAt(t){return this.children[t]||null}flush(){let t,r,i,s,{type:n,length:o,nullCount:a,_typeIds:h,_offsets:p,_values:g,_nulls:v}=this;(r=h?.flush(o))?s=p?.flush(o):(s=p?.flush(o))?t=g?.flush(p.last()):t=g?.flush(o),a>0&&(i=v?.flush(o));let T=this.children.map(C=>C.flush());return this.clear(),_i({type:n,length:o,nullCount:a,children:T,child:T[0],data:t,typeIds:r,nullBitmap:i,valueOffsets:s})}finish(){this.finished=!0;for(let t of this.children)t.finish();return this}clear(){var t,r,i,s;this.length=0,(t=this._nulls)===null||t===void 0||t.clear(),(r=this._values)===null||r===void 0||r.clear(),(i=this._offsets)===null||i===void 0||i.clear(),(s=this._typeIds)===null||s===void 0||s.clear();for(let n of this.children)n.clear();return this}};Fs.prototype.length=1;Fs.prototype.stride=1;Fs.prototype.children=null;Fs.prototype.finished=!1;Fs.prototype.nullValues=null;Fs.prototype._isValid=()=>!0;var Xo=class extends Fs{constructor(t){super(t),this._values=new k0(this.ArrayType,0,this.stride)}setValue(t,r){let i=this._values;return i.reserve(t-i.length+1),super.setValue(t,r)}},zc=class extends Fs{constructor(t){super(t),this._pendingLength=0,this._offsets=new ib(t.type)}setValue(t,r){let i=this._pending||(this._pending=new Map),s=i.get(t);s&&(this._pendingLength-=s.length),this._pendingLength+=r instanceof Gp?r[vh].length:r.length,i.set(t,r)}setValid(t,r){return super.setValid(t,r)?!0:((this._pending||(this._pending=new Map)).set(t,void 0),!1)}clear(){return this._pendingLength=0,this._pending=void 0,super.clear()}flush(){return this._flush(),super.flush()}finish(){return this._flush(),super.finish()}_flush(){let t=this._pending,r=this._pendingLength;return this._pendingLength=0,this._pending=void 0,t&&t.size>0&&this._flushPending(t,r),this}};var I_=class{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}offset(){return this.bb.readInt64(this.bb_pos)}metaDataLength(){return this.bb.readInt32(this.bb_pos+8)}bodyLength(){return this.bb.readInt64(this.bb_pos+16)}static sizeOf(){return 24}static createBlock(t,r,i,s){return t.prep(8,24),t.writeInt64(BigInt(s??0)),t.pad(4),t.writeInt32(i),t.writeInt64(BigInt(r??0)),t.offset()}};var Su=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsFooter(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFooter(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}version(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Wn.V1}schema(t){let r=this.bb.__offset(this.bb_pos,6);return r?(t||new Nc).__init(this.bb.__indirect(this.bb_pos+r),this.bb):null}dictionaries(t,r){let i=this.bb.__offset(this.bb_pos,8);return i?(r||new I_).__init(this.bb.__vector(this.bb_pos+i)+t*24,this.bb):null}dictionariesLength(){let t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}recordBatches(t,r){let i=this.bb.__offset(this.bb_pos,10);return i?(r||new I_).__init(this.bb.__vector(this.bb_pos+i)+t*24,this.bb):null}recordBatchesLength(){let t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__vector_len(this.bb_pos+t):0}customMetadata(t,r){let i=this.bb.__offset(this.bb_pos,12);return i?(r||new sa).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+t*4),this.bb):null}customMetadataLength(){let t=this.bb.__offset(this.bb_pos,12);return t?this.bb.__vector_len(this.bb_pos+t):0}static startFooter(t){t.startObject(5)}static addVersion(t,r){t.addFieldInt16(0,r,Wn.V1)}static addSchema(t,r){t.addFieldOffset(1,r,0)}static addDictionaries(t,r){t.addFieldOffset(2,r,0)}static startDictionariesVector(t,r){t.startVector(24,r,8)}static addRecordBatches(t,r){t.addFieldOffset(3,r,0)}static startRecordBatchesVector(t,r){t.startVector(24,r,8)}static addCustomMetadata(t,r){t.addFieldOffset(4,r,0)}static createCustomMetadataVector(t,r){t.startVector(4,r.length,4);for(let i=r.length-1;i>=0;i--)t.addOffset(r[i]);return t.endVector()}static startCustomMetadataVector(t,r){t.startVector(4,r,4)}static endFooter(t){return t.endObject()}static finishFooterBuffer(t,r){t.finish(r)}static finishSizePrefixedFooterBuffer(t,r){t.finish(r,void 0,!0)}};var Fn=class e{constructor(t=[],r,i,s=Wn.V5){this.fields=t||[],this.metadata=r||new Map,i||(i=TF(t)),this.dictionaries=i,this.metadataVersion=s}get[Symbol.toStringTag](){return"Schema"}get names(){return this.fields.map(t=>t.name)}toString(){return`Schema<{ ${this.fields.map((t,r)=>`${r}: ${t}`).join(", ")} }>`}select(t){let r=new Set(t),i=this.fields.filter(s=>r.has(s.name));return new e(i,this.metadata)}selectAt(t){let r=t.map(i=>this.fields[i]).filter(Boolean);return new e(r,this.metadata)}assign(...t){let r=t[0]instanceof e?t[0]:Array.isArray(t[0])?new e(t[0]):new e(t),i=[...this.fields],s=_8(_8(new Map,this.metadata),r.metadata),n=r.fields.filter(a=>{let h=i.findIndex(p=>p.name===a.name);return~h?(i[h]=a.clone({metadata:_8(_8(new Map,i[h].metadata),a.metadata)}))&&!1:!0}),o=TF(n,new Map);return new e([...i,...n],s,new Map([...this.dictionaries,...o]))}};Fn.prototype.fields=null;Fn.prototype.metadata=null;Fn.prototype.dictionaries=null;var Ui=class e{static new(...t){let[r,i,s,n]=t;return t[0]&&typeof t[0]=="object"&&({name:r}=t[0],i===void 0&&(i=t[0].type),s===void 0&&(s=t[0].nullable),n===void 0&&(n=t[0].metadata)),new e(`${r}`,i,s,n)}constructor(t,r,i=!1,s){this.name=t,this.type=r,this.nullable=i,this.metadata=s||new Map}get typeId(){return this.type.typeId}get[Symbol.toStringTag](){return"Field"}toString(){return`${this.name}: ${this.type}`}clone(...t){let[r,i,s,n]=t;return!t[0]||typeof t[0]!="object"?[r=this.name,i=this.type,s=this.nullable,n=this.metadata]=t:{name:r=this.name,type:i=this.type,nullable:s=this.nullable,metadata:n=this.metadata}=t[0],e.new(r,i,s,n)}};Ui.prototype.type=null;Ui.prototype.name=null;Ui.prototype.nullable=null;Ui.prototype.metadata=null;function _8(e,t){return new Map([...e||new Map,...t||new Map])}function TF(e,t=new Map){for(let r=-1,i=e.length;++r<i;){let n=e[r].type;if(xr.isDictionary(n)){if(!t.has(n.id))t.set(n.id,n.dictionary);else if(t.get(n.id)!==n.dictionary)throw new Error("Cannot create Schema containing two different dictionaries with the same Id")}n.children&&n.children.length>0&&TF(n.children,t)}return t}var kIt=b_,DIt=bu,D0=class{static decode(t){t=new DIt(ii(t));let r=Su.getRootAsFooter(t),i=Fn.decode(r.schema(),new Map,r.version());return new SF(i,r)}static encode(t){let r=new kIt,i=Fn.encode(r,t.schema);Su.startRecordBatchesVector(r,t.numRecordBatches);for(let o of[...t.recordBatches()].slice().reverse())O0.encode(r,o);let s=r.endVector();Su.startDictionariesVector(r,t.numDictionaries);for(let o of[...t.dictionaryBatches()].slice().reverse())O0.encode(r,o);let n=r.endVector();return Su.startFooter(r),Su.addSchema(r,i),Su.addVersion(r,Wn.V5),Su.addRecordBatches(r,s),Su.addDictionaries(r,n),Su.finishFooterBuffer(r,Su.endFooter(r)),r.asUint8Array()}get numRecordBatches(){return this._recordBatches.length}get numDictionaries(){return this._dictionaryBatches.length}constructor(t,r=Wn.V5,i,s){this.schema=t,this.version=r,i&&(this._recordBatches=i),s&&(this._dictionaryBatches=s)}*recordBatches(){for(let t,r=-1,i=this.numRecordBatches;++r<i;)(t=this.getRecordBatch(r))&&(yield t)}*dictionaryBatches(){for(let t,r=-1,i=this.numDictionaries;++r<i;)(t=this.getDictionaryBatch(r))&&(yield t)}getRecordBatch(t){return t>=0&&t<this.numRecordBatches&&this._recordBatches[t]||null}getDictionaryBatch(t){return t>=0&&t<this.numDictionaries&&this._dictionaryBatches[t]||null}};var SF=class extends D0{get numRecordBatches(){return this._footer.recordBatchesLength()}get numDictionaries(){return this._footer.dictionariesLength()}constructor(t,r){super(t,r.version()),this._footer=r}getRecordBatch(t){if(t>=0&&t<this.numRecordBatches){let r=this._footer.recordBatches(t);if(r)return O0.decode(r)}return null}getDictionaryBatch(t){if(t>=0&&t<this.numDictionaries){let r=this._footer.dictionaries(t);if(r)return O0.decode(r)}return null}},O0=class e{static decode(t){return new e(t.metaDataLength(),t.bodyLength(),t.offset())}static encode(t,r){let{metaDataLength:i}=r,s=BigInt(r.offset),n=BigInt(r.bodyLength);return I_.createBlock(t,s,i,n)}constructor(t,r,i){this.metaDataLength=t,this.offset=no(i),this.bodyLength=no(r)}};var Cs=Object.freeze({done:!0,value:void 0}),IS=class{constructor(t){this._json=t}get schema(){return this._json.schema}get batches(){return this._json.batches||[]}get dictionaries(){return this._json.dictionaries||[]}},M_=class{tee(){return this._getDOMStream().tee()}pipe(t,r){return this._getNodeStream().pipe(t,r)}pipeTo(t,r){return this._getDOMStream().pipeTo(t,r)}pipeThrough(t,r){return this._getDOMStream().pipeThrough(t,r)}_getDOMStream(){return this._DOMStream||(this._DOMStream=this.toDOMStream())}_getNodeStream(){return this._nodeStream||(this._nodeStream=this.toNodeStream())}},y8=class extends M_{constructor(){super(),this._values=[],this.resolvers=[],this._closedPromise=new Promise(t=>this._closedPromiseResolve=t)}get closed(){return this._closedPromise}cancel(t){return _r(this,void 0,void 0,function*(){yield this.return(t)})}write(t){this._ensureOpen()&&(this.resolvers.length<=0?this._values.push(t):this.resolvers.shift().resolve({done:!1,value:t}))}abort(t){this._closedPromiseResolve&&(this.resolvers.length<=0?this._error={error:t}:this.resolvers.shift().reject({done:!0,value:t}))}close(){if(this._closedPromiseResolve){let{resolvers:t}=this;for(;t.length>0;)t.shift().resolve(Cs);this._closedPromiseResolve(),this._closedPromiseResolve=void 0}}[Symbol.asyncIterator](){return this}toDOMStream(t){return Za.toDOMStream(this._closedPromiseResolve||this._error?this:this._values,t)}toNodeStream(t){return Za.toNodeStream(this._closedPromiseResolve||this._error?this:this._values,t)}throw(t){return _r(this,void 0,void 0,function*(){return yield this.abort(t),Cs})}return(t){return _r(this,void 0,void 0,function*(){return yield this.close(),Cs})}read(t){return _r(this,void 0,void 0,function*(){return(yield this.next(t,"read")).value})}peek(t){return _r(this,void 0,void 0,function*(){return(yield this.next(t,"peek")).value})}next(...t){return this._values.length>0?Promise.resolve({done:!1,value:this._values.shift()}):this._error?Promise.reject({done:!0,value:this._error.error}):this._closedPromiseResolve?new Promise((r,i)=>{this.resolvers.push({resolve:r,reject:i})}):Promise.resolve(Cs)}_ensureOpen(){if(this._closedPromiseResolve)return!0;throw new Error("AsyncQueue is closed")}};var Qp=class extends y8{write(t){if((t=ii(t)).byteLength>0)return super.write(t)}toString(t=!1){return t?sS(this.toUint8Array(!0)):this.toUint8Array(!1).then(sS)}toUint8Array(t=!1){return t?xu(this._values)[0]:_r(this,void 0,void 0,function*(){var r,i,s,n;let o=[],a=0;try{for(var h=!0,p=xf(this),g;g=yield p.next(),r=g.done,!r;h=!0){n=g.value,h=!1;let v=n;o.push(v),a+=v.byteLength}}catch(v){i={error:v}}finally{try{!h&&!r&&(s=p.return)&&(yield s.call(p))}finally{if(i)throw i.error}}return xu(o,a)[0]})}},Kp=class{constructor(t){t&&(this.source=new EF(Za.fromIterable(t)))}[Symbol.iterator](){return this}next(t){return this.source.next(t)}throw(t){return this.source.throw(t)}return(t){return this.source.return(t)}peek(t){return this.source.peek(t)}read(t){return this.source.read(t)}},wh=class e{constructor(t){t instanceof e?this.source=t.source:t instanceof Qp?this.source=new B0(Za.fromAsyncIterable(t)):FC(t)?this.source=new B0(Za.fromNodeStream(t)):oS(t)?this.source=new B0(Za.fromDOMStream(t)):NC(t)?this.source=new B0(Za.fromDOMStream(t.body)):bf(t)?this.source=new B0(Za.fromIterable(t)):yu(t)?this.source=new B0(Za.fromAsyncIterable(t)):ph(t)&&(this.source=new B0(Za.fromAsyncIterable(t)))}[Symbol.asyncIterator](){return this}next(t){return this.source.next(t)}throw(t){return this.source.throw(t)}return(t){return this.source.return(t)}get closed(){return this.source.closed}cancel(t){return this.source.cancel(t)}peek(t){return this.source.peek(t)}read(t){return this.source.read(t)}},EF=class{constructor(t){this.source=t}cancel(t){this.return(t)}peek(t){return this.next(t,"peek").value}read(t){return this.next(t,"read").value}next(t,r="read"){return this.source.next({cmd:r,size:t})}throw(t){return Object.create(this.source.throw&&this.source.throw(t)||Cs)}return(t){return Object.create(this.source.return&&this.source.return(t)||Cs)}},B0=class{constructor(t){this.source=t,this._closedPromise=new Promise(r=>this._closedPromiseResolve=r)}cancel(t){return _r(this,void 0,void 0,function*(){yield this.return(t)})}get closed(){return this._closedPromise}read(t){return _r(this,void 0,void 0,function*(){return(yield this.next(t,"read")).value})}peek(t){return _r(this,void 0,void 0,function*(){return(yield this.next(t,"peek")).value})}next(t,r="read"){return _r(this,void 0,void 0,function*(){return yield this.source.next({cmd:r,size:t})})}throw(t){return _r(this,void 0,void 0,function*(){let r=this.source.throw&&(yield this.source.throw(t))||Cs;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(r)})}return(t){return _r(this,void 0,void 0,function*(){let r=this.source.return&&(yield this.source.return(t))||Cs;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(r)})}};var MS=class extends Kp{constructor(t,r){super(),this.position=0,this.buffer=ii(t),this.size=r===void 0?this.buffer.byteLength:r}readInt32(t){let{buffer:r,byteOffset:i}=this.readAt(t,4);return new DataView(r,i).getInt32(0,!0)}seek(t){return this.position=Math.min(t,this.size),t<this.size}read(t){let{buffer:r,size:i,position:s}=this;return r&&s<i?(typeof t!="number"&&(t=Number.POSITIVE_INFINITY),this.position=Math.min(i,s+Math.min(i-s,t)),r.subarray(s,this.position)):null}readAt(t,r){let i=this.buffer,s=Math.min(this.size,t+r);return i?i.subarray(t,s):new Uint8Array(r)}close(){this.buffer&&(this.buffer=null)}throw(t){return this.close(),{done:!0,value:t}}return(t){return this.close(),{done:!0,value:t}}},BA=class extends wh{constructor(t,r){super(),this.position=0,this._handle=t,typeof r=="number"?this.size=r:this._pending=_r(this,void 0,void 0,function*(){this.size=(yield t.stat()).size,delete this._pending})}readInt32(t){return _r(this,void 0,void 0,function*(){let{buffer:r,byteOffset:i}=yield this.readAt(t,4);return new DataView(r,i).getInt32(0,!0)})}seek(t){return _r(this,void 0,void 0,function*(){return this._pending&&(yield this._pending),this.position=Math.min(t,this.size),t<this.size})}read(t){return _r(this,void 0,void 0,function*(){this._pending&&(yield this._pending);let{_handle:r,size:i,position:s}=this;if(r&&s<i){typeof t!="number"&&(t=Number.POSITIVE_INFINITY);let n=s,o=0,a=0,h=Math.min(i,n+Math.min(i-n,t)),p=new Uint8Array(Math.max(0,(this.position=h)-n));for(;(n+=a)<h&&(o+=a)<p.byteLength;)({bytesRead:a}=yield r.read(p,o,p.byteLength-o,n));return p}return null})}readAt(t,r){return _r(this,void 0,void 0,function*(){this._pending&&(yield this._pending);let{_handle:i,size:s}=this;if(i&&t+r<s){let n=Math.min(s,t+r),o=new Uint8Array(n-t);return(yield i.read(o,0,r,t)).buffer}return new Uint8Array(r)})}close(){return _r(this,void 0,void 0,function*(){let t=this._handle;this._handle=null,t&&(yield t.close())})}throw(t){return _r(this,void 0,void 0,function*(){return yield this.close(),{done:!0,value:t}})}return(t){return _r(this,void 0,void 0,function*(){return yield this.close(),{done:!0,value:t}})}};var MF={};Ua(MF,{BaseInt64:()=>CS,Int128:()=>PS,Int64:()=>N0,Uint64:()=>so});function nb(e){return e<0&&(e=4294967295+e+1),`0x${e.toString(16)}`}var sb=8,IF=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8],CS=class{constructor(t){this.buffer=t}high(){return this.buffer[1]}low(){return this.buffer[0]}_times(t){let r=new Uint32Array([this.buffer[1]>>>16,this.buffer[1]&65535,this.buffer[0]>>>16,this.buffer[0]&65535]),i=new Uint32Array([t.buffer[1]>>>16,t.buffer[1]&65535,t.buffer[0]>>>16,t.buffer[0]&65535]),s=r[3]*i[3];this.buffer[0]=s&65535;let n=s>>>16;return s=r[2]*i[3],n+=s,s=r[3]*i[2]>>>0,n+=s,this.buffer[0]+=n<<16,this.buffer[1]=n>>>0<s?65536:0,this.buffer[1]+=n>>>16,this.buffer[1]+=r[1]*i[3]+r[2]*i[2]+r[3]*i[1],this.buffer[1]+=r[0]*i[3]+r[1]*i[2]+r[2]*i[1]+r[3]*i[0]<<16,this}_plus(t){let r=this.buffer[0]+t.buffer[0]>>>0;this.buffer[1]+=t.buffer[1],r<this.buffer[0]>>>0&&++this.buffer[1],this.buffer[0]=r}lessThan(t){return this.buffer[1]<t.buffer[1]||this.buffer[1]===t.buffer[1]&&this.buffer[0]<t.buffer[0]}equals(t){return this.buffer[1]===t.buffer[1]&&this.buffer[0]==t.buffer[0]}greaterThan(t){return t.lessThan(this)}hex(){return`${nb(this.buffer[1])} ${nb(this.buffer[0])}`}},so=class e extends CS{times(t){return this._times(t),this}plus(t){return this._plus(t),this}static from(t,r=new Uint32Array(2)){return e.fromString(typeof t=="string"?t:t.toString(),r)}static fromNumber(t,r=new Uint32Array(2)){return e.fromString(t.toString(),r)}static fromString(t,r=new Uint32Array(2)){let i=t.length,s=new e(r);for(let n=0;n<i;){let o=sb<i-n?sb:i-n,a=new e(new Uint32Array([Number.parseInt(t.slice(n,n+o),10),0])),h=new e(new Uint32Array([IF[o],0]));s.times(h),s.plus(a),n+=o}return s}static convertArray(t){let r=new Uint32Array(t.length*2);for(let i=-1,s=t.length;++i<s;)e.from(t[i],new Uint32Array(r.buffer,r.byteOffset+2*i*4,2));return r}static multiply(t,r){return new e(new Uint32Array(t.buffer)).times(r)}static add(t,r){return new e(new Uint32Array(t.buffer)).plus(r)}},N0=class e extends CS{negate(){return this.buffer[0]=~this.buffer[0]+1,this.buffer[1]=~this.buffer[1],this.buffer[0]==0&&++this.buffer[1],this}times(t){return this._times(t),this}plus(t){return this._plus(t),this}lessThan(t){let r=this.buffer[1]<<0,i=t.buffer[1]<<0;return r<i||r===i&&this.buffer[0]<t.buffer[0]}static from(t,r=new Uint32Array(2)){return e.fromString(typeof t=="string"?t:t.toString(),r)}static fromNumber(t,r=new Uint32Array(2)){return e.fromString(t.toString(),r)}static fromString(t,r=new Uint32Array(2)){let i=t.startsWith("-"),s=t.length,n=new e(r);for(let o=i?1:0;o<s;){let a=sb<s-o?sb:s-o,h=new e(new Uint32Array([Number.parseInt(t.slice(o,o+a),10),0])),p=new e(new Uint32Array([IF[a],0]));n.times(p),n.plus(h),o+=a}return i?n.negate():n}static convertArray(t){let r=new Uint32Array(t.length*2);for(let i=-1,s=t.length;++i<s;)e.from(t[i],new Uint32Array(r.buffer,r.byteOffset+2*i*4,2));return r}static multiply(t,r){return new e(new Uint32Array(t.buffer)).times(r)}static add(t,r){return new e(new Uint32Array(t.buffer)).plus(r)}},PS=class e{constructor(t){this.buffer=t}high(){return new N0(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2))}low(){return new N0(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset,2))}negate(){return this.buffer[0]=~this.buffer[0]+1,this.buffer[1]=~this.buffer[1],this.buffer[2]=~this.buffer[2],this.buffer[3]=~this.buffer[3],this.buffer[0]==0&&++this.buffer[1],this.buffer[1]==0&&++this.buffer[2],this.buffer[2]==0&&++this.buffer[3],this}times(t){let r=new so(new Uint32Array([this.buffer[3],0])),i=new so(new Uint32Array([this.buffer[2],0])),s=new so(new Uint32Array([this.buffer[1],0])),n=new so(new Uint32Array([this.buffer[0],0])),o=new so(new Uint32Array([t.buffer[3],0])),a=new so(new Uint32Array([t.buffer[2],0])),h=new so(new Uint32Array([t.buffer[1],0])),p=new so(new Uint32Array([t.buffer[0],0])),g=so.multiply(n,p);this.buffer[0]=g.low();let v=new so(new Uint32Array([g.high(),0]));return g=so.multiply(s,p),v.plus(g),g=so.multiply(n,h),v.plus(g),this.buffer[1]=v.low(),this.buffer[3]=v.lessThan(g)?1:0,this.buffer[2]=v.high(),new so(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2)).plus(so.multiply(i,p)).plus(so.multiply(s,h)).plus(so.multiply(n,a)),this.buffer[3]+=so.multiply(r,p).plus(so.multiply(i,h)).plus(so.multiply(s,a)).plus(so.multiply(n,o)).low(),this}plus(t){let r=new Uint32Array(4);return r[3]=this.buffer[3]+t.buffer[3]>>>0,r[2]=this.buffer[2]+t.buffer[2]>>>0,r[1]=this.buffer[1]+t.buffer[1]>>>0,r[0]=this.buffer[0]+t.buffer[0]>>>0,r[0]<this.buffer[0]>>>0&&++r[1],r[1]<this.buffer[1]>>>0&&++r[2],r[2]<this.buffer[2]>>>0&&++r[3],this.buffer[3]=r[3],this.buffer[2]=r[2],this.buffer[1]=r[1],this.buffer[0]=r[0],this}hex(){return`${nb(this.buffer[3])} ${nb(this.buffer[2])} ${nb(this.buffer[1])} ${nb(this.buffer[0])}`}static multiply(t,r){return new e(new Uint32Array(t.buffer)).times(r)}static add(t,r){return new e(new Uint32Array(t.buffer)).plus(r)}static from(t,r=new Uint32Array(4)){return e.fromString(typeof t=="string"?t:t.toString(),r)}static fromNumber(t,r=new Uint32Array(4)){return e.fromString(t.toString(),r)}static fromString(t,r=new Uint32Array(4)){let i=t.startsWith("-"),s=t.length,n=new e(r);for(let o=i?1:0;o<s;){let a=sb<s-o?sb:s-o,h=new e(new Uint32Array([Number.parseInt(t.slice(o,o+a),10),0,0,0])),p=new e(new Uint32Array([IF[a],0,0,0]));n.times(p),n.plus(h),o+=a}return i?n.negate():n}static convertArray(t){let r=new Uint32Array(t.length*4);for(let i=-1,s=t.length;++i<s;)e.from(t[i],new Uint32Array(r.buffer,r.byteOffset+4*4*i,4));return r}};var RS=class extends Yr{constructor(t,r,i,s,n=Wn.V5){super(),this.nodesIndex=-1,this.buffersIndex=-1,this.bytes=t,this.nodes=r,this.buffers=i,this.dictionaries=s,this.metadataVersion=n}visit(t){return super.visit(t instanceof Ui?t.type:t)}visitNull(t,{length:r}=this.nextFieldNode()){return _i({type:t,length:r})}visitBool(t,{length:r,nullCount:i}=this.nextFieldNode()){return _i({type:t,length:r,nullCount:i,nullBitmap:this.readNullBitmap(t,i),data:this.readData(t)})}visitInt(t,{length:r,nullCount:i}=this.nextFieldNode()){return _i({type:t,length:r,nullCount:i,nullBitmap:this.readNullBitmap(t,i),data:this.readData(t)})}visitFloat(t,{length:r,nullCount:i}=this.nextFieldNode()){return _i({type:t,length:r,nullCount:i,nullBitmap:this.readNullBitmap(t,i),data:this.readData(t)})}visitUtf8(t,{length:r,nullCount:i}=this.nextFieldNode()){return _i({type:t,length:r,nullCount:i,nullBitmap:this.readNullBitmap(t,i),valueOffsets:this.readOffsets(t),data:this.readData(t)})}visitLargeUtf8(t,{length:r,nullCount:i}=this.nextFieldNode()){return _i({type:t,length:r,nullCount:i,nullBitmap:this.readNullBitmap(t,i),valueOffsets:this.readOffsets(t),data:this.readData(t)})}visitBinary(t,{length:r,nullCount:i}=this.nextFieldNode()){return _i({type:t,length:r,nullCount:i,nullBitmap:this.readNullBitmap(t,i),valueOffsets:this.readOffsets(t),data:this.readData(t)})}visitLargeBinary(t,{length:r,nullCount:i}=this.nextFieldNode()){return _i({type:t,length:r,nullCount:i,nullBitmap:this.readNullBitmap(t,i),valueOffsets:this.readOffsets(t),data:this.readData(t)})}visitFixedSizeBinary(t,{length:r,nullCount:i}=this.nextFieldNode()){return _i({type:t,length:r,nullCount:i,nullBitmap:this.readNullBitmap(t,i),data:this.readData(t)})}visitDate(t,{length:r,nullCount:i}=this.nextFieldNode()){return _i({type:t,length:r,nullCount:i,nullBitmap:this.readNullBitmap(t,i),data:this.readData(t)})}visitTimestamp(t,{length:r,nullCount:i}=this.nextFieldNode()){return _i({type:t,length:r,nullCount:i,nullBitmap:this.readNullBitmap(t,i),data:this.readData(t)})}visitTime(t,{length:r,nullCount:i}=this.nextFieldNode()){return _i({type:t,length:r,nullCount:i,nullBitmap:this.readNullBitmap(t,i),data:this.readData(t)})}visitDecimal(t,{length:r,nullCount:i}=this.nextFieldNode()){return _i({type:t,length:r,nullCount:i,nullBitmap:this.readNullBitmap(t,i),data:this.readData(t)})}visitList(t,{length:r,nullCount:i}=this.nextFieldNode()){return _i({type:t,length:r,nullCount:i,nullBitmap:this.readNullBitmap(t,i),valueOffsets:this.readOffsets(t),child:this.visit(t.children[0])})}visitStruct(t,{length:r,nullCount:i}=this.nextFieldNode()){return _i({type:t,length:r,nullCount:i,nullBitmap:this.readNullBitmap(t,i),children:this.visitMany(t.children)})}visitUnion(t,{length:r,nullCount:i}=this.nextFieldNode()){return this.metadataVersion<Wn.V5&&this.readNullBitmap(t,i),t.mode===us.Sparse?this.visitSparseUnion(t,{length:r,nullCount:i}):this.visitDenseUnion(t,{length:r,nullCount:i})}visitDenseUnion(t,{length:r,nullCount:i}=this.nextFieldNode()){return _i({type:t,length:r,nullCount:i,typeIds:this.readTypeIds(t),valueOffsets:this.readOffsets(t),children:this.visitMany(t.children)})}visitSparseUnion(t,{length:r,nullCount:i}=this.nextFieldNode()){return _i({type:t,length:r,nullCount:i,typeIds:this.readTypeIds(t),children:this.visitMany(t.children)})}visitDictionary(t,{length:r,nullCount:i}=this.nextFieldNode()){return _i({type:t,length:r,nullCount:i,nullBitmap:this.readNullBitmap(t,i),data:this.readData(t.indices),dictionary:this.readDictionary(t)})}visitInterval(t,{length:r,nullCount:i}=this.nextFieldNode()){return _i({type:t,length:r,nullCount:i,nullBitmap:this.readNullBitmap(t,i),data:this.readData(t)})}visitDuration(t,{length:r,nullCount:i}=this.nextFieldNode()){return _i({type:t,length:r,nullCount:i,nullBitmap:this.readNullBitmap(t,i),data:this.readData(t)})}visitFixedSizeList(t,{length:r,nullCount:i}=this.nextFieldNode()){return _i({type:t,length:r,nullCount:i,nullBitmap:this.readNullBitmap(t,i),child:this.visit(t.children[0])})}visitMap(t,{length:r,nullCount:i}=this.nextFieldNode()){return _i({type:t,length:r,nullCount:i,nullBitmap:this.readNullBitmap(t,i),valueOffsets:this.readOffsets(t),child:this.visit(t.children[0])})}nextFieldNode(){return this.nodes[++this.nodesIndex]}nextBufferRange(){return this.buffers[++this.buffersIndex]}readNullBitmap(t,r,i=this.nextBufferRange()){return r>0&&this.readData(t,i)||new Uint8Array(0)}readOffsets(t,r){return this.readData(t,r)}readTypeIds(t,r){return this.readData(t,r)}readData(t,{length:r,offset:i}=this.nextBufferRange()){return this.bytes.subarray(i,i+r)}readDictionary(t){return this.dictionaries.get(t.id)}},x8=class extends RS{constructor(t,r,i,s,n){super(new Uint8Array(0),r,i,s,n),this.sources=t}readNullBitmap(t,r,{offset:i}=this.nextBufferRange()){return r<=0?new Uint8Array(0):S_(this.sources[i])}readOffsets(t,{offset:r}=this.nextBufferRange()){return Ki(Uint8Array,Ki(t.OffsetArrayType,this.sources[r]))}readTypeIds(t,{offset:r}=this.nextBufferRange()){return Ki(Uint8Array,Ki(t.ArrayType,this.sources[r]))}readData(t,{offset:r}=this.nextBufferRange()){let{sources:i}=this;return xr.isTimestamp(t)?Ki(Uint8Array,N0.convertArray(i[r])):(xr.isInt(t)||xr.isTime(t))&&t.bitWidth===64||xr.isDuration(t)?Ki(Uint8Array,N0.convertArray(i[r])):xr.isDate(t)&&t.unit===io.MILLISECOND?Ki(Uint8Array,N0.convertArray(i[r])):xr.isDecimal(t)?Ki(Uint8Array,PS.convertArray(i[r])):xr.isBinary(t)||xr.isLargeBinary(t)||xr.isFixedSizeBinary(t)?OIt(i[r]):xr.isBool(t)?S_(i[r]):xr.isUtf8(t)||xr.isLargeUtf8(t)?zp(i[r].join("")):Ki(Uint8Array,Ki(t.ArrayType,i[r].map(s=>+s)))}};function OIt(e){let t=e.join(""),r=new Uint8Array(t.length/2);for(let i=0;i<t.length;i+=2)r[i>>1]=Number.parseInt(t.slice(i,i+2),16);return r}var ob=class extends zc{constructor(t){super(t),this._values=new Cf(Uint8Array)}get byteLength(){let t=this._pendingLength+this.length*4;return this._offsets&&(t+=this._offsets.byteLength),this._values&&(t+=this._values.byteLength),this._nulls&&(t+=this._nulls.byteLength),t}setValue(t,r){return super.setValue(t,ii(r))}_flushPending(t,r){let i=this._offsets,s=this._values.reserve(r).buffer,n=0;for(let[o,a]of t)if(a===void 0)i.set(o,0);else{let h=a.length;s.set(a,n),i.set(o,h),n+=h}}};var ab=class extends zc{constructor(t){super(t),this._values=new Cf(Uint8Array)}get byteLength(){let t=this._pendingLength+this.length*4;return this._offsets&&(t+=this._offsets.byteLength),this._values&&(t+=this._values.byteLength),this._nulls&&(t+=this._nulls.byteLength),t}setValue(t,r){return super.setValue(t,ii(r))}_flushPending(t,r){let i=this._offsets,s=this._values.reserve(r).buffer,n=0;for(let[o,a]of t)if(a===void 0)i.set(o,BigInt(0));else{let h=a.length;s.set(a,n),i.set(o,BigInt(h)),n+=h}}};var b8=class extends Fs{constructor(t){super(t),this._values=new rb}setValue(t,r){this._values.set(t,+r)}};var C_=class extends Xo{};C_.prototype._setValue=aF;var kS=class extends C_{};kS.prototype._setValue=YC;var DS=class extends C_{};DS.prototype._setValue=XC;var OS=class extends Xo{};OS.prototype._setValue=uF;var v8=class extends Fs{constructor({type:t,nullValues:r,dictionaryHashFunction:i}){super({type:new Pl(t.dictionary,t.indices,t.id,t.isOrdered)}),this._nulls=null,this._dictionaryOffset=0,this._keysToIndices=Object.create(null),this.indices=Jp({type:this.type.indices,nullValues:r}),this.dictionary=Jp({type:this.type.dictionary,nullValues:null}),typeof i=="function"&&(this.valueToKey=i)}get values(){return this.indices.values}get nullCount(){return this.indices.nullCount}get nullBitmap(){return this.indices.nullBitmap}get byteLength(){return this.indices.byteLength+this.dictionary.byteLength}get reservedLength(){return this.indices.reservedLength+this.dictionary.reservedLength}get reservedByteLength(){return this.indices.reservedByteLength+this.dictionary.reservedByteLength}isValid(t){return this.indices.isValid(t)}setValid(t,r){let i=this.indices;return r=i.setValid(t,r),this.length=i.length,r}setValue(t,r){let i=this._keysToIndices,s=this.valueToKey(r),n=i[s];return n===void 0&&(i[s]=n=this._dictionaryOffset+this.dictionary.append(r).length-1),this.indices.setValue(t,n)}flush(){let t=this.type,r=this._dictionary,i=this.dictionary.toVector(),s=this.indices.flush().clone(t);return s.dictionary=r?r.concat(i):i,this.finished||(this._dictionaryOffset+=i.length),this._dictionary=s.dictionary,this.clear(),s}finish(){return this.indices.finish(),this.dictionary.finish(),this._dictionaryOffset=0,this._keysToIndices=Object.create(null),super.finish()}clear(){return this.indices.clear(),this.dictionary.clear(),super.clear()}valueToKey(t){return typeof t=="string"?t:`${t}`}};var BS=class extends Xo{};BS.prototype._setValue=oF;var w8=class extends Fs{setValue(t,r){let[i]=this.children,s=t*this.stride;for(let n=-1,o=r.length;++n<o;)i.set(s+n,r[n])}addChild(t,r="0"){if(this.numChildren>0)throw new Error("FixedSizeListBuilder can only have one child.");let i=this.children.push(t);return this.type=new Fc(this.type.listSize,new Ui(r,t.type,!0)),i}};var P_=class extends Xo{setValue(t,r){this._values.set(t,r)}},T8=class extends P_{setValue(t,r){super.setValue(t,vS(r))}},S8=class extends P_{},E8=class extends P_{};var R_=class extends Xo{};R_.prototype._setValue=hF;var NS=class extends R_{};NS.prototype._setValue=i8;var LS=class extends R_{};LS.prototype._setValue=n8;var L0=class extends Xo{};L0.prototype._setValue=fF;var FS=class extends L0{};FS.prototype._setValue=s8;var zS=class extends L0{};zS.prototype._setValue=o8;var US=class extends L0{};US.prototype._setValue=a8;var VS=class extends L0{};VS.prototype._setValue=l8;var Th=class extends Xo{setValue(t,r){this._values.set(t,r)}},I8=class extends Th{},M8=class extends Th{},C8=class extends Th{},P8=class extends Th{},R8=class extends Th{},k8=class extends Th{},D8=class extends Th{},O8=class extends Th{};var B8=class extends zc{constructor(t){super(t),this._offsets=new ib(t.type)}addChild(t,r="0"){if(this.numChildren>0)throw new Error("ListBuilder can only have one child.");return this.children[this.numChildren]=t,this.type=new Lc(new Ui(r,t.type,!0)),this.numChildren-1}_flushPending(t){let r=this._offsets,[i]=this.children;for(let[s,n]of t)if(typeof n>"u")r.set(s,0);else{let o=n,a=o.length,h=r.set(s,a).buffer[s];for(let p=-1;++p<a;)i.set(h+p,o[p])}}};var N8=class extends zc{set(t,r){return super.set(t,r)}setValue(t,r){let i=r instanceof Map?r:new Map(Object.entries(r)),s=this._pending||(this._pending=new Map),n=s.get(t);n&&(this._pendingLength-=n.size),this._pendingLength+=i.size,s.set(t,i)}addChild(t,r=`${this.numChildren}`){if(this.numChildren>0)throw new Error("ListBuilder can only have one child.");return this.children[this.numChildren]=t,this.type=new bh(new Ui(r,t.type,!0),this.type.keysSorted),this.numChildren-1}_flushPending(t){let r=this._offsets,[i]=this.children;for(let[s,n]of t)if(n===void 0)r.set(s,0);else{let{[s]:o,[s+1]:a}=r.set(s,n.size).buffer;for(let h of n.entries())if(i.set(o,h),++o>=a)break}}};var L8=class extends Fs{setValue(t,r){}setValid(t,r){return this.length=Math.max(t+1,this.length),r}};var F8=class extends Fs{setValue(t,r){let{children:i,type:s}=this;switch(Array.isArray(r)||r.constructor){case!0:return s.children.forEach((n,o)=>i[o].set(t,r[o]));case Map:return s.children.forEach((n,o)=>i[o].set(t,r.get(n.name)));default:return s.children.forEach((n,o)=>i[o].set(t,r[n.name]))}}setValid(t,r){return super.setValid(t,r)||this.children.forEach(i=>i.setValid(t,r)),r}addChild(t,r=`${this.numChildren}`){let i=this.children.push(t);return this.type=new is([...this.type.children,new Ui(r,t.type,!0)]),i}};var F0=class extends Xo{};F0.prototype._setValue=lF;var jS=class extends F0{};jS.prototype._setValue=ZC;var WS=class extends F0{};WS.prototype._setValue=GC;var $S=class extends F0{};$S.prototype._setValue=QC;var HS=class extends F0{};HS.prototype._setValue=KC;var z0=class extends Xo{};z0.prototype._setValue=cF;var qS=class extends z0{};qS.prototype._setValue=JC;var YS=class extends z0{};YS.prototype._setValue=t8;var XS=class extends z0{};XS.prototype._setValue=e8;var ZS=class extends z0{};ZS.prototype._setValue=r8;var lb=class extends Fs{constructor(t){super(t),this._typeIds=new k0(Int8Array,0,1),typeof t.valueToChildTypeId=="function"&&(this._valueToChildTypeId=t.valueToChildTypeId)}get typeIdToChildIndex(){return this.type.typeIdToChildIndex}append(t,r){return this.set(this.length,t,r)}set(t,r,i){return i===void 0&&(i=this._valueToChildTypeId(this,r,t)),this.setValue(t,r,i),this}setValue(t,r,i){this._typeIds.set(t,i);let s=this.type.typeIdToChildIndex[i],n=this.children[s];n?.set(t,r)}addChild(t,r=`${this.children.length}`){let i=this.children.push(t),{type:{children:s,mode:n,typeIds:o}}=this,a=[...s,new Ui(r,t.type)];return this.type=new xh(n,[...o,i],a),i}_valueToChildTypeId(t,r,i){throw new Error("Cannot map UnionBuilder value to child typeId. Pass the `childTypeId` as the second argument to unionBuilder.append(), or supply a `valueToChildTypeId` function as part of the UnionBuilder constructor options.")}},z8=class extends lb{},U8=class extends lb{constructor(t){super(t),this._offsets=new k0(Int32Array)}setValue(t,r,i){let s=this._typeIds.set(t,i).buffer[t],n=this.getChildAt(this.type.typeIdToChildIndex[s]),o=this._offsets.set(t,n.length).buffer[t];n?.set(o,r)}};var GS=class extends zc{constructor(t){super(t),this._values=new Cf(Uint8Array)}get byteLength(){let t=this._pendingLength+this.length*4;return this._offsets&&(t+=this._offsets.byteLength),this._values&&(t+=this._values.byteLength),this._nulls&&(t+=this._nulls.byteLength),t}setValue(t,r){return super.setValue(t,zp(r))}_flushPending(t,r){}};GS.prototype._flushPending=ob.prototype._flushPending;var QS=class extends zc{constructor(t){super(t),this._values=new Cf(Uint8Array)}get byteLength(){let t=this._pendingLength+this.length*4;return this._offsets&&(t+=this._offsets.byteLength),this._values&&(t+=this._values.byteLength),this._nulls&&(t+=this._nulls.byteLength),t}setValue(t,r){return super.setValue(t,zp(r))}_flushPending(t,r){}};QS.prototype._flushPending=ab.prototype._flushPending;var CF=class extends Yr{visitNull(){return L8}visitBool(){return b8}visitInt(){return Th}visitInt8(){return I8}visitInt16(){return M8}visitInt32(){return C8}visitInt64(){return P8}visitUint8(){return R8}visitUint16(){return k8}visitUint32(){return D8}visitUint64(){return O8}visitFloat(){return P_}visitFloat16(){return T8}visitFloat32(){return S8}visitFloat64(){return E8}visitUtf8(){return GS}visitLargeUtf8(){return QS}visitBinary(){return ob}visitLargeBinary(){return ab}visitFixedSizeBinary(){return BS}visitDate(){return C_}visitDateDay(){return kS}visitDateMillisecond(){return DS}visitTimestamp(){return F0}visitTimestampSecond(){return jS}visitTimestampMillisecond(){return WS}visitTimestampMicrosecond(){return $S}visitTimestampNanosecond(){return HS}visitTime(){return z0}visitTimeSecond(){return qS}visitTimeMillisecond(){return YS}visitTimeMicrosecond(){return XS}visitTimeNanosecond(){return ZS}visitDecimal(){return OS}visitList(){return B8}visitStruct(){return F8}visitUnion(){return lb}visitDenseUnion(){return U8}visitSparseUnion(){return z8}visitDictionary(){return v8}visitInterval(){return R_}visitIntervalDayTime(){return NS}visitIntervalYearMonth(){return LS}visitDuration(){return L0}visitDurationSecond(){return FS}visitDurationMillisecond(){return zS}visitDurationMicrosecond(){return US}visitDurationNanosecond(){return VS}visitFixedSizeList(){return w8}visitMap(){return N8}},xat=new CF;var Qr=class extends Yr{compareSchemas(t,r){return t===r||r instanceof t.constructor&&this.compareManyFields(t.fields,r.fields)}compareManyFields(t,r){return t===r||Array.isArray(t)&&Array.isArray(r)&&t.length===r.length&&t.every((i,s)=>this.compareFields(i,r[s]))}compareFields(t,r){return t===r||r instanceof t.constructor&&t.name===r.name&&t.nullable===r.nullable&&this.visit(t.type,r.type)}};function ec(e,t){return t instanceof e.constructor}function k_(e,t){return e===t||ec(e,t)}function U0(e,t){return e===t||ec(e,t)&&e.bitWidth===t.bitWidth&&e.isSigned===t.isSigned}function V8(e,t){return e===t||ec(e,t)&&e.precision===t.precision}function BIt(e,t){return e===t||ec(e,t)&&e.byteWidth===t.byteWidth}function PF(e,t){return e===t||ec(e,t)&&e.unit===t.unit}function KS(e,t){return e===t||ec(e,t)&&e.unit===t.unit&&e.timezone===t.timezone}function JS(e,t){return e===t||ec(e,t)&&e.unit===t.unit&&e.bitWidth===t.bitWidth}function NIt(e,t){return e===t||ec(e,t)&&e.children.length===t.children.length&&td.compareManyFields(e.children,t.children)}function LIt(e,t){return e===t||ec(e,t)&&e.children.length===t.children.length&&td.compareManyFields(e.children,t.children)}function RF(e,t){return e===t||ec(e,t)&&e.mode===t.mode&&e.typeIds.every((r,i)=>r===t.typeIds[i])&&td.compareManyFields(e.children,t.children)}function FIt(e,t){return e===t||ec(e,t)&&e.id===t.id&&e.isOrdered===t.isOrdered&&td.visit(e.indices,t.indices)&&td.visit(e.dictionary,t.dictionary)}function kF(e,t){return e===t||ec(e,t)&&e.unit===t.unit}function t4(e,t){return e===t||ec(e,t)&&e.unit===t.unit}function zIt(e,t){return e===t||ec(e,t)&&e.listSize===t.listSize&&e.children.length===t.children.length&&td.compareManyFields(e.children,t.children)}function UIt(e,t){return e===t||ec(e,t)&&e.keysSorted===t.keysSorted&&e.children.length===t.children.length&&td.compareManyFields(e.children,t.children)}Qr.prototype.visitNull=k_;Qr.prototype.visitBool=k_;Qr.prototype.visitInt=U0;Qr.prototype.visitInt8=U0;Qr.prototype.visitInt16=U0;Qr.prototype.visitInt32=U0;Qr.prototype.visitInt64=U0;Qr.prototype.visitUint8=U0;Qr.prototype.visitUint16=U0;Qr.prototype.visitUint32=U0;Qr.prototype.visitUint64=U0;Qr.prototype.visitFloat=V8;Qr.prototype.visitFloat16=V8;Qr.prototype.visitFloat32=V8;Qr.prototype.visitFloat64=V8;Qr.prototype.visitUtf8=k_;Qr.prototype.visitLargeUtf8=k_;Qr.prototype.visitBinary=k_;Qr.prototype.visitLargeBinary=k_;Qr.prototype.visitFixedSizeBinary=BIt;Qr.prototype.visitDate=PF;Qr.prototype.visitDateDay=PF;Qr.prototype.visitDateMillisecond=PF;Qr.prototype.visitTimestamp=KS;Qr.prototype.visitTimestampSecond=KS;Qr.prototype.visitTimestampMillisecond=KS;Qr.prototype.visitTimestampMicrosecond=KS;Qr.prototype.visitTimestampNanosecond=KS;Qr.prototype.visitTime=JS;Qr.prototype.visitTimeSecond=JS;Qr.prototype.visitTimeMillisecond=JS;Qr.prototype.visitTimeMicrosecond=JS;Qr.prototype.visitTimeNanosecond=JS;Qr.prototype.visitDecimal=k_;Qr.prototype.visitList=NIt;Qr.prototype.visitStruct=LIt;Qr.prototype.visitUnion=RF;Qr.prototype.visitDenseUnion=RF;Qr.prototype.visitSparseUnion=RF;Qr.prototype.visitDictionary=FIt;Qr.prototype.visitInterval=kF;Qr.prototype.visitIntervalDayTime=kF;Qr.prototype.visitIntervalYearMonth=kF;Qr.prototype.visitDuration=t4;Qr.prototype.visitDurationSecond=t4;Qr.prototype.visitDurationMillisecond=t4;Qr.prototype.visitDurationMicrosecond=t4;Qr.prototype.visitDurationNanosecond=t4;Qr.prototype.visitFixedSizeList=zIt;Qr.prototype.visitMap=UIt;var td=new Qr;function D_(e,t){return td.compareSchemas(e,t)}function bat(e,t){return td.compareFields(e,t)}function vat(e,t){return td.visit(e,t)}function Jp(e){let t=e.type,r=new(xat.getVisitFn(t)())(e);if(t.children&&t.children.length>0){let i=e.children||[],s={nullValues:e.nullValues},n=Array.isArray(i)?(o,a)=>i[a]||s:({name:o})=>i[o]||s;for(let[o,a]of t.children.entries()){let{type:h}=a,p=n(a,o);r.children.push(Jp(Object.assign(Object.assign({},p),{type:h})))}}return r}function j8(e,t){return VIt(e,t.map(r=>r.data.concat()))}function VIt(e,t){let r=[...e.fields],i=[],s={numBatches:t.reduce((v,T)=>Math.max(v,T.length),0)},n=0,o=0,a=-1,h=t.length,p,g=[];for(;s.numBatches-- >0;){for(o=Number.POSITIVE_INFINITY,a=-1;++a<h;)g[a]=p=t[a].shift(),o=Math.min(o,p?p.length:o);Number.isFinite(o)&&(g=jIt(r,o,g,t,s),o>0&&(i[n++]=_i({type:new is(r),length:o,nullCount:0,children:g.slice()})))}return[e=e.assign(r),i.map(v=>new yo(e,v))]}function jIt(e,t,r,i,s){var n;let o=(t+63&-64)>>3;for(let a=-1,h=i.length;++a<h;){let p=r[a],g=p?.length;if(g>=t)g===t?r[a]=p:(r[a]=p.slice(0,t),s.numBatches=Math.max(s.numBatches,i[a].unshift(p.slice(t,g-t))));else{let v=e[a];e[a]=v.clone({nullable:!0}),r[a]=(n=p?._changeLengthAndBackfillNullBitmap(t))!==null&&n!==void 0?n:_i({type:v.type,length:t,nullCount:t,nullBitmap:new Uint8Array(o)})}}return r}var Tat,Qa=class e{constructor(...t){var r,i;if(t.length===0)return this.batches=[],this.schema=new Fn([]),this._offsets=[0],this;let s,n;t[0]instanceof Fn&&(s=t.shift()),t.at(-1)instanceof Uint32Array&&(n=t.pop());let o=h=>{if(h){if(h instanceof yo)return[h];if(h instanceof e)return h.batches;if(h instanceof gn){if(h.type instanceof is)return[new yo(new Fn(h.type.children),h)]}else{if(Array.isArray(h))return h.flatMap(p=>o(p));if(typeof h[Symbol.iterator]=="function")return[...h].flatMap(p=>o(p));if(typeof h=="object"){let p=Object.keys(h),g=p.map(C=>new zi([h[C]])),v=s??new Fn(p.map((C,B)=>new Ui(String(C),g[B].type,g[B].nullable))),[,T]=j8(v,g);return T.length===0?[new yo(h)]:T}}}return[]},a=t.flatMap(h=>o(h));if(s=(i=s??((r=a[0])===null||r===void 0?void 0:r.schema))!==null&&i!==void 0?i:new Fn([]),!(s instanceof Fn))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");for(let h of a){if(!(h instanceof yo))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");if(!D_(s,h.schema))throw new TypeError("Table and inner RecordBatch schemas must be equivalent.")}this.schema=s,this.batches=a,this._offsets=n??p8(this.data)}get data(){return this.batches.map(({data:t})=>t)}get numCols(){return this.schema.fields.length}get numRows(){return this.data.reduce((t,r)=>t+r.length,0)}get nullCount(){return this._nullCount===-1&&(this._nullCount=f8(this.data)),this._nullCount}isValid(t){return!1}get(t){return null}set(t,r){}indexOf(t,r){return-1}[Symbol.iterator](){return this.batches.length>0?eb.visit(new zi(this.data)):new Array(0)[Symbol.iterator]()}toArray(){return[...this]}toString(){return`[
  ${this.toArray().join(`,
  `)}
]`}concat(...t){let r=this.schema,i=this.data.concat(t.flatMap(({data:s})=>s));return new e(r,i.map(s=>new yo(r,s)))}slice(t,r){let i=this.schema;[t,r]=wS({length:this.numRows},t,r);let s=d8(this.data,this._offsets,t,r);return new e(i,s.map(n=>new yo(i,n)))}getChild(t){return this.getChildAt(this.schema.fields.findIndex(r=>r.name===t))}getChildAt(t){if(t>-1&&t<this.schema.fields.length){let r=this.data.map(i=>i.children[t]);if(r.length===0){let{type:i}=this.schema.fields[t],s=_i({type:i,length:0,nullCount:0});r.push(s._changeLengthAndBackfillNullBitmap(this.numRows))}return new zi(r)}return null}setChild(t,r){var i;return this.setChildAt((i=this.schema.fields)===null||i===void 0?void 0:i.findIndex(s=>s.name===t),r)}setChildAt(t,r){let i=this.schema,s=[...this.batches];if(t>-1&&t<this.numCols){r||(r=new zi([_i({type:new Ia,length:this.numRows})]));let n=i.fields.slice(),o=n[t].clone({type:r.type}),a=this.schema.fields.map((h,p)=>this.getChildAt(p));[n[t],a[t]]=[o,r],[i,s]=j8(i,a)}return new e(i,s)}select(t){let r=this.schema.fields.reduce((i,s,n)=>i.set(s.name,n),new Map);return this.selectAt(t.map(i=>r.get(i)).filter(i=>i>-1))}selectAt(t){let r=this.schema.selectAt(t),i=this.batches.map(s=>s.selectAt(t));return new e(r,i)}assign(t){let r=this.schema.fields,[i,s]=t.schema.fields.reduce((a,h,p)=>{let[g,v]=a,T=r.findIndex(C=>C.name===h.name);return~T?v[T]=p:g.push(p),a},[[],[]]),n=this.schema.assign(t.schema),o=[...r.map((a,h)=>[h,s[h]]).map(([a,h])=>h===void 0?this.getChildAt(a):t.getChildAt(h)),...i.map(a=>t.getChildAt(a))].filter(Boolean);return new e(...j8(n,o))}};Tat=Symbol.toStringTag;Qa[Tat]=(e=>(e.schema=null,e.batches=[],e._offsets=new Uint32Array([0]),e._nullCount=-1,e[Symbol.isConcatSpreadable]=!0,e.isValid=tb(ES),e.get=tb(Yo.getVisitFn(Lt.Struct)),e.set=m8(Ga.getVisitFn(Lt.Struct)),e.indexOf=A8(E_.getVisitFn(Lt.Struct)),"Table"))(Qa.prototype);var Eat,yo=class e{constructor(...t){switch(t.length){case 2:{if([this.schema]=t,!(this.schema instanceof Fn))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");if([,this.data=_i({nullCount:0,type:new is(this.schema.fields),children:this.schema.fields.map(r=>_i({type:r.type,nullCount:0}))})]=t,!(this.data instanceof gn))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");[this.schema,this.data]=Sat(this.schema,this.data.children);break}case 1:{let[r]=t,{fields:i,children:s,length:n}=Object.keys(r).reduce((h,p,g)=>(h.children[g]=r[p],h.length=Math.max(h.length,r[p].length),h.fields[g]=Ui.new({name:p,type:r[p].type,nullable:!0}),h),{length:0,fields:new Array,children:new Array}),o=new Fn(i),a=_i({type:new is(i),length:n,children:s,nullCount:0});[this.schema,this.data]=Sat(o,a.children,n);break}default:throw new TypeError("RecordBatch constructor expects an Object mapping names to child Data, or a [Schema, Data] pair.")}}get dictionaries(){return this._dictionaries||(this._dictionaries=Iat(this.schema.fields,this.data.children))}get numCols(){return this.schema.fields.length}get numRows(){return this.data.length}get nullCount(){return this.data.nullCount}isValid(t){return this.data.getValid(t)}get(t){return Yo.visit(this.data,t)}set(t,r){return Ga.visit(this.data,t,r)}indexOf(t,r){return E_.visit(this.data,t,r)}[Symbol.iterator](){return eb.visit(new zi([this.data]))}toArray(){return[...this]}concat(...t){return new Qa(this.schema,[this,...t])}slice(t,r){let[i]=new zi([this.data]).slice(t,r).data;return new e(this.schema,i)}getChild(t){var r;return this.getChildAt((r=this.schema.fields)===null||r===void 0?void 0:r.findIndex(i=>i.name===t))}getChildAt(t){return t>-1&&t<this.schema.fields.length?new zi([this.data.children[t]]):null}setChild(t,r){var i;return this.setChildAt((i=this.schema.fields)===null||i===void 0?void 0:i.findIndex(s=>s.name===t),r)}setChildAt(t,r){let i=this.schema,s=this.data;if(t>-1&&t<this.numCols){r||(r=new zi([_i({type:new Ia,length:this.numRows})]));let n=i.fields.slice(),o=s.children.slice(),a=n[t].clone({type:r.type});[n[t],o[t]]=[a,r.data[0]],i=new Fn(n,new Map(this.schema.metadata)),s=_i({type:new is(n),children:o})}return new e(i,s)}select(t){let r=this.schema.select(t),i=new is(r.fields),s=[];for(let n of t){let o=this.schema.fields.findIndex(a=>a.name===n);~o&&(s[o]=this.data.children[o])}return new e(r,_i({type:i,length:this.numRows,children:s}))}selectAt(t){let r=this.schema.selectAt(t),i=t.map(n=>this.data.children[n]).filter(Boolean),s=_i({type:new is(r.fields),length:this.numRows,children:i});return new e(r,s)}};Eat=Symbol.toStringTag;yo[Eat]=(e=>(e._nullCount=-1,e[Symbol.isConcatSpreadable]=!0,"RecordBatch"))(yo.prototype);function Sat(e,t,r=t.reduce((i,s)=>Math.max(i,s.length),0)){var i;let s=[...e.fields],n=[...t],o=(r+63&-64)>>3;for(let[a,h]of e.fields.entries()){let p=t[a];(!p||p.length!==r)&&(s[a]=h.clone({nullable:!0}),n[a]=(i=p?._changeLengthAndBackfillNullBitmap(r))!==null&&i!==void 0?i:_i({type:h.type,length:r,nullCount:r,nullBitmap:new Uint8Array(o)}))}return[e.assign(s),_i({type:new is(s),length:r,children:n})]}function Iat(e,t,r=new Map){var i,s;if(((i=e?.length)!==null&&i!==void 0?i:0)>0&&e?.length===t?.length)for(let n=-1,o=e.length;++n<o;){let{type:a}=e[n],h=t[n];for(let p of[h,...((s=h?.dictionary)===null||s===void 0?void 0:s.data)||[]])Iat(a.children,p?.children,r);if(xr.isDictionary(a)){let{id:p}=a;if(!r.has(p))h?.dictionary&&r.set(p,h.dictionary);else if(r.get(p)!==h.dictionary)throw new Error("Cannot create Schema containing two different dictionaries with the same Id")}}return r}var O_=class extends yo{constructor(t){let r=t.fields.map(s=>_i({type:s.type})),i=_i({type:new is(t.fields),nullCount:0,children:r});super(t,i)}};var Pf=class e{constructor(){this.bb=null,this.bb_pos=0}__init(t,r){return this.bb_pos=t,this.bb=r,this}static getRootAsMessage(t,r){return(r||new e).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsMessage(t,r){return t.setPosition(t.position()+4),(r||new e).__init(t.readInt32(t.position())+t.position(),t)}version(){let t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Wn.V1}headerType(){let t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readUint8(this.bb_pos+t):sn.NONE}header(t){let r=this.bb.__offset(this.bb_pos,8);return r?this.bb.__union(t,this.bb_pos+r):null}bodyLength(){let t=this.bb.__offset(this.bb_pos,10);return t?this.bb.readInt64(this.bb_pos+t):BigInt("0")}customMetadata(t,r){let i=this.bb.__offset(this.bb_pos,12);return i?(r||new sa).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+t*4),this.bb):null}customMetadataLength(){let t=this.bb.__offset(this.bb_pos,12);return t?this.bb.__vector_len(this.bb_pos+t):0}static startMessage(t){t.startObject(5)}static addVersion(t,r){t.addFieldInt16(0,r,Wn.V1)}static addHeaderType(t,r){t.addFieldInt8(1,r,sn.NONE)}static addHeader(t,r){t.addFieldOffset(2,r,0)}static addBodyLength(t,r){t.addFieldInt64(3,r,BigInt("0"))}static addCustomMetadata(t,r){t.addFieldOffset(4,r,0)}static createCustomMetadataVector(t,r){t.startVector(4,r.length,4);for(let i=r.length-1;i>=0;i--)t.addOffset(r[i]);return t.endVector()}static startCustomMetadataVector(t,r){t.startVector(4,r,4)}static endMessage(t){return t.endObject()}static finishMessageBuffer(t,r){t.finish(r)}static finishSizePrefixedMessageBuffer(t,r){t.finish(r,void 0,!0)}static createMessage(t,r,i,s,n,o){return e.startMessage(t),e.addVersion(t,r),e.addHeaderType(t,i),e.addHeader(t,s),e.addBodyLength(t,n),e.addCustomMetadata(t,o),e.endMessage(t)}};var DF=class extends Yr{visit(t,r){return t==null||r==null?void 0:super.visit(t,r)}visitNull(t,r){return gS.startNull(r),gS.endNull(r)}visitInt(t,r){return Tf.startInt(r),Tf.addBitWidth(r,t.bitWidth),Tf.addIsSigned(r,t.isSigned),Tf.endInt(r)}visitFloat(t,r){return CA.startFloatingPoint(r),CA.addPrecision(r,t.precision),CA.endFloatingPoint(r)}visitBinary(t,r){return fS.startBinary(r),fS.endBinary(r)}visitLargeBinary(t,r){return dS.startLargeBinary(r),dS.endLargeBinary(r)}visitBool(t,r){return pS.startBool(r),pS.endBool(r)}visitUtf8(t,r){return yS.startUtf8(r),yS.endUtf8(r)}visitLargeUtf8(t,r){return mS.startLargeUtf8(r),mS.endLargeUtf8(r)}visitDecimal(t,r){return Wp.startDecimal(r),Wp.addScale(r,t.scale),Wp.addPrecision(r,t.precision),Wp.addBitWidth(r,t.bitWidth),Wp.endDecimal(r)}visitDate(t,r){return SA.startDate(r),SA.addUnit(r,t.unit),SA.endDate(r)}visitTime(t,r){return x0.startTime(r),x0.addUnit(r,t.unit),x0.addBitWidth(r,t.bitWidth),x0.endTime(r)}visitTimestamp(t,r){let i=t.timezone&&r.createString(t.timezone)||void 0;return b0.startTimestamp(r),b0.addUnit(r,t.unit),i!==void 0&&b0.addTimezone(r,i),b0.endTimestamp(r)}visitInterval(t,r){return PA.startInterval(r),PA.addUnit(r,t.unit),PA.endInterval(r)}visitDuration(t,r){return EA.startDuration(r),EA.addUnit(r,t.unit),EA.endDuration(r)}visitList(t,r){return AS.startList(r),AS.endList(r)}visitStruct(t,r){return _S.startStruct_(r),_S.endStruct_(r)}visitUnion(t,r){Sf.startTypeIdsVector(r,t.typeIds.length);let i=Sf.createTypeIdsVector(r,t.typeIds);return Sf.startUnion(r),Sf.addMode(r,t.mode),Sf.addTypeIds(r,i),Sf.endUnion(r)}visitDictionary(t,r){let i=this.visit(t.indices,r);return jp.startDictionaryEncoding(r),jp.addId(r,BigInt(t.id)),jp.addIsOrdered(r,t.isOrdered),i!==void 0&&jp.addIndexType(r,i),jp.endDictionaryEncoding(r)}visitFixedSizeBinary(t,r){return IA.startFixedSizeBinary(r),IA.addByteWidth(r,t.byteWidth),IA.endFixedSizeBinary(r)}visitFixedSizeList(t,r){return MA.startFixedSizeList(r),MA.addListSize(r,t.listSize),MA.endFixedSizeList(r)}visitMap(t,r){return RA.startMap(r),RA.addKeysSorted(r,t.keysSorted),RA.endMap(r)}},W8=new DF;function Rat(e,t=new Map){return new Fn(WIt(e,t),$8(e.metadata),t)}function OF(e){return new Ka(e.count,Dat(e.columns),Oat(e.columns))}function kat(e){return new Vc(OF(e.data),e.id,e.isDelta)}function WIt(e,t){return(e.fields||[]).filter(Boolean).map(r=>Ui.fromJSON(r,t))}function Mat(e,t){return(e.children||[]).filter(Boolean).map(r=>Ui.fromJSON(r,t))}function Dat(e){return(e||[]).reduce((t,r)=>[...t,new Sh(r.count,$It(r.VALIDITY)),...Dat(r.children)],[])}function Oat(e,t=[]){for(let r=-1,i=(e||[]).length;++r<i;){let s=e[r];s.VALIDITY&&t.push(new Uc(t.length,s.VALIDITY.length)),s.TYPE_ID&&t.push(new Uc(t.length,s.TYPE_ID.length)),s.OFFSET&&t.push(new Uc(t.length,s.OFFSET.length)),s.DATA&&t.push(new Uc(t.length,s.DATA.length)),t=Oat(s.children,t)}return t}function $It(e){return(e||[]).reduce((t,r)=>t+ +(r===0),0)}function Bat(e,t){let r,i,s,n,o,a;return!t||!(n=e.dictionary)?(o=Pat(e,Mat(e,t)),s=new Ui(e.name,o,e.nullable,$8(e.metadata))):t.has(r=n.id)?(i=(i=n.indexType)?Cat(i):new Ml,a=new Pl(t.get(r),i,r,n.isOrdered),s=new Ui(e.name,a,e.nullable,$8(e.metadata))):(i=(i=n.indexType)?Cat(i):new Ml,t.set(r,o=Pat(e,Mat(e,t))),a=new Pl(o,i,r,n.isOrdered),s=new Ui(e.name,a,e.nullable,$8(e.metadata))),s||null}function $8(e=[]){return new Map(e.map(({key:t,value:r})=>[t,r]))}function Cat(e){return new _o(e.isSigned,e.bitWidth)}function Pat(e,t){let r=e.type.name;switch(r){case"NONE":return new Ia;case"null":return new Ia;case"binary":return new Ah;case"largebinary":return new $p;case"utf8":return new wu;case"largeutf8":return new Hp;case"bool":return new gh;case"list":return new Lc((t||[])[0]);case"struct":return new is(t||[]);case"struct_":return new is(t||[])}switch(r){case"int":{let i=e.type;return new _o(i.isSigned,i.bitWidth)}case"floatingpoint":{let i=e.type;return new tc(rs[i.precision])}case"decimal":{let i=e.type;return new qp(i.scale,i.precision,i.bitWidth)}case"date":{let i=e.type;return new _h(io[i.unit])}case"time":{let i=e.type;return new Cl(Tr[i.unit],i.bitWidth)}case"timestamp":{let i=e.type;return new Yp(Tr[i.unit],i.timezone)}case"interval":{let i=e.type;return new yh(Lo[i.unit])}case"duration":{let i=e.type;return new Xp(Tr[i.unit])}case"union":{let i=e.type,[s,...n]=(i.mode+"").toLowerCase(),o=s.toUpperCase()+n.join("");return new xh(us[o],i.typeIds||[],t||[])}case"fixedsizebinary":{let i=e.type;return new Zp(i.byteWidth)}case"fixedsizelist":{let i=e.type;return new Fc(i.listSize,(t||[])[0])}case"map":{let i=e.type;return new bh((t||[])[0],i.keysSorted)}}throw new Error(`Unrecognized type: "${r}"`)}var HIt=b_,qIt=bu,jc=class e{static fromJSON(t,r){let i=new e(0,Wn.V5,r);return i._createHeader=YIt(t,r),i}static decode(t){t=new qIt(ii(t));let r=Pf.getRootAsMessage(t),i=r.bodyLength(),s=r.version(),n=r.headerType(),o=new e(i,s,n);return o._createHeader=XIt(r,n),o}static encode(t){let r=new HIt,i=-1;return t.isSchema()?i=Fn.encode(r,t.header()):t.isRecordBatch()?i=Ka.encode(r,t.header()):t.isDictionaryBatch()&&(i=Vc.encode(r,t.header())),Pf.startMessage(r),Pf.addVersion(r,Wn.V5),Pf.addHeader(r,i),Pf.addHeaderType(r,t.headerType),Pf.addBodyLength(r,BigInt(t.bodyLength)),Pf.finishMessageBuffer(r,Pf.endMessage(r)),r.asUint8Array()}static from(t,r=0){if(t instanceof Fn)return new e(0,Wn.V5,sn.Schema,t);if(t instanceof Ka)return new e(r,Wn.V5,sn.RecordBatch,t);if(t instanceof Vc)return new e(r,Wn.V5,sn.DictionaryBatch,t);throw new Error(`Unrecognized Message header: ${t}`)}get type(){return this.headerType}get version(){return this._version}get headerType(){return this._headerType}get bodyLength(){return this._bodyLength}header(){return this._createHeader()}isSchema(){return this.headerType===sn.Schema}isRecordBatch(){return this.headerType===sn.RecordBatch}isDictionaryBatch(){return this.headerType===sn.DictionaryBatch}constructor(t,r,i,s){this._version=r,this._headerType=i,this.body=new Uint8Array(0),s&&(this._createHeader=()=>s),this._bodyLength=no(t)}},Ka=class{get nodes(){return this._nodes}get length(){return this._length}get buffers(){return this._buffers}constructor(t,r,i){this._nodes=r,this._buffers=i,this._length=no(t)}},Vc=class{get id(){return this._id}get data(){return this._data}get isDelta(){return this._isDelta}get length(){return this.data.length}get nodes(){return this.data.nodes}get buffers(){return this.data.buffers}constructor(t,r,i=!1){this._data=t,this._isDelta=i,this._id=no(r)}},Uc=class{constructor(t,r){this.offset=no(t),this.length=no(r)}},Sh=class{constructor(t,r){this.length=no(t),this.nullCount=no(r)}};function YIt(e,t){return()=>{switch(t){case sn.Schema:return Fn.fromJSON(e);case sn.RecordBatch:return Ka.fromJSON(e);case sn.DictionaryBatch:return Vc.fromJSON(e)}throw new Error(`Unrecognized Message type: { name: ${sn[t]}, type: ${t} }`)}}function XIt(e,t){return()=>{switch(t){case sn.Schema:return Fn.decode(e.header(new Nc),new Map,e.version());case sn.RecordBatch:return Ka.decode(e.header(new vu),e.version());case sn.DictionaryBatch:return Vc.decode(e.header(new y0),e.version())}throw new Error(`Unrecognized Message type: { name: ${sn[t]}, type: ${t} }`)}}Ui.encode=sMt;Ui.decode=iMt;Ui.fromJSON=Bat;Fn.encode=nMt;Fn.decode=ZIt;Fn.fromJSON=Rat;Ka.encode=oMt;Ka.decode=GIt;Ka.fromJSON=OF;Vc.encode=aMt;Vc.decode=QIt;Vc.fromJSON=kat;Sh.encode=lMt;Sh.decode=JIt;Uc.encode=cMt;Uc.decode=KIt;function ZIt(e,t=new Map,r=Wn.V5){let i=rMt(e,t);return new Fn(i,H8(e),t,r)}function GIt(e,t=Wn.V5){if(e.compression()!==null)throw new Error("Record batch compression not implemented");return new Ka(e.length(),tMt(e),eMt(e,t))}function QIt(e,t=Wn.V5){return new Vc(Ka.decode(e.data(),t),e.id(),e.isDelta())}function KIt(e){return new Uc(e.offset(),e.length())}function JIt(e){return new Sh(e.length(),e.nullCount())}function tMt(e){let t=[];for(let r,i=-1,s=-1,n=e.nodesLength();++i<n;)(r=e.nodes(i))&&(t[++s]=Sh.decode(r));return t}function eMt(e,t){let r=[];for(let i,s=-1,n=-1,o=e.buffersLength();++s<o;)(i=e.buffers(s))&&(t<Wn.V4&&(i.bb_pos+=8*(s+1)),r[++n]=Uc.decode(i));return r}function rMt(e,t){let r=[];for(let i,s=-1,n=-1,o=e.fieldsLength();++s<o;)(i=e.fields(s))&&(r[++n]=Ui.decode(i,t));return r}function Nat(e,t){let r=[];for(let i,s=-1,n=-1,o=e.childrenLength();++s<o;)(i=e.children(s))&&(r[++n]=Ui.decode(i,t));return r}function iMt(e,t){let r,i,s,n,o,a;return!t||!(a=e.dictionary())?(s=Fat(e,Nat(e,t)),i=new Ui(e.name(),s,e.nullable(),H8(e))):t.has(r=no(a.id()))?(n=(n=a.indexType())?Lat(n):new Ml,o=new Pl(t.get(r),n,r,a.isOrdered()),i=new Ui(e.name(),o,e.nullable(),H8(e))):(n=(n=a.indexType())?Lat(n):new Ml,t.set(r,s=Fat(e,Nat(e,t))),o=new Pl(s,n,r,a.isOrdered()),i=new Ui(e.name(),o,e.nullable(),H8(e))),i||null}function H8(e){let t=new Map;if(e)for(let r,i,s=-1,n=Math.trunc(e.customMetadataLength());++s<n;)(r=e.customMetadata(s))&&(i=r.key())!=null&&t.set(i,r.value());return t}function Lat(e){return new _o(e.isSigned(),e.bitWidth())}function Fat(e,t){let r=e.typeType();switch(r){case hs.NONE:return new Ia;case hs.Null:return new Ia;case hs.Binary:return new Ah;case hs.LargeBinary:return new $p;case hs.Utf8:return new wu;case hs.LargeUtf8:return new Hp;case hs.Bool:return new gh;case hs.List:return new Lc((t||[])[0]);case hs.Struct_:return new is(t||[])}switch(r){case hs.Int:{let i=e.type(new Tf);return new _o(i.isSigned(),i.bitWidth())}case hs.FloatingPoint:{let i=e.type(new CA);return new tc(i.precision())}case hs.Decimal:{let i=e.type(new Wp);return new qp(i.scale(),i.precision(),i.bitWidth())}case hs.Date:{let i=e.type(new SA);return new _h(i.unit())}case hs.Time:{let i=e.type(new x0);return new Cl(i.unit(),i.bitWidth())}case hs.Timestamp:{let i=e.type(new b0);return new Yp(i.unit(),i.timezone())}case hs.Interval:{let i=e.type(new PA);return new yh(i.unit())}case hs.Duration:{let i=e.type(new EA);return new Xp(i.unit())}case hs.Union:{let i=e.type(new Sf);return new xh(i.mode(),i.typeIdsArray()||[],t||[])}case hs.FixedSizeBinary:{let i=e.type(new IA);return new Zp(i.byteWidth())}case hs.FixedSizeList:{let i=e.type(new MA);return new Fc(i.listSize(),(t||[])[0])}case hs.Map:{let i=e.type(new RA);return new bh((t||[])[0],i.keysSorted())}}throw new Error(`Unrecognized type: "${hs[r]}" (${r})`)}function nMt(e,t){let r=t.fields.map(n=>Ui.encode(e,n));Nc.startFieldsVector(e,r.length);let i=Nc.createFieldsVector(e,r),s=t.metadata&&t.metadata.size>0?Nc.createCustomMetadataVector(e,[...t.metadata].map(([n,o])=>{let a=e.createString(`${n}`),h=e.createString(`${o}`);return sa.startKeyValue(e),sa.addKey(e,a),sa.addValue(e,h),sa.endKeyValue(e)})):-1;return Nc.startSchema(e),Nc.addFields(e,i),Nc.addEndianness(e,uMt?TA.Little:TA.Big),s!==-1&&Nc.addCustomMetadata(e,s),Nc.endSchema(e)}function sMt(e,t){let r=-1,i=-1,s=-1,n=t.type,o=t.typeId;xr.isDictionary(n)?(o=n.dictionary.typeId,s=W8.visit(n,e),i=W8.visit(n.dictionary,e)):i=W8.visit(n,e);let a=(n.children||[]).map(g=>Ui.encode(e,g)),h=Il.createChildrenVector(e,a),p=t.metadata&&t.metadata.size>0?Il.createCustomMetadataVector(e,[...t.metadata].map(([g,v])=>{let T=e.createString(`${g}`),C=e.createString(`${v}`);return sa.startKeyValue(e),sa.addKey(e,T),sa.addValue(e,C),sa.endKeyValue(e)})):-1;return t.name&&(r=e.createString(t.name)),Il.startField(e),Il.addType(e,i),Il.addTypeType(e,o),Il.addChildren(e,h),Il.addNullable(e,!!t.nullable),r!==-1&&Il.addName(e,r),s!==-1&&Il.addDictionary(e,s),p!==-1&&Il.addCustomMetadata(e,p),Il.endField(e)}function oMt(e,t){let r=t.nodes||[],i=t.buffers||[];vu.startNodesVector(e,r.length);for(let o of r.slice().reverse())Sh.encode(e,o);let s=e.endVector();vu.startBuffersVector(e,i.length);for(let o of i.slice().reverse())Uc.encode(e,o);let n=e.endVector();return vu.startRecordBatch(e),vu.addLength(e,BigInt(t.length)),vu.addNodes(e,s),vu.addBuffers(e,n),vu.endRecordBatch(e)}function aMt(e,t){let r=Ka.encode(e,t.data);return y0.startDictionaryBatch(e),y0.addId(e,BigInt(t.id)),y0.addIsDelta(e,t.isDelta),y0.addData(e,r),y0.endDictionaryBatch(e)}function lMt(e,t){return Fx.createFieldNode(e,BigInt(t.length),BigInt(t.nullCount))}function cMt(e,t){return Lx.createBuffer(e,BigInt(t.offset),BigInt(t.length))}var uMt=(()=>{let e=new ArrayBuffer(2);return new DataView(e).setInt16(0,256,!0),new Int16Array(e)[0]===256})();var NF=e=>`Expected ${sn[e]} Message in stream, but was null or length 0.`,LF=e=>`Header pointer of flatbuffer-encoded ${sn[e]} Message is null or length 0.`,zat=(e,t)=>`Expected to read ${e} metadata bytes, but only read ${t}.`,Uat=(e,t)=>`Expected to read ${e} bytes for message body, but only read ${t}.`,cb=class{constructor(t){this.source=t instanceof Kp?t:new Kp(t)}[Symbol.iterator](){return this}next(){let t;return(t=this.readMetadataLength()).done?Cs:t.value===-1&&(t=this.readMetadataLength()).done?Cs:(t=this.readMetadata(t.value)).done?Cs:t}throw(t){return this.source.throw(t)}return(t){return this.source.return(t)}readMessage(t){let r;if((r=this.next()).done)return null;if(t!=null&&r.value.headerType!==t)throw new Error(NF(t));return r.value}readMessageBody(t){if(t<=0)return new Uint8Array(0);let r=ii(this.source.read(t));if(r.byteLength<t)throw new Error(Uat(t,r.byteLength));return r.byteOffset%8===0&&r.byteOffset+r.byteLength<=r.buffer.byteLength?r:r.slice()}readSchema(t=!1){let r=sn.Schema,i=this.readMessage(r),s=i?.header();if(t&&!s)throw new Error(LF(r));return s}readMetadataLength(){let t=this.source.read(q8),r=t&&new bu(t),i=r?.readInt32(0)||0;return{done:i===0,value:i}}readMetadata(t){let r=this.source.read(t);if(!r)return Cs;if(r.byteLength<t)throw new Error(zat(t,r.byteLength));return{done:!1,value:jc.decode(r)}}},e4=class{constructor(t,r){this.source=t instanceof wh?t:BC(t)?new BA(t,r):new wh(t)}[Symbol.asyncIterator](){return this}next(){return _r(this,void 0,void 0,function*(){let t;return(t=yield this.readMetadataLength()).done?Cs:t.value===-1&&(t=yield this.readMetadataLength()).done?Cs:(t=yield this.readMetadata(t.value)).done?Cs:t})}throw(t){return _r(this,void 0,void 0,function*(){return yield this.source.throw(t)})}return(t){return _r(this,void 0,void 0,function*(){return yield this.source.return(t)})}readMessage(t){return _r(this,void 0,void 0,function*(){let r;if((r=yield this.next()).done)return null;if(t!=null&&r.value.headerType!==t)throw new Error(NF(t));return r.value})}readMessageBody(t){return _r(this,void 0,void 0,function*(){if(t<=0)return new Uint8Array(0);let r=ii(yield this.source.read(t));if(r.byteLength<t)throw new Error(Uat(t,r.byteLength));return r.byteOffset%8===0&&r.byteOffset+r.byteLength<=r.buffer.byteLength?r:r.slice()})}readSchema(t=!1){return _r(this,void 0,void 0,function*(){let r=sn.Schema,i=yield this.readMessage(r),s=i?.header();if(t&&!s)throw new Error(LF(r));return s})}readMetadataLength(){return _r(this,void 0,void 0,function*(){let t=yield this.source.read(q8),r=t&&new bu(t),i=r?.readInt32(0)||0;return{done:i===0,value:i}})}readMetadata(t){return _r(this,void 0,void 0,function*(){let r=yield this.source.read(t);if(!r)return Cs;if(r.byteLength<t)throw new Error(zat(t,r.byteLength));return{done:!1,value:jc.decode(r)}})}},r4=class extends cb{constructor(t){super(new Uint8Array(0)),this._schema=!1,this._body=[],this._batchIndex=0,this._dictionaryIndex=0,this._json=t instanceof IS?t:new IS(t)}next(){let{_json:t}=this;if(!this._schema)return this._schema=!0,{done:!1,value:jc.fromJSON(t.schema,sn.Schema)};if(this._dictionaryIndex<t.dictionaries.length){let r=t.dictionaries[this._dictionaryIndex++];return this._body=r.data.columns,{done:!1,value:jc.fromJSON(r,sn.DictionaryBatch)}}if(this._batchIndex<t.batches.length){let r=t.batches[this._batchIndex++];return this._body=r.columns,{done:!1,value:jc.fromJSON(r,sn.RecordBatch)}}return this._body=[],Cs}readMessageBody(t){return r(this._body);function r(i){return(i||[]).reduce((s,n)=>[...s,...n.VALIDITY&&[n.VALIDITY]||[],...n.TYPE_ID&&[n.TYPE_ID]||[],...n.OFFSET&&[n.OFFSET]||[],...n.DATA&&[n.DATA]||[],...r(n.children)],[])}}readMessage(t){let r;if((r=this.next()).done)return null;if(t!=null&&r.value.headerType!==t)throw new Error(NF(t));return r.value}readSchema(){let t=sn.Schema,r=this.readMessage(t),i=r?.header();if(!r||!i)throw new Error(LF(t));return i}},q8=4,BF="ARROW1",ub=new Uint8Array(BF.length);for(let e=0;e<BF.length;e+=1)ub[e]=BF.codePointAt(e);function Y8(e,t=0){for(let r=-1,i=ub.length;++r<i;)if(ub[r]!==e[t+r])return!1;return!0}var hb=ub.length,FF=hb+q8,Vat=hb*2+q8;var Eu=class e extends M_{constructor(t){super(),this._impl=t}get closed(){return this._impl.closed}get schema(){return this._impl.schema}get autoDestroy(){return this._impl.autoDestroy}get dictionaries(){return this._impl.dictionaries}get numDictionaries(){return this._impl.numDictionaries}get numRecordBatches(){return this._impl.numRecordBatches}get footer(){return this._impl.isFile()?this._impl.footer:null}isSync(){return this._impl.isSync()}isAsync(){return this._impl.isAsync()}isFile(){return this._impl.isFile()}isStream(){return this._impl.isStream()}next(){return this._impl.next()}throw(t){return this._impl.throw(t)}return(t){return this._impl.return(t)}cancel(){return this._impl.cancel()}reset(t){return this._impl.reset(t),this._DOMStream=void 0,this._nodeStream=void 0,this}open(t){let r=this._impl.open(t);return yu(r)?r.then(()=>this):this}readRecordBatch(t){return this._impl.isFile()?this._impl.readRecordBatch(t):null}[Symbol.iterator](){return this._impl[Symbol.iterator]()}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}toDOMStream(){return Za.toDOMStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this})}toNodeStream(){return Za.toNodeStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this},{objectMode:!0})}static throughNode(t){throw new Error('"throughNode" not available in this environment')}static throughDOM(t,r){throw new Error('"throughDOM" not available in this environment')}static from(t){return t instanceof e?t:DC(t)?fMt(t):BC(t)?mMt(t):yu(t)?_r(this,void 0,void 0,function*(){return yield e.from(yield t)}):NC(t)||oS(t)||FC(t)||ph(t)?dMt(new wh(t)):pMt(new Kp(t))}static readAll(t){return t instanceof e?t.isSync()?jat(t):Wat(t):DC(t)||ArrayBuffer.isView(t)||bf(t)||OC(t)?jat(t):Wat(t)}},V0=class extends Eu{constructor(t){super(t),this._impl=t}readAll(){return[...this]}[Symbol.iterator](){return this._impl[Symbol.iterator]()}[Symbol.asyncIterator](){return _u(this,arguments,function*(){yield Fi(yield*Bx(xf(this[Symbol.iterator]())))})}},B_=class extends Eu{constructor(t){super(t),this._impl=t}readAll(){var t,r,i,s;return _r(this,void 0,void 0,function*(){let n=new Array;try{for(var o=!0,a=xf(this),h;h=yield a.next(),t=h.done,!t;o=!0){s=h.value,o=!1;let p=s;n.push(p)}}catch(p){r={error:p}}finally{try{!o&&!t&&(i=a.return)&&(yield i.call(a))}finally{if(r)throw r.error}}return n})}[Symbol.iterator](){throw new Error("AsyncRecordBatchStreamReader is not Iterable")}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}},N_=class extends V0{constructor(t){super(t),this._impl=t}},X8=class extends B_{constructor(t){super(t),this._impl=t}},Z8=class{get numDictionaries(){return this._dictionaryIndex}get numRecordBatches(){return this._recordBatchIndex}constructor(t=new Map){this.closed=!1,this.autoDestroy=!0,this._dictionaryIndex=0,this._recordBatchIndex=0,this.dictionaries=t}isSync(){return!1}isAsync(){return!1}isFile(){return!1}isStream(){return!1}reset(t){return this._dictionaryIndex=0,this._recordBatchIndex=0,this.schema=t,this.dictionaries=new Map,this}_loadRecordBatch(t,r){let i=this._loadVectors(t,r,this.schema.fields),s=_i({type:new is(this.schema.fields),length:t.length,children:i});return new yo(this.schema,s)}_loadDictionaryBatch(t,r){let{id:i,isDelta:s}=t,{dictionaries:n,schema:o}=this,a=n.get(i);if(s||!a){let h=o.dictionaries.get(i),p=this._loadVectors(t.data,r,[h]);return(a&&s?a.concat(new zi(p)):new zi(p)).memoize()}return a.memoize()}_loadVectors(t,r,i){return new RS(r,t.nodes,t.buffers,this.dictionaries,this.schema.metadataVersion).visitMany(i)}},fb=class extends Z8{constructor(t,r){super(r),this._reader=DC(t)?new r4(this._handle=t):new cb(this._handle=t)}isSync(){return!0}isStream(){return!0}[Symbol.iterator](){return this}cancel(){!this.closed&&(this.closed=!0)&&(this.reset()._reader.return(),this._reader=null,this.dictionaries=null)}open(t){return this.closed||(this.autoDestroy=$at(this,t),this.schema||(this.schema=this._reader.readSchema())||this.cancel()),this}throw(t){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.throw(t):Cs}return(t){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.return(t):Cs}next(){if(this.closed)return Cs;let t,{_reader:r}=this;for(;t=this._readNextMessageAndValidate();)if(t.isSchema())this.reset(t.header());else if(t.isRecordBatch()){this._recordBatchIndex++;let i=t.header(),s=r.readMessageBody(t.bodyLength);return{done:!1,value:this._loadRecordBatch(i,s)}}else if(t.isDictionaryBatch()){this._dictionaryIndex++;let i=t.header(),s=r.readMessageBody(t.bodyLength),n=this._loadDictionaryBatch(i,s);this.dictionaries.set(i.id,n)}return this.schema&&this._recordBatchIndex===0?(this._recordBatchIndex++,{done:!1,value:new O_(this.schema)}):this.return()}_readNextMessageAndValidate(t){return this._reader.readMessage(t)}},pb=class extends Z8{constructor(t,r){super(r),this._reader=new e4(this._handle=t)}isAsync(){return!0}isStream(){return!0}[Symbol.asyncIterator](){return this}cancel(){return _r(this,void 0,void 0,function*(){!this.closed&&(this.closed=!0)&&(yield this.reset()._reader.return(),this._reader=null,this.dictionaries=null)})}open(t){return _r(this,void 0,void 0,function*(){return this.closed||(this.autoDestroy=$at(this,t),this.schema||(this.schema=yield this._reader.readSchema())||(yield this.cancel())),this})}throw(t){return _r(this,void 0,void 0,function*(){return!this.closed&&this.autoDestroy&&(this.closed=!0)?yield this.reset()._reader.throw(t):Cs})}return(t){return _r(this,void 0,void 0,function*(){return!this.closed&&this.autoDestroy&&(this.closed=!0)?yield this.reset()._reader.return(t):Cs})}next(){return _r(this,void 0,void 0,function*(){if(this.closed)return Cs;let t,{_reader:r}=this;for(;t=yield this._readNextMessageAndValidate();)if(t.isSchema())yield this.reset(t.header());else if(t.isRecordBatch()){this._recordBatchIndex++;let i=t.header(),s=yield r.readMessageBody(t.bodyLength);return{done:!1,value:this._loadRecordBatch(i,s)}}else if(t.isDictionaryBatch()){this._dictionaryIndex++;let i=t.header(),s=yield r.readMessageBody(t.bodyLength),n=this._loadDictionaryBatch(i,s);this.dictionaries.set(i.id,n)}return this.schema&&this._recordBatchIndex===0?(this._recordBatchIndex++,{done:!1,value:new O_(this.schema)}):yield this.return()})}_readNextMessageAndValidate(t){return _r(this,void 0,void 0,function*(){return yield this._reader.readMessage(t)})}},G8=class extends fb{get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}constructor(t,r){super(t instanceof MS?t:new MS(t),r)}isSync(){return!0}isFile(){return!0}open(t){if(!this.closed&&!this._footer){this.schema=(this._footer=this._readFooter()).schema;for(let r of this._footer.dictionaryBatches())r&&this._readDictionaryBatch(this._dictionaryIndex++)}return super.open(t)}readRecordBatch(t){var r;if(this.closed)return null;this._footer||this.open();let i=(r=this._footer)===null||r===void 0?void 0:r.getRecordBatch(t);if(i&&this._handle.seek(i.offset)){let s=this._reader.readMessage(sn.RecordBatch);if(s?.isRecordBatch()){let n=s.header(),o=this._reader.readMessageBody(s.bodyLength);return this._loadRecordBatch(n,o)}}return null}_readDictionaryBatch(t){var r;let i=(r=this._footer)===null||r===void 0?void 0:r.getDictionaryBatch(t);if(i&&this._handle.seek(i.offset)){let s=this._reader.readMessage(sn.DictionaryBatch);if(s?.isDictionaryBatch()){let n=s.header(),o=this._reader.readMessageBody(s.bodyLength),a=this._loadDictionaryBatch(n,o);this.dictionaries.set(n.id,a)}}}_readFooter(){let{_handle:t}=this,r=t.size-FF,i=t.readInt32(r),s=t.readAt(r-i,i);return D0.decode(s)}_readNextMessageAndValidate(t){var r;if(this._footer||this.open(),this._footer&&this._recordBatchIndex<this.numRecordBatches){let i=(r=this._footer)===null||r===void 0?void 0:r.getRecordBatch(this._recordBatchIndex);if(i&&this._handle.seek(i.offset))return this._reader.readMessage(t)}return null}},zF=class extends pb{get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}constructor(t,...r){let i=typeof r[0]!="number"?r.shift():void 0,s=r[0]instanceof Map?r.shift():void 0;super(t instanceof BA?t:new BA(t,i),s)}isFile(){return!0}isAsync(){return!0}open(t){let r=Object.create(null,{open:{get:()=>super.open}});return _r(this,void 0,void 0,function*(){if(!this.closed&&!this._footer){this.schema=(this._footer=yield this._readFooter()).schema;for(let i of this._footer.dictionaryBatches())i&&(yield this._readDictionaryBatch(this._dictionaryIndex++))}return yield r.open.call(this,t)})}readRecordBatch(t){var r;return _r(this,void 0,void 0,function*(){if(this.closed)return null;this._footer||(yield this.open());let i=(r=this._footer)===null||r===void 0?void 0:r.getRecordBatch(t);if(i&&(yield this._handle.seek(i.offset))){let s=yield this._reader.readMessage(sn.RecordBatch);if(s?.isRecordBatch()){let n=s.header(),o=yield this._reader.readMessageBody(s.bodyLength);return this._loadRecordBatch(n,o)}}return null})}_readDictionaryBatch(t){var r;return _r(this,void 0,void 0,function*(){let i=(r=this._footer)===null||r===void 0?void 0:r.getDictionaryBatch(t);if(i&&(yield this._handle.seek(i.offset))){let s=yield this._reader.readMessage(sn.DictionaryBatch);if(s?.isDictionaryBatch()){let n=s.header(),o=yield this._reader.readMessageBody(s.bodyLength),a=this._loadDictionaryBatch(n,o);this.dictionaries.set(n.id,a)}}})}_readFooter(){return _r(this,void 0,void 0,function*(){let{_handle:t}=this;t._pending&&(yield t._pending);let r=t.size-FF,i=yield t.readInt32(r),s=yield t.readAt(r-i,i);return D0.decode(s)})}_readNextMessageAndValidate(t){return _r(this,void 0,void 0,function*(){if(this._footer||(yield this.open()),this._footer&&this._recordBatchIndex<this.numRecordBatches){let r=this._footer.getRecordBatch(this._recordBatchIndex);if(r&&(yield this._handle.seek(r.offset)))return yield this._reader.readMessage(t)}return null})}},UF=class extends fb{constructor(t,r){super(t,r)}_loadVectors(t,r,i){return new x8(r,t.nodes,t.buffers,this.dictionaries,this.schema.metadataVersion).visitMany(i)}};function $at(e,t){return t&&typeof t.autoDestroy=="boolean"?t.autoDestroy:e.autoDestroy}function*jat(e){let t=Eu.from(e);try{if(!t.open({autoDestroy:!1}).closed)do yield t;while(!t.reset().open().closed)}finally{t.cancel()}}function Wat(e){return _u(this,arguments,function*(){let r=yield Fi(Eu.from(e));try{if(!(yield Fi(r.open({autoDestroy:!1}))).closed)do yield yield Fi(r);while(!(yield Fi(r.reset().open())).closed)}finally{yield Fi(r.cancel())}})}function fMt(e){return new V0(new UF(e))}function pMt(e){let t=e.peek(hb+7&-8);return t&&t.byteLength>=4?Y8(t)?new N_(new G8(e.read())):new V0(new fb(e)):new V0(new fb(function*(){}()))}function dMt(e){return _r(this,void 0,void 0,function*(){let t=yield e.peek(hb+7&-8);return t&&t.byteLength>=4?Y8(t)?new N_(new G8(yield e.read())):new B_(new pb(e)):new B_(new pb(function(){return _u(this,arguments,function*(){})}()))})}function mMt(e){return _r(this,void 0,void 0,function*(){let{size:t}=yield e.stat(),r=new BA(e,t);return t>=Vat&&Y8(yield r.readAt(0,hb+7&-8))?new X8(new zF(r)):new B_(new pb(r))})}var Ys=class e extends Yr{static assemble(...t){let r=s=>s.flatMap(n=>Array.isArray(n)?r(n):n instanceof yo?n.data.children:n.data),i=new e;return i.visitMany(r(t)),i}constructor(){super(),this._byteLength=0,this._nodes=[],this._buffers=[],this._bufferRegions=[]}visit(t){if(t instanceof zi)return this.visitMany(t.data),this;let{type:r}=t;if(!xr.isDictionary(r)){let{length:i}=t;if(i>2147483647)throw new RangeError("Cannot write arrays larger than 2^31 - 1 in length");if(xr.isUnion(r))this.nodes.push(new Sh(i,0));else{let{nullCount:s}=t;xr.isNull(r)||Rf.call(this,s<=0?new Uint8Array(0):T_(t.offset,i,t.nullBitmap)),this.nodes.push(new Sh(i,s))}}return super.visit(t)}visitNull(t){return this}visitDictionary(t){return this.visit(t.clone(t.type.indices))}get nodes(){return this._nodes}get buffers(){return this._buffers}get byteLength(){return this._byteLength}get bufferRegions(){return this._bufferRegions}};function Rf(e){let t=e.byteLength+7&-8;return this.buffers.push(e),this.bufferRegions.push(new Uc(this._byteLength,t)),this._byteLength+=t,this}function AMt(e){var t;let{type:r,length:i,typeIds:s,valueOffsets:n}=e;if(Rf.call(this,s),r.mode===us.Sparse)return VF.call(this,e);if(r.mode===us.Dense){if(e.offset<=0)return Rf.call(this,n),VF.call(this,e);{let o=new Int32Array(i),a=Object.create(null),h=Object.create(null);for(let p,g,v=-1;++v<i;)(p=s[v])!==void 0&&((g=a[p])===void 0&&(g=a[p]=n[v]),o[v]=n[v]-g,h[p]=((t=h[p])!==null&&t!==void 0?t:0)+1);Rf.call(this,o),this.visitMany(e.children.map((p,g)=>{let v=r.typeIds[g],T=a[v],C=h[v];return p.slice(T,Math.min(i,C))}))}}return this}function gMt(e){let t;return e.nullCount>=e.length?Rf.call(this,new Uint8Array(0)):(t=e.values)instanceof Uint8Array?Rf.call(this,T_(e.offset,e.length,t)):Rf.call(this,S_(e.values))}function j0(e){return Rf.call(this,e.values.subarray(0,e.length*e.stride))}function Q8(e){let{length:t,values:r,valueOffsets:i}=e,s=no(i[0]),n=no(i[t]),o=Math.min(n-s,r.byteLength-s);return Rf.call(this,UC(-s,t+1,i)),Rf.call(this,r.subarray(s,s+o)),this}function jF(e){let{length:t,valueOffsets:r}=e;if(r){let{[0]:i,[t]:s}=r;return Rf.call(this,UC(-i,t+1,r)),this.visit(e.children[0].slice(i,s-i))}return this.visit(e.children[0])}function VF(e){return this.visitMany(e.type.children.map((t,r)=>e.children[r]).filter(Boolean))[0]}Ys.prototype.visitBool=gMt;Ys.prototype.visitInt=j0;Ys.prototype.visitFloat=j0;Ys.prototype.visitUtf8=Q8;Ys.prototype.visitLargeUtf8=Q8;Ys.prototype.visitBinary=Q8;Ys.prototype.visitLargeBinary=Q8;Ys.prototype.visitFixedSizeBinary=j0;Ys.prototype.visitDate=j0;Ys.prototype.visitTimestamp=j0;Ys.prototype.visitTime=j0;Ys.prototype.visitDecimal=j0;Ys.prototype.visitList=jF;Ys.prototype.visitStruct=VF;Ys.prototype.visitUnion=AMt;Ys.prototype.visitInterval=j0;Ys.prototype.visitDuration=j0;Ys.prototype.visitFixedSizeList=jF;Ys.prototype.visitMap=jF;var L_=class extends M_{static throughNode(t){throw new Error('"throughNode" not available in this environment')}static throughDOM(t,r){throw new Error('"throughDOM" not available in this environment')}constructor(t){super(),this._position=0,this._started=!1,this._sink=new Qp,this._schema=null,this._dictionaryBlocks=[],this._recordBatchBlocks=[],this._dictionaryDeltaOffsets=new Map,Jl(t)||(t={autoDestroy:!0,writeLegacyIpcFormat:!1}),this._autoDestroy=typeof t.autoDestroy=="boolean"?t.autoDestroy:!0,this._writeLegacyIpcFormat=typeof t.writeLegacyIpcFormat=="boolean"?t.writeLegacyIpcFormat:!1}toString(t=!1){return this._sink.toString(t)}toUint8Array(t=!1){return this._sink.toUint8Array(t)}writeAll(t){return yu(t)?t.then(r=>this.writeAll(r)):ph(t)?$F(this,t):WF(this,t)}get closed(){return this._sink.closed}[Symbol.asyncIterator](){return this._sink[Symbol.asyncIterator]()}toDOMStream(t){return this._sink.toDOMStream(t)}toNodeStream(t){return this._sink.toNodeStream(t)}close(){return this.reset()._sink.close()}abort(t){return this.reset()._sink.abort(t)}finish(){return this._autoDestroy?this.close():this.reset(this._sink,this._schema),this}reset(t=this._sink,r=null){return t===this._sink||t instanceof Qp?this._sink=t:(this._sink=new Qp,t&&iot(t)?this.toDOMStream({type:"bytes"}).pipeTo(t):t&&not(t)&&this.toNodeStream({objectMode:!1}).pipe(t)),this._started&&this._schema&&this._writeFooter(this._schema),this._started=!1,this._dictionaryBlocks=[],this._recordBatchBlocks=[],this._dictionaryDeltaOffsets=new Map,(!r||!D_(r,this._schema))&&(r==null?(this._position=0,this._schema=null):(this._started=!0,this._schema=r,this._writeSchema(r))),this}write(t){let r=null;if(this._sink){if(t==null)return this.finish()&&void 0;if(t instanceof Qa&&!(r=t.schema))return this.finish()&&void 0;if(t instanceof yo&&!(r=t.schema))return this.finish()&&void 0}else throw new Error("RecordBatchWriter is closed");if(r&&!D_(r,this._schema)){if(this._started&&this._autoDestroy)return this.close();this.reset(this._sink,r)}t instanceof yo?t instanceof O_||this._writeRecordBatch(t):t instanceof Qa?this.writeAll(t.batches):bf(t)&&this.writeAll(t)}_writeMessage(t,r=8){let i=r-1,s=jc.encode(t),n=s.byteLength,o=this._writeLegacyIpcFormat?4:8,a=n+o+i&~i,h=a-n-o;return t.headerType===sn.RecordBatch?this._recordBatchBlocks.push(new O0(a,t.bodyLength,this._position)):t.headerType===sn.DictionaryBatch&&this._dictionaryBlocks.push(new O0(a,t.bodyLength,this._position)),this._writeLegacyIpcFormat||this._write(Int32Array.of(-1)),this._write(Int32Array.of(a-o)),n>0&&this._write(s),this._writePadding(h)}_write(t){if(this._started){let r=ii(t);r&&r.byteLength>0&&(this._sink.write(r),this._position+=r.byteLength)}return this}_writeSchema(t){return this._writeMessage(jc.from(t))}_writeFooter(t){return this._writeLegacyIpcFormat?this._write(Int32Array.of(0)):this._write(Int32Array.of(-1,0))}_writeMagic(){return this._write(ub)}_writePadding(t){return t>0?this._write(new Uint8Array(t)):this}_writeRecordBatch(t){let{byteLength:r,nodes:i,bufferRegions:s,buffers:n}=Ys.assemble(t),o=new Ka(t.numRows,i,s),a=jc.from(o,r);return this._writeDictionaries(t)._writeMessage(a)._writeBodyBuffers(n)}_writeDictionaryBatch(t,r,i=!1){this._dictionaryDeltaOffsets.set(r,t.length+(this._dictionaryDeltaOffsets.get(r)||0));let{byteLength:s,nodes:n,bufferRegions:o,buffers:a}=Ys.assemble(new zi([t])),h=new Ka(t.length,n,o),p=new Vc(h,r,i),g=jc.from(p,s);return this._writeMessage(g)._writeBodyBuffers(a)}_writeBodyBuffers(t){let r,i,s;for(let n=-1,o=t.length;++n<o;)(r=t[n])&&(i=r.byteLength)>0&&(this._write(r),(s=(i+7&-8)-i)>0&&this._writePadding(s));return this}_writeDictionaries(t){for(let[r,i]of t.dictionaries){let s=this._dictionaryDeltaOffsets.get(r)||0;if(s===0||(i=i?.slice(s)).length>0)for(let n of i.data)this._writeDictionaryBatch(n,r,s>0),s+=n.length}return this}},F_=class e extends L_{static writeAll(t,r){let i=new e(r);return yu(t)?t.then(s=>i.writeAll(s)):ph(t)?$F(i,t):WF(i,t)}},z_=class e extends L_{static writeAll(t){let r=new e;return yu(t)?t.then(i=>r.writeAll(i)):ph(t)?$F(r,t):WF(r,t)}constructor(){super(),this._autoDestroy=!0}_writeSchema(t){return this._writeMagic()._writePadding(2)}_writeFooter(t){let r=D0.encode(new D0(t,Wn.V5,this._recordBatchBlocks,this._dictionaryBlocks));return super._writeFooter(t)._write(r)._write(Int32Array.of(r.byteLength))._writeMagic()}};function WF(e,t){let r=t;t instanceof Qa&&(r=t.batches,e.reset(void 0,t.schema));for(let i of r)e.write(i);return e.finish()}function $F(e,t){var r,i,s,n,o,a,h;return _r(this,void 0,void 0,function*(){try{for(r=!0,i=xf(t);s=yield i.next(),n=s.done,!n;r=!0){h=s.value,r=!1;let p=h;e.write(p)}}catch(p){o={error:p}}finally{try{!r&&!n&&(a=i.return)&&(yield a.call(i))}finally{if(o)throw o.error}}return e.finish()})}function Hat(e,t){if(ph(e))return yMt(e,t);if(bf(e))return _Mt(e,t);throw new Error("toDOMStream() must be called with an Iterable or AsyncIterable")}function _Mt(e,t){let r=null,i=t?.type==="bytes"||!1,s=t?.highWaterMark||Math.pow(2,24);return new ReadableStream(Object.assign(Object.assign({},t),{start(o){n(o,r||(r=e[Symbol.iterator]()))},pull(o){r?n(o,r):o.close()},cancel(){(r?.return&&r.return()||!0)&&(r=null)}}),Object.assign({highWaterMark:i?s:void 0},t));function n(o,a){let h,p=null,g=o.desiredSize||null;for(;!(p=a.next(i?g:null)).done;)if(ArrayBuffer.isView(p.value)&&(h=ii(p.value))&&(g!=null&&i&&(g=g-h.byteLength+1),p.value=h),o.enqueue(p.value),g!=null&&--g<=0)return;o.close()}}function yMt(e,t){let r=null,i=t?.type==="bytes"||!1,s=t?.highWaterMark||Math.pow(2,24);return new ReadableStream(Object.assign(Object.assign({},t),{start(o){return _r(this,void 0,void 0,function*(){yield n(o,r||(r=e[Symbol.asyncIterator]()))})},pull(o){return _r(this,void 0,void 0,function*(){r?yield n(o,r):o.close()})},cancel(){return _r(this,void 0,void 0,function*(){(r?.return&&(yield r.return())||!0)&&(r=null)})}}),Object.assign({highWaterMark:i?s:void 0},t));function n(o,a){return _r(this,void 0,void 0,function*(){let h,p=null,g=o.desiredSize||null;for(;!(p=yield a.next(i?g:null)).done;)if(ArrayBuffer.isView(p.value)&&(h=ii(p.value))&&(g!=null&&i&&(g=g-h.byteLength+1),p.value=h),o.enqueue(p.value),g!=null&&--g<=0)return;o.close()})}}function Xat(e){return new HF(e)}var HF=class{constructor(t){this._numChunks=0,this._finished=!1,this._bufferedSize=0;let{["readableStrategy"]:r,["writableStrategy"]:i,["queueingStrategy"]:s="count"}=t,n=eot(t,["readableStrategy","writableStrategy","queueingStrategy"]);this._controller=null,this._builder=Jp(n),this._getSize=s!=="bytes"?qat:Yat;let{["highWaterMark"]:o=s==="bytes"?Math.pow(2,14):1e3}=Object.assign({},r),{["highWaterMark"]:a=s==="bytes"?Math.pow(2,14):1e3}=Object.assign({},i);this.readable=new ReadableStream({cancel:()=>{this._builder.clear()},pull:h=>{this._maybeFlush(this._builder,this._controller=h)},start:h=>{this._maybeFlush(this._builder,this._controller=h)}},{highWaterMark:o,size:s!=="bytes"?qat:Yat}),this.writable=new WritableStream({abort:()=>{this._builder.clear()},write:()=>{this._maybeFlush(this._builder,this._controller)},close:()=>{this._maybeFlush(this._builder.finish(),this._controller)}},{highWaterMark:a,size:h=>this._writeValueAndReturnChunkSize(h)})}_writeValueAndReturnChunkSize(t){let r=this._bufferedSize;return this._bufferedSize=this._getSize(this._builder.append(t)),this._bufferedSize-r}_maybeFlush(t,r){r!=null&&(this._bufferedSize>=r.desiredSize&&++this._numChunks&&this._enqueue(r,t.toVector()),t.finished&&((t.length>0||this._numChunks===0)&&++this._numChunks&&this._enqueue(r,t.toVector()),!this._finished&&(this._finished=!0)&&this._enqueue(r,null)))}_enqueue(t,r){this._bufferedSize=0,this._controller=null,r==null?t.close():t.enqueue(r)}},qat=e=>{var t;return(t=e?.length)!==null&&t!==void 0?t:0},Yat=e=>{var t;return(t=e?.byteLength)!==null&&t!==void 0?t:0};function K8(e,t){let r=new Qp,i=null,s=new ReadableStream({cancel(){return _r(this,void 0,void 0,function*(){yield r.close()})},start(a){return _r(this,void 0,void 0,function*(){yield o(a,i||(i=yield n()))})},pull(a){return _r(this,void 0,void 0,function*(){i?yield o(a,i):a.close()})}});return{writable:new WritableStream(r,Object.assign({highWaterMark:Math.pow(2,14)},e)),readable:s};function n(){return _r(this,void 0,void 0,function*(){return yield(yield Eu.from(r)).open(t)})}function o(a,h){return _r(this,void 0,void 0,function*(){let p=a.desiredSize,g=null;for(;!(g=yield h.next()).done;)if(a.enqueue(g.value),p!=null&&--p<=0)return;a.close()})}}function J8(e,t){let r=new this(e),i=new wh(r),s=new ReadableStream({cancel(){return _r(this,void 0,void 0,function*(){yield i.cancel()})},pull(o){return _r(this,void 0,void 0,function*(){yield n(o)})},start(o){return _r(this,void 0,void 0,function*(){yield n(o)})}},Object.assign({highWaterMark:Math.pow(2,14)},t));return{writable:new WritableStream(r,e),readable:s};function n(o){return _r(this,void 0,void 0,function*(){let a=null,h=o.desiredSize;for(;a=yield i.read(h||null);)if(o.enqueue(a),h!=null&&(h-=a.byteLength)<=0)return;o.close()})}}function i4(e){let t=Eu.from(e);return yu(t)?t.then(r=>i4(r)):t.isAsync()?t.readAll().then(r=>new Qa(r)):new Qa(t.readAll())}function tP(e,t="stream"){return(t==="stream"?F_:z_).writeAll(e).toUint8Array(!0)}var NMt=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},rF),MF),yF),iF),QL),_F),tF),{compareSchemas:D_,compareFields:bat,compareTypes:vat});Za.toDOMStream=Hat;Fs.throughDOM=Xat;Eu.throughDOM=K8;N_.throughDOM=K8;V0.throughDOM=K8;L_.throughDOM=J8;z_.throughDOM=J8;F_.throughDOM=J8;function n4(e,t=1){return(e*t+63&-64||64)/t}function rc(e,t,r=e.BYTES_PER_ELEMENT){return new e(n4(t,r))}function eP(e){return e instanceof gn?e:new gn(e.type,0,e.length,e.nulls,e.buffers,null,e.dict)}function Zat(e){return new zi([eP(e)])}var qF=new TextEncoder;function LMt(e,t,r){let i=qF.encode(r);return e.set(i,t),i.length}function FMt(e,t,r){return qF.encodeInto(r,e.subarray(t)).written}var Gat=qF.encodeInto?FMt:LMt;function YF(e,t){let r=rc(e.ArrayType,t);return{set(i,s){r[s]=i},data:()=>({type:e,length:t,buffers:[null,r]})}}function Qat(e,t){let r=rc(e.ArrayType,t/8);return{set(i,s){i&&(r[s>>3]|=1<<s%8)},data:()=>({type:e,length:t,buffers:[null,r]})}}function Kat(e,t){let r=rc(e.ArrayType,t);return{set(i,s){r[s]=i/864e5|0},data:()=>({type:e,length:t,buffers:[null,r]})}}function Jat(e,t){let r=rc(e.ArrayType,t<<1);return{set(i,s){let n=s<<1;r[n]=i%4294967296|0,r[n+1]=i/4294967296|0},data:()=>({type:e,length:t,buffers:[null,r]})}}function tlt(e){let t=Jp({type:e,nullValues:[null,void 0]});return{set(r,i){t.set(i,r)},data:()=>t.finish().flush()}}function elt(e,t,r){let i=rc(Int32Array,t+1),s=rc(Uint8Array,3*r),n=0;return{set(o,a){n+=Gat(s,n,o),i[a+1]=n},data:()=>{let o=n4(n),a=s.length>o?s.subarray(0,o):s;return{type:e,length:t,buffers:[i,a]}}}}function rlt(e,t){let r=[],i=rc(e.indices.ArrayType,t),s=Object.create(null),n=-1,o=0;return{set(a,h){let p=String(a),g=s[p];g===void 0&&(o+=p.length,s[p]=g=++n,r.push(p)),i[h]=g},data:()=>({type:e,length:t,buffers:[null,i],dict:zMt(e.dictionary,r,o)})}}function zMt(e,t,r){let i=elt(e,t.length,r);return t.forEach(i.set),Zat(i.data())}function ilt(e,t){let r=rc(Uint8Array,t/8),i=0;return{set(s,n){s==null?++i:(e.set(s,n),r[n>>3]|=1<<n%8)},data:()=>{let s=e.data();return i&&(s.nulls=i,s.buffers[2]=r),s}}}function nlt(e,t,r=!0){let i;switch(e.typeId){case Lt.Int:i=e.bitWidth<64?YF:null;break;case Lt.Float:i=e.precision>0?YF:null;break;case Lt.Dictionary:i=e.dictionary.typeId===Lt.Utf8&&e.indices.typeId===Lt.Int&&e.indices.bitWidth<64?rlt:null;break;case Lt.Bool:i=Qat;break;case Lt.Date:i=e.unit?Jat:Kat;break}return i==null?tlt(e):r?ilt(i(e,t),t):i(e,t)}function slt(e,t){let r=e.length,i=n4(r,e.BYTES_PER_ELEMENT),s=e;return r!==i&&(s=new e.constructor(i),s.set(e)),eP({type:t,length:r,buffers:[null,s]})}function rP(e,t,r,i,s=!0){let n=nlt(i,e,s);return t(r,n.set),eP(n.data())}function db(e){if(e instanceof xr||e==null)return e;switch(e){case Lt.Binary:return new Ah;case Lt.Bool:return new gh;case Lt.DateDay:return new jx;case Lt.DateMillisecond:case Lt.Date:return new Wx;case Lt.Dictionary:return new Pl(new wu,new Ml);case Lt.Float16:return new v_;case Lt.Float32:return new C0;case Lt.Float64:case Lt.Float:return new P0;case Lt.Int8:return new v0;case Lt.Int16:return new w0;case Lt.Int32:case Lt.Int:return new Ml;case Lt.Int64:return new T0;case Lt.IntervalDayTime:return new Xx;case Lt.Interval:case Lt.IntervalYearMonth:return new Zx;case Lt.Null:return new Ia;case Lt.TimeMicrosecond:return new qx;case Lt.TimeMillisecond:case Lt.Time:return new Hx;case Lt.TimeNanosecond:return new Yx;case Lt.TimeSecond:return new $x;case Lt.Uint8:return new S0;case Lt.Uint16:return new E0;case Lt.Uint32:return new I0;case Lt.Uint64:return new M0;case Lt.Utf8:return new wu;default:sr(`Unsupported type code: ${Ls(e)}. Use a data type constructor instead?`)}}function olt(e){return e.getUTCHours()===0&&e.getUTCMinutes()===0&&e.getUTCSeconds()===0&&e.getUTCMilliseconds()===0}function iP(e,t){let r=XF();return e(t,r.add),r}function XF(){let e={count:0,nulls:0,bools:0,nums:0,ints:0,bigints:0,min:1/0,max:-1/0,digits:0,dates:0,utcdays:0,strings:0,strlen:0,arrays:0,minlen:1/0,maxlen:0,structs:0,add(t){if(++e.count,t==null){++e.nulls;return}let r=typeof t;if(r==="string")++e.strings;else if(r==="number")++e.nums,t<e.min&&(e.min=t),t>e.max&&(e.max=t),Number.isInteger(t)&&++e.ints;else if(r==="boolean")++e.bools;else if(r==="object")if(Ya(t))++e.dates,olt(t)&&++e.utcdays;else if(Au(t)){++e.arrays,t.length<e.minlen&&(e.minlen=t.length),t.length>e.maxlen&&(e.maxlen=t.length);let i=e.array_prof||(e.array_prof=XF());t.forEach(i.add)}else{++e.structs;let i=e.struct_prof||(e.struct_prof={});for(let s in t)(i[s]||(i[s]=XF())).add(t[s])}else r==="bigint"&&(++e.bigints,t<e.min&&(e.min=t),t>e.max&&(e.max=t))},type(){return db(UMt(e))}};return e}function UMt(e){let t=e.count-e.nulls;if(t===0)return Lt.Null;if(e.ints===t){let r=Math.max(Math.abs(e.min)-1,e.max);return e.min<0?r>=2**31?Lt.Float64:r<128?Lt.Int8:r<32768?Lt.Int16:Lt.Int32:r>=2**32?Lt.Float64:r<256?Lt.Uint8:r<65536?Lt.Uint16:Lt.Uint32}else{if(e.nums===t)return Lt.Float64;if(e.bigints===t){let r=-e.min>e.max?-e.min-1n:e.max;return e.min<0?r<2**63?Lt.Int64:sr(`BigInt exceeds 64 bits: ${r}`):e.max<2**64?Lt.Uint64:sr(`BigInt exceeds 64 bits: ${e.max}`)}else{if(e.bools===t)return Lt.Bool;if(e.utcdays===t)return Lt.DateDay;if(e.dates===t)return Lt.DateMillisecond;if(e.arrays===t){let r=Ui.new("value",e.array_prof.type(),!0);return e.minlen===e.maxlen?new Fc(e.minlen,r):new Lc(r)}else if(e.structs===t){let r=e.struct_prof;return new is(Object.keys(r).map(i=>Ui.new(i,r[i].type(),!0)))}else{if(e.strings>0)return Lt.Dictionary;sr("Type inference failure")}}}}function alt(e,t,r,i,s,n=!0){if(s=db(s),!s){let o=iP(i,t);n=o.nulls>0,s=o.type()}return rP(r,i,t,s,n)}function clt(e,t,r,i,s,n=!0){s=db(s);let o=e.column(t),a=!(e.isFiltered()||e.isOrdered()),h=VMt(o);if(h&&a&&llt(h.type,s))return h;let p=o.data;if(Op(p)){let g=jMt(p);if(a&&g&&llt(g,s))return slt(p,g);s=s||g,n=!1}if(!s){let g=iP(i,o);n=g.nulls>0,s=g.type()}return rP(r,i,o,s,n)}function VMt(e){return e instanceof zi?e:e.vector instanceof zi?e.vector:null}function jMt(e){let r={Float32Array:C0,Float64Array:P0,Int8Array:v0,Int16Array:w0,Int32Array:Ml,Uint8Array:S0,Uint16Array:E0,Uint32Array:I0,BigInt64Array:T0,BigUint64Array:M0}[e.constructor.name];return r?new r:null}function llt(e,t){return!e||!t?!0:e.compareTo(t)}function ult(e,t,r){let i=Math.min(e.length,r+t);return(s,n)=>{for(let o=r;o<i;++o)n(e[o][s],o)}}function hlt(e,t,r){let i=r===0&&e.numRows()<=t&&!e.isFiltered()&&!e.isOrdered();return(s,n)=>{let o=-1;i&&Au(s.data)?s.data.forEach(n):e.scan(a=>n(s.get(a),++o),!0,t,r)}}var flt=()=>sr("Apache Arrow not imported, see https://github.com/uwdata/arquero#usage");function plt(){try{return Qa}catch{flt()}}function dlt(){try{return i4}catch{flt()}}function s4(e,t={}){let{types:r={}}=t,{dataFrom:i,names:s,nrows:n,scan:o}=WMt(e,t),a={};s.forEach(p=>{let g=i(e,p,n,o,r[p]);g.length!==n&&sr("Column length mismatch"),a[p]=g});let h=plt();return new h(a)}function WMt(e,t){let{columns:r,limit:i=1/0,offset:s=0}=t,n=Li(r)?r(e):li(r)?r:null;if(li(e))return{dataFrom:alt,names:n||Object.keys(e[0]),nrows:Math.min(i,e.length-s),scan:ult(e,i,s)};if($Mt(e))return{dataFrom:clt,names:n||e.columnNames(),nrows:Math.min(i,e.numRows()-s),scan:hlt(e,i,s)};sr("Unsupported input data type")}function $Mt(e){return e&&Li(e.reify)}var mlt=s4;function Alt(e,t={}){let{format:r,...i}=t,s=r||"stream";if(!["stream","file"].includes(s))throw Error("Unrecognised output format");return tP(s4(e,i),r)}function HMt(e){return e.getUTCHours()===0&&e.getUTCMinutes()===0&&e.getUTCSeconds()===0&&e.getUTCMilliseconds()===0}function glt(e,t={}){let r=0,i=0,s=0,n=0,o=0,a=0;return e(h=>{if(++r,h==null){++i;return}let p=typeof h;if(p==="object"&&Ya(h))++s,HMt(h)&&++n;else if(p==="number"&&(++o,h===h&&(h|0)!==h)){let g=h+"",v=g.indexOf(".");if(v>=0){let T=g.indexOf("e"),C=T>0?T:g.length;a=Math.max(a,C-v-1)}}}),{align:(i+o+s)/r>.5?"r":"l",format:{utc:s===n,digits:Math.min(a,t.maxdigits||6)}}}function NA(e,t){return Li(t)?t(e):t||e.columnNames()}function nP(e,t,r){let i=r.format||{},s=r.align||{},n={},o={};return t.forEach(a=>{let h=glt(qMt(e,a),r);o[a]=s[a]||h.align,n[a]=i[a]||h.format}),{align:o,format:n}}function qMt(e,t){let r=e.column(t);return i=>e.scan(s=>i(r.get(s)))}function mb(e,t,r=100,i,s){let n=e.data(),o=t.length;e.scan(a=>{s.row(a);for(let h=0;h<o;++h){let p=t[h];s.cell(n[t[h]].get(a),p,h)}},!0,r,i)}function _lt(e,t={}){let r=NA(e,t.columns),i=t.format||{},s=t.delimiter||",",n=new RegExp(`["${s}
\r]`),o=p=>p==null?"":Ya(p)?bA(p,!0):n.test(p+="")?'"'+p.replace(/"/g,'""')+'"':p,a=r.map(o),h="";return mb(e,r,t.limit||1/0,t.offset,{row(){h+=a.join(s)+`
`},cell(p,g,v){a[v]=o(i[g]?i[g](p):p)}}),h+a.join(s)}function sP(e,t={}){if(Li(t))return t(e)+"";let r=typeof e;if(r==="object"){if(Ya(e))return t.utc?bA(e):EC(e);{let i=JSON.stringify(e,(n,o)=>Op(o)?Array.from(o):o),s=t.maxlen||30;return i.length>s?i.slice(0,28)+"\u2026"+(i[0]==="["?"]":"}"):i}}else if(r==="number"){let i=t.digits||0,s;return e!==0&&((s=Math.abs(e))>=1e18||s<Math.pow(10,-i))?e.toExponential(i):e.toFixed(i)}else return e+""}function U_(e,t,r={}){for(let i in e)r[i]=t(e[i],i);return r}function ylt(e,t={}){let r=NA(e,t.columns),{align:i,format:s}=nP(e,r,t),n=YMt(t),o=t.null,a=L=>L==="c"?"center":L==="r"?"right":"left",h=L=>L.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),p=(L,z)=>h(sP(L,z)),g=o?(L,z)=>L==null?o(L):p(L,z):p,v=-1,T=-1,C=(L,z,W)=>{let Z=W?a(i[z]):"",X=n[L]&&n[L](z,T,v)||"",q=(Z?`text-align: ${Z};`+(X?" ":""):"")+X;return`<${L}${q?` style="${q}"`:""}>`},B=C("table")+C("thead")+C("tr",v)+r.map(L=>`${C("th",L,1)}${L}</th>`).join("")+"</tr></thead>"+C("tbody");return mb(e,r,t.limit,t.offset,{row(L){v=L,B+=(++T?"</tr>":"")+C("tr")},cell(L,z){B+=C("td",z,1)+g(L,s[z])+"</td>"}}),B+"</tr></tbody></table>"}function YMt(e){return U_(e.style,t=>Li(t)?t:()=>t)}function oP(e,t=!0,r=!1){return e===void 0||e?t:r}var XMt=e=>Ya(e)?bA(e,!0):e;function xlt(e,t={}){let r=oP(t.schema),i=t.format||{},s=NA(e,t.columns),n="{";return r&&(n+='"schema":{"fields":'+JSON.stringify(s.map(o=>({name:o})))+'},"data":{'),s.forEach((o,a)=>{n+=(a?",":"")+JSON.stringify(o)+":[";let h=e.column(o),p=i[o]||XMt,g=-1;e.scan(v=>{let T=h.get(v);n+=(++g?",":"")+JSON.stringify(p(T))},!0,t.limit,t.offset),n+="]"}),n+"}"+(r?"}":"")}function blt(e,t={}){let r=NA(e,t.columns),{align:i,format:s}=nP(e,r,t),n=h=>h==="c"?":-:":h==="r"?"-:":":-",o=h=>h.replace(/\|/g,"\\|"),a="|"+r.map(o).join("|")+`|
|`+r.map(h=>n(i[h])).join("|")+"|";return mb(e,r,t.limit,t.offset,{row(){a+=`
|`},cell(h,p){a+=o(sP(h,s[p]))+"|"}}),a+`
`}function aP(e,t){for(let[r,i]of wA(t))e.set(r,i);return e}function lP(e){return e.replace(/[.*+\-?^${}()|[\]\\]/g,"\\$&")}function Ja(e,t,r=new Map){return t=qs(t)?e.columnName(t):t,Ln(t)?r.set(t,t):li(t)?t.forEach(i=>Ja(e,i,r)):Li(t)?Ja(e,t(e),r):_s(t)?aP(r,t):sr(`Invalid column selection: ${Ls(t)}`),r}function cP(e,t){return e.toObject=t,e}function vlt(e){return li(e)?e.map(vlt):e&&e.toObject?e.toObject():e}function Iu(){return cP(e=>e.columnNames(),()=>({all:[]}))}function Ab(...e){return e=e.flat(),cP(t=>{let r=Ja(t,e);return t.columnNames(i=>!r.has(i))},()=>({not:vlt(e)}))}function uP(e,t){return cP(r=>{let i=qs(e)?e:r.columnIndex(e),s=qs(t)?t:r.columnIndex(t);if(s<i){let n=s;s=i,i=n}return r.columnNames().slice(i,s+1)},()=>({range:[e,t]}))}function gb(e){return Ln(e)&&(e=RegExp(lP(e))),cP(t=>t.columnNames(r=>e.test(r)),()=>({matches:[e.source,e.flags]}))}function wlt(e){return gb(RegExp("^"+lP(e)))}function Tlt(e){return gb(RegExp(lP(e)+"$"))}function Slt(e){return Op(e.data)?e.data.constructor:Array}var tl=class e extends m_{static from(t,r){return new e(mst(t,r),r)}static new(t,r){if(t instanceof e)return t;let i={},s=[];for(let[n,o]of wA(t))i[n]=o,s.push(n);return new e(i,r||s)}constructor(t,r,i,s,n,o){U_(t,TC,t),r=r||Object.keys(t);let a=r.length?t[r[0]].length:0;super(r,a,t,i,s,n,o)}create({data:t,names:r,filter:i,groups:s,order:n}){let o=i!==void 0?i:this.mask();return new e(t||this._data,r||(t?null:this._names),o,s!==void 0?s:Ost(this._group,i&&o),n!==void 0?n:this._order,this._params)}assign(...t){let r=this.numRows(),i=this.reify(),s=ys(i).groupby(i.groups());return t.forEach(n=>{n=e.new(n),n.numRows()!==r&&sr("Assign row counts do not match"),n=n.reify(),n.columnNames(o=>s.add(o,n.column(o)))}),this.create(s.new())}columns(){return this._data}column(t){return this._data[t]}columnAt(t){return this._data[this._names[t]]}array(t,r=Array){let i=this.column(t),s=new r(this.numRows()),n=-1;return this.scan(o=>s[++n]=i.get(o),!0),s}get(t,r=0){let i=this.column(t);return this.isFiltered()||this.isOrdered()?i.get(this.indices()[r]):i.get(r)}getter(t){let r=this.column(t),i=this.isFiltered()||this.isOrdered()?this.indices():null;return i?s=>r.get(i[s]):r?s=>r.get(s):sr(`Unrecognized column: ${t}`)}object(t=0){return Elt(this)(t)}objects(t={}){let{grouped:r,limit:i,offset:s}=t,n=Ja(this,t.columns||Iu()),o=HL(n),a=[];if(this.scan((h,p)=>a.push(o(h,p)),!0,i,s),r&&this.isGrouped()){let h=[];return this.scan(p=>h.push(p),!0,i,s),Nst(this,h,a,r)}return a}*[Symbol.iterator](){let t=Elt(this),r=this.numRows();for(let i=0;i<r;++i)yield t(i)}reify(t){let r=t?t.length:this.numRows(),i=this._names,s,n;if(!t&&!this.isOrdered())if(this.isFiltered())r===this.totalRows()&&(s=this.data());else return this;if(!s){let o=t?h=>t.forEach(h):h=>this.scan(h,!0),a=i.length;s={};for(let h=0;h<a;++h){let p=i[h],g=this.column(p),v=s[p]=new(Slt(g))(r),T=-1;o(C=>v[++T]=g.get(C))}this.isGrouped()&&(n=Bst(this.groups(),o,!!t,r))}return this.create({data:s,names:i,groups:n,filter:null,order:null})}transform(...t){return t.flat().reduce((r,i)=>i(r),this)}toArrow(t){return mlt(this,t)}toArrowBuffer(t){return Alt(this,t)}toCSV(t){return _lt(this,t)}toHTML(t){return ylt(this,t)}toJSON(t){return xlt(this,t)}toMarkdown(t){return blt(this,t)}};function Elt(e){let t=e._builder;if(!t){let r=HL(e.columnNames()),i=e.data();if(e.isOrdered()||e.isFiltered()){let s=e.indices();t=n=>r(s[n],i)}else t=s=>r(s,i);e._builder=t}return t}var V_=class{constructor(t){this._outputs=t}size(){return this._outputs.length}outputs(){return this._outputs}init(){return{}}add(){}rem(){}write(){}};function on(e,t,r,i){let s=r[e.type]||r.Default;if(s&&s(e,t,i)===!1)return;let n=ZMt[e.type];n&&n(e,t,r)}var hP=(e,t,r)=>{on(e.argument,t,r,e)},ZF=(e,t,r)=>{on(e.left,t,r,e),on(e.right,t,r,e)},Ilt=(e,t,r)=>{on(e.test,t,r,e),on(e.consequent,t,r,e),e.alternate&&on(e.alternate,t,r,e)},GF=(e,t,r)=>{ed(e.params,t,r,e),on(e.body,t,r,e)},Mlt=(e,t,r)=>{on(e.callee,t,r,e),ed(e.arguments,t,r,e)},ed=(e,t,r,i)=>{e.forEach(s=>on(s,t,r,i))},ZMt={TemplateLiteral:(e,t,r)=>{ed(e.expressions,t,r,e),ed(e.quasis,t,r,e)},MemberExpression:(e,t,r)=>{on(e.object,t,r,e),on(e.property,t,r,e)},CallExpression:Mlt,NewExpression:Mlt,ArrayExpression:(e,t,r)=>{ed(e.elements,t,r,e)},AssignmentExpression:ZF,AwaitExpression:hP,BinaryExpression:ZF,LogicalExpression:ZF,UnaryExpression:hP,UpdateExpression:hP,ConditionalExpression:Ilt,ObjectExpression:(e,t,r)=>{ed(e.properties,t,r,e)},Property:(e,t,r)=>{on(e.key,t,r,e),on(e.value,t,r,e)},ArrowFunctionExpression:GF,FunctionExpression:GF,FunctionDeclaration:GF,VariableDeclaration:(e,t,r)=>{ed(e.declarations,t,r,e)},VariableDeclarator:(e,t,r)=>{on(e.id,t,r,e),on(e.init,t,r,e)},SpreadElement:(e,t,r)=>{on(e.argument,t,r,e)},BlockStatement:(e,t,r)=>{ed(e.body,t,r,e)},ExpressionStatement:(e,t,r)=>{on(e.expression,t,r,e)},IfStatement:Ilt,ForStatement:(e,t,r)=>{on(e.init,t,r,e),on(e.test,t,r,e),on(e.update,t,r,e),on(e.body,t,r,e)},WhileStatement:(e,t,r)=>{on(e.test,t,r,e),on(e.body,t,r,e)},DoWhileStatement:(e,t,r)=>{on(e.body,t,r,e),on(e.test,t,r,e)},SwitchStatement:(e,t,r)=>{on(e.discriminant,t,r,e),ed(e.cases,t,r,e)},SwitchCase:(e,t,r)=>{e.test&&on(e.test,t,r,e),ed(e.consequent,t,r,e)},ReturnStatement:hP,Program:(e,t,r)=>{on(e.body[0],t,r,e)}};function Plt(e){delete e.start,delete e.end,delete e.optional}function Clt(e){Plt(e),delete e.object,delete e.property,delete e.computed,e.table||delete e.table}function Rlt(e){return on(e,null,{Column:Clt,Constant:Clt,Default:Plt}),e}function Fo(e,t){return t&&t.type===e}function klt(e){return Fo(zst,e)||Fo(Fst,e)}function Dlt(e){return Li(e)?e:()=>e}var GMt="Escaped functions are not valid as rollup or pivot values.";function Olt(e,t,r){e.aggronly&&sr(GMt);let i="(row,data)=>fn("+$L(e.table.columnNames())+",$)";return{escape:Dx.escape(i,Dlt(t.expr),r)}}var QMt=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,370,1,81,2,71,10,50,3,123,2,54,14,32,10,3,1,11,3,46,10,8,0,46,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,2,11,83,11,7,0,3,0,158,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,193,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,84,14,5,9,243,14,166,9,71,5,2,1,3,3,2,0,2,1,13,9,120,6,3,6,4,0,29,9,41,6,2,3,9,0,10,10,47,15,406,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,330,3,10,1,2,0,49,6,4,4,14,9,5351,0,7,14,13835,9,87,9,39,4,60,6,26,9,1014,0,2,54,8,3,82,0,12,1,19628,1,4706,45,3,22,543,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,101,0,161,6,10,9,357,0,62,13,499,13,983,6,110,6,6,9,4759,9,787719,239],Ult=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,13,10,2,14,2,6,2,1,2,10,2,14,2,6,2,1,68,310,10,21,11,7,25,5,2,41,2,8,70,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,349,41,7,1,79,28,11,0,9,21,43,17,47,20,28,22,13,52,58,1,3,0,14,44,33,24,27,35,30,0,3,0,9,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,20,1,64,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,159,52,19,3,21,2,31,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,14,0,72,26,38,6,186,43,117,63,32,7,3,0,3,7,2,1,2,23,16,0,2,0,95,7,3,38,17,0,2,0,29,0,11,39,8,0,22,0,12,45,20,0,19,72,264,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,328,18,16,0,2,12,2,33,125,0,80,921,103,110,18,195,2637,96,16,1071,18,5,4026,582,8634,568,8,30,18,78,18,29,19,47,17,3,32,20,6,18,689,63,129,74,6,0,67,12,65,1,2,0,29,6135,9,1237,43,8,8936,3,2,6,2,1,2,290,16,0,30,2,3,0,15,3,9,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,1845,30,7,5,262,61,147,44,11,6,17,0,322,29,19,43,485,27,757,6,2,3,2,1,2,14,2,196,60,67,8,0,1205,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42719,33,4153,7,221,3,5761,15,7472,16,621,2467,541,1507,4938,6,4191],KMt="\u200C\u200D\xB7\u0300-\u036F\u0387\u0483-\u0487\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u0669\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u06F0-\u06F9\u0711\u0730-\u074A\u07A6-\u07B0\u07C0-\u07C9\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u0898-\u089F\u08CA-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0966-\u096F\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u09E6-\u09EF\u09FE\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A66-\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0AE6-\u0AEF\u0AFA-\u0AFF\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B55-\u0B57\u0B62\u0B63\u0B66-\u0B6F\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0BE6-\u0BEF\u0C00-\u0C04\u0C3C\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C66-\u0C6F\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0CE6-\u0CEF\u0CF3\u0D00-\u0D03\u0D3B\u0D3C\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D66-\u0D6F\u0D81-\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0E50-\u0E59\u0EB1\u0EB4-\u0EBC\u0EC8-\u0ECE\u0ED0-\u0ED9\u0F18\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1040-\u1049\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F-\u109D\u135D-\u135F\u1369-\u1371\u1712-\u1715\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u17E0-\u17E9\u180B-\u180D\u180F-\u1819\u18A9\u1920-\u192B\u1930-\u193B\u1946-\u194F\u19D0-\u19DA\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AB0-\u1ABD\u1ABF-\u1ACE\u1B00-\u1B04\u1B34-\u1B44\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BB0-\u1BB9\u1BE6-\u1BF3\u1C24-\u1C37\u1C40-\u1C49\u1C50-\u1C59\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF4\u1CF7-\u1CF9\u1DC0-\u1DFF\u200C\u200D\u203F\u2040\u2054\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\u30FB\uA620-\uA629\uA66F\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA82C\uA880\uA881\uA8B4-\uA8C5\uA8D0-\uA8D9\uA8E0-\uA8F1\uA8FF-\uA909\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9D0-\uA9D9\uA9E5\uA9F0-\uA9F9\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA50-\uAA59\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uABF0-\uABF9\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F\uFE33\uFE34\uFE4D-\uFE4F\uFF10-\uFF19\uFF3F\uFF65",Vlt="\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0560-\u0588\u05D0-\u05EA\u05EF-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u0860-\u086A\u0870-\u0887\u0889-\u088E\u08A0-\u08C9\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u09FC\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C5D\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D04-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E86-\u0E8A\u0E8C-\u0EA3\u0EA5\u0EA7-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u1711\u171F-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1878\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4C\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1C90-\u1CBA\u1CBD-\u1CBF\u1CE9-\u1CEC\u1CEE-\u1CF3\u1CF5\u1CF6\u1CFA\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2118-\u211D\u2124\u2126\u2128\u212A-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309B-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312F\u3131-\u318E\u31A0-\u31BF\u31F0-\u31FF\u3400-\u4DBF\u4E00-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7CA\uA7D0\uA7D1\uA7D3\uA7D5-\uA7D9\uA7F2-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA8FE\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB69\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC",QF={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"},KF="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",JMt={5:KF,"5module":KF+" export import",6:KF+" const class extends export import super"},tCt=/^in(stanceof)?$/,eCt=new RegExp("["+Vlt+"]"),rCt=new RegExp("["+Vlt+KMt+"]");function tz(e,t){for(var r=65536,i=0;i<t.length;i+=2){if(r+=t[i],r>e)return!1;if(r+=t[i+1],r>=e)return!0}return!1}function W0(e,t){return e<65?e===36:e<91?!0:e<97?e===95:e<123?!0:e<=65535?e>=170&&eCt.test(String.fromCharCode(e)):t===!1?!1:tz(e,Ult)}function _b(e,t){return e<48?e===36:e<58?!0:e<65?!1:e<91?!0:e<97?e===95:e<123?!0:e<=65535?e>=170&&rCt.test(String.fromCharCode(e)):t===!1?!1:tz(e,Ult)||tz(e,QMt)}var Rn=function(t,r){r===void 0&&(r={}),this.label=t,this.keyword=r.keyword,this.beforeExpr=!!r.beforeExpr,this.startsExpr=!!r.startsExpr,this.isLoop=!!r.isLoop,this.isAssign=!!r.isAssign,this.prefix=!!r.prefix,this.postfix=!!r.postfix,this.binop=r.binop||null,this.updateContext=null};function Eh(e,t){return new Rn(e,{beforeExpr:!0,binop:t})}var Ih={beforeExpr:!0},Wc={startsExpr:!0},nz={};function vn(e,t){return t===void 0&&(t={}),t.keyword=e,nz[e]=new Rn(e,t)}var dt={num:new Rn("num",Wc),regexp:new Rn("regexp",Wc),string:new Rn("string",Wc),name:new Rn("name",Wc),privateId:new Rn("privateId",Wc),eof:new Rn("eof"),bracketL:new Rn("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new Rn("]"),braceL:new Rn("{",{beforeExpr:!0,startsExpr:!0}),braceR:new Rn("}"),parenL:new Rn("(",{beforeExpr:!0,startsExpr:!0}),parenR:new Rn(")"),comma:new Rn(",",Ih),semi:new Rn(";",Ih),colon:new Rn(":",Ih),dot:new Rn("."),question:new Rn("?",Ih),questionDot:new Rn("?."),arrow:new Rn("=>",Ih),template:new Rn("template"),invalidTemplate:new Rn("invalidTemplate"),ellipsis:new Rn("...",Ih),backQuote:new Rn("`",Wc),dollarBraceL:new Rn("${",{beforeExpr:!0,startsExpr:!0}),eq:new Rn("=",{beforeExpr:!0,isAssign:!0}),assign:new Rn("_=",{beforeExpr:!0,isAssign:!0}),incDec:new Rn("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new Rn("!/~",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:Eh("||",1),logicalAND:Eh("&&",2),bitwiseOR:Eh("|",3),bitwiseXOR:Eh("^",4),bitwiseAND:Eh("&",5),equality:Eh("==/!=/===/!==",6),relational:Eh("</>/<=/>=",7),bitShift:Eh("<</>>/>>>",8),plusMin:new Rn("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:Eh("%",10),star:Eh("*",10),slash:Eh("/",10),starstar:new Rn("**",{beforeExpr:!0}),coalesce:Eh("??",1),_break:vn("break"),_case:vn("case",Ih),_catch:vn("catch"),_continue:vn("continue"),_debugger:vn("debugger"),_default:vn("default",Ih),_do:vn("do",{isLoop:!0,beforeExpr:!0}),_else:vn("else",Ih),_finally:vn("finally"),_for:vn("for",{isLoop:!0}),_function:vn("function",Wc),_if:vn("if"),_return:vn("return",Ih),_switch:vn("switch"),_throw:vn("throw",Ih),_try:vn("try"),_var:vn("var"),_const:vn("const"),_while:vn("while",{isLoop:!0}),_with:vn("with"),_new:vn("new",{beforeExpr:!0,startsExpr:!0}),_this:vn("this",Wc),_super:vn("super",Wc),_class:vn("class",Wc),_extends:vn("extends",Ih),_export:vn("export"),_import:vn("import",Wc),_null:vn("null",Wc),_true:vn("true",Wc),_false:vn("false",Wc),_in:vn("in",{beforeExpr:!0,binop:7}),_instanceof:vn("instanceof",{beforeExpr:!0,binop:7}),_typeof:vn("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_void:vn("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_delete:vn("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},Ph=/\r\n?|\n|\u2028|\u2029/,iCt=new RegExp(Ph.source,"g");function yb(e){return e===10||e===13||e===8232||e===8233}function jlt(e,t,r){r===void 0&&(r=e.length);for(var i=t;i<r;i++){var s=e.charCodeAt(i);if(yb(s))return i<r-1&&s===13&&e.charCodeAt(i+1)===10?i+2:i+1}return-1}var Wlt=/[\u1680\u2000-\u200a\u202f\u205f\u3000\ufeff]/,Mh=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,$lt=Object.prototype,nCt=$lt.hasOwnProperty,sCt=$lt.toString,c4=Object.hasOwn||function(e,t){return nCt.call(e,t)},Blt=Array.isArray||function(e){return sCt.call(e)==="[object Array]"},Nlt=Object.create(null);function LA(e){return Nlt[e]||(Nlt[e]=new RegExp("^(?:"+e.replace(/ /g,"|")+")$"))}function FA(e){return e<=65535?String.fromCharCode(e):(e-=65536,String.fromCharCode((e>>10)+55296,(e&1023)+56320))}var oCt=/(?:[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])/,a4=function(t,r){this.line=t,this.column=r};a4.prototype.offset=function(t){return new a4(this.line,this.column+t)};var gP=function(t,r,i){this.start=r,this.end=i,t.sourceFile!==null&&(this.source=t.sourceFile)};function Hlt(e,t){for(var r=1,i=0;;){var s=jlt(e,i,t);if(s<0)return new a4(r,t-i);++r,i=s}}var ez={ecmaVersion:null,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowAwaitOutsideFunction:null,allowSuperOutsideMethod:null,allowHashBang:!1,checkPrivateFields:!0,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1},Llt=!1;function aCt(e){var t={};for(var r in ez)t[r]=e&&c4(e,r)?e[r]:ez[r];if(t.ecmaVersion==="latest"?t.ecmaVersion=1e8:t.ecmaVersion==null?(!Llt&&typeof console=="object"&&console.warn&&(Llt=!0,console.warn(`Since Acorn 8.0.0, options.ecmaVersion is required.
Defaulting to 2020, but this will stop working in the future.`)),t.ecmaVersion=11):t.ecmaVersion>=2015&&(t.ecmaVersion-=2009),t.allowReserved==null&&(t.allowReserved=t.ecmaVersion<5),(!e||e.allowHashBang==null)&&(t.allowHashBang=t.ecmaVersion>=14),Blt(t.onToken)){var i=t.onToken;t.onToken=function(s){return i.push(s)}}return Blt(t.onComment)&&(t.onComment=lCt(t,t.onComment)),t}function lCt(e,t){return function(r,i,s,n,o,a){var h={type:r?"Block":"Line",value:i,start:s,end:n};e.locations&&(h.loc=new gP(this,o,a)),e.ranges&&(h.range=[s,n]),t.push(h)}}var l4=1,xb=2,sz=4,qlt=8,Ylt=16,Xlt=32,oz=64,Zlt=128,u4=256,az=l4|xb|u4;function lz(e,t){return xb|(e?sz:0)|(t?qlt:0)}var pP=0,cz=1,H0=2,Glt=3,Qlt=4,Klt=5,oa=function(t,r,i){this.options=t=aCt(t),this.sourceFile=t.sourceFile,this.keywords=LA(JMt[t.ecmaVersion>=6?6:t.sourceType==="module"?"5module":5]);var s="";t.allowReserved!==!0&&(s=QF[t.ecmaVersion>=6?6:t.ecmaVersion===5?5:3],t.sourceType==="module"&&(s+=" await")),this.reservedWords=LA(s);var n=(s?s+" ":"")+QF.strict;this.reservedWordsStrict=LA(n),this.reservedWordsStrictBind=LA(n+" "+QF.strictBind),this.input=String(r),this.containsEsc=!1,i?(this.pos=i,this.lineStart=this.input.lastIndexOf(`
`,i-1)+1,this.curLine=this.input.slice(0,this.lineStart).split(Ph).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=dt.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.inModule=t.sourceType==="module",this.strict=this.inModule||this.strictDirective(this.pos),this.potentialArrowAt=-1,this.potentialArrowInForAwait=!1,this.yieldPos=this.awaitPos=this.awaitIdentPos=0,this.labels=[],this.undefinedExports=Object.create(null),this.pos===0&&t.allowHashBang&&this.input.slice(0,2)==="#!"&&this.skipLineComment(2),this.scopeStack=[],this.enterScope(l4),this.regexpState=null,this.privateNameStack=[]},rd={inFunction:{configurable:!0},inGenerator:{configurable:!0},inAsync:{configurable:!0},canAwait:{configurable:!0},allowSuper:{configurable:!0},allowDirectSuper:{configurable:!0},treatFunctionsAsVar:{configurable:!0},allowNewDotTarget:{configurable:!0},inClassStaticBlock:{configurable:!0}};oa.prototype.parse=function(){var t=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel(t)};rd.inFunction.get=function(){return(this.currentVarScope().flags&xb)>0};rd.inGenerator.get=function(){return(this.currentVarScope().flags&qlt)>0&&!this.currentVarScope().inClassFieldInit};rd.inAsync.get=function(){return(this.currentVarScope().flags&sz)>0&&!this.currentVarScope().inClassFieldInit};rd.canAwait.get=function(){for(var e=this.scopeStack.length-1;e>=0;e--){var t=this.scopeStack[e];if(t.inClassFieldInit||t.flags&u4)return!1;if(t.flags&xb)return(t.flags&sz)>0}return this.inModule&&this.options.ecmaVersion>=13||this.options.allowAwaitOutsideFunction};rd.allowSuper.get=function(){var e=this.currentThisScope(),t=e.flags,r=e.inClassFieldInit;return(t&oz)>0||r||this.options.allowSuperOutsideMethod};rd.allowDirectSuper.get=function(){return(this.currentThisScope().flags&Zlt)>0};rd.treatFunctionsAsVar.get=function(){return this.treatFunctionsAsVarInScope(this.currentScope())};rd.allowNewDotTarget.get=function(){var e=this.currentThisScope(),t=e.flags,r=e.inClassFieldInit;return(t&(xb|u4))>0||r};rd.inClassStaticBlock.get=function(){return(this.currentVarScope().flags&u4)>0};oa.extend=function(){for(var t=[],r=arguments.length;r--;)t[r]=arguments[r];for(var i=this,s=0;s<t.length;s++)i=t[s](i);return i};oa.parse=function(t,r){return new this(r,t).parse()};oa.parseExpressionAt=function(t,r,i){var s=new this(i,t,r);return s.nextToken(),s.parseExpression()};oa.tokenizer=function(t,r){return new this(r,t)};Object.defineProperties(oa.prototype,rd);var ic=oa.prototype,cCt=/^(?:'((?:\\[^]|[^'\\])*?)'|"((?:\\[^]|[^"\\])*?)")/;ic.strictDirective=function(e){if(this.options.ecmaVersion<5)return!1;for(;;){Mh.lastIndex=e,e+=Mh.exec(this.input)[0].length;var t=cCt.exec(this.input.slice(e));if(!t)return!1;if((t[1]||t[2])==="use strict"){Mh.lastIndex=e+t[0].length;var r=Mh.exec(this.input),i=r.index+r[0].length,s=this.input.charAt(i);return s===";"||s==="}"||Ph.test(r[0])&&!(/[(`.[+\-/*%<>=,?^&]/.test(s)||s==="!"&&this.input.charAt(i+1)==="=")}e+=t[0].length,Mh.lastIndex=e,e+=Mh.exec(this.input)[0].length,this.input[e]===";"&&e++}};ic.eat=function(e){return this.type===e?(this.next(),!0):!1};ic.isContextual=function(e){return this.type===dt.name&&this.value===e&&!this.containsEsc};ic.eatContextual=function(e){return this.isContextual(e)?(this.next(),!0):!1};ic.expectContextual=function(e){this.eatContextual(e)||this.unexpected()};ic.canInsertSemicolon=function(){return this.type===dt.eof||this.type===dt.braceR||Ph.test(this.input.slice(this.lastTokEnd,this.start))};ic.insertSemicolon=function(){if(this.canInsertSemicolon())return this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0};ic.semicolon=function(){!this.eat(dt.semi)&&!this.insertSemicolon()&&this.unexpected()};ic.afterTrailingComma=function(e,t){if(this.type===e)return this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),t||this.next(),!0};ic.expect=function(e){this.eat(e)||this.unexpected()};ic.unexpected=function(e){this.raise(e??this.start,"Unexpected token")};var _P=function(){this.shorthandAssign=this.trailingComma=this.parenthesizedAssign=this.parenthesizedBind=this.doubleProto=-1};ic.checkPatternErrors=function(e,t){if(e){e.trailingComma>-1&&this.raiseRecoverable(e.trailingComma,"Comma is not permitted after the rest element");var r=t?e.parenthesizedAssign:e.parenthesizedBind;r>-1&&this.raiseRecoverable(r,t?"Assigning to rvalue":"Parenthesized pattern")}};ic.checkExpressionErrors=function(e,t){if(!e)return!1;var r=e.shorthandAssign,i=e.doubleProto;if(!t)return r>=0||i>=0;r>=0&&this.raise(r,"Shorthand property assignments are valid only in destructuring patterns"),i>=0&&this.raiseRecoverable(i,"Redefinition of __proto__ property")};ic.checkYieldAwaitInDefaultParams=function(){this.yieldPos&&(!this.awaitPos||this.yieldPos<this.awaitPos)&&this.raise(this.yieldPos,"Yield expression cannot be a default value"),this.awaitPos&&this.raise(this.awaitPos,"Await expression cannot be a default value")};ic.isSimpleAssignTarget=function(e){return e.type==="ParenthesizedExpression"?this.isSimpleAssignTarget(e.expression):e.type==="Identifier"||e.type==="MemberExpression"};var Vr=oa.prototype;Vr.parseTopLevel=function(e){var t=Object.create(null);for(e.body||(e.body=[]);this.type!==dt.eof;){var r=this.parseStatement(null,!0,t);e.body.push(r)}if(this.inModule)for(var i=0,s=Object.keys(this.undefinedExports);i<s.length;i+=1){var n=s[i];this.raiseRecoverable(this.undefinedExports[n].start,"Export '"+n+"' is not defined")}return this.adaptDirectivePrologue(e.body),this.next(),e.sourceType=this.options.sourceType,this.finishNode(e,"Program")};var uz={kind:"loop"},uCt={kind:"switch"};Vr.isLet=function(e){if(this.options.ecmaVersion<6||!this.isContextual("let"))return!1;Mh.lastIndex=this.pos;var t=Mh.exec(this.input),r=this.pos+t[0].length,i=this.input.charCodeAt(r);if(i===91||i===92)return!0;if(e)return!1;if(i===123||i>55295&&i<56320)return!0;if(W0(i,!0)){for(var s=r+1;_b(i=this.input.charCodeAt(s),!0);)++s;if(i===92||i>55295&&i<56320)return!0;var n=this.input.slice(r,s);if(!tCt.test(n))return!0}return!1};Vr.isAsyncFunction=function(){if(this.options.ecmaVersion<8||!this.isContextual("async"))return!1;Mh.lastIndex=this.pos;var e=Mh.exec(this.input),t=this.pos+e[0].length,r;return!Ph.test(this.input.slice(this.pos,t))&&this.input.slice(t,t+8)==="function"&&(t+8===this.input.length||!(_b(r=this.input.charCodeAt(t+8))||r>55295&&r<56320))};Vr.parseStatement=function(e,t,r){var i=this.type,s=this.startNode(),n;switch(this.isLet(e)&&(i=dt._var,n="let"),i){case dt._break:case dt._continue:return this.parseBreakContinueStatement(s,i.keyword);case dt._debugger:return this.parseDebuggerStatement(s);case dt._do:return this.parseDoStatement(s);case dt._for:return this.parseForStatement(s);case dt._function:return e&&(this.strict||e!=="if"&&e!=="label")&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement(s,!1,!e);case dt._class:return e&&this.unexpected(),this.parseClass(s,!0);case dt._if:return this.parseIfStatement(s);case dt._return:return this.parseReturnStatement(s);case dt._switch:return this.parseSwitchStatement(s);case dt._throw:return this.parseThrowStatement(s);case dt._try:return this.parseTryStatement(s);case dt._const:case dt._var:return n=n||this.value,e&&n!=="var"&&this.unexpected(),this.parseVarStatement(s,n);case dt._while:return this.parseWhileStatement(s);case dt._with:return this.parseWithStatement(s);case dt.braceL:return this.parseBlock(!0,s);case dt.semi:return this.parseEmptyStatement(s);case dt._export:case dt._import:if(this.options.ecmaVersion>10&&i===dt._import){Mh.lastIndex=this.pos;var o=Mh.exec(this.input),a=this.pos+o[0].length,h=this.input.charCodeAt(a);if(h===40||h===46)return this.parseExpressionStatement(s,this.parseExpression())}return this.options.allowImportExportEverywhere||(t||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),i===dt._import?this.parseImport(s):this.parseExport(s,r);default:if(this.isAsyncFunction())return e&&this.unexpected(),this.next(),this.parseFunctionStatement(s,!0,!e);var p=this.value,g=this.parseExpression();return i===dt.name&&g.type==="Identifier"&&this.eat(dt.colon)?this.parseLabeledStatement(s,p,g,e):this.parseExpressionStatement(s,g)}};Vr.parseBreakContinueStatement=function(e,t){var r=t==="break";this.next(),this.eat(dt.semi)||this.insertSemicolon()?e.label=null:this.type!==dt.name?this.unexpected():(e.label=this.parseIdent(),this.semicolon());for(var i=0;i<this.labels.length;++i){var s=this.labels[i];if((e.label==null||s.name===e.label.name)&&(s.kind!=null&&(r||s.kind==="loop")||e.label&&r))break}return i===this.labels.length&&this.raise(e.start,"Unsyntactic "+t),this.finishNode(e,r?"BreakStatement":"ContinueStatement")};Vr.parseDebuggerStatement=function(e){return this.next(),this.semicolon(),this.finishNode(e,"DebuggerStatement")};Vr.parseDoStatement=function(e){return this.next(),this.labels.push(uz),e.body=this.parseStatement("do"),this.labels.pop(),this.expect(dt._while),e.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat(dt.semi):this.semicolon(),this.finishNode(e,"DoWhileStatement")};Vr.parseForStatement=function(e){this.next();var t=this.options.ecmaVersion>=9&&this.canAwait&&this.eatContextual("await")?this.lastTokStart:-1;if(this.labels.push(uz),this.enterScope(0),this.expect(dt.parenL),this.type===dt.semi)return t>-1&&this.unexpected(t),this.parseFor(e,null);var r=this.isLet();if(this.type===dt._var||this.type===dt._const||r){var i=this.startNode(),s=r?"let":this.value;return this.next(),this.parseVar(i,!0,s),this.finishNode(i,"VariableDeclaration"),(this.type===dt._in||this.options.ecmaVersion>=6&&this.isContextual("of"))&&i.declarations.length===1?(this.options.ecmaVersion>=9&&(this.type===dt._in?t>-1&&this.unexpected(t):e.await=t>-1),this.parseForIn(e,i)):(t>-1&&this.unexpected(t),this.parseFor(e,i))}var n=this.isContextual("let"),o=!1,a=this.containsEsc,h=new _P,p=this.start,g=t>-1?this.parseExprSubscripts(h,"await"):this.parseExpression(!0,h);return this.type===dt._in||(o=this.options.ecmaVersion>=6&&this.isContextual("of"))?(t>-1?(this.type===dt._in&&this.unexpected(t),e.await=!0):o&&this.options.ecmaVersion>=8&&(g.start===p&&!a&&g.type==="Identifier"&&g.name==="async"?this.unexpected():this.options.ecmaVersion>=9&&(e.await=!1)),n&&o&&this.raise(g.start,"The left-hand side of a for-of loop may not start with 'let'."),this.toAssignable(g,!1,h),this.checkLValPattern(g),this.parseForIn(e,g)):(this.checkExpressionErrors(h,!0),t>-1&&this.unexpected(t),this.parseFor(e,g))};Vr.parseFunctionStatement=function(e,t,r){return this.next(),this.parseFunction(e,o4|(r?0:rz),!1,t)};Vr.parseIfStatement=function(e){return this.next(),e.test=this.parseParenExpression(),e.consequent=this.parseStatement("if"),e.alternate=this.eat(dt._else)?this.parseStatement("if"):null,this.finishNode(e,"IfStatement")};Vr.parseReturnStatement=function(e){return!this.inFunction&&!this.options.allowReturnOutsideFunction&&this.raise(this.start,"'return' outside of function"),this.next(),this.eat(dt.semi)||this.insertSemicolon()?e.argument=null:(e.argument=this.parseExpression(),this.semicolon()),this.finishNode(e,"ReturnStatement")};Vr.parseSwitchStatement=function(e){this.next(),e.discriminant=this.parseParenExpression(),e.cases=[],this.expect(dt.braceL),this.labels.push(uCt),this.enterScope(0);for(var t,r=!1;this.type!==dt.braceR;)if(this.type===dt._case||this.type===dt._default){var i=this.type===dt._case;t&&this.finishNode(t,"SwitchCase"),e.cases.push(t=this.startNode()),t.consequent=[],this.next(),i?t.test=this.parseExpression():(r&&this.raiseRecoverable(this.lastTokStart,"Multiple default clauses"),r=!0,t.test=null),this.expect(dt.colon)}else t||this.unexpected(),t.consequent.push(this.parseStatement(null));return this.exitScope(),t&&this.finishNode(t,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(e,"SwitchStatement")};Vr.parseThrowStatement=function(e){return this.next(),Ph.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),e.argument=this.parseExpression(),this.semicolon(),this.finishNode(e,"ThrowStatement")};var hCt=[];Vr.parseCatchClauseParam=function(){var e=this.parseBindingAtom(),t=e.type==="Identifier";return this.enterScope(t?Xlt:0),this.checkLValPattern(e,t?Qlt:H0),this.expect(dt.parenR),e};Vr.parseTryStatement=function(e){if(this.next(),e.block=this.parseBlock(),e.handler=null,this.type===dt._catch){var t=this.startNode();this.next(),this.eat(dt.parenL)?t.param=this.parseCatchClauseParam():(this.options.ecmaVersion<10&&this.unexpected(),t.param=null,this.enterScope(0)),t.body=this.parseBlock(!1),this.exitScope(),e.handler=this.finishNode(t,"CatchClause")}return e.finalizer=this.eat(dt._finally)?this.parseBlock():null,!e.handler&&!e.finalizer&&this.raise(e.start,"Missing catch or finally clause"),this.finishNode(e,"TryStatement")};Vr.parseVarStatement=function(e,t,r){return this.next(),this.parseVar(e,!1,t,r),this.semicolon(),this.finishNode(e,"VariableDeclaration")};Vr.parseWhileStatement=function(e){return this.next(),e.test=this.parseParenExpression(),this.labels.push(uz),e.body=this.parseStatement("while"),this.labels.pop(),this.finishNode(e,"WhileStatement")};Vr.parseWithStatement=function(e){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),e.object=this.parseParenExpression(),e.body=this.parseStatement("with"),this.finishNode(e,"WithStatement")};Vr.parseEmptyStatement=function(e){return this.next(),this.finishNode(e,"EmptyStatement")};Vr.parseLabeledStatement=function(e,t,r,i){for(var s=0,n=this.labels;s<n.length;s+=1){var o=n[s];o.name===t&&this.raise(r.start,"Label '"+t+"' is already declared")}for(var a=this.type.isLoop?"loop":this.type===dt._switch?"switch":null,h=this.labels.length-1;h>=0;h--){var p=this.labels[h];if(p.statementStart===e.start)p.statementStart=this.start,p.kind=a;else break}return this.labels.push({name:t,kind:a,statementStart:this.start}),e.body=this.parseStatement(i?i.indexOf("label")===-1?i+"label":i:"label"),this.labels.pop(),e.label=r,this.finishNode(e,"LabeledStatement")};Vr.parseExpressionStatement=function(e,t){return e.expression=t,this.semicolon(),this.finishNode(e,"ExpressionStatement")};Vr.parseBlock=function(e,t,r){for(e===void 0&&(e=!0),t===void 0&&(t=this.startNode()),t.body=[],this.expect(dt.braceL),e&&this.enterScope(0);this.type!==dt.braceR;){var i=this.parseStatement(null);t.body.push(i)}return r&&(this.strict=!1),this.next(),e&&this.exitScope(),this.finishNode(t,"BlockStatement")};Vr.parseFor=function(e,t){return e.init=t,this.expect(dt.semi),e.test=this.type===dt.semi?null:this.parseExpression(),this.expect(dt.semi),e.update=this.type===dt.parenR?null:this.parseExpression(),this.expect(dt.parenR),e.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(e,"ForStatement")};Vr.parseForIn=function(e,t){var r=this.type===dt._in;return this.next(),t.type==="VariableDeclaration"&&t.declarations[0].init!=null&&(!r||this.options.ecmaVersion<8||this.strict||t.kind!=="var"||t.declarations[0].id.type!=="Identifier")&&this.raise(t.start,(r?"for-in":"for-of")+" loop variable declaration may not have an initializer"),e.left=t,e.right=r?this.parseExpression():this.parseMaybeAssign(),this.expect(dt.parenR),e.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(e,r?"ForInStatement":"ForOfStatement")};Vr.parseVar=function(e,t,r,i){for(e.declarations=[],e.kind=r;;){var s=this.startNode();if(this.parseVarId(s,r),this.eat(dt.eq)?s.init=this.parseMaybeAssign(t):!i&&r==="const"&&!(this.type===dt._in||this.options.ecmaVersion>=6&&this.isContextual("of"))?this.unexpected():!i&&s.id.type!=="Identifier"&&!(t&&(this.type===dt._in||this.isContextual("of")))?this.raise(this.lastTokEnd,"Complex binding patterns require an initialization value"):s.init=null,e.declarations.push(this.finishNode(s,"VariableDeclarator")),!this.eat(dt.comma))break}return e};Vr.parseVarId=function(e,t){e.id=this.parseBindingAtom(),this.checkLValPattern(e.id,t==="var"?cz:H0,!1)};var o4=1,rz=2,Jlt=4;Vr.parseFunction=function(e,t,r,i,s){this.initFunction(e),(this.options.ecmaVersion>=9||this.options.ecmaVersion>=6&&!i)&&(this.type===dt.star&&t&rz&&this.unexpected(),e.generator=this.eat(dt.star)),this.options.ecmaVersion>=8&&(e.async=!!i),t&o4&&(e.id=t&Jlt&&this.type!==dt.name?null:this.parseIdent(),e.id&&!(t&rz)&&this.checkLValSimple(e.id,this.strict||e.generator||e.async?this.treatFunctionsAsVar?cz:H0:Glt));var n=this.yieldPos,o=this.awaitPos,a=this.awaitIdentPos;return this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(lz(e.async,e.generator)),t&o4||(e.id=this.type===dt.name?this.parseIdent():null),this.parseFunctionParams(e),this.parseFunctionBody(e,r,!1,s),this.yieldPos=n,this.awaitPos=o,this.awaitIdentPos=a,this.finishNode(e,t&o4?"FunctionDeclaration":"FunctionExpression")};Vr.parseFunctionParams=function(e){this.expect(dt.parenL),e.params=this.parseBindingList(dt.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams()};Vr.parseClass=function(e,t){this.next();var r=this.strict;this.strict=!0,this.parseClassId(e,t),this.parseClassSuper(e);var i=this.enterClassBody(),s=this.startNode(),n=!1;for(s.body=[],this.expect(dt.braceL);this.type!==dt.braceR;){var o=this.parseClassElement(e.superClass!==null);o&&(s.body.push(o),o.type==="MethodDefinition"&&o.kind==="constructor"?(n&&this.raiseRecoverable(o.start,"Duplicate constructor in the same class"),n=!0):o.key&&o.key.type==="PrivateIdentifier"&&fCt(i,o)&&this.raiseRecoverable(o.key.start,"Identifier '#"+o.key.name+"' has already been declared"))}return this.strict=r,this.next(),e.body=this.finishNode(s,"ClassBody"),this.exitClassBody(),this.finishNode(e,t?"ClassDeclaration":"ClassExpression")};Vr.parseClassElement=function(e){if(this.eat(dt.semi))return null;var t=this.options.ecmaVersion,r=this.startNode(),i="",s=!1,n=!1,o="method",a=!1;if(this.eatContextual("static")){if(t>=13&&this.eat(dt.braceL))return this.parseClassStaticBlock(r),r;this.isClassElementNameStart()||this.type===dt.star?a=!0:i="static"}if(r.static=a,!i&&t>=8&&this.eatContextual("async")&&((this.isClassElementNameStart()||this.type===dt.star)&&!this.canInsertSemicolon()?n=!0:i="async"),!i&&(t>=9||!n)&&this.eat(dt.star)&&(s=!0),!i&&!n&&!s){var h=this.value;(this.eatContextual("get")||this.eatContextual("set"))&&(this.isClassElementNameStart()?o=h:i=h)}if(i?(r.computed=!1,r.key=this.startNodeAt(this.lastTokStart,this.lastTokStartLoc),r.key.name=i,this.finishNode(r.key,"Identifier")):this.parseClassElementName(r),t<13||this.type===dt.parenL||o!=="method"||s||n){var p=!r.static&&dP(r,"constructor"),g=p&&e;p&&o!=="method"&&this.raise(r.key.start,"Constructor can't have get/set modifier"),r.kind=p?"constructor":o,this.parseClassMethod(r,s,n,g)}else this.parseClassField(r);return r};Vr.isClassElementNameStart=function(){return this.type===dt.name||this.type===dt.privateId||this.type===dt.num||this.type===dt.string||this.type===dt.bracketL||this.type.keyword};Vr.parseClassElementName=function(e){this.type===dt.privateId?(this.value==="constructor"&&this.raise(this.start,"Classes can't have an element named '#constructor'"),e.computed=!1,e.key=this.parsePrivateIdent()):this.parsePropertyName(e)};Vr.parseClassMethod=function(e,t,r,i){var s=e.key;e.kind==="constructor"?(t&&this.raise(s.start,"Constructor can't be a generator"),r&&this.raise(s.start,"Constructor can't be an async method")):e.static&&dP(e,"prototype")&&this.raise(s.start,"Classes may not have a static property named prototype");var n=e.value=this.parseMethod(t,r,i);return e.kind==="get"&&n.params.length!==0&&this.raiseRecoverable(n.start,"getter should have no params"),e.kind==="set"&&n.params.length!==1&&this.raiseRecoverable(n.start,"setter should have exactly one param"),e.kind==="set"&&n.params[0].type==="RestElement"&&this.raiseRecoverable(n.params[0].start,"Setter cannot use rest params"),this.finishNode(e,"MethodDefinition")};Vr.parseClassField=function(e){if(dP(e,"constructor")?this.raise(e.key.start,"Classes can't have a field named 'constructor'"):e.static&&dP(e,"prototype")&&this.raise(e.key.start,"Classes can't have a static field named 'prototype'"),this.eat(dt.eq)){var t=this.currentThisScope(),r=t.inClassFieldInit;t.inClassFieldInit=!0,e.value=this.parseMaybeAssign(),t.inClassFieldInit=r}else e.value=null;return this.semicolon(),this.finishNode(e,"PropertyDefinition")};Vr.parseClassStaticBlock=function(e){e.body=[];var t=this.labels;for(this.labels=[],this.enterScope(u4|oz);this.type!==dt.braceR;){var r=this.parseStatement(null);e.body.push(r)}return this.next(),this.exitScope(),this.labels=t,this.finishNode(e,"StaticBlock")};Vr.parseClassId=function(e,t){this.type===dt.name?(e.id=this.parseIdent(),t&&this.checkLValSimple(e.id,H0,!1)):(t===!0&&this.unexpected(),e.id=null)};Vr.parseClassSuper=function(e){e.superClass=this.eat(dt._extends)?this.parseExprSubscripts(null,!1):null};Vr.enterClassBody=function(){var e={declared:Object.create(null),used:[]};return this.privateNameStack.push(e),e.declared};Vr.exitClassBody=function(){var e=this.privateNameStack.pop(),t=e.declared,r=e.used;if(this.options.checkPrivateFields)for(var i=this.privateNameStack.length,s=i===0?null:this.privateNameStack[i-1],n=0;n<r.length;++n){var o=r[n];c4(t,o.name)||(s?s.used.push(o):this.raiseRecoverable(o.start,"Private field '#"+o.name+"' must be declared in an enclosing class"))}};function fCt(e,t){var r=t.key.name,i=e[r],s="true";return t.type==="MethodDefinition"&&(t.kind==="get"||t.kind==="set")&&(s=(t.static?"s":"i")+t.kind),i==="iget"&&s==="iset"||i==="iset"&&s==="iget"||i==="sget"&&s==="sset"||i==="sset"&&s==="sget"?(e[r]="true",!1):i?!0:(e[r]=s,!1)}function dP(e,t){var r=e.computed,i=e.key;return!r&&(i.type==="Identifier"&&i.name===t||i.type==="Literal"&&i.value===t)}Vr.parseExportAllDeclaration=function(e,t){return this.options.ecmaVersion>=11&&(this.eatContextual("as")?(e.exported=this.parseModuleExportName(),this.checkExport(t,e.exported,this.lastTokStart)):e.exported=null),this.expectContextual("from"),this.type!==dt.string&&this.unexpected(),e.source=this.parseExprAtom(),this.semicolon(),this.finishNode(e,"ExportAllDeclaration")};Vr.parseExport=function(e,t){if(this.next(),this.eat(dt.star))return this.parseExportAllDeclaration(e,t);if(this.eat(dt._default))return this.checkExport(t,"default",this.lastTokStart),e.declaration=this.parseExportDefaultDeclaration(),this.finishNode(e,"ExportDefaultDeclaration");if(this.shouldParseExportStatement())e.declaration=this.parseExportDeclaration(e),e.declaration.type==="VariableDeclaration"?this.checkVariableExport(t,e.declaration.declarations):this.checkExport(t,e.declaration.id,e.declaration.id.start),e.specifiers=[],e.source=null;else{if(e.declaration=null,e.specifiers=this.parseExportSpecifiers(t),this.eatContextual("from"))this.type!==dt.string&&this.unexpected(),e.source=this.parseExprAtom();else{for(var r=0,i=e.specifiers;r<i.length;r+=1){var s=i[r];this.checkUnreserved(s.local),this.checkLocalExport(s.local),s.local.type==="Literal"&&this.raise(s.local.start,"A string literal cannot be used as an exported binding without `from`.")}e.source=null}this.semicolon()}return this.finishNode(e,"ExportNamedDeclaration")};Vr.parseExportDeclaration=function(e){return this.parseStatement(null)};Vr.parseExportDefaultDeclaration=function(){var e;if(this.type===dt._function||(e=this.isAsyncFunction())){var t=this.startNode();return this.next(),e&&this.next(),this.parseFunction(t,o4|Jlt,!1,e)}else if(this.type===dt._class){var r=this.startNode();return this.parseClass(r,"nullableID")}else{var i=this.parseMaybeAssign();return this.semicolon(),i}};Vr.checkExport=function(e,t,r){e&&(typeof t!="string"&&(t=t.type==="Identifier"?t.name:t.value),c4(e,t)&&this.raiseRecoverable(r,"Duplicate export '"+t+"'"),e[t]=!0)};Vr.checkPatternExport=function(e,t){var r=t.type;if(r==="Identifier")this.checkExport(e,t,t.start);else if(r==="ObjectPattern")for(var i=0,s=t.properties;i<s.length;i+=1){var n=s[i];this.checkPatternExport(e,n)}else if(r==="ArrayPattern")for(var o=0,a=t.elements;o<a.length;o+=1){var h=a[o];h&&this.checkPatternExport(e,h)}else r==="Property"?this.checkPatternExport(e,t.value):r==="AssignmentPattern"?this.checkPatternExport(e,t.left):r==="RestElement"&&this.checkPatternExport(e,t.argument)};Vr.checkVariableExport=function(e,t){if(e)for(var r=0,i=t;r<i.length;r+=1){var s=i[r];this.checkPatternExport(e,s.id)}};Vr.shouldParseExportStatement=function(){return this.type.keyword==="var"||this.type.keyword==="const"||this.type.keyword==="class"||this.type.keyword==="function"||this.isLet()||this.isAsyncFunction()};Vr.parseExportSpecifier=function(e){var t=this.startNode();return t.local=this.parseModuleExportName(),t.exported=this.eatContextual("as")?this.parseModuleExportName():t.local,this.checkExport(e,t.exported,t.exported.start),this.finishNode(t,"ExportSpecifier")};Vr.parseExportSpecifiers=function(e){var t=[],r=!0;for(this.expect(dt.braceL);!this.eat(dt.braceR);){if(r)r=!1;else if(this.expect(dt.comma),this.afterTrailingComma(dt.braceR))break;t.push(this.parseExportSpecifier(e))}return t};Vr.parseImport=function(e){return this.next(),this.type===dt.string?(e.specifiers=hCt,e.source=this.parseExprAtom()):(e.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),e.source=this.type===dt.string?this.parseExprAtom():this.unexpected()),this.semicolon(),this.finishNode(e,"ImportDeclaration")};Vr.parseImportSpecifier=function(){var e=this.startNode();return e.imported=this.parseModuleExportName(),this.eatContextual("as")?e.local=this.parseIdent():(this.checkUnreserved(e.imported),e.local=e.imported),this.checkLValSimple(e.local,H0),this.finishNode(e,"ImportSpecifier")};Vr.parseImportDefaultSpecifier=function(){var e=this.startNode();return e.local=this.parseIdent(),this.checkLValSimple(e.local,H0),this.finishNode(e,"ImportDefaultSpecifier")};Vr.parseImportNamespaceSpecifier=function(){var e=this.startNode();return this.next(),this.expectContextual("as"),e.local=this.parseIdent(),this.checkLValSimple(e.local,H0),this.finishNode(e,"ImportNamespaceSpecifier")};Vr.parseImportSpecifiers=function(){var e=[],t=!0;if(this.type===dt.name&&(e.push(this.parseImportDefaultSpecifier()),!this.eat(dt.comma)))return e;if(this.type===dt.star)return e.push(this.parseImportNamespaceSpecifier()),e;for(this.expect(dt.braceL);!this.eat(dt.braceR);){if(t)t=!1;else if(this.expect(dt.comma),this.afterTrailingComma(dt.braceR))break;e.push(this.parseImportSpecifier())}return e};Vr.parseModuleExportName=function(){if(this.options.ecmaVersion>=13&&this.type===dt.string){var e=this.parseLiteral(this.value);return oCt.test(e.value)&&this.raise(e.start,"An export name cannot include a lone surrogate."),e}return this.parseIdent(!0)};Vr.adaptDirectivePrologue=function(e){for(var t=0;t<e.length&&this.isDirectiveCandidate(e[t]);++t)e[t].directive=e[t].expression.raw.slice(1,-1)};Vr.isDirectiveCandidate=function(e){return this.options.ecmaVersion>=5&&e.type==="ExpressionStatement"&&e.expression.type==="Literal"&&typeof e.expression.value=="string"&&(this.input[e.start]==='"'||this.input[e.start]==="'")};var Rh=oa.prototype;Rh.toAssignable=function(e,t,r){if(this.options.ecmaVersion>=6&&e)switch(e.type){case"Identifier":this.inAsync&&e.name==="await"&&this.raise(e.start,"Cannot use 'await' as identifier inside an async function");break;case"ObjectPattern":case"ArrayPattern":case"AssignmentPattern":case"RestElement":break;case"ObjectExpression":e.type="ObjectPattern",r&&this.checkPatternErrors(r,!0);for(var i=0,s=e.properties;i<s.length;i+=1){var n=s[i];this.toAssignable(n,t),n.type==="RestElement"&&(n.argument.type==="ArrayPattern"||n.argument.type==="ObjectPattern")&&this.raise(n.argument.start,"Unexpected token")}break;case"Property":e.kind!=="init"&&this.raise(e.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(e.value,t);break;case"ArrayExpression":e.type="ArrayPattern",r&&this.checkPatternErrors(r,!0),this.toAssignableList(e.elements,t);break;case"SpreadElement":e.type="RestElement",this.toAssignable(e.argument,t),e.argument.type==="AssignmentPattern"&&this.raise(e.argument.start,"Rest elements cannot have a default value");break;case"AssignmentExpression":e.operator!=="="&&this.raise(e.left.end,"Only '=' operator can be used for specifying default value."),e.type="AssignmentPattern",delete e.operator,this.toAssignable(e.left,t);break;case"ParenthesizedExpression":this.toAssignable(e.expression,t,r);break;case"ChainExpression":this.raiseRecoverable(e.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":if(!t)break;default:this.raise(e.start,"Assigning to rvalue")}else r&&this.checkPatternErrors(r,!0);return e};Rh.toAssignableList=function(e,t){for(var r=e.length,i=0;i<r;i++){var s=e[i];s&&this.toAssignable(s,t)}if(r){var n=e[r-1];this.options.ecmaVersion===6&&t&&n&&n.type==="RestElement"&&n.argument.type!=="Identifier"&&this.unexpected(n.argument.start)}return e};Rh.parseSpread=function(e){var t=this.startNode();return this.next(),t.argument=this.parseMaybeAssign(!1,e),this.finishNode(t,"SpreadElement")};Rh.parseRestBinding=function(){var e=this.startNode();return this.next(),this.options.ecmaVersion===6&&this.type!==dt.name&&this.unexpected(),e.argument=this.parseBindingAtom(),this.finishNode(e,"RestElement")};Rh.parseBindingAtom=function(){if(this.options.ecmaVersion>=6)switch(this.type){case dt.bracketL:var e=this.startNode();return this.next(),e.elements=this.parseBindingList(dt.bracketR,!0,!0),this.finishNode(e,"ArrayPattern");case dt.braceL:return this.parseObj(!0)}return this.parseIdent()};Rh.parseBindingList=function(e,t,r,i){for(var s=[],n=!0;!this.eat(e);)if(n?n=!1:this.expect(dt.comma),t&&this.type===dt.comma)s.push(null);else{if(r&&this.afterTrailingComma(e))break;if(this.type===dt.ellipsis){var o=this.parseRestBinding();this.parseBindingListItem(o),s.push(o),this.type===dt.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.expect(e);break}else s.push(this.parseAssignableListItem(i))}return s};Rh.parseAssignableListItem=function(e){var t=this.parseMaybeDefault(this.start,this.startLoc);return this.parseBindingListItem(t),t};Rh.parseBindingListItem=function(e){return e};Rh.parseMaybeDefault=function(e,t,r){if(r=r||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat(dt.eq))return r;var i=this.startNodeAt(e,t);return i.left=r,i.right=this.parseMaybeAssign(),this.finishNode(i,"AssignmentPattern")};Rh.checkLValSimple=function(e,t,r){t===void 0&&(t=pP);var i=t!==pP;switch(e.type){case"Identifier":this.strict&&this.reservedWordsStrictBind.test(e.name)&&this.raiseRecoverable(e.start,(i?"Binding ":"Assigning to ")+e.name+" in strict mode"),i&&(t===H0&&e.name==="let"&&this.raiseRecoverable(e.start,"let is disallowed as a lexically bound name"),r&&(c4(r,e.name)&&this.raiseRecoverable(e.start,"Argument name clash"),r[e.name]=!0),t!==Klt&&this.declareName(e.name,t,e.start));break;case"ChainExpression":this.raiseRecoverable(e.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":i&&this.raiseRecoverable(e.start,"Binding member expression");break;case"ParenthesizedExpression":return i&&this.raiseRecoverable(e.start,"Binding parenthesized expression"),this.checkLValSimple(e.expression,t,r);default:this.raise(e.start,(i?"Binding":"Assigning to")+" rvalue")}};Rh.checkLValPattern=function(e,t,r){switch(t===void 0&&(t=pP),e.type){case"ObjectPattern":for(var i=0,s=e.properties;i<s.length;i+=1){var n=s[i];this.checkLValInnerPattern(n,t,r)}break;case"ArrayPattern":for(var o=0,a=e.elements;o<a.length;o+=1){var h=a[o];h&&this.checkLValInnerPattern(h,t,r)}break;default:this.checkLValSimple(e,t,r)}};Rh.checkLValInnerPattern=function(e,t,r){switch(t===void 0&&(t=pP),e.type){case"Property":this.checkLValInnerPattern(e.value,t,r);break;case"AssignmentPattern":this.checkLValPattern(e.left,t,r);break;case"RestElement":this.checkLValPattern(e.argument,t,r);break;default:this.checkLValPattern(e,t,r)}};var kf=function(t,r,i,s,n){this.token=t,this.isExpr=!!r,this.preserveSpace=!!i,this.override=s,this.generator=!!n},Xs={b_stat:new kf("{",!1),b_expr:new kf("{",!0),b_tmpl:new kf("${",!1),p_stat:new kf("(",!1),p_expr:new kf("(",!0),q_tmpl:new kf("`",!0,!0,function(e){return e.tryReadTemplateToken()}),f_stat:new kf("function",!1),f_expr:new kf("function",!0),f_expr_gen:new kf("function",!0,!1,null,!0),f_gen:new kf("function",!1,!1,null,!0)},bb=oa.prototype;bb.initialContext=function(){return[Xs.b_stat]};bb.curContext=function(){return this.context[this.context.length-1]};bb.braceIsBlock=function(e){var t=this.curContext();return t===Xs.f_expr||t===Xs.f_stat?!0:e===dt.colon&&(t===Xs.b_stat||t===Xs.b_expr)?!t.isExpr:e===dt._return||e===dt.name&&this.exprAllowed?Ph.test(this.input.slice(this.lastTokEnd,this.start)):e===dt._else||e===dt.semi||e===dt.eof||e===dt.parenR||e===dt.arrow?!0:e===dt.braceL?t===Xs.b_stat:e===dt._var||e===dt._const||e===dt.name?!1:!this.exprAllowed};bb.inGeneratorContext=function(){for(var e=this.context.length-1;e>=1;e--){var t=this.context[e];if(t.token==="function")return t.generator}return!1};bb.updateContext=function(e){var t,r=this.type;r.keyword&&e===dt.dot?this.exprAllowed=!1:(t=r.updateContext)?t.call(this,e):this.exprAllowed=r.beforeExpr};bb.overrideContext=function(e){this.curContext()!==e&&(this.context[this.context.length-1]=e)};dt.parenR.updateContext=dt.braceR.updateContext=function(){if(this.context.length===1){this.exprAllowed=!0;return}var e=this.context.pop();e===Xs.b_stat&&this.curContext().token==="function"&&(e=this.context.pop()),this.exprAllowed=!e.isExpr};dt.braceL.updateContext=function(e){this.context.push(this.braceIsBlock(e)?Xs.b_stat:Xs.b_expr),this.exprAllowed=!0};dt.dollarBraceL.updateContext=function(){this.context.push(Xs.b_tmpl),this.exprAllowed=!0};dt.parenL.updateContext=function(e){var t=e===dt._if||e===dt._for||e===dt._with||e===dt._while;this.context.push(t?Xs.p_stat:Xs.p_expr),this.exprAllowed=!0};dt.incDec.updateContext=function(){};dt._function.updateContext=dt._class.updateContext=function(e){e.beforeExpr&&e!==dt._else&&!(e===dt.semi&&this.curContext()!==Xs.p_stat)&&!(e===dt._return&&Ph.test(this.input.slice(this.lastTokEnd,this.start)))&&!((e===dt.colon||e===dt.braceL)&&this.curContext()===Xs.b_stat)?this.context.push(Xs.f_expr):this.context.push(Xs.f_stat),this.exprAllowed=!1};dt.colon.updateContext=function(){this.curContext().token==="function"&&this.context.pop(),this.exprAllowed=!0};dt.backQuote.updateContext=function(){this.curContext()===Xs.q_tmpl?this.context.pop():this.context.push(Xs.q_tmpl),this.exprAllowed=!1};dt.star.updateContext=function(e){if(e===dt._function){var t=this.context.length-1;this.context[t]===Xs.f_expr?this.context[t]=Xs.f_expr_gen:this.context[t]=Xs.f_gen}this.exprAllowed=!0};dt.name.updateContext=function(e){var t=!1;this.options.ecmaVersion>=6&&e!==dt.dot&&(this.value==="of"&&!this.exprAllowed||this.value==="yield"&&this.inGeneratorContext())&&(t=!0),this.exprAllowed=t};var Mi=oa.prototype;Mi.checkPropClash=function(e,t,r){if(!(this.options.ecmaVersion>=9&&e.type==="SpreadElement")&&!(this.options.ecmaVersion>=6&&(e.computed||e.method||e.shorthand))){var i=e.key,s;switch(i.type){case"Identifier":s=i.name;break;case"Literal":s=String(i.value);break;default:return}var n=e.kind;if(this.options.ecmaVersion>=6){s==="__proto__"&&n==="init"&&(t.proto&&(r?r.doubleProto<0&&(r.doubleProto=i.start):this.raiseRecoverable(i.start,"Redefinition of __proto__ property")),t.proto=!0);return}s="$"+s;var o=t[s];if(o){var a;n==="init"?a=this.strict&&o.init||o.get||o.set:a=o.init||o[n],a&&this.raiseRecoverable(i.start,"Redefinition of property")}else o=t[s]={init:!1,get:!1,set:!1};o[n]=!0}};Mi.parseExpression=function(e,t){var r=this.start,i=this.startLoc,s=this.parseMaybeAssign(e,t);if(this.type===dt.comma){var n=this.startNodeAt(r,i);for(n.expressions=[s];this.eat(dt.comma);)n.expressions.push(this.parseMaybeAssign(e,t));return this.finishNode(n,"SequenceExpression")}return s};Mi.parseMaybeAssign=function(e,t,r){if(this.isContextual("yield")){if(this.inGenerator)return this.parseYield(e);this.exprAllowed=!1}var i=!1,s=-1,n=-1,o=-1;t?(s=t.parenthesizedAssign,n=t.trailingComma,o=t.doubleProto,t.parenthesizedAssign=t.trailingComma=-1):(t=new _P,i=!0);var a=this.start,h=this.startLoc;(this.type===dt.parenL||this.type===dt.name)&&(this.potentialArrowAt=this.start,this.potentialArrowInForAwait=e==="await");var p=this.parseMaybeConditional(e,t);if(r&&(p=r.call(this,p,a,h)),this.type.isAssign){var g=this.startNodeAt(a,h);return g.operator=this.value,this.type===dt.eq&&(p=this.toAssignable(p,!1,t)),i||(t.parenthesizedAssign=t.trailingComma=t.doubleProto=-1),t.shorthandAssign>=p.start&&(t.shorthandAssign=-1),this.type===dt.eq?this.checkLValPattern(p):this.checkLValSimple(p),g.left=p,this.next(),g.right=this.parseMaybeAssign(e),o>-1&&(t.doubleProto=o),this.finishNode(g,"AssignmentExpression")}else i&&this.checkExpressionErrors(t,!0);return s>-1&&(t.parenthesizedAssign=s),n>-1&&(t.trailingComma=n),p};Mi.parseMaybeConditional=function(e,t){var r=this.start,i=this.startLoc,s=this.parseExprOps(e,t);if(this.checkExpressionErrors(t))return s;if(this.eat(dt.question)){var n=this.startNodeAt(r,i);return n.test=s,n.consequent=this.parseMaybeAssign(),this.expect(dt.colon),n.alternate=this.parseMaybeAssign(e),this.finishNode(n,"ConditionalExpression")}return s};Mi.parseExprOps=function(e,t){var r=this.start,i=this.startLoc,s=this.parseMaybeUnary(t,!1,!1,e);return this.checkExpressionErrors(t)||s.start===r&&s.type==="ArrowFunctionExpression"?s:this.parseExprOp(s,r,i,-1,e)};Mi.parseExprOp=function(e,t,r,i,s){var n=this.type.binop;if(n!=null&&(!s||this.type!==dt._in)&&n>i){var o=this.type===dt.logicalOR||this.type===dt.logicalAND,a=this.type===dt.coalesce;a&&(n=dt.logicalAND.binop);var h=this.value;this.next();var p=this.start,g=this.startLoc,v=this.parseExprOp(this.parseMaybeUnary(null,!1,!1,s),p,g,n,s),T=this.buildBinary(t,r,e,v,h,o||a);return(o&&this.type===dt.coalesce||a&&(this.type===dt.logicalOR||this.type===dt.logicalAND))&&this.raiseRecoverable(this.start,"Logical expressions and coalesce expressions cannot be mixed. Wrap either by parentheses"),this.parseExprOp(T,t,r,i,s)}return e};Mi.buildBinary=function(e,t,r,i,s,n){i.type==="PrivateIdentifier"&&this.raise(i.start,"Private identifier can only be left side of binary expression");var o=this.startNodeAt(e,t);return o.left=r,o.operator=s,o.right=i,this.finishNode(o,n?"LogicalExpression":"BinaryExpression")};Mi.parseMaybeUnary=function(e,t,r,i){var s=this.start,n=this.startLoc,o;if(this.isContextual("await")&&this.canAwait)o=this.parseAwait(i),t=!0;else if(this.type.prefix){var a=this.startNode(),h=this.type===dt.incDec;a.operator=this.value,a.prefix=!0,this.next(),a.argument=this.parseMaybeUnary(null,!0,h,i),this.checkExpressionErrors(e,!0),h?this.checkLValSimple(a.argument):this.strict&&a.operator==="delete"&&tct(a.argument)?this.raiseRecoverable(a.start,"Deleting local variable in strict mode"):a.operator==="delete"&&iz(a.argument)?this.raiseRecoverable(a.start,"Private fields can not be deleted"):t=!0,o=this.finishNode(a,h?"UpdateExpression":"UnaryExpression")}else if(!t&&this.type===dt.privateId)(i||this.privateNameStack.length===0)&&this.options.checkPrivateFields&&this.unexpected(),o=this.parsePrivateIdent(),this.type!==dt._in&&this.unexpected();else{if(o=this.parseExprSubscripts(e,i),this.checkExpressionErrors(e))return o;for(;this.type.postfix&&!this.canInsertSemicolon();){var p=this.startNodeAt(s,n);p.operator=this.value,p.prefix=!1,p.argument=o,this.checkLValSimple(o),this.next(),o=this.finishNode(p,"UpdateExpression")}}if(!r&&this.eat(dt.starstar))if(t)this.unexpected(this.lastTokStart);else return this.buildBinary(s,n,o,this.parseMaybeUnary(null,!1,!1,i),"**",!1);else return o};function tct(e){return e.type==="Identifier"||e.type==="ParenthesizedExpression"&&tct(e.expression)}function iz(e){return e.type==="MemberExpression"&&e.property.type==="PrivateIdentifier"||e.type==="ChainExpression"&&iz(e.expression)||e.type==="ParenthesizedExpression"&&iz(e.expression)}Mi.parseExprSubscripts=function(e,t){var r=this.start,i=this.startLoc,s=this.parseExprAtom(e,t);if(s.type==="ArrowFunctionExpression"&&this.input.slice(this.lastTokStart,this.lastTokEnd)!==")")return s;var n=this.parseSubscripts(s,r,i,!1,t);return e&&n.type==="MemberExpression"&&(e.parenthesizedAssign>=n.start&&(e.parenthesizedAssign=-1),e.parenthesizedBind>=n.start&&(e.parenthesizedBind=-1),e.trailingComma>=n.start&&(e.trailingComma=-1)),n};Mi.parseSubscripts=function(e,t,r,i,s){for(var n=this.options.ecmaVersion>=8&&e.type==="Identifier"&&e.name==="async"&&this.lastTokEnd===e.end&&!this.canInsertSemicolon()&&e.end-e.start===5&&this.potentialArrowAt===e.start,o=!1;;){var a=this.parseSubscript(e,t,r,i,n,o,s);if(a.optional&&(o=!0),a===e||a.type==="ArrowFunctionExpression"){if(o){var h=this.startNodeAt(t,r);h.expression=a,a=this.finishNode(h,"ChainExpression")}return a}e=a}};Mi.shouldParseAsyncArrow=function(){return!this.canInsertSemicolon()&&this.eat(dt.arrow)};Mi.parseSubscriptAsyncArrow=function(e,t,r,i){return this.parseArrowExpression(this.startNodeAt(e,t),r,!0,i)};Mi.parseSubscript=function(e,t,r,i,s,n,o){var a=this.options.ecmaVersion>=11,h=a&&this.eat(dt.questionDot);i&&h&&this.raise(this.lastTokStart,"Optional chaining cannot appear in the callee of new expressions");var p=this.eat(dt.bracketL);if(p||h&&this.type!==dt.parenL&&this.type!==dt.backQuote||this.eat(dt.dot)){var g=this.startNodeAt(t,r);g.object=e,p?(g.property=this.parseExpression(),this.expect(dt.bracketR)):this.type===dt.privateId&&e.type!=="Super"?g.property=this.parsePrivateIdent():g.property=this.parseIdent(this.options.allowReserved!=="never"),g.computed=!!p,a&&(g.optional=h),e=this.finishNode(g,"MemberExpression")}else if(!i&&this.eat(dt.parenL)){var v=new _P,T=this.yieldPos,C=this.awaitPos,B=this.awaitIdentPos;this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0;var L=this.parseExprList(dt.parenR,this.options.ecmaVersion>=8,!1,v);if(s&&!h&&this.shouldParseAsyncArrow())return this.checkPatternErrors(v,!1),this.checkYieldAwaitInDefaultParams(),this.awaitIdentPos>0&&this.raise(this.awaitIdentPos,"Cannot use 'await' as identifier inside an async function"),this.yieldPos=T,this.awaitPos=C,this.awaitIdentPos=B,this.parseSubscriptAsyncArrow(t,r,L,o);this.checkExpressionErrors(v,!0),this.yieldPos=T||this.yieldPos,this.awaitPos=C||this.awaitPos,this.awaitIdentPos=B||this.awaitIdentPos;var z=this.startNodeAt(t,r);z.callee=e,z.arguments=L,a&&(z.optional=h),e=this.finishNode(z,"CallExpression")}else if(this.type===dt.backQuote){(h||n)&&this.raise(this.start,"Optional chaining cannot appear in the tag of tagged template expressions");var W=this.startNodeAt(t,r);W.tag=e,W.quasi=this.parseTemplate({isTagged:!0}),e=this.finishNode(W,"TaggedTemplateExpression")}return e};Mi.parseExprAtom=function(e,t,r){this.type===dt.slash&&this.readRegexp();var i,s=this.potentialArrowAt===this.start;switch(this.type){case dt._super:return this.allowSuper||this.raise(this.start,"'super' keyword outside a method"),i=this.startNode(),this.next(),this.type===dt.parenL&&!this.allowDirectSuper&&this.raise(i.start,"super() call outside constructor of a subclass"),this.type!==dt.dot&&this.type!==dt.bracketL&&this.type!==dt.parenL&&this.unexpected(),this.finishNode(i,"Super");case dt._this:return i=this.startNode(),this.next(),this.finishNode(i,"ThisExpression");case dt.name:var n=this.start,o=this.startLoc,a=this.containsEsc,h=this.parseIdent(!1);if(this.options.ecmaVersion>=8&&!a&&h.name==="async"&&!this.canInsertSemicolon()&&this.eat(dt._function))return this.overrideContext(Xs.f_expr),this.parseFunction(this.startNodeAt(n,o),0,!1,!0,t);if(s&&!this.canInsertSemicolon()){if(this.eat(dt.arrow))return this.parseArrowExpression(this.startNodeAt(n,o),[h],!1,t);if(this.options.ecmaVersion>=8&&h.name==="async"&&this.type===dt.name&&!a&&(!this.potentialArrowInForAwait||this.value!=="of"||this.containsEsc))return h=this.parseIdent(!1),(this.canInsertSemicolon()||!this.eat(dt.arrow))&&this.unexpected(),this.parseArrowExpression(this.startNodeAt(n,o),[h],!0,t)}return h;case dt.regexp:var p=this.value;return i=this.parseLiteral(p.value),i.regex={pattern:p.pattern,flags:p.flags},i;case dt.num:case dt.string:return this.parseLiteral(this.value);case dt._null:case dt._true:case dt._false:return i=this.startNode(),i.value=this.type===dt._null?null:this.type===dt._true,i.raw=this.type.keyword,this.next(),this.finishNode(i,"Literal");case dt.parenL:var g=this.start,v=this.parseParenAndDistinguishExpression(s,t);return e&&(e.parenthesizedAssign<0&&!this.isSimpleAssignTarget(v)&&(e.parenthesizedAssign=g),e.parenthesizedBind<0&&(e.parenthesizedBind=g)),v;case dt.bracketL:return i=this.startNode(),this.next(),i.elements=this.parseExprList(dt.bracketR,!0,!0,e),this.finishNode(i,"ArrayExpression");case dt.braceL:return this.overrideContext(Xs.b_expr),this.parseObj(!1,e);case dt._function:return i=this.startNode(),this.next(),this.parseFunction(i,0);case dt._class:return this.parseClass(this.startNode(),!1);case dt._new:return this.parseNew();case dt.backQuote:return this.parseTemplate();case dt._import:return this.options.ecmaVersion>=11?this.parseExprImport(r):this.unexpected();default:return this.parseExprAtomDefault()}};Mi.parseExprAtomDefault=function(){this.unexpected()};Mi.parseExprImport=function(e){var t=this.startNode();if(this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword import"),this.next(),this.type===dt.parenL&&!e)return this.parseDynamicImport(t);if(this.type===dt.dot){var r=this.startNodeAt(t.start,t.loc&&t.loc.start);return r.name="import",t.meta=this.finishNode(r,"Identifier"),this.parseImportMeta(t)}else this.unexpected()};Mi.parseDynamicImport=function(e){if(this.next(),e.source=this.parseMaybeAssign(),!this.eat(dt.parenR)){var t=this.start;this.eat(dt.comma)&&this.eat(dt.parenR)?this.raiseRecoverable(t,"Trailing comma is not allowed in import()"):this.unexpected(t)}return this.finishNode(e,"ImportExpression")};Mi.parseImportMeta=function(e){this.next();var t=this.containsEsc;return e.property=this.parseIdent(!0),e.property.name!=="meta"&&this.raiseRecoverable(e.property.start,"The only valid meta property for import is 'import.meta'"),t&&this.raiseRecoverable(e.start,"'import.meta' must not contain escaped characters"),this.options.sourceType!=="module"&&!this.options.allowImportExportEverywhere&&this.raiseRecoverable(e.start,"Cannot use 'import.meta' outside a module"),this.finishNode(e,"MetaProperty")};Mi.parseLiteral=function(e){var t=this.startNode();return t.value=e,t.raw=this.input.slice(this.start,this.end),t.raw.charCodeAt(t.raw.length-1)===110&&(t.bigint=t.raw.slice(0,-1).replace(/_/g,"")),this.next(),this.finishNode(t,"Literal")};Mi.parseParenExpression=function(){this.expect(dt.parenL);var e=this.parseExpression();return this.expect(dt.parenR),e};Mi.shouldParseArrow=function(e){return!this.canInsertSemicolon()};Mi.parseParenAndDistinguishExpression=function(e,t){var r=this.start,i=this.startLoc,s,n=this.options.ecmaVersion>=8;if(this.options.ecmaVersion>=6){this.next();var o=this.start,a=this.startLoc,h=[],p=!0,g=!1,v=new _P,T=this.yieldPos,C=this.awaitPos,B;for(this.yieldPos=0,this.awaitPos=0;this.type!==dt.parenR;)if(p?p=!1:this.expect(dt.comma),n&&this.afterTrailingComma(dt.parenR,!0)){g=!0;break}else if(this.type===dt.ellipsis){B=this.start,h.push(this.parseParenItem(this.parseRestBinding())),this.type===dt.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element");break}else h.push(this.parseMaybeAssign(!1,v,this.parseParenItem));var L=this.lastTokEnd,z=this.lastTokEndLoc;if(this.expect(dt.parenR),e&&this.shouldParseArrow(h)&&this.eat(dt.arrow))return this.checkPatternErrors(v,!1),this.checkYieldAwaitInDefaultParams(),this.yieldPos=T,this.awaitPos=C,this.parseParenArrowList(r,i,h,t);(!h.length||g)&&this.unexpected(this.lastTokStart),B&&this.unexpected(B),this.checkExpressionErrors(v,!0),this.yieldPos=T||this.yieldPos,this.awaitPos=C||this.awaitPos,h.length>1?(s=this.startNodeAt(o,a),s.expressions=h,this.finishNodeAt(s,"SequenceExpression",L,z)):s=h[0]}else s=this.parseParenExpression();if(this.options.preserveParens){var W=this.startNodeAt(r,i);return W.expression=s,this.finishNode(W,"ParenthesizedExpression")}else return s};Mi.parseParenItem=function(e){return e};Mi.parseParenArrowList=function(e,t,r,i){return this.parseArrowExpression(this.startNodeAt(e,t),r,!1,i)};var pCt=[];Mi.parseNew=function(){this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword new");var e=this.startNode();if(this.next(),this.options.ecmaVersion>=6&&this.type===dt.dot){var t=this.startNodeAt(e.start,e.loc&&e.loc.start);t.name="new",e.meta=this.finishNode(t,"Identifier"),this.next();var r=this.containsEsc;return e.property=this.parseIdent(!0),e.property.name!=="target"&&this.raiseRecoverable(e.property.start,"The only valid meta property for new is 'new.target'"),r&&this.raiseRecoverable(e.start,"'new.target' must not contain escaped characters"),this.allowNewDotTarget||this.raiseRecoverable(e.start,"'new.target' can only be used in functions and class static block"),this.finishNode(e,"MetaProperty")}var i=this.start,s=this.startLoc;return e.callee=this.parseSubscripts(this.parseExprAtom(null,!1,!0),i,s,!0,!1),this.eat(dt.parenL)?e.arguments=this.parseExprList(dt.parenR,this.options.ecmaVersion>=8,!1):e.arguments=pCt,this.finishNode(e,"NewExpression")};Mi.parseTemplateElement=function(e){var t=e.isTagged,r=this.startNode();return this.type===dt.invalidTemplate?(t||this.raiseRecoverable(this.start,"Bad escape sequence in untagged template literal"),r.value={raw:this.value.replace(/\r\n?/g,`
`),cooked:null}):r.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,`
`),cooked:this.value},this.next(),r.tail=this.type===dt.backQuote,this.finishNode(r,"TemplateElement")};Mi.parseTemplate=function(e){e===void 0&&(e={});var t=e.isTagged;t===void 0&&(t=!1);var r=this.startNode();this.next(),r.expressions=[];var i=this.parseTemplateElement({isTagged:t});for(r.quasis=[i];!i.tail;)this.type===dt.eof&&this.raise(this.pos,"Unterminated template literal"),this.expect(dt.dollarBraceL),r.expressions.push(this.parseExpression()),this.expect(dt.braceR),r.quasis.push(i=this.parseTemplateElement({isTagged:t}));return this.next(),this.finishNode(r,"TemplateLiteral")};Mi.isAsyncProp=function(e){return!e.computed&&e.key.type==="Identifier"&&e.key.name==="async"&&(this.type===dt.name||this.type===dt.num||this.type===dt.string||this.type===dt.bracketL||this.type.keyword||this.options.ecmaVersion>=9&&this.type===dt.star)&&!Ph.test(this.input.slice(this.lastTokEnd,this.start))};Mi.parseObj=function(e,t){var r=this.startNode(),i=!0,s={};for(r.properties=[],this.next();!this.eat(dt.braceR);){if(i)i=!1;else if(this.expect(dt.comma),this.options.ecmaVersion>=5&&this.afterTrailingComma(dt.braceR))break;var n=this.parseProperty(e,t);e||this.checkPropClash(n,s,t),r.properties.push(n)}return this.finishNode(r,e?"ObjectPattern":"ObjectExpression")};Mi.parseProperty=function(e,t){var r=this.startNode(),i,s,n,o;if(this.options.ecmaVersion>=9&&this.eat(dt.ellipsis))return e?(r.argument=this.parseIdent(!1),this.type===dt.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.finishNode(r,"RestElement")):(r.argument=this.parseMaybeAssign(!1,t),this.type===dt.comma&&t&&t.trailingComma<0&&(t.trailingComma=this.start),this.finishNode(r,"SpreadElement"));this.options.ecmaVersion>=6&&(r.method=!1,r.shorthand=!1,(e||t)&&(n=this.start,o=this.startLoc),e||(i=this.eat(dt.star)));var a=this.containsEsc;return this.parsePropertyName(r),!e&&!a&&this.options.ecmaVersion>=8&&!i&&this.isAsyncProp(r)?(s=!0,i=this.options.ecmaVersion>=9&&this.eat(dt.star),this.parsePropertyName(r)):s=!1,this.parsePropertyValue(r,e,i,s,n,o,t,a),this.finishNode(r,"Property")};Mi.parseGetterSetter=function(e){e.kind=e.key.name,this.parsePropertyName(e),e.value=this.parseMethod(!1);var t=e.kind==="get"?0:1;if(e.value.params.length!==t){var r=e.value.start;e.kind==="get"?this.raiseRecoverable(r,"getter should have no params"):this.raiseRecoverable(r,"setter should have exactly one param")}else e.kind==="set"&&e.value.params[0].type==="RestElement"&&this.raiseRecoverable(e.value.params[0].start,"Setter cannot use rest params")};Mi.parsePropertyValue=function(e,t,r,i,s,n,o,a){(r||i)&&this.type===dt.colon&&this.unexpected(),this.eat(dt.colon)?(e.value=t?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,o),e.kind="init"):this.options.ecmaVersion>=6&&this.type===dt.parenL?(t&&this.unexpected(),e.kind="init",e.method=!0,e.value=this.parseMethod(r,i)):!t&&!a&&this.options.ecmaVersion>=5&&!e.computed&&e.key.type==="Identifier"&&(e.key.name==="get"||e.key.name==="set")&&this.type!==dt.comma&&this.type!==dt.braceR&&this.type!==dt.eq?((r||i)&&this.unexpected(),this.parseGetterSetter(e)):this.options.ecmaVersion>=6&&!e.computed&&e.key.type==="Identifier"?((r||i)&&this.unexpected(),this.checkUnreserved(e.key),e.key.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=s),e.kind="init",t?e.value=this.parseMaybeDefault(s,n,this.copyNode(e.key)):this.type===dt.eq&&o?(o.shorthandAssign<0&&(o.shorthandAssign=this.start),e.value=this.parseMaybeDefault(s,n,this.copyNode(e.key))):e.value=this.copyNode(e.key),e.shorthand=!0):this.unexpected()};Mi.parsePropertyName=function(e){if(this.options.ecmaVersion>=6){if(this.eat(dt.bracketL))return e.computed=!0,e.key=this.parseMaybeAssign(),this.expect(dt.bracketR),e.key;e.computed=!1}return e.key=this.type===dt.num||this.type===dt.string?this.parseExprAtom():this.parseIdent(this.options.allowReserved!=="never")};Mi.initFunction=function(e){e.id=null,this.options.ecmaVersion>=6&&(e.generator=e.expression=!1),this.options.ecmaVersion>=8&&(e.async=!1)};Mi.parseMethod=function(e,t,r){var i=this.startNode(),s=this.yieldPos,n=this.awaitPos,o=this.awaitIdentPos;return this.initFunction(i),this.options.ecmaVersion>=6&&(i.generator=e),this.options.ecmaVersion>=8&&(i.async=!!t),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(lz(t,i.generator)|oz|(r?Zlt:0)),this.expect(dt.parenL),i.params=this.parseBindingList(dt.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams(),this.parseFunctionBody(i,!1,!0,!1),this.yieldPos=s,this.awaitPos=n,this.awaitIdentPos=o,this.finishNode(i,"FunctionExpression")};Mi.parseArrowExpression=function(e,t,r,i){var s=this.yieldPos,n=this.awaitPos,o=this.awaitIdentPos;return this.enterScope(lz(r,!1)|Ylt),this.initFunction(e),this.options.ecmaVersion>=8&&(e.async=!!r),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,e.params=this.toAssignableList(t,!0),this.parseFunctionBody(e,!0,!1,i),this.yieldPos=s,this.awaitPos=n,this.awaitIdentPos=o,this.finishNode(e,"ArrowFunctionExpression")};Mi.parseFunctionBody=function(e,t,r,i){var s=t&&this.type!==dt.braceL,n=this.strict,o=!1;if(s)e.body=this.parseMaybeAssign(i),e.expression=!0,this.checkParams(e,!1);else{var a=this.options.ecmaVersion>=7&&!this.isSimpleParamList(e.params);(!n||a)&&(o=this.strictDirective(this.end),o&&a&&this.raiseRecoverable(e.start,"Illegal 'use strict' directive in function with non-simple parameter list"));var h=this.labels;this.labels=[],o&&(this.strict=!0),this.checkParams(e,!n&&!o&&!t&&!r&&this.isSimpleParamList(e.params)),this.strict&&e.id&&this.checkLValSimple(e.id,Klt),e.body=this.parseBlock(!1,void 0,o&&!n),e.expression=!1,this.adaptDirectivePrologue(e.body.body),this.labels=h}this.exitScope()};Mi.isSimpleParamList=function(e){for(var t=0,r=e;t<r.length;t+=1){var i=r[t];if(i.type!=="Identifier")return!1}return!0};Mi.checkParams=function(e,t){for(var r=Object.create(null),i=0,s=e.params;i<s.length;i+=1){var n=s[i];this.checkLValInnerPattern(n,cz,t?null:r)}};Mi.parseExprList=function(e,t,r,i){for(var s=[],n=!0;!this.eat(e);){if(n)n=!1;else if(this.expect(dt.comma),t&&this.afterTrailingComma(e))break;var o=void 0;r&&this.type===dt.comma?o=null:this.type===dt.ellipsis?(o=this.parseSpread(i),i&&this.type===dt.comma&&i.trailingComma<0&&(i.trailingComma=this.start)):o=this.parseMaybeAssign(!1,i),s.push(o)}return s};Mi.checkUnreserved=function(e){var t=e.start,r=e.end,i=e.name;if(this.inGenerator&&i==="yield"&&this.raiseRecoverable(t,"Cannot use 'yield' as identifier inside a generator"),this.inAsync&&i==="await"&&this.raiseRecoverable(t,"Cannot use 'await' as identifier inside an async function"),this.currentThisScope().inClassFieldInit&&i==="arguments"&&this.raiseRecoverable(t,"Cannot use 'arguments' in class field initializer"),this.inClassStaticBlock&&(i==="arguments"||i==="await")&&this.raise(t,"Cannot use "+i+" in class static initialization block"),this.keywords.test(i)&&this.raise(t,"Unexpected keyword '"+i+"'"),!(this.options.ecmaVersion<6&&this.input.slice(t,r).indexOf("\\")!==-1)){var s=this.strict?this.reservedWordsStrict:this.reservedWords;s.test(i)&&(!this.inAsync&&i==="await"&&this.raiseRecoverable(t,"Cannot use keyword 'await' outside an async function"),this.raiseRecoverable(t,"The keyword '"+i+"' is reserved"))}};Mi.parseIdent=function(e){var t=this.parseIdentNode();return this.next(!!e),this.finishNode(t,"Identifier"),e||(this.checkUnreserved(t),t.name==="await"&&!this.awaitIdentPos&&(this.awaitIdentPos=t.start)),t};Mi.parseIdentNode=function(){var e=this.startNode();return this.type===dt.name?e.name=this.value:this.type.keyword?(e.name=this.type.keyword,(e.name==="class"||e.name==="function")&&(this.lastTokEnd!==this.lastTokStart+1||this.input.charCodeAt(this.lastTokStart)!==46)&&this.context.pop(),this.type=dt.name):this.unexpected(),e};Mi.parsePrivateIdent=function(){var e=this.startNode();return this.type===dt.privateId?e.name=this.value:this.unexpected(),this.next(),this.finishNode(e,"PrivateIdentifier"),this.options.checkPrivateFields&&(this.privateNameStack.length===0?this.raise(e.start,"Private field '#"+e.name+"' must be declared in an enclosing class"):this.privateNameStack[this.privateNameStack.length-1].used.push(e)),e};Mi.parseYield=function(e){this.yieldPos||(this.yieldPos=this.start);var t=this.startNode();return this.next(),this.type===dt.semi||this.canInsertSemicolon()||this.type!==dt.star&&!this.type.startsExpr?(t.delegate=!1,t.argument=null):(t.delegate=this.eat(dt.star),t.argument=this.parseMaybeAssign(e)),this.finishNode(t,"YieldExpression")};Mi.parseAwait=function(e){this.awaitPos||(this.awaitPos=this.start);var t=this.startNode();return this.next(),t.argument=this.parseMaybeUnary(null,!0,!1,e),this.finishNode(t,"AwaitExpression")};var mP=oa.prototype;mP.raise=function(e,t){var r=Hlt(this.input,e);t+=" ("+r.line+":"+r.column+")";var i=new SyntaxError(t);throw i.pos=e,i.loc=r,i.raisedAt=this.pos,i};mP.raiseRecoverable=mP.raise;mP.curPosition=function(){if(this.options.locations)return new a4(this.curLine,this.pos-this.lineStart)};var zA=oa.prototype,dCt=function(t){this.flags=t,this.var=[],this.lexical=[],this.functions=[],this.inClassFieldInit=!1};zA.enterScope=function(e){this.scopeStack.push(new dCt(e))};zA.exitScope=function(){this.scopeStack.pop()};zA.treatFunctionsAsVarInScope=function(e){return e.flags&xb||!this.inModule&&e.flags&l4};zA.declareName=function(e,t,r){var i=!1;if(t===H0){var s=this.currentScope();i=s.lexical.indexOf(e)>-1||s.functions.indexOf(e)>-1||s.var.indexOf(e)>-1,s.lexical.push(e),this.inModule&&s.flags&l4&&delete this.undefinedExports[e]}else if(t===Qlt){var n=this.currentScope();n.lexical.push(e)}else if(t===Glt){var o=this.currentScope();this.treatFunctionsAsVar?i=o.lexical.indexOf(e)>-1:i=o.lexical.indexOf(e)>-1||o.var.indexOf(e)>-1,o.functions.push(e)}else for(var a=this.scopeStack.length-1;a>=0;--a){var h=this.scopeStack[a];if(h.lexical.indexOf(e)>-1&&!(h.flags&Xlt&&h.lexical[0]===e)||!this.treatFunctionsAsVarInScope(h)&&h.functions.indexOf(e)>-1){i=!0;break}if(h.var.push(e),this.inModule&&h.flags&l4&&delete this.undefinedExports[e],h.flags&az)break}i&&this.raiseRecoverable(r,"Identifier '"+e+"' has already been declared")};zA.checkLocalExport=function(e){this.scopeStack[0].lexical.indexOf(e.name)===-1&&this.scopeStack[0].var.indexOf(e.name)===-1&&(this.undefinedExports[e.name]=e)};zA.currentScope=function(){return this.scopeStack[this.scopeStack.length-1]};zA.currentVarScope=function(){for(var e=this.scopeStack.length-1;;e--){var t=this.scopeStack[e];if(t.flags&az)return t}};zA.currentThisScope=function(){for(var e=this.scopeStack.length-1;;e--){var t=this.scopeStack[e];if(t.flags&az&&!(t.flags&Ylt))return t}};var yP=function(t,r,i){this.type="",this.start=r,this.end=0,t.options.locations&&(this.loc=new gP(t,i)),t.options.directSourceFile&&(this.sourceFile=t.options.directSourceFile),t.options.ranges&&(this.range=[r,0])},h4=oa.prototype;h4.startNode=function(){return new yP(this,this.start,this.startLoc)};h4.startNodeAt=function(e,t){return new yP(this,e,t)};function ect(e,t,r,i){return e.type=t,e.end=r,this.options.locations&&(e.loc.end=i),this.options.ranges&&(e.range[1]=r),e}h4.finishNode=function(e,t){return ect.call(this,e,t,this.lastTokEnd,this.lastTokEndLoc)};h4.finishNodeAt=function(e,t,r,i){return ect.call(this,e,t,r,i)};h4.copyNode=function(e){var t=new yP(this,e.start,this.startLoc);for(var r in e)t[r]=e[r];return t};var rct="ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS",ict=rct+" Extended_Pictographic",nct=ict,sct=nct+" EBase EComp EMod EPres ExtPict",oct=sct,mCt=oct,ACt={9:rct,10:ict,11:nct,12:sct,13:oct,14:mCt},gCt="Basic_Emoji Emoji_Keycap_Sequence RGI_Emoji_Modifier_Sequence RGI_Emoji_Flag_Sequence RGI_Emoji_Tag_Sequence RGI_Emoji_ZWJ_Sequence RGI_Emoji",_Ct={9:"",10:"",11:"",12:"",13:"",14:gCt},Flt="Cased_Letter LC Close_Punctuation Pe Connector_Punctuation Pc Control Cc cntrl Currency_Symbol Sc Dash_Punctuation Pd Decimal_Number Nd digit Enclosing_Mark Me Final_Punctuation Pf Format Cf Initial_Punctuation Pi Letter L Letter_Number Nl Line_Separator Zl Lowercase_Letter Ll Mark M Combining_Mark Math_Symbol Sm Modifier_Letter Lm Modifier_Symbol Sk Nonspacing_Mark Mn Number N Open_Punctuation Ps Other C Other_Letter Lo Other_Number No Other_Punctuation Po Other_Symbol So Paragraph_Separator Zp Private_Use Co Punctuation P punct Separator Z Space_Separator Zs Spacing_Mark Mc Surrogate Cs Symbol S Titlecase_Letter Lt Unassigned Cn Uppercase_Letter Lu",act="Adlam Adlm Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb",lct=act+" Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd",cct=lct+" Elymaic Elym Nandinagari Nand Nyiakeng_Puachue_Hmong Hmnp Wancho Wcho",uct=cct+" Chorasmian Chrs Diak Dives_Akuru Khitan_Small_Script Kits Yezi Yezidi",hct=uct+" Cypro_Minoan Cpmn Old_Uyghur Ougr Tangsa Tnsa Toto Vithkuqi Vith",yCt=hct+" Hrkt Katakana_Or_Hiragana Kawi Nag_Mundari Nagm Unknown Zzzz",xCt={9:act,10:lct,11:cct,12:uct,13:hct,14:yCt},fct={};function bCt(e){var t=fct[e]={binary:LA(ACt[e]+" "+Flt),binaryOfStrings:LA(_Ct[e]),nonBinary:{General_Category:LA(Flt),Script:LA(xCt[e])}};t.nonBinary.Script_Extensions=t.nonBinary.Script,t.nonBinary.gc=t.nonBinary.General_Category,t.nonBinary.sc=t.nonBinary.Script,t.nonBinary.scx=t.nonBinary.Script_Extensions}for(fP=0,JF=[9,10,11,12,13,14];fP<JF.length;fP+=1)zlt=JF[fP],bCt(zlt);var zlt,fP,JF,Rr=oa.prototype,AP=function(t,r){this.parent=t,this.base=r||this};AP.prototype.separatedFrom=function(t){for(var r=this;r;r=r.parent)for(var i=t;i;i=i.parent)if(r.base===i.base&&r!==i)return!0;return!1};AP.prototype.sibling=function(){return new AP(this.parent,this.base)};var id=function(t){this.parser=t,this.validFlags="gim"+(t.options.ecmaVersion>=6?"uy":"")+(t.options.ecmaVersion>=9?"s":"")+(t.options.ecmaVersion>=13?"d":"")+(t.options.ecmaVersion>=15?"v":""),this.unicodeProperties=fct[t.options.ecmaVersion>=14?14:t.options.ecmaVersion],this.source="",this.flags="",this.start=0,this.switchU=!1,this.switchV=!1,this.switchN=!1,this.pos=0,this.lastIntValue=0,this.lastStringValue="",this.lastAssertionIsQuantifiable=!1,this.numCapturingParens=0,this.maxBackReference=0,this.groupNames=Object.create(null),this.backReferenceNames=[],this.branchID=null};id.prototype.reset=function(t,r,i){var s=i.indexOf("v")!==-1,n=i.indexOf("u")!==-1;this.start=t|0,this.source=r+"",this.flags=i,s&&this.parser.options.ecmaVersion>=15?(this.switchU=!0,this.switchV=!0,this.switchN=!0):(this.switchU=n&&this.parser.options.ecmaVersion>=6,this.switchV=!1,this.switchN=n&&this.parser.options.ecmaVersion>=9)};id.prototype.raise=function(t){this.parser.raiseRecoverable(this.start,"Invalid regular expression: /"+this.source+"/: "+t)};id.prototype.at=function(t,r){r===void 0&&(r=!1);var i=this.source,s=i.length;if(t>=s)return-1;var n=i.charCodeAt(t);if(!(r||this.switchU)||n<=55295||n>=57344||t+1>=s)return n;var o=i.charCodeAt(t+1);return o>=56320&&o<=57343?(n<<10)+o-56613888:n};id.prototype.nextIndex=function(t,r){r===void 0&&(r=!1);var i=this.source,s=i.length;if(t>=s)return s;var n=i.charCodeAt(t),o;return!(r||this.switchU)||n<=55295||n>=57344||t+1>=s||(o=i.charCodeAt(t+1))<56320||o>57343?t+1:t+2};id.prototype.current=function(t){return t===void 0&&(t=!1),this.at(this.pos,t)};id.prototype.lookahead=function(t){return t===void 0&&(t=!1),this.at(this.nextIndex(this.pos,t),t)};id.prototype.advance=function(t){t===void 0&&(t=!1),this.pos=this.nextIndex(this.pos,t)};id.prototype.eat=function(t,r){return r===void 0&&(r=!1),this.current(r)===t?(this.advance(r),!0):!1};id.prototype.eatChars=function(t,r){r===void 0&&(r=!1);for(var i=this.pos,s=0,n=t;s<n.length;s+=1){var o=n[s],a=this.at(i,r);if(a===-1||a!==o)return!1;i=this.nextIndex(i,r)}return this.pos=i,!0};Rr.validateRegExpFlags=function(e){for(var t=e.validFlags,r=e.flags,i=!1,s=!1,n=0;n<r.length;n++){var o=r.charAt(n);t.indexOf(o)===-1&&this.raise(e.start,"Invalid regular expression flag"),r.indexOf(o,n+1)>-1&&this.raise(e.start,"Duplicate regular expression flag"),o==="u"&&(i=!0),o==="v"&&(s=!0)}this.options.ecmaVersion>=15&&i&&s&&this.raise(e.start,"Invalid regular expression flag")};function vCt(e){for(var t in e)return!0;return!1}Rr.validateRegExpPattern=function(e){this.regexp_pattern(e),!e.switchN&&this.options.ecmaVersion>=9&&vCt(e.groupNames)&&(e.switchN=!0,this.regexp_pattern(e))};Rr.regexp_pattern=function(e){e.pos=0,e.lastIntValue=0,e.lastStringValue="",e.lastAssertionIsQuantifiable=!1,e.numCapturingParens=0,e.maxBackReference=0,e.groupNames=Object.create(null),e.backReferenceNames.length=0,e.branchID=null,this.regexp_disjunction(e),e.pos!==e.source.length&&(e.eat(41)&&e.raise("Unmatched ')'"),(e.eat(93)||e.eat(125))&&e.raise("Lone quantifier brackets")),e.maxBackReference>e.numCapturingParens&&e.raise("Invalid escape");for(var t=0,r=e.backReferenceNames;t<r.length;t+=1){var i=r[t];e.groupNames[i]||e.raise("Invalid named capture referenced")}};Rr.regexp_disjunction=function(e){var t=this.options.ecmaVersion>=16;for(t&&(e.branchID=new AP(e.branchID,null)),this.regexp_alternative(e);e.eat(124);)t&&(e.branchID=e.branchID.sibling()),this.regexp_alternative(e);t&&(e.branchID=e.branchID.parent),this.regexp_eatQuantifier(e,!0)&&e.raise("Nothing to repeat"),e.eat(123)&&e.raise("Lone quantifier brackets")};Rr.regexp_alternative=function(e){for(;e.pos<e.source.length&&this.regexp_eatTerm(e););};Rr.regexp_eatTerm=function(e){return this.regexp_eatAssertion(e)?(e.lastAssertionIsQuantifiable&&this.regexp_eatQuantifier(e)&&e.switchU&&e.raise("Invalid quantifier"),!0):(e.switchU?this.regexp_eatAtom(e):this.regexp_eatExtendedAtom(e))?(this.regexp_eatQuantifier(e),!0):!1};Rr.regexp_eatAssertion=function(e){var t=e.pos;if(e.lastAssertionIsQuantifiable=!1,e.eat(94)||e.eat(36))return!0;if(e.eat(92)){if(e.eat(66)||e.eat(98))return!0;e.pos=t}if(e.eat(40)&&e.eat(63)){var r=!1;if(this.options.ecmaVersion>=9&&(r=e.eat(60)),e.eat(61)||e.eat(33))return this.regexp_disjunction(e),e.eat(41)||e.raise("Unterminated group"),e.lastAssertionIsQuantifiable=!r,!0}return e.pos=t,!1};Rr.regexp_eatQuantifier=function(e,t){return t===void 0&&(t=!1),this.regexp_eatQuantifierPrefix(e,t)?(e.eat(63),!0):!1};Rr.regexp_eatQuantifierPrefix=function(e,t){return e.eat(42)||e.eat(43)||e.eat(63)||this.regexp_eatBracedQuantifier(e,t)};Rr.regexp_eatBracedQuantifier=function(e,t){var r=e.pos;if(e.eat(123)){var i=0,s=-1;if(this.regexp_eatDecimalDigits(e)&&(i=e.lastIntValue,e.eat(44)&&this.regexp_eatDecimalDigits(e)&&(s=e.lastIntValue),e.eat(125)))return s!==-1&&s<i&&!t&&e.raise("numbers out of order in {} quantifier"),!0;e.switchU&&!t&&e.raise("Incomplete quantifier"),e.pos=r}return!1};Rr.regexp_eatAtom=function(e){return this.regexp_eatPatternCharacters(e)||e.eat(46)||this.regexp_eatReverseSolidusAtomEscape(e)||this.regexp_eatCharacterClass(e)||this.regexp_eatUncapturingGroup(e)||this.regexp_eatCapturingGroup(e)};Rr.regexp_eatReverseSolidusAtomEscape=function(e){var t=e.pos;if(e.eat(92)){if(this.regexp_eatAtomEscape(e))return!0;e.pos=t}return!1};Rr.regexp_eatUncapturingGroup=function(e){var t=e.pos;if(e.eat(40)){if(e.eat(63)&&e.eat(58)){if(this.regexp_disjunction(e),e.eat(41))return!0;e.raise("Unterminated group")}e.pos=t}return!1};Rr.regexp_eatCapturingGroup=function(e){if(e.eat(40)){if(this.options.ecmaVersion>=9?this.regexp_groupSpecifier(e):e.current()===63&&e.raise("Invalid group"),this.regexp_disjunction(e),e.eat(41))return e.numCapturingParens+=1,!0;e.raise("Unterminated group")}return!1};Rr.regexp_eatExtendedAtom=function(e){return e.eat(46)||this.regexp_eatReverseSolidusAtomEscape(e)||this.regexp_eatCharacterClass(e)||this.regexp_eatUncapturingGroup(e)||this.regexp_eatCapturingGroup(e)||this.regexp_eatInvalidBracedQuantifier(e)||this.regexp_eatExtendedPatternCharacter(e)};Rr.regexp_eatInvalidBracedQuantifier=function(e){return this.regexp_eatBracedQuantifier(e,!0)&&e.raise("Nothing to repeat"),!1};Rr.regexp_eatSyntaxCharacter=function(e){var t=e.current();return pct(t)?(e.lastIntValue=t,e.advance(),!0):!1};function pct(e){return e===36||e>=40&&e<=43||e===46||e===63||e>=91&&e<=94||e>=123&&e<=125}Rr.regexp_eatPatternCharacters=function(e){for(var t=e.pos,r=0;(r=e.current())!==-1&&!pct(r);)e.advance();return e.pos!==t};Rr.regexp_eatExtendedPatternCharacter=function(e){var t=e.current();return t!==-1&&t!==36&&!(t>=40&&t<=43)&&t!==46&&t!==63&&t!==91&&t!==94&&t!==124?(e.advance(),!0):!1};Rr.regexp_groupSpecifier=function(e){if(e.eat(63)){this.regexp_eatGroupName(e)||e.raise("Invalid group");var t=this.options.ecmaVersion>=16,r=e.groupNames[e.lastStringValue];if(r)if(t)for(var i=0,s=r;i<s.length;i+=1){var n=s[i];n.separatedFrom(e.branchID)||e.raise("Duplicate capture group name")}else e.raise("Duplicate capture group name");t?(r||(e.groupNames[e.lastStringValue]=[])).push(e.branchID):e.groupNames[e.lastStringValue]=!0}};Rr.regexp_eatGroupName=function(e){if(e.lastStringValue="",e.eat(60)){if(this.regexp_eatRegExpIdentifierName(e)&&e.eat(62))return!0;e.raise("Invalid capture group name")}return!1};Rr.regexp_eatRegExpIdentifierName=function(e){if(e.lastStringValue="",this.regexp_eatRegExpIdentifierStart(e)){for(e.lastStringValue+=FA(e.lastIntValue);this.regexp_eatRegExpIdentifierPart(e);)e.lastStringValue+=FA(e.lastIntValue);return!0}return!1};Rr.regexp_eatRegExpIdentifierStart=function(e){var t=e.pos,r=this.options.ecmaVersion>=11,i=e.current(r);return e.advance(r),i===92&&this.regexp_eatRegExpUnicodeEscapeSequence(e,r)&&(i=e.lastIntValue),wCt(i)?(e.lastIntValue=i,!0):(e.pos=t,!1)};function wCt(e){return W0(e,!0)||e===36||e===95}Rr.regexp_eatRegExpIdentifierPart=function(e){var t=e.pos,r=this.options.ecmaVersion>=11,i=e.current(r);return e.advance(r),i===92&&this.regexp_eatRegExpUnicodeEscapeSequence(e,r)&&(i=e.lastIntValue),TCt(i)?(e.lastIntValue=i,!0):(e.pos=t,!1)};function TCt(e){return _b(e,!0)||e===36||e===95||e===8204||e===8205}Rr.regexp_eatAtomEscape=function(e){return this.regexp_eatBackReference(e)||this.regexp_eatCharacterClassEscape(e)||this.regexp_eatCharacterEscape(e)||e.switchN&&this.regexp_eatKGroupName(e)?!0:(e.switchU&&(e.current()===99&&e.raise("Invalid unicode escape"),e.raise("Invalid escape")),!1)};Rr.regexp_eatBackReference=function(e){var t=e.pos;if(this.regexp_eatDecimalEscape(e)){var r=e.lastIntValue;if(e.switchU)return r>e.maxBackReference&&(e.maxBackReference=r),!0;if(r<=e.numCapturingParens)return!0;e.pos=t}return!1};Rr.regexp_eatKGroupName=function(e){if(e.eat(107)){if(this.regexp_eatGroupName(e))return e.backReferenceNames.push(e.lastStringValue),!0;e.raise("Invalid named reference")}return!1};Rr.regexp_eatCharacterEscape=function(e){return this.regexp_eatControlEscape(e)||this.regexp_eatCControlLetter(e)||this.regexp_eatZero(e)||this.regexp_eatHexEscapeSequence(e)||this.regexp_eatRegExpUnicodeEscapeSequence(e,!1)||!e.switchU&&this.regexp_eatLegacyOctalEscapeSequence(e)||this.regexp_eatIdentityEscape(e)};Rr.regexp_eatCControlLetter=function(e){var t=e.pos;if(e.eat(99)){if(this.regexp_eatControlLetter(e))return!0;e.pos=t}return!1};Rr.regexp_eatZero=function(e){return e.current()===48&&!xP(e.lookahead())?(e.lastIntValue=0,e.advance(),!0):!1};Rr.regexp_eatControlEscape=function(e){var t=e.current();return t===116?(e.lastIntValue=9,e.advance(),!0):t===110?(e.lastIntValue=10,e.advance(),!0):t===118?(e.lastIntValue=11,e.advance(),!0):t===102?(e.lastIntValue=12,e.advance(),!0):t===114?(e.lastIntValue=13,e.advance(),!0):!1};Rr.regexp_eatControlLetter=function(e){var t=e.current();return dct(t)?(e.lastIntValue=t%32,e.advance(),!0):!1};function dct(e){return e>=65&&e<=90||e>=97&&e<=122}Rr.regexp_eatRegExpUnicodeEscapeSequence=function(e,t){t===void 0&&(t=!1);var r=e.pos,i=t||e.switchU;if(e.eat(117)){if(this.regexp_eatFixedHexDigits(e,4)){var s=e.lastIntValue;if(i&&s>=55296&&s<=56319){var n=e.pos;if(e.eat(92)&&e.eat(117)&&this.regexp_eatFixedHexDigits(e,4)){var o=e.lastIntValue;if(o>=56320&&o<=57343)return e.lastIntValue=(s-55296)*1024+(o-56320)+65536,!0}e.pos=n,e.lastIntValue=s}return!0}if(i&&e.eat(123)&&this.regexp_eatHexDigits(e)&&e.eat(125)&&SCt(e.lastIntValue))return!0;i&&e.raise("Invalid unicode escape"),e.pos=r}return!1};function SCt(e){return e>=0&&e<=1114111}Rr.regexp_eatIdentityEscape=function(e){if(e.switchU)return this.regexp_eatSyntaxCharacter(e)?!0:e.eat(47)?(e.lastIntValue=47,!0):!1;var t=e.current();return t!==99&&(!e.switchN||t!==107)?(e.lastIntValue=t,e.advance(),!0):!1};Rr.regexp_eatDecimalEscape=function(e){e.lastIntValue=0;var t=e.current();if(t>=49&&t<=57){do e.lastIntValue=10*e.lastIntValue+(t-48),e.advance();while((t=e.current())>=48&&t<=57);return!0}return!1};var mct=0,$0=1,Ch=2;Rr.regexp_eatCharacterClassEscape=function(e){var t=e.current();if(ECt(t))return e.lastIntValue=-1,e.advance(),$0;var r=!1;if(e.switchU&&this.options.ecmaVersion>=9&&((r=t===80)||t===112)){e.lastIntValue=-1,e.advance();var i;if(e.eat(123)&&(i=this.regexp_eatUnicodePropertyValueExpression(e))&&e.eat(125))return r&&i===Ch&&e.raise("Invalid property name"),i;e.raise("Invalid property name")}return mct};function ECt(e){return e===100||e===68||e===115||e===83||e===119||e===87}Rr.regexp_eatUnicodePropertyValueExpression=function(e){var t=e.pos;if(this.regexp_eatUnicodePropertyName(e)&&e.eat(61)){var r=e.lastStringValue;if(this.regexp_eatUnicodePropertyValue(e)){var i=e.lastStringValue;return this.regexp_validateUnicodePropertyNameAndValue(e,r,i),$0}}if(e.pos=t,this.regexp_eatLoneUnicodePropertyNameOrValue(e)){var s=e.lastStringValue;return this.regexp_validateUnicodePropertyNameOrValue(e,s)}return mct};Rr.regexp_validateUnicodePropertyNameAndValue=function(e,t,r){c4(e.unicodeProperties.nonBinary,t)||e.raise("Invalid property name"),e.unicodeProperties.nonBinary[t].test(r)||e.raise("Invalid property value")};Rr.regexp_validateUnicodePropertyNameOrValue=function(e,t){if(e.unicodeProperties.binary.test(t))return $0;if(e.switchV&&e.unicodeProperties.binaryOfStrings.test(t))return Ch;e.raise("Invalid property name")};Rr.regexp_eatUnicodePropertyName=function(e){var t=0;for(e.lastStringValue="";Act(t=e.current());)e.lastStringValue+=FA(t),e.advance();return e.lastStringValue!==""};function Act(e){return dct(e)||e===95}Rr.regexp_eatUnicodePropertyValue=function(e){var t=0;for(e.lastStringValue="";ICt(t=e.current());)e.lastStringValue+=FA(t),e.advance();return e.lastStringValue!==""};function ICt(e){return Act(e)||xP(e)}Rr.regexp_eatLoneUnicodePropertyNameOrValue=function(e){return this.regexp_eatUnicodePropertyValue(e)};Rr.regexp_eatCharacterClass=function(e){if(e.eat(91)){var t=e.eat(94),r=this.regexp_classContents(e);return e.eat(93)||e.raise("Unterminated character class"),t&&r===Ch&&e.raise("Negated character class may contain strings"),!0}return!1};Rr.regexp_classContents=function(e){return e.current()===93?$0:e.switchV?this.regexp_classSetExpression(e):(this.regexp_nonEmptyClassRanges(e),$0)};Rr.regexp_nonEmptyClassRanges=function(e){for(;this.regexp_eatClassAtom(e);){var t=e.lastIntValue;if(e.eat(45)&&this.regexp_eatClassAtom(e)){var r=e.lastIntValue;e.switchU&&(t===-1||r===-1)&&e.raise("Invalid character class"),t!==-1&&r!==-1&&t>r&&e.raise("Range out of order in character class")}}};Rr.regexp_eatClassAtom=function(e){var t=e.pos;if(e.eat(92)){if(this.regexp_eatClassEscape(e))return!0;if(e.switchU){var r=e.current();(r===99||yct(r))&&e.raise("Invalid class escape"),e.raise("Invalid escape")}e.pos=t}var i=e.current();return i!==93?(e.lastIntValue=i,e.advance(),!0):!1};Rr.regexp_eatClassEscape=function(e){var t=e.pos;if(e.eat(98))return e.lastIntValue=8,!0;if(e.switchU&&e.eat(45))return e.lastIntValue=45,!0;if(!e.switchU&&e.eat(99)){if(this.regexp_eatClassControlLetter(e))return!0;e.pos=t}return this.regexp_eatCharacterClassEscape(e)||this.regexp_eatCharacterEscape(e)};Rr.regexp_classSetExpression=function(e){var t=$0,r;if(!this.regexp_eatClassSetRange(e))if(r=this.regexp_eatClassSetOperand(e)){r===Ch&&(t=Ch);for(var i=e.pos;e.eatChars([38,38]);){if(e.current()!==38&&(r=this.regexp_eatClassSetOperand(e))){r!==Ch&&(t=$0);continue}e.raise("Invalid character in character class")}if(i!==e.pos)return t;for(;e.eatChars([45,45]);)this.regexp_eatClassSetOperand(e)||e.raise("Invalid character in character class");if(i!==e.pos)return t}else e.raise("Invalid character in character class");for(;;)if(!this.regexp_eatClassSetRange(e)){if(r=this.regexp_eatClassSetOperand(e),!r)return t;r===Ch&&(t=Ch)}};Rr.regexp_eatClassSetRange=function(e){var t=e.pos;if(this.regexp_eatClassSetCharacter(e)){var r=e.lastIntValue;if(e.eat(45)&&this.regexp_eatClassSetCharacter(e)){var i=e.lastIntValue;return r!==-1&&i!==-1&&r>i&&e.raise("Range out of order in character class"),!0}e.pos=t}return!1};Rr.regexp_eatClassSetOperand=function(e){return this.regexp_eatClassSetCharacter(e)?$0:this.regexp_eatClassStringDisjunction(e)||this.regexp_eatNestedClass(e)};Rr.regexp_eatNestedClass=function(e){var t=e.pos;if(e.eat(91)){var r=e.eat(94),i=this.regexp_classContents(e);if(e.eat(93))return r&&i===Ch&&e.raise("Negated character class may contain strings"),i;e.pos=t}if(e.eat(92)){var s=this.regexp_eatCharacterClassEscape(e);if(s)return s;e.pos=t}return null};Rr.regexp_eatClassStringDisjunction=function(e){var t=e.pos;if(e.eatChars([92,113])){if(e.eat(123)){var r=this.regexp_classStringDisjunctionContents(e);if(e.eat(125))return r}else e.raise("Invalid escape");e.pos=t}return null};Rr.regexp_classStringDisjunctionContents=function(e){for(var t=this.regexp_classString(e);e.eat(124);)this.regexp_classString(e)===Ch&&(t=Ch);return t};Rr.regexp_classString=function(e){for(var t=0;this.regexp_eatClassSetCharacter(e);)t++;return t===1?$0:Ch};Rr.regexp_eatClassSetCharacter=function(e){var t=e.pos;if(e.eat(92))return this.regexp_eatCharacterEscape(e)||this.regexp_eatClassSetReservedPunctuator(e)?!0:e.eat(98)?(e.lastIntValue=8,!0):(e.pos=t,!1);var r=e.current();return r<0||r===e.lookahead()&&MCt(r)||CCt(r)?!1:(e.advance(),e.lastIntValue=r,!0)};function MCt(e){return e===33||e>=35&&e<=38||e>=42&&e<=44||e===46||e>=58&&e<=64||e===94||e===96||e===126}function CCt(e){return e===40||e===41||e===45||e===47||e>=91&&e<=93||e>=123&&e<=125}Rr.regexp_eatClassSetReservedPunctuator=function(e){var t=e.current();return PCt(t)?(e.lastIntValue=t,e.advance(),!0):!1};function PCt(e){return e===33||e===35||e===37||e===38||e===44||e===45||e>=58&&e<=62||e===64||e===96||e===126}Rr.regexp_eatClassControlLetter=function(e){var t=e.current();return xP(t)||t===95?(e.lastIntValue=t%32,e.advance(),!0):!1};Rr.regexp_eatHexEscapeSequence=function(e){var t=e.pos;if(e.eat(120)){if(this.regexp_eatFixedHexDigits(e,2))return!0;e.switchU&&e.raise("Invalid escape"),e.pos=t}return!1};Rr.regexp_eatDecimalDigits=function(e){var t=e.pos,r=0;for(e.lastIntValue=0;xP(r=e.current());)e.lastIntValue=10*e.lastIntValue+(r-48),e.advance();return e.pos!==t};function xP(e){return e>=48&&e<=57}Rr.regexp_eatHexDigits=function(e){var t=e.pos,r=0;for(e.lastIntValue=0;gct(r=e.current());)e.lastIntValue=16*e.lastIntValue+_ct(r),e.advance();return e.pos!==t};function gct(e){return e>=48&&e<=57||e>=65&&e<=70||e>=97&&e<=102}function _ct(e){return e>=65&&e<=70?10+(e-65):e>=97&&e<=102?10+(e-97):e-48}Rr.regexp_eatLegacyOctalEscapeSequence=function(e){if(this.regexp_eatOctalDigit(e)){var t=e.lastIntValue;if(this.regexp_eatOctalDigit(e)){var r=e.lastIntValue;t<=3&&this.regexp_eatOctalDigit(e)?e.lastIntValue=t*64+r*8+e.lastIntValue:e.lastIntValue=t*8+r}else e.lastIntValue=t;return!0}return!1};Rr.regexp_eatOctalDigit=function(e){var t=e.current();return yct(t)?(e.lastIntValue=t-48,e.advance(),!0):(e.lastIntValue=0,!1)};function yct(e){return e>=48&&e<=55}Rr.regexp_eatFixedHexDigits=function(e,t){var r=e.pos;e.lastIntValue=0;for(var i=0;i<t;++i){var s=e.current();if(!gct(s))return e.pos=r,!1;e.lastIntValue=16*e.lastIntValue+_ct(s),e.advance()}return!0};var hz=function(t){this.type=t.type,this.value=t.value,this.start=t.start,this.end=t.end,t.options.locations&&(this.loc=new gP(t,t.startLoc,t.endLoc)),t.options.ranges&&(this.range=[t.start,t.end])},_n=oa.prototype;_n.next=function(e){!e&&this.type.keyword&&this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword "+this.type.keyword),this.options.onToken&&this.options.onToken(new hz(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()};_n.getToken=function(){return this.next(),new hz(this)};typeof Symbol<"u"&&(_n[Symbol.iterator]=function(){var e=this;return{next:function(){var t=e.getToken();return{done:t.type===dt.eof,value:t}}}});_n.nextToken=function(){var e=this.curContext();if((!e||!e.preserveSpace)&&this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length)return this.finishToken(dt.eof);if(e.override)return e.override(this);this.readToken(this.fullCharCodeAtPos())};_n.readToken=function(e){return W0(e,this.options.ecmaVersion>=6)||e===92?this.readWord():this.getTokenFromCode(e)};_n.fullCharCodeAtPos=function(){var e=this.input.charCodeAt(this.pos);if(e<=55295||e>=56320)return e;var t=this.input.charCodeAt(this.pos+1);return t<=56319||t>=57344?e:(e<<10)+t-56613888};_n.skipBlockComment=function(){var e=this.options.onComment&&this.curPosition(),t=this.pos,r=this.input.indexOf("*/",this.pos+=2);if(r===-1&&this.raise(this.pos-2,"Unterminated comment"),this.pos=r+2,this.options.locations)for(var i=void 0,s=t;(i=jlt(this.input,s,this.pos))>-1;)++this.curLine,s=this.lineStart=i;this.options.onComment&&this.options.onComment(!0,this.input.slice(t+2,r),t,this.pos,e,this.curPosition())};_n.skipLineComment=function(e){for(var t=this.pos,r=this.options.onComment&&this.curPosition(),i=this.input.charCodeAt(this.pos+=e);this.pos<this.input.length&&!yb(i);)i=this.input.charCodeAt(++this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(t+e,this.pos),t,this.pos,r,this.curPosition())};_n.skipSpace=function(){t:for(;this.pos<this.input.length;){var e=this.input.charCodeAt(this.pos);switch(e){case 32:case 160:++this.pos;break;case 13:this.input.charCodeAt(this.pos+1)===10&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break t}break;default:if(e>8&&e<14||e>=5760&&Wlt.test(String.fromCharCode(e)))++this.pos;else break t}}};_n.finishToken=function(e,t){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var r=this.type;this.type=e,this.value=t,this.updateContext(r)};_n.readToken_dot=function(){var e=this.input.charCodeAt(this.pos+1);if(e>=48&&e<=57)return this.readNumber(!0);var t=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&e===46&&t===46?(this.pos+=3,this.finishToken(dt.ellipsis)):(++this.pos,this.finishToken(dt.dot))};_n.readToken_slash=function(){var e=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):e===61?this.finishOp(dt.assign,2):this.finishOp(dt.slash,1)};_n.readToken_mult_modulo_exp=function(e){var t=this.input.charCodeAt(this.pos+1),r=1,i=e===42?dt.star:dt.modulo;return this.options.ecmaVersion>=7&&e===42&&t===42&&(++r,i=dt.starstar,t=this.input.charCodeAt(this.pos+2)),t===61?this.finishOp(dt.assign,r+1):this.finishOp(i,r)};_n.readToken_pipe_amp=function(e){var t=this.input.charCodeAt(this.pos+1);if(t===e){if(this.options.ecmaVersion>=12){var r=this.input.charCodeAt(this.pos+2);if(r===61)return this.finishOp(dt.assign,3)}return this.finishOp(e===124?dt.logicalOR:dt.logicalAND,2)}return t===61?this.finishOp(dt.assign,2):this.finishOp(e===124?dt.bitwiseOR:dt.bitwiseAND,1)};_n.readToken_caret=function(){var e=this.input.charCodeAt(this.pos+1);return e===61?this.finishOp(dt.assign,2):this.finishOp(dt.bitwiseXOR,1)};_n.readToken_plus_min=function(e){var t=this.input.charCodeAt(this.pos+1);return t===e?t===45&&!this.inModule&&this.input.charCodeAt(this.pos+2)===62&&(this.lastTokEnd===0||Ph.test(this.input.slice(this.lastTokEnd,this.pos)))?(this.skipLineComment(3),this.skipSpace(),this.nextToken()):this.finishOp(dt.incDec,2):t===61?this.finishOp(dt.assign,2):this.finishOp(dt.plusMin,1)};_n.readToken_lt_gt=function(e){var t=this.input.charCodeAt(this.pos+1),r=1;return t===e?(r=e===62&&this.input.charCodeAt(this.pos+2)===62?3:2,this.input.charCodeAt(this.pos+r)===61?this.finishOp(dt.assign,r+1):this.finishOp(dt.bitShift,r)):t===33&&e===60&&!this.inModule&&this.input.charCodeAt(this.pos+2)===45&&this.input.charCodeAt(this.pos+3)===45?(this.skipLineComment(4),this.skipSpace(),this.nextToken()):(t===61&&(r=2),this.finishOp(dt.relational,r))};_n.readToken_eq_excl=function(e){var t=this.input.charCodeAt(this.pos+1);return t===61?this.finishOp(dt.equality,this.input.charCodeAt(this.pos+2)===61?3:2):e===61&&t===62&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(dt.arrow)):this.finishOp(e===61?dt.eq:dt.prefix,1)};_n.readToken_question=function(){var e=this.options.ecmaVersion;if(e>=11){var t=this.input.charCodeAt(this.pos+1);if(t===46){var r=this.input.charCodeAt(this.pos+2);if(r<48||r>57)return this.finishOp(dt.questionDot,2)}if(t===63){if(e>=12){var i=this.input.charCodeAt(this.pos+2);if(i===61)return this.finishOp(dt.assign,3)}return this.finishOp(dt.coalesce,2)}}return this.finishOp(dt.question,1)};_n.readToken_numberSign=function(){var e=this.options.ecmaVersion,t=35;if(e>=13&&(++this.pos,t=this.fullCharCodeAtPos(),W0(t,!0)||t===92))return this.finishToken(dt.privateId,this.readWord1());this.raise(this.pos,"Unexpected character '"+FA(t)+"'")};_n.getTokenFromCode=function(e){switch(e){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(dt.parenL);case 41:return++this.pos,this.finishToken(dt.parenR);case 59:return++this.pos,this.finishToken(dt.semi);case 44:return++this.pos,this.finishToken(dt.comma);case 91:return++this.pos,this.finishToken(dt.bracketL);case 93:return++this.pos,this.finishToken(dt.bracketR);case 123:return++this.pos,this.finishToken(dt.braceL);case 125:return++this.pos,this.finishToken(dt.braceR);case 58:return++this.pos,this.finishToken(dt.colon);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(dt.backQuote);case 48:var t=this.input.charCodeAt(this.pos+1);if(t===120||t===88)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(t===111||t===79)return this.readRadixNumber(8);if(t===98||t===66)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(e);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(e);case 124:case 38:return this.readToken_pipe_amp(e);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(e);case 60:case 62:return this.readToken_lt_gt(e);case 61:case 33:return this.readToken_eq_excl(e);case 63:return this.readToken_question();case 126:return this.finishOp(dt.prefix,1);case 35:return this.readToken_numberSign()}this.raise(this.pos,"Unexpected character '"+FA(e)+"'")};_n.finishOp=function(e,t){var r=this.input.slice(this.pos,this.pos+t);return this.pos+=t,this.finishToken(e,r)};_n.readRegexp=function(){for(var e,t,r=this.pos;;){this.pos>=this.input.length&&this.raise(r,"Unterminated regular expression");var i=this.input.charAt(this.pos);if(Ph.test(i)&&this.raise(r,"Unterminated regular expression"),e)e=!1;else{if(i==="[")t=!0;else if(i==="]"&&t)t=!1;else if(i==="/"&&!t)break;e=i==="\\"}++this.pos}var s=this.input.slice(r,this.pos);++this.pos;var n=this.pos,o=this.readWord1();this.containsEsc&&this.unexpected(n);var a=this.regexpState||(this.regexpState=new id(this));a.reset(r,s,o),this.validateRegExpFlags(a),this.validateRegExpPattern(a);var h=null;try{h=new RegExp(s,o)}catch{}return this.finishToken(dt.regexp,{pattern:s,flags:o,value:h})};_n.readInt=function(e,t,r){for(var i=this.options.ecmaVersion>=12&&t===void 0,s=r&&this.input.charCodeAt(this.pos)===48,n=this.pos,o=0,a=0,h=0,p=t??1/0;h<p;++h,++this.pos){var g=this.input.charCodeAt(this.pos),v=void 0;if(i&&g===95){s&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed in legacy octal numeric literals"),a===95&&this.raiseRecoverable(this.pos,"Numeric separator must be exactly one underscore"),h===0&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed at the first of digits"),a=g;continue}if(g>=97?v=g-97+10:g>=65?v=g-65+10:g>=48&&g<=57?v=g-48:v=1/0,v>=e)break;a=g,o=o*e+v}return i&&a===95&&this.raiseRecoverable(this.pos-1,"Numeric separator is not allowed at the last of digits"),this.pos===n||t!=null&&this.pos-n!==t?null:o};function RCt(e,t){return t?parseInt(e,8):parseFloat(e.replace(/_/g,""))}function xct(e){return typeof BigInt!="function"?null:BigInt(e.replace(/_/g,""))}_n.readRadixNumber=function(e){var t=this.pos;this.pos+=2;var r=this.readInt(e);return r==null&&this.raise(this.start+2,"Expected number in radix "+e),this.options.ecmaVersion>=11&&this.input.charCodeAt(this.pos)===110?(r=xct(this.input.slice(t,this.pos)),++this.pos):W0(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(dt.num,r)};_n.readNumber=function(e){var t=this.pos;!e&&this.readInt(10,void 0,!0)===null&&this.raise(t,"Invalid number");var r=this.pos-t>=2&&this.input.charCodeAt(t)===48;r&&this.strict&&this.raise(t,"Invalid number");var i=this.input.charCodeAt(this.pos);if(!r&&!e&&this.options.ecmaVersion>=11&&i===110){var s=xct(this.input.slice(t,this.pos));return++this.pos,W0(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(dt.num,s)}r&&/[89]/.test(this.input.slice(t,this.pos))&&(r=!1),i===46&&!r&&(++this.pos,this.readInt(10),i=this.input.charCodeAt(this.pos)),(i===69||i===101)&&!r&&(i=this.input.charCodeAt(++this.pos),(i===43||i===45)&&++this.pos,this.readInt(10)===null&&this.raise(t,"Invalid number")),W0(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var n=RCt(this.input.slice(t,this.pos),r);return this.finishToken(dt.num,n)};_n.readCodePoint=function(){var e=this.input.charCodeAt(this.pos),t;if(e===123){this.options.ecmaVersion<6&&this.unexpected();var r=++this.pos;t=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,t>1114111&&this.invalidStringToken(r,"Code point out of bounds")}else t=this.readHexChar(4);return t};_n.readString=function(e){for(var t="",r=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var i=this.input.charCodeAt(this.pos);if(i===e)break;i===92?(t+=this.input.slice(r,this.pos),t+=this.readEscapedChar(!1),r=this.pos):i===8232||i===8233?(this.options.ecmaVersion<10&&this.raise(this.start,"Unterminated string constant"),++this.pos,this.options.locations&&(this.curLine++,this.lineStart=this.pos)):(yb(i)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return t+=this.input.slice(r,this.pos++),this.finishToken(dt.string,t)};var bct={};_n.tryReadTemplateToken=function(){this.inTemplateElement=!0;try{this.readTmplToken()}catch(e){if(e===bct)this.readInvalidTemplateToken();else throw e}this.inTemplateElement=!1};_n.invalidStringToken=function(e,t){if(this.inTemplateElement&&this.options.ecmaVersion>=9)throw bct;this.raise(e,t)};_n.readTmplToken=function(){for(var e="",t=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");var r=this.input.charCodeAt(this.pos);if(r===96||r===36&&this.input.charCodeAt(this.pos+1)===123)return this.pos===this.start&&(this.type===dt.template||this.type===dt.invalidTemplate)?r===36?(this.pos+=2,this.finishToken(dt.dollarBraceL)):(++this.pos,this.finishToken(dt.backQuote)):(e+=this.input.slice(t,this.pos),this.finishToken(dt.template,e));if(r===92)e+=this.input.slice(t,this.pos),e+=this.readEscapedChar(!0),t=this.pos;else if(yb(r)){switch(e+=this.input.slice(t,this.pos),++this.pos,r){case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:e+=`
`;break;default:e+=String.fromCharCode(r);break}this.options.locations&&(++this.curLine,this.lineStart=this.pos),t=this.pos}else++this.pos}};_n.readInvalidTemplateToken=function(){for(;this.pos<this.input.length;this.pos++)switch(this.input[this.pos]){case"\\":++this.pos;break;case"$":if(this.input[this.pos+1]!=="{")break;case"`":return this.finishToken(dt.invalidTemplate,this.input.slice(this.start,this.pos));case"\r":this.input[this.pos+1]===`
`&&++this.pos;case`
`:case"\u2028":case"\u2029":++this.curLine,this.lineStart=this.pos+1;break}this.raise(this.start,"Unterminated template")};_n.readEscapedChar=function(e){var t=this.input.charCodeAt(++this.pos);switch(++this.pos,t){case 110:return`
`;case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return FA(this.readCodePoint());case 116:return"	";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:this.input.charCodeAt(this.pos)===10&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";case 56:case 57:if(this.strict&&this.invalidStringToken(this.pos-1,"Invalid escape sequence"),e){var r=this.pos-1;this.invalidStringToken(r,"Invalid escape sequence in template string")}default:if(t>=48&&t<=55){var i=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],s=parseInt(i,8);return s>255&&(i=i.slice(0,-1),s=parseInt(i,8)),this.pos+=i.length-1,t=this.input.charCodeAt(this.pos),(i!=="0"||t===56||t===57)&&(this.strict||e)&&this.invalidStringToken(this.pos-1-i.length,e?"Octal literal in template string":"Octal literal in strict mode"),String.fromCharCode(s)}return yb(t)?(this.options.locations&&(this.lineStart=this.pos,++this.curLine),""):String.fromCharCode(t)}};_n.readHexChar=function(e){var t=this.pos,r=this.readInt(16,e);return r===null&&this.invalidStringToken(t,"Bad character escape sequence"),r};_n.readWord1=function(){this.containsEsc=!1;for(var e="",t=!0,r=this.pos,i=this.options.ecmaVersion>=6;this.pos<this.input.length;){var s=this.fullCharCodeAtPos();if(_b(s,i))this.pos+=s<=65535?1:2;else if(s===92){this.containsEsc=!0,e+=this.input.slice(r,this.pos);var n=this.pos;this.input.charCodeAt(++this.pos)!==117&&this.invalidStringToken(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;var o=this.readCodePoint();(t?W0:_b)(o,i)||this.invalidStringToken(n,"Invalid Unicode escape"),e+=FA(o),r=this.pos}else break;t=!1}return e+this.input.slice(r,this.pos)};_n.readWord=function(){var e=this.readWord1(),t=dt.name;return this.keywords.test(e)&&(t=nz[e]),this.finishToken(t,e)};var kCt="8.12.1";oa.acorn={Parser:oa,version:kCt,defaultOptions:ez,Position:a4,SourceLocation:gP,getLineInfo:Hlt,Node:yP,TokenType:Rn,tokTypes:dt,keywordTypes:nz,TokContext:kf,tokContexts:Xs,isIdentifierChar:_b,isIdentifierStart:W0,Token:hz,isNewLine:yb,lineBreak:Ph,lineBreakG:iCt,nonASCIIwhitespace:Wlt};function vct(e,t){return oa.parse(e,t)}var bP={undefined:"void(0)",Infinity:"Number.POSITIVE_INFINITY",NaN:"Number.NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2"};var DCt={ecmaVersion:11},wct="$",OCt="d",BCt="d1",NCt="d2",el=e=>(t,r)=>r.error(t,e+" not allowed"),LCt=el("Aggregate function"),FCt=el("Window function"),zCt="Invalid argument",mz="Invalid column reference",UCt=mz+" (must be input to an aggregate function)",Sct="Invalid function call",VCt="Invalid member expression",jCt="Invalid operator parameter",WCt="Invalid param reference",$Ct="Invalid variable reference",HCt="Variable not accessible in operator call",qCt="Unsupported variable declaration",YCt="Unsupported destructuring pattern",Ect="Table expressions do not support closures",Ict="Use aq.escape(fn) to use a function as-is (including closures)",XCt="use table.params({ name: value }) to define dynamic parameters",ZCt="use aq.addFunction(name, fn) to add new op functions",GCt=`
Note: ${Ect}. ${Ict}, or ${XCt}.`,Mct=`
Note: ${Ect}. ${Ict}, or ${ZCt}.`,QCt=`The ${Ox} method is not valid in multi-table expressions.`;function Az(e,t){let r=KCt(t),i=e.root=r;return e.spec=t,e.tuple=null,e.tuple1=null,e.tuple2=null,e.$param=null,e.$op=0,e.scope=new Set,e.paramsRef=new Map,e.columnRef=new Map,klt(i)?(t8t(i,e),i=i.body):e.join?(e.scope.add(e.tuple1=BCt),e.scope.add(e.tuple2=NCt),e.scope.add(e.$param=wct)):(e.scope.add(e.tuple=OCt),e.scope.add(e.$param=wct)),on(i,e,gz),e.root}function KCt(e){try{let t=e.field?JCt(e):li(e)?Ls(e):e;return vct(`expr=(${t})`,DCt).body[0].expression.right}catch(t){sr(`Expression parse error: ${e+""}`,t)}}function JCt(e){let t=JSON.stringify(e+"");return e.table?`(a,b)=>b[${t}]`:`d=>d[${t}]`}var gz={FunctionDeclaration:el("Function definitions"),ForStatement:el("For loops"),ForOfStatement:el("For-of loops"),ForInStatement:el("For-in loops"),WhileStatement:el("While loops"),DoWhileStatement:el("Do-while loops"),AwaitExpression:el("Await expressions"),ArrowFunctionExpression:el("Function definitions"),AssignmentExpression:el("Assignments"),FunctionExpression:el("Function definitions"),NewExpression:el('Use of "new"'),UpdateExpression:el("Update expressions"),VariableDeclarator(e,t){dz(e.id,t)},Identifier(e,t,r){Rct(e,t,r)&&!t.scope.has(e.name)&&t.error(e,$Ct,GCt)},CallExpression(e,t){let r=Cct(e.callee),i=PC(r)||RC(r);if(i){if((t.join||t.aggregate===!1)&&rS(r)&&LCt(e,t),(t.join||t.window===!1)&&iS(r)&&FCt(e,t),t.$op=1,t.ast)pz(e,r,t),e.arguments.forEach(s=>on(s,t,fz));else{let s=t.op(e8t(t,i,r,e.arguments));Object.assign(e,{type:CC,name:s.id})}return t.$op=0,!1}else jL(r)?pz(e,r,t):t.error(e,Sct,Mct)},MemberExpression(e,t,r){let{object:i,property:s}=e;if(!Fo(_0,i))return;let{name:n}=i;if(Pct(e)&&Fo(_0,s)&&Ea(bP,s.name)){Oct(e,s.name);return}let o=n===t.tuple?0:n===t.tuple1?1:n===t.tuple2?2:-1;if(o>=0)return Tct(e,o,t,kct,r);if(n===t.$param)return Tct(e,o,t,i8t);t.paramsRef.has(n)?p4(e,t.paramsRef.get(n)):t.columnRef.has(n)?Dct(i,n,t,e):Ea(t.params,n)&&p4(i,n)}};function Tct(e,t,r,i,s){let{property:n,computed:o}=e,a;if(!o)a=n.name;else if(Fo(Lp,n))a=n.value;else try{on(n,r,gz,e),a=r.param(n)}catch{r.error(e,VCt)}return i(e,a,t,r,s),!1}var fz={...gz,VariableDeclarator:el("Variable declaration in operator call"),Identifier(e,t,r){Rct(e,t,r)&&t.error(e,HCt)},CallExpression(e,t){let r=Cct(e.callee);jL(r)?pz(e,r,t):t.error(e,Sct,Mct)}};function t8t(e,t){e.generator&&el("Generator functions")(e,t),e.async&&el("Async functions")(e,t);let{params:r}=e,i=r.length,s=o=>(a,h)=>t.columnRef.set(a,[h,o]),n=(o,a)=>t.paramsRef.set(o,a);i&&(t.join?(f4(t,r[0],"tuple1",s(1)),i>1&&f4(t,r[1],"tuple2",s(2)),i>2&&f4(t,r[2],"$param",n)):(f4(t,r[0],"tuple",s(0)),i>1&&f4(t,r[1],"$param",n))),t.root=e.body}function f4(e,t,r,i){Fo(_0,t)?(e.scope.add(t.name),e[r]=t.name):Fo(zL,t)&&t.properties.forEach(s=>{let n=Fo(_0,s.key)?s.key.name:Fo(Lp,s.key)?s.key.value:e.error(s,zCt);Fo(_0,s.value)||e.error(s.value,YCt),i(s.value.name,n)})}function e8t(e,t,r,i){let s=[],n=[],o=t.param[0]||0,a=o+(t.param[1]||0);return i.forEach((h,p)=>{p<o?(on(h,e,fz),s.push(e.field(h))):p<a?(on(h,e,fz),n.push(e.param(h))):e.error(h,jCt)}),{name:r,fields:s,params:n,...e.spec.window||{}}}function Cct(e){return Fo(_0,e)?e.name:Fo(FL,e)?Pct(e)?r8t(e.property.name):e.property.name:null}function Pct(e){return Fo(_0,e.object)&&e.object.name==="Math"}function r8t(e){return e==="max"?"greatest":e==="min"?"least":e}function Rct(e,t,r){let{name:i}=e;if(!(Fo(FL,r)&&r.property===e)){if(!(Fo(MC,r)&&r.key===e))if(t.paramsRef.has(i))p4(e,t.paramsRef.get(i));else if(t.columnRef.has(i))Dct(e,i,t,r);else if(Ea(t.params,i))p4(e,i);else if(Ea(bP,i))Oct(e,i);else return!0}}function kct(e,t,r,i,s){let n=r===0?i.table:r>0?i.join[r-1]:null,o=n&&n.column(t);n&&!o&&i.error(e,mz),i.aggronly&&!i.$op&&i.error(e,UCt),kC(e,t,r,o,s)}function Dct(e,t,r,i){let[s,n]=r.columnRef.get(t);kct(e,s,n,r,i)}function i8t(e,t,r,i){i.params&&!Ea(i.params,t)&&i.error(e,WCt),p4(e,t)}function p4(e,t){e.type=$st,e.name=t}function Oct(e,t){e.type=Vst,e.name=t,e.raw=bP[t]}function pz(e,t,r){if(t===Ox){let i=r.table;i||r.error(e,QCt),WL(e,e.arguments.length?e.arguments.map(s=>{let n=r.param(s),o=qs(n)?i.columnName(n):n;return i.column(o)||r.error(s,mz),o}):i.columnNames())}else e.callee={type:Wst,name:t}}function dz(e,t){Fo(_0,e)?t.scope.add(e.name):Fo(Lst,e)?e.elements.forEach(r=>dz(r,t)):Fo(zL,e)?e.properties.forEach(r=>dz(r.value,t)):t.error(e.id,qCt)}var n8t={[vA]:1,[CC]:1};function xs(e,t={}){let r=t.generate||g_,i=t.compiler||Dx,s=o8t(t),n={},o={},a=[],h=[],p=0,g=-1,v=t.join?i.join:t.index==1?i.expr2:i.expr,T={op(L){let z=s8t(L);return o[z]||(L.id=++g,o[z]=L)},field(L){let z=r(L);return n[z]||(n[z]=++p)},param(L){return Fo(Lp,L)?L.value:i.param(r(L),s)},value(L,z){a.push(L);let W=z.escape||(t.ast?Rlt(z):v(r(z),s));h.push(W),n8t[z.type]&&W!==z&&_s(W)&&(W.field=z.name)},error(L,z,W=""){let Z=L.start-6,X=L.end-6,q=String(T.spec).slice(Z,X);sr(`${z}: "${q}"${W}`)}};Object.assign(T,t,{params:s});for(let[L,z]of wA(e))T.value(L+"",z.escape?Olt(T,z,s):Az(T,z));if(t.ast)return{names:a,exprs:h};let C=[];for(let L in n)C[n[L]]=i.expr(L,s);let B=Object.values(o);return B.forEach(L=>L.fields=L.fields.map(z=>C[z])),{names:a,exprs:h,ops:B}}function s8t(e){let t=`${e.name}(${e.fields.concat(e.params).join(",")})`;if(e.frame){let r=e.frame.map(i=>Number.isFinite(i)?Math.abs(i):-1);t+=`[${r},${!!e.peers}]`}return t}function o8t(e){return(e.table?_z(e.table):e.join?{..._z(e.join[1]),..._z(e.join[0])}:{})||{}}function _z(e){return e&&Li(e.params)?e.params():{}}var vP="Expr",Mu="ExprList",wP="ExprNumber",j_="ExprObject",UA="JoinKeys",vb="JoinValues",$c="Options",d4="OrderKeys",nd="SelectionList",q0="TableRef",VA="TableRefList",Bct="Descending",Nct="Query",Lct="Selection",Fct="Verb",zct="Window";function jA(e,t){return e&&e.expr?new TP({...e,...t}):new TP(t,e)}var TP=class{constructor(t,r){this.expr=r,Object.assign(this,t)}toString(){return String(this.expr)}toObject(){return{...this,expr:this.toString(),...Li(this.expr)?{func:!0}:{}}}};function SP(e){return jA(e,{desc:!0})}function Cu(e,t,r=0){let i=r?{field:!0,table:r}:{field:!0};return jA(e,t?{expr:t,...i}:i)}function wb(e,t,r){return jA(e,{window:{frame:t||[-1/0,0],peers:!!r}})}function a8t(e){let t=r=>r;return t.toString=()=>e,t}function yz(e,t){return t=t&&Li(t.query)?t.query():t,t&&Li(t.evaluate)?t.evaluate(null,e):e(t)}function xz(e){return _s(e)&&(li(e.all)||li(e.matches)||li(e.not)||li(e.range))}function W_(e){return e&&Li(e.toObject)?e.toObject():Li(e)?{expr:String(e),func:!0}:li(e)?e.map(W_):_s(e)?U_(e,t=>W_(t)):e}function EP(e){return li(e)?e.map(EP):_s(e)?li(e.verbs)?Hc.from(e):li(e.all)?Iu():li(e.range)?uP(...e.range):li(e.match)?gb(RegExp(...e.match)):li(e.not)?Ab(e.not.map(W_)):l8t(e):e}function l8t(e){let t=e,r=e.expr;if(r!=null){if(e.field===!0?t=r=Cu(r):e.func===!0&&(t=r=a8t(r)),_s(e.window)){let{frame:i,peers:s}=e.window;t=r=wb(r,i,s)}e.desc===!0&&(t=SP(r))}return e===t?U_(e,i=>EP(i)):t}function Uct(e){return li(e)?e.map(c8t):e}function c8t(e){let t=[];return Hs(e).forEach(r=>{qs(r)?t.push(r):Ln(r)?t.push(Cu(r,null)):_s(r)&&r.expr||Li(r)?t.push(r):sr(`Invalid key value: ${r+""}`)}),t}function Vct(e){return li(e)?e.map(u8t):e}function u8t(e,t){return t<2?Hs(e):e}function jct(e){let t=[];return e.forEach(r=>{let i=r.expr!=null?r.expr:r;if(_s(i)&&!Li(i))for(let s in i)t.push(i[s]);else r=qs(i)?i:Ln(i)?Cu(r):Li(i)?r:sr(`Invalid orderby field: ${r+""}`),t.push(r)}),t}var h8t={[vP]:Xct,[Mu]:Tb,[wP]:A8t,[j_]:WA,[UA]:g8t,[vb]:_8t,[d4]:Tb,[nd]:d8t};function $ct(e,t,r){return t===q0?Wct(e):t===VA?e.map(Wct):Hct(W_(e),t,r)}function Hct(e,t,r){return t===$c?e&&f8t(e,r):h8t[t](e)}function f8t(e,t={}){let r={};for(let i in e){let s=e[i];r[i]=t[i]?Hct(s,t[i]):s}return r}function p8t(e,t){return xs({expr:e},{...t,ast:!0}).exprs[0]}function bz(e){return{type:vA,name:e}}function qct(e){return{type:vA,index:e}}function WA(e,t){if(Ln(e))return p8t(e,t);if(e.expr){let r;if(e.field===!0?r=bz(e.expr):e.func===!0&&(r=WA(e.expr,t)),r)return e.desc&&(r={type:Bct,expr:r}),e.window&&(r={type:zct,expr:r,...e.window}),r}return Object.keys(e).map(r=>({...WA(e[r],t),as:r}))}function Yct(e){let t=Lct;return e.all?{type:t,operator:"all"}:e.not?{type:t,operator:"not",arguments:Tb(e.not)}:e.range?{type:t,operator:"range",arguments:Tb(e.range)}:e.matches?{type:t,operator:"matches",arguments:e.matches}:sr("Invalid input")}function d8t(e){return Hs(e).map(m8t).flat()}function m8t(e){return xz(e)?Yct(e):qs(e)?qct(e):Ln(e)?bz(e):_s(e)?Object.keys(e).map(t=>({type:vA,name:t,as:e[t]})):sr("Invalid input")}function Xct(e){return xz(e)?Yct(e):qs(e)?qct(e):Ln(e)?bz(e):_s(e)?WA(e):sr("Invalid input")}function Tb(e){return Hs(e).map(Xct).flat()}function A8t(e){return qs(e)?e:WA(e)}function g8t(e){return li(e)?e.map(Tb):WA(e,{join:!0})}function _8t(e){return li(e)?e.map((t,r)=>r<2?Tb(t):WA(t,{join:!0})):WA(e,{join:!0})}function Wct(e){return e&&Li(e.toAST)?e.toAST():e}var $_=class{constructor(t,r=[],i=[]){this.verb=t,this.schema=r,r.forEach((s,n)=>{let o=s.type,a=i[n],h=o===UA?Uct(a):o===vb?Vct(a):o===d4?jct(a):a;this[s.name]=h!==void 0?h:s.default})}static from(t){let r=$A[t.verb],i=(r.schema||[]).map(({name:s})=>EP(t[s]));return r(...i)}evaluate(t,r){let i=this.schema.map(({name:s,type:n})=>{let o=this[s];return n===q0?yz(r,o):n===VA?o.map(a=>yz(r,a)):o});return t[this.verb](...i)}toObject(){let t={verb:this.verb};return this.schema.forEach(({name:r})=>{t[r]=W_(this[r])}),t}toAST(){let t={type:Fct,verb:this.verb};return this.schema.forEach(({name:r,type:i,props:s})=>{t[r]=$ct(this[r],i,s)}),t}};function Zn(e,t){return Object.assign((...r)=>new $_(e,t,r),{schema:t})}var $A={count:Zn("count",[{name:"options",type:$c}]),derive:Zn("derive",[{name:"values",type:j_},{name:"options",type:$c,props:{before:nd,after:nd}}]),filter:Zn("filter",[{name:"criteria",type:j_}]),groupby:Zn("groupby",[{name:"keys",type:Mu}]),orderby:Zn("orderby",[{name:"keys",type:d4}]),relocate:Zn("relocate",[{name:"columns",type:nd},{name:"options",type:$c,props:{before:nd,after:nd}}]),rename:Zn("rename",[{name:"columns",type:nd}]),rollup:Zn("rollup",[{name:"values",type:j_}]),sample:Zn("sample",[{name:"size",type:wP},{name:"options",type:$c,props:{weight:vP}}]),select:Zn("select",[{name:"columns",type:nd}]),ungroup:Zn("ungroup"),unorder:Zn("unorder"),reify:Zn("reify"),dedupe:Zn("dedupe",[{name:"keys",type:Mu,default:[]}]),impute:Zn("impute",[{name:"values",type:j_},{name:"options",type:$c,props:{expand:Mu}}]),fold:Zn("fold",[{name:"values",type:Mu},{name:"options",type:$c}]),pivot:Zn("pivot",[{name:"keys",type:Mu},{name:"values",type:Mu},{name:"options",type:$c}]),spread:Zn("spread",[{name:"values",type:Mu},{name:"options",type:$c}]),unroll:Zn("unroll",[{name:"values",type:Mu},{name:"options",type:$c,props:{drop:Mu}}]),lookup:Zn("lookup",[{name:"table",type:q0},{name:"on",type:UA},{name:"values",type:Mu}]),join:Zn("join",[{name:"table",type:q0},{name:"on",type:UA},{name:"values",type:vb},{name:"options",type:$c}]),cross:Zn("cross",[{name:"table",type:q0},{name:"values",type:vb},{name:"options",type:$c}]),semijoin:Zn("semijoin",[{name:"table",type:q0},{name:"on",type:UA}]),antijoin:Zn("antijoin",[{name:"table",type:q0},{name:"on",type:UA}]),concat:Zn("concat",[{name:"tables",type:VA}]),union:Zn("union",[{name:"tables",type:VA}]),intersect:Zn("intersect",[{name:"tables",type:VA}]),except:Zn("except",[{name:"tables",type:VA}])};function Gct(e){return new Hc(null,null,e)}function Qct(e){return Hc.from(e)}var Hc=class e extends m0{constructor(t,r,i){super(r),this._verbs=t||[],this._table=i}static from({verbs:t,table:r,params:i}){return new e(t.map($_.from),i,r)}get[Symbol.toStringTag](){return this._verbs?`Query: ${this._verbs.length} verbs`+(this._table?` on '${this._table}'`:""):"Object"}get length(){return this._verbs.length}get tableName(){return this._table}params(t){return arguments.length?(this._params={...this._params,...t},this):this._params}evaluate(t,r){t=t||r(this._table);for(let i of this._verbs)t=i.evaluate(t.params(this._params),r);return t}toObject(){return Zct(this,"toObject")}toJSON(){return this.toObject()}toAST(){return Zct(this,"toAST",{type:Nct})}};function Zct(e,t,r){return{...r,verbs:e._verbs.map(i=>i[t]()),...e._params?{params:e._params}:null,...e._table?{table:e._table}:null}}function Kct(e,t){return new Hc(e._verbs.concat(t),e._params,e._table)}function Jct(e,t){Hc.prototype[e]=function(...r){return Kct(this,t(...r))}}for(let e in $A){let t=$A[e];Hc.prototype["__"+e]=function(r,...i){return Kct(r,t(...i))}}var tut={name:"arquero",version:"5.4.1",description:"Query processing and transformation of array-backed data tables.",keywords:["data","query","database","table","dataframe","transform","arrays"],license:"BSD-3-Clause",author:"Jeffrey Heer (http://idl.cs.washington.edu)",main:"dist/arquero.node.js",module:"src/index-node.js",unpkg:"dist/arquero.min.js",jsdelivr:"dist/arquero.min.js",types:"dist/types/index.d.ts",browser:{"./dist/arquero.node.js":"./dist/arquero.min.js","./src/index-node.js":"./src/index.js"},repository:{type:"git",url:"https://github.com/uwdata/arquero.git"},scripts:{prebuild:"rimraf dist && mkdir dist",build:"rollup -c rollup.config.mjs",postbuild:"tsc",preperf:"npm run build",perf:"TZ=America/Los_Angeles tape 'perf/**/*-perf.js'",lint:"eslint src test",test:"TZ=America/Los_Angeles tape 'test/**/*-test.js' --require esm",prepublishOnly:"npm test && npm run lint && npm run build"},dependencies:{acorn:"^8.12.0","apache-arrow":"^15.0.2","node-fetch":"^2.7.0"},devDependencies:{"@rollup/plugin-json":"^6.1.0","@rollup/plugin-node-resolve":"^15.2.3","@rollup/plugin-terser":"^0.4.4",eslint:"^9.5.0",esm:"^3.2.25",rimraf:"^5.0.7",rollup:"^4.18.0","rollup-plugin-bundle-size":"^1.0.3",tape:"^5.8.1",typescript:"^5.5.2"},esm:{force:!0,mainFields:["module","main"]}};function eut(e){let{data:t,length:r,nullCount:i}=e,s=t[t.length-1].dictionary,n=s.length,o=x8t(t||[e],r,i,n),a=Array(n),h=p=>p==null||p<0||p>=n?null:a[p]!==void 0?a[p]:a[p]=s.get(p);return{vector:e,length:r,get:p=>h(o[p]),key:p=>o[p],keyFor(p){if(p===null)return i?n:-1;for(let g=0;g<n;++g)if(a[g]===void 0&&(a[g]=s.get(g)),a[g]===p)return g;return-1},groups(p){let g=n+(i?1:0);return{keys:o,get:[h],names:p,rows:IC(0,g),size:g}},[Symbol.iterator](){return e[Symbol.iterator]()}}}function x8t(e,t,r,i){let s=e.length>1||r?b8t(e,t,e[0].type.indices):e[0].values;return r?v8t(e,s,i):s}function b8t(e,t,r){let i=new r.ArrayType(t),s=e.length;for(let n=0,o=0,a;n<s;++n)a=e[n].length,i.set(e[n].values.subarray(0,a),o),o+=a;return i}function v8t(e,t,r){let i=e.length;for(let s=0,n=0,o,a,h,p;s<i;++s){if(h=e[s].nullBitmap,o=e[s].length>>3,h&&h.length)for(let g=0;g<=o;++g)(p=h[g])!==255&&(a=n+(g<<3),p&1||(t[a+0]=r),p&2||(t[a+1]=r),p&4||(t[a+2]=r),p&8||(t[a+3]=r),p&16||(t[a+4]=r),p&32||(t[a+5]=r),p&64||(t[a+6]=r),p&128||(t[a+7]=r));n+=e[s].length}return t}function qc(e,t,...r){let i=["_","$"],s=i.slice(0,r.length);return s.push('"use strict"; const '+r.map((n,o)=>n.map((a,h)=>`${i[o]}${h} = ${i[o]}[${h}]`).join(", ")).join(", ")+`; return (${e}) => ${t};`),Function(...s)(...r)}var rut=({typeId:e})=>e===-1,iut=({typeId:e})=>e===5,nut=({typeId:e})=>e===12,sut=({typeId:e})=>e===13,out=({typeId:e})=>e===16;var w8t=e=>nut(e)||out(e);function IP(e,t){let{type:r,length:i,numChildren:s}=e;if(rut(r))return eut(e);let n=s&&t?vz(e):s?aut(vz(e)):iut(r)?aut(o=>e.get(o)):null;return n?{vector:e,length:i,get:n,[Symbol.iterator]:()=>T8t(i,n)}:e}function aut(e){let t=[];return r=>{let i=t[r];return i!==void 0?i:t[r]=e(r)}}function*T8t(e,t){for(let r=0;r<e;++r)yield t(r)}var lut=e=>e.numChildren?fh(e.length,vz(e)):e.nullCount?[...e]:e.toArray(),vz=e=>w8t(e.type)?S8t(e):sut(e.type)?E8t(e):sr(`Unsupported Arrow type: ${Ls(e.VectorName)}`),S8t=e=>e.nullCount?t=>e.isValid(t)?lut(e.get(t)):null:t=>lut(e.get(t));function E8t(e){let t=[],r=[];e.type.children.forEach((s,n)=>{t.push(IP(e.getChildAt(n),!0)),r.push(`${Ls(s.name)}:_${n}.get(row)`)});let i=qc("row","({"+r+"})",t);return e.nullCount?s=>e.isValid(s)?i(s):null:i}function MP(e,t={}){e&&!e.batches&&(e=dlt()(e));let r=e.schema.fields.map(n=>n.name),i=Ja({columnNames:n=>n?r.filter(n):r.slice(),columnIndex:n=>r.indexOf(n)},t.columns||Iu()),s=ys();return i.forEach((n,o)=>{s.add(n,IP(e.getChild(o)))}),new tl(s.data,s.names)}var m4=e=>e;var I8t=[e=>e==="true"||e==="false",e=>e!=="false"],cut=[e=>e==="NaN"||(e=+e)===e,e=>+e],M8t=[Mx,e=>new Date(Date.parse(e))];function C8t(e){let{decimal:t}=e;return t&&t!=="."?cut.map(r=>i=>r(i&&i.replace(t,"."))):cut}function uut(e,t){let r=[I8t,C8t(t),M8t],i=r.length;for(let s=0;s<i;++s){let[n,o]=r[s];if(P8t(e,n))return o}return m4}function P8t(e,t){let r=e.length;for(let i=0;i<r;++i){let s=e[i];if(s!=null&&!t(s))return!1}return!0}function hut(e,t=0){return fh(e-t,r=>`col${r+t+1}`)}function CP(e,t,r){let i=e(),s=i.length,n=+r.autoMax||1e3,o=fh(s,()=>[]);t=t?t.length<s?[...t,hut(s,t.length)]:t:hut(s);let a=0;for(;a<n&&i;++a,i=e())for(let g=0;g<s;++g)o[g].push(i[g]===""?null:i[g]);let h=R8t(t,o,r);for(h.forEach((g,v)=>{if(g===m4)return;let T=o[v];for(let C=0;C<a;++C)T[C]!=null&&(T[C]=g(T[C]))});i;i=e())for(let g=0;g<s;++g)o[g].push(i[g]?h[g](i[g]):null);let p={};return t.forEach((g,v)=>p[g]=o[v]),new tl(p,t)}function R8t(e,t,r){let{parse:i={}}=r,s=r.autoType===!1;return e.map((n,o)=>Li(i[n])?i[n]:s?m4:uut(t[o],r))}var wz={},PP={};function RP(e,t,r){let i=+t||0;for(;--i>=0;)e();return r?()=>{let s;for(;!s;)if(r(s=e()))s=null;else return s}:e}function fut(e,{delimiter:t=",",skip:r,comment:i}){t.length!==1&&sr(`Text "delimiter" should be a single character, found "${t}"`);let s=t.charCodeAt(0),n=e.length,o=0,a,h=n<=0,p=!1;e.charCodeAt(n-1)===10&&--n,e.charCodeAt(n-1)===13&&--n;function g(){if(h)return PP;if(p)return p=!1,wz;let T=o,C,B;if(e.charCodeAt(T)===34){for(;o++<n&&e.charCodeAt(o)!==34||e.charCodeAt(++o)===34;);return(C=o)>=n?h=!0:(B=e.charCodeAt(o++))===10?p=!0:B===13&&(p=!0,e.charCodeAt(o)===10&&++o),e.slice(T+1,C-1).replace(/""/g,'"')}for(;o<n;){if((B=e.charCodeAt(C=o++))===10)p=!0;else if(B===13)p=!0,e.charCodeAt(o)===10&&++o;else if(B!==s)continue;return e.slice(T,C)}return h=!0,e.slice(T,n)}function v(){if((a=g())!==PP){let T=[];for(;a!==wz&&a!==PP;)T.push(a),a=g();return T}}return RP(v,r,i&&(T=>(T&&T[0]||"").startsWith(i)))}function A4(e,t={}){let r=fut(e,t);return CP(r,t.header!==!1?r():t.names,t)}function put(e,{skip:t,comment:r}){let i=e.length,s=0;e.charCodeAt(i-1)===10&&--i,e.charCodeAt(i-1)===13&&--i;function n(){if(s>=i)return;let o=s,a=!1,h,p;for(;s<i;)if((p=e.charCodeAt(h=s++))===10?a=!0:p===13&&(a=!0,e.charCodeAt(s)===10&&++s),a)return e.slice(o,h);return e.slice(o,i)}return RP(n,t,r&&(o=>(o||"").startsWith(r)))}function kP(e,t={}){let r=put(e,t),i=k8t(t);return CP(()=>{let s=r();if(s)return i.map(([n,o])=>s.slice(n,o).trim())},t.names,t)}function k8t({positions:e,widths:t}){!e&&!t&&sr('Fixed width files require a "positions" or "widths" option');let r=0;return e||t.map(i=>[r,r+=i])}function dut(e){let t=e.length;for(let r=0;r<t;++r){let i=e.charCodeAt(r);if(i<48||i>57)return!1}return!0}function DP(e,t={}){let r=oP(t.autoType);Ln(e)&&(e=JSON.parse(e));let i=e.data,s;if(_s(i)&&!Au(i)?e.schema&&e.schema.fields&&(s=e.schema.fields.map(n=>n.name)):i=e,r||t.parse){let n=t.parse||{};for(let o in i){let a=i[o],h=a.length;if(n[o])for(let p=0;p<h;++p)a[p]=n[o](a[p]);else if(r)for(let p=0;p<h;++p){let g=a[p];Ln(g)&&Mx(g)&&!dut(g)&&(a[p]=new Date(g))}}}return new tl(i,s)}function mut(e,t=[]){return e.groupby(t.length?t:e.columnNames()).filter("row_number() === 1").ungroup().reify()}function Eb(e,t){let r=ys();return t.forEach((i,s)=>{let n=Ln(i)?i:s;if(n){let o=e.column(s)||sr(`Unrecognized column: ${s}`);r.add(n,o)}}),e.create(r)}function OP(e,t,{before:r,after:i}={}){let s=r!=null,n=i!=null;s||n||sr("relocate requires a before or after option."),s&&n&&sr("relocate accepts only one of the before or after options."),t=Ja(e,t);let o=[...Ja(e,s?r:i).keys()],a=s?o[0]:o.pop(),h=new Map;return e.columnNames().forEach(p=>{let g=!t.has(p);if(p===a){n&&g&&h.set(p,p);for(let[v,T]of t)h.set(v,T);if(n)return}g&&h.set(p,p)}),Eb(e,h)}function sd(e,t=i=>i,r=""){let i=e.length;if(!i)return"";let s=t(e[0],0);for(let n=1;n<i;++n)s+=r+t(e[n],n);return s}function Ib(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Aut(e,t=0,r=e.length){let i=r?e[t++]:Wi;for(let s=t;s<r;++s)i>e[s]&&(i=e[s]);return i}function gut(e,t=0,r=e.length){let i=r?e[t++]:Wi;for(let s=t;s<r;++s)i<e[s]&&(i=e[s]);return i}function g4(e){return g0(e)?e:+e}function Sz(e,t){let r=e.length;if(!r)return Wi;if((t=+t)<=0||r<2)return g4(e[0]);if(t>=1)return g4(e[r-1]);let i=(r-1)*t,s=Math.floor(i),n=g4(e[s]);return g0(n)?n:n+(g4(e[s+1])-n)*(i-s)}var _4=class{constructor(t){this._values=t||[],this._sorted=null,this._start=0}values(t){return this._start&&(this._values=this._values.slice(this._start),this._start=0),t?this._values.slice():this._values}add(t){this._values.push(t),this._sorted=null}rem(){this._start+=1,this._sorted=null}min(){return this._sorted&&this._sorted.length?this._sorted[0]:Aut(this._values,this._start)}max(){return this._sorted&&this._sorted.length?this._sorted[this._sorted.length-1]:gut(this._values,this._start)}quantile(t){return this._sorted||(this._sorted=this.values(!0),this._sorted.sort(Ib)),Sz(this._sorted,t)}};var BP=(e,t,r)=>qc(t,"{"+sd(e,(i,s)=>`_${s}.${r}(${t});`)+"}",e);function _ut(e,t){let{ops:r,output:i}=D8t(e,t),s=e[0].fields,n=s.length,o=n===0?y4:n===1?Ez:n===2?Iz:sr("Unsupported field count: "+n);return new o(s,r,i,t)}function D8t(e,t){let r={},i=[];function s(o,a=[]){let h=o+":"+a;if(r[h])return r[h];let p=PC(o),g=p.create(...a);return t<0&&p.stream&&p.stream.forEach(v=>s(v,[])),p.req&&p.req.forEach(v=>s(v,[])),r[h]=g,i.push(g),g}let n=e.map(o=>{let a=s(o.name,o.params);return a.output=o.id,a});return{ops:i,output:n}}var y4=class extends V_{constructor(t,r,i,s){super(i),this._op=r,this._fields=t,this._stream=!!s}init(){let t={count:0,valid:0,stream:this._stream};return this._op.forEach(r=>r.init(t)),t.values&&(t.list=new _4),t}write(t,r,i){let s=this._outputs,n=s.length;for(let o=0;o<n;++o)r[s[o].output][i]=s[o].value(t);return 1}_add(){}_rem(){}add(t){++t.count}rem(t){--t.count}},Ez=class extends y4{constructor(t,r,i,s){super(t,r,i,s);let n=["state","v1","v2"];this._add=BP(r,n,"add"),this._rem=BP(r,n,"rem")}add(t,r,i){let s=this._fields[0](r,i);++t.count,Xa(s)&&(++t.valid,t.list&&t.list.add(s),this._add(t,s))}rem(t,r,i){let s=this._fields[0](r,i);--t.count,Xa(s)&&(--t.valid,t.list&&t.list.rem(),this._rem(t,s))}},Iz=class extends y4{constructor(t,r,i,s){super(t,r,i,s);let n=["state","v1","v2"];this._add=BP(r,n,"add"),this._rem=BP(r,n,"rem")}add(t,r,i){let s=this._fields[0](r,i),n=this._fields[1](r,i);++t.count,Xa(s)&&Xa(n)&&(++t.valid,t.list&&t.list.add([s,n]),this._add(t,s,n))}rem(t,r,i){let s=this._fields[0](r,i),n=this._fields[1](r,i);--t.count,Xa(s)&&Xa(n)&&(--t.valid,t.list&&t.list.rem(),this._rem(t,s,n))}};function Yc(e,t,r){if(t.length){let i=e.data(),{keys:s}=e.groups()||{},n=od(e,t),o=s?(a,h)=>n[a][s[h]]:a=>n[a][0];r=r.map(a=>h=>a(h,i,o))}return r}function od(e,t,r){if(!t.length)return r;let i=Mz(t),s=e.groups(),n=s?s.size:1;return r=r||fh(t.length,()=>Array(n)),n>1?i.forEach(o=>{let a=Pz(e,o,s);for(let h=0;h<n;++h)o.write(a[h],r,h)}):i.forEach(o=>{let a=Cz(e,o);o.write(a,r,0)}),r}function Mz(e,t){let r=[],i={};for(let s of e){let n=s.fields.map(o=>o+"").join(",");(i[n]||(i[n]=[])).push(s)}for(let s in i)r.push(_ut(i[s],t));return r}function Cz(e,t){let r=t.init(),i=e.totalRows(),s=e.data(),n=e.mask();if(e.isOrdered()){let o=e.indices();for(let a=0;a<i;++a)t.add(r,o[a],s)}else if(n)for(let o=n.next(0);o>=0;o=n.next(o+1))t.add(r,o,s);else for(let o=0;o<i;++o)t.add(r,o,s);return r}function Pz(e,t,r){let{keys:i,size:s}=r,n=fh(s,()=>t.init()),o=e.data();if(e.isOrdered()){let a=e.indices(),h=a.length;for(let p=0;p<h;++p){let g=a[p];t.add(n[i[g]],g,o)}}else if(e.isFiltered()){let a=e.mask();for(let h=a.next(0);h>=0;h=a.next(h+1))t.add(n[i[h]],h,o)}else{let a=e.totalRows();for(let h=0;h<a;++h)t.add(n[i[h]],h,o)}return n}function NP(e,t){let{get:r,names:i,rows:s,size:n}=t,o=i.length;for(let a=0;a<o;++a){let h=e.add(i[a],Array(n)),p=r[a];for(let g=0;g<n;++g)h[g]=p(s[g])}}function LP(e){return{left(t,r,i,s){for(i==null&&(i=0),s==null&&(s=t.length);i<s;){let n=i+s>>>1;e(t[n],r)<0?i=n+1:s=n}return i},right(t,r,i,s){for(i==null&&(i=0),s==null&&(s=t.length);i<s;){let n=i+s>>>1;e(t[n],r)>0?s=n:i=n+1}return i}}}var yut=LP(Ib);function xut(e,t,r,i,s){let n,o,a,h,p,g=L=>o[L-1]===o[L],v=i.length,T=s.length,C=i.length?qc(["w","r","k"],"{"+sd(i,(L,z)=>`r[_${z}.id][k]=_${z}.value(w,_${z}.get);`)+"}",i):()=>{},B={i0:0,i1:0,index:0,size:0,peer:g,init(L,z,W,Z){B.index=B.i0=B.i1=0,B.size=z.length,n=L,o=z,h=W,p=Z,a=s?s.map(X=>X.init()):null;for(let X=0;X<v;++X)i[X].init();return B},value(L,z){return z(n[L],e)},step(L){let[z,W]=t,Z=B.size,X=B.i0,q=B.i1;B.i0=z!=null?Math.max(0,L-Math.abs(z)):0,B.i1=W!=null?Math.min(Z,L+Math.abs(W)+1):Z,B.index=L,r&&(B.i0>0&&g(B.i0)&&(B.i0=yut.left(o,o[B.i0])),B.i1<Z&&g(B.i1)&&(B.i1=yut.right(o,o[B.i1-1])));for(let it=0;it<T;++it){let nt=s[it],Mt=a[it];for(let _t=X;_t<B.i0;++_t)nt.rem(Mt,n[_t],e);for(let _t=q;_t<B.i1;++_t)nt.add(Mt,n[_t],e);nt.write(Mt,h,p)}return C(B,h,p),h}};return B}var O8t=e=>(e.frame||[null,null]).map(t=>Number.isFinite(t)?Math.abs(t):null),B8t=e=>!!e.peers;function N8t(e){let{id:t,name:r,fields:i=[],params:s=[]}=e,n=RC(r).create(...s);return i.length&&(n.get=i[0]),n.id=t,n}function but(e,t,r,i={},s){let n=e.data(),o=L8t(s,n),a=o.length,h=qc(["r","d","op"],"{"+sd(t,(p,g)=>`_${g}[r] = $${g}(r, d, op);`)+"}",t,r);e.partitions().forEach((p,g)=>{let v=p.length,T=F8t(e,p);for(let B=0;B<a;++B)o[B].init(p,T,i,g);let C=B=>i[B][g];for(let B=0;B<v;++B){for(let L=0;L<a;++L)o[L].step(B);h(p[B],n,C)}})}function L8t(e,t){let r={};return e.forEach(i=>{let s=O8t(i),n=B8t(i),o=`${s},${n}`,{aggOps:a,winOps:h}=r[o]||(r[o]={frame:s,peers:n,aggOps:[],winOps:[]});rS(i.name)?a.push(i):h.push(N8t(i))}),Object.values(r).map(i=>xut(t,i.frame,i.peers,i.winOps,Mz(i.aggOps,i.frame[0]!=null?-1:1)))}function F8t(e,t){if(e.isOrdered()){let r=e.comparator(),i=e.data(),s=t.length,n=new Uint32Array(s);for(let o=1,a=0;o<s;++o)n[o]=r(t[o-1],t[o],i)?++a:a;return n}else return t}function z8t(e){return iS(e.name)||e.frame&&(Number.isFinite(e.frame[0])||Number.isFinite(e.frame[1]))}function Mb(e,{names:t,exprs:r,ops:i},s={}){let n=e.totalRows(),o=ys(s.drop?null:e),a=t.map(T=>o.add(T,Array(n))),[h,p]=U8t(i),g=e.isGrouped()?e.groups().size:1,v=od(e,h,fh(i.length,()=>Array(g)));return p.length?but(e,a,r,v,p):V8t(e,a,r,v),e.create(o)}function U8t(e){let t=[],r=[],i=e.length;for(let s=0;s<i;++s){let n=e[s];n.id=s,(z8t(n)?r:t).push(n)}return[t,r]}function V8t(e,t,r,i){let s=e.mask(),n=e.data(),{keys:o}=e.groups()||{},a=o?(p,g)=>i[p][o[g]]:p=>i[p][0],h=t.length;for(let p=0;p<h;++p){let g=r[p],v=t[p];if(s)for(let T=s.next(0);T>=0;T=s.next(T+1))v[T]=g(T,n,a);else{let T=e.totalRows();for(let C=0;C<T;++C)v[C]=g(C,n,a)}}}function vut(e,t,r={}){let i=Mb(e,xs(t,{table:e}),r);return r.drop||r.before==null&&r.after==null?i:OP(i,Object.keys(t).filter(s=>!e.column(s)),r)}function wut(e,t){if(t.length===0)return e;let r=e.columnNames();return t.reduce((i,s)=>i.antijoin(s.select(r)),e).dedupe()}var H_=class{constructor(t){this._size=t,this._bits=new Uint32Array(Math.ceil(t/32))}get length(){return this._size}count(){let t=this._bits.length,r=0;for(let i=0;i<t;++i)for(let s=this._bits[i];s;++r)s&=s-1;return r}get(t){return this._bits[t>>5]&2147483648>>>t}set(t){this._bits[t>>5]|=2147483648>>>t}clear(t){this._bits[t>>5]&=~(2147483648>>>t)}scan(t){for(let r=this.next(0);r>=0;r=this.next(r+1))t(r)}next(t){let r=this._bits,i=r.length,s=t>>5,n=r[s]&4294967295>>>t;for(;s<i;n=r[++s])if(n!==0)return(s<<5)+Math.clz32(n);return-1}nth(t){let r=this.next(0);for(;t--&&r>=0;)r=this.next(r+1);return r}not(){let t=this._bits,r=t.length;for(let s=0;s<r;++s)t[s]=~t[s];let i=this._size%32;return i&&(t[r-1]&=2147483648>>i-1),this}and(t){if(t){let r=this._bits,i=t._bits,s=r.length;for(let n=0;n<s;++n)r[n]&=i[n]}return this}or(t){if(t){let r=this._bits,i=t._bits,s=r.length;for(let n=0;n<s;++n)r[n]|=i[n]}return this}};function Tut(e,t){let r=e.totalRows(),i=e.mask(),s=e.data(),n=new H_(r);if(i)for(let o=i.next(0);o>=0;o=i.next(o+1))t(o,s)&&n.set(o);else for(let o=0;o<r;++o)t(o,s)&&n.set(o);return e.create({filter:n})}function Sut(e,t){let r=xs({p:t},{table:e}),i=r.exprs[0];if(r.ops.length){let{data:s}=Mb(e,r,{drop:!0}).column("p");i=n=>s[n]}return Tut(e,i)}function FP(e,{names:t=[],exprs:r=[],ops:i=[]},s={}){if(!t.length)return e;let n=s.limit>0?+s.limit:1/0,o=s.index?s.index===!0?"index":s.index+"":null,a=new Set(s.drop),h=Yc(e,i,r),p=ys(),g=new Set(t),v=[],T=[],C=[];e.columnNames().forEach(q=>{if(!a.has(q)){let it=p.add(q,[]);g.has(q)||(v.push(e.column(q)),T.push(it))}}),t.forEach(q=>{a.has(q)||(p.has(q)||p.add(q,[]),C.push(p.data[q]))});let B=o?p.add(o,[]):null,L=0,z=v.length,W=C.length,Z=(q,it)=>{for(let nt=0;nt<z;++nt)T[nt].length=L+it,T[nt].fill(v[nt].get(q),L,L+it)},X=B?(q,it)=>{for(let nt=0;nt<it;++nt)B[q+nt]=nt}:()=>{};if(W===1){let q=h[0],it=C[0];e.scan((nt,Mt)=>{let _t=Hs(q(nt,Mt)),Et=Math.min(_t.length,n);Z(nt,Et);for(let vt=0;vt<Et;++vt)it[L+vt]=_t[vt];X(L,Et),L+=Et})}else e.scan((q,it)=>{let nt=0,Mt=h.map(_t=>{let Et=Hs(_t(q,it));return nt=Math.min(Math.max(nt,Et.length),n),Et});Z(q,nt);for(let _t=0;_t<W;++_t){let Et=C[_t],vt=Mt[_t];for(let Pt=0;Pt<nt;++Pt)Et[L+Pt]=vt[Pt]}X(L,nt),L+=nt});return e.create(p.new())}function Eut(e,{names:t=[],exprs:r=[],ops:i=[]},s={}){if(t.length===0)return e;let[n="key",o="value"]=s.as||[],a=Yc(e,i,r);return FP(e,{names:[n,o],exprs:[()=>t,(h,p)=>a.map(g=>g(h,p))]},{...s,drop:t})}function aa(e,t,r,i={window:!1}){let s=new Map,n=o=>{o=qs(o)?t.columnName(o):o,Ln(o)?s.set(o,Cu(o)):Li(o)?Ja(t,o).forEach(n):_s(o)?aP(s,o):sr(`Invalid ${e} value: ${o+""}`)};return Hs(r).forEach(n),i.preparse&&i.preparse(s),xs(s,{table:t,...i})}function Iut(e,t,r){return Eut(e,aa("fold",e,t),r)}function Rz(e,t,r,i){let s=r&&r.length;return j8t(s?W8t(e,r,i):e,t,s)}function j8t(e,{names:t,exprs:r,ops:i},s){let n=Yc(e,i,r),o=s?null:ys(e),a=e.totalRows();return t.forEach((h,p)=>{let g=e.column(h),v=s?g.data:o.add(h,Array(a)),T=n[p];e.scan(C=>{let B=g.get(C);v[C]=Xa(B)?B:T(C)})}),s?e:e.create(o)}function W8t(e,t,r){let i=e.groups(),s=e.data(),n=(i?i.names:[]).concat(t),o=(i?i.get:[]).concat(t.map(B=>e.getter(B))),a=new Set,h=y_(o);e.scan((B,L)=>a.add(h(B,L)));let p=e.columnNames(),g=ys(),v=p.map(B=>g.add(B,[]));p.forEach((B,L)=>{let z=s[B],W=v[L];e.scan(Z=>W.push(z.get(Z)))});let T=y_(o.map((B,L)=>z=>z[L])),C=qc("v","{"+v.map((B,L)=>`_${L}.push(v[$${L}]);`).join("")+"}",v,p.map(B=>n.indexOf(B)));if(i){let B=i.keys.length,L=r.reduce((W,Z)=>W*Z.length,i.size),z=new Uint32Array(L+(B-a.size));z.set(i.keys),Mut(i,r,(W,Z)=>{a.has(T(W))||(C(W),z[B++]=Z[0])}),g.groupby({...i,keys:z})}else Mut(i,r,B=>{a.has(T(B))||C(B)});return e.create(g.new())}function Mut(e,t,r){let i=e?e.get.length:0,s=e?1:0,n=s+t.length,o=new Int32Array(n),a=new Int32Array(n),h=[];if(e){let{get:g,rows:v,size:T}=e;o[0]=T,h.push((C,B)=>{let L=v[B];for(let z=0;z<i;++z)C[z]=g[z](L)})}t.forEach((g,v)=>{let T=v+i;o[v+s]=g.length,h.push((C,B)=>C[T]=g[B])});let p=Array(i+t.length);for(let g=0;g<n;++g)h[g](p,0);r(p,a);for(let g=n-1;g>=0;){let v=++a[g];v<o[g]?(h[g](p,v),r(p,a),g=n-1):(a[g]=0,h[g](p,0),--g)}}function Cb(e,{names:t,exprs:r,ops:i}){let s=ys(),n=e.groups();return n&&NP(s,n),$8t(t,r,n,od(e,i),s),e.create(s.new())}function $8t(e,t,r,i=[],s){if(!t.length)return;let n=r?r.size:1,o=(h,p)=>i[h][p],a=e.length;for(let h=0;h<a;++h){let p=t[h];if(p.field!=null)s.add(e[h],i[p.field]);else if(n>1){let g=s.add(e[h],Array(n));for(let v=0;v<n;++v)g[v]=p(v,null,o)}else s.add(e[h],[p(0,null,o)])}}function Cut(e,t,r={}){if(t=xs(t,{table:e}),t.names.forEach(i=>e.column(i)?0:sr(`Invalid impute column ${Ls(i)}`)),r.expand){let i={preparse:H8t,aggronly:!0},s=aa("impute",e,r.expand,i),n=Cb(e.ungroup(),s);return Rz(e,t,s.names,s.names.map(o=>n.get(o,0)))}else return Rz(e,t)}function H8t(e){e.forEach((t,r)=>t.field?e.set(r,OL(t+"")):0)}function Put(e,t){let r=e.columnNames();return t.length?t.reduce((i,s)=>i.semijoin(s.select(r)),e).dedupe():e.reify([])}function zP(e,t){let r=new Map;return e.scan((i,s)=>{let n=t(i,s);n!=null&&n===n&&r.set(n,i)}),r}function Rut(e,t,r){let i=new Map,s=e.length;for(let n=0;n<s;++n){let o=e[n],a=r(o,t);a!=null&&a===a&&(i.has(a)?i.get(a).push(n):i.set(a,[n]))}return i}function q8t(e,t){let r=["i","a","j","b"];return qc(r,"{"+sd(e,(i,s)=>`_${s}.push($${s}(${r}));`)+"}",e,t)}function kut(e,t,r,{names:i,exprs:s},n={}){let o=e.data(),a=e.indices(!1),h=a.length,p=new Int32Array(h),g=t.data(),v=t.indices(!1),T=v.length,C=new Int32Array(T),B=i.length,L=ys(),z=Array(B),W=Array(B);for(let q=0;q<i.length;++q)z[q]=L.add(i[q],[]),W[q]=s[q];let Z=q8t(z,W);if((li(r)?X8t:Y8t)(Z,r,o,g,a,v,p,C,h,T),n.left)for(let q=0;q<h;++q)p[q]||Z(a[q],o,-1,g);if(n.right)for(let q=0;q<T;++q)C[q]||Z(-1,o,v[q],g);return e.create(L.new())}function Y8t(e,t,r,i,s,n,o,a,h,p){for(let g=0;g<h;++g){let v=s[g];for(let T=0;T<p;++T){let C=n[T];t(v,r,C,i)&&(e(v,r,C,i),o[g]=1,a[T]=1)}}}function X8t(e,[t,r],i,s,n,o,a,h,p,g){let v,T,C,B,L,z,W,Z,X=e;p>=g?(v=i,T=t,C=a,B=n,L=s,z=r,W=h,Z=o):(v=s,T=r,C=h,B=o,L=i,z=t,W=a,Z=n,X=(nt,Mt,_t,Et)=>e(_t,Et,nt,Mt));let q=Rut(Z,L,z),it=B.length;for(let nt=0;nt<it;++nt){let Mt=B[nt],_t=q.get(T(Mt,v));if(_t){let Et=_t.length;for(let vt=0;vt<Et;++vt){let Pt=_t[vt];X(Mt,v,Z[Pt],L),W[Pt]=1}C[nt]=1}}}function Pb(e,t,r){let i=new Map;Hs(r).forEach((n,o)=>{n=qs(n)?t.columnName(n):n,Ln(n)?i.set(o,Cu(n)):Li(n)||_s(n)&&n.expr?i.set(o,n):sr(`Invalid ${e} key value: ${n+""}`)});let s=xs(i,{table:t,aggregate:!1,window:!1});return y_(s.exprs,!0)}function kz(e,t){let r=new Set(t);return e.filter(i=>r.has(i))}function Rb(e,t,r){if(r)Ln(r)?r=[r,r]:li(r)&&r.length===1&&(r=[r[0],r[0]]);else{let i=kz(e.columnNames(),t.columnNames());i.length||sr("Natural join requires shared column names."),r=[i,i]}return r}function UP(e,t,r,i){return r.length!==i.length&&sr("Mismatched number of join keys"),[Pb("join",e,r),Pb("join",t,i)]}var Z8t={aggregate:!1,window:!1},G8t={...Z8t,index:1};function Dz(e,t,r,i,s={}){r=Rb(e,t,r);let n={join:[e,t]},o;if(li(r)){let[a,h]=r.map(Hs);o=UP(e,t,a,h),i||(i=Q8t(e,a,h,s))}else o=xs({on:r},n).exprs[0],i||(i=[Iu(),Iu()]);return kut(e,t,o,K8t(e,t,i,n,s&&s.suffix),s)}function Q8t(e,t,r,i){let s=[];t.forEach((o,a)=>Ln(o)&&o===r[a]?s.push(o):0);let n=Ab(s);if(i.left&&i.right){let o=new Set(s);return[e.columnNames().map(a=>{let h=`[${Ls(a)}]`;return o.has(a)?{[a]:`(a, b) => a${h} == null ? b${h} : a${h}`}:a}),n]}return i.right?[n,Iu()]:[Iu(),n]}function K8t(e,t,r,i,s=[]){if(li(r)){let n,o,a,h=r.length;n=o=a={names:[],exprs:[]},h--&&(n=aa("join",e,r[0],i)),h--&&(o=aa("join",t,r[1],G8t)),h--&&(a=xs(r[2],i));let p=new Set,g=new Set(n.names);return o.names.forEach(v=>{g.has(v)&&p.add(v)}),p.size&&(s[0]!==""&&Dut(n.names,p,s[0]||"_1"),s[1]!==""&&Dut(o.names,p,s[1]||"_2")),{names:n.names.concat(o.names,a.names),exprs:n.exprs.concat(o.exprs,a.exprs)}}else return xs(r,i)}function Dut(e,t,r){e.forEach((i,s)=>t.has(i)?e[s]=i+r:0)}function Out(e,t,r,i={}){let s=new H_(e.totalRows());return(li(r)?J8t:tPt)(s,e,t,r),i.anti&&s.not().and(e.mask()),e.create({filter:s})}function J8t(e,t,r,[i,s]){let n=zP(r,s);t.scan((o,a)=>{n.get(i(o,a))>=0&&e.set(o)})}function tPt(e,t,r,i){let s=t.numRows(),n=r.numRows(),o=t.data(),a=r.data();if(t.isFiltered()||r.isFiltered()){let h=t.indices(!1),p=r.indices(!1);for(let g=0;g<s;++g){let v=h[g];for(let T=0;T<n;++T)if(i(v,o,p[T],a)){e.set(v);break}}}else for(let h=0;h<s;++h)for(let p=0;p<n;++p)if(i(h,o,p,a)){e.set(h);break}}function Oz(e,t,r,i){r=Rb(e,t,r);let s=li(r)?UP(e,t,...r.map(Hs)):xs({on:r},{join:[e,t]}).exprs[0];return Out(e,t,s,i)}function But(e,t,[r,i],{names:s,exprs:n,ops:o}){let a=ys(e),h=e.totalRows();s.forEach(T=>a.add(T,Array(h).fill(Wi)));let p=zP(t,i),g=qc(["lr","rr","data"],"{"+sd(s,(T,C)=>`_[${C}][lr] = $[${C}](rr, data);`)+"}",s.map(T=>a.data[T]),Yc(t,o,n)),v=t.data();return e.scan((T,C)=>{let B=p.get(r(T,C));B>=0&&g(T,B,v)}),e.create(a)}function Nut(e,t,r,i){return r=Rb(e,t,r),But(e,t,[Pb("lookup",e,r[0]),Pb("lookup",t,r[1])],aa("lookup",t,i))}var Bz=(e,t)=>e??t;function Lut(e,t,r,i={}){let{keys:s,keyColumn:n}=ePt(e,t,i),o=Bz(i.valueSeparator,"_"),a=r.names.length>1?(p,g)=>g+o+s[p]:p=>s[p],h=s.map(p=>od(e,r.ops.map(g=>{if(g.name==="count"){let T=C=>p===n[C]?1:NaN;return T.toString=()=>p+":1",{...g,name:"sum",fields:[T]}}let v=g.fields.map(T=>{let C=(B,L)=>p===n[B]?T(B,L):NaN;return C.toString=()=>p+":"+T,C});return{...g,fields:v}})));return e.create(rPt(r,a,e.groups(),h))}function ePt(e,t,r){let i=r.limit>0?+r.limit:1/0,s=Bz(r.sort,!0),n=Bz(r.keySeparator,"_"),o=Yc(e,t.ops,t.exprs),a=o.length===1?o[0]:(v,T)=>o.map(C=>C(v,T)).join(n),h=Array(e.totalRows());e.scan((v,T)=>h[v]=a(v,T));let p=od(e.ungroup(),[{id:0,name:"array_agg_distinct",fields:[v=>h[v]],params:[]}])[0][0],g=s?p.sort():p;return{keys:Number.isFinite(i)?g.slice(0,i):g,keyColumn:h}}function rPt({names:e,exprs:t},r,i,s){let n=i?i.size:1,o=ys(),a=s.length,h=e.length,p,g=(v,T)=>p[v][T];i&&NP(o,i);for(let v=0;v<h;++v){let T=t[v];if(T.field!=null)for(let C=0;C<a;++C)o.add(r(C,e[v]),s[C][T.field]);else if(n>1)for(let C=0;C<a;++C){p=s[C];let B=o.add(r(C,e[v]),Array(n));for(let L=0;L<n;++L)B[L]=T(L,null,g)}else for(let C=0;C<a;++C)p=s[C],o.add(r(C,e[v]),[T(0,null,g)])}return o.new()}function Fut(e,t,r,i){return Lut(e,aa("fold",e,t),aa("fold",e,r,{preparse:iPt,aggronly:!0}),i)}function iPt(e){e.forEach((t,r)=>t.field?e.set(r,RL(t+"")):0)}function zut(e,t){let r=new Map;return e.columnNames(i=>(r.set(i,i),0)),Eb(e,Ja(e,t,r))}function Nz(e,t){return Cb(e,xs(t,{table:e,aggronly:!0,window:!1}))}function Uut(e,t,r,i){return(t?i?sPt:nPt:i?aPt:oPt)(e.length,e,r,i)}function nPt(e,t,r){let i=r.length;for(let s=0;s<e;++s)t[s]=r[i*A0()|0];return t}function sPt(e,t,r,i){let s=r.length,n=new Float64Array(s),o=0;for(let h=0;h<s;++h)n[h]=o+=i(r[h]);let a=LP(Ib).right;for(let h=0;h<e;++h)t[h]=r[a(n,o*A0())];return t}function oPt(e,t,r){let i=r.length;if(e>=i)return r;for(let s=0;s<e;++s)t[s]=r[s];for(let s=e;s<i;++s){let n=s*A0();n<e&&(t[n|0]=r[s])}return t}function aPt(e,t,r,i){let s=r.length;if(e>=s)return r;let n=new Float32Array(s),o=new Uint32Array(s);for(let a=0;a<s;++a)o[a]=a,n[a]=-Math.log(A0())/i(r[a]);o.sort((a,h)=>n[a]-n[h]);for(let a=0;a<e;++a)t[a]=r[o[a]];return t}function Vut(e,t=0,r=e.length){let i=r-(t=+t);for(;i;){let s=A0()*i--|0,n=e[i+t];e[i+t]=e[s+t],e[s+t]=n}return e}function jut(e,t,r,i={}){let{replace:s,shuffle:n}=i,o=e.partitions(!1),a=0;t=o.map((g,v)=>{let T=t(v);return a+=T=s?T:Math.min(g.length,T),T});let h=new Uint32Array(a),p=0;return o.forEach((g,v)=>{let T=t[v],C=h.subarray(p,p+=T);!s&&T===g.length?C.set(g):Uut(C,s,g,r)}),n!==!1&&(o.length>1||!s)&&Vut(h),e.reify(h)}function Wut(e,t,r={}){return jut(e,lPt(e,t),cPt(e,r.weight),r)}var $ut=e=>t=>e.get(t)||0;function lPt(e,t){return qs(t)?()=>t:$ut(Cb(e,xs({size:t},{table:e,window:!1})).column("size"))}function cPt(e,t){return t==null?null:(t=qs(t)?e.columnName(t):t,$ut(Ln(t)?e.column(t):Mb(e,xs({w:t},{table:e}),{drop:!0}).column("w")))}function Hut(e,t){return Eb(e,Ja(e,t))}function qut(e,{names:t,exprs:r,ops:i=[]},s={}){if(t.length===0)return e;let n=t.length===1&&s.as||[],o=s.drop==null?!0:!!s.drop,a=s.limit==null?n.length||1/0:Math.max(1,+s.limit||1),h=Yc(e,i,r),p=ys(),g=t.reduce((T,C,B)=>T.set(C,B),new Map),v=(T,C)=>{let B=uPt(e,h[T],a),L=B.length;for(let z=0;z<L;++z)p.add(n[z]||`${C}_${z+1}`,B[z])};return e.columnNames().forEach(T=>{g.has(T)?(o||p.add(T,e.column(T)),v(g.get(T),T),g.delete(T)):p.add(T,e.column(T))}),g.forEach(v),e.create(p)}function uPt(e,t,r){let i=e.totalRows(),s=[];return e.scan((n,o)=>{let a=Hs(t(n,o)),h=Math.min(a.length,r);for(;s.length<h;)s.push(Array(i).fill(Wi));for(let p=0;p<h;++p)s[p][n]=a[p]}),s}function Yut(e,t,r){return qut(e,aa("spread",e,t),r)}function Xut(e,t){return e.concat(t).dedupe()}function Zut(e,t,r){return FP(e,aa("unroll",e,t),r&&r.drop?{...r,drop:aa("unroll",e,r.drop).names}:r)}function Gut(e,t){return e.create({groups:hPt(e,t)})}function hPt(e,{names:t=[],exprs:r=[],ops:i=[]}){let s=t.length;if(s===0)return null;if(s===1&&!e.isFiltered()&&r[0].field){let C=e.column(r[0].field);if(C.groups)return C.groups(t)}let n=Yc(e,i,r),o=y_(n),a=e.totalRows(),h=new Uint32Array(a),p={},g=[],v=e.data(),T=e.mask();if(T)for(let C=T.next(0);C>=0;C=T.next(C+1)){let B=o(C,v)+"",L=p[B];h[C]=L??(p[B]=g.push(C)-1)}else for(let C=0;C<a;++C){let B=o(C,v)+"",L=p[B];h[C]=L??(p[B]=g.push(C)-1)}return i.length||(n=n.map(C=>B=>C(B,v))),{keys:h,get:n,names:t,rows:g,size:g.length}}function Qut(e,t){return Gut(e,aa("groupby",e,t))}function Kut(e,t){return e.create({order:t})}var fPt=(e,t,r,i)=>`((u = ${e}) < (v = ${t}) || u == null) && v != null ? ${r}
    : (u > v || v == null) && u != null ? ${i}
    : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? ${r}
    : v !== v && u === u ? ${i} : `;function Jut(e,t){let r=[],i=[],s=[],n=null,o="0",a="0";e.isGrouped()&&(n=e.groups().keys,o="ka",a="kb");let{ops:h}=xs(t,{table:e,value:(C,B)=>{if(r.push(C),B.escape){let L=z=>`fn[${s.length}](${z}, data)`;i.push([L("a"),L("b")]),s.push(B.escape)}else i.push([g_(B,{index:"a",op:o}),g_(B,{index:"b",op:a})])},window:!1}),p=od(e,h),g=(C,B)=>p[C][B],v=r.length,T="return (a, b) => {"+(g&&e.isGrouped()?"const ka = keys[a], kb = keys[b];":"")+"let u, v; return ";for(let C=0;C<v;++C){let B=t.get(r[C]).desc?-1:1,[L,z]=i[C];T+=fPt(L,z,-B,B)}return T+="0;};",Function("op","keys","fn","data",T)(g,n,s,e.data())}function tht(e,t){return Kut(e,pPt(e,t))}function pPt(e,t){let r=-1,i=new Map,s=n=>i.set(++r+"",n);return t.forEach(n=>{let o=n.expr!=null?n.expr:n;if(_s(o)&&!Li(o))for(let a in o)s(o[a]);else s(qs(o)?Cu(n,e.columnName(o)):Ln(o)?Cu(n):Li(o)?n:sr(`Invalid orderby field: ${n+""}`))}),Jut(e,i)}function eht(e,t){let r=e.numRows(),i=r+t.reduce((o,a)=>o+a.numRows(),0);if(r===i)return e;let s=[e,...t],n=ys();return e.columnNames().forEach(o=>{let a=Array(i),h=0;s.forEach(p=>{let g=p.column(o)||{get:()=>Wi};p.scan(v=>a[h++]=g.get(v))}),n.add(o,a)}),e.create(n.new())}function rht(e,t){let r=ys(),i=e.groups(),{get:s,names:n=[],rows:o,size:a=1}=i||{},h=new Uint32Array(a+1);n.forEach(T=>r.add(T,null));let p=i?Pz(e,t,i):[Cz(e,t)];t.outputs().map(T=>r.add(T,[]));let g=h.length-1,v=0;for(let T=0;T<g;++T)v+=h[T+1]=t.write(p[T],r.data,h[T]);if(i){let T=e.data();n.forEach((C,B)=>{let L=r.data[C]=Array(v),z=s[B];for(let W=0,Z=0;W<a;++W)L.fill(z(o[W],T),Z,Z+=h[W+1])})}return e.create(r.new())}function iht(e){return e.isGrouped()?e.create({groups:null}):e}function nht(e){return e.isOrdered()?e.create({order:null}):e}var sht={__antijoin:(e,t,r)=>Oz(e,t,r,{anti:!0}),__count:(e,t={})=>Nz(e,{[t.as||"count"]:kL()}),__cross:(e,t,r,i)=>Dz(e,t,()=>!0,r,{...i,left:!0,right:!0}),__concat:eht,__dedupe:mut,__derive:vut,__except:wut,__filter:Sut,__fold:Iut,__impute:Cut,__intersect:Put,__join:Dz,__lookup:Nut,__pivot:Fut,__relocate:OP,__rename:zut,__rollup:Nz,__sample:Wut,__select:Hut,__semijoin:Oz,__spread:Yut,__union:Xut,__unroll:Zut,__groupby:Qut,__orderby:tht,__ungroup:iht,__unorder:nht,__reduce:rht};Object.assign(tl.prototype,sht);function Lz(e,t){return tl.new(e,t)}function x4(e,t){return tl.from(e,t)}function kb(e,t={}){let r=t.using||A4;return fetch(e,t.fetch).then(i=>i[t.as||"text"]()).then(i=>r(i,t))}function VP(e,t){return kb(e,{...t,as:"arrayBuffer",using:MP})}function oht(e,t){return kb(e,{...t,as:"text",using:A4})}function aht(e,t){return kb(e,{...t,as:"text",using:kP})}function lht(e,t){return kb(e,{...t,as:"json",using:dPt})}function dPt(e,t){return li(e)?x4(e):DP(e,t)}function cht(e,t={}){let r=`d[${JSON.stringify(e)}]`,{maxbins:i,nice:s,minstep:n,step:o,offset:a}=t,h=[i,s,n,o],p=h.length;for(;p&&h[--p]==null;)h.pop();let g=h.length?", "+h.map(v=>v+"").join(", "):"";return`d => op.bin(${r}, ...op.bins(${r}${g}), ${a||0})`}function uht(e){return jA(e,{escape:!0,toString(){sr("Escaped values can not be serialized.")}})}function hht(e){return`() => op.round(${+e} * op.count())`}function fht(...e){return e=e.flat(),t=>{let r=new Map,i=Math.min(e.length,t.numCols());for(let s=0;s<i;++s)r.set(t.columnName(s),e[s]);return r}}function Fz(e,t){return e.ungroup().rollup({_:t}).get("_")}var dht=(e,t)=>sr(`Illegal ${t} name: ${Ls(e)}`),mPt=(e,t)=>sr(`The ${t} ${Ls(e)} is already defined. Use override option?`),mht=(e,t)=>sr(`The ${t} name ${Ls(e)} is reserved and can not be overridden.`);function Aht(e,t,r=Np,i="function"){e||dht(e,i),!t.override&&Ea(r,e)&&mPt(e,i)}function b4(e,t,r,i){return r[e]===t||Aht(e,i)}function ght(e,t,r,i={}){if(b4(e,t,r,i))return;let[s=0,n=0]=t.param;r[e]=t,Np[e]=(...o)=>Ri(e,o.slice(0,s),o.slice(s,s+n))}function _ht(e,t,r){ght(e,t,Rx,r)}function yht(e,t,r){ght(e,t,kx,r)}function xht(e,t,r={}){arguments.length===1&&(t=e,e=t.name,e===""||e==="anonymous"?sr("Anonymous function provided, please include a name argument."):e===Ox&&mht(Ox,"function")),!b4(e,t,gu,r)&&(gu[e]=t,Np[e]=t)}var Db=tl.prototype,jP;function pht(e){for(;e;e=Object.getPrototypeOf(e))Object.getOwnPropertyNames(e).forEach(t=>jP[t]=1)}function zz(e,t,r){let i="method";if(Db[e]&&Db[e].fn===t)return!0;jP||(jP={},pht(Db),pht(Hc.prototype)),jP[e]&&mht(e,i),(e+"")[0]==="_"&&dht(e,i),Aht(e,r,Db,i)}function Uz(e,t,r={}){zz(e,t,r)||(Db[e]=function(...i){return t(this,...i)},Db[e].fn=t)}function bht(e,t,r,i={}){Uz(e,t,i),Jct(e,$A[e]=Zn(e,r))}var APt="arquero_package";function gPt(e,t={}){let r=e&&e[APt]||e,i={functions:[(n,o,a)=>b4(n,o,gu,a),xht],aggregateFunctions:[(n,o,a)=>b4(n,o,Rx,a),_ht],windowFunctions:[(n,o,a)=>b4(n,o,kx,a),yht],tableMethods:[zz,Uz],verbs:[(n,o,a)=>zz(n,o.method,a),(n,o,a)=>bht(n,o.method,o.params,a)]};function s(n){for(let o in i){let a=i[o],h=r[o];for(let p in h)a[n](p,h[p],t)}}s(0),s(1)}var _Pt={Table:m_,ColumnTable:tl,Transformable:m0,Query:Hc,Reducer:V_,Verb:$_,Verbs:$A,columnFactory:pst,parse:xs,walk_ast:on},yPt=tut.version;var jz={x:7.27,y:43.7,z:10,...Object.fromEntries(new URLSearchParams(window.location.hash.slice(1)))},X0=new Zz.default.Map({container:"map",style:`https://api.maptiler.com/maps/toner-v2/style.json?key=${window.location.hostname=="localhost"?"Y4leWPnhJFGnTFFk1cru":"L7Sd3jHa1AR1dtyLCTgq"}`,center:[jz.x,jz.y],zoom:jz.z,maxZoom:18,minZoom:1,bearing:0,pitch:0,maxBounds:[[-45,0],[70,75]]}),Wz;async function Sht(){return Wz||(Wz=await(await fetch("data/JRC_POPULATION_2018_H3_by_rnd/meta.json")).json()),Wz}var Eht=gx(YM).domain([0,1]),xPt=e=>[...Object.values(Rc(Eht(e))).slice(0,-1),Math.sqrt(e)*255];var bPt=e=>new p1({id:"selectedHex",ish3:!0,data:e.objects(),extruded:!1,stroked:!1,getHexagon:t=>t.index,getFillColor:t=>[0,255,0,100],pickable:!0});function vPt({object:e}){let t=r=>`<div>${r[0]}: ${typeof r[1]=="number"?parseFloat(r[1].toPrecision(3)):r[1]}</div>`;return e&&{html:`${$P!==void 0?"<div>density: "+$P+" population: "+Hz+"</div>":""} ${Object.entries(e).map(t).join(" ")}`,style:{backgroundColor:"#fff",fontFamily:"sans-serif",fontSize:"0.8em",padding:"0.5em"}}}function WP(e){return parseFloat(e.toPrecision(3)).toLocaleString()}var $P,vht,Hz,v4,HP=new a2({interleaved:!1,onClick:(e,t)=>Iht(e,void 0),getTooltip:vPt});function Iht(e,t){if(v4=e??v4,e.layer!=null&&(e.layer.id==="selectedHex"&&HP.setProps({layers:[qz.filter(r=>r.id!="selectedHex")]}),e.layer.props.ish3)){let r=t??document.getElementById("desired_radius").value,i=new Set(y3(e.object.index,r).map(o=>BO(o,3))),s=Lz({index:y3(e.object.index,r)}),n=x4(Array.from(i).map(o=>Ob.get(`${fp(e.object.index)},${o}`)).flat().filter(o=>o!==void 0)).semijoin(s,"index");n=n.orderby("real_value").derive({cumsum:wb(o=>op.sum(o.real_value))}).derive({quantile:o=>o.cumsum/op.sum(o.real_value)}).derive({median_dist:o=>Np.abs(o.quantile-.5)}).orderby("median_dist"),window.dt=n,$P=n.get("real_value",0)*9/fp(n.get("index",0)),vht=n.rollup({median:o=>Np.median(o.real_value)}).get("median")*9/fp(n.get("index",0)),Hz=n.rollup({total:o=>Np.mean(o.real_value)}).get("total")*n.size*NO(fp(n.get("index",0)),"km2"),document.getElementById("results_text").innerHTML=`
            <p>Approx radius: ${WP(x3(fp(n.get("index",0)),"km")*2*r+1)} km </p>
            ${fp(n.get("index",0))==9?"":"<h3><b>Warning:</b> the numbers are broken at this zoom level, please "+(qP?"reload the page and allow high resolution data":"zoom to ~approx region level and click again")+"</h3>"}
            <p>Median population density weighted by population: <b>${WP($P)}</b> / km^2                                </p>
            <p>Median population density weighted by populated land area: <b>${WP(vht)}</b> / km^2                     </p>
            <p>Total population: <b>${WP(Hz)}</b>                                                                          </p>
            `,document.getElementById("settings").show(),HP.setProps({layers:[qz,bPt(n)]})}}X0.addControl(HP);X0.addControl(new Zz.default.NavigationControl);document.getElementById("desired_radius").addEventListener("sl-change",e=>{if(v4==null)return;let t=e.target.value;Iht(v4,t)});var qP=!1,wPt=()=>{let e,t,r=Math.floor(X0.getZoom());return r<6?(e=5,t=14):r<8?(e=9,t=2):r<100&&(e=9,t=1),qP&&(e=Math.min(e,7)),{res:e,disk:t}},TPt=new y2({id:"OpenRailwayMapLayer",data:"https://tiles.openrailwaymap.org/maxspeed/{z}/{x}/{y}.png",maxZoom:19,minZoom:0,renderSubLayers:e=>{let{boundingBox:t}=e.tile;return new l2(e,{data:null,image:e.data,bounds:[t[0][0],t[0][1],t[1][0],t[1][1]]})},pickable:!1}),wht=[],Ob=new Map,qz=[],$z=document.getElementById("zoom-in-please"),SPt=navigator.userAgent.includes("Mobi")?navigator.userAgent.includes("Safari")?12:10:2,EPt=navigator.userAgent.includes("Mobi"),Tht=!1,Gz=async()=>{if(EPt&&!Tht&&!qP&&(window.confirm("Phone detected: click 'OK' to use high resolution data (~300MB per session) or click 'cancel' to use low resolution data (~50MB per session)")||(qP=!0),Tht=!0),X0.getZoom()<SPt){try{$z.toast()}catch{$z.open=!0}return}$z.open=!1;let e=X0.getCenter(),t=_3(e.lat,e.lng,3),r=wPt(),i=y3(t,r.disk),s=await Sht(),n=[];for(let v of i)s.valid_parents[r.res].includes(v)&&n.push(v);if(wht.sort().join()==n.sort().join())return;v4=void 0;function o(v){try{return v.sort((T,C)=>S2(T,t)-S2(C,t)).slice(0,250)}catch(T){return console.warn(T),v}}let a=250,h=o(n).slice(0,250);wht=h;let p=(await Promise.all(h.map(async v=>{let T=`${r.res},${v}`;if(!Ob.has(T)){let C=`data/JRC_POPULATION_2018_H3_by_rnd/res=${r.res}/h3_3=${v}/part0.arrow`;if((await fetch(C)).status==404)return;Ob.set(T,(await VP(C)).objects())}return new p1({id:T,ish3:!0,data:Ob.get(T),extruded:!1,stroked:!1,getHexagon:C=>C.index,getFillColor:C=>xPt(C.value),getElevation:C=>(1-C.value)*1e3,elevationScale:20,pickable:!0})}))).filter(v=>v!=null);Yz.get("trains")!==null&&p.push(TPt),HP.setProps({layers:p}),qz=p;let g=h.map(v=>`${r.res},${v}`);for(let v of Ob.keys())g.includes(v)||Ob.delete(v)};Gz();window.d3=EL;window.observablehq=ML;window.aq=Vz;window.h3=LO;window.update=Gz;var Yz=new URLSearchParams(window.location.search),Xz=document.getElementById("attribution");Xz.innerText="\xA9 "+[Yz.get("c"),"Eurostat","MapTiler","OpenStreetMap contributors",Yz.get("trains")!==null?"OpenRailwayMap":null].filter(e=>e!==null).join(" \xA9 ");Sht().then(e=>{let r=IL({color:Eht,title:"Population per km^2",tickFormat:i=>e.scale[Object.keys(e.scale).map(s=>[s,Math.abs(s-i)]).sort((s,n)=>s[1]-n[1])[0][0]].toLocaleString()});Xz.insertBefore(r,Xz.firstChild)});X0.on("moveend",()=>{let e=X0.getCenter(),t=X0.getZoom();window.location.hash=`x=${e.lng}&y=${e.lat}&z=${t}`,setTimeout(r=>{let i=X0.getCenter();e.lng==i.lng&&e.lat==i.lat&&(console.log("updating"),Gz())},1e3)});var Mht=()=>{let e=document.querySelector('link[rel="icon"]');e.href=window.matchMedia("(prefers-color-scheme: dark)").matches?"cow.svg":"cow-light.svg"};Mht();window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",Mht);})();
/*! Bundled license information:

hammerjs/hammer.js:
  (*! Hammer.JS - v2.0.7 - 2016-04-22
   * http://hammerjs.github.io/
   *
   * Copyright (c) 2016 Jorik Tangelder;
   * Licensed under the MIT license *)
*/
